var QX=e=>{throw TypeError(e)};var v2=(e,t,n)=>t.has(e)||QX("Cannot "+n);var Qe=(e,t,n)=>(v2(e,t,"read from private field"),n?n.call(e):t.get(e)),yr=(e,t,n)=>t.has(e)?QX("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),On=(e,t,n,i)=>(v2(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),hs=(e,t,n)=>(v2(e,t,"access private method"),n);var lC=(e,t,n,i)=>({set _(o){On(e,t,o,n)},get _(){return Qe(e,t,i)}});function Uke(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const o in i)if(o!=="default"&&!(o in e)){const u=Object.getOwnPropertyDescriptor(i,o);u&&Object.defineProperty(e,o,u.get?u:{enumerable:!0,get:()=>i[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}})();var Zh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _ae={exports:{}},YA={},bae={exports:{}},Jn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rw=Symbol.for("react.element"),Fke=Symbol.for("react.portal"),Vke=Symbol.for("react.fragment"),Bke=Symbol.for("react.strict_mode"),$ke=Symbol.for("react.profiler"),Wke=Symbol.for("react.provider"),Gke=Symbol.for("react.context"),Hke=Symbol.for("react.forward_ref"),zke=Symbol.for("react.suspense"),Kke=Symbol.for("react.memo"),qke=Symbol.for("react.lazy"),eJ=Symbol.iterator;function Yke(e){return e===null||typeof e!="object"?null:(e=eJ&&e[eJ]||e["@@iterator"],typeof e=="function"?e:null)}var Eae={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wae=Object.assign,Sae={};function $y(e,t,n){this.props=e,this.context=t,this.refs=Sae,this.updater=n||Eae}$y.prototype.isReactComponent={};$y.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function xae(){}xae.prototype=$y.prototype;function vV(e,t,n){this.props=e,this.context=t,this.refs=Sae,this.updater=n||Eae}var yV=vV.prototype=new xae;yV.constructor=vV;wae(yV,$y.prototype);yV.isPureReactComponent=!0;var tJ=Array.isArray,Tae=Object.prototype.hasOwnProperty,_V={current:null},Cae={key:!0,ref:!0,__self:!0,__source:!0};function Rae(e,t,n){var i,o={},u=null,h=null;if(t!=null)for(i in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(u=""+t.key),t)Tae.call(t,i)&&!Cae.hasOwnProperty(i)&&(o[i]=t[i]);var p=arguments.length-2;if(p===1)o.children=n;else if(1<p){for(var g=Array(p),v=0;v<p;v++)g[v]=arguments[v+2];o.children=g}if(e&&e.defaultProps)for(i in p=e.defaultProps,p)o[i]===void 0&&(o[i]=p[i]);return{$$typeof:Rw,type:e,key:u,ref:h,props:o,_owner:_V.current}}function Xke(e,t){return{$$typeof:Rw,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bV(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rw}function Jke(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var nJ=/\/+/g;function y2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Jke(""+e.key):t.toString(36)}function yR(e,t,n,i,o){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(u){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case Rw:case Fke:h=!0}}if(h)return h=e,o=o(h),e=i===""?"."+y2(h,0):i,tJ(o)?(n="",e!=null&&(n=e.replace(nJ,"$&/")+"/"),yR(o,t,n,"",function(v){return v})):o!=null&&(bV(o)&&(o=Xke(o,n+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(nJ,"$&/")+"/")+e)),t.push(o)),1;if(h=0,i=i===""?".":i+":",tJ(e))for(var p=0;p<e.length;p++){u=e[p];var g=i+y2(u,p);h+=yR(u,t,n,g,o)}else if(g=Yke(e),typeof g=="function")for(e=g.call(e),p=0;!(u=e.next()).done;)u=u.value,g=i+y2(u,p++),h+=yR(u,t,n,g,o);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function uC(e,t,n){if(e==null)return e;var i=[],o=0;return yR(e,i,"","",function(u){return t.call(n,u,o++)}),i}function Zke(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Us={current:null},_R={transition:null},Qke={ReactCurrentDispatcher:Us,ReactCurrentBatchConfig:_R,ReactCurrentOwner:_V};function Nae(){throw Error("act(...) is not supported in production builds of React.")}Jn.Children={map:uC,forEach:function(e,t,n){uC(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return uC(e,function(){t++}),t},toArray:function(e){return uC(e,function(t){return t})||[]},only:function(e){if(!bV(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Jn.Component=$y;Jn.Fragment=Vke;Jn.Profiler=$ke;Jn.PureComponent=vV;Jn.StrictMode=Bke;Jn.Suspense=zke;Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qke;Jn.act=Nae;Jn.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=wae({},e.props),o=e.key,u=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,h=_V.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var p=e.type.defaultProps;for(g in t)Tae.call(t,g)&&!Cae.hasOwnProperty(g)&&(i[g]=t[g]===void 0&&p!==void 0?p[g]:t[g])}var g=arguments.length-2;if(g===1)i.children=n;else if(1<g){p=Array(g);for(var v=0;v<g;v++)p[v]=arguments[v+2];i.children=p}return{$$typeof:Rw,type:e.type,key:o,ref:u,props:i,_owner:h}};Jn.createContext=function(e){return e={$$typeof:Gke,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Wke,_context:e},e.Consumer=e};Jn.createElement=Rae;Jn.createFactory=function(e){var t=Rae.bind(null,e);return t.type=e,t};Jn.createRef=function(){return{current:null}};Jn.forwardRef=function(e){return{$$typeof:Hke,render:e}};Jn.isValidElement=bV;Jn.lazy=function(e){return{$$typeof:qke,_payload:{_status:-1,_result:e},_init:Zke}};Jn.memo=function(e,t){return{$$typeof:Kke,type:e,compare:t===void 0?null:t}};Jn.startTransition=function(e){var t=_R.transition;_R.transition={};try{e()}finally{_R.transition=t}};Jn.unstable_act=Nae;Jn.useCallback=function(e,t){return Us.current.useCallback(e,t)};Jn.useContext=function(e){return Us.current.useContext(e)};Jn.useDebugValue=function(){};Jn.useDeferredValue=function(e){return Us.current.useDeferredValue(e)};Jn.useEffect=function(e,t){return Us.current.useEffect(e,t)};Jn.useId=function(){return Us.current.useId()};Jn.useImperativeHandle=function(e,t,n){return Us.current.useImperativeHandle(e,t,n)};Jn.useInsertionEffect=function(e,t){return Us.current.useInsertionEffect(e,t)};Jn.useLayoutEffect=function(e,t){return Us.current.useLayoutEffect(e,t)};Jn.useMemo=function(e,t){return Us.current.useMemo(e,t)};Jn.useReducer=function(e,t,n){return Us.current.useReducer(e,t,n)};Jn.useRef=function(e){return Us.current.useRef(e)};Jn.useState=function(e){return Us.current.useState(e)};Jn.useSyncExternalStore=function(e,t,n){return Us.current.useSyncExternalStore(e,t,n)};Jn.useTransition=function(){return Us.current.useTransition()};Jn.version="18.3.1";bae.exports=Jn;var S=bae.exports;const me=jr(S),a0=Uke({__proto__:null,default:me},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eje=S,tje=Symbol.for("react.element"),nje=Symbol.for("react.fragment"),rje=Object.prototype.hasOwnProperty,ije=eje.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,aje={key:!0,ref:!0,__self:!0,__source:!0};function Aae(e,t,n){var i,o={},u=null,h=null;n!==void 0&&(u=""+n),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(h=t.ref);for(i in t)rje.call(t,i)&&!aje.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)o[i]===void 0&&(o[i]=t[i]);return{$$typeof:tje,type:e,key:u,ref:h,props:o,_owner:ije.current}}YA.Fragment=nje;YA.jsx=Aae;YA.jsxs=Aae;_ae.exports=YA;var c=_ae.exports,Iae={exports:{}},Qo={},Oae={exports:{}},Pae={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,X){var de=re.length;re.push(X);e:for(;0<de;){var we=de-1>>>1,ge=re[we];if(0<o(ge,X))re[we]=X,re[de]=ge,de=we;else break e}}function n(re){return re.length===0?null:re[0]}function i(re){if(re.length===0)return null;var X=re[0],de=re.pop();if(de!==X){re[0]=de;e:for(var we=0,ge=re.length,Te=ge>>>1;we<Te;){var Pe=2*(we+1)-1,rt=re[Pe],dt=Pe+1,ze=re[dt];if(0>o(rt,de))dt<ge&&0>o(ze,rt)?(re[we]=ze,re[dt]=de,we=dt):(re[we]=rt,re[Pe]=de,we=Pe);else if(dt<ge&&0>o(ze,de))re[we]=ze,re[dt]=de,we=dt;else break e}}return X}function o(re,X){var de=re.sortIndex-X.sortIndex;return de!==0?de:re.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();e.unstable_now=function(){return h.now()-p}}var g=[],v=[],b=1,E=null,T=3,C=!1,R=!1,N=!1,O=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(re){for(var X=n(v);X!==null;){if(X.callback===null)i(v);else if(X.startTime<=re)i(v),X.sortIndex=X.expirationTime,t(g,X);else break;X=n(v)}}function M(re){if(N=!1,P(re),!R)if(n(g)!==null)R=!0,ae(D);else{var X=n(v);X!==null&&J(M,X.startTime-re)}}function D(re,X){R=!1,N&&(N=!1,k(z),z=-1),C=!0;var de=T;try{for(P(X),E=n(g);E!==null&&(!(E.expirationTime>X)||re&&!Q());){var we=E.callback;if(typeof we=="function"){E.callback=null,T=E.priorityLevel;var ge=we(E.expirationTime<=X);X=e.unstable_now(),typeof ge=="function"?E.callback=ge:E===n(g)&&i(g),P(X)}else i(g);E=n(g)}if(E!==null)var Te=!0;else{var Pe=n(v);Pe!==null&&J(M,Pe.startTime-X),Te=!1}return Te}finally{E=null,T=de,C=!1}}var U=!1,V=null,z=-1,W=5,Y=-1;function Q(){return!(e.unstable_now()-Y<W)}function K(){if(V!==null){var re=e.unstable_now();Y=re;var X=!0;try{X=V(!0,re)}finally{X?q():(U=!1,V=null)}}else U=!1}var q;if(typeof j=="function")q=function(){j(K)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,oe=ee.port2;ee.port1.onmessage=K,q=function(){oe.postMessage(null)}}else q=function(){O(K,0)};function ae(re){V=re,U||(U=!0,q())}function J(re,X){z=O(function(){re(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){R||C||(R=!0,ae(D))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return n(g)},e.unstable_next=function(re){switch(T){case 1:case 2:case 3:var X=3;break;default:X=T}var de=T;T=X;try{return re()}finally{T=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,X){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var de=T;T=re;try{return X()}finally{T=de}},e.unstable_scheduleCallback=function(re,X,de){var we=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?we+de:we):de=we,re){case 1:var ge=-1;break;case 2:ge=250;break;case 5:ge=1073741823;break;case 4:ge=1e4;break;default:ge=5e3}return ge=de+ge,re={id:b++,callback:X,priorityLevel:re,startTime:de,expirationTime:ge,sortIndex:-1},de>we?(re.sortIndex=de,t(v,re),n(g)===null&&re===n(v)&&(N?(k(z),z=-1):N=!0,J(M,de-we))):(re.sortIndex=ge,t(g,re),R||C||(R=!0,ae(D))),re},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(re){var X=T;return function(){var de=T;T=X;try{return re.apply(this,arguments)}finally{T=de}}}})(Pae);Oae.exports=Pae;var sje=Oae.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oje=S,qo=sje;function mt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kae=new Set,s0={};function bm(e,t){ey(e,t),ey(e+"Capture",t)}function ey(e,t){for(s0[e]=t,e=0;e<t.length;e++)kae.add(t[e])}var Ld=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cM=Object.prototype.hasOwnProperty,cje=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rJ={},iJ={};function lje(e){return cM.call(iJ,e)?!0:cM.call(rJ,e)?!1:cje.test(e)?iJ[e]=!0:(rJ[e]=!0,!1)}function uje(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function dje(e,t,n,i){if(t===null||typeof t>"u"||uje(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fs(e,t,n,i,o,u,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=h}var rs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rs[e]=new Fs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rs[t]=new Fs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rs[e]=new Fs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rs[e]=new Fs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rs[e]=new Fs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rs[e]=new Fs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rs[e]=new Fs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rs[e]=new Fs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rs[e]=new Fs(e,5,!1,e.toLowerCase(),null,!1,!1)});var EV=/[\-:]([a-z])/g;function wV(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(EV,wV);rs[t]=new Fs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(EV,wV);rs[t]=new Fs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(EV,wV);rs[t]=new Fs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rs[e]=new Fs(e,1,!1,e.toLowerCase(),null,!1,!1)});rs.xlinkHref=new Fs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rs[e]=new Fs(e,1,!1,e.toLowerCase(),null,!0,!0)});function SV(e,t,n,i){var o=rs.hasOwnProperty(t)?rs[t]:null;(o!==null?o.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(dje(t,n,o,i)&&(n=null),i||o===null?lje(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,i=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var qd=oje.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dC=Symbol.for("react.element"),vv=Symbol.for("react.portal"),yv=Symbol.for("react.fragment"),xV=Symbol.for("react.strict_mode"),lM=Symbol.for("react.profiler"),jae=Symbol.for("react.provider"),Dae=Symbol.for("react.context"),TV=Symbol.for("react.forward_ref"),uM=Symbol.for("react.suspense"),dM=Symbol.for("react.suspense_list"),CV=Symbol.for("react.memo"),Vh=Symbol.for("react.lazy"),Lae=Symbol.for("react.offscreen"),aJ=Symbol.iterator;function Jb(e){return e===null||typeof e!="object"?null:(e=aJ&&e[aJ]||e["@@iterator"],typeof e=="function"?e:null)}var ki=Object.assign,_2;function OE(e){if(_2===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);_2=t&&t[1]||""}return`
`+_2+e}var b2=!1;function E2(e,t){if(!e||b2)return"";b2=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(v){var i=v}Reflect.construct(e,[],t)}else{try{t.call()}catch(v){i=v}e.call(t.prototype)}else{try{throw Error()}catch(v){i=v}e()}}catch(v){if(v&&i&&typeof v.stack=="string"){for(var o=v.stack.split(`
`),u=i.stack.split(`
`),h=o.length-1,p=u.length-1;1<=h&&0<=p&&o[h]!==u[p];)p--;for(;1<=h&&0<=p;h--,p--)if(o[h]!==u[p]){if(h!==1||p!==1)do if(h--,p--,0>p||o[h]!==u[p]){var g=`
`+o[h].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=h&&0<=p);break}}}finally{b2=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?OE(e):""}function hje(e){switch(e.tag){case 5:return OE(e.type);case 16:return OE("Lazy");case 13:return OE("Suspense");case 19:return OE("SuspenseList");case 0:case 2:case 15:return e=E2(e.type,!1),e;case 11:return e=E2(e.type.render,!1),e;case 1:return e=E2(e.type,!0),e;default:return""}}function hM(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yv:return"Fragment";case vv:return"Portal";case lM:return"Profiler";case xV:return"StrictMode";case uM:return"Suspense";case dM:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Dae:return(e.displayName||"Context")+".Consumer";case jae:return(e._context.displayName||"Context")+".Provider";case TV:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case CV:return t=e.displayName||null,t!==null?t:hM(e.type)||"Memo";case Vh:t=e._payload,e=e._init;try{return hM(e(t))}catch{}}return null}function fje(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hM(t);case 8:return t===xV?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yf(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mae(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pje(e){var t=Mae(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,u=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(h){i=""+h,u.call(this,h)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(h){i=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function hC(e){e._valueTracker||(e._valueTracker=pje(e))}function Uae(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Mae(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function zR(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fM(e,t){var n=t.checked;return ki({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function sJ(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=yf(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fae(e,t){t=t.checked,t!=null&&SV(e,"checked",t,!1)}function pM(e,t){Fae(e,t);var n=yf(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?mM(e,t.type,n):t.hasOwnProperty("defaultValue")&&mM(e,t.type,yf(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function oJ(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function mM(e,t,n){(t!=="number"||zR(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var PE=Array.isArray;function Pv(e,t,n,i){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&i&&(e[n].defaultSelected=!0)}else{for(n=""+yf(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function gM(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(mt(91));return ki({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cJ(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(mt(92));if(PE(n)){if(1<n.length)throw Error(mt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:yf(n)}}function Vae(e,t){var n=yf(t.value),i=yf(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function lJ(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Bae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vM(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Bae(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fC,$ae=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fC=fC||document.createElement("div"),fC.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fC.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function o0(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var WE={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mje=["Webkit","ms","Moz","O"];Object.keys(WE).forEach(function(e){mje.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),WE[t]=WE[e]})});function Wae(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||WE.hasOwnProperty(e)&&WE[e]?(""+t).trim():t+"px"}function Gae(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,o=Wae(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,o):e[n]=o}}var gje=ki({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yM(e,t){if(t){if(gje[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(mt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(mt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(mt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(mt(62))}}function _M(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bM=null;function RV(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var EM=null,kv=null,jv=null;function uJ(e){if(e=Iw(e)){if(typeof EM!="function")throw Error(mt(280));var t=e.stateNode;t&&(t=e1(t),EM(e.stateNode,e.type,t))}}function Hae(e){kv?jv?jv.push(e):jv=[e]:kv=e}function zae(){if(kv){var e=kv,t=jv;if(jv=kv=null,uJ(e),t)for(e=0;e<t.length;e++)uJ(t[e])}}function Kae(e,t){return e(t)}function qae(){}var w2=!1;function Yae(e,t,n){if(w2)return e(t,n);w2=!0;try{return Kae(e,t,n)}finally{w2=!1,(kv!==null||jv!==null)&&(qae(),zae())}}function c0(e,t){var n=e.stateNode;if(n===null)return null;var i=e1(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(mt(231,t,typeof n));return n}var wM=!1;if(Ld)try{var Zb={};Object.defineProperty(Zb,"passive",{get:function(){wM=!0}}),window.addEventListener("test",Zb,Zb),window.removeEventListener("test",Zb,Zb)}catch{wM=!1}function vje(e,t,n,i,o,u,h,p,g){var v=Array.prototype.slice.call(arguments,3);try{t.apply(n,v)}catch(b){this.onError(b)}}var GE=!1,KR=null,qR=!1,SM=null,yje={onError:function(e){GE=!0,KR=e}};function _je(e,t,n,i,o,u,h,p,g){GE=!1,KR=null,vje.apply(yje,arguments)}function bje(e,t,n,i,o,u,h,p,g){if(_je.apply(this,arguments),GE){if(GE){var v=KR;GE=!1,KR=null}else throw Error(mt(198));qR||(qR=!0,SM=v)}}function Em(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Xae(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function dJ(e){if(Em(e)!==e)throw Error(mt(188))}function Eje(e){var t=e.alternate;if(!t){if(t=Em(e),t===null)throw Error(mt(188));return t!==e?null:e}for(var n=e,i=t;;){var o=n.return;if(o===null)break;var u=o.alternate;if(u===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===u.child){for(u=o.child;u;){if(u===n)return dJ(o),e;if(u===i)return dJ(o),t;u=u.sibling}throw Error(mt(188))}if(n.return!==i.return)n=o,i=u;else{for(var h=!1,p=o.child;p;){if(p===n){h=!0,n=o,i=u;break}if(p===i){h=!0,i=o,n=u;break}p=p.sibling}if(!h){for(p=u.child;p;){if(p===n){h=!0,n=u,i=o;break}if(p===i){h=!0,i=u,n=o;break}p=p.sibling}if(!h)throw Error(mt(189))}}if(n.alternate!==i)throw Error(mt(190))}if(n.tag!==3)throw Error(mt(188));return n.stateNode.current===n?e:t}function Jae(e){return e=Eje(e),e!==null?Zae(e):null}function Zae(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zae(e);if(t!==null)return t;e=e.sibling}return null}var Qae=qo.unstable_scheduleCallback,hJ=qo.unstable_cancelCallback,wje=qo.unstable_shouldYield,Sje=qo.unstable_requestPaint,Ji=qo.unstable_now,xje=qo.unstable_getCurrentPriorityLevel,NV=qo.unstable_ImmediatePriority,ese=qo.unstable_UserBlockingPriority,YR=qo.unstable_NormalPriority,Tje=qo.unstable_LowPriority,tse=qo.unstable_IdlePriority,XA=null,Ou=null;function Cje(e){if(Ou&&typeof Ou.onCommitFiberRoot=="function")try{Ou.onCommitFiberRoot(XA,e,void 0,(e.current.flags&128)===128)}catch{}}var Ul=Math.clz32?Math.clz32:Aje,Rje=Math.log,Nje=Math.LN2;function Aje(e){return e>>>=0,e===0?32:31-(Rje(e)/Nje|0)|0}var pC=64,mC=4194304;function kE(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function XR(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,o=e.suspendedLanes,u=e.pingedLanes,h=n&268435455;if(h!==0){var p=h&~o;p!==0?i=kE(p):(u&=h,u!==0&&(i=kE(u)))}else h=n&~o,h!==0?i=kE(h):u!==0&&(i=kE(u));if(i===0)return 0;if(t!==0&&t!==i&&!(t&o)&&(o=i&-i,u=t&-t,o>=u||o===16&&(u&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-Ul(t),o=1<<n,i|=e[n],t&=~o;return i}function Ije(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oje(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,u=e.pendingLanes;0<u;){var h=31-Ul(u),p=1<<h,g=o[h];g===-1?(!(p&n)||p&i)&&(o[h]=Ije(p,t)):g<=t&&(e.expiredLanes|=p),u&=~p}}function xM(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function nse(){var e=pC;return pC<<=1,!(pC&4194240)&&(pC=64),e}function S2(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Nw(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ul(t),e[t]=n}function Pje(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Ul(n),u=1<<o;t[o]=0,i[o]=-1,e[o]=-1,n&=~u}}function AV(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Ul(n),o=1<<i;o&t|e[i]&t&&(e[i]|=t),n&=~o}}var Br=0;function rse(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ise,IV,ase,sse,ose,TM=!1,gC=[],sf=null,of=null,cf=null,l0=new Map,u0=new Map,Gh=[],kje="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fJ(e,t){switch(e){case"focusin":case"focusout":sf=null;break;case"dragenter":case"dragleave":of=null;break;case"mouseover":case"mouseout":cf=null;break;case"pointerover":case"pointerout":l0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":u0.delete(t.pointerId)}}function Qb(e,t,n,i,o,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:u,targetContainers:[o]},t!==null&&(t=Iw(t),t!==null&&IV(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function jje(e,t,n,i,o){switch(t){case"focusin":return sf=Qb(sf,e,t,n,i,o),!0;case"dragenter":return of=Qb(of,e,t,n,i,o),!0;case"mouseover":return cf=Qb(cf,e,t,n,i,o),!0;case"pointerover":var u=o.pointerId;return l0.set(u,Qb(l0.get(u)||null,e,t,n,i,o)),!0;case"gotpointercapture":return u=o.pointerId,u0.set(u,Qb(u0.get(u)||null,e,t,n,i,o)),!0}return!1}function cse(e){var t=Mp(e.target);if(t!==null){var n=Em(t);if(n!==null){if(t=n.tag,t===13){if(t=Xae(n),t!==null){e.blockedOn=t,ose(e.priority,function(){ase(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bR(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=CM(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);bM=i,n.target.dispatchEvent(i),bM=null}else return t=Iw(n),t!==null&&IV(t),e.blockedOn=n,!1;t.shift()}return!0}function pJ(e,t,n){bR(e)&&n.delete(t)}function Dje(){TM=!1,sf!==null&&bR(sf)&&(sf=null),of!==null&&bR(of)&&(of=null),cf!==null&&bR(cf)&&(cf=null),l0.forEach(pJ),u0.forEach(pJ)}function eE(e,t){e.blockedOn===t&&(e.blockedOn=null,TM||(TM=!0,qo.unstable_scheduleCallback(qo.unstable_NormalPriority,Dje)))}function d0(e){function t(o){return eE(o,e)}if(0<gC.length){eE(gC[0],e);for(var n=1;n<gC.length;n++){var i=gC[n];i.blockedOn===e&&(i.blockedOn=null)}}for(sf!==null&&eE(sf,e),of!==null&&eE(of,e),cf!==null&&eE(cf,e),l0.forEach(t),u0.forEach(t),n=0;n<Gh.length;n++)i=Gh[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Gh.length&&(n=Gh[0],n.blockedOn===null);)cse(n),n.blockedOn===null&&Gh.shift()}var Dv=qd.ReactCurrentBatchConfig,JR=!0;function Lje(e,t,n,i){var o=Br,u=Dv.transition;Dv.transition=null;try{Br=1,OV(e,t,n,i)}finally{Br=o,Dv.transition=u}}function Mje(e,t,n,i){var o=Br,u=Dv.transition;Dv.transition=null;try{Br=4,OV(e,t,n,i)}finally{Br=o,Dv.transition=u}}function OV(e,t,n,i){if(JR){var o=CM(e,t,n,i);if(o===null)k2(e,t,i,ZR,n),fJ(e,i);else if(jje(o,e,t,n,i))i.stopPropagation();else if(fJ(e,i),t&4&&-1<kje.indexOf(e)){for(;o!==null;){var u=Iw(o);if(u!==null&&ise(u),u=CM(e,t,n,i),u===null&&k2(e,t,i,ZR,n),u===o)break;o=u}o!==null&&i.stopPropagation()}else k2(e,t,i,null,n)}}var ZR=null;function CM(e,t,n,i){if(ZR=null,e=RV(i),e=Mp(e),e!==null)if(t=Em(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Xae(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ZR=e,null}function lse(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xje()){case NV:return 1;case ese:return 4;case YR:case Tje:return 16;case tse:return 536870912;default:return 16}default:return 16}}var Qh=null,PV=null,ER=null;function use(){if(ER)return ER;var e,t=PV,n=t.length,i,o="value"in Qh?Qh.value:Qh.textContent,u=o.length;for(e=0;e<n&&t[e]===o[e];e++);var h=n-e;for(i=1;i<=h&&t[n-i]===o[u-i];i++);return ER=o.slice(e,1<i?1-i:void 0)}function wR(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vC(){return!0}function mJ(){return!1}function ec(e){function t(n,i,o,u,h){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=u,this.target=h,this.currentTarget=null;for(var p in e)e.hasOwnProperty(p)&&(n=e[p],this[p]=n?n(u):u[p]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?vC:mJ,this.isPropagationStopped=mJ,this}return ki(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vC)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vC)},persist:function(){},isPersistent:vC}),t}var Wy={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kV=ec(Wy),Aw=ki({},Wy,{view:0,detail:0}),Uje=ec(Aw),x2,T2,tE,JA=ki({},Aw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jV,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==tE&&(tE&&e.type==="mousemove"?(x2=e.screenX-tE.screenX,T2=e.screenY-tE.screenY):T2=x2=0,tE=e),x2)},movementY:function(e){return"movementY"in e?e.movementY:T2}}),gJ=ec(JA),Fje=ki({},JA,{dataTransfer:0}),Vje=ec(Fje),Bje=ki({},Aw,{relatedTarget:0}),C2=ec(Bje),$je=ki({},Wy,{animationName:0,elapsedTime:0,pseudoElement:0}),Wje=ec($je),Gje=ki({},Wy,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hje=ec(Gje),zje=ki({},Wy,{data:0}),vJ=ec(zje),Kje={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qje={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yje={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xje(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Yje[e])?!!t[e]:!1}function jV(){return Xje}var Jje=ki({},Aw,{key:function(e){if(e.key){var t=Kje[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wR(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qje[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jV,charCode:function(e){return e.type==="keypress"?wR(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wR(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zje=ec(Jje),Qje=ki({},JA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yJ=ec(Qje),eDe=ki({},Aw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jV}),tDe=ec(eDe),nDe=ki({},Wy,{propertyName:0,elapsedTime:0,pseudoElement:0}),rDe=ec(nDe),iDe=ki({},JA,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),aDe=ec(iDe),sDe=[9,13,27,32],DV=Ld&&"CompositionEvent"in window,HE=null;Ld&&"documentMode"in document&&(HE=document.documentMode);var oDe=Ld&&"TextEvent"in window&&!HE,dse=Ld&&(!DV||HE&&8<HE&&11>=HE),_J=" ",bJ=!1;function hse(e,t){switch(e){case"keyup":return sDe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fse(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _v=!1;function cDe(e,t){switch(e){case"compositionend":return fse(t);case"keypress":return t.which!==32?null:(bJ=!0,_J);case"textInput":return e=t.data,e===_J&&bJ?null:e;default:return null}}function lDe(e,t){if(_v)return e==="compositionend"||!DV&&hse(e,t)?(e=use(),ER=PV=Qh=null,_v=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dse&&t.locale!=="ko"?null:t.data;default:return null}}var uDe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function EJ(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!uDe[e.type]:t==="textarea"}function pse(e,t,n,i){Hae(i),t=QR(t,"onChange"),0<t.length&&(n=new kV("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var zE=null,h0=null;function dDe(e){Tse(e,0)}function ZA(e){var t=wv(e);if(Uae(t))return e}function hDe(e,t){if(e==="change")return t}var mse=!1;if(Ld){var R2;if(Ld){var N2="oninput"in document;if(!N2){var wJ=document.createElement("div");wJ.setAttribute("oninput","return;"),N2=typeof wJ.oninput=="function"}R2=N2}else R2=!1;mse=R2&&(!document.documentMode||9<document.documentMode)}function SJ(){zE&&(zE.detachEvent("onpropertychange",gse),h0=zE=null)}function gse(e){if(e.propertyName==="value"&&ZA(h0)){var t=[];pse(t,h0,e,RV(e)),Yae(dDe,t)}}function fDe(e,t,n){e==="focusin"?(SJ(),zE=t,h0=n,zE.attachEvent("onpropertychange",gse)):e==="focusout"&&SJ()}function pDe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ZA(h0)}function mDe(e,t){if(e==="click")return ZA(t)}function gDe(e,t){if(e==="input"||e==="change")return ZA(t)}function vDe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $l=typeof Object.is=="function"?Object.is:vDe;function f0(e,t){if($l(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!cM.call(t,o)||!$l(e[o],t[o]))return!1}return!0}function xJ(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function TJ(e,t){var n=xJ(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=xJ(n)}}function vse(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vse(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yse(){for(var e=window,t=zR();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=zR(e.document)}return t}function LV(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yDe(e){var t=yse(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vse(n.ownerDocument.documentElement,n)){if(i!==null&&LV(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,u=Math.min(i.start,o);i=i.end===void 0?u:Math.min(i.end,o),!e.extend&&u>i&&(o=i,i=u,u=o),o=TJ(n,u);var h=TJ(n,i);o&&h&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),u>i?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _De=Ld&&"documentMode"in document&&11>=document.documentMode,bv=null,RM=null,KE=null,NM=!1;function CJ(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;NM||bv==null||bv!==zR(i)||(i=bv,"selectionStart"in i&&LV(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),KE&&f0(KE,i)||(KE=i,i=QR(RM,"onSelect"),0<i.length&&(t=new kV("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=bv)))}function yC(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ev={animationend:yC("Animation","AnimationEnd"),animationiteration:yC("Animation","AnimationIteration"),animationstart:yC("Animation","AnimationStart"),transitionend:yC("Transition","TransitionEnd")},A2={},_se={};Ld&&(_se=document.createElement("div").style,"AnimationEvent"in window||(delete Ev.animationend.animation,delete Ev.animationiteration.animation,delete Ev.animationstart.animation),"TransitionEvent"in window||delete Ev.transitionend.transition);function QA(e){if(A2[e])return A2[e];if(!Ev[e])return e;var t=Ev[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _se)return A2[e]=t[n];return e}var bse=QA("animationend"),Ese=QA("animationiteration"),wse=QA("animationstart"),Sse=QA("transitionend"),xse=new Map,RJ="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nf(e,t){xse.set(e,t),bm(t,[e])}for(var I2=0;I2<RJ.length;I2++){var O2=RJ[I2],bDe=O2.toLowerCase(),EDe=O2[0].toUpperCase()+O2.slice(1);Nf(bDe,"on"+EDe)}Nf(bse,"onAnimationEnd");Nf(Ese,"onAnimationIteration");Nf(wse,"onAnimationStart");Nf("dblclick","onDoubleClick");Nf("focusin","onFocus");Nf("focusout","onBlur");Nf(Sse,"onTransitionEnd");ey("onMouseEnter",["mouseout","mouseover"]);ey("onMouseLeave",["mouseout","mouseover"]);ey("onPointerEnter",["pointerout","pointerover"]);ey("onPointerLeave",["pointerout","pointerover"]);bm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bm("onBeforeInput",["compositionend","keypress","textInput","paste"]);bm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jE="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wDe=new Set("cancel close invalid load scroll toggle".split(" ").concat(jE));function NJ(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,bje(i,t,void 0,e),e.currentTarget=null}function Tse(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],o=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var h=i.length-1;0<=h;h--){var p=i[h],g=p.instance,v=p.currentTarget;if(p=p.listener,g!==u&&o.isPropagationStopped())break e;NJ(o,p,v),u=g}else for(h=0;h<i.length;h++){if(p=i[h],g=p.instance,v=p.currentTarget,p=p.listener,g!==u&&o.isPropagationStopped())break e;NJ(o,p,v),u=g}}}if(qR)throw e=SM,qR=!1,SM=null,e}function ui(e,t){var n=t[kM];n===void 0&&(n=t[kM]=new Set);var i=e+"__bubble";n.has(i)||(Cse(t,e,2,!1),n.add(i))}function P2(e,t,n){var i=0;t&&(i|=4),Cse(n,e,i,t)}var _C="_reactListening"+Math.random().toString(36).slice(2);function p0(e){if(!e[_C]){e[_C]=!0,kae.forEach(function(n){n!=="selectionchange"&&(wDe.has(n)||P2(n,!1,e),P2(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_C]||(t[_C]=!0,P2("selectionchange",!1,t))}}function Cse(e,t,n,i){switch(lse(t)){case 1:var o=Lje;break;case 4:o=Mje;break;default:o=OV}n=o.bind(null,t,n,e),o=void 0,!wM||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function k2(e,t,n,i,o){var u=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var h=i.tag;if(h===3||h===4){var p=i.stateNode.containerInfo;if(p===o||p.nodeType===8&&p.parentNode===o)break;if(h===4)for(h=i.return;h!==null;){var g=h.tag;if((g===3||g===4)&&(g=h.stateNode.containerInfo,g===o||g.nodeType===8&&g.parentNode===o))return;h=h.return}for(;p!==null;){if(h=Mp(p),h===null)return;if(g=h.tag,g===5||g===6){i=u=h;continue e}p=p.parentNode}}i=i.return}Yae(function(){var v=u,b=RV(n),E=[];e:{var T=xse.get(e);if(T!==void 0){var C=kV,R=e;switch(e){case"keypress":if(wR(n)===0)break e;case"keydown":case"keyup":C=Zje;break;case"focusin":R="focus",C=C2;break;case"focusout":R="blur",C=C2;break;case"beforeblur":case"afterblur":C=C2;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=gJ;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Vje;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=tDe;break;case bse:case Ese:case wse:C=Wje;break;case Sse:C=rDe;break;case"scroll":C=Uje;break;case"wheel":C=aDe;break;case"copy":case"cut":case"paste":C=Hje;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=yJ}var N=(t&4)!==0,O=!N&&e==="scroll",k=N?T!==null?T+"Capture":null:T;N=[];for(var j=v,P;j!==null;){P=j;var M=P.stateNode;if(P.tag===5&&M!==null&&(P=M,k!==null&&(M=c0(j,k),M!=null&&N.push(m0(j,M,P)))),O)break;j=j.return}0<N.length&&(T=new C(T,R,null,n,b),E.push({event:T,listeners:N}))}}if(!(t&7)){e:{if(T=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",T&&n!==bM&&(R=n.relatedTarget||n.fromElement)&&(Mp(R)||R[Md]))break e;if((C||T)&&(T=b.window===b?b:(T=b.ownerDocument)?T.defaultView||T.parentWindow:window,C?(R=n.relatedTarget||n.toElement,C=v,R=R?Mp(R):null,R!==null&&(O=Em(R),R!==O||R.tag!==5&&R.tag!==6)&&(R=null)):(C=null,R=v),C!==R)){if(N=gJ,M="onMouseLeave",k="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&(N=yJ,M="onPointerLeave",k="onPointerEnter",j="pointer"),O=C==null?T:wv(C),P=R==null?T:wv(R),T=new N(M,j+"leave",C,n,b),T.target=O,T.relatedTarget=P,M=null,Mp(b)===v&&(N=new N(k,j+"enter",R,n,b),N.target=P,N.relatedTarget=O,M=N),O=M,C&&R)t:{for(N=C,k=R,j=0,P=N;P;P=nv(P))j++;for(P=0,M=k;M;M=nv(M))P++;for(;0<j-P;)N=nv(N),j--;for(;0<P-j;)k=nv(k),P--;for(;j--;){if(N===k||k!==null&&N===k.alternate)break t;N=nv(N),k=nv(k)}N=null}else N=null;C!==null&&AJ(E,T,C,N,!1),R!==null&&O!==null&&AJ(E,O,R,N,!0)}}e:{if(T=v?wv(v):window,C=T.nodeName&&T.nodeName.toLowerCase(),C==="select"||C==="input"&&T.type==="file")var D=hDe;else if(EJ(T))if(mse)D=gDe;else{D=pDe;var U=fDe}else(C=T.nodeName)&&C.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(D=mDe);if(D&&(D=D(e,v))){pse(E,D,n,b);break e}U&&U(e,T,v),e==="focusout"&&(U=T._wrapperState)&&U.controlled&&T.type==="number"&&mM(T,"number",T.value)}switch(U=v?wv(v):window,e){case"focusin":(EJ(U)||U.contentEditable==="true")&&(bv=U,RM=v,KE=null);break;case"focusout":KE=RM=bv=null;break;case"mousedown":NM=!0;break;case"contextmenu":case"mouseup":case"dragend":NM=!1,CJ(E,n,b);break;case"selectionchange":if(_De)break;case"keydown":case"keyup":CJ(E,n,b)}var V;if(DV)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else _v?hse(e,n)&&(z="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(z="onCompositionStart");z&&(dse&&n.locale!=="ko"&&(_v||z!=="onCompositionStart"?z==="onCompositionEnd"&&_v&&(V=use()):(Qh=b,PV="value"in Qh?Qh.value:Qh.textContent,_v=!0)),U=QR(v,z),0<U.length&&(z=new vJ(z,e,null,n,b),E.push({event:z,listeners:U}),V?z.data=V:(V=fse(n),V!==null&&(z.data=V)))),(V=oDe?cDe(e,n):lDe(e,n))&&(v=QR(v,"onBeforeInput"),0<v.length&&(b=new vJ("onBeforeInput","beforeinput",null,n,b),E.push({event:b,listeners:v}),b.data=V))}Tse(E,t)})}function m0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function QR(e,t){for(var n=t+"Capture",i=[];e!==null;){var o=e,u=o.stateNode;o.tag===5&&u!==null&&(o=u,u=c0(e,n),u!=null&&i.unshift(m0(e,u,o)),u=c0(e,t),u!=null&&i.push(m0(e,u,o))),e=e.return}return i}function nv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function AJ(e,t,n,i,o){for(var u=t._reactName,h=[];n!==null&&n!==i;){var p=n,g=p.alternate,v=p.stateNode;if(g!==null&&g===i)break;p.tag===5&&v!==null&&(p=v,o?(g=c0(n,u),g!=null&&h.unshift(m0(n,g,p))):o||(g=c0(n,u),g!=null&&h.push(m0(n,g,p)))),n=n.return}h.length!==0&&e.push({event:t,listeners:h})}var SDe=/\r\n?/g,xDe=/\u0000|\uFFFD/g;function IJ(e){return(typeof e=="string"?e:""+e).replace(SDe,`
`).replace(xDe,"")}function bC(e,t,n){if(t=IJ(t),IJ(e)!==t&&n)throw Error(mt(425))}function eN(){}var AM=null,IM=null;function OM(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var PM=typeof setTimeout=="function"?setTimeout:void 0,TDe=typeof clearTimeout=="function"?clearTimeout:void 0,OJ=typeof Promise=="function"?Promise:void 0,CDe=typeof queueMicrotask=="function"?queueMicrotask:typeof OJ<"u"?function(e){return OJ.resolve(null).then(e).catch(RDe)}:PM;function RDe(e){setTimeout(function(){throw e})}function j2(e,t){var n=t,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(i===0){e.removeChild(o),d0(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=o}while(n);d0(t)}function lf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function PJ(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Gy=Math.random().toString(36).slice(2),Cu="__reactFiber$"+Gy,g0="__reactProps$"+Gy,Md="__reactContainer$"+Gy,kM="__reactEvents$"+Gy,NDe="__reactListeners$"+Gy,ADe="__reactHandles$"+Gy;function Mp(e){var t=e[Cu];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Md]||n[Cu]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=PJ(e);e!==null;){if(n=e[Cu])return n;e=PJ(e)}return t}e=n,n=e.parentNode}return null}function Iw(e){return e=e[Cu]||e[Md],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function wv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(mt(33))}function e1(e){return e[g0]||null}var jM=[],Sv=-1;function Af(e){return{current:e}}function pi(e){0>Sv||(e.current=jM[Sv],jM[Sv]=null,Sv--)}function ai(e,t){Sv++,jM[Sv]=e.current,e.current=t}var _f={},ws=Af(_f),fo=Af(!1),nm=_f;function ty(e,t){var n=e.type.contextTypes;if(!n)return _f;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var o={},u;for(u in n)o[u]=t[u];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function po(e){return e=e.childContextTypes,e!=null}function tN(){pi(fo),pi(ws)}function kJ(e,t,n){if(ws.current!==_f)throw Error(mt(168));ai(ws,t),ai(fo,n)}function Rse(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var o in i)if(!(o in t))throw Error(mt(108,fje(e)||"Unknown",o));return ki({},n,i)}function nN(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_f,nm=ws.current,ai(ws,e),ai(fo,fo.current),!0}function jJ(e,t,n){var i=e.stateNode;if(!i)throw Error(mt(169));n?(e=Rse(e,t,nm),i.__reactInternalMemoizedMergedChildContext=e,pi(fo),pi(ws),ai(ws,e)):pi(fo),ai(fo,n)}var Ed=null,t1=!1,D2=!1;function Nse(e){Ed===null?Ed=[e]:Ed.push(e)}function IDe(e){t1=!0,Nse(e)}function If(){if(!D2&&Ed!==null){D2=!0;var e=0,t=Br;try{var n=Ed;for(Br=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}Ed=null,t1=!1}catch(o){throw Ed!==null&&(Ed=Ed.slice(e+1)),Qae(NV,If),o}finally{Br=t,D2=!1}}return null}var xv=[],Tv=0,rN=null,iN=0,Pc=[],kc=0,rm=null,xd=1,Td="";function Ip(e,t){xv[Tv++]=iN,xv[Tv++]=rN,rN=e,iN=t}function Ase(e,t,n){Pc[kc++]=xd,Pc[kc++]=Td,Pc[kc++]=rm,rm=e;var i=xd;e=Td;var o=32-Ul(i)-1;i&=~(1<<o),n+=1;var u=32-Ul(t)+o;if(30<u){var h=o-o%5;u=(i&(1<<h)-1).toString(32),i>>=h,o-=h,xd=1<<32-Ul(t)+o|n<<o|i,Td=u+e}else xd=1<<u|n<<o|i,Td=e}function MV(e){e.return!==null&&(Ip(e,1),Ase(e,1,0))}function UV(e){for(;e===rN;)rN=xv[--Tv],xv[Tv]=null,iN=xv[--Tv],xv[Tv]=null;for(;e===rm;)rm=Pc[--kc],Pc[kc]=null,Td=Pc[--kc],Pc[kc]=null,xd=Pc[--kc],Pc[kc]=null}var Ho=null,Go=null,bi=!1,kl=null;function Ise(e,t){var n=Lc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function DJ(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ho=e,Go=lf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ho=e,Go=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=rm!==null?{id:xd,overflow:Td}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Lc(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ho=e,Go=null,!0):!1;default:return!1}}function DM(e){return(e.mode&1)!==0&&(e.flags&128)===0}function LM(e){if(bi){var t=Go;if(t){var n=t;if(!DJ(e,t)){if(DM(e))throw Error(mt(418));t=lf(n.nextSibling);var i=Ho;t&&DJ(e,t)?Ise(i,n):(e.flags=e.flags&-4097|2,bi=!1,Ho=e)}}else{if(DM(e))throw Error(mt(418));e.flags=e.flags&-4097|2,bi=!1,Ho=e}}}function LJ(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ho=e}function EC(e){if(e!==Ho)return!1;if(!bi)return LJ(e),bi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!OM(e.type,e.memoizedProps)),t&&(t=Go)){if(DM(e))throw Ose(),Error(mt(418));for(;t;)Ise(e,t),t=lf(t.nextSibling)}if(LJ(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(mt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Go=lf(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Go=null}}else Go=Ho?lf(e.stateNode.nextSibling):null;return!0}function Ose(){for(var e=Go;e;)e=lf(e.nextSibling)}function ny(){Go=Ho=null,bi=!1}function FV(e){kl===null?kl=[e]:kl.push(e)}var ODe=qd.ReactCurrentBatchConfig;function nE(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(mt(309));var i=n.stateNode}if(!i)throw Error(mt(147,e));var o=i,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(h){var p=o.refs;h===null?delete p[u]:p[u]=h},t._stringRef=u,t)}if(typeof e!="string")throw Error(mt(284));if(!n._owner)throw Error(mt(290,e))}return e}function wC(e,t){throw e=Object.prototype.toString.call(t),Error(mt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function MJ(e){var t=e._init;return t(e._payload)}function Pse(e){function t(k,j){if(e){var P=k.deletions;P===null?(k.deletions=[j],k.flags|=16):P.push(j)}}function n(k,j){if(!e)return null;for(;j!==null;)t(k,j),j=j.sibling;return null}function i(k,j){for(k=new Map;j!==null;)j.key!==null?k.set(j.key,j):k.set(j.index,j),j=j.sibling;return k}function o(k,j){return k=ff(k,j),k.index=0,k.sibling=null,k}function u(k,j,P){return k.index=P,e?(P=k.alternate,P!==null?(P=P.index,P<j?(k.flags|=2,j):P):(k.flags|=2,j)):(k.flags|=1048576,j)}function h(k){return e&&k.alternate===null&&(k.flags|=2),k}function p(k,j,P,M){return j===null||j.tag!==6?(j=$2(P,k.mode,M),j.return=k,j):(j=o(j,P),j.return=k,j)}function g(k,j,P,M){var D=P.type;return D===yv?b(k,j,P.props.children,M,P.key):j!==null&&(j.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Vh&&MJ(D)===j.type)?(M=o(j,P.props),M.ref=nE(k,j,P),M.return=k,M):(M=AR(P.type,P.key,P.props,null,k.mode,M),M.ref=nE(k,j,P),M.return=k,M)}function v(k,j,P,M){return j===null||j.tag!==4||j.stateNode.containerInfo!==P.containerInfo||j.stateNode.implementation!==P.implementation?(j=W2(P,k.mode,M),j.return=k,j):(j=o(j,P.children||[]),j.return=k,j)}function b(k,j,P,M,D){return j===null||j.tag!==7?(j=Zp(P,k.mode,M,D),j.return=k,j):(j=o(j,P),j.return=k,j)}function E(k,j,P){if(typeof j=="string"&&j!==""||typeof j=="number")return j=$2(""+j,k.mode,P),j.return=k,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case dC:return P=AR(j.type,j.key,j.props,null,k.mode,P),P.ref=nE(k,null,j),P.return=k,P;case vv:return j=W2(j,k.mode,P),j.return=k,j;case Vh:var M=j._init;return E(k,M(j._payload),P)}if(PE(j)||Jb(j))return j=Zp(j,k.mode,P,null),j.return=k,j;wC(k,j)}return null}function T(k,j,P,M){var D=j!==null?j.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return D!==null?null:p(k,j,""+P,M);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case dC:return P.key===D?g(k,j,P,M):null;case vv:return P.key===D?v(k,j,P,M):null;case Vh:return D=P._init,T(k,j,D(P._payload),M)}if(PE(P)||Jb(P))return D!==null?null:b(k,j,P,M,null);wC(k,P)}return null}function C(k,j,P,M,D){if(typeof M=="string"&&M!==""||typeof M=="number")return k=k.get(P)||null,p(j,k,""+M,D);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case dC:return k=k.get(M.key===null?P:M.key)||null,g(j,k,M,D);case vv:return k=k.get(M.key===null?P:M.key)||null,v(j,k,M,D);case Vh:var U=M._init;return C(k,j,P,U(M._payload),D)}if(PE(M)||Jb(M))return k=k.get(P)||null,b(j,k,M,D,null);wC(j,M)}return null}function R(k,j,P,M){for(var D=null,U=null,V=j,z=j=0,W=null;V!==null&&z<P.length;z++){V.index>z?(W=V,V=null):W=V.sibling;var Y=T(k,V,P[z],M);if(Y===null){V===null&&(V=W);break}e&&V&&Y.alternate===null&&t(k,V),j=u(Y,j,z),U===null?D=Y:U.sibling=Y,U=Y,V=W}if(z===P.length)return n(k,V),bi&&Ip(k,z),D;if(V===null){for(;z<P.length;z++)V=E(k,P[z],M),V!==null&&(j=u(V,j,z),U===null?D=V:U.sibling=V,U=V);return bi&&Ip(k,z),D}for(V=i(k,V);z<P.length;z++)W=C(V,k,z,P[z],M),W!==null&&(e&&W.alternate!==null&&V.delete(W.key===null?z:W.key),j=u(W,j,z),U===null?D=W:U.sibling=W,U=W);return e&&V.forEach(function(Q){return t(k,Q)}),bi&&Ip(k,z),D}function N(k,j,P,M){var D=Jb(P);if(typeof D!="function")throw Error(mt(150));if(P=D.call(P),P==null)throw Error(mt(151));for(var U=D=null,V=j,z=j=0,W=null,Y=P.next();V!==null&&!Y.done;z++,Y=P.next()){V.index>z?(W=V,V=null):W=V.sibling;var Q=T(k,V,Y.value,M);if(Q===null){V===null&&(V=W);break}e&&V&&Q.alternate===null&&t(k,V),j=u(Q,j,z),U===null?D=Q:U.sibling=Q,U=Q,V=W}if(Y.done)return n(k,V),bi&&Ip(k,z),D;if(V===null){for(;!Y.done;z++,Y=P.next())Y=E(k,Y.value,M),Y!==null&&(j=u(Y,j,z),U===null?D=Y:U.sibling=Y,U=Y);return bi&&Ip(k,z),D}for(V=i(k,V);!Y.done;z++,Y=P.next())Y=C(V,k,z,Y.value,M),Y!==null&&(e&&Y.alternate!==null&&V.delete(Y.key===null?z:Y.key),j=u(Y,j,z),U===null?D=Y:U.sibling=Y,U=Y);return e&&V.forEach(function(K){return t(k,K)}),bi&&Ip(k,z),D}function O(k,j,P,M){if(typeof P=="object"&&P!==null&&P.type===yv&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case dC:e:{for(var D=P.key,U=j;U!==null;){if(U.key===D){if(D=P.type,D===yv){if(U.tag===7){n(k,U.sibling),j=o(U,P.props.children),j.return=k,k=j;break e}}else if(U.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Vh&&MJ(D)===U.type){n(k,U.sibling),j=o(U,P.props),j.ref=nE(k,U,P),j.return=k,k=j;break e}n(k,U);break}else t(k,U);U=U.sibling}P.type===yv?(j=Zp(P.props.children,k.mode,M,P.key),j.return=k,k=j):(M=AR(P.type,P.key,P.props,null,k.mode,M),M.ref=nE(k,j,P),M.return=k,k=M)}return h(k);case vv:e:{for(U=P.key;j!==null;){if(j.key===U)if(j.tag===4&&j.stateNode.containerInfo===P.containerInfo&&j.stateNode.implementation===P.implementation){n(k,j.sibling),j=o(j,P.children||[]),j.return=k,k=j;break e}else{n(k,j);break}else t(k,j);j=j.sibling}j=W2(P,k.mode,M),j.return=k,k=j}return h(k);case Vh:return U=P._init,O(k,j,U(P._payload),M)}if(PE(P))return R(k,j,P,M);if(Jb(P))return N(k,j,P,M);wC(k,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,j!==null&&j.tag===6?(n(k,j.sibling),j=o(j,P),j.return=k,k=j):(n(k,j),j=$2(P,k.mode,M),j.return=k,k=j),h(k)):n(k,j)}return O}var ry=Pse(!0),kse=Pse(!1),aN=Af(null),sN=null,Cv=null,VV=null;function BV(){VV=Cv=sN=null}function $V(e){var t=aN.current;pi(aN),e._currentValue=t}function MM(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Lv(e,t){sN=e,VV=Cv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(uo=!0),e.firstContext=null)}function Bc(e){var t=e._currentValue;if(VV!==e)if(e={context:e,memoizedValue:t,next:null},Cv===null){if(sN===null)throw Error(mt(308));Cv=e,sN.dependencies={lanes:0,firstContext:e}}else Cv=Cv.next=e;return t}var Up=null;function WV(e){Up===null?Up=[e]:Up.push(e)}function jse(e,t,n,i){var o=t.interleaved;return o===null?(n.next=n,WV(t)):(n.next=o.next,o.next=n),t.interleaved=n,Ud(e,i)}function Ud(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Bh=!1;function GV(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dse(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ad(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function uf(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,pr&2){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,Ud(e,n)}return o=i.interleaved,o===null?(t.next=t,WV(i)):(t.next=o.next,o.next=t),i.interleaved=t,Ud(e,n)}function SR(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,AV(e,n)}}function UJ(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,u=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};u===null?o=u=h:u=u.next=h,n=n.next}while(n!==null);u===null?o=u=t:u=u.next=t}else o=u=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:u,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function oN(e,t,n,i){var o=e.updateQueue;Bh=!1;var u=o.firstBaseUpdate,h=o.lastBaseUpdate,p=o.shared.pending;if(p!==null){o.shared.pending=null;var g=p,v=g.next;g.next=null,h===null?u=v:h.next=v,h=g;var b=e.alternate;b!==null&&(b=b.updateQueue,p=b.lastBaseUpdate,p!==h&&(p===null?b.firstBaseUpdate=v:p.next=v,b.lastBaseUpdate=g))}if(u!==null){var E=o.baseState;h=0,b=v=g=null,p=u;do{var T=p.lane,C=p.eventTime;if((i&T)===T){b!==null&&(b=b.next={eventTime:C,lane:0,tag:p.tag,payload:p.payload,callback:p.callback,next:null});e:{var R=e,N=p;switch(T=t,C=n,N.tag){case 1:if(R=N.payload,typeof R=="function"){E=R.call(C,E,T);break e}E=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=N.payload,T=typeof R=="function"?R.call(C,E,T):R,T==null)break e;E=ki({},E,T);break e;case 2:Bh=!0}}p.callback!==null&&p.lane!==0&&(e.flags|=64,T=o.effects,T===null?o.effects=[p]:T.push(p))}else C={eventTime:C,lane:T,tag:p.tag,payload:p.payload,callback:p.callback,next:null},b===null?(v=b=C,g=E):b=b.next=C,h|=T;if(p=p.next,p===null){if(p=o.shared.pending,p===null)break;T=p,p=T.next,T.next=null,o.lastBaseUpdate=T,o.shared.pending=null}}while(!0);if(b===null&&(g=E),o.baseState=g,o.firstBaseUpdate=v,o.lastBaseUpdate=b,t=o.shared.interleaved,t!==null){o=t;do h|=o.lane,o=o.next;while(o!==t)}else u===null&&(o.shared.lanes=0);am|=h,e.lanes=h,e.memoizedState=E}}function FJ(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(o!==null){if(i.callback=null,i=n,typeof o!="function")throw Error(mt(191,o));o.call(i)}}}var Ow={},Pu=Af(Ow),v0=Af(Ow),y0=Af(Ow);function Fp(e){if(e===Ow)throw Error(mt(174));return e}function HV(e,t){switch(ai(y0,t),ai(v0,e),ai(Pu,Ow),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vM(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vM(t,e)}pi(Pu),ai(Pu,t)}function iy(){pi(Pu),pi(v0),pi(y0)}function Lse(e){Fp(y0.current);var t=Fp(Pu.current),n=vM(t,e.type);t!==n&&(ai(v0,e),ai(Pu,n))}function zV(e){v0.current===e&&(pi(Pu),pi(v0))}var Ii=Af(0);function cN(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var L2=[];function KV(){for(var e=0;e<L2.length;e++)L2[e]._workInProgressVersionPrimary=null;L2.length=0}var xR=qd.ReactCurrentDispatcher,M2=qd.ReactCurrentBatchConfig,im=0,Pi=null,Na=null,Va=null,lN=!1,qE=!1,_0=0,PDe=0;function fs(){throw Error(mt(321))}function qV(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$l(e[n],t[n]))return!1;return!0}function YV(e,t,n,i,o,u){if(im=u,Pi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xR.current=e===null||e.memoizedState===null?LDe:MDe,e=n(i,o),qE){u=0;do{if(qE=!1,_0=0,25<=u)throw Error(mt(301));u+=1,Va=Na=null,t.updateQueue=null,xR.current=UDe,e=n(i,o)}while(qE)}if(xR.current=uN,t=Na!==null&&Na.next!==null,im=0,Va=Na=Pi=null,lN=!1,t)throw Error(mt(300));return e}function XV(){var e=_0!==0;return _0=0,e}function bu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Va===null?Pi.memoizedState=Va=e:Va=Va.next=e,Va}function $c(){if(Na===null){var e=Pi.alternate;e=e!==null?e.memoizedState:null}else e=Na.next;var t=Va===null?Pi.memoizedState:Va.next;if(t!==null)Va=t,Na=e;else{if(e===null)throw Error(mt(310));Na=e,e={memoizedState:Na.memoizedState,baseState:Na.baseState,baseQueue:Na.baseQueue,queue:Na.queue,next:null},Va===null?Pi.memoizedState=Va=e:Va=Va.next=e}return Va}function b0(e,t){return typeof t=="function"?t(e):t}function U2(e){var t=$c(),n=t.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=e;var i=Na,o=i.baseQueue,u=n.pending;if(u!==null){if(o!==null){var h=o.next;o.next=u.next,u.next=h}i.baseQueue=o=u,n.pending=null}if(o!==null){u=o.next,i=i.baseState;var p=h=null,g=null,v=u;do{var b=v.lane;if((im&b)===b)g!==null&&(g=g.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),i=v.hasEagerState?v.eagerState:e(i,v.action);else{var E={lane:b,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};g===null?(p=g=E,h=i):g=g.next=E,Pi.lanes|=b,am|=b}v=v.next}while(v!==null&&v!==u);g===null?h=i:g.next=p,$l(i,t.memoizedState)||(uo=!0),t.memoizedState=i,t.baseState=h,t.baseQueue=g,n.lastRenderedState=i}if(e=n.interleaved,e!==null){o=e;do u=o.lane,Pi.lanes|=u,am|=u,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function F2(e){var t=$c(),n=t.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=e;var i=n.dispatch,o=n.pending,u=t.memoizedState;if(o!==null){n.pending=null;var h=o=o.next;do u=e(u,h.action),h=h.next;while(h!==o);$l(u,t.memoizedState)||(uo=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),n.lastRenderedState=u}return[u,i]}function Mse(){}function Use(e,t){var n=Pi,i=$c(),o=t(),u=!$l(i.memoizedState,o);if(u&&(i.memoizedState=o,uo=!0),i=i.queue,JV(Bse.bind(null,n,i,e),[e]),i.getSnapshot!==t||u||Va!==null&&Va.memoizedState.tag&1){if(n.flags|=2048,E0(9,Vse.bind(null,n,i,o,t),void 0,null),Ga===null)throw Error(mt(349));im&30||Fse(n,t,o)}return o}function Fse(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Pi.updateQueue,t===null?(t={lastEffect:null,stores:null},Pi.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Vse(e,t,n,i){t.value=n,t.getSnapshot=i,$se(t)&&Wse(e)}function Bse(e,t,n){return n(function(){$se(t)&&Wse(e)})}function $se(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!$l(e,n)}catch{return!0}}function Wse(e){var t=Ud(e,1);t!==null&&Fl(t,e,1,-1)}function VJ(e){var t=bu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b0,lastRenderedState:e},t.queue=e,e=e.dispatch=DDe.bind(null,Pi,e),[t.memoizedState,e]}function E0(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Pi.updateQueue,t===null?(t={lastEffect:null,stores:null},Pi.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Gse(){return $c().memoizedState}function TR(e,t,n,i){var o=bu();Pi.flags|=e,o.memoizedState=E0(1|t,n,void 0,i===void 0?null:i)}function n1(e,t,n,i){var o=$c();i=i===void 0?null:i;var u=void 0;if(Na!==null){var h=Na.memoizedState;if(u=h.destroy,i!==null&&qV(i,h.deps)){o.memoizedState=E0(t,n,u,i);return}}Pi.flags|=e,o.memoizedState=E0(1|t,n,u,i)}function BJ(e,t){return TR(8390656,8,e,t)}function JV(e,t){return n1(2048,8,e,t)}function Hse(e,t){return n1(4,2,e,t)}function zse(e,t){return n1(4,4,e,t)}function Kse(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qse(e,t,n){return n=n!=null?n.concat([e]):null,n1(4,4,Kse.bind(null,t,e),n)}function ZV(){}function Yse(e,t){var n=$c();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&qV(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Xse(e,t){var n=$c();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&qV(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Jse(e,t,n){return im&21?($l(n,t)||(n=nse(),Pi.lanes|=n,am|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,uo=!0),e.memoizedState=n)}function kDe(e,t){var n=Br;Br=n!==0&&4>n?n:4,e(!0);var i=M2.transition;M2.transition={};try{e(!1),t()}finally{Br=n,M2.transition=i}}function Zse(){return $c().memoizedState}function jDe(e,t,n){var i=hf(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qse(e))eoe(t,n);else if(n=jse(e,t,n,i),n!==null){var o=Ms();Fl(n,e,i,o),toe(n,t,i)}}function DDe(e,t,n){var i=hf(e),o={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qse(e))eoe(t,o);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var h=t.lastRenderedState,p=u(h,n);if(o.hasEagerState=!0,o.eagerState=p,$l(p,h)){var g=t.interleaved;g===null?(o.next=o,WV(t)):(o.next=g.next,g.next=o),t.interleaved=o;return}}catch{}finally{}n=jse(e,t,o,i),n!==null&&(o=Ms(),Fl(n,e,i,o),toe(n,t,i))}}function Qse(e){var t=e.alternate;return e===Pi||t!==null&&t===Pi}function eoe(e,t){qE=lN=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function toe(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,AV(e,n)}}var uN={readContext:Bc,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},LDe={readContext:Bc,useCallback:function(e,t){return bu().memoizedState=[e,t===void 0?null:t],e},useContext:Bc,useEffect:BJ,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,TR(4194308,4,Kse.bind(null,t,e),n)},useLayoutEffect:function(e,t){return TR(4194308,4,e,t)},useInsertionEffect:function(e,t){return TR(4,2,e,t)},useMemo:function(e,t){var n=bu();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=bu();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=jDe.bind(null,Pi,e),[i.memoizedState,e]},useRef:function(e){var t=bu();return e={current:e},t.memoizedState=e},useState:VJ,useDebugValue:ZV,useDeferredValue:function(e){return bu().memoizedState=e},useTransition:function(){var e=VJ(!1),t=e[0];return e=kDe.bind(null,e[1]),bu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Pi,o=bu();if(bi){if(n===void 0)throw Error(mt(407));n=n()}else{if(n=t(),Ga===null)throw Error(mt(349));im&30||Fse(i,t,n)}o.memoizedState=n;var u={value:n,getSnapshot:t};return o.queue=u,BJ(Bse.bind(null,i,u,e),[e]),i.flags|=2048,E0(9,Vse.bind(null,i,u,n,t),void 0,null),n},useId:function(){var e=bu(),t=Ga.identifierPrefix;if(bi){var n=Td,i=xd;n=(i&~(1<<32-Ul(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=_0++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=PDe++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},MDe={readContext:Bc,useCallback:Yse,useContext:Bc,useEffect:JV,useImperativeHandle:qse,useInsertionEffect:Hse,useLayoutEffect:zse,useMemo:Xse,useReducer:U2,useRef:Gse,useState:function(){return U2(b0)},useDebugValue:ZV,useDeferredValue:function(e){var t=$c();return Jse(t,Na.memoizedState,e)},useTransition:function(){var e=U2(b0)[0],t=$c().memoizedState;return[e,t]},useMutableSource:Mse,useSyncExternalStore:Use,useId:Zse,unstable_isNewReconciler:!1},UDe={readContext:Bc,useCallback:Yse,useContext:Bc,useEffect:JV,useImperativeHandle:qse,useInsertionEffect:Hse,useLayoutEffect:zse,useMemo:Xse,useReducer:F2,useRef:Gse,useState:function(){return F2(b0)},useDebugValue:ZV,useDeferredValue:function(e){var t=$c();return Na===null?t.memoizedState=e:Jse(t,Na.memoizedState,e)},useTransition:function(){var e=F2(b0)[0],t=$c().memoizedState;return[e,t]},useMutableSource:Mse,useSyncExternalStore:Use,useId:Zse,unstable_isNewReconciler:!1};function Tl(e,t){if(e&&e.defaultProps){t=ki({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function UM(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:ki({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var r1={isMounted:function(e){return(e=e._reactInternals)?Em(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Ms(),o=hf(e),u=Ad(i,o);u.payload=t,n!=null&&(u.callback=n),t=uf(e,u,o),t!==null&&(Fl(t,e,o,i),SR(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Ms(),o=hf(e),u=Ad(i,o);u.tag=1,u.payload=t,n!=null&&(u.callback=n),t=uf(e,u,o),t!==null&&(Fl(t,e,o,i),SR(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ms(),i=hf(e),o=Ad(n,i);o.tag=2,t!=null&&(o.callback=t),t=uf(e,o,i),t!==null&&(Fl(t,e,i,n),SR(t,e,i))}};function $J(e,t,n,i,o,u,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,h):t.prototype&&t.prototype.isPureReactComponent?!f0(n,i)||!f0(o,u):!0}function noe(e,t,n){var i=!1,o=_f,u=t.contextType;return typeof u=="object"&&u!==null?u=Bc(u):(o=po(t)?nm:ws.current,i=t.contextTypes,u=(i=i!=null)?ty(e,o):_f),t=new t(n,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=r1,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=u),t}function WJ(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&r1.enqueueReplaceState(t,t.state,null)}function FM(e,t,n,i){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},GV(e);var u=t.contextType;typeof u=="object"&&u!==null?o.context=Bc(u):(u=po(t)?nm:ws.current,o.context=ty(e,u)),o.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(UM(e,t,u,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&r1.enqueueReplaceState(o,o.state,null),oN(e,n,o,i),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function ay(e,t){try{var n="",i=t;do n+=hje(i),i=i.return;while(i);var o=n}catch(u){o=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:o,digest:null}}function V2(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function VM(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var FDe=typeof WeakMap=="function"?WeakMap:Map;function roe(e,t,n){n=Ad(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){hN||(hN=!0,XM=i),VM(e,t)},n}function ioe(e,t,n){n=Ad(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var o=t.value;n.payload=function(){return i(o)},n.callback=function(){VM(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(n.callback=function(){VM(e,t),typeof i!="function"&&(df===null?df=new Set([this]):df.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),n}function GJ(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new FDe;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(o.add(n),e=QDe.bind(null,e,t,n),t.then(e,e))}function HJ(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function zJ(e,t,n,i,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ad(-1,1),t.tag=2,uf(n,t,1))),n.lanes|=1),e)}var VDe=qd.ReactCurrentOwner,uo=!1;function ks(e,t,n,i){t.child=e===null?kse(t,null,n,i):ry(t,e.child,n,i)}function KJ(e,t,n,i,o){n=n.render;var u=t.ref;return Lv(t,o),i=YV(e,t,n,i,u,o),n=XV(),e!==null&&!uo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Fd(e,t,o)):(bi&&n&&MV(t),t.flags|=1,ks(e,t,i,o),t.child)}function qJ(e,t,n,i,o){if(e===null){var u=n.type;return typeof u=="function"&&!s4(u)&&u.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=u,aoe(e,t,u,i,o)):(e=AR(n.type,null,i,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!(e.lanes&o)){var h=u.memoizedProps;if(n=n.compare,n=n!==null?n:f0,n(h,i)&&e.ref===t.ref)return Fd(e,t,o)}return t.flags|=1,e=ff(u,i),e.ref=t.ref,e.return=t,t.child=e}function aoe(e,t,n,i,o){if(e!==null){var u=e.memoizedProps;if(f0(u,i)&&e.ref===t.ref)if(uo=!1,t.pendingProps=i=u,(e.lanes&o)!==0)e.flags&131072&&(uo=!0);else return t.lanes=e.lanes,Fd(e,t,o)}return BM(e,t,n,i,o)}function soe(e,t,n){var i=t.pendingProps,o=i.children,u=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ai(Nv,Uo),Uo|=n;else{if(!(n&1073741824))return e=u!==null?u.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ai(Nv,Uo),Uo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=u!==null?u.baseLanes:n,ai(Nv,Uo),Uo|=i}else u!==null?(i=u.baseLanes|n,t.memoizedState=null):i=n,ai(Nv,Uo),Uo|=i;return ks(e,t,o,n),t.child}function ooe(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function BM(e,t,n,i,o){var u=po(n)?nm:ws.current;return u=ty(t,u),Lv(t,o),n=YV(e,t,n,i,u,o),i=XV(),e!==null&&!uo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Fd(e,t,o)):(bi&&i&&MV(t),t.flags|=1,ks(e,t,n,o),t.child)}function YJ(e,t,n,i,o){if(po(n)){var u=!0;nN(t)}else u=!1;if(Lv(t,o),t.stateNode===null)CR(e,t),noe(t,n,i),FM(t,n,i,o),i=!0;else if(e===null){var h=t.stateNode,p=t.memoizedProps;h.props=p;var g=h.context,v=n.contextType;typeof v=="object"&&v!==null?v=Bc(v):(v=po(n)?nm:ws.current,v=ty(t,v));var b=n.getDerivedStateFromProps,E=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";E||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(p!==i||g!==v)&&WJ(t,h,i,v),Bh=!1;var T=t.memoizedState;h.state=T,oN(t,i,h,o),g=t.memoizedState,p!==i||T!==g||fo.current||Bh?(typeof b=="function"&&(UM(t,n,b,i),g=t.memoizedState),(p=Bh||$J(t,n,p,i,T,g,v))?(E||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=g),h.props=i,h.state=g,h.context=v,i=p):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,Dse(e,t),p=t.memoizedProps,v=t.type===t.elementType?p:Tl(t.type,p),h.props=v,E=t.pendingProps,T=h.context,g=n.contextType,typeof g=="object"&&g!==null?g=Bc(g):(g=po(n)?nm:ws.current,g=ty(t,g));var C=n.getDerivedStateFromProps;(b=typeof C=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(p!==E||T!==g)&&WJ(t,h,i,g),Bh=!1,T=t.memoizedState,h.state=T,oN(t,i,h,o);var R=t.memoizedState;p!==E||T!==R||fo.current||Bh?(typeof C=="function"&&(UM(t,n,C,i),R=t.memoizedState),(v=Bh||$J(t,n,v,i,T,R,g)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,R,g),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,R,g)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=R),h.props=i,h.state=R,h.context=g,i=v):(typeof h.componentDidUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),i=!1)}return $M(e,t,n,i,u,o)}function $M(e,t,n,i,o,u){ooe(e,t);var h=(t.flags&128)!==0;if(!i&&!h)return o&&jJ(t,n,!1),Fd(e,t,u);i=t.stateNode,VDe.current=t;var p=h&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&h?(t.child=ry(t,e.child,null,u),t.child=ry(t,null,p,u)):ks(e,t,p,u),t.memoizedState=i.state,o&&jJ(t,n,!0),t.child}function coe(e){var t=e.stateNode;t.pendingContext?kJ(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kJ(e,t.context,!1),HV(e,t.containerInfo)}function XJ(e,t,n,i,o){return ny(),FV(o),t.flags|=256,ks(e,t,n,i),t.child}var WM={dehydrated:null,treeContext:null,retryLane:0};function GM(e){return{baseLanes:e,cachePool:null,transitions:null}}function loe(e,t,n){var i=t.pendingProps,o=Ii.current,u=!1,h=(t.flags&128)!==0,p;if((p=h)||(p=e!==null&&e.memoizedState===null?!1:(o&2)!==0),p?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),ai(Ii,o&1),e===null)return LM(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=i.children,e=i.fallback,u?(i=t.mode,u=t.child,h={mode:"hidden",children:h},!(i&1)&&u!==null?(u.childLanes=0,u.pendingProps=h):u=s1(h,i,0,null),e=Zp(e,i,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=GM(n),t.memoizedState=WM,e):QV(t,h));if(o=e.memoizedState,o!==null&&(p=o.dehydrated,p!==null))return BDe(e,t,h,i,p,o,n);if(u){u=i.fallback,h=t.mode,o=e.child,p=o.sibling;var g={mode:"hidden",children:i.children};return!(h&1)&&t.child!==o?(i=t.child,i.childLanes=0,i.pendingProps=g,t.deletions=null):(i=ff(o,g),i.subtreeFlags=o.subtreeFlags&14680064),p!==null?u=ff(p,u):(u=Zp(u,h,n,null),u.flags|=2),u.return=t,i.return=t,i.sibling=u,t.child=i,i=u,u=t.child,h=e.child.memoizedState,h=h===null?GM(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},u.memoizedState=h,u.childLanes=e.childLanes&~n,t.memoizedState=WM,i}return u=e.child,e=u.sibling,i=ff(u,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function QV(e,t){return t=s1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function SC(e,t,n,i){return i!==null&&FV(i),ry(t,e.child,null,n),e=QV(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function BDe(e,t,n,i,o,u,h){if(n)return t.flags&256?(t.flags&=-257,i=V2(Error(mt(422))),SC(e,t,h,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=i.fallback,o=t.mode,i=s1({mode:"visible",children:i.children},o,0,null),u=Zp(u,o,h,null),u.flags|=2,i.return=t,u.return=t,i.sibling=u,t.child=i,t.mode&1&&ry(t,e.child,null,h),t.child.memoizedState=GM(h),t.memoizedState=WM,u);if(!(t.mode&1))return SC(e,t,h,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var p=i.dgst;return i=p,u=Error(mt(419)),i=V2(u,i,void 0),SC(e,t,h,i)}if(p=(h&e.childLanes)!==0,uo||p){if(i=Ga,i!==null){switch(h&-h){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(i.suspendedLanes|h)?0:o,o!==0&&o!==u.retryLane&&(u.retryLane=o,Ud(e,o),Fl(i,e,o,-1))}return a4(),i=V2(Error(mt(421))),SC(e,t,h,i)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=e2e.bind(null,e),o._reactRetry=t,null):(e=u.treeContext,Go=lf(o.nextSibling),Ho=t,bi=!0,kl=null,e!==null&&(Pc[kc++]=xd,Pc[kc++]=Td,Pc[kc++]=rm,xd=e.id,Td=e.overflow,rm=t),t=QV(t,i.children),t.flags|=4096,t)}function JJ(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),MM(e.return,t,n)}function B2(e,t,n,i,o){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=i,u.tail=n,u.tailMode=o)}function uoe(e,t,n){var i=t.pendingProps,o=i.revealOrder,u=i.tail;if(ks(e,t,i.children,n),i=Ii.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&JJ(e,n,t);else if(e.tag===19)JJ(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(ai(Ii,i),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&cN(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),B2(t,!1,o,n,u);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&cN(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}B2(t,!0,n,null,u);break;case"together":B2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function CR(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fd(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),am|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(mt(153));if(t.child!==null){for(e=t.child,n=ff(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ff(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function $De(e,t,n){switch(t.tag){case 3:coe(t),ny();break;case 5:Lse(t);break;case 1:po(t.type)&&nN(t);break;case 4:HV(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,o=t.memoizedProps.value;ai(aN,i._currentValue),i._currentValue=o;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(ai(Ii,Ii.current&1),t.flags|=128,null):n&t.child.childLanes?loe(e,t,n):(ai(Ii,Ii.current&1),e=Fd(e,t,n),e!==null?e.sibling:null);ai(Ii,Ii.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return uoe(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),ai(Ii,Ii.current),i)break;return null;case 22:case 23:return t.lanes=0,soe(e,t,n)}return Fd(e,t,n)}var doe,HM,hoe,foe;doe=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};HM=function(){};hoe=function(e,t,n,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,Fp(Pu.current);var u=null;switch(n){case"input":o=fM(e,o),i=fM(e,i),u=[];break;case"select":o=ki({},o,{value:void 0}),i=ki({},i,{value:void 0}),u=[];break;case"textarea":o=gM(e,o),i=gM(e,i),u=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=eN)}yM(n,i);var h;n=null;for(v in o)if(!i.hasOwnProperty(v)&&o.hasOwnProperty(v)&&o[v]!=null)if(v==="style"){var p=o[v];for(h in p)p.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(s0.hasOwnProperty(v)?u||(u=[]):(u=u||[]).push(v,null));for(v in i){var g=i[v];if(p=o!=null?o[v]:void 0,i.hasOwnProperty(v)&&g!==p&&(g!=null||p!=null))if(v==="style")if(p){for(h in p)!p.hasOwnProperty(h)||g&&g.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in g)g.hasOwnProperty(h)&&p[h]!==g[h]&&(n||(n={}),n[h]=g[h])}else n||(u||(u=[]),u.push(v,n)),n=g;else v==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,p=p?p.__html:void 0,g!=null&&p!==g&&(u=u||[]).push(v,g)):v==="children"?typeof g!="string"&&typeof g!="number"||(u=u||[]).push(v,""+g):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(s0.hasOwnProperty(v)?(g!=null&&v==="onScroll"&&ui("scroll",e),u||p===g||(u=[])):(u=u||[]).push(v,g))}n&&(u=u||[]).push("style",n);var v=u;(t.updateQueue=v)&&(t.flags|=4)}};foe=function(e,t,n,i){n!==i&&(t.flags|=4)};function rE(e,t){if(!bi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ps(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function WDe(e,t,n){var i=t.pendingProps;switch(UV(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ps(t),null;case 1:return po(t.type)&&tN(),ps(t),null;case 3:return i=t.stateNode,iy(),pi(fo),pi(ws),KV(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(EC(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kl!==null&&(QM(kl),kl=null))),HM(e,t),ps(t),null;case 5:zV(t);var o=Fp(y0.current);if(n=t.type,e!==null&&t.stateNode!=null)hoe(e,t,n,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(mt(166));return ps(t),null}if(e=Fp(Pu.current),EC(t)){i=t.stateNode,n=t.type;var u=t.memoizedProps;switch(i[Cu]=t,i[g0]=u,e=(t.mode&1)!==0,n){case"dialog":ui("cancel",i),ui("close",i);break;case"iframe":case"object":case"embed":ui("load",i);break;case"video":case"audio":for(o=0;o<jE.length;o++)ui(jE[o],i);break;case"source":ui("error",i);break;case"img":case"image":case"link":ui("error",i),ui("load",i);break;case"details":ui("toggle",i);break;case"input":sJ(i,u),ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!u.multiple},ui("invalid",i);break;case"textarea":cJ(i,u),ui("invalid",i)}yM(n,u),o=null;for(var h in u)if(u.hasOwnProperty(h)){var p=u[h];h==="children"?typeof p=="string"?i.textContent!==p&&(u.suppressHydrationWarning!==!0&&bC(i.textContent,p,e),o=["children",p]):typeof p=="number"&&i.textContent!==""+p&&(u.suppressHydrationWarning!==!0&&bC(i.textContent,p,e),o=["children",""+p]):s0.hasOwnProperty(h)&&p!=null&&h==="onScroll"&&ui("scroll",i)}switch(n){case"input":hC(i),oJ(i,u,!0);break;case"textarea":hC(i),lJ(i);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(i.onclick=eN)}i=o,t.updateQueue=i,i!==null&&(t.flags|=4)}else{h=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Bae(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=h.createElement(n,{is:i.is}):(e=h.createElement(n),n==="select"&&(h=e,i.multiple?h.multiple=!0:i.size&&(h.size=i.size))):e=h.createElementNS(e,n),e[Cu]=t,e[g0]=i,doe(e,t,!1,!1),t.stateNode=e;e:{switch(h=_M(n,i),n){case"dialog":ui("cancel",e),ui("close",e),o=i;break;case"iframe":case"object":case"embed":ui("load",e),o=i;break;case"video":case"audio":for(o=0;o<jE.length;o++)ui(jE[o],e);o=i;break;case"source":ui("error",e),o=i;break;case"img":case"image":case"link":ui("error",e),ui("load",e),o=i;break;case"details":ui("toggle",e),o=i;break;case"input":sJ(e,i),o=fM(e,i),ui("invalid",e);break;case"option":o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=ki({},i,{value:void 0}),ui("invalid",e);break;case"textarea":cJ(e,i),o=gM(e,i),ui("invalid",e);break;default:o=i}yM(n,o),p=o;for(u in p)if(p.hasOwnProperty(u)){var g=p[u];u==="style"?Gae(e,g):u==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&$ae(e,g)):u==="children"?typeof g=="string"?(n!=="textarea"||g!=="")&&o0(e,g):typeof g=="number"&&o0(e,""+g):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(s0.hasOwnProperty(u)?g!=null&&u==="onScroll"&&ui("scroll",e):g!=null&&SV(e,u,g,h))}switch(n){case"input":hC(e),oJ(e,i,!1);break;case"textarea":hC(e),lJ(e);break;case"option":i.value!=null&&e.setAttribute("value",""+yf(i.value));break;case"select":e.multiple=!!i.multiple,u=i.value,u!=null?Pv(e,!!i.multiple,u,!1):i.defaultValue!=null&&Pv(e,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=eN)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ps(t),null;case 6:if(e&&t.stateNode!=null)foe(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(mt(166));if(n=Fp(y0.current),Fp(Pu.current),EC(t)){if(i=t.stateNode,n=t.memoizedProps,i[Cu]=t,(u=i.nodeValue!==n)&&(e=Ho,e!==null))switch(e.tag){case 3:bC(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&bC(i.nodeValue,n,(e.mode&1)!==0)}u&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Cu]=t,t.stateNode=i}return ps(t),null;case 13:if(pi(Ii),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(bi&&Go!==null&&t.mode&1&&!(t.flags&128))Ose(),ny(),t.flags|=98560,u=!1;else if(u=EC(t),i!==null&&i.dehydrated!==null){if(e===null){if(!u)throw Error(mt(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(mt(317));u[Cu]=t}else ny(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ps(t),u=!1}else kl!==null&&(QM(kl),kl=null),u=!0;if(!u)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Ii.current&1?Aa===0&&(Aa=3):a4())),t.updateQueue!==null&&(t.flags|=4),ps(t),null);case 4:return iy(),HM(e,t),e===null&&p0(t.stateNode.containerInfo),ps(t),null;case 10:return $V(t.type._context),ps(t),null;case 17:return po(t.type)&&tN(),ps(t),null;case 19:if(pi(Ii),u=t.memoizedState,u===null)return ps(t),null;if(i=(t.flags&128)!==0,h=u.rendering,h===null)if(i)rE(u,!1);else{if(Aa!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=cN(e),h!==null){for(t.flags|=128,rE(u,!1),i=h.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)u=n,e=i,u.flags&=14680066,h=u.alternate,h===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=h.childLanes,u.lanes=h.lanes,u.child=h.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=h.memoizedProps,u.memoizedState=h.memoizedState,u.updateQueue=h.updateQueue,u.type=h.type,e=h.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ai(Ii,Ii.current&1|2),t.child}e=e.sibling}u.tail!==null&&Ji()>sy&&(t.flags|=128,i=!0,rE(u,!1),t.lanes=4194304)}else{if(!i)if(e=cN(h),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),rE(u,!0),u.tail===null&&u.tailMode==="hidden"&&!h.alternate&&!bi)return ps(t),null}else 2*Ji()-u.renderingStartTime>sy&&n!==1073741824&&(t.flags|=128,i=!0,rE(u,!1),t.lanes=4194304);u.isBackwards?(h.sibling=t.child,t.child=h):(n=u.last,n!==null?n.sibling=h:t.child=h,u.last=h)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=Ji(),t.sibling=null,n=Ii.current,ai(Ii,i?n&1|2:n&1),t):(ps(t),null);case 22:case 23:return i4(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Uo&1073741824&&(ps(t),t.subtreeFlags&6&&(t.flags|=8192)):ps(t),null;case 24:return null;case 25:return null}throw Error(mt(156,t.tag))}function GDe(e,t){switch(UV(t),t.tag){case 1:return po(t.type)&&tN(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return iy(),pi(fo),pi(ws),KV(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return zV(t),null;case 13:if(pi(Ii),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(mt(340));ny()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pi(Ii),null;case 4:return iy(),null;case 10:return $V(t.type._context),null;case 22:case 23:return i4(),null;case 24:return null;default:return null}}var xC=!1,_s=!1,HDe=typeof WeakSet=="function"?WeakSet:Set,zt=null;function Rv(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Vi(e,t,i)}else n.current=null}function zM(e,t,n){try{n()}catch(i){Vi(e,t,i)}}var ZJ=!1;function zDe(e,t){if(AM=JR,e=yse(),LV(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{n.nodeType,u.nodeType}catch{n=null;break e}var h=0,p=-1,g=-1,v=0,b=0,E=e,T=null;t:for(;;){for(var C;E!==n||o!==0&&E.nodeType!==3||(p=h+o),E!==u||i!==0&&E.nodeType!==3||(g=h+i),E.nodeType===3&&(h+=E.nodeValue.length),(C=E.firstChild)!==null;)T=E,E=C;for(;;){if(E===e)break t;if(T===n&&++v===o&&(p=h),T===u&&++b===i&&(g=h),(C=E.nextSibling)!==null)break;E=T,T=E.parentNode}E=C}n=p===-1||g===-1?null:{start:p,end:g}}else n=null}n=n||{start:0,end:0}}else n=null;for(IM={focusedElem:e,selectionRange:n},JR=!1,zt=t;zt!==null;)if(t=zt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,zt=e;else for(;zt!==null;){t=zt;try{var R=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var N=R.memoizedProps,O=R.memoizedState,k=t.stateNode,j=k.getSnapshotBeforeUpdate(t.elementType===t.type?N:Tl(t.type,N),O);k.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var P=t.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mt(163))}}catch(M){Vi(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,zt=e;break}zt=t.return}return R=ZJ,ZJ=!1,R}function YE(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var u=o.destroy;o.destroy=void 0,u!==void 0&&zM(t,n,u)}o=o.next}while(o!==i)}}function i1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function KM(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function poe(e){var t=e.alternate;t!==null&&(e.alternate=null,poe(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cu],delete t[g0],delete t[kM],delete t[NDe],delete t[ADe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function moe(e){return e.tag===5||e.tag===3||e.tag===4}function QJ(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||moe(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=eN));else if(i!==4&&(e=e.child,e!==null))for(qM(e,t,n),e=e.sibling;e!==null;)qM(e,t,n),e=e.sibling}function YM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(YM(e,t,n),e=e.sibling;e!==null;)YM(e,t,n),e=e.sibling}var Qa=null,Al=!1;function jh(e,t,n){for(n=n.child;n!==null;)goe(e,t,n),n=n.sibling}function goe(e,t,n){if(Ou&&typeof Ou.onCommitFiberUnmount=="function")try{Ou.onCommitFiberUnmount(XA,n)}catch{}switch(n.tag){case 5:_s||Rv(n,t);case 6:var i=Qa,o=Al;Qa=null,jh(e,t,n),Qa=i,Al=o,Qa!==null&&(Al?(e=Qa,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Qa.removeChild(n.stateNode));break;case 18:Qa!==null&&(Al?(e=Qa,n=n.stateNode,e.nodeType===8?j2(e.parentNode,n):e.nodeType===1&&j2(e,n),d0(e)):j2(Qa,n.stateNode));break;case 4:i=Qa,o=Al,Qa=n.stateNode.containerInfo,Al=!0,jh(e,t,n),Qa=i,Al=o;break;case 0:case 11:case 14:case 15:if(!_s&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var u=o,h=u.destroy;u=u.tag,h!==void 0&&(u&2||u&4)&&zM(n,t,h),o=o.next}while(o!==i)}jh(e,t,n);break;case 1:if(!_s&&(Rv(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(p){Vi(n,t,p)}jh(e,t,n);break;case 21:jh(e,t,n);break;case 22:n.mode&1?(_s=(i=_s)||n.memoizedState!==null,jh(e,t,n),_s=i):jh(e,t,n);break;default:jh(e,t,n)}}function eZ(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new HDe),t.forEach(function(i){var o=t2e.bind(null,e,i);n.has(i)||(n.add(i),i.then(o,o))})}}function gl(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];try{var u=e,h=t,p=h;e:for(;p!==null;){switch(p.tag){case 5:Qa=p.stateNode,Al=!1;break e;case 3:Qa=p.stateNode.containerInfo,Al=!0;break e;case 4:Qa=p.stateNode.containerInfo,Al=!0;break e}p=p.return}if(Qa===null)throw Error(mt(160));goe(u,h,o),Qa=null,Al=!1;var g=o.alternate;g!==null&&(g.return=null),o.return=null}catch(v){Vi(o,t,v)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)voe(t,e),t=t.sibling}function voe(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),gu(e),i&4){try{YE(3,e,e.return),i1(3,e)}catch(N){Vi(e,e.return,N)}try{YE(5,e,e.return)}catch(N){Vi(e,e.return,N)}}break;case 1:gl(t,e),gu(e),i&512&&n!==null&&Rv(n,n.return);break;case 5:if(gl(t,e),gu(e),i&512&&n!==null&&Rv(n,n.return),e.flags&32){var o=e.stateNode;try{o0(o,"")}catch(N){Vi(e,e.return,N)}}if(i&4&&(o=e.stateNode,o!=null)){var u=e.memoizedProps,h=n!==null?n.memoizedProps:u,p=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{p==="input"&&u.type==="radio"&&u.name!=null&&Fae(o,u),_M(p,h);var v=_M(p,u);for(h=0;h<g.length;h+=2){var b=g[h],E=g[h+1];b==="style"?Gae(o,E):b==="dangerouslySetInnerHTML"?$ae(o,E):b==="children"?o0(o,E):SV(o,b,E,v)}switch(p){case"input":pM(o,u);break;case"textarea":Vae(o,u);break;case"select":var T=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!u.multiple;var C=u.value;C!=null?Pv(o,!!u.multiple,C,!1):T!==!!u.multiple&&(u.defaultValue!=null?Pv(o,!!u.multiple,u.defaultValue,!0):Pv(o,!!u.multiple,u.multiple?[]:"",!1))}o[g0]=u}catch(N){Vi(e,e.return,N)}}break;case 6:if(gl(t,e),gu(e),i&4){if(e.stateNode===null)throw Error(mt(162));o=e.stateNode,u=e.memoizedProps;try{o.nodeValue=u}catch(N){Vi(e,e.return,N)}}break;case 3:if(gl(t,e),gu(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{d0(t.containerInfo)}catch(N){Vi(e,e.return,N)}break;case 4:gl(t,e),gu(e);break;case 13:gl(t,e),gu(e),o=e.child,o.flags&8192&&(u=o.memoizedState!==null,o.stateNode.isHidden=u,!u||o.alternate!==null&&o.alternate.memoizedState!==null||(n4=Ji())),i&4&&eZ(e);break;case 22:if(b=n!==null&&n.memoizedState!==null,e.mode&1?(_s=(v=_s)||b,gl(t,e),_s=v):gl(t,e),gu(e),i&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!b&&e.mode&1)for(zt=e,b=e.child;b!==null;){for(E=zt=b;zt!==null;){switch(T=zt,C=T.child,T.tag){case 0:case 11:case 14:case 15:YE(4,T,T.return);break;case 1:Rv(T,T.return);var R=T.stateNode;if(typeof R.componentWillUnmount=="function"){i=T,n=T.return;try{t=i,R.props=t.memoizedProps,R.state=t.memoizedState,R.componentWillUnmount()}catch(N){Vi(i,n,N)}}break;case 5:Rv(T,T.return);break;case 22:if(T.memoizedState!==null){nZ(E);continue}}C!==null?(C.return=T,zt=C):nZ(E)}b=b.sibling}e:for(b=null,E=e;;){if(E.tag===5){if(b===null){b=E;try{o=E.stateNode,v?(u=o.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(p=E.stateNode,g=E.memoizedProps.style,h=g!=null&&g.hasOwnProperty("display")?g.display:null,p.style.display=Wae("display",h))}catch(N){Vi(e,e.return,N)}}}else if(E.tag===6){if(b===null)try{E.stateNode.nodeValue=v?"":E.memoizedProps}catch(N){Vi(e,e.return,N)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;b===E&&(b=null),E=E.return}b===E&&(b=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:gl(t,e),gu(e),i&4&&eZ(e);break;case 21:break;default:gl(t,e),gu(e)}}function gu(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(moe(n)){var i=n;break e}n=n.return}throw Error(mt(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(o0(o,""),i.flags&=-33);var u=QJ(e);YM(e,u,o);break;case 3:case 4:var h=i.stateNode.containerInfo,p=QJ(e);qM(e,p,h);break;default:throw Error(mt(161))}}catch(g){Vi(e,e.return,g)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function KDe(e,t,n){zt=e,yoe(e)}function yoe(e,t,n){for(var i=(e.mode&1)!==0;zt!==null;){var o=zt,u=o.child;if(o.tag===22&&i){var h=o.memoizedState!==null||xC;if(!h){var p=o.alternate,g=p!==null&&p.memoizedState!==null||_s;p=xC;var v=_s;if(xC=h,(_s=g)&&!v)for(zt=o;zt!==null;)h=zt,g=h.child,h.tag===22&&h.memoizedState!==null?rZ(o):g!==null?(g.return=h,zt=g):rZ(o);for(;u!==null;)zt=u,yoe(u),u=u.sibling;zt=o,xC=p,_s=v}tZ(e)}else o.subtreeFlags&8772&&u!==null?(u.return=o,zt=u):tZ(e)}}function tZ(e){for(;zt!==null;){var t=zt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_s||i1(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!_s)if(n===null)i.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Tl(t.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&FJ(t,u,i);break;case 3:var h=t.updateQueue;if(h!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}FJ(t,h,n)}break;case 5:var p=t.stateNode;if(n===null&&t.flags&4){n=p;var g=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&n.focus();break;case"img":g.src&&(n.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var v=t.alternate;if(v!==null){var b=v.memoizedState;if(b!==null){var E=b.dehydrated;E!==null&&d0(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mt(163))}_s||t.flags&512&&KM(t)}catch(T){Vi(t,t.return,T)}}if(t===e){zt=null;break}if(n=t.sibling,n!==null){n.return=t.return,zt=n;break}zt=t.return}}function nZ(e){for(;zt!==null;){var t=zt;if(t===e){zt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,zt=n;break}zt=t.return}}function rZ(e){for(;zt!==null;){var t=zt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{i1(4,t)}catch(g){Vi(t,n,g)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var o=t.return;try{i.componentDidMount()}catch(g){Vi(t,o,g)}}var u=t.return;try{KM(t)}catch(g){Vi(t,u,g)}break;case 5:var h=t.return;try{KM(t)}catch(g){Vi(t,h,g)}}}catch(g){Vi(t,t.return,g)}if(t===e){zt=null;break}var p=t.sibling;if(p!==null){p.return=t.return,zt=p;break}zt=t.return}}var qDe=Math.ceil,dN=qd.ReactCurrentDispatcher,e4=qd.ReactCurrentOwner,Uc=qd.ReactCurrentBatchConfig,pr=0,Ga=null,fa=null,ns=0,Uo=0,Nv=Af(0),Aa=0,w0=null,am=0,a1=0,t4=0,XE=null,lo=null,n4=0,sy=1/0,bd=null,hN=!1,XM=null,df=null,TC=!1,ef=null,fN=0,JE=0,JM=null,RR=-1,NR=0;function Ms(){return pr&6?Ji():RR!==-1?RR:RR=Ji()}function hf(e){return e.mode&1?pr&2&&ns!==0?ns&-ns:ODe.transition!==null?(NR===0&&(NR=nse()),NR):(e=Br,e!==0||(e=window.event,e=e===void 0?16:lse(e.type)),e):1}function Fl(e,t,n,i){if(50<JE)throw JE=0,JM=null,Error(mt(185));Nw(e,n,i),(!(pr&2)||e!==Ga)&&(e===Ga&&(!(pr&2)&&(a1|=n),Aa===4&&Hh(e,ns)),mo(e,i),n===1&&pr===0&&!(t.mode&1)&&(sy=Ji()+500,t1&&If()))}function mo(e,t){var n=e.callbackNode;Oje(e,t);var i=XR(e,e===Ga?ns:0);if(i===0)n!==null&&hJ(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&hJ(n),t===1)e.tag===0?IDe(iZ.bind(null,e)):Nse(iZ.bind(null,e)),CDe(function(){!(pr&6)&&If()}),n=null;else{switch(rse(i)){case 1:n=NV;break;case 4:n=ese;break;case 16:n=YR;break;case 536870912:n=tse;break;default:n=YR}n=Coe(n,_oe.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function _oe(e,t){if(RR=-1,NR=0,pr&6)throw Error(mt(327));var n=e.callbackNode;if(Mv()&&e.callbackNode!==n)return null;var i=XR(e,e===Ga?ns:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=pN(e,i);else{t=i;var o=pr;pr|=2;var u=Eoe();(Ga!==e||ns!==t)&&(bd=null,sy=Ji()+500,Jp(e,t));do try{JDe();break}catch(p){boe(e,p)}while(!0);BV(),dN.current=u,pr=o,fa!==null?t=0:(Ga=null,ns=0,t=Aa)}if(t!==0){if(t===2&&(o=xM(e),o!==0&&(i=o,t=ZM(e,o))),t===1)throw n=w0,Jp(e,0),Hh(e,i),mo(e,Ji()),n;if(t===6)Hh(e,i);else{if(o=e.current.alternate,!(i&30)&&!YDe(o)&&(t=pN(e,i),t===2&&(u=xM(e),u!==0&&(i=u,t=ZM(e,u))),t===1))throw n=w0,Jp(e,0),Hh(e,i),mo(e,Ji()),n;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(mt(345));case 2:Op(e,lo,bd);break;case 3:if(Hh(e,i),(i&130023424)===i&&(t=n4+500-Ji(),10<t)){if(XR(e,0)!==0)break;if(o=e.suspendedLanes,(o&i)!==i){Ms(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=PM(Op.bind(null,e,lo,bd),t);break}Op(e,lo,bd);break;case 4:if(Hh(e,i),(i&4194240)===i)break;for(t=e.eventTimes,o=-1;0<i;){var h=31-Ul(i);u=1<<h,h=t[h],h>o&&(o=h),i&=~u}if(i=o,i=Ji()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*qDe(i/1960))-i,10<i){e.timeoutHandle=PM(Op.bind(null,e,lo,bd),i);break}Op(e,lo,bd);break;case 5:Op(e,lo,bd);break;default:throw Error(mt(329))}}}return mo(e,Ji()),e.callbackNode===n?_oe.bind(null,e):null}function ZM(e,t){var n=XE;return e.current.memoizedState.isDehydrated&&(Jp(e,t).flags|=256),e=pN(e,t),e!==2&&(t=lo,lo=n,t!==null&&QM(t)),e}function QM(e){lo===null?lo=e:lo.push.apply(lo,e)}function YDe(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var o=n[i],u=o.getSnapshot;o=o.value;try{if(!$l(u(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hh(e,t){for(t&=~t4,t&=~a1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ul(t),i=1<<n;e[n]=-1,t&=~i}}function iZ(e){if(pr&6)throw Error(mt(327));Mv();var t=XR(e,0);if(!(t&1))return mo(e,Ji()),null;var n=pN(e,t);if(e.tag!==0&&n===2){var i=xM(e);i!==0&&(t=i,n=ZM(e,i))}if(n===1)throw n=w0,Jp(e,0),Hh(e,t),mo(e,Ji()),n;if(n===6)throw Error(mt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Op(e,lo,bd),mo(e,Ji()),null}function r4(e,t){var n=pr;pr|=1;try{return e(t)}finally{pr=n,pr===0&&(sy=Ji()+500,t1&&If())}}function sm(e){ef!==null&&ef.tag===0&&!(pr&6)&&Mv();var t=pr;pr|=1;var n=Uc.transition,i=Br;try{if(Uc.transition=null,Br=1,e)return e()}finally{Br=i,Uc.transition=n,pr=t,!(pr&6)&&If()}}function i4(){Uo=Nv.current,pi(Nv)}function Jp(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,TDe(n)),fa!==null)for(n=fa.return;n!==null;){var i=n;switch(UV(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&tN();break;case 3:iy(),pi(fo),pi(ws),KV();break;case 5:zV(i);break;case 4:iy();break;case 13:pi(Ii);break;case 19:pi(Ii);break;case 10:$V(i.type._context);break;case 22:case 23:i4()}n=n.return}if(Ga=e,fa=e=ff(e.current,null),ns=Uo=t,Aa=0,w0=null,t4=a1=am=0,lo=XE=null,Up!==null){for(t=0;t<Up.length;t++)if(n=Up[t],i=n.interleaved,i!==null){n.interleaved=null;var o=i.next,u=n.pending;if(u!==null){var h=u.next;u.next=o,i.next=h}n.pending=i}Up=null}return e}function boe(e,t){do{var n=fa;try{if(BV(),xR.current=uN,lN){for(var i=Pi.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}lN=!1}if(im=0,Va=Na=Pi=null,qE=!1,_0=0,e4.current=null,n===null||n.return===null){Aa=1,w0=t,fa=null;break}e:{var u=e,h=n.return,p=n,g=t;if(t=ns,p.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var v=g,b=p,E=b.tag;if(!(b.mode&1)&&(E===0||E===11||E===15)){var T=b.alternate;T?(b.updateQueue=T.updateQueue,b.memoizedState=T.memoizedState,b.lanes=T.lanes):(b.updateQueue=null,b.memoizedState=null)}var C=HJ(h);if(C!==null){C.flags&=-257,zJ(C,h,p,u,t),C.mode&1&&GJ(u,v,t),t=C,g=v;var R=t.updateQueue;if(R===null){var N=new Set;N.add(g),t.updateQueue=N}else R.add(g);break e}else{if(!(t&1)){GJ(u,v,t),a4();break e}g=Error(mt(426))}}else if(bi&&p.mode&1){var O=HJ(h);if(O!==null){!(O.flags&65536)&&(O.flags|=256),zJ(O,h,p,u,t),FV(ay(g,p));break e}}u=g=ay(g,p),Aa!==4&&(Aa=2),XE===null?XE=[u]:XE.push(u),u=h;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var k=roe(u,g,t);UJ(u,k);break e;case 1:p=g;var j=u.type,P=u.stateNode;if(!(u.flags&128)&&(typeof j.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(df===null||!df.has(P)))){u.flags|=65536,t&=-t,u.lanes|=t;var M=ioe(u,p,t);UJ(u,M);break e}}u=u.return}while(u!==null)}Soe(n)}catch(D){t=D,fa===n&&n!==null&&(fa=n=n.return);continue}break}while(!0)}function Eoe(){var e=dN.current;return dN.current=uN,e===null?uN:e}function a4(){(Aa===0||Aa===3||Aa===2)&&(Aa=4),Ga===null||!(am&268435455)&&!(a1&268435455)||Hh(Ga,ns)}function pN(e,t){var n=pr;pr|=2;var i=Eoe();(Ga!==e||ns!==t)&&(bd=null,Jp(e,t));do try{XDe();break}catch(o){boe(e,o)}while(!0);if(BV(),pr=n,dN.current=i,fa!==null)throw Error(mt(261));return Ga=null,ns=0,Aa}function XDe(){for(;fa!==null;)woe(fa)}function JDe(){for(;fa!==null&&!wje();)woe(fa)}function woe(e){var t=Toe(e.alternate,e,Uo);e.memoizedProps=e.pendingProps,t===null?Soe(e):fa=t,e4.current=null}function Soe(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=GDe(n,t),n!==null){n.flags&=32767,fa=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Aa=6,fa=null;return}}else if(n=WDe(n,t,Uo),n!==null){fa=n;return}if(t=t.sibling,t!==null){fa=t;return}fa=t=e}while(t!==null);Aa===0&&(Aa=5)}function Op(e,t,n){var i=Br,o=Uc.transition;try{Uc.transition=null,Br=1,ZDe(e,t,n,i)}finally{Uc.transition=o,Br=i}return null}function ZDe(e,t,n,i){do Mv();while(ef!==null);if(pr&6)throw Error(mt(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(mt(177));e.callbackNode=null,e.callbackPriority=0;var u=n.lanes|n.childLanes;if(Pje(e,u),e===Ga&&(fa=Ga=null,ns=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||TC||(TC=!0,Coe(YR,function(){return Mv(),null})),u=(n.flags&15990)!==0,n.subtreeFlags&15990||u){u=Uc.transition,Uc.transition=null;var h=Br;Br=1;var p=pr;pr|=4,e4.current=null,zDe(e,n),voe(n,e),yDe(IM),JR=!!AM,IM=AM=null,e.current=n,KDe(n),Sje(),pr=p,Br=h,Uc.transition=u}else e.current=n;if(TC&&(TC=!1,ef=e,fN=o),u=e.pendingLanes,u===0&&(df=null),Cje(n.stateNode),mo(e,Ji()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],i(o.value,{componentStack:o.stack,digest:o.digest});if(hN)throw hN=!1,e=XM,XM=null,e;return fN&1&&e.tag!==0&&Mv(),u=e.pendingLanes,u&1?e===JM?JE++:(JE=0,JM=e):JE=0,If(),null}function Mv(){if(ef!==null){var e=rse(fN),t=Uc.transition,n=Br;try{if(Uc.transition=null,Br=16>e?16:e,ef===null)var i=!1;else{if(e=ef,ef=null,fN=0,pr&6)throw Error(mt(331));var o=pr;for(pr|=4,zt=e.current;zt!==null;){var u=zt,h=u.child;if(zt.flags&16){var p=u.deletions;if(p!==null){for(var g=0;g<p.length;g++){var v=p[g];for(zt=v;zt!==null;){var b=zt;switch(b.tag){case 0:case 11:case 15:YE(8,b,u)}var E=b.child;if(E!==null)E.return=b,zt=E;else for(;zt!==null;){b=zt;var T=b.sibling,C=b.return;if(poe(b),b===v){zt=null;break}if(T!==null){T.return=C,zt=T;break}zt=C}}}var R=u.alternate;if(R!==null){var N=R.child;if(N!==null){R.child=null;do{var O=N.sibling;N.sibling=null,N=O}while(N!==null)}}zt=u}}if(u.subtreeFlags&2064&&h!==null)h.return=u,zt=h;else e:for(;zt!==null;){if(u=zt,u.flags&2048)switch(u.tag){case 0:case 11:case 15:YE(9,u,u.return)}var k=u.sibling;if(k!==null){k.return=u.return,zt=k;break e}zt=u.return}}var j=e.current;for(zt=j;zt!==null;){h=zt;var P=h.child;if(h.subtreeFlags&2064&&P!==null)P.return=h,zt=P;else e:for(h=j;zt!==null;){if(p=zt,p.flags&2048)try{switch(p.tag){case 0:case 11:case 15:i1(9,p)}}catch(D){Vi(p,p.return,D)}if(p===h){zt=null;break e}var M=p.sibling;if(M!==null){M.return=p.return,zt=M;break e}zt=p.return}}if(pr=o,If(),Ou&&typeof Ou.onPostCommitFiberRoot=="function")try{Ou.onPostCommitFiberRoot(XA,e)}catch{}i=!0}return i}finally{Br=n,Uc.transition=t}}return!1}function aZ(e,t,n){t=ay(n,t),t=roe(e,t,1),e=uf(e,t,1),t=Ms(),e!==null&&(Nw(e,1,t),mo(e,t))}function Vi(e,t,n){if(e.tag===3)aZ(e,e,n);else for(;t!==null;){if(t.tag===3){aZ(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(df===null||!df.has(i))){e=ay(n,e),e=ioe(t,e,1),t=uf(t,e,1),e=Ms(),t!==null&&(Nw(t,1,e),mo(t,e));break}}t=t.return}}function QDe(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=Ms(),e.pingedLanes|=e.suspendedLanes&n,Ga===e&&(ns&n)===n&&(Aa===4||Aa===3&&(ns&130023424)===ns&&500>Ji()-n4?Jp(e,0):t4|=n),mo(e,t)}function xoe(e,t){t===0&&(e.mode&1?(t=mC,mC<<=1,!(mC&130023424)&&(mC=4194304)):t=1);var n=Ms();e=Ud(e,t),e!==null&&(Nw(e,t,n),mo(e,n))}function e2e(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),xoe(e,n)}function t2e(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(mt(314))}i!==null&&i.delete(t),xoe(e,n)}var Toe;Toe=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||fo.current)uo=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return uo=!1,$De(e,t,n);uo=!!(e.flags&131072)}else uo=!1,bi&&t.flags&1048576&&Ase(t,iN,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;CR(e,t),e=t.pendingProps;var o=ty(t,ws.current);Lv(t,n),o=YV(null,t,i,e,o,n);var u=XV();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,po(i)?(u=!0,nN(t)):u=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,GV(t),o.updater=r1,t.stateNode=o,o._reactInternals=t,FM(t,i,e,n),t=$M(null,t,i,!0,u,n)):(t.tag=0,bi&&u&&MV(t),ks(null,t,o,n),t=t.child),t;case 16:i=t.elementType;e:{switch(CR(e,t),e=t.pendingProps,o=i._init,i=o(i._payload),t.type=i,o=t.tag=r2e(i),e=Tl(i,e),o){case 0:t=BM(null,t,i,e,n);break e;case 1:t=YJ(null,t,i,e,n);break e;case 11:t=KJ(null,t,i,e,n);break e;case 14:t=qJ(null,t,i,Tl(i.type,e),n);break e}throw Error(mt(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Tl(i,o),BM(e,t,i,o,n);case 1:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Tl(i,o),YJ(e,t,i,o,n);case 3:e:{if(coe(t),e===null)throw Error(mt(387));i=t.pendingProps,u=t.memoizedState,o=u.element,Dse(e,t),oN(t,i,null,n);var h=t.memoizedState;if(i=h.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){o=ay(Error(mt(423)),t),t=XJ(e,t,i,n,o);break e}else if(i!==o){o=ay(Error(mt(424)),t),t=XJ(e,t,i,n,o);break e}else for(Go=lf(t.stateNode.containerInfo.firstChild),Ho=t,bi=!0,kl=null,n=kse(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ny(),i===o){t=Fd(e,t,n);break e}ks(e,t,i,n)}t=t.child}return t;case 5:return Lse(t),e===null&&LM(t),i=t.type,o=t.pendingProps,u=e!==null?e.memoizedProps:null,h=o.children,OM(i,o)?h=null:u!==null&&OM(i,u)&&(t.flags|=32),ooe(e,t),ks(e,t,h,n),t.child;case 6:return e===null&&LM(t),null;case 13:return loe(e,t,n);case 4:return HV(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=ry(t,null,i,n):ks(e,t,i,n),t.child;case 11:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Tl(i,o),KJ(e,t,i,o,n);case 7:return ks(e,t,t.pendingProps,n),t.child;case 8:return ks(e,t,t.pendingProps.children,n),t.child;case 12:return ks(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,u=t.memoizedProps,h=o.value,ai(aN,i._currentValue),i._currentValue=h,u!==null)if($l(u.value,h)){if(u.children===o.children&&!fo.current){t=Fd(e,t,n);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var p=u.dependencies;if(p!==null){h=u.child;for(var g=p.firstContext;g!==null;){if(g.context===i){if(u.tag===1){g=Ad(-1,n&-n),g.tag=2;var v=u.updateQueue;if(v!==null){v=v.shared;var b=v.pending;b===null?g.next=g:(g.next=b.next,b.next=g),v.pending=g}}u.lanes|=n,g=u.alternate,g!==null&&(g.lanes|=n),MM(u.return,n,t),p.lanes|=n;break}g=g.next}}else if(u.tag===10)h=u.type===t.type?null:u.child;else if(u.tag===18){if(h=u.return,h===null)throw Error(mt(341));h.lanes|=n,p=h.alternate,p!==null&&(p.lanes|=n),MM(h,n,t),h=u.sibling}else h=u.child;if(h!==null)h.return=u;else for(h=u;h!==null;){if(h===t){h=null;break}if(u=h.sibling,u!==null){u.return=h.return,h=u;break}h=h.return}u=h}ks(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,Lv(t,n),o=Bc(o),i=i(o),t.flags|=1,ks(e,t,i,n),t.child;case 14:return i=t.type,o=Tl(i,t.pendingProps),o=Tl(i.type,o),qJ(e,t,i,o,n);case 15:return aoe(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Tl(i,o),CR(e,t),t.tag=1,po(i)?(e=!0,nN(t)):e=!1,Lv(t,n),noe(t,i,o),FM(t,i,o,n),$M(null,t,i,!0,e,n);case 19:return uoe(e,t,n);case 22:return soe(e,t,n)}throw Error(mt(156,t.tag))};function Coe(e,t){return Qae(e,t)}function n2e(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lc(e,t,n,i){return new n2e(e,t,n,i)}function s4(e){return e=e.prototype,!(!e||!e.isReactComponent)}function r2e(e){if(typeof e=="function")return s4(e)?1:0;if(e!=null){if(e=e.$$typeof,e===TV)return 11;if(e===CV)return 14}return 2}function ff(e,t){var n=e.alternate;return n===null?(n=Lc(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function AR(e,t,n,i,o,u){var h=2;if(i=e,typeof e=="function")s4(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case yv:return Zp(n.children,o,u,t);case xV:h=8,o|=8;break;case lM:return e=Lc(12,n,t,o|2),e.elementType=lM,e.lanes=u,e;case uM:return e=Lc(13,n,t,o),e.elementType=uM,e.lanes=u,e;case dM:return e=Lc(19,n,t,o),e.elementType=dM,e.lanes=u,e;case Lae:return s1(n,o,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jae:h=10;break e;case Dae:h=9;break e;case TV:h=11;break e;case CV:h=14;break e;case Vh:h=16,i=null;break e}throw Error(mt(130,e==null?e:typeof e,""))}return t=Lc(h,n,t,o),t.elementType=e,t.type=i,t.lanes=u,t}function Zp(e,t,n,i){return e=Lc(7,e,i,t),e.lanes=n,e}function s1(e,t,n,i){return e=Lc(22,e,i,t),e.elementType=Lae,e.lanes=n,e.stateNode={isHidden:!1},e}function $2(e,t,n){return e=Lc(6,e,null,t),e.lanes=n,e}function W2(e,t,n){return t=Lc(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function i2e(e,t,n,i,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S2(0),this.expirationTimes=S2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S2(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function o4(e,t,n,i,o,u,h,p,g){return e=new i2e(e,t,n,p,g),t===1?(t=1,u===!0&&(t|=8)):t=0,u=Lc(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},GV(u),e}function a2e(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vv,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function Roe(e){if(!e)return _f;e=e._reactInternals;e:{if(Em(e)!==e||e.tag!==1)throw Error(mt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(po(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(mt(171))}if(e.tag===1){var n=e.type;if(po(n))return Rse(e,n,t)}return t}function Noe(e,t,n,i,o,u,h,p,g){return e=o4(n,i,!0,e,o,u,h,p,g),e.context=Roe(null),n=e.current,i=Ms(),o=hf(n),u=Ad(i,o),u.callback=t??null,uf(n,u,o),e.current.lanes=o,Nw(e,o,i),mo(e,i),e}function o1(e,t,n,i){var o=t.current,u=Ms(),h=hf(o);return n=Roe(n),t.context===null?t.context=n:t.pendingContext=n,t=Ad(u,h),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=uf(o,t,h),e!==null&&(Fl(e,o,h,u),SR(e,o,h)),h}function mN(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sZ(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function c4(e,t){sZ(e,t),(e=e.alternate)&&sZ(e,t)}function s2e(){return null}var Aoe=typeof reportError=="function"?reportError:function(e){console.error(e)};function l4(e){this._internalRoot=e}c1.prototype.render=l4.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(mt(409));o1(e,t,null,null)};c1.prototype.unmount=l4.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sm(function(){o1(null,e,null,null)}),t[Md]=null}};function c1(e){this._internalRoot=e}c1.prototype.unstable_scheduleHydration=function(e){if(e){var t=sse();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Gh.length&&t!==0&&t<Gh[n].priority;n++);Gh.splice(n,0,e),n===0&&cse(e)}};function u4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function oZ(){}function o2e(e,t,n,i,o){if(o){if(typeof i=="function"){var u=i;i=function(){var v=mN(h);u.call(v)}}var h=Noe(t,i,e,0,null,!1,!1,"",oZ);return e._reactRootContainer=h,e[Md]=h.current,p0(e.nodeType===8?e.parentNode:e),sm(),h}for(;o=e.lastChild;)e.removeChild(o);if(typeof i=="function"){var p=i;i=function(){var v=mN(g);p.call(v)}}var g=o4(e,0,!1,null,null,!1,!1,"",oZ);return e._reactRootContainer=g,e[Md]=g.current,p0(e.nodeType===8?e.parentNode:e),sm(function(){o1(t,g,n,i)}),g}function u1(e,t,n,i,o){var u=n._reactRootContainer;if(u){var h=u;if(typeof o=="function"){var p=o;o=function(){var g=mN(h);p.call(g)}}o1(t,h,e,o)}else h=o2e(n,t,e,o,i);return mN(h)}ise=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=kE(t.pendingLanes);n!==0&&(AV(t,n|1),mo(t,Ji()),!(pr&6)&&(sy=Ji()+500,If()))}break;case 13:sm(function(){var i=Ud(e,1);if(i!==null){var o=Ms();Fl(i,e,1,o)}}),c4(e,1)}};IV=function(e){if(e.tag===13){var t=Ud(e,134217728);if(t!==null){var n=Ms();Fl(t,e,134217728,n)}c4(e,134217728)}};ase=function(e){if(e.tag===13){var t=hf(e),n=Ud(e,t);if(n!==null){var i=Ms();Fl(n,e,t,i)}c4(e,t)}};sse=function(){return Br};ose=function(e,t){var n=Br;try{return Br=e,t()}finally{Br=n}};EM=function(e,t,n){switch(t){case"input":if(pM(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var o=e1(i);if(!o)throw Error(mt(90));Uae(i),pM(i,o)}}}break;case"textarea":Vae(e,n);break;case"select":t=n.value,t!=null&&Pv(e,!!n.multiple,t,!1)}};Kae=r4;qae=sm;var c2e={usingClientEntryPoint:!1,Events:[Iw,wv,e1,Hae,zae,r4]},iE={findFiberByHostInstance:Mp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},l2e={bundleType:iE.bundleType,version:iE.version,rendererPackageName:iE.rendererPackageName,rendererConfig:iE.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Jae(e),e===null?null:e.stateNode},findFiberByHostInstance:iE.findFiberByHostInstance||s2e,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var CC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!CC.isDisabled&&CC.supportsFiber)try{XA=CC.inject(l2e),Ou=CC}catch{}}Qo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c2e;Qo.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u4(t))throw Error(mt(200));return a2e(e,t,null,n)};Qo.createRoot=function(e,t){if(!u4(e))throw Error(mt(299));var n=!1,i="",o=Aoe;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=o4(e,1,!1,null,null,n,!1,i,o),e[Md]=t.current,p0(e.nodeType===8?e.parentNode:e),new l4(t)};Qo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(mt(188)):(e=Object.keys(e).join(","),Error(mt(268,e)));return e=Jae(t),e=e===null?null:e.stateNode,e};Qo.flushSync=function(e){return sm(e)};Qo.hydrate=function(e,t,n){if(!l1(t))throw Error(mt(200));return u1(null,e,t,!0,n)};Qo.hydrateRoot=function(e,t,n){if(!u4(e))throw Error(mt(405));var i=n!=null&&n.hydratedSources||null,o=!1,u="",h=Aoe;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),t=Noe(t,null,e,1,n??null,o,!1,u,h),e[Md]=t.current,p0(e),i)for(e=0;e<i.length;e++)n=i[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new c1(t)};Qo.render=function(e,t,n){if(!l1(t))throw Error(mt(200));return u1(null,e,t,!1,n)};Qo.unmountComponentAtNode=function(e){if(!l1(e))throw Error(mt(40));return e._reactRootContainer?(sm(function(){u1(null,null,e,!1,function(){e._reactRootContainer=null,e[Md]=null})}),!0):!1};Qo.unstable_batchedUpdates=r4;Qo.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!l1(n))throw Error(mt(200));if(e==null||e._reactInternals===void 0)throw Error(mt(38));return u1(e,t,n,!1,i)};Qo.version="18.3.1-next-f1338f8080-20240426";function Ioe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ioe)}catch(e){console.error(e)}}Ioe(),Iae.exports=Qo;var wm=Iae.exports;const Ooe=jr(wm);var Poe,cZ=wm;Poe=cZ.createRoot,cZ.hydrateRoot;var u2e=e=>{switch(e){case"success":return f2e;case"info":return m2e;case"warning":return p2e;case"error":return g2e;default:return null}},d2e=Array(12).fill(0),h2e=({visible:e,className:t})=>me.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},me.createElement("div",{className:"sonner-spinner"},d2e.map((n,i)=>me.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),f2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),p2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),m2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),g2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),v2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},me.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),me.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),y2e=()=>{let[e,t]=me.useState(document.hidden);return me.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},eU=1,_2e=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...i}=e,o=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:eU++,u=this.toasts.find(p=>p.id===o),h=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),u?this.toasts=this.toasts.map(p=>p.id===o?(this.publish({...p,...e,id:o,title:n}),{...p,...e,id:o,dismissible:h,title:n}):p):this.addToast({title:n,...i,dismissible:h,id:o}),o},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let i=e instanceof Promise?e:e(),o=n!==void 0,u,h=i.then(async g=>{if(u=["resolve",g],me.isValidElement(g))o=!1,this.create({id:n,type:"default",message:g});else if(E2e(g)&&!g.ok){o=!1;let v=typeof t.error=="function"?await t.error(`HTTP error! status: ${g.status}`):t.error,b=typeof t.description=="function"?await t.description(`HTTP error! status: ${g.status}`):t.description;this.create({id:n,type:"error",message:v,description:b})}else if(t.success!==void 0){o=!1;let v=typeof t.success=="function"?await t.success(g):t.success,b=typeof t.description=="function"?await t.description(g):t.description;this.create({id:n,type:"success",message:v,description:b})}}).catch(async g=>{if(u=["reject",g],t.error!==void 0){o=!1;let v=typeof t.error=="function"?await t.error(g):t.error,b=typeof t.description=="function"?await t.description(g):t.description;this.create({id:n,type:"error",message:v,description:b})}}).finally(()=>{var g;o&&(this.dismiss(n),n=void 0),(g=t.finally)==null||g.call(t)}),p=()=>new Promise((g,v)=>h.then(()=>u[0]==="reject"?v(u[1]):g(u[1])).catch(v));return typeof n!="string"&&typeof n!="number"?{unwrap:p}:Object.assign(n,{unwrap:p})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||eU++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},co=new _2e,b2e=(e,t)=>{let n=(t==null?void 0:t.id)||eU++;return co.addToast({title:e,...t,id:n}),n},E2e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",w2e=b2e,S2e=()=>co.toasts,x2e=()=>co.getActiveToasts(),Ce=Object.assign(w2e,{success:co.success,info:co.info,warning:co.warning,error:co.error,custom:co.custom,message:co.message,promise:co.promise,dismiss:co.dismiss,loading:co.loading},{getHistory:S2e,getToasts:x2e});function T2e(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}T2e(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function RC(e){return e.label!==void 0}var C2e=3,R2e="32px",N2e="16px",lZ=4e3,A2e=356,I2e=14,O2e=20,P2e=200;function vl(...e){return e.filter(Boolean).join(" ")}function k2e(e){let[t,n]=e.split("-"),i=[];return t&&i.push(t),n&&i.push(n),i}var j2e=e=>{var t,n,i,o,u,h,p,g,v,b,E;let{invert:T,toast:C,unstyled:R,interacting:N,setHeights:O,visibleToasts:k,heights:j,index:P,toasts:M,expanded:D,removeToast:U,defaultRichColors:V,closeButton:z,style:W,cancelButtonStyle:Y,actionButtonStyle:Q,className:K="",descriptionClassName:q="",duration:ee,position:oe,gap:ae,loadingIcon:J,expandByDefault:re,classNames:X,icons:de,closeButtonAriaLabel:we="Close toast",pauseWhenPageIsHidden:ge}=e,[Te,Pe]=me.useState(null),[rt,dt]=me.useState(null),[ze,vt]=me.useState(!1),[Be,ot]=me.useState(!1),[De,je]=me.useState(!1),[Mt,Ut]=me.useState(!1),[fn,ht]=me.useState(!1),[St,At]=me.useState(0),[it,ve]=me.useState(0),Ie=me.useRef(C.duration||ee||lZ),$e=me.useRef(null),gt=me.useRef(null),at=P===0,pt=P+1<=k,Ft=C.type,vn=C.dismissible!==!1,cr=C.className||"",ra=C.descriptionClassName||"",Gs=me.useMemo(()=>j.findIndex(Sn=>Sn.toastId===C.id)||0,[j,C.id]),xs=me.useMemo(()=>{var Sn;return(Sn=C.closeButton)!=null?Sn:z},[C.closeButton,z]),Ju=me.useMemo(()=>C.duration||ee||lZ,[C.duration,ee]),rc=me.useRef(0),ia=me.useRef(0),Yc=me.useRef(0),Hs=me.useRef(null),[eh,lt]=oe.split("-"),Gt=me.useMemo(()=>j.reduce((Sn,nr,ei)=>ei>=Gs?Sn:Sn+nr.height,0),[j,Gs]),Yn=y2e(),gi=C.invert||T,zs=Ft==="loading";ia.current=me.useMemo(()=>Gs*ae+Gt,[Gs,Gt]),me.useEffect(()=>{Ie.current=Ju},[Ju]),me.useEffect(()=>{vt(!0)},[]),me.useEffect(()=>{let Sn=gt.current;if(Sn){let nr=Sn.getBoundingClientRect().height;return ve(nr),O(ei=>[{toastId:C.id,height:nr,position:C.position},...ei]),()=>O(ei=>ei.filter(bo=>bo.toastId!==C.id))}},[O,C.id]),me.useLayoutEffect(()=>{if(!ze)return;let Sn=gt.current,nr=Sn.style.height;Sn.style.height="auto";let ei=Sn.getBoundingClientRect().height;Sn.style.height=nr,ve(ei),O(bo=>bo.find(Eo=>Eo.toastId===C.id)?bo.map(Eo=>Eo.toastId===C.id?{...Eo,height:ei}:Eo):[{toastId:C.id,height:ei,position:C.position},...bo])},[ze,C.title,C.description,O,C.id]);let Ts=me.useCallback(()=>{ot(!0),At(ia.current),O(Sn=>Sn.filter(nr=>nr.toastId!==C.id)),setTimeout(()=>{U(C)},P2e)},[C,U,O,ia]);me.useEffect(()=>{if(C.promise&&Ft==="loading"||C.duration===1/0||C.type==="loading")return;let Sn;return D||N||ge&&Yn?(()=>{if(Yc.current<rc.current){let nr=new Date().getTime()-rc.current;Ie.current=Ie.current-nr}Yc.current=new Date().getTime()})():Ie.current!==1/0&&(rc.current=new Date().getTime(),Sn=setTimeout(()=>{var nr;(nr=C.onAutoClose)==null||nr.call(C,C),Ts()},Ie.current)),()=>clearTimeout(Sn)},[D,N,C,Ft,ge,Yn,Ts]),me.useEffect(()=>{C.delete&&Ts()},[Ts,C.delete]);function Wf(){var Sn,nr,ei;return de!=null&&de.loading?me.createElement("div",{className:vl(X==null?void 0:X.loader,(Sn=C==null?void 0:C.classNames)==null?void 0:Sn.loader,"sonner-loader"),"data-visible":Ft==="loading"},de.loading):J?me.createElement("div",{className:vl(X==null?void 0:X.loader,(nr=C==null?void 0:C.classNames)==null?void 0:nr.loader,"sonner-loader"),"data-visible":Ft==="loading"},J):me.createElement(h2e,{className:vl(X==null?void 0:X.loader,(ei=C==null?void 0:C.classNames)==null?void 0:ei.loader),visible:Ft==="loading"})}return me.createElement("li",{tabIndex:0,ref:gt,className:vl(K,cr,X==null?void 0:X.toast,(t=C==null?void 0:C.classNames)==null?void 0:t.toast,X==null?void 0:X.default,X==null?void 0:X[Ft],(n=C==null?void 0:C.classNames)==null?void 0:n[Ft]),"data-sonner-toast":"","data-rich-colors":(i=C.richColors)!=null?i:V,"data-styled":!(C.jsx||C.unstyled||R),"data-mounted":ze,"data-promise":!!C.promise,"data-swiped":fn,"data-removed":Be,"data-visible":pt,"data-y-position":eh,"data-x-position":lt,"data-index":P,"data-front":at,"data-swiping":De,"data-dismissible":vn,"data-type":Ft,"data-invert":gi,"data-swipe-out":Mt,"data-swipe-direction":rt,"data-expanded":!!(D||re&&ze),style:{"--index":P,"--toasts-before":P,"--z-index":M.length-P,"--offset":`${Be?St:ia.current}px`,"--initial-height":re?"auto":`${it}px`,...W,...C.style},onDragEnd:()=>{je(!1),Pe(null),Hs.current=null},onPointerDown:Sn=>{zs||!vn||($e.current=new Date,At(ia.current),Sn.target.setPointerCapture(Sn.pointerId),Sn.target.tagName!=="BUTTON"&&(je(!0),Hs.current={x:Sn.clientX,y:Sn.clientY}))},onPointerUp:()=>{var Sn,nr,ei,bo;if(Mt||!vn)return;Hs.current=null;let Eo=Number(((Sn=gt.current)==null?void 0:Sn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Si=Number(((nr=gt.current)==null?void 0:nr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Zu=new Date().getTime()-((ei=$e.current)==null?void 0:ei.getTime()),wo=Te==="x"?Eo:Si,So=Math.abs(wo)/Zu;if(Math.abs(wo)>=O2e||So>.11){At(ia.current),(bo=C.onDismiss)==null||bo.call(C,C),dt(Te==="x"?Eo>0?"right":"left":Si>0?"down":"up"),Ts(),Ut(!0),ht(!1);return}je(!1),Pe(null)},onPointerMove:Sn=>{var nr,ei,bo,Eo;if(!Hs.current||!vn||((nr=window.getSelection())==null?void 0:nr.toString().length)>0)return;let Si=Sn.clientY-Hs.current.y,Zu=Sn.clientX-Hs.current.x,wo=(ei=e.swipeDirections)!=null?ei:k2e(oe);!Te&&(Math.abs(Zu)>1||Math.abs(Si)>1)&&Pe(Math.abs(Zu)>Math.abs(Si)?"x":"y");let So={x:0,y:0};Te==="y"?(wo.includes("top")||wo.includes("bottom"))&&(wo.includes("top")&&Si<0||wo.includes("bottom")&&Si>0)&&(So.y=Si):Te==="x"&&(wo.includes("left")||wo.includes("right"))&&(wo.includes("left")&&Zu<0||wo.includes("right")&&Zu>0)&&(So.x=Zu),(Math.abs(So.x)>0||Math.abs(So.y)>0)&&ht(!0),(bo=gt.current)==null||bo.style.setProperty("--swipe-amount-x",`${So.x}px`),(Eo=gt.current)==null||Eo.style.setProperty("--swipe-amount-y",`${So.y}px`)}},xs&&!C.jsx?me.createElement("button",{"aria-label":we,"data-disabled":zs,"data-close-button":!0,onClick:zs||!vn?()=>{}:()=>{var Sn;Ts(),(Sn=C.onDismiss)==null||Sn.call(C,C)},className:vl(X==null?void 0:X.closeButton,(o=C==null?void 0:C.classNames)==null?void 0:o.closeButton)},(u=de==null?void 0:de.close)!=null?u:v2e):null,C.jsx||S.isValidElement(C.title)?C.jsx?C.jsx:typeof C.title=="function"?C.title():C.title:me.createElement(me.Fragment,null,Ft||C.icon||C.promise?me.createElement("div",{"data-icon":"",className:vl(X==null?void 0:X.icon,(h=C==null?void 0:C.classNames)==null?void 0:h.icon)},C.promise||C.type==="loading"&&!C.icon?C.icon||Wf():null,C.type!=="loading"?C.icon||(de==null?void 0:de[Ft])||u2e(Ft):null):null,me.createElement("div",{"data-content":"",className:vl(X==null?void 0:X.content,(p=C==null?void 0:C.classNames)==null?void 0:p.content)},me.createElement("div",{"data-title":"",className:vl(X==null?void 0:X.title,(g=C==null?void 0:C.classNames)==null?void 0:g.title)},typeof C.title=="function"?C.title():C.title),C.description?me.createElement("div",{"data-description":"",className:vl(q,ra,X==null?void 0:X.description,(v=C==null?void 0:C.classNames)==null?void 0:v.description)},typeof C.description=="function"?C.description():C.description):null),S.isValidElement(C.cancel)?C.cancel:C.cancel&&RC(C.cancel)?me.createElement("button",{"data-button":!0,"data-cancel":!0,style:C.cancelButtonStyle||Y,onClick:Sn=>{var nr,ei;RC(C.cancel)&&vn&&((ei=(nr=C.cancel).onClick)==null||ei.call(nr,Sn),Ts())},className:vl(X==null?void 0:X.cancelButton,(b=C==null?void 0:C.classNames)==null?void 0:b.cancelButton)},C.cancel.label):null,S.isValidElement(C.action)?C.action:C.action&&RC(C.action)?me.createElement("button",{"data-button":!0,"data-action":!0,style:C.actionButtonStyle||Q,onClick:Sn=>{var nr,ei;RC(C.action)&&((ei=(nr=C.action).onClick)==null||ei.call(nr,Sn),!Sn.defaultPrevented&&Ts())},className:vl(X==null?void 0:X.actionButton,(E=C==null?void 0:C.classNames)==null?void 0:E.actionButton)},C.action.label):null))};function uZ(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function D2e(e,t){let n={};return[e,t].forEach((i,o)=>{let u=o===1,h=u?"--mobile-offset":"--offset",p=u?N2e:R2e;function g(v){["top","right","bottom","left"].forEach(b=>{n[`${h}-${b}`]=typeof v=="number"?`${v}px`:v})}typeof i=="number"||typeof i=="string"?g(i):typeof i=="object"?["top","right","bottom","left"].forEach(v=>{i[v]===void 0?n[`${h}-${v}`]=p:n[`${h}-${v}`]=typeof i[v]=="number"?`${i[v]}px`:i[v]}):g(p)}),n}var L2e=S.forwardRef(function(e,t){let{invert:n,position:i="bottom-right",hotkey:o=["altKey","KeyT"],expand:u,closeButton:h,className:p,offset:g,mobileOffset:v,theme:b="light",richColors:E,duration:T,style:C,visibleToasts:R=C2e,toastOptions:N,dir:O=uZ(),gap:k=I2e,loadingIcon:j,icons:P,containerAriaLabel:M="Notifications",pauseWhenPageIsHidden:D}=e,[U,V]=me.useState([]),z=me.useMemo(()=>Array.from(new Set([i].concat(U.filter(ge=>ge.position).map(ge=>ge.position)))),[U,i]),[W,Y]=me.useState([]),[Q,K]=me.useState(!1),[q,ee]=me.useState(!1),[oe,ae]=me.useState(b!=="system"?b:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),J=me.useRef(null),re=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),X=me.useRef(null),de=me.useRef(!1),we=me.useCallback(ge=>{V(Te=>{var Pe;return(Pe=Te.find(rt=>rt.id===ge.id))!=null&&Pe.delete||co.dismiss(ge.id),Te.filter(({id:rt})=>rt!==ge.id)})},[]);return me.useEffect(()=>co.subscribe(ge=>{if(ge.dismiss){V(Te=>Te.map(Pe=>Pe.id===ge.id?{...Pe,delete:!0}:Pe));return}setTimeout(()=>{Ooe.flushSync(()=>{V(Te=>{let Pe=Te.findIndex(rt=>rt.id===ge.id);return Pe!==-1?[...Te.slice(0,Pe),{...Te[Pe],...ge},...Te.slice(Pe+1)]:[ge,...Te]})})})}),[]),me.useEffect(()=>{if(b!=="system"){ae(b);return}if(b==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ae("dark"):ae("light")),typeof window>"u")return;let ge=window.matchMedia("(prefers-color-scheme: dark)");try{ge.addEventListener("change",({matches:Te})=>{ae(Te?"dark":"light")})}catch{ge.addListener(({matches:Pe})=>{try{ae(Pe?"dark":"light")}catch(rt){console.error(rt)}})}},[b]),me.useEffect(()=>{U.length<=1&&K(!1)},[U]),me.useEffect(()=>{let ge=Te=>{var Pe,rt;o.every(dt=>Te[dt]||Te.code===dt)&&(K(!0),(Pe=J.current)==null||Pe.focus()),Te.code==="Escape"&&(document.activeElement===J.current||(rt=J.current)!=null&&rt.contains(document.activeElement))&&K(!1)};return document.addEventListener("keydown",ge),()=>document.removeEventListener("keydown",ge)},[o]),me.useEffect(()=>{if(J.current)return()=>{X.current&&(X.current.focus({preventScroll:!0}),X.current=null,de.current=!1)}},[J.current]),me.createElement("section",{ref:t,"aria-label":`${M} ${re}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},z.map((ge,Te)=>{var Pe;let[rt,dt]=ge.split("-");return U.length?me.createElement("ol",{key:ge,dir:O==="auto"?uZ():O,tabIndex:-1,ref:J,className:p,"data-sonner-toaster":!0,"data-theme":oe,"data-y-position":rt,"data-lifted":Q&&U.length>1&&!u,"data-x-position":dt,style:{"--front-toast-height":`${((Pe=W[0])==null?void 0:Pe.height)||0}px`,"--width":`${A2e}px`,"--gap":`${k}px`,...C,...D2e(g,v)},onBlur:ze=>{de.current&&!ze.currentTarget.contains(ze.relatedTarget)&&(de.current=!1,X.current&&(X.current.focus({preventScroll:!0}),X.current=null))},onFocus:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||de.current||(de.current=!0,X.current=ze.relatedTarget)},onMouseEnter:()=>K(!0),onMouseMove:()=>K(!0),onMouseLeave:()=>{q||K(!1)},onDragEnd:()=>K(!1),onPointerDown:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||ee(!0)},onPointerUp:()=>ee(!1)},U.filter(ze=>!ze.position&&Te===0||ze.position===ge).map((ze,vt)=>{var Be,ot;return me.createElement(j2e,{key:ze.id,icons:P,index:vt,toast:ze,defaultRichColors:E,duration:(Be=N==null?void 0:N.duration)!=null?Be:T,className:N==null?void 0:N.className,descriptionClassName:N==null?void 0:N.descriptionClassName,invert:n,visibleToasts:R,closeButton:(ot=N==null?void 0:N.closeButton)!=null?ot:h,interacting:q,position:ge,style:N==null?void 0:N.style,unstyled:N==null?void 0:N.unstyled,classNames:N==null?void 0:N.classNames,cancelButtonStyle:N==null?void 0:N.cancelButtonStyle,actionButtonStyle:N==null?void 0:N.actionButtonStyle,removeToast:we,toasts:U.filter(De=>De.position==ze.position),heights:W.filter(De=>De.position==ze.position),setHeights:Y,expandByDefault:u,gap:k,loadingIcon:j,expanded:Q,pauseWhenPageIsHidden:D,swipeDirections:e.swipeDirections})})):null}))});function Tt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function dZ(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function d1(...e){return t=>{let n=!1;const i=e.map(o=>{const u=dZ(o,t);return!n&&typeof u=="function"&&(n=!0),u});if(n)return()=>{for(let o=0;o<i.length;o++){const u=i[o];typeof u=="function"?u():dZ(e[o],null)}}}}function Dn(...e){return S.useCallback(d1(...e),e)}function M2e(e,t){const n=S.createContext(t),i=u=>{const{children:h,...p}=u,g=S.useMemo(()=>p,Object.values(p));return c.jsx(n.Provider,{value:g,children:h})};i.displayName=e+"Provider";function o(u){const h=S.useContext(n);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${u}\` must be used within \`${e}\``)}return[i,o]}function Vs(e,t=[]){let n=[];function i(u,h){const p=S.createContext(h),g=n.length;n=[...n,h];const v=E=>{var k;const{scope:T,children:C,...R}=E,N=((k=T==null?void 0:T[e])==null?void 0:k[g])||p,O=S.useMemo(()=>R,Object.values(R));return c.jsx(N.Provider,{value:O,children:C})};v.displayName=u+"Provider";function b(E,T){var N;const C=((N=T==null?void 0:T[e])==null?void 0:N[g])||p,R=S.useContext(C);if(R)return R;if(h!==void 0)return h;throw new Error(`\`${E}\` must be used within \`${u}\``)}return[v,b]}const o=()=>{const u=n.map(h=>S.createContext(h));return function(p){const g=(p==null?void 0:p[e])||u;return S.useMemo(()=>({[`__scope${e}`]:{...p,[e]:g}}),[p,g])}};return o.scopeName=e,[i,U2e(o,...t)]}function U2e(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(u){const h=i.reduce((p,{useScope:g,scopeName:v})=>{const E=g(u)[`__scope${v}`];return{...p,...E}},{});return S.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return n.scopeName=t.scopeName,n}function bf(e){const t=F2e(e),n=S.forwardRef((i,o)=>{const{children:u,...h}=i,p=S.Children.toArray(u),g=p.find(B2e);if(g){const v=g.props.children,b=p.map(E=>E===g?S.Children.count(v)>1?S.Children.only(null):S.isValidElement(v)?v.props.children:null:E);return c.jsx(t,{...h,ref:o,children:S.isValidElement(v)?S.cloneElement(v,void 0,b):null})}return c.jsx(t,{...h,ref:o,children:u})});return n.displayName=`${e}.Slot`,n}var koe=bf("Slot");function F2e(e){const t=S.forwardRef((n,i)=>{const{children:o,...u}=n;if(S.isValidElement(o)){const h=W2e(o),p=$2e(u,o.props);return o.type!==S.Fragment&&(p.ref=i?d1(i,h):h),S.cloneElement(o,p)}return S.Children.count(o)>1?S.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var joe=Symbol("radix.slottable");function V2e(e){const t=({children:n})=>c.jsx(c.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=joe,t}function B2e(e){return S.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===joe}function $2e(e,t){const n={...t};for(const i in t){const o=e[i],u=t[i];/^on[A-Z]/.test(i)?o&&u?n[i]=(...p)=>{const g=u(...p);return o(...p),g}:o&&(n[i]=o):i==="style"?n[i]={...o,...u}:i==="className"&&(n[i]=[o,u].filter(Boolean).join(" "))}return{...e,...n}}function W2e(e){var i,o;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var G2e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],en=G2e.reduce((e,t)=>{const n=bf(`Primitive.${t}`),i=S.forwardRef((o,u)=>{const{asChild:h,...p}=o,g=h?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(g,{...p,ref:u})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function Doe(e,t){e&&wm.flushSync(()=>e.dispatchEvent(t))}function Ba(e){const t=S.useRef(e);return S.useEffect(()=>{t.current=e}),S.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function H2e(e,t=globalThis==null?void 0:globalThis.document){const n=Ba(e);S.useEffect(()=>{const i=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var z2e="DismissableLayer",tU="dismissableLayer.update",K2e="dismissableLayer.pointerDownOutside",q2e="dismissableLayer.focusOutside",hZ,Loe=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Hy=S.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:u,onInteractOutside:h,onDismiss:p,...g}=e,v=S.useContext(Loe),[b,E]=S.useState(null),T=(b==null?void 0:b.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,C]=S.useState({}),R=Dn(t,V=>E(V)),N=Array.from(v.layers),[O]=[...v.layersWithOutsidePointerEventsDisabled].slice(-1),k=N.indexOf(O),j=b?N.indexOf(b):-1,P=v.layersWithOutsidePointerEventsDisabled.size>0,M=j>=k,D=J2e(V=>{const z=V.target,W=[...v.branches].some(Y=>Y.contains(z));!M||W||(o==null||o(V),h==null||h(V),V.defaultPrevented||p==null||p())},T),U=Z2e(V=>{const z=V.target;[...v.branches].some(Y=>Y.contains(z))||(u==null||u(V),h==null||h(V),V.defaultPrevented||p==null||p())},T);return H2e(V=>{j===v.layers.size-1&&(i==null||i(V),!V.defaultPrevented&&p&&(V.preventDefault(),p()))},T),S.useEffect(()=>{if(b)return n&&(v.layersWithOutsidePointerEventsDisabled.size===0&&(hZ=T.body.style.pointerEvents,T.body.style.pointerEvents="none"),v.layersWithOutsidePointerEventsDisabled.add(b)),v.layers.add(b),fZ(),()=>{n&&v.layersWithOutsidePointerEventsDisabled.size===1&&(T.body.style.pointerEvents=hZ)}},[b,T,n,v]),S.useEffect(()=>()=>{b&&(v.layers.delete(b),v.layersWithOutsidePointerEventsDisabled.delete(b),fZ())},[b,v]),S.useEffect(()=>{const V=()=>C({});return document.addEventListener(tU,V),()=>document.removeEventListener(tU,V)},[]),c.jsx(en.div,{...g,ref:R,style:{pointerEvents:P?M?"auto":"none":void 0,...e.style},onFocusCapture:Tt(e.onFocusCapture,U.onFocusCapture),onBlurCapture:Tt(e.onBlurCapture,U.onBlurCapture),onPointerDownCapture:Tt(e.onPointerDownCapture,D.onPointerDownCapture)})});Hy.displayName=z2e;var Y2e="DismissableLayerBranch",X2e=S.forwardRef((e,t)=>{const n=S.useContext(Loe),i=S.useRef(null),o=Dn(t,i);return S.useEffect(()=>{const u=i.current;if(u)return n.branches.add(u),()=>{n.branches.delete(u)}},[n.branches]),c.jsx(en.div,{...e,ref:o})});X2e.displayName=Y2e;function J2e(e,t=globalThis==null?void 0:globalThis.document){const n=Ba(e),i=S.useRef(!1),o=S.useRef(()=>{});return S.useEffect(()=>{const u=p=>{if(p.target&&!i.current){let g=function(){Moe(K2e,n,v,{discrete:!0})};const v={originalEvent:p};p.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=g,t.addEventListener("click",o.current,{once:!0})):g()}else t.removeEventListener("click",o.current);i.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",u),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function Z2e(e,t=globalThis==null?void 0:globalThis.document){const n=Ba(e),i=S.useRef(!1);return S.useEffect(()=>{const o=u=>{u.target&&!i.current&&Moe(q2e,n,{originalEvent:u},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function fZ(){const e=new CustomEvent(tU);document.dispatchEvent(e)}function Moe(e,t,n,{discrete:i}){const o=n.originalEvent.target,u=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?Doe(o,u):o.dispatchEvent(u)}var va=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},Q2e=a0[" useId ".trim().toString()]||(()=>{}),eLe=0;function Vl(e){const[t,n]=S.useState(Q2e());return va(()=>{n(i=>i??String(eLe++))},[e]),t?`radix-${t}`:""}const tLe=["top","right","bottom","left"],Ef=Math.min,Bo=Math.max,gN=Math.round,NC=Math.floor,ku=e=>({x:e,y:e}),nLe={left:"right",right:"left",bottom:"top",top:"bottom"},rLe={start:"end",end:"start"};function nU(e,t,n){return Bo(e,Ef(t,n))}function Vd(e,t){return typeof e=="function"?e(t):e}function Bd(e){return e.split("-")[0]}function zy(e){return e.split("-")[1]}function d4(e){return e==="x"?"y":"x"}function h4(e){return e==="y"?"height":"width"}const iLe=new Set(["top","bottom"]);function Nu(e){return iLe.has(Bd(e))?"y":"x"}function f4(e){return d4(Nu(e))}function aLe(e,t,n){n===void 0&&(n=!1);const i=zy(e),o=f4(e),u=h4(o);let h=o==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[u]>t.floating[u]&&(h=vN(h)),[h,vN(h)]}function sLe(e){const t=vN(e);return[rU(e),t,rU(t)]}function rU(e){return e.replace(/start|end/g,t=>rLe[t])}const pZ=["left","right"],mZ=["right","left"],oLe=["top","bottom"],cLe=["bottom","top"];function lLe(e,t,n){switch(e){case"top":case"bottom":return n?t?mZ:pZ:t?pZ:mZ;case"left":case"right":return t?oLe:cLe;default:return[]}}function uLe(e,t,n,i){const o=zy(e);let u=lLe(Bd(e),n==="start",i);return o&&(u=u.map(h=>h+"-"+o),t&&(u=u.concat(u.map(rU)))),u}function vN(e){return e.replace(/left|right|bottom|top/g,t=>nLe[t])}function dLe(e){return{top:0,right:0,bottom:0,left:0,...e}}function Uoe(e){return typeof e!="number"?dLe(e):{top:e,right:e,bottom:e,left:e}}function yN(e){const{x:t,y:n,width:i,height:o}=e;return{width:i,height:o,top:n,left:t,right:t+i,bottom:n+o,x:t,y:n}}function gZ(e,t,n){let{reference:i,floating:o}=e;const u=Nu(t),h=f4(t),p=h4(h),g=Bd(t),v=u==="y",b=i.x+i.width/2-o.width/2,E=i.y+i.height/2-o.height/2,T=i[p]/2-o[p]/2;let C;switch(g){case"top":C={x:b,y:i.y-o.height};break;case"bottom":C={x:b,y:i.y+i.height};break;case"right":C={x:i.x+i.width,y:E};break;case"left":C={x:i.x-o.width,y:E};break;default:C={x:i.x,y:i.y}}switch(zy(t)){case"start":C[h]-=T*(n&&v?-1:1);break;case"end":C[h]+=T*(n&&v?-1:1);break}return C}const hLe=async(e,t,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:u=[],platform:h}=n,p=u.filter(Boolean),g=await(h.isRTL==null?void 0:h.isRTL(t));let v=await h.getElementRects({reference:e,floating:t,strategy:o}),{x:b,y:E}=gZ(v,i,g),T=i,C={},R=0;for(let N=0;N<p.length;N++){const{name:O,fn:k}=p[N],{x:j,y:P,data:M,reset:D}=await k({x:b,y:E,initialPlacement:i,placement:T,strategy:o,middlewareData:C,rects:v,platform:h,elements:{reference:e,floating:t}});b=j??b,E=P??E,C={...C,[O]:{...C[O],...M}},D&&R<=50&&(R++,typeof D=="object"&&(D.placement&&(T=D.placement),D.rects&&(v=D.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:o}):D.rects),{x:b,y:E}=gZ(v,T,g)),N=-1)}return{x:b,y:E,placement:T,strategy:o,middlewareData:C}};async function S0(e,t){var n;t===void 0&&(t={});const{x:i,y:o,platform:u,rects:h,elements:p,strategy:g}=e,{boundary:v="clippingAncestors",rootBoundary:b="viewport",elementContext:E="floating",altBoundary:T=!1,padding:C=0}=Vd(t,e),R=Uoe(C),O=p[T?E==="floating"?"reference":"floating":E],k=yN(await u.getClippingRect({element:(n=await(u.isElement==null?void 0:u.isElement(O)))==null||n?O:O.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(p.floating)),boundary:v,rootBoundary:b,strategy:g})),j=E==="floating"?{x:i,y:o,width:h.floating.width,height:h.floating.height}:h.reference,P=await(u.getOffsetParent==null?void 0:u.getOffsetParent(p.floating)),M=await(u.isElement==null?void 0:u.isElement(P))?await(u.getScale==null?void 0:u.getScale(P))||{x:1,y:1}:{x:1,y:1},D=yN(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:p,rect:j,offsetParent:P,strategy:g}):j);return{top:(k.top-D.top+R.top)/M.y,bottom:(D.bottom-k.bottom+R.bottom)/M.y,left:(k.left-D.left+R.left)/M.x,right:(D.right-k.right+R.right)/M.x}}const fLe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:o,rects:u,platform:h,elements:p,middlewareData:g}=t,{element:v,padding:b=0}=Vd(e,t)||{};if(v==null)return{};const E=Uoe(b),T={x:n,y:i},C=f4(o),R=h4(C),N=await h.getDimensions(v),O=C==="y",k=O?"top":"left",j=O?"bottom":"right",P=O?"clientHeight":"clientWidth",M=u.reference[R]+u.reference[C]-T[C]-u.floating[R],D=T[C]-u.reference[C],U=await(h.getOffsetParent==null?void 0:h.getOffsetParent(v));let V=U?U[P]:0;(!V||!await(h.isElement==null?void 0:h.isElement(U)))&&(V=p.floating[P]||u.floating[R]);const z=M/2-D/2,W=V/2-N[R]/2-1,Y=Ef(E[k],W),Q=Ef(E[j],W),K=Y,q=V-N[R]-Q,ee=V/2-N[R]/2+z,oe=nU(K,ee,q),ae=!g.arrow&&zy(o)!=null&&ee!==oe&&u.reference[R]/2-(ee<K?Y:Q)-N[R]/2<0,J=ae?ee<K?ee-K:ee-q:0;return{[C]:T[C]+J,data:{[C]:oe,centerOffset:ee-oe-J,...ae&&{alignmentOffset:J}},reset:ae}}}),pLe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:o,middlewareData:u,rects:h,initialPlacement:p,platform:g,elements:v}=t,{mainAxis:b=!0,crossAxis:E=!0,fallbackPlacements:T,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:R="none",flipAlignment:N=!0,...O}=Vd(e,t);if((n=u.arrow)!=null&&n.alignmentOffset)return{};const k=Bd(o),j=Nu(p),P=Bd(p)===p,M=await(g.isRTL==null?void 0:g.isRTL(v.floating)),D=T||(P||!N?[vN(p)]:sLe(p)),U=R!=="none";!T&&U&&D.push(...uLe(p,N,R,M));const V=[p,...D],z=await S0(t,O),W=[];let Y=((i=u.flip)==null?void 0:i.overflows)||[];if(b&&W.push(z[k]),E){const ee=aLe(o,h,M);W.push(z[ee[0]],z[ee[1]])}if(Y=[...Y,{placement:o,overflows:W}],!W.every(ee=>ee<=0)){var Q,K;const ee=(((Q=u.flip)==null?void 0:Q.index)||0)+1,oe=V[ee];if(oe&&(!(E==="alignment"?j!==Nu(oe):!1)||Y.every(re=>re.overflows[0]>0&&Nu(re.placement)===j)))return{data:{index:ee,overflows:Y},reset:{placement:oe}};let ae=(K=Y.filter(J=>J.overflows[0]<=0).sort((J,re)=>J.overflows[1]-re.overflows[1])[0])==null?void 0:K.placement;if(!ae)switch(C){case"bestFit":{var q;const J=(q=Y.filter(re=>{if(U){const X=Nu(re.placement);return X===j||X==="y"}return!0}).map(re=>[re.placement,re.overflows.filter(X=>X>0).reduce((X,de)=>X+de,0)]).sort((re,X)=>re[1]-X[1])[0])==null?void 0:q[0];J&&(ae=J);break}case"initialPlacement":ae=p;break}if(o!==ae)return{reset:{placement:ae}}}return{}}}};function vZ(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function yZ(e){return tLe.some(t=>e[t]>=0)}const mLe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...o}=Vd(e,t);switch(i){case"referenceHidden":{const u=await S0(t,{...o,elementContext:"reference"}),h=vZ(u,n.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:yZ(h)}}}case"escaped":{const u=await S0(t,{...o,altBoundary:!0}),h=vZ(u,n.floating);return{data:{escapedOffsets:h,escaped:yZ(h)}}}default:return{}}}}},Foe=new Set(["left","top"]);async function gLe(e,t){const{placement:n,platform:i,elements:o}=e,u=await(i.isRTL==null?void 0:i.isRTL(o.floating)),h=Bd(n),p=zy(n),g=Nu(n)==="y",v=Foe.has(h)?-1:1,b=u&&g?-1:1,E=Vd(t,e);let{mainAxis:T,crossAxis:C,alignmentAxis:R}=typeof E=="number"?{mainAxis:E,crossAxis:0,alignmentAxis:null}:{mainAxis:E.mainAxis||0,crossAxis:E.crossAxis||0,alignmentAxis:E.alignmentAxis};return p&&typeof R=="number"&&(C=p==="end"?R*-1:R),g?{x:C*b,y:T*v}:{x:T*v,y:C*b}}const vLe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:o,y:u,placement:h,middlewareData:p}=t,g=await gLe(t,e);return h===((n=p.offset)==null?void 0:n.placement)&&(i=p.arrow)!=null&&i.alignmentOffset?{}:{x:o+g.x,y:u+g.y,data:{...g,placement:h}}}}},yLe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:o}=t,{mainAxis:u=!0,crossAxis:h=!1,limiter:p={fn:O=>{let{x:k,y:j}=O;return{x:k,y:j}}},...g}=Vd(e,t),v={x:n,y:i},b=await S0(t,g),E=Nu(Bd(o)),T=d4(E);let C=v[T],R=v[E];if(u){const O=T==="y"?"top":"left",k=T==="y"?"bottom":"right",j=C+b[O],P=C-b[k];C=nU(j,C,P)}if(h){const O=E==="y"?"top":"left",k=E==="y"?"bottom":"right",j=R+b[O],P=R-b[k];R=nU(j,R,P)}const N=p.fn({...t,[T]:C,[E]:R});return{...N,data:{x:N.x-n,y:N.y-i,enabled:{[T]:u,[E]:h}}}}}},_Le=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:o,rects:u,middlewareData:h}=t,{offset:p=0,mainAxis:g=!0,crossAxis:v=!0}=Vd(e,t),b={x:n,y:i},E=Nu(o),T=d4(E);let C=b[T],R=b[E];const N=Vd(p,t),O=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(g){const P=T==="y"?"height":"width",M=u.reference[T]-u.floating[P]+O.mainAxis,D=u.reference[T]+u.reference[P]-O.mainAxis;C<M?C=M:C>D&&(C=D)}if(v){var k,j;const P=T==="y"?"width":"height",M=Foe.has(Bd(o)),D=u.reference[E]-u.floating[P]+(M&&((k=h.offset)==null?void 0:k[E])||0)+(M?0:O.crossAxis),U=u.reference[E]+u.reference[P]+(M?0:((j=h.offset)==null?void 0:j[E])||0)-(M?O.crossAxis:0);R<D?R=D:R>U&&(R=U)}return{[T]:C,[E]:R}}}},bLe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:o,rects:u,platform:h,elements:p}=t,{apply:g=()=>{},...v}=Vd(e,t),b=await S0(t,v),E=Bd(o),T=zy(o),C=Nu(o)==="y",{width:R,height:N}=u.floating;let O,k;E==="top"||E==="bottom"?(O=E,k=T===(await(h.isRTL==null?void 0:h.isRTL(p.floating))?"start":"end")?"left":"right"):(k=E,O=T==="end"?"top":"bottom");const j=N-b.top-b.bottom,P=R-b.left-b.right,M=Ef(N-b[O],j),D=Ef(R-b[k],P),U=!t.middlewareData.shift;let V=M,z=D;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(z=P),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(V=j),U&&!T){const Y=Bo(b.left,0),Q=Bo(b.right,0),K=Bo(b.top,0),q=Bo(b.bottom,0);C?z=R-2*(Y!==0||Q!==0?Y+Q:Bo(b.left,b.right)):V=N-2*(K!==0||q!==0?K+q:Bo(b.top,b.bottom))}await g({...t,availableWidth:z,availableHeight:V});const W=await h.getDimensions(p.floating);return R!==W.width||N!==W.height?{reset:{rects:!0}}:{}}}};function h1(){return typeof window<"u"}function Ky(e){return Voe(e)?(e.nodeName||"").toLowerCase():"#document"}function zo(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Gu(e){var t;return(t=(Voe(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Voe(e){return h1()?e instanceof Node||e instanceof zo(e).Node:!1}function Wl(e){return h1()?e instanceof Element||e instanceof zo(e).Element:!1}function Fu(e){return h1()?e instanceof HTMLElement||e instanceof zo(e).HTMLElement:!1}function _Z(e){return!h1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof zo(e).ShadowRoot}const ELe=new Set(["inline","contents"]);function Pw(e){const{overflow:t,overflowX:n,overflowY:i,display:o}=Gl(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!ELe.has(o)}const wLe=new Set(["table","td","th"]);function SLe(e){return wLe.has(Ky(e))}const xLe=[":popover-open",":modal"];function f1(e){return xLe.some(t=>{try{return e.matches(t)}catch{return!1}})}const TLe=["transform","translate","scale","rotate","perspective"],CLe=["transform","translate","scale","rotate","perspective","filter"],RLe=["paint","layout","strict","content"];function p4(e){const t=m4(),n=Wl(e)?Gl(e):e;return TLe.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||CLe.some(i=>(n.willChange||"").includes(i))||RLe.some(i=>(n.contain||"").includes(i))}function NLe(e){let t=wf(e);for(;Fu(t)&&!oy(t);){if(p4(t))return t;if(f1(t))return null;t=wf(t)}return null}function m4(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const ALe=new Set(["html","body","#document"]);function oy(e){return ALe.has(Ky(e))}function Gl(e){return zo(e).getComputedStyle(e)}function p1(e){return Wl(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function wf(e){if(Ky(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_Z(e)&&e.host||Gu(e);return _Z(t)?t.host:t}function Boe(e){const t=wf(e);return oy(t)?e.ownerDocument?e.ownerDocument.body:e.body:Fu(t)&&Pw(t)?t:Boe(t)}function x0(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=Boe(e),u=o===((i=e.ownerDocument)==null?void 0:i.body),h=zo(o);if(u){const p=iU(h);return t.concat(h,h.visualViewport||[],Pw(o)?o:[],p&&n?x0(p):[])}return t.concat(o,x0(o,[],n))}function iU(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function $oe(e){const t=Gl(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const o=Fu(e),u=o?e.offsetWidth:n,h=o?e.offsetHeight:i,p=gN(n)!==u||gN(i)!==h;return p&&(n=u,i=h),{width:n,height:i,$:p}}function g4(e){return Wl(e)?e:e.contextElement}function Uv(e){const t=g4(e);if(!Fu(t))return ku(1);const n=t.getBoundingClientRect(),{width:i,height:o,$:u}=$oe(t);let h=(u?gN(n.width):n.width)/i,p=(u?gN(n.height):n.height)/o;return(!h||!Number.isFinite(h))&&(h=1),(!p||!Number.isFinite(p))&&(p=1),{x:h,y:p}}const ILe=ku(0);function Woe(e){const t=zo(e);return!m4()||!t.visualViewport?ILe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function OLe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==zo(e)?!1:t}function om(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),u=g4(e);let h=ku(1);t&&(i?Wl(i)&&(h=Uv(i)):h=Uv(e));const p=OLe(u,n,i)?Woe(u):ku(0);let g=(o.left+p.x)/h.x,v=(o.top+p.y)/h.y,b=o.width/h.x,E=o.height/h.y;if(u){const T=zo(u),C=i&&Wl(i)?zo(i):i;let R=T,N=iU(R);for(;N&&i&&C!==R;){const O=Uv(N),k=N.getBoundingClientRect(),j=Gl(N),P=k.left+(N.clientLeft+parseFloat(j.paddingLeft))*O.x,M=k.top+(N.clientTop+parseFloat(j.paddingTop))*O.y;g*=O.x,v*=O.y,b*=O.x,E*=O.y,g+=P,v+=M,R=zo(N),N=iU(R)}}return yN({width:b,height:E,x:g,y:v})}function v4(e,t){const n=p1(e).scrollLeft;return t?t.left+n:om(Gu(e)).left+n}function Goe(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),o=i.left+t.scrollLeft-(n?0:v4(e,i)),u=i.top+t.scrollTop;return{x:o,y:u}}function PLe(e){let{elements:t,rect:n,offsetParent:i,strategy:o}=e;const u=o==="fixed",h=Gu(i),p=t?f1(t.floating):!1;if(i===h||p&&u)return n;let g={scrollLeft:0,scrollTop:0},v=ku(1);const b=ku(0),E=Fu(i);if((E||!E&&!u)&&((Ky(i)!=="body"||Pw(h))&&(g=p1(i)),Fu(i))){const C=om(i);v=Uv(i),b.x=C.x+i.clientLeft,b.y=C.y+i.clientTop}const T=h&&!E&&!u?Goe(h,g,!0):ku(0);return{width:n.width*v.x,height:n.height*v.y,x:n.x*v.x-g.scrollLeft*v.x+b.x+T.x,y:n.y*v.y-g.scrollTop*v.y+b.y+T.y}}function kLe(e){return Array.from(e.getClientRects())}function jLe(e){const t=Gu(e),n=p1(e),i=e.ownerDocument.body,o=Bo(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),u=Bo(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let h=-n.scrollLeft+v4(e);const p=-n.scrollTop;return Gl(i).direction==="rtl"&&(h+=Bo(t.clientWidth,i.clientWidth)-o),{width:o,height:u,x:h,y:p}}function DLe(e,t){const n=zo(e),i=Gu(e),o=n.visualViewport;let u=i.clientWidth,h=i.clientHeight,p=0,g=0;if(o){u=o.width,h=o.height;const v=m4();(!v||v&&t==="fixed")&&(p=o.offsetLeft,g=o.offsetTop)}return{width:u,height:h,x:p,y:g}}const LLe=new Set(["absolute","fixed"]);function MLe(e,t){const n=om(e,!0,t==="fixed"),i=n.top+e.clientTop,o=n.left+e.clientLeft,u=Fu(e)?Uv(e):ku(1),h=e.clientWidth*u.x,p=e.clientHeight*u.y,g=o*u.x,v=i*u.y;return{width:h,height:p,x:g,y:v}}function bZ(e,t,n){let i;if(t==="viewport")i=DLe(e,n);else if(t==="document")i=jLe(Gu(e));else if(Wl(t))i=MLe(t,n);else{const o=Woe(e);i={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return yN(i)}function Hoe(e,t){const n=wf(e);return n===t||!Wl(n)||oy(n)?!1:Gl(n).position==="fixed"||Hoe(n,t)}function ULe(e,t){const n=t.get(e);if(n)return n;let i=x0(e,[],!1).filter(p=>Wl(p)&&Ky(p)!=="body"),o=null;const u=Gl(e).position==="fixed";let h=u?wf(e):e;for(;Wl(h)&&!oy(h);){const p=Gl(h),g=p4(h);!g&&p.position==="fixed"&&(o=null),(u?!g&&!o:!g&&p.position==="static"&&!!o&&LLe.has(o.position)||Pw(h)&&!g&&Hoe(e,h))?i=i.filter(b=>b!==h):o=p,h=wf(h)}return t.set(e,i),i}function FLe(e){let{element:t,boundary:n,rootBoundary:i,strategy:o}=e;const h=[...n==="clippingAncestors"?f1(t)?[]:ULe(t,this._c):[].concat(n),i],p=h[0],g=h.reduce((v,b)=>{const E=bZ(t,b,o);return v.top=Bo(E.top,v.top),v.right=Ef(E.right,v.right),v.bottom=Ef(E.bottom,v.bottom),v.left=Bo(E.left,v.left),v},bZ(t,p,o));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function VLe(e){const{width:t,height:n}=$oe(e);return{width:t,height:n}}function BLe(e,t,n){const i=Fu(t),o=Gu(t),u=n==="fixed",h=om(e,!0,u,t);let p={scrollLeft:0,scrollTop:0};const g=ku(0);function v(){g.x=v4(o)}if(i||!i&&!u)if((Ky(t)!=="body"||Pw(o))&&(p=p1(t)),i){const C=om(t,!0,u,t);g.x=C.x+t.clientLeft,g.y=C.y+t.clientTop}else o&&v();u&&!i&&o&&v();const b=o&&!i&&!u?Goe(o,p):ku(0),E=h.left+p.scrollLeft-g.x-b.x,T=h.top+p.scrollTop-g.y-b.y;return{x:E,y:T,width:h.width,height:h.height}}function G2(e){return Gl(e).position==="static"}function EZ(e,t){if(!Fu(e)||Gl(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Gu(e)===n&&(n=n.ownerDocument.body),n}function zoe(e,t){const n=zo(e);if(f1(e))return n;if(!Fu(e)){let o=wf(e);for(;o&&!oy(o);){if(Wl(o)&&!G2(o))return o;o=wf(o)}return n}let i=EZ(e,t);for(;i&&SLe(i)&&G2(i);)i=EZ(i,t);return i&&oy(i)&&G2(i)&&!p4(i)?n:i||NLe(e)||n}const $Le=async function(e){const t=this.getOffsetParent||zoe,n=this.getDimensions,i=await n(e.floating);return{reference:BLe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function WLe(e){return Gl(e).direction==="rtl"}const GLe={convertOffsetParentRelativeRectToViewportRelativeRect:PLe,getDocumentElement:Gu,getClippingRect:FLe,getOffsetParent:zoe,getElementRects:$Le,getClientRects:kLe,getDimensions:VLe,getScale:Uv,isElement:Wl,isRTL:WLe};function Koe(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function HLe(e,t){let n=null,i;const o=Gu(e);function u(){var p;clearTimeout(i),(p=n)==null||p.disconnect(),n=null}function h(p,g){p===void 0&&(p=!1),g===void 0&&(g=1),u();const v=e.getBoundingClientRect(),{left:b,top:E,width:T,height:C}=v;if(p||t(),!T||!C)return;const R=NC(E),N=NC(o.clientWidth-(b+T)),O=NC(o.clientHeight-(E+C)),k=NC(b),P={rootMargin:-R+"px "+-N+"px "+-O+"px "+-k+"px",threshold:Bo(0,Ef(1,g))||1};let M=!0;function D(U){const V=U[0].intersectionRatio;if(V!==g){if(!M)return h();V?h(!1,V):i=setTimeout(()=>{h(!1,1e-7)},1e3)}V===1&&!Koe(v,e.getBoundingClientRect())&&h(),M=!1}try{n=new IntersectionObserver(D,{...P,root:o.ownerDocument})}catch{n=new IntersectionObserver(D,P)}n.observe(e)}return h(!0),u}function qoe(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:o=!0,ancestorResize:u=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:p=typeof IntersectionObserver=="function",animationFrame:g=!1}=i,v=g4(e),b=o||u?[...v?x0(v):[],...x0(t)]:[];b.forEach(k=>{o&&k.addEventListener("scroll",n,{passive:!0}),u&&k.addEventListener("resize",n)});const E=v&&p?HLe(v,n):null;let T=-1,C=null;h&&(C=new ResizeObserver(k=>{let[j]=k;j&&j.target===v&&C&&(C.unobserve(t),cancelAnimationFrame(T),T=requestAnimationFrame(()=>{var P;(P=C)==null||P.observe(t)})),n()}),v&&!g&&C.observe(v),C.observe(t));let R,N=g?om(e):null;g&&O();function O(){const k=om(e);N&&!Koe(N,k)&&n(),N=k,R=requestAnimationFrame(O)}return n(),()=>{var k;b.forEach(j=>{o&&j.removeEventListener("scroll",n),u&&j.removeEventListener("resize",n)}),E==null||E(),(k=C)==null||k.disconnect(),C=null,g&&cancelAnimationFrame(R)}}const zLe=vLe,KLe=yLe,qLe=pLe,YLe=bLe,XLe=mLe,wZ=fLe,JLe=_Le,ZLe=(e,t,n)=>{const i=new Map,o={platform:GLe,...n},u={...o.platform,_c:i};return hLe(e,t,{...o,platform:u})};var QLe=typeof document<"u",eMe=function(){},IR=QLe?S.useLayoutEffect:eMe;function _N(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!_N(e[i],t[i]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,o[i]))return!1;for(i=n;i--!==0;){const u=o[i];if(!(u==="_owner"&&e.$$typeof)&&!_N(e[u],t[u]))return!1}return!0}return e!==e&&t!==t}function Yoe(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function SZ(e,t){const n=Yoe(e);return Math.round(t*n)/n}function H2(e){const t=S.useRef(e);return IR(()=>{t.current=e}),t}function tMe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:o,elements:{reference:u,floating:h}={},transform:p=!0,whileElementsMounted:g,open:v}=e,[b,E]=S.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[T,C]=S.useState(i);_N(T,i)||C(i);const[R,N]=S.useState(null),[O,k]=S.useState(null),j=S.useCallback(re=>{re!==U.current&&(U.current=re,N(re))},[]),P=S.useCallback(re=>{re!==V.current&&(V.current=re,k(re))},[]),M=u||R,D=h||O,U=S.useRef(null),V=S.useRef(null),z=S.useRef(b),W=g!=null,Y=H2(g),Q=H2(o),K=H2(v),q=S.useCallback(()=>{if(!U.current||!V.current)return;const re={placement:t,strategy:n,middleware:T};Q.current&&(re.platform=Q.current),ZLe(U.current,V.current,re).then(X=>{const de={...X,isPositioned:K.current!==!1};ee.current&&!_N(z.current,de)&&(z.current=de,wm.flushSync(()=>{E(de)}))})},[T,t,n,Q,K]);IR(()=>{v===!1&&z.current.isPositioned&&(z.current.isPositioned=!1,E(re=>({...re,isPositioned:!1})))},[v]);const ee=S.useRef(!1);IR(()=>(ee.current=!0,()=>{ee.current=!1}),[]),IR(()=>{if(M&&(U.current=M),D&&(V.current=D),M&&D){if(Y.current)return Y.current(M,D,q);q()}},[M,D,q,Y,W]);const oe=S.useMemo(()=>({reference:U,floating:V,setReference:j,setFloating:P}),[j,P]),ae=S.useMemo(()=>({reference:M,floating:D}),[M,D]),J=S.useMemo(()=>{const re={position:n,left:0,top:0};if(!ae.floating)return re;const X=SZ(ae.floating,b.x),de=SZ(ae.floating,b.y);return p?{...re,transform:"translate("+X+"px, "+de+"px)",...Yoe(ae.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:X,top:de}},[n,p,ae.floating,b.x,b.y]);return S.useMemo(()=>({...b,update:q,refs:oe,elements:ae,floatingStyles:J}),[b,q,oe,ae,J])}const nMe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:o}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?wZ({element:i.current,padding:o}).fn(n):{}:i?wZ({element:i,padding:o}).fn(n):{}}}},rMe=(e,t)=>({...zLe(e),options:[e,t]}),iMe=(e,t)=>({...KLe(e),options:[e,t]}),aMe=(e,t)=>({...JLe(e),options:[e,t]}),sMe=(e,t)=>({...qLe(e),options:[e,t]}),oMe=(e,t)=>({...YLe(e),options:[e,t]}),cMe=(e,t)=>({...XLe(e),options:[e,t]}),lMe=(e,t)=>({...nMe(e),options:[e,t]});var uMe="Arrow",Xoe=S.forwardRef((e,t)=>{const{children:n,width:i=10,height:o=5,...u}=e;return c.jsx(en.svg,{...u,ref:t,width:i,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});Xoe.displayName=uMe;var dMe=Xoe;function y4(e){const[t,n]=S.useState(void 0);return va(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const u=o[0];let h,p;if("borderBoxSize"in u){const g=u.borderBoxSize,v=Array.isArray(g)?g[0]:g;h=v.inlineSize,p=v.blockSize}else h=e.offsetWidth,p=e.offsetHeight;n({width:h,height:p})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var _4="Popper",[Joe,Of]=Vs(_4),[hMe,Zoe]=Joe(_4),Qoe=e=>{const{__scopePopper:t,children:n}=e,[i,o]=S.useState(null);return c.jsx(hMe,{scope:t,anchor:i,onAnchorChange:o,children:n})};Qoe.displayName=_4;var ece="PopperAnchor",tce=S.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...o}=e,u=Zoe(ece,n),h=S.useRef(null),p=Dn(t,h);return S.useEffect(()=>{u.onAnchorChange((i==null?void 0:i.current)||h.current)}),i?null:c.jsx(en.div,{...o,ref:p})});tce.displayName=ece;var b4="PopperContent",[fMe,pMe]=Joe(b4),nce=S.forwardRef((e,t)=>{var ze,vt,Be,ot,De,je;const{__scopePopper:n,side:i="bottom",sideOffset:o=0,align:u="center",alignOffset:h=0,arrowPadding:p=0,avoidCollisions:g=!0,collisionBoundary:v=[],collisionPadding:b=0,sticky:E="partial",hideWhenDetached:T=!1,updatePositionStrategy:C="optimized",onPlaced:R,...N}=e,O=Zoe(b4,n),[k,j]=S.useState(null),P=Dn(t,Mt=>j(Mt)),[M,D]=S.useState(null),U=y4(M),V=(U==null?void 0:U.width)??0,z=(U==null?void 0:U.height)??0,W=i+(u!=="center"?"-"+u:""),Y=typeof b=="number"?b:{top:0,right:0,bottom:0,left:0,...b},Q=Array.isArray(v)?v:[v],K=Q.length>0,q={padding:Y,boundary:Q.filter(gMe),altBoundary:K},{refs:ee,floatingStyles:oe,placement:ae,isPositioned:J,middlewareData:re}=tMe({strategy:"fixed",placement:W,whileElementsMounted:(...Mt)=>qoe(...Mt,{animationFrame:C==="always"}),elements:{reference:O.anchor},middleware:[rMe({mainAxis:o+z,alignmentAxis:h}),g&&iMe({mainAxis:!0,crossAxis:!1,limiter:E==="partial"?aMe():void 0,...q}),g&&sMe({...q}),oMe({...q,apply:({elements:Mt,rects:Ut,availableWidth:fn,availableHeight:ht})=>{const{width:St,height:At}=Ut.reference,it=Mt.floating.style;it.setProperty("--radix-popper-available-width",`${fn}px`),it.setProperty("--radix-popper-available-height",`${ht}px`),it.setProperty("--radix-popper-anchor-width",`${St}px`),it.setProperty("--radix-popper-anchor-height",`${At}px`)}}),M&&lMe({element:M,padding:p}),vMe({arrowWidth:V,arrowHeight:z}),T&&cMe({strategy:"referenceHidden",...q})]}),[X,de]=ace(ae),we=Ba(R);va(()=>{J&&(we==null||we())},[J,we]);const ge=(ze=re.arrow)==null?void 0:ze.x,Te=(vt=re.arrow)==null?void 0:vt.y,Pe=((Be=re.arrow)==null?void 0:Be.centerOffset)!==0,[rt,dt]=S.useState();return va(()=>{k&&dt(window.getComputedStyle(k).zIndex)},[k]),c.jsx("div",{ref:ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...oe,transform:J?oe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:rt,"--radix-popper-transform-origin":[(ot=re.transformOrigin)==null?void 0:ot.x,(De=re.transformOrigin)==null?void 0:De.y].join(" "),...((je=re.hide)==null?void 0:je.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:c.jsx(fMe,{scope:n,placedSide:X,onArrowChange:D,arrowX:ge,arrowY:Te,shouldHideArrow:Pe,children:c.jsx(en.div,{"data-side":X,"data-align":de,...N,ref:P,style:{...N.style,animation:J?void 0:"none"}})})})});nce.displayName=b4;var rce="PopperArrow",mMe={top:"bottom",right:"left",bottom:"top",left:"right"},ice=S.forwardRef(function(t,n){const{__scopePopper:i,...o}=t,u=pMe(rce,i),h=mMe[u.placedSide];return c.jsx("span",{ref:u.onArrowChange,style:{position:"absolute",left:u.arrowX,top:u.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[u.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[u.placedSide],visibility:u.shouldHideArrow?"hidden":void 0},children:c.jsx(dMe,{...o,ref:n,style:{...o.style,display:"block"}})})});ice.displayName=rce;function gMe(e){return e!==null}var vMe=e=>({name:"transformOrigin",options:e,fn(t){var O,k,j;const{placement:n,rects:i,middlewareData:o}=t,h=((O=o.arrow)==null?void 0:O.centerOffset)!==0,p=h?0:e.arrowWidth,g=h?0:e.arrowHeight,[v,b]=ace(n),E={start:"0%",center:"50%",end:"100%"}[b],T=(((k=o.arrow)==null?void 0:k.x)??0)+p/2,C=(((j=o.arrow)==null?void 0:j.y)??0)+g/2;let R="",N="";return v==="bottom"?(R=h?E:`${T}px`,N=`${-g}px`):v==="top"?(R=h?E:`${T}px`,N=`${i.floating.height+g}px`):v==="right"?(R=`${-g}px`,N=h?E:`${C}px`):v==="left"&&(R=`${i.floating.width+g}px`,N=h?E:`${C}px`),{data:{x:R,y:N}}}});function ace(e){const[t,n="center"]=e.split("-");return[t,n]}var E4=Qoe,kw=tce,m1=nce,g1=ice,yMe="Portal",jw=S.forwardRef((e,t)=>{var p;const{container:n,...i}=e,[o,u]=S.useState(!1);va(()=>u(!0),[]);const h=n||o&&((p=globalThis==null?void 0:globalThis.document)==null?void 0:p.body);return h?Ooe.createPortal(c.jsx(en.div,{...i,ref:t}),h):null});jw.displayName=yMe;function _Me(e,t){return S.useReducer((n,i)=>t[n][i]??n,e)}var is=e=>{const{present:t,children:n}=e,i=bMe(t),o=typeof n=="function"?n({present:i.isPresent}):S.Children.only(n),u=Dn(i.ref,EMe(o));return typeof n=="function"||i.isPresent?S.cloneElement(o,{ref:u}):null};is.displayName="Presence";function bMe(e){const[t,n]=S.useState(),i=S.useRef(null),o=S.useRef(e),u=S.useRef("none"),h=e?"mounted":"unmounted",[p,g]=_Me(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const v=AC(i.current);u.current=p==="mounted"?v:"none"},[p]),va(()=>{const v=i.current,b=o.current;if(b!==e){const T=u.current,C=AC(v);e?g("MOUNT"):C==="none"||(v==null?void 0:v.display)==="none"?g("UNMOUNT"):g(b&&T!==C?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,g]),va(()=>{if(t){let v;const b=t.ownerDocument.defaultView??window,E=C=>{const N=AC(i.current).includes(C.animationName);if(C.target===t&&N&&(g("ANIMATION_END"),!o.current)){const O=t.style.animationFillMode;t.style.animationFillMode="forwards",v=b.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=O)})}},T=C=>{C.target===t&&(u.current=AC(i.current))};return t.addEventListener("animationstart",T),t.addEventListener("animationcancel",E),t.addEventListener("animationend",E),()=>{b.clearTimeout(v),t.removeEventListener("animationstart",T),t.removeEventListener("animationcancel",E),t.removeEventListener("animationend",E)}}else g("ANIMATION_END")},[t,g]),{isPresent:["mounted","unmountSuspended"].includes(p),ref:S.useCallback(v=>{i.current=v?getComputedStyle(v):null,n(v)},[])}}function AC(e){return(e==null?void 0:e.animationName)||"none"}function EMe(e){var i,o;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var wMe=a0[" useInsertionEffect ".trim().toString()]||va;function $d({prop:e,defaultProp:t,onChange:n=()=>{},caller:i}){const[o,u,h]=SMe({defaultProp:t,onChange:n}),p=e!==void 0,g=p?e:o;{const b=S.useRef(e!==void 0);S.useEffect(()=>{const E=b.current;E!==p&&console.warn(`${i} is changing from ${E?"controlled":"uncontrolled"} to ${p?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),b.current=p},[p,i])}const v=S.useCallback(b=>{var E;if(p){const T=xMe(b)?b(e):b;T!==e&&((E=h.current)==null||E.call(h,T))}else u(b)},[p,e,u,h]);return[g,v]}function SMe({defaultProp:e,onChange:t}){const[n,i]=S.useState(e),o=S.useRef(n),u=S.useRef(t);return wMe(()=>{u.current=t},[t]),S.useEffect(()=>{var h;o.current!==n&&((h=u.current)==null||h.call(u,n),o.current=n)},[n,o]),[n,i,u]}function xMe(e){return typeof e=="function"}var sce=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),TMe="VisuallyHidden",oce=S.forwardRef((e,t)=>c.jsx(en.span,{...e,ref:t,style:{...sce,...e.style}}));oce.displayName=TMe;var CMe=oce,[v1,YSt]=Vs("Tooltip",[Of]),w4=Of(),cce="TooltipProvider",RMe=700,xZ="tooltip.open",[NMe,lce]=v1(cce),uce=e=>{const{__scopeTooltip:t,delayDuration:n=RMe,skipDelayDuration:i=300,disableHoverableContent:o=!1,children:u}=e,h=S.useRef(!0),p=S.useRef(!1),g=S.useRef(0);return S.useEffect(()=>{const v=g.current;return()=>window.clearTimeout(v)},[]),c.jsx(NMe,{scope:t,isOpenDelayedRef:h,delayDuration:n,onOpen:S.useCallback(()=>{window.clearTimeout(g.current),h.current=!1},[]),onClose:S.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>h.current=!0,i)},[i]),isPointerInTransitRef:p,onPointerInTransitChange:S.useCallback(v=>{p.current=v},[]),disableHoverableContent:o,children:u})};uce.displayName=cce;var dce="Tooltip",[XSt,y1]=v1(dce),aU="TooltipTrigger",AMe=S.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,o=y1(aU,n),u=lce(aU,n),h=w4(n),p=S.useRef(null),g=Dn(t,p,o.onTriggerChange),v=S.useRef(!1),b=S.useRef(!1),E=S.useCallback(()=>v.current=!1,[]);return S.useEffect(()=>()=>document.removeEventListener("pointerup",E),[E]),c.jsx(kw,{asChild:!0,...h,children:c.jsx(en.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...i,ref:g,onPointerMove:Tt(e.onPointerMove,T=>{T.pointerType!=="touch"&&!b.current&&!u.isPointerInTransitRef.current&&(o.onTriggerEnter(),b.current=!0)}),onPointerLeave:Tt(e.onPointerLeave,()=>{o.onTriggerLeave(),b.current=!1}),onPointerDown:Tt(e.onPointerDown,()=>{o.open&&o.onClose(),v.current=!0,document.addEventListener("pointerup",E,{once:!0})}),onFocus:Tt(e.onFocus,()=>{v.current||o.onOpen()}),onBlur:Tt(e.onBlur,o.onClose),onClick:Tt(e.onClick,o.onClose)})})});AMe.displayName=aU;var IMe="TooltipPortal",[JSt,OMe]=v1(IMe,{forceMount:void 0}),cy="TooltipContent",hce=S.forwardRef((e,t)=>{const n=OMe(cy,e.__scopeTooltip),{forceMount:i=n.forceMount,side:o="top",...u}=e,h=y1(cy,e.__scopeTooltip);return c.jsx(is,{present:i||h.open,children:h.disableHoverableContent?c.jsx(fce,{side:o,...u,ref:t}):c.jsx(PMe,{side:o,...u,ref:t})})}),PMe=S.forwardRef((e,t)=>{const n=y1(cy,e.__scopeTooltip),i=lce(cy,e.__scopeTooltip),o=S.useRef(null),u=Dn(t,o),[h,p]=S.useState(null),{trigger:g,onClose:v}=n,b=o.current,{onPointerInTransitChange:E}=i,T=S.useCallback(()=>{p(null),E(!1)},[E]),C=S.useCallback((R,N)=>{const O=R.currentTarget,k={x:R.clientX,y:R.clientY},j=MMe(k,O.getBoundingClientRect()),P=UMe(k,j),M=FMe(N.getBoundingClientRect()),D=BMe([...P,...M]);p(D),E(!0)},[E]);return S.useEffect(()=>()=>T(),[T]),S.useEffect(()=>{if(g&&b){const R=O=>C(O,b),N=O=>C(O,g);return g.addEventListener("pointerleave",R),b.addEventListener("pointerleave",N),()=>{g.removeEventListener("pointerleave",R),b.removeEventListener("pointerleave",N)}}},[g,b,C,T]),S.useEffect(()=>{if(h){const R=N=>{const O=N.target,k={x:N.clientX,y:N.clientY},j=(g==null?void 0:g.contains(O))||(b==null?void 0:b.contains(O)),P=!VMe(k,h);j?T():P&&(T(),v())};return document.addEventListener("pointermove",R),()=>document.removeEventListener("pointermove",R)}},[g,b,h,v,T]),c.jsx(fce,{...e,ref:u})}),[kMe,jMe]=v1(dce,{isInside:!1}),DMe=V2e("TooltipContent"),fce=S.forwardRef((e,t)=>{const{__scopeTooltip:n,children:i,"aria-label":o,onEscapeKeyDown:u,onPointerDownOutside:h,...p}=e,g=y1(cy,n),v=w4(n),{onClose:b}=g;return S.useEffect(()=>(document.addEventListener(xZ,b),()=>document.removeEventListener(xZ,b)),[b]),S.useEffect(()=>{if(g.trigger){const E=T=>{const C=T.target;C!=null&&C.contains(g.trigger)&&b()};return window.addEventListener("scroll",E,{capture:!0}),()=>window.removeEventListener("scroll",E,{capture:!0})}},[g.trigger,b]),c.jsx(Hy,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:u,onPointerDownOutside:h,onFocusOutside:E=>E.preventDefault(),onDismiss:b,children:c.jsxs(m1,{"data-state":g.stateAttribute,...v,...p,ref:t,style:{...p.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(DMe,{children:i}),c.jsx(kMe,{scope:n,isInside:!0,children:c.jsx(CMe,{id:g.contentId,role:"tooltip",children:o||i})})]})})});hce.displayName=cy;var pce="TooltipArrow",LMe=S.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,o=w4(n);return jMe(pce,n).isInside?null:c.jsx(g1,{...o,...i,ref:t})});LMe.displayName=pce;function MMe(e,t){const n=Math.abs(t.top-e.y),i=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),u=Math.abs(t.left-e.x);switch(Math.min(n,i,o,u)){case u:return"left";case o:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function UMe(e,t,n=5){const i=[];switch(t){case"top":i.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":i.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":i.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":i.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return i}function FMe(e){const{top:t,right:n,bottom:i,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:i},{x:o,y:i}]}function VMe(e,t){const{x:n,y:i}=e;let o=!1;for(let u=0,h=t.length-1;u<t.length;h=u++){const p=t[u],g=t[h],v=p.x,b=p.y,E=g.x,T=g.y;b>i!=T>i&&n<(E-v)*(i-b)/(T-b)+v&&(o=!o)}return o}function BMe(e){const t=e.slice();return t.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),$Me(t)}function $Me(e){if(e.length<=1)return e.slice();const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(;t.length>=2;){const u=t[t.length-1],h=t[t.length-2];if((u.x-h.x)*(o.y-h.y)>=(u.y-h.y)*(o.x-h.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let i=e.length-1;i>=0;i--){const o=e[i];for(;n.length>=2;){const u=n[n.length-1],h=n[n.length-2];if((u.x-h.x)*(o.y-h.y)>=(u.y-h.y)*(o.x-h.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var WMe=uce,mce=hce;function gce(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=gce(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function er(){for(var e,t,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=gce(e))&&(i&&(i+=" "),i+=t);return i}const S4="-",GMe=e=>{const t=zMe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:h=>{const p=h.split(S4);return p[0]===""&&p.length!==1&&p.shift(),vce(p,t)||HMe(h)},getConflictingClassGroupIds:(h,p)=>{const g=n[h]||[];return p&&i[h]?[...g,...i[h]]:g}}},vce=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const n=e[0],i=t.nextPart.get(n),o=i?vce(e.slice(1),i):void 0;if(o)return o;if(t.validators.length===0)return;const u=e.join(S4);return(h=t.validators.find(({validator:p})=>p(u)))==null?void 0:h.classGroupId},TZ=/^\[(.+)\]$/,HMe=e=>{if(TZ.test(e)){const t=TZ.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},zMe=e=>{const{theme:t,prefix:n}=e,i={nextPart:new Map,validators:[]};return qMe(Object.entries(e.classGroups),n).forEach(([u,h])=>{sU(h,i,u,t)}),i},sU=(e,t,n,i)=>{e.forEach(o=>{if(typeof o=="string"){const u=o===""?t:CZ(t,o);u.classGroupId=n;return}if(typeof o=="function"){if(KMe(o)){sU(o(i),t,n,i);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([u,h])=>{sU(h,CZ(t,u),n,i)})})},CZ=(e,t)=>{let n=e;return t.split(S4).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},KMe=e=>e.isThemeGetter,qMe=(e,t)=>t?e.map(([n,i])=>{const o=i.map(u=>typeof u=="string"?t+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(([h,p])=>[t+h,p])):u);return[n,o]}):e,YMe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,i=new Map;const o=(u,h)=>{n.set(u,h),t++,t>e&&(t=0,i=n,n=new Map)};return{get(u){let h=n.get(u);if(h!==void 0)return h;if((h=i.get(u))!==void 0)return o(u,h),h},set(u,h){n.has(u)?n.set(u,h):o(u,h)}}},yce="!",XMe=e=>{const{separator:t,experimentalParseClassName:n}=e,i=t.length===1,o=t[0],u=t.length,h=p=>{const g=[];let v=0,b=0,E;for(let O=0;O<p.length;O++){let k=p[O];if(v===0){if(k===o&&(i||p.slice(O,O+u)===t)){g.push(p.slice(b,O)),b=O+u;continue}if(k==="/"){E=O;continue}}k==="["?v++:k==="]"&&v--}const T=g.length===0?p:p.substring(b),C=T.startsWith(yce),R=C?T.substring(1):T,N=E&&E>b?E-b:void 0;return{modifiers:g,hasImportantModifier:C,baseClassName:R,maybePostfixModifierPosition:N}};return n?p=>n({className:p,parseClassName:h}):h},JMe=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(i=>{i[0]==="["?(t.push(...n.sort(),i),n=[]):n.push(i)}),t.push(...n.sort()),t},ZMe=e=>({cache:YMe(e.cacheSize),parseClassName:XMe(e),...GMe(e)}),QMe=/\s+/,eUe=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:o}=t,u=[],h=e.trim().split(QMe);let p="";for(let g=h.length-1;g>=0;g-=1){const v=h[g],{modifiers:b,hasImportantModifier:E,baseClassName:T,maybePostfixModifierPosition:C}=n(v);let R=!!C,N=i(R?T.substring(0,C):T);if(!N){if(!R){p=v+(p.length>0?" "+p:p);continue}if(N=i(T),!N){p=v+(p.length>0?" "+p:p);continue}R=!1}const O=JMe(b).join(":"),k=E?O+yce:O,j=k+N;if(u.includes(j))continue;u.push(j);const P=o(N,R);for(let M=0;M<P.length;++M){const D=P[M];u.push(k+D)}p=v+(p.length>0?" "+p:p)}return p};function tUe(){let e=0,t,n,i="";for(;e<arguments.length;)(t=arguments[e++])&&(n=_ce(t))&&(i&&(i+=" "),i+=n);return i}const _ce=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=_ce(e[i]))&&(n&&(n+=" "),n+=t);return n};function nUe(e,...t){let n,i,o,u=h;function h(g){const v=t.reduce((b,E)=>E(b),e());return n=ZMe(v),i=n.cache.get,o=n.cache.set,u=p,p(g)}function p(g){const v=i(g);if(v)return v;const b=eUe(g,n);return o(g,b),b}return function(){return u(tUe.apply(null,arguments))}}const li=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},bce=/^\[(?:([a-z-]+):)?(.+)\]$/i,rUe=/^\d+\/\d+$/,iUe=new Set(["px","full","screen"]),aUe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sUe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,oUe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,cUe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,lUe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,gd=e=>Fv(e)||iUe.has(e)||rUe.test(e),Dh=e=>qy(e,"length",vUe),Fv=e=>!!e&&!Number.isNaN(Number(e)),z2=e=>qy(e,"number",Fv),aE=e=>!!e&&Number.isInteger(Number(e)),uUe=e=>e.endsWith("%")&&Fv(e.slice(0,-1)),Fn=e=>bce.test(e),Lh=e=>aUe.test(e),dUe=new Set(["length","size","percentage"]),hUe=e=>qy(e,dUe,Ece),fUe=e=>qy(e,"position",Ece),pUe=new Set(["image","url"]),mUe=e=>qy(e,pUe,_Ue),gUe=e=>qy(e,"",yUe),sE=()=>!0,qy=(e,t,n)=>{const i=bce.exec(e);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):n(i[2]):!1},vUe=e=>sUe.test(e)&&!oUe.test(e),Ece=()=>!1,yUe=e=>cUe.test(e),_Ue=e=>lUe.test(e),bUe=()=>{const e=li("colors"),t=li("spacing"),n=li("blur"),i=li("brightness"),o=li("borderColor"),u=li("borderRadius"),h=li("borderSpacing"),p=li("borderWidth"),g=li("contrast"),v=li("grayscale"),b=li("hueRotate"),E=li("invert"),T=li("gap"),C=li("gradientColorStops"),R=li("gradientColorStopPositions"),N=li("inset"),O=li("margin"),k=li("opacity"),j=li("padding"),P=li("saturate"),M=li("scale"),D=li("sepia"),U=li("skew"),V=li("space"),z=li("translate"),W=()=>["auto","contain","none"],Y=()=>["auto","hidden","clip","visible","scroll"],Q=()=>["auto",Fn,t],K=()=>[Fn,t],q=()=>["",gd,Dh],ee=()=>["auto",Fv,Fn],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ae=()=>["solid","dashed","dotted","double","none"],J=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],re=()=>["start","end","center","between","around","evenly","stretch"],X=()=>["","0",Fn],de=()=>["auto","avoid","all","avoid-page","page","left","right","column"],we=()=>[Fv,Fn];return{cacheSize:500,separator:":",theme:{colors:[sE],spacing:[gd,Dh],blur:["none","",Lh,Fn],brightness:we(),borderColor:[e],borderRadius:["none","","full",Lh,Fn],borderSpacing:K(),borderWidth:q(),contrast:we(),grayscale:X(),hueRotate:we(),invert:X(),gap:K(),gradientColorStops:[e],gradientColorStopPositions:[uUe,Dh],inset:Q(),margin:Q(),opacity:we(),padding:K(),saturate:we(),scale:we(),sepia:X(),skew:we(),space:K(),translate:K()},classGroups:{aspect:[{aspect:["auto","square","video",Fn]}],container:["container"],columns:[{columns:[Lh]}],"break-after":[{"break-after":de()}],"break-before":[{"break-before":de()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),Fn]}],overflow:[{overflow:Y()}],"overflow-x":[{"overflow-x":Y()}],"overflow-y":[{"overflow-y":Y()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",aE,Fn]}],basis:[{basis:Q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Fn]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",aE,Fn]}],"grid-cols":[{"grid-cols":[sE]}],"col-start-end":[{col:["auto",{span:["full",aE,Fn]},Fn]}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":[sE]}],"row-start-end":[{row:["auto",{span:[aE,Fn]},Fn]}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Fn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Fn]}],gap:[{gap:[T]}],"gap-x":[{"gap-x":[T]}],"gap-y":[{"gap-y":[T]}],"justify-content":[{justify:["normal",...re()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...re(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...re(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[j]}],px:[{px:[j]}],py:[{py:[j]}],ps:[{ps:[j]}],pe:[{pe:[j]}],pt:[{pt:[j]}],pr:[{pr:[j]}],pb:[{pb:[j]}],pl:[{pl:[j]}],m:[{m:[O]}],mx:[{mx:[O]}],my:[{my:[O]}],ms:[{ms:[O]}],me:[{me:[O]}],mt:[{mt:[O]}],mr:[{mr:[O]}],mb:[{mb:[O]}],ml:[{ml:[O]}],"space-x":[{"space-x":[V]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[V]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Fn,t]}],"min-w":[{"min-w":[Fn,t,"min","max","fit"]}],"max-w":[{"max-w":[Fn,t,"none","full","min","max","fit","prose",{screen:[Lh]},Lh]}],h:[{h:[Fn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Fn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Fn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Fn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Lh,Dh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",z2]}],"font-family":[{font:[sE]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Fn]}],"line-clamp":[{"line-clamp":["none",Fv,z2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",gd,Fn]}],"list-image":[{"list-image":["none",Fn]}],"list-style-type":[{list:["none","disc","decimal",Fn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[k]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ae(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",gd,Dh]}],"underline-offset":[{"underline-offset":["auto",gd,Fn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:K()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Fn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Fn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[k]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),fUe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",hUe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mUe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[R]}],"gradient-via-pos":[{via:[R]}],"gradient-to-pos":[{to:[R]}],"gradient-from":[{from:[C]}],"gradient-via":[{via:[C]}],"gradient-to":[{to:[C]}],rounded:[{rounded:[u]}],"rounded-s":[{"rounded-s":[u]}],"rounded-e":[{"rounded-e":[u]}],"rounded-t":[{"rounded-t":[u]}],"rounded-r":[{"rounded-r":[u]}],"rounded-b":[{"rounded-b":[u]}],"rounded-l":[{"rounded-l":[u]}],"rounded-ss":[{"rounded-ss":[u]}],"rounded-se":[{"rounded-se":[u]}],"rounded-ee":[{"rounded-ee":[u]}],"rounded-es":[{"rounded-es":[u]}],"rounded-tl":[{"rounded-tl":[u]}],"rounded-tr":[{"rounded-tr":[u]}],"rounded-br":[{"rounded-br":[u]}],"rounded-bl":[{"rounded-bl":[u]}],"border-w":[{border:[p]}],"border-w-x":[{"border-x":[p]}],"border-w-y":[{"border-y":[p]}],"border-w-s":[{"border-s":[p]}],"border-w-e":[{"border-e":[p]}],"border-w-t":[{"border-t":[p]}],"border-w-r":[{"border-r":[p]}],"border-w-b":[{"border-b":[p]}],"border-w-l":[{"border-l":[p]}],"border-opacity":[{"border-opacity":[k]}],"border-style":[{border:[...ae(),"hidden"]}],"divide-x":[{"divide-x":[p]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[p]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[k]}],"divide-style":[{divide:ae()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...ae()]}],"outline-offset":[{"outline-offset":[gd,Fn]}],"outline-w":[{outline:[gd,Dh]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[k]}],"ring-offset-w":[{"ring-offset":[gd,Dh]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Lh,gUe]}],"shadow-color":[{shadow:[sE]}],opacity:[{opacity:[k]}],"mix-blend":[{"mix-blend":[...J(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":J()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[g]}],"drop-shadow":[{"drop-shadow":["","none",Lh,Fn]}],grayscale:[{grayscale:[v]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[E]}],saturate:[{saturate:[P]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[g]}],"backdrop-grayscale":[{"backdrop-grayscale":[v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[E]}],"backdrop-opacity":[{"backdrop-opacity":[k]}],"backdrop-saturate":[{"backdrop-saturate":[P]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Fn]}],duration:[{duration:we()}],ease:[{ease:["linear","in","out","in-out",Fn]}],delay:[{delay:we()}],animate:[{animate:["none","spin","ping","pulse","bounce",Fn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[aE,Fn]}],"translate-x":[{"translate-x":[z]}],"translate-y":[{"translate-y":[z]}],"skew-x":[{"skew-x":[U]}],"skew-y":[{"skew-y":[U]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Fn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Fn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":K()}],"scroll-mx":[{"scroll-mx":K()}],"scroll-my":[{"scroll-my":K()}],"scroll-ms":[{"scroll-ms":K()}],"scroll-me":[{"scroll-me":K()}],"scroll-mt":[{"scroll-mt":K()}],"scroll-mr":[{"scroll-mr":K()}],"scroll-mb":[{"scroll-mb":K()}],"scroll-ml":[{"scroll-ml":K()}],"scroll-p":[{"scroll-p":K()}],"scroll-px":[{"scroll-px":K()}],"scroll-py":[{"scroll-py":K()}],"scroll-ps":[{"scroll-ps":K()}],"scroll-pe":[{"scroll-pe":K()}],"scroll-pt":[{"scroll-pt":K()}],"scroll-pr":[{"scroll-pr":K()}],"scroll-pb":[{"scroll-pb":K()}],"scroll-pl":[{"scroll-pl":K()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Fn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[gd,Dh,z2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},EUe=nUe(bUe);function kt(...e){return EUe(er(e))}function bN(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}function wUe(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}const SUe=WMe,xUe=S.forwardRef(({className:e,sideOffset:t=4,...n},i)=>c.jsx(mce,{ref:i,sideOffset:t,className:kt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));xUe.displayName=mce.displayName;var _1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},b1=typeof window>"u"||"Deno"in globalThis;function Cl(){}function TUe(e,t){return typeof e=="function"?e(t):e}function CUe(e){return typeof e=="number"&&e>=0&&e!==1/0}function RUe(e,t){return Math.max(e+(t||0)-Date.now(),0)}function oU(e,t){return typeof e=="function"?e(t):e}function NUe(e,t){return typeof e=="function"?e(t):e}function RZ(e,t){const{type:n="all",exact:i,fetchStatus:o,predicate:u,queryKey:h,stale:p}=e;if(h){if(i){if(t.queryHash!==x4(h,t.options))return!1}else if(!C0(t.queryKey,h))return!1}if(n!=="all"){const g=t.isActive();if(n==="active"&&!g||n==="inactive"&&g)return!1}return!(typeof p=="boolean"&&t.isStale()!==p||o&&o!==t.state.fetchStatus||u&&!u(t))}function NZ(e,t){const{exact:n,status:i,predicate:o,mutationKey:u}=e;if(u){if(!t.options.mutationKey)return!1;if(n){if(T0(t.options.mutationKey)!==T0(u))return!1}else if(!C0(t.options.mutationKey,u))return!1}return!(i&&t.state.status!==i||o&&!o(t))}function x4(e,t){return((t==null?void 0:t.queryKeyHashFn)||T0)(e)}function T0(e){return JSON.stringify(e,(t,n)=>cU(n)?Object.keys(n).sort().reduce((i,o)=>(i[o]=n[o],i),{}):n)}function C0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>C0(e[n],t[n])):!1}function wce(e,t){if(e===t)return e;const n=AZ(e)&&AZ(t);if(n||cU(e)&&cU(t)){const i=n?e:Object.keys(e),o=i.length,u=n?t:Object.keys(t),h=u.length,p=n?[]:{},g=new Set(i);let v=0;for(let b=0;b<h;b++){const E=n?b:u[b];(!n&&g.has(E)||n)&&e[E]===void 0&&t[E]===void 0?(p[E]=void 0,v++):(p[E]=wce(e[E],t[E]),p[E]===e[E]&&e[E]!==void 0&&v++)}return o===h&&v===o?e:p}return t}function AZ(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function cU(e){if(!IZ(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!IZ(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function IZ(e){return Object.prototype.toString.call(e)==="[object Object]"}function AUe(e){return new Promise(t=>{setTimeout(t,e)})}function IUe(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?wce(e,t):t}function OUe(e,t,n=0){const i=[...e,t];return n&&i.length>n?i.slice(1):i}function PUe(e,t,n=0){const i=[t,...e];return n&&i.length>n?i.slice(0,-1):i}var T4=Symbol();function Sce(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===T4?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Hp,Kh,zv,dae,kUe=(dae=class extends _1{constructor(){super();yr(this,Hp);yr(this,Kh);yr(this,zv);On(this,zv,t=>{if(!b1&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Qe(this,Kh)||this.setEventListener(Qe(this,zv))}onUnsubscribe(){var t;this.hasListeners()||((t=Qe(this,Kh))==null||t.call(this),On(this,Kh,void 0))}setEventListener(t){var n;On(this,zv,t),(n=Qe(this,Kh))==null||n.call(this),On(this,Kh,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){Qe(this,Hp)!==t&&(On(this,Hp,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Qe(this,Hp)=="boolean"?Qe(this,Hp):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Hp=new WeakMap,Kh=new WeakMap,zv=new WeakMap,dae),xce=new kUe,Kv,qh,qv,hae,jUe=(hae=class extends _1{constructor(){super();yr(this,Kv,!0);yr(this,qh);yr(this,qv);On(this,qv,t=>{if(!b1&&window.addEventListener){const n=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)}}})}onSubscribe(){Qe(this,qh)||this.setEventListener(Qe(this,qv))}onUnsubscribe(){var t;this.hasListeners()||((t=Qe(this,qh))==null||t.call(this),On(this,qh,void 0))}setEventListener(t){var n;On(this,qv,t),(n=Qe(this,qh))==null||n.call(this),On(this,qh,t(this.setOnline.bind(this)))}setOnline(t){Qe(this,Kv)!==t&&(On(this,Kv,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return Qe(this,Kv)}},Kv=new WeakMap,qh=new WeakMap,qv=new WeakMap,hae),EN=new jUe;function DUe(){let e,t;const n=new Promise((o,u)=>{e=o,t=u});n.status="pending",n.catch(()=>{});function i(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{i({status:"fulfilled",value:o}),e(o)},n.reject=o=>{i({status:"rejected",reason:o}),t(o)},n}function LUe(e){return Math.min(1e3*2**e,3e4)}function Tce(e){return(e??"online")==="online"?EN.isOnline():!0}var Cce=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function K2(e){return e instanceof Cce}function Rce(e){let t=!1,n=0,i=!1,o;const u=DUe(),h=N=>{var O;i||(T(new Cce(N)),(O=e.abort)==null||O.call(e))},p=()=>{t=!0},g=()=>{t=!1},v=()=>xce.isFocused()&&(e.networkMode==="always"||EN.isOnline())&&e.canRun(),b=()=>Tce(e.networkMode)&&e.canRun(),E=N=>{var O;i||(i=!0,(O=e.onSuccess)==null||O.call(e,N),o==null||o(),u.resolve(N))},T=N=>{var O;i||(i=!0,(O=e.onError)==null||O.call(e,N),o==null||o(),u.reject(N))},C=()=>new Promise(N=>{var O;o=k=>{(i||v())&&N(k)},(O=e.onPause)==null||O.call(e)}).then(()=>{var N;o=void 0,i||(N=e.onContinue)==null||N.call(e)}),R=()=>{if(i)return;let N;const O=n===0?e.initialPromise:void 0;try{N=O??e.fn()}catch(k){N=Promise.reject(k)}Promise.resolve(N).then(E).catch(k=>{var U;if(i)return;const j=e.retry??(b1?0:3),P=e.retryDelay??LUe,M=typeof P=="function"?P(n,k):P,D=j===!0||typeof j=="number"&&n<j||typeof j=="function"&&j(n,k);if(t||!D){T(k);return}n++,(U=e.onFail)==null||U.call(e,n,k),AUe(M).then(()=>v()?void 0:C()).then(()=>{t?T(k):R()})})};return{promise:u,cancel:h,continue:()=>(o==null||o(),u),cancelRetry:p,continueRetry:g,canStart:b,start:()=>(b()?R():C().then(R),u)}}var MUe=e=>setTimeout(e,0);function UUe(){let e=[],t=0,n=p=>{p()},i=p=>{p()},o=MUe;const u=p=>{t?e.push(p):o(()=>{n(p)})},h=()=>{const p=e;e=[],p.length&&o(()=>{i(()=>{p.forEach(g=>{n(g)})})})};return{batch:p=>{let g;t++;try{g=p()}finally{t--,t||h()}return g},batchCalls:p=>(...g)=>{u(()=>{p(...g)})},schedule:u,setNotifyFunction:p=>{n=p},setBatchNotifyFunction:p=>{i=p},setScheduler:p=>{o=p}}}var Ds=UUe(),zp,fae,Nce=(fae=class{constructor(){yr(this,zp)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),CUe(this.gcTime)&&On(this,zp,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(b1?1/0:5*60*1e3))}clearGcTimeout(){Qe(this,zp)&&(clearTimeout(Qe(this,zp)),On(this,zp,void 0))}},zp=new WeakMap,fae),Yv,Kp,Ic,qp,vs,Tw,Yp,Rl,_d,pae,FUe=(pae=class extends Nce{constructor(t){super();yr(this,Rl);yr(this,Yv);yr(this,Kp);yr(this,Ic);yr(this,qp);yr(this,vs);yr(this,Tw);yr(this,Yp);On(this,Yp,!1),On(this,Tw,t.defaultOptions),this.setOptions(t.options),this.observers=[],On(this,qp,t.client),On(this,Ic,Qe(this,qp).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,On(this,Yv,BUe(this.options)),this.state=t.state??Qe(this,Yv),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Qe(this,vs))==null?void 0:t.promise}setOptions(t){this.options={...Qe(this,Tw),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Qe(this,Ic).remove(this)}setData(t,n){const i=IUe(this.state.data,t,this.options);return hs(this,Rl,_d).call(this,{data:i,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),i}setState(t,n){hs(this,Rl,_d).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var i,o;const n=(i=Qe(this,vs))==null?void 0:i.promise;return(o=Qe(this,vs))==null||o.cancel(t),n?n.then(Cl).catch(Cl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Qe(this,Yv))}isActive(){return this.observers.some(t=>NUe(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===T4||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>oU(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!RUe(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Qe(this,vs))==null||n.continue()}onOnline(){var n;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Qe(this,vs))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Qe(this,Ic).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Qe(this,vs)&&(Qe(this,Yp)?Qe(this,vs).cancel({revert:!0}):Qe(this,vs).cancelRetry()),this.scheduleGc()),Qe(this,Ic).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||hs(this,Rl,_d).call(this,{type:"invalidate"})}fetch(t,n){var v,b,E;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Qe(this,vs))return Qe(this,vs).continueRetry(),Qe(this,vs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const T=this.observers.find(C=>C.options.queryFn);T&&this.setOptions(T.options)}const i=new AbortController,o=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(On(this,Yp,!0),i.signal)})},u=()=>{const T=Sce(this.options,n),R=(()=>{const N={client:Qe(this,qp),queryKey:this.queryKey,meta:this.meta};return o(N),N})();return On(this,Yp,!1),this.options.persister?this.options.persister(T,R,this):T(R)},p=(()=>{const T={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:Qe(this,qp),state:this.state,fetchFn:u};return o(T),T})();(v=this.options.behavior)==null||v.onFetch(p,this),On(this,Kp,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((b=p.fetchOptions)==null?void 0:b.meta))&&hs(this,Rl,_d).call(this,{type:"fetch",meta:(E=p.fetchOptions)==null?void 0:E.meta});const g=T=>{var C,R,N,O;K2(T)&&T.silent||hs(this,Rl,_d).call(this,{type:"error",error:T}),K2(T)||((R=(C=Qe(this,Ic).config).onError)==null||R.call(C,T,this),(O=(N=Qe(this,Ic).config).onSettled)==null||O.call(N,this.state.data,T,this)),this.scheduleGc()};return On(this,vs,Rce({initialPromise:n==null?void 0:n.initialPromise,fn:p.fetchFn,abort:i.abort.bind(i),onSuccess:T=>{var C,R,N,O;if(T===void 0){g(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(T)}catch(k){g(k);return}(R=(C=Qe(this,Ic).config).onSuccess)==null||R.call(C,T,this),(O=(N=Qe(this,Ic).config).onSettled)==null||O.call(N,T,this.state.error,this),this.scheduleGc()},onError:g,onFail:(T,C)=>{hs(this,Rl,_d).call(this,{type:"failed",failureCount:T,error:C})},onPause:()=>{hs(this,Rl,_d).call(this,{type:"pause"})},onContinue:()=>{hs(this,Rl,_d).call(this,{type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay,networkMode:p.options.networkMode,canRun:()=>!0})),Qe(this,vs).start()}},Yv=new WeakMap,Kp=new WeakMap,Ic=new WeakMap,qp=new WeakMap,vs=new WeakMap,Tw=new WeakMap,Yp=new WeakMap,Rl=new WeakSet,_d=function(t){const n=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...VUe(i.data,this.options),fetchMeta:t.meta??null};case"success":return On(this,Kp,void 0),{...i,data:t.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return K2(o)&&o.revert&&Qe(this,Kp)?{...Qe(this,Kp),fetchStatus:"idle"}:{...i,error:o,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=n(this.state),Ds.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),Qe(this,Ic).notify({query:this,type:"updated",action:t})})},pae);function VUe(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Tce(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function BUe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,i=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Eu,mae,$Ue=(mae=class extends _1{constructor(t={}){super();yr(this,Eu);this.config=t,On(this,Eu,new Map)}build(t,n,i){const o=n.queryKey,u=n.queryHash??x4(o,n);let h=this.get(u);return h||(h=new FUe({client:t,queryKey:o,queryHash:u,options:t.defaultQueryOptions(n),state:i,defaultOptions:t.getQueryDefaults(o)}),this.add(h)),h}add(t){Qe(this,Eu).has(t.queryHash)||(Qe(this,Eu).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Qe(this,Eu).get(t.queryHash);n&&(t.destroy(),n===t&&Qe(this,Eu).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ds.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Qe(this,Eu).get(t)}getAll(){return[...Qe(this,Eu).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(i=>RZ(n,i))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(i=>RZ(t,i)):n}notify(t){Ds.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Ds.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ds.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Eu=new WeakMap,mae),wu,Ps,Xp,Su,Uh,gae,WUe=(gae=class extends Nce{constructor(t){super();yr(this,Su);yr(this,wu);yr(this,Ps);yr(this,Xp);this.mutationId=t.mutationId,On(this,Ps,t.mutationCache),On(this,wu,[]),this.state=t.state||GUe(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Qe(this,wu).includes(t)||(Qe(this,wu).push(t),this.clearGcTimeout(),Qe(this,Ps).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){On(this,wu,Qe(this,wu).filter(n=>n!==t)),this.scheduleGc(),Qe(this,Ps).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Qe(this,wu).length||(this.state.status==="pending"?this.scheduleGc():Qe(this,Ps).remove(this))}continue(){var t;return((t=Qe(this,Xp))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var u,h,p,g,v,b,E,T,C,R,N,O,k,j,P,M,D,U,V,z;const n=()=>{hs(this,Su,Uh).call(this,{type:"continue"})};On(this,Xp,Rce({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(W,Y)=>{hs(this,Su,Uh).call(this,{type:"failed",failureCount:W,error:Y})},onPause:()=>{hs(this,Su,Uh).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Qe(this,Ps).canRun(this)}));const i=this.state.status==="pending",o=!Qe(this,Xp).canStart();try{if(i)n();else{hs(this,Su,Uh).call(this,{type:"pending",variables:t,isPaused:o}),await((h=(u=Qe(this,Ps).config).onMutate)==null?void 0:h.call(u,t,this));const Y=await((g=(p=this.options).onMutate)==null?void 0:g.call(p,t));Y!==this.state.context&&hs(this,Su,Uh).call(this,{type:"pending",context:Y,variables:t,isPaused:o})}const W=await Qe(this,Xp).start();return await((b=(v=Qe(this,Ps).config).onSuccess)==null?void 0:b.call(v,W,t,this.state.context,this)),await((T=(E=this.options).onSuccess)==null?void 0:T.call(E,W,t,this.state.context)),await((R=(C=Qe(this,Ps).config).onSettled)==null?void 0:R.call(C,W,null,this.state.variables,this.state.context,this)),await((O=(N=this.options).onSettled)==null?void 0:O.call(N,W,null,t,this.state.context)),hs(this,Su,Uh).call(this,{type:"success",data:W}),W}catch(W){try{throw await((j=(k=Qe(this,Ps).config).onError)==null?void 0:j.call(k,W,t,this.state.context,this)),await((M=(P=this.options).onError)==null?void 0:M.call(P,W,t,this.state.context)),await((U=(D=Qe(this,Ps).config).onSettled)==null?void 0:U.call(D,void 0,W,this.state.variables,this.state.context,this)),await((z=(V=this.options).onSettled)==null?void 0:z.call(V,void 0,W,t,this.state.context)),W}finally{hs(this,Su,Uh).call(this,{type:"error",error:W})}}finally{Qe(this,Ps).runNext(this)}}},wu=new WeakMap,Ps=new WeakMap,Xp=new WeakMap,Su=new WeakSet,Uh=function(t){const n=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Ds.batch(()=>{Qe(this,wu).forEach(i=>{i.onMutationUpdate(t)}),Qe(this,Ps).notify({mutation:this,type:"updated",action:t})})},gae);function GUe(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var wd,Nl,Cw,vae,HUe=(vae=class extends _1{constructor(t={}){super();yr(this,wd);yr(this,Nl);yr(this,Cw);this.config=t,On(this,wd,new Set),On(this,Nl,new Map),On(this,Cw,0)}build(t,n,i){const o=new WUe({mutationCache:this,mutationId:++lC(this,Cw)._,options:t.defaultMutationOptions(n),state:i});return this.add(o),o}add(t){Qe(this,wd).add(t);const n=IC(t);if(typeof n=="string"){const i=Qe(this,Nl).get(n);i?i.push(t):Qe(this,Nl).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Qe(this,wd).delete(t)){const n=IC(t);if(typeof n=="string"){const i=Qe(this,Nl).get(n);if(i)if(i.length>1){const o=i.indexOf(t);o!==-1&&i.splice(o,1)}else i[0]===t&&Qe(this,Nl).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=IC(t);if(typeof n=="string"){const i=Qe(this,Nl).get(n),o=i==null?void 0:i.find(u=>u.state.status==="pending");return!o||o===t}else return!0}runNext(t){var i;const n=IC(t);if(typeof n=="string"){const o=(i=Qe(this,Nl).get(n))==null?void 0:i.find(u=>u!==t&&u.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ds.batch(()=>{Qe(this,wd).forEach(t=>{this.notify({type:"removed",mutation:t})}),Qe(this,wd).clear(),Qe(this,Nl).clear()})}getAll(){return Array.from(Qe(this,wd))}find(t){const n={exact:!0,...t};return this.getAll().find(i=>NZ(n,i))}findAll(t={}){return this.getAll().filter(n=>NZ(t,n))}notify(t){Ds.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Ds.batch(()=>Promise.all(t.map(n=>n.continue().catch(Cl))))}},wd=new WeakMap,Nl=new WeakMap,Cw=new WeakMap,vae);function IC(e){var t;return(t=e.options.scope)==null?void 0:t.id}function OZ(e){return{onFetch:(t,n)=>{var b,E,T,C,R;const i=t.options,o=(T=(E=(b=t.fetchOptions)==null?void 0:b.meta)==null?void 0:E.fetchMore)==null?void 0:T.direction,u=((C=t.state.data)==null?void 0:C.pages)||[],h=((R=t.state.data)==null?void 0:R.pageParams)||[];let p={pages:[],pageParams:[]},g=0;const v=async()=>{let N=!1;const O=P=>{Object.defineProperty(P,"signal",{enumerable:!0,get:()=>(t.signal.aborted?N=!0:t.signal.addEventListener("abort",()=>{N=!0}),t.signal)})},k=Sce(t.options,t.fetchOptions),j=async(P,M,D)=>{if(N)return Promise.reject();if(M==null&&P.pages.length)return Promise.resolve(P);const V=(()=>{const Q={client:t.client,queryKey:t.queryKey,pageParam:M,direction:D?"backward":"forward",meta:t.options.meta};return O(Q),Q})(),z=await k(V),{maxPages:W}=t.options,Y=D?PUe:OUe;return{pages:Y(P.pages,z,W),pageParams:Y(P.pageParams,M,W)}};if(o&&u.length){const P=o==="backward",M=P?zUe:PZ,D={pages:u,pageParams:h},U=M(i,D);p=await j(D,U,P)}else{const P=e??u.length;do{const M=g===0?h[0]??i.initialPageParam:PZ(i,p);if(g>0&&M==null)break;p=await j(p,M),g++}while(g<P)}return p};t.options.persister?t.fetchFn=()=>{var N,O;return(O=(N=t.options).persister)==null?void 0:O.call(N,v,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=v}}}function PZ(e,{pages:t,pageParams:n}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,n[i],n):void 0}function zUe(e,{pages:t,pageParams:n}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,n[0],n):void 0}var Fi,Yh,Xh,Xv,Jv,Jh,Zv,Qv,yae,KUe=(yae=class{constructor(e={}){yr(this,Fi);yr(this,Yh);yr(this,Xh);yr(this,Xv);yr(this,Jv);yr(this,Jh);yr(this,Zv);yr(this,Qv);On(this,Fi,e.queryCache||new $Ue),On(this,Yh,e.mutationCache||new HUe),On(this,Xh,e.defaultOptions||{}),On(this,Xv,new Map),On(this,Jv,new Map),On(this,Jh,0)}mount(){lC(this,Jh)._++,Qe(this,Jh)===1&&(On(this,Zv,xce.subscribe(async e=>{e&&(await this.resumePausedMutations(),Qe(this,Fi).onFocus())})),On(this,Qv,EN.subscribe(async e=>{e&&(await this.resumePausedMutations(),Qe(this,Fi).onOnline())})))}unmount(){var e,t;lC(this,Jh)._--,Qe(this,Jh)===0&&((e=Qe(this,Zv))==null||e.call(this),On(this,Zv,void 0),(t=Qe(this,Qv))==null||t.call(this),On(this,Qv,void 0))}isFetching(e){return Qe(this,Fi).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Qe(this,Yh).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Qe(this,Fi).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=Qe(this,Fi).build(this,t),i=n.state.data;return i===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(oU(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return Qe(this,Fi).findAll(e).map(({queryKey:t,state:n})=>{const i=n.data;return[t,i]})}setQueryData(e,t,n){const i=this.defaultQueryOptions({queryKey:e}),o=Qe(this,Fi).get(i.queryHash),u=o==null?void 0:o.state.data,h=TUe(t,u);if(h!==void 0)return Qe(this,Fi).build(this,i).setData(h,{...n,manual:!0})}setQueriesData(e,t,n){return Ds.batch(()=>Qe(this,Fi).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Qe(this,Fi).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Qe(this,Fi);Ds.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Qe(this,Fi);return Ds.batch(()=>(n.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},i=Ds.batch(()=>Qe(this,Fi).findAll(e).map(o=>o.cancel(n)));return Promise.all(i).then(Cl).catch(Cl)}invalidateQueries(e,t={}){return Ds.batch(()=>(Qe(this,Fi).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},i=Ds.batch(()=>Qe(this,Fi).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let u=o.fetch(void 0,n);return n.throwOnError||(u=u.catch(Cl)),o.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(i).then(Cl)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Qe(this,Fi).build(this,t);return n.isStaleByTime(oU(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Cl).catch(Cl)}fetchInfiniteQuery(e){return e.behavior=OZ(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Cl).catch(Cl)}ensureInfiniteQueryData(e){return e.behavior=OZ(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return EN.isOnline()?Qe(this,Yh).resumePausedMutations():Promise.resolve()}getQueryCache(){return Qe(this,Fi)}getMutationCache(){return Qe(this,Yh)}getDefaultOptions(){return Qe(this,Xh)}setDefaultOptions(e){On(this,Xh,e)}setQueryDefaults(e,t){Qe(this,Xv).set(T0(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Qe(this,Xv).values()],n={};return t.forEach(i=>{C0(e,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(e,t){Qe(this,Jv).set(T0(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Qe(this,Jv).values()],n={};return t.forEach(i=>{C0(e,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Qe(this,Xh).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=x4(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===T4&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Qe(this,Xh).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Qe(this,Fi).clear(),Qe(this,Yh).clear()}},Fi=new WeakMap,Yh=new WeakMap,Xh=new WeakMap,Xv=new WeakMap,Jv=new WeakMap,Jh=new WeakMap,Zv=new WeakMap,Qv=new WeakMap,yae),qUe=S.createContext(void 0),YUe=({client:e,children:t})=>(S.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(qUe.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},R0.apply(this,arguments)}var tf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(tf||(tf={}));const kZ="popstate";function XUe(e){e===void 0&&(e={});function t(i,o){let{pathname:u,search:h,hash:p}=i.location;return lU("",{pathname:u,search:h,hash:p},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(i,o){return typeof o=="string"?o:wN(o)}return ZUe(t,n,null,e)}function ea(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ace(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function JUe(){return Math.random().toString(36).substr(2,8)}function jZ(e,t){return{usr:e.state,key:e.key,idx:t}}function lU(e,t,n,i){return n===void 0&&(n=null),R0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Yy(t):t,{state:n,key:t&&t.key||i||JUe()})}function wN(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function Yy(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function ZUe(e,t,n,i){i===void 0&&(i={});let{window:o=document.defaultView,v5Compat:u=!1}=i,h=o.history,p=tf.Pop,g=null,v=b();v==null&&(v=0,h.replaceState(R0({},h.state,{idx:v}),""));function b(){return(h.state||{idx:null}).idx}function E(){p=tf.Pop;let O=b(),k=O==null?null:O-v;v=O,g&&g({action:p,location:N.location,delta:k})}function T(O,k){p=tf.Push;let j=lU(N.location,O,k);v=b()+1;let P=jZ(j,v),M=N.createHref(j);try{h.pushState(P,"",M)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;o.location.assign(M)}u&&g&&g({action:p,location:N.location,delta:1})}function C(O,k){p=tf.Replace;let j=lU(N.location,O,k);v=b();let P=jZ(j,v),M=N.createHref(j);h.replaceState(P,"",M),u&&g&&g({action:p,location:N.location,delta:0})}function R(O){let k=o.location.origin!=="null"?o.location.origin:o.location.href,j=typeof O=="string"?O:wN(O);return j=j.replace(/ $/,"%20"),ea(k,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,k)}let N={get action(){return p},get location(){return e(o,h)},listen(O){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(kZ,E),g=O,()=>{o.removeEventListener(kZ,E),g=null}},createHref(O){return t(o,O)},createURL:R,encodeLocation(O){let k=R(O);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:T,replace:C,go(O){return h.go(O)}};return N}var DZ;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(DZ||(DZ={}));function QUe(e,t,n){return n===void 0&&(n="/"),eFe(e,t,n)}function eFe(e,t,n,i){let o=typeof t=="string"?Yy(t):t,u=C4(o.pathname||"/",n);if(u==null)return null;let h=Ice(e);tFe(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let v=fFe(u);p=uFe(h[g],v)}return p}function Ice(e,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let o=(u,h,p)=>{let g={relativePath:p===void 0?u.path||"":p,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};g.relativePath.startsWith("/")&&(ea(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let v=pf([i,g.relativePath]),b=n.concat(g);u.children&&u.children.length>0&&(ea(u.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Ice(u.children,t,b,v)),!(u.path==null&&!u.index)&&t.push({path:v,score:cFe(v,u.index),routesMeta:b})};return e.forEach((u,h)=>{var p;if(u.path===""||!((p=u.path)!=null&&p.includes("?")))o(u,h);else for(let g of Oce(u.path))o(u,h,g)}),t}function Oce(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,o=n.endsWith("?"),u=n.replace(/\?$/,"");if(i.length===0)return o?[u,""]:[u];let h=Oce(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),o&&p.push(...h),p.map(g=>e.startsWith("/")&&g===""?"/":g)}function tFe(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:lFe(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const nFe=/^:[\w-]+$/,rFe=3,iFe=2,aFe=1,sFe=10,oFe=-2,LZ=e=>e==="*";function cFe(e,t){let n=e.split("/"),i=n.length;return n.some(LZ)&&(i+=oFe),t&&(i+=iFe),n.filter(o=>!LZ(o)).reduce((o,u)=>o+(nFe.test(u)?rFe:u===""?aFe:sFe),i)}function lFe(e,t){return e.length===t.length&&e.slice(0,-1).every((i,o)=>i===t[o])?e[e.length-1]-t[t.length-1]:0}function uFe(e,t,n){let{routesMeta:i}=e,o={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],v=p===i.length-1,b=u==="/"?t:t.slice(u.length)||"/",E=dFe({path:g.relativePath,caseSensitive:g.caseSensitive,end:v},b),T=g.route;if(!E)return null;Object.assign(o,E.params),h.push({params:o,pathname:pf([u,E.pathname]),pathnameBase:vFe(pf([u,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(u=pf([u,E.pathnameBase]))}return h}function dFe(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=hFe(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let u=o[0],h=u.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:i.reduce((v,b,E)=>{let{paramName:T,isOptional:C}=b;if(T==="*"){let N=p[E]||"";h=u.slice(0,u.length-N.length).replace(/(.)\/+$/,"$1")}const R=p[E];return C&&!R?v[T]=void 0:v[T]=(R||"").replace(/%2F/g,"/"),v},{}),pathname:u,pathnameBase:h,pattern:e}}function hFe(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Ace(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),i]}function fFe(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ace(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function C4(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function pFe(e,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:o=""}=typeof e=="string"?Yy(e):e;return{pathname:n?n.startsWith("/")?n:mFe(n,t):t,search:yFe(i),hash:_Fe(o)}}function mFe(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function q2(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gFe(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function R4(e,t){let n=gFe(e);return t?n.map((i,o)=>o===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function N4(e,t,n,i){i===void 0&&(i=!1);let o;typeof e=="string"?o=Yy(e):(o=R0({},e),ea(!o.pathname||!o.pathname.includes("?"),q2("?","pathname","search",o)),ea(!o.pathname||!o.pathname.includes("#"),q2("#","pathname","hash",o)),ea(!o.search||!o.search.includes("#"),q2("#","search","hash",o)));let u=e===""||o.pathname==="",h=u?"/":o.pathname,p;if(h==null)p=n;else{let E=t.length-1;if(!i&&h.startsWith("..")){let T=h.split("/");for(;T[0]==="..";)T.shift(),E-=1;o.pathname=T.join("/")}p=E>=0?t[E]:"/"}let g=pFe(o,p),v=h&&h!=="/"&&h.endsWith("/"),b=(u||h===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(v||b)&&(g.pathname+="/"),g}const pf=e=>e.join("/").replace(/\/\/+/g,"/"),vFe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),yFe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,_Fe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bFe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Pce=["post","put","patch","delete"];new Set(Pce);const EFe=["get",...Pce];new Set(EFe);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},N0.apply(this,arguments)}const A4=S.createContext(null),wFe=S.createContext(null),Pf=S.createContext(null),E1=S.createContext(null),Hu=S.createContext({outlet:null,matches:[],isDataRoute:!1}),kce=S.createContext(null);function SFe(e,t){let{relative:n}=t===void 0?{}:t;Xy()||ea(!1);let{basename:i,navigator:o}=S.useContext(Pf),{hash:u,pathname:h,search:p}=Dce(e,{relative:n}),g=h;return i!=="/"&&(g=h==="/"?i:pf([i,h])),o.createHref({pathname:g,search:p,hash:u})}function Xy(){return S.useContext(E1)!=null}function Gc(){return Xy()||ea(!1),S.useContext(E1).location}function jce(e){S.useContext(Pf).static||S.useLayoutEffect(e)}function tr(){let{isDataRoute:e}=S.useContext(Hu);return e?UFe():xFe()}function xFe(){Xy()||ea(!1);let e=S.useContext(A4),{basename:t,future:n,navigator:i}=S.useContext(Pf),{matches:o}=S.useContext(Hu),{pathname:u}=Gc(),h=JSON.stringify(R4(o,n.v7_relativeSplatPath)),p=S.useRef(!1);return jce(()=>{p.current=!0}),S.useCallback(function(v,b){if(b===void 0&&(b={}),!p.current)return;if(typeof v=="number"){i.go(v);return}let E=N4(v,JSON.parse(h),u,b.relative==="path");e==null&&t!=="/"&&(E.pathname=E.pathname==="/"?t:pf([t,E.pathname])),(b.replace?i.replace:i.push)(E,b.state,b)},[t,i,h,u,e])}const TFe=S.createContext(null);function CFe(e){let t=S.useContext(Hu).outlet;return t&&S.createElement(TFe.Provider,{value:e},t)}function tc(){let{matches:e}=S.useContext(Hu),t=e[e.length-1];return t?t.params:{}}function Dce(e,t){let{relative:n}=t===void 0?{}:t,{future:i}=S.useContext(Pf),{matches:o}=S.useContext(Hu),{pathname:u}=Gc(),h=JSON.stringify(R4(o,i.v7_relativeSplatPath));return S.useMemo(()=>N4(e,JSON.parse(h),u,n==="path"),[e,h,u,n])}function RFe(e,t){return NFe(e,t)}function NFe(e,t,n,i){Xy()||ea(!1);let{navigator:o}=S.useContext(Pf),{matches:u}=S.useContext(Hu),h=u[u.length-1],p=h?h.params:{};h&&h.pathname;let g=h?h.pathnameBase:"/";h&&h.route;let v=Gc(),b;if(t){var E;let O=typeof t=="string"?Yy(t):t;g==="/"||(E=O.pathname)!=null&&E.startsWith(g)||ea(!1),b=O}else b=v;let T=b.pathname||"/",C=T;if(g!=="/"){let O=g.replace(/^\//,"").split("/");C="/"+T.replace(/^\//,"").split("/").slice(O.length).join("/")}let R=QUe(e,{pathname:C}),N=kFe(R&&R.map(O=>Object.assign({},O,{params:Object.assign({},p,O.params),pathname:pf([g,o.encodeLocation?o.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?g:pf([g,o.encodeLocation?o.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),u,n,i);return t&&N?S.createElement(E1.Provider,{value:{location:N0({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:tf.Pop}},N):N}function AFe(){let e=MFe(),t=bFe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:o},n):null,null)}const IFe=S.createElement(AFe,null);class OFe extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?S.createElement(Hu.Provider,{value:this.props.routeContext},S.createElement(kce.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PFe(e){let{routeContext:t,match:n,children:i}=e,o=S.useContext(A4);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(Hu.Provider,{value:t},i)}function kFe(e,t,n,i){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),e==null){var u;if(!n)return null;if(n.errors)e=n.matches;else if((u=i)!=null&&u.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let h=e,p=(o=n)==null?void 0:o.errors;if(p!=null){let b=h.findIndex(E=>E.route.id&&(p==null?void 0:p[E.route.id])!==void 0);b>=0||ea(!1),h=h.slice(0,Math.min(h.length,b+1))}let g=!1,v=-1;if(n&&i&&i.v7_partialHydration)for(let b=0;b<h.length;b++){let E=h[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(v=b),E.route.id){let{loaderData:T,errors:C}=n,R=E.route.loader&&T[E.route.id]===void 0&&(!C||C[E.route.id]===void 0);if(E.route.lazy||R){g=!0,v>=0?h=h.slice(0,v+1):h=[h[0]];break}}}return h.reduceRight((b,E,T)=>{let C,R=!1,N=null,O=null;n&&(C=p&&E.route.id?p[E.route.id]:void 0,N=E.route.errorElement||IFe,g&&(v<0&&T===0?(FFe("route-fallback"),R=!0,O=null):v===T&&(R=!0,O=E.route.hydrateFallbackElement||null)));let k=t.concat(h.slice(0,T+1)),j=()=>{let P;return C?P=N:R?P=O:E.route.Component?P=S.createElement(E.route.Component,null):E.route.element?P=E.route.element:P=b,S.createElement(PFe,{match:E,routeContext:{outlet:b,matches:k,isDataRoute:n!=null},children:P})};return n&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?S.createElement(OFe,{location:n.location,revalidation:n.revalidation,component:N,error:C,children:j(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):j()},null)}var Lce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Lce||{}),Mce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Mce||{});function jFe(e){let t=S.useContext(A4);return t||ea(!1),t}function DFe(e){let t=S.useContext(wFe);return t||ea(!1),t}function LFe(e){let t=S.useContext(Hu);return t||ea(!1),t}function Uce(e){let t=LFe(),n=t.matches[t.matches.length-1];return n.route.id||ea(!1),n.route.id}function MFe(){var e;let t=S.useContext(kce),n=DFe(),i=Uce();return t!==void 0?t:(e=n.errors)==null?void 0:e[i]}function UFe(){let{router:e}=jFe(Lce.UseNavigateStable),t=Uce(Mce.UseNavigateStable),n=S.useRef(!1);return jce(()=>{n.current=!0}),S.useCallback(function(o,u){u===void 0&&(u={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,N0({fromRouteId:t},u)))},[e,t])}const MZ={};function FFe(e,t,n){MZ[e]||(MZ[e]=!0)}function VFe(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Fce(e){let{to:t,replace:n,state:i,relative:o}=e;Xy()||ea(!1);let{future:u,static:h}=S.useContext(Pf),{matches:p}=S.useContext(Hu),{pathname:g}=Gc(),v=tr(),b=N4(t,R4(p,u.v7_relativeSplatPath),g,o==="path"),E=JSON.stringify(b);return S.useEffect(()=>v(JSON.parse(E),{replace:n,state:i,relative:o}),[v,E,o,n,i]),null}function BFe(e){return CFe(e.context)}function Lt(e){ea(!1)}function $Fe(e){let{basename:t="/",children:n=null,location:i,navigationType:o=tf.Pop,navigator:u,static:h=!1,future:p}=e;Xy()&&ea(!1);let g=t.replace(/^\/*/,"/"),v=S.useMemo(()=>({basename:g,navigator:u,static:h,future:N0({v7_relativeSplatPath:!1},p)}),[g,p,u,h]);typeof i=="string"&&(i=Yy(i));let{pathname:b="/",search:E="",hash:T="",state:C=null,key:R="default"}=i,N=S.useMemo(()=>{let O=C4(b,g);return O==null?null:{location:{pathname:O,search:E,hash:T,state:C,key:R},navigationType:o}},[g,b,E,T,C,R,o]);return N==null?null:S.createElement(Pf.Provider,{value:v},S.createElement(E1.Provider,{children:n,value:N}))}function WFe(e){let{children:t,location:n}=e;return RFe(uU(t),n)}new Promise(()=>{});function uU(e,t){t===void 0&&(t=[]);let n=[];return S.Children.forEach(e,(i,o)=>{if(!S.isValidElement(i))return;let u=[...t,o];if(i.type===S.Fragment){n.push.apply(n,uU(i.props.children,u));return}i.type!==Lt&&ea(!1),!i.props.index||!i.props.children||ea(!1);let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=uU(i.props.children,u)),n.push(h)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dU(){return dU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dU.apply(this,arguments)}function GFe(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,u;for(u=0;u<i.length;u++)o=i[u],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function HFe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function zFe(e,t){return e.button===0&&(!t||t==="_self")&&!HFe(e)}function hU(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(o=>[n,o]):[[n,i]])},[]))}function KFe(e,t){let n=hU(e);return t&&t.forEach((i,o)=>{n.has(o)||t.getAll(o).forEach(u=>{n.append(o,u)})}),n}const qFe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],YFe="6";try{window.__reactRouterVersion=YFe}catch{}const XFe="startTransition",UZ=a0[XFe];function JFe(e){let{basename:t,children:n,future:i,window:o}=e,u=S.useRef();u.current==null&&(u.current=XUe({window:o,v5Compat:!0}));let h=u.current,[p,g]=S.useState({action:h.action,location:h.location}),{v7_startTransition:v}=i||{},b=S.useCallback(E=>{v&&UZ?UZ(()=>g(E)):g(E)},[g,v]);return S.useLayoutEffect(()=>h.listen(b),[h,b]),S.useEffect(()=>VFe(i),[i]),S.createElement($Fe,{basename:t,children:n,location:p.location,navigationType:p.action,navigator:h,future:i})}const ZFe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",QFe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Nt=S.forwardRef(function(t,n){let{onClick:i,relative:o,reloadDocument:u,replace:h,state:p,target:g,to:v,preventScrollReset:b,viewTransition:E}=t,T=GFe(t,qFe),{basename:C}=S.useContext(Pf),R,N=!1;if(typeof v=="string"&&QFe.test(v)&&(R=v,ZFe))try{let P=new URL(window.location.href),M=v.startsWith("//")?new URL(P.protocol+v):new URL(v),D=C4(M.pathname,C);M.origin===P.origin&&D!=null?v=D+M.search+M.hash:N=!0}catch{}let O=SFe(v,{relative:o}),k=eVe(v,{replace:h,state:p,target:g,preventScrollReset:b,relative:o,viewTransition:E});function j(P){i&&i(P),P.defaultPrevented||k(P)}return S.createElement("a",dU({},T,{href:R||O,onClick:N||u?i:j,ref:n,target:g}))});var FZ;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(FZ||(FZ={}));var VZ;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(VZ||(VZ={}));function eVe(e,t){let{target:n,replace:i,state:o,preventScrollReset:u,relative:h,viewTransition:p}=t===void 0?{}:t,g=tr(),v=Gc(),b=Dce(e,{relative:h});return S.useCallback(E=>{if(zFe(E,n)){E.preventDefault();let T=i!==void 0?i:wN(v)===wN(b);g(e,{replace:T,state:o,preventScrollReset:u,relative:h,viewTransition:p})}},[v,g,b,i,o,n,e,u,h,p])}function Jy(e){let t=S.useRef(hU(e)),n=S.useRef(!1),i=Gc(),o=S.useMemo(()=>KFe(i.search,n.current?null:t.current),[i.search]),u=tr(),h=S.useCallback((p,g)=>{const v=hU(typeof p=="function"?p(o):p);n.current=!0,u("?"+v,g)},[u,o]);return[o,h]}const Vce=[{id:"1",firstname:"John",lastname:"Doe",username:"John Doe",email:"john@example.com",password:"password123",profileImage:"https://i.pravatar.cc/150?img=1",coverImage:"https://images.unsplash.com/photo-1477346611705-65d1883cee1e",bio:"Software developer and technology enthusiast",friends:["2","3"],createdAt:new Date(2023,0,15).toISOString()},{id:"2",firstname:"Jane",lastname:"Smith",username:"Jane Smith",email:"jane@example.com",password:"password123",profileImage:"https://i.pravatar.cc/150?img=2",coverImage:"https://images.unsplash.com/photo-1498736297812-3a08021f206f",bio:"Digital marketing specialist | Coffee lover",friends:["1"],createdAt:new Date(2023,1,20).toISOString()},{id:"3",firstname:"Robert",lastname:"Johnson",username:"Robert Johnson",email:"robert@example.com",password:"password123",profileImage:"https://i.pravatar.cc/150?img=3",coverImage:"https://images.unsplash.com/photo-1477959858617-67f85cf4f1df",bio:"Photographer and travel enthusiast",friends:["1"],createdAt:new Date(2023,2,10).toISOString()}],tVe=[{id:"1",userId:"1",content:"Just finished working on a new project! Can't wait to share it with everyone.",images:["https://images.unsplash.com/photo-1519389950473-47ba0277781c"],videos:[],likes:["2","3"],comments:[{id:"1",userId:"2",content:"Looks amazing! Can't wait to see it.",createdAt:new Date(2023,3,5,9,30).toISOString()}],createdAt:new Date(2023,3,5,9,0).toISOString()},{id:"2",userId:"2",content:"Beautiful day at the beach! 🌊☀️",images:["https://images.unsplash.com/photo-1507525428034-b723cf961d3e"],videos:[],likes:["1"],comments:[{id:"2",userId:"1",content:"Wow! Looks incredible.",createdAt:new Date(2023,3,6,14,15).toISOString()},{id:"3",userId:"3",content:"I need a vacation like this!",createdAt:new Date(2023,3,6,15,0).toISOString()}],createdAt:new Date(2023,3,6,13,45).toISOString()},{id:"3",userId:"3",content:"Check out this amazing timelapse I shot yesterday!",images:[],videos:["https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4"],likes:["1","2"],comments:[],createdAt:new Date(2023,3,7,10,30).toISOString()}],nVe=()=>{const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null},rVe=()=>{const e=localStorage.getItem("users");return e?JSON.parse(e):Vce},iVe=e=>{localStorage.setItem("users",JSON.stringify(e))},aVe=()=>{localStorage.getItem("users")||localStorage.setItem("users",JSON.stringify(Vce)),localStorage.getItem("posts")||localStorage.setItem("posts",JSON.stringify(tVe))},Wd="https://api.gada.chat";async function Sm(e){const t=await e.json();if(!e.ok){const n=t.message??"Something went wrong";throw new Error(n)}return t}async function sVe(e,t){const n=await fetch(`${Wd}/api/signin`,{method:"POST",headers:t,body:JSON.stringify(e)});return Sm(n)}async function oVe(e){const t=await fetch(`${Wd}/api/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return Sm(t)}async function cVe(e){const t=await fetch(`${Wd}/api/resend-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return Sm(t)}async function lVe(e){const t=await fetch(`${Wd}/api/sendForgotOtp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return Sm(t)}async function uVe(e){const t=await fetch(`${Wd}/api/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return Sm(t)}async function dVe(e,t){const n=await fetch(`${Wd}/api/activation`,{method:"POST",headers:t,body:JSON.stringify(e)});return Sm(n)}async function hVe(e,t){const n=await fetch(`${Wd}/api/signUp`,{method:"POST",headers:t,body:JSON.stringify(e)});return Sm(n)}async function fVe(e,t,n,i){const o=new FormData;if(o.append("avatar",t),i=="cover"){const u=await fetch(`${Wd}/api/users/${e}/cover`,{method:"PUT",credentials:"include",headers:n,body:o});if(!u.ok)throw new Error("Upload failed");const{avatarUrl:h}=await u.json();return h}else{const u=await fetch(`${Wd}/api/users/${e}/avatar`,{method:"PUT",credentials:"include",headers:n,body:o});if(!u.ok)throw new Error("Upload failed");const{avatarUrl:h}=await u.json();return h}}function Hl(e){return e?{Authorization:`Bearer ${e}`}:{"Content-Type":"application/json"}}function wt(e){return e?{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"}}function Kn(e){if(!e||/^data:/.test(e))return e;try{const t=new URL(e),n=t.pathname.split("/").filter(i=>i&&i!=="uploads").join("/");return t.pathname="/"+n,t.toString()}catch{const t=e.match(/^([^?#]*)([?#].*)?$/),n=(t==null?void 0:t[1])??e,i=(t==null?void 0:t[2])??"",o=n.startsWith("/"),u=n.split("/").filter(h=>h&&h!=="uploads").join("/");return(o?"/":"")+u+i}}const Bce=S.createContext(void 0);function pVe({children:e}){const[t,n]=S.useState(null),[i,o]=S.useState(!0),[u,h]=S.useState(null);S.useEffect(()=>{const O=localStorage.getItem("accessToken"),k=localStorage.getItem("UserData");O&&h(O),nVe(),k&&n(JSON.parse(k)),o(!1)},[]);const N={user:t,login:async(O,k)=>{let j={email:O,password:k},P=wt(u);await new Promise(U=>setTimeout(U,500));const{token:M,user:D}=await sVe(j,P);if(M&&D){let U={id:D.user_id,firstname:D.user_firstname,lastname:D.user_firstname,username:D.user_name,email:D.user_email,profileImage:D.user_picture?"/uploads/"+Kn(D.user_picture):"/uploads//profile/defaultavatar.png",coverImage:D.user_coverImage,password:"",bio:"",createdAt:"",friends:[],walletBalance:D.user_wallet_balance,roles:D.role,packageactive:D.packageactive,packageName:D.packageName};return n(U),h(M),localStorage.setItem("accessToken",M),localStorage.setItem("UserData",JSON.stringify(U)),!0}return!1},register:async(O,k,j,P,M,D)=>{await new Promise(K=>setTimeout(K,500));const U=rVe(),V={id:wUe(),firstname:O,lastname:k,username:j,email:P,password:M,profileImage:`https://i.pravatar.cc/150?u=${P}`,coverImage:"https://images.unsplash.com/photo-1477346611705-65d1883cee1e",bio:"",friends:[],createdAt:new Date().toISOString(),referral:D};let z={"Content-Type":"application/json"};console.log(V,"newUsernewUsernewUser");const{token:W,user:Y}=await hVe(V,z),Q=[...U,V];return iVe(Q),n(V),!0},forgotpassword:async(O,k)=>{console.log("flsnfjnsdijofn");let j={email:O,otp:k};await new Promise(M=>setTimeout(M,500));const P=await oVe(j);return P!=null&&P.status?(console.log("Password reset instructions sent to email."),!0):!1},resetpassword:async(O,k,j)=>{let P={email:O,otp:k,password:j};await new Promise(D=>setTimeout(D,500));const M=await uVe(P);return M!=null&&M.status?(console.log("Password updated successfully."),!0):!1},resendOtp:async O=>{let k={email:O};await new Promise(P=>setTimeout(P,500));const j=await cVe(k);return j!=null&&j.status?(console.log("OTP resend to email"),!0):!1},sendOtp:async O=>{let k={email:O};await new Promise(P=>setTimeout(P,500));const j=await lVe(k);return j!=null&&j.status?(console.log("OTP send to email"),!0):!1},updateProfile:O=>{if(!t)return;console.log(O,"updatesupdatesupdates");const k={profileImage:"/uploads/"+Kn(O.profileImage)},j={...t,...k};n(j)},logout:()=>{n(null),h(null),localStorage.clear()},isLoading:i,accessToken:u};return c.jsx(Bce.Provider,{value:N,children:e})}function st(){const e=S.useContext(Bce);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const zu="https://api.gada.chat";async function xm(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error(t&&(t.error||t.message)||"Request failed");return t}async function mVe(e,t){if(!e||e.length===0)return[];const n=new FormData;e.forEach(u=>n.append("files",u));const i=await fetch(`${zu}/api/media/upload`,{method:"POST",body:n,headers:t,credentials:"include"}),{urls:o}=await xm(i);return o.map(u=>({url:u,type:u.match(/\/videos\//)?"video":"image"}))}async function oE(e){const t=await fetch(`${zu}/api/posts?withPromoted=1`,{headers:e,credentials:"include"});return xm(t)}async function $ce(e,t){const n=await fetch(`${zu}/api/posts/${e}`,{headers:t,credentials:"include"});return xm(n)}async function gVe(e,t,n,i){const o=await fetch(`${zu}/api/posts`,{method:"POST",headers:i,body:JSON.stringify({userId:Number(e),content:t,media:n})});return xm(o)}async function vVe(e,t,n){const i=await fetch(`${zu}/api/posts/${e}/react`,{method:"POST",headers:{...n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({reaction:"like"})});return xm(i)}async function yVe(e,t,n,i){const o=await fetch(`${zu}/api/posts/${e}/comment`,{method:"POST",headers:{...i,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:n})});return xm(o)}async function _Ve(e,t,n){const i=await fetch(`${zu}/api/posts/${e}/share`,{method:"POST",headers:n,credentials:"include"});return xm(i)}async function bVe(e,t){if(!(await fetch(`${zu}/api/saves`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({postId:e})})).ok)throw new Error("Save post failed")}async function EVe(e,t){if(!(await fetch(`${zu}/api/saves/${e}`,{method:"DELETE",credentials:"include",headers:t})).ok)throw new Error("Unsave post failed")}async function wVe(e){const t=await fetch(`${zu}/api/saves`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to load saved posts");return t.json()}const Wce=S.createContext(void 0),SVe=({children:e})=>{const{accessToken:t,user:n}=st(),i=wt(t),o=Hl(t),[u,h]=S.useState([]);S.useEffect(()=>{t&&oE(i).then(h).catch(console.error)},[t,n]);async function p(T,C,R){const N=await mVe([...C,...R],o);await gVe(n.id,T,N,i)&&(Ce.success("Post has been created successfully"),oE(i).then(h).catch(console.error))}const g=async T=>{await vVe(T,n.id,i),oE(i).then(h).catch(console.error)},v=async(T,C)=>{await yVe(T,n.id,C,i)&&oE(i).then(h).catch(console.error)},b=async(T,C)=>{await _Ve(T,C,i),Ce.success("Post has been shared successfully");try{const R=await oE(i);h(R)}catch(R){console.error(R)}},E=async(T,C)=>{C?await EVe(T,i):await bVe(T,i),h(R=>R.map(N=>N.id===T?{...N,hasSaved:!C}:N))};return c.jsx(Wce.Provider,{value:{posts:u,addPost:p,likePost:g,commentPost:v,sharePost:b,toggleSave:E},children:e})},w1=()=>{const e=S.useContext(Wce);if(!e)throw new Error("usePost must be used within PostProvider");return e},Gce="https://api.gada.chat";async function xVe(e,t,n){const i=new FormData;i.append("file",e),i.append("meta",JSON.stringify(t));const o=await fetch(`${Gce}/api/stories`,{method:"POST",headers:n,body:i});if(!o.ok)throw new Error(`uploadStory failed: ${o.status}`);const u=await o.json();return{url:u.url,type:u.type,meta:u.meta||{}}}async function BZ(e){const t=await fetch(`${Gce}/api/stories`,{headers:e});if(!t.ok)throw new Error(`fetchStories failed: ${t.status}`);return await t.json()}const Hce=S.createContext(null);function TVe({children:e}){const{user:t,accessToken:n}=st(),[i,o]=S.useState([]),u=wt(n),h=Hl(n);S.useEffect(()=>{if(!n)return;BZ(u).then(o).catch(console.error);const g=setInterval(()=>BZ(u).then(o).catch(()=>{}),6e4);return()=>clearInterval(g)},[n]);const p=async(g,v)=>{const{url:b,type:E,meta:T}=await xVe(g,v,h);o(C=>{const R=C.findIndex(O=>String(O.userId)===String(t.id??t.userId)),N={url:b,type:E,meta:T||v};if(R>=0){const O=[...C];return O[R]={...O[R],stories:[...O[R].stories,N]},O}return[...C,{userId:t.id??t.userId,username:t.name??t.username??"You",avatar:t.profileImage??"",stories:[N]}]}),Ce.success("Story published")};return c.jsx(Hce.Provider,{value:{stories:i,addStory:p},children:e})}const CVe=()=>S.useContext(Hce);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RVe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zce=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var NVe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AVe=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:h,...p},g)=>S.createElement("svg",{ref:g,...NVe,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:zce("lucide",o),...p},[...h.map(([v,b])=>S.createElement(v,b)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=(e,t)=>{const n=S.forwardRef(({className:i,...o},u)=>S.createElement(AVe,{ref:u,iconNode:t,className:zce(`lucide-${RVe(e)}`,i),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IVe=ct("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OVe=ct("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PVe=ct("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kVe=ct("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Z=ct("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=ct("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jVe=ct("BookmarkMinus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=ct("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DVe=ct("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LVe=ct("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=ct("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=ct("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=ct("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MVe=ct("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fU=ct("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=ct("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=ct("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=ct("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=ct("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=ct("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=ct("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WZ=ct("CircleArrowOutDownRight",[["path",{d:"M12 22a10 10 0 1 1 10-10",key:"130bv5"}],["path",{d:"M22 22 12 12",key:"131aw7"}],["path",{d:"M22 16v6h-6",key:"1gvm70"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UVe=ct("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=ct("CircleDollarSign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FVe=ct("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kce=ct("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GZ=ct("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=ct("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qce=ct("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VVe=ct("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=ct("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BVe=ct("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HZ=ct("Currency",[["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}],["line",{x1:"3",x2:"6",y1:"3",y2:"6",key:"1jkytn"}],["line",{x1:"21",x2:"18",y1:"3",y2:"6",key:"14zfjt"}],["line",{x1:"3",x2:"6",y1:"21",y2:"18",key:"iusuec"}],["line",{x1:"21",x2:"18",y1:"21",y2:"18",key:"yj2dd7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Ve=ct("Delete",[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zZ=ct("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yce=ct("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xce=ct("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pU=ct("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=ct("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WVe=ct("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=ct("FilePlus2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=ct("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GVe=ct("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=ct("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HVe=ct("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=ct("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mU=ct("Group",[["path",{d:"M3 7V5c0-1.1.9-2 2-2h2",key:"adw53z"}],["path",{d:"M17 3h2c1.1 0 2 .9 2 2v2",key:"an4l38"}],["path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2",key:"144t0e"}],["path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2",key:"rtnfgi"}],["rect",{width:"7",height:"5",x:"7",y:"7",rx:"1",key:"1eyiv7"}],["rect",{width:"7",height:"5",x:"10",y:"12",rx:"1",key:"1qlmkx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jce=ct("HandCoins",[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KZ=ct("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gU=ct("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zce=ct("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=ct("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zVe=ct("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KVe=ct("LandPlot",[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=ct("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qVe=ct("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=ct("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qZ=ct("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YVe=ct("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XVe=ct("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=ct("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qce=ct("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=ct("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=ct("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JVe=ct("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZVe=ct("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ele=ct("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QVe=ct("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4e=ct("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YZ=ct("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tle=ct("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4e=ct("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4e=ct("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4e=ct("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=ct("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nle=ct("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4e=ct("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=ct("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=ct("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rle=ct("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ile=ct("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=ct("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=ct("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4e=ct("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4e=ct("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ale=ct("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XZ=ct("Tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JZ=ct("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=ct("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=ct("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZZ=ct("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4e=ct("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4e=ct("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=ct("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QZ=ct("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4e=ct("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=ct("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4e=ct("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=ct("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4e=ct("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4e=ct("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=ct("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=ct("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),eQ=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,tQ=er,Uw=(e,t)=>n=>{var i;if((t==null?void 0:t.variants)==null)return tQ(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:u}=t,h=Object.keys(o).map(v=>{const b=n==null?void 0:n[v],E=u==null?void 0:u[v];if(b===null)return null;const T=eQ(b)||eQ(E);return o[v][T]}),p=n&&Object.entries(n).reduce((v,b)=>{let[E,T]=b;return T===void 0||(v[E]=T),v},{}),g=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((v,b)=>{let{class:E,className:T,...C}=b;return Object.entries(C).every(R=>{let[N,O]=R;return Array.isArray(O)?O.includes({...u,...p}[N]):{...u,...p}[N]===O})?[...v,E,T]:v},[]);return tQ(e,h,g,n==null?void 0:n.class,n==null?void 0:n.className)},sle=Uw("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),be=S.forwardRef(({className:e,variant:t,size:n,asChild:i=!1,...o},u)=>{const h=i?koe:"button";return c.jsx(h,{className:kt(sle({variant:t,size:n,className:e})),ref:u,...o})});be.displayName="Button";const wi=S.forwardRef(({className:e,...t},n)=>c.jsx("textarea",{className:kt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));wi.displayName="Textarea";var ole={exports:{}},cle={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy=S;function f4e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var p4e=typeof Object.is=="function"?Object.is:f4e,m4e=hy.useState,g4e=hy.useEffect,v4e=hy.useLayoutEffect,y4e=hy.useDebugValue;function _4e(e,t){var n=t(),i=m4e({inst:{value:n,getSnapshot:t}}),o=i[0].inst,u=i[1];return v4e(function(){o.value=n,o.getSnapshot=t,J2(o)&&u({inst:o})},[e,n,t]),g4e(function(){return J2(o)&&u({inst:o}),e(function(){J2(o)&&u({inst:o})})},[e]),y4e(n),n}function J2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!p4e(e,n)}catch{return!0}}function b4e(e,t){return t()}var E4e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?b4e:_4e;cle.useSyncExternalStore=hy.useSyncExternalStore!==void 0?hy.useSyncExternalStore:E4e;ole.exports=cle;var w4e=ole.exports;function S4e(){return w4e.useSyncExternalStore(x4e,()=>!0,()=>!1)}function x4e(){return()=>{}}var V4="Avatar",[T4e,ZSt]=Vs(V4),[C4e,lle]=T4e(V4),ule=S.forwardRef((e,t)=>{const{__scopeAvatar:n,...i}=e,[o,u]=S.useState("idle");return c.jsx(C4e,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:u,children:c.jsx(en.span,{...i,ref:t})})});ule.displayName=V4;var dle="AvatarImage",hle=S.forwardRef((e,t)=>{const{__scopeAvatar:n,src:i,onLoadingStatusChange:o=()=>{},...u}=e,h=lle(dle,n),p=R4e(i,u),g=Ba(v=>{o(v),h.onImageLoadingStatusChange(v)});return va(()=>{p!=="idle"&&g(p)},[p,g]),p==="loaded"?c.jsx(en.img,{...u,ref:t,src:i}):null});hle.displayName=dle;var fle="AvatarFallback",ple=S.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:i,...o}=e,u=lle(fle,n),[h,p]=S.useState(i===void 0);return S.useEffect(()=>{if(i!==void 0){const g=window.setTimeout(()=>p(!0),i);return()=>window.clearTimeout(g)}},[i]),h&&u.imageLoadingStatus!=="loaded"?c.jsx(en.span,{...o,ref:t}):null});ple.displayName=fle;function nQ(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function R4e(e,{referrerPolicy:t,crossOrigin:n}){const i=S4e(),o=S.useRef(null),u=i?(o.current||(o.current=new window.Image),o.current):null,[h,p]=S.useState(()=>nQ(u,e));return va(()=>{p(nQ(u,e))},[u,e]),va(()=>{const g=E=>()=>{p(E)};if(!u)return;const v=g("loaded"),b=g("error");return u.addEventListener("load",v),u.addEventListener("error",b),t&&(u.referrerPolicy=t),typeof n=="string"&&(u.crossOrigin=n),()=>{u.removeEventListener("load",v),u.removeEventListener("error",b)}},[u,n,t]),h}var mle=ule,gle=hle,vle=ple;const $i=S.forwardRef(({className:e,...t},n)=>c.jsx(mle,{ref:n,className:kt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));$i.displayName=mle.displayName;const Oi=S.forwardRef(({className:e,...t},n)=>c.jsx(gle,{ref:n,className:kt("aspect-square h-full w-full",e),...t}));Oi.displayName=gle.displayName;const Qi=S.forwardRef(({className:e,...t},n)=>c.jsx(vle,{ref:n,className:kt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));Qi.displayName=vle.displayName;const Vr=S.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:kt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Vr.displayName="Card";const pa=S.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:kt("flex flex-col space-y-1.5 p-6",e),...t}));pa.displayName="CardHeader";const Wa=S.forwardRef(({className:e,...t},n)=>c.jsx("h3",{ref:n,className:kt("text-2xl font-semibold leading-none tracking-tight",e),...t}));Wa.displayName="CardTitle";const Qy=S.forwardRef(({className:e,...t},n)=>c.jsx("p",{ref:n,className:kt("text-sm text-muted-foreground",e),...t}));Qy.displayName="CardDescription";const mi=S.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:kt("p-6 pt-0",e),...t}));mi.displayName="CardContent";const e_=S.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:kt("flex items-center p-6 pt-0",e),...t}));e_.displayName="CardFooter";const Ne=S.forwardRef(({className:e,type:t,onInput:n,...i},o)=>{const u=h=>{const p=i.maxLength;t==="number"&&p&&(h.currentTarget.value=h.currentTarget.value.slice(0,p)),n&&n(h)};return c.jsx("input",{type:t,className:kt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:o,onInput:u,...i})});Ne.displayName="Input";var Z2="focusScope.autoFocusOnMount",Q2="focusScope.autoFocusOnUnmount",rQ={bubbles:!1,cancelable:!0},N4e="FocusScope",Fw=S.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:o,onUnmountAutoFocus:u,...h}=e,[p,g]=S.useState(null),v=Ba(o),b=Ba(u),E=S.useRef(null),T=Dn(t,N=>g(N)),C=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(i){let N=function(P){if(C.paused||!p)return;const M=P.target;p.contains(M)?E.current=M:Fh(E.current,{select:!0})},O=function(P){if(C.paused||!p)return;const M=P.relatedTarget;M!==null&&(p.contains(M)||Fh(E.current,{select:!0}))},k=function(P){if(document.activeElement===document.body)for(const D of P)D.removedNodes.length>0&&Fh(p)};document.addEventListener("focusin",N),document.addEventListener("focusout",O);const j=new MutationObserver(k);return p&&j.observe(p,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",O),j.disconnect()}}},[i,p,C.paused]),S.useEffect(()=>{if(p){aQ.add(C);const N=document.activeElement;if(!p.contains(N)){const k=new CustomEvent(Z2,rQ);p.addEventListener(Z2,v),p.dispatchEvent(k),k.defaultPrevented||(A4e(j4e(yle(p)),{select:!0}),document.activeElement===N&&Fh(p))}return()=>{p.removeEventListener(Z2,v),setTimeout(()=>{const k=new CustomEvent(Q2,rQ);p.addEventListener(Q2,b),p.dispatchEvent(k),k.defaultPrevented||Fh(N??document.body,{select:!0}),p.removeEventListener(Q2,b),aQ.remove(C)},0)}}},[p,v,b,C]);const R=S.useCallback(N=>{if(!n&&!i||C.paused)return;const O=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,k=document.activeElement;if(O&&k){const j=N.currentTarget,[P,M]=I4e(j);P&&M?!N.shiftKey&&k===M?(N.preventDefault(),n&&Fh(P,{select:!0})):N.shiftKey&&k===P&&(N.preventDefault(),n&&Fh(M,{select:!0})):k===j&&N.preventDefault()}},[n,i,C.paused]);return c.jsx(en.div,{tabIndex:-1,...h,ref:T,onKeyDown:R})});Fw.displayName=N4e;function A4e(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if(Fh(i,{select:t}),document.activeElement!==n)return}function I4e(e){const t=yle(e),n=iQ(t,e),i=iQ(t.reverse(),e);return[n,i]}function yle(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const o=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||o?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function iQ(e,t){for(const n of e)if(!O4e(n,{upTo:t}))return n}function O4e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function P4e(e){return e instanceof HTMLInputElement&&"select"in e}function Fh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&P4e(e)&&t&&e.select()}}var aQ=k4e();function k4e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=sQ(e,t),e.unshift(t)},remove(t){var n;e=sQ(e,t),(n=e[0])==null||n.resume()}}}function sQ(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function j4e(e){return e.filter(t=>t.tagName!=="A")}var eL=0;function C1(){S.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??oQ()),document.body.insertAdjacentElement("beforeend",e[1]??oQ()),eL++,()=>{eL===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),eL--}},[])}function oQ(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Ru=function(){return Ru=Object.assign||function(t){for(var n,i=1,o=arguments.length;i<o;i++){n=arguments[i];for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(t[u]=n[u])}return t},Ru.apply(this,arguments)};function _le(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]]);return n}function D4e(e,t,n){if(n||arguments.length===2)for(var i=0,o=t.length,u;i<o;i++)(u||!(i in t))&&(u||(u=Array.prototype.slice.call(t,0,i)),u[i]=t[i]);return e.concat(u||Array.prototype.slice.call(t))}var OR="right-scroll-bar-position",PR="width-before-scroll-bar",L4e="with-scroll-bars-hidden",M4e="--removed-body-scroll-bar-size";function tL(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function U4e(e,t){var n=S.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var o=n.value;o!==i&&(n.value=i,n.callback(i,o))}}}})[0];return n.callback=t,n.facade}var F4e=typeof window<"u"?S.useLayoutEffect:S.useEffect,cQ=new WeakMap;function V4e(e,t){var n=U4e(null,function(i){return e.forEach(function(o){return tL(o,i)})});return F4e(function(){var i=cQ.get(n);if(i){var o=new Set(i),u=new Set(e),h=n.current;o.forEach(function(p){u.has(p)||tL(p,null)}),u.forEach(function(p){o.has(p)||tL(p,h)})}cQ.set(n,e)},[e]),n}function B4e(e){return e}function $4e(e,t){t===void 0&&(t=B4e);var n=[],i=!1,o={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(u){var h=t(u,i);return n.push(h),function(){n=n.filter(function(p){return p!==h})}},assignSyncMedium:function(u){for(i=!0;n.length;){var h=n;n=[],h.forEach(u)}n={push:function(p){return u(p)},filter:function(){return n}}},assignMedium:function(u){i=!0;var h=[];if(n.length){var p=n;n=[],p.forEach(u),h=n}var g=function(){var b=h;h=[],b.forEach(u)},v=function(){return Promise.resolve().then(g)};v(),n={push:function(b){h.push(b),v()},filter:function(b){return h=h.filter(b),n}}}};return o}function W4e(e){e===void 0&&(e={});var t=$4e(null);return t.options=Ru({async:!0,ssr:!1},e),t}var ble=function(e){var t=e.sideCar,n=_le(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return S.createElement(i,Ru({},n))};ble.isSideCarExport=!0;function G4e(e,t){return e.useMedium(t),ble}var Ele=W4e(),nL=function(){},R1=S.forwardRef(function(e,t){var n=S.useRef(null),i=S.useState({onScrollCapture:nL,onWheelCapture:nL,onTouchMoveCapture:nL}),o=i[0],u=i[1],h=e.forwardProps,p=e.children,g=e.className,v=e.removeScrollBar,b=e.enabled,E=e.shards,T=e.sideCar,C=e.noRelative,R=e.noIsolation,N=e.inert,O=e.allowPinchZoom,k=e.as,j=k===void 0?"div":k,P=e.gapMode,M=_le(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=T,U=V4e([n,t]),V=Ru(Ru({},M),o);return S.createElement(S.Fragment,null,b&&S.createElement(D,{sideCar:Ele,removeScrollBar:v,shards:E,noRelative:C,noIsolation:R,inert:N,setCallbacks:u,allowPinchZoom:!!O,lockRef:n,gapMode:P}),h?S.cloneElement(S.Children.only(p),Ru(Ru({},V),{ref:U})):S.createElement(j,Ru({},V,{className:g,ref:U}),p))});R1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};R1.classNames={fullWidth:PR,zeroRight:OR};var H4e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function z4e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=H4e();return t&&e.setAttribute("nonce",t),e}function K4e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function q4e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Y4e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=z4e())&&(K4e(t,n),q4e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},X4e=function(){var e=Y4e();return function(t,n){S.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},wle=function(){var e=X4e(),t=function(n){var i=n.styles,o=n.dynamic;return e(i,o),null};return t},J4e={left:0,top:0,right:0,gap:0},rL=function(e){return parseInt(e||"",10)||0},Z4e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[rL(n),rL(i),rL(o)]},Q4e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return J4e;var t=Z4e(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},eBe=wle(),Vv="data-scroll-locked",tBe=function(e,t,n,i){var o=e.left,u=e.top,h=e.right,p=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(L4e,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(p,"px ").concat(i,`;
  }
  body[`).concat(Vv,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(u,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(p,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(p,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(OR,` {
    right: `).concat(p,"px ").concat(i,`;
  }
  
  .`).concat(PR,` {
    margin-right: `).concat(p,"px ").concat(i,`;
  }
  
  .`).concat(OR," .").concat(OR,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(PR," .").concat(PR,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Vv,`] {
    `).concat(M4e,": ").concat(p,`px;
  }
`)},lQ=function(){var e=parseInt(document.body.getAttribute(Vv)||"0",10);return isFinite(e)?e:0},nBe=function(){S.useEffect(function(){return document.body.setAttribute(Vv,(lQ()+1).toString()),function(){var e=lQ()-1;e<=0?document.body.removeAttribute(Vv):document.body.setAttribute(Vv,e.toString())}},[])},rBe=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,o=i===void 0?"margin":i;nBe();var u=S.useMemo(function(){return Q4e(o)},[o]);return S.createElement(eBe,{styles:tBe(u,!t,o,n?"":"!important")})},vU=!1;if(typeof window<"u")try{var OC=Object.defineProperty({},"passive",{get:function(){return vU=!0,!0}});window.addEventListener("test",OC,OC),window.removeEventListener("test",OC,OC)}catch{vU=!1}var rv=vU?{passive:!1}:!1,iBe=function(e){return e.tagName==="TEXTAREA"},Sle=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!iBe(e)&&n[t]==="visible")},aBe=function(e){return Sle(e,"overflowY")},sBe=function(e){return Sle(e,"overflowX")},uQ=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var o=xle(e,i);if(o){var u=Tle(e,i),h=u[1],p=u[2];if(h>p)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},oBe=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},cBe=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},xle=function(e,t){return e==="v"?aBe(t):sBe(t)},Tle=function(e,t){return e==="v"?oBe(t):cBe(t)},lBe=function(e,t){return e==="h"&&t==="rtl"?-1:1},uBe=function(e,t,n,i,o){var u=lBe(e,window.getComputedStyle(t).direction),h=u*i,p=n.target,g=t.contains(p),v=!1,b=h>0,E=0,T=0;do{if(!p)break;var C=Tle(e,p),R=C[0],N=C[1],O=C[2],k=N-O-u*R;(R||k)&&xle(e,p)&&(E+=k,T+=R);var j=p.parentNode;p=j&&j.nodeType===Node.DOCUMENT_FRAGMENT_NODE?j.host:j}while(!g&&p!==document.body||g&&(t.contains(p)||t===p));return(b&&Math.abs(E)<1||!b&&Math.abs(T)<1)&&(v=!0),v},PC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},dQ=function(e){return[e.deltaX,e.deltaY]},hQ=function(e){return e&&"current"in e?e.current:e},dBe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},hBe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},fBe=0,iv=[];function pBe(e){var t=S.useRef([]),n=S.useRef([0,0]),i=S.useRef(),o=S.useState(fBe++)[0],u=S.useState(wle)[0],h=S.useRef(e);S.useEffect(function(){h.current=e},[e]),S.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var N=D4e([e.lockRef.current],(e.shards||[]).map(hQ),!0).filter(Boolean);return N.forEach(function(O){return O.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),N.forEach(function(O){return O.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var p=S.useCallback(function(N,O){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!h.current.allowPinchZoom;var k=PC(N),j=n.current,P="deltaX"in N?N.deltaX:j[0]-k[0],M="deltaY"in N?N.deltaY:j[1]-k[1],D,U=N.target,V=Math.abs(P)>Math.abs(M)?"h":"v";if("touches"in N&&V==="h"&&U.type==="range")return!1;var z=uQ(V,U);if(!z)return!0;if(z?D=V:(D=V==="v"?"h":"v",z=uQ(V,U)),!z)return!1;if(!i.current&&"changedTouches"in N&&(P||M)&&(i.current=D),!D)return!0;var W=i.current||D;return uBe(W,O,N,W==="h"?P:M)},[]),g=S.useCallback(function(N){var O=N;if(!(!iv.length||iv[iv.length-1]!==u)){var k="deltaY"in O?dQ(O):PC(O),j=t.current.filter(function(D){return D.name===O.type&&(D.target===O.target||O.target===D.shadowParent)&&dBe(D.delta,k)})[0];if(j&&j.should){O.cancelable&&O.preventDefault();return}if(!j){var P=(h.current.shards||[]).map(hQ).filter(Boolean).filter(function(D){return D.contains(O.target)}),M=P.length>0?p(O,P[0]):!h.current.noIsolation;M&&O.cancelable&&O.preventDefault()}}},[]),v=S.useCallback(function(N,O,k,j){var P={name:N,delta:O,target:k,should:j,shadowParent:mBe(k)};t.current.push(P),setTimeout(function(){t.current=t.current.filter(function(M){return M!==P})},1)},[]),b=S.useCallback(function(N){n.current=PC(N),i.current=void 0},[]),E=S.useCallback(function(N){v(N.type,dQ(N),N.target,p(N,e.lockRef.current))},[]),T=S.useCallback(function(N){v(N.type,PC(N),N.target,p(N,e.lockRef.current))},[]);S.useEffect(function(){return iv.push(u),e.setCallbacks({onScrollCapture:E,onWheelCapture:E,onTouchMoveCapture:T}),document.addEventListener("wheel",g,rv),document.addEventListener("touchmove",g,rv),document.addEventListener("touchstart",b,rv),function(){iv=iv.filter(function(N){return N!==u}),document.removeEventListener("wheel",g,rv),document.removeEventListener("touchmove",g,rv),document.removeEventListener("touchstart",b,rv)}},[]);var C=e.removeScrollBar,R=e.inert;return S.createElement(S.Fragment,null,R?S.createElement(u,{styles:hBe(o)}):null,C?S.createElement(rBe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function mBe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const gBe=G4e(Ele,pBe);var Vw=S.forwardRef(function(e,t){return S.createElement(R1,Ru({},e,{ref:t,sideCar:gBe}))});Vw.classNames=R1.classNames;var vBe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},av=new WeakMap,kC=new WeakMap,jC={},iL=0,Cle=function(e){return e&&(e.host||Cle(e.parentNode))},yBe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=Cle(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},_Be=function(e,t,n,i){var o=yBe(t,Array.isArray(e)?e:[e]);jC[n]||(jC[n]=new WeakMap);var u=jC[n],h=[],p=new Set,g=new Set(o),v=function(E){!E||p.has(E)||(p.add(E),v(E.parentNode))};o.forEach(v);var b=function(E){!E||g.has(E)||Array.prototype.forEach.call(E.children,function(T){if(p.has(T))b(T);else try{var C=T.getAttribute(i),R=C!==null&&C!=="false",N=(av.get(T)||0)+1,O=(u.get(T)||0)+1;av.set(T,N),u.set(T,O),h.push(T),N===1&&R&&kC.set(T,!0),O===1&&T.setAttribute(n,"true"),R||T.setAttribute(i,"true")}catch(k){console.error("aria-hidden: cannot operate on ",T,k)}})};return b(t),p.clear(),iL++,function(){h.forEach(function(E){var T=av.get(E)-1,C=u.get(E)-1;av.set(E,T),u.set(E,C),T||(kC.has(E)||E.removeAttribute(i),kC.delete(E)),C||E.removeAttribute(n)}),iL--,iL||(av=new WeakMap,av=new WeakMap,kC=new WeakMap,jC={})}},N1=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),o=vBe(e);return o?(i.push.apply(i,Array.from(o.querySelectorAll("[aria-live], script"))),_Be(i,o,n,"aria-hidden")):function(){return null}},A1="Dialog",[Rle,QSt]=Vs(A1),[bBe,zl]=Rle(A1),Nle=e=>{const{__scopeDialog:t,children:n,open:i,defaultOpen:o,onOpenChange:u,modal:h=!0}=e,p=S.useRef(null),g=S.useRef(null),[v,b]=$d({prop:i,defaultProp:o??!1,onChange:u,caller:A1});return c.jsx(bBe,{scope:t,triggerRef:p,contentRef:g,contentId:Vl(),titleId:Vl(),descriptionId:Vl(),open:v,onOpenChange:b,onOpenToggle:S.useCallback(()=>b(E=>!E),[b]),modal:h,children:n})};Nle.displayName=A1;var Ale="DialogTrigger",Ile=S.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=zl(Ale,n),u=Dn(t,o.triggerRef);return c.jsx(en.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":W4(o.open),...i,ref:u,onClick:Tt(e.onClick,o.onOpenToggle)})});Ile.displayName=Ale;var B4="DialogPortal",[EBe,Ole]=Rle(B4,{forceMount:void 0}),Ple=e=>{const{__scopeDialog:t,forceMount:n,children:i,container:o}=e,u=zl(B4,t);return c.jsx(EBe,{scope:t,forceMount:n,children:S.Children.map(i,h=>c.jsx(is,{present:n||u.open,children:c.jsx(jw,{asChild:!0,container:o,children:h})}))})};Ple.displayName=B4;var IN="DialogOverlay",kle=S.forwardRef((e,t)=>{const n=Ole(IN,e.__scopeDialog),{forceMount:i=n.forceMount,...o}=e,u=zl(IN,e.__scopeDialog);return u.modal?c.jsx(is,{present:i||u.open,children:c.jsx(SBe,{...o,ref:t})}):null});kle.displayName=IN;var wBe=bf("DialogOverlay.RemoveScroll"),SBe=S.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=zl(IN,n);return c.jsx(Vw,{as:wBe,allowPinchZoom:!0,shards:[o.contentRef],children:c.jsx(en.div,{"data-state":W4(o.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),cm="DialogContent",jle=S.forwardRef((e,t)=>{const n=Ole(cm,e.__scopeDialog),{forceMount:i=n.forceMount,...o}=e,u=zl(cm,e.__scopeDialog);return c.jsx(is,{present:i||u.open,children:u.modal?c.jsx(xBe,{...o,ref:t}):c.jsx(TBe,{...o,ref:t})})});jle.displayName=cm;var xBe=S.forwardRef((e,t)=>{const n=zl(cm,e.__scopeDialog),i=S.useRef(null),o=Dn(t,n.contentRef,i);return S.useEffect(()=>{const u=i.current;if(u)return N1(u)},[]),c.jsx(Dle,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Tt(e.onCloseAutoFocus,u=>{var h;u.preventDefault(),(h=n.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Tt(e.onPointerDownOutside,u=>{const h=u.detail.originalEvent,p=h.button===0&&h.ctrlKey===!0;(h.button===2||p)&&u.preventDefault()}),onFocusOutside:Tt(e.onFocusOutside,u=>u.preventDefault())})}),TBe=S.forwardRef((e,t)=>{const n=zl(cm,e.__scopeDialog),i=S.useRef(!1),o=S.useRef(!1);return c.jsx(Dle,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h,p;(h=e.onCloseAutoFocus)==null||h.call(e,u),u.defaultPrevented||(i.current||(p=n.triggerRef.current)==null||p.focus(),u.preventDefault()),i.current=!1,o.current=!1},onInteractOutside:u=>{var g,v;(g=e.onInteractOutside)==null||g.call(e,u),u.defaultPrevented||(i.current=!0,u.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const h=u.target;((v=n.triggerRef.current)==null?void 0:v.contains(h))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&o.current&&u.preventDefault()}})}),Dle=S.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:u,...h}=e,p=zl(cm,n),g=S.useRef(null),v=Dn(t,g);return C1(),c.jsxs(c.Fragment,{children:[c.jsx(Fw,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:u,children:c.jsx(Hy,{role:"dialog",id:p.contentId,"aria-describedby":p.descriptionId,"aria-labelledby":p.titleId,"data-state":W4(p.open),...h,ref:v,onDismiss:()=>p.onOpenChange(!1)})}),c.jsxs(c.Fragment,{children:[c.jsx(CBe,{titleId:p.titleId}),c.jsx(NBe,{contentRef:g,descriptionId:p.descriptionId})]})]})}),$4="DialogTitle",Lle=S.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=zl($4,n);return c.jsx(en.h2,{id:o.titleId,...i,ref:t})});Lle.displayName=$4;var Mle="DialogDescription",Ule=S.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=zl(Mle,n);return c.jsx(en.p,{id:o.descriptionId,...i,ref:t})});Ule.displayName=Mle;var Fle="DialogClose",Vle=S.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=zl(Fle,n);return c.jsx(en.button,{type:"button",...i,ref:t,onClick:Tt(e.onClick,()=>o.onOpenChange(!1))})});Vle.displayName=Fle;function W4(e){return e?"open":"closed"}var Ble="DialogTitleWarning",[ext,$le]=M2e(Ble,{contentName:cm,titleName:$4,docsSlug:"dialog"}),CBe=({titleId:e})=>{const t=$le(Ble),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return S.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},RBe="DialogDescriptionWarning",NBe=({contentRef:e,descriptionId:t})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${$le(RBe).contentName}}.`;return S.useEffect(()=>{var u;const o=(u=e.current)==null?void 0:u.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},Wle=Nle,ABe=Ile,Gle=Ple,I1=kle,O1=jle,P1=Lle,k1=Ule,Hle=Vle;const Yo=Wle,IBe=Gle,zle=S.forwardRef(({className:e,...t},n)=>c.jsx(I1,{ref:n,className:kt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));zle.displayName=I1.displayName;const vo=S.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(IBe,{children:[c.jsx(zle,{}),c.jsxs(O1,{ref:i,className:kt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,c.jsxs(Hle,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(go,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));vo.displayName=O1.displayName;const Xo=({className:e,...t})=>c.jsx("div",{className:kt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Xo.displayName="DialogHeader";const lm=({className:e,...t})=>c.jsx("div",{className:kt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});lm.displayName="DialogFooter";const Jo=S.forwardRef(({className:e,...t},n)=>c.jsx(P1,{ref:n,className:kt("text-lg font-semibold leading-none tracking-tight",e),...t}));Jo.displayName=P1.displayName;const t_=S.forwardRef(({className:e,...t},n)=>c.jsx(k1,{ref:n,className:kt("text-sm text-muted-foreground",e),...t}));t_.displayName=k1.displayName;var OBe="Label",Kle=S.forwardRef((e,t)=>c.jsx(en.label,{...e,ref:t,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=e.onMouseDown)==null||o.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Kle.displayName=OBe;var qle=Kle;const PBe=Uw("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Je=S.forwardRef(({className:e,...t},n)=>c.jsx(qle,{ref:n,className:kt(PBe(),e),...t}));Je.displayName=qle.displayName;async function kBe(e,t,n){const i=await fetch(`${ON}/api/live/stop`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({postId:e,thumbnailDataUrl:n})});if(!i.ok){const o=await G4(i);throw new Error(`Stop live failed (${i.status}) ${o}`)}return await i.json()}async function G4(e){try{return await e.text()}catch{return""}}const ON="https://api.gada.chat";async function jBe(e,t){var h,p;const n=JSON.stringify(e);try{const g=await fetch(`${ON}/api/posts/live`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:n});if(g.ok){const v=await g.json(),b=(v==null?void 0:v.id)??(v==null?void 0:v.postId)??((h=v==null?void 0:v.data)==null?void 0:h.id);if(b)return Number(b)}}catch{}const i=await fetch(`${ON}/api/posts`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:n});if(!i.ok){const g=await G4(i);throw new Error(`Create post failed (${i.status}) ${g}`)}const o=await i.json(),u=(o==null?void 0:o.id)??(o==null?void 0:o.postId)??((p=o==null?void 0:o.data)==null?void 0:p.id);if(!u)throw new Error("Create post: missing id in response");return Number(u)}async function DBe(e,t){const n=await fetch(`${ON}/api/live/start`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify(e)});if(!n.ok){const i=await G4(n);throw new Error(`Start live failed (${n.status}) ${i}`)}return await n.json()}var Yle={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(Zh,function(){function n(r,a){return a.forEach(function(s){s&&typeof s!="string"&&!Array.isArray(s)&&Object.keys(s).forEach(function(l){if(l!=="default"&&!(l in r)){var d=Object.getOwnPropertyDescriptor(s,l);Object.defineProperty(r,l,d.get?d:{enumerable:!0,get:function(){return s[l]}})}})}),Object.freeze(r)}var i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Zh<"u"?Zh:typeof self<"u"?self:{};function o(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var u=function(r){try{return!!r()}catch{return!0}},h=!u(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),p=h,g=Function.prototype,v=g.call,b=p&&g.bind.bind(v,v),E=p?b:function(r){return function(){return v.apply(r,arguments)}},T=E({}.isPrototypeOf),C=function(r){return r&&r.Math===Math&&r},R=C(typeof globalThis=="object"&&globalThis)||C(typeof window=="object"&&window)||C(typeof self=="object"&&self)||C(typeof i=="object"&&i)||C(typeof i=="object"&&i)||function(){return this}()||Function("return this")(),N=h,O=Function.prototype,k=O.apply,j=O.call,P=typeof Reflect=="object"&&Reflect.apply||(N?j.bind(k):function(){return j.apply(k,arguments)}),M=E,D=M({}.toString),U=M("".slice),V=function(r){return U(D(r),8,-1)},z=V,W=E,Y=function(r){if(z(r)==="Function")return W(r)},Q=typeof document=="object"&&document.all,K=Q===void 0&&Q!==void 0?function(r){return typeof r=="function"||r===Q}:function(r){return typeof r=="function"},q={},ee=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),oe=h,ae=Function.prototype.call,J=oe?ae.bind(ae):function(){return ae.apply(ae,arguments)},re={},X={}.propertyIsEnumerable,de=Object.getOwnPropertyDescriptor,we=de&&!X.call({1:2},1);re.f=we?function(r){var a=de(this,r);return!!a&&a.enumerable}:X;var ge,Te,Pe=function(r,a){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:a}},rt=u,dt=V,ze=Object,vt=E("".split),Be=rt(function(){return!ze("z").propertyIsEnumerable(0)})?function(r){return dt(r)==="String"?vt(r,""):ze(r)}:ze,ot=function(r){return r==null},De=ot,je=TypeError,Mt=function(r){if(De(r))throw new je("Can't call method on "+r);return r},Ut=Be,fn=Mt,ht=function(r){return Ut(fn(r))},St=K,At=function(r){return typeof r=="object"?r!==null:St(r)},it={},ve=it,Ie=R,$e=K,gt=function(r){return $e(r)?r:void 0},at=function(r,a){return arguments.length<2?gt(ve[r])||gt(Ie[r]):ve[r]&&ve[r][a]||Ie[r]&&Ie[r][a]},pt=R.navigator,Ft=pt&&pt.userAgent,vn=Ft?String(Ft):"",cr=R,ra=vn,Gs=cr.process,xs=cr.Deno,Ju=Gs&&Gs.versions||xs&&xs.version,rc=Ju&&Ju.v8;rc&&(Te=(ge=rc.split("."))[0]>0&&ge[0]<4?1:+(ge[0]+ge[1])),!Te&&ra&&(!(ge=ra.match(/Edge\/(\d+)/))||ge[1]>=74)&&(ge=ra.match(/Chrome\/(\d+)/))&&(Te=+ge[1]);var ia=Te,Yc=ia,Hs=u,eh=R.String,lt=!!Object.getOwnPropertySymbols&&!Hs(function(){var r=Symbol("symbol detection");return!eh(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&Yc&&Yc<41}),Gt=lt&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Yn=at,gi=K,zs=T,Ts=Object,Wf=Gt?function(r){return typeof r=="symbol"}:function(r){var a=Yn("Symbol");return gi(a)&&zs(a.prototype,Ts(r))},Sn=String,nr=function(r){try{return Sn(r)}catch{return"Object"}},ei=K,bo=nr,Eo=TypeError,Si=function(r){if(ei(r))return r;throw new Eo(bo(r)+" is not a function")},Zu=Si,wo=ot,So=function(r,a){var s=r[a];return wo(s)?void 0:Zu(s)},Q3=J,e5=K,t5=At,mye=TypeError,n5={exports:{}},r5=R,gye=Object.defineProperty,vye=R,yye=function(r,a){try{gye(r5,r,{value:a,configurable:!0,writable:!0})}catch{r5[r]=a}return a},i5="__core-js_shared__",a5=n5.exports=vye[i5]||yye(i5,{});(a5.versions||(a5.versions=[])).push({version:"3.42.0",mode:"pure",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var hO=n5.exports,s5=hO,Vm=function(r,a){return s5[r]||(s5[r]=a||{})},_ye=Mt,bye=Object,Yl=function(r){return bye(_ye(r))},Eye=Yl,wye=E({}.hasOwnProperty),aa=Object.hasOwn||function(r,a){return wye(Eye(r),a)},Sye=E,xye=0,Tye=Math.random(),Cye=Sye(1 .toString),fO=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Cye(++xye+Tye,36)},Rye=Vm,o5=aa,Nye=fO,Aye=lt,Iye=Gt,Bm=R.Symbol,pO=Rye("wks"),Oye=Iye?Bm.for||Bm:Bm&&Bm.withoutSetter||Nye,qr=function(r){return o5(pO,r)||(pO[r]=Aye&&o5(Bm,r)?Bm[r]:Oye("Symbol."+r)),pO[r]},Pye=J,c5=At,l5=Wf,kye=So,jye=function(r,a){var s,l;if(e5(s=r.toString)&&!t5(l=Q3(s,r))||e5(s=r.valueOf)&&!t5(l=Q3(s,r)))return l;throw new mye("Can't convert object to primitive value")},Dye=TypeError,Lye=qr("toPrimitive"),Mye=function(r,a){if(!c5(r)||l5(r))return r;var s,l=kye(r,Lye);if(l){if(s=Pye(l,r,a),!c5(s)||l5(s))return s;throw new Dye("Can't convert object to primitive value")}return jye(r)},Uye=Wf,mO=function(r){var a=Mye(r,"string");return Uye(a)?a:a+""},u5=At,gO=R.document,Fye=u5(gO)&&u5(gO.createElement),vO=function(r){return Fye?gO.createElement(r):{}},Vye=vO,d5=!ee&&!u(function(){return Object.defineProperty(Vye("div"),"a",{get:function(){return 7}}).a!==7}),Bye=ee,$ye=J,Wye=re,Gye=Pe,Hye=ht,zye=mO,Kye=aa,qye=d5,h5=Object.getOwnPropertyDescriptor;q.f=Bye?h5:function(r,a){if(r=Hye(r),a=zye(a),qye)try{return h5(r,a)}catch{}if(Kye(r,a))return Gye(!$ye(Wye.f,r,a),r[a])};var Yye=u,Xye=K,Jye=/#|\.prototype\./,T_=function(r,a){var s=Qye[Zye(r)];return s===t_e||s!==e_e&&(Xye(a)?Yye(a):!!a)},Zye=T_.normalize=function(r){return String(r).replace(Jye,".").toLowerCase()},Qye=T_.data={},e_e=T_.NATIVE="N",t_e=T_.POLYFILL="P",f5=T_,n_e=Si,r_e=h,i_e=Y(Y.bind),th=function(r,a){return n_e(r),a===void 0?r:r_e?i_e(r,a):function(){return r.apply(a,arguments)}},ic={},p5=ee&&u(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),a_e=At,s_e=String,o_e=TypeError,Cs=function(r){if(a_e(r))return r;throw new o_e(s_e(r)+" is not an object")},c_e=ee,l_e=d5,u_e=p5,uS=Cs,m5=mO,d_e=TypeError,yO=Object.defineProperty,h_e=Object.getOwnPropertyDescriptor,_O="enumerable",bO="configurable",EO="writable";ic.f=c_e?u_e?function(r,a,s){if(uS(r),a=m5(a),uS(s),typeof r=="function"&&a==="prototype"&&"value"in s&&EO in s&&!s[EO]){var l=h_e(r,a);l&&l[EO]&&(r[a]=s.value,s={configurable:bO in s?s[bO]:l[bO],enumerable:_O in s?s[_O]:l[_O],writable:!1})}return yO(r,a,s)}:yO:function(r,a,s){if(uS(r),a=m5(a),uS(s),l_e)try{return yO(r,a,s)}catch{}if("get"in s||"set"in s)throw new d_e("Accessors not supported");return"value"in s&&(r[a]=s.value),r};var f_e=ic,p_e=Pe,Gf=ee?function(r,a,s){return f_e.f(r,a,p_e(1,s))}:function(r,a,s){return r[a]=s,r},C_=R,m_e=P,g_e=Y,v_e=K,y_e=q.f,__e=f5,$m=it,b_e=th,Wm=Gf,g5=aa,E_e=function(r){var a=function(s,l,d){if(this instanceof a){switch(arguments.length){case 0:return new r;case 1:return new r(s);case 2:return new r(s,l)}return new r(s,l,d)}return m_e(r,this,arguments)};return a.prototype=r.prototype,a},Tn=function(r,a){var s,l,d,f,m,y,_,w,x,A=r.target,I=r.global,L=r.stat,H=r.proto,$=I?C_:L?C_[A]:C_[A]&&C_[A].prototype,G=I?$m:$m[A]||Wm($m,A,{})[A],ne=G.prototype;for(f in a)l=!(s=__e(I?f:A+(L?".":"#")+f,r.forced))&&$&&g5($,f),y=G[f],l&&(_=r.dontCallGetSet?(x=y_e($,f))&&x.value:$[f]),m=l&&_?_:a[f],(s||H||typeof y!=typeof m)&&(w=r.bind&&l?b_e(m,C_):r.wrap&&l?E_e(m):H&&v_e(m)?g_e(m):m,(r.sham||m&&m.sham||y&&y.sham)&&Wm(w,"sham",!0),Wm(G,f,w),H&&(g5($m,d=A+"Prototype")||Wm($m,d,{}),Wm($m[d],f,m),r.real&&ne&&(s||!ne[f])&&Wm(ne,f,m)))},w_e=Math.ceil,S_e=Math.floor,x_e=Math.trunc||function(r){var a=+r;return(a>0?S_e:w_e)(a)},T_e=x_e,wO=function(r){var a=+r;return a!=a||a===0?0:T_e(a)},C_e=wO,R_e=Math.max,N_e=Math.min,SO=function(r,a){var s=C_e(r);return s<0?R_e(s+a,0):N_e(s,a)},A_e=wO,I_e=Math.min,v5=function(r){var a=A_e(r);return a>0?I_e(a,9007199254740991):0},O_e=v5,nh=function(r){return O_e(r.length)},P_e=ht,k_e=SO,j_e=nh,y5=function(r){return function(a,s,l){var d=P_e(a),f=j_e(d);if(f===0)return!r&&-1;var m,y=k_e(l,f);if(r&&s!=s){for(;f>y;)if((m=d[y++])!=m)return!0}else for(;f>y;y++)if((r||y in d)&&d[y]===s)return r||y||0;return!r&&-1}},xO={includes:y5(!0),indexOf:y5(!1)},D_e=xO.includes;Tn({target:"Array",proto:!0,forced:u(function(){return!Array(1).includes()})},{includes:function(r){return D_e(this,r,arguments.length>1?arguments[1]:void 0)}});var L_e=R,M_e=it,ac=function(r,a){var s=M_e[r+"Prototype"],l=s&&s[a];if(l)return l;var d=L_e[r],f=d&&d.prototype;return f&&f[a]},U_e=ac("Array","includes"),F_e=At,V_e=V,B_e=qr("match"),_5=function(r){var a;return F_e(r)&&((a=r[B_e])!==void 0?!!a:V_e(r)==="RegExp")},$_e=_5,W_e=TypeError,b5={};b5[qr("toStringTag")]="z";var TO=String(b5)==="[object z]",G_e=TO,H_e=K,dS=V,z_e=qr("toStringTag"),K_e=Object,q_e=dS(function(){return arguments}())==="Arguments",rh=G_e?dS:function(r){var a,s,l;return r===void 0?"Undefined":r===null?"Null":typeof(s=function(d,f){try{return d[f]}catch{}}(a=K_e(r),z_e))=="string"?s:q_e?dS(a):(l=dS(a))==="Object"&&H_e(a.callee)?"Arguments":l},Y_e=rh,X_e=String,Ks=function(r){if(Y_e(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return X_e(r)},J_e=qr("match"),Z_e=Tn,Q_e=function(r){if($_e(r))throw new W_e("The method doesn't accept regular expressions");return r},ebe=Mt,E5=Ks,tbe=function(r){var a=/./;try{"/./"[r](a)}catch{try{return a[J_e]=!1,"/./"[r](a)}catch{}}return!1},nbe=E("".indexOf);Z_e({target:"String",proto:!0,forced:!tbe("includes")},{includes:function(r){return!!~nbe(E5(ebe(this)),E5(Q_e(r)),arguments.length>1?arguments[1]:void 0)}});var rbe=ac("String","includes"),w5=T,ibe=U_e,abe=rbe,CO=Array.prototype,RO=String.prototype,sbe=function(r){var a=r.includes;return r===CO||w5(CO,r)&&a===CO.includes?ibe:typeof r=="string"||r===RO||w5(RO,r)&&a===RO.includes?abe:a},Ve=o(sbe),obe=Si,cbe=Yl,lbe=Be,ube=nh,S5=TypeError,x5="Reduce of empty array with no initial value",dbe=function(r){return function(a,s,l,d){var f=cbe(a),m=lbe(f),y=ube(f);if(obe(s),y===0&&l<2)throw new S5(x5);var _=r?y-1:0,w=r?-1:1;if(l<2)for(;;){if(_ in m){d=m[_],_+=w;break}if(_+=w,r?_<0:y<=_)throw new S5(x5)}for(;r?_>=0:y>_;_+=w)_ in m&&(d=s(d,m[_],_,f));return d}},hbe={left:dbe(!1)},fbe=u,hS=function(r,a){var s=[][r];return!!s&&fbe(function(){s.call(null,a||function(){return 1},1)})},R_=R,pbe=vn,mbe=V,fS=function(r){return pbe.slice(0,r.length)===r},NO=fS("Bun/")?"BUN":fS("Cloudflare-Workers")?"CLOUDFLARE":fS("Deno/")?"DENO":fS("Node.js/")?"NODE":R_.Bun&&typeof Bun.version=="string"?"BUN":R_.Deno&&typeof Deno.version=="object"?"DENO":mbe(R_.process)==="process"?"NODE":R_.window&&R_.document?"BROWSER":"REST",pS=NO==="NODE",gbe=hbe.left;Tn({target:"Array",proto:!0,forced:!pS&&ia>79&&ia<83||!hS("reduce")},{reduce:function(r){var a=arguments.length;return gbe(this,r,a,a>1?arguments[1]:void 0)}});var vbe=ac("Array","reduce"),ybe=T,_be=vbe,AO=Array.prototype,bbe=function(r){var a=r.reduce;return r===AO||ybe(AO,r)&&a===AO.reduce?_be:a},T5=bbe,sc=o(T5),Ebe=V,N_=Array.isArray||function(r){return Ebe(r)==="Array"},wbe=Tn,Sbe=N_,xbe=E([].reverse),C5=[1,2];wbe({target:"Array",proto:!0,forced:String(C5)===String(C5.reverse())},{reverse:function(){return Sbe(this)&&(this.length=this.length),xbe(this)}});var Tbe=ac("Array","reverse"),Cbe=T,Rbe=Tbe,IO=Array.prototype,Nbe=function(r){var a=r.reverse;return r===IO||Cbe(IO,r)&&a===IO.reverse?Rbe:a},R5=Nbe,N5=o(R5),Abe=fO,A5=Vm("keys"),mS=function(r){return A5[r]||(A5[r]=Abe(r))},Ibe=!u(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),Obe=aa,Pbe=K,kbe=Yl,jbe=Ibe,I5=mS("IE_PROTO"),OO=Object,Dbe=OO.prototype,PO=jbe?OO.getPrototypeOf:function(r){var a=kbe(r);if(Obe(a,I5))return a[I5];var s=a.constructor;return Pbe(s)&&a instanceof s?s.prototype:a instanceof OO?Dbe:null},Lbe=E,Mbe=Si,Ube=At,Fbe=function(r){return Ube(r)||r===null},Vbe=String,Bbe=TypeError,$be=function(r,a,s){try{return Lbe(Mbe(Object.getOwnPropertyDescriptor(r,a)[s]))}catch{}},Wbe=At,Gbe=Mt,Hbe=function(r){if(Fbe(r))return r;throw new Bbe("Can't set "+Vbe(r)+" as a prototype")},zbe=Object.setPrototypeOf||("__proto__"in{}?function(){var r,a=!1,s={};try{(r=$be(Object.prototype,"__proto__","set"))(s,[]),a=s instanceof Array}catch{}return function(l,d){return Gbe(l),Hbe(d),Wbe(l)&&(a?r(l,d):l.__proto__=d),l}}():void 0),gS={},vS={},kO=aa,Kbe=ht,qbe=xO.indexOf,Ybe=vS,O5=E([].push),P5=function(r,a){var s,l=Kbe(r),d=0,f=[];for(s in l)!kO(Ybe,s)&&kO(l,s)&&O5(f,s);for(;a.length>d;)kO(l,s=a[d++])&&(~qbe(f,s)||O5(f,s));return f},jO=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xbe=P5,Jbe=jO.concat("length","prototype");gS.f=Object.getOwnPropertyNames||function(r){return Xbe(r,Jbe)};var A_={};A_.f=Object.getOwnPropertySymbols;var Zbe=at,Qbe=gS,eEe=A_,tEe=Cs,nEe=E([].concat),rEe=Zbe("Reflect","ownKeys")||function(r){var a=Qbe.f(tEe(r)),s=eEe.f;return s?nEe(a,s(r)):a},k5=aa,iEe=rEe,aEe=q,sEe=ic,DO={},oEe=P5,cEe=jO,yS=Object.keys||function(r){return oEe(r,cEe)},lEe=ee,uEe=p5,dEe=ic,hEe=Cs,fEe=ht,pEe=yS;DO.f=lEe&&!uEe?Object.defineProperties:function(r,a){hEe(r);for(var s,l=fEe(a),d=pEe(a),f=d.length,m=0;f>m;)dEe.f(r,s=d[m++],l[s]);return r};var _S,j5=at("document","documentElement"),mEe=Cs,gEe=DO,D5=jO,vEe=vS,yEe=j5,_Ee=vO,LO="prototype",MO="script",L5=mS("IE_PROTO"),UO=function(){},M5=function(r){return"<"+MO+">"+r+"</"+MO+">"},U5=function(r){r.write(M5("")),r.close();var a=r.parentWindow.Object;return r=null,a},bS=function(){try{_S=new ActiveXObject("htmlfile")}catch{}var r,a,s;bS=typeof document<"u"?document.domain&&_S?U5(_S):(a=_Ee("iframe"),s="java"+MO+":",a.style.display="none",yEe.appendChild(a),a.src=String(s),(r=a.contentWindow.document).open(),r.write(M5("document.F=Object")),r.close(),r.F):U5(_S);for(var l=D5.length;l--;)delete bS[LO][D5[l]];return bS()};vEe[L5]=!0;var I_=Object.create||function(r,a){var s;return r!==null?(UO[LO]=mEe(r),s=new UO,UO[LO]=null,s[L5]=r):s=bS(),a===void 0?s:gEe.f(s,a)},bEe=At,EEe=Gf,F5=Error,wEe=E("".replace),SEe=String(new F5("zxcasd").stack),V5=/\n\s*at [^:]*:[^\n]*/,xEe=V5.test(SEe),TEe=Pe,CEe=!u(function(){var r=new Error("a");return!("stack"in r)||(Object.defineProperty(r,"stack",TEe(1,7)),r.stack!==7)}),REe=Gf,NEe=function(r,a){if(xEe&&typeof r=="string"&&!F5.prepareStackTrace)for(;a--;)r=wEe(r,V5,"");return r},AEe=CEe,B5=Error.captureStackTrace,Gm={},IEe=Gm,OEe=qr("iterator"),PEe=Array.prototype,$5=function(r){return r!==void 0&&(IEe.Array===r||PEe[OEe]===r)},kEe=rh,W5=So,jEe=ot,DEe=Gm,LEe=qr("iterator"),ES=function(r){if(!jEe(r))return W5(r,LEe)||W5(r,"@@iterator")||DEe[kEe(r)]},MEe=J,UEe=Si,FEe=Cs,VEe=nr,BEe=ES,$Ee=TypeError,FO=function(r,a){var s=arguments.length<2?BEe(r):a;if(UEe(s))return FEe(MEe(s,r));throw new $Ee(VEe(r)+" is not iterable")},WEe=J,G5=Cs,GEe=So,H5=function(r,a,s){var l,d;G5(r);try{if(!(l=GEe(r,"return"))){if(a==="throw")throw s;return s}l=WEe(l,r)}catch(f){d=!0,l=f}if(a==="throw")throw s;if(d)throw l;return G5(l),s},HEe=th,zEe=J,KEe=Cs,qEe=nr,YEe=$5,XEe=nh,z5=T,JEe=FO,ZEe=ES,K5=H5,QEe=TypeError,wS=function(r,a){this.stopped=r,this.result=a},q5=wS.prototype,O_=function(r,a,s){var l,d,f,m,y,_,w,x=s&&s.that,A=!(!s||!s.AS_ENTRIES),I=!(!s||!s.IS_RECORD),L=!(!s||!s.IS_ITERATOR),H=!(!s||!s.INTERRUPTED),$=HEe(a,x),G=function(te){return l&&K5(l,"normal",te),new wS(!0,te)},ne=function(te){return A?(KEe(te),H?$(te[0],te[1],G):$(te[0],te[1])):H?$(te,G):$(te)};if(I)l=r.iterator;else if(L)l=r;else{if(!(d=ZEe(r)))throw new QEe(qEe(r)+" is not iterable");if(YEe(d)){for(f=0,m=XEe(r);m>f;f++)if((y=ne(r[f]))&&z5(q5,y))return y;return new wS(!1)}l=JEe(r,d)}for(_=I?r.next:l.next;!(w=zEe(_,l)).done;){try{y=ne(w.value)}catch(te){K5(l,"throw",te)}if(typeof y=="object"&&y&&z5(q5,y))return y}return new wS(!1)},e0e=Ks,t0e=Tn,n0e=T,r0e=PO,SS=zbe,i0e=function(r,a,s){for(var l=iEe(a),d=sEe.f,f=aEe.f,m=0;m<l.length;m++){var y=l[m];k5(r,y)||s&&k5(s,y)||d(r,y,f(a,y))}},Y5=I_,VO=Gf,BO=Pe,a0e=function(r,a){bEe(a)&&"cause"in a&&EEe(r,"cause",a.cause)},s0e=function(r,a,s,l){AEe&&(B5?B5(r,a):REe(r,"stack",NEe(s,l)))},o0e=O_,c0e=function(r,a){return r===void 0?arguments.length<2?"":a:e0e(r)},l0e=qr("toStringTag"),xS=Error,u0e=[].push,Hm=function(r,a){var s,l=n0e($O,this);SS?s=SS(new xS,l?r0e(this):$O):(s=l?this:Y5($O),VO(s,l0e,"Error")),a!==void 0&&VO(s,"message",c0e(a)),s0e(s,Hm,s.stack,1),arguments.length>2&&a0e(s,arguments[2]);var d=[];return o0e(r,u0e,{that:d}),VO(s,"errors",d),s};SS?SS(Hm,xS):i0e(Hm,xS,{name:!0});var $O=Hm.prototype=Y5(xS.prototype,{constructor:BO(1,Hm),message:BO(1,""),name:BO(1,"AggregateError")});t0e({global:!0},{AggregateError:Hm});var TS,P_,CS,d0e=K,X5=R.WeakMap,h0e=d0e(X5)&&/native code/.test(String(X5)),J5=R,f0e=At,p0e=Gf,WO=aa,GO=hO,m0e=mS,g0e=vS,Z5="Object already initialized",HO=J5.TypeError,v0e=J5.WeakMap;if(h0e||GO.state){var Xl=GO.state||(GO.state=new v0e);Xl.get=Xl.get,Xl.has=Xl.has,Xl.set=Xl.set,TS=function(r,a){if(Xl.has(r))throw new HO(Z5);return a.facade=r,Xl.set(r,a),a},P_=function(r){return Xl.get(r)||{}},CS=function(r){return Xl.has(r)}}else{var zm=m0e("state");g0e[zm]=!0,TS=function(r,a){if(WO(r,zm))throw new HO(Z5);return a.facade=r,p0e(r,zm,a),a},P_=function(r){return WO(r,zm)?r[zm]:{}},CS=function(r){return WO(r,zm)}}var Hf,Q5,e$,zf={set:TS,get:P_,has:CS,enforce:function(r){return CS(r)?P_(r):TS(r,{})},getterFor:function(r){return function(a){var s;if(!f0e(a)||(s=P_(a)).type!==r)throw new HO("Incompatible receiver, "+r+" required");return s}}},zO=ee,y0e=aa,t$=Function.prototype,_0e=zO&&Object.getOwnPropertyDescriptor,n$=y0e(t$,"name"),r$={PROPER:n$&&(function(){}).name==="something",CONFIGURABLE:n$&&(!zO||zO&&_0e(t$,"name").configurable)},b0e=Gf,ih=function(r,a,s,l){return l&&l.enumerable?r[a]=s:b0e(r,a,s),r},E0e=u,w0e=K,S0e=At,x0e=I_,i$=PO,T0e=ih,KO=qr("iterator"),a$=!1;[].keys&&("next"in(e$=[].keys())?(Q5=i$(i$(e$)))!==Object.prototype&&(Hf=Q5):a$=!0);var C0e=!S0e(Hf)||E0e(function(){var r={};return Hf[KO].call(r)!==r});w0e((Hf=C0e?{}:x0e(Hf))[KO])||T0e(Hf,KO,function(){return this});var s$={IteratorPrototype:Hf,BUGGY_SAFARI_ITERATORS:a$},R0e=rh,N0e=TO?{}.toString:function(){return"[object "+R0e(this)+"]"},A0e=TO,I0e=ic.f,O0e=Gf,P0e=aa,k0e=N0e,o$=qr("toStringTag"),Qu=function(r,a,s,l){var d=s?r:r&&r.prototype;d&&(P0e(d,o$)||I0e(d,o$,{configurable:!0,value:a}),l&&!A0e&&O0e(d,"toString",k0e))},j0e=s$.IteratorPrototype,D0e=I_,L0e=Pe,M0e=Qu,U0e=Gm,F0e=function(){return this},qO=function(r,a,s,l){var d=a+" Iterator";return r.prototype=D0e(j0e,{next:L0e(+!l,s)}),M0e(r,d,!1,!0),U0e[d]=F0e,r},V0e=Tn,B0e=J,$0e=r$,W0e=qO,G0e=PO,H0e=Qu,c$=ih,l$=Gm,z0e=s$,K0e=$0e.PROPER,RS=z0e.BUGGY_SAFARI_ITERATORS,YO=qr("iterator"),u$="keys",NS="values",d$="entries",q0e=function(){return this},h$=function(r,a,s,l,d,f,m){W0e(s,a,l);var y,_,w,x=function(ne){if(ne===d&&$)return $;if(!RS&&ne&&ne in L)return L[ne];switch(ne){case u$:case NS:case d$:return function(){return new s(this,ne)}}return function(){return new s(this)}},A=a+" Iterator",I=!1,L=r.prototype,H=L[YO]||L["@@iterator"]||d&&L[d],$=!RS&&H||x(d),G=a==="Array"&&L.entries||H;if(G&&(y=G0e(G.call(new r)))!==Object.prototype&&y.next&&(H0e(y,A,!0,!0),l$[A]=q0e),K0e&&d===NS&&H&&H.name!==NS&&(I=!0,$=function(){return B0e(H,this)}),d)if(_={values:x(NS),keys:f?$:x(u$),entries:x(d$)},m)for(w in _)(RS||I||!(w in L))&&c$(L,w,_[w]);else V0e({target:a,proto:!0,forced:RS||I},_);return m&&L[YO]!==$&&c$(L,YO,$,{}),l$[a]=$,_},AS=function(r,a){return{value:r,done:a}},Y0e=ht,f$=Gm,p$=zf;ic.f;var X0e=h$,IS=AS,m$="Array Iterator",J0e=p$.set,Z0e=p$.getterFor(m$);X0e(Array,"Array",function(r,a){J0e(this,{type:m$,target:Y0e(r),index:0,kind:a})},function(){var r=Z0e(this),a=r.target,s=r.index++;if(!a||s>=a.length)return r.target=null,IS(void 0,!0);switch(r.kind){case"keys":return IS(s,!1);case"values":return IS(a[s],!1)}return IS([s,a[s]],!1)},"values"),f$.Arguments=f$.Array;var Q0e=ic,OS=function(r,a,s){return Q0e.f(r,a,s)},ewe=at,twe=OS,nwe=ee,g$=qr("species"),rwe=T,iwe=TypeError,XO=function(r,a){if(rwe(a,r))return r;throw new iwe("Incorrect invocation")},awe=K,JO=hO,swe=E(Function.toString);awe(JO.inspectSource)||(JO.inspectSource=function(r){return swe(r)});var v$=JO.inspectSource,owe=E,cwe=u,y$=K,lwe=rh,uwe=v$,_$=function(){},b$=at("Reflect","construct"),ZO=/^\s*(?:class|function)\b/,dwe=owe(ZO.exec),hwe=!ZO.test(_$),k_=function(r){if(!y$(r))return!1;try{return b$(_$,[],r),!0}catch{return!1}},E$=function(r){if(!y$(r))return!1;switch(lwe(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return hwe||!!dwe(ZO,uwe(r))}catch{return!0}};E$.sham=!0;var j_,Km,w$,QO,PS=!b$||cwe(function(){var r;return k_(k_.call)||!k_(Object)||!k_(function(){r=!0})||r})?E$:k_,fwe=PS,pwe=nr,mwe=TypeError,S$=Cs,gwe=function(r){if(fwe(r))return r;throw new mwe(pwe(r)+" is not a constructor")},vwe=ot,ywe=qr("species"),eP=function(r,a){var s,l=S$(r).constructor;return l===void 0||vwe(s=S$(l)[ywe])?a:gwe(s)},ah=E([].slice),_we=TypeError,Kf=function(r,a){if(r<a)throw new _we("Not enough arguments");return r},x$=/(?:ipad|iphone|ipod).*applewebkit/i.test(vn),xo=R,bwe=P,Ewe=th,T$=K,wwe=aa,C$=u,R$=j5,Swe=ah,N$=vO,xwe=Kf,Twe=x$,Cwe=pS,tP=xo.setImmediate,nP=xo.clearImmediate,Rwe=xo.process,rP=xo.Dispatch,Nwe=xo.Function,A$=xo.MessageChannel,Awe=xo.String,iP=0,D_={},I$="onreadystatechange";C$(function(){j_=xo.location});var aP=function(r){if(wwe(D_,r)){var a=D_[r];delete D_[r],a()}},sP=function(r){return function(){aP(r)}},O$=function(r){aP(r.data)},P$=function(r){xo.postMessage(Awe(r),j_.protocol+"//"+j_.host)};tP&&nP||(tP=function(r){xwe(arguments.length,1);var a=T$(r)?r:Nwe(r),s=Swe(arguments,1);return D_[++iP]=function(){bwe(a,void 0,s)},Km(iP),iP},nP=function(r){delete D_[r]},Cwe?Km=function(r){Rwe.nextTick(sP(r))}:rP&&rP.now?Km=function(r){rP.now(sP(r))}:A$&&!Twe?(QO=(w$=new A$).port2,w$.port1.onmessage=O$,Km=Ewe(QO.postMessage,QO)):xo.addEventListener&&T$(xo.postMessage)&&!xo.importScripts&&j_&&j_.protocol!=="file:"&&!C$(P$)?(Km=P$,xo.addEventListener("message",O$,!1)):Km=I$ in N$("script")?function(r){R$.appendChild(N$("script"))[I$]=function(){R$.removeChild(this),aP(r)}}:function(r){setTimeout(sP(r),0)});var kS={set:tP,clear:nP},k$=R,Iwe=ee,Owe=Object.getOwnPropertyDescriptor,j$=function(r){if(!Iwe)return k$[r];var a=Owe(k$,r);return a&&a.value},D$=function(){this.head=null,this.tail=null};D$.prototype={add:function(r){var a={item:r,next:null},s=this.tail;s?s.next=a:this.head=a,this.tail=a},get:function(){var r=this.head;if(r)return(this.head=r.next)===null&&(this.tail=null),r.item}};var qm,oP,cP,lP,L$,M$=D$,Pwe=/ipad|iphone|ipod/i.test(vn)&&typeof Pebble<"u",kwe=/web0s(?!.*chrome)/i.test(vn),Ym=R,jwe=j$,U$=th,uP=kS.set,Dwe=M$,Lwe=x$,Mwe=Pwe,Uwe=kwe,dP=pS,F$=Ym.MutationObserver||Ym.WebKitMutationObserver,V$=Ym.document,B$=Ym.process,jS=Ym.Promise,hP=jwe("queueMicrotask");if(!hP){var DS=new Dwe,LS=function(){var r,a;for(dP&&(r=B$.domain)&&r.exit();a=DS.get();)try{a()}catch(s){throw DS.head&&qm(),s}r&&r.enter()};Lwe||dP||Uwe||!F$||!V$?!Mwe&&jS&&jS.resolve?((lP=jS.resolve(void 0)).constructor=jS,L$=U$(lP.then,lP),qm=function(){L$(LS)}):dP?qm=function(){B$.nextTick(LS)}:(uP=U$(uP,Ym),qm=function(){uP(LS)}):(oP=!0,cP=V$.createTextNode(""),new F$(LS).observe(cP,{characterData:!0}),qm=function(){cP.data=oP=!oP}),hP=function(r){DS.head||qm(),DS.add(r)}}var $$=hP,Xm=function(r){try{return{error:!1,value:r()}}catch(a){return{error:!0,value:a}}},qf=R.Promise,Fwe=R,L_=qf,Vwe=K,Bwe=f5,$we=v$,Wwe=qr,W$=NO,fP=ia,G$=L_&&L_.prototype,Gwe=Wwe("species"),H$=Vwe(Fwe.PromiseRejectionEvent),Hwe=Bwe("Promise",function(){var r=$we(L_),a=r!==String(L_);if(!a&&fP===66||!G$.catch||!G$.finally)return!0;if(!fP||fP<51||!/native code/.test(r)){var s=new L_(function(d){d(1)}),l=function(d){d(function(){},function(){})};if((s.constructor={})[Gwe]=l,!(s.then(function(){})instanceof l))return!0}return!(a||W$!=="BROWSER"&&W$!=="DENO"||H$)}),M_={CONSTRUCTOR:Hwe,REJECTION_EVENT:H$},Jl={},z$=Si,zwe=TypeError,Kwe=function(r){var a,s;this.promise=new r(function(l,d){if(a!==void 0||s!==void 0)throw new zwe("Bad Promise constructor");a=l,s=d}),this.resolve=z$(a),this.reject=z$(s)};Jl.f=function(r){return new Kwe(r)};var pP,K$,qwe=Tn,MS=pS,sh=R,U_=J,Ywe=ih,Xwe=Qu,Jwe=function(r){var a=ewe(r);nwe&&a&&!a[g$]&&twe(a,g$,{configurable:!0,get:function(){return this}})},Zwe=Si,mP=K,Qwe=At,eSe=XO,tSe=eP,q$=kS.set,gP=$$,nSe=function(r,a){try{arguments.length===1?console.error(r):console.error(r,a)}catch{}},rSe=Xm,iSe=M$,Y$=zf,vP=qf,X$=M_,J$=Jl,US="Promise",Z$=X$.CONSTRUCTOR,aSe=X$.REJECTION_EVENT,yP=Y$.getterFor(US),sSe=Y$.set,oSe=vP&&vP.prototype,F_=vP,_P=oSe,Q$=sh.TypeError,bP=sh.document,EP=sh.process,wP=J$.f,cSe=wP,lSe=!!(bP&&bP.createEvent&&sh.dispatchEvent),e6="unhandledrejection",t6=function(r){var a;return!(!Qwe(r)||!mP(a=r.then))&&a},n6=function(r,a){var s,l,d,f=a.value,m=a.state===1,y=m?r.ok:r.fail,_=r.resolve,w=r.reject,x=r.domain;try{y?(m||(a.rejection===2&&dSe(a),a.rejection=1),y===!0?s=f:(x&&x.enter(),s=y(f),x&&(x.exit(),d=!0)),s===r.promise?w(new Q$("Promise-chain cycle")):(l=t6(s))?U_(l,s,_,w):_(s)):w(f)}catch(A){x&&!d&&x.exit(),w(A)}},r6=function(r,a){r.notified||(r.notified=!0,gP(function(){for(var s,l=r.reactions;s=l.get();)n6(s,r);r.notified=!1,a&&!r.rejection&&uSe(r)}))},i6=function(r,a,s){var l,d;lSe?((l=bP.createEvent("Event")).promise=a,l.reason=s,l.initEvent(r,!1,!0),sh.dispatchEvent(l)):l={promise:a,reason:s},!aSe&&(d=sh["on"+r])?d(l):r===e6&&nSe("Unhandled promise rejection",s)},uSe=function(r){U_(q$,sh,function(){var a,s=r.facade,l=r.value;if(a6(r)&&(a=rSe(function(){MS?EP.emit("unhandledRejection",l,s):i6(e6,s,l)}),r.rejection=MS||a6(r)?2:1,a.error))throw a.value})},a6=function(r){return r.rejection!==1&&!r.parent},dSe=function(r){U_(q$,sh,function(){var a=r.facade;MS?EP.emit("rejectionHandled",a):i6("rejectionhandled",a,r.value)})},Jm=function(r,a,s){return function(l){r(a,l,s)}},Zm=function(r,a,s){r.done||(r.done=!0,s&&(r=s),r.value=a,r.state=2,r6(r,!0))},SP=function(r,a,s){if(!r.done){r.done=!0,s&&(r=s);try{if(r.facade===a)throw new Q$("Promise can't be resolved itself");var l=t6(a);l?gP(function(){var d={done:!1};try{U_(l,a,Jm(SP,d,r),Jm(Zm,d,r))}catch(f){Zm(d,f,r)}}):(r.value=a,r.state=1,r6(r,!1))}catch(d){Zm({done:!1},d,r)}}};Z$&&(_P=(F_=function(r){eSe(this,_P),Zwe(r),U_(pP,this);var a=yP(this);try{r(Jm(SP,a),Jm(Zm,a))}catch(s){Zm(a,s)}}).prototype,(pP=function(r){sSe(this,{type:US,done:!1,notified:!1,parent:!1,reactions:new iSe,rejection:!1,state:0,value:null})}).prototype=Ywe(_P,"then",function(r,a){var s=yP(this),l=wP(tSe(this,F_));return s.parent=!0,l.ok=!mP(r)||r,l.fail=mP(a)&&a,l.domain=MS?EP.domain:void 0,s.state===0?s.reactions.add(l):gP(function(){n6(l,s)}),l.promise}),K$=function(){var r=new pP,a=yP(r);this.promise=r,this.resolve=Jm(SP,a),this.reject=Jm(Zm,a)},J$.f=wP=function(r){return r===F_||r===void 0?new K$(r):cSe(r)}),qwe({global:!0,wrap:!0,forced:Z$},{Promise:F_}),Xwe(F_,US,!1,!0),Jwe(US);var s6=qr("iterator"),o6=!1;try{var hSe=0,c6={next:function(){return{done:!!hSe++}},return:function(){o6=!0}};c6[s6]=function(){return this},Array.from(c6,function(){throw 2})}catch{}var fSe=qf,pSe=function(r,a){try{if(!a&&!o6)return!1}catch{return!1}var s=!1;try{var l={};l[s6]=function(){return{next:function(){return{done:s=!0}}}},r(l)}catch{}return s},FS=M_.CONSTRUCTOR||!pSe(function(r){fSe.all(r).then(void 0,function(){})}),mSe=J,gSe=Si,vSe=Jl,ySe=Xm,_Se=O_;Tn({target:"Promise",stat:!0,forced:FS},{all:function(r){var a=this,s=vSe.f(a),l=s.resolve,d=s.reject,f=ySe(function(){var m=gSe(a.resolve),y=[],_=0,w=1;_Se(r,function(x){var A=_++,I=!1;w++,mSe(m,a,x).then(function(L){I||(I=!0,y[A]=L,--w||l(y))},d)}),--w||l(y)});return f.error&&d(f.value),s.promise}});var bSe=Tn,ESe=M_.CONSTRUCTOR;qf&&qf.prototype,bSe({target:"Promise",proto:!0,forced:ESe,real:!0},{catch:function(r){return this.then(void 0,r)}});var wSe=J,SSe=Si,xSe=Jl,TSe=Xm,CSe=O_;Tn({target:"Promise",stat:!0,forced:FS},{race:function(r){var a=this,s=xSe.f(a),l=s.reject,d=TSe(function(){var f=SSe(a.resolve);CSe(r,function(m){wSe(f,a,m).then(s.resolve,l)})});return d.error&&l(d.value),s.promise}});var RSe=Jl;Tn({target:"Promise",stat:!0,forced:M_.CONSTRUCTOR},{reject:function(r){var a=RSe.f(this);return(0,a.reject)(r),a.promise}});var NSe=Cs,ASe=At,ISe=Jl,l6=function(r,a){if(NSe(r),ASe(a)&&a.constructor===r)return a;var s=ISe.f(r);return(0,s.resolve)(a),s.promise},OSe=Tn,PSe=qf,kSe=M_.CONSTRUCTOR,jSe=l6,DSe=at("Promise"),LSe=!kSe;OSe({target:"Promise",stat:!0,forced:!0},{resolve:function(r){return jSe(LSe&&this===DSe?PSe:this,r)}});var MSe=J,USe=Si,FSe=Jl,VSe=Xm,BSe=O_;Tn({target:"Promise",stat:!0,forced:FS},{allSettled:function(r){var a=this,s=FSe.f(a),l=s.resolve,d=s.reject,f=VSe(function(){var m=USe(a.resolve),y=[],_=0,w=1;BSe(r,function(x){var A=_++,I=!1;w++,MSe(m,a,x).then(function(L){I||(I=!0,y[A]={status:"fulfilled",value:L},--w||l(y))},function(L){I||(I=!0,y[A]={status:"rejected",reason:L},--w||l(y))})}),--w||l(y)});return f.error&&d(f.value),s.promise}});var $Se=J,WSe=Si,GSe=at,HSe=Jl,zSe=Xm,KSe=O_,u6="No one promise resolved";Tn({target:"Promise",stat:!0,forced:FS},{any:function(r){var a=this,s=GSe("AggregateError"),l=HSe.f(a),d=l.resolve,f=l.reject,m=zSe(function(){var y=WSe(a.resolve),_=[],w=0,x=1,A=!1;KSe(r,function(I){var L=w++,H=!1;x++,$Se(y,a,I).then(function($){H||A||(A=!0,d($))},function($){H||A||(H=!0,_[L]=$,--x||f(new s(_,u6)))})}),--x||f(new s(_,u6))});return m.error&&f(m.value),l.promise}});var qSe=Tn,YSe=P,XSe=ah,JSe=Jl,ZSe=Si,d6=Xm,xP=R.Promise,h6=!1;qSe({target:"Promise",stat:!0,forced:!xP||!xP.try||d6(function(){xP.try(function(r){h6=r===8},8)}).error||!h6},{try:function(r){var a=arguments.length>1?XSe(arguments,1):[],s=JSe.f(this),l=d6(function(){return YSe(ZSe(r),void 0,a)});return(l.error?s.reject:s.resolve)(l.value),s.promise}});var QSe=Jl;Tn({target:"Promise",stat:!0},{withResolvers:function(){var r=QSe.f(this);return{promise:r.promise,resolve:r.resolve,reject:r.reject}}});var exe=Tn,TP=qf,txe=u,nxe=at,rxe=K,ixe=eP,f6=l6,axe=TP&&TP.prototype;exe({target:"Promise",proto:!0,real:!0,forced:!!TP&&txe(function(){axe.finally.call({then:function(){}},function(){})})},{finally:function(r){var a=ixe(this,nxe("Promise")),s=rxe(r);return this.then(s?function(l){return f6(a,r()).then(function(){return l})}:r,s?function(l){return f6(a,r()).then(function(){throw l})}:r)}});var CP=E,sxe=wO,oxe=Ks,cxe=Mt,lxe=CP("".charAt),p6=CP("".charCodeAt),uxe=CP("".slice),m6=function(r){return function(a,s){var l,d,f=oxe(cxe(a)),m=sxe(s),y=f.length;return m<0||m>=y?r?"":void 0:(l=p6(f,m))<55296||l>56319||m+1===y||(d=p6(f,m+1))<56320||d>57343?r?lxe(f,m):l:r?uxe(f,m,m+2):d-56320+(l-55296<<10)+65536}},RP={codeAt:m6(!1),charAt:m6(!0)},dxe=RP.charAt,hxe=Ks,g6=zf,fxe=h$,v6=AS,y6="String Iterator",pxe=g6.set,mxe=g6.getterFor(y6);fxe(String,"String",function(r){pxe(this,{type:y6,string:hxe(r),index:0})},function(){var r,a=mxe(this),s=a.string,l=a.index;return l>=s.length?v6(void 0,!0):(r=dxe(s,l),a.index+=r.length,v6(r,!1))});var gxe=it.Promise,vxe={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},yxe=R,_xe=Qu,_6=Gm;for(var NP in vxe)_xe(yxe[NP],NP),_6[NP]=_6.Array;var b6=gxe,Ge=o(b6),bxe=ac("Array","values"),Exe=rh,wxe=aa,Sxe=T,xxe=bxe,AP=Array.prototype,Txe={DOMTokenList:!0,NodeList:!0},Cxe=function(r){var a=r.values;return r===AP||Sxe(AP,r)&&a===AP.values||wxe(Txe,Exe(r))?xxe:a},Rs=o(Cxe),E6=nr,Rxe=TypeError,w6=ah,Nxe=Math.floor,IP=function(r,a){var s=r.length;if(s<8)for(var l,d,f=1;f<s;){for(d=f,l=r[f];d&&a(r[d-1],l)>0;)r[d]=r[--d];d!==f++&&(r[d]=l)}else for(var m=Nxe(s/2),y=IP(w6(r,0,m),a),_=IP(w6(r,m),a),w=y.length,x=_.length,A=0,I=0;A<w||I<x;)r[A+I]=A<w&&I<x?a(y[A],_[I])<=0?y[A++]:_[I++]:A<w?y[A++]:_[I++];return r},S6=IP,x6=vn.match(/firefox\/(\d+)/i),Axe=!!x6&&+x6[1],Ixe=/MSIE|Trident/.test(vn),T6=vn.match(/AppleWebKit\/(\d+)\./),Oxe=!!T6&&+T6[1],Pxe=Tn,C6=E,kxe=Si,jxe=Yl,R6=nh,Dxe=function(r,a){if(!delete r[a])throw new Rxe("Cannot delete property "+E6(a)+" of "+E6(r))},N6=Ks,OP=u,Lxe=S6,Mxe=hS,A6=Axe,Uxe=Ixe,I6=ia,O6=Oxe,oh=[],P6=C6(oh.sort),Fxe=C6(oh.push),Vxe=OP(function(){oh.sort(void 0)}),Bxe=OP(function(){oh.sort(null)}),$xe=Mxe("sort"),k6=!OP(function(){if(I6)return I6<70;if(!(A6&&A6>3)){if(Uxe)return!0;if(O6)return O6<603;var r,a,s,l,d="";for(r=65;r<76;r++){switch(a=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(l=0;l<47;l++)oh.push({k:a+l,v:s})}for(oh.sort(function(f,m){return m.v-f.v}),l=0;l<oh.length;l++)a=oh[l].k.charAt(0),d.charAt(d.length-1)!==a&&(d+=a);return d!=="DGBEFHACIJK"}});Pxe({target:"Array",proto:!0,forced:Vxe||!Bxe||!$xe||!k6},{sort:function(r){r!==void 0&&kxe(r);var a=jxe(this);if(k6)return r===void 0?P6(a):P6(a,r);var s,l,d=[],f=R6(a);for(l=0;l<f;l++)l in a&&Fxe(d,a[l]);for(Lxe(d,function(m){return function(y,_){return _===void 0?-1:y===void 0?1:m!==void 0?+m(y,_)||0:N6(y)>N6(_)?1:-1}}(r)),s=R6(d),l=0;l<s;)a[l]=d[l++];for(;l<f;)Dxe(a,l++);return a}});var Wxe=ac("Array","sort"),Gxe=T,Hxe=Wxe,PP=Array.prototype,zxe=function(r){var a=r.sort;return r===PP||Gxe(PP,r)&&a===PP.sort?Hxe:a},Yf=o(zxe),Kxe=Tn,qxe=E,Yxe=SO,Xxe=RangeError,j6=String.fromCharCode,D6=String.fromCodePoint,Jxe=qxe([].join);Kxe({target:"String",stat:!0,forced:!!D6&&D6.length!==1},{fromCodePoint:function(r){for(var a,s=[],l=arguments.length,d=0;l>d;){if(a=+arguments[d++],Yxe(a,1114111)!==a)throw new Xxe(a+" is not a valid code point");s[d]=a<65536?j6(a):j6(55296+((a-=65536)>>10),a%1024+56320)}return Jxe(s,"")}});var Zxe=u,Qxe=qr("iterator"),VS=!Zxe(function(){var r=new URL("b?a=1&b=2&c=3","https://a"),a=r.searchParams,s=new URLSearchParams("a=1&a=2&b=3"),l="";return r.pathname="c%20d",a.forEach(function(d,f){a.delete("b"),l+=f+d}),s.delete("a",2),s.delete("b",void 0),!r.toJSON||!s.has("a",1)||s.has("a",2)||!s.has("a",void 0)||s.has("b")||!a.size&&!0||!a.sort||r.href!=="https://a/c%20d?a=1&c=3"||a.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!a[Qxe]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||l!=="a1c3"||new URL("https://x",void 0).host!=="x"}),eTe=ih,kP=Tn,L6=R,jP=j$,tTe=at,BS=J,Xc=E,V_=ee,M6=VS,U6=ih,nTe=OS,rTe=function(r,a,s){for(var l in a)s&&s.unsafe&&r[l]?r[l]=a[l]:eTe(r,l,a[l],s);return r},iTe=Qu,aTe=qO,DP=zf,F6=XO,LP=K,sTe=aa,oTe=th,cTe=rh,lTe=Cs,V6=At,Ns=Ks,uTe=I_,B6=Pe,$6=FO,dTe=ES,$S=AS,Qm=Kf,hTe=S6,fTe=qr("iterator"),eg="URLSearchParams",W6=eg+"Iterator",G6=DP.set,oc=DP.getterFor(eg),pTe=DP.getterFor(W6),H6=jP("fetch"),WS=jP("Request"),B_=jP("Headers"),MP=WS&&WS.prototype,z6=B_&&B_.prototype,mTe=L6.TypeError,gTe=L6.encodeURIComponent,vTe=String.fromCharCode,yTe=tTe("String","fromCodePoint"),_Te=parseInt,GS=Xc("".charAt),K6=Xc([].join),ch=Xc([].push),q6=Xc("".replace),bTe=Xc([].shift),Y6=Xc([].splice),X6=Xc("".split),J6=Xc("".slice),ETe=Xc(/./.exec),wTe=/\+/g,STe=/^[0-9a-f]+$/i,Z6=function(r,a){var s=J6(r,a,a+2);return ETe(STe,s)?_Te(s,16):NaN},xTe=function(r){for(var a=0,s=128;s>0&&r&s;s>>=1)a++;return a},TTe=function(r){var a=null;switch(r.length){case 1:a=r[0];break;case 2:a=(31&r[0])<<6|63&r[1];break;case 3:a=(15&r[0])<<12|(63&r[1])<<6|63&r[2];break;case 4:a=(7&r[0])<<18|(63&r[1])<<12|(63&r[2])<<6|63&r[3]}return a>1114111?null:a},Q6=function(r){for(var a=(r=q6(r,wTe," ")).length,s="",l=0;l<a;){var d=GS(r,l);if(d==="%"){if(GS(r,l+1)==="%"||l+3>a){s+="%",l++;continue}var f=Z6(r,l+1);if(f!=f){s+=d,l++;continue}l+=2;var m=xTe(f);if(m===0)d=vTe(f);else{if(m===1||m>4){s+="�",l++;continue}for(var y=[f],_=1;_<m&&!(++l+3>a||GS(r,l)!=="%");){var w=Z6(r,l+1);if(w!=w){l+=3;break}if(w>191||w<128)break;ch(y,w),l+=2,_++}if(y.length!==m){s+="�";continue}var x=TTe(y);x===null?s+="�":d=yTe(x)}}s+=d,l++}return s},CTe=/[!'()~]|%20/g,RTe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},NTe=function(r){return RTe[r]},e8=function(r){return q6(gTe(r),CTe,NTe)},UP=aTe(function(r,a){G6(this,{type:W6,target:oc(r).entries,index:0,kind:a})},eg,function(){var r=pTe(this),a=r.target,s=r.index++;if(!a||s>=a.length)return r.target=null,$S(void 0,!0);var l=a[s];switch(r.kind){case"keys":return $S(l.key,!1);case"values":return $S(l.value,!1)}return $S([l.key,l.value],!1)},!0),t8=function(r){this.entries=[],this.url=null,r!==void 0&&(V6(r)?this.parseObject(r):this.parseQuery(typeof r=="string"?GS(r,0)==="?"?J6(r,1):r:Ns(r)))};t8.prototype={type:eg,bindURL:function(r){this.url=r,this.update()},parseObject:function(r){var a,s,l,d,f,m,y,_=this.entries,w=dTe(r);if(w)for(s=(a=$6(r,w)).next;!(l=BS(s,a)).done;){if(f=(d=$6(lTe(l.value))).next,(m=BS(f,d)).done||(y=BS(f,d)).done||!BS(f,d).done)throw new mTe("Expected sequence with length 2");ch(_,{key:Ns(m.value),value:Ns(y.value)})}else for(var x in r)sTe(r,x)&&ch(_,{key:x,value:Ns(r[x])})},parseQuery:function(r){if(r)for(var a,s,l=this.entries,d=X6(r,"&"),f=0;f<d.length;)(a=d[f++]).length&&(s=X6(a,"="),ch(l,{key:Q6(bTe(s)),value:Q6(K6(s,"="))}))},serialize:function(){for(var r,a=this.entries,s=[],l=0;l<a.length;)r=a[l++],ch(s,e8(r.key)+"="+e8(r.value));return K6(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var HS=function(){F6(this,tg);var r=G6(this,new t8(arguments.length>0?arguments[0]:void 0));V_||(this.size=r.entries.length)},tg=HS.prototype;if(rTe(tg,{append:function(r,a){var s=oc(this);Qm(arguments.length,2),ch(s.entries,{key:Ns(r),value:Ns(a)}),V_||this.length++,s.updateURL()},delete:function(r){for(var a=oc(this),s=Qm(arguments.length,1),l=a.entries,d=Ns(r),f=s<2?void 0:arguments[1],m=f===void 0?f:Ns(f),y=0;y<l.length;){var _=l[y];if(_.key!==d||m!==void 0&&_.value!==m)y++;else if(Y6(l,y,1),m!==void 0)break}V_||(this.size=l.length),a.updateURL()},get:function(r){var a=oc(this).entries;Qm(arguments.length,1);for(var s=Ns(r),l=0;l<a.length;l++)if(a[l].key===s)return a[l].value;return null},getAll:function(r){var a=oc(this).entries;Qm(arguments.length,1);for(var s=Ns(r),l=[],d=0;d<a.length;d++)a[d].key===s&&ch(l,a[d].value);return l},has:function(r){for(var a=oc(this).entries,s=Qm(arguments.length,1),l=Ns(r),d=s<2?void 0:arguments[1],f=d===void 0?d:Ns(d),m=0;m<a.length;){var y=a[m++];if(y.key===l&&(f===void 0||y.value===f))return!0}return!1},set:function(r,a){var s=oc(this);Qm(arguments.length,1);for(var l,d=s.entries,f=!1,m=Ns(r),y=Ns(a),_=0;_<d.length;_++)(l=d[_]).key===m&&(f?Y6(d,_--,1):(f=!0,l.value=y));f||ch(d,{key:m,value:y}),V_||(this.size=d.length),s.updateURL()},sort:function(){var r=oc(this);hTe(r.entries,function(a,s){return a.key>s.key?1:-1}),r.updateURL()},forEach:function(r){for(var a,s=oc(this).entries,l=oTe(r,arguments.length>1?arguments[1]:void 0),d=0;d<s.length;)l((a=s[d++]).value,a.key,this)},keys:function(){return new UP(this,"keys")},values:function(){return new UP(this,"values")},entries:function(){return new UP(this,"entries")}},{enumerable:!0}),U6(tg,fTe,tg.entries,{}),U6(tg,"toString",function(){return oc(this).serialize()},{enumerable:!0}),V_&&nTe(tg,"size",{get:function(){return oc(this).entries.length},configurable:!0,enumerable:!0}),iTe(HS,eg),kP({global:!0,forced:!M6},{URLSearchParams:HS}),!M6&&LP(B_)){var ATe=Xc(z6.has),ITe=Xc(z6.set),n8=function(r){if(V6(r)){var a,s=r.body;if(cTe(s)===eg)return a=r.headers?new B_(r.headers):new B_,ATe(a,"content-type")||ITe(a,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),uTe(r,{body:B6(0,Ns(s)),headers:B6(0,a)})}return r};if(LP(H6)&&kP({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(r){return H6(r,arguments.length>1?n8(arguments[1]):{})}}),LP(WS)){var FP=function(r){return F6(this,MP),new WS(r,arguments.length>1?n8(arguments[1]):{})};MP.constructor=FP,FP.prototype=MP,kP({global:!0,dontCallGetSet:!0,forced:!0},{Request:FP})}}var cc,OTe={URLSearchParams:HS,getState:oc},PTe=it.URLSearchParams,r8=ee,kTe=E,jTe=J,DTe=u,VP=yS,LTe=A_,MTe=re,UTe=Yl,FTe=Be,ng=Object.assign,i8=Object.defineProperty,VTe=kTe([].concat),BTe=!ng||DTe(function(){if(r8&&ng({b:1},ng(i8({},"a",{enumerable:!0,get:function(){i8(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},a={},s=Symbol("assign detection"),l="abcdefghijklmnopqrst";return r[s]=7,l.split("").forEach(function(d){a[d]=d}),ng({},r)[s]!==7||VP(ng({},a)).join("")!==l})?function(r,a){for(var s=UTe(r),l=arguments.length,d=1,f=LTe.f,m=MTe.f;l>d;)for(var y,_=FTe(arguments[d++]),w=f?VTe(VP(_),f(_)):VP(_),x=w.length,A=0;x>A;)y=w[A++],r8&&!jTe(m,_,y)||(s[y]=_[y]);return s}:ng,$Te=Cs,WTe=H5,GTe=ee,HTe=ic,zTe=Pe,BP=function(r,a,s){GTe?HTe.f(r,a,zTe(0,s)):r[a]=s},KTe=th,qTe=J,YTe=Yl,XTe=function(r,a,s,l){try{return l?a($Te(s)[0],s[1]):a(s)}catch(d){WTe(r,"throw",d)}},JTe=$5,ZTe=PS,QTe=nh,a8=BP,eCe=FO,tCe=ES,s8=Array,Xf=E,$P=2147483647,nCe=/[^\0-\u007E]/,o8=/[.\u3002\uFF0E\uFF61]/g,c8="Overflow: input needs wider integers to process",l8=RangeError,rCe=Xf(o8.exec),rg=Math.floor,WP=String.fromCharCode,u8=Xf("".charCodeAt),d8=Xf([].join),lh=Xf([].push),iCe=Xf("".replace),aCe=Xf("".split),sCe=Xf("".toLowerCase),h8=function(r){return r+22+75*(r<26)},oCe=function(r,a,s){var l=0;for(r=s?rg(r/700):r>>1,r+=rg(r/a);r>455;)r=rg(r/35),l+=36;return rg(l+36*r/(r+38))},cCe=function(r){var a=[];r=function(ne){for(var te=[],ce=0,pe=ne.length;ce<pe;){var fe=u8(ne,ce++);if(fe>=55296&&fe<=56319&&ce<pe){var ue=u8(ne,ce++);(64512&ue)==56320?lh(te,((1023&fe)<<10)+(1023&ue)+65536):(lh(te,fe),ce--)}else lh(te,fe)}return te}(r);var s,l,d=r.length,f=128,m=0,y=72;for(s=0;s<r.length;s++)(l=r[s])<128&&lh(a,WP(l));var _=a.length,w=_;for(_&&lh(a,"-");w<d;){var x=$P;for(s=0;s<r.length;s++)(l=r[s])>=f&&l<x&&(x=l);var A=w+1;if(x-f>rg(($P-m)/A))throw new l8(c8);for(m+=(x-f)*A,f=x,s=0;s<r.length;s++){if((l=r[s])<f&&++m>$P)throw new l8(c8);if(l===f){for(var I=m,L=36;;){var H=L<=y?1:L>=y+26?26:L-y;if(I<H)break;var $=I-H,G=36-H;lh(a,WP(h8(H+$%G))),I=rg($/G),L+=36}lh(a,WP(h8(I))),y=oCe(m,A,w===_),m=0,w++}}m++,f++}return d8(a,"")},lCe=Tn,GP=ee,uCe=VS,HP=R,f8=th,lc=E,zS=ih,uc=OS,dCe=XO,zP=aa,KP=BTe,ig=function(r){var a=YTe(r),s=ZTe(this),l=arguments.length,d=l>1?arguments[1]:void 0,f=d!==void 0;f&&(d=KTe(d,l>2?arguments[2]:void 0));var m,y,_,w,x,A,I=tCe(a),L=0;if(!I||this===s8&&JTe(I))for(m=QTe(a),y=s?new this(m):s8(m);m>L;L++)A=f?d(a[L],L):a[L],a8(y,L,A);else for(y=s?new this:[],x=(w=eCe(a,I)).next;!(_=qTe(x,w)).done;L++)A=f?XTe(w,d,[_.value,L],!0):_.value,a8(y,L,A);return y.length=L,y},Jc=ah,hCe=RP.codeAt,fCe=function(r){var a,s,l=[],d=aCe(iCe(sCe(r),o8,"."),".");for(a=0;a<d.length;a++)s=d[a],lh(l,rCe(nCe,s)?"xn--"+cCe(s):s);return d8(l,".")},ed=Ks,pCe=Qu,mCe=Kf,p8=OTe,m8=zf,gCe=m8.set,KS=m8.getterFor("URL"),vCe=p8.URLSearchParams,yCe=p8.getState,$_=HP.URL,qP=HP.TypeError,qS=HP.parseInt,_Ce=Math.floor,g8=Math.pow,dc=lc("".charAt),Zc=lc(/./.exec),W_=lc([].join),bCe=lc(1 .toString),ECe=lc([].pop),ag=lc([].push),YP=lc("".replace),wCe=lc([].shift),SCe=lc("".split),G_=lc("".slice),YS=lc("".toLowerCase),xCe=lc([].unshift),XP="Invalid scheme",Jf="Invalid host",v8="Invalid port",y8=/[a-z]/i,TCe=/[\d+-.a-z]/i,JP=/\d/,CCe=/^0x/i,RCe=/^[0-7]+$/,NCe=/^\d+$/,_8=/^[\da-f]+$/i,ACe=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ICe=/[\0\t\n\r #/:<>?@[\\\]^|]/,OCe=/^[\u0000-\u0020]+/,PCe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,kCe=/[\t\n\r]/g,H_=function(r){var a,s,l,d;if(typeof r=="number"){for(a=[],s=0;s<4;s++)xCe(a,r%256),r=_Ce(r/256);return W_(a,".")}if(typeof r=="object"){for(a="",l=function(f){for(var m=null,y=1,_=null,w=0,x=0;x<8;x++)f[x]!==0?(w>y&&(m=_,y=w),_=null,w=0):(_===null&&(_=x),++w);return w>y?_:m}(r),s=0;s<8;s++)d&&r[s]===0||(d&&(d=!1),l===s?(a+=s?":":"::",d=!0):(a+=bCe(r[s],16),s<7&&(a+=":")));return"["+a+"]"}return r},XS={},b8=KP({},XS,{" ":1,'"':1,"<":1,">":1,"`":1}),E8=KP({},b8,{"#":1,"?":1,"{":1,"}":1}),ZP=KP({},E8,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),uh=function(r,a){var s=hCe(r,0);return s>32&&s<127&&!zP(a,r)?r:encodeURIComponent(r)},JS={ftp:21,file:null,http:80,https:443,ws:80,wss:443},z_=function(r,a){var s;return r.length===2&&Zc(y8,dc(r,0))&&((s=dc(r,1))===":"||!a&&s==="|")},w8=function(r){var a;return r.length>1&&z_(G_(r,0,2))&&(r.length===2||(a=dc(r,2))==="/"||a==="\\"||a==="?"||a==="#")},jCe=function(r){return r==="."||YS(r)==="%2e"},QP={},S8={},ek={},x8={},T8={},tk={},C8={},R8={},ZS={},QS={},nk={},rk={},ik={},ak={},N8={},sk={},sg={},Zl={},A8={},Zf={},td={},ok=function(r,a,s){var l,d,f,m=ed(r);if(a){if(d=this.parse(m))throw new qP(d);this.searchParams=null}else{if(s!==void 0&&(l=new ok(s,!0)),d=this.parse(m,null,l))throw new qP(d);(f=yCe(new vCe)).bindURL(this),this.searchParams=f}};ok.prototype={type:"URL",parse:function(r,a,s){var l,d,f,m,y,_=this,w=a||QP,x=0,A="",I=!1,L=!1,H=!1;for(r=ed(r),a||(_.scheme="",_.username="",_.password="",_.host=null,_.port=null,_.path=[],_.query=null,_.fragment=null,_.cannotBeABaseURL=!1,r=YP(r,OCe,""),r=YP(r,PCe,"$1")),r=YP(r,kCe,""),l=ig(r);x<=l.length;){switch(d=l[x],w){case QP:if(!d||!Zc(y8,d)){if(a)return XP;w=ek;continue}A+=YS(d),w=S8;break;case S8:if(d&&(Zc(TCe,d)||d==="+"||d==="-"||d==="."))A+=YS(d);else{if(d!==":"){if(a)return XP;A="",w=ek,x=0;continue}if(a&&(_.isSpecial()!==zP(JS,A)||A==="file"&&(_.includesCredentials()||_.port!==null)||_.scheme==="file"&&!_.host))return;if(_.scheme=A,a)return void(_.isSpecial()&&JS[_.scheme]===_.port&&(_.port=null));A="",_.scheme==="file"?w=ak:_.isSpecial()&&s&&s.scheme===_.scheme?w=x8:_.isSpecial()?w=R8:l[x+1]==="/"?(w=T8,x++):(_.cannotBeABaseURL=!0,ag(_.path,""),w=A8)}break;case ek:if(!s||s.cannotBeABaseURL&&d!=="#")return XP;if(s.cannotBeABaseURL&&d==="#"){_.scheme=s.scheme,_.path=Jc(s.path),_.query=s.query,_.fragment="",_.cannotBeABaseURL=!0,w=td;break}w=s.scheme==="file"?ak:tk;continue;case x8:if(d!=="/"||l[x+1]!=="/"){w=tk;continue}w=ZS,x++;break;case T8:if(d==="/"){w=QS;break}w=Zl;continue;case tk:if(_.scheme=s.scheme,d===cc)_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=Jc(s.path),_.query=s.query;else if(d==="/"||d==="\\"&&_.isSpecial())w=C8;else if(d==="?")_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=Jc(s.path),_.query="",w=Zf;else{if(d!=="#"){_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=Jc(s.path),_.path.length--,w=Zl;continue}_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=Jc(s.path),_.query=s.query,_.fragment="",w=td}break;case C8:if(!_.isSpecial()||d!=="/"&&d!=="\\"){if(d!=="/"){_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,w=Zl;continue}w=QS}else w=ZS;break;case R8:if(w=ZS,d!=="/"||dc(A,x+1)!=="/")continue;x++;break;case ZS:if(d!=="/"&&d!=="\\"){w=QS;continue}break;case QS:if(d==="@"){I&&(A="%40"+A),I=!0,f=ig(A);for(var $=0;$<f.length;$++){var G=f[$];if(G!==":"||H){var ne=uh(G,ZP);H?_.password+=ne:_.username+=ne}else H=!0}A=""}else if(d===cc||d==="/"||d==="?"||d==="#"||d==="\\"&&_.isSpecial()){if(I&&A==="")return"Invalid authority";x-=ig(A).length+1,A="",w=nk}else A+=d;break;case nk:case rk:if(a&&_.scheme==="file"){w=sk;continue}if(d!==":"||L){if(d===cc||d==="/"||d==="?"||d==="#"||d==="\\"&&_.isSpecial()){if(_.isSpecial()&&A==="")return Jf;if(a&&A===""&&(_.includesCredentials()||_.port!==null))return;if(m=_.parseHost(A))return m;if(A="",w=sg,a)return;continue}d==="["?L=!0:d==="]"&&(L=!1),A+=d}else{if(A==="")return Jf;if(m=_.parseHost(A))return m;if(A="",w=ik,a===rk)return}break;case ik:if(!Zc(JP,d)){if(d===cc||d==="/"||d==="?"||d==="#"||d==="\\"&&_.isSpecial()||a){if(A!==""){var te=qS(A,10);if(te>65535)return v8;_.port=_.isSpecial()&&te===JS[_.scheme]?null:te,A=""}if(a)return;w=sg;continue}return v8}A+=d;break;case ak:if(_.scheme="file",d==="/"||d==="\\")w=N8;else{if(!s||s.scheme!=="file"){w=Zl;continue}switch(d){case cc:_.host=s.host,_.path=Jc(s.path),_.query=s.query;break;case"?":_.host=s.host,_.path=Jc(s.path),_.query="",w=Zf;break;case"#":_.host=s.host,_.path=Jc(s.path),_.query=s.query,_.fragment="",w=td;break;default:w8(W_(Jc(l,x),""))||(_.host=s.host,_.path=Jc(s.path),_.shortenPath()),w=Zl;continue}}break;case N8:if(d==="/"||d==="\\"){w=sk;break}s&&s.scheme==="file"&&!w8(W_(Jc(l,x),""))&&(z_(s.path[0],!0)?ag(_.path,s.path[0]):_.host=s.host),w=Zl;continue;case sk:if(d===cc||d==="/"||d==="\\"||d==="?"||d==="#"){if(!a&&z_(A))w=Zl;else if(A===""){if(_.host="",a)return;w=sg}else{if(m=_.parseHost(A))return m;if(_.host==="localhost"&&(_.host=""),a)return;A="",w=sg}continue}A+=d;break;case sg:if(_.isSpecial()){if(w=Zl,d!=="/"&&d!=="\\")continue}else if(a||d!=="?")if(a||d!=="#"){if(d!==cc&&(w=Zl,d!=="/"))continue}else _.fragment="",w=td;else _.query="",w=Zf;break;case Zl:if(d===cc||d==="/"||d==="\\"&&_.isSpecial()||!a&&(d==="?"||d==="#")){if((y=YS(y=A))===".."||y==="%2e."||y===".%2e"||y==="%2e%2e"?(_.shortenPath(),d==="/"||d==="\\"&&_.isSpecial()||ag(_.path,"")):jCe(A)?d==="/"||d==="\\"&&_.isSpecial()||ag(_.path,""):(_.scheme==="file"&&!_.path.length&&z_(A)&&(_.host&&(_.host=""),A=dc(A,0)+":"),ag(_.path,A)),A="",_.scheme==="file"&&(d===cc||d==="?"||d==="#"))for(;_.path.length>1&&_.path[0]==="";)wCe(_.path);d==="?"?(_.query="",w=Zf):d==="#"&&(_.fragment="",w=td)}else A+=uh(d,E8);break;case A8:d==="?"?(_.query="",w=Zf):d==="#"?(_.fragment="",w=td):d!==cc&&(_.path[0]+=uh(d,XS));break;case Zf:a||d!=="#"?d!==cc&&(d==="'"&&_.isSpecial()?_.query+="%27":_.query+=d==="#"?"%23":uh(d,XS)):(_.fragment="",w=td);break;case td:d!==cc&&(_.fragment+=uh(d,b8))}x++}},parseHost:function(r){var a,s,l;if(dc(r,0)==="["){if(dc(r,r.length-1)!=="]"||(a=function(d){var f,m,y,_,w,x,A,I=[0,0,0,0,0,0,0,0],L=0,H=null,$=0,G=function(){return dc(d,$)};if(G()===":"){if(dc(d,1)!==":")return;$+=2,H=++L}for(;G();){if(L===8)return;if(G()!==":"){for(f=m=0;m<4&&Zc(_8,G());)f=16*f+qS(G(),16),$++,m++;if(G()==="."){if(m===0||($-=m,L>6))return;for(y=0;G();){if(_=null,y>0){if(!(G()==="."&&y<4))return;$++}if(!Zc(JP,G()))return;for(;Zc(JP,G());){if(w=qS(G(),10),_===null)_=w;else{if(_===0)return;_=10*_+w}if(_>255)return;$++}I[L]=256*I[L]+_,++y!=2&&y!==4||L++}if(y!==4)return;break}if(G()===":"){if($++,!G())return}else if(G())return;I[L++]=f}else{if(H!==null)return;$++,H=++L}}if(H!==null)for(x=L-H,L=7;L!==0&&x>0;)A=I[L],I[L--]=I[H+x-1],I[H+--x]=A;else if(L!==8)return;return I}(G_(r,1,-1)),!a))return Jf;this.host=a}else if(this.isSpecial()){if(r=fCe(r),Zc(ACe,r)||(a=function(d){var f,m,y,_,w,x,A,I=SCe(d,".");if(I.length&&I[I.length-1]===""&&I.length--,(f=I.length)>4)return d;for(m=[],y=0;y<f;y++){if((_=I[y])==="")return d;if(w=10,_.length>1&&dc(_,0)==="0"&&(w=Zc(CCe,_)?16:8,_=G_(_,w===8?1:2)),_==="")x=0;else{if(!Zc(w===10?NCe:w===8?RCe:_8,_))return d;x=qS(_,w)}ag(m,x)}for(y=0;y<f;y++)if(x=m[y],y===f-1){if(x>=g8(256,5-f))return null}else if(x>255)return null;for(A=ECe(m),y=0;y<m.length;y++)A+=m[y]*g8(256,3-y);return A}(r),a===null))return Jf;this.host=a}else{if(Zc(ICe,r))return Jf;for(a="",s=ig(r),l=0;l<s.length;l++)a+=uh(s[l],XS);this.host=a}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return zP(JS,this.scheme)},shortenPath:function(){var r=this.path,a=r.length;!a||this.scheme==="file"&&a===1&&z_(r[0],!0)||r.length--},serialize:function(){var r=this,a=r.scheme,s=r.username,l=r.password,d=r.host,f=r.port,m=r.path,y=r.query,_=r.fragment,w=a+":";return d!==null?(w+="//",r.includesCredentials()&&(w+=s+(l?":"+l:"")+"@"),w+=H_(d),f!==null&&(w+=":"+f)):a==="file"&&(w+="//"),w+=r.cannotBeABaseURL?m[0]:m.length?"/"+W_(m,"/"):"",y!==null&&(w+="?"+y),_!==null&&(w+="#"+_),w},setHref:function(r){var a=this.parse(r);if(a)throw new qP(a);this.searchParams.update()},getOrigin:function(){var r=this.scheme,a=this.port;if(r==="blob")try{return new og(r.path[0]).origin}catch{return"null"}return r!=="file"&&this.isSpecial()?r+"://"+H_(this.host)+(a!==null?":"+a:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(r){this.parse(ed(r)+":",QP)},getUsername:function(){return this.username},setUsername:function(r){var a=ig(ed(r));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var s=0;s<a.length;s++)this.username+=uh(a[s],ZP)}},getPassword:function(){return this.password},setPassword:function(r){var a=ig(ed(r));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var s=0;s<a.length;s++)this.password+=uh(a[s],ZP)}},getHost:function(){var r=this.host,a=this.port;return r===null?"":a===null?H_(r):H_(r)+":"+a},setHost:function(r){this.cannotBeABaseURL||this.parse(r,nk)},getHostname:function(){var r=this.host;return r===null?"":H_(r)},setHostname:function(r){this.cannotBeABaseURL||this.parse(r,rk)},getPort:function(){var r=this.port;return r===null?"":ed(r)},setPort:function(r){this.cannotHaveUsernamePasswordPort()||((r=ed(r))===""?this.port=null:this.parse(r,ik))},getPathname:function(){var r=this.path;return this.cannotBeABaseURL?r[0]:r.length?"/"+W_(r,"/"):""},setPathname:function(r){this.cannotBeABaseURL||(this.path=[],this.parse(r,sg))},getSearch:function(){var r=this.query;return r?"?"+r:""},setSearch:function(r){(r=ed(r))===""?this.query=null:(dc(r,0)==="?"&&(r=G_(r,1)),this.query="",this.parse(r,Zf)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var r=this.fragment;return r?"#"+r:""},setHash:function(r){(r=ed(r))!==""?(dc(r,0)==="#"&&(r=G_(r,1)),this.fragment="",this.parse(r,td)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var og=function(r){var a=dCe(this,As),s=mCe(arguments.length,1)>1?arguments[1]:void 0,l=gCe(a,new ok(r,!1,s));GP||(a.href=l.serialize(),a.origin=l.getOrigin(),a.protocol=l.getProtocol(),a.username=l.getUsername(),a.password=l.getPassword(),a.host=l.getHost(),a.hostname=l.getHostname(),a.port=l.getPort(),a.pathname=l.getPathname(),a.search=l.getSearch(),a.searchParams=l.getSearchParams(),a.hash=l.getHash())},As=og.prototype,hc=function(r,a){return{get:function(){return KS(this)[r]()},set:a&&function(s){return KS(this)[a](s)},configurable:!0,enumerable:!0}};if(GP&&(uc(As,"href",hc("serialize","setHref")),uc(As,"origin",hc("getOrigin")),uc(As,"protocol",hc("getProtocol","setProtocol")),uc(As,"username",hc("getUsername","setUsername")),uc(As,"password",hc("getPassword","setPassword")),uc(As,"host",hc("getHost","setHost")),uc(As,"hostname",hc("getHostname","setHostname")),uc(As,"port",hc("getPort","setPort")),uc(As,"pathname",hc("getPathname","setPathname")),uc(As,"search",hc("getSearch","setSearch")),uc(As,"searchParams",hc("getSearchParams")),uc(As,"hash",hc("getHash","setHash"))),zS(As,"toJSON",function(){return KS(this).serialize()},{enumerable:!0}),zS(As,"toString",function(){return KS(this).serialize()},{enumerable:!0}),$_){var I8=$_.createObjectURL,O8=$_.revokeObjectURL;I8&&zS(og,"createObjectURL",f8(I8,$_)),O8&&zS(og,"revokeObjectURL",f8(O8,$_))}pCe(og,"URL"),lCe({global:!0,forced:!uCe,sham:!GP},{URL:og});var DCe=Tn,P8=u,LCe=Kf,k8=Ks,MCe=VS,ck=at("URL"),UCe=MCe&&P8(function(){ck.canParse()}),FCe=P8(function(){return ck.canParse.length!==1});DCe({target:"URL",stat:!0,forced:!UCe||FCe},{canParse:function(r){var a=LCe(arguments.length,1),s=k8(r),l=a<2||arguments[1]===void 0?void 0:k8(arguments[1]);try{return!!new ck(s,l)}catch{return!1}}});var VCe=Tn,BCe=Kf,j8=Ks,$Ce=VS,WCe=at("URL");VCe({target:"URL",stat:!0,forced:!$Ce},{parse:function(r){var a=BCe(arguments.length,1),s=j8(r),l=a<2||arguments[1]===void 0?void 0:j8(arguments[1]);try{return new WCe(s,l)}catch{return null}}});var ex=o(it.URL);let D8=!0,L8=!0;function tx(r,a,s){const l=r.match(a);return l&&l.length>=s&&parseInt(l[s],10)}function Qf(r,a,s){if(!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype,d=l.addEventListener;l.addEventListener=function(m,y){if(m!==a)return d.apply(this,arguments);const _=w=>{const x=s(w);x&&(y.handleEvent?y.handleEvent(x):y(x))};return this._eventMap=this._eventMap||{},this._eventMap[a]||(this._eventMap[a]=new Map),this._eventMap[a].set(y,_),d.apply(this,[m,_])};const f=l.removeEventListener;l.removeEventListener=function(m,y){if(m!==a||!this._eventMap||!this._eventMap[a])return f.apply(this,arguments);if(!this._eventMap[a].has(y))return f.apply(this,arguments);const _=this._eventMap[a].get(y);return this._eventMap[a].delete(y),this._eventMap[a].size===0&&delete this._eventMap[a],Object.keys(this._eventMap).length===0&&delete this._eventMap,f.apply(this,[m,_])},Object.defineProperty(l,"on"+a,{get(){return this["_on"+a]},set(m){this["_on"+a]&&(this.removeEventListener(a,this["_on"+a]),delete this["_on"+a]),m&&this.addEventListener(a,this["_on"+a]=m)},enumerable:!0,configurable:!0})}function GCe(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(D8=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function HCe(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(L8=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function M8(){if(typeof window=="object"){if(D8)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function lk(r,a){L8&&console.warn(r+" is deprecated, please use "+a+" instead.")}function U8(r){return Object.prototype.toString.call(r)==="[object Object]"}function F8(r){var a;return U8(r)?sc(a=Object.keys(r)).call(a,function(s,l){const d=U8(r[l]),f=d?F8(r[l]):r[l],m=d&&!Object.keys(f).length;return f===void 0||m?s:Object.assign(s,{[l]:f})},{}):r}function uk(r,a,s){a&&!s.has(a.id)&&(s.set(a.id,a),Object.keys(a).forEach(l=>{l.endsWith("Id")?uk(r,r.get(a[l]),s):l.endsWith("Ids")&&a[l].forEach(d=>{uk(r,r.get(d),s)})}))}function V8(r,a,s){const l=s?"outbound-rtp":"inbound-rtp",d=new Map;if(a===null)return d;const f=[];return r.forEach(m=>{m.type==="track"&&m.trackIdentifier===a.id&&f.push(m)}),f.forEach(m=>{r.forEach(y=>{y.type===l&&y.trackId===m.id&&uk(r,y,d)})}),d}const B8=M8;function $8(r,a){const s=r&&r.navigator;if(!s.mediaDevices)return;const l=function(m){if(typeof m!="object"||m.mandatory||m.optional)return m;const y={};return Object.keys(m).forEach(_=>{if(_==="require"||_==="advanced"||_==="mediaSource")return;const w=typeof m[_]=="object"?m[_]:{ideal:m[_]};w.exact!==void 0&&typeof w.exact=="number"&&(w.min=w.max=w.exact);const x=function(A,I){return A?A+I.charAt(0).toUpperCase()+I.slice(1):I==="deviceId"?"sourceId":I};if(w.ideal!==void 0){y.optional=y.optional||[];let A={};typeof w.ideal=="number"?(A[x("min",_)]=w.ideal,y.optional.push(A),A={},A[x("max",_)]=w.ideal,y.optional.push(A)):(A[x("",_)]=w.ideal,y.optional.push(A))}w.exact!==void 0&&typeof w.exact!="number"?(y.mandatory=y.mandatory||{},y.mandatory[x("",_)]=w.exact):["min","max"].forEach(A=>{w[A]!==void 0&&(y.mandatory=y.mandatory||{},y.mandatory[x(A,_)]=w[A])})}),m.advanced&&(y.optional=(y.optional||[]).concat(m.advanced)),y},d=function(m,y){if(a.version>=61)return y(m);if((m=JSON.parse(JSON.stringify(m)))&&typeof m.audio=="object"){const _=function(w,x,A){x in w&&!(A in w)&&(w[A]=w[x],delete w[x])};_((m=JSON.parse(JSON.stringify(m))).audio,"autoGainControl","googAutoGainControl"),_(m.audio,"noiseSuppression","googNoiseSuppression"),m.audio=l(m.audio)}if(m&&typeof m.video=="object"){let _=m.video.facingMode;_=_&&(typeof _=="object"?_:{ideal:_});const w=a.version<66;if(_&&(_.exact==="user"||_.exact==="environment"||_.ideal==="user"||_.ideal==="environment")&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||w)){let x;if(delete m.video.facingMode,_.exact==="environment"||_.ideal==="environment"?x=["back","rear"]:_.exact!=="user"&&_.ideal!=="user"||(x=["front"]),x)return s.mediaDevices.enumerateDevices().then(A=>{A=A.filter(L=>L.kind==="videoinput");let I=A.find(L=>x.some(H=>{var $;return Ve($=L.label.toLowerCase()).call($,H)}));return!I&&A.length&&Ve(x).call(x,"back")&&(I=A[A.length-1]),I&&(m.video.deviceId=_.exact?{exact:I.deviceId}:{ideal:I.deviceId}),m.video=l(m.video),B8("chrome: "+JSON.stringify(m)),y(m)})}m.video=l(m.video)}return B8("chrome: "+JSON.stringify(m)),y(m)},f=function(m){return a.version>=64?m:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[m.name]||m.name,message:m.message,constraint:m.constraint||m.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(s.getUserMedia=(function(m,y,_){d(m,w=>{s.webkitGetUserMedia(w,y,x=>{_&&_(f(x))})})}).bind(s),s.mediaDevices.getUserMedia){const m=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(y){return d(y,_=>m(_).then(w=>{if(_.audio&&!w.getAudioTracks().length||_.video&&!w.getVideoTracks().length)throw w.getTracks().forEach(x=>{x.stop()}),new DOMException("","NotFoundError");return w},w=>Ge.reject(f(w))))}}}function W8(r){r.MediaStream=r.MediaStream||r.webkitMediaStream}function G8(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("ontrack"in r.RTCPeerConnection.prototype)){Object.defineProperty(r.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(s){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=s)},enumerable:!0,configurable:!0});const a=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",l=>{let d;d=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(m=>m.track&&m.track.id===l.track.id):{track:l.track};const f=new Event("track");f.track=l.track,f.receiver=d,f.transceiver={receiver:d},f.streams=[s.stream],this.dispatchEvent(f)}),s.stream.getTracks().forEach(l=>{let d;d=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(m=>m.track&&m.track.id===l.id):{track:l};const f=new Event("track");f.track=l,f.receiver=d,f.transceiver={receiver:d},f.streams=[s.stream],this.dispatchEvent(f)})},this.addEventListener("addstream",this._ontrackpoly)),a.apply(this,arguments)}}else Qf(r,"track",a=>(a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}}),a))}function H8(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("getSenders"in r.RTCPeerConnection.prototype)&&"createDTMFSender"in r.RTCPeerConnection.prototype){const a=function(d,f){return{track:f,get dtmf(){return this._dtmf===void 0&&(f.kind==="audio"?this._dtmf=d.createDTMFSender(f):this._dtmf=null),this._dtmf},_pc:d}};if(!r.RTCPeerConnection.prototype.getSenders){r.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const d=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(m,y){let _=d.apply(this,arguments);return _||(_=a(this,m),this._senders.push(_)),_};const f=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(m){f.apply(this,arguments);const y=this._senders.indexOf(m);y!==-1&&this._senders.splice(y,1)}}const s=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(d){this._senders=this._senders||[],s.apply(this,[d]),d.getTracks().forEach(f=>{this._senders.push(a(this,f))})};const l=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(d){this._senders=this._senders||[],l.apply(this,[d]),d.getTracks().forEach(f=>{const m=this._senders.find(y=>y.track===f);m&&this._senders.splice(this._senders.indexOf(m),1)})}}else if(typeof r=="object"&&r.RTCPeerConnection&&"getSenders"in r.RTCPeerConnection.prototype&&"createDTMFSender"in r.RTCPeerConnection.prototype&&r.RTCRtpSender&&!("dtmf"in r.RTCRtpSender.prototype)){const a=r.RTCPeerConnection.prototype.getSenders;r.RTCPeerConnection.prototype.getSenders=function(){const s=a.apply(this,[]);return s.forEach(l=>l._pc=this),s},Object.defineProperty(r.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function z8(r){if(!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[s,l,d]=arguments;if(arguments.length>0&&typeof s=="function")return a.apply(this,arguments);if(a.length===0&&(arguments.length===0||typeof s!="function"))return a.apply(this,[]);const f=function(y){const _={};return y.result().forEach(w=>{const x={id:w.id,timestamp:w.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[w.type]||w.type};w.names().forEach(A=>{x[A]=w.stat(A)}),_[x.id]=x}),_},m=function(y){return new Map(Object.keys(y).map(_=>[_,y[_]]))};if(arguments.length>=2){const y=function(_){l(m(f(_)))};return a.apply(this,[y,s])}return new Ge((y,_)=>{a.apply(this,[function(w){y(m(f(w)))},_])}).then(l,d)}}function K8(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender&&r.RTCRtpReceiver))return;if(!("getStats"in r.RTCRtpSender.prototype)){const s=r.RTCPeerConnection.prototype.getSenders;s&&(r.RTCPeerConnection.prototype.getSenders=function(){const d=s.apply(this,[]);return d.forEach(f=>f._pc=this),d});const l=r.RTCPeerConnection.prototype.addTrack;l&&(r.RTCPeerConnection.prototype.addTrack=function(){const d=l.apply(this,arguments);return d._pc=this,d}),r.RTCRtpSender.prototype.getStats=function(){const d=this;return this._pc.getStats().then(f=>V8(f,d.track,!0))}}if(!("getStats"in r.RTCRtpReceiver.prototype)){const s=r.RTCPeerConnection.prototype.getReceivers;s&&(r.RTCPeerConnection.prototype.getReceivers=function(){const l=s.apply(this,[]);return l.forEach(d=>d._pc=this),l}),Qf(r,"track",l=>(l.receiver._pc=l.srcElement,l)),r.RTCRtpReceiver.prototype.getStats=function(){const l=this;return this._pc.getStats().then(d=>V8(d,l.track,!1))}}if(!("getStats"in r.RTCRtpSender.prototype)||!("getStats"in r.RTCRtpReceiver.prototype))return;const a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof r.MediaStreamTrack){const s=arguments[0];let l,d,f;return this.getSenders().forEach(m=>{m.track===s&&(l?f=!0:l=m)}),this.getReceivers().forEach(m=>(m.track===s&&(d?f=!0:d=m),m.track===s)),f||l&&d?Ge.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():d?d.getStats():Ge.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}function q8(r){r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(f=>this._shimmedLocalStreams[f][0])};const a=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(f,m){if(!m)return a.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const y=a.apply(this,arguments);return this._shimmedLocalStreams[m.id]?this._shimmedLocalStreams[m.id].indexOf(y)===-1&&this._shimmedLocalStreams[m.id].push(y):this._shimmedLocalStreams[m.id]=[m,y],y};const s=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(f){this._shimmedLocalStreams=this._shimmedLocalStreams||{},f.getTracks().forEach(_=>{if(this.getSenders().find(x=>x.track===_))throw new DOMException("Track already exists.","InvalidAccessError")});const m=this.getSenders();s.apply(this,arguments);const y=this.getSenders().filter(_=>m.indexOf(_)===-1);this._shimmedLocalStreams[f.id]=[f].concat(y)};const l=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(f){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[f.id],l.apply(this,arguments)};const d=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(f){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},f&&Object.keys(this._shimmedLocalStreams).forEach(m=>{const y=this._shimmedLocalStreams[m].indexOf(f);y!==-1&&this._shimmedLocalStreams[m].splice(y,1),this._shimmedLocalStreams[m].length===1&&delete this._shimmedLocalStreams[m]}),d.apply(this,arguments)}}function Y8(r,a){if(!r.RTCPeerConnection)return;if(r.RTCPeerConnection.prototype.addTrack&&a.version>=65)return q8(r);const s=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){const _=s.apply(this);return this._reverseStreams=this._reverseStreams||{},_.map(w=>this._reverseStreams[w.id])};const l=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(_){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_.getTracks().forEach(w=>{if(this.getSenders().find(A=>A.track===w))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_.id]){const w=new r.MediaStream(_.getTracks());this._streams[_.id]=w,this._reverseStreams[w.id]=_,_=w}l.apply(this,[_])};const d=r.RTCPeerConnection.prototype.removeStream;function f(_,w){let x=w.sdp;return Object.keys(_._reverseStreams||[]).forEach(A=>{const I=_._reverseStreams[A],L=_._streams[I.id];x=x.replace(new RegExp(L.id,"g"),I.id)}),new RTCSessionDescription({type:w.type,sdp:x})}r.RTCPeerConnection.prototype.removeStream=function(_){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.apply(this,[this._streams[_.id]||_]),delete this._reverseStreams[this._streams[_.id]?this._streams[_.id].id:_.id],delete this._streams[_.id]},r.RTCPeerConnection.prototype.addTrack=function(_,w){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const x=[].slice.call(arguments,1);if(x.length!==1||!x[0].getTracks().find(L=>L===_))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(L=>L.track===_))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const I=this._streams[w.id];if(I)I.addTrack(_),Ge.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const L=new r.MediaStream([_]);this._streams[w.id]=L,this._reverseStreams[L.id]=w,this.addStream(L)}return this.getSenders().find(L=>L.track===_)},["createOffer","createAnswer"].forEach(function(_){const w=r.RTCPeerConnection.prototype[_],x={[_](){const A=arguments;return arguments.length&&typeof arguments[0]=="function"?w.apply(this,[I=>{const L=f(this,I);A[0].apply(null,[L])},I=>{A[1]&&A[1].apply(null,I)},arguments[2]]):w.apply(this,arguments).then(I=>f(this,I))}};r.RTCPeerConnection.prototype[_]=x[_]});const m=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(_,w){let x=w.sdp;return Object.keys(_._reverseStreams||[]).forEach(A=>{const I=_._reverseStreams[A],L=_._streams[I.id];x=x.replace(new RegExp(I.id,"g"),L.id)}),new RTCSessionDescription({type:w.type,sdp:x})}(this,arguments[0]),m.apply(this,arguments)):m.apply(this,arguments)};const y=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get(){const _=y.get.apply(this);return _.type===""?_:f(this,_)}}),r.RTCPeerConnection.prototype.removeTrack=function(_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let w;this._streams=this._streams||{},Object.keys(this._streams).forEach(x=>{this._streams[x].getTracks().find(A=>_.track===A)&&(w=this._streams[x])}),w&&(w.getTracks().length===1?this.removeStream(this._reverseStreams[w.id]):w.removeTrack(_.track),this.dispatchEvent(new Event("negotiationneeded")))}}function dk(r,a){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const l=r.RTCPeerConnection.prototype[s],d={[s](){return arguments[0]=new(s==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};r.RTCPeerConnection.prototype[s]=d[s]})}function X8(r,a){Qf(r,"negotiationneeded",s=>{const l=s.target;if(!(a.version<72||l.getConfiguration&&l.getConfiguration().sdpSemantics==="plan-b")||l.signalingState==="stable")return s})}var J8=Object.freeze({__proto__:null,fixNegotiationNeeded:X8,shimAddTrackRemoveTrack:Y8,shimAddTrackRemoveTrackWithNative:q8,shimGetDisplayMedia:function(r,a){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(typeof a=="function"?r.navigator.mediaDevices.getDisplayMedia=function(s){return a(s).then(l=>{const d=s.video&&s.video.width,f=s.video&&s.video.height,m=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l,maxFrameRate:m||3}},d&&(s.video.mandatory.maxWidth=d),f&&(s.video.mandatory.maxHeight=f),r.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:H8,shimGetStats:z8,shimGetUserMedia:$8,shimMediaStream:W8,shimOnTrack:G8,shimPeerConnection:dk,shimSenderReceiverGetStats:K8});function Z8(r,a){const s=r&&r.navigator,l=r&&r.MediaStreamTrack;if(s.getUserMedia=function(d,f,m){lk("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),s.mediaDevices.getUserMedia(d).then(f,m)},!(a.version>55&&"autoGainControl"in s.mediaDevices.getSupportedConstraints())){const d=function(m,y,_){y in m&&!(_ in m)&&(m[_]=m[y],delete m[y])},f=s.mediaDevices.getUserMedia.bind(s.mediaDevices);if(s.mediaDevices.getUserMedia=function(m){return typeof m=="object"&&typeof m.audio=="object"&&(m=JSON.parse(JSON.stringify(m)),d(m.audio,"autoGainControl","mozAutoGainControl"),d(m.audio,"noiseSuppression","mozNoiseSuppression")),f(m)},l&&l.prototype.getSettings){const m=l.prototype.getSettings;l.prototype.getSettings=function(){const y=m.apply(this,arguments);return d(y,"mozAutoGainControl","autoGainControl"),d(y,"mozNoiseSuppression","noiseSuppression"),y}}if(l&&l.prototype.applyConstraints){const m=l.prototype.applyConstraints;l.prototype.applyConstraints=function(y){return this.kind==="audio"&&typeof y=="object"&&(y=JSON.parse(JSON.stringify(y)),d(y,"autoGainControl","mozAutoGainControl"),d(y,"noiseSuppression","mozNoiseSuppression")),m.apply(this,[y])}}}}function Q8(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function hk(r,a){if(typeof r!="object"||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const f=r.RTCPeerConnection.prototype[d],m={[d](){return arguments[0]=new(d==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),f.apply(this,arguments)}};r.RTCPeerConnection.prototype[d]=m[d]});const s={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},l=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[d,f,m]=arguments;return l.apply(this,[d||null]).then(y=>{if(a.version<53&&!f)try{y.forEach(_=>{_.type=s[_.type]||_.type})}catch(_){if(_.name!=="TypeError")throw _;y.forEach((w,x)=>{y.set(x,Object.assign({},w,{type:s[w.type]||w.type}))})}return y}).then(f,m)}}function eW(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpSender.prototype)return;const a=r.RTCPeerConnection.prototype.getSenders;a&&(r.RTCPeerConnection.prototype.getSenders=function(){const l=a.apply(this,[]);return l.forEach(d=>d._pc=this),l});const s=r.RTCPeerConnection.prototype.addTrack;s&&(r.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),r.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Ge.resolve(new Map)}}function tW(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpReceiver.prototype)return;const a=r.RTCPeerConnection.prototype.getReceivers;a&&(r.RTCPeerConnection.prototype.getReceivers=function(){const s=a.apply(this,[]);return s.forEach(l=>l._pc=this),s}),Qf(r,"track",s=>(s.receiver._pc=s.srcElement,s)),r.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function nW(r){r.RTCPeerConnection&&!("removeStream"in r.RTCPeerConnection.prototype)&&(r.RTCPeerConnection.prototype.removeStream=function(a){lk("removeStream","removeTrack"),this.getSenders().forEach(s=>{var l;s.track&&Ve(l=a.getTracks()).call(l,s.track)&&this.removeTrack(s)})})}function rW(r){r.DataChannel&&!r.RTCDataChannel&&(r.RTCDataChannel=r.DataChannel)}function iW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.addTransceiver;a&&(r.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const l=s.length>0;l&&s.forEach(f=>{if("rid"in f&&!/^[a-z0-9]{0,16}$/i.test(f.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in f&&!(parseFloat(f.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in f&&!(parseFloat(f.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const d=a.apply(this,arguments);if(l){const{sender:f}=d,m=f.getParameters();(!("encodings"in m)||m.encodings.length===1&&Object.keys(m.encodings[0]).length===0)&&(m.encodings=s,f.sendEncodings=s,this.setParametersPromises.push(f.setParameters(m).then(()=>{delete f.sendEncodings}).catch(()=>{delete f.sendEncodings})))}return d})}function aW(r){if(typeof r!="object"||!r.RTCRtpSender)return;const a=r.RTCRtpSender.prototype.getParameters;a&&(r.RTCRtpSender.prototype.getParameters=function(){const s=a.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function sW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ge.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}function oW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.createAnswer;r.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ge.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}var cW=Object.freeze({__proto__:null,shimAddTransceiver:iW,shimCreateAnswer:oW,shimCreateOffer:sW,shimGetDisplayMedia:function(r,a){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(r.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){const l=new DOMException("getDisplayMedia without video constraints is undefined");return l.name="NotFoundError",l.code=8,Ge.reject(l)}return s.video===!0?s.video={mediaSource:a}:s.video.mediaSource=a,r.navigator.mediaDevices.getUserMedia(s)})},shimGetParameters:aW,shimGetUserMedia:Z8,shimOnTrack:Q8,shimPeerConnection:hk,shimRTCDataChannel:rW,shimReceiverGetStats:tW,shimRemoveStream:nW,shimSenderGetStats:eW});function lW(r){if(typeof r=="object"&&r.RTCPeerConnection){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){const a=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(s){var l;this._localStreams||(this._localStreams=[]),Ve(l=this._localStreams).call(l,s)||this._localStreams.push(s),s.getAudioTracks().forEach(d=>a.call(this,d,s)),s.getVideoTracks().forEach(d=>a.call(this,d,s))},r.RTCPeerConnection.prototype.addTrack=function(s){for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];return d&&d.forEach(m=>{var y;this._localStreams?Ve(y=this._localStreams).call(y,m)||this._localStreams.push(m):this._localStreams=[m]}),a.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(a);if(s===-1)return;this._localStreams.splice(s,1);const l=a.getTracks();this.getSenders().forEach(d=>{Ve(l).call(l,d.track)&&this.removeTrack(d)})})}}function uW(r){if(typeof r=="object"&&r.RTCPeerConnection&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(s){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=s),this.addEventListener("track",this._onaddstreampoly=l=>{l.streams.forEach(d=>{var f;if(this._remoteStreams||(this._remoteStreams=[]),Ve(f=this._remoteStreams).call(f,d))return;this._remoteStreams.push(d);const m=new Event("addstream");m.stream=d,this.dispatchEvent(m)})})}});const a=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(d=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(d)>=0)return;s._remoteStreams.push(d);const f=new Event("addstream");f.stream=d,s.dispatchEvent(f)})}),a.apply(s,arguments)}}}function dW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype,s=a.createOffer,l=a.createAnswer,d=a.setLocalDescription,f=a.setRemoteDescription,m=a.addIceCandidate;a.createOffer=function(_,w){const x=arguments.length>=2?arguments[2]:arguments[0],A=s.apply(this,[x]);return w?(A.then(_,w),Ge.resolve()):A},a.createAnswer=function(_,w){const x=arguments.length>=2?arguments[2]:arguments[0],A=l.apply(this,[x]);return w?(A.then(_,w),Ge.resolve()):A};let y=function(_,w,x){const A=d.apply(this,[_]);return x?(A.then(w,x),Ge.resolve()):A};a.setLocalDescription=y,y=function(_,w,x){const A=f.apply(this,[_]);return x?(A.then(w,x),Ge.resolve()):A},a.setRemoteDescription=y,y=function(_,w,x){const A=m.apply(this,[_]);return x?(A.then(w,x),Ge.resolve()):A},a.addIceCandidate=y}function hW(r){const a=r&&r.navigator;if(a.mediaDevices&&a.mediaDevices.getUserMedia){const s=a.mediaDevices,l=s.getUserMedia.bind(s);a.mediaDevices.getUserMedia=d=>l(fW(d))}!a.getUserMedia&&a.mediaDevices&&a.mediaDevices.getUserMedia&&(a.getUserMedia=(function(s,l,d){a.mediaDevices.getUserMedia(s).then(l,d)}).bind(a))}function fW(r){return r&&r.video!==void 0?Object.assign({},r,{video:F8(r.video)}):r}function pW(r){if(!r.RTCPeerConnection)return;const a=r.RTCPeerConnection;r.RTCPeerConnection=function(s,l){if(s&&s.iceServers){const d=[];for(let f=0;f<s.iceServers.length;f++){let m=s.iceServers[f];!m.hasOwnProperty("urls")&&m.hasOwnProperty("url")?(lk("RTCIceServer.url","RTCIceServer.urls"),m=JSON.parse(JSON.stringify(m)),m.urls=m.url,delete m.url,d.push(m)):d.push(s.iceServers[f])}s.iceServers=d}return new a(s,l)},r.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in a&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:()=>a.generateCertificate})}function mW(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function gW(r){const a=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(s){if(s){s.offerToReceiveAudio!==void 0&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const l=this.getTransceivers().find(f=>f.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveAudio!==!0||l||this.addTransceiver("audio",{direction:"recvonly"}),s.offerToReceiveVideo!==void 0&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const d=this.getTransceivers().find(f=>f.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&d?d.direction==="sendrecv"?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":d.direction==="recvonly"&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):s.offerToReceiveVideo!==!0||d||this.addTransceiver("video",{direction:"recvonly"})}return a.apply(this,arguments)}}function vW(r){typeof r!="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}var yW=Object.freeze({__proto__:null,shimAudioContext:vW,shimCallbacksAPI:dW,shimConstraints:fW,shimCreateOfferLegacy:gW,shimGetUserMedia:hW,shimLocalStreamsAPI:lW,shimRTCIceServerUrls:pW,shimRemoteStreamsAPI:uW,shimTrackEventTransceiver:mW}),_W=`	
\v\f\r                　\u2028\u2029\uFEFF`,zCe=Mt,KCe=Ks,fk=_W,bW=E("".replace),qCe=RegExp("^["+fk+"]+"),YCe=RegExp("(^|[^"+fk+"])["+fk+"]+$"),XCe=function(r){return function(a){var s=KCe(zCe(a));return 1&r&&(s=bW(s,qCe,"")),2&r&&(s=bW(s,YCe,"$1")),s}},JCe={trim:XCe(3)},ZCe=r$.PROPER,QCe=u,EW=_W,eRe=JCe.trim;Tn({target:"String",proto:!0,forced:function(r){return QCe(function(){return!!EW[r]()||"​᠎"[r]()!=="​᠎"||ZCe&&EW[r].name!==r})}("trim")},{trim:function(){return eRe(this)}});var tRe=ac("String","trim"),nRe=T,rRe=tRe,pk=String.prototype,iRe=function(r){var a=r.trim;return typeof r=="string"||r===pk||nRe(pk,r)&&a===pk.trim?rRe:a},Ea=o(iRe),wW={exports:{}};(function(r){const a={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};a.localCName=a.generateIdentifier(),a.splitLines=function(s){return s.trim().split(`
`).map(l=>l.trim())},a.splitSections=function(s){return s.split(`
m=`).map((l,d)=>(d>0?"m="+l:l).trim()+`\r
`)},a.getDescription=function(s){const l=a.splitSections(s);return l&&l[0]},a.getMediaSections=function(s){const l=a.splitSections(s);return l.shift(),l},a.matchPrefix=function(s,l){return a.splitLines(s).filter(d=>d.indexOf(l)===0)},a.parseCandidate=function(s){let l;l=s.indexOf("a=candidate:")===0?s.substring(12).split(" "):s.substring(10).split(" ");const d={foundation:l[0],component:{1:"rtp",2:"rtcp"}[l[1]]||l[1],protocol:l[2].toLowerCase(),priority:parseInt(l[3],10),ip:l[4],address:l[4],port:parseInt(l[5],10),type:l[7]};for(let f=8;f<l.length;f+=2)switch(l[f]){case"raddr":d.relatedAddress=l[f+1];break;case"rport":d.relatedPort=parseInt(l[f+1],10);break;case"tcptype":d.tcpType=l[f+1];break;case"ufrag":d.ufrag=l[f+1],d.usernameFragment=l[f+1];break;default:d[l[f]]===void 0&&(d[l[f]]=l[f+1])}return d},a.writeCandidate=function(s){const l=[];l.push(s.foundation);const d=s.component;d==="rtp"?l.push(1):d==="rtcp"?l.push(2):l.push(d),l.push(s.protocol.toUpperCase()),l.push(s.priority),l.push(s.address||s.ip),l.push(s.port);const f=s.type;return l.push("typ"),l.push(f),f!=="host"&&s.relatedAddress&&s.relatedPort&&(l.push("raddr"),l.push(s.relatedAddress),l.push("rport"),l.push(s.relatedPort)),s.tcpType&&s.protocol.toLowerCase()==="tcp"&&(l.push("tcptype"),l.push(s.tcpType)),(s.usernameFragment||s.ufrag)&&(l.push("ufrag"),l.push(s.usernameFragment||s.ufrag)),"candidate:"+l.join(" ")},a.parseIceOptions=function(s){return s.substring(14).split(" ")},a.parseRtpMap=function(s){let l=s.substring(9).split(" ");const d={payloadType:parseInt(l.shift(),10)};return l=l[0].split("/"),d.name=l[0],d.clockRate=parseInt(l[1],10),d.channels=l.length===3?parseInt(l[2],10):1,d.numChannels=d.channels,d},a.writeRtpMap=function(s){let l=s.payloadType;s.preferredPayloadType!==void 0&&(l=s.preferredPayloadType);const d=s.channels||s.numChannels||1;return"a=rtpmap:"+l+" "+s.name+"/"+s.clockRate+(d!==1?"/"+d:"")+`\r
`},a.parseExtmap=function(s){const l=s.substring(9).split(" ");return{id:parseInt(l[0],10),direction:l[0].indexOf("/")>0?l[0].split("/")[1]:"sendrecv",uri:l[1],attributes:l.slice(2).join(" ")}},a.writeExtmap=function(s){return"a=extmap:"+(s.id||s.preferredId)+(s.direction&&s.direction!=="sendrecv"?"/"+s.direction:"")+" "+s.uri+(s.attributes?" "+s.attributes:"")+`\r
`},a.parseFmtp=function(s){const l={};let d;const f=s.substring(s.indexOf(" ")+1).split(";");for(let m=0;m<f.length;m++)d=f[m].trim().split("="),l[d[0].trim()]=d[1];return l},a.writeFmtp=function(s){let l="",d=s.payloadType;if(s.preferredPayloadType!==void 0&&(d=s.preferredPayloadType),s.parameters&&Object.keys(s.parameters).length){const f=[];Object.keys(s.parameters).forEach(m=>{s.parameters[m]!==void 0?f.push(m+"="+s.parameters[m]):f.push(m)}),l+="a=fmtp:"+d+" "+f.join(";")+`\r
`}return l},a.parseRtcpFb=function(s){const l=s.substring(s.indexOf(" ")+1).split(" ");return{type:l.shift(),parameter:l.join(" ")}},a.writeRtcpFb=function(s){let l="",d=s.payloadType;return s.preferredPayloadType!==void 0&&(d=s.preferredPayloadType),s.rtcpFeedback&&s.rtcpFeedback.length&&s.rtcpFeedback.forEach(f=>{l+="a=rtcp-fb:"+d+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`}),l},a.parseSsrcMedia=function(s){const l=s.indexOf(" "),d={ssrc:parseInt(s.substring(7,l),10)},f=s.indexOf(":",l);return f>-1?(d.attribute=s.substring(l+1,f),d.value=s.substring(f+1)):d.attribute=s.substring(l+1),d},a.parseSsrcGroup=function(s){const l=s.substring(13).split(" ");return{semantics:l.shift(),ssrcs:l.map(d=>parseInt(d,10))}},a.getMid=function(s){const l=a.matchPrefix(s,"a=mid:")[0];if(l)return l.substring(6)},a.parseFingerprint=function(s){const l=s.substring(14).split(" ");return{algorithm:l[0].toLowerCase(),value:l[1].toUpperCase()}},a.getDtlsParameters=function(s,l){return{role:"auto",fingerprints:a.matchPrefix(s+l,"a=fingerprint:").map(a.parseFingerprint)}},a.writeDtlsParameters=function(s,l){let d="a=setup:"+l+`\r
`;return s.fingerprints.forEach(f=>{d+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`}),d},a.parseCryptoLine=function(s){const l=s.substring(9).split(" ");return{tag:parseInt(l[0],10),cryptoSuite:l[1],keyParams:l[2],sessionParams:l.slice(3)}},a.writeCryptoLine=function(s){return"a=crypto:"+s.tag+" "+s.cryptoSuite+" "+(typeof s.keyParams=="object"?a.writeCryptoKeyParams(s.keyParams):s.keyParams)+(s.sessionParams?" "+s.sessionParams.join(" "):"")+`\r
`},a.parseCryptoKeyParams=function(s){if(s.indexOf("inline:")!==0)return null;const l=s.substring(7).split("|");return{keyMethod:"inline",keySalt:l[0],lifeTime:l[1],mkiValue:l[2]?l[2].split(":")[0]:void 0,mkiLength:l[2]?l[2].split(":")[1]:void 0}},a.writeCryptoKeyParams=function(s){return s.keyMethod+":"+s.keySalt+(s.lifeTime?"|"+s.lifeTime:"")+(s.mkiValue&&s.mkiLength?"|"+s.mkiValue+":"+s.mkiLength:"")},a.getCryptoParameters=function(s,l){return a.matchPrefix(s+l,"a=crypto:").map(a.parseCryptoLine)},a.getIceParameters=function(s,l){const d=a.matchPrefix(s+l,"a=ice-ufrag:")[0],f=a.matchPrefix(s+l,"a=ice-pwd:")[0];return d&&f?{usernameFragment:d.substring(12),password:f.substring(10)}:null},a.writeIceParameters=function(s){let l="a=ice-ufrag:"+s.usernameFragment+`\r
a=ice-pwd:`+s.password+`\r
`;return s.iceLite&&(l+=`a=ice-lite\r
`),l},a.parseRtpParameters=function(s){const l={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},d=a.splitLines(s)[0].split(" ");l.profile=d[2];for(let m=3;m<d.length;m++){const y=d[m],_=a.matchPrefix(s,"a=rtpmap:"+y+" ")[0];if(_){const w=a.parseRtpMap(_),x=a.matchPrefix(s,"a=fmtp:"+y+" ");switch(w.parameters=x.length?a.parseFmtp(x[0]):{},w.rtcpFeedback=a.matchPrefix(s,"a=rtcp-fb:"+y+" ").map(a.parseRtcpFb),l.codecs.push(w),w.name.toUpperCase()){case"RED":case"ULPFEC":l.fecMechanisms.push(w.name.toUpperCase())}}}a.matchPrefix(s,"a=extmap:").forEach(m=>{l.headerExtensions.push(a.parseExtmap(m))});const f=a.matchPrefix(s,"a=rtcp-fb:* ").map(a.parseRtcpFb);return l.codecs.forEach(m=>{f.forEach(y=>{m.rtcpFeedback.find(_=>_.type===y.type&&_.parameter===y.parameter)||m.rtcpFeedback.push(y)})}),l},a.writeRtpDescription=function(s,l){let d="";d+="m="+s+" ",d+=l.codecs.length>0?"9":"0",d+=" "+(l.profile||"UDP/TLS/RTP/SAVPF")+" ",d+=l.codecs.map(m=>m.preferredPayloadType!==void 0?m.preferredPayloadType:m.payloadType).join(" ")+`\r
`,d+=`c=IN IP4 0.0.0.0\r
`,d+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,l.codecs.forEach(m=>{d+=a.writeRtpMap(m),d+=a.writeFmtp(m),d+=a.writeRtcpFb(m)});let f=0;return l.codecs.forEach(m=>{m.maxptime>f&&(f=m.maxptime)}),f>0&&(d+="a=maxptime:"+f+`\r
`),l.headerExtensions&&l.headerExtensions.forEach(m=>{d+=a.writeExtmap(m)}),d},a.parseRtpEncodingParameters=function(s){const l=[],d=a.parseRtpParameters(s),f=d.fecMechanisms.indexOf("RED")!==-1,m=d.fecMechanisms.indexOf("ULPFEC")!==-1,y=a.matchPrefix(s,"a=ssrc:").map(I=>a.parseSsrcMedia(I)).filter(I=>I.attribute==="cname"),_=y.length>0&&y[0].ssrc;let w;const x=a.matchPrefix(s,"a=ssrc-group:FID").map(I=>I.substring(17).split(" ").map(L=>parseInt(L,10)));x.length>0&&x[0].length>1&&x[0][0]===_&&(w=x[0][1]),d.codecs.forEach(I=>{if(I.name.toUpperCase()==="RTX"&&I.parameters.apt){let L={ssrc:_,codecPayloadType:parseInt(I.parameters.apt,10)};_&&w&&(L.rtx={ssrc:w}),l.push(L),f&&(L=JSON.parse(JSON.stringify(L)),L.fec={ssrc:_,mechanism:m?"red+ulpfec":"red"},l.push(L))}}),l.length===0&&_&&l.push({ssrc:_});let A=a.matchPrefix(s,"b=");return A.length&&(A=A[0].indexOf("b=TIAS:")===0?parseInt(A[0].substring(7),10):A[0].indexOf("b=AS:")===0?1e3*parseInt(A[0].substring(5),10)*.95-16e3:void 0,l.forEach(I=>{I.maxBitrate=A})),l},a.parseRtcpParameters=function(s){const l={},d=a.matchPrefix(s,"a=ssrc:").map(y=>a.parseSsrcMedia(y)).filter(y=>y.attribute==="cname")[0];d&&(l.cname=d.value,l.ssrc=d.ssrc);const f=a.matchPrefix(s,"a=rtcp-rsize");l.reducedSize=f.length>0,l.compound=f.length===0;const m=a.matchPrefix(s,"a=rtcp-mux");return l.mux=m.length>0,l},a.writeRtcpParameters=function(s){let l="";return s.reducedSize&&(l+=`a=rtcp-rsize\r
`),s.mux&&(l+=`a=rtcp-mux\r
`),s.ssrc!==void 0&&s.cname&&(l+="a=ssrc:"+s.ssrc+" cname:"+s.cname+`\r
`),l},a.parseMsid=function(s){let l;const d=a.matchPrefix(s,"a=msid:");if(d.length===1)return l=d[0].substring(7).split(" "),{stream:l[0],track:l[1]};const f=a.matchPrefix(s,"a=ssrc:").map(m=>a.parseSsrcMedia(m)).filter(m=>m.attribute==="msid");return f.length>0?(l=f[0].value.split(" "),{stream:l[0],track:l[1]}):void 0},a.parseSctpDescription=function(s){const l=a.parseMLine(s),d=a.matchPrefix(s,"a=max-message-size:");let f;d.length>0&&(f=parseInt(d[0].substring(19),10)),isNaN(f)&&(f=65536);const m=a.matchPrefix(s,"a=sctp-port:");if(m.length>0)return{port:parseInt(m[0].substring(12),10),protocol:l.fmt,maxMessageSize:f};const y=a.matchPrefix(s,"a=sctpmap:");if(y.length>0){const _=y[0].substring(10).split(" ");return{port:parseInt(_[0],10),protocol:_[1],maxMessageSize:f}}},a.writeSctpDescription=function(s,l){let d=[];return d=s.protocol!=="DTLS/SCTP"?["m="+s.kind+" 9 "+s.protocol+" "+l.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+l.port+`\r
`]:["m="+s.kind+" 9 "+s.protocol+" "+l.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+l.port+" "+l.protocol+` 65535\r
`],l.maxMessageSize!==void 0&&d.push("a=max-message-size:"+l.maxMessageSize+`\r
`),d.join("")},a.generateSessionId=function(){return Math.random().toString().substr(2,22)},a.writeSessionBoilerplate=function(s,l,d){let f;const m=l!==void 0?l:2;return f=s||a.generateSessionId(),`v=0\r
o=`+(d||"thisisadapterortc")+" "+f+" "+m+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},a.getDirection=function(s,l){const d=a.splitLines(s);for(let f=0;f<d.length;f++)switch(d[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return d[f].substring(2)}return l?a.getDirection(l):"sendrecv"},a.getKind=function(s){return a.splitLines(s)[0].split(" ")[0].substring(2)},a.isRejected=function(s){return s.split(" ",2)[1]==="0"},a.parseMLine=function(s){const l=a.splitLines(s)[0].substring(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},a.parseOLine=function(s){const l=a.matchPrefix(s,"o=")[0].substring(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},a.isValidSDP=function(s){if(typeof s!="string"||s.length===0)return!1;const l=a.splitLines(s);for(let d=0;d<l.length;d++)if(l[d].length<2||l[d].charAt(1)!=="=")return!1;return!0},r.exports=a})(wW);var SW=wW.exports,cg=o(SW),aRe=n({__proto__:null,default:cg},[SW]);function nx(r){if(!r.RTCIceCandidate||r.RTCIceCandidate&&"foundation"in r.RTCIceCandidate.prototype)return;const a=r.RTCIceCandidate;r.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&((s=JSON.parse(JSON.stringify(s))).candidate=s.candidate.substr(2)),s.candidate&&s.candidate.length){const l=new a(s),d=cg.parseCandidate(s.candidate),f=Object.assign(l,d);return f.toJSON=function(){return{candidate:f.candidate,sdpMid:f.sdpMid,sdpMLineIndex:f.sdpMLineIndex,usernameFragment:f.usernameFragment}},f}return new a(s)},r.RTCIceCandidate.prototype=a.prototype,Qf(r,"icecandidate",s=>(s.candidate&&Object.defineProperty(s,"candidate",{value:new r.RTCIceCandidate(s.candidate),writable:"false"}),s))}function mk(r){!r.RTCIceCandidate||r.RTCIceCandidate&&"relayProtocol"in r.RTCIceCandidate.prototype||Qf(r,"icecandidate",a=>{if(a.candidate){const s=cg.parseCandidate(a.candidate.candidate);s.type==="relay"&&(a.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[s.priority>>24])}return a})}function rx(r,a){if(!r.RTCPeerConnection)return;"sctp"in r.RTCPeerConnection.prototype||Object.defineProperty(r.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const s=function(y){if(!y||!y.sdp)return!1;const _=cg.splitSections(y.sdp);return _.shift(),_.some(w=>{const x=cg.parseMLine(w);return x&&x.kind==="application"&&x.protocol.indexOf("SCTP")!==-1})},l=function(y){const _=y.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const w=parseInt(_[1],10);return w!=w?-1:w},d=function(y){let _=65536;return a.browser==="firefox"&&(_=a.version<57?y===-1?16384:2147483637:a.version<60?a.version===57?65535:65536:2147483637),_},f=function(y,_){let w=65536;a.browser==="firefox"&&a.version===57&&(w=65535);const x=cg.matchPrefix(y.sdp,"a=max-message-size:");return x.length>0?w=parseInt(x[0].substr(19),10):a.browser==="firefox"&&_!==-1&&(w=2147483637),w},m=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,a.browser==="chrome"&&a.version>=76){const{sdpSemantics:y}=this.getConfiguration();y==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(s(arguments[0])){const y=l(arguments[0]),_=d(y),w=f(arguments[0],y);let x;x=_===0&&w===0?Number.POSITIVE_INFINITY:_===0||w===0?Math.max(_,w):Math.min(_,w);const A={};Object.defineProperty(A,"maxMessageSize",{get:()=>x}),this._sctp=A}return m.apply(this,arguments)}}function ix(r){if(!r.RTCPeerConnection||!("createDataChannel"in r.RTCPeerConnection.prototype))return;function a(l,d){const f=l.send;l.send=function(){const m=arguments[0],y=m.length||m.size||m.byteLength;if(l.readyState==="open"&&d.sctp&&y>d.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+d.sctp.maxMessageSize+" bytes)");return f.apply(l,arguments)}}const s=r.RTCPeerConnection.prototype.createDataChannel;r.RTCPeerConnection.prototype.createDataChannel=function(){const l=s.apply(this,arguments);return a(l,this),l},Qf(r,"datachannel",l=>(a(l.channel,l.target),l))}function gk(r){if(!r.RTCPeerConnection||"connectionState"in r.RTCPeerConnection.prototype)return;const a=r.RTCPeerConnection.prototype;Object.defineProperty(a,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(a,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(s){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),s&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=s)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(s=>{const l=a[s];a[s]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=d=>{const f=d.target;if(f._lastConnectionState!==f.connectionState){f._lastConnectionState=f.connectionState;const m=new Event("connectionstatechange",d);f.dispatchEvent(m)}return d},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),l.apply(this,arguments)}})}function vk(r,a){if(!r.RTCPeerConnection||a.browser==="chrome"&&a.version>=71||a.browser==="safari"&&a.version>=605)return;const s=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(l){if(l&&l.sdp&&l.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const d=l.sdp.split(`
`).filter(f=>Ea(f).call(f)!=="a=extmap-allow-mixed").join(`
`);r.RTCSessionDescription&&l instanceof r.RTCSessionDescription?arguments[0]=new r.RTCSessionDescription({type:l.type,sdp:d}):l.sdp=d}return s.apply(this,arguments)}}function ax(r,a){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const s=r.RTCPeerConnection.prototype.addIceCandidate;s&&s.length!==0&&(r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(a.browser==="chrome"&&a.version<78||a.browser==="firefox"&&a.version<68||a.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Ge.resolve():s.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Ge.resolve())})}function sx(r,a){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const s=r.RTCPeerConnection.prototype.setLocalDescription;s&&s.length!==0&&(r.RTCPeerConnection.prototype.setLocalDescription=function(){let l=arguments[0]||{};if(typeof l!="object"||l.type&&l.sdp)return s.apply(this,arguments);if(l={type:l.type,sdp:l.sdp},!l.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":l.type="offer";break;default:l.type="answer"}return l.sdp||l.type!=="offer"&&l.type!=="answer"?s.apply(this,[l]):(l.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(d=>s.apply(this,[d]))})}var sRe=Object.freeze({__proto__:null,removeExtmapAllowMixed:vk,shimAddIceCandidateNullOrEmpty:ax,shimConnectionState:gk,shimMaxMessageSize:rx,shimParameterlessSetLocalDescription:sx,shimRTCIceCandidate:nx,shimRTCIceCandidateRelayProtocol:mk,shimSendThrowTypeError:ix});(function(){let{window:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const s=M8,l=function(f){const m={browser:null,version:null};if(f===void 0||!f.navigator)return m.browser="Not a browser.",m;const{navigator:y}=f;if(y.mozGetUserMedia)m.browser="firefox",m.version=tx(y.userAgent,/Firefox\/(\d+)\./,1);else if(y.webkitGetUserMedia||f.isSecureContext===!1&&f.webkitRTCPeerConnection)m.browser="chrome",m.version=tx(y.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!f.RTCPeerConnection||!y.userAgent.match(/AppleWebKit\/(\d+)\./))return m.browser="Not a supported browser.",m;m.browser="safari",m.version=tx(y.userAgent,/AppleWebKit\/(\d+)\./,1),m.supportsUnifiedPlan=f.RTCRtpTransceiver&&"currentDirection"in f.RTCRtpTransceiver.prototype}return m}(r),d={browserDetails:l,commonShim:sRe,extractVersion:tx,disableLog:GCe,disableWarnings:HCe,sdp:aRe};switch(l.browser){case"chrome":if(!J8||!dk||!a.shimChrome)return s("Chrome shim is not included in this adapter release."),d;if(l.version===null)return s("Chrome shim can not determine version, not shimming."),d;s("adapter.js shimming chrome."),d.browserShim=J8,ax(r,l),sx(r),$8(r,l),W8(r),dk(r,l),G8(r),Y8(r,l),H8(r),z8(r),K8(r),X8(r,l),nx(r),mk(r),gk(r),rx(r,l),ix(r),vk(r,l);break;case"firefox":if(!cW||!hk||!a.shimFirefox)return s("Firefox shim is not included in this adapter release."),d;s("adapter.js shimming firefox."),d.browserShim=cW,ax(r,l),sx(r),Z8(r,l),hk(r,l),Q8(r),nW(r),eW(r),tW(r),rW(r),iW(r),aW(r),sW(r),oW(r),nx(r),gk(r),rx(r,l),ix(r);break;case"safari":if(!yW||!a.shimSafari)return s("Safari shim is not included in this adapter release."),d;s("adapter.js shimming safari."),d.browserShim=yW,ax(r,l),sx(r),pW(r),gW(r),dW(r),lW(r),uW(r),mW(r),hW(r),vW(r),nx(r),mk(r),rx(r,l),ix(r),vk(r,l);break;default:s("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var yk=R;Tn({global:!0,forced:yk.globalThis!==yk},{globalThis:yk});var xW=o(R),_k={exports:{}};(function(r,a){(function(s,l){var d="function",f="undefined",m="object",y="string",_="major",w="model",x="name",A="type",I="vendor",L="version",H="architecture",$="console",G="mobile",ne="tablet",te="smarttv",ce="wearable",pe="embedded",fe="Amazon",ue="Apple",ye="ASUS",xe="BlackBerry",Ae="Browser",Le="Chrome",Ht="Firefox",qt="Google",Rt="Huawei",bn="LG",yn="Microsoft",Yi="Motorola",Re="Opera",Fe="Samsung",Xe="Sharp",Oe="Sony",B="Xiaomi",le="Zebra",he="Facebook",Ue="Chromium OS",Vt="Mac OS",Vn=" Browser",Jr=function(zr){for(var Zr={},Hn=0;Hn<zr.length;Hn++)Zr[zr[Hn].toUpperCase()]=zr[Hn];return Zr},Do=function(zr,Zr){return typeof zr===y&&Cc(Zr).indexOf(Cc(zr))!==-1},Cc=function(zr){return zr.toLowerCase()},Xb=function(zr,Zr){if(typeof zr===y)return zr=zr.replace(/^\s\s*/,""),typeof Zr===f?zr:zr.substring(0,500)},Rp=function(zr,Zr){for(var Hn,ds,pl,Ir,md,cn,ml=0;ml<Zr.length&&!md;){var Np=Zr[ml],mu=Zr[ml+1];for(Hn=ds=0;Hn<Np.length&&!md&&Np[Hn];)if(md=Np[Hn++].exec(zr))for(pl=0;pl<mu.length;pl++)cn=md[++ds],typeof(Ir=mu[pl])===m&&Ir.length>0?Ir.length===2?typeof Ir[1]==d?this[Ir[0]]=Ir[1].call(this,cn):this[Ir[0]]=Ir[1]:Ir.length===3?typeof Ir[1]!==d||Ir[1].exec&&Ir[1].test?this[Ir[0]]=cn?cn.replace(Ir[1],Ir[2]):l:this[Ir[0]]=cn?Ir[1].call(this,cn,Ir[2]):l:Ir.length===4&&(this[Ir[0]]=cn?Ir[3].call(this,cn.replace(Ir[1],Ir[2])):l):this[Ir]=cn||l;ml+=2}},tv=function(zr,Zr){for(var Hn in Zr)if(typeof Zr[Hn]===m&&Zr[Hn].length>0){for(var ds=0;ds<Zr[Hn].length;ds++)if(Do(Zr[Hn][ds],zr))return Hn==="?"?l:Hn}else if(Do(Zr[Hn],zr))return Hn==="?"?l:Hn;return Zr.hasOwnProperty("*")?Zr["*"]:zr},sC={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},oC={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[L,[x,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[L,[x,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[x,L],[/opios[\/ ]+([\w\.]+)/i],[L,[x,Re+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[L,[x,Re+" GX"]],[/\bopr\/([\w\.]+)/i],[L,[x,Re]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[L,[x,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[L,[x,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[x,L],[/quark(?:pc)?\/([-\w\.]+)/i],[L,[x,"Quark"]],[/\bddg\/([\w\.]+)/i],[L,[x,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[L,[x,"UC"+Ae]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[L,[x,"WeChat"]],[/konqueror\/([\w\.]+)/i],[L,[x,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[L,[x,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[L,[x,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[L,[x,"Smart Lenovo "+Ae]],[/(avast|avg)\/([\w\.]+)/i],[[x,/(.+)/,"$1 Secure "+Ae],L],[/\bfocus\/([\w\.]+)/i],[L,[x,Ht+" Focus"]],[/\bopt\/([\w\.]+)/i],[L,[x,Re+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[L,[x,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[L,[x,"Dolphin"]],[/coast\/([\w\.]+)/i],[L,[x,Re+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[L,[x,"MIUI"+Vn]],[/fxios\/([\w\.-]+)/i],[L,[x,Ht]],[/\bqihoobrowser\/?([\w\.]*)/i],[L,[x,"360"]],[/\b(qq)\/([\w\.]+)/i],[[x,/(.+)/,"$1Browser"],L],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[x,/(.+)/,"$1"+Vn],L],[/samsungbrowser\/([\w\.]+)/i],[L,[x,Fe+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[L,[x,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[x,"Sogou Mobile"],L],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[x,L],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[x],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[L,x],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[x,he],L],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[x,L],[/\bgsa\/([\w\.]+) .*safari\//i],[L,[x,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[L,[x,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[L,[x,Le+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[x,Le+" WebView"],L],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[L,[x,"Android "+Ae]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[x,L],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[L,[x,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[L,x],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[x,[L,tv,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[x,L],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[x,"Netscape"],L],[/(wolvic|librewolf)\/([\w\.]+)/i],[x,L],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[L,[x,Ht+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[x,[L,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[x,[L,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[H,"amd64"]],[/(ia32(?=;))/i],[[H,Cc]],[/((?:i[346]|x)86)[;\)]/i],[[H,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[H,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[H,"armhf"]],[/windows (ce|mobile); ppc;/i],[[H,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[H,/ower/,"",Cc]],[/(sun4\w)[;\)]/i],[[H,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[H,Cc]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[w,[I,Fe],[A,ne]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[w,[I,Fe],[A,G]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[w,[I,ue],[A,G]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[w,[I,ue],[A,ne]],[/(macintosh);/i],[w,[I,ue]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[w,[I,Xe],[A,G]],[/(?:honor)([-\w ]+)[;\)]/i],[w,[I,"Honor"],[A,G]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[w,[I,Rt],[A,ne]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[w,[I,Rt],[A,G]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[w,/_/g," "],[I,B],[A,G]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[w,/_/g," "],[I,B],[A,ne]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[w,[I,"OPPO"],[A,G]],[/\b(opd2\d{3}a?) bui/i],[w,[I,"OPPO"],[A,ne]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[w,[I,"Vivo"],[A,G]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[w,[I,"Realme"],[A,G]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[w,[I,Yi],[A,G]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[w,[I,Yi],[A,ne]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[w,[I,bn],[A,ne]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[w,[I,bn],[A,G]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[w,[I,"Lenovo"],[A,ne]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[w,/_/g," "],[I,"Nokia"],[A,G]],[/(pixel c)\b/i],[w,[I,qt],[A,ne]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[w,[I,qt],[A,G]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[w,[I,Oe],[A,G]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[w,"Xperia Tablet"],[I,Oe],[A,ne]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[w,[I,"OnePlus"],[A,G]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[w,[I,fe],[A,ne]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[w,/(.+)/g,"Fire Phone $1"],[I,fe],[A,G]],[/(playbook);[-\w\),; ]+(rim)/i],[w,I,[A,ne]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[w,[I,xe],[A,G]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[w,[I,ye],[A,ne]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[w,[I,ye],[A,G]],[/(nexus 9)/i],[w,[I,"HTC"],[A,ne]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[I,[w,/_/g," "],[A,G]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[w,[I,"TCL"],[A,ne]],[/(itel) ((\w+))/i],[[I,Cc],w,[A,tv,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[w,[I,"Acer"],[A,ne]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[w,[I,"Meizu"],[A,G]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[w,[I,"Ulefone"],[A,G]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[w,[I,"Energizer"],[A,G]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[w,[I,"Cat"],[A,G]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[w,[I,"Smartfren"],[A,G]],[/droid.+; (a(?:015|06[35]|142p?))/i],[w,[I,"Nothing"],[A,G]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,w,[A,G]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,w,[A,ne]],[/(surface duo)/i],[w,[I,yn],[A,ne]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[w,[I,"Fairphone"],[A,G]],[/(u304aa)/i],[w,[I,"AT&T"],[A,G]],[/\bsie-(\w*)/i],[w,[I,"Siemens"],[A,G]],[/\b(rct\w+) b/i],[w,[I,"RCA"],[A,ne]],[/\b(venue[\d ]{2,7}) b/i],[w,[I,"Dell"],[A,ne]],[/\b(q(?:mv|ta)\w+) b/i],[w,[I,"Verizon"],[A,ne]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[w,[I,"Barnes & Noble"],[A,ne]],[/\b(tm\d{3}\w+) b/i],[w,[I,"NuVision"],[A,ne]],[/\b(k88) b/i],[w,[I,"ZTE"],[A,ne]],[/\b(nx\d{3}j) b/i],[w,[I,"ZTE"],[A,G]],[/\b(gen\d{3}) b.+49h/i],[w,[I,"Swiss"],[A,G]],[/\b(zur\d{3}) b/i],[w,[I,"Swiss"],[A,ne]],[/\b((zeki)?tb.*\b) b/i],[w,[I,"Zeki"],[A,ne]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],w,[A,ne]],[/\b(ns-?\w{0,9}) b/i],[w,[I,"Insignia"],[A,ne]],[/\b((nxa|next)-?\w{0,9}) b/i],[w,[I,"NextBook"],[A,ne]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],w,[A,G]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],w,[A,G]],[/\b(ph-1) /i],[w,[I,"Essential"],[A,G]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[w,[I,"Envizen"],[A,ne]],[/\b(trio[-\w\. ]+) b/i],[w,[I,"MachSpeed"],[A,ne]],[/\btu_(1491) b/i],[w,[I,"Rotor"],[A,ne]],[/(shield[\w ]+) b/i],[w,[I,"Nvidia"],[A,ne]],[/(sprint) (\w+)/i],[I,w,[A,G]],[/(kin\.[onetw]{3})/i],[[w,/\./g," "],[I,yn],[A,G]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[w,[I,le],[A,ne]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[w,[I,le],[A,G]],[/smart-tv.+(samsung)/i],[I,[A,te]],[/hbbtv.+maple;(\d+)/i],[[w,/^/,"SmartTV"],[I,Fe],[A,te]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,bn],[A,te]],[/(apple) ?tv/i],[I,[w,ue+" TV"],[A,te]],[/crkey/i],[[w,Le+"cast"],[I,qt],[A,te]],[/droid.+aft(\w+)( bui|\))/i],[w,[I,fe],[A,te]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[w,[I,Xe],[A,te]],[/(bravia[\w ]+)( bui|\))/i],[w,[I,Oe],[A,te]],[/(mitv-\w{5}) bui/i],[w,[I,B],[A,te]],[/Hbbtv.*(technisat) (.*);/i],[I,w,[A,te]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[I,Xb],[w,Xb],[A,te]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[A,te]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,w,[A,$]],[/droid.+; (shield) bui/i],[w,[I,"Nvidia"],[A,$]],[/(playstation [345portablevi]+)/i],[w,[I,Oe],[A,$]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[w,[I,yn],[A,$]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[w,[I,Fe],[A,ce]],[/((pebble))app/i],[I,w,[A,ce]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[w,[I,ue],[A,ce]],[/droid.+; (glass) \d/i],[w,[I,qt],[A,ce]],[/droid.+; (wt63?0{2,3})\)/i],[w,[I,le],[A,ce]],[/droid.+; (glass) \d/i],[w,[I,qt],[A,ce]],[/(pico) (4|neo3(?: link|pro)?)/i],[I,w,[A,ce]],[/; (quest( \d| pro)?)/i],[w,[I,he],[A,ce]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[A,pe]],[/(aeobc)\b/i],[w,[I,fe],[A,pe]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[w,[A,G]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[w,[A,ne]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[A,ne]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[A,G]],[/(android[-\w\. ]{0,9});.+buil/i],[w,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[L,[x,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[x,L],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[L,[x,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[x,L],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[L,x]],os:[[/microsoft (windows) (vista|xp)/i],[x,L],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[x,[L,tv,sC]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[L,tv,sC],[x,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[L,/_/g,"."],[x,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[x,Vt],[L,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[L,x],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[x,L],[/\(bb(10);/i],[L,[x,xe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[L,[x,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[L,[x,Ht+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[L,[x,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[L,[x,"watchOS"]],[/crkey\/([\d\.]+)/i],[L,[x,Le+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[x,Ue],L],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[x,L],[/(sunos) ?([\w\.\d]*)/i],[[x,"Solaris"],L],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[x,L]]},Lo=function(zr,Zr){if(typeof zr===m&&(Zr=zr,zr=l),!(this instanceof Lo))return new Lo(zr,Zr).getResult();var Hn=typeof s!==f&&s.navigator?s.navigator:l,ds=zr||(Hn&&Hn.userAgent?Hn.userAgent:""),pl=Hn&&Hn.userAgentData?Hn.userAgentData:l,Ir=Zr?function(cn,ml){var Np={};for(var mu in cn)ml[mu]&&ml[mu].length%2==0?Np[mu]=ml[mu].concat(cn[mu]):Np[mu]=cn[mu];return Np}(oC,Zr):oC,md=Hn&&Hn.userAgent==ds;return this.getBrowser=function(){var cn={};return cn[x]=l,cn[L]=l,Rp.call(cn,ds,Ir.browser),cn[_]=function(ml){return typeof ml===y?ml.replace(/[^\d\.]/g,"").split(".")[0]:l}(cn[L]),md&&Hn&&Hn.brave&&typeof Hn.brave.isBrave==d&&(cn[x]="Brave"),cn},this.getCPU=function(){var cn={};return cn[H]=l,Rp.call(cn,ds,Ir.cpu),cn},this.getDevice=function(){var cn={};return cn[I]=l,cn[w]=l,cn[A]=l,Rp.call(cn,ds,Ir.device),md&&!cn[A]&&pl&&pl.mobile&&(cn[A]=G),md&&cn[w]=="Macintosh"&&Hn&&typeof Hn.standalone!==f&&Hn.maxTouchPoints&&Hn.maxTouchPoints>2&&(cn[w]="iPad",cn[A]=ne),cn},this.getEngine=function(){var cn={};return cn[x]=l,cn[L]=l,Rp.call(cn,ds,Ir.engine),cn},this.getOS=function(){var cn={};return cn[x]=l,cn[L]=l,Rp.call(cn,ds,Ir.os),md&&!cn[x]&&pl&&pl.platform&&pl.platform!="Unknown"&&(cn[x]=pl.platform.replace(/chrome os/i,Ue).replace(/macos/i,Vt)),cn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ds},this.setUA=function(cn){return ds=typeof cn===y&&cn.length>500?Xb(cn,500):cn,this},this.setUA(ds),this};Lo.VERSION="0.7.40",Lo.BROWSER=Jr([x,L,_]),Lo.CPU=Jr([H]),Lo.DEVICE=Jr([w,I,A,$,G,te,ne,ce,pe]),Lo.ENGINE=Lo.OS=Jr([x,L]),r.exports&&(a=r.exports=Lo),a.UAParser=Lo;var pd=typeof s!==f&&(s.jQuery||s.Zepto);if(pd&&!pd.ua){var cC=new Lo;pd.ua=cC.getResult(),pd.ua.get=function(){return cC.getUA()},pd.ua.set=function(zr){cC.setUA(zr);var Zr=cC.getResult();for(var Hn in Zr)pd.ua[Hn]=Zr[Hn]}}})(typeof window=="object"?window:i)})(_k,_k.exports);var oRe=o(_k.exports),TW=kS.clear;Tn({global:!0,bind:!0,forced:R.clearImmediate!==TW},{clearImmediate:TW});var CW=R,cRe=P,lRe=K,uRe=NO,dRe=vn,hRe=ah,fRe=Kf,pRe=CW.Function,mRe=/MSIE .\./.test(dRe)||uRe==="BUN"&&function(){var r=CW.Bun.version.split(".");return r.length<3||r[0]==="0"&&(r[1]<3||r[1]==="3"&&r[2]==="0")}(),gRe=Tn,RW=R,NW=kS.set,vRe=function(r,a){var s=1;return mRe?function(l,d){var f=fRe(arguments.length,1)>s,m=lRe(l)?l:pRe(l),y=f?hRe(arguments,s):[],_=f?function(){cRe(m,this,y)}:m;return r(_)}:r},AW=RW.setImmediate?vRe(NW):NW;gRe({global:!0,bind:!0,forced:RW.setImmediate!==AW},{setImmediate:AW});var IW=o(it.setImmediate),yRe=R,_Re=$$,bRe=Si,ERe=Kf,wRe=ee;Tn({global:!0,dontCallGetSet:!0,forced:u(function(){return wRe&&Object.getOwnPropertyDescriptor(yRe,"queueMicrotask").value.length!==1})},{queueMicrotask:function(r){ERe(arguments.length,1),_Re(bRe(r))}});var OW=o(it.queueMicrotask);function PW(r,a){return function(){return r.apply(a,arguments)}}const{toString:SRe}=Object.prototype,{getPrototypeOf:bk}=Object,{iterator:ox,toStringTag:kW}=Symbol,cx=(Ek=Object.create(null),r=>{const a=SRe.call(r);return Ek[a]||(Ek[a]=a.slice(8,-1).toLowerCase())});var Ek;const Qc=r=>(r=r.toLowerCase(),a=>cx(a)===r),lx=r=>a=>typeof a===r,{isArray:lg}=Array,K_=lx("undefined"),jW=Qc("ArrayBuffer"),xRe=lx("string"),qs=lx("function"),DW=lx("number"),ux=r=>r!==null&&typeof r=="object",dx=r=>{if(cx(r)!=="object")return!1;const a=bk(r);return!(a!==null&&a!==Object.prototype&&Object.getPrototypeOf(a)!==null||kW in r||ox in r)},TRe=Qc("Date"),CRe=Qc("File"),RRe=Qc("Blob"),NRe=Qc("FileList"),ARe=Qc("URLSearchParams"),[IRe,ORe,PRe,kRe]=["ReadableStream","Request","Response","Headers"].map(Qc);function q_(r,a){let s,l,{allOwnKeys:d=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r!=null)if(typeof r!="object"&&(r=[r]),lg(r))for(s=0,l=r.length;s<l;s++)a.call(null,r[s],s,r);else{const f=d?Object.getOwnPropertyNames(r):Object.keys(r),m=f.length;let y;for(s=0;s<m;s++)y=f[s],a.call(null,r[y],y,r)}}function LW(r,a){a=a.toLowerCase();const s=Object.keys(r);let l,d=s.length;for(;d-- >0;)if(l=s[d],a===l.toLowerCase())return l;return null}const ep=xW!==void 0?xW:typeof self<"u"?self:typeof window<"u"?window:Zh,MW=r=>!K_(r)&&r!==ep,jRe=(wk=typeof Uint8Array<"u"&&bk(Uint8Array),r=>wk&&r instanceof wk);var wk;const DRe=Qc("HTMLFormElement"),UW=(r=>{let{hasOwnProperty:a}=r;return(s,l)=>a.call(s,l)})(Object.prototype),LRe=Qc("RegExp"),FW=(r,a)=>{const s=Object.getOwnPropertyDescriptors(r),l={};q_(s,(d,f)=>{let m;(m=a(d,f,r))!==!1&&(l[f]=m||d)}),Object.defineProperties(r,l)},MRe=Qc("AsyncFunction"),VW=(BW=typeof IW=="function",$W=qs(ep.postMessage),BW?IW:$W?(Sk="axios@".concat(Math.random()),hx=[],ep.addEventListener("message",r=>{let{source:a,data:s}=r;a===ep&&s===Sk&&hx.length&&hx.shift()()},!1),r=>{hx.push(r),ep.postMessage(Sk,"*")}):r=>setTimeout(r));var BW,$W,Sk,hx;const URe=OW!==void 0?OW.bind(ep):typeof process<"u"&&process.nextTick||VW;var We={isArray:lg,isArrayBuffer:jW,isBuffer:function(r){return r!==null&&!K_(r)&&r.constructor!==null&&!K_(r.constructor)&&qs(r.constructor.isBuffer)&&r.constructor.isBuffer(r)},isFormData:r=>{let a;return r&&(typeof FormData=="function"&&r instanceof FormData||qs(r.append)&&((a=cx(r))==="formdata"||a==="object"&&qs(r.toString)&&r.toString()==="[object FormData]"))},isArrayBufferView:function(r){let a;return a=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer&&jW(r.buffer),a},isString:xRe,isNumber:DW,isBoolean:r=>r===!0||r===!1,isObject:ux,isPlainObject:dx,isReadableStream:IRe,isRequest:ORe,isResponse:PRe,isHeaders:kRe,isUndefined:K_,isDate:TRe,isFile:CRe,isBlob:RRe,isRegExp:LRe,isFunction:qs,isStream:r=>ux(r)&&qs(r.pipe),isURLSearchParams:ARe,isTypedArray:jRe,isFileList:NRe,forEach:q_,merge:function r(){const{caseless:a}=MW(this)&&this||{},s={},l=(d,f)=>{const m=a&&LW(s,f)||f;dx(s[m])&&dx(d)?s[m]=r(s[m],d):dx(d)?s[m]=r({},d):lg(d)?s[m]=d.slice():s[m]=d};for(let d=0,f=arguments.length;d<f;d++)arguments[d]&&q_(arguments[d],l);return s},extend:function(r,a,s){let{allOwnKeys:l}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return q_(a,(d,f)=>{s&&qs(d)?r[f]=PW(d,s):r[f]=d},{allOwnKeys:l}),r},trim:r=>Ea(r)?Ea(r).call(r):r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),inherits:(r,a,s,l)=>{r.prototype=Object.create(a.prototype,l),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:a.prototype}),s&&Object.assign(r.prototype,s)},toFlatObject:(r,a,s,l)=>{let d,f,m;const y={};if(a=a||{},r==null)return a;do{for(d=Object.getOwnPropertyNames(r),f=d.length;f-- >0;)m=d[f],l&&!l(m,r,a)||y[m]||(a[m]=r[m],y[m]=!0);r=s!==!1&&bk(r)}while(r&&(!s||s(r,a))&&r!==Object.prototype);return a},kindOf:cx,kindOfTest:Qc,endsWith:(r,a,s)=>{r=String(r),(s===void 0||s>r.length)&&(s=r.length),s-=a.length;const l=r.indexOf(a,s);return l!==-1&&l===s},toArray:r=>{if(!r)return null;if(lg(r))return r;let a=r.length;if(!DW(a))return null;const s=new Array(a);for(;a-- >0;)s[a]=r[a];return s},forEachEntry:(r,a)=>{const s=(r&&r[ox]).call(r);let l;for(;(l=s.next())&&!l.done;){const d=l.value;a.call(r,d[0],d[1])}},matchAll:(r,a)=>{let s;const l=[];for(;(s=r.exec(a))!==null;)l.push(s);return l},isHTMLForm:DRe,hasOwnProperty:UW,hasOwnProp:UW,reduceDescriptors:FW,freezeMethods:r=>{FW(r,(a,s)=>{if(qs(r)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const l=r[s];qs(l)&&(a.enumerable=!1,"writable"in a?a.writable=!1:a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))})},toObjectSet:(r,a)=>{const s={},l=d=>{d.forEach(f=>{s[f]=!0})};return lg(r)?l(r):l(String(r).split(a)),s},toCamelCase:r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,s,l){return s.toUpperCase()+l}),noop:()=>{},toFiniteNumber:(r,a)=>r!=null&&Number.isFinite(r=+r)?r:a,findKey:LW,global:ep,isContextDefined:MW,isSpecCompliantForm:function(r){return!!(r&&qs(r.append)&&r[kW]==="FormData"&&r[ox])},toJSONObject:r=>{const a=new Array(10),s=(l,d)=>{if(ux(l)){if(a.indexOf(l)>=0)return;if(!("toJSON"in l)){a[d]=l;const f=lg(l)?[]:{};return q_(l,(m,y)=>{const _=s(m,d+1);!K_(_)&&(f[y]=_)}),a[d]=void 0,f}}return l};return s(r,0)},isAsyncFn:MRe,isThenable:r=>r&&(ux(r)||qs(r))&&qs(r.then)&&qs(r.catch),setImmediate:VW,asap:URe,isIterable:r=>r!=null&&qs(r[ox])};function Pn(r,a,s,l,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",a&&(this.code=a),s&&(this.config=s),l&&(this.request=l),d&&(this.response=d,this.status=d.status?d.status:null)}We.inherits(Pn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:We.toJSONObject(this.config),code:this.code,status:this.status}}});const WW=Pn.prototype,GW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{GW[r]={value:r}}),Object.defineProperties(Pn,GW),Object.defineProperty(WW,"isAxiosError",{value:!0}),Pn.from=(r,a,s,l,d,f)=>{const m=Object.create(WW);return We.toFlatObject(r,m,function(y){return y!==Error.prototype},y=>y!=="isAxiosError"),Pn.call(m,r.message,a,s,l,d),m.cause=r,m.name=r.name,f&&Object.assign(m,f),m};function xk(r){return We.isPlainObject(r)||We.isArray(r)}function HW(r){return We.endsWith(r,"[]")?r.slice(0,-2):r}function zW(r,a,s){return r?r.concat(a).map(function(l,d){return l=HW(l),!s&&d?"["+l+"]":l}).join(s?".":""):a}const FRe=We.toFlatObject(We,{},null,function(r){return/^is[A-Z]/.test(r)});function fx(r,a,s){if(!We.isObject(r))throw new TypeError("target must be an object");a=a||new FormData;const l=(s=We.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,L){return!We.isUndefined(L[I])})).metaTokens,d=s.visitor||w,f=s.dots,m=s.indexes,y=(s.Blob||typeof Blob<"u"&&Blob)&&We.isSpecCompliantForm(a);if(!We.isFunction(d))throw new TypeError("visitor must be a function");function _(I){if(I===null)return"";if(We.isDate(I))return I.toISOString();if(!y&&We.isBlob(I))throw new Pn("Blob is not supported. Use a Buffer instead.");return We.isArrayBuffer(I)||We.isTypedArray(I)?y&&typeof Blob=="function"?new Blob([I]):Buffer.from(I):I}function w(I,L,H){let $=I;if(I&&!H&&typeof I=="object"){if(We.endsWith(L,"{}"))L=l?L:L.slice(0,-2),I=JSON.stringify(I);else if(We.isArray(I)&&function(G){return We.isArray(G)&&!G.some(xk)}(I)||(We.isFileList(I)||We.endsWith(L,"[]"))&&($=We.toArray(I)))return L=HW(L),$.forEach(function(G,ne){!We.isUndefined(G)&&G!==null&&a.append(m===!0?zW([L],ne,f):m===null?L:L+"[]",_(G))}),!1}return!!xk(I)||(a.append(zW(H,L,f),_(I)),!1)}const x=[],A=Object.assign(FRe,{defaultVisitor:w,convertValue:_,isVisitable:xk});if(!We.isObject(r))throw new TypeError("data must be an object");return function I(L,H){if(!We.isUndefined(L)){if(x.indexOf(L)!==-1)throw Error("Circular reference detected in "+H.join("."));x.push(L),We.forEach(L,function($,G){(!(We.isUndefined($)||$===null)&&d.call(a,$,We.isString(G)?Ea(G).call(G):G,H,A))===!0&&I($,H?H.concat(G):[G])}),x.pop()}}(r),a}function KW(r){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return a[s]})}function Tk(r,a){this._pairs=[],r&&fx(r,this,a)}const qW=Tk.prototype;function VRe(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function YW(r,a,s){if(!a)return r;const l=s&&s.encode||VRe;We.isFunction(s)&&(s={serialize:s});const d=s&&s.serialize;let f;if(f=d?d(a,s):We.isURLSearchParams(a)?a.toString():new Tk(a,s).toString(l),f){const m=r.indexOf("#");m!==-1&&(r=r.slice(0,m)),r+=(r.indexOf("?")===-1?"?":"&")+f}return r}qW.append=function(r,a){this._pairs.push([r,a])},qW.toString=function(r){const a=r?function(s){return r.call(this,s,KW)}:KW;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};var XW=class{constructor(){this.handlers=[]}use(r,a,s){return this.handlers.push({fulfilled:r,rejected:a,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){We.forEach(this.handlers,function(a){a!==null&&r(a)})}},JW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ZW={exports:{}},BRe=Tn,$Re=ee,QW=ic.f;BRe({target:"Object",stat:!0,forced:Object.defineProperty!==QW,sham:!$Re},{defineProperty:QW});var eG=it.Object,WRe=ZW.exports=function(r,a,s){return eG.defineProperty(r,a,s)};eG.defineProperty.sham&&(WRe.sham=!0);var tG=o(ZW.exports),GRe=TypeError,nG=N_,HRe=PS,zRe=At,KRe=qr("species"),rG=Array,qRe=function(r){var a;return nG(r)&&(a=r.constructor,(HRe(a)&&(a===rG||nG(a.prototype))||zRe(a)&&(a=a[KRe])===null)&&(a=void 0)),a===void 0?rG:a},iG=function(r,a){return new(qRe(r))(a===0?0:a)},YRe=u,XRe=ia,JRe=qr("species"),aG=function(r){return XRe>=51||!YRe(function(){var a=[];return(a.constructor={})[JRe]=function(){return{foo:1}},a[r](Boolean).foo!==1})},ZRe=Tn,QRe=u,eNe=N_,tNe=At,nNe=Yl,rNe=nh,sG=function(r){if(r>9007199254740991)throw GRe("Maximum allowed index exceeded");return r},oG=BP,iNe=iG,aNe=aG,sNe=ia,cG=qr("isConcatSpreadable"),oNe=sNe>=51||!QRe(function(){var r=[];return r[cG]=!1,r.concat()[0]!==r}),cNe=function(r){if(!tNe(r))return!1;var a=r[cG];return a!==void 0?!!a:eNe(r)};ZRe({target:"Array",proto:!0,forced:!oNe||!aNe("concat")},{concat:function(r){var a,s,l,d,f,m=nNe(this),y=iNe(m,0),_=0;for(a=-1,l=arguments.length;a<l;a++)if(cNe(f=a===-1?m:arguments[a]))for(d=rNe(f),sG(_+d),s=0;s<d;s++,_++)s in f&&oG(y,_,f[s]);else sG(_+1),oG(y,_++,f);return y.length=_,y}});var lG={},lNe=V,uNe=ht,uG=gS.f,dNe=ah,dG=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];lG.f=function(r){return dG&&lNe(r)==="Window"?function(a){try{return uG(a)}catch{return dNe(dG)}}(r):uG(uNe(r))};var ug={},hNe=qr;ug.f=hNe;var hG=it,fNe=aa,pNe=ug,mNe=ic.f,xi=function(r){var a=hG.Symbol||(hG.Symbol={});fNe(a,r)||mNe(a,r,{value:pNe.f(r)})},gNe=J,vNe=at,yNe=qr,_Ne=ih,fG=function(){var r=vNe("Symbol"),a=r&&r.prototype,s=a&&a.valueOf,l=yNe("toPrimitive");a&&!a[l]&&_Ne(a,l,function(d){return gNe(s,this)},{})},bNe=th,ENe=Be,wNe=Yl,SNe=nh,xNe=iG,pG=E([].push),TNe=function(r){var a=r===1,s=r===2,l=r===3,d=r===4,f=r===6,m=r===7,y=r===5||f;return function(_,w,x,A){for(var I,L,H=wNe(_),$=ENe(H),G=SNe($),ne=bNe(w,x),te=0,ce=A||xNe,pe=a?ce(_,G):s||m?ce(_,0):void 0;G>te;te++)if((y||te in $)&&(L=ne(I=$[te],te,H),r))if(a)pe[te]=L;else if(L)switch(r){case 3:return!0;case 5:return I;case 6:return te;case 2:pG(pe,I)}else switch(r){case 4:return!1;case 7:pG(pe,I)}return f?-1:l||d?d:pe}},mG={forEach:TNe(0)},px=Tn,Y_=R,Ck=J,CNe=E,dg=ee,hg=lt,RNe=u,ka=aa,NNe=T,Rk=Cs,mx=ht,Nk=mO,ANe=Ks,Ak=Pe,fg=I_,gG=yS,INe=gS,vG=lG,ONe=A_,yG=q,_G=ic,PNe=DO,bG=re,EG=ih,kNe=OS,Ik=Vm,wG=vS,SG=fO,jNe=qr,DNe=ug,LNe=xi,MNe=fG,UNe=Qu,xG=zf,gx=mG.forEach,Ys=mS("hidden"),vx="Symbol",X_="prototype",FNe=xG.set,TG=xG.getterFor(vx),el=Object[X_],tp=Y_.Symbol,yx=tp&&tp[X_],VNe=Y_.RangeError,BNe=Y_.TypeError,Ok=Y_.QObject,CG=yG.f,np=_G.f,RG=vG.f,$Ne=bG.f,NG=CNe([].push),nd=Ik("symbols"),J_=Ik("op-symbols"),WNe=Ik("wks"),Pk=!Ok||!Ok[X_]||!Ok[X_].findChild,AG=function(r,a,s){var l=CG(el,a);l&&delete el[a],np(r,a,s),l&&r!==el&&np(el,a,l)},kk=dg&&RNe(function(){return fg(np({},"a",{get:function(){return np(this,"a",{value:7}).a}})).a!==7})?AG:np,jk=function(r,a){var s=nd[r]=fg(yx);return FNe(s,{type:vx,tag:r,description:a}),dg||(s.description=a),s},_x=function(r,a,s){r===el&&_x(J_,a,s),Rk(r);var l=Nk(a);return Rk(s),ka(nd,l)?(s.enumerable?(ka(r,Ys)&&r[Ys][l]&&(r[Ys][l]=!1),s=fg(s,{enumerable:Ak(0,!1)})):(ka(r,Ys)||np(r,Ys,Ak(1,fg(null))),r[Ys][l]=!0),kk(r,l,s)):np(r,l,s)},Dk=function(r,a){Rk(r);var s=mx(a),l=gG(s).concat(kG(s));return gx(l,function(d){dg&&!Ck(IG,s,d)||_x(r,d,s[d])}),r},IG=function(r){var a=Nk(r),s=Ck($Ne,this,a);return!(this===el&&ka(nd,a)&&!ka(J_,a))&&(!(s||!ka(this,a)||!ka(nd,a)||ka(this,Ys)&&this[Ys][a])||s)},OG=function(r,a){var s=mx(r),l=Nk(a);if(s!==el||!ka(nd,l)||ka(J_,l)){var d=CG(s,l);return!d||!ka(nd,l)||ka(s,Ys)&&s[Ys][l]||(d.enumerable=!0),d}},PG=function(r){var a=RG(mx(r)),s=[];return gx(a,function(l){ka(nd,l)||ka(wG,l)||NG(s,l)}),s},kG=function(r){var a=r===el,s=RG(a?J_:mx(r)),l=[];return gx(s,function(d){!ka(nd,d)||a&&!ka(el,d)||NG(l,nd[d])}),l};hg||(tp=function(){if(NNe(yx,this))throw new BNe("Symbol is not a constructor");var r=arguments.length&&arguments[0]!==void 0?ANe(arguments[0]):void 0,a=SG(r),s=function(l){var d=this===void 0?Y_:this;d===el&&Ck(s,J_,l),ka(d,Ys)&&ka(d[Ys],a)&&(d[Ys][a]=!1);var f=Ak(1,l);try{kk(d,a,f)}catch(m){if(!(m instanceof VNe))throw m;AG(d,a,f)}};return dg&&Pk&&kk(el,a,{configurable:!0,set:s}),jk(a,r)},EG(yx=tp[X_],"toString",function(){return TG(this).tag}),EG(tp,"withoutSetter",function(r){return jk(SG(r),r)}),bG.f=IG,_G.f=_x,PNe.f=Dk,yG.f=OG,INe.f=vG.f=PG,ONe.f=kG,DNe.f=function(r){return jk(jNe(r),r)},dg&&kNe(yx,"description",{configurable:!0,get:function(){return TG(this).description}})),px({global:!0,wrap:!0,forced:!hg,sham:!hg},{Symbol:tp}),gx(gG(WNe),function(r){LNe(r)}),px({target:vx,stat:!0,forced:!hg},{useSetter:function(){Pk=!0},useSimple:function(){Pk=!1}}),px({target:"Object",stat:!0,forced:!hg,sham:!dg},{create:function(r,a){return a===void 0?fg(r):Dk(fg(r),a)},defineProperty:_x,defineProperties:Dk,getOwnPropertyDescriptor:OG}),px({target:"Object",stat:!0,forced:!hg},{getOwnPropertyNames:PG}),MNe(),UNe(tp,vx),wG[Ys]=!0;var jG=lt&&!!Symbol.for&&!!Symbol.keyFor,GNe=Tn,HNe=at,zNe=aa,KNe=Ks,DG=Vm,qNe=jG,Lk=DG("string-to-symbol-registry"),YNe=DG("symbol-to-string-registry");GNe({target:"Symbol",stat:!0,forced:!qNe},{for:function(r){var a=KNe(r);if(zNe(Lk,a))return Lk[a];var s=HNe("Symbol")(a);return Lk[a]=s,YNe[s]=a,s}});var XNe=Tn,JNe=aa,ZNe=Wf,QNe=nr,eAe=jG,LG=Vm("symbol-to-string-registry");XNe({target:"Symbol",stat:!0,forced:!eAe},{keyFor:function(r){if(!ZNe(r))throw new TypeError(QNe(r)+" is not a symbol");if(JNe(LG,r))return LG[r]}});var MG=N_,tAe=K,UG=V,nAe=Ks,FG=E([].push),rAe=Tn,VG=at,BG=P,iAe=J,Z_=E,$G=u,WG=K,GG=Wf,HG=ah,aAe=function(r){if(tAe(r))return r;if(MG(r)){for(var a=r.length,s=[],l=0;l<a;l++){var d=r[l];typeof d=="string"?FG(s,d):typeof d!="number"&&UG(d)!=="Number"&&UG(d)!=="String"||FG(s,nAe(d))}var f=s.length,m=!0;return function(y,_){if(m)return m=!1,_;if(MG(this))return _;for(var w=0;w<f;w++)if(s[w]===y)return _}}},sAe=lt,oAe=String,dh=VG("JSON","stringify"),bx=Z_(/./.exec),zG=Z_("".charAt),cAe=Z_("".charCodeAt),lAe=Z_("".replace),uAe=Z_(1 .toString),dAe=/[\uD800-\uDFFF]/g,KG=/^[\uD800-\uDBFF]$/,qG=/^[\uDC00-\uDFFF]$/,YG=!sAe||$G(function(){var r=VG("Symbol")("stringify detection");return dh([r])!=="[null]"||dh({a:r})!=="{}"||dh(Object(r))!=="{}"}),XG=$G(function(){return dh("\uDF06\uD834")!=='"\\udf06\\ud834"'||dh("\uDEAD")!=='"\\udead"'}),hAe=function(r,a){var s=HG(arguments),l=aAe(a);if(WG(l)||r!==void 0&&!GG(r))return s[1]=function(d,f){if(WG(l)&&(f=iAe(l,this,oAe(d),f)),!GG(f))return f},BG(dh,null,s)},fAe=function(r,a,s){var l=zG(s,a-1),d=zG(s,a+1);return bx(KG,r)&&!bx(qG,d)||bx(qG,r)&&!bx(KG,l)?"\\u"+uAe(cAe(r,0),16):r};dh&&rAe({target:"JSON",stat:!0,forced:YG||XG},{stringify:function(r,a,s){var l=HG(arguments),d=BG(YG?hAe:dh,null,l);return XG&&typeof d=="string"?lAe(d,dAe,fAe):d}});var JG=A_,pAe=Yl;Tn({target:"Object",stat:!0,forced:!lt||u(function(){JG.f(1)})},{getOwnPropertySymbols:function(r){var a=JG.f;return a?a(pAe(r)):[]}}),xi("asyncIterator"),xi("hasInstance"),xi("isConcatSpreadable"),xi("iterator"),xi("match"),xi("matchAll"),xi("replace"),xi("search"),xi("species"),xi("split");var mAe=fG;xi("toPrimitive"),mAe();var gAe=at,vAe=Qu;xi("toStringTag"),vAe(gAe("Symbol"),"Symbol"),xi("unscopables"),Qu(R.JSON,"JSON",!0);var yAe=it.Symbol,_Ae=qr,bAe=ic.f,ZG=_Ae("metadata"),QG=Function.prototype;QG[ZG]===void 0&&bAe(QG,ZG,{value:null}),xi("asyncDispose"),xi("dispose"),xi("metadata");var EAe=yAe,wAe=E,Mk=at("Symbol"),SAe=Mk.keyFor,xAe=wAe(Mk.prototype.valueOf),eH=Mk.isRegisteredSymbol||function(r){try{return SAe(xAe(r))!==void 0}catch{return!1}};Tn({target:"Symbol",stat:!0},{isRegisteredSymbol:eH});for(var TAe=Vm,tH=at,CAe=E,RAe=Wf,NAe=qr,Ex=tH("Symbol"),nH=Ex.isWellKnownSymbol,rH=tH("Object","getOwnPropertyNames"),AAe=CAe(Ex.prototype.valueOf),iH=TAe("wks"),Uk=0,aH=rH(Ex),IAe=aH.length;Uk<IAe;Uk++)try{var sH=aH[Uk];RAe(Ex[sH])&&NAe(sH)}catch{}var oH=function(r){if(nH&&nH(r))return!0;try{for(var a=AAe(r),s=0,l=rH(iH),d=l.length;s<d;s++)if(iH[l[s]]==a)return!0}catch{}return!1};Tn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:oH}),xi("customMatcher"),xi("observable"),Tn({target:"Symbol",stat:!0},{isRegistered:eH}),Tn({target:"Symbol",stat:!0,forced:!0},{isWellKnown:oH}),xi("matcher"),xi("metadataKey"),xi("patternMatch"),xi("replaceAll");var pg=o(EAe),cH=o(ug.f("iterator"));function Q_(r){return Q_=typeof pg=="function"&&typeof cH=="symbol"?function(a){return typeof a}:function(a){return a&&typeof pg=="function"&&a.constructor===pg&&a!==pg.prototype?"symbol":typeof a},Q_(r)}var OAe=o(ug.f("toPrimitive"));function PAe(r){var a=function(s,l){if(Q_(s)!="object"||!s)return s;var d=s[OAe];if(d!==void 0){var f=d.call(s,l);if(Q_(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return Q_(a)=="symbol"?a:a+""}function Z(r,a,s){return(a=PAe(a))in r?tG(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}var lH=o(PTe),kAe={isBrowser:!0,classes:{URLSearchParams:lH!==void 0?lH:Tk,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const Fk=typeof window<"u"&&typeof document<"u",Vk=typeof navigator=="object"&&navigator||void 0,jAe=Fk&&(!Vk||["ReactNative","NativeScript","NS"].indexOf(Vk.product)<0),DAe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",LAe=Fk&&window.location.href||"http://localhost";function uH(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function dH(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?uH(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):uH(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}var as=dH(dH({},Object.freeze({__proto__:null,hasBrowserEnv:Fk,hasStandardBrowserEnv:jAe,hasStandardBrowserWebWorkerEnv:DAe,navigator:Vk,origin:LAe})),kAe),MAe=Cs,UAe=J,FAe=aa,VAe=T,BAe=function(){var r=MAe(this),a="";return r.hasIndices&&(a+="d"),r.global&&(a+="g"),r.ignoreCase&&(a+="i"),r.multiline&&(a+="m"),r.dotAll&&(a+="s"),r.unicode&&(a+="u"),r.unicodeSets&&(a+="v"),r.sticky&&(a+="y"),a},hH=RegExp.prototype,fH=function(r){var a=r.flags;return a!==void 0||"flags"in hH||FAe(r,"flags")||!VAe(hH,r)?a:UAe(BAe,r)},$Ae=RP.charAt,pH=J,WAe=Cs,GAe=K,HAe=V,zAe=/./.exec,KAe=TypeError,qAe=Tn,mH=J,gH=Y,YAe=qO,wx=AS,vH=Mt,yH=v5,eb=Ks,XAe=Cs,JAe=At,ZAe=V,QAe=_5,_H=fH,e1e=So,t1e=u,n1e=eP,r1e=function(r,a,s){return a+(s?$Ae(r,a).length:1)},i1e=function(r,a){var s=r.exec;if(GAe(s)){var l=pH(s,r,a);return l!==null&&WAe(l),l}if(HAe(r)==="RegExp")return pH(zAe,r,a);throw new KAe("RegExp#exec called on incompatible receiver")},bH=zf,a1e=qr("matchAll"),EH="RegExp String",wH=EH+" Iterator",s1e=bH.set,o1e=bH.getterFor(wH),c1e=TypeError,Bk=gH("".indexOf),Sx=gH("".matchAll),$k=!!Sx&&!t1e(function(){Sx("a",/./)}),l1e=YAe(function(r,a,s,l){s1e(this,{type:wH,regexp:r,string:a,global:s,unicode:l,done:!1})},EH,function(){var r=o1e(this);if(r.done)return wx(void 0,!0);var a=r.regexp,s=r.string,l=i1e(a,s);return l===null?(r.done=!0,wx(void 0,!0)):r.global?(eb(l[0])===""&&(a.lastIndex=r1e(s,yH(a.lastIndex),r.unicode)),wx(l,!1)):(r.done=!0,wx(l,!1))}),SH=function(r){var a,s,l,d=XAe(this),f=eb(r),m=n1e(d,RegExp),y=eb(_H(d));return a=new m(m===RegExp?d.source:d,y),s=!!~Bk(y,"g"),l=!!~Bk(y,"u"),a.lastIndex=yH(d.lastIndex),new l1e(a,f,s,l)};qAe({target:"String",proto:!0,forced:$k},{matchAll:function(r){var a,s,l,d,f=vH(this);if(JAe(r)){if(QAe(r)&&(a=eb(vH(_H(r))),!~Bk(a,"g")))throw new c1e("`.matchAll` does not allow non-global regexes");if($k)return Sx(f,r);if((l=e1e(r,a1e))===void 0&&ZAe(r)==="RegExp"&&(l=SH),l)return mH(l,r,f)}else if($k)return Sx(f,r);return s=eb(f),d=new RegExp(r,"g"),mH(SH,d,s)}});var u1e=ac("String","matchAll"),d1e=T,h1e=u1e,Wk=String.prototype,f1e=function(r){var a=r.matchAll;return typeof r=="string"||r===Wk||d1e(Wk,r)&&a===Wk.matchAll?h1e:a},p1e=o(f1e);function xH(r){function a(s,l,d,f){let m=s[f++];if(m==="__proto__")return!0;const y=Number.isFinite(+m),_=f>=s.length;return m=!m&&We.isArray(d)?d.length:m,_?(We.hasOwnProp(d,m)?d[m]=[d[m],l]:d[m]=l,!y):(d[m]&&We.isObject(d[m])||(d[m]=[]),a(s,l,d[m],f)&&We.isArray(d[m])&&(d[m]=function(w){const x={},A=Object.keys(w);let I;const L=A.length;let H;for(I=0;I<L;I++)H=A[I],x[H]=w[H];return x}(d[m])),!y)}if(We.isFormData(r)&&We.isFunction(r.entries)){const s={};return We.forEachEntry(r,(l,d)=>{a(function(f){return p1e(We).call(We,/\w+|\[(\w*)]/g,f).map(m=>m[0]==="[]"?"":m[1]||m[0])}(l),d,s,0)}),s}return null}const Gk={transitional:JW,adapter:["xhr","http","fetch"],transformRequest:[function(r,a){const s=a.getContentType()||"",l=s.indexOf("application/json")>-1,d=We.isObject(r);if(d&&We.isHTMLForm(r)&&(r=new FormData(r)),We.isFormData(r))return l?JSON.stringify(xH(r)):r;if(We.isArrayBuffer(r)||We.isBuffer(r)||We.isStream(r)||We.isFile(r)||We.isBlob(r)||We.isReadableStream(r))return r;if(We.isArrayBufferView(r))return r.buffer;if(We.isURLSearchParams(r))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let f;if(d){if(s.indexOf("application/x-www-form-urlencoded")>-1)return function(m,y){return fx(m,new as.classes.URLSearchParams,Object.assign({visitor:function(_,w,x,A){return as.isNode&&We.isBuffer(_)?(this.append(w,_.toString("base64")),!1):A.defaultVisitor.apply(this,arguments)}},y))}(r,this.formSerializer).toString();if((f=We.isFileList(r))||s.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return fx(f?{"files[]":r}:r,m&&new m,this.formSerializer)}}return d||l?(a.setContentType("application/json",!1),function(m,y,_){if(We.isString(m))try{return(y||JSON.parse)(m),Ea(We).call(We,m)}catch(w){if(w.name!=="SyntaxError")throw w}return(_||JSON.stringify)(m)}(r)):r}],transformResponse:[function(r){const a=this.transitional||Gk.transitional,s=a&&a.forcedJSONParsing,l=this.responseType==="json";if(We.isResponse(r)||We.isReadableStream(r))return r;if(r&&We.isString(r)&&(s&&!this.responseType||l)){const d=!(a&&a.silentJSONParsing)&&l;try{return JSON.parse(r)}catch(f){if(d)throw f.name==="SyntaxError"?Pn.from(f,Pn.ERR_BAD_RESPONSE,this,null,this.response):f}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:as.classes.FormData,Blob:as.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};We.forEach(["delete","get","head","post","put","patch"],r=>{Gk.headers[r]={}});var Hk=Gk;const m1e=We.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),TH=Symbol("internals");function tb(r){var a;return r&&Ea(a=String(r)).call(a).toLowerCase()}function xx(r){return r===!1||r==null?r:We.isArray(r)?r.map(xx):String(r)}function zk(r,a,s,l,d){return We.isFunction(l)?l.call(this,a,s):(d&&(a=s),We.isString(a)?We.isString(l)?a.indexOf(l)!==-1:We.isRegExp(l)?l.test(a):void 0:void 0)}class Tx{constructor(a){a&&this.set(a)}set(a,s,l){const d=this;function f(_,w,x){const A=tb(w);if(!A)throw new Error("header name must be a non-empty string");const I=We.findKey(d,A);(!I||d[I]===void 0||x===!0||x===void 0&&d[I]!==!1)&&(d[I||w]=xx(_))}const m=(_,w)=>We.forEach(_,(x,A)=>f(x,A,w));if(We.isPlainObject(a)||a instanceof this.constructor)m(a,s);else if(We.isString(a)&&(a=Ea(a).call(a))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Ea(y=a).call(y)))m((_=>{const w={};let x,A,I;return _&&_.split(`
`).forEach(function(L){var H,$;I=L.indexOf(":"),x=Ea(H=L.substring(0,I)).call(H).toLowerCase(),A=Ea($=L.substring(I+1)).call($),!x||w[x]&&m1e[x]||(x==="set-cookie"?w[x]?w[x].push(A):w[x]=[A]:w[x]=w[x]?w[x]+", "+A:A)}),w})(a),s);else if(We.isObject(a)&&We.isIterable(a)){let _,w,x={};for(const A of a){if(!We.isArray(A))throw TypeError("Object iterator must return a key-value pair");x[w=A[0]]=(_=x[w])?We.isArray(_)?[..._,A[1]]:[_,A[1]]:A[1]}m(x,s)}else a!=null&&f(s,a,l);var y;return this}get(a,s){if(a=tb(a)){const l=We.findKey(this,a);if(l){const d=this[l];if(!s)return d;if(s===!0)return function(f){const m=Object.create(null),y=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _;for(;_=y.exec(f);)m[_[1]]=_[2];return m}(d);if(We.isFunction(s))return s.call(this,d,l);if(We.isRegExp(s))return s.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,s){if(a=tb(a)){const l=We.findKey(this,a);return!(!l||this[l]===void 0||s&&!zk(0,this[l],l,s))}return!1}delete(a,s){const l=this;let d=!1;function f(m){if(m=tb(m)){const y=We.findKey(l,m);!y||s&&!zk(0,l[y],y,s)||(delete l[y],d=!0)}}return We.isArray(a)?a.forEach(f):f(a),d}clear(a){const s=Object.keys(this);let l=s.length,d=!1;for(;l--;){const f=s[l];a&&!zk(0,this[f],f,a,!0)||(delete this[f],d=!0)}return d}normalize(a){const s=this,l={};return We.forEach(this,(d,f)=>{var m;const y=We.findKey(l,f);if(y)return s[y]=xx(d),void delete s[f];const _=a?function(w){return Ea(w).call(w).toLowerCase().replace(/([a-z\d])(\w*)/g,(x,A,I)=>A.toUpperCase()+I)}(f):Ea(m=String(f)).call(m);_!==f&&delete s[f],s[_]=xx(d),l[_]=!0}),this}concat(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return this.constructor.concat(this,...s)}toJSON(a){const s=Object.create(null);return We.forEach(this,(l,d)=>{l!=null&&l!==!1&&(s[d]=a&&We.isArray(l)?l.join(", "):l)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(a=>{let[s,l]=a;return s+": "+l}).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a){const s=new this(a);for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];return d.forEach(m=>s.set(m)),s}static accessor(a){const s=(this[TH]=this[TH]={accessors:{}}).accessors,l=this.prototype;function d(f){const m=tb(f);s[m]||(function(y,_){const w=We.toCamelCase(" "+_);["get","set","has"].forEach(x=>{Object.defineProperty(y,x+w,{value:function(A,I,L){return this[x].call(this,_,A,I,L)},configurable:!0})})}(l,f),s[m]=!0)}return We.isArray(a)?a.forEach(d):d(a),this}}Tx.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),We.reduceDescriptors(Tx.prototype,(r,a)=>{let{value:s}=r,l=a[0].toUpperCase()+a.slice(1);return{get:()=>s,set(d){this[l]=d}}}),We.freezeMethods(Tx);var tl=Tx;function Kk(r,a){const s=this||Hk,l=a||s,d=tl.from(l.headers);let f=l.data;return We.forEach(r,function(m){f=m.call(s,f,d.normalize(),a?a.status:void 0)}),d.normalize(),f}function CH(r){return!(!r||!r.__CANCEL__)}function mg(r,a,s){Pn.call(this,r??"canceled",Pn.ERR_CANCELED,a,s),this.name="CanceledError"}function RH(r,a,s){const l=s.config.validateStatus;s.status&&l&&!l(s.status)?a(new Pn("Request failed with status code "+s.status,[Pn.ERR_BAD_REQUEST,Pn.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):r(s)}We.inherits(mg,Pn,{__CANCEL__:!0});const Cx=function(r,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,l=0;const d=function(f,m){f=f||10;const y=new Array(f),_=new Array(f);let w,x=0,A=0;return m=m!==void 0?m:1e3,function(I){const L=Date.now(),H=_[A];w||(w=L),y[x]=I,_[x]=L;let $=A,G=0;for(;$!==x;)G+=y[$++],$%=f;if(x=(x+1)%f,x===A&&(A=(A+1)%f),L-w<m)return;const ne=H&&L-H;return ne?Math.round(1e3*G/ne):void 0}}(50,250);return function(f,m){let y,_,w=0,x=1e3/m;const A=function(I){w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),y=null,_&&(clearTimeout(_),_=null),f.apply(null,I)};return[function(){const I=Date.now(),L=I-w;for(var H=arguments.length,$=new Array(H),G=0;G<H;G++)$[G]=arguments[G];L>=x?A($,I):(y=$,_||(_=setTimeout(()=>{_=null,A(y)},x-L)))},()=>y&&A(y)]}(f=>{const m=f.loaded,y=f.lengthComputable?f.total:void 0,_=m-l,w=d(_);l=m,r({loaded:m,total:y,progress:y?m/y:void 0,bytes:_,rate:w||void 0,estimated:w&&y&&m<=y?(y-m)/w:void 0,event:f,lengthComputable:y!=null,[a?"download":"upload"]:!0})},s)},NH=(r,a)=>{const s=r!=null;return[l=>a[0]({lengthComputable:s,total:r,loaded:l}),a[1]]},AH=r=>function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return We.asap(()=>r(...s))};var g1e=as.hasStandardBrowserEnv?((r,a)=>s=>(s=new ex(s,as.origin),r.protocol===s.protocol&&r.host===s.host&&(a||r.port===s.port)))(new ex(as.origin),as.navigator&&/(msie|trident)/i.test(as.navigator.userAgent)):()=>!0,v1e=as.hasStandardBrowserEnv?{write(r,a,s,l,d,f){const m=[r+"="+encodeURIComponent(a)];We.isNumber(s)&&m.push("expires="+new Date(s).toGMTString()),We.isString(l)&&m.push("path="+l),We.isString(d)&&m.push("domain="+d),f===!0&&m.push("secure"),document.cookie=m.join("; ")},read(r){const a=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function IH(r,a,s){let l=!function(d){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(d)}(a);return r&&(l||s==0)?function(d,f){return f?d.replace(/\/?\/$/,"")+"/"+f.replace(/^\/+/,""):d}(r,a):a}function OH(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}const PH=r=>r instanceof tl?function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?OH(Object(l),!0).forEach(function(d){Z(a,d,l[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(l)):OH(Object(l)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(l,d))})}return a}({},r):r;function rp(r,a){a=a||{};const s={};function l(w,x,A,I){return We.isPlainObject(w)&&We.isPlainObject(x)?We.merge.call({caseless:I},w,x):We.isPlainObject(x)?We.merge({},x):We.isArray(x)?x.slice():x}function d(w,x,A,I){return We.isUndefined(x)?We.isUndefined(w)?void 0:l(void 0,w,0,I):l(w,x,0,I)}function f(w,x){if(!We.isUndefined(x))return l(void 0,x)}function m(w,x){return We.isUndefined(x)?We.isUndefined(w)?void 0:l(void 0,w):l(void 0,x)}function y(w,x,A){return A in a?l(w,x):A in r?l(void 0,w):void 0}const _={url:f,method:f,data:f,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:y,headers:(w,x,A)=>d(PH(w),PH(x),0,!0)};return We.forEach(Object.keys(Object.assign({},r,a)),function(w){const x=_[w]||d,A=x(r[w],a[w],w);We.isUndefined(A)&&x!==y||(s[w]=A)}),s}var kH=r=>{const a=rp({},r);let s,{data:l,withXSRFToken:d,xsrfHeaderName:f,xsrfCookieName:m,headers:y,auth:_}=a;if(a.headers=y=tl.from(y),a.url=YW(IH(a.baseURL,a.url,a.allowAbsoluteUrls),r.params,r.paramsSerializer),_&&y.set("Authorization","Basic "+btoa((_.username||"")+":"+(_.password?unescape(encodeURIComponent(_.password)):""))),We.isFormData(l)){if(as.hasStandardBrowserEnv||as.hasStandardBrowserWebWorkerEnv)y.setContentType(void 0);else if((s=y.getContentType())!==!1){const[w,...x]=s?s.split(";").map(A=>Ea(A).call(A)).filter(Boolean):[];y.setContentType([w||"multipart/form-data",...x].join("; "))}}if(as.hasStandardBrowserEnv&&(d&&We.isFunction(d)&&(d=d(a)),d||d!==!1&&g1e(a.url))){const w=f&&m&&v1e.read(m);w&&y.set(f,w)}return a},y1e=typeof XMLHttpRequest<"u"&&function(r){return new Ge(function(a,s){const l=kH(r);let d=l.data;const f=tl.from(l.headers).normalize();let m,y,_,w,x,{responseType:A,onUploadProgress:I,onDownloadProgress:L}=l;function H(){w&&w(),x&&x(),l.cancelToken&&l.cancelToken.unsubscribe(m),l.signal&&l.signal.removeEventListener("abort",m)}let $=new XMLHttpRequest;function G(){if(!$)return;const te=tl.from("getAllResponseHeaders"in $&&$.getAllResponseHeaders());RH(function(ce){a(ce),H()},function(ce){s(ce),H()},{data:A&&A!=="text"&&A!=="json"?$.response:$.responseText,status:$.status,statusText:$.statusText,headers:te,config:r,request:$}),$=null}$.open(l.method.toUpperCase(),l.url,!0),$.timeout=l.timeout,"onloadend"in $?$.onloadend=G:$.onreadystatechange=function(){$&&$.readyState===4&&($.status!==0||$.responseURL&&$.responseURL.indexOf("file:")===0)&&setTimeout(G)},$.onabort=function(){$&&(s(new Pn("Request aborted",Pn.ECONNABORTED,r,$)),$=null)},$.onerror=function(){s(new Pn("Network Error",Pn.ERR_NETWORK,r,$)),$=null},$.ontimeout=function(){let te=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const ce=l.transitional||JW;l.timeoutErrorMessage&&(te=l.timeoutErrorMessage),s(new Pn(te,ce.clarifyTimeoutError?Pn.ETIMEDOUT:Pn.ECONNABORTED,r,$)),$=null},d===void 0&&f.setContentType(null),"setRequestHeader"in $&&We.forEach(f.toJSON(),function(te,ce){$.setRequestHeader(ce,te)}),We.isUndefined(l.withCredentials)||($.withCredentials=!!l.withCredentials),A&&A!=="json"&&($.responseType=l.responseType),L&&([_,x]=Cx(L,!0),$.addEventListener("progress",_)),I&&$.upload&&([y,w]=Cx(I),$.upload.addEventListener("progress",y),$.upload.addEventListener("loadend",w)),(l.cancelToken||l.signal)&&(m=te=>{$&&(s(!te||te.type?new mg(null,r,$):te),$.abort(),$=null)},l.cancelToken&&l.cancelToken.subscribe(m),l.signal&&(l.signal.aborted?m():l.signal.addEventListener("abort",m)));const ne=function(te){const ce=/^([-+\w]{1,25})(:?\/\/|:)/.exec(te);return ce&&ce[1]||""}(l.url);ne&&as.protocols.indexOf(ne)===-1?s(new Pn("Unsupported protocol "+ne+":",Pn.ERR_BAD_REQUEST,r)):$.send(d||null)})},_1e=(r,a)=>{const{length:s}=r=r?r.filter(Boolean):[];if(a||s){let l,d=new AbortController;const f=function(w){if(!l){l=!0,y();const x=w instanceof Error?w:this.reason;d.abort(x instanceof Pn?x:new mg(x instanceof Error?x.message:x))}};let m=a&&setTimeout(()=>{m=null,f(new Pn("timeout ".concat(a," of ms exceeded"),Pn.ETIMEDOUT))},a);const y=()=>{r&&(m&&clearTimeout(m),m=null,r.forEach(w=>{w.unsubscribe?w.unsubscribe(f):w.removeEventListener("abort",f)}),r=null)};r.forEach(w=>w.addEventListener("abort",f));const{signal:_}=d;return _.unsubscribe=()=>We.asap(y),_}},qk=o(b6),jH=ug.f("asyncIterator"),b1e=o(jH);function Yk(r,a){this.v=r,this.k=a}function To(r){return function(){return new nb(r.apply(this,arguments))}}function nb(r){var a,s;function l(f,m){try{var y=r[f](m),_=y.value,w=_ instanceof Yk;qk.resolve(w?_.v:_).then(function(x){if(w){var A=f==="return"?"return":"next";if(!_.k||x.done)return l(A,x);x=r[A](x).value}d(y.done?"return":"normal",x)},function(x){l("throw",x)})}catch(x){d("throw",x)}}function d(f,m){switch(f){case"return":a.resolve({value:m,done:!0});break;case"throw":a.reject(m);break;default:a.resolve({value:m,done:!1})}(a=a.next)?l(a.key,a.arg):s=null}this._invoke=function(f,m){return new qk(function(y,_){var w={key:f,arg:m,resolve:y,reject:_,next:null};s?s=s.next=w:(a=s=w,l(f,m))})},typeof r.return!="function"&&(this.return=void 0)}function ln(r){return new Yk(r,0)}function Rx(r){var a={},s=!1;function l(d,f){return s=!0,f=new qk(function(m){m(r[d](f))}),{done:!1,value:new Yk(f,1)}}return a[pg!==void 0&&cH||"@@iterator"]=function(){return this},a.next=function(d){return s?(s=!1,d):l("next",d)},typeof r.throw=="function"&&(a.throw=function(d){if(s)throw s=!1,d;return l("throw",d)}),typeof r.return=="function"&&(a.return=function(d){return s?(s=!1,d):l("return",d)}),a}nb.prototype[typeof pg=="function"&&b1e||"@@asyncIterator"]=function(){return this},nb.prototype.next=function(r){return this._invoke("next",r)},nb.prototype.throw=function(r){return this._invoke("throw",r)},nb.prototype.return=function(r){return this._invoke("return",r)};var Xk=o(jH);function Jk(r){var a,s,l,d=2;for(typeof Symbol<"u"&&(s=Xk,l=Symbol.iterator);d--;){if(s&&(a=r[s])!=null)return a.call(r);if(l&&(a=r[l])!=null)return new Nx(a.call(r));s="@@asyncIterator",l="@@iterator"}throw new TypeError("Object is not async iterable")}function Nx(r){function a(s){if(Object(s)!==s)return Ge.reject(new TypeError(s+" is not an object."));var l=s.done;return Ge.resolve(s.value).then(function(d){return{value:d,done:l}})}return Nx=function(s){this.s=s,this.n=s.next},Nx.prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(s){var l=this.s.return;return l===void 0?Ge.resolve({value:s,done:!0}):a(l.apply(this.s,arguments))},throw:function(s){var l=this.s.return;return l===void 0?Ge.reject(s):a(l.apply(this.s,arguments))}},new Nx(r)}const E1e=function*(r,a){let s=r.byteLength;if(!a||s<a)return void(yield r);let l,d=0;for(;d<s;)l=d+a,yield r.slice(d,l),d=l},w1e=function(){var r=To(function*(a,s){var l,d=!1,f=!1;try{for(var m,y=Jk(S1e(a));d=!(m=yield ln(y.next())).done;d=!1){const _=m.value;yield*Rx(Jk(E1e(_,s)))}}catch(_){f=!0,l=_}finally{try{d&&y.return!=null&&(yield ln(y.return()))}finally{if(f)throw l}}});return function(a,s){return r.apply(this,arguments)}}(),S1e=function(){var r=To(function*(a){if(a[Xk])return void(yield*Rx(Jk(a)));const s=a.getReader();try{for(;;){const{done:l,value:d}=yield ln(s.read());if(l)break;yield d}}finally{yield ln(s.cancel())}});return function(a){return r.apply(this,arguments)}}(),DH=(r,a,s,l)=>{const d=w1e(r,a);let f,m=0,y=_=>{f||(f=!0,l&&l(_))};return new ReadableStream({async pull(_){try{const{done:w,value:x}=await d.next();if(w)return y(),void _.close();let A=x.byteLength;if(s){let I=m+=A;s(I)}_.enqueue(new Uint8Array(x))}catch(w){throw y(w),w}},cancel:_=>(y(_),d.return())},{highWaterMark:2})};function LH(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function MH(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?LH(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):LH(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const Ax=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",UH=Ax&&typeof ReadableStream=="function",x1e=Ax&&(typeof TextEncoder=="function"?(FH=new TextEncoder,r=>FH.encode(r)):async r=>new Uint8Array(await new Response(r).arrayBuffer()));var FH;const VH=function(r){try{for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return!!r(...s)}catch{return!1}},T1e=UH&&VH(()=>{let r=!1;const a=new Request(as.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!a}),Zk=UH&&VH(()=>We.isReadableStream(new Response("").body)),Ix={stream:Zk&&(r=>r.body)};var BH;Ax&&(BH=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(r=>{!Ix[r]&&(Ix[r]=We.isFunction(BH[r])?a=>a[r]():(a,s)=>{throw new Pn("Response type '".concat(r,"' is not supported"),Pn.ERR_NOT_SUPPORT,s)})}));const C1e=async(r,a)=>{const s=We.toFiniteNumber(r.getContentLength());return s??(async l=>l==null?0:We.isBlob(l)?l.size:We.isSpecCompliantForm(l)?(await new Request(as.origin,{method:"POST",body:l}).arrayBuffer()).byteLength:We.isArrayBufferView(l)||We.isArrayBuffer(l)?l.byteLength:(We.isURLSearchParams(l)&&(l+=""),We.isString(l)?(await x1e(l)).byteLength:void 0))(a)};var R1e=Ax&&(async r=>{let{url:a,method:s,data:l,signal:d,cancelToken:f,timeout:m,onDownloadProgress:y,onUploadProgress:_,responseType:w,headers:x,withCredentials:A="same-origin",fetchOptions:I}=kH(r);w=w?(w+"").toLowerCase():"text";let L,H=_1e([d,f&&f.toAbortSignal()],m);const $=H&&H.unsubscribe&&(()=>{H.unsubscribe()});let G;try{if(_&&T1e&&s!=="get"&&s!=="head"&&(G=await C1e(x,l))!==0){let fe,ue=new Request(a,{method:"POST",body:l,duplex:"half"});if(We.isFormData(l)&&(fe=ue.headers.get("content-type"))&&x.setContentType(fe),ue.body){const[ye,xe]=NH(G,Cx(AH(_)));l=DH(ue.body,65536,ye,xe)}}We.isString(A)||(A=A?"include":"omit");const ne="credentials"in Request.prototype;L=new Request(a,MH(MH({},I),{},{signal:H,method:s.toUpperCase(),headers:x.normalize().toJSON(),body:l,duplex:"half",credentials:ne?A:void 0}));let te=await fetch(L);const ce=Zk&&(w==="stream"||w==="response");if(Zk&&(y||ce&&$)){const fe={};["status","statusText","headers"].forEach(Ae=>{fe[Ae]=te[Ae]});const ue=We.toFiniteNumber(te.headers.get("content-length")),[ye,xe]=y&&NH(ue,Cx(AH(y),!0))||[];te=new Response(DH(te.body,65536,ye,()=>{xe&&xe(),$&&$()}),fe)}w=w||"text";let pe=await Ix[We.findKey(Ix,w)||"text"](te,r);return!ce&&$&&$(),await new Ge((fe,ue)=>{RH(fe,ue,{data:pe,headers:tl.from(te.headers),status:te.status,statusText:te.statusText,config:r,request:L})})}catch(ne){throw $&&$(),ne&&ne.name==="TypeError"&&/Load failed|fetch/i.test(ne.message)?Object.assign(new Pn("Network Error",Pn.ERR_NETWORK,r,L),{cause:ne.cause||ne}):Pn.from(ne,ne&&ne.code,r,L)}});const Qk={http:null,xhr:y1e,fetch:R1e};We.forEach(Qk,(r,a)=>{if(r){try{Object.defineProperty(r,"name",{value:a})}catch{}Object.defineProperty(r,"adapterName",{value:a})}});const $H=r=>"- ".concat(r),N1e=r=>We.isFunction(r)||r===null||r===!1;var WH={getAdapter:r=>{r=We.isArray(r)?r:[r];const{length:a}=r;let s,l;const d={};for(let f=0;f<a;f++){let m;if(s=r[f],l=s,!N1e(s)&&(l=Qk[(m=String(s)).toLowerCase()],l===void 0))throw new Pn("Unknown adapter '".concat(m,"'"));if(l)break;d[m||"#"+f]=l}if(!l){const f=Object.entries(d).map(m=>{let[y,_]=m;return"adapter ".concat(y," ")+(_===!1?"is not supported by the environment":"is not available in the build")});throw new Pn("There is no suitable adapter to dispatch the request "+(a?f.length>1?`since :
`+f.map($H).join(`
`):" "+$H(f[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return l},adapters:Qk};function ej(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new mg(null,r)}function GH(r){return ej(r),r.headers=tl.from(r.headers),r.data=Kk.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),WH.getAdapter(r.adapter||Hk.adapter)(r).then(function(a){return ej(r),a.data=Kk.call(r,r.transformResponse,a),a.headers=tl.from(a.headers),a},function(a){return CH(a)||(ej(r),a&&a.response&&(a.response.data=Kk.call(r,r.transformResponse,a.response),a.response.headers=tl.from(a.response.headers))),Ge.reject(a)})}const HH="1.9.0",Ox={};["object","boolean","number","function","string","symbol"].forEach((r,a)=>{Ox[r]=function(s){return typeof s===r||"a"+(a<1?"n ":" ")+r}});const zH={};Ox.transitional=function(r,a,s){function l(d,f){return"[Axios v"+HH+"] Transitional option '"+d+"'"+f+(s?". "+s:"")}return(d,f,m)=>{if(r===!1)throw new Pn(l(f," has been removed"+(a?" in "+a:"")),Pn.ERR_DEPRECATED);return a&&!zH[f]&&(zH[f]=!0,console.warn(l(f," has been deprecated since v"+a+" and will be removed in the near future"))),!r||r(d,f,m)}},Ox.spelling=function(r){return(a,s)=>(console.warn("".concat(s," is likely a misspelling of ").concat(r)),!0)};var Px={assertOptions:function(r,a,s){if(typeof r!="object")throw new Pn("options must be an object",Pn.ERR_BAD_OPTION_VALUE);const l=Object.keys(r);let d=l.length;for(;d-- >0;){const f=l[d],m=a[f];if(m){const y=r[f],_=y===void 0||m(y,f,r);if(_!==!0)throw new Pn("option "+f+" must be "+_,Pn.ERR_BAD_OPTION_VALUE)}else if(s!==!0)throw new Pn("Unknown option "+f,Pn.ERR_BAD_OPTION)}},validators:Ox};const Ql=Px.validators;let kx=class{constructor(r){this.defaults=r||{},this.interceptors={request:new XW,response:new XW}}async request(r,a){try{return await this._request(r,a)}catch(s){if(s instanceof Error){let l={};Error.captureStackTrace?Error.captureStackTrace(l):l=new Error;const d=l.stack?l.stack.replace(/^.+\n/,""):"";try{s.stack?d&&!String(s.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+d):s.stack=d}catch{}}throw s}}_request(r,a){typeof r=="string"?(a=a||{}).url=r:a=r||{},a=rp(this.defaults,a);const{transitional:s,paramsSerializer:l,headers:d}=a;s!==void 0&&Px.assertOptions(s,{silentJSONParsing:Ql.transitional(Ql.boolean),forcedJSONParsing:Ql.transitional(Ql.boolean),clarifyTimeoutError:Ql.transitional(Ql.boolean)},!1),l!=null&&(We.isFunction(l)?a.paramsSerializer={serialize:l}:Px.assertOptions(l,{encode:Ql.function,serialize:Ql.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),Px.assertOptions(a,{baseUrl:Ql.spelling("baseURL"),withXsrfToken:Ql.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let f=d&&We.merge(d.common,d[a.method]);d&&We.forEach(["delete","get","head","post","put","patch","common"],L=>{delete d[L]}),a.headers=tl.concat(f,d);const m=[];let y=!0;this.interceptors.request.forEach(function(L){typeof L.runWhen=="function"&&L.runWhen(a)===!1||(y=y&&L.synchronous,m.unshift(L.fulfilled,L.rejected))});const _=[];let w;this.interceptors.response.forEach(function(L){_.push(L.fulfilled,L.rejected)});let x,A=0;if(!y){const L=[GH.bind(this),void 0];for(L.unshift.apply(L,m),L.push.apply(L,_),x=L.length,w=Ge.resolve(a);A<x;)w=w.then(L[A++],L[A++]);return w}x=m.length;let I=a;for(A=0;A<x;){const L=m[A++],H=m[A++];try{I=L(I)}catch($){H.call(this,$);break}}try{w=GH.call(this,I)}catch(L){return Ge.reject(L)}for(A=0,x=_.length;A<x;)w=w.then(_[A++],_[A++]);return w}getUri(r){return YW(IH((r=rp(this.defaults,r)).baseURL,r.url,r.allowAbsoluteUrls),r.params,r.paramsSerializer)}};We.forEach(["delete","get","head","options"],function(r){kx.prototype[r]=function(a,s){return this.request(rp(s||{},{method:r,url:a,data:(s||{}).data}))}}),We.forEach(["post","put","patch"],function(r){function a(s){return function(l,d,f){return this.request(rp(f||{},{method:r,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:d}))}}kx.prototype[r]=a(),kx.prototype[r+"Form"]=a(!0)});var jx=kx;class tj{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Ge(function(d){s=d});const l=this;this.promise.then(d=>{if(!l._listeners)return;let f=l._listeners.length;for(;f-- >0;)l._listeners[f](d);l._listeners=null}),this.promise.then=d=>{let f;const m=new Ge(y=>{l.subscribe(y),f=y}).then(d);return m.cancel=function(){l.unsubscribe(f)},m},a(function(d,f,m){l.reason||(l.reason=new mg(d,f,m),s(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){this.reason?a(this.reason):this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const s=this._listeners.indexOf(a);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const a=new AbortController,s=l=>{a.abort(l)};return this.subscribe(s),a.signal.unsubscribe=()=>this.unsubscribe(s),a.signal}static source(){let a;return{token:new tj(function(l){a=l}),cancel:a}}}var A1e=tj;const nj={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(nj).forEach(r=>{let[a,s]=r;nj[s]=a});var I1e=nj;const sa=function r(a){const s=new jx(a),l=PW(jx.prototype.request,s);return We.extend(l,jx.prototype,s,{allOwnKeys:!0}),We.extend(l,s,null,{allOwnKeys:!0}),l.create=function(d){return r(rp(a,d))},l}(Hk);sa.Axios=jx,sa.CanceledError=mg,sa.CancelToken=A1e,sa.isCancel=CH,sa.VERSION=HH,sa.toFormData=fx,sa.AxiosError=Pn,sa.Cancel=sa.CanceledError,sa.all=function(r){return Ge.all(r)},sa.spread=function(r){return function(a){return r.apply(null,a)}},sa.isAxiosError=function(r){return We.isObject(r)&&r.isAxiosError===!0},sa.mergeConfig=rp,sa.AxiosHeaders=tl,sa.formToJSON=r=>xH(We.isHTMLForm(r)?new FormData(r):r),sa.getAdapter=WH.getAdapter,sa.HttpStatusCode=I1e,sa.default=sa;var Ka=sa;const O1e=()=>{};function rb(){const r={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:O1e};return r.promise=new Ge((a,s)=>{r.resolve=l=>{r.isFinished||(r.isResolved=!0,r.isFinished=!0,a(l),r.value=l)},r.reject=l=>{r.isFinished||(r.isRejected=!0,r.isFinished=!0,s(l))}}),r}const Dx=new Map,Lx=new Map,eu=new Map;let oi=function(r){return r.WIN_10="Windows 10",r.WIN_81="Windows 8.1",r.WIN_8="Windows 8",r.WIN_7="Windows 7",r.WIN_VISTA="Windows Vista",r.WIN_SERVER_2003="Windows Server 2003",r.WIN_XP="Windows XP",r.WIN_2000="Windows 2000",r.ANDROID="Android",r.HARMONY_OS="HarmonyOS",r.OPEN_BSD="Open BSD",r.SUN_OS="Sun OS",r.LINUX="Linux",r.IOS="iOS",r.MAC_OS="Mac OS",r.CHROMIUM_OS="Chromium OS",r.QNX="QNX",r.UNIX="UNIX",r.BEOS="BeOS",r.OS_2="OS/2",r.SEARCH_BOT="Search Bot",r}({}),pn=function(r){return r.CHROME="Chrome",r.SAFARI="Safari",r.EDGE="Edge",r.FIREFOX="Firefox",r.OPERA="OPR",r.QQ="QQBrowser",r.WECHAT="MicroMessenger",r}({});const KH=new oRe;let nl=KH.getResult(),rj=null;function sn(r){if(!rj){nl=KH.getResult();const a=function(y){if(y.engine.name==="Blink"&&y.browser.name!=="WeChat")return pn.CHROME;switch(y.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return pn.CHROME;case"Safari":case"Mobile Safari":return pn.SAFARI;case"Edge":return pn.EDGE;case"Firefox":return pn.FIREFOX;case"QQ":case"QQBrowser":return pn.QQ;case"Opera":return pn.OPERA;case"WeChat":return pn.WECHAT;default:return y.browser.name||""}}(nl),s=qH(nl),l=function(y){return y.os.name==="Windows"?y.os.version?y.os.name+" "+y.os.version:y.os.name:y.os.name||""}(nl),d=nl.os.version,f=qH(nl,!1),m=nl.device.type;if(!(a&&s&&l&&d))return{name:a,version:s,os:l,osVersion:d,browserVersion:f,deviceType:m};rj={name:a,version:s,os:l,osVersion:d,browserVersion:f,deviceType:m}}return rj}function qH(r){let a,s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return a=r.engine.name==="Blink"?r.engine.version||"":r.browser.version||"",s?a.split(".")[0]:a}function Mx(){return sn().os}function YH(){const r=sn();return"".concat(r.os," ").concat(r.osVersion)}function Ux(){const r=sn();return!!(nl.engine.name==="WebKit"&&r.os===oi.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&r.name!==pn.SAFARI||oa()&&r.name!==pn.SAFARI)}function rd(){return sn().name===pn.CHROME}function ji(){return sn().name===pn.SAFARI}function XH(){const r=sn();if(r.name!==pn.SAFARI||!r.browserVersion)return!1;const a=r.browserVersion.split(".");return Number(a[0])>15||Number(a[0])===15&&Number(a[1])>=4}function JH(){return sn().name===pn.EDGE}function dr(){return sn().name===pn.FIREFOX}function oa(){return sn().os===oi.IOS}function gg(r){const a=sn();return!(a.name!==pn.CHROME||!a.osVersion)&&Number(a.version)>=r}function ZH(r){const a=sn();return!(a.name!==pn.CHROME||!a.osVersion)&&Number(a.version)<r}function ij(r,a,s){const l=sn();return!(l.name!==r||!l.osVersion)&&(s?Number(l.version)>=a&&Number(l.version)<=s:Number(l.version)===a)}function aj(r){const a=sn();return!(a.name!==pn.EDGE||!a.osVersion)&&Number(a.version)>=r}function sj(r){const a=sn();return!(a.name!==pn.FIREFOX||!a.osVersion)&&Number(a.version)>=r}function QH(r){const a=sn();return!(a.name!==pn.SAFARI||!a.osVersion)&&Number(a.version)>=r}function ez(r,a,s){const l=sn();if(l.os!==oi.IOS||!l.osVersion)return!1;const d=l.osVersion.split(".");return s?a&&Number(d[0])===r&&Number(d[1])>a||Number(d[0])>r:a?Number(d[0])===r&&Number(d[1])>=a||Number(d[0])>r:Number(d[0])>=r}function tz(r,a,s){const l=sn();if(l.os!==oi.IOS||!l.osVersion)return!1;const d=l.osVersion.split(".");return a&&Number(d[0])===r&&Number(d[1])<a||Number(d[0])<r}function oj(r,a,s){const l=sn();if(l.name!==pn.SAFARI||!l.osVersion||!l.browserVersion)return!1;const d=l.browserVersion.split(".");return s?a&&Number(d[0])===r&&Number(d[1])<a||Number(d[0])<r:a?Number(d[0])===r&&Number(d[1])<=a||Number(d[0])<r:Number(d[0])<=r}function cj(r){const a=sn();return!(a.name!==pn.OPERA||!a.osVersion)&&Number(a.version)>=r}function nz(){const r=sn();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])<14||Number(a[0])===14&&Number(a[1])<=6}function vg(){const r=sn();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])===15}function lj(){const r=sn();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])===16}function rz(){const r=sn();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])===15&&Number(a[1])>=1}function fc(){return ji()&&navigator.maxTouchPoints>0}function iz(){return sn().name===pn.WECHAT}function az(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function uj(){const r=Mx();return function(){const{deviceType:a}=sn();return a==="mobile"||a==="tablet"}()||r===oi.ANDROID||r===oi.IOS||r===oi.HARMONY_OS}function id(){const r=sn();return r.name!==pn.EDGE&&r.name!==pn.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Fx(){return Mx()===oi.ANDROID}function ib(){const r=sn();return Fx()&&(r.name===pn.CHROME||r.name===pn.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function Pt(r,a,s){return(a=function(l){var d=function(f,m){if(typeof f!="object"||!f)return f;var y=f[Symbol.toPrimitive];if(y!==void 0){var _=y.call(f,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(l);return typeof d=="symbol"?d:d+""}(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}function sz(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Me(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?sz(Object(s),!0).forEach(function(l){Pt(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):sz(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let ie=function(r){return r.UNEXPECTED_ERROR="UNEXPECTED_ERROR",r.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",r.TIMEOUT="TIMEOUT",r.INVALID_PARAMS="INVALID_PARAMS",r.NOT_READABLE="NOT_READABLE",r.NOT_SUPPORTED="NOT_SUPPORTED",r.INVALID_OPERATION="INVALID_OPERATION",r.OPERATION_ABORTED="OPERATION_ABORTED",r.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",r.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",r.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",r.DATACHANNEL_FAILED="DATACHANNEL_FAILED",r.NETWORK_ERROR="NETWORK_ERROR",r.NETWORK_TIMEOUT="NETWORK_TIMEOUT",r.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",r.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",r.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",r.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",r.ELECTRON_IS_NULL="ELECTRON_IS_NULL",r.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",r.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",r.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",r.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",r.PERMISSION_DENIED="PERMISSION_DENIED",r.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",r.TRACK_IS_DISABLED="TRACK_IS_DISABLED",r.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",r.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",r.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",r.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",r.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",r.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",r.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",r.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",r.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",r.UID_CONFLICT="UID_CONFLICT",r.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",r.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",r.TOKEN_EXPIRE="TOKEN_EXPIRE",r.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",r.INVALID_TRACK="INVALID_TRACK",r.SENDER_NOT_FOUND="SENDER_NOT_FOUND",r.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",r.SET_ANSWER_FAILED="SET_ANSWER_FAILED",r.ICE_FAILED="ICE_FAILED",r.PC_CLOSED="PC_CLOSED",r.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",r.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",r.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",r.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",r.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",r.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",r.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",r.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",r.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",r.INVALID_REMOTE_USER="INVALID_REMOTE_USER",r.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",r.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",r.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",r.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",r.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",r.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",r.WS_ABORT="WS_ABORT",r.WS_DISCONNECT="WS_DISCONNECT",r.WS_ERR="WS_ERR",r.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",r.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",r.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",r.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",r.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",r.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",r.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",r.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",r.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",r.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",r.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",r.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",r.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",r.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",r.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",r.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",r.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",r.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",r.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",r.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",r.INVALID_PLUGIN="INVALID_PLUGIN",r.DISCONNECT_P2P="DISCONNECT_P2P",r.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",r.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",r.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",r.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",r.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",r.PROHIBITED_OPERATION="PROHIBITED_OPERATION",r.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",r.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",r}({}),Se=class extends Error{constructor(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;super(a),Pt(this,"code",void 0),Pt(this,"message",void 0),Pt(this,"data",void 0),Pt(this,"name","AgoraRTCException"),this.code=r,this.message="AgoraRTCError ".concat(this.code,": ").concat(a),this.data=s}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",a=arguments.length>1?arguments[1]:void 0;return r==="error"&&(a||console).error(this.toString()),r==="warning"&&(a||console).warn(this.toString()),this}throw(r){throw this.print("error",r),this}};function rl(r,a){if(typeof r!="boolean")throw new Se(ie.INVALID_PARAMS,"Invalid ".concat(a,": The value is of the boolean type."))}function ni(r,a,s){if(!Ve(s).call(s,r))throw new Se(ie.INVALID_PARAMS,"".concat(a," can only be set as ").concat(JSON.stringify(s)))}function kn(r,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(r<s||r>l||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(d){return typeof d=="number"&&d%1==0}(r))throw new Se(ie.INVALID_PARAMS,"invalid ".concat(a,": the value range is [").concat(s,", ").concat(l,"]. integer only"))}function dj(r,a){if(typeof r!="number"){if(!(r.min||r.max||r.ideal||r.exact))throw new Se(ie.INVALID_PARAMS,"".concat(a," is not a valid ConstrainLong"));r.min!==void 0&&kn(r.min,"".concat(a,".min"),0,1/0),r.max!==void 0&&kn(r.max,"".concat(a,".max"),1,1/0),r.exact!==void 0&&kn(r.exact,"".concat(a,".exact"),1,1/0),r.ideal!==void 0&&kn(r.ideal,"".concat(a,".ideal"),1,1/0)}else kn(r,a,1,1/0)}function Ti(r,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,d=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(r==null)throw new Se(ie.INVALID_PARAMS,"".concat(a||"param"," cannot be empty"));if(!oz(r,s,l,d))throw new Se(ie.INVALID_PARAMS,"Invalid ".concat(a||"string param",": Length of the string: [").concat(s,",").concat(l,"].").concat(d?" ASCII characters only.":""))}function ad(r,a){if(!Array.isArray(r))throw new Se(ie.INVALID_PARAMS,"".concat(a," should be an array"))}function hr(r){return r==null}function oz(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,l=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof r=="string"&&r.length<=s&&r.length>=a&&(!l||function(d){if(typeof d!="string")return!1;for(let f=0;f<d.length;f+=1){const m=d.charCodeAt(f);if(m<0||m>255)return!1}return!0}(r))}var ab=function(r){return r.COVERED="COVERED",r.POSITION="POSITION",r.SIZE="SIZE",r.STYLE="STYLE",r}(ab||{}),hj=function(r){return r.UNMOUNTED="UNMOUNTED",r.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",r}(hj||{});const cz=new class{constructor(){Pt(this,"_clientSize",null),Pt(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),Pt(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),Pt(this,"getStyle",r=>window.getComputedStyle(r,null)),Pt(this,"checkCssVisibleProperty",r=>{var a;let s=!0;const l=this.getStyle(r),{display:d,visibility:f,opacity:m,filter:y}=l;return(d==="none"||Ve(a=["hidden","collapse"]).call(a,f)||Number(m)<.1)&&(s=!1),!!s&&(y&&y.split(" ").filter(_=>{var w;const x=_.split("(")[0];return Ve(w=["brightness","blur","opacity"]).call(w,x)}).map(_=>{const[w,x]=_.split(/\(|\)/);return[w,Number(x.match(/^[0-9\.]+/))]}).forEach(_=>{const[w,x]=_;switch(w){case"brightness":(x<.1||x>3)&&(s=!1);break;case"blur":x>3&&(s=!1);break;case"opacity":x<.1&&(s=!1)}}),s)}),Pt(this,"checkPropertyUpToAllParentNodes",(r,a)=>{let s=!0,l=!0;const d=m=>a(m);let f=r;for(;f&&l;)d(f)||(s=!1,l=!1),f=f.parentElement,f||(l=!1);return s}),Pt(this,"checkActualCssVisibleIncludeInherit",r=>this.checkPropertyUpToAllParentNodes(r,this.checkCssVisibleProperty)),Pt(this,"getSizeAboutClient",r=>{const{width:a,height:s,left:l,right:d,top:f,bottom:m}=r.getBoundingClientRect(),y=this.getClientWidth(),_=this.getClientHeight();return{width:a,height:s,left:l,right:d,top:f,bottom:m,clientWidth:y,clientHeight:_,clientMin:Math.min(y,_)}}),Pt(this,"checkActualSize",()=>{const{width:r,height:a,clientMin:s}=this._clientSize;return this.checkSizeIsVisible(r,a,s)}),Pt(this,"elementFromPoint",(r,a)=>document.elementFromPoint?document.elementFromPoint(r,a):null),Pt(this,"checkCoverForAPoint",(r,a,s)=>{const l=this.elementFromPoint(r,a);return l!==null&&l!==s}),Pt(this,"getPointPositionList",()=>{const{width:r,height:a,left:s,top:l}=this._clientSize,d=r/6,f=a/6,m=[],y=10**6;for(let _=0;_<5;_++)for(let w=0;w<5;w++){const x=(s*y+(_===0?.1:_===4?(d*_*y-1e5)/y:d*_)*y)/y,A=(l*y+(w===0?.1:w===4?(f*w*y-1e5)/y:f*w)*y)/y;m.push({x,y:A})}return[...m]}),Pt(this,"checkElementCover",r=>this.getPointPositionList().map(a=>this.checkCoverForAPoint(a.x,a.y,r)).filter(a=>!!a).length>6),Pt(this,"checkSizeIsVisible",(r,a,s)=>(r>50||s/r<=10)&&(a>50||s/a<=10)),Pt(this,"checkSizeOfPartInClient",()=>{const{left:r,right:a,top:s,bottom:l,clientHeight:d,clientWidth:f,clientMin:m}=this._clientSize;let y,_,w,x;if(r<0)y=0;else{if(!(r<f))return!1;y=r}if(a<0)return!1;if(_=a<f?a:f,s<0)w=0;else{if(!(s<d))return!1;w=s}if(l<0)return!1;x=l<d?l:d;const A=_-y,I=x-w;return this.checkSizeIsVisible(A,I,m)}),Pt(this,"returnHiddenResult",r=>(this._clientSize=null,{visible:!1,reason:r})),Pt(this,"checkOneElementVisible",r=>{if(r instanceof HTMLElement){if(this.checkElementIsMountedOnDom(r)){if(this.checkActualCssVisibleIncludeInherit(r)){if(this._clientSize=this.getSizeAboutClient(r),this.checkElementCover(r))return this.returnHiddenResult(ab.COVERED);{const a=this.checkActualSize(),s=this.checkSizeOfPartInClient();return a&&!s?this.returnHiddenResult(ab.POSITION):a?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(ab.SIZE)}}return this.returnHiddenResult(ab.STYLE)}return this.returnHiddenResult(hj.UNMOUNTED)}return this.returnHiddenResult(hj.INVALID_HTML_ELEMENT)}),Pt(this,"checkElementIsMountedOnDom",r=>this.checkPropertyUpToAllParentNodes(r,a=>a.nodeName.toUpperCase()!=="HTML"?a.parentElement!==null:!!document.documentElement))}};function fj(r){return new TextEncoder().encode(r)}const lz=function(r,a){const s=new Uint8Array(r.byteLength+a.byteLength);return s.set(new Uint8Array(r),0),s.set(new Uint8Array(a),r.byteLength),s},pj=async r=>function(a,s){let l="";return new Uint8Array(a).forEach(d=>{l+=d.toString(s).padStart(2,"0")}),l}(await crypto.subtle.digest("SHA-256",fj(r)),16);class lr{constructor(){Pt(this,"_events",{}),Pt(this,"addListener",this.on)}getListeners(a){return this._events[a]?this._events[a].map(s=>s.listener):[]}on(a,s){this._events[a]||(this._events[a]=[]);const l=this._events[a];this._indexOfListener(l,s)===-1&&l.push({listener:s,once:!1})}once(a,s){this._events[a]||(this._events[a]=[]);const l=this._events[a];this._indexOfListener(l,s)===-1&&l.push({listener:s,once:!0})}off(a,s){if(!this._events[a])return;const l=this._events[a],d=this._indexOfListener(l,s);d!==-1&&l.splice(d,1),this._events[a].length===0&&delete this._events[a]}removeAllListeners(a){a?delete this._events[a]:this._events={}}emit(a){this._events[a]||(this._events[a]=[]);const s=this._events[a].map(m=>m);for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];for(let m=0;m<s.length;m+=1){const y=s[m];y.once&&this.off(a,y.listener),y.listener.apply(this,d||[])}}safeEmit(a){for(var s=arguments.length,l=new Array(s>1?s-1:0),d=1;d<s;d++)l[d-1]=arguments[d];[...this._events[a]||[]].forEach(f=>{f.once&&this.off(a,f.listener);try{f.listener.apply(this,l)}catch(m){console.error("safeEmit event:".concat(a," error ").concat(m==null?void 0:m.toString()))}})}_indexOfListener(a,s){let l=a.length;for(;l--;)if(a[l].listener===s)return l;return-1}}let sb=null;function uz(){if(sb)return sb;if(window.electron)return sb=window.electron;if(!window.require)return null;try{return sb=window.require("electron"),sb}catch{return null}}let Er=function(r){return r.CREATE_CLIENT="createClient",r.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",r.SET_AREA="setArea",r.PRELOAD="PRELOAD",r.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",r.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",r.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",r.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",r.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",r.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",r.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",r.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",r.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",r.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",r.START_PROXY_SERVER="Client.startProxyServer",r.STOP_PROXY_SERVER="Client.stopProxyServer",r.SET_PROXY_SERVER="Client.setProxyServer",r.SET_TURN_SERVER="Client.setTurnServer",r.SET_CLIENT_ROLE="Client.setClientRole",r.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",r.ENABLE_DUAL_STREAM="Client.enableDualStream",r.DISABLE_DUAL_STREAM="Client.disableDualStream",r.JOIN="Client.join",r.LEAVE="Client.leave",r.PUBLISH="Client.publish",r.UNPUBLISH="Client.unpublish",r.SUBSCRIBE="Client.subscribe",r.MASS_SUBSCRIBE="Client.massSubscribe",r.MASS_UNSUBSCRIBE="Client.massUnsubscribe",r.UNSUBSCRIBE="Client.unsubscribe",r.RENEW_TOKEN="Client.renewToken",r.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",r.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",r.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",r.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",r.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",r.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",r.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",r.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",r.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",r.START_LIVE_STREAMING="Client.startLiveStreaming",r.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",r.STOP_LIVE_STREAMING="Client.stopLiveStreaming",r.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",r.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",r.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",r.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",r.SET_CONFIG_DISTRIBUTE="_configDistribute",r.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",r.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",r.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",r.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",r.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",r.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",r.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",r.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",r.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",r.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",r.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",r.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",r.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",r.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",r.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",r.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",r.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",r.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",r.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",r.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",r.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",r.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",r.STREAM_TYPE_CHANGE="streamTypeChange",r.CONNECTION_STATE_CHANGE="connectionStateChange",r.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",r.IMAGE_MODERATION_UPLOAD="imageModerationUpload",r.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",r.PRELOAD_MEDIA_FAILED="preloadMediaFailed",r.MISMATCH_DTLS_PARAMETERS="mismatchDtlsParameters",r}({}),rr=function(r){return r.TRACER="tracer",r}({});function dz(r){return kn(r.timeout,"config.timeout",0,1e5),kn(r.timeoutFactor,"config.timeoutFactor",0,100,!1),kn(r.maxRetryCount,"config.maxRetryConfig",0,1/0),kn(r.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let P1e=function(r){return r[r.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",r[r.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",r[r.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",r}({}),En=function(r){return r.LEAVE="LEAVE",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.UID_BANNED="UID_BANNED",r.FALLBACK="FALLBACK",r.IP_BANNED="IP_BANNED",r.CHANNEL_BANNED="CHANNEL_BANNED",r.LICENSE_MISSING="LICENSE_MISSING",r.LICENSE_EXPIRED="LICENSE_EXPIRED",r.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",r.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",r.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",r.LICENSE_ILLEGAL="LICENSE_ILLEGAL",r.TOKEN_EXPIRE="TOKEN_EXPIRE",r}({});function ob(r){if(!Array.isArray(r)||r.length<1)return!1;try{r.forEach(a=>{if(!a.urls)throw Error()})}catch{return!1}return!0}function hz(r){return Ti(r.turnServerURL,"turnServerURL"),Ti(r.username,"username"),Ti(r.password,"password"),r.udpport&&kn(r.udpport,"udpport",1,99999,!0),r.forceturn&&rl(r.forceturn,"forceturn"),r.security&&rl(r.security,"security"),r.tcpport&&kn(r.tcpport,"tcpport",1,99999,!0),!0}function mj(r){return r.level!==void 0&&ni(r.level,"level",[1,2,3]),r.delay!==void 0&&kn(r.delay,"delay",0,3e3,!0),!0}let Qt=function(r){return r.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",r.AUDIO_METADATA="audio-metadata",r.AUDIO_PTS="audio-pts",r.CONNECTION_STATE_CHANGE="connection-state-change",r.MEDIA_RECONNECT_START="media-reconnect-start",r.MEDIA_RECONNECT_END="media-reconnect-end",r.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",r.USER_JOINED="user-joined",r.USER_LEAVED="user-left",r.USER_PUBLISHED="user-published",r.USER_UNPUBLISHED="user-unpublished",r.USER_INFO_UPDATED="user-info-updated",r.CLIENT_BANNED="client-banned",r.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",r.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",r.VOLUME_INDICATOR="volume-indicator",r.CRYPT_ERROR="crypt-error",r.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",r.NETWORK_QUALITY="network-quality",r.STREAM_TYPE_CHANGED="stream-type-changed",r.STREAM_FALLBACK="stream-fallback",r.RECEIVE_METADATA="receive-metadata",r.STREAM_MESSAGE="stream-message",r.LIVE_STREAMING_ERROR="live-streaming-error",r.LIVE_STREAMING_WARNING="live-streaming-warning",r.EXCEPTION="exception",r.ERROR="error",r.P2P_LOST="p2p_lost",r.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",r.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",r.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",r.PUBLISHED_USER_LIST="published-user-list",r.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",r.CONTENT_INSPECT_ERROR="content-inspect-error",r.CONTENT_INSPECT_RESULT="content-inspect-result",r.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",r}({}),Di=function(r){return r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.MULTI_IP="MULTI_IP",r.TIMEOUT="TIMEOUT",r.OFFLINE="OFFLINE",r.LEAVE="LEAVE",r.P2P_FAILED="P2P_FAILED",r.FALLBACK="FALLBACK",r.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",r}({}),Is=function(r){return r.ONLINE="ONLINE",r.OFFLINE="OFFLINE",r}({}),yg=function(r){return r.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",r.ONLINE="ONLINE",r.OFFLINE="OFFLINE",r}({});function Li(r,a){for(var s=arguments.length,l=new Array(s>2?s-2:0),d=2;d<s;d++)l[d-2]=arguments[d];return r.getListeners(a).length===0?Ge.reject(new Se(ie.UNEXPECTED_ERROR,"can not emit promise")):new Ge((f,m)=>{r.emit(a,...l,f,m)})}function Ln(r,a){if(r.getListeners(a).length===0)return Ge.resolve();for(var s=arguments.length,l=new Array(s>2?s-2:0),d=2;d<s;d++)l[d-2]=arguments[d];return Li(r,a,...l)}function Xs(r,a){if(r.getListeners(a).length===0)return null;for(var s=arguments.length,l=new Array(s>2?s-2:0),d=2;d<s;d++)l[d-2]=arguments[d];return cb(r,a,...l)}function cb(r,a){let s=null,l=null;for(var d=arguments.length,f=new Array(d>2?d-2:0),m=2;m<d;m++)f[m-2]=arguments[m];if(r.emit(a,...f,y=>{s=y},y=>{l=y}),l!==null)throw l;if(s===null)throw new Se(ie.UNEXPECTED_ERROR,"handler is not sync");return s}const Dr=new class extends lr{set networkState(r){this.emit(yg.NETWORK_STATE_CHANGE,r,this._networkState),r===Is.ONLINE?this.emit(yg.ONLINE):r===Is.OFFLINE&&(this.onlineWaiter=new Ge(a=>{this.once(yg.ONLINE,()=>{this.onlineWaiter=void 0,a(Is.ONLINE)})}),this.emit(yg.OFFLINE)),this._networkState=r}get networkState(){return this._networkState}get isOnline(){return this._networkState===Is.ONLINE}constructor(){super(),Pt(this,"_moduleName","network-indicator"),Pt(this,"_networkState",Is.ONLINE),Pt(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Is.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Is.OFFLINE})}};function Vx(r,a){const s=r.indexOf(a);s!==-1&&r.splice(s,1)}function _g(r){const a=[];return r.forEach(s=>{a.indexOf(s)===-1&&a.push(s)}),a}function Bx(r){Ge!==void 0?Ge.resolve().then(r):setTimeout(r,0)}function ir(r){return JSON.parse(JSON.stringify(r))}function ip(r){try{return ir(r)}catch{return r}}const fz={};function hh(r,a){fz[a]||(fz[a]=!0,r())}function ap(r){const a=window.atob(r),s=new Uint8Array(new ArrayBuffer(a.length));for(let l=0;l<a.length;l+=1)s[l]=a.charCodeAt(l);return s}function fh(r){let a="";for(let s=0;s<r.length;s+=1)a+=String.fromCharCode(r[s]);return window.btoa(a)}function pz(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,s=new TextEncoder().encode(r);if(s.length>a)s=s.slice(0,a);else if(s.length<a){const l=new Uint8Array(a);l.set(s),s=l}return s}function mz(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=sc(a).call(a,(m,y)=>m+y.length,0),d=new Uint8Array(new ArrayBuffer(l));let f=0;return a.forEach(m=>{d.set(m,f),f+=m.length}),d}function tu(r){return window.TextEncoder?new TextEncoder().encode(r).length:r.length}function gz(r){let a=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&r.realFormData&&(r=r.realFormData),r.forEach(s=>{a+=typeof s=="string"?tu(s):s.size}),a+138}function k1e(r){const a=new Se(ie.TIMEOUT,"timeout");return new Ge((s,l)=>{window.setTimeout(()=>l(a),r)})}function Ci(r){return new Ge(a=>{window.setTimeout(a,r)})}function Mn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,a=arguments.length>1?arguments[1]:void 0;const s=Math.random().toString(16).substr(2,r).toLowerCase();return s.length===r?"".concat(a).concat(s):"".concat(a).concat(s)+Mn(r-s.length,"")}function sp(){return Mn(32,"").toUpperCase()}const $x=()=>{},vz=new class{constructor(){Pt(this,"fnMap",new Map)}throttleByKey(r,a,s,l){for(var d=arguments.length,f=new Array(d>4?d-4:0),m=4;m<d;m++)f[m-4]=arguments[m];if(this.fnMap.has(a)){const y=this.fnMap.get(a);if(y.threshold!==s){y.fn(...y.args),clearTimeout(y.timer);const _=window.setTimeout(()=>{const w=this.fnMap.get(a);w&&w.fn(...w.args),this.fnMap.delete(a)},s);this.fnMap.set(a,{fn:r,threshold:s,timer:_,args:f,skipFn:l})}else y.skipFn&&y.skipFn(...y.args),this.fnMap.set(a,Me(Me({},y),{},{fn:r,args:f,skipFn:l}))}else{const y=window.setTimeout(()=>{const _=this.fnMap.get(a);_&&_.fn(..._.args),this.fnMap.delete(a)},s);this.fnMap.set(a,{fn:r,threshold:s,timer:y,args:f,skipFn:l})}}},yz=vz.throttleByKey.bind(vz);function _z(r){return typeof r=="object"&&r!==null&&!(r instanceof RegExp)}function gj(r,a){if(!_z(r)||!_z(a)||Array.isArray(r)&&!Array.isArray(a)||!Array.isArray(r)&&Array.isArray(a))return a;if(Array.isArray(a)&&Array.isArray(r)){const s=[...r];for(let l=0;l<a.length;l++)s[l]=gj(r[l],a[l]);return s}{const s=Me({},r);for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&(Object.prototype.hasOwnProperty.call(r,l)?s[l]=gj(r[l],a[l]):s[l]=a[l]);return s}}function bz(r,a){let s=[0];if(s=new Array(a).fill(0),r===0)return s;let l=0;for(;r>0&&(s[l]=255&r,r>>=8,l++,l!==a););return s}function bg(r){return typeof r=="number"?r:r.exact||r.ideal||r.max||r.min||0}function vj(r){return sc(r).call(r,(a,s)=>a+s,0)}function Ez(r){const a="0123456789abcdef";function s(ce){let pe,fe="";for(pe=0;pe<=3;pe++)fe+=a.charAt(ce>>8*pe+4&15)+a.charAt(ce>>8*pe&15);return fe}function l(ce,pe){const fe=(65535&ce)+(65535&pe);return(ce>>16)+(pe>>16)+(fe>>16)<<16|65535&fe}function d(ce,pe,fe,ue,ye,xe){return l(function(Ae,Le){return Ae<<Le|Ae>>>32-Le}(l(l(pe,ce),l(ue,xe)),ye),fe)}function f(ce,pe,fe,ue,ye,xe,Ae){return d(pe&fe|~pe&ue,ce,pe,ye,xe,Ae)}function m(ce,pe,fe,ue,ye,xe,Ae){return d(pe&ue|fe&~ue,ce,pe,ye,xe,Ae)}function y(ce,pe,fe,ue,ye,xe,Ae){return d(pe^fe^ue,ce,pe,ye,xe,Ae)}function _(ce,pe,fe,ue,ye,xe,Ae){return d(fe^(pe|~ue),ce,pe,ye,xe,Ae)}const w=function(ce){let pe;const fe=1+(ce.length+8>>6),ue=new Array(16*fe);for(pe=0;pe<16*fe;pe++)ue[pe]=0;for(pe=0;pe<ce.length;pe++)ue[pe>>2]|=ce.charCodeAt(pe)<<pe%4*8;return ue[pe>>2]|=128<<pe%4*8,ue[16*fe-2]=8*ce.length,ue}(r);let x,A,I,L,H,$=1732584193,G=-271733879,ne=-1732584194,te=271733878;for(x=0;x<w.length;x+=16)A=$,I=G,L=ne,H=te,$=f($,G,ne,te,w[x+0],7,-680876936),te=f(te,$,G,ne,w[x+1],12,-389564586),ne=f(ne,te,$,G,w[x+2],17,606105819),G=f(G,ne,te,$,w[x+3],22,-1044525330),$=f($,G,ne,te,w[x+4],7,-176418897),te=f(te,$,G,ne,w[x+5],12,1200080426),ne=f(ne,te,$,G,w[x+6],17,-1473231341),G=f(G,ne,te,$,w[x+7],22,-45705983),$=f($,G,ne,te,w[x+8],7,1770035416),te=f(te,$,G,ne,w[x+9],12,-1958414417),ne=f(ne,te,$,G,w[x+10],17,-42063),G=f(G,ne,te,$,w[x+11],22,-1990404162),$=f($,G,ne,te,w[x+12],7,1804603682),te=f(te,$,G,ne,w[x+13],12,-40341101),ne=f(ne,te,$,G,w[x+14],17,-1502002290),G=f(G,ne,te,$,w[x+15],22,1236535329),$=m($,G,ne,te,w[x+1],5,-165796510),te=m(te,$,G,ne,w[x+6],9,-1069501632),ne=m(ne,te,$,G,w[x+11],14,643717713),G=m(G,ne,te,$,w[x+0],20,-373897302),$=m($,G,ne,te,w[x+5],5,-701558691),te=m(te,$,G,ne,w[x+10],9,38016083),ne=m(ne,te,$,G,w[x+15],14,-660478335),G=m(G,ne,te,$,w[x+4],20,-405537848),$=m($,G,ne,te,w[x+9],5,568446438),te=m(te,$,G,ne,w[x+14],9,-1019803690),ne=m(ne,te,$,G,w[x+3],14,-187363961),G=m(G,ne,te,$,w[x+8],20,1163531501),$=m($,G,ne,te,w[x+13],5,-1444681467),te=m(te,$,G,ne,w[x+2],9,-51403784),ne=m(ne,te,$,G,w[x+7],14,1735328473),G=m(G,ne,te,$,w[x+12],20,-1926607734),$=y($,G,ne,te,w[x+5],4,-378558),te=y(te,$,G,ne,w[x+8],11,-2022574463),ne=y(ne,te,$,G,w[x+11],16,1839030562),G=y(G,ne,te,$,w[x+14],23,-35309556),$=y($,G,ne,te,w[x+1],4,-1530992060),te=y(te,$,G,ne,w[x+4],11,1272893353),ne=y(ne,te,$,G,w[x+7],16,-155497632),G=y(G,ne,te,$,w[x+10],23,-1094730640),$=y($,G,ne,te,w[x+13],4,681279174),te=y(te,$,G,ne,w[x+0],11,-358537222),ne=y(ne,te,$,G,w[x+3],16,-722521979),G=y(G,ne,te,$,w[x+6],23,76029189),$=y($,G,ne,te,w[x+9],4,-640364487),te=y(te,$,G,ne,w[x+12],11,-421815835),ne=y(ne,te,$,G,w[x+15],16,530742520),G=y(G,ne,te,$,w[x+2],23,-995338651),$=_($,G,ne,te,w[x+0],6,-198630844),te=_(te,$,G,ne,w[x+7],10,1126891415),ne=_(ne,te,$,G,w[x+14],15,-1416354905),G=_(G,ne,te,$,w[x+5],21,-57434055),$=_($,G,ne,te,w[x+12],6,1700485571),te=_(te,$,G,ne,w[x+3],10,-1894986606),ne=_(ne,te,$,G,w[x+10],15,-1051523),G=_(G,ne,te,$,w[x+1],21,-2054922799),$=_($,G,ne,te,w[x+8],6,1873313359),te=_(te,$,G,ne,w[x+15],10,-30611744),ne=_(ne,te,$,G,w[x+6],15,-1560198380),G=_(G,ne,te,$,w[x+13],21,1309151649),$=_($,G,ne,te,w[x+4],6,-145523070),te=_(te,$,G,ne,w[x+11],10,-1120210379),ne=_(ne,te,$,G,w[x+2],15,718787259),G=_(G,ne,te,$,w[x+9],21,-343485551),$=l($,A),G=l(G,I),ne=l(ne,L),te=l(te,H);return s($)+s(G)+s(ne)+s(te)}let j1e=1,wz=console,Gi=class{static setLogger(r){wz=r}constructor(r,a){Pt(this,"id",void 0),Pt(this,"lockingPromise",Ge.resolve()),Pt(this,"locks",0),Pt(this,"name",""),Pt(this,"lockId",void 0),this.lockId=j1e++,r&&(this.name=r),a&&(this.id=a),this.logger("created")}logger(r,a){const s=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),l=r==="created"?"is ".concat(r,"."):"is ".concat(r,", current queue ").concat(this.locks,". ").concat(a??"");wz.debug("".concat(s," ").concat(l))}setId(r){this.id=r}get isLocked(){return this.locks>0}lock(r){let a;this.locks+=1,this.logger("locked",r);const s=new Ge(d=>{a=()=>{this.locks-=1,this.logger("unlocked",r),d()}}),l=this.lockingPromise.then(()=>a);return this.lockingPromise=this.lockingPromise.then(()=>s),l}};function Eg(r,a){return function(s,l,d){const f=d.value;if(typeof f!="function")throw new Error("Cannot use mutex on object property.");return d.value=async function(){const m=this[a];if(!m)throw new Error("mutex property key ".concat(a," doesn't exist on ").concat(r));const y=await m.lock("From ".concat(r,".").concat(l));try{for(var _=arguments.length,w=new Array(_),x=0;x<_;x++)w[x]=arguments[x];return await f.apply(this,w)}finally{y()}},d}}const Gr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function yj(r,a){const s=Math.floor(a.timeout*Math.pow(a.timeoutFactor,r));return Math.min(a.maxRetryTimeout,s)}function il(r,a,s,l){const d=Object.assign({},Gr,l);let f=d.timeout;const m=async()=>{await function(w){return new Ge(x=>{window.setTimeout(x,w)})}(f),f*=d.timeoutFactor,f=Math.min(d.maxRetryTimeout,f)};let y=!1;const _=new Ge(async(w,x)=>{a=a||(()=>!1),s=s||(()=>!0);for(let A=0;A<d.maxRetryCount;A+=1){if(y)return x(new Se(ie.OPERATION_ABORTED));try{const I=await r();if(!a(I,A)||A+1===d.maxRetryCount)return w(I);await m()}catch(I){if(!s(I,A)||A+1===d.maxRetryCount)return x(I);await m()}}});return _.cancel=()=>y=!0,_}let Wx,Sz=class{constructor(r){Pt(this,"input",[]),Pt(this,"size",void 0),this.size=r}add(r){this.input.push(r),this.input.length>this.size&&this.input.splice(0,1)}mean(){var r;return this.input.length===0?0:sc(r=this.input).call(r,(a,s)=>a+s)/this.input.length}},Gx=0,_j=0;function bj(r,a,s,l){return new Ge((d,f)=>{a.responseType=a.responseType||"json",a.data&&!s?(a.data=JSON.stringify(a.data),Gx+=tu(a.data)):s&&(a.data.size?Gx+=a.data.size:a.data instanceof FormData?Gx+=gz(a.data):Gx+=tu(JSON.stringify(a.data))),a.headers=a.headers||{},a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.method="POST",a.url=r,Ka.request(a).then(m=>{typeof m.data=="string"?_j+=tu(m.data):m.data instanceof ArrayBuffer||m.data instanceof Uint8Array?_j+=m.data.byteLength:_j+=tu(JSON.stringify(m.data)),d(m.data)}).catch(m=>{Ka.isCancel(m)?f(new Se(ie.OPERATION_ABORTED,"cancel token canceled")):m.code==="ECONNABORTED"?f(new Se(ie.NETWORK_TIMEOUT,m.message)):m.response?f(new Se(ie.NETWORK_RESPONSE_ERROR,m.response.status)):f(new Se(ie.NETWORK_ERROR,m.message))})})}async function D1e(r,a){const s=new Blob([a.data],{type:"buffer"});return await bj(r,Me(Me({},a),{},{data:s,headers:{"Content-Type":"application/octet-stream"}}),!0)}const xz=()=>window.isSecureContext!==void 0;function pc(r){if(Array.isArray(r))return r.map(s=>s);if(!Tz(r))return r;const a={};for(const s in r){const l=r[s];Tz(l)||Array.isArray(l)?a[s]=pc(l):a[s]=l}return a}function Tz(r){return!(typeof r!="object"||Array.isArray(r)||!r)}let Ej=class{constructor(r){Pt(this,"input",[]),Pt(this,"size",void 0),this.size=r}add(r){this.input.push(r),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const nu={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},lb={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:nu,remoteCandidate:nu},updateInterval:0},Cz={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},Rz={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},Nz={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},Az={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let wj=class{constructor(r,a){Pt(this,"onFirstVideoReceived",void 0),Pt(this,"onFirstVideoDecoded",void 0),Pt(this,"onFirstAudioReceived",void 0),Pt(this,"onFirstVideoDecodedTimeout",void 0),Pt(this,"onFirstAudioDecoded",void 0),Pt(this,"onSelectedLocalCandidateChanged",void 0),Pt(this,"onSelectedRemoteCandidateChanged",void 0),Pt(this,"videoIsReady",!1),Pt(this,"videoIsReady2",{}),Pt(this,"pc",void 0),Pt(this,"options",void 0),Pt(this,"intervalTimer",void 0),Pt(this,"stats",pc(lb)),Pt(this,"isFirstVideoReceived",{}),Pt(this,"isFirstVideoDecoded",{}),Pt(this,"isFirstAudioReceived",{}),Pt(this,"isFirstAudioDecoded",{}),Pt(this,"isFirstVideoDecodedTimeout",{}),Pt(this,"lossRateWindowStats",[]),this.pc=r,this.options=a,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new Ge(r=>{r({local:Me({},nu),remote:Me({},nu)})})}setVideoIsReady(r){this.videoIsReady=r}setVideoIsReady2(r,a){this.videoIsReady2[r]=a}getVideoIsReady(r){return this.videoIsReady2[r]||!1}setIsFirstAudioDecoded(r){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(r){this.lossRateWindowStats.push(r),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const a=this.lossRateWindowStats.length,s=["videoSend","audioSend","videoRecv","audioRecv"];let l=0,d=0,f=0,m=0;for(const y of s)r[y].forEach((_,w)=>{if(!this.lossRateWindowStats[a-1][y][w]||!this.lossRateWindowStats[0][y][w])return;const x=this.lossRateWindowStats[a-1][y][w].packets-this.lossRateWindowStats[0][y][w].packets,A=this.lossRateWindowStats[a-1][y][w].packetsLost-this.lossRateWindowStats[0][y][w].packetsLost;y==="videoSend"||y==="audioSend"?(l+=x,f+=A):(d+=x,m+=A),Number.isNaN(x)||Number.isNaN(x)?_.packetLostRate=0:_.packetLostRate=x<=0||A<=0?0:A/(x+A)});r.sendPacketLossRate=l<=0||f<=0?0:f/(l+f),r.recvPacketLossRate=d<=0||m<=0?0:m/(d+m)}},L1e=class extends wj{constructor(){super(...arguments),Pt(this,"_stats",lb),Pt(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const r=await this._getStats(),a=this.statsResponsesToObjects(r);this._stats=pc(lb);const s=a.filter(d=>d.type==="ssrc");this.processSSRCStats(s);const l=a.find(d=>d.type==="VideoBwe");l&&this.processBandwidthStats(l),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(r){this._stats.bitrate={actualEncoded:Number(r.googActualEncBitrate),targetEncoded:Number(r.googTargetEncBitrate),retransmit:Number(r.googRetransmitBitrate),transmit:Number(r.googTransmitBitrate)},this._stats.sendBandwidth=Number(r.googAvailableSendBandwidth)}processSSRCStats(r){r.forEach(a=>{var s;const l=Ve(s=a.id).call(s,"send");switch("".concat(a.mediaType,"_").concat(l?"send":"recv")){case"video_send":{const d=pc(Rz);d.codec=a.googCodecName,d.adaptionChangeReason="none",a.googCpuLimitedResolution&&(d.adaptionChangeReason="cpu"),a.googBandwidthLimitedResolution&&(d.adaptionChangeReason="bandwidth"),d.avgEncodeMs=Number(a.googAvgEncodeMs),d.inputFrame={width:Number(a.googFrameWidthInput)||Number(a.googFrameWidthSent),height:Number(a.googFrameHeightInput)||Number(a.googFrameHeightSent),frameRate:Number(a.googFrameRateInput)},d.sentFrame={width:Number(a.googFrameWidthSent),height:Number(a.googFrameHeightSent),frameRate:Number(a.googFrameRateInput)},d.firsCount=Number(a.googFirReceived),d.nacksCount=Number(a.googNacksReceived),d.plisCount=Number(a.googPlisReceived),d.frameCount=Number(a.framesEncoded),d.bytes=Number(a.bytesSent),d.packets=Number(a.packetsSent),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.rttMs=Number(a.googRtt||0),this._stats.videoSend.push(d),this._stats.rtt=d.rttMs;break}case"video_recv":{const d=pc(Cz),f=this.lastDecodeVideoReceiverStats.get(Number(a.ssrc));if(d.codec=a.googCodecName,d.targetDelayMs=Number(a.googTargetDelayMs),d.renderDelayMs=Number(a.googRenderDelayMs),d.currentDelayMs=Number(a.googCurrentDelayMs),d.minPlayoutDelayMs=Number(a.googMinPlayoutDelayMs),d.decodeMs=Number(a.googDecodeMs),d.maxDecodeMs=Number(a.googMaxDecodeMs),d.receivedFrame={width:Number(a.googFrameWidthReceived),height:Number(a.googFrameHeightReceived),frameRate:Number(a.googFrameRateReceived)},d.decodedFrame={width:Number(a.googFrameWidthReceived),height:Number(a.googFrameHeightReceived),frameRate:Number(a.googFrameRateDecoded)},d.decodeFrameRate=Number(a.googFrameRateDecoded),d.outputFrame={width:Number(a.googFrameWidthReceived),height:Number(a.googFrameHeightReceived),frameRate:Number(a.googFrameRateOutput)},d.jitterBufferMs=Number(a.googJitterBufferMs),d.firsCount=Number(a.googFirsSent),d.nacksCount=Number(a.googNacksSent),d.plisCount=Number(a.googPlisSent),d.framesDecodeCount=Number(a.framesDecoded),d.bytes=Number(a.bytesReceived),d.packets=Number(a.packetsReceived),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.packets>0&&!this.isFirstVideoReceived[d.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(d.ssrc),this.isFirstVideoReceived[d.ssrc]=!0),d.framesDecodeCount>0&&!this.isFirstVideoDecoded[d.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(d.ssrc,d.decodedFrame.width,d.decodedFrame.height),this.isFirstVideoDecoded[d.ssrc]=!0),f){const m=f.stats,y=Date.now()-f.lts;d.framesDecodeFreezeTime=m.framesDecodeFreezeTime,d.framesDecodeInterval=m.framesDecodeInterval,d.framesDecodeCount>m.framesDecodeCount&&this.isFirstVideoDecoded[d.ssrc]?(f.lts=Date.now(),d.framesDecodeInterval=y,d.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(a.ssrc,10))?d.framesDecodeFreezeTime+=d.framesDecodeInterval:this.setVideoIsReady2(parseInt(a.ssrc,10),!0))):d.framesDecodeCount<f.stats.framesDecodeCount&&(d.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(d.ssrc,{stats:Me({},d),lts:Date.now()}),this._stats.videoRecv.push(d);break}case"audio_recv":{const d=pc(Az);d.codec=a.googCodecName,d.outputLevel=Math.abs(Number(a.audioOutputLevel))/32767,d.decodingCNG=Number(a.googDecodingCNG),d.decodingCTN=Number(a.googDecodingCTN),d.decodingCTSG=Number(a.googDecodingCTSG),d.decodingNormal=Number(a.googDecodingNormal),d.decodingPLC=Number(a.googDecodingPLC),d.decodingPLCCNG=Number(a.googDecodingPLCCNG),d.expandRate=Number(a.googExpandRate),d.accelerateRate=Number(a.googAccelerateRate),d.preemptiveExpandRate=Number(a.googPreemptiveExpandRate),d.secondaryDecodedRate=Number(a.googSecondaryDecodedRate),d.speechExpandRate=Number(a.googSpeechExpandRate),d.preferredJitterBufferMs=Number(a.googPreferredJitterBufferMs),d.jitterBufferMs=Number(a.googJitterBufferMs),d.jitterMs=Number(a.googJitterReceived),d.bytes=Number(a.bytesReceived),d.packets=Number(a.packetsReceived),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.receivedFrames=Number(a.googDecodingCTN)||Number(a.packetsReceived),d.droppedFrames=Number(a.googDecodingPLC)+Number(a.googDecodingPLCCNG)||Number(a.packetsLost),d.receivedFrames>0&&!this.isFirstAudioReceived[d.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(d.ssrc),this.isFirstAudioReceived[d.ssrc]=!0),d.decodingNormal>0&&!this.isFirstAudioDecoded[d.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(d.ssrc),this.isFirstAudioDecoded[d.ssrc]=!0),this._stats.audioRecv.push(d);break}case"audio_send":{const d=pc(Nz);d.codec=a.googCodecName,d.inputLevel=Math.abs(Number(a.audioInputLevel))/32767,d.aecReturnLoss=Number(a.googEchoCancellationReturnLoss||0),d.aecReturnLossEnhancement=Number(a.googEchoCancellationReturnLossEnhancement||0),d.residualEchoLikelihood=Number(a.googResidualEchoLikelihood||0),d.residualEchoLikelihoodRecentMax=Number(a.googResidualEchoLikelihoodRecentMax||0),d.bytes=Number(a.bytesSent),d.packets=Number(a.packetsSent),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.rttMs=Number(a.googRtt||0),this._stats.rtt=d.rttMs,this._stats.audioSend.push(d);break}}})}_getStats(){return new Ge((r,a)=>{this.pc.getStats(r,a)})}statsResponsesToObjects(r){const a=[];return r.result().forEach(s=>{const l={id:s.id,timestamp:s.timestamp.valueOf().toString(),type:s.type};s.names().forEach(d=>{l[d]=s.stat(d)}),a.push(l)}),a}},ub=function(r){return r.BANDWIDTH="bandwidth",r.CPU="cpu",r.NONE="none",r.OTHER="other",r}({}),Hx=function(r){return r.L1T1="L1T1",r.L1T2="L1T2",r.L1T3="L1T3",r.L1T3_KEY="L1T3_KEY",r.L2T1_KEY="L2T1_KEY",r.L2T2_KEY="L2T2_KEY",r.L2T3_KEY="L2T3_KEY",r.L3T1_KEY="L3T1_KEY",r.L3T2_KEY="L3T2_KEY",r.L3T3_KEY="L3T3_KEY",r}({}),Sj=function(r){return r[r.new=0]="new",r[r.connecting=1]="connecting",r[r.connected=2]="connected",r[r.disconnected=3]="disconnected",r[r.failed=4]="failed",r[r.closed=5]="closed",r}({}),Js=function(r){return r.CERTIFICATE="certificate",r.CODEC="codec",r.CANDIDATE_PAIR="candidate-pair",r.LOCAL_CANDIDATE="local-candidate",r.REMOTE_CANDIDATE="remote-candidate",r.INBOUND="inbound-rtp",r.TRACK="track",r.OUTBOUND="outbound-rtp",r.PC="peer-connection",r.REMOTE_INBOUND="remote-inbound-rtp",r.REMOTE_OUTBOUND="remote-outbound-rtp",r.TRANSPORT="transport",r.CSRC="csrc",r.DATA_CHANNEL="data-channel",r.STREAM="stream",r.SENDER="sender",r.RECEIVER="receiver",r}({});var wg=function(r){return r[r.kNone=1]="kNone",r[r.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",r[r.kBytesToBits=8]="kBytesToBits",r}(wg||{});function db(r,a,s,l){let d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:wg.kNone;if(!a)return;const f=Number(a[s]);if(typeof f!="number")return;const m=Number(a[l]);if(typeof m!="number")return;if(!r)return m?f/m*d:void 0;const y=Number(r[s]);if(typeof y!="number")return;const _=Number(r[l]);if(typeof _!="number")return;const w=m-_;return w?(f-y)/w*d:void 0}let Iz=class extends wj{constructor(){super(...arguments),Pt(this,"_stats",lb),Pt(this,"report",void 0),Pt(this,"lastDecodeVideoReceiverStats",new Map),Pt(this,"lastVideoFramesRecv",new Map),Pt(this,"lastVideoFramesSent",new Map),Pt(this,"lastVideoFramesDecode",new Map),Pt(this,"lastVideoFramesOutput",new Map),Pt(this,"lastVideoJBDelay",new Map),Pt(this,"lastAudioJBDelay",new Map),Pt(this,"mediaBytesSent",new Map),Pt(this,"mediaBytesRetransmit",new Map),Pt(this,"mediaBytesTargetEncode",new Map),Pt(this,"lastDecodeAudioReceiverStats",new Map),Pt(this,"lastAudioConcealment",new Map),Pt(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=pc(lb),this.report.forEach(r=>{switch(r.type){case Js.OUTBOUND:case Js.INBOUND:{const a=r.mediaType||r.kind,s=!a&&"frameWidth"in r,l=!a&&!("frameWidth"in r);r.type===Js.OUTBOUND?a==="audio"||l?this.processAudioOutboundStats(r):(a==="video"||s)&&this.processVideoOutboundStats(r):r.type===Js.INBOUND&&(a==="audio"||l?this.processAudioInboundStats(r):(a==="video"||s)&&this.processVideoInboundStats(r));break}case Js.TRANSPORT:{const a=this.report.get(r.selectedCandidatePairId);a&&this.processCandidatePairStats(a);break}case Js.CANDIDATE_PAIR:r.selected&&this.processCandidatePairStats(r)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const r=await this.pc.getStats(),a={local:Me({},nu),remote:Me({},nu)};return r.forEach(s=>{let l;if(s.type===Js.TRANSPORT&&(l=r.get(s.selectedCandidatePairId)),s.type===Js.CANDIDATE_PAIR&&s.selected&&(l=s),l){const d=(f,m)=>{f.type=m.type,f.id=m.id,m.address&&(f.address=m.address),m.candidateType&&(f.candidateType=m.candidateType),m.port&&(f.port=m.port),m.priority&&(f.priority=m.priority),m.protocol&&(f.protocol=m.protocol),m.relayProtocol&&(f.relayProtocol=m.relayProtocol)};if(l.localCandidateId){const f=r.get(l.localCandidateId);f&&d(a.local,f)}if(l.remoteCandidateId){const f=r.get(l.remoteCandidateId);f&&d(a.remote,f)}}}),a}processCandidatePairStats(r){if(this._stats.sendBandwidth=r.availableOutgoingBitrate||0,r.currentRoundTripTime&&(this._stats.rtt=1e3*r.currentRoundTripTime),this._stats.videoSend.forEach(a=>{r.currentRoundTripTime&&(a.rttMs=1e3*r.currentRoundTripTime)}),this._stats.audioSend.forEach(a=>{r.currentRoundTripTime&&(a.rttMs=1e3*r.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=r.id,r.localCandidateId){const a=this.report.get(r.localCandidateId);a&&this.processCandidateStats(a)}if(r.remoteCandidateId){const a=this.report.get(r.remoteCandidateId);a&&this.processCandidateStats(a)}}processCandidateStats(r){let a;r.type===Js.LOCAL_CANDIDATE&&(a=this._stats.selectedCandidatePair.localCandidate),r.type===Js.REMOTE_CANDIDATE&&(a=this._stats.selectedCandidatePair.remoteCandidate),a&&(a.type=r.type,a.id=r.id,r.address&&(a.address=r.address),r.candidateType&&(a.candidateType=r.candidateType),r.port&&(a.port=r.port),r.priority&&(a.priority=r.priority),r.protocol&&(a.protocol=r.protocol),r.relayProtocol&&(a.relayProtocol=r.relayProtocol),r.type===Js.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==a.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Me({},a),Me({},this.stats.selectedCandidatePair.localCandidate)),r.type===Js.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==a.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Me({},a),Me({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(r){let a=this._stats.audioRecv.find(l=>l.ssrc===r.ssrc);a||(a=pc(Az),this._stats.audioRecv.push(a)),a.ssrc=r.ssrc,a.packets=r.packetsReceived,a.packetsLost=r.packetsLost,a.packetsDiscarded=r.packetsDiscarded,a.bytes=r.bytesReceived,a.jitterMs=1e3*r.jitter,a.retransmittedBytesReceived=r.retransmittedBytesReceived,a.retransmittedPacketsReceived=r.retransmittedPacketsReceived,a.totalProcessingDelay=r.totalProcessingDelay,a.jitterBufferEmittedCount=r.jitterBufferEmittedCount;const s=this.lastDecodeAudioReceiverStats.get(a.ssrc);a.avgProcessingDelayMs=db(s,a,"totalProcessingDelay","jitterBufferEmittedCount",wg.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(r,r.trackId,a),this.calculateAudioFreeze(a,s,r),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),a.receivedFrames||(a.receivedFrames=r.packetsReceived),a.droppedFrames||(a.droppedFrames=r.packetsLost),a.receivedFrames>0&&!this.isFirstAudioReceived[a.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(a.ssrc),this.isFirstAudioReceived[a.ssrc]=!0),a.outputLevel&&a.outputLevel>0&&!this.isFirstAudioDecoded[a.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(a.ssrc),this.isFirstAudioDecoded[a.ssrc]=!0),typeof r.concealedSamples=="number"&&(a.concealedSamples=r.concealedSamples),this.lastDecodeAudioReceiverStats.set(a.ssrc,Me({},a))}calculateAudioFreeze(r,a,s){const l=this.lastAudioConcealment.get(r.ssrc);if(a!=null&&l!=null){const d=l.lts,f=s.timestamp,m=f-d;if(m<=0)return;const y=r.concealedSamples-a.concealedSamples-0,_=l.nonSilent+y,w=r.totalSamplesReceived-a.totalSamplesReceived;if(w<=0)return;const x=80*w/m,A=200*w/m,I=m/w;let L=0;r.freezeSamples80=a.freezeSamples80,r.freezeMs80=a.freezeMs80,_>x&&(l.plc80>0?(r.freezeSamples80+=y,r.freezeMs80+=Math.round(y*I)):(r.freezeSamples80+=_,r.freezeMs80+=Math.round(_*I)),L=l.plc80+1);let H=0;r.freezeSamples200=a.freezeSamples200,r.freezeMs200=a.freezeMs200,_>A&&(l.plc200>0?(r.freezeSamples200+=y,r.freezeMs200+=Math.round(y*I)):(r.freezeSamples200+=_,r.freezeMs200+=Math.round(_*I)),H=l.plc200+1),this.lastAudioConcealment.set(r.ssrc,{nonSilent:y,lts:f,plc80:L,plc200:H})}else r.freezeSamples80=0,r.freezeSamples200=0,r.freezeMs80=0,r.freezeMs200=0,this.lastAudioConcealment.set(r.ssrc,{nonSilent:0,lts:s.timestamp,plc80:0,plc200:0})}processVideoInboundStats(r){let a=this._stats.videoRecv.find(m=>m.ssrc===r.ssrc);a||(a=pc(Cz),this._stats.videoRecv.push(a)),a.ssrc=r.ssrc,a.packets=r.packetsReceived,a.packetsLost=r.packetsLost,a.bytes=r.bytesReceived,a.firsCount=r.firCount,a.nacksCount=r.nackCount,a.plisCount=r.pliCount,a.framesDecodeCount=r.framesDecoded,a.framesDroppedCount=r.framesDropped,a.totalInterFrameDelay=r.totalInterFrameDelay,a.totalSquaredInterFrameDelay=r.totalSquaredInterFrameDelay,a.totalFreezesDuration=r.totalFreezesDuration,a.totalProcessingDelay=r.totalProcessingDelay,a.packetsDiscarded=r.packetsDiscarded,a.framesAssembledFromMultiplePackets=r.framesAssembledFromMultiplePackets,a.totalAssemblyTime=r.totalAssemblyTime,a.keyFramesDecoded=r.keyFramesDecoded,a.retransmittedBytesReceived=r.retransmittedBytesReceived,a.retransmittedPacketsReceived=r.retransmittedPacketsReceived;const s=this.lastDecodeVideoReceiverStats.get(a.ssrc),l=this.lastVideoFramesDecode.get(a.ssrc),d=this.lastVideoFramesOutput.get(a.ssrc),f=Date.now();if(a.framesDecodeCount>0&&!this.isFirstVideoDecoded[a.ssrc]){const m=a.decodedFrame?a.decodedFrame.width:0,y=a.decodedFrame?a.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(a.ssrc,m,y),this.isFirstVideoDecoded[a.ssrc]=!0}if(s){const m=s.stats,y=f-s.lts;a.framesDecodeFreezeTime=m.framesDecodeFreezeTime,a.framesDecodeInterval=m.framesDecodeInterval,!this.isFirstVideoDecoded[a.ssrc]&&y>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[a.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(a.ssrc),this.isFirstVideoDecodedTimeout[a.ssrc]=!0),a.framesDecodeCount>m.framesDecodeCount&&this.isFirstVideoDecoded[a.ssrc]?(s.lts=Date.now(),a.framesDecodeInterval=y,a.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc))?a.framesDecodeFreezeTime+=a.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):a.framesDecodeCount<m.framesDecodeCount&&(a.framesDecodeInterval=0),r.framesDecoded&&r.qpSum&&(s.stats.framesDecodeCount>r.framesDecoded?a.qpSumPerFrame=r.qpSum/r.framesDecoded:a.qpSumPerFrame=(r.qpSum-s.qpSum)/(r.framesDecoded-s.stats.framesDecodeCount))}r.totalDecodeTime&&(a.decodeMs=1e3*r.totalDecodeTime,a.avgDecodeMs=db(s==null?void 0:s.stats,a,"decodeMs","framesDecodeCount")),a.avgProcessingDelayMs=db(s==null?void 0:s.stats,a,"totalProcessingDelay","framesDecodeCount",wg.kMillisecondsFromSeconds),a.avgFramesAssembledFromMultiplePacketsMs=db(s==null?void 0:s.stats,a,"totalAssemblyTime","framesAssembledFromMultiplePackets",wg.kMillisecondsFromSeconds),a.avgInterFrameDelayMs=db(s==null?void 0:s.stats,a,"totalInterFrameDelay","framesDecodeCount",wg.kMillisecondsFromSeconds),l&&f-l.lts>=800?(a.decodeFrameRate=Math.round((a.framesDecodeCount-l.count)/((f-l.lts)/1e3)),this.lastVideoFramesDecode.set(a.ssrc,{count:a.framesDecodeCount,lts:f,rate:a.decodeFrameRate})):l?a.decodeFrameRate=l.rate:this.lastVideoFramesDecode.set(a.ssrc,{count:a.framesDecodeCount,lts:f,rate:0}),a.framesDroppedCount&&r.framesReceived&&(d&&f-d.lts>=800?(a.outputFrameRate=Math.round((r.framesReceived-a.framesDroppedCount-d.count)/((f-d.lts)/1e3)),this.lastVideoFramesOutput.set(a.ssrc,{count:r.framesReceived-a.framesDroppedCount,lts:f,rate:Math.max(a.outputFrameRate,0)})):d?a.outputFrameRate=d.rate:this.lastVideoFramesOutput.set(a.ssrc,{count:r.framesReceived-a.framesDroppedCount,lts:f,rate:0})),this.processVideoTrackReceiverStats(r,r.trackId,a),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),r.framerateMean&&(a.framesRateFirefox=r.framerateMean),a.packets>0&&!this.isFirstVideoReceived[a.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(a.ssrc),this.isFirstVideoReceived[a.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(a.ssrc,{stats:Me({},a),lts:s?s.lts:Date.now(),qpSum:r.qpSum})}processVideoOutboundStats(r){let a=this._stats.videoSend.find(l=>l.ssrc===r.ssrc);a||(a=pc(Rz),this._stats.videoSend.push(a));const s=this.mediaBytesSent.get(r.ssrc);if(s)s.add(r.bytesSent);else{const l=new Ej(10);l.add(r.bytesSent),this.mediaBytesSent.set(r.ssrc,l)}if(r.retransmittedBytesSent!==void 0){const l=this.mediaBytesRetransmit.get(r.ssrc);if(l)l.add(r.retransmittedBytesSent);else{const d=new Ej(10);d.add(r.retransmittedBytesSent),this.mediaBytesRetransmit.set(r.ssrc,d)}}if(r.totalEncodedBytesTarget){const l=this.mediaBytesTargetEncode.get(r.ssrc);if(l)l.add(r.totalEncodedBytesTarget);else{const d=new Ej(10);d.add(r.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(r.ssrc,d)}}if(a.ssrc=r.ssrc,a.bytes=r.bytesSent,a.packets=r.packetsSent,a.firsCount=r.firCount,a.nacksCount=r.nackCount,a.plisCount=r.pliCount,a.frameCount=r.framesEncoded,a.adaptionChangeReason=r.qualityLimitationReason,a.scalabilityMode=r.scalabilityMode,a.retransmittedBytesSent=r.retransmittedBytesSent,a.retransmittedPacketsSent=r.retransmittedPacketsSent,a.hugeFramesSent=r.hugeFramesSent,a.keyFramesEncoded=r.keyFramesEncoded,a.targetBitrate=r.targetBitrate,r.totalEncodeTime&&r.framesEncoded){const l=this.lastEncoderMs.get(r.ssrc);if(!l||l.lastFrameCount>r.framesEncoded)a.avgEncodeMs=1e3*r.totalEncodeTime/r.framesEncoded;else{const d=r.framesEncoded-l.lastFrameCount,f=r.totalEncodeTime-l.lastEncoderTime;a.avgEncodeMs=1e3*f/d}}if(r.framesEncoded&&r.qpSum){const l=this.lastEncoderMs.get(r.ssrc);!l||l.lastFrameCount>r.framesEncoded?a.qpSumPerFrame=r.qpSum/r.framesEncoded:a.qpSumPerFrame=(r.qpSum-l.lastQpSum)/(r.framesEncoded-l.lastFrameCount)}if(this.lastEncoderMs.set(r.ssrc,{lastFrameCount:r.framesEncoded,lastEncoderTime:r.totalEncodeTime,lastQpSum:r.qpSum,lts:Date.now()}),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),r.mediaSourceId&&this.processVideoMediaSource(r.mediaSourceId,a),this.processVideoTrackSenderStats(r,r.trackId,a),r.remoteId)this.processRemoteInboundStats(r.remoteId,a);else{const l=this.findRemoteStatsId(r.ssrc,Js.REMOTE_INBOUND);l&&this.processRemoteInboundStats(l,a)}}processAudioOutboundStats(r){let a=this._stats.audioSend.find(s=>s.ssrc===r.ssrc);if(a||(a=pc(Nz),this._stats.audioSend.push(a)),a.ssrc=r.ssrc,a.packets=r.packetsSent,a.bytes=r.bytesSent,a.retransmittedBytesSent=r.retransmittedBytesSent,a.retransmittedPacketsSent=r.retransmittedPacketsSent,r.mediaSourceId&&this.processAudioMediaSource(r.mediaSourceId,a),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),this.processAudioTrackSenderStats(r,r.trackId,a),r.remoteId)this.processRemoteInboundStats(r.remoteId,a);else{const s=this.findRemoteStatsId(r.ssrc,Js.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,a)}}findRemoteStatsId(r,a){var s;const l=Array.from(Rs(s=this.report).call(s)).find(d=>d.type===a&&d.ssrc===r);return l?l.id:null}processVideoMediaSource(r,a){const s=this.report.get(r);s&&s.width&&s.height&&s.framesPerSecond&&(a.inputFrame={width:s.width,height:s.height,frameRate:s.framesPerSecond})}processAudioMediaSource(r,a){const s=this.report.get(r);s&&(a.inputLevel=s.audioLevel)}processVideoTrackSenderStats(r,a,s){var l,d,f,m;const y=a?this.report.get(a):void 0,_=(l=y==null?void 0:y.framesSent)!==null&&l!==void 0?l:r.framesSent;if(typeof _!="number")return;let w=(d=y==null?void 0:y.frameWidth)!==null&&d!==void 0?d:r.frameWidth,x=(f=y==null?void 0:y.frameHeight)!==null&&f!==void 0?f:r.frameHeight,A=(m=y==null?void 0:y.framesPerSecond)!==null&&m!==void 0?m:r.framesPerSecond;if(typeof w=="number"&&typeof x=="number"||(w=0,x=0),A==null){const I=Date.now(),L=this.lastVideoFramesSent.get(s.ssrc);L&&I-L.lts>=800?(A=Math.round((_-L.count)/((I-L.lts)/1e3)),this.lastVideoFramesSent.set(s.ssrc,{count:_,lts:I,rate:A})):L?A=L.rate:this.lastVideoFramesSent.set(s.ssrc,{count:_,lts:I,rate:0})}s.sentFrame={width:w,height:x,frameRate:Math.max(0,A)}}processVideoTrackReceiverStats(r,a,s){var l,d,f,m,y;const _=a?this.report.get(a):void 0,w=(l=_==null?void 0:_.framesReceived)!==null&&l!==void 0?l:r.framesReceived,x=(d=_==null?void 0:_.frameWidth)!==null&&d!==void 0?d:r.frameWidth,A=(f=_==null?void 0:_.frameHeight)!==null&&f!==void 0?f:r.frameHeight,I=(m=_==null?void 0:_.jitterBufferDelay)!==null&&m!==void 0?m:r.jitterBufferDelay,L=(y=_==null?void 0:_.jitterBufferEmittedCount)!==null&&y!==void 0?y:r.jitterBufferEmittedCount;if(typeof w=="number"){const H=this.lastVideoFramesRecv.get(s.ssrc),$=Date.now();s.framesReceivedCount=w;let G=0;H&&$-H.lts>=800?(G=Math.round((w-H.count)/(($-H.lts)/1e3)),this.lastVideoFramesRecv.set(s.ssrc,{count:w,lts:$,rate:G})):H?G=H.rate:this.lastVideoFramesRecv.set(s.ssrc,{count:w,lts:$,rate:0}),s.receivedFrame={width:x||0,height:A||0,frameRate:G||0},s.decodedFrame={width:x||0,height:A||0,frameRate:s.decodeFrameRate||0},s.outputFrame={width:x||0,height:A||0,frameRate:s.outputFrameRate||s.decodeFrameRate||0}}if(I&&L){const H=this.lastVideoJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let $=H.jitterBufferMs;const G=L-H.jitterBufferEmittedCount;G>0&&($=1e3*(I-H.jitterBufferDelay)/G),s.jitterBufferMs=$,s.currentDelayMs=Math.round($),this.lastVideoJBDelay.set(s.ssrc,{jitterBufferDelay:I,jitterBufferEmittedCount:L,jitterBufferMs:s.currentDelayMs})}}processAudioTrackSenderStats(r,a,s){var l,d,f,m;const y=a?this.report.get(a):void 0,_=(l=(d=y==null?void 0:y.echoReturnLoss)!==null&&d!==void 0?d:r.echoReturnLoss)!==null&&l!==void 0?l:0,w=(f=(m=y==null?void 0:y.echoReturnLossEnhancement)!==null&&m!==void 0?m:r.echoReturnLossEnhancement)!==null&&f!==void 0?f:0;s.aecReturnLoss=_,s.aecReturnLossEnhancement=w}processAudioTrackReceiverStats(r,a,s){var l,d,f,m,y,_,w,x,A;const I=a?this.report.get(a):void 0,L=(l=I==null?void 0:I.removedSamplesForAcceleration)!==null&&l!==void 0?l:r.removedSamplesForAcceleration,H=(d=I==null?void 0:I.totalSamplesReceived)!==null&&d!==void 0?d:r.totalSamplesReceived,$=(f=I==null?void 0:I.jitterBufferDelay)!==null&&f!==void 0?f:r.jitterBufferDelay,G=(m=I==null?void 0:I.jitterBufferEmittedCount)!==null&&m!==void 0?m:r.jitterBufferEmittedCount,ne=(y=I==null?void 0:I.audioLevel)!==null&&y!==void 0?y:r==null?void 0:r.audioLevel,te=(_=I==null?void 0:I.totalSamplesDuration)!==null&&_!==void 0?_:r==null?void 0:r.totalSamplesDuration,ce=(w=I==null?void 0:I.concealedSamples)!==null&&w!==void 0?w:r.concealedSamples,pe=(x=I==null?void 0:I.silentConcealedSamples)!==null&&x!==void 0?x:r.silentConcealedSamples,fe=(A=I==null?void 0:I.concealmentEvents)!==null&&A!==void 0?A:r.concealmentEvents;if(typeof H=="number"&&(s.totalSamplesReceived=H),typeof pe=="number"&&(s.silentConcealedSamples=pe),typeof fe=="number"&&(s.concealmentEvents=fe),typeof ce=="number"&&(s.concealedSamples=ce),L&&H&&(s.accelerateRate=L/H),$&&G){const ye=this.lastAudioJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let xe=ye.jitterBufferMs;const Ae=G-ye.jitterBufferEmittedCount;Ae>0&&(xe=1e3*($-ye.jitterBufferDelay)/Ae),s.jitterBufferMs=Math.round(xe),this.lastAudioJBDelay.set(s.ssrc,{jitterBufferDelay:$,jitterBufferEmittedCount:G,jitterBufferMs:s.jitterBufferMs})}s.outputLevel=ne;let ue=1920;te&&H&&(ue=H/te/50,s.receivedFrames=Math.round(H/ue)),ce&&(s.droppedFrames=Math.round(ce/ue))}processRemoteInboundStats(r,a){const s=this.report.get(r);s&&(a.packetsLost=s.packetsLost,s.roundTripTime&&(a.rttMs=1e3*s.roundTripTime),s.jitter&&(a.jitterMs=1e3*s.jitter),s.timestamp&&(a.timestamp=s.timestamp))}getCodecFromCodecStats(r){const a=this.report.get(r);if(!a)return"";const s=a.mimeType.match(/\/(.*)$/);return s&&s[1]?s[1]:""}updateSendBitrate(){let r=0,a=null,s=null;this.mediaBytesSent.forEach(d=>{r+=d.diffMean()}),this.mediaBytesRetransmit.forEach(d=>{a=a===null?d.diffMean():a+d.diffMean()}),this.mediaBytesTargetEncode.forEach(d=>{s=s===null?d.diffMean():s+d.diffMean()});const l=a!==null?r-a:r;this._stats.bitrate={actualEncoded:8*l/(this.options.updateInterval/1e3),transmit:8*r/(this.options.updateInterval/1e3)},a!==null&&(this._stats.bitrate.retransmit=8*a/(this.options.updateInterval/1e3)),s!==null&&(this._stats.bitrate.targetEncoded=8*s/(this.options.updateInterval/1e3))}},M1e=class extends wj{updateStats(){return Ge.resolve()}};function xj(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const f=function(){const m=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return m&&m[0]?Number(m[0].split("/")[1]):null}();return f?f<76?new L1e(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d}):new Iz(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d}):function(m){if(!window.RTCStatsReport)return!1;const y=m.getStats();return!!(y instanceof Ge||function(_){return!!_&&(typeof _=="object"||typeof _=="function")&&typeof _.then=="function"}(y))}(r)?new Iz(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d}):new M1e(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d})}const Oz="websdk_ng_install_id";function Tj(){try{if(se("INSTALL_ID"))return se("INSTALL_ID");let r=window.localStorage.getItem(Oz);return r||(r=sp(),window.localStorage.setItem(Oz,r)),An("INSTALL_ID",r),r}catch{return}}const Co=function(r){if(r.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return r;const a=r.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(a&&a[1]&&a[2]){const s=a[1],l=a[2];return"".concat(s,".").concat(l)}return"4.0.0.999"}("4.24.0"),Cj=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let op=function(r){return r.Default="default",r.Auto="auto",r.Relay="relay",r.SdRtn="sd-rtn",r}({});const Mi=function(){const r="us".concat("erna","me"),a="pa".concat("sswo","rd"),s=["t","s","t"];s.splice(1,0,"e");const l=s.join(""),d=[];for(let y=0;y<6;y++)d.push("1");const f=d.join(""),m={};return m[r]=l,m[a]=f,Object.assign(m,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Mi;const zx={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!0,FORCE_ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:1,ENABLE_AUT_FEEDBACK:!0,SVC_EXTENDED:["VP9"]},Rj={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},Nj="v4.24.0-0-gf2267710-dirty(7/31/2025, 7:00:42 PM)",Aj={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!0,NEW_TURN_MODE:4,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1,ENCODE_EXCEPTION_TIMES:5,ENABLE_ENCODE_EXCEPTION:!0,ENCODE_EXCEPTION_VALIDATE_CODEC:["h264"],VIDEO_ENCODER_CONFIG_LIST:[{width:240,height:180},{width:320,height:240},{width:400,height:300},{width:480,height:360},{width:560,height:420},{width:640,height:480}],DELETE_NEQ_AFTER_USER_LEAVE:!0},Zn=Me(Me(Me(Me({},Aj),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ENABLE_ABSSENDTIME_AS_SENTTS:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],UNSUPPORTED_VIDEO_UPLINK_CODEC:[],UNSUPPORTED_VIDEO_DOWNLINK_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:Rj,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},zx),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1,ENABLE_PRE_RENDER:!1,FORCE_DISABLE_AUTO_SUB:!1,ENABLE_PRE_SUB_WITH_PRE_PC:!1,PRE_USE_LOCAL_CODECS:!0},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:2,BASELINE_MORE_H264_BITRATE_RATIO:1.1});function An(r,a,s){var l,d,f;Ve(l=Object.keys(Zn)).call(l,r)&&(!s&&Ve(d=Object.keys(al)).call(d,r)||(Zn[r]=a,r!=="ENABLE_VIDEO_SEI"&&r!=="ENABLE_AUDIO_TOPN"&&r!=="ENABLE_AUDIO_METADATA"&&r!=="ENABLE_AUDIO_PTS"||a!==!0||(Zn.ENABLE_ENCODED_TRANSFORM=!0),r==="USE_NEW_NETWORK_CONFIG"&&a&&(f=!!a,Zn.USE_NEW_NETWORK_CONFIG=f,f&&(Zn.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],Zn.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],Zn.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],Zn.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],Zn.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",Zn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",Zn.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),r==="ENABLE_PRE_SUB"&&a&&(Zn.ENABLE_INSTANT_VIDEO=!0,Zn.ENABLE_PREALLOC_PC=!0),r==="ENABLE_SVC"&&a&&(Zn.ENABLE_AUT_CC=!0),r==="NEW_FORCE_TURN"&&a&&(Zn.NEW_TURN_MODE||(Zn.NEW_TURN_MODE=4))))}function se(r){return Zn[r]}Cj||(Zn.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Zn.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Zn.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Zn.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Zn.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Zn.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Zn.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Zn.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Zn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Zn.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Zn.AREAS=["NORTH_AMERICA","OVERSEA"]);let Pz=function(r){return r[r.REALTIME=1]="REALTIME",r}({});const al={};var jt=function(r){return r.SET_SESSION_ID="SET_SESSION_ID",r.SET_P2P_ID="SET_P2P_id",r.SET_DC_ID="SET_DC_id",r.SET_UID="SET_UID",r.SET_INT_UID="SET_INT_UID",r.SET_PUB_ID="SET_PUB_ID",r.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",r.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",r.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",r.KEY_METRIC_PRELOAD_START="KEY_METRIC_PRELOAD_START",r.KEY_METRIC_PRELOAD_END="KEY_METRIC_PRELOAD_END",r.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",r.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",r.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",r.KEY_METRIC_REQUEST_SUA_END="KEY_METRIC_REQUEST_SUA_END",r.KEY_METRIC_BEFORE_CONNECT="KEY_METRIC_BEFORE_CONNECT",r.KEY_METRIC_PEER_RECEIVER="KEY_METRIC_PEER_RECEIVER",r.KEY_METRIC_SIGNAL_CONNECTED="KEY_METRIC_SIGNAL_CONNECTED",r.KEY_METRIC_JOIN_REQ="KEY_METRIC_JOIN_REQ",r.KEY_METRIC_JOIN_REP="KEY_METRIC_JOIN_REP",r.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",r.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",r.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",r.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",r.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED="KEY_METRIC_FIRST_VIDEO_FRAME_DECODED",r.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",r.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",r.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",r.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",r.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",r.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",r.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",r.RESET_KEY_METRICS="RESET_KEY_METRICS",r.RESET_FIRST_VIDEO_FRAME_DECODED="RESET_FIRST_VIDEO_FRAME_DECODED",r.SET_USE_P2P="SET_USE_P2P",r.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",r}(jt||{});let hb=function(r){return r.h264="h264",r.h265="h265",r.vp8="vp8",r.vp9="vp9",r.av1="av1",r}({});(function(r){r.opus="opus",r.pcma="pcma",r.pcmu="pcmu",r.g722="g722"})({});const kz=128,U1e=96,jz=1e3,Sg=10;let F1e=0;var Dz=(()=>{var r={8:(l,d,f)=>{f.r(d),f.d(d,{Parser:()=>Ae,Printer:()=>bn,parse:()=>Fe,print:()=>Xe});const m=`
`,y="".concat("\r").concat(m),_=" ";let w;function x(Oe){return Oe>="0"&&Oe<="9"}function A(Oe){return Oe>="!"&&Oe<="~"}function I(Oe){return A(Oe)||Oe>=""&&Oe<="ÿ"}function L(Oe){return Oe==="!"||Oe>="#"&&Oe<="'"||Oe>="*"&&Oe<="+"||Oe>="-"&&Oe<="."||Oe>="0"&&Oe<="9"||Oe>="A"&&Oe<="Z"||Oe>="^"&&Oe<="~"}function H(Oe){return Oe>="1"&&Oe<="9"}function $(Oe){return Oe>="A"&&Oe<="Z"||Oe>="a"&&Oe<="z"}function G(Oe){return Oe==="d"||Oe==="h"||Oe==="m"||Oe==="s"}function ne(Oe){return Oe>""&&Oe<"	"||Oe>"\v"&&Oe<"\f"||Oe>""&&Oe<"ÿ"}function te(Oe){return $(Oe)||x(Oe)||Oe==="+"||Oe==="/"}function ce(Oe){return x(Oe)||$(Oe)||Oe==="+"||Oe==="/"||Oe==="-"||Oe==="_"}function pe(Oe){return $(Oe)||x(Oe)||Oe==="+"||Oe==="/"}function fe(Oe,B){var le=Object.keys(Oe);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols(Oe);B&&(he=he.filter(function(Ue){return Object.getOwnPropertyDescriptor(Oe,Ue).enumerable})),le.push.apply(le,he)}return le}function ue(Oe){for(var B=1;B<arguments.length;B++){var le=arguments[B]!=null?arguments[B]:{};B%2?fe(Object(le),!0).forEach(function(he){ye(Oe,he,le[he])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Oe,Object.getOwnPropertyDescriptors(le)):fe(Object(le)).forEach(function(he){Object.defineProperty(Oe,he,Object.getOwnPropertyDescriptor(le,he))})}return Oe}function ye(Oe,B,le){return B in Oe?Object.defineProperty(Oe,B,{value:le,enumerable:!0,configurable:!0,writable:!0}):Oe[B]=le,Oe}(function(Oe){Oe.VERSION="v",Oe.ORIGIN="o",Oe.SESSION_NAME="s",Oe.INFORMATION="i",Oe.URI="u",Oe.EMAIL="e",Oe.PHONE="p",Oe.CONNECTION="c",Oe.BANDWIDTH="b",Oe.TIME="t",Oe.REPEAT="r",Oe.ZONE_ADJUSTMENTS="z",Oe.KEY="k",Oe.ATTRIBUTE="a",Oe.MEDIA="m"})(w||(w={}));class xe{consumeText(B,le){let he=le;for(;he<B.length;){const Ue=B[he];if(Ue==="\0"||Ue==="\r"||Ue===m)break;he+=1}if(he-le==0)throw new Error("Invalid text, at ".concat(B));return he}consumeUnicastAddress(B,le,he){return this.consumeTill(B,le,_)}consumeOneOrMore(B,le,he){let Ue=le;for(;he(B[Ue]);)Ue++;if(Ue-le==0)throw new Error("Invalid rule at ".concat(le,"."));return Ue}consumeSpace(B,le){if(B[le]===_)return le+1;throw new Error("Invalid space at ".concat(le,"."))}consumeIP4Address(B,le){let he=le;for(let Ue=0;Ue<4;Ue++)if(he=this.consumeDecimalUChar(B,he),Ue!==3){if(B[he]!==".")throw new Error("Invalid IP4 address.");he++}return he}consumeDecimalUChar(B,le){let he=le;for(let Vt=0;Vt<3&&x(B[he]);Vt++,he++);if(he-le==0)throw new Error("Invalid decimal uchar.");const Ue=parseInt(B.slice(le,he));if(Ue>=0&&Ue<=255)return he;throw new Error("Invalid decimal uchar")}consumeIP6Address(B,le){let he=this.consumeHexpart(B,le);return B[he]===":"&&(he+=1,he=this.consumeIP4Address(B,he)),he}consumeHexpart(B,le){let he=le;if(B[he]===":"&&B[he+1]===":"){he+=2;try{he=this.consumeHexseq(B,he)}catch{}return he}if(he=this.consumeHexseq(B,he),B[he]===":"&&B[he+1]===":"){he+=2;try{he=this.consumeHexseq(B,he)}catch{}return he}return he}consumeHexseq(B,le){let he=le;for(;he=this.consumeHex4(B,he),B[he]===":"&&B[he+1]!==":";)he+=1;return he}consumeHex4(B,le){let he=0;for(;he<4;he++)if(!((Ue=B[le+he])>="0"&&Ue<="9"||Ue>="a"&&Ue<="f"||Ue>="A"&&Ue<="F")){if(he===0)throw new Error("Invalid hex 4");break}var Ue;return le+he}consumeFQDN(B,le){let he=le;for(;x(B[he])||$(B[he])||B[he]==="-"||B[he]===".";)he+=1;if(he-le<4)throw new Error("Invalid FQDN");return he}consumeExtnAddr(B,le){return this.consumeOneOrMore(B,le,I)}consumeMulticastAddress(B,le,he){switch(he){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(B,le);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(B,le);default:try{return this.consumeFQDN(B,le)}catch{return this.consumeExtnAddr(B,le)}}}consumeIP6MulticastAddress(B,le){const he=this.consumeHexpart(B,le);return B[he]==="/"?this.consumeInteger(B,he+1):he}consumeIP4MulticastAddress(B,le){let he=le+3;const Ue=B.slice(le,he),Vt=parseInt(Ue);if(Vt<224||Vt>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Vn=0;Vn<3;Vn++){if(B[he]!==".")throw new Error("Invalid IP4 multicast address.");he+=1,he=this.consumeDecimalUChar(B,he)}return B[he]==="/"&&(he+=1),he=this.consumeTTL(B,he),B[he]==="/"&&(he=this.consumeInteger(B,he)),he}consumeInteger(B,le){if(!H(B[le]))throw new Error("Invalid integer.");for(le+=1;x(B[le]);)le+=1;return le}consumeTTL(B,le){if(B[le]==="0")return le+1;if(!H(B[le]))throw new Error("Invalid TTL.");le+=1;for(let he=0;he<2&&x(B[le]);he++)le+=1;return le}consumeToken(B,le){return this.consumeOneOrMore(B,le,L)}consumeTime(B,le){let he=le;if(B[he]==="0")return he+1;for(H(B[he])&&(he+=1);x(B[he]);)he++;if(he-le<10)throw new Error("Invalid time");return he}consumeAddress(B,le){return this.consumeTill(B,le,_)}consumeTypedTime(B,le){let he=le;return he=this.consumeOneOrMore(B,he,x),G(B[he])?he+1:he}consumeRepeatInterval(B,le){if(!H(B[le]))throw new Error("Invalid repeat interval");for(le+=1;x(B[le]);)le+=1;return G(B[le])&&(le+=1),le}consumePort(B,le){return this.consumeOneOrMore(B,le,x)}consume(B,le,he){for(let Ue=0;Ue<he.length;Ue++){if(le+Ue>=B.length)throw new Error("consume exceeding value length");if(B[le+Ue]!==he[Ue])throw new Error("consume ".concat(he," failed at ").concat(Ue))}return le+he.length}consumeTill(B,le,he){let Ue=le;for(;Ue<B.length&&(typeof he!="string"||B[Ue]!==he)&&(typeof he!="function"||!he(B[Ue]));)Ue++;return Ue}}class Ae extends xe{constructor(){super(),ye(this,"records",[]),ye(this,"currentLine",0)}parse(B){const le=this.probeEOL(B);this.records=B.split(le).filter(pd=>!!Ea(pd).call(pd)).map(this.parseLine),this.currentLine=0;const he=this.parseVersion(),Ue=this.parseOrigin(),Vt=this.parseSessionName(),Vn=this.parseInformation(),Jr=this.parseUri(),Do=this.parseEmail(),Cc=this.parsePhone(),Xb=this.parseConnection(),Rp=this.parseBandWidth(),tv=this.parseTimeFields(),sC=this.parseKey(),oC=this.parseSessionAttribute(),Lo=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:he,origin:Ue,sessionName:Vt,information:Vn,uri:Jr,emails:Do,phones:Cc,connection:Xb,bandwidths:Rp,timeFields:tv,key:sC,attributes:oC,mediaDescriptions:Lo}}getCurrentRecord(){const B=this.records[this.currentLine];if(!B)throw new Error("Record doesn't exit.");return B}probeEOL(B){for(let le=0;le<B.length;le++)if(B[le]===m)return B[le-1]==="\r"?y:m;throw new Error("Invalid newline character.")}parseLine(B,le){if(B.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const he=B[0];if(B[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:he,value:B.slice(2),line:le,cur:0}}parseSessionAttribute(){const B=new Ht;for(;this.currentLine<this.records.length;){const le=this.getCurrentRecord();if(le.type!==w.ATTRIBUTE)break;const he={attField:this.extractOneOrMore(le,Ue=>L(Ue)&&Ue!==":"),_cur:0};le.value[le.cur]===":"&&(le.cur+=1,he.attValue=this.extractOneOrMore(le,ne)),B.parse(he),this.currentLine++}return B.digest()}parseMediaAttributes(B){const le=new qt(B);for(;this.currentLine<this.records.length;){const he=this.getCurrentRecord();if(he.type!==w.ATTRIBUTE)break;const Ue={attField:this.extractOneOrMore(he,Vt=>L(Vt)&&Vt!==":"),_cur:0};he.value[he.cur]===":"&&(he.cur+=1,Ue.attValue=this.extractOneOrMore(he,ne)),le.parse(Ue),this.currentLine++}return le.digest()}parseKey(){const B=this.getCurrentRecord();if(B.type===w.KEY){if(B.value==="prompt"||B.value==="clear:"||B.value==="base64:"||B.value==="uri:")return B.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const B=this.getCurrentRecord();if(B.type===w.ZONE_ADJUSTMENTS){const le=[];for(;;)try{const he=this.extract(B,this.consumeTime);this.consumeSpaceForRecord(B);let Ue=!1;B.value[B.cur]==="-"&&(Ue=!0,B.cur+=1);const Vt=this.extract(B,this.consumeTypedTime);le.push({time:he,typedTime:Vt,back:Ue})}catch{break}if(le.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,le}return[]}parseRepeat(){const B=[];for(;;){const le=this.getCurrentRecord();if(le.type!==w.REPEAT)break;{const he=this.extract(le,this.consumeRepeatInterval),Ue=this.parseTypedTime(le);B.push({repeatInterval:he,typedTimes:Ue}),this.currentLine++}}return B}parseTypedTime(B){const le=[];for(;;)try{this.consumeSpaceForRecord(B),le.push(this.extract(B,this.consumeTypedTime))}catch{break}if(le.length===0)throw new Error("Invalid typed time.");return le}parseTime(){const B=this.getCurrentRecord(),le=this.extract(B,this.consumeTime);this.consumeSpaceForRecord(B);const he=this.extract(B,this.consumeTime);return this.currentLine++,{startTime:le,stopTime:he}}parseBandWidth(){const B=[];for(;this.currentLine<this.records.length;){const le=this.getCurrentRecord();if(le.type!==w.BANDWIDTH)break;{const he=this.extractOneOrMore(le,L);if(le.value[le.cur]!==":")throw new Error("Invalid bandwidth field.");le.cur++;const Ue=this.extractOneOrMore(le,x);B.push({bwtype:he,bandwidth:Ue}),this.currentLine++}}return B}parseVersion(){const B=this.getCurrentRecord();if(B.type!==w.VERSION)throw new Error("first sdp record must be version");const le=B.value.slice(0,this.consumeOneOrMore(B.value,0,x));if(le.length!==B.value.length)throw new Error('invalid proto version, "v='.concat(B.value,'"'));return this.currentLine++,le}parseOrigin(){const B=this.getCurrentRecord();if(B.type!==w.ORIGIN)throw new Error("second line of sdp must be origin");const le=this.extractOneOrMore(B,I);this.consumeSpaceForRecord(B);const he=this.extractOneOrMore(B,x);this.consumeSpaceForRecord(B);const Ue=this.extractOneOrMore(B,x);this.consumeSpaceForRecord(B);const Vt=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const Vn=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const Jr=this.extract(B,this.consumeUnicastAddress);return this.currentLine++,{username:le,sessId:he,sessVersion:Ue,nettype:Vt,addrtype:Vn,unicastAddress:Jr}}parseSessionName(){const B=this.getCurrentRecord();if(B.type===w.SESSION_NAME){const le=this.extract(B,this.consumeText);return this.currentLine++,le}}parseInformation(){const B=this.getCurrentRecord();if(B.type!==w.INFORMATION)return;const le=this.extract(B,this.consumeText);return this.currentLine++,le}parseUri(){const B=this.getCurrentRecord();if(B.type===w.URI)return this.currentLine++,B.value}parseEmail(){const B=[];for(;;){const le=this.getCurrentRecord();if(le.type!==w.EMAIL)break;B.push(le.value),this.currentLine++}return B}parsePhone(){const B=[];for(;;){const le=this.getCurrentRecord();if(le.type!==w.PHONE)break;B.push(le.value),this.currentLine++}return B}parseConnection(){const B=this.getCurrentRecord();if(B.type===w.CONNECTION){const le=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const he=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const Ue=this.extract(B,this.consumeAddress);return this.currentLine++,{nettype:le,addrtype:he,address:Ue}}}parseMedia(){const B=this.getCurrentRecord(),le=this.extract(B,this.consumeToken);this.consumeSpaceForRecord(B);let he=this.extract(B,this.consumePort);B.value[B.cur]==="/"&&(B.cur+=1,he+=this.extract(B,this.consumeInteger)),this.consumeSpaceForRecord(B);const Ue=[];for(Ue.push(this.extract(B,this.consumeToken));B.value[B.cur]==="/";)B.cur+=1,Ue.push(this.extract(B,this.consumeToken));if(Ue.length===0)throw new Error("Invalid proto");const Vt=this.parseFmt(B);return this.currentLine++,{mediaType:le,port:he,protos:Ue,fmts:Vt}}parseTimeFields(){const B=[];for(;this.getCurrentRecord().type===w.TIME;){const le=this.parseTime(),he=this.parseRepeat(),Ue=this.parseZone();B.push({time:le,repeats:he,zones:Ue})}return B}parseMediaDescription(){const B=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===w.MEDIA;){const le=this.parseMedia(),he=this.parseInformation(),Ue=this.parseConnections(),Vt=this.parseBandWidth(),Vn=this.parseKey(),Jr=this.parseMediaAttributes(le);B.push({media:le,information:he,connections:Ue,bandwidths:Vt,key:Vn,attributes:Jr})}return B}parseConnections(){const B=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===w.CONNECTION;)B.push(this.parseConnection());return B}parseFmt(B){const le=[];for(;;)try{this.consumeSpaceForRecord(B),le.push(this.extract(B,this.consumeToken))}catch{break}if(le.length===0)throw new Error("Invalid fmts");return le}extract(B,le){for(var he=arguments.length,Ue=new Array(he>2?he-2:0),Vt=2;Vt<he;Vt++)Ue[Vt-2]=arguments[Vt];const Vn=le.call(this,B.value,B.cur,...Ue),Jr=B.value.slice(B.cur,Vn);return B.cur=Vn,Jr}extractOneOrMore(B,le){const he=this.consumeOneOrMore(B.value,B.cur,le),Ue=B.value.slice(B.cur,he);return B.cur=he,Ue}consumeSpaceForRecord(B){if(B.value[B.cur]!==_)throw new Error("Invalid space at ".concat(B.cur,"."));B.cur+=1}}class Le extends xe{constructor(){super(...arguments),ye(this,"attributes",void 0),ye(this,"digested",!1)}extractOneOrMore(B,le,he){const Ue=this.consumeOneOrMore(B.attValue,B._cur,le),Vt=B.attValue.slice(B._cur,Ue),[Vn,Jr]=he||[];if(typeof Vn=="number"&&Vt.length<Vn)throw new Error("error in length, should be more or equal than ".concat(Vn," characters."));if(typeof Jr=="number"&&Vt.length>Jr)throw new Error("error in length, should be less or equal than ".concat(Jr," characters."));return B._cur=Ue,Vt}consumeAttributeSpace(B){if(B.attValue[B._cur]!==_)throw new Error("Invalid space at ".concat(B._cur,"."));B._cur+=1}extract(B,le){if(!B.attValue)throw new Error("Nothing to extract from attValue.");for(var he=arguments.length,Ue=new Array(he>2?he-2:0),Vt=2;Vt<he;Vt++)Ue[Vt-2]=arguments[Vt];const Vn=le.call(this,B.attValue,B._cur,...Ue),Jr=B.attValue.slice(B._cur,Vn);return B._cur=Vn,Jr}atEnd(B){if(!B.attValue)throw new Error;return B._cur>=B.attValue.length}peekChar(B){if(!B.attValue)throw new Error;return B.attValue[B._cur]}peek(B,le){if(!B.attValue)throw new Error;for(let he=0;he<le.length;he++)if(le[he]!==B.attValue[B._cur+he])return!1;return!0}parseIceUfrag(B){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(B,te,[4,256])}parseIcePwd(B){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(B,te,[22,256])}parseIceOptions(B){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const le=[];for(;!this.atEnd(B);){le.push(this.extractOneOrMore(B,te));try{this.consumeAttributeSpace(B)}catch(he){if(this.atEnd(B))break;throw he}}this.attributes.iceOptions=le}parseFingerprint(B){const le=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill);this.attributes.fingerprints.push({hashFunction:le,fingerprint:he})}parseExtmap(B){const le=this.extractOneOrMore(B,x);let he;this.peekChar(B)==="/"&&(this.extract(B,this.consume,"/"),he=this.extract(B,this.consumeToken)),this.consumeAttributeSpace(B);const Ue=this.extract(B,this.consumeTill,_),Vt=ue(ue({entry:parseInt(le,10)},he&&{direction:he}),{},{extensionName:Ue});this.peekChar(B)===_&&(this.consumeAttributeSpace(B),Vt.extensionAttributes=this.extract(B,this.consumeTill)),this.attributes.extmaps.push(Vt)}parseSetup(B){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const le=this.extract(B,this.consumeTill);if(le!=="active"&&le!=="passive"&&le!=="actpass"&&le!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=le}}class Ht extends Le{constructor(){super(...arguments),ye(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(B){if(this.digested)throw new Error("already digested");try{switch(B.attField){case"group":this.parseGroup(B);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(B);break;case"ice-pwd":this.parseIcePwd(B);break;case"ice-options":this.parseIceOptions(B);break;case"fingerprint":this.parseFingerprint(B);break;case"setup":this.parseSetup(B);break;case"tls-id":this.parseTlsId(B);break;case"identity":this.parseIdentity(B);break;case"extmap":this.parseExtmap(B);break;case"msid-semantic":this.parseMsidSemantic(B);break;default:B.ignored=!0,this.attributes.unrecognized.push(B)}}catch(le){throw console.error("parsing session attribute ".concat(B.attField,' error, "a=').concat(B.attField,":").concat(B.attValue,'"')),le}if(!B.ignored&&B.attValue&&!this.atEnd(B))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(B){const le=this.extract(B,this.consumeToken),he=[];for(;!this.atEnd(B)&&this.peekChar(B)===_;)this.consumeAttributeSpace(B),he.push(this.extract(B,this.consumeToken));this.attributes.groups.push({semantic:le,identificationTag:he})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(B){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(B,ce)}parseIdentity(B){const le=this.extractOneOrMore(B,pe),he=[];for(;!this.atEnd(B)&&this.peekChar(B)===_;){this.consumeAttributeSpace(B);const Ue=this.extract(B,this.consumeToken);this.extract(B,this.consume,"=");const Vt=this.extractOneOrMore(B,Vn=>Vn!==_&&ne(Vn));he.push({name:Ue,value:Vt})}this.attributes.identities.push({assertionValue:le,extensions:he})}parseMsidSemantic(B){this.peekChar(B)===_&&this.consumeAttributeSpace(B);const le={semantic:this.extract(B,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(B)}catch{break}if(this.peekChar(B)==="*"){this.extract(B,this.consume,"*"),le.applyForAll=!0;break}{const he=this.extract(B,this.consumeTill,_);le.identifierList.push(he)}}this.attributes.msidSemantic=le}}class qt extends Le{constructor(B){super(),ye(this,"attributes",void 0),B.protos.indexOf("RTP")!==-1||B.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(B){if(this.digested)throw new Error("already digested");try{switch(B.attField){case"extmap":this.parseExtmap(B);break;case"setup":this.parseSetup(B);break;case"ice-ufrag":this.parseIceUfrag(B);break;case"ice-pwd":this.parseIcePwd(B);break;case"ice-options":this.parseIceOptions(B);break;case"candidate":this.parseCandidate(B);break;case"remote-candidate":this.parseRemoteCandidate(B);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(B);break;case"rtpmap":this.parseRtpmap(B);break;case"ptime":this.parsePtime(B);break;case"maxptime":this.parseMaxPtime(B);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(B);break;case"ssrc":this.parseSSRC(B);break;case"fmtp":this.parseFmtp(B);break;case"rtcp-fb":this.parseRtcpFb(B);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(B);break;case"mid":this.parseMid(B);break;case"msid":this.parseMsid(B);break;case"imageattr":this.parseImageAttr(B);break;case"rid":this.parseRid(B);break;case"simulcast":this.parseSimulcast(B);break;case"sctp-port":this.parseSctpPort(B);break;case"max-message-size":this.parseMaxMessageSize(B);break;case"ssrc-group":this.parseSSRCGroup(B);break;default:B.ignored=!0,this.attributes.unrecognized.push(B)}}catch(le){throw console.error("parsing media attribute ".concat(B.attField,' error, "a=').concat(B.attField,":").concat(B.attValue,'"')),le}if(!B.ignored&&B.attValue&&!this.atEnd(B))throw new Error("attribute parsing error")}parseCandidate(B){const le=this.extractOneOrMore(B,te,[1,32]);this.consumeAttributeSpace(B);const he=this.extractOneOrMore(B,x,[1,5]);this.consumeAttributeSpace(B);const Ue=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const Vt=this.extractOneOrMore(B,x,[1,10]);this.consumeAttributeSpace(B);const Vn=this.extract(B,this.consumeAddress);this.consumeAttributeSpace(B);const Jr=this.extract(B,this.consumePort);this.consumeAttributeSpace(B),this.extract(B,this.consume,"typ"),this.consumeAttributeSpace(B);const Do={foundation:le,componentId:he,transport:Ue,priority:Vt,connectionAddress:Vn,port:Jr,type:this.extract(B,this.consumeToken),extension:{}};for(this.peek(B," raddr")&&(this.extract(B,this.consume," raddr"),this.consumeAttributeSpace(B),Do.relAddr=this.extract(B,this.consumeAddress)),this.peek(B," rport")&&(this.extract(B,this.consume," rport"),this.consumeAttributeSpace(B),Do.relPort=this.extract(B,this.consumePort));this.peekChar(B)===_;){this.consumeAttributeSpace(B);const Cc=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B),Do.extension[Cc]=this.extractOneOrMore(B,A)}this.attributes.candidates.push(Do)}parseRemoteCandidate(B){const le=[];for(;;){const he=this.extractOneOrMore(B,x,[1,5]);this.consumeAttributeSpace(B);const Ue=this.extract(B,this.consumeAddress);this.consumeAttributeSpace(B);const Vt=this.extract(B,this.consumePort);le.push({componentId:he,connectionAddress:Ue,port:Vt});try{this.consumeAttributeSpace(B)}catch{break}}this.attributes.remoteCandidatesList.push(le)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(B){const le=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill,"/");this.extract(B,this.consume,"/");const Ue={encodingName:he,clockRate:this.extractOneOrMore(B,x)};this.atEnd(B)||this.peekChar(B)!=="/"||(this.extract(B,this.consume,"/"),Ue.encodingParameters=parseInt(this.extract(B,this.consumeTill),10));const Vt=this.attributes.payloads.find(Vn=>Vn.payloadType===parseInt(le,10));Vt?Vt.rtpMap=Ue:this.attributes.payloads.push({payloadType:parseInt(le,10),rtpMap:Ue,rtcpFeedbacks:[]})}parsePtime(B){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(B,this.consumeTill)}parseMaxPtime(B){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(B,this.consumeTill)}parseDirection(B){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=B.attField}parseSSRC(B){const le=this.extractOneOrMore(B,x);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill,":");let Ue;this.peekChar(B)===":"&&(this.extract(B,this.consume,":"),Ue=this.extract(B,this.consumeTill));const Vt=this.attributes.ssrcs.find(Vn=>Vn.ssrcId===parseInt(le,10));Vt?Vt.attributes[he]=Ue:this.attributes.ssrcs.push({ssrcId:parseInt(le,10),attributes:{[he]:Ue}})}parseFmtp(B){const le=this.extract(B,this.consumeTill,_);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill),Ue={};he.split(";").forEach(Vn=>{let[Jr,Do]=Vn.split("=");Jr=Ea(Jr).call(Jr);const Cc=typeof Do=="string"?Ea(Do).call(Do):null;typeof Jr=="string"&&Jr.length>0&&(Ue[Jr]=Cc)});const Vt=this.attributes.payloads.find(Vn=>Vn.payloadType===parseInt(le,10));Vt?Vt.fmtp={parameters:Ue}:this.attributes.payloads.push({payloadType:parseInt(le,10),rtcpFeedbacks:[],fmtp:{parameters:Ue}})}parseFmtParameters(B){const le={},he=this.extract(B,this.consumeTill,"=");B._cur++;const Ue=this.extract(B,this.consumeTill,";");for(le[he]=Ue;B.attValue[B._cur]===";";){const Vt=this.extract(B,this.consumeTill,"=");B._cur++;const Vn=this.extract(B,this.consumeTill,";");le[Vt]=Vn}return le}parseRtcpFb(B){let le="";le=this.peekChar(B)==="*"?this.extract(B,this.consume,"*"):this.extract(B,this.consumeTill,_),this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill,_);let Ue;if(he==="trr-int")Ue={type:he,interval:this.extract(B,this.consumeTill)};else{const Vt={type:he};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),Vt.parameter=this.extract(B,this.consumeToken),this.peekChar(B)===_&&(Vt.additional=this.extract(B,this.consumeTill))),Ue=Vt}if(le==="*")this.attributes.rtcpFeedbackWildcards.push(Ue);else{const Vt=this.attributes.payloads.find(Vn=>Vn.payloadType===parseInt(le,10));Vt?Vt.rtcpFeedbacks.push(Ue):this.attributes.payloads.push({payloadType:parseInt(le,10),rtcpFeedbacks:[Ue]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(B){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const le={port:this.extract(B,this.consumePort)};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),le.netType=this.extractOneOrMore(B,L),this.consumeAttributeSpace(B),le.addressType=this.extractOneOrMore(B,L),this.consumeAttributeSpace(B),le.address=this.extract(B,this.consumeAddress)),this.attributes.rtcp=le}parseMsid(B){const le={id:this.extractOneOrMore(B,L,[1,64])};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),le.appdata=this.extractOneOrMore(B,L,[1,64])),this.attributes.msids.push(le)}parseImageAttr(B){this.attributes.imageattr.push(B.attValue)}parseRid(B){const le=this.extractOneOrMore(B,Ue=>$(Ue)||x(Ue)||Ue==="_"||Ue==="-");this.consumeAttributeSpace(B);const he={id:le,direction:this.extract(B,this.consumeToken),params:[]};if(this.peekChar(B)===_){if(this.consumeAttributeSpace(B),this.peek(B,"pt=")){this.extract(B,this.consume,"pt=");const Ue=[];for(;;){const Vt=this.extract(B,this.consumeToken);Ue.push(Vt);try{this.extract(B,this.consume,",")}catch{break}}he.payloads=Ue,this.peekChar(B)===_&&this.extract(B,this.consume,_)}for(;;){const Ue=this.extract(B,this.consumeToken);switch(Ue){case"depend":{const Vt={type:Ue,rids:this.extract(B,this.consume,"=").split(",")};he.params.push(Vt);break}default:{const Vt={type:Ue};this.peekChar(B)==="="&&(this.extract(B,this.consume,"="),Vt.val=this.extract(B,this.consumeTill,";")),he.params.push(Vt)}}try{this.extract(B,this.consume,";")}catch{break}}}this.attributes.rids.push(he)}parseSimulcast(B){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=B.attValue,this.extract(B,this.consumeTill)}parseSctpPort(B){this.attributes.sctpPort=this.extractOneOrMore(B,x,[1,5])}parseMaxMessageSize(B){this.attributes.maxMessageSize=this.extractOneOrMore(B,x,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(B){this.attributes.mid=this.extract(B,this.consumeToken)}parseSSRCGroup(B){const le=this.extract(B,this.consumeToken),he=[];for(;;)try{this.consumeAttributeSpace(B);const Ue=this.extract(B,this.consumeInteger);he.push(parseInt(Ue,10))}catch{break}this.attributes.ssrcGroups.push({semantic:le,ssrcIds:he})}}function Rt(Oe,B,le){return B in Oe?Object.defineProperty(Oe,B,{value:le,enumerable:!0,configurable:!0,writable:!0}):Oe[B]=le,Oe}class bn{constructor(){Rt(this,"eol",y)}print(B,le){let he="";return le&&(this.eol=le),he+=this.printVersion(B.version),he+=this.printOrigin(B.origin),he+=this.printSessionName(B.sessionName),he+=this.printInformation(B.information),he+=this.printUri(B.uri),he+=this.printEmail(B.emails),he+=this.printPhone(B.phones),he+=this.printConnection(B.connection),he+=this.printBandwidth(B.bandwidths),he+=this.printTimeFields(B.timeFields),he+=this.printKey(B.key),he+=this.printSessionAttributes(B.attributes),he+=this.printMediaDescription(B.mediaDescriptions),he}printVersion(B){return"v=".concat(B).concat(this.eol)}printOrigin(B){return"o=".concat(B.username," ").concat(B.sessId," ").concat(B.sessVersion," ").concat(B.nettype," ").concat(B.addrtype," ").concat(B.unicastAddress).concat(this.eol)}printSessionName(B){return B?"s=".concat(B).concat(this.eol):""}printInformation(B){return B?"i=".concat(B).concat(this.eol):""}printUri(B){return B?"u=".concat(B).concat(this.eol):""}printEmail(B){let le="";for(const he of B)le+="e=".concat(he).concat(this.eol);return le}printPhone(B){let le="";for(const he of B)le+="e=".concat(he).concat(this.eol);return le}printConnection(B){return B?"c=".concat(B.nettype," ").concat(B.addrtype," ").concat(B.address).concat(this.eol):""}printBandwidth(B){let le="";for(const he of B)le+="b=".concat(he.bwtype,":").concat(he.bandwidth).concat(this.eol);return le}printTimeFields(B){let le="";for(const he of B){le+="t=".concat(he.time.startTime," ").concat(he.time.startTime).concat(this.eol);for(const Ue of he.repeats)le+="r=".concat(Ue.repeatInterval," ").concat(Ue.typedTimes.join(" ")).concat(this.eol);he.zoneAdjustments&&(le+="z=",le+="z=".concat(he.zoneAdjustments.map(Ue=>"".concat(Ue.time," ").concat(Ue.back?"-":""," ").concat(Ue.typedTime)).join(" ")).concat(this.eol),le+=this.eol)}return le}printKey(B){return B?"k=".concat(B).concat(this.eol):""}printAttributes(B){let le="";for(const he of B)le+="a=".concat(he.attField).concat(he.attValue?":".concat(he.attValue):"").concat(this.eol);return le}printMediaDescription(B){let le="";for(const he of B)le+=this.printMedia(he.media),le+=this.printInformation(he.information),le+=this.printConnections(he.connections),le+=this.printBandwidth(he.bandwidths),le+=this.printKey(he.key),le+=this.printMediaAttributes(he);return le}printConnections(B){let le="";for(const he of B)le+=this.printConnection(he);return le}printMedia(B){return"m=".concat(B.mediaType," ").concat(B.port," ").concat(B.protos.join("/")," ").concat(B.fmts.join(" ")).concat(this.eol)}printSessionAttributes(B){return new Yi(this.eol).print(B)}printMediaAttributes(B){return new Re(this.eol).print(B)}}class yn{constructor(B){Rt(this,"eol",void 0),this.eol=B}printIceUfrag(B){return B===void 0?"":"a=ice-ufrag:".concat(B).concat(this.eol)}printIcePwd(B){return B===void 0?"":"a=ice-pwd:".concat(B).concat(this.eol)}printIceOptions(B){return B===void 0?"":"a=ice-options:".concat(B.join(_)).concat(this.eol)}printFingerprints(B){return B.length>0?B.map(le=>"a=fingerprint:".concat(le.hashFunction).concat(_).concat(le.fingerprint)).join(this.eol)+this.eol:""}printExtmap(B){return B.map(le=>"a=extmap:".concat(le.entry).concat(le.direction?"/".concat(le.direction):"").concat(_).concat(le.extensionName).concat(le.extensionAttributes?"".concat(_).concat(le.extensionAttributes):"").concat(this.eol)).join("")}printSetup(B){return B===void 0?"":"a=setup:".concat(B).concat(this.eol)}printUnrecognized(B){return B.map(le=>"a=".concat(le.attField).concat(le.attValue?":".concat(le.attValue):"").concat(this.eol)).join("")}}class Yi extends yn{print(B){let le="";return le+=this.printGroups(B.groups),le+=this.printMsidSemantic(B.msidSemantic),le+=this.printIceLite(B.iceLite),le+=this.printIceUfrag(B.iceUfrag),le+=this.printIcePwd(B.icePwd),le+=this.printIceOptions(B.iceOptions),le+=this.printFingerprints(B.fingerprints),le+=this.printSetup(B.setup),le+=this.printTlsId(B.tlsId),le+=this.printIdentity(B.identities),le+=this.printExtmap(B.extmaps),le+=this.printUnrecognized(B.unrecognized),le}printGroups(B){let le="";return B.length>0&&(le+=B.map(he=>"a=group:".concat(he.semantic).concat(he.identificationTag.map(Ue=>"".concat(_).concat(Ue)).join("")).concat(this.eol)).join("")),le}printIceLite(B){return B===void 0?"":"a=ice-lite"+this.eol}printTlsId(B){return B?"a=tls-id:".concat(B).concat(this.eol):""}printIdentity(B){return B.length===0?"":B.map(le=>"a=identity:".concat(le.assertionValue).concat(le.extensions.map(he=>"".concat(_).concat(he.name).concat(he.value?"=".concat(he.value):"")))).join(this.eol)+this.eol}printMsidSemantic(B){if(!B)return"";let le="a=msid-semantic:".concat(B.semantic);return B.applyForAll?le+="".concat(_,"*"):B.identifierList.length>0&&(le+=B.identifierList.map(he=>"".concat(_).concat(he))),le+this.eol}}class Re extends yn{print(B){const le=B.attributes;let he="";return he+=this.printRTCP(le.rtcp),he+=this.printIceUfrag(le.iceUfrag),he+=this.printIcePwd(le.icePwd),he+=this.printIceOptions(le.iceOptions),he+=this.printCandidates(le.candidates),he+=this.printRemoteCandidatesList(le.remoteCandidatesList),he+=this.printEndOfCandidates(le.endOfCandidates),he+=this.printFingerprints(le.fingerprints),he+=this.printSetup(le.setup),he+=this.printMid(le.mid),he+=this.printExtmap(le.extmaps),he+=this.printRTPRelated(le),he+=this.printPtime(le.ptime),he+=this.printMaxPtime(le.maxPtime),he+=this.printDirection(le.direction),he+=this.printSSRCGroups(le.ssrcGroups),he+=this.printSSRC(le.ssrcs),he+=this.printRTCPMux(le.rtcpMux),he+=this.printRTCPMuxOnly(le.rtcpMuxOnly),he+=this.printRTCPRsize(le.rtcpRsize),he+=this.printMSId(le.msids),he+=this.printImageattr(le.imageattr),he+=this.printRid(le.rids),he+=this.printSimulcast(le.simulcast),he+=this.printSCTPPort(le.sctpPort),he+=this.printMaxMessageSize(le.maxMessageSize),he+=this.printUnrecognized(le.unrecognized),he}printCandidates(B){return B.map(le=>"a=candidate:".concat(le.foundation).concat(_).concat(le.componentId).concat(_).concat(le.transport).concat(_).concat(le.priority).concat(_).concat(le.connectionAddress).concat(_).concat(le.port).concat(_,"typ").concat(_).concat(le.type).concat(le.relAddr?"".concat(_,"raddr").concat(_).concat(le.relAddr):"").concat(le.relPort?"".concat(_,"rport").concat(_).concat(le.relPort):"").concat(Object.keys(le.extension).map(he=>"".concat(_).concat(he).concat(_).concat(le.extension[he])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(B){return B.map(le=>"a=remote-candidates:".concat(le.join(_)).concat(this.eol)).join("")}printEndOfCandidates(B){return B===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(B){if(!B.payloads)return"";const le=B.payloads;let he="";he+=B.rtcpFeedbackWildcards.map(Ue=>this.printRTCPFeedback("*",Ue)).join("");for(const Ue of le)he+=this.printRtpMap(Ue.payloadType,Ue.rtpMap),he+=this.printFmtp(Ue.payloadType,Ue.fmtp),he+=Ue.rtcpFeedbacks.map(Vt=>this.printRTCPFeedback(Ue.payloadType,Vt)).join("");return he}printFmtp(B,le){if(!le)return"";const he=Object.keys(le.parameters);return he.length===1&&le.parameters[he[0]]===null?"a=fmtp:".concat(B).concat(_).concat(he[0]).concat(this.eol):"a=fmtp:".concat(B).concat(_).concat(Object.keys(le.parameters).map(Ue=>"".concat(Ue,"=").concat(le.parameters[Ue])).join(";")).concat(this.eol)}printRtpMap(B,le){return le?"a=rtpmap:".concat(B).concat(_).concat(le.encodingName,"/").concat(le.clockRate).concat(le.encodingParameters?"/".concat(le.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(B,le){let he="a=rtcp-fb:".concat(B).concat(_),Ue=le;return Ue.type==="trr-int"?he+="ttr-int".concat(_).concat(Ue.interval):(he+="".concat(Ue.type),Ue.parameter&&(he+="".concat(_).concat(Ue.parameter),Ue.additional&&(he+="".concat(_).concat(Ue.additional)))),he+this.eol}printPtime(B){return B===void 0?"":"a=ptime:".concat(B).concat(this.eol)}printMaxPtime(B){return B===void 0?"":"a=maxptime:".concat(B).concat(this.eol)}printDirection(B){return B===void 0?"":"a=".concat(B).concat(this.eol)}printSSRC(B){return B.map(le=>Object.keys(le.attributes).map(he=>"a=ssrc:".concat(le.ssrcId.toString(10)).concat(_).concat(he).concat(le.attributes[he]?":".concat(le.attributes[he]):"").concat(this.eol)).join("")).join("")}printRTCPMux(B){return B===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(B){return B===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(B){return B===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(B){if(B===void 0)return"";let le="a=rtcp:".concat(B.port);return B.netType&&(le+="".concat(_).concat(B.netType)),B.addressType&&(le+="".concat(_).concat(B.addressType)),B.address&&(le+="".concat(_).concat(B.address)),le+this.eol}printMSId(B){return B.map(le=>"a=msid:".concat(le.id).concat(le.appdata?"".concat(_).concat(le.appdata):"").concat(this.eol)).join("")}printImageattr(B){return B.map(le=>"a=imageattr:".concat(le).concat(this.eol)).join("")}printRid(B){return B.map(le=>{let he="a=rid:".concat(le.id).concat(_).concat(le.direction);return le.payloads&&(he+="".concat(_,"pt=").concat(le.payloads.join(","))),le.params.length>0&&(he+="".concat(_).concat(le.params.map(Ue=>Ue.type==="depend"?"depend=".concat(Ue.rids.join(",")):"".concat(Ue.type,"=").concat(Ue.val)).join(";"))),he+this.eol}).join("")}printSimulcast(B){return B===void 0?"":"a=simulcast:".concat(B).concat(this.eol)}printSCTPPort(B){return B===void 0?"":"a=sctp-port:".concat(B).concat(this.eol)}printMaxMessageSize(B){return B===void 0?"":"a=max-message-size:".concat(B).concat(this.eol)}printMid(B){return B===void 0?"":"a=mid:".concat(B).concat(this.eol)}printSSRCGroups(B){return B.map(le=>"a=ssrc-group:".concat(le.semantic).concat(le.ssrcIds.map(he=>"".concat(_).concat(he.toString(10))).join("")).concat(this.eol)).join("")}}function Fe(Oe){return new Ae().parse(Oe)}function Xe(Oe,B){return new bn().print(Oe,B)}}},a={};function s(l){if(a[l])return a[l].exports;var d=a[l]={exports:{}};return r[l](d,d.exports,s),d.exports}return s.d=(l,d)=>{for(var f in d)s.o(d,f)&&!s.o(l,f)&&Object.defineProperty(l,f,{enumerable:!0,get:d[f]})},s.o=(l,d)=>Object.prototype.hasOwnProperty.call(l,d),s.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},s(8)})();function ss(r){return Dz.parse(r)}function ph(r,a){return Dz.print(r,a)}var V1e=ac("Array","keys"),B1e=rh,$1e=aa,W1e=T,G1e=V1e,Ij=Array.prototype,H1e={DOMTokenList:!0,NodeList:!0},z1e=function(r){var a=r.keys;return r===Ij||W1e(Ij,r)&&a===Ij.keys||$1e(H1e,B1e(r))?G1e:a},os=o(z1e);function fr(r,a,s){return(a=function(l){var d=function(f,m){if(typeof f!="object"||!f)return f;var y=f[Symbol.toPrimitive];if(y!==void 0){var _=y.call(f,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(l);return typeof d=="symbol"?d:d+""}(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}function Lz(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Wt(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Lz(Object(s),!0).forEach(function(l){fr(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Lz(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const Mz=new class extends lr{constructor(){super(...arguments),fr(this,"currentUploadLogID",0)}reportLogUploadError(r){const{errorRange:a}=r;a[a.length-1]&&a[a.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=a[a.length-1],this.emit("REPORT_LOG_UPLOAD",r))}};class K1e{constructor(a){fr(this,"logger",void 0),fr(this,"prefixLists",[]),this.logger=a}debug(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.debug(...this.prefixLists,...s)}info(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.info(...this.prefixLists,...s)}warning(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.warning(...this.prefixLists,...s)}error(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.error(...this.prefixLists,...s)}prefix(a){return this.prefixLists.push(a),this}popPrefix(){return this.prefixLists.pop(),this}}function Oj(){const r=new Date;return r.toTimeString().split(" ")[0]+":"+r.getMilliseconds()}function Uz(){const r=new Date,a=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return a?(a==null?void 0:a[0])+":"+r.getUTCMilliseconds():r.toTimeString().split(" ")[0]+":"+r.getMilliseconds()}const Ro={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Kx=Date.now(),fb=r=>{for(const a in Ro)if(Object.prototype.hasOwnProperty.call(Ro,a)&&Ro[a]===r)return a;return"DEFAULT"},F=new class{constructor(){fr(this,"proxyServerURL",void 0),fr(this,"logLevel",Ro.DEBUG),fr(this,"uploadState","collecting"),fr(this,"uploadLogWaitingList",[]),fr(this,"uploadLogUploadingList",[]),fr(this,"uploadErrorCount",0),fr(this,"currentLogID",0),fr(this,"url",void 0),fr(this,"extLog",(r,a)=>{this.appendLogToWaitingList(r,...a)})}debug(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[Ro.DEBUG].concat(a);this.log.apply(this,l)}info(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[Ro.INFO].concat(a);this.log.apply(this,l)}warning(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[Ro.WARNING].concat(a);this.log.apply(this,l)}warn(){this.warning(...arguments)}error(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[Ro.ERROR].concat(a);this.log.apply(this,l)}upload(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[Ro.DEBUG].concat(a);this.uploadLog.apply(this,l)}setLogLevel(r){r=Math.min(Math.max(0,r),4),this.logLevel=r}enableLogUpload(){An("UPLOAD_LOG",!0)}disableLogUpload(){An("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(r){this.proxyServerURL=r}prefix(r){return new K1e(this).prefix(r)}log(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];if(Date.now()-Kx<100)return void setTimeout(()=>{this.log(...a)},Date.now()-Kx);const l=Math.max(0,Math.min(4,a[0]));if(a[0]=Oj()+" Agora-SDK [".concat(fb(l),"]:"),this.appendLogToWaitingList(l,...a),l<this.logLevel)return;const d=Oj()+" %cAgora-SDK [".concat(fb(l),"]:");let f=[];if(!se("USE_NEW_LOG"))switch(l){case Ro.DEBUG:f=[d,"color: #64B5F6;"].concat(a.slice(1)),console.log.apply(console,f);break;case Ro.INFO:f=[d,"color: #1E88E5; font-weight: bold;"].concat(a.slice(1)),console.log.apply(console,f);break;case Ro.WARNING:f=[d,"color: #FB8C00; font-weight: bold;"].concat(a.slice(1)),console.warn.apply(console,f);break;case Ro.ERROR:f=[d,"color: #B00020; font-weight: bold;"].concat(a.slice(1)),console.error.apply(console,f)}}uploadLog(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];if(Date.now()-Kx<100)return void setTimeout(()=>{this.uploadLog(...a)},Date.now()-Kx);const l=Math.max(0,Math.min(4,a[0]));a[0]=Oj()+" Agora-SDK [".concat(fb(l),"]:"),this.appendLogToWaitingList(l,...a)}appendLogToWaitingList(r){if(!se("UPLOAD_LOG"))return;for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];Array.isArray(s[0])?s[0][0]=Uz()+" Agora-SDK [".concat(fb(r),"]:"):s[0]=Uz()+" Agora-SDK [".concat(fb(r),"]:");let d="";s.forEach(f=>{typeof f=="object"&&(f=JSON.stringify(f)),d+="".concat(f," ")}),this.uploadLogWaitingList.push({payload_str:d,log_level:r,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const r=this.uploadLogUploadingList,a={sdk_version:Co,process_id:se("PROCESS_ID"),payload:JSON.stringify(r)};return il(async()=>{const s=await Ka.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(se("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(se("LOG_UPLOAD_SERVER"),"/upload/v1")),a,{responseType:"text"});if(s.data!=="OK"){const l=new Error("unexpected upload log response");throw l.response=s,l}},()=>(this.uploadLogUploadingList=[],!1),s=>{const l={status:-1,message:s.message,errorRange:r.map(d=>d.log_item_id)};return s.response?(l.status=s.response.status,l.data=s.response.data,l.headers=s.response.headers):s.request&&(l.status=s.request.status),Mz.reportLogUploadError(l),!0},{timeout:se("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:se("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,se("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),se("UPLOAD_LOG_INTERVAL"))}).catch(r=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),se("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),se("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var Fz;function q1e(r){return Ti(r.reportId,"params.reportId",0,100,!1),Ti(r.category,"params.category",0,100,!1),Ti(r.event,"params.event",0,100,!1),Ti(r.label,"params.label",0,100,!1),kn(r.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(Fz={}).FREE="free",Fz.UPLOADING="uploading",function(r){r[r.MISC=0]="MISC",r[r.INTERNAL_EVENT=1]="INTERNAL_EVENT",r[r.PUBLIC_EVENT=2]="PUBLIC_EVENT",r[r.WEB_EVENT=3]="WEB_EVENT",r[r.INTERNAL_API=4]="INTERNAL_API",r[r.WEB_API=5]="WEB_API",r[r.PUBLIC_API=6]="PUBLIC_API"}({});const Y1e={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let ri=function(r){return r.PUBLISH="publish",r.SUBSCRIBE="subscribe",r.WS_COMPRESSOR_INIT="ws_compressor_init",r.SESSION_INIT="session_init",r.JOIN_CHOOSE_SERVER="join_choose_server",r.REQ_USER_ACCOUNT="req_user_account",r.JOIN_GATEWAY="join_gateway",r.REJOIN_GATEWAY="rejoin_gateway",r.STREAM_SWITCH="stream_switch",r.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",r.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",r.FIRST_VIDEO_RECEIVED="first_video_received",r.FIRST_AUDIO_RECEIVED="first_audio_received",r.FIRST_VIDEO_DECODE="first_video_decode",r.FIRST_AUDIO_DECODE="first_audio_decode",r.XLA_PEER_FIRST_VIDEO_FRAME="xla_peer_first_video_frame",r.ON_ADD_AUDIO_STREAM="on_add_audio_stream",r.ON_ADD_VIDEO_STREAM="on_add_video_stream",r.ON_UPDATE_STREAM="on_update_stream",r.ON_REMOVE_STREAM="on_remove_stream",r.USER_ANALYTICS="req_user_analytics",r.PC_STATS="pc_stats",r.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",r.AB_TEST="ab_test",r}({}),Qn=function(r){return r.SESSION="io.agora.pb.Wrtc.Session",r.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",r.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",r.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",r.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",r.PUBLISH="io.agora.pb.Wrtc.Publish",r.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",r.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",r.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",r.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",r.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",r.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",r.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",r.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",r.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",r.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",r.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",r.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",r.XLA_PEER_FIRST_VIDEO_FRAME="io.agora.pb.Wrtc.XLAPeerFirstVideoFrame",r.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",r.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",r.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",r.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",r.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",r.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",r.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",r.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",r.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",r.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",r.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",r.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",r.PC_STATS="io.agora.pb.Wrtc.PCStats",r.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",r.AB_TEST="io.agora.pb.Wrtc.ABTest",r}({});(function(r){r[r.WORKER_EVENT=156]="WORKER_EVENT",r[r.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let X1e=function(r){return r[r.SESSION=26]="SESSION",r[r.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",r[r.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",r[r.JOIN_GATEWAY=28]="JOIN_GATEWAY",r[r.PUBLISH=30]="PUBLISH",r[r.SUBSCRIBE=29]="SUBSCRIBE",r[r.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",r[r.STREAM_SWITCH=32]="STREAM_SWITCH",r[r.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",r[r.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",r[r.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",r[r.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",r[r.API_INVOKE=41]="API_INVOKE",r[r.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",r[r.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",r[r.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",r[r.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",r[r.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",r[r.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",r[r.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",r[r.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",r[r.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",r[r.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",r[r.WORKER_EVENT=156]="WORKER_EVENT",r[r.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",r[r.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",r[r.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",r[r.USER_ANALYTICS=1e4]="USER_ANALYTICS",r[r.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",r}({});function Et(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(a,s,l){const d=l.value;if(typeof d=="function"){const f=r.className||a.__className__||(a.constructor.name==="AgoraRTCClient"?"Client":a.constructor.name);l.value=function(){for(var m,y=arguments.length,_=new Array(y),w=0;w<y;w++)_[w]=arguments[w];let x=_;if(r.argsMap)try{x=r.argsMap(this,..._)}catch(I){F.warning(I),x=[]}try{JSON.stringify(x)}catch{F.warning("arguments for method ".concat(f,".").concat(String(s)," not serializable for apiInvoke.")),x=[]}const A=(r.report||nt).reportApiInvoke(this._sessionId||null,{id:this._clientId||((m=this.store)===null||m===void 0?void 0:m.clientId)||this._ID,name:"".concat(f,".").concat(String(s)),options:x,tag:rr.TRACER,reportResult:r.reportResult},r.throttleTime);try{const I=d.apply(this,_);return I instanceof Ge?I.then(L=>(A.onSuccess(r.reportResult&&L),L)).catch(L=>{throw A.onError(L),L}):(A.onSuccess(r.reportResult&&I),I)}catch(I){throw A.onError(I),I}}}return l}}const nt=new class{constructor(){fr(this,"baseInfoMap",new Map),fr(this,"proxyServer",void 0),fr(this,"eventUploadTimer",void 0),fr(this,"setSessionIdTimer",void 0),fr(this,"url",void 0),fr(this,"sids",new Set),fr(this,"backupUrl",void 0),fr(this,"_appId",void 0),fr(this,"_aid",0),fr(this,"keyEventUploadPendingItems",[]),fr(this,"normalEventUploadPendingItems",[]),fr(this,"apiInvokeUploadPendingItems",[]),fr(this,"apiInvokeCount",0),fr(this,"apiInvokeLoggedCount",0),fr(this,"ltsList",[]),fr(this,"lastSendNormalEventTime",Date.now()),fr(this,"customReportCounterTimer",void 0),fr(this,"customReportCount",0),fr(this,"extApiInvoke",async r=>{for(const a of r){const s=Wt(Wt({},a),{},{sid:null,invokeId:++this.apiInvokeCount,tag:rr.TRACER});this.sendApiInvoke(s)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),se("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),se("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(r){return this.baseInfoMap.get(r)}setAppId(r){this._appId=r,this._aid=parseInt(r.replace(/[a-fA-F0-9]{8}/g,a=>{let[s,l]=a;return s+l}),16)||0}reportApiInvoke(r,a,s){a.timeout=a.timeout||6e4,a.reportResult=a.reportResult===void 0||a.reportResult;const l=Date.now();this.apiInvokeCount+=1;const d=this.apiInvokeCount,f=!!se("SHOW_REPORT_INVOKER_LOG"),m=!!se("SHOW_REPORT_USER_INVOKER_LOG"),y=f||m&&a.id;y&&(this.apiInvokeLoggedCount+=1);const _=this.apiInvokeLoggedCount;function w(L,H){if(y){let $="[apiInvoke-".concat(_,"]");if(a.id&&($+="[".concat(a.id,"]")),a.name&&($+="[".concat(a.name,"]"),a.name===Er.JOIN))return F.info("".concat($," ").concat(L));F.info("".concat($," ").concat(L),L==="start"?a.options:H||"")}}const x=()=>({tag:a.tag,invokeId:d,sid:r,name:a.name,apiInvokeTime:l,options:a.options,states:a.states||null});w("start");let A=!1;Ci(a.timeout).then(()=>{A||(this.sendApiInvoke(Wt(Wt({},x()),{},{error:ie.API_INVOKE_TIMEOUT,success:!1})),w("timeout"))});const I=new Se(ie.UNEXPECTED_ERROR,"".concat(a.name,": this api invoke is end"));return{onSuccess:L=>{const H=()=>{if(A)throw I;return A=!0,this.sendApiInvoke(Wt(Wt({},x()),{},{success:!0},a.reportResult&&{result:L})),w("onSuccess"),L};return s?yz(H,a.name+"Success",s,()=>A=!0):H()},onError:L=>{const H=()=>{if(A)throw L;A=!0,this.sendApiInvoke(Wt(Wt({},x()),{},{success:!1,error:L})),w("onFailure",L.toString())};return s?yz(H,a.name+"Error",s,()=>A=!0):H()}}}sessionInit(r,a){if(this.baseInfoMap.has(r))return;const s=Date.now(),l=this.createBaseInfo(r,s);l.cname=a.cname;const d=Object.assign({},{willUploadConsoleLog:se("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Cj?"global":"oversea",areas:se("AREAS")&&se("AREAS").join(",")},a.extend),{stringUid:f,channelProfile:m,channelMode:y,isABTestSuccess:_,lsid:w,clientRole:x}=a,A=Date.now(),I=Wt(Wt({},l),{},{eventType:ri.SESSION_INIT,appid:a.appid,browser:navigator.userAgent,buildFormat:a.buildFormat,build:Nj,lts:A,elapse:A-s,extend:JSON.stringify(d),mode:a.mode,process:se("PROCESS_ID"),appType:se("APP_TYPE"),success:!0,version:Co,stringUid:f,channelProfile:m,channelMode:y,isABTestSuccess:_,lsid:w,clientType:Ve(L=window.navigator.userAgent).call(L,"AgoraWebView")?42:20,clientRole:x,serviceId:se("PROCESS_ID"),extensionID:se("PLUGIN_INFO").join(",")||""});var L;this.send({type:Qn.SESSION,data:I},!0)}joinChooseServer(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{role:a.role,eventType:ri.JOIN_CHOOSE_SERVER,lts:d,eventElapse:a.elapse||d-a.lts,chooseServerAddr:a.csAddr,errorCode:a.ec,elapse:d-s.startTime,success:a.succ,chooseServerAddrList:JSON.stringify(a.serverList),uid:a.uid?parseInt(a.uid):null,cid:a.cid?parseInt(a.cid):null,chooseServerIp:a.csIp||"",opid:a.opid,unilbsServerIds:a.unilbsServerIds,extend:a.extend||void 0,isHttp3:a.isHttp3,corssRegionTagReq:a.corssRegionTagReq||void 0,corssRegionTagRes:a.corssRegionTagRes||void 0,resourceTimingInfo:a.resourceTimingInfo||void 0});this.send({type:Qn.JOIN_CHOOSE_SERVER,data:f},!0)}reqUserAccount(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ri.REQ_USER_ACCOUNT,lts:d,success:a.success,serverAddress:a.serverAddr,stringUid:a.stringUid,uid:a.uid,errorCode:a.errorCode,elapse:a.elapse||d-s.startTime,eventElapse:d-a.lts,extend:JSON.stringify(a.extend)});this.send({type:Qn.REQ_USER_ACCOUNT,data:f},!0)}joinGateway(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info;a.vid&&(l.vid=a.vid),l.uid=a.uid,l.cid=a.cid;const d=Date.now(),{firstSuccess:f,addr:m,isProxy:y}=a,_=d-s.startTime,w=Wt(Wt({},l),{},{eventType:ri.JOIN_GATEWAY,lts:d,gatewayAddr:a.addr,success:a.succ,errorCode:a.ec,errorMsg:a.errorMsg||"",elapse:_,eventElapse:d-a.lts,firstSuccess:f,signalChannel:a.signalChannel,preload:a.preload?1:0,installId:Tj(),isABTestSuccess:a.isABTestSuccess?1:0}),x=w.success?1:0;if(a.succ&&(s.lastJoinSuccessTime=d),f)this.send({type:Qn.JOIN_GATEWAY,data:w},!0);else{let A;if(m)if(y){const L=m.match(/h=(\d{1,3}-){3}\d{1,3}/g),H=m.match(/p=[0-9]{1,6}/g);A={isSuccess:x,gatewayIp:L&&L.length?L[0].split("=")[1].replace(/-/g,"."):"",port:H&&H.length?H[0].split("=")[1]:"",isProxy:y?1:0}}else{const L=m.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),H=m.match(/(:|p=)[0-9]{1,6}/g);A={isSuccess:x,gatewayIp:L&&L.length?L[0].split("//")[1].replace(/-/g,"."):"",port:H&&H.length?H[0].split(/:|p=/g)[1]:"",isProxy:y?1:0}}else A={isSuccess:x,gatewayIp:"",port:"",isProxy:y?1:0};delete w.success,delete w.eventType,delete w.firstSuccess,w.vid=Number(w.vid);const I=Object.assign({},w,A,{eventType:ri.REJOIN_GATEWAY});this.send({type:Qn.RE_JOIN_GATEWAY,data:I},!0)}}joinChannelTimeout(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=Date.now(),d=Wt(Wt({},s.info),{},{lts:l,timeout:a,elapse:l-s.startTime});this.send({type:Qn.JOIN_CHANNEL_TIMEOUT,data:d},!0)}publish(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ri.PUBLISH,lts:d,eventElapse:a.eventElapse,elapse:d-s.startTime,success:a.succ,errorCode:a.ec,videoName:a.videoName,audioName:a.audioName,screenName:a.screenName,screenshare:a.screenshare,audio:a.audio,video:a.video,p2pid:a.p2pid,publishRequestid:a.publishRequestid});this.send({type:Qn.PUBLISH,data:f},!0)}subscribe(r,a,s){const l=this.baseInfoMap.get(r);if(!l)return;const d=l.info,f=Date.now(),m=Wt(Wt({},d),{},{eventType:ri.SUBSCRIBE,lts:f,eventElapse:a.eventElapse,elapse:f-l.startTime,success:a.succ,errorCode:a.ec,video:a.video,audio:a.audio,subscribeRequestid:a.subscribeRequestid,p2pid:a.p2pid,preSsrc:a.preSsrc?1:0},s&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof a.peerid=="string"?m.peerSuid=a.peerid:m.peer=a.peerid,this.send({type:Qn.SUBSCRIBE,data:m},!0)}wsCompressorInit(r){var a;const s=[...os(a=this.baseInfoMap).call(a)],l=s.length?s[0]:"UnableToGetSid",d=this.baseInfoMap.get(l);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt({},f),{},{eventType:ri.WS_COMPRESSOR_INIT,lts:m,eventElapse:r.eventElapse,elapse:m-d.startTime,status:r.status?1:2});this.send({type:Qn.WS_COMPRESSOR_INIT,data:y},!0)}firstXLAPeerFirstVideoFrame(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=a.peerPubStatusMs-(s.lastJoinSuccessTime||d),m=Wt(Wt({},l),{},{elapse:d-s.startTime,eventType:ri.XLA_PEER_FIRST_VIDEO_FRAME,lts:d,peer:a.peer,width:a.width,height:a.height,ssrc:a.ssrc,p2pid:a.p2pid,peerPublishDuration:a.peerPublishDuration,joinChannelSuccessElapse:f,peerPubStatusMs:a.peerPubStatusMs-a.joinChannelStart,availablePublish:a.peerPublishDuration>f?1:0,preloadStart:Math.max(a.preloadStart-a.joinChannelStart,0),preloadEnd:Math.max(a.preloadEnd-a.joinChannelStart,0),encrypt:Math.max(a.apStart-a.joinChannelStart,0),ap:Math.max(a.apEnd-a.joinChannelStart,0),sua:Math.max(a.suaEnd-a.joinChannelStart,0),beforeConnect:Math.max(a.beforeConnect-a.joinChannelStart,0),peerRecevier:Math.max(a.peerReceiver-a.joinChannelStart,0),ice:Math.max(a.ice-a.joinChannelStart,0),pc:Math.max(a.pc-a.joinChannelStart,0),signalConnected:Math.max(a.signalConnected-a.joinChannelStart,0),joinReq:Math.max(a.joinReq-a.joinChannelStart,0),joinRes:Math.max(a.joinRes-a.joinChannelStart,0),userJoinNotify:Math.max(a.userJoinNotify-a.joinChannelStart,0),videoSsrcNotify:Math.max(a.videoAddNotify-a.joinChannelStart,0),subscribeDelayMs:Math.max(a.subscribeStart-a.videoAddNotify,0),subscribeStart:Math.max(a.subscribeStart-a.joinChannelStart,0),subscribeEnd:Math.max(a.subscribeEnd-a.joinChannelStart,0),firstReceived:Math.max(a.firstReceived-a.joinChannelStart,0),firstDecoded:Math.max(a.firstDecoded-a.joinChannelStart,0),firstPreRender:Math.max(a.firstPreRender-a.joinChannelStart,0),firstRender:Math.max(a.firstRender-a.joinChannelStart,0),playDelayMs:Math.max(a.playStart-a.subscribeEnd,0),playStart:Math.max(a.playStart-a.joinChannelStart,0),playEnd:Math.max(a.playEnd-a.joinChannelStart,0),isPreSub:a.isPreSub?1:0,isPrePc:a.isPrePc?1:0,isPreInstantVideo:a.isPreInstantVideo?1:0});this.send({type:Qn.XLA_PEER_FIRST_VIDEO_FRAME,data:m},!0)}firstRemoteVideoDecode(r,a,s,l){const d=this.baseInfoMap.get(r);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt(Wt({},f),l),{},{elapse:m-d.startTime,eventType:a,lts:m,firstDecodeFrame:Math.max((l.firstFrame||m)-d.startTime,0),apEnd:Math.max(l.apEnd-d.startTime,0),apStart:Math.max(l.apStart-d.startTime,0),joinGwEnd:Math.max(l.joinGwEnd-d.startTime,0),joinGwStart:Math.max(l.joinGwStart-d.startTime,0),pcEnd:Math.max(l.pcEnd-d.startTime,0),pcStart:Math.max(l.pcStart-d.startTime,0),subscriberEnd:Math.max(l.subscriberEnd-d.startTime,0),subscriberStart:Math.max(l.subscriberStart-d.startTime,0),videoAddNotify:Math.max(l.videoAddNotify-d.startTime,0)});this.send({type:s,data:y},!0)}firstRemoteFrame(r,a,s,l){const d=this.baseInfoMap.get(r);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt(Wt({},f),l),{},{elapse:m-d.startTime,eventType:a,lts:m});this.send({type:s,data:y},!0)}abTest(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{vid:l.vid===void 0?0:Number(l.vid),elapse:d-s.startTime,eventType:ri.AB_TEST,lts:d});this.send({type:Qn.AB_TEST,data:f},!0)}pcStats(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{vid:l.vid===void 0?0:Number(l.vid),elapse:d-s.startTime,eventType:ri.PC_STATS,lts:d,preallocation:a.preallocation?1:0});this.send({type:Qn.PC_STATS,data:f},!0)}updateRemoteRTPCapabilities(r,a){if(r){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{vid:l.vid===void 0?0:Number(l.vid),eventType:ri.UPDATE_REMOTE_RTPCAPABILITIES,lts:d});this.send({type:Qn.UPDATE_REMOTE_RTPCAPABILITIES,data:f},!0)}}onGatewayStream(r,a,s,l){const d=this.baseInfoMap.get(r);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt(Wt({},f),l),{},{eventType:a,lts:m});this.send({type:s,data:y},!0)}streamSwitch(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ri.STREAM_SWITCH,lts:d,isDual:a.isdual,elapse:d-s.startTime,success:a.succ});this.send({type:Qn.STREAM_SWITCH,data:f},!0)}requestProxyAppCenter(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ri.REQUEST_PROXY_APPCENTER,lts:d,eventElapse:d-a.lts,elapse:d-s.startTime,APAddr:a.APAddr,workerManagerList:a.workerManagerList,response:a.response,errorCode:a.ec,success:a.succ});this.send({type:Qn.REQUEST_PROXY_APPCENTER,data:f},!0)}requestProxyWorkerManager(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ri.REQUEST_PROXY_WORKER_MANAGER,lts:d,eventElapse:d-a.lts,elapse:d-s.startTime,workerManagerAddr:a.workerManagerAddr,response:a.response,errorCode:a.ec,success:a.succ});this.send({type:Qn.REQUEST_PROXY_WORKER_MANAGER,data:f},!0)}setProxyServer(r){this.proxyServer=r,r?F.debug("reportProxyServerurl: ".concat(r)):F.debug("disable reportProxyServerurl: ".concat(r))}peerPublishStatus(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{subscribeElapse:a.subscribeElapse,peer:a.peer,peerPublishDuration:Math.max(a.audioPublishDuration,a.videoPublishDuration),audiotag:a.audioPublishDuration>0?1:-1,videotag:a.videoPublishDuration>0?1:-1,lts:d,elapse:d-s.startTime,joinChannelSuccessElapse:d-(s.lastJoinSuccessTime||d),peerPublishDurationVideo:a.videoPublishDuration,peerPublishDurationAudio:a.audioPublishDuration});this.send({type:Qn.PEER_PUBLISH_STATUS,data:f},!0)}workerEvent(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now();(function(f,m,y){const _=f[m];if(!_||typeof _!="string")return[f];f[m]="";const w=tu(JSON.stringify(f));let x=0;const A=[];let I=0;for(let L=0;L<_.length;L++)I+=_.charCodeAt(L)<=127?1:3,I<=y-w||(A[A.length]=Me(Me({},f),{},{[m]:_.substring(x,L)}),x=L,I=_.charCodeAt(L)<=127?1:3);return x!==_.length-1&&(A[A.length]=Me(Me({},f),{},{[m]:_.substring(x)})),A})(Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d,productType:"WebRTC"}),"payload",1300).forEach(f=>this.send({type:Qn.WORKER_EVENT,data:f},!0))}apworkerEvent(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d});this.send({type:Qn.AP_WORKER_EVENT,data:f},!0)}joinWebProxyAP(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d,extend:a.extend||void 0});this.send({type:Qn.JOIN_WEB_PROXY_AP,data:f},!0)}WebSocketQuit(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d});this.send({type:Qn.WEBSOCKET_QUIT,data:f},!0)}async sendCustomReportMessage(r,a){if(this.customReportCount+=a.length,this.customReportCount>se("CUSTOM_REPORT_LIMIT"))throw new Se(ie.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const s=Date.now(),l=a.map(d=>({type:Qn.USER_ANALYTICS,data:Wt(Wt({sid:r},d),{},{lts:s})}));try{se("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(l):await this.postDataToStatsCollector(l)}catch(d){throw F.error("send custom report message failed",d.toString()),new Se(ie.CUSTOM_REPORT_SEND_FAILED,d.message)}}sendApiInvoke(r){const a=se("NOT_REPORT_EVENT");if(r.tag&&Ve(a)&&Ve(a).call(a,r.tag))return!1;if(r.sid===null)return this.apiInvokeUploadPendingItems.push(r),!1;const s=this.baseInfoMap.get(r.sid);if(!s)return this.apiInvokeUploadPendingItems.push(r),!1;const{cname:l,uid:d,cid:f}=s.info;let m;if(r.lts=r.lts||Date.now(),r.error)if(r.error instanceof Se){const{code:_,message:w}=r.error;m=_||w||r.error.toString()}else m=r.error.toString();const y={invokeId:r.invokeId,sid:r.sid,cname:l,cid:f,uid:d,lts:r.lts,success:r.success,elapse:r.lts-s.startTime,execElapse:r.lts-r.apiInvokeTime,apiName:r.name,options:r.options?JSON.stringify(r.options):void 0,execStates:r.states?JSON.stringify(r.states):void 0,execResult:r.result?JSON.stringify(r.result):void 0,errorCode:r.error?m:void 0,errorMsg:r.error?JSON.stringify(r.error):void 0};return this.send({type:Qn.API_INVOKE,data:y},!1),!0}addSid(r){this.sids.add(r)}removeSid(r){this.sids.delete(r)}appendSessionId(){const r=this.apiInvokeUploadPendingItems;if(r.length===0)return;const a=Array.from(this.sids).find(s=>s!==null);a&&r.forEach(s=>{s&&(s.sid=a,this.sendApiInvoke(Object.assign({},s)))}),r.length=0}send(r,a){if(a)return this.keyEventUploadPendingItems.push(r),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(r),this.normalEventUploadPendingItems.length>se("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(r,a){const s=[],l=[];for(;r.length;){const f=r.shift();s.length<20?s.push(f):l.push(f)}r.push(...l);for(const f of[...s]){var d;this.ltsList.indexOf(f.data.lts)!==-1?(f.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(f.data.lts)):(this.ltsList.push(f.data.lts),Yf(d=this.ltsList).call(d,(m,y)=>m-y))}return a||(this.lastSendNormalEventTime=Date.now()),se("ENABLE_EVENT_REPORT")&&s.length&&(se("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(s):this.postDataToStatsCollector(s)).catch((f=>m=>{se("EVENT_REPORT_RETRY")&&(a?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(f):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(f),this.normalEventUploadPendingItems.length>se("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-se("NORMAL_EVENT_QUEUE_CAPACITY")),F.warning("report: drop normal events"))))})(s)),r}async postDataToStatsCollector2(r){Dr.networkState===Is.OFFLINE&&await Ge.race([Dr.onlineWaiter,Ci(2*Gr.maxRetryTimeout)]);const a=d=>{let f=new Uint8Array;return d.forEach(m=>{const y=fj(JSON.stringify(m.data)),_=new ArrayBuffer(5),w=(A=>{let I=0;return Object.entries(Qn).forEach(L=>{let[H,$]=L;$===A.type&&(I=X1e[H])}),I})(m),x=new DataView(_);x.setUint16(0,y.byteLength,!0),x.setUint8(2,255&w),x.setUint8(3,w>>>8&255),x.setUint8(4,w>>>16&255),f=lz(f,new Uint8Array(_)),f=lz(f,y)}),f},s="event";let l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(se("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(s):"https://".concat(se("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(s);for(let d=0;d<2;d+=1){d===1&&(l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(se("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(s):"https://".concat(se("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(s));try{await bj(l,{timeout:1e4,data:a(r),headers:Wt(Wt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(f){if(d===1)throw f;continue}return}}async postDataToStatsCollector(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=(y=>{const _=y&&y.data.sid&&this.baseInfoMap.get(y.data.sid);return _&&_.info.vid&&+_.info.vid||0})(r[0]),l=s?void 0:this._aid,d={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:r.map(y=>JSON.stringify(y)),vid:s,aid:l};Dr.networkState===Is.OFFLINE&&await Ge.race([Dr.onlineWaiter,Ci(2*Gr.maxRetryTimeout)]);const f=a?"/events/proto-raws":"/events/messages";let m=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(se("EVENT_REPORT_DOMAIN"),"&p=").concat(se("STATS_COLLECTOR_PORT"),"&d=").concat(f):"https://".concat(se("EVENT_REPORT_DOMAIN"),":").concat(se("STATS_COLLECTOR_PORT")).concat(f));for(let y=0;y<2;y+=1){y===1&&(m=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(se("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(se("STATS_COLLECTOR_PORT"),"&d=").concat(f):"https://".concat(se("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(se("STATS_COLLECTOR_PORT")).concat(f)));try{a?await D1e(m,{timeout:1e4,data:d}):await bj(m,{timeout:1e4,data:d})}catch(_){if(y===1)throw _;continue}return}}createBaseInfo(r,a){const s=Object.assign({},Y1e);return s.sid=r,this.baseInfoMap.set(r,{info:s,startTime:a}),s}reportResourceTiming(r,a){const s=performance.getEntriesByName(r),l=s[s.length-1];l&&this.reportApiInvoke(a,{name:"Client.resourceTiming",options:l,tag:rr.TRACER}).onSuccess()}};Mz.on("REPORT_LOG_UPLOAD",r=>{r.networkState=Dr.networkState,nt.reportApiInvoke(null,{name:"logUploadError",options:r,tag:rr.TRACER}).onSuccess("logUploadError")});class Ee extends Se{constructor(a){super(a,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),fr(this,"name","AgoraRTCException")}print(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(a,F)}throw(){super.throw(F)}}const Ri={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function un(){return Ri}function Vz(){return"setSinkId"in HTMLAudioElement.prototype&&(!se("RESTRICTION_SET_PLAYBACK_DEVICE")||(rd()||JH())&&!uj())}function qx(){return!Ri.supportUnifiedPlan||se("CHROME_FORCE_PLAN_B")&&id()}function Pj(r){return!(dr()||ZH(87)||qx()||!se("ENABLE_PRE_SUB")&&(r==null||!r.autoSubscribe||se("FORCE_DISABLE_AUTO_SUB")))}function Bz(r){return!!se("ENABLE_INSTANT_VIDEO")||!(r==null||!r.autoSubscribe||se("FORCE_DISABLE_AUTO_SUB"))}let Ni=function(r){return r.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",r.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",r.IOS_INTERRUPTION_START="ios-interruption-start",r.IOS_INTERRUPTION_END="ios-interruption-end",r.STATE_CHANGE="state-change",r}({});function xg(r,a,s){return{sampleRate:r,stereo:a,bitrate:s}}function dn(r,a,s,l,d){return{width:r,height:a,frameRate:s,bitrateMin:l,bitrateMax:d}}function mc(r,a,s,l,d){return{width:{max:r},height:{max:a},frameRate:s,bitrateMin:l,bitrateMax:d}}function kj(r,a){return{numSpatialLayers:r,numTemporalLayers:a}}const J1e={"90p":dn(160,90),"90p_1":dn(160,90),"120p":dn(160,120,15,30,65),"120p_1":dn(160,120,15,30,65),"120p_3":dn(120,120,15,30,50),"120p_4":dn(212,120),"180p":dn(320,180,15,30,140),"180p_1":dn(320,180,15,30,140),"180p_3":dn(180,180,15,30,100),"180p_4":dn(240,180,15,30,120),"240p":dn(320,240,15,40,200),"240p_1":dn(320,240,15,40,200),"240p_3":dn(240,240,15,40,140),"240p_4":dn(424,240,15,40,220),"360p":dn(640,360,15,80,400),"360p_1":dn(640,360,15,80,400),"360p_3":dn(360,360,15,80,260),"360p_4":dn(640,360,30,80,600),"360p_6":dn(360,360,30,80,400),"360p_7":dn(480,360,15,80,320),"360p_8":dn(480,360,30,80,490),"360p_9":dn(640,360,15,80,800),"360p_10":dn(640,360,24,80,800),"360p_11":dn(640,360,24,80,1e3),"480p":dn(640,480,15,100,500),"480p_1":dn(640,480,15,100,500),"480p_2":dn(640,480,30,100,1e3),"480p_3":dn(480,480,15,100,400),"480p_4":dn(640,480,30,100,750),"480p_6":dn(480,480,30,100,600),"480p_8":dn(848,480,15,100,610),"480p_9":dn(848,480,30,100,930),"480p_10":dn(640,480,10,100,400),"720p":dn(1280,720,15,120,1130),"720p_auto":dn(1280,720,30,900,3e3),"720p_1":dn(1280,720,15,120,1130),"720p_2":dn(1280,720,30,120,2e3),"720p_3":dn(1280,720,30,120,1710),"720p_5":dn(960,720,15,120,910),"720p_6":dn(960,720,30,120,1380),"1080p":dn(1920,1080,15,120,2080),"1080p_1":dn(1920,1080,15,120,2080),"1080p_2":dn(1920,1080,30,120,3e3),"1080p_3":dn(1920,1080,30,120,3150),"1080p_5":dn(1920,1080,60,120,4780),"1440p":dn(2560,1440,30,120,4850),"1440p_1":dn(2560,1440,30,120,4850),"1440p_2":dn(2560,1440,60,120,7350),"4k":dn(3840,2160,30,120,8910),"4k_1":dn(3840,2160,30,120,8910),"4k_3":dn(3840,2160,60,120,13500)},Z1e={"480p":mc(640,480,5),"480p_1":mc(640,480,5),"480p_2":mc(640,480,30),"480p_3":mc(640,480,15),"720p":mc(1280,720,5),"720p_auto":dn(1280,720,30,900,3e3),"720p_1":mc(1280,720,5),"720p_2":mc(1280,720,30),"720p_3":mc(1280,720,15),"1080p":mc(1920,1080,5),"1080p_1":mc(1920,1080,5),"1080p_2":mc(1920,1080,30),"1080p_3":mc(1920,1080,15)},Q1e={"1SL1TL":kj(1,1),"3SL3TL":kj(3,3),"2SL3TL":kj(2,3)};function gc(r){return r||(r="480p_1"),typeof r=="string"?Object.assign({},J1e[r]):r}function jj(r){return typeof r=="string"?Object.assign({},Z1e[r]):r}function Yx(r){return typeof r=="string"?Object.assign({},Q1e[r]):r}const eIe={speech_low_quality:xg(16e3,!1),speech_standard:xg(32e3,!1,18),music_standard:xg(48e3,!1),standard_stereo:xg(48e3,!0,56),high_quality:xg(48e3,!1,128),high_quality_stereo:xg(48e3,!0,192)};function Xx(r){return typeof r=="string"?Object.assign({},eIe[r]):r}const Tg=[];function $z(r){return ni(r,"mediaSource",["screen","window","application"]),!0}let Ze=function(r){return r.NEED_RENEGOTIATE="@need_renegotiate",r.NEED_REPLACE_TRACK="@need_replace_track",r.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",r.NEED_CLOSE="@need_close",r.NEED_ENABLE_TRACK="@need_enable_track",r.NEED_DISABLE_TRACK="@need_disable_track",r.NEED_SESSION_ID="@need_sid",r.SET_OPTIMIZATION_MODE="@set_optimization_mode",r.GET_STATS="@get_stats",r.GET_RTC_STATS="@get_rtc_stats",r.GET_LOW_VIDEO_TRACK="@get_low_video_track",r.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",r.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",r.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",r.NEED_MUTE_TRACK="@need_mute_track",r.NEED_UNMUTE_TRACK="@need_unmute_track",r}({}),jn=function(r){return r.SCREEN_TRACK="screen_track",r.CUSTOM_TRACK="custome_track",r.LOW_STREAM="low_stream",r.SCREEN_LOW_TRACK="screen_low_track",r}({}),Cg=function(r){return r[r.HIGH_STREAM=0]="HIGH_STREAM",r[r.LOW_STREAM=1]="LOW_STREAM",r}({}),tIe=function(r){return r[r.HIGH_STREAM=0]="HIGH_STREAM",r[r.LOW_STREAM=1]="LOW_STREAM",r[r.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",r[r.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",r[r.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",r[r.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",r[r.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",r[r.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",r}({}),nIe=function(r){return r[r.DISABLE=0]="DISABLE",r[r.LOW_STREAM=1]="LOW_STREAM",r[r.AUDIO_ONLY=2]="AUDIO_ONLY",r[r.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",r[r.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",r[r.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",r[r.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",r[r.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",r[r.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",r}({}),cp=function(r){return r.TRANSCEIVER_UPDATED="transceiver-updated",r.SEI_TO_SEND="sei-to-send",r.SEI_RECEIVED="sei-received",r.TRACK_UPDATED="track-updated",r}({}),Rg=function(r){return r.SOURCE_STATE_CHANGE="source-state-change",r.TRACK_ENDED="track-ended",r.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",r.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",r.CLOSED="closed",r}({}),No=function(r){return r.FIRST_FRAME_DECODED="first-frame-decoded",r.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",r.VIDEO_STATE_CHANGED="video-state-changed",r.PLAY_START="play-start",r.PLAY_END="play-end",r.FIRST_FRAME_RENDER="first-frame-render",r}({}),Ng=function(r){return r.AUDIO="audio",r.VIDEO="video",r.DATA="data",r}({}),Zs=function(r){return r.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",r.RECEIVE_TRACK_BUFFER="receive_track_buffer",r.ON_AUDIO_BUFFER="on_audio_buffer",r.UPDATE_SOURCE="update_source",r}({});(function(r){r.UPDATE_TRACK_SOURCE="update-track-source"})({});const Dj={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},Lj={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},Wz={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},rIe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},Gz={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let ja=function(r){return r.ON_TRACK="on_track",r.ON_NODE="on_node",r}({}),Qs=function(r){return r.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",r.REQUEST_CONSTRAINTS="request_constraints",r}({}),pb=function(r){return r.IDLE="IDLE",r.INITING="INITING",r.INITEND="INITEND",r}({}),lp=function(r){return r.STATE_CHANGE="state_change",r.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",r.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",r.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",r}({}),Hi=function(r){return r.NONE="none",r.INIT="init",r.CANPLAY="canplay",r.PLAYING="playing",r.PAUSED="paused",r.SUSPEND="suspend",r.STALLED="stalled",r.WAITING="waiting",r.ERROR="error",r.DESTROYED="destroyed",r.ABORT="abort",r.ENDED="ended",r.EMPTIED="emptied",r.LOADEDDATA="loadeddata",r}({}),ru=function(r){return r[r.VideoStateStopped=0]="VideoStateStopped",r[r.VideoStateStarting=1]="VideoStateStarting",r[r.VideoStateDecoding=2]="VideoStateDecoding",r[r.VideoStateFrozen=3]="VideoStateFrozen",r}({});const Mj={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let Jx=function(r){return r.OPEN="open",r.MESSAGE="message",r.CLOSE="close",r.CLOSING="closing",r.ERROR="error",r}({});function an(r,a,s,l,d){var f,m,y={};return Object.keys(l).forEach(function(_){y[_]=l[_]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=sc(f=N5(m=s.slice()).call(m)).call(f,function(_,w){return w(r,a,_)||_},y),d&&y.initializer!==void 0&&(y.value=y.initializer?y.initializer.call(d):void 0,y.initializer=void 0),y.initializer===void 0?(Object.defineProperty(r,a,y),null):y}function _e(r,a,s){return(a=function(l){var d=function(f,m){if(typeof f!="object"||!f)return f;var y=f[Symbol.toPrimitive];if(y!==void 0){var _=y.call(f,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(l);return typeof d=="symbol"?d:d+""}(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}function Hz(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Bn(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Hz(Object(s),!0).forEach(function(l){_e(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Hz(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class zz extends lr{set _mediaStreamTrack(a){a!==this.mediaStreamTrack&&(this.safeEmit(cp.TRACK_UPDATED,a),this.mediaStreamTrack=a)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(a,s){super(),_e(this,"trackMediaType",void 0),_e(this,"_ID",void 0),_e(this,"_rtpTransceiver",void 0),_e(this,"_lowRtpTransceiver",void 0),_e(this,"_hints",[]),_e(this,"_isClosed",!1),_e(this,"_originMediaStreamTrack",void 0),_e(this,"mediaStreamTrack",void 0),_e(this,"_external",{}),this._ID=s||Mn(8,"track-"),this._originMediaStreamTrack=a,this.mediaStreamTrack=a,function(l){Ve(Tg).call(Tg,l)||Tg.push(l)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(a){return a||hh(()=>{var s;nt.reportApiInvoke(null,{name:Er.GET_MEDIA_STREAM_TRACK,options:[],tag:rr.TRACER}).onSuccess(((s=this._mediaStreamTrack)===null||s===void 0?void 0:s.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(a){return a===Cg.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(a){const s=Tg.indexOf(a);s!==-1&&Tg.splice(s,1)}(this),this.emit(Rg.CLOSED),this.removeAllListeners(cp.SEI_RECEIVED)}_updateRtpTransceiver(a,s){if(s===Cg.LOW_STREAM){if(this._lowRtpTransceiver===a)return;this._lowRtpTransceiver=a}else{if(this._rtpTransceiver===a)return;this._rtpTransceiver=a}this.emit(cp.TRANSCEIVER_UPDATED,a,s)}}class Ag extends zz{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(a,s){super(a,s),_e(this,"_enabled",!0),_e(this,"_muted",!1),_e(this,"_isExternalTrack",!1),_e(this,"_isClosed",!1),_e(this,"_enabledMutex",void 0),_e(this,"processor",void 0),_e(this,"_processorContext",void 0),_e(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Gi("".concat(this.getTrackId())),a.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var a,s;return(a=(s=this._originMediaStreamTrack)===null||s===void 0?void 0:s.label)!==null&&a!==void 0?a:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,F.debug("[".concat(this.getTrackId(),"] close")),this.emit(Ze.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(a,s){let l=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=l,a!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),s&&this._originMediaStreamTrack.stop()),a.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=a,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,Ze.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){F.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Rg.TRACK_ENDED)}stateCheck(a,s){if(F.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(a,": ").concat(s,"]")),rl(s,a),this._enabled&&this._muted&&a==="enabled"&&s===!1)throw new Se(ie.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",F);if(!this._enabled&&!this._muted&&a==="muted"&&s===!0)throw new Se(ie.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",F)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():Ge.resolve([])}}const Kz=window.AudioContext||window.webkitAudioContext;let eo=null;const In=new class extends lr{constructor(){super(...arguments),_e(this,"prevState",void 0),_e(this,"curState",void 0),_e(this,"currentTime",void 0),_e(this,"currentTimeStuckAt",void 0),_e(this,"interruptDetectorTrack",void 0),_e(this,"onLocalAudioTrackMute",()=>{F.info("ios15-interruption-start"),this.emit(Ni.IOS_15_16_INTERRUPTION_START)}),_e(this,"onLocalAudioTrackUnmute",async()=>{F.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?F.info("ios15-interruption-end-canceled"):(eo&&await eo.suspend(),this.emit(Ni.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(r){F.debug("webaudio bindInterruptDetectorTrack ".concat(r.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=r,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(r){F.debug("webaudio unbindInterruptDetectorTrack ".concat(r.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===r&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Ig(){if(!eo){if(function(){if(!Kz)return void F.error("your browser is not support web audio");F.info("create audio context");const r=Bn({},se("WEBAUDIO_INIT_OPTIONS"));F.debug("audio context init option:",JSON.stringify(r)),eo=new Kz(r),In.curState=eo.state,eo.onstatechange=()=>{In.prevState=In.curState,In.curState=eo?eo.state:void 0;const{prevState:a,curState:s}=In,l=s==="running",d=s==="interrupted",f=a==="running",m=a==="suspended",y=a==="interrupted",_=sn().osVersion;(oa()||fc())&&f&&d&&(F.info("ios".concat(_,"-interruption-start")),In.emit(Ni.IOS_INTERRUPTION_START)),(oa()||fc())&&(m||y)&&l&&(F.info("ios".concat(_,"-interruption-end")),In.emit(Ni.IOS_INTERRUPTION_END)),a!==s&&In.emit(Ni.STATE_CHANGE,s,a)},setInterval(()=>{var a;const s=(a=eo)===null||a===void 0?void 0:a.currentTime;In.currentTime!==s?(In.currentTimeStuckAt&&(F.debug("AudioContext current time resume at ".concat(s)),In.currentTimeStuckAt=void 0),In.currentTime=s):(s!==In.currentTimeStuckAt&&(nt.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:s},tag:rr.TRACER}).onSuccess(),F.warning("AudioContext current time stuck at ".concat(s))),In.currentTimeStuckAt=s)},5e3),async function(a){const s=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let l,d=!1,f=!1,m=!1;function y($){a.state==="running"?_(!1):oa()||fc()?a.state==="suspended"&&(_(!0),$&&a.resume().then(w,w)):a.state!=="closed"&&(_(!0),$&&a.resume().then(w,w))}function _($){if(d!==$){d=$;for(let G=0,ne=s;G<ne.length;G+=1){const te=ne[G];$?window.addEventListener(te,x,{capture:!0,passive:!0}):window.removeEventListener(te,x,{capture:!0,passive:!0})}}}function w(){y(!1)}function x(){y(!0)}function A($){if(!m)if(l.paused)if($){let G;I(!1),m=!0;try{G=l.play(),G?G.then(L,L):(l.addEventListener("playing",L),l.addEventListener("abort",L),l.addEventListener("error",L))}catch{L()}}else I(!0);else I(!1)}function I($){if(f!==$){f=$;for(let G=0,ne=s;G<ne.length;G++){const te=ne[G];$?window.addEventListener(te,H,{capture:!0,passive:!0}):window.removeEventListener(te,H,{capture:!0,passive:!0})}}}function L(){l.removeEventListener("playing",L),l.removeEventListener("abort",L),l.removeEventListener("error",L),m=!1,A(!1)}function H(){A(!0)}if(oa()){const $=a.createMediaStreamDestination(),G=document.createElement("div");G.innerHTML="<audio x-webkit-airplay='deny'></audio>",l=G.children.item(0),l.controls=!1,l.disableRemotePlayback=!0,l.preload="auto",l.srcObject=$.stream,A(!0)}In.on(Ni.STATE_CHANGE,function(){y(!0)}),y(!1)}(eo)}(),!eo)throw new Se(ie.NOT_SUPPORTED,"can not create audio context");return eo}return eo}function up(r){if(function(){if(Uj!==null)return Uj;const l=Ig(),d=l.createBufferSource(),f=l.createGain(),m=l.createGain();d.connect(f),d.connect(m),d.disconnect(f);let y=!1;try{d.disconnect(f)}catch{y=!0}return d.disconnect(),Uj=y,y}())return;const a=r.connect,s=r.disconnect;r.connect=(l,d,f)=>{var m;return r._inputNodes||(r._inputNodes=[]),Ve(m=r._inputNodes).call(m,l)||(l instanceof AudioNode?(r._inputNodes.push(l),a.call(r,l,d,f)):a.call(r,l,d)),r},r.disconnect=(l,d,f)=>{s.call(r),l?Vx(r._inputNodes,l):r._inputNodes=[];for(const m of r._inputNodes)a.call(r,m)}}let Uj=null;function Fj(r,a){let s=!1;const l=1/a;if(se("DISABLE_WEBAUDIO")){const d=window.setInterval(()=>{s?window.clearInterval(d):r(performance.now()/1e3)},1e3*l)}else{const d=Ig();let f=d.createGain();f.gain.value=0,f.connect(d.destination);const m=()=>{if(s)return void(f=null);const y=d.createOscillator();y.onended=m,y.connect(f),y.start(0),y.stop(d.currentTime+l),r(d.currentTime)};m()}return()=>{s=!0}}class qz{constructor(){_e(this,"context",void 0),_e(this,"analyserNode",void 0),_e(this,"sourceNode",void 0),this.context=Ig(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(a){if(a!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=a,a==null||a.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||oa()||fc()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const a=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(a);else{const l=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(l);for(let d=0;d<a.length;++d)a[d]=l[d]/128-1}const s=sc(a).call(a,(l,d)=>l+d*d,0)/a.length;return Math.max(10*Math.log10(s)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var a,s;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(s=this.sourceNode)===null||s===void 0||s.connect(this.analyserNode)}catch{F.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class Yz extends lr{get processSourceNode(){return this.sourceNode}set processedNode(a){var s;if(!this.isDestroyed&&this._processedNode!==a){try{var l;(l=this.sourceNode)===null||l===void 0||l.disconnect(this.outputNode)}catch{}(s=this._processedNode)===null||s===void 0||s.disconnect(),this._processedNode=a,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),_e(this,"outputNode",void 0),_e(this,"outputTrack",void 0),_e(this,"isPlayed",!1),_e(this,"sourceNode",void 0),_e(this,"context",void 0),_e(this,"audioBufferNode",void 0),_e(this,"destNode",void 0),_e(this,"audioOutputLevel",0),_e(this,"volumeLevelAnalyser",void 0),_e(this,"_processedNode",void 0),_e(this,"playNode",void 0),_e(this,"isDestroyed",!1),_e(this,"onNoAudioInput",void 0),_e(this,"isNoAudioInput",!1),_e(this,"_noAudioInputCount",0),this.context=Ig(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),up(this.outputNode),this.volumeLevelAnalyser=new qz}startGetAudioBuffer(a){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(a),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=s=>{this.emit(Zs.ON_AUDIO_BUFFER,function(l){for(let d=0;d<l.outputBuffer.numberOfChannels;d+=1){const f=l.outputBuffer.getChannelData(d);for(let m=0;m<f.length;m+=1)f[m]=0}return l.inputBuffer}(s))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!un().webAudioMediaStreamDest)throw new Se(ie.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(a){this.context.state!=="running"&&Bx(()=>{In.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=a||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(a>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;oa()||fc()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const s=this.volumeLevelAnalyser.getAnalyserNode();let l;s.getFloatTimeDomainData?(l=new Float32Array(s.fftSize),s.getFloatTimeDomainData(l)):(l=new Uint8Array(s.fftSize),s.getByteTimeDomainData(l));let d=!1;for(let f=0;f<l.length;f++)l[f]!==0&&(d=!0);return d?(this.isNoAudioInput=!1,!0):(await Ci(200),await this.checkHasAudioInput(a?a+1:1)&&d)}getAudioVolume(){return this.outputNode.gain.value}setVolume(a){this.outputNode.gain.setValueAtTime(a,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var a,s;(a=this.processedNode)===null||a===void 0||a.disconnect(),(s=this.sourceNode)===null||s===void 0||s.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var a;this.processedNode?(a=this.processedNode)===null||a===void 0||a.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class Xz extends Yz{get isFreeze(){return!1}constructor(a,s,l){var d;if(super(),_e(this,"sourceNode",void 0),_e(this,"track",void 0),_e(this,"clonedTrack",void 0),_e(this,"audioElement",void 0),_e(this,"isCurrentTrackCloned",!1),_e(this,"isRemoteTrack",!1),_e(this,"originVolumeLevelAnalyser",void 0),_e(this,"rebuildWebAudio",async()=>{if(F.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void F.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>F.info("resume success")),F.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const y=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?y.stop():this.isCurrentTrackCloned=!0;const _=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(_),up(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const w=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(w,this.context.currentTime),up(this.outputNode),this.emit(Zs.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=_,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),a.kind!=="audio")throw new Se(ie.UNEXPECTED_ERROR);this.track=a;const f=new MediaStream([this.track]);if(this.isRemoteTrack=!!s,this.sourceNode=this.context.createMediaStreamSource(f),up(this.sourceNode),l){const y=l.clone();y.enabled=!0,this.clonedTrack=y,F.debug("create an unmuted track ".concat(y.id," from the original track ").concat(l.id," to get the volume"));const _=this.context.createMediaStreamSource(new MediaStream([y]));up(_),this.originVolumeLevelAnalyser=new qz,this.originVolumeLevelAnalyser.updateSource(_)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=f;const m=sn();s&&m.os===oi.IOS&&Number((d=m.osVersion)===null||d===void 0?void 0:d.split(".")[0])<15&&(In.on(Ni.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(y=>{y||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(a){this.sourceNode.disconnect(),this.track=a,this.isCurrentTrackCloned=!1;const s=new MediaStream([a]);this.sourceNode=this.context.createMediaStreamSource(s),up(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Zs.UPDATE_SOURCE),this.audioElement.srcObject=s}destroy(){var a;this.audioElement.srcObject=null,this.audioElement.remove(),In.off("state-change",this.rebuildWebAudio),(a=this.originVolumeLevelAnalyser)===null||a===void 0||a.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(a){return this.context.createMediaStreamSource(new MediaStream([a]))}updateOriginTrack(a){const s=a.clone();s.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=s),F.debug("create an unmuted track ".concat(s.id," from the original track ").concat(a.id," to get the volume"));const l=this.context.createMediaStreamSource(new MediaStream([s]));up(l),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(l)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function Jz(r,a,s){const l=(f,m)=>f?typeof f!="number"?f.max||f.exact||f.ideal||f.min||m:f:m,d={audio:!!s&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxHeight:l(a.height,1080),maxWidth:l(a.width,1920)}}};return a.frameRate&&typeof a.frameRate!="number"?(d.video.mandatory.maxFrameRate=a.frameRate.max,d.video.mandatory.minFrameRate=a.frameRate.min):typeof a.frameRate=="number"&&(d.video.mandatory.maxFrameRate=a.frameRate),await navigator.mediaDevices.getUserMedia(d)}async function iIe(r,a){const s=await Zz(r.mediaSource),{sourceId:l,audio:d}=await function(f){let m=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ge((y,_)=>{const w=document.createElement("div");w.innerText="share screen",w.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const x=document.createElement("div");x.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const A=document.createElement("div");A.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",A.setAttribute("style","height: 12%;");const I=document.createElement("div");I.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const L=document.createElement("div");L.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const H=document.createElement("button");H.innerHTML="cancel",H.setAttribute("style","width: 85px;"),H.onclick=()=>{document.body.removeChild(ne);const te=new Error("NotAllowedError");te.name="NotAllowedError",_(te)};let $=m;const G=document.createElement("div");if(m){const te=document.createElement("input");te.setAttribute("type","checkbox");const ce=document.createElement("span");te.setAttribute("style","margin-right: 6px;"),ce.innerText="Share audio",te.checked=$,te.onchange=()=>{$=te.checked},G.appendChild(te),G.appendChild(ce)}L.appendChild(G),L.appendChild(H),x.appendChild(A),x.appendChild(I),x.appendChild(L);const ne=document.createElement("div");ne.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),ne.appendChild(w),ne.appendChild(x),document.body.appendChild(ne),f.map(te=>{if(te.id){const ce=document.createElement("div");ce.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let pe=te.thumbnail;try{const{width:fe}=pe.getSize();fe>1920&&(pe=pe.resize({width:1920}))}catch(fe){throw fe&&fe.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),fe}ce.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+pe.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+te.name.replace(/[\u00A0-\u9999<>\&]/g,function(fe){return"&#"+fe.charCodeAt(0)+";"})+"</span>",ce.onclick=()=>{document.body.removeChild(ne),y({sourceId:te.id,audio:$})},I.appendChild(ce)}})})}(s,a);return await Jz(l,r,d)}async function Zz(r){let a=["window","screen"];r!=="application"&&r!=="window"||(a=["window"]),r==="screen"&&(a=["screen"]);const s=uz();if(!s)throw console.error("failed to fetch electron, please mount it to window"),new Se(ie.ELECTRON_IS_NULL);let l=null;try{var d;l=((d=s.desktopCapturer)===null||d===void 0?void 0:d.getSources({types:a}))||s.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:a})}catch{l=null}l&&l.then||(l=new Ge((f,m)=>{s.desktopCapturer.getSources({types:a},(y,_)=>{y?m(y):f(_)})}));try{return await l}catch(f){throw new Se(ie.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,f.toString())}}const Vj=new Gi("safari");let Qz=!1,e9=!1;async function to(r,a){let s=0,l=null;for(;s<2;)try{l=await aIe(r,a,s>0);break}catch(d){if(d instanceof Se)throw F.error("[".concat(a,"] ").concat(d.toString())),d;const f=Zx(d.name||d.code||d,d.message);if(f.code===ie.MEDIA_OPTION_INVALID){F.debug("[".concat(a,"] detect media option invalid, retry")),s+=1,await Ci(500);continue}throw F.error("[".concat(a,"] ").concat(f.toString())),f}if(!l)throw new Se(ie.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return l}async function aIe(r,a,s){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Se(ie.NOT_SUPPORTED,"can not find getUserMedia");s&&(r.video&&(delete r.video.width,delete r.video.height),r.screen&&(delete r.screen.width,delete r.screen.height));const l=un(),d=new MediaStream;if(r.audioSource&&d.addTrack(r.audioSource),r.videoSource&&d.addTrack(r.videoSource),!r.audio&&!r.video&&!r.screen)return F.debug("Using Video Source/ Audio Source"),d;if(r.screen)if(uz())r.screen.sourceId?Og(d,await Jz(r.screen.sourceId,r.screen,!!r.screenAudio)):Og(d,await iIe(r.screen,!!r.screenAudio));else if(rd()&&r.screen.extensionId&&r.screen.mandatory){if(!l.getStreamFromExtension)throw new Se(ie.NOT_SUPPORTED,"This browser does not support screen sharing");F.debug("[".concat(a,'] Screen access on chrome stable, looking for extension"'));const I=await(m=r.screen.extensionId,y=a,new Ge((L,H)=>{try{chrome.runtime.sendMessage(m,{getStream:!0},$=>{if(!$||!$.streamId)return F.error("[".concat(y,"] No response from Chrome Plugin. Plugin not installed properly"),$),void H(new Se(ie.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));L($.streamId)})}catch($){F.error("[".concat(y,"] AgoraRTC screensharing plugin is not accessible(").concat(m,")"),$.toString()),H(new Se(ie.CHROME_PLUGIN_NOT_INSTALL))}}));r.screen.mandatory.chromeMediaSourceId=I,Og(d,await navigator.mediaDevices.getUserMedia({video:{mandatory:r.screen.mandatory}}))}else if(l.getDisplayMedia){var f;r.screen.mediaSource&&$z(r.screen.mediaSource);const I={width:r.screen.width,height:r.screen.height,frameRate:r.screen.frameRate,displaySurface:(f=r.screen.displaySurface)!==null&&f!==void 0?f:r.screen.mediaSource==="screen"?"monitor":r.screen.mediaSource},{selfBrowserSurface:L,surfaceSwitching:H,systemAudio:$,preferCurrentTab:G}=r.screen,ne={selfBrowserSurface:L,surfaceSwitching:H,systemAudio:$,preferCurrentTab:G};!L&&delete ne.selfBrowserSurface,!H&&delete ne.surfaceSwitching,!$&&delete ne.systemAudio,!G&&delete ne.preferCurrentTab,F.debug("[".concat(a,"] getDisplayMedia:"),JSON.stringify({video:I,audio:r.screenAudio,controls:ne})),Og(d,await navigator.mediaDevices.getDisplayMedia(Bn({video:I,audio:r.screenAudio},ne)))}else{if(!dr())throw F.error("[".concat(a,"] This browser does not support screenSharing")),new Se(ie.NOT_SUPPORTED,"This browser does not support screen sharing");{r.screen.mediaSource&&$z(r.screen.mediaSource);const I={video:{mediaSource:r.screen.mediaSource,width:r.screen.width,height:r.screen.height,frameRate:r.screen.frameRate}};F.debug("[".concat(a,"] getUserMedia: ").concat(JSON.stringify(I))),Og(d,await navigator.mediaDevices.getUserMedia(I))}}var m,y;if(!r.video&&!r.audio)return d;let _={video:r.video,audio:r.audio},w=se("MEDIA_DEVICE_CONSTRAINTS");if(w)try{typeof w=="string"&&(w=JSON.parse(w)),_=gj(_,w)}catch{}F.debug("[".concat(a,"] GetUserMedia"),JSON.stringify(_)),sn();let x,A=null;(ji()||oa()||Ux())&&(A=await Vj.lock());try{x=await navigator.mediaDevices.getUserMedia(_)}catch(I){throw A&&A(),I}return _.audio&&(Qz=!0),_.video&&(e9=!0),Og(d,x),A&&A(),d}function Zx(r,a){switch(r){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Se(ie.MEDIA_OPTION_INVALID,"".concat(r,": ").concat(a));case"NotFoundError":case"DevicesNotFoundError":return new Se(ie.DEVICE_NOT_FOUND,"".concat(r,": ").concat(a));case"NotSupportedError":return new Se(ie.NOT_SUPPORTED,"".concat(r,": ").concat(a));case"NotReadableError":return new Se(ie.NOT_READABLE,"".concat(r,": ").concat(a));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Se(ie.PERMISSION_DENIED,"".concat(r,": ").concat(a));case"ConstraintNotSatisfiedError":return new Se(ie.CONSTRAINT_NOT_SATISFIED,"".concat(r,": ").concat(a));default:return F.error("getUserMedia unexpected error",r),new Se(ie.UNEXPECTED_ERROR,"".concat(r,": ").concat(a))}}function Og(r,a){const s=r.getVideoTracks()[0],l=r.getAudioTracks()[0],d=a.getVideoTracks()[0],f=a.getAudioTracks()[0];f&&(l&&r.removeTrack(l),r.addTrack(f)),d&&(s&&r.removeTrack(s),r.addTrack(d))}const no=new class extends lr{get state(){return this._state}set state(r){r!==this._state&&(this.emit(lp.STATE_CHANGE,r),this._state=r)}constructor(){super(),_e(this,"_state",pb.IDLE),_e(this,"isAccessMicrophonePermission",!1),_e(this,"isAccessCameraPermission",!1),_e(this,"lastAccessMicrophonePermission",!1),_e(this,"lastAccessCameraPermission",!1),_e(this,"checkdeviceMatched",!1),_e(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(se("ENUMERATE_DEVICES_INTERVAL")||(Fx()||Mx()===oi.HARMONY_OS)&&id())&&this.updateDevicesInfo()},se("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(r=>F.error(r.toString()))}async enumerateDevices(r,a){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Se(ie.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const l=await navigator.mediaDevices.enumerateDevices(),d=this.checkMediaDeviceInfoIsOk(l);let f=!this.isAccessMicrophonePermission&&r,m=!this.isAccessCameraPermission&&a;d.audio&&(f=!1),d.video&&(m=!1);let y=null,_=null,w=null;if(!s&&(f||m)){if(Vj.isLocked&&(F.debug("[device manager] wait GUM lock"),(await Vj.lock())(),F.debug("[device manager] GUM unlock")),Qz&&(f=!1,this.isAccessMicrophonePermission=!0),e9&&(m=!1,this.isAccessCameraPermission=!0),F.debug("[device manager] check media device permissions",r,a,f,m),f&&m){try{w=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(x){const A=Zx(x.name||x.code||x,x.message);if(A.code===ie.PERMISSION_DENIED)throw A;F.warning("getUserMedia failed in getDevices",A)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(f){try{y=await navigator.mediaDevices.getUserMedia({audio:r})}catch(x){const A=Zx(x.name||x.code||x,x.message);if(A.code===ie.PERMISSION_DENIED)throw A;F.warning("getUserMedia failed in getDevices",A)}this.isAccessMicrophonePermission=!0}else if(m){try{_=await navigator.mediaDevices.getUserMedia({video:a})}catch(x){const A=Zx(x.name||x.code||x,x.message);if(A.code===ie.PERMISSION_DENIED)throw A;F.warning("getUserMedia failed in getDevices",A)}this.isAccessCameraPermission=!0}F.debug("[device manager] mic permission",r,"cam permission",a)}try{const x=await navigator.mediaDevices.enumerateDevices();return y&&y.getTracks().forEach(A=>A.stop()),_&&_.getTracks().forEach(A=>A.stop()),w&&w.getTracks().forEach(A=>A.stop()),y=null,_=null,w=null,x}catch(x){return y&&y.getTracks().forEach(A=>A.stop()),_&&_.getTracks().forEach(A=>A.stop()),w&&w.getTracks().forEach(A=>A.stop()),y=null,_=null,w=null,new Se(ie.ENUMERATE_DEVICES_FAILED,x.toString()).throw()}}async getRecordingDevices(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,r)).filter(a=>a.kind==="audioinput")}async getCamerasDevices(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,r)).filter(a=>a.kind==="videoinput")}async getSpeakers(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,r)).filter(a=>a.kind==="audiooutput")}searchDeviceIdByName(r){let a=null;return this.deviceInfoMap.forEach(s=>{s.device.label===r&&(a=s.device.deviceId)}),a}async getDeviceById(r){const a=(await this.enumerateDevices(!0,!0,!0)).find(s=>s.deviceId===r);if(!a)throw new Se(ie.DEVICE_NOT_FOUND,"deviceId: ".concat(r));return a}async init(){this.state=pb.INITING;try{await this.updateDevicesInfo(),this.state=pb.INITEND}catch(r){throw F.warning("Device Detection functionality cannot start properly.",r.toString()),this.state=pb.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new Se(ie.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),r}}async updateDevicesInfo(){const r=await this.enumerateDevices(!0,!0,!0),a=Date.now(),s=[];if(r[0]&&r[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const d=r.find(m=>m.kind==="audioinput"&&m.deviceId==="default"),f=r.find(m=>m.kind==="audiooutput"&&m.deviceId==="default");d&&f?f.groupId===d.groupId?F.debug("[device-check] default input ".concat(d.label," and output ").concat(f.label," is the same group")):F.debug("[device-check] default input ".concat(d.label," and output ").concat(f.label," is not the same group")):F.debug("[device-check] default input or output not found")}const l=this.checkMediaDeviceInfoIsOk(r);if(r.forEach(d=>{if(!d.deviceId)return;const f=this.deviceInfoMap.get("".concat(d.kind,"_").concat(d.deviceId));if((f?f.state:"INACTIVE")!=="ACTIVE"){const m={initAt:a,updateAt:a,device:d,state:"ACTIVE"};this.deviceInfoMap.set("".concat(d.kind,"_").concat(d.deviceId),m),s.push(m)}f&&(f.updateAt=a)}),this.deviceInfoMap.forEach((d,f)=>{d.state==="ACTIVE"&&d.updateAt!==a&&(d.state="INACTIVE",s.push(d))}),this.state!==pb.INITEND)return l.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(l.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));s.forEach(d=>{switch(d.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lp.RECORDING_DEVICE_CHANGED,d);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(lp.CAMERA_DEVICE_CHANGED,d);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lp.PLAYOUT_DEVICE_CHANGED,d)}}),l.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),l.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(r){const a=r.filter(d=>d.kind==="audioinput"),s=r.filter(d=>d.kind==="videoinput"),l={audio:!1,video:!1};for(const d of a)if(d.label&&d.deviceId){l.audio=!0;break}for(const d of s)if(d.label&&d.deviceId){l.video=!0;break}return l}};let Bj=!1;const ro=new class extends lr{constructor(){super(...arguments),_e(this,"onAutoplayFailed",void 0),_e(this,"onAudioAutoplayFailed",void 0)}};function t9(){if(sn(),!Bj){const r=a=>{a.preventDefault(),Bj=!1,ib()?document.body.removeEventListener("click",r,!0):(document.body.removeEventListener("touchstart",r,!0),document.body.removeEventListener("mousedown",r,!0))};Bj=!0,ib()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0)),F.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),ro.onAutoplayFailed?ro.onAutoplayFailed():ro.onAudioAutoplayFailed?F.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):F.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),ro.emit("autoplay-failed")}}function n9(r,a,s,l){if(!r)return;const d=nt.getBaseInfoBySessionId(r);if(!d)return;const f=d.info,m=Date.now(),y=Bn(Bn({},f),{},{vid:f.vid===void 0?0:Number(f.vid),lts:m,elapse:m-d.startTime,cbRegistered:ro.onAutoplayFailed||ro.onAudioAutoplayFailed?1:-1,errorMsg:s,mediaType:a,trackId:l,extend:void 0});nt.send({type:Qn.AUTOPLAY_FAILED,data:y},!0)}const sIe=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],qa=new class{constructor(){_e(this,"onAutoplayFailed",void 0),_e(this,"elementMap",new Map),_e(this,"elementStateMap",new Map),_e(this,"elementsNeedToResume",[]),_e(this,"sinkIdMap",new Map),_e(this,"autoResumeAfterInterruption",r=>{Array.from(this.elementMap.entries()).forEach(a=>{let[s,l]=a;const d=this.elementStateMap.get(s),f=l.srcObject.getAudioTracks()[0],m=f&&f.readyState;if(F.debug("resume after interrupted, ele: ".concat(d," audio: ").concat(m," ").concat(r)),m==="live"){if(r)return l.pause(),void l.play();if(In.curState==="running")return vg()?(l.pause(),void l.play()):void(d&&d==="paused"&&l.play())}})}),_e(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(r=>{let[a,s]=r;const l=s.srcObject.getAudioTracks()[0];l&&l.readyState==="live"&&(F.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),s.pause(),s.play())})}),this.autoResumeAudioElement(),In.on(Ni.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),In.on(Ni.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),In.on(Ni.STATE_CHANGE,()=>{oa()&&In.prevState==="suspended"&&In.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(r,a){const s=this.elementMap.get(r);if(this.sinkIdMap.set(r,a),s)try{await s.setSinkId(a)}catch(l){throw new Se(ie.PERMISSION_DENIED,"can not set sink id: "+l.toString())}}play(r,a,s,l){if(this.elementMap.has(a))return;const d=document.createElement("audio");d.autoplay=!0,d.srcObject=new MediaStream([r]),this.bindAudioElementEvents(a,d),this.elementMap.set(a,d),this.elementStateMap.set(a,Hi.INIT),this.setVolume(a,s);const f=this.sinkIdMap.get(a);if(f)try{d.setSinkId(f).catch(y=>{F.warning("[".concat(a,"] set sink id failed"),y.toString())})}catch(y){F.warning("[".concat(a,"] set sink id failed"),y.toString())}const m=d.play();m&&m.then&&m.catch(y=>{l&&n9(l,"audio",y.message,a),F.warning("audio element play warning",y.toString()),this.elementMap.has(a)&&y.name==="NotAllowedError"&&(F.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(d),Bx(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),t9()}))})}updateTrack(r,a){const s=this.elementMap.get(r);s&&(s.srcObject=new MediaStream([a]))}isPlaying(r){return this.elementMap.has(r)&&this.elementStateMap.get(r)==="playing"}setVolume(r,a){const s=this.elementMap.get(r);s&&(a=Math.max(0,Math.min(100,a)),s.volume=a/100)}stop(r){const a=this.elementMap.get(r);if(this.sinkIdMap.delete(r),!a)return;const s=this.elementsNeedToResume.indexOf(a);this.elementsNeedToResume.splice(s,1),a.srcObject=null,a.remove(),this.elementMap.delete(r),this.elementStateMap.delete(r)}bindAudioElementEvents(r,a){sIe.forEach(s=>{a.addEventListener(s,l=>{const d=this.elementStateMap.get(r),f=l.type==="pause"?"paused":l.type;if(F.debug("[".concat(r,"] audio-element-status change ").concat(d," => ").concat(f)),l.type==="error"){const m=a==null?void 0:a.error;m&&F.error("[".concat(r,"] media error, code: ").concat(m.code,", message: ").concat(m.message))}this.elementStateMap.set(r,f)})})}getPlayerState(r){return this.elementStateMap.get(r)||"uninit"}autoResumeAudioElement(){const r=()=>{this.elementsNeedToResume.forEach(a=>{a.play().then(s=>{F.debug("Auto resume audio element success")}).catch(s=>{F.warning("Auto resume audio element failed!",s)})}),this.elementsNeedToResume=[]};new Ge(a=>{document.body?a():window.addEventListener("load",()=>a())}).then(()=>{ib()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0))})}};function gr(){return function(r,a,s){const l=s.value;return typeof l=="function"&&(s.value=function(){this._isClosed&&new Se(ie.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",F);for(var d=arguments.length,f=new Array(d),m=0;m<d;m++)f[m]=arguments[m];const y=l.apply(this,f);return y instanceof Ge?new Ge((_,w)=>{y.then(_).catch(w)}):y}),s}}class r9 extends lr{constructor(a){super(),_e(this,"name","VideoProcessorDestination"),_e(this,"ID","0"),_e(this,"_source",void 0),_e(this,"videoContext",void 0),_e(this,"inputTrack",void 0),this.videoContext=a}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Se(ie.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Se(ie.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(a){if(a.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);a.track&&a.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=a.track,this.emit(ja.ON_TRACK,a.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(ja.ON_TRACK,void 0)}}class i9 extends lr{set chained(a){this._chained=a}get chained(){return this._chained}constructor(a,s){super(),_e(this,"constraintsMap",new Map),_e(this,"statsRegistry",[]),_e(this,"usageRegistry",[]),_e(this,"trackId",void 0),_e(this,"direction",void 0),_e(this,"_chained",!1),this.trackId=a,this.direction=s}async getConstraints(){return await Li(this,Qs.REQUEST_CONSTRAINTS)}async requestApplyConstraints(a,s){var l;return F.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),a&&this.constraintsMap.set(s,a),Ln(this,Qs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Rs(l=this.constraintsMap).call(l)))}async requestRevertConstraints(a){var s;if(this.constraintsMap.has(a))return F.info("processor ".concat(a.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(a),Ln(this,Qs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Rs(s=this.constraintsMap).call(s)))}registerStats(a,s,l){this.statsRegistry.find(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s)||this.statsRegistry.push({processorName:a.name,processorID:a.ID,type:s,cb:l})}unregisterStats(a,s){const l=this.statsRegistry.findIndex(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s);l!==-1&&this.statsRegistry.splice(l,1)}gatherStats(){const a=[];for(const{processorID:s,processorName:l,type:d,cb:f}of this.statsRegistry)try{const m=f();a.push({processorID:s,processorName:l,type:d,stats:m})}catch(m){F.error(new Se(ie.UNEXPECTED_ERROR,m.message))}return a}registerUsage(a,s){this.usageRegistry.find(l=>l.processorID===a.ID&&l.processorName===a.name)||this.usageRegistry.push({processorID:a.ID,processorName:a.name,cb:s})}unregisterUsage(a){const s=this.usageRegistry.findIndex(l=>l.processorID===a.ID&&l.processorName===a.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const a=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let l=s();l instanceof Ge&&(l=await l),a.push(Bn(Bn({},l),{},{direction:this.direction}))}catch(l){F.error("gather extension usage error",l)}return a}getDirection(){return this.direction}}class a9 extends lr{constructor(a){super(),_e(this,"name","AudioProcessorDestination"),_e(this,"ID","0"),_e(this,"inputTrack",void 0),_e(this,"inputNode",void 0),_e(this,"audioProcessorContext",void 0),_e(this,"_source",void 0),this.audioProcessorContext=a}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Se(ie.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Se(ie.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(ja.ON_TRACK,void 0),this.emit(ja.ON_NODE,void 0)}updateInput(a){if(a.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);a.track&&this.inputTrack!==a.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=a.track,this.emit(ja.ON_TRACK,this.inputTrack)),a.node&&this.inputNode!==a.node&&(this.audioProcessorContext.chained=!0,this.inputNode=a.node,this.emit(ja.ON_NODE,this.inputNode))}}class s9 extends lr{set chained(a){this._chained=a}get chained(){return this._chained}constructor(a,s,l){super(),_e(this,"constraintsMap",new Map),_e(this,"statsRegistry",[]),_e(this,"audioContext",void 0),_e(this,"trackId",void 0),_e(this,"direction",void 0),_e(this,"usageRegistry",[]),_e(this,"_chained",!1),this.audioContext=a,this.trackId=s,this.direction=l}async getConstraints(){return Li(this,Qs.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(a,s){var l;return F.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),a&&this.constraintsMap.set(s,a),Ln(this,Qs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Rs(l=this.constraintsMap).call(l)))}async requestRevertConstraints(a){var s;if(this.constraintsMap.has(a))return this.constraintsMap.delete(a),Ln(this,Qs.REQUEST_UPDATE_CONSTRAINTS,Array.from(Rs(s=this.constraintsMap).call(s)))}registerStats(a,s,l){this.statsRegistry.find(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s)||this.statsRegistry.push({processorName:a.name,processorID:a.ID,type:s,cb:l})}unregisterStats(a,s){const l=this.statsRegistry.findIndex(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s);l!==-1&&this.statsRegistry.splice(l,1)}gatherStats(){const a=[];for(const{processorID:s,processorName:l,type:d,cb:f}of this.statsRegistry)try{const m=f();a.push({processorID:s,processorName:l,type:d,stats:m})}catch(m){F.error(new Se(ie.UNEXPECTED_ERROR,m.message))}return a}registerUsage(a,s){this.usageRegistry.find(l=>l.processorID===a.ID&&l.processorName===a.name)||this.usageRegistry.push({processorID:a.ID,processorName:a.name,cb:s})}unregisterUsage(a){const s=this.usageRegistry.findIndex(l=>l.processorID===a.ID&&l.processorName===a.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const a=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let l=s();l instanceof Ge&&(l=await l),a.push(Bn(Bn({},l),{},{direction:this.direction}))}catch(l){F.error("gather extension usage error",l)}return a}getDirection(){return this.direction}}class $j extends lr{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),_e(this,"context",void 0),_e(this,"processSourceNode",void 0),_e(this,"outputTrack",void 0),_e(this,"processedNode",void 0),_e(this,"clonedTrack",void 0),_e(this,"outputNode",void 0),this.outputNode=new oIe}setVolume(){}createOutputTrack(){throw new Se(ie.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class oIe{disconnect(){}connect(){}}function o9(r){return new Ge((a,s)=>{let l=!1;const d=document.createElement("video");d.setAttribute("autoplay",""),d.setAttribute("muted",""),d.muted=!0,d.autoplay=!0,d.setAttribute("playsinline",""),d.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(d);const f=oa()?"canplay":"playing";d.addEventListener(f,()=>{const m=d.videoWidth,y=d.videoHeight;!m&&dr()||(l=!0,d.srcObject=null,d.remove(),a([m,y]))}),d.srcObject=new MediaStream([r]),d.play().catch($x),setTimeout(()=>{l||(d.srcObject=null,d.remove(),a([d.videoWidth,d.videoHeight]))},4e3)})}function Qx(r){const a={};r.facingMode&&(a.facingMode=r.facingMode),r.cameraId&&(a.deviceId={exact:r.cameraId});const s=gc(r.encoderConfig);return s.width!=null&&(a.width=s.width),s.height!=null&&(a.height=s.height),!az()&&s.frameRate&&(a.frameRate=s.frameRate),JH()&&typeof a.frameRate=="object"&&(a.frameRate.max=60),dr()&&(a.frameRate={ideal:30,max:30}),a}function c9(r){const a={};return az()||(r.AGC!==void 0&&(a.autoGainControl=r.AGC),r.AEC!==void 0&&(a.echoCancellation=r.AEC),r.ANS!==void 0&&(a.noiseSuppression=r.ANS,rd()&&r.ANS&&(a.googHighpassFilter=r.ANS))),a}function l9(r){const a=c9(r);if(r.encoderConfig){const s=Xx(r.encoderConfig);a.channelCount=s.stereo?2:1,a.sampleRate=s.sampleRate,a.sampleSize=s.sampleSize}return r.microphoneId&&(a.deviceId={exact:r.microphoneId}),Fx()&&(a.sampleRate=void 0),a}const cIe=r=>{const a=r._encoderConfig;if(!a)return;const{frameRate:s,width:l,height:d}=r.getMediaStreamTrackSettings();let{frameRate:f=s,width:m=l,height:y=d}=a;if(!f||!m||!y)return;m=bg(m),y=bg(y),f=bg(f);const{max:_,min:w}=function(L,H,$){const G=200*Math.pow($/15,.6)*Math.pow(L*H/640/360,.75);return{min:Math.floor(G),max:Math.floor(4*G)}}(m,y,f),{bitrateMax:x,bitrateMin:A}=a||{};x||F.debug("calculate bitrate: [w: ".concat(m,", h: ").concat(y,", fps: ").concat(f,"] => [brMax: ").concat(x,", brMin: ").concat(A,"]"));const{maxFramerate:I}=se("ENCODER_CONFIG_LIMIT");return I&&typeof I=="number"&&(f=Math.min(f,I)),{frameRate:f,bitrateMax:x||_,bitrateMin:A||w,scaleResolutionDownBy:1,scale:0}},u9=async(r,a,s)=>await(async(l,d,f)=>{const m=function(w){const x=[];for(let A=0;A<w.length;A+=2)x.push(parseInt(w.slice(A,A+2),16));return Uint8Array.from(x)}(Ez(""+d+f)).slice(0,16),y=m.slice(0,12),_=await window.crypto.subtle.importKey("raw",m,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:y},_,l))})(r.buffer,a,s),Wj=r=>{const a=document.createElement("canvas");return a.width=2,a.height=2,new Ge((s,l)=>{a.toBlob(async d=>{if(a.remove(),d){const f=await d9(d);s({buffer:f,width:a.width,height:a.height})}else l(new Se(ie.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},r,1)})},d9=async r=>{const a=await r.arrayBuffer();return new Uint8Array(a)};var h9,f9,p9,m9,g9,v9,y9,_9,b9,E9,w9,S9,x9,T9,C9,R9,N9,A9,ur,I9,O9,P9,k9,j9,D9,iu,L9,M9,U9,F9,V9,B9,$9,W9,G9,H9,z9,K9,q9,Ui;let vr=(h9=Et({argsMap:(r,a)=>[r.getTrackId(),a],throttleTime:300}),f9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),p9=gr(),m9=Eg("LocalAudioTrack","_enabledMutex"),g9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),v9=gr(),y9=Eg("LocalAudioTrack","_enabledMutex"),_9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),b9=gr(),E9=gr(),w9=gr(),S9=Et({argsMap:r=>[r.getTrackId()]}),x9=gr(),T9=Et({argsMap:r=>[r.getTrackId()]}),C9=gr(),R9=Et({argsMap:r=>[r.getTrackId()]}),N9=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),A9=Et({argsMap:r=>[r.getTrackId()]}),an((ur=class extends Ag{get _source(){return this.initWebAudio()}set _source(r){this._trackSource=r}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?qa.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(r,a,s,l){super(r,s),_e(this,"trackMediaType",Ng.AUDIO),_e(this,"_encoderConfig",void 0),_e(this,"_trackSource",void 0),_e(this,"metadata",[]),_e(this,"_enabled",!0),_e(this,"_volume",100),_e(this,"_useAudioElement",!0),_e(this,"_bypassWebAudio",!1),_e(this,"processor",void 0),_e(this,"_processorContext",void 0),_e(this,"_processorDestination",void 0),_e(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=a,this._getOriginVolumeLevel=!!l,this._trackSource=new $j,se("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),se("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),ji()&&!eo?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(r){kn(r,"volume",0,1e3),this._volume=r,this._source.setVolume(r/100),this._useAudioElement&&qa.setVolume(this.getTrackId(),r);try{if(this._bypassWebAudio)return void F.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const a=this._source.createOutputTrack();this._mediaStreamTrack!==a&&(this._mediaStreamTrack=a,Ln(this,Ze.NEED_REPLACE_TRACK,this).then(()=>{F.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(s=>{F.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),s)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(r){if(!this._useAudioElement||!Vz())throw new Se(ie.NOT_SUPPORTED,"your browser does not support setting the audio output device");await qa.setSinkID(this.getTrackId(),r)}async setEnabled(r,a,s){return this._setEnabled(r,a,s)}async _setEnabled(r,a,s){if(!s){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(F.info("[".concat(this.getTrackId(),"] start setEnabled"),r),r){this._originMediaStreamTrack.enabled=!0;try{s||(this._enabled=!0),await Ln(this,Ze.NEED_ENABLE_TRACK,this),F.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(r," success"))}catch(l){throw s||(this._enabled=!1),F.error("[".concat(this.getTrackId(),"] setEnabled to true error"),l.toString()),l}}else{this._originMediaStreamTrack.enabled=!1,s||(this._enabled=!1);try{await Ln(this,Ze.NEED_DISABLE_TRACK,this)}catch(l){throw s||(this._enabled=!0),F.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}}}async setMuted(r){r!==this._muted&&(this.stateCheck("muted",r),this._muted=r,this._originMediaStreamTrack.enabled=!r,F.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(r)),r?await Ln(this,Ze.NEED_MUTE_TRACK,this):await Ln(this,Ze.NEED_UNMUTE_TRACK,this))}getStats(){return hh(()=>{F.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),Xs(this,Ze.GET_STATS)||Bn({},Dj)}setAudioFrameCallback(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!r)return this._source.removeAllListeners(Zs.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(a),this._source.removeAllListeners(Zs.ON_AUDIO_BUFFER),this._source.on(Zs.ON_AUDIO_BUFFER,s=>r(s))}play(){F.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(F.debug("[".concat(this.getTrackId(),"] start audio playback in element")),qa.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){F.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?qa.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];F.debug("[".concat(this.getTrackId(),"] update player source track")),r&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&qa.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(r,a){this._originMediaStreamTrack!==r&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),a&&this._originMediaStreamTrack.stop()),r.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=r,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:r,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,Ze.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(r))}renewMediaStreamTrack(r){return Ge.resolve(void 0)}pipe(r){if(this._bypassWebAudio)throw new Se(ie.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===r)return r;if(r._source)throw new Se(ie.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),r}unpipe(){var r;if(!this.processor)return;const a=this.processor;(r=this._source.processSourceNode)===null||r===void 0||r.disconnect(),this.processor._source=!1,this.processor=void 0,a.reset()}bindProcessorDestinationEvents(r){r.on(ja.ON_TRACK,async a=>{a?a!==this._mediaStreamTrack&&(this._mediaStreamTrack=a,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(a),await Ln(this,Ze.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,Ze.NEED_REPLACE_TRACK,this))}),r.on(ja.ON_NODE,a=>{this._source.processedNode=a})}unbindProcessorDestinationEvents(r){r.removeAllListeners(ja.ON_TRACK),r.removeAllListeners(ja.ON_NODE)}bindProcessorContextEvents(r){r.on(Qs.REQUEST_CONSTRAINTS,async a=>{a(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(r){r.removeAllListeners(Qs.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof $j&&(this._trackSource=new Xz(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const r=new s9(this._source.context,this.getTrackId(),"local"),a=new a9(r);return this._processorContext=r,this._processorDestination=a,this.bindProcessorContextEvents(r),this.bindProcessorDestinationEvents(a),this._source.on(Zs.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:r})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(qa.stop(this.getTrackId()),this._source.play()),Ln(this,Ze.NEED_REPLACE_MIXING_TRACK,this).then(()=>{F.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(s=>{F.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),s)})),{processorContext:r,processorDestination:a}}}).prototype,"setVolume",[h9],Object.getOwnPropertyDescriptor(ur.prototype,"setVolume"),ur.prototype),an(ur.prototype,"setPlaybackDevice",[f9,p9],Object.getOwnPropertyDescriptor(ur.prototype,"setPlaybackDevice"),ur.prototype),an(ur.prototype,"setEnabled",[m9,g9,v9],Object.getOwnPropertyDescriptor(ur.prototype,"setEnabled"),ur.prototype),an(ur.prototype,"setMuted",[y9,_9,b9],Object.getOwnPropertyDescriptor(ur.prototype,"setMuted"),ur.prototype),an(ur.prototype,"getStats",[E9],Object.getOwnPropertyDescriptor(ur.prototype,"getStats"),ur.prototype),an(ur.prototype,"setAudioFrameCallback",[w9],Object.getOwnPropertyDescriptor(ur.prototype,"setAudioFrameCallback"),ur.prototype),an(ur.prototype,"play",[S9,x9],Object.getOwnPropertyDescriptor(ur.prototype,"play"),ur.prototype),an(ur.prototype,"stop",[T9,C9],Object.getOwnPropertyDescriptor(ur.prototype,"stop"),ur.prototype),an(ur.prototype,"close",[R9],Object.getOwnPropertyDescriptor(ur.prototype,"close"),ur.prototype),an(ur.prototype,"pipe",[N9],Object.getOwnPropertyDescriptor(ur.prototype,"pipe"),ur.prototype),an(ur.prototype,"unpipe",[A9],Object.getOwnPropertyDescriptor(ur.prototype,"unpipe"),ur.prototype),ur),mb=(I9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),O9=gr(),P9=Eg("MicrophoneAudioTrack","_enabledMutex"),k9=Et({argsMap:(r,a,s)=>[r.getTrackId(),a,s]}),j9=gr(),D9=Et({argsMap:r=>[r.getTrackId()]}),an((iu=class extends vr{get __className__(){return"MicrophoneAudioTrack"}constructor(r,a,s,l){super(r,a.encoderConfig?Xx(a.encoderConfig):{},l,se("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),_e(this,"_config",void 0),_e(this,"_deviceName","default"),_e(this,"_constraints",void 0),_e(this,"_originalConstraints",void 0),_e(this,"_enabled",!0),this._config=a,this._constraints=s,this._originalConstraints=s,this._deviceName=r.label,typeof a.bypassWebAudio=="boolean"&&(this._bypassWebAudio=a.bypassWebAudio),(vg()||lj())&&In.bindInterruptDetectorTrack(this)}async setDevice(r){if(F.info("[".concat(this.getTrackId(),"] start set device to ").concat(r)),this._enabled)try{const a=await no.getDeviceById(r),s={};s.audio=Bn({},this._constraints),s.audio.deviceId={exact:r},this._originMediaStreamTrack.stop();let l=null;try{l=await to(s,this.getTrackId())}catch(d){throw F.error("[".concat(this.getTrackId(),"] setDevice failed"),d.toString()),l=await to({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),d}await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),this._deviceName=a.label,this._config.microphoneId=r,this._constraints.deviceId={exact:r}}catch(a){throw F.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}else try{const a=await no.getDeviceById(r);this._deviceName=a.label,this._config.microphoneId=r,this._constraints.deviceId={exact:r}}catch(a){throw F.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}F.info("[".concat(this.getTrackId(),"] set device to ").concat(r," success"))}async setEnabled(r,a,s){if(a)return F.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(r);if(!s){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(F.info("[".concat(this.getTrackId(),"] start setEnabled"),r),se("AUTO_RESET_AUDIO_ROUTE")&&(oa()||fc())){const m=navigator.audioSession;m&&(r||(m.type="playback"),m.type="auto")}if(!r){var l;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(l=this._source.clonedTrack)===null||l===void 0||l.stop(),s||(this._enabled=!1);try{await Ln(this,Ze.NEED_DISABLE_TRACK,this)}catch(m){throw F.error("[".concat(this.getTrackId(),"] setEnabled false failed"),m.toString()),m}return}const d=Bn({},this._constraints),f=no.searchDeviceIdByName(this._deviceName);f&&!d.deviceId&&(d.deviceId=f);try{s||(this._enabled=!0);const m=await to({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(m.getAudioTracks()[0],!1),await Ln(this,Ze.NEED_ENABLE_TRACK,this)}catch(m){throw s||(this._enabled=!1),F.error("[".concat(this.getTrackId(),"] setEnabled true failed"),m.toString()),m}F.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(vg()||lj())&&In.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((oa()||fc())&&this._enabled&&!this._isClosed&&In.duringInterruption){const r=async()=>{In.off(Ni.IOS_INTERRUPTION_END,r),this._enabled&&!this._isClosed&&(F.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};In.on(Ni.IOS_INTERRUPTION_END,r)}else F.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Rg.TRACK_ENDED)}async renewMediaStreamTrack(r){const a=r||this._constraints,s=no.searchDeviceIdByName(this._deviceName);if(s&&!a.deviceId&&(a.deviceId=s),this._constraints=a,this._enabled){this._originMediaStreamTrack.stop();const l=await to({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!0)}}bindProcessorContextEvents(r){super.bindProcessorContextEvents(r),r.on(Qs.REQUEST_UPDATE_CONSTRAINTS,async(a,s,l)=>{try{const d=Object.assign({},this._originalConstraints,...a);await this.renewMediaStreamTrack(d),s()}catch(d){l(d)}})}unbindProcessorContextEvents(r){super.unbindProcessorContextEvents(r),r.removeAllListeners(Qs.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[I9,O9],Object.getOwnPropertyDescriptor(iu.prototype,"setDevice"),iu.prototype),an(iu.prototype,"setEnabled",[P9,k9,j9],Object.getOwnPropertyDescriptor(iu.prototype,"setEnabled"),iu.prototype),an(iu.prototype,"close",[D9],Object.getOwnPropertyDescriptor(iu.prototype,"close"),iu.prototype),iu),lIe=(L9=Et({argsMap:(r,a)=>[r.getTrackId(),a,r.duration]}),M9=gr(),U9=Et({argsMap:r=>[r.getTrackId()]}),F9=gr(),V9=Et({argsMap:r=>[r.getTrackId()]}),B9=gr(),$9=Et({argsMap:r=>[r.getTrackId()]}),W9=gr(),G9=Et({argsMap:r=>[r.getTrackId()]}),H9=gr(),z9=Et({argsMap:r=>[r.getTrackId()]}),K9=Et({argsMap:r=>[r.getTrackId()]}),q9=gr(),an((Ui=class extends vr{get __className__(){return"BufferSourceAudioTrack"}constructor(r,a,s,l){super(a.createOutputTrack(),s,l),_e(this,"source",void 0),_e(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=r,this._bufferSource=a,this._bufferSource.on(Zs.AUDIO_SOURCE_STATE_CHANGE,d=>{this.safeEmit(Rg.SOURCE_STATE_CHANGE,d)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(r){r&&this._bufferSource.updateOptions(r),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(r){this._bufferSource.seekAudioBuffer(r)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(r){kn(r,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(r)}}).prototype,"startProcessAudioBuffer",[L9,M9],Object.getOwnPropertyDescriptor(Ui.prototype,"startProcessAudioBuffer"),Ui.prototype),an(Ui.prototype,"pauseProcessAudioBuffer",[U9,F9],Object.getOwnPropertyDescriptor(Ui.prototype,"pauseProcessAudioBuffer"),Ui.prototype),an(Ui.prototype,"seekAudioBuffer",[V9,B9],Object.getOwnPropertyDescriptor(Ui.prototype,"seekAudioBuffer"),Ui.prototype),an(Ui.prototype,"resumeProcessAudioBuffer",[$9,W9],Object.getOwnPropertyDescriptor(Ui.prototype,"resumeProcessAudioBuffer"),Ui.prototype),an(Ui.prototype,"stopProcessAudioBuffer",[G9,H9],Object.getOwnPropertyDescriptor(Ui.prototype,"stopProcessAudioBuffer"),Ui.prototype),an(Ui.prototype,"close",[z9],Object.getOwnPropertyDescriptor(Ui.prototype,"close"),Ui.prototype),an(Ui.prototype,"setAudioBufferPlaybackSpeed",[K9,q9],Object.getOwnPropertyDescriptor(Ui.prototype,"setAudioBufferPlaybackSpeed"),Ui.prototype),Ui);class Yr extends vr{get __className__(){return"MixingAudioTrack"}get isActive(){for(const a of this.trackList)if(a._enabled&&!a._isClosed&&!a.muted)return!0;return!1}constructor(){const a=Ig().createMediaStreamDestination();super(a.stream.getAudioTracks()[0],void 0,Mn(8,"track-mix-")),_e(this,"trackList",void 0),_e(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=a,this.trackList=[]}hasAudioTrack(a){return this.trackList.indexOf(a)!==-1}addAudioTrack(a){this.trackList.indexOf(a)===-1?(F.debug("add ".concat(a.getTrackId()," to mixing track")),a._source.outputNode.connect(this.destNode),this.trackList.push(a),this.updateEncoderConfig()):F.debug("track ".concat(a.getTrackId()," is already added"))}removeAudioTrack(a){if(this.trackList.indexOf(a)!==-1){F.debug("remove ".concat(a.getTrackId()," from mixing track"));try{a._source.outputNode.disconnect(this.destNode)}catch{}Vx(this.trackList,a),this.updateEncoderConfig()}}updateEncoderConfig(){const a={};this.trackList.forEach(s=>{s._encoderConfig&&((s._encoderConfig.bitrate||0)>(a.bitrate||0)&&(a.bitrate=s._encoderConfig.bitrate),(s._encoderConfig.sampleRate||0)>(a.sampleRate||0)&&(a.sampleRate=s._encoderConfig.sampleRate),(s._encoderConfig.sampleSize||0)>(a.sampleSize||0)&&(a.sampleSize=s._encoderConfig.sampleSize),s._encoderConfig.stereo&&(a.stereo=!0))}),this._encoderConfig=a}_updateRtpTransceiver(a){this._rtpTransceiver!==a&&(this._rtpTransceiver=a,this.trackList.forEach(s=>{s instanceof Yr?s.emit(cp.TRANSCEIVER_UPDATED,a):s._updateRtpTransceiver(a)}))}}class uIe extends Yz{set currentState(a){a!==this._currentState&&(this._currentState=a,this.safeEmit(Zs.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),_e(this,"audioBuffer",void 0),_e(this,"sourceNode",void 0),_e(this,"startPlayTime",0),_e(this,"startPlayOffset",0),_e(this,"pausePlayTime",0),_e(this,"options",void 0),_e(this,"currentLoopCount",0),_e(this,"currentPlaybackSpeed",100),_e(this,"_currentState","stopped"),this.audioBuffer=a,this.options=s,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(a){this.currentState==="stopped"?(this.options=a,this.startPlayOffset=this.options.startPlayTime||0):F.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(a){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=a,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=a))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(a){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=a/100),this.currentPlaybackSpeed=a}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const a=this.context.createBufferSource();return a.buffer=this.audioBuffer,a.loop=!!this.options.loop,a.connect(this.outputNode),a.playbackRate.value=this.currentPlaybackSpeed/100,a}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const Y9=new Map;function X9(r,a){if(r.length===0||a.length===0)return 1/0;const s=vj(r),l=vj(a);return Math.floor(l/s)}class Gj{get rendFrameRate(){const a=Math.max(1,X9(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/a)}get videoElementStatus(){return this._isInPage?this._videoElementStatus:Hi.DESTROYED}set videoElementStatus(a){a!==this._videoElementStatus&&(F.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(a)),this._videoElementStatus=a)}get videoState(){return this._videoState}set videoState(a){var s;a!==this._videoState&&(this._videoState=a,(s=this.onVideoStateChanged)===null||s===void 0||s.call(this,this.videoState))}constructor(a){_e(this,"trackId",void 0),_e(this,"config",void 0),_e(this,"onFirstVideoFrameDecoded",void 0),_e(this,"onFirstVideoFrameRender",void 0),_e(this,"onVideoStateChanged",void 0),_e(this,"freezeTimeCounterList",[]),_e(this,"renderFreezeAccTime",0),_e(this,"renderFreezeAccTime2",0),_e(this,"isKeepLastFrame",!1),_e(this,"isDestroyed",!1),_e(this,"timeUpdatedCount",0),_e(this,"freezeTime",0),_e(this,"playbackTime",0),_e(this,"lastTimeUpdatedTime",0),_e(this,"autoplayFailed",!1),_e(this,"videoTrack",void 0),_e(this,"videoElement",void 0),_e(this,"cacheVideoElement",void 0),_e(this,"internal",!1),_e(this,"_render_interframe_delays",[]),_e(this,"_render_interframe_delays_sizes",[]),_e(this,"_videoState",ru.VideoStateStopped),_e(this,"videoElementCheckInterval",void 0),_e(this,"videoElementFreezeTimeout",void 0),_e(this,"_videoElementStatus",Hi.NONE),_e(this,"_isInPage",!0),_e(this,"isGettingVideoDimensions",!1),_e(this,"startGetVideoDimensions",()=>{const s=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return F.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(s,500)};!this.isGettingVideoDimensions&&s()}),_e(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&In.curState==="running"&&(F.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(YH())),rz()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),_e(this,"handleVideoEvents",s=>{switch(s.type){case"play":case"playing":s.type==="play"&&F.debug("[".concat(this.trackId,"] video element status: play")),this.startGetVideoDimensions(),this.videoElementStatus=Hi.PLAYING;break;case"loadeddata":if(this.videoState=ru.VideoStateStarting,this.onFirstVideoFrameRender&&this.onFirstVideoFrameRender(),this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=Hi.CANPLAY;break;case"stalled":this.videoElementStatus=Hi.STALLED;break;case"suspend":this.videoElementStatus=Hi.SUSPEND;break;case"pause":this.videoElementStatus=Hi.PAUSED,oa()||fc()||ji()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(F.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=Hi.WAITING;break;case"abort":this.videoElementStatus=Hi.ABORT;break;case"ended":this.videoElementStatus=Hi.ENDED;break;case"emptied":this.videoElementStatus=Hi.EMPTIED;break;case"error":{const l=this.videoElement.error;l&&(this.videoElementStatus=Hi.ERROR,F.error("[".concat(this.trackId,"] media error: ").concat(l.message," (").concat(l.code,")")));break}case"timeupdate":{const l=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=l);const d=l-this.lastTimeUpdatedTime,f=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=l,au.lastVisibleTime<au.lastHiddenTime||f<au.lastHiddenTime||f<au.lastVisibleTime||this.isSkipCalcRenderFreezeTime())return;for(d>se("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=d),this.playbackTime+=d;this.playbackTime>=6e3;){this.playbackTime-=6e3;const m=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(m),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),_e(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(F.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(YH())),rz()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=a.trackId,this.config=a,a.element instanceof HTMLVideoElement?this.videoElement=a.element:this.videoElement=document.createElement("video"),In.on(Ni.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),In.on(Ni.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var a;return(a=this.videoElement.parentElement)!==null&&a!==void 0?a:void 0}updateConfig(a){this.config=a,this.trackId=a.trackId,a.element!==this.videoElement&&(this.destroy(),this.videoElement=a.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(a){this.videoTrack!==a&&(this.videoTrack=a,this.initVideoElement())}play(a){const s=this.videoElement.play();s&&s.catch&&s.catch(d=>{a&&n9(a,"video",d.message,this.trackId),d.name==="NotAllowedError"?(F.warning("detected video element autoplay failed",d),this.autoplayFailed=!0,this.handleAutoPlayFailed()):F.warning("[".concat(this.trackId,"] play warning: "),d)});const l=sn();if((l.name==="Safari"&&Number(l.version)===15||vg())&&s&&s.then){const d=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};s.then(d).catch(d)}}getCurrentFrame(){const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const s=a.getContext("2d");if(!s)return F.error("create canvas context failed!"),new ImageData(2,2);s.drawImage(this.videoElement,0,0,a.width,a.height);const l=s.getImageData(0,0,a.width,a.height);return a.remove(),l}async getCurrentFrameToUint8Array(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=document.createElement("canvas");l.width=this.videoElement.videoWidth,l.height=this.videoElement.videoHeight;const d=l.getContext("2d");return d?(d.drawImage(this.videoElement,0,0,l.width,l.height),new Ge((f,m)=>{l.toBlob(async y=>{if(l.remove(),y){const _=await d9(y);f({buffer:_,width:l.width,height:l.height})}else m(new Se(ie.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},a,s<0?.1:s>1?1:s)})):await Wj(a)}destroy(){this.isDestroyed=!0,In.off(Ni.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),In.off(Ni.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=ru.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=Hi.INIT,!this.videoElementCheckInterval&&(J9.forEach(f=>{this.videoElement.addEventListener(f,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{this._isInPage=function(f){return f!==document.body&&document.body.contains(f)}(this.videoElement)},1e3),se("ENABLE_VIDEO_FRAME_CALLBACK"))){var a,s;let f;const m=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",m),this.videoElementFreezeTimeout=window.setTimeout(y,se("VIDEO_FREEZE_DURATION")))},y=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===ru.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=ru.VideoStateFrozen:document.addEventListener("visibilitychange",m))},_=(w,x)=>{if(this.videoElementStatus===Hi.PLAYING){if(f){const L=x.presentationTime-f.presentationTime,H=x.presentedFrames-f.presentedFrames;this._render_interframe_delays_sizes.push(H),this._render_interframe_delays.push(L);const $=vj(this._render_interframe_delays_sizes),G=$-this._render_interframe_delays_sizes[0];if($>30&&G>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===ru.VideoStateStarting&&(this.videoState=ru.VideoStateDecoding),this.videoState===ru.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(y,se("VIDEO_FREEZE_DURATION"))),L<se("VIDEO_FREEZE_DURATION")&&this.videoState===ru.VideoStateFrozen&&(this.videoState=ru.VideoStateDecoding),L>se("VIDEO_FREEZE_DURATION")&&au.lastVisibleTime>=au.lastHiddenTime&&f.timestamp>au.lastVisibleTime&&f.timestamp>au.lastHiddenTime){const ne=Math.min(66,X9(this._render_interframe_delays_sizes,this._render_interframe_delays)),te=Math.max(0,L-(H-1)*ne);this.renderFreezeAccTime2+=te>ne?te:0,this.renderFreezeAccTime+=L}}f=Bn(Bn({},x),{},{timestamp:w})}else this.isSkipCalcRenderFreezeTime()&&(f=Bn(Bn({},x),{},{timestamp:w}));var A,I;se("ENABLE_VIDEO_FRAME_CALLBACK")&&((A=(I=this.videoElement).requestVideoFrameCallback)===null||A===void 0||A.call(I,_))};(a=(s=this.videoElement).requestVideoFrameCallback)===null||a===void 0||a.call(s,_)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Fx()&&!se("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const l=sn();l.name==="Safari"&&Number(l.version)===15||vg()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,dr()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,dr()&&this.videoElement.load());const d=this.videoElement.play();d!==void 0&&d.catch(f=>{F.debug("[".concat(this.trackId,"] playback interrupted"),f.toString())})}resetVideoElement(){J9.forEach(a=>{this.videoElement&&this.videoElement.removeEventListener(a,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=Hi.NONE}isSkipCalcRenderFreezeTime(){return this.videoElementStatus===Hi.DESTROYED||this.internal}handleAutoPlayFailed(){const a=s=>{s.preventDefault(),this.videoElement.play().then(()=>{F.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(l=>{F.error(l)}),this.autoplayFailed=!1,ib()?document.body.removeEventListener("click",a,!0):(document.body.removeEventListener("touchstart",a,!0),document.body.removeEventListener("mousedown",a,!0))};ib()?document.body.addEventListener("click",a,!0):(document.body.addEventListener("touchstart",a,!0),document.body.addEventListener("mousedown",a,!0)),t9()}}const J9=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class Hj extends Gj{constructor(a){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];super(a),_e(this,"container",void 0),_e(this,"slot",void 0),this.slot=a.element,this.internal=s,this.updateConfig(a)}updateConfig(a){this.config=a,this.trackId=a.trackId;const s=a.element;var l;!this.internal||this.slot?(s!==this.slot&&(this.destroy(),this.slot=s),this.createElements()):(this.slot=s,s&&this.container?(this.internal=!1,this.container.id="agora-video-player-".concat(this.trackId),this.videoElement.id="video_".concat(this.trackId),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",(l=this.slot)===null||l===void 0||l.appendChild(this.container)):this.createElements())}updateVideoTrack(a){this.videoTrack!==a&&(this.videoTrack=a,this.createElements())}play(a){var s;(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)&&super.play(a)}getCurrentFrame(){var a;return(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(a){var s;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(a,l):await Wj(a)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{var a;this.container.remove(),(a=this.slot)===null||a===void 0||a.removeChild(this.container)}catch{}this.container=void 0}}createElements(){var a;this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",se("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),(a=this.slot)===null||a===void 0||a.appendChild(this.container)}mountedVideoElement(){var a;!this.container||(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var a;if((a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var a;(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var Z9,Q9,e7,t7,n7,r7,i7,a7,s7,o7,c7,l7,u7,d7,h7,f7,p7,m7,g7,v7,y7,_7,b7,E7,w7,S7,x7,T7,Jt,C7,R7,N7,A7,I7,O7,P7,k7,io;let Wn=(Z9=Et({argsMap:(r,a,s)=>[r.getTrackId(),typeof a=="string"?a:a instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),Q9=gr(),e7=Et({argsMap:r=>[r.getTrackId()]}),t7=Eg("LocalVideoTrack","_enabledMutex"),n7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),r7=gr(),i7=Eg("LocalVideoTrack","_enabledMutex"),a7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),s7=gr(),o7=Et({argsMap:(r,a)=>[r.getTrackId(),a,r._saveEncodeBitrateRatio]}),c7=gr(),l7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),u7=gr(),d7=gr(),h7=Et({argsMap:(r,a,s)=>[r.getTrackId(),a,s]}),f7=gr(),p7=gr(),m7=gr(),g7=Et({argsMap:r=>[r.getTrackId()]}),v7=gr(),y7=gr(),_7=gr(),b7=gr(),E7=gr(),w7=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),S7=Et({argsMap:r=>[r.getTrackId()]}),x7=Et({argsMap:r=>[r.getTrackId()]}),T7=Et({argsMap:(r,a,s)=>[r.getTrackId(),a.label,s]}),Jt=class Xle extends Ag{get videoHeight(){if(ji()){const{height:a}=this._mediaStreamTrack.getSettings();return this._videoHeight=a,this._videoHeight}return this._videoHeight}get videoWidth(){if(ji()){const{width:a}=this._mediaStreamTrack.getSettings();return this._videoWidth=a,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Hi.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(a){this._processorContext=a}get __className__(){return"LocalVideoTrack"}constructor(a,s,l,d,f,m){if(super(a,f),_e(this,"trackMediaType",Ng.VIDEO),_e(this,"_player",void 0),_e(this,"isUseScaleResolutionDownBy",!1),_e(this,"_videoVisibleTimer",null),_e(this,"_previousVideoVisibleStatus",void 0),_e(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_e(this,"_encoderConfig",void 0),_e(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),_e(this,"_optimizationMode",void 0),_e(this,"_saveEncodeBitrateRatio",1),_e(this,"_videoHeight",void 0),_e(this,"_videoWidth",void 0),_e(this,"_forceBitrateLimit",void 0),_e(this,"_enabled",!0),_e(this,"_processorDestination",void 0),_e(this,"_processorContext",void 0),ji()){const{width:y,height:_}=a.getSettings();this._videoWidth=y,this._videoHeight=_}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=l,this._optimizationMode=d,this._hints=m||[],s&&this._hints.indexOf(jn.CUSTOM_TRACK)!==-1?this._encoderConfig=ir(s):this._encoderConfig=s,this._hints.indexOf(jn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(ij(pn.CHROME,115)&&Mx().indexOf("Windows")!==-1){const y=function(_,w){if("VideoFrame"in window&&"TransformStream"in window&&un().supportWebRTCInsertableStream){const x=new MediaStreamTrackProcessor(_),A=new MediaStreamTrackGenerator({kind:"video"});let I,L,H=Date.now();const $=()=>{G&&(clearInterval(G),G=void 0),I&&(I.close(),I=void 0),_.stop(),L=void 0,A.removeEventListener("ended",$)};let G=window.setInterval(()=>{if(L&&I&&Date.now()-H>1e3)try{A.readyState==="live"?L.enqueue(I.clone()):$()}catch{$()}},1e3);const ne=new TransformStream({transform:(te,ce)=>{A.readyState==="live"?(L=ce,H=Date.now(),I===void 0?(I=te,ce.enqueue(te.clone())):(ce.enqueue(I),I=te)):te.close()}});return A.addEventListener("ended",$),x.readable.pipeThrough(ne).pipeTo(A.writable),A}}(a);y&&(F.info("local screen video track begin to inject frame"),this._mediaStreamTrack=y)}s&&this._hints.indexOf(jn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(s),this._processorContext=new i9(this.getTrackId(),"local"),this._processorDestination=new r9(this.processorContext),this.bindProcessorDestinationEvents()}play(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof a=="string"){const d=document.getElementById(a);d?a=d:(F.warning("[".concat(this.getTrackId(),'] can not find "#').concat(a,'" element, use document.body')),a=document.body)}F.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(a instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(s));const l=Bn(Bn(Bn({},this._getDefaultPlayerConfig()),s),{},{trackId:this.getTrackId(),element:a});this._player?this._player.updateConfig(l):(a instanceof HTMLVideoElement?this._player=new Gj(l):this._player=new Hj(l),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const d=this.getVideoElementVisibleStatus();this.safeEmit(Rg.VIDEO_ELEMENT_VISIBLE_STATUS,d)}catch{}},se("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,F.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(a,s){if(!s){if(a===this._enabled)return;this.stateCheck("enabled",a)}if(F.info("[".concat(this.getTrackId(),"] start setEnabled"),a),!a){this._originMediaStreamTrack.enabled=!1;try{await Ln(this,Ze.NEED_DISABLE_TRACK,this)}catch(l){throw F.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}return s||(this._enabled=!1),void F.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Ln(this,Ze.NEED_ENABLE_TRACK,this)}catch(l){throw F.error("[".concat(this.getTrackId(),"] setEnabled to true error"),l.toString()),l}F.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}async setMuted(a){a!==this._muted&&(this.stateCheck("muted",a),this._muted=a,this._originMediaStreamTrack.enabled=!a,F.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(a)),a?await Ln(this,Ze.NEED_MUTE_TRACK,this):await Ln(this,Ze.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._saveEncodeBitrateRatio;if(this._saveEncodeBitrateRatio!==1&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*a),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*a),F.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(a)),this._saveEncodeBitrateRatio=1;try{await Ln(this,Ze.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(F)}}}async setEncoderConfiguration(a,s){if(!this._enabled)throw new Se(ie.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(a=gc(a),se("USE_STANDARD_BITRATE_DEFAULT")&&(delete a.bitrateMax,delete a.bitrateMin),this._forceBitrateLimit&&(a.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:a.bitrateMax,a.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:a.bitrateMin),a.width||a.height||a.frameRate){const l=Qx({encoderConfig:a});(ji()||oa()||fc())&&(l.deviceId=void 0),F.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(a),JSON.stringify(l));try{await this._originMediaStreamTrack.applyConstraints(l),this.updateMediaStreamTrackResolution()}catch(d){const f=new Se(ie.UNEXPECTED_ERROR,d.toString());throw F.error("[".concat(this.getTrackId(),"] applyConstraints error"),f.toString()),f}}this._encoderConfig=a,this._hints.indexOf(jn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Ln(this,Ze.NEED_UPDATE_VIDEO_ENCODER,this)}catch(l){return l.throw(F)}}getStats(){return hh(()=>{F.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),Xs(this,Ze.GET_STATS)||Bn({},Lj)}async setBeautyEffect(a){F.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(a,s):await Wj(a)}async findClosestProfile(){const{width:a,height:s,frameRate:l}=this.getMediaStreamTrackSettings(),{width:d,height:f,frameRate:m}=this._encoderConfig||{},y=bg(this._videoWidth||a||d||0),_=bg(this._videoHeight||s||f||0),w=function(x,A,I){if(!Array.isArray(se("VIDEO_ENCODER_CONFIG_LIST"))||se("VIDEO_ENCODER_CONFIG_LIST").length===0)return!1;const L=Math.min(x,A);return!(L>=480)&&Bn(Bn({},se("VIDEO_ENCODER_CONFIG_LIST").find(H=>H.height>L)),{},{frameRate:I})}(y,_,bg(l||m||15));if(w)return F.debug("[".concat(this.getTrackId(),"] find closest profile, ").concat(y,"x").concat(_," => ").concat(JSON.stringify(w))),this.setEncoderConfiguration(w)}async setBitrateLimit(a){F.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(a))),a&&(this._forceBitrateLimit=a,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<a.max_bitrate?this._encoderConfig.bitrateMax:a.max_bitrate:this._encoderConfig.bitrateMax=a.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=a.min_bitrate))}async setOptimizationMode(a){if(a!=="motion"&&a!=="detail"&&a!=="balanced")return void F.error(ie.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const s=this._optimizationMode;try{this._optimizationMode=a,await Ln(this,Ze.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(l){throw this._optimizationMode=s,F.error("[".concat(this.getTrackId(),"] set optimization mode failed"),l.toString()),l}F.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(a,")"))}setScalabiltyMode(a){if(a.numSpatialLayers===1&&a.numTemporalLayers!==1)return F.error(ie.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=a,F.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(a,")"))}updateMediaStreamTrackResolution(){o9(this._originMediaStreamTrack).then(a=>{let[s,l]=a;this._videoHeight=l,this._videoWidth=s}).catch($x)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(a){if(!this._enabled)throw new Se(ie.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");F.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(a)),a=gc(a),this._forceBitrateLimit&&(a.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:a.bitrateMax,a.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:a.bitrateMin),this._encoderConfig=a,this._hints.indexOf(jn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Ln(this,Ze.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(F)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:a,height:s,frameRate:l}=this.getMediaStreamTrackSettings();if(!a||!s||!l)return;const{bitrateMax:d,bitrateMin:f}=this._encoderConfig;if(f==null||d==null){const{max:m,min:y}=function(_,w,x,A,I){const L=se("BITRATE_ADAPTER_TYPE");if(L==="DEFAULT_BITRATE")return{min:A,max:I};if(I===void 0){const H=Math.floor(200*Math.pow(x/15,.6)*Math.pow(_*w/640/360,.75));I=L==="STANDARD_BITRATE"?4*H:2*H,A=A??H}else A=A??Math.floor(I/10);return{min:A,max:I}}(a,s,l,f,d);if(this._encoderConfig.bitrateMin=y,this._encoderConfig.bitrateMax=m,se("VIDEO_STANDARD_BITRATE_VERSION")&&f==null&&d==null){const[_,w]=function(x,A,I){const L=4*Math.floor(2e5*Math.pow(I/15,.6)*Math.pow(x*A/230400,.75)),H=x*A,$=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),G=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let ne=Rs($).call($).next().value,te=1;if($.has(H))ne=$.get(H);else{var ce;const Le=Yf(ce=Array.from($.entries())).call(ce,(qt,Rt)=>{let[bn]=qt,[yn]=Rt;return bn-yn}),Ht=Le.find(qt=>{let[Rt]=qt;return Rt>H});if(Ht){const qt=Le.indexOf(Ht);if(qt>0){const Rt=Le[qt-1],bn=(H-Rt[0])/(Ht[0]-Rt[0]);ne=Rt[1]+bn*(Ht[1]-Rt[1])}else ne=Ht[1]}else ne=Le[Le.length-1][1]}if(G.has(H))te=G.get(H);else{var pe;const Le=Yf(pe=Array.from(G.entries())).call(pe,(qt,Rt)=>{let[bn]=qt,[yn]=Rt;return bn-yn}),Ht=Le.find(qt=>{let[Rt]=qt;return Rt>H});if(Ht){const qt=Le.indexOf(Ht);if(qt>0){const Rt=Le[qt-1],bn=(H-Rt[0])/(Ht[0]-Rt[0]);te=Rt[1]+bn*(Ht[1]-Rt[1])}else te=Ht[1]}else te=Le[Le.length-1][1]}const fe=se("VIDEO_NEW_BITRATE_RATIO");fe&&fe>0&&(ne=fe/100);const ue=Math.floor(L*ne),ye=Math.floor(65e4*Math.pow(x*A/230400,.5)*Math.pow(I/15,.69));let xe=ue;const Ae=se("VIDEO_STANDARD_BITRATE_VERSION");return Ae&&Ae>0&&(Ae===1?xe=L:Ae===2?xe=ue:Ae===3&&(xe=ye)),[Math.floor(xe/1e3),te]}(a,s,l);this._encoderConfig.bitrateMax=_,this._encoderConfig.bitrateMin=y?Math.min(y,_):_,this._saveEncodeBitrateRatio=w,F.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(a,", h: ").concat(s,", fps: ").concat(l,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else F.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(a,", h: ").concat(s,", fps: ").concat(l,"] => [brMax: ").concat(m,", brMin: ").concat(y,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var a,s;const l=this==null||(a=this._player)===null||a===void 0?void 0:a.getContainerElement(),d={track:this,element:this==null||(s=this._player)===null||s===void 0?void 0:s.getVideoElement(),slot:l==null?void 0:l.parentElement},{element:f,slot:m}=d;if(this.isPlaying&&f instanceof HTMLVideoElement&&m instanceof HTMLElement){const y=cz.checkOneElementVisible(f),_=Object.assign({},y);if(_.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_.visible;const w=nt.reportApiInvoke(null,{tag:rr.TRACER,name:Er.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_.visible?w.onSuccess("Video is visible"):w.onSuccess("Invisible because of ".concat(_.reason))}return _}return}catch(l){throw new Se(ie.GET_VIDEO_ELEMENT_VISIBLE_ERROR,l.message)}}async renewMediaStreamTrack(a){}pipe(a){if(this.processor===a)return a;if(a._source)throw new Se(ie.INVALID_OPERATION,"Processor ".concat(a.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=a,this.processor._source=this,a.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),a}unpipe(){if(!this.processor)return;const a=this.processor;this.processor._source=void 0,this.processor=void 0,a.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(a){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],l=this._encoderConfig;a&&(l=Bn(Bn({},l),gc(a))),l=ip(l);const d=Mn(8,"track-video-cloned-"),f=new Xle(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,l,ip(this._scalabilityMode),this._optimizationMode,d,ip(this._hints));return a&&l&&f.setEncoderConfiguration(l),F.debug("clone video track from ".concat(this.getTrackId()," to ").concat(d,", clone ").concat(s)),f}async replaceTrack(a,s){if(!(a instanceof MediaStreamTrack))throw new Se(ie.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(a.kind!=="video")throw new Se(ie.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(a,s,!0),this.updateMediaStreamTrackResolution()}sendSeiData(a){if(hh(()=>{nt.reportApiInvoke(null,{name:Er.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:rr.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!se("ENABLE_VIDEO_SEI")||!se("ENABLE_ENCODED_TRANSFORM"))return void F.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(a instanceof Uint8Array==0)return new Se(ie.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const s=this.getRTCRtpTransceiver();if(!s)return void F.warning("Video track is not published, SEI can not be send");const l=s.sender.getParameters();if(l.codecs.length===0)return;const d=l.codecs[0].mimeType.toLocaleLowerCase();d==="video/h264"||d==="video/h265"?this.safeEmit("sei-to-send",a):F.warning("SEI is not supported by ".concat(d))}bindProcessorDestinationEvents(){this.processorDestination.on(ja.ON_TRACK,async a=>{a?a!==this._mediaStreamTrack&&(this._mediaStreamTrack=a,this._updatePlayerSource(),await Ln(this,Ze.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,Ze.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ja.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Qs.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Qs.REQUEST_CONSTRAINTS)}},an(Jt.prototype,"play",[Z9,Q9],Object.getOwnPropertyDescriptor(Jt.prototype,"play"),Jt.prototype),an(Jt.prototype,"stop",[e7],Object.getOwnPropertyDescriptor(Jt.prototype,"stop"),Jt.prototype),an(Jt.prototype,"setEnabled",[t7,n7,r7],Object.getOwnPropertyDescriptor(Jt.prototype,"setEnabled"),Jt.prototype),an(Jt.prototype,"setMuted",[i7,a7,s7],Object.getOwnPropertyDescriptor(Jt.prototype,"setMuted"),Jt.prototype),an(Jt.prototype,"setSaveEncodeBitrateRatio",[o7,c7],Object.getOwnPropertyDescriptor(Jt.prototype,"setSaveEncodeBitrateRatio"),Jt.prototype),an(Jt.prototype,"setEncoderConfiguration",[l7,u7],Object.getOwnPropertyDescriptor(Jt.prototype,"setEncoderConfiguration"),Jt.prototype),an(Jt.prototype,"getStats",[d7],Object.getOwnPropertyDescriptor(Jt.prototype,"getStats"),Jt.prototype),an(Jt.prototype,"setBeautyEffect",[h7,f7],Object.getOwnPropertyDescriptor(Jt.prototype,"setBeautyEffect"),Jt.prototype),an(Jt.prototype,"getCurrentFrameData",[p7],Object.getOwnPropertyDescriptor(Jt.prototype,"getCurrentFrameData"),Jt.prototype),an(Jt.prototype,"getCurrentFrameImage",[m7],Object.getOwnPropertyDescriptor(Jt.prototype,"getCurrentFrameImage"),Jt.prototype),an(Jt.prototype,"findClosestProfile",[g7,v7],Object.getOwnPropertyDescriptor(Jt.prototype,"findClosestProfile"),Jt.prototype),an(Jt.prototype,"setBitrateLimit",[y7],Object.getOwnPropertyDescriptor(Jt.prototype,"setBitrateLimit"),Jt.prototype),an(Jt.prototype,"setOptimizationMode",[_7],Object.getOwnPropertyDescriptor(Jt.prototype,"setOptimizationMode"),Jt.prototype),an(Jt.prototype,"setScalabiltyMode",[b7],Object.getOwnPropertyDescriptor(Jt.prototype,"setScalabiltyMode"),Jt.prototype),an(Jt.prototype,"updateMediaStreamTrackResolution",[E7],Object.getOwnPropertyDescriptor(Jt.prototype,"updateMediaStreamTrackResolution"),Jt.prototype),an(Jt.prototype,"pipe",[w7],Object.getOwnPropertyDescriptor(Jt.prototype,"pipe"),Jt.prototype),an(Jt.prototype,"unpipe",[S7],Object.getOwnPropertyDescriptor(Jt.prototype,"unpipe"),Jt.prototype),an(Jt.prototype,"close",[x7],Object.getOwnPropertyDescriptor(Jt.prototype,"close"),Jt.prototype),an(Jt.prototype,"replaceTrack",[T7],Object.getOwnPropertyDescriptor(Jt.prototype,"replaceTrack"),Jt.prototype),Jt),eT=(C7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),R7=gr(),N7=Eg("CameraVideoTrack","_enabledMutex"),A7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),I7=gr(),O7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),P7=gr(),k7=Et({argsMap:r=>[r.getTrackId()]}),io=class Jle extends Wn{get __className__(){return"CameraVideoTrack"}constructor(a,s,l,d,f,m){super(a,gc(s.encoderConfig),d,f,m),_e(this,"_config",void 0),_e(this,"_originalConstraints",void 0),_e(this,"_constraints",void 0),_e(this,"_enabled",!0),_e(this,"_deviceName","default"),_e(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(vg()||lj())&&!function(){const y=sn();if(y.os!==oi.IOS||!y.osVersion)return!1;const _=y.osVersion.split(".");return Number(_[0])===15&&Number(_[1])>=2}()&&iz()&&this._enabled&&!this._isClosed&&(F.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=s,this._originalConstraints=l,this._constraints=l,this._deviceName=a.label,this._encoderConfig=gc(this._config.encoderConfig),In.on(Ni.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),In.on(Ni.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(a){return typeof a=="string"?this._setDeviceById(a):a.deviceId?this._setDeviceById(a.deviceId):a.facingMode?this._setDeviceByFacingModel(a.facingMode):void 0}async _setDeviceById(a){if(F.info("[".concat(this.getTrackId(),"] set device to ").concat(a)),this._enabled)try{const s=await no.getDeviceById(a),l={};l.video=Bn({},this._constraints),l.video.deviceId={exact:a},l.video.facingMode=void 0,this._originMediaStreamTrack.stop();let d=null;try{d=await to(l,this.getTrackId())}catch(f){throw F.error("[".concat(this.getTrackId(),"] setDevice failed"),f.toString()),d=await to({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(d.getVideoTracks()[0],!1),f}await this._updateOriginMediaStreamTrack(d.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=s.label,this._config.cameraId=a,this._constraints.deviceId={exact:a}}catch(s){throw F.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}else try{const s=await no.getDeviceById(a);this._deviceName=s.label,this._config.cameraId=a,this._constraints.deviceId={exact:a}}catch(s){throw F.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}F.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(a){F.info("[".concat(this.getTrackId(),"] set facingMode ").concat(a));const s={video:Bn(Bn({},this._constraints),{},{deviceId:void 0,facingMode:{exact:a}})};if(this._enabled){this._originMediaStreamTrack.stop();let l=null;try{l=await to(s,this.getTrackId())}catch(d){throw F.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),d.toString()),l=await to({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),d}await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=a,this._config.cameraId=void 0,this._constraints=Bn({},s.video),F.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(a,s){if(!s){if(a===this._enabled)return;this.stateCheck("enabled",a)}if(F.info("[".concat(this.getTrackId(),"] start setEnabled"),a),a){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const l=await to({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1)}await Ln(this,Ze.NEED_ENABLE_TRACK,this)}catch(l){throw F.error("[".concat(this.getTrackId(),"] setEnabled true error"),l.toString()),l}this.updateMediaStreamTrackResolution(),F.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),s||(this._enabled=!1);try{await Ln(this,Ze.NEED_DISABLE_TRACK,this)}catch(l){throw F.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}F.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(a,s){if(!this._enabled)throw new Se(ie.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");a=gc(a),se("USE_STANDARD_BITRATE_DEFAULT")&&(delete a.bitrateMax,delete a.bitrateMin),this._forceBitrateLimit&&(a.bitrateMax=this._forceBitrateLimit.max_bitrate||a.bitrateMax,a.bitrateMin=this._forceBitrateLimit.min_bitrate||a.bitrateMin);const l=ir(this._config);l.encoderConfig=a;const d=Qx(l);(ji()||oa()||fc())&&(d.deviceId=void 0),F.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(a),JSON.stringify(d));try{await this._originMediaStreamTrack.applyConstraints(d),this.updateMediaStreamTrackResolution()}catch(f){const m=new Se(ie.UNEXPECTED_ERROR,f.toString());throw F.error("[".concat(this.getTrackId(),"] applyConstraints error"),m.toString()),m}this._config=l,this._constraints=d,this._originalConstraints=d,this._encoderConfig=a,this._hints.indexOf(jn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Ln(this,Ze.NEED_UPDATE_VIDEO_ENCODER,this)}catch(f){return f.throw(F)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((oa()||fc())&&this._enabled&&!this._isClosed&&In.duringInterruption){const a=async()=>{In.off(Ni.IOS_INTERRUPTION_END,a),this._enabled&&!this._isClosed&&(F.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};In.on(Ni.IOS_INTERRUPTION_END,a)}else F.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Rg.TRACK_ENDED)}async renewMediaStreamTrack(a){const s=a||this._constraints,l=no.searchDeviceIdByName(this._deviceName);if(l&&!s.deviceId&&(s.deviceId={exact:l}),this._enabled){const d=await to({video:s},this.getTrackId());this._constraints=s,await this._updateOriginMediaStreamTrack(d.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),In.off(Ni.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),In.off(Ni.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(a){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],l=this._encoderConfig;a&&(l=Bn(Bn({},l),gc(a))),l=ip(l);const d=Mn(8,"track-cam-cloned-"),f=new Jle(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,ip(Bn(Bn({},this._config),{},{encoderConfig:l})),ip(this._constraints),ip(this._scalabilityMode),this._optimizationMode,d);return a&&l&&f.setEncoderConfiguration(l),F.debug("clone track from ".concat(this.getTrackId()," to ").concat(d,", clone ").concat(s)),f}bindProcessorContextEvents(){this.processorContext.on(Qs.REQUEST_UPDATE_CONSTRAINTS,async(a,s,l)=>{try{const d=Object.assign({},this._originalConstraints,...a);await this.renewMediaStreamTrack(d),s()}catch(d){l(d)}}),this.processorContext.on(Qs.REQUEST_CONSTRAINTS,async a=>{a(this._originMediaStreamTrack.getSettings())})}},an(io.prototype,"setDevice",[C7,R7],Object.getOwnPropertyDescriptor(io.prototype,"setDevice"),io.prototype),an(io.prototype,"setEnabled",[N7,A7,I7],Object.getOwnPropertyDescriptor(io.prototype,"setEnabled"),io.prototype),an(io.prototype,"setEncoderConfiguration",[O7,P7],Object.getOwnPropertyDescriptor(io.prototype,"setEncoderConfiguration"),io.prototype),an(io.prototype,"close",[k7],Object.getOwnPropertyDescriptor(io.prototype,"close"),io.prototype),io);function zj(r,a,s,l){s.optimizationMode&&(l&&l.width&&l.height?(s.encoderConfig=Bn(Bn({},l),{},{bitrateMin:l.bitrateMin,bitrateMax:l.bitrateMax}),s.optimizationMode!=="motion"&&s.optimizationMode!=="detail"||(a.contentHint=s.optimizationMode,a.contentHint===s.optimizationMode?F.debug("[".concat(r,"] set content hint to"),s.optimizationMode):F.debug("[".concat(r,"] set content hint failed")))):F.warning("[".concat(r,"] can not apply optimization mode bitrate config, no encoderConfig")))}var j7,D7,L7,M7,Ao,U7,F7,V7,B7,$7,W7,wa;class G7 extends zz{getUserId(){return this._userId}constructor(a,s,l,d){super(a,"track-".concat(a.kind,"-").concat(s,"-").concat(d.clientId,"_").concat(Mn(5,""))),_e(this,"_userId",void 0),_e(this,"_uintId",void 0),_e(this,"_isDestroyed",!1),_e(this,"store",void 0),_e(this,"processor",void 0),_e(this,"processorContext",void 0),this._userId=s,this._uintId=l,this.store=d}_updateOriginMediaStreamTrack(a){this._originMediaStreamTrack=a,this._mediaStreamTrack=a,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,F.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let Pg=(j7=Et({argsMap:(r,a,s)=>[r.getTrackId(),typeof a=="string"?a:a instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),D7=Et({argsMap:r=>[r.getTrackId()]}),L7=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),M7=Et({argsMap:r=>[r.getTrackId()]}),an((Ao=class extends G7{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Hi.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(r,a,s,l,d){super(r,a,s,l),_e(this,"_videoVisibleTimer",null),_e(this,"_previousVideoVisibleStatus",void 0),_e(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_e(this,"trackMediaType",Ng.VIDEO),_e(this,"_videoWidth",void 0),_e(this,"_videoHeight",void 0),_e(this,"_player",void 0),_e(this,"_prePlayer",void 0),_e(this,"processorDestination",void 0),_e(this,"processorContext",void 0),this._prePlayer=d,this.updateMediaStreamTrackResolution(),this.processorContext=new i9(this.getTrackId(),"remote"),this.processorDestination=new r9(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return hh(()=>{F.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),Xs(this,Ze.GET_STATS)||Bn({},Gz)}play(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.safeEmit(No.PLAY_START),typeof r=="string"){const l=document.getElementById(r);l?r=l:(F.warning("[".concat(this.getTrackId(),'] can not find "#').concat(r,'" element, use document.body')),r=document.body)}F.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(a));const s=Bn(Bn({fit:"cover"},a),{},{trackId:this.getTrackId(),element:r});if(this._player)this._player.updateConfig(s);else{let l=!1,d=!1;r instanceof HTMLVideoElement?(this._player=new Gj(s),this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0,d=!0)):this._prePlayer&&!this._prePlayer.isDestroyed?(this._player=this._prePlayer,this._prePlayer=void 0,l=this._player.videoState>0,this._player.updateConfig(s)):this._player=new Hj(s),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(No.FIRST_FRAME_DECODED),d&&this.safeEmit(No.FIRST_FRAME_RENDER)},this._player.onVideoStateChanged=f=>{this.safeEmit(No.VIDEO_STATE_CHANGED,f)},l&&(this._player.onFirstVideoFrameDecoded(),this._player.onVideoStateChanged(this._player.videoState))}this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(No.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},se("CHECK_VIDEO_VISIBLE_INTERVAL")),this.safeEmit(No.PLAY_END)}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,F.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){o9(this._originMediaStreamTrack).then(r=>{let[a,s]=r;this._videoHeight=s,this._videoWidth=a}).catch($x)}_updatePlayerSource(){F.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var r,a;const s=this==null||(r=this._player)===null||r===void 0?void 0:r.getContainerElement(),l={track:this,element:this==null||(a=this._player)===null||a===void 0?void 0:a.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:d,slot:f}=l;if(this.isPlaying&&d instanceof HTMLVideoElement&&f instanceof HTMLElement){const m=cz.checkOneElementVisible(d),y=Object.assign({},m);if(y.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=y.visible;const _=nt.reportApiInvoke(null,{tag:rr.TRACER,name:Er.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});y.visible?_.onSuccess("Video is visible"):_.onSuccess("Invisible because of ".concat(y.reason))}return y}return}catch(s){throw new Se(ie.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}pipe(r){if(this.processor===r)return r;if(r._source)throw new Se(ie.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),r}unpipe(){if(!this.processor)return;const r=this.processor;this.processor._source=void 0,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ja.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ja.ON_TRACK)}_destroy(){this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0),super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(r){this.emit(cp.SEI_RECEIVED,r)}}).prototype,"play",[j7],Object.getOwnPropertyDescriptor(Ao.prototype,"play"),Ao.prototype),an(Ao.prototype,"stop",[D7],Object.getOwnPropertyDescriptor(Ao.prototype,"stop"),Ao.prototype),an(Ao.prototype,"pipe",[L7],Object.getOwnPropertyDescriptor(Ao.prototype,"pipe"),Ao.prototype),an(Ao.prototype,"unpipe",[M7],Object.getOwnPropertyDescriptor(Ao.prototype,"unpipe"),Ao.prototype),Ao),kg=(U7=Et({argsMap:(r,a)=>[r.getTrackId(),a],throttleTime:300}),F7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),V7=Et({argsMap:r=>[r.getTrackId()]}),B7=Et({argsMap:r=>[r.getTrackId()]}),$7=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),W7=Et({argsMap:r=>[r.getTrackId()]}),an((wa=class extends G7{get isPlaying(){return this._useAudioElement?qa.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(r,a,s,l){super(r,a,s,l),_e(this,"trackMediaType",Ng.AUDIO),_e(this,"_source",void 0),_e(this,"_useAudioElement",!0),_e(this,"_volume",100),_e(this,"processorContext",void 0),_e(this,"processorDestination",void 0),_e(this,"_played",!1),_e(this,"_bypassWebAudio",!1),se("DISABLE_WEBAUDIO")?(this._source=new $j,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new Xz(r,!0),se("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Zs.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(No.FIRST_FRAME_DECODED)}),this.processorContext=new s9(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new a9(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Zs.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!r)return this._source.removeAllListeners(Zs.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(a),this._source.removeAllListeners(Zs.ON_AUDIO_BUFFER),this._source.on(Zs.ON_AUDIO_BUFFER,s=>r(s))}setVolume(r){this._volume=r,this._useAudioElement?qa.setVolume(this.getTrackId(),r):this._source.setVolume(r/100)}async setPlaybackDevice(r){if(!this._useAudioElement||!Vz())throw new Se(ie.NOT_SUPPORTED,"your browser does not support setting the audio output device");await qa.setSinkID(this.getTrackId(),r)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return hh(()=>{F.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),Xs(this,Ze.GET_STATS)||Bn({},Wz)}play(){F.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(F.debug("[".concat(this.getTrackId(),"] use audio element to play")),qa.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){F.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?qa.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];F.debug("[".concat(this.getTrackId(),"] update player source track")),r&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&qa.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(r){if(this._bypassWebAudio)throw new Se(ie.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===r)return r;if(r._source)throw new Se(ie.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),r}unpipe(){var r;if(this._bypassWebAudio)throw new Se(ie.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const a=this.processor;(r=this._source.processSourceNode)===null||r===void 0||r.disconnect(),this.processor._source=!1,this.processor=void 0,a.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ja.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(r)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(ja.ON_NODE,r=>{this._source.processedNode=r;const a=!r;this._useAudioElement!==a&&(this._played?(this.stop(),this._useAudioElement=a,this.play()):this._useAudioElement=a)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ja.ON_TRACK),this.processorDestination.removeAllListeners(ja.ON_NODE)}}).prototype,"setVolume",[U7],Object.getOwnPropertyDescriptor(wa.prototype,"setVolume"),wa.prototype),an(wa.prototype,"setPlaybackDevice",[F7],Object.getOwnPropertyDescriptor(wa.prototype,"setPlaybackDevice"),wa.prototype),an(wa.prototype,"play",[V7],Object.getOwnPropertyDescriptor(wa.prototype,"play"),wa.prototype),an(wa.prototype,"stop",[B7],Object.getOwnPropertyDescriptor(wa.prototype,"stop"),wa.prototype),an(wa.prototype,"pipe",[$7],Object.getOwnPropertyDescriptor(wa.prototype,"pipe"),wa.prototype),an(wa.prototype,"unpipe",[W7],Object.getOwnPropertyDescriptor(wa.prototype,"unpipe"),wa.prototype),wa);const au=new class extends lr{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),_e(this,"_lastHiddenTime",0),_e(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),F.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class H7 extends lr{constructor(a,s){super(),_e(this,"trackMediaType",Ng.DATA),_e(this,"_version",1),_e(this,"_type",3),_e(this,"_config",void 0),_e(this,"_originDataChannel",void 0),_e(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),_e(this,"_dataStreamPacketHandler",{serialize:l=>l,deserialize:l=>l}),_e(this,"_datachannelEventMap",new Map),this._config=a,s&&(this._originDataChannel=s,this._bandDataChannelEvents(s)),this._initPacketHeader()}useDataStream(a){this._dataStreamPacketHandler=a}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return se("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var a,s;return(a=(s=this._originDataChannel)===null||s===void 0?void 0:s.readyState)!==null&&a!==void 0?a:"connecting"}get _originDataChannelId(){var a,s;return(a=(s=this._originDataChannel)===null||s===void 0?void 0:s.id)!==null&&a!==void 0?a:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new Ge((a,s)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&a();const l=setTimeout(()=>{var d;s(new Se(ie.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((d=this._originDataChannel)===null||d===void 0?void 0:d.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(l),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),a()},this._originDataChannel.onerror=()=>{throw clearTimeout(l),new Se(ie.DATACHANNEL_CONNECTION_TIMEOUT)}}else s(new Se(ie.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(a){this._originDataChannel=a,this._bandDataChannelEvents(a)}_initPacketHeader(){const a=new DataView(this._dataStreamPacketHeader);a.setUint16(0,this._version),a.setUint8(2,this._type),a.setUint8(3,this._config.id)}_bandDataChannelEvents(a){this._unbindDataChannelEvents(a),[Jx.OPEN,Jx.CLOSE,Jx.ERROR].forEach(s=>{const l=()=>{this.emit(s)};this._datachannelEventMap.set(s,l),a.addEventListener(s,l)})}_unbindDataChannelEvents(a){Array.from(this._datachannelEventMap.entries()).forEach(s=>{let[l,d]=s;a.removeEventListener(l,d)}),this._datachannelEventMap.clear()}}class dIe extends H7{constructor(a){super(a),_e(this,"_messageListener",void 0),this._messageListener=s=>{if(s.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const l=s.data.slice(0,this._dataStreamPacketHeader.byteLength),d=new DataView(l).getUint8(3);if(d!==this.id)return void(se("SHOW_DATASTREAM2_LOG")&&F.debug("invalid datachannel id: ".concat(d," !== ").concat(this.id)));let f=s.data.slice(this._dataStreamPacketHeader.byteLength);f=this._dataStreamPacketHandler.deserialize(f),this.emit(Jx.MESSAGE,f)}}_updateOriginDataChannel(a){super._updateOriginDataChannel(a),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class hIe extends H7{send(a){if(this._originDataChannel){let s=a;s=this._dataStreamPacketHandler.serialize(a);const l=new Uint8Array(this._dataStreamPacketHeader.byteLength+s.byteLength);l.set(new Uint8Array(this._dataStreamPacketHeader),0),l.set(new Uint8Array(s),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(l.buffer)}}}function tT(){const r=new Blob([atob("Y29uc3QgdD0idmlkZW8vaDI2NCIsZT0idmlkZW8vaDI2NSI7ZnVuY3Rpb24gbih0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLHI9W10sbz0wO2Zvcig7ci5sZW5ndGg8bjspbyszPG4mJjA9PT1hW29dJiYwPT09YVtvKzFdJiYzPT09YVtvKzJdJiYoMD09PWFbbyszXXx8MT09PWFbbyszXXx8Mj09PWFbbyszXXx8Mz09PWFbbyszXSk/KHIucHVzaChhW29dLGFbbysxXSxhW28rM10pLG8rPTQpOihyLnB1c2goYVtvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkocil9ZnVuY3Rpb24gYShhLHIpe3N3aXRjaChyKXtjYXNlIHQ6cmV0dXJuIGZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IERhdGFWaWV3KHQuZGF0YSk7bGV0IGE9MDtmb3IoO2ErNDx0LmRhdGEuYnl0ZUxlbmd0aDspe2lmKDA9PT1lLmdldFVpbnQ4KGErMCkmJjA9PT1lLmdldFVpbnQ4KGErMSkmJjA9PT1lLmdldFVpbnQ4KGErMikmJjE9PT1lLmdldFVpbnQ4KGErMykmJjY9PT1lLmdldFVpbnQ4KGErNCkpe2xldCByPWErNixvPTAsaT0wO2Zvcig7MjU1PT09KGk9ZS5nZXRVaW50OChyKyspKTspbys9MjU1O28rPWk7Y29uc3Qgcz1uKHQuZGF0YSxyLG8pO3JldHVybiBuZXcgVWludDhBcnJheShzKX1hKyt9cmV0dXJuIG51bGx9KGEpO2Nhc2UgZTpyZXR1cm4gZnVuY3Rpb24odCl7Y29uc3QgZT1uZXcgRGF0YVZpZXcodC5kYXRhKTtsZXQgYT0wO2Zvcig7YSs1PHQuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PWUuZ2V0VWludDgoYSswKSYmMD09PWUuZ2V0VWludDgoYSsxKSYmMD09PWUuZ2V0VWludDgoYSsyKSYmMT09PWUuZ2V0VWludDgoYSszKSYmNzg9PT1lLmdldFVpbnQ4KGErNCkmJjE9PT1lLmdldFVpbnQ4KGErNSkmJjEwMT09PWUuZ2V0VWludDgoYSs2KSl7bGV0IHI9YSs3LG89MCxpPTA7Zm9yKDsyNTU9PT0oaT1lLmdldFVpbnQ4KHIrKykpOylvKz0yNTU7bys9aTtjb25zdCBzPW4odC5kYXRhLHIsbyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KHMpfWErK31yZXR1cm4gbnVsbH0oYSk7ZGVmYXVsdDpyZXR1cm4gbnVsbH19ZnVuY3Rpb24gcih0KXtjb25zdCBlPXQubGVuZ3RoO2xldCBuPVtdLGE9MDtmb3IoO2E8ZTspYSsyPGUmJjA9PT10W2FdJiYwPT09dFthKzFdJiYoMD09PXRbYSsyXXx8MT09PXRbYSsyXXx8Mj09PXRbYSsyXXx8Mz09PXRbYSsyXSk/KG4ucHVzaCh0W2FdLHRbYSsxXSwzLHRbYSsyXSksYSs9Myk6KG4ucHVzaCh0W2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShuKX1mdW5jdGlvbiBvKG4sYSxvKXtzd2l0Y2gobyl7Y2FzZSB0OnJldHVybiBmdW5jdGlvbih0LGUpe2NvbnN0IG49cihlKSxhPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihhLzI1NSksaT1hJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK2ErdC5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNitmXT0yNTUsZisrO3JldHVybiBzWzYrZl09aSxmKysscy5zZXQobiw2K2YpLHMuc2V0KG5ldyBVaW50OEFycmF5KHQpLDYrZithKSxzLmJ1ZmZlcn0obixhKTtjYXNlIGU6cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3Qgbj1yKGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxpPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNytvKzErYSsxK3QuYnl0ZUxlbmd0aCk7c1swXT0wLHNbMV09MCxzWzJdPTAsc1szXT0xLHNbNF09Nzgsc1s1XT0xLHNbNl09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNytmXT0yNTUsZisrO3JldHVybiBzWzcrZl09aSxmKysscy5zZXQobiw3K2YpLGYrPWEsc1s3K2ZdPTEyOCxmKysscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNytmKSxzLmJ1ZmZlcn0obixhKTtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBpKG4pe2lmKG4ubGVuZ3RoPDUpcmV0dXJuIiI7bGV0IGE9LTE7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aC0zO3QrKyl7aWYoMD09PW5bdF0mJjA9PT1uW3QrMV0mJjE9PT1uW3QrMl0pe2E9dDticmVha31pZih0PG4ubGVuZ3RoLTQmJjA9PT1uW3RdJiYwPT09blt0KzFdJiYwPT09blt0KzJdJiYxPT09blt0KzNdKXthPXQ7YnJlYWt9fWlmKC0xPT09YSlyZXR1cm4iIjtjb25zdCByPWErKDA9PT1uW2ErMl0/NDozKTtpZihyPj1uLmxlbmd0aClyZXR1cm4iIjtjb25zdCBvPW5bcl07aWYoMTI4Jm8pcmV0dXJuIiI7aWYoKG8+PjEmNjMpPj0zMilyZXR1cm4gZTtpZihyKzE8bi5sZW5ndGgpe2lmKDA9PSgyNDgmbltyKzFdKSlyZXR1cm4gZX1yZXR1cm4oMzEmbyk8PTMxP3Q6IiJ9Y29uc3Qgcz03MSxmPTEsbD0yLHU9MSxnPTI7dmFyIGM7ZnVuY3Rpb24gZCh0LGU9ITEpe2NvbnN0IG49dC5nZXRVaW50OCgwKTtpZihuIT09cylyZXR1cm47Y29uc3QgYT10LmdldFVpbnQxNigxKSxyPWYrbCthLG89bmV3IFVpbnQ4QXJyYXkodC5ieXRlTGVuZ3RoLXIpO28uc2V0KG5ldyBVaW50OEFycmF5KHQuYnVmZmVyLHIsdC5ieXRlTGVuZ3RoLXIpKTtjb25zdCBpPXttOm4sdGx2TGVuOmEsdGx2OltdLGZyYW1lOm99O2xldCBkPWYrbDtmb3IoO2Q8cjspe2NvbnN0IG49dC5nZXRVaW50OChkKSxhPXQuZ2V0VWludDE2KGQrdSkscj11K2c7aWYobj09PWMuQVVESU9fTEVWRUwpe2xldCBvPXQuZ2V0VWludDgoZCtyKTtmb3IobGV0IGU9MTtlPGE7ZSsrKW89bzw8OHx0LmdldFVpbnQ4KGQrcitlKTtpLnRsdi5wdXNoKHt0YWc6bixsZW5ndGg6YSx2YWx1ZTplPzEyN15vPj4xOjEyNyZvfSl9ZWxzZSBpZihuPT09Yy5NRVRBREFUQXx8bj09PWMuQVVESU9fNjRfQklUX1BUUyl7Y29uc3QgZT1uZXcgVWludDhBcnJheShhKTtmb3IobGV0IG49MDtuPGE7bisrKWVbbl09dC5nZXRVaW50OChkK3Irbik7aS50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZX0pfWQrPXIrYX1yZXR1cm4gaX0hZnVuY3Rpb24odCl7dFt0LkFVRElPX0xFVkVMPTFdPSJBVURJT19MRVZFTCIsdFt0Lk1FVEFEQVRBPTJdPSJNRVRBREFUQSIsdFt0LkFVRElPXzY0X0JJVF9QVFM9M109IkFVRElPXzY0X0JJVF9QVFMifShjfHwoYz17fSkpLHNlbGYub25ydGN0cmFuc2Zvcm09dD0+e2NvbnN0IGU9dC50cmFuc2Zvcm1lcjtsZXQgbj1bXSxyPVtdO2Uub3B0aW9ucy5wb3J0Lm9ubWVzc2FnZT10PT57dC5kYXRhLnNlaSYmbi5wdXNoKHQuZGF0YS5zZWkpLHQuZGF0YS5tZXRhZGF0YSYmci5wdXNoKHQuZGF0YS5tZXRhZGF0YSl9LHNlbGYucG9zdE1lc3NhZ2UoInN0YXJ0ZWQiKTtjb25zdCBoPWUucmVhZGFibGUuZ2V0UmVhZGVyKCksVT1lLndyaXRhYmxlLmdldFdyaXRlcigpOyJzZWktcngiPT09ZS5vcHRpb25zLm5hbWU/ZnVuY3Rpb24gdChlKXtoLnJlYWQoKS50aGVuKChuPT57aWYoIW4uZG9uZSl7aWYobi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRWaWRlb0ZyYW1lKXtjb25zdCB0PWkobmV3IFVpbnQ4QXJyYXkobi52YWx1ZS5kYXRhKSkscj1hKG4udmFsdWUsdCk7ciYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTpyfSl9VS53cml0ZShuLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSk6InNlaS10eCI9PT1lLm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2gucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9aShuZXcgVWludDhBcnJheShhLnZhbHVlLmRhdGEpKSxlPW4uc2hpZnQoKTtpZihlKXtjb25zdCBuPW8oYS52YWx1ZS5kYXRhLGUsdCk7biYmKGEudmFsdWUuZGF0YT1uKX19VS53cml0ZShhLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSk6ImF1ZGlvLW1ldGFkYXRhLXJ4Ij09PWUub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQoZSl7aC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkQXVkaW9GcmFtZSl7Y29uc3QgdD1uZXcgRGF0YVZpZXcobi52YWx1ZS5kYXRhKSxhPXQuZ2V0VWludDgoMCk7bGV0IHI7aWYoMCE9KDEyOCZhKSYmNzEhPT1hKXtsZXQgZT1mdW5jdGlvbih0KXtpZih0LmJ5dGVMZW5ndGg8PTApcmV0dXJuW107Y29uc3QgZT1bXTtsZXQgbj0wO2Zvcig7bjx0LmJ5dGVMZW5ndGg7KXtjb25zdCBhPSgxMjgmdC5nZXRVaW50OChuKSk+Pjcscj0xMjcmdC5nZXRVaW50OChuKTtpZighKGEmJm4rNDw9dC5ieXRlTGVuZ3RoKSl7bisrO2JyZWFrfXtjb25zdCBhPXQuZ2V0VWludDMyKG4sITEpLG89KDE2Nzc2MTkyJmEpPj4xMCxpPTEwMjMmYTtlLnB1c2goe3B0OnIsdHNfb2Zmc2V0Om8sbGVuZ3RoOmksZGF0YTpuZXcgVWludDhBcnJheX0pLG4rPTR9fWxldCBhPXQuYnl0ZUxlbmd0aC1uO2Zvcihjb25zdCByIG9mIGUpe2lmKHIubGVuZ3RoPmEpcmV0dXJuIGNvbnNvbGUud2FybigiQnJva2VuIHJlZCBwYXlsb2FkIiksW107ci5sZW5ndGg+MCYmKHIuZGF0YT1uZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbixyLmxlbmd0aCksbis9ci5sZW5ndGgsYS09ci5sZW5ndGgpfWlmKGE+MCl7Y29uc3Qgcj17cHQ6ZS5sZW5ndGg+MD9lW2UubGVuZ3RoLTFdLnB0OjAsdHNfb2Zmc2V0OjAsbGVuZ3RoOmEsZGF0YTpuZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbixhKX07ZS5wdXNoKHIpfXJldHVybiBlfSh0KTtpZihlLmxlbmd0aD4wKXtjb25zdCB0PWZ1bmN0aW9uKHQpe2xldCBlPTA7Zm9yKGxldCBuPTA7bjx0Lmxlbmd0aDtuKyspZSs9bjx0Lmxlbmd0aC0xPzQ6MSxlKz10W25dLmxlbmd0aDtjb25zdCBuPW5ldyBVaW50OEFycmF5KGUpO2xldCBhPTA7Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDtlKyspaWYoZTx0Lmxlbmd0aC0xKXtjb25zdCByPSgyMTQ3NDgzNjQ4fCgxMjcmdFtlXS5wdCk8PDI0fCgyNjIxNDMmdFtlXS50c19vZmZzZXQpPDwxMHwxMDIzJnRbZV0ubGVuZ3RoKT4+PjA7blthKytdPXI+PjI0JjI1NSxuW2ErK109cj4+MTYmMjU1LG5bYSsrXT1yPj44JjI1NSxuW2ErK109MjU1JnJ9ZWxzZSBuW2ErK109MTI3JnRbZV0ucHQ7Zm9yKGNvbnN0IGUgb2YgdCluLnNldChlLmRhdGEsYSksYSs9ZS5sZW5ndGg7cmV0dXJuIG59KGUubWFwKCh0PT57bGV0IGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpO2Uuc2V0KHQuZGF0YSk7Y29uc3Qgbj1kKG5ldyBEYXRhVmlldyhlLmJ1ZmZlcikpO3JldHVybiBuPy5mcmFtZSYmKHQuZGF0YT1uPy5mcmFtZSkscj1uLHR9KSkpO24udmFsdWUuZGF0YT10LmJ1ZmZlcn19ZWxzZSByPWQodCksciYmKG4udmFsdWUuZGF0YT1yLmZyYW1lLmJ1ZmZlcik7aWYocil7bGV0IHQ9ci50bHYuZmluZCgodD0+dC50YWc9PT1jLk1FVEFEQVRBKSk7aWYodCYmdC52YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJmUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHttZXRhZGF0YTp0LnZhbHVlfSksdD1yLnRsdi5maW5kKCh0PT50LnRhZz09PWMuQVVESU9fNjRfQklUX1BUUykpLHQmJnQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5JiY4PT10LnZhbHVlLmxlbmd0aCl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcodC52YWx1ZS5idWZmZXIpLmdldEJpZ1VpbnQ2NCgwLCEwKTt0JiZ0LnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3B0czpufSl9fX1VLndyaXRlKG4udmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToiYXVkaW8tbWV0YWRhdGEtdHgiPT09ZS5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIHQoZSl7aC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHtnZXRNZXRhZGF0YTohMH0pLG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkQXVkaW9GcmFtZSl7Y29uc3QgdD1yLnNoaWZ0KCk7dCYmKG4udmFsdWUuZGF0YT1mdW5jdGlvbih0LGUsbil7Y29uc3QgYT1uLmJ5dGVMZW5ndGgscj1hK3UrZyxvPWYrbCtyLGk9bmV3IEFycmF5QnVmZmVyKHQuYnl0ZUxlbmd0aCtvKSxjPW5ldyBEYXRhVmlldyhpKTtjLnNldFVpbnQ4KDAscyksYy5zZXRVaW50MTYoMSxyKSxjLnNldFVpbnQ4KDMsZSksYy5zZXRVaW50MTYoNCxhKTtmb3IobGV0IHQ9MDt0PGE7dCsrKWMuc2V0VWludDgoNit0LG5bdF0pO2NvbnN0IGQ9bmV3IFVpbnQ4QXJyYXkoYy5idWZmZXIpO3JldHVybiBkLnNldChuZXcgVWludDhBcnJheSh0KSxvKSxkLmJ1ZmZlcn0obi52YWx1ZS5kYXRhLGMuQVVESU9fNjRfQklUX1BUUyx0KSl9VS53cml0ZShuLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSl9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKTsK")],{type:"text/javascript"});return setTimeout(()=>ex.revokeObjectURL(r),0),new Worker(ex.createObjectURL(r))}const z7=71,Kj=1,qj=2,Yj=1,K7=2;var mh=function(r){return r[r.AUDIO_LEVEL=1]="AUDIO_LEVEL",r[r.METADATA=2]="METADATA",r[r.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",r}(mh||{});function Xj(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=r.getUint8(0);if(s!==z7)return;const l=r.getUint16(1),d=Kj+qj+l,f=new Uint8Array(r.byteLength-d);f.set(new Uint8Array(r.buffer,d,r.byteLength-d));const m={m:s,tlvLen:l,tlv:[],frame:f};let y=Kj+qj;for(;y<d;){const _=r.getUint8(y),w=r.getUint16(y+Yj),x=Yj+K7;if(_===mh.AUDIO_LEVEL){let A=r.getUint8(y+x);for(let I=1;I<w;I++)A=A<<8|r.getUint8(y+x+I);m.tlv.push({tag:_,length:w,value:a?127^A>>1:127&A})}else if(_===mh.METADATA||_===mh.AUDIO_64_BIT_PTS){const A=new Uint8Array(w);for(let I=0;I<w;I++)A[I]=r.getUint8(y+x+I);m.tlv.push({tag:_,length:w,value:A})}y+=x+w}return m}const nT=new Map,rT=127,dp=1e-10,Jj=139/13,iT=new Map;function Zj(r,a,s){const l="".concat(r,"-").concat(a,"-").concat(s);let d=0;return iT.has(l)?d=iT.get(l):(d=Math.log(function(m,y){const _=m-y;y<_&&(y=_);let w=1;for(let x=m,A=1;x>y;x--,A++)w=w*x/A;return w}(a,r))+r*Math.log(.5)+(a-r)*Math.log(1-.5)-Math.log(s)+s*r,iT.set(l,d)),d<dp&&(d=dp),d}function q7(r,a,s){const l=a.length,d=r.length/l;let f=!1;for(let m=0,y=0;m<l;m++){let _=0;for(let w=y+d;y<w;y++)r[y]>s&&_++;a[m]!==_&&(a[m]=_,f=!0)}return f}window.cache=iT;let fIe=0;class Y7{constructor(a){_e(this,"id",void 0),_e(this,"immediates",[]),_e(this,"lastNonSilence",-1),_e(this,"immediateSpeechActivityScore",dp),_e(this,"lastLevelChangedTime",Date.now()),_e(this,"levels",[]),_e(this,"longs",[]),_e(this,"longSpeechActivityScore",dp),_e(this,"mediums",[]),_e(this,"mediumSpeechActivityScore",dp),_e(this,"minLevel",0),_e(this,"nextMinLevel",0),_e(this,"nextMinLevelWindowLength",0),_e(this,"energyScore",0),this.id=a||"".concat(fIe++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const a=this.immediates,s=this.levels,l=this.minLevel+Jj;let d=!1;for(let f=0;f<a.length;++f){let m=s[f];m<l&&(m=0);const y=Math.floor(m/Jj);a[f]!==y&&(a[f]=y,d=!0)}return d}computeLongs(){return q7(this.mediums,this.longs,4)}computeMediums(){return q7(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=Zj(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(a){this.longSpeechActivityScore=Zj(this.longs[0],10,47),this.longSpeechActivityScore>dp&&(this.lastNonSilence=a)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=Zj(this.mediums[0],5,24)}evaluateSpeechActivityScores(a){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(a)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var a;return"[".concat(N5(a=[...this.levels]).call(a).join(),"]")}getSpeechActivityScore(a){switch(a){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+a)}}levelChanged(a,s){if(this.lastLevelChangedTime<=s){this.lastLevelChangedTime=s;let l=a;return a<0&&(l=0),a>rT&&(l=rT),this.levels.unshift(l),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(l),l>=this.minLevel+Jj?l:l/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(a){if(a!==0){if(this.minLevel===0||this.minLevel>a)return this.minLevel=a,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=a,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>a&&(this.nextMinLevel=a),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let s=Math.sqrt(this.minLevel*this.nextMinLevel);s<0?s=0:s>rT&&(s=rT),this.minLevel=s,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class pIe{constructor(a){_e(this,"algorithm",void 0),this.algorithm=a}execute(){let a=!this.algorithm;if(!a)try{const s=this.algorithm.runInDecisionMaker(this);s<=0?a=!0:setTimeout(this.execute.bind(this),s)}catch{a=!0}a&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class Qj{constructor(a,s,l){_e(this,"isDominant",void 0),_e(this,"energyRanking",void 0),_e(this,"energyScore",void 0),this.isDominant=a,this.energyRanking=s,this.energyScore=l}}class mIe extends lr{constructor(a){super(),_e(this,"dominantId",null),_e(this,"lastDecisionTime",0),_e(this,"lastLevelChangedTime",0),_e(this,"lastLevelIdleTime",0),_e(this,"relativeSpeechActivities",[]),_e(this,"speakers",new Map),_e(this,"enableSilence",!1),_e(this,"timeoutToSilenceInterval",0),_e(this,"decisionMaker",null),_e(this,"loudest",[]),_e(this,"numLoudestToTrack",3),_e(this,"energyExpireTimeMs",250),_e(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=a,this.enableSilence=a>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,s=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=a,s!=null&&(this.energyExpireTimeMs=s),l!=null&&(this.energyAlphaPct=l),this.loudest.length>a&&this.loudest.splice(a)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(a){return this.loudest.some(s=>s.id===a)}levelChanged(a,s){const l=Date.now(),d=this.getOrCreateSpeaker(a);this.lastLevelChangedTime<l&&(this.lastLevelChangedTime=l,this.maybeStartDecisionMaker());const f=d.levelChanged(s,l);return this.updateLoudestList(d,f,l)}runInDecisionMaker(a){return this.decisionMaker!==a||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(a){this.decisionMaker===a&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(a){a.forEach(s=>{this.speakers.has(s.id)||this.speakers.set(s.id,s)})}removeSpeakers(a){a.forEach(s=>{this.speakers.delete(s.id)})}getOrCreateSpeaker(a){let s=this.speakers.get(a);return s||(s=new Y7(a),this.speakers.set(a,s),this.maybeStartDecisionMaker()),s}updateLoudestList(a,s,l){const d=a.id===this.dominantId;if(s<0){let _=0;for(;_<this.loudest.length&&this.loudest[_]!==a;)++_;return new Qj(d,_,a.energyScore)}if(a.energyScore=Math.floor((this.energyAlphaPct*s+(100-this.energyAlphaPct)*a.energyScore+50)/100),this.numLoudestToTrack===0)return new Qj(d,0,a.energyScore);const f=l-this.energyExpireTimeMs;let m=0;for(;m<this.loudest.length;){const _=this.loudest[m];if(_.getLastLevelChangedTime()<f&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(m,1);else if(_.id!==a.id)++m;else if(this.loudest.splice(m,1),this.loudest.length<this.numLoudestToTrack)break}let y=0;for(;y<this.loudest.length&&!(this.loudest[y].energyScore<a.energyScore);)++y;return y<this.numLoudestToTrack&&(this.loudest.splice(y,0,a),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new Qj(d,y,a.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new pIe(this),this.decisionMaker.execute())}makeDecision(a){let s=null,l=null;const d=this.speakers.size;let f=null;if(d===0)f=null;else if(d===1){var m;const y=Rs(m=this.speakers).call(m).next().value;this.enableSilence&&y&&(f=y.id,y.evaluateSpeechActivityScores(a),a-y.lastNonSilence>this.timeoutToSilenceInterval&&(f=null))}else{let y=this.dominantId==null?null:this.speakers.get(this.dominantId);if(y==null){const x=this.speakers.entries().next();x.value&&(f=x.value[0],y=x.value[1])}else f=y.id;y!=null&&y.evaluateSpeechActivityScores(a);const _=this.relativeSpeechActivities;let w=2;for(const x of this.speakers.entries()){const[A,I]=x;if(I===y)continue;I.evaluateSpeechActivityScores(a);for(let G=0;G<_.length;++G){const ne=y==null?dp:y.getSpeechActivityScore(G);_[G]=Math.log(I.getSpeechActivityScore(G)/ne)}const L=_[0],H=_[1],$=_[2];L>3&&H>2&&$>0&&H>w&&(w=H,f=A)}this.enableSilence&&y!=null&&f===y.id&&a-y.lastNonSilence>this.timeoutToSilenceInterval&&(f=null)}f==null&&!this.enableSilence||f===this.dominantId||(s=this.dominantId,this.dominantId=f,l=this.dominantId),l==null&&!this.enableSilence||l===s||this.emit("ActiveSpeakerChanged",l)}_runInDecisionMaker(){const a=Date.now(),s=300-(a-this.lastLevelIdleTime);let l=0;s<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(a),this.lastLevelIdleTime=a):l=s;let d=300-(a-this.lastDecisionTime);return d<=0&&(this.lastDecisionTime=a,this.makeDecision(a),d=300-(Date.now()-a)),d>0&&l>d&&(l=d),l}timeoutIdleLevels(a){const s=[];for(const d of Rs(l=this.speakers).call(l)){var l;const f=a-d.getLastLevelChangedTime();36e5<f&&(this.dominantId==null||d.id!==this.dominantId)?s.push(d.id):300<f&&d.levelTimedOut()}s.forEach(d=>this.speakers.delete(d))}}const jg=new Map;let sl=null,aT=null;const X7=3;let hp=[];const ol=new Map,sT=new Map;class gIe{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(a,s){_e(this,"id",void 0),_e(this,"track",void 0),_e(this,"score",0),_e(this,"active",!0),_e(this,"muted",!1),_e(this,"timer",0),_e(this,"actives",0),_e(this,"inactives",0),this.id=a,this.track=s,this.setActive(ol.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const a=this.active;this.active=this.activeRate>=.8;const{actives:s,inactives:l}=function(){const d=[],f=[];return Array.from(Rs(ol).call(ol)).forEach(m=>{m.active?d.push(m):f.push(m)}),{actives:d,inactives:f}}();if(s.length>3){let d;s.forEach(f=>{(!d||d.score>f.score)&&(d=f)}),d&&d.setActive(!1)}if(s.length<3&&l.length>0){let d;l.forEach(f=>{(!d||d.score<f.score)&&f.id!==this.id&&(d=f)}),d&&a&&!this.active&&(d.samples>40&&d.activeRate-this.activeRate>.4?d.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(a){this.active=a,this.resetTimer(),this.setMuted(!a)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const a=function(s){let l;return Array.from(Rs(ol).call(ol)).forEach(d=>{!d.active||d.id===s||d.samples<40||(!l||d.score<l.score)&&(l=d)}),l}(this.id);a&&this.activeRate-a.activeRate>.4&&(a.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const a=function(s){let l;return Array.from(Rs(ol).call(ol)).forEach(d=>{d.active||d.id===s||d.samples<40||(!l||d.score>l.score)&&(l=d)}),l}(this.id);a&&a.activeRate-this.activeRate>.4&&(a.setActive(!0),this.setActive(!1))}addSample(a){a?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(a){this.track&&(this.track.enabled=!a,this.muted=a)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let oT;function J7(r){const a=ol.get(r);a&&(ol.delete(r),a.clearTimer())}const cT=new Map,vIe=new Map,eD="video/h264",tD="video/h265";function Z7(r,a,s){let l=new Uint8Array(r,a,s),d=[],f=0;for(;d.length<s;)f+3<s&&l[f]===0&&l[f+1]===0&&l[f+2]===3&&(l[f+3]===0||l[f+3]===1||l[f+3]===2||l[f+3]===3)?(d.push(l[f],l[f+1],l[f+3]),f+=4):(d.push(l[f]),f++);return new Uint8Array(d)}function Q7(r){const a=r.length;let s=[],l=0;for(;l<a;)l+2<a&&r[l]===0&&r[l+1]===0&&(r[l+2]===0||r[l+2]===1||r[l+2]===2||r[l+2]===3)?(s.push(r[l],r[l+1],3,r[l+2]),l+=3):(s.push(r[l]),l++);return new Uint8Array(s)}function eK(r){if(r.length<5)return"";let a=-1;for(let d=0;d<r.length-3;d++){if(r[d]===0&&r[d+1]===0&&r[d+2]===1){a=d;break}if(d<r.length-4&&r[d]===0&&r[d+1]===0&&r[d+2]===0&&r[d+3]===1){a=d;break}}if(a===-1)return"";const s=a+(r[a+2]===0?4:3);if(s>=r.length)return"";const l=r[s];return 128&l?"":(l>>1&63)>=32||s+1<r.length&&!(248&r[s+1])?tD:(31&l)<=31?eD:""}const lT=new Map,gb=new Map;(function(){const r=sn();Ri.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Ri.getStreamFromExtension=r.name===pn.CHROME&&Number(r.version)>34,Ri.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const a=new RTCPeerConnection;let s=!1;try{a.addTransceiver("audio"),s=!0}catch{}return a.close(),s}(),Ri.supportMinBitrate=r.name===pn.CHROME||r.name===pn.EDGE,Ri.supportSetRtpSenderParameters=function(){const a=sn();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!id()||!(!ji()&&!Ux())||a.name===pn.FIREFOX&&Number(a.version)>=64)}(),r.name===pn.SAFARI&&(Number(r.version)>=14?Ri.supportDualStream=!0:Ri.supportDualStream=!1),Ri.webAudioMediaStreamDest=function(){const a=sn();return!(a.name===pn.SAFARI&&Number(a.version)<12)}(),Ri.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",Ri.supportWebGL=typeof WebGLRenderingContext<"u",Ri.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,id()||(Ri.webAudioWithAEC=!0),Ri.supportShareAudio=function(){const a=sn();return(a.os===oi.WIN_10||a.os===oi.WIN_81||a.os===oi.WIN_7||a.os===oi.LINUX||a.os===oi.MAC_OS||a.os===oi.CHROMIUM_OS)&&a.name===pn.CHROME&&Number(a.version)>=74}(),Ri.supportDataChannel=!!(gg(76)||sj(68)||QH(14)),Ri.supportPCSetConfiguration=function(){const a=window.RTCPeerConnection;return!dr()&&!!a&&a.prototype.setConfiguration instanceof Function}(),Ri.supportWebRTCEncodedTransform=gg(87)||XH()||sj(117),Ri.supportWebRTCInsertableStream=function(){const a=sn();return(a.name===pn.CHROME||a.name===pn.EDGE)&&Number(a.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Ri.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,Ri.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,Bx(()=>{Ri.supportDualStreamEncoding=function(){const a=sn();return!!se("DISABLE_WEBAUDIO")||a.name==="Safari"&&Number(a.version)>=14||!!(a.name==="Chrome"&&/Windows/i.test(a.os||"")&&Number(a.version)>=100&&se("CHROME_DUAL_STREAM_USE_ENCODING"))}(),F.debug("browser ua: ",navigator.userAgent),F.info("browser info: ",r),F.info("browser compatibility: ",Ri)})})();const yIe=["CHINA","GLOBAL"],tK=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],fp=[],Dg=[];function pp(r,a){return!!a&&fp.some(s=>s.uid===r&&s.channelName===a)}function nD(){return Dg.length>0}var _Ie=mG.forEach,nK=hS("forEach")?[].forEach:function(r){return _Ie(this,r,arguments.length>1?arguments[1]:void 0)};Tn({target:"Array",proto:!0,forced:[].forEach!==nK},{forEach:nK});var bIe=ac("Array","forEach"),EIe=rh,wIe=aa,SIe=T,xIe=bIe,rD=Array.prototype,TIe={DOMTokenList:!0,NodeList:!0},CIe=function(r){var a=r.forEach;return r===rD||SIe(rD,r)&&a===rD.forEach||wIe(TIe,EIe(r))?xIe:a},RIe=o(CIe),NIe=Yl,rK=yS;Tn({target:"Object",stat:!0,forced:u(function(){rK(1)})},{keys:function(r){return rK(NIe(r))}});var AIe=o(it.Object.keys),IIe=o(T5),OIe=o(R5),PIe=Tn,iK=N_,kIe=PS,jIe=At,aK=SO,DIe=nh,LIe=ht,MIe=BP,UIe=qr,FIe=ah,VIe=aG("slice"),BIe=UIe("species"),iD=Array,$Ie=Math.max;PIe({target:"Array",proto:!0,forced:!VIe},{slice:function(r,a){var s,l,d,f=LIe(this),m=DIe(f),y=aK(r,m),_=aK(a===void 0?m:a,m);if(iK(f)&&(s=f.constructor,(kIe(s)&&(s===iD||iK(s.prototype))||jIe(s)&&(s=s[BIe])===null)&&(s=void 0),s===iD||s===void 0))return FIe(f,y,_);for(l=new(s===void 0?iD:s)($Ie(_-y,0)),d=0;y<_;y++,d++)y in f&&MIe(l,d,f[y]);return l.length=d,l}});var WIe=ac("Array","slice"),GIe=T,HIe=WIe,aD=Array.prototype,zIe=function(r){var a=r.slice;return r===aD||GIe(aD,r)&&a===aD.slice?HIe:a},KIe=o(zIe);function tt(r,a,s,l,d){var f,m,y,_={};return RIe(f=AIe(l)).call(f,function(w){_[w]=l[w]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=IIe(m=OIe(y=KIe(s).call(s)).call(y)).call(m,function(w,x){return x(r,a,w)||w},_),d&&_.initializer!==void 0&&(_.value=_.initializer?_.initializer.call(d):void 0,_.initializer=void 0),_.initializer===void 0?(tG(r,a,_),null):_}let uT=function(r){return r[r.ACCESS_POINT=101]="ACCESS_POINT",r[r.UNILBS=201]="UNILBS",r[r.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",r}({}),sD=function(r){return r[r.IIIEGAL_APPID=1]="IIIEGAL_APPID",r[r.IIIEGAL_UID=2]="IIIEGAL_UID",r[r.INTERNAL_ERROR=3]="INTERNAL_ERROR",r}({}),vc=function(r){return r[r.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",r[r.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",r[r.INTERNAL_ERROR=8]="INTERNAL_ERROR",r[r.NO_AUTHORIZED=9]="NO_AUTHORIZED",r[r.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",r[r.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",r[r.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",r[r.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",r[r.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",r[r.USER_OVERLOAD=16]="USER_OVERLOAD",r[r.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",r[r.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",r}({}),Da=function(r){return r[r.NO_FLAG_SET=100]="NO_FLAG_SET",r[r.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",r[r.INVALID_FALG_SET=102]="INVALID_FALG_SET",r[r.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",r[r.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",r[r.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",r[r.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",r[r.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",r[r.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",r[r.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",r[r.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",r[r.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",r[r.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",r[r.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",r[r.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",r[r.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",r[r.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",r[r.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",r[r.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",r}({}),yt=function(r){return r[r.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",r[r.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",r[r.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",r[r.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",r[r.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",r[r.K_TICKET_INVALID=7]="K_TICKET_INVALID",r[r.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",r[r.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",r[r.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",r[r.K_UID_BANNED=14]="K_UID_BANNED",r[r.K_IP_BANNED=15]="K_IP_BANNED",r[r.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",r[r.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",r[r.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",r[r.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",r[r.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",r[r.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",r[r.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",r[r.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",r[r.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",r[r.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",r[r.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",r[r.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",r[r.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",r[r.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",r[r.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",r[r.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",r[r.ERR_INVALID_UID=117]="ERR_INVALID_UID",r[r.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",r[r.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",r[r.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",r[r.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",r[r.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",r[r.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",r[r.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",r[r.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",r[r.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",r[r.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",r[r.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",r[r.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",r[r.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",r[r.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",r[r.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",r[r.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",r[r.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",r[r.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",r[r.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",r[r.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",r[r.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",r[r.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",r[r.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",r[r.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",r[r.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",r[r.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",r[r.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",r[r.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",r[r.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",r[r.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",r[r.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",r[r.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",r[r.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",r[r.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",r[r.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",r[r.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",r[r.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",r}({}),$n=function(r){return r.CONNECTING="connecting",r.CONNECTED="connected",r.RECONNECTING="reconnecting",r.CLOSED="closed",r}({}),It=function(r){return r.WS_CONNECTED="ws_connected",r.WS_RECONNECTING="ws_reconnecting",r.WS_CLOSED="ws_closed",r.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",r.ON_BINARY_DATA="on_binary_data",r.REQUEST_RECOVER="request_recover",r.REQUEST_JOIN_INFO="request_join_info",r.REQUEST_REJOIN_INFO="req_rejoin_info",r.IS_P2P_DISCONNECTED="is_p2p_dis",r.DISCONNECT_P2P="dis_p2p",r.ABORT_P2P_EXECUTION="abort_p2p_execution",r.NEED_RENEW_SESSION="need-sid",r.REPORT_JOIN_GATEWAY="report_join_gateway",r.REQUEST_TIMEOUT="request_timeout",r.REQUEST_SUCCESS="request_success",r.JOIN_RESPONSE="join_response",r.PRE_CONNECT_PC="pre_connect_pc",r.P2P_CONNECTION="p2p_connection",r.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",r.P2P_SUBSCRIBE="p2p_subscribe",r.P2P_UNSUBSCRIBE="p2p_unsubscribe",r.P2P_EXCHANGE_SDP="p2p_exchange_sdp",r.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",r.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",r.RECOVER_NOTIFICATION="recover_notification",r}({}),Ct=function(r){return r.PING="ping",r.PING_BACK="ping_back",r.JOIN="join_v3",r.REJOIN="rejoin_v3",r.LEAVE="leave",r.SET_CLIENT_ROLE="set_client_role",r.PUBLISH="publish",r.PUBLISH_DATASTREAM="publish_datastream",r.UNPUBLISH="unpublish",r.UNPUBLISH_DATASTREAM="unpublish_datastream",r.SUBSCRIBE="subscribe",r.PRE_SUBSCRIBE="pre_subscribe",r.SUBSCRIBE_DATASTREAM="subscribe_datastream",r.SUBSCRIBE_STREAMS="subscribe_streams",r.UNSUBSCRIBE="unsubscribe",r.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",r.UNSUBSCRIBE_STREAMS="unsubscribe_streams",r.SUBSCRIBE_CHANGE="subscribe_change",r.TRAFFIC_STATS="traffic_stats",r.RENEW_TOKEN="renew_token",r.SWITCH_VIDEO_STREAM="switch_video_stream",r.DEFAULT_VIDEO_STREAM="default_video_stream",r.SET_FALLBACK_OPTION="set_fallback_option",r.GATEWAY_INFO="gateway_info",r.CONTROL="control",r.SEND_METADATA="send_metadata",r.DATA_STREAM="data_stream",r.PICK_SVC_LAYER="pick_svc_layer",r.RESTART_ICE="restart_ice",r.CONNECT_PC="connect_pc",r.SET_VIDEO_PROFILE="set_video_profile",r.SET_PARAMETER="set_parameter",r.SET_RTM2_FLAG="set_rtm2_flag",r.DOWNGRADE_CODEC="downgrade_codec",r}({}),vb=function(r){return r.WRTC_STATS="wrtc_stats",r.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",r.DENOISER_STATS="denoiser_stats",r.EXTENSION_USAGE_STATS="extension_usage_stats",r}({}),tn=function(r){return r.ON_USER_ONLINE="on_user_online",r.ON_USER_OFFLINE="on_user_offline",r.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",r.ON_PUBLISH_STREAM="on_publish_stream",r.ON_UPLINK_STATS="on_uplink_stats",r.ON_P2P_LOST="on_p2p_lost",r.ON_REMOVE_STREAM="on_remove_stream",r.ON_ADD_AUDIO_STREAM="on_add_audio_stream",r.ON_ADD_VIDEO_STREAM="on_add_video_stream",r.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",r.ON_USER_BANNED="on_user_banned",r.ON_USER_LICENSE_BANNED="on_user_license_banned",r.ON_NOTIFICATION="on_notification",r.ON_CRYPT_ERROR="on_crypt_error",r.MUTE_AUDIO="mute_audio",r.MUTE_VIDEO="mute_video",r.UNMUTE_AUDIO="unmute_audio",r.UNMUTE_VIDEO="unmute_video",r.ON_P2P_OK="on_p2p_ok",r.RECEIVE_METADATA="receive_metadata",r.ON_DATA_STREAM="on_data_stream",r.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",r.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",r.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",r.ENABLE_LOCAL_VIDEO="enable_local_video",r.DISABLE_LOCAL_VIDEO="disable_local_video",r.ENABLE_LOCAL_AUDIO="enable_local_audio",r.DISABLE_LOCAL_AUDIO="disable_local_audio",r.ON_PUBLISHED_USER_LIST="on_published_user_list",r}({}),La=function(r){return r.SEND_ONLY="SEND_ONLY",r.RECEIVE_ONLY="RECEIVE_ONLY",r}({}),Bt=function(r){return r.CONNECTED="websocket:connected",r.RECONNECTING="websocket:reconnecting",r.WILL_RECONNECT="websocket:will_reconnect",r.CLOSED="websocket:closed",r.FAILED="websocket:failed",r.ON_MESSAGE="websocket:on_message",r.REQUEST_NEW_URLS="websocket:request_new_urls",r.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",r}({});function dT(r){if(typeof r!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(r))throw F.error("Invalid Channel Name ".concat(r)),new Ee(ie.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function hT(r){if(a=r,!(typeof a=="number"&&Math.floor(a)===a&&0<=a&&a<=4294967295||oz(r,1,255)))throw new Ee(ie.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var a;typeof r=="string"&&F.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let sd=function(r){return r.TRANSCODE="mix_streaming",r.RAW="raw_streaming",r}({});const qIe={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},oD={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function cD(r,a){Ti(r.url,"".concat(a,".url"),1,1e3,!1),hr(r.x)||kn(r.x,"".concat(a,".x"),0,1e4),hr(r.y)||kn(r.y,"".concat(a,".y"),0,1e4),hr(r.width)||kn(r.width,"".concat(a,".width"),0,1e4),hr(r.height)||kn(r.height,"".concat(a,".height"),0,1e4),hr(r.zOrder)||kn(r.zOrder,"".concat(a,".zOrder"),0,255),hr(r.alpha)||kn(r.alpha,"".concat(a,".alpha"),0,1,!1)}const YIe={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let gh=function(r){return r.WARNING="@live_uap-warning",r.ERROR="@line_uap-error",r.PUBLISH_STREAM_STATUS="@live_uap-publish-status",r.WORKER_STATUS="@live_uap-worker-status",r.REQUEST_NEW_ADDRESS="@live_uap-request-address",r}({}),lD=function(r){return r.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",r}({}),Xr=function(r){return r[r.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",r[r.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",r[r.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",r[r.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",r[r.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",r[r.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",r[r.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",r[r.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",r[r.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",r[r.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",r[r.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",r[r.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",r[r.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",r[r.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",r[r.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",r[r.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",r[r.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",r[r.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",r}({});function sK(r){if(!r.channelName)throw new Ee(ie.INVALID_PARAMS,"invalid channelName in info");if(typeof r.uid!="number")throw new Ee(ie.INVALID_PARAMS,"invalid uid in info, uid must be a number");return r.token&&Ti(r.token,"info.token",1,2047),hT(r.uid),dT(r.channelName),!0}let Ma=function(r){return r[r.SetSdkProfile=0]="SetSdkProfile",r[r.SetSourceChannel=1]="SetSourceChannel",r[r.SetSourceUserId=2]="SetSourceUserId",r[r.SetDestChannel=3]="SetDestChannel",r[r.StartPacketTransfer=4]="StartPacketTransfer",r[r.StopPacketTransfer=5]="StopPacketTransfer",r[r.UpdateDestChannel=6]="UpdateDestChannel",r[r.Reconnect=7]="Reconnect",r[r.SetVideoProfile=8]="SetVideoProfile",r}({}),od=function(r){return r.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",r.NETWORK_CONNECTED="NETWORK_CONNECTED",r.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",r.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",r.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",r.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",r.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",r.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",r.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",r.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",r}({}),cs=function(r){return r.RELAY_STATE_IDLE="RELAY_STATE_IDLE",r.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",r.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",r.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",r}({}),Lg=function(r){return r.RELAY_OK="RELAY_OK",r.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",r.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",r.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",r}({}),xn=function(r){return r.High="high",r.Low="low",r.Audio="audio",r.Screen="screen",r.ScreenLow="screen_low",r}({}),vi=function(r){return r.DISCONNECT="disconnect",r.CONNECTION_STATE_CHANGE="connection-state-change",r.NETWORK_QUALITY="network-quality",r.STREAM_TYPE_CHANGE="stream-type-change",r.IS_P2P_DISCONNECTED="is-p2p-dis",r.DISCONNECT_P2P="dis-p2p",r.REQUEST_NEW_GATEWAY_LIST="req-gate-url",r.NEED_RENEW_SESSION="need-sid",r.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",r.JOIN_RESPONSE="join-response",r.RESET_CONNECTION_EVENTS="reset-connection-events",r.PRE_CONNECT_PC="pre-connect_pc",r.UPDATE_GATEWAY_CONFIG="update-gateway-config",r}({}),fT=function(r){return r.P2P_DISCONNECTED="P2P_DISCONNECTED",r.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",r.TIMEOUT="TIMEOUT",r.UNKNOWN_REASON="UNKNOWN_REASON",r}({}),ci=function(r){return r[r.Nothing=0]="Nothing",r[r.Audio=1]="Audio",r[r.LwoVideo=2]="LwoVideo",r[r.Video=4]="Video",r[r.Data=8]="Data",r[r.DataStream0=256]="DataStream0",r[r.DataStream1=512]="DataStream1",r[r.DataStream2=1024]="DataStream2",r[r.DataStream3=2048]="DataStream3",r[r.DataStream4=4096]="DataStream4",r[r.DataStream5=8192]="DataStream5",r[r.DataStream6=16384]="DataStream6",r[r.DataStream7=32768]="DataStream7",r}({}),_n=function(r){return r.CHINA="CHINA",r.ASIA="ASIA",r.NORTH_AMERICA="NORTH_AMERICA",r.EUROPE="EUROPE",r.JAPAN="JAPAN",r.INDIA="INDIA",r.KOREA="KOREA",r.HKMC="HKMC",r.US="US",r.OCEANIA="OCEANIA",r.SOUTH_AMERICA="SOUTH_AMERICA",r.AFRICA="AFRICA",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL",r.EXTENSIONS="EXTENSIONS",r}({});const oK=[_n.AFRICA,_n.ASIA,_n.CHINA,_n.EUROPE,_n.GLOBAL,_n.INDIA,_n.JAPAN,_n.NORTH_AMERICA,_n.OCEANIA,_n.OVERSEA,_n.SOUTH_AMERICA];let zi=function(r){return r.CHINA="CN",r.ASIA="AS",r.NORTH_AMERICA="NA",r.EUROPE="EU",r.JAPAN="JP",r.INDIA="IN",r.KOREA="KR",r.HKMC="HK",r.US="US",r.OCEANIA="OC",r.SOUTH_AMERICA="SA",r.AFRICA="AF",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL",r.EXTENSIONS="GLOBAL",r}({});const pT={CHINA:{},ASIA:{CODE:zi.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:zi.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:zi.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:zi.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:zi.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:zi.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:zi.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:zi.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:zi.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:zi.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:zi.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:zi.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:zi.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};Cj&&(pT.CHINA={CODE:zi.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let yb=function(r){return r.UPDATE_BITRATE_LIMIT="update_bitrate_limit",r.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",r}({});function cK(r){return!!r&&!(!r.uplink||!r.id)&&r.uplink.max_bitrate!==void 0&&r.uplink.min_bitrate!==void 0}class lK extends lr{constructor(a,s){super(),Z(this,"onICEConnectionStateChange",void 0),Z(this,"onConnectionStateChange",void 0),Z(this,"onDTLSTransportStateChange",void 0),Z(this,"onDTLSTransportError",void 0),Z(this,"onICETransportStateChange",void 0),Z(this,"onFirstAudioReceived",void 0),Z(this,"onFirstVideoReceived",void 0),Z(this,"onFirstAudioDecoded",void 0),Z(this,"onFirstVideoDecoded",void 0),Z(this,"onFirstVideoRender",void 0),Z(this,"onFirstVideoDecodedTimeout",void 0),Z(this,"onSelectedLocalCandidateChanged",void 0),Z(this,"onSelectedRemoteCandidateChanged",void 0),Z(this,"onICECandidateError",void 0),Z(this,"getLocalVideoStats",void 0)}}class uK extends lK{constructor(a,s){super(a,s),Z(this,"establishPromise",void 0)}}let Ye=function(r){return r.VIDEO="video",r.AUDIO="audio",r}({}),Ki=function(r){return r.UDP_RELAY="udp_relay",r.UDP_TCP_RELAY="udp_tcp_relay",r.TCP_RELAY="tcp_relay",r.RELAY="relay",r}({}),cd=function(r){return r[r.FIRST_CONNECTION=0]="FIRST_CONNECTION",r[r.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",r[r.RELAY_RESTART=2]="RELAY_RESTART",r[r.TCP_RESTART=3]="TCP_RESTART",r[r.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",r[r.OLD_RESTART=11]="OLD_RESTART",r[r.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",r}({});const dK=["disconnected","failed"];let ke=function(r){return r.LocalVideoTrack="videoTrack",r.LocalAudioTrack="audioTrack",r.LocalVideoLowTrack="videoLowTrack",r}({}),wn=function(r){return r.New="new",r.Connected="connected",r.Reconnecting="reconnecting",r.Disconnected="disconnected",r}({}),ut=function(r){return r.AudioMetadata="audioMetadata",r.AudioPts="audioPts",r.StateChange="stateChange",r.IceConnectionStateChange="iceConnectionStateChange",r.RequestMuteLocal="requestMuteLocal",r.RequestUnmuteLocal="requestUnmuteLocal",r.RequestRePublish="requestRePublish",r.RequestRePublishDataChannel="requestRePublishDataChannel",r.RequestReSubscribe="requestReSubscribe",r.RequestUploadStats="requestUploadStats",r.RequestUpload="requestUpload",r.MediaReconnectStart="MediaReconnectStart",r.MediaReconnectEnd="MediaReconnectEnd",r.NeedSignalRTT="NeedSignalRTT",r.RequestRestartICE="RequestRestartIce",r.PeerConnectionStateChange="PeerConnectionStateChange",r.RequestReconnect="RequestReconnect",r.RequestReconnectPC="RequestReconnectPC",r.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",r.P2PLost="P2PLost",r.UpdateVideoEncoder="UpdateVideoEncoder",r.ConnectionTypeChange="ConnectionTypeChange",r.RequestLowStreamParameter="RequestLowStreamParameter",r.QueryClientConnectionState="QueryClientConnectionState",r.LocalCandidate="LocalCandidate",r.RequestP2PMuteLocal="requestP2PMuteLocal",r.RequestP2PUnPublish="RequestP2PUnPublish",r.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",r.RequestP2PMuteRemote="RequestP2PMuteRemote",r.RequestP2PRestartICE="RequestP2PRestartICE",r}({}),yc=function(r){return r.CONNECTING="CONNECTING",r.RECONNECTING="RECONNECTING",r.CONNECTED="CONNECTED",r.CLOSED="CLOSED",r}({}),_c=function(r){return r[r.CONNECT_AP=0]="CONNECT_AP",r[r.AP_CONNECTED=1]="AP_CONNECTED",r[r.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",r[r.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",r[r.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",r[r.CONNECT_WORKER=5]="CONNECT_WORKER",r[r.WORKER_CONNECTED=6]="WORKER_CONNECTED",r[r.CLOSED=7]="CLOSED",r}({}),yi=function(r){return r.CONNECTION_STATE_CHANGE="connection-state-change",r.STATE_CHANGE="state-change",r.INSPECT_RESULT="inspect-result",r.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",r.REQUEST_NEW_WORKER_URL="request-new-worker-url",r}({}),hK=function(r){return r.CONNECTED="transmitter:connected",r.RECONNECTING="transmitter:reconnecting",r.WILL_RECONNECT="transmitter:will_reconnect",r.CLOSED="transmitter:closed",r.FAILED="transmitter:failed",r.ON_MESSAGE="transmitter:on_message",r.REQUEST_NEW_URLS="transmitter:request_new_urls",r.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",r.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",r.FAILBACK="transmitter:failback",r.PRE_CONNECT_PC="transmitter:pre_connect_pc",r}({}),su=function(r){return r.CAMERA_CHANGED="camera-changed",r.MICROPHONE_CHANGED="microphone-changed",r.PLAYBACK_DEVICE_CHANGED="playback-device-changed",r.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",r.AUTOPLAY_FAILED="autoplay-failed",r.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",r.SECURITY_POLICY_VIOLATION="security-policy-violation",r}({}),Io=function(r){return r.CONNECTING="CONNECTING",r.RECONNECTING="RECONNECTING",r.CONNECTED="CONNECTED",r.CLOSED="CLOSED",r}({}),cl=function(r){return r.CONNECTION_STATE_CHANGE="connection-state-change",r.STATE_CHANGE="state-change",r.INSPECT_RESULT="inspect-result",r.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",r.REQUEST_NEW_WORKER_URL="request-new-worker-url",r}({}),Mg=function(r){return r[r.CONNECT_AP=0]="CONNECT_AP",r[r.AP_CONNECTED=1]="AP_CONNECTED",r[r.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",r[r.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",r[r.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",r[r.CONNECT_WORKER=5]="CONNECT_WORKER",r[r.WORKER_CONNECTED=6]="WORKER_CONNECTED",r[r.CLOSED=7]="CLOSED",r}({}),Ar=function(r){return r.CALL="call",r.CANDIDATE="candidate",r.PUBLISH="publish",r.UNPUBLISH="unpublish",r.CONTROL="control",r.RESTART_ICE="restart_ice",r.ACK="ack",r.RESPONSE="response",r.JOIN="join",r.CHECK="check",r}({}),Ug=function(r){return r.ABORT="abort",r}({}),vh=function(r){return r.MUTE_LOCAL_AUDIO="mute_local_audio",r.MUTE_LOCAL_VIDEO="mute_local_video",r.UNMUTE_LOCAL_AUDIO="unmute_local_audio",r.UNMUTE_LOCAL_VIDEO="unmute_local_video",r}({}),XIe=function(r){return r.P2P_TOKEN_TIMEOUT="p2p_token_timeout",r.P2P_TOKEN_CHANGED="p2p_token_changed",r}({});const JIe={[uT.ACCESS_POINT]:{[Da.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Da.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Da.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Da.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Da.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Da.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[uT.UNILBS]:{[vc.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[vc.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[vc.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[vc.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[vc.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[vc.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[vc.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[vc.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[vc.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[vc.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[vc.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[vc.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[uT.STRING_UID_ALLOCATOR]:{[sD.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[sD.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[sD.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Fg(r){const a=JIe[Math.floor(r/1e4)];if(!a)return{desc:"unknown error",retry:!1};const s=a[r%1e4];if(!s){if(Math.floor(r/1e4)===uT.ACCESS_POINT){const l=r%1e4;if(l.toString()[0]==="1")return{desc:r.toString(),retry:!1};if(l.toString()[0]==="2")return{desc:r.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return s}const ZIe={[yt.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[yt.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[yt.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[yt.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[yt.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[yt.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[yt.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[yt.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[yt.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[yt.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[yt.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[yt.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[yt.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[yt.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[yt.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[yt.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[yt.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[yt.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[yt.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[yt.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[yt.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[yt.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[yt.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[yt.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[yt.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[yt.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[yt.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[yt.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[yt.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[yt.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[yt.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[yt.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[yt.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[yt.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[yt.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[yt.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[yt.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[yt.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[yt.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[yt.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[yt.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[yt.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[yt.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[yt.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[yt.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[yt.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[yt.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[yt.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[yt.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[yt.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[yt.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[yt.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[yt.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[yt.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[yt.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[yt.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[yt.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[yt.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[yt.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[yt.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[yt.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[yt.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[yt.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[yt.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function _b(r){return ZIe[r]||{desc:"UNKNOWN_ERROR_".concat(r),action:"failed"}}function fK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function uD(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?fK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):fK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function dD(r,a){if(typeof r=="string")return r;const{proxy:s,host:l,port:d}=r;if(a){const f=se("JOIN_GATEWAY_FALLBACK_PORT")||443;return f===443?"wss://".concat(l,"/ws/?p=").concat(Number(d)+150):"wss://".concat(l,":").concat(f,"/ws/?p=").concat(Number(d)+150)}return s?"wss://".concat(s,"/ws/?h=").concat(l,"&p=").concat(d):"wss://".concat(l,":").concat(d)}const QIe=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,eOe=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,tOe=/wss:\/\/(.+):([0-9]+)\/?/,nOe=/wss:\/\/(.[^\/]+)\/?/;let rOe=0;class iOe{constructor(a,s){Z(this,"id",0),Z(this,"store",void 0),Z(this,"recordIndex",void 0),Z(this,"websockets",[]),Z(this,"try443PortDuration",2e3),Z(this,"forceCloseWSDuration",5e3),Z(this,"try443PortTimeout",null),Z(this,"forceCloseTimeout",null),Z(this,"isTry443PortFailed",!1),Z(this,"isNormalPortFailed",!1),Z(this,"useDoubleDomain",!1),Z(this,"useProxy",!1),Z(this,"startTime",Date.now()),this.id=++rOe,this.try443PortDuration=se("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=a||5e3,this.store=s}closeAllWebsockets(){this.websockets.forEach(a=>{a.onopen=null,a.onclose=null,a.onmessage=null,a.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var a;const s=Date.now()-this.startTime;for(var l=arguments.length,d=new Array(l),f=0;f<l;f++)d[f]=arguments[f];F.debug("[choose-best-ws ".concat((a=this.store)===null||a===void 0?void 0:a.clientId," ").concat(this.id,"] ").concat(s,"ms:"),...d)}createWebSocket(a,s,l){this.logger("createWebSocket:",a,{isTry443Port:s,hasTimeoutDetection:l});const d=se("GATEWAY_DOMAINS"),f=Date.now(),m=[],y=d.find(I=>{var L;return Ve(L=a.host).call(L,I)});y||(this.useDoubleDomain=!1);const _=[];if(this.useDoubleDomain)d.forEach(I=>{_.push(dD(uD(uD({},a),{},{host:a.host.replace(y,I)}),s))});else{const I=uD({},a);if(s&&y){const L=d.find(H=>H!==y);L&&(I.host=I.host.replace(y,L))}_.push(dD(I,s))}try{_.forEach(I=>{const L=new WebSocket(I);L.binaryType="arraybuffer",m.push(L),this.logger("ws is connecting:",L.url)})}catch(I){if(this.logger("ws create failed"),m.forEach(L=>L.close()),m.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(a,s,l);if(!s&&Number(a.port)!==443)return this.createWebSocket(a,!0,l);throw new Ee(ie.WS_ERR,"init websocket failed! Error: ".concat(I.toString()))}const w=rb();this.store&&this.store.recordJoinChannelService({urls:m.map(I=>I.url),service:"gateway"},this.recordIndex),m.forEach(I=>{I.onopen=()=>{this.logger("onopen: ws ".concat(I.url," open cost ").concat(Date.now()-f,"ms")),this.websockets.forEach(L=>{L!==I&&(L.onopen=null,L.onclose=null,L.onmessage=null,L.close(),this.logger("close backup websocket: ".concat(L.url)))}),this.websockets.length=0,w.resolve(I)},I.onclose=L=>{this.logger("onclose: ws ".concat(I.url," closed cost ").concat(Date.now()-f,"ms state: ").concat(I.readyState));const H=m.every($=>$.readyState===WebSocket.CLOSED||$.readyState===WebSocket.CLOSING);this.logger("".concat(s?"443":"47xx"," websocket closed, all failed: ").concat(H)),H&&(s||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(L.reason)),w.reject({code:L.code,reason:fT.A_ROUND_WS_FAILED})):!s&&H&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),A()),s?this.isTry443PortFailed=H:this.isNormalPortFailed=H},I.onmessage=L=>this.logger("".concat(I.url," onmessage: ").concat(L.data))}),this.websockets.push(...m);const x=()=>{this.websockets.forEach(I=>I.readyState!==WebSocket.OPEN&&I.close())},A=()=>{if(w.isResolved)return x();sn().os===oi.MAC_OS&&dr()&&x(),this.createWebSocket(a,!0,!0).then(I=>{w.resolve(I)}).catch(I=>{this.isNormalPortFailed&&w.reject(I),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",w.isResolved),this.forceCloseTimeout=null,x()},this.forceCloseWSDuration)};return l||(()=>{if(s||this.useProxy)return this.logger("add 5s timeout at ".concat(s?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,x()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",w.isResolved),this.try443PortTimeout=null,A()},this.try443PortDuration)})(),w.promise}chooseBestWebsocket(a,s,l,d){return this.useDoubleDomain=!!s,typeof a=="string"&&(a=function(f){let m,y,_;return[,m,y,_]=f.match(QIe)||[],m||([,y,_]=f.match(eOe)||[]),y&&_||([,y,_]=f.match(tOe)||[]),y&&_||([,y]=f.match(nOe)||[]),y||F.warning("un-destructible url: ",f),{proxy:m,host:y,port:_||"443"}}(a)),this.recordIndex=d,this.useProxy=!!a.proxy,l&&this.useProxy&&(F.warn("cannot use 443 only when use proxy"),l=!1),this.createWebSocket(a,!!l,!1).finally(()=>this.clearTimeout())}}function pK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}class mK extends lr{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(a){var s;Ve(s=["tryNext","recover"]).call(s,a)&&this.resetReconnectCount(a),this._reconnectMode=a}get state(){return this._state}set state(a){a!==this._state&&(this._state=a,this._state==="reconnecting"?this.emit(Bt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(Bt.CONNECTED):this._state==="closed"?this.emit(Bt.CLOSED):this._state==="failed"&&this.emit(Bt.FAILED))}resetReconnectCount(a){F.debug("websocket reset reconnect count, reason: "+a),this.reconnectCount=0}constructor(a,s){let l=arguments.length>2&&arguments[2]!==void 0&&arguments[2],d=arguments.length>3&&arguments[3]!==void 0&&arguments[3],f=arguments.length>4&&arguments[4]!==void 0&&arguments[4],m=arguments.length>5?arguments[5]:void 0;super(),Z(this,"_websocketUrl",null),Z(this,"connectionID",0),Z(this,"currentURLIndex",0),Z(this,"urls",[]),Z(this,"_reconnectMode","tryNext"),Z(this,"reconnectReason",void 0),Z(this,"_initMutex",void 0),Z(this,"name",void 0),Z(this,"_state","closed"),Z(this,"reconnectInterrupter",void 0),Z(this,"websocket",void 0),Z(this,"retryConfig",void 0),Z(this,"reconnectCount",0),Z(this,"forceCloseTimeout",5e3),Z(this,"onlineReconnectListener",void 0),Z(this,"useCompress",void 0),Z(this,"tryDoubleDomain",!1),Z(this,"use443PortOnly",!1),Z(this,"wsInflateLength",0),Z(this,"wsDeflateLength",0),Z(this,"closeEstablishingWs",()=>{}),Z(this,"store",void 0),Z(this,"joinGatewayRecordIndex",void 0),this.store=m,this.name=a,this.retryConfig=function(A){for(var I=1;I<arguments.length;I++){var L=arguments[I]!=null?arguments[I]:{};I%2?pK(Object(L),!0).forEach(function(H){Z(A,H,L[H])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(L)):pK(Object(L)).forEach(function(H){Object.defineProperty(A,H,Object.getOwnPropertyDescriptor(L,H))})}return A}({},s),this.useCompress=l,this.tryDoubleDomain=d,this.use443PortOnly=f,this._initMutex=new Gi("websocket",m?m.clientId:void 0);const{timeout:y,timeoutFactor:_}=s,w=Math.max(300,Math.floor(3*y/5)),x=Math.max(1.2,Math.floor(8*_)/10);Is.ONLINE&&(this.retryConfig.timeout=w,this.retryConfig.timeoutFactor=x),Dr.on(yg.NETWORK_STATE_CHANGE,(A,I)=>{A!==I&&(this.resetReconnectCount("network state change: ".concat(I," -> ").concat(A)),A===Is.ONLINE?(this.retryConfig.timeout=w,this.retryConfig.timeoutFactor=x):(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=_))})}getConnection(){return this.websocket||void 0}async init(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const l=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=s,this.urls=a,this.state="connecting";try{var d;const f=rb(),m=this.urls[this.currentURLIndex];(d=this.store)===null||d===void 0||d.beforeConnect(),function(y){return!(qx()||se("USE_NEW_TOKEN")||!se("ENABLE_PREALLOC_PC")&&(y==null||!y.autoSubscribe||se("FORCE_DISABLE_AUTO_SUB")))}(this.store)&&this.emit(hK.PRE_CONNECT_PC),this.createWebSocketConnection(m).then(f.resolve).catch(f.reject),this.once(Bt.CLOSED,()=>{f.reject(new Se(ie.WS_DISCONNECT))}),this.once(Bt.CONNECTED,f.resolve),await f.promise}catch{}finally{l()}}close(a,s){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const l=this.websocket;s?setTimeout(()=>l.close(),500):l.close(),this.websocket=void 0,this._websocketUrl=null}this.state=a?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(a,s){if(!this.websocket)return void F.warning("[".concat(this.name,"] can not reconnect, no websocket"));a!==void 0&&(this.reconnectMode=a),F.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(s)]},this.joinGatewayRecordIndex);const l=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),l&&l.bind(this.websocket)({code:9999,reason:s})}sendMessage(a){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Se(ie.WS_ABORT,"websocket is not ready");try{s||(a=JSON.stringify(a)),this.websocket.send(a)}catch(l){throw new Se(ie.WS_ERR,"send websocket message error"+l.toString())}}setWsInflateData(a){this.wsDeflateLength=this.wsDeflateLength+a.originLength,this.wsInflateLength=this.wsInflateLength+a.compressedLength}getWsInflateData(){const a=this.wsInflateLength,s=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:a,wsDeflateLength:s}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(a){var s;const l=rb();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const d=x=>{var A;(A=this.store)===null||A===void 0||A.signalChannelOpen(),F.debug("[".concat(this.name,"] websocket opened:"),x),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),l.resolve()},f=async x=>{var A;if(F.debug("[".concat(this.name,"] websocket close ").concat((A=this.websocket)===null||A===void 0?void 0:A.url,", code: ").concat(x.code,", reason: ").concat(x.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)l.reject(new Se(ie.WS_DISCONNECT,"websocket close: ".concat(x.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=x.reason,this.state="reconnecting");const I=Xs(this,Bt.WILL_RECONNECT,this.reconnectMode,x.reason)||this.reconnectMode,L=await this.reconnectWithAction(I);if(this.state==="closed")return void F.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!L)return l.reject(new Se(ie.WS_DISCONNECT,"websocket reconnect failed: ".concat(x.code))),this.close(!0);l.resolve()}},m=x=>{this.emit(Bt.ON_MESSAGE,x)},y=x=>{F.warn("[".concat(this.connectionID,"] ws open error ").concat(x))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),se("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(a=se("GATEWAY_WSS_ADDRESS")),F.debug("[".concat(this.name,"] start connect, url:"),a);const _=(s=this.store)===null||s===void 0?void 0:s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var w;this._websocketUrl=dD(a);const x=await this.chooseBestWebsocketConnection(a);this.websocket=x,d&&d(this.websocket.url),this.websocket.onclose=f,this.websocket.onmessage=m,this.websocket.onerror=y,(w=this.store)===null||w===void 0||w.recordJoinChannelService({endTs:Date.now(),status:"success"},_),this.joinGatewayRecordIndex=_}catch(x){const A=this.state==="closed",I=x instanceof Se,L=I&&x.code===ie.WS_ABORT,H=I&&x.code===ie.WS_ERR,$=I?x.message:x&&(x.reason||x.toString());F.warning("[choose-best-ws] chooseBestWebsocket error: ".concat($)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:L?"aborted":"error",errors:[x]},_),A||H?(l.reject(A?new Se(ie.WS_DISCONNECT,"websocket is closed: ".concat($)):new Se(ie.WS_ERR,"init websocket failed: ".concat($))),H&&F.error("[".concat(this.name,"] init websocket failed: ").concat($))):f&&f(x)}return l.promise}async reconnectWithAction(a){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;F.warning("[choose-best-ws] action: =>",a),this.onlineReconnectListener||Dr.isOnline||!Dr.onlineWaiter||(this.onlineReconnectListener=Dr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let l=!0;if(this.reconnectInterrupter=()=>l=!1,s){const m=yj(this.reconnectCount,this.retryConfig);F.debug("[".concat(this.name,"] wait ").concat(m,"ms to reconnect websocket, mode: ").concat(a)),await Ge.race([Ci(m),this.onlineReconnectListener||new Ge(()=>{})])}if(this._state==="closed"||!l)return!1;this.reconnectCount+=1;const d=async(m,y)=>{this.emit(Bt.RECONNECT_CREATE_CONNECTION,y),await this.createWebSocketConnection(m)};try{if(a==="retry")await d(this.urls[this.currentURLIndex],a);else if(a==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);F.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await d(this.urls[this.currentURLIndex],a)}else a==="recover"&&(F.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await Li(this,Bt.REQUEST_NEW_URLS),this.currentURLIndex=0,await d(this.urls[this.currentURLIndex],a))}catch(m){var f;F.error("[".concat(this.name,"] reconnect failed ").concat(m&&m.toString()));const y=m==null||(f=m.data)===null||f===void 0?void 0:f.desc;return Array.isArray(y)&&Ve(y).call(y,"dynamic key expired")?(this.emit(Bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(a,s)}return!0}}class hD extends mK{constructor(a,s){super(a,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(a,s){const l=rb(),d=function(m,y){return new iOe(m,y)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{F.debug("[choose-best-ws] close establishing websockets"),d.closeAllWebsockets(),l.reject(new Se(ie.WS_ABORT,"choose best websocket aborted"))};const f=se("GATEWAY_DOMAINS");return F.debug("[choose-best-ws] currentDomain: ",a,", domains: ",f,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),d.chooseBestWebsocket(a,this.tryDoubleDomain,this.use443PortOnly,s).then(l.resolve).catch(l.reject),l.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class bb extends mK{constructor(a,s){super(a,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(a,s){return new Ge((l,d)=>{let f=!1;const m=[];this.closeEstablishingWs=()=>{F.debug("[choose-best-ws] close establishing websockets"),m.forEach(H=>{H.onclose=null,H.onopen=null,H.onmessage=null,H.close()}),d(new Se(ie.WS_ABORT,"choose best websocket aborted"))};const y=se("GATEWAY_DOMAINS");let _;const w=a.indexOf("?h="),x=y.find(H=>w!==-1?Ve(a).call(a,H,w):Ve(a).call(a,H));F.debug("[choose-best-ws] currentDomain: ",x,", domains: ",y);let A=!this.tryDoubleDomain||!x;if(!A&&x){var I;const H=Date.now();try{y.forEach($=>{const G=w===-1?a.replace(x,$):a.substr(0,w)+a.substr(w).replace(x,$),ne=new WebSocket(G);ne.binaryType="arraybuffer",m.push(ne),F.debug("[choose-best-ws] ws is connecting:",ne.url)})}catch{for(F.debug("[choose-best-ws] ws create failed, fallback to single url"),m.forEach(G=>G.close());m.length;)m.pop();A=!0}(I=this.store)===null||I===void 0||I.recordJoinChannelService({urls:m.map($=>$.url),service:"gateway"},s),m.forEach($=>{$.onopen=()=>{if(f)return;const G=Date.now()-H;F.debug("[choose-best-ws] ws open cost ".concat(G,"ms")),m.filter(ne=>ne!==$).forEach(ne=>{F.debug("[choose-best-ws]close backup websocket: ".concat(ne.url)),ne.close()}),f=!0,l($)},$.onclose=G=>{_=G,!f&&(m.find(ne=>!(ne.readyState===WebSocket.CLOSED||ne.readyState===WebSocket.CLOSING))||(F.debug("[choose-best-ws] all websocket is closed"),f=!0,d(_)))},$.onmessage=G=>{F.debug("[choose-best-ws]".concat($.url," onmessage: ").concat(G.data))}}),Ci(this.forceCloseTimeout).then(()=>{m.forEach($=>{$.readyState!==WebSocket.OPEN&&$.close()})})}if(A){var L;let H;F.debug("[choose-best-ws] use single url: ",a),(L=this.store)===null||L===void 0||L.recordJoinChannelService({urls:[a],service:"gateway"},s);try{H=new WebSocket(a),m.push(H),H.binaryType="arraybuffer"}catch($){const G=new Se(ie.WS_ERR,"init websocket failed! Error: ".concat($.toString()));return F.error("[".concat(this.name,"]").concat(G)),void d(G)}H.onopen=()=>{l(H)},H.onclose=$=>{d($)},H.onmessage=$=>{F.debug("[choose-best-ws]".concat(H.url," onmessage: ").concat($.data))},Ci(this.forceCloseTimeout).then(()=>{H&&H.readyState!==WebSocket.OPEN&&H.close()})}}).then(l=>(this.closeEstablishingWs=void 0,l)).catch(l=>{throw this.closeEstablishingWs=void 0,l})}}class aOe extends lr{get connectionState(){return this._connectionState}set connectionState(a){a!==this._connectionState&&(this._connectionState=a,a===$n.CONNECTED?this.emit(It.WS_CONNECTED):a===$n.RECONNECTING?this.emit(It.WS_RECONNECTING,this._websocketReconnectReason):a===$n.CLOSED&&this.emit(It.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(a,s){super(),Z(this,"_disconnectedReason",void 0),Z(this,"_websocketReconnectReason",void 0),Z(this,"_connectionState",$n.CLOSED),Z(this,"reconnectToken",void 0),Z(this,"websocket",void 0),Z(this,"openConnectionTime",void 0),Z(this,"clientId",void 0),Z(this,"lastMsgTime",Date.now()),Z(this,"uploadCache",[]),Z(this,"uploadCacheInterval",void 0),Z(this,"rttRolling",new Sz(5)),Z(this,"pingpongTimer",void 0),Z(this,"wsInflateDataTimer",void 0),Z(this,"pingpongTimeoutCount",0),Z(this,"ortc",void 0),Z(this,"joinResponse",void 0),Z(this,"multiIpOption",void 0),Z(this,"initError",void 0),Z(this,"spec",void 0),Z(this,"store",void 0),Z(this,"onWebsocketMessage",l=>{if(l.data instanceof ArrayBuffer)return void this.emit(It.ON_BINARY_DATA,l.data);const d=JSON.parse(l.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(d,"_id")){const f="res-@".concat(d._id);this.emit(f,d._result,d._message)}else if(Object.prototype.hasOwnProperty.call(d,"_type")){if(this.emit(d._type,d._message),d._type===tn.ON_NOTIFICATION&&this.handleNotification(d._message),d._type===tn.ON_USER_BANNED)switch(d._message.error_code){case 14:this.close(En.UID_BANNED);break;case 15:this.close(En.IP_BANNED);break;case 16:this.close(En.CHANNEL_BANNED)}if(d._type===tn.ON_USER_LICENSE_BANNED)switch(d._message.error_code){case yt.ERR_LICENSE_MISSING:this.close(En.LICENSE_MISSING);break;case yt.ERR_LICENSE_EXPIRED:this.close(En.LICENSE_EXPIRED);break;case yt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(En.LICENSE_MINUTES_EXCEEDED);break;case yt.ERR_LICENSE_PERIOD_INVALID:this.close(En.LICENSE_PERIOD_INVALID);break;case yt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(En.LICENSE_MULTIPLE_SDK_SERVICE);break;case yt.ERR_LICENSE_ILLEGAL:this.close(En.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=a.clientId,this.spec=a,this.store=s,this.websocket=new hD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,se("JOIN_GATEWAY_USE_DUAL_DOMAIN"),se("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===$n.CONNECTED&&this.reconnect("retry",Di.OFFLINE)})}async request(a,s,l,d){const f=Mn(6,""),m={_id:f,_type:a,_message:s},y=this.websocket.connectionID,_=()=>new Ge((H,$)=>{if(this.connectionState===$n.CONNECTED)return H();const G=()=>{this.off(It.WS_CLOSED,ne),H()},ne=()=>{this.off(It.WS_CONNECTED,G),$(new Ee(ie.WS_ABORT))};this.once(It.WS_CONNECTED,G),this.once(It.WS_CLOSED,ne),a!==Ct.PUBLISH&&a!==Ct.PUBLISH_DATASTREAM&&a!==Ct.SUBSCRIBE&&a!==Ct.SUBSCRIBE_DATASTREAM&&a!==Ct.UNSUBSCRIBE&&a!==Ct.UNSUBSCRIBE_DATASTREAM&&a!==Ct.UNPUBLISH&&a!==Ct.UNPUBLISH_DATASTREAM&&a!==Ct.CONTROL&&a!==Ct.RESTART_ICE||this.once(It.DISCONNECT_P2P,()=>{$(new Ee(ie.DISCONNECT_P2P))}),a!==Ct.PUBLISH&&a!==Ct.RESTART_ICE||this.once(It.ABORT_P2P_EXECUTION,()=>{$(new Ee(ie.DISCONNECT_P2P))})});if(this.connectionState!==$n.CONNECTING&&this.connectionState!==$n.RECONNECTING||a===Ct.JOIN||a===Ct.REJOIN||await _(),this.websocket.sendMessage(m,!0),d)return;const w=new Ge((H,$)=>{let G=!1;const ne=(ce,pe)=>{G=!0,H({isSuccess:ce==="success",message:pe||{}}),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.emit(It.REQUEST_SUCCESS,a,s)};this.once("res-@".concat(f),ne);const te=()=>{$(new Ee(ie.WS_ABORT,"type: ".concat(a))),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.off("res-@".concat(f),ne)};this.once(It.WS_CLOSED,te),this.once(It.WS_RECONNECTING,te),Ci(se("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==y||G||(F.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(a)),this.emit(It.REQUEST_TIMEOUT,a,s))})});let x=null;try{x=await w}catch(H){if(this.connectionState===$n.CLOSED||a===Ct.LEAVE)throw new Ee(ie.WS_ABORT);return!this.spec.forceWaitGatewayResponse||l?H.throw():a===Ct.JOIN||a===Ct.REJOIN?null:(await _(),await this.request(a,s))}if(x.isSuccess)return x.message;const A=Number(x.message.error_code||x.message.code),I=_b(A),L=new Ee(ie.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(x.message.error_str),{code:A,data:x.message,desc:I.desc});return I.action==="success"?x.message:(F.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(a,", error_code: ").concat(A,", message: ").concat(I.desc,", action: ").concat(I.action)),A===yt.ERR_TOO_MANY_BROADCASTERS?((a===Ct.JOIN||a===Ct.REJOIN)&&(this.initError=L,this.close()),L.throw()):I.action==="failed"?L.throw():I.action==="quit"?(this.initError=L,this.close(),L.throw()):(A===yt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,F.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Di.MULTI_IP)):this.reconnect(I.action,Di.SERVER_ERROR),a===Ct.JOIN||a===Ct.REJOIN?null:await this.request(a,s)))}waitMessage(a,s){return new Ge(l=>{const d=f=>{(!s||s(f))&&(this.off(a,d),l(f))};this.on(a,d)})}uploadWRTCStats(a){if(!this.store.sessionId)return void F.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const s={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:a};this.upload(vb.WRTC_STATS,s)}upload(a,s){const l={_type:a,_message:s};try{this.websocket.sendMessage(l)}catch{const f=se("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(l),this.uploadCache.length>f&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==$n.CONNECTED)return;const m=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(m._type,m._message)},se("UPLOAD_CACHE_INTERVAL")||2e3))}}send(a,s){const l={_type:a,_message:s};this.websocket.sendMessage(l)}init(a){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ge((s,l)=>{this.once(It.WS_CONNECTED,()=>s(this.joinResponse)),this.once(It.WS_CLOSED,d=>l(this.initError||new Ee(ie.WS_ABORT,d))),this.connectionState=$n.CONNECTING,this.websocket.init(a).catch(l),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=a||En.LEAVE,this.connectionState=$n.CLOSED,F.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(It.ABORT_P2P_EXECUTION),this.store.signalConnected();const a=await Li(this,It.REQUEST_JOIN_INFO);this.store.joinReq();const s=await this.request(Ct.JOIN,a);if(this.ortc=a==null?void 0:a.ortc,this.store.joinRep(),!s)return this.emit(It.REPORT_JOIN_GATEWAY,fT.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(It.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=$n.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Ee(ie.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const a=cb(this,It.REQUEST_REJOIN_INFO);a.token=this.reconnectToken;const s=await this.request(Ct.REJOIN,a);return!!s&&(this.connectionState=$n.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),s.peers&&s.peers.forEach(l=>{this.emit(tn.ON_USER_ONLINE,{uid:l.uid}),l.audio&&this.emit(tn.ON_ADD_AUDIO_STREAM,{uid:l.uid,uint_id:l.uint_id,audio:!0,ssrcId:l.audio_ssrc}),l.video&&this.emit(tn.ON_ADD_VIDEO_STREAM,{uid:l.uid,uint_id:l.uint_id,video:!0,ssrcId:l.video_ssrc}),l.audio_mute?this.emit(tn.MUTE_AUDIO,{uid:l.uid}):this.emit(tn.UNMUTE_AUDIO,{uid:l.uid}),l.video_mute?this.emit(tn.MUTE_VIDEO,{uid:l.uid}):this.emit(tn.UNMUTE_VIDEO,{uid:l.uid}),l.audio_enable_local?this.emit(tn.ENABLE_LOCAL_AUDIO,{uid:l.uid}):this.emit(tn.DISABLE_LOCAL_AUDIO,{uid:l.uid}),l.video_enable_local?this.emit(tn.ENABLE_LOCAL_VIDEO,{uid:l.uid}):this.emit(tn.DISABLE_LOCAL_VIDEO,{uid:l.uid}),l.audio||l.video||this.emit(tn.ON_REMOVE_STREAM,{uid:l.uid,uint_id:l.uint_id})}),!0)}reconnect(a,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(a,s)}async downgradeCodec(a){if(!this.ortc)return!1;const s={downgrade_codec:a,ortc:this.ortc};return!!await this.request(Ct.DOWNGRADE_CODEC,s)}handleNotification(a){F.debug("[".concat(this.clientId,"] receive notification: "),a);const s=_b(a.code);if(a.code===28&&"detail"in a&&(F.info("[".concat(this.clientId,"] receive recover notification: "),a.detail),this.emit(It.RECOVER_NOTIFICATION,a.detail)),s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(En.UID_BANNED),void this.close()):void this.reconnect(s.action,Di.SERVER_ERROR);F.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const a=se("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=a&&(F.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>se("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Di.TIMEOUT):this.request(Ct.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const l=Date.now()-s;this.rttRolling.add(l),se("REPORT_STATS")&&this.send(Ct.PING_BACK,{pingpongElapse:l})}).catch(l=>{})}handleWsInflateData(){const{wsInflateLength:a,wsDeflateLength:s}=this.websocket.getWsInflateData();a!==0&&s!==0&&this.upload(vb.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:a})}handleWebsocketEvents(){this.websocket.on(Bt.RECONNECT_CREATE_CONNECTION,a=>{this.emit(It.WS_RECONNECT_CREATE_CONNECTION,a)}),this.websocket.on(Bt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Bt.CLOSED,()=>{this.connectionState=$n.CLOSED}),this.websocket.on(Bt.FAILED,()=>{this._disconnectedReason=En.NETWORK_ERROR,this.connectionState=$n.CLOSED}),this.websocket.on(Bt.RECONNECTING,a=>{this._websocketReconnectReason=a,this.joinResponse=void 0,this.connectionState===$n.CONNECTED?this.connectionState=$n.RECONNECTING:this.connectionState=$n.CONNECTING}),this.websocket.on(Bt.WILL_RECONNECT,(a,s,l)=>{const d=cb(this,It.IS_P2P_DISCONNECTED),f=d||a!=="retry";d&&a==="retry"&&(F.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),a="tryNext",s=fT.P2P_DISCONNECTED),f&&(F.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(a)),this.emit(It.REPORT_JOIN_GATEWAY,s||fT.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(It.DISCONNECT_P2P)),l(a)}),this.websocket.on(Bt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(a=>{F.warning("[".concat(this.clientId,"] rejoin failed ").concat(a)),this.reconnect("tryNext",Di.SERVER_ERROR)}):this.join().catch(a=>{if(this.emit(It.REPORT_JOIN_GATEWAY,a,this.url||""),a instanceof Ee){if(a.code===ie.UNEXPECTED_RESPONSE&&a.data.code===yt.ERR_NO_AUTHORIZED)return this.initError=new Ee(ie.TOKEN_EXPIRE,"dynamic key expired"),void this.close(En.TOKEN_EXPIRE);F.error("[".concat(this.clientId,"] join gateway request failed"),a.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Di.SERVER_ERROR):(this.initError=a,this.close())}})}),this.websocket.on(Bt.REQUEST_NEW_URLS,(a,s)=>{Li(this,It.REQUEST_RECOVER,this.multiIpOption).then(a).catch(s)}),this.websocket.on(Bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(tn.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(hK.PRE_CONNECT_PC,()=>{this.emit(It.PRE_CONNECT_PC)})}}let sOe=function(r){return r.NATIVE_RTC="native_rtc",r.NATIVE_RTM="native_rtm",r.WEB_RTC="web_rtc",r.WEB_RTM="web_rtm",r}({}),Lr=function(r){return r[r.CHOOSE_SERVER=11]="CHOOSE_SERVER",r[r.CLOUD_PROXY=18]="CLOUD_PROXY",r[r.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",r[r.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",r}({});function gK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function mT(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?gK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):gK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function yh(r){return r.match(/^[\.\:\d]+$/)?"".concat(r.replace(/[^\d]/g,"-"),".").concat(se("TURN_DOMAIN")):(F.debug("Cannot recognized as ip address: ".concat(r,", use as host2")),r)}function gT(r){try{const a=se("GATEWAY_DOMAINS").concat(se("TURN_DOMAIN")).find(s=>Ve(r).call(r,s));return a?r.split(".".concat(a))[0].replace(/-/g,"."):r}catch{return F.debug("serverUrlToIp error, fallback to url",r),r}}function fD(r,a){r.addresses||(r.addresses=[]);const s=function(y,_){if(se("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return y.map(A=>{let{ip:I,port:L}=A;return{address:"".concat(I,":").concat(L)}});const w=se("GATEWAY_DOMAINS");let x=w[1]&&Ve(_).call(_,w[1])?1:0;return y.map(A=>{let{domain_prefix:I,port:L,ip:H}=A;if(I)return{address:"".concat(I,".").concat(w[x++%w.length],":").concat(L)};const $=/^[\.\:\d]+$/.test(H),G=$?"".concat(H.replace(/[^\d]/g,"-"),".").concat(w[x++%w.length],":").concat(L):"".concat(H,":").concat(L);return $||F.debug("Cannot recognized as ip address: ".concat(H,", use as host3")),{ip:H,port:L,address:G}})}(r.addresses,a),l=Array.isArray(r.detail)&&r.detail[18];if(l&&typeof l=="string"){const y=l.split(";");for(let _=0;_<y.length;_++){var d;const w=Ea(d=y[_]).call(d);s[_]&&w&&(s[_].ip6=w)}}const f=r.detail&&r.detail.candidate;let m;if(f){const[y,_]=f.split(":");y&&_&&(m={port:Number(_),ip:y,address:"".concat(y,":").concat(_)})}return{gatewayAddrs:s,apGatewayAddress:m,uid:r.uid,cid:r.cid,cert:r.cert,vid:r.detail&&r.detail[8],uni_lbs_ip:r.detail&&r.detail[1],res:r,csIp:r.detail&&r.detail[502]}}function Os(r){return typeof r=="number"?r:r.exact||r.ideal||r.max||r.min||0}function vK(r){const a=r._encoderConfig;if(!a)return{};const s={resolution:a.width&&a.height?"".concat(Os(a.width),"x").concat(Os(a.height)):void 0,maxVideoBW:a.bitrateMax,minVideoBW:a.bitrateMin};return typeof a.frameRate=="number"?(s.maxFrameRate=a.frameRate,s.minFrameRate=a.frameRate):a.frameRate&&(s.maxFrameRate=a.frameRate.max||a.frameRate.ideal||a.frameRate.exact||a.frameRate.min,s.minFrameRate=a.frameRate.min||a.frameRate.ideal||a.frameRate.exact||a.frameRate.max),s}function yK(r){return r>=0&&r<.17?1:r>=.17&&r<.36?2:r>=.36&&r<.59?3:r>=.59&&r<=1?4:r>1?5:0}function Eb(r,a){let s,l,d;switch(a){case Lr.CHOOSE_SERVER:l=4096,d="choose server";break;case Lr.CLOUD_PROXY:l=1048576,d="proxy";break;case Lr.CLOUD_PROXY_5:l=4194304,d="proxy5";break;case Lr.CLOUD_PROXY_FALLBACK:l=4194310,d="proxy fallback";break;default:throw new Ee(ie.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:r.detail&&r.detail[502],retry:!1})}if(r.response_body.forEach(f=>{f.buffer&&f.buffer.flag===l&&(s={code:f.buffer.code,addresses:(f.buffer.edges_services||[]).map(m=>mT(mT({},m),{},{ticket:f.buffer.cert})),server_ts:r.enter_ts,uid:f.buffer.uid,cid:f.buffer.cid,cname:f.buffer.cname,detail:mT(mT({},f.buffer.detail),r.detail),flag:f.buffer.flag,opid:r.opid,cert:f.buffer.cert})}),!s)throw new Ee(ie.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(d," from multi unilbs response"),{csIp:r.detail&&r.detail[502]});return s}async function _K(r,a){return await Ge.all(r.addresses.map(async s=>({address:yh(s.ip),tcpport:s.port,udpport:s.port,username:a&&se("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?a.toString():Mi.username,password:a&&se("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await pj(a.toString()):Mi.password})))}function pD(r,a){const s=a.getMediaStreamTrack(!0).getSettings(),l=a.videoHeight||s.height,d=a.videoWidth||s.width;return l&&d?Math.max(Math.min(l,d)/Math.min(Os(r.height),Os(r.width)),1):(F.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function _h(r){let{candidateType:a,relayProtocol:s,type:l,address:d,port:f,protocol:m}=r;const y={candidateType:a,relayProtocol:s,protocol:m};if(l!=="local-candidate"){const _=d.split(".");_.length>=4&&(_[1]="*",_[2]="*"),y.address=_.join("."),y.port=f}return y}function mp(r){const a=r.split(":"),s=r.split(/[-.]/),l=Ve(r).call(r,"-")?"-":".";let d=r;return a.length>1?s.length>1?(s[1]="**",d=s[0]+l+"**:"+a[a.length-1]):d=a.length>2?a[0]+l+"**:"+a[a.length-1]:"**:"+a[a.length-1]:s.length>1&&(d=s[0]+l+"**"),d}function vT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:se("SVC_MODE");if(se("ENABLE_SVC"))return function(a){return a in Hx}(r)?r:Hx.L1T3}const bK={[Ye.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[Ye.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function yT(r,a,s){a.forEach(l=>{var d;const f=bK[r].find(y=>{var _;let{key:w}=y;return Ve(_=l.extensionName).call(_,w)});if(!f)return;const m=s.find(y=>{let{extensionName:_}=y;return Ve(_).call(_,f.key)});m&&Ve(d=m.extensionName).call(d,"gdpr_forbidden")&&(l.extensionName=m.extensionName)})}function Vg(r,a){a.forEach(s=>{var l;const d=bK[r].find(f=>{var m;let{key:y}=f;return Ve(m=s.extensionName).call(m,y)});Ve(l=s.extensionName).call(l,"gdpr_forbidden")&&d&&(s.extensionName=d.extensionName)})}function EK(r){return r==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||Ve(r).call(r,"abs-send-time")}function _T(r){return r==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||Ve(r).call(r,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function wK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function SK(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?wK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):wK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function wb(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0;const{filterRTX:d,filterVideoFec:f,filterAudioFec:m,filterAudioCodec:y,filterVideoCodec:_,unsupportedVideoUplinkCodec:w,unsupportedVideoDownlinkCodec:x}=a,{useXR:A}=s;let I=[],L=[],H=[],$=[],G=!1,ne=!1;if(ss(r).mediaDescriptions.forEach(ce=>{l&&l!==ce.attributes.direction||(ce.media.mediaType!=="video"||G||(L=ce.attributes.payloads,$=ce.attributes.extmaps,G=!0),ce.media.mediaType!=="audio"||ne||(I=ce.attributes.payloads,H=ce.attributes.extmaps,ne=!0))}),!$||L.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!H||I.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(L.forEach(ce=>{var pe;(pe=ce.rtpMap)!==null&&pe!==void 0&&pe.clockRate&&(ce.rtpMap.clockRate=parseInt(ce.rtpMap.clockRate)),A&&ce.rtcpFeedbacks.push({type:"rrtr"})}),I.forEach(ce=>{var pe;(pe=ce.rtpMap)!==null&&pe!==void 0&&pe.clockRate&&(ce.rtpMap.clockRate=parseInt(ce.rtpMap.clockRate)),A&&ce.rtcpFeedbacks.push({type:"rrtr"})}),d&&(I=I.filter(ce=>{var pe;return((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLowerCase())!=="rtx"}),L=L.filter(ce=>{var pe;return((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLowerCase())!=="rtx"})),f){const ce=L.filter(ue=>{var ye;return/(red)|(ulpfec)|(flexfec)/i.test(((ye=ue.rtpMap)===null||ye===void 0?void 0:ye.encodingName)||"")}),pe=Eh(ce,L).map(ue=>ue.payloadType),fe=[...ce.map(ue=>ue.payloadType),...pe];L=L.filter(ue=>!Ve(fe).call(fe,ue.payloadType))}if(m&&(I=I.filter(ce=>{var pe;return!/(red)|(ulpfec)|(flexfec)/i.test(((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName)||"")})),y&&(y==null?void 0:y.length)>0&&(I=I.filter(ce=>{var pe;return Ve(y).call(y,((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLowerCase())||"")})),_&&(_==null?void 0:_.length)>0){const ce=L.filter(pe=>{var fe;return Ve(_).call(_,((fe=pe.rtpMap)===null||fe===void 0?void 0:fe.encodingName.toLowerCase())||"")});L=ce.concat(d?[]:Eh(ce,L))}const te=se("UNSUPPORTED_VIDEO_CODEC");if(te&&te.length>0){const ce=L.filter(ue=>ue.rtpMap&&Ve(te).call(te,ue.rtpMap.encodingName.toLowerCase())),pe=Eh(ce,L),fe=ce.concat(pe).map(ue=>ue.payloadType);L=L.filter(ue=>!Ve(fe).call(fe,ue.payloadType)),F.debug("unsupportedVideoCodec: ".concat(te,", toBeRemoved: ").concat(fe))}if(w&&w.length>0&&l==="sendonly"){const ce=L.filter(ue=>ue.rtpMap&&Ve(w).call(w,ue.rtpMap.encodingName.toLowerCase())),pe=Eh(ce,L),fe=ce.concat(pe).map(ue=>ue.payloadType);L=L.filter(ue=>!Ve(fe).call(fe,ue.payloadType)),F.debug("unsupportedVideoUplinkCodec: ".concat(w,", toBeRemoved: ").concat(fe))}if(x&&x.length>0&&l==="recvonly"){const ce=L.filter(ue=>ue.rtpMap&&Ve(x).call(x,ue.rtpMap.encodingName.toLowerCase())),pe=Eh(ce,L),fe=ce.concat(pe).map(ue=>ue.payloadType);L=L.filter(ue=>!Ve(fe).call(fe,ue.payloadType)),F.debug("unsupportedVideoDownlinkCodec: ".concat(x,", toBeRemoved: ").concat(fe))}return{audioCodecs:I,videoCodecs:L,audioExtensions:H,videoExtensions:$}}function bh(r){const a=ss(r);let s,l;for(const d of a.mediaDescriptions){if(!s){const f=d.attributes.iceUfrag,m=d.attributes.icePwd;if(!f||!m)throw new Error("Cannot get iceUfrag or icePwd from SDP.");s={iceUfrag:f,icePwd:m}}if(!l){const f=d.attributes.fingerprints;f.length>0&&(l={fingerprints:f})}}if(!l&&a.attributes.fingerprints.length>0&&(l={fingerprints:a.attributes.fingerprints}),!l||!s)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:s,dtlsParameters:l}}function xK(r,a){const s=[],l=r.attributes.ssrcGroups.filter(m=>m.semantic==="FID"),d=r.attributes.ssrcGroups.find(m=>m.semantic==="SIM"),f=r.attributes.ssrcs;if(d)d.ssrcIds.forEach(m=>{var y;const _=(y=l.find(w=>w.ssrcIds[0]===m))===null||y===void 0?void 0:y.ssrcIds[1];s.push({ssrcId:m,rtx:a?_:void 0})});else if(l.length>0){const m=l[0].ssrcIds[0],y=l[0].ssrcIds[1];s.push({ssrcId:m,rtx:a?y:void 0})}else{if(f.length===0)throw new Error("No ssrcs found on local media description.");s.push({ssrcId:f[0].ssrcId})}return s}function TK(r,a,s){const{cname:l}=r;let d=[];a&&(d=CK(a)),d.length===0&&(d=r.iceParameters.candidates.map(x=>({foundation:x.foundation,componentId:"1",transport:x.protocol,priority:x.priority.toString(),connectionAddress:x.ip,port:x.port.toString(),type:x.type,extension:{}})),F.debug("Using candidates from gateway."));const f={fingerprints:r.dtlsParameters.fingerprints.map(x=>({hashFunction:x.algorithm,fingerprint:x.fingerprint}))},m={iceUfrag:r.iceParameters.iceUfrag,icePwd:r.iceParameters.icePwd};let y;switch(r.dtlsParameters.role){case"server":y="passive";break;case"client":y="active";break;case"auto":y="actpass"}const _=ET(r.rtpCapabilities),w=[];return Array.isArray(s)&&s.length>0&&s.forEach(x=>{w.push({kind:Ye.VIDEO,ssrcMsg:[{ssrcId:x.v,rtx:x.v_rtx}],mslabel:"".concat(x.v,"_").concat(x.a)},{kind:Ye.AUDIO,ssrcMsg:[{ssrcId:x.a}],mslabel:"".concat(x.v,"_").concat(x.a)})}),{dtlsParameters:f,iceParameters:m,candidates:d,rtpCapabilities:_,setup:y,cname:l,preSSRCs:w}}function CK(r){let a=[];return r.ip&&typeof r.port=="number"&&(a=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:r.ip,port:r.port.toString(),type:"host",extension:{}}],F.debug("Using remote candidate from AP ".concat(mp(r.ip),":").concat(r.port)),r.ip6&&(a.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:r.ip6,port:r.port.toString(),type:"host",extension:{}}),F.debug("Using IPV6 remote candidate from AP ".concat(mp(r.ip6),":").concat(r.port)))),a}function Sb(r,a,s){const l=[],d=[];return r.forEach(f=>{let{ssrcId:m,rtx:y}=f;const _=Mn(8,"track-"),w={ssrcId:m,attributes:SK({label:_,mslabel:s=s||Mn(10,""),msid:"".concat(s," ").concat(_)},a&&{cname:a})};if(l.push(w),y!==void 0){const x={ssrcId:y,attributes:SK({label:_,mslabel:s,msid:"".concat(s," ").concat(_)},a&&{cname:a})};l.push(x),d.push({semantic:"FID",ssrcIds:[m,y]})}}),r.length>1&&d.push({semantic:"SIM",ssrcIds:r.map(f=>{let{ssrcId:m}=f;return m})}),{ssrcs:l,ssrcGroups:d}}function Bg(r,a){a instanceof vr&&r.attributes.payloads.forEach(s=>{var l;const d=(l=s.rtpMap)===null||l===void 0?void 0:l.encodingName.toLowerCase();if(!d||["opus","pcmu","pcma","g722"].indexOf(d)===-1)return;s.fmtp||(s.fmtp={parameters:{}}),d==="opus"&&typeof se("OPUS_PTIME")=="number"?s.fmtp.parameters.ptime=se("OPUS_PTIME"):s.fmtp.parameters.minptime="10",s.fmtp.parameters.useinbandfec="1";const f=a._encoderConfig;f&&(d!=="pcmu"&&d!=="pcma"&&d!=="g722"&&(f.bitrate&&!dr()&&(s.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*f.bitrate))),f.sampleRate&&(s.fmtp.parameters.maxplaybackrate="".concat(f.sampleRate),s.fmtp.parameters["sprop-maxcapturerate"]="".concat(f.sampleRate)),f.stereo&&(s.fmtp.parameters.stereo="1",s.fmtp.parameters["sprop-stereo"]="1")),a instanceof mb&&d==="opus"&&a._config.DTX&&(s.fmtp.parameters.usedtx="1"))})}function mD(r){const a=r.attributes.unrecognized.findIndex(s=>s.attField==="x-google-flag"&&s.attValue==="conference");a!==-1&&r.attributes.unrecognized.splice(a,1)}function gD(r,a){var s;if(!(a instanceof Wn&&a._encoderConfig&&a._hints.indexOf(jn.SCREEN_TRACK)===-1))return;const l=a._encoderConfig;un().supportMinBitrate&&l.bitrateMin&&r.attributes.payloads.forEach(d=>{var f,m;Ve(f=["h264","h265","vp8","vp9","av1"]).call(f,((m=d.rtpMap)===null||m===void 0?void 0:m.encodingName.toLowerCase())||"")&&(d.fmtp||(d.fmtp={parameters:{}}),d.fmtp.parameters["x-google-min-bitrate"]="".concat(l.bitrateMin))}),un().supportMinBitrate&&!Ve(s=a._hints).call(s,jn.LOW_STREAM)&&l.bitrateMax&&r.attributes.payloads.forEach(d=>{var f,m;Ve(f=["h264","h265","vp8","vp9","av1"]).call(f,((m=d.rtpMap)===null||m===void 0?void 0:m.encodingName.toLowerCase())||"")&&(d.fmtp||(d.fmtp={parameters:{}}),d.fmtp.parameters["x-google-start-bitrate"]="".concat(se("X_GOOGLE_START_BITRATE")||Math.floor(l.bitrateMax)))})}function RK(r){if(r.media.mediaType!=="video")return;const a=sn();if(a.name!==pn.SAFARI&&a.os!==oi.IOS)return;const s=r.attributes.extmaps.findIndex(l=>/video-orientation/g.test(l.extensionName));s!==-1&&r.attributes.extmaps.splice(s,1)}function bT(r,a,s){if(!a)return;let l,d;if(r.media.mediaType==="video"?(l=s.videoExtensions,d=s.videoCodecs):(l=s.audioExtensions,d=s.audioCodecs),a.twcc===!0){const f=l.find(m=>_T(m.extensionName));if(f){const m=f.extensionName;r.attributes.extmaps.find(_=>_T(_.extensionName))||r.attributes.extmaps.push({entry:f.entry,extensionName:m}),function(_,w){return w.filter(x=>!!_.find(A=>A.payloadType===x.payloadType&&!!A.rtcpFeedbacks.find(I=>I.type==="transport-cc")))}(d,r.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(w=>w.type==="transport-cc")||_.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(a.twcc===!1){const f=r.attributes.extmaps.findIndex(m=>_T(m.extensionName));f!==-1&&r.attributes.extmaps.splice(f,1),r.attributes.payloads.forEach(m=>{const y=m.rtcpFeedbacks.findIndex(_=>_.type==="transport-cc");y!==-1&&m.rtcpFeedbacks.splice(y,1)})}if(a.remb===!0){const f=l.find(m=>EK(m.extensionName));if(f){const m=f.extensionName;r.attributes.extmaps.find(_=>_.extensionName===m)||r.attributes.extmaps.push({entry:f.entry,extensionName:m}),function(_,w){return w.filter(x=>!!_.find(A=>A.payloadType===x.payloadType&&!!A.rtcpFeedbacks.find(I=>I.type==="goog-remb")))}(d,r.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(w=>w.type==="goog-remb")||_.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(a.remb===!1){const f=r.attributes.extmaps.findIndex(m=>EK(m.extensionName));f!==-1&&r.attributes.extmaps.splice(f,1),r.attributes.payloads.forEach(m=>{const y=m.rtcpFeedbacks.findIndex(_=>_.type==="goog-remb");y!==-1&&m.rtcpFeedbacks.splice(y,1)})}}function NK(r,a,s){if(dr()||r.media.mediaType!=="video"||!(a instanceof Wn)||s!=="vp9"&&s!=="vp8"||s==="vp8"&&!se("SIMULCAST")||s==="vp9"&&se("ENABLE_SVC")||a._scalabilityMode===void 0||a._scalabilityMode.numSpatialLayers<=1)return;const l=s==="vp8"?2:a._scalabilityMode.numSpatialLayers,d=r.attributes.ssrcs[0],f=r.attributes.ssrcGroups.find(y=>y.semantic==="FID"&&y.ssrcIds[0]===d.ssrcId),m={semantic:"SIM",ssrcIds:[d.ssrcId]};for(let y=1;y<l;y++)r.attributes.ssrcs.push({ssrcId:d.ssrcId+y,attributes:ir(d.attributes)}),m.ssrcIds.push(d.ssrcId+y),f&&(r.attributes.ssrcs.push({ssrcId:f.ssrcIds[1]+y,attributes:ir(d.attributes)}),r.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[d.ssrcId+y,f.ssrcIds[1]+y]}));r.attributes.ssrcGroups.unshift(m)}async function AK(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new RTCPeerConnection;s.addTransceiver("video",{direction:"sendonly"}),s.addTransceiver("audio",{direction:"sendonly"}),s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"});const l=(await s.createOffer()).sdp,{send:d,recv:f,sendrecv:m}=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w=arguments.length>2?arguments[2]:void 0;const x=wb(w,y,_,"sendonly"),A=wb(w,y,_,"recvonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},L={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},H={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(bc(x,A,"videoExtensions",I,L,H),bc(x,A,"videoCodecs",I,L,H),bc(x,A,"audioExtensions",I,L,H),bc(x,A,"audioCodecs",I,L,H),se("RAISE_H264_BASELINE_PRIORITY")){const $=[],G=[];if(H.videoCodecs.forEach((ne,te)=>{var ce;if(((ce=ne.rtpMap)===null||ce===void 0?void 0:ce.encodingName.toLocaleLowerCase())==="h264"){var pe,fe;const ue=H.videoCodecs[te+1],ye=ue&&jK(ne,ue),xe=(pe=ne.fmtp)===null||pe===void 0?void 0:pe.parameters["profile-level-id"],Ae=(fe=ne.fmtp)===null||fe===void 0?void 0:fe.parameters["packetization-mode"];!xe||xe!==se("FIRST_H264_PROFILE_LEVEL_ID")||se("FIRST_PACKETIZATION_MODE")&&Ae!==se("FIRST_PACKETIZATION_MODE")?ye?G.push([ne,ue]):G.push([ne]):ye?$.push([ne,ue]):$.push([ne])}}),$.length>0&&G.length>0){F.debug("raising H264 baseline profile priority"),H.videoCodecs.forEach((te,ce)=>{var pe;if(((pe=te.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLocaleLowerCase())==="h264"){const fe=jK(te,H.videoCodecs[ce+1]),ue=$.shift()||G.shift()||[];ue.length>0&&(fe?H.videoCodecs.splice(ce,2,...ue):H.videoCodecs.splice(ce,1,...ue))}});const ne=L.videoCodecs.filter(te=>{var ce,pe;return((ce=te.rtpMap)===null||ce===void 0?void 0:ce.encodingName.toLocaleLowerCase())==="h264"&&((pe=te.fmtp)===null||pe===void 0?void 0:pe.parameters["profile-level-id"])!==se("FIRST_H264_PROFILE_LEVEL_ID")});if(ne.length>0){const te=Eh(ne,L.videoCodecs).map(pe=>pe.payloadType),ce=[...ne.map(pe=>pe.payloadType),...te];L.videoCodecs=L.videoCodecs.filter(pe=>!Ve(ce).call(ce,pe.payloadType))}se("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(te=>{var ce,pe;return!(((ce=te.rtpMap)===null||ce===void 0?void 0:ce.encodingName.toLocaleLowerCase())==="h264"&&((pe=te.fmtp)===null||pe===void 0?void 0:pe.parameters["profile-level-id"])!==se("FIRST_H264_PROFILE_LEVEL_ID"))}))}return{send:I,recv:L,sendrecv:H}}return{send:I,recv:L,sendrecv:H}}(r,a,l);try{s.close()}catch{}return{send:d,recv:f,sendrecv:m}}function IK(){const r={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},a=wb(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},d={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(bc(r,a,"videoExtensions",s,l,d),bc(r,a,"videoCodecs",s,l,d),bc(r,a,"audioExtensions",s,l,d),bc(r,a,"audioCodecs",s,l,d),se("RAISE_H264_BASELINE_PRIORITY")){const f=d.videoCodecs.findIndex(m=>m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&m.fmtp&&m.fmtp.parameters["profile-level-id"]==="42001f");if(f!==-1){const m=d.videoCodecs.findIndex(y=>y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(m<f){F.debug("raising H264 baseline profile priority");const y=d.videoCodecs[f];d.videoCodecs.splice(f,1),d.videoCodecs.splice(m,0,y)}m!==-1&&(l.videoCodecs=l.videoCodecs.filter(y=>!(y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&y.fmtp&&y.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:s,recv:l,sendrecv:d}}function bc(r,a,s,l,d,f){if(s==="videoExtensions"||s==="audioExtensions"){const m=[];return r[s].forEach(y=>{a[s].some((_,w)=>{if(y.entry===_.entry&&y.extensionName===_.extensionName)return m.push(w),!0})?f[s].push(y):l[s].push(y)}),void a[s].forEach((y,_)=>{m.indexOf(_)===-1&&d[s].push(y)})}if(s==="videoCodecs"||s==="audioCodecs"){const m=[];return r[s].forEach(y=>{a[s].some((_,w)=>{if(y.payloadType===_.payloadType&&JSON.stringify(y)===JSON.stringify(_))return m.push(w),!0})?f[s].push(y):l[s].push(y)}),void a[s].forEach((y,_)=>{m.indexOf(_)===-1&&d[s].push(y)})}}function ET(r){const{send:a,recv:s,sendrecv:l}=r;if(!l){if(!a||!s)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:a,recv:s}}let d,f;return a?(d={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},d.audioCodecs=[...a.audioCodecs,...l.audioCodecs],d.videoCodecs=[...a.videoCodecs,...l.videoCodecs],d.audioExtensions=[...a.audioExtensions,...l.audioExtensions],d.videoExtensions=[...a.videoExtensions,...l.videoExtensions]):d=l,s?(f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f.audioCodecs=[...s.audioCodecs,...l.audioCodecs],f.videoCodecs=[...s.videoCodecs,...l.videoCodecs],f.audioExtensions=[...s.audioExtensions,...l.audioExtensions],f.videoExtensions=[...s.videoExtensions,...l.videoExtensions]):f=l,{send:d,recv:f}}function $g(r){r.media.mediaType==="audio"&&r.attributes.payloads.filter(a=>{var s;return((s=a.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase())==="opus"}).forEach(a=>{a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters.stereo="1",a.fmtp.parameters["sprop-stereo"]="1"})}function xb(r,a,s,l){let d=[];if(r===Ye.VIDEO){if(se("H264_PROFILE_LEVEL_ID")&&l==="h264"&&(d=a.videoCodecs.filter(f=>{var m;return Ve(m=f.rtpMap&&f.rtpMap.encodingName.toLowerCase()||"").call(m,l)&&f&&f.fmtp&&f.fmtp.parameters["profile-level-id"]===se("H264_PROFILE_LEVEL_ID")})),!Array.isArray(d)||d.length===0){let f=[];const m=[],y=[],_=[];if(s.videoCodecs.forEach(w=>{const x=w.rtpMap&&w.rtpMap.encodingName.toLowerCase()||"";Ve(x).call(x,l)?f.push(w):Ve(x).call(x,"vp9")?m.push(w):Ve(x).call(x,"vp8")?y.push(w):Ve(x).call(x,"h264")&&_.push(w)}),f.length===0){let w="";m.length!==0?(f=m,w="vp9"):y.length!==0?(f=y,w="vp8"):_.length!==0&&(f=_,w="h264"),F.warning("codec ".concat(l," not included in rtpCapabilities, fallback to default payloads: ").concat(w))}f.length!==0&&(d=a.videoCodecs.filter(w=>f.some(x=>x.payloadType===w.payloadType)))}if(d.length===0&&(F.warning("codec ".concat(l," not included in rtpCapabilities, fallback to default payloads: ").concat(a.videoCodecs[0].rtpMap&&a.videoCodecs[0].rtpMap.encodingName)),d=a.videoCodecs),se("USE_PUB_RTX")||se("USE_SUB_RTX")){const f=Eh(d,a.videoCodecs);d=[...d,...f]}}else{d=a.audioCodecs.filter(m=>{var y;return Ve(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,l)});const f=a.audioCodecs.filter(m=>{var y;return Ve(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,"red")});d.length===0&&(F.warning("codec ".concat(l," not included in rtpCapabilities, fallback to opus")),d=a.audioCodecs.filter(m=>{var y;return Ve(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,"opus")})),se("ENABLE_AUDIO_RED")&&f.length!==0&&(d=[...f,...d])}return d}function Eh(r,a){const s=r.map(l=>l.payloadType.toString());return a.filter(l=>l.rtpMap&&l.rtpMap.encodingName==="rtx"&&l.fmtp&&l.fmtp.parameters.apt&&Ve(s).call(s,l.fmtp&&l.fmtp.parameters.apt))}async function wh(r,a,s){const l=a.toString(),d=PK(l,"offer","remote","exchangeSDP");await r.setRemoteDescription({type:"offer",sdp:l});const f=await r.createAnswer();if(!f.sdp)throw new Error("cannot get answer sdp");let m=f.sdp;m=OK(m,s||{}),d==null||d(m||""),await r.setLocalDescription({type:"answer",sdp:m})}function OK(r,a,s){const l=ss(r),{useXR:d}=a;return l.mediaDescriptions.forEach(f=>{var m;f.attributes.mid&&(Array.isArray(s)&&!Ve(s).call(s,f.attributes.mid)||(f.media.mediaType==="audio"&&$g(f),d&&Ve(m=["audio","video"]).call(m,f.media.mediaType)&&f.attributes.payloads.forEach(y=>{y.rtcpFeedbacks.findIndex(_=>_.type==="rrtr")===-1&&y.rtcpFeedbacks.push({type:"rrtr"})})))}),ph(l)}function PK(r,a,s,l){if(se("SDP_LOGGING"))return F.upload("exchanging ".concat(s," ").concat(a," SDP during P2PConnection.").concat(l,`
`),r),a==="offer"?d=>{PK(d,"answer",s==="local"?"remote":"local",l)}:void 0}function kK(r){const a=se("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(a)&&a.length>0)&&a.some(s=>Ve(r).call(r,s))}function jK(r,a){try{var s;return((s=r.fmtp)===null||s===void 0?void 0:s.parameters.apt)===a.payloadType.toString()}catch{return!1}}function DK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ao(r,a){return typeof se(r)===a?se(r):void 0}function oOe(){try{const r=se("EXPERIMENTS")||{};return typeof r=="string"||Array.isArray(r)?{}:function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?DK(Object(l),!0).forEach(function(d){Z(a,d,l[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(l)):DK(Object(l)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(l,d))})}return a}({},r)}catch(r){return F.debug("handle gateway attributes failed: ",r),{}}}const LK={};function Sh(r){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&F.debug("install service ".concat(r.name)),LK[r.name]=r}function ld(r){const a=LK[r];if(!a)throw new Se(ie.INVALID_OPERATION,"".concat(r," not found, please use AgoraRTC.use(").concat(r,"Service) to load it first"));return a}function MK(r,a){return ld("DataStream").create(r,a)}function wT(){return ld("InterceptFrame").create()}function UK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ca(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?UK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):UK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const vD=new Map;class cOe extends lr{get state(){return this._state}set state(a){if(a===this._state)return;const s=this._state;this._state=a,a==="DISCONNECTED"&&this._disconnectedReason?this.emit(vi.CONNECTION_STATE_CHANGE,a,s,this._disconnectedReason):this.emit(vi.CONNECTION_STATE_CHANGE,a,s)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(a){F.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(a)),this._joinGatewayStartTime=a}constructor(a,s){var l,d,f;super(),Z(this,"store",void 0),Z(this,"joinInfo",void 0),Z(this,"key",void 0),Z(this,"ntpOffset",0),Z(this,"signal",void 0),Z(this,"role",void 0),Z(this,"isPreallocation",void 0),Z(this,"isPreSub",void 0),Z(this,"inChannelInfo",{joinAt:null,duration:0}),Z(this,"spec",void 0),Z(this,"_state","DISCONNECTED"),Z(this,"_statsCollector",void 0),Z(this,"_disconnectedReason",void 0),Z(this,"isSignalRecover",!1),Z(this,"hasChangeBGPAddress",!1),Z(this,"trafficStatsInterval",void 0),Z(this,"networkQualityInterval",void 0),Z(this,"_joinGatewayStartTime",0),Z(this,"_signalTimeout",!1),Z(this,"_clientRoleOptions",void 0),Z(this,"_isProactiveJoin",!1),this.store=a,this.spec=s,this.signal=this.store.useP2P?(l={spec:ca(ca({},s),{},{retryConfig:s.websocketRetryConfig}),store:a},(d=(f=ld("P2PChannel")).createSubmodule)===null||d===void 0?void 0:d.call(f,l)):new aOe(ca(ca({},s),{},{retryConfig:s.websocketRetryConfig}),a),this._statsCollector=s.statsCollector,this.role=s.role||"audience",this._clientRoleOptions=s.clientRoleOptions,this.handleSignalEvents()}async join(a,s,l){this.store.joinGatewayStart(),a.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const d=Date.now();let f=vD.get(a.cname);if(f||(f=new Map,vD.set(a.cname,f)),this._isProactiveJoin=!0,f.has(a.uid)){const w=new Ee(ie.UID_CONFLICT);throw nt.joinGateway(a.sid,{lts:d,succ:!1,ec:w.code,addr:null,uid:a.uid,cid:a.cid,firstSuccess:this._isProactiveJoin,isProxy:!!a.proxyServer,signalChannel:"0",preload:a.preload}),w}f.set(a.uid,!0),this.joinInfo=a,this.key=s;let m=0;this.joinGatewayStartTime=d;const y=a.proxyServer;try{F.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(m));const w=a.gatewayAddrs.map(x=>{let{address:A}=x;const[I,L]=A.split(":"),H={host:I,port:L};return a.proxyServer&&(H.proxy=a.proxyServer),H});m=(await this.signal.init(w)).uid,F.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(m," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(w){var _;throw F.error("[".concat(this.store.clientId,"] User join failed"),w.toString()),nt.joinGateway(a.sid,{lts:d,succ:!1,ec:((_=w.data)===null||_===void 0?void 0:_.desc)||w.code,errorMsg:w.message,addr:this.signal.url,uid:a.uid,cid:a.cid,firstSuccess:this._isProactiveJoin,isProxy:!!y,signalChannel:"0",preload:a.preload}),f.delete(a.uid),this.signal.close(),w}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),F.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(w=>{F.warning("[".concat(this.store.clientId,"] get traffic stats error"),w.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(vi.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(vi.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(vi.NETWORK_QUALITY,{uplinkNetworkQuality:yK(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:yK(this._statsCollector.trafficStats.B_dnq)}):this.emit(vi.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),m}async leave(){let a=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){s!==En.FALLBACK&&(this.state="DISCONNECTING");try{a||this.signal.connectionState!==$n.CONNECTED||await function(l,d){return d===1/0?l:Ge.race([l,k1e(d)])}(this.signal.request(Ct.LEAVE,void 0,!0),3e3)}catch(l){F.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),l)}this.signal.close(s),s!==En.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const d={state:"offer",p2p_id:this.store.p2pId,ortc:s,mode:this.spec.mode,extend:se("PUB_EXTEND"),twcc:!!se("PUBLISH_TWCC"),rtx:!!se("USE_PUB_RTX")};try{return(await this.signal.request(Ct.PUBLISH,d,!0))._message}catch(f){if(l&&f.data&&f.data.code===yt.ERR_PUBLISH_REQUEST_INVALID)return F.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),f.toString()),await this.tryUnpubBeforeRepub(a,s),this.publish(a,s,!1);throw f}}async publishDataChannel(a,s,l){var d;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const f={stream_id:s.streamId,ordered:s.ordered?1:0,max_retrans_times:(d=s.maxRetransmits)!==null&&d!==void 0?d:10,channel_id:s.channelId,metadata:s.metadata};try{await this.signal.request(Ct.PUBLISH_DATASTREAM,f,!0)}catch(m){if(l&&m.data&&m.data.code===yt.ERR_PUBLISH_REQUEST_INVALID)return F.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),m.toString()),await this.tryUnpubDataChannelBeforeRepub(a,s),this.publishDataChannel(a,s,!1);throw m}}async unpublish(a,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Ct.UNPUBLISH,{stream_id:s,ortc:a},!0)}catch(l){F.warning("[".concat(this.store.clientId,"] unpublish warning: "),l)}}async unpublishDataChannel(a){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ge.all(a.map(s=>this.signal.request(Ct.UNPUBLISH_DATASTREAM,{channel_id:s},!0)))}catch(s){F.warning("unpublish datachannels warning: ",s)}}async presubscribe(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const d={stream_id:a,stream_type:s,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!se("SUBSCRIBE_TWCC"),rtx:!!se("USE_SUB_RTX")||void 0,extend:se("SUB_EXTEND"),svc:Array.isArray(se("SVC"))&&se("SVC").length!==0?se("SVC"):void 0};try{return await this.signal.request(Ct.PRE_SUBSCRIBE,d,!0)}catch(f){if(l&&f.data&&f.data.code===yt.ERR_SUBSCRIBE_REQUEST_INVALID)return F.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),f.toString()),this.presubscribe(a,s,!1);throw f}}async subscribe(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const d={stream_id:a,stream_type:s.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!se("SUBSCRIBE_TWCC"),rtx:!!se("USE_SUB_RTX"),extend:se("SUB_EXTEND"),ssrcId:s.ssrcId,svc:Array.isArray(se("SVC"))&&se("SVC").length!==0?se("SVC"):void 0};try{return(await this.signal.request(Ct.SUBSCRIBE,d,!0))._message}catch(f){if(l&&f.data&&f.data.code===yt.ERR_SUBSCRIBE_REQUEST_INVALID)return F.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),f.toString()),await this.tryUnsubBeforeResub(a,s),await this.subscribe(a,s,!1);throw f}}async subscribeDataChannel(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const d={uid:a,stream_id:s.id,channel_id:s.datachannelId};try{return void await this.signal.request(Ct.SUBSCRIBE_DATASTREAM,d,!0)}catch(f){if(l&&f.data&&f.data.code===yt.ERR_SUBSCRIBE_REQUEST_INVALID)return F.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),f.toString()),await this.tryUnsubDataChannelBeforeResub(a,s),await this.subscribeDataChannel(a,s,!1);throw f}}async subscribeAll(a,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const l={p2p_id:this.store.p2pId,users:a,dtx:!1,rtx:!!se("USE_SUB_RTX"),twcc:!!se("SUBSCRIBE_TWCC"),svc:Array.isArray(se("SVC"))&&se("SVC").length!==0?se("SVC"):void 0};try{return await this.signal.request(Ct.SUBSCRIBE_STREAMS,l,!0)}catch(d){if(s&&d.data&&d.data.code===yt.ERR_SUBSCRIBE_REQUEST_INVALID)return F.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),d.toString()),await this.tryMassUnsubBeforeResub(a),await this.subscribeAll(a,!1);throw d}}async setVideoProfile(a){const s=function(l){if(!(l.bitrateMax&&l.bitrateMin&&l.frameRate&&l.height&&l.width))return;let d=l.frameRate,f=l.width,m=l.height,y=!0;return typeof d!="number"&&(d=d.exact||d.ideal||d.max||d.min||0,d||(y=!1)),typeof f!="number"&&(f=f.exact||f.ideal||f.max||f.min||0,f||(y=!1)),typeof m!="number"&&(m=m.exact||m.ideal||m.max||m.min||0,d||(y=!1)),y?{stream_type:0,width:f,height:m,fps:d,start_bps:1e3*l.bitrateMax,min_bps:1e3*l.bitrateMin,target_bps:1e3*l.bitrateMax}:void 0}(a);if(s)return this.signal.request(Ct.SET_VIDEO_PROFILE,s);F.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(a,s){try{await this.signal.request(Ct.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:a,stream_id:s},!0)}catch(l){F.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),l)}}async unsubscribeDataChannel(a,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ge.all(a.map(l=>this.signal.request(Ct.UNSUBSCRIBE_DATASTREAM,{stream_id:l,uid:s},!0)))}catch(l){F.warning("unsubscribeDataChannel warning: ",l)}}async massUnsubscribe(a){try{await this.signal.request(Ct.UNSUBSCRIBE_STREAMS,a,!0)}catch(s){F.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),s)}}async reconnectPC(a){const{iceParameters:s,dtlsParameters:l,rtpCapabilities:d}=a;return{gatewayEstablishParams:await this.signal.request(Ct.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:s,dtlsParameters:l,rtpCapabilities:d}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(Ct.GATEWAY_INFO)}async renewToken(a){await this.signal.request(Ct.RENEW_TOKEN,a),this.key=a.token}updateClientRole(a,s){s&&(this._clientRoleOptions=Object.assign({},s)),se("CLIENT_ROLE_OPTIONS")&&(F.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(se("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},se("CLIENT_ROLE_OPTIONS"))),this.role=a}async setClientRole(a,s){if(s&&(this._clientRoleOptions=Object.assign({},s)),se("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},se("CLIENT_ROLE_OPTIONS")),F.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(se("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=a);let l,d=0;a==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(l=this._clientRoleOptions.delay,d=1):d=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:d=0;const f=Object.assign({},s);delete f.delay,delete f.level,await this.signal.request(Ct.SET_CLIENT_ROLE,ca(ca({role:a,level:d,delay:l},f),{},{client_ts:Date.now()})),this.role=a}async setRemoteVideoStreamType(a,s){await this.signal.request(Ct.SWITCH_VIDEO_STREAM,{stream_id:a,stream_type:s})}async setDefaultRemoteVideoStreamType(a){await this.signal.request(Ct.DEFAULT_VIDEO_STREAM,{stream_type:a})}async setStreamFallbackOption(a,s){await this.signal.request(Ct.SET_FALLBACK_OPTION,{stream_id:a,fallback_type:s})}async pickSVCLayer(a,s){await this.signal.request(Ct.PICK_SVC_LAYER,{stream_id:a,spatial_layer:s.spatialLayer,temporal_layer:s.temporalLayer})}async setRTM2Flag(a){await this.signal.request(Ct.SET_RTM2_FLAG,{rtm2_flag:a})}async sendExtensionMessage(a,s,l){if(this.store.useP2P)return this.signal.sendExtensionMessage(a,s,l)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),ca({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Ct.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const a=vD.get(this.joinInfo.cname);a&&a.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const a=function(s){let l;return l=s.startsWith("dc")?s.match(/(dc\:\/\/)?([^:]+):(\d+)/):s.match(/(wss\:\/\/)?([^:]+):(\d+)/),l?{username:Mi.username,password:Mi.password,turnServerURL:l[2],tcpport:parseInt(l[3])+30,udpport:parseInt(l[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],a&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(ca(ca({},Mi),{},{turnServerURL:a.turnServerURL,tcpport:a.tcpport,udpport:a.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const a=await this.signal.request(Ct.TRAFFIC_STATS,void 0,!0);a.timestamp=Date.now(),a.ntp_offset!=null&&(this.ntpOffset=a.ntp_offset),a.peer_delay.forEach(s=>{const l=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(d=>d.peer_uid===s.peer_uid);l&&l.B_st!==s.B_st&&Bx(()=>{this.emit(vi.STREAM_TYPE_CHANGE,s.peer_uid,s.B_st)})}),this._statsCollector.updateTrafficStats(a)}getJoinMessage(a){var s,l;if(!this.joinInfo||!this.key)throw new Ee(ie.UNEXPECTED_ERROR,"can not generate join message, no join info");const d=Object.assign({},this.joinInfo.apResponse);let f=se("REPORT_APP_SCENARIO");if(typeof f!="string")try{f=JSON.stringify(f)}catch{f=void 0}var m;f&&f.length>128&&(f=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(vi.UPDATE_GATEWAY_CONFIG),m=this.store.clientId,Ve(Dg).call(Dg,m)||Dg.push(m);const y=Pj(this.store),_=!((s=this.isPreallocation)===null||s===void 0||!s.call(this)),w=Bz(this.store),x=oOe(),A=gg(87)||XH()||sj(117),I=(function(){const H=sn();if(H.name!==pn.SAFARI||!H.browserVersion)return!1;const $=H.browserVersion.split(".");return Number($[0])>18||Number($[0])===18&&Number($[1])>=4}()||ez(18,4,!1))&&oj(18,6,!0)&&this.spec.codec==="h264"&&se("ENABLE_ABSSENDTIME_AS_SENTTS"),L=ca({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Co,browser:navigator.userAgent,process_id:se("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:d,extend:se("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:f,attributes:{userAttributes:ca(ca({enableEncodedTransform:(!!se("ENABLE_AUDIO_METADATA")||!!se("ENABLE_AUDIO_PTS"))&&A||!!se("ENABLE_AUDIO_TOPN")&&ij(pn.CHROME,87,116)||void 0,enableAudioMetadata:!!se("ENABLE_AUDIO_METADATA")&&A,enableAudioPts:!!se("ENABLE_AUDIO_PTS")&&A,topnSmoothLevel:se("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:se("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:se("TOPN_SWITCH_HOLD_MS"),topnAudioGain:se("TOPN_AUDIO_GAIN"),enablePublishedUserList:se("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:se("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:ao("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:ao("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:ao("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:se("USE_PUB_RTX")===!0||se("USE_SUB_RTX")===!0||void 0,disableFEC:se("DISABLE_FEC"),enableNTPReport:!!se("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:w,enableFulllinkAvSync:!!se("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:ao("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!se("FORCE_ENABLE_AUT_CC")||!qx()&&(!!se("ENABLE_AUT_FEEDBACK")||void 0),rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!se("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:ao("USE_XR","boolean"),enableLossbasedBwe:ao("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!se("FORCE_ENABLE_AUT_CC")||!qx()&&(!!se("ENABLE_AUT_CC")||void 0),enableCCFallback:ao("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:_,preSubNum:y?ao("PRE_SUB_NUM","number"):void 0,enablePubTWCC:ao("PUBLISH_TWCC","boolean"),enableSubTWCC:ao("SUBSCRIBE_TWCC","boolean"),enablePubRTX:ao("USE_PUB_RTX","boolean"),enableSubRTX:ao("USE_SUB_RTX","boolean"),enableSubSVC:se("ENABLE_SVC")?se("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(se("SVC"))&&se("SVC").length!==0?se("SVC"):void 0,enableSvcExtended:se("ENABLE_SVC")&&Array.isArray(se("SVC_EXTENDED"))&&se("SVC_EXTENDED").length!==0?se("SVC_EXTENDED"):void 0},x),{},{audioDuplicate:ao("ENABLE_AUDIO_RED","boolean")?(l=ao("AUDIO_DUPLICATE_NUM","number"))!==null&&l!==void 0?l:2:void 0,senttsUsesAbsSendTime:!!I||void 0})},join_ts:this.joinGatewayStartTime},a);return this.joinInfo.stringUid&&(L.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(L.aes_mode=this.joinInfo.aesmode,se("ENCRYPT_AES")?(L.aes_secret=this.joinInfo.aespassword,L.aes_encrypt=!0):L.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(L.aes_salt=this.joinInfo.aessalt)),d.addresses[this.signal.websocket.currentURLIndex]&&(L.ap_response.ticket=d.addresses[this.signal.websocket.currentURLIndex].ticket,delete d.addresses),this.joinInfo.defaultVideoStream!==void 0&&(L.default_video_stream=this.joinInfo.defaultVideoStream),L}getRejoinMessage(){if(!this.joinInfo)throw new Ee(ie.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(It.WS_RECONNECT_CREATE_CONNECTION,a=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(It.WS_RECONNECTING,a=>{this.joinInfo&&nt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:a||Di.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",nt.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(It.WS_CLOSED,a=>{let s;switch(a){case En.LEAVE:s=Di.LEAVE;break;case En.UID_BANNED:case En.IP_BANNED:case En.CHANNEL_BANNED:case En.SERVER_ERROR:s=Di.SERVER_ERROR;break;case En.FALLBACK:s=Di.FALLBACK;break;case En.LICENSE_MISSING:case En.LICENSE_EXPIRED:case En.LICENSE_MINUTES_EXCEEDED:case En.LICENSE_PERIOD_INVALID:case En.LICENSE_MULTIPLE_SDK_SERVICE:case En.LICENSE_ILLEGAL:case En.TOKEN_EXPIRE:s=a;break;default:s=Di.NETWORK_ERROR}F.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(s||"undefined -> "+Di.NETWORK_ERROR)),this.joinInfo&&nt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:a===En.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:s}),this._disconnectedReason=a,a!==En.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(It.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const a=se("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;a&&(a.level||a.delay)&&(F.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(a.level,", delay: ").concat(a.delay)),this.setClientRole(this.role,a))}if(nt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const a=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!a)return void F.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(a));An("EVENT_REPORT_DOMAIN",a[1]),An("EVENT_REPORT_BACKUP_DOMAIN",a[1]),An("LOG_UPLOAD_SERVER","".concat(a[1],":6444"))}}}),this.signal.on(tn.ON_UPLINK_STATS,a=>{this._statsCollector.updateUplinkStats(a)}),this.signal.on(It.REQUEST_RECOVER,(a,s,l)=>{if(!this.joinInfo)return l(new Ee(ie.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));a&&(this.joinInfo.multiIP=a,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Li(this,vi.REQUEST_NEW_GATEWAY_LIST).then(s).catch(l)}),this.signal.on(It.REQUEST_JOIN_INFO,async(a,s,l)=>{var d,f,m;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void a(this.getJoinMessage({ortc:{}}));const y=ir((d=this.joinInfo)===null||d===void 0?void 0:d.turnServer);if(se("NEW_TURN_MODE")&&y&&((f=this.joinInfo)===null||f===void 0?void 0:f.cloudProxyServer)==="disabled"){var _;let I=y.servers.map($=>"turnServerURL"in $&&se("USE_TURN_IP")?ca(ca({},$),{},{turnServerURL:gT($.turnServerURL)}):$),L=(_=y.serversFromGateway)===null||_===void 0?void 0:_.map($=>se("USE_TURN_IP")?ca(ca({},$),{},{turnServerURL:gT($.turnServerURL)}):$);const H=this.signal.currentURLIndex;I.length>0&&(I=[I[H%I.length]],y.servers=I),Array.isArray(L)&&L.length>0&&(L=[L[0]],y.serversFromGateway=L),F.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(H))}const{iceParameters:w,dtlsParameters:x,rtpCapabilities:A}=await Li(this,vi.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:y,cloudProxyServer:(m=this.joinInfo)===null||m===void 0?void 0:m.cloudProxyServer});try{a(this.getJoinMessage({ortc:{iceParameters:w,dtlsParameters:x,rtpCapabilities:A,version:"2"}}))}catch(I){s(I)}}),this.signal.on(It.REQUEST_REJOIN_INFO,a=>{a(this.getRejoinMessage())}),this.signal.on(It.REPORT_JOIN_GATEWAY,(a,s)=>{if(!this.joinInfo)return;let l,d="";var f;a instanceof Ee?(l=((f=a.data)===null||f===void 0?void 0:f.desc)||a.code,d=a.message):l=a,nt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:l,errorMsg:d,addr:s,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(It.IS_P2P_DISCONNECTED,a=>{a(cb(this,vi.IS_P2P_DISCONNECTED))}),this.signal.on(It.DISCONNECT_P2P,()=>{this.emit(vi.DISCONNECT_P2P)}),this.signal.on(It.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(It.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(It.JOIN_RESPONSE,a=>{const s=this.getCurrentGatewayAddress();this.emit(vi.JOIN_RESPONSE,a,s)}),this.signal.on(It.PRE_CONNECT_PC,async()=>{if(this.joinInfo){var a,s;this.updateTurnConfigFromSignal();const d=this.getCurrentGatewayAddress(),f=ir((a=this.joinInfo)===null||a===void 0?void 0:a.turnServer);if(se("NEW_TURN_MODE")&&f&&((s=this.joinInfo)===null||s===void 0?void 0:s.cloudProxyServer)==="disabled"){var l;let y=f.servers.map(x=>"turnServerURL"in x&&se("USE_TURN_IP")?ca(ca({},x),{},{turnServerURL:gT(x.turnServerURL)}):x),_=(l=f.serversFromGateway)===null||l===void 0?void 0:l.map(x=>se("USE_TURN_IP")?ca(ca({},x),{},{turnServerURL:gT(x.turnServerURL)}):x);const w=this.signal.currentURLIndex;y.length>0&&(y=[y[w%y.length]],f.servers=y),Array.isArray(_)&&_.length>0&&(_=[_[0]],f.serversFromGateway=_),F.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(w,",in pre pc"))}const m=se("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(d&&m){const y=CK(d);this.emit(vi.PRE_CONNECT_PC,{candidates:y,fingerprint:m,turnServer:f})}}}),this.signal.on(It.RECOVER_NOTIFICATION,a=>{this.joinInfo&&typeof se("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(se("AP_REQUEST_DETAIL"),";").concat(a))})}async tryUnsubBeforeResub(a,s){try{await this.signal.request(Ct.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:a,ortc:[s]},!0)}catch(l){throw F.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),l),l}}async tryUnsubDataChannelBeforeResub(a,s){try{await this.signal.request(Ct.UNSUBSCRIBE,{stream_id:s.id},!0)}catch(l){throw F.warning("unsubscribe datachannel warning",l),l}}async tryUnpubBeforeRepub(a,s){try{await this.signal.request(Ct.UNPUBLISH,{stream_id:a,ortc:s},!0)}catch(l){throw F.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),l),l}}async tryUnpubDataChannelBeforeRepub(a,s){try{await this.signal.request(Ct.UNPUBLISH_DATASTREAM,{channnel_id:s.channelId},!0)}catch(l){throw F.warning("unpublish datastream warning: ",l),l}}async tryMassUnsubBeforeResub(a){const s={users:a.map(l=>({stream_id:l.stream_id,stream_type:l.stream_type}))};try{await this.signal.request(Ct.UNSUBSCRIBE_STREAMS,s,!0)}catch(l){throw F.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),l),l}}async muteLocal(a,s){const l={action:a.find(d=>d.stream_type===xn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:a,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw F.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),d),d}}async unmuteLocal(a,s){const l={action:a.find(d=>d.stream_type===xn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:a,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw F.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),d),d}}async muteRemote(a,s){const l={action:a===Ye.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw F.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),d),d}}async unmuteRemote(a,s){const l={action:a===Ye.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw F.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),d),d}}uploadWRTCStats(a){this.signal.uploadWRTCStats(a)}upload(a,s){this.signal.upload(a,s)}getSignalRTT(){return this.signal.rtt}async restartICE(a){const s={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:a};try{return await this.signal.request(Ct.RESTART_ICE,s,!0)}catch(l){throw F.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),l),l}}reconnect(a,s){this.state==="CONNECTED"&&this.signal.reconnect(a||void 0,s||Di.P2P_FAILED)}getCurrentGatewayAddress(){var a,s;if(!se("GATEWAY_WSS_ADDRESS"))return se("USE_CANDIDATE_FROM_AP_DETAIL")&&(a=this.joinInfo)!==null&&a!==void 0&&a.apGatewayAddress?(F.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(s=this.joinInfo)!==null&&s!==void 0&&s.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(a){await this.signal.request(Ct.SET_PARAMETER,{enablePublishAudioFilter:a})}downgradeCodec(a){this.signal.downgradeCodec(a)}}let ST=0,yD=0;function ll(r,a,s,l){return new Ge((d,f)=>{a.timeout=a.timeout||se("HTTP_CONNECT_TIMEOUT"),a.responseType=a.responseType||"json",a.data&&!s?(a.data=JSON.stringify(a.data),ST+=tu(a.data)):s&&(a.data.size?ST+=a.data.size:a.data instanceof FormData?ST+=gz(a.data):ST+=tu(JSON.stringify(a.data))),a.headers=a.headers||{},a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.method="POST",a.url=r,Ka.request(a).then(m=>{typeof m.data=="string"?yD+=tu(m.data):m.data instanceof ArrayBuffer||m.data instanceof Uint8Array?yD+=m.data.byteLength:yD+=tu(JSON.stringify(m.data)),l&&d({data:m.data,headers:m.headers}),d(m.data)}).catch(m=>{Ka.isCancel(m)?f(new Ee(ie.OPERATION_ABORTED,"cancel token canceled")):m.code==="ECONNABORTED"?f(new Ee(ie.NETWORK_TIMEOUT,m.message)):m.response?f(new Ee(ie.NETWORK_RESPONSE_ERROR,m.response.status)):f(new Ee(ie.NETWORK_ERROR,m.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var r;function a(Re){var Fe=0;return function(){return Fe<Re.length?{done:!1,value:Re[Fe++]}:{done:!0}}}var s=typeof Object.defineProperties=="function"?Object.defineProperty:function(Re,Fe,Xe){return Re==Array.prototype||Re==Object.prototype||(Re[Fe]=Xe.value),Re},l,d=function(Re){Re=[typeof globalThis=="object"&&globalThis,Re,typeof window=="object"&&window,typeof self=="object"&&self,typeof i=="object"&&i];for(var Fe=0;Fe<Re.length;++Fe){var Xe=Re[Fe];if(Xe&&Xe.Math==Math)return Xe}throw Error("Cannot find global object")}(this);function f(Re,Fe){if(Fe)e:{var Xe=d;Re=Re.split(".");for(var Oe=0;Oe<Re.length-1;Oe++){var B=Re[Oe];if(!(B in Xe))break e;Xe=Xe[B]}(Fe=Fe(Oe=Xe[Re=Re[Re.length-1]]))!=Oe&&Fe!=null&&s(Xe,Re,{configurable:!0,writable:!0,value:Fe})}}function m(Re){return(Re={next:Re})[Symbol.iterator]=function(){return this},Re}function y(Re){var Fe=typeof Symbol<"u"&&Symbol.iterator&&Re[Symbol.iterator];return Fe?Fe.call(Re):{next:a(Re)}}if(f("Symbol",function(Re){function Fe(B,le){this.A=B,s(this,"description",{configurable:!0,writable:!0,value:le})}if(Re)return Re;Fe.prototype.toString=function(){return this.A};var Xe="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Oe=0;return function B(le){if(this instanceof B)throw new TypeError("Symbol is not a constructor");return new Fe(Xe+(le||"")+"_"+Oe++,le)}}),f("Symbol.iterator",function(Re){if(Re)return Re;Re=Symbol("Symbol.iterator");for(var Fe="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Xe=0;Xe<Fe.length;Xe++){var Oe=d[Fe[Xe]];typeof Oe=="function"&&typeof Oe.prototype[Re]!="function"&&s(Oe.prototype,Re,{configurable:!0,writable:!0,value:function(){return m(a(this))}})}return Re}),typeof Object.setPrototypeOf=="function")l=Object.setPrototypeOf;else{var _;e:{var w={};try{w.__proto__={a:!0},_=w.a;break e}catch{}_=!1}l=_?function(Re,Fe){if(Re.__proto__=Fe,Re.__proto__!==Fe)throw new TypeError(Re+" is not extensible");return Re}:null}var x=l;function A(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function I(Re){if(Re.m)throw new TypeError("Generator is already running");Re.m=!0}function L(Re,Fe){return Re.h=3,{value:Fe}}function H(Re){this.g=new A,this.G=Re}function $(Re,Fe,Xe,Oe){try{var B=Fe.call(Re.g.j,Xe);if(!(B instanceof Object))throw new TypeError("Iterator result "+B+" is not an object");if(!B.done)return Re.g.m=!1,B;var le=B.value}catch(he){return Re.g.j=null,Re.g.s(he),G(Re)}return Re.g.j=null,Oe.call(Re.g,le),G(Re)}function G(Re){for(;Re.g.h;)try{var Fe=Re.G(Re.g);if(Fe)return Re.g.m=!1,{value:Fe.value,done:!1}}catch(Xe){Re.g.v=void 0,Re.g.s(Xe)}if(Re.g.m=!1,Re.g.l){if(Fe=Re.g.l,Re.g.l=null,Fe.F)throw Fe.D;return{value:Fe.return,done:!0}}return{value:void 0,done:!0}}function ne(Re){this.next=function(Fe){return Re.o(Fe)},this.throw=function(Fe){return Re.s(Fe)},this.return=function(Fe){return function(Xe,Oe){I(Xe.g);var B=Xe.g.j;return B?$(Xe,"return"in B?B.return:function(le){return{value:le,done:!0}},Oe,Xe.g.return):(Xe.g.return(Oe),G(Xe))}(Re,Fe)},this[Symbol.iterator]=function(){return this}}function te(Re,Fe){return Fe=new ne(new H(Fe)),x&&Re.prototype&&x(Fe,Re.prototype),Fe}if(A.prototype.o=function(Re){this.v=Re},A.prototype.s=function(Re){this.l={D:Re,F:!0},this.h=this.C||this.u},A.prototype.return=function(Re){this.l={return:Re},this.h=this.u},H.prototype.o=function(Re){return I(this.g),this.g.j?$(this,this.g.j.next,Re,this.g.o):(this.g.o(Re),G(this))},H.prototype.s=function(Re){return I(this.g),this.g.j?$(this,this.g.j.throw,Re,this.g.o):(this.g.s(Re),G(this))},f("Array.prototype.entries",function(Re){return Re||function(){return function(Fe,Xe){Fe instanceof String&&(Fe+="");var Oe=0,B=!1,le={next:function(){if(!B&&Oe<Fe.length){var he=Oe++;return{value:Xe(he,Fe[he]),done:!1}}return B=!0,{done:!0,value:void 0}}};return le[Symbol.iterator]=function(){return le},le}(this,function(Fe,Xe){return[Fe,Xe]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var ce=function(Re,Fe){for(var Xe=0;Xe<Re.length;Xe++)Fe(Re[Xe])},pe=function(Re){return Re.replace(/\r?\n|\r/g,`\r
`)},fe=function(Re,Fe,Xe){return Fe instanceof Blob?(Xe=Xe!==void 0?Xe+"":typeof Fe.name=="string"?Fe.name:"blob",Fe.name===Xe&&Object.prototype.toString.call(Fe)!=="[object Blob]"||(Fe=new File([Fe],Xe)),[String(Re),Fe]):[String(Re),String(Fe)]},ue=function(Re,Fe){if(Re.length<Fe)throw new TypeError(Fe+" argument required, but only "+Re.length+" present.")},ye=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,xe=ye.FormData,Ae=ye.XMLHttpRequest&&ye.XMLHttpRequest.prototype.send,Le=ye.Request&&ye.fetch,Ht=ye.navigator&&ye.navigator.sendBeacon,qt=ye.Element&&ye.Element.prototype,Rt=ye.Symbol&&Symbol.toStringTag;Rt&&(Blob.prototype[Rt]||(Blob.prototype[Rt]="Blob"),"File"in ye&&!File.prototype[Rt]&&(File.prototype[Rt]="File"));try{new File([],"")}catch{ye.File=function(Fe,Xe,Oe){return Fe=new Blob(Fe,Oe||{}),Object.defineProperties(Fe,{name:{value:Xe},lastModified:{value:+(Oe&&Oe.lastModified!==void 0?new Date(Oe.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Rt&&Object.defineProperty(Fe,Rt,{value:"File"}),Fe}}var bn=function(Re){return Re.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},yn=function(Re){this.i=[];var Fe=this;Re&&ce(Re.elements,function(Xe){if(Xe.name&&!Xe.disabled&&Xe.type!=="submit"&&Xe.type!=="button"&&!Xe.matches("form fieldset[disabled] *"))if(Xe.type==="file"){var Oe=Xe.files&&Xe.files.length?Xe.files:[new File([],"",{type:"application/octet-stream"})];ce(Oe,function(B){Fe.append(Xe.name,B)})}else Xe.type==="select-multiple"||Xe.type==="select-one"?ce(Xe.options,function(B){!B.disabled&&B.selected&&Fe.append(Xe.name,B.value)}):Xe.type==="checkbox"||Xe.type==="radio"?Xe.checked&&Fe.append(Xe.name,Xe.value):(Oe=Xe.type==="textarea"?pe(Xe.value):Xe.value,Fe.append(Xe.name,Oe))})};if((r=yn.prototype).append=function(Re,Fe,Xe){ue(arguments,2),this.i.push(fe(Re,Fe,Xe))},r.delete=function(Re){ue(arguments,1);var Fe=[];Re=String(Re),ce(this.i,function(Xe){Xe[0]!==Re&&Fe.push(Xe)}),this.i=Fe},r.entries=function Re(){var Fe,Xe=this;return te(Re,function(Oe){if(Oe.h==1&&(Fe=0),Oe.h!=3)return Fe<Xe.i.length?Oe=L(Oe,Xe.i[Fe]):(Oe.h=0,Oe=void 0),Oe;Fe++,Oe.h=2})},r.forEach=function(Re,Fe){ue(arguments,1);for(var Xe=y(this),Oe=Xe.next();!Oe.done;Oe=Xe.next()){var B=y(Oe.value);Oe=B.next().value,B=B.next().value,Re.call(Fe,B,Oe,this)}},r.get=function(Re){ue(arguments,1);var Fe=this.i;Re=String(Re);for(var Xe=0;Xe<Fe.length;Xe++)if(Fe[Xe][0]===Re)return Fe[Xe][1];return null},r.getAll=function(Re){ue(arguments,1);var Fe=[];return Re=String(Re),ce(this.i,function(Xe){Xe[0]===Re&&Fe.push(Xe[1])}),Fe},r.has=function(Re){ue(arguments,1),Re=String(Re);for(var Fe=0;Fe<this.i.length;Fe++)if(this.i[Fe][0]===Re)return!0;return!1},r.keys=function Re(){var Fe,Xe,Oe,B,le=this;return te(Re,function(he){if(he.h==1&&(Fe=y(le),Xe=Fe.next()),he.h!=3)return Xe.done?void(he.h=0):(Oe=Xe.value,B=y(Oe),L(he,B.next().value));Xe=Fe.next(),he.h=2})},r.set=function(Re,Fe,Xe){ue(arguments,2),Re=String(Re);var Oe=[],B=fe(Re,Fe,Xe),le=!0;ce(this.i,function(he){he[0]===Re?le&&(le=!Oe.push(B)):Oe.push(he)}),le&&Oe.push(B),this.i=Oe},r.values=function Re(){var Fe,Xe,Oe,B,le=this;return te(Re,function(he){if(he.h==1&&(Fe=y(le),Xe=Fe.next()),he.h!=3)return Xe.done?void(he.h=0):(Oe=Xe.value,(B=y(Oe)).next(),L(he,B.next().value));Xe=Fe.next(),he.h=2})},yn.prototype._asNative=function(){for(var Re=new xe,Fe=y(this),Xe=Fe.next();!Xe.done;Xe=Fe.next()){var Oe=y(Xe.value);Xe=Oe.next().value,Oe=Oe.next().value,Re.append(Xe,Oe)}return Re},yn.prototype._blob=function(){var Re="----formdata-polyfill-"+Math.random(),Fe=[],Xe="--"+Re+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(Oe,B){return typeof Oe=="string"?Fe.push(Xe+bn(pe(B))+`"\r
\r
`+pe(Oe)+`\r
`):Fe.push(Xe+bn(pe(B))+'"; filename="'+bn(Oe.name)+`"\r
Content-Type: `+(Oe.type||"application/octet-stream")+`\r
\r
`,Oe,`\r
`)}),Fe.push("--"+Re+"--"),new Blob(Fe,{type:"multipart/form-data; boundary="+Re})},yn.prototype[Symbol.iterator]=function(){return this.entries()},yn.prototype.toString=function(){return"[object FormData]"},qt&&!qt.matches&&(qt.matches=qt.matchesSelector||qt.mozMatchesSelector||qt.msMatchesSelector||qt.oMatchesSelector||qt.webkitMatchesSelector||function(Re){for(var Fe=(Re=(this.document||this.ownerDocument).querySelectorAll(Re)).length;0<=--Fe&&Re.item(Fe)!==this;);return-1<Fe}),Rt&&(yn.prototype[Rt]="FormData"),Ae){var Yi=ye.XMLHttpRequest.prototype.setRequestHeader;ye.XMLHttpRequest.prototype.setRequestHeader=function(Re,Fe){Yi.call(this,Re,Fe),Re.toLowerCase()==="content-type"&&(this.B=!0)},ye.XMLHttpRequest.prototype.send=function(Re){Re instanceof yn?(Re=Re._blob(),this.B||this.setRequestHeader("Content-Type",Re.type),Ae.call(this,Re)):Ae.call(this,Re)}}Le&&(ye.fetch=function(Re,Fe){return Fe&&Fe.body&&Fe.body instanceof yn&&(Fe.body=Fe.body._blob()),Le.call(this,Re,Fe)}),Ht&&(ye.navigator.sendBeacon=function(Re,Fe){return Fe instanceof yn&&(Fe=Fe._asNative()),Ht.call(this,Re,Fe)}),ye.FormData=yn}})();const Tb=()=>{const r=se("AREAS");return r.length===0&&r.push(_n.GLOBAL),sc(r).call(r,(a,s,l)=>{const d=FK(s);return d?l===0?d:"".concat(a,",").concat(d):a},"")},FK=r=>r===_n.OVERSEA?"".concat(zi.ASIA,",").concat(zi.EUROPE,",").concat(zi.AFRICA,",").concat(zi.NORTH_AMERICA,",").concat(zi.SOUTH_AMERICA,",").concat(zi.OCEANIA):zi[r],lOe=r=>{const a={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return r.map(s=>{const l=pT[s],d=Object.keys(l);d&&d.map(f=>{f!=="CODE"&&(a[f]=a[f].concat(l[f]))})}),a},xT={GLOBAL:{ASIA:[_n.CHINA,_n.JAPAN,_n.INDIA,_n.KOREA,_n.HKMC],EUROPE:[],NORTH_AMERICA:[_n.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},TT=Object.keys(xT[_n.GLOBAL]),_D=[_n.CHINA,_n.NORTH_AMERICA,_n.EUROPE,_n.ASIA,_n.JAPAN,_n.INDIA,_n.OCEANIA,_n.SOUTH_AMERICA,_n.AFRICA,_n.KOREA,_n.HKMC,_n.US],uOe=function(r,a){let s=[];if(Ve(r).call(r,_n.GLOBAL)){const f=[_n.GLOBAL,_n.OVERSEA],m=Object.keys(pT);if(a===_n.GLOBAL)throw new Ee(ie.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(a===_n.CHINA)s=[_n.OVERSEA];else if(d=a,Ve(TT).call(TT,d)){const y=(l=a,xT[_n.GLOBAL][l]||[]),_=[...f,a,...y];s=m.filter(w=>!Ve(_).call(_,w))}else if(function(y){let _=!1;return TT.forEach(w=>{var x;Ve(x=xT[_n.GLOBAL][w]).call(x,y)&&(_=!0)}),_}(a)){const y=function(w){let x;return TT.forEach(A=>{var I;Ve(I=xT[_n.GLOBAL][A]).call(I,w)&&(x=A)}),x}(a),_=[...f,y,a];s=m.filter(w=>!Ve(_).call(_,w))}else s=r;s=function(y){const _=[];return _D.forEach(w=>{Ve(y).call(y,w)&&_.push(w)}),_.concat(y.filter(w=>!Ve(_D).call(_D,w)))}(s)}else s=r;var l,d;return s};function VK(r){var a,s;if(!r&&Ve(a=se("AREAS")).call(a,_n.EXTENSIONS))return F.debug("update area from ap : reset"),void bD(yIe,!0);if(!Ve(s=se("AREAS")).call(s,_n.GLOBAL)||!r)return;let l=pT.EXTENSIONS;l&&(l={CODE:FK(_n.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(r,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(r,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(r,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(r,".agora.io"),"cds-ap-web-2-".concat(r,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(r,".agora.io"),"sua-ap-web-2-".concat(r,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(r,".agora.io"),"uap-ap-web-2-".concat(r,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(r,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(r,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(r,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(r,".agora.io")]},F.debug("update area from ap success: ".concat(r,",config is "),l),An("AREAS",[_n.EXTENSIONS],!0),Object.keys(l).map(d=>{d==="LOG_UPLOAD_SERVER"||d==="EVENT_REPORT_DOMAIN"||d==="EVENT_REPORT_BACKUP_DOMAIN"||d==="PROXY_SERVER_TYPE3"?An(d,l[d][0]):An(d,l[d])}))}function bD(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=nt.reportApiInvoke(null,{name:Er.SET_AREA,options:r,tag:rr.TRACER});try{let l=[];if(typeof r=="string"&&(l=[r]),Array.isArray(r)&&(r.forEach(f=>{if(!Ve(oK).call(oK,f))throw new Ee(ie.INVALID_PARAMS,"invalid area code")}),l=r),Object.prototype.toString.call(r)==="[object Object]"){const{areaCode:f,excludedArea:m}=r;if(!f)throw new Ee(ie.INVALID_PARAMS,"area code is needed");let y=f;typeof f=="string"&&(y=[f]),l=m?uOe(y,m):y}if(!a){if(al.AREAS){const f=new Ee(ie.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return s.onError(f),void F.warning("setArea is prohibited because of config-distribute")}if(Ve(l).call(l,_n.GLOBAL)&&se("AREAS")===_n.EXTENSIONS){const f=new Ee(ie.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return s.onError(f),void F.warning("setArea is prohibited because of ap extensions")}}An("AREAS",l,a);const d=lOe(l);Object.keys(d).map(f=>{f==="LOG_UPLOAD_SERVER"||f==="EVENT_REPORT_DOMAIN"||f==="EVENT_REPORT_BACKUP_DOMAIN"||f==="PROXY_SERVER_TYPE3"?An(f,d[f][0]):An(f,d[f])}),F.debug("set area success:",l.join(","))}catch(l){throw s.onError(l),l}s.onSuccess()}function BK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ou(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?BK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):BK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let ED=1;function dOe(r,a,s,l,d){ED+=1;const f={sid:s.sid,command:"convergeAllocateEdge",uid:"666",appId:s.appId,ts:Math.floor(Date.now()/1e3),seq:ED,requestId:ED,version:Co,cname:s.cname},m={service_name:a,json_body:JSON.stringify(f)};let y,_,w=r[0];return il(async()=>{y=Date.now();const x=await ll(w,{data:m,cancelToken:l,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_=Date.now()-y,x.code!==0){const L=new Ee(ie.UNEXPECTED_RESPONSE,"live streaming ap error, code"+x.code,{retry:!0,responseTime:_});throw F.error(L.toString()),L}const A=JSON.parse(x.json_body);if(A.code!==200){const L=new Ee(ie.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(A.code,", reason: ").concat(A.reason),{code:A.code,responseTime:_});throw F.error(L.toString()),L}if(!A.servers||A.servers.length===0){const L=new Ee(ie.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:A.code,responseTime:_});throw F.error(L.toString()),L}const I=function(L,H){return{addressList:L.servers.map($=>"wss://".concat($.address.replace(/\./g,"-"),".").concat(se("WORKER_DOMAIN"),":").concat($.wss,"?serviceName=").concat(encodeURIComponent(H))),workerToken:L.workerToken,vid:L.vid}}(A,a);return se("LIVE_STREAMING_ADDRESS")&&(I.addressList=se("LIVE_STREAMING_ADDRESS")instanceof Array?se("LIVE_STREAMING_ADDRESS"):[se("LIVE_STREAMING_ADDRESS")]),ou(ou({},I),{},{responseTime:_})},(x,A)=>(nt.apworkerEvent(s.sid,{success:!0,sc:200,serviceName:a,responseDetail:JSON.stringify(x.addressList),firstSuccess:A===0,responseTime:_,serverIp:r[A%r.length]}),!1),(x,A)=>(nt.apworkerEvent(s.sid,{success:!1,sc:x.data&&x.data.code||200,serviceName:a,responseTime:_,serverIp:r[A%r.length]}),!!(x.code!==ie.OPERATION_ABORTED&&x.code!==ie.UNEXPECTED_RESPONSE||x.data&&x.data.retry)&&(w=r[(A+1)%r.length],!0)),d)}let wD=1;function $K(r,a,s,l){let{url:d,areaCode:f}=r;const{clientId:m,sid:y}=a,_=Date.now();let w;const x=a.role,[A,I]=xD(a,f,[Lr.CHOOSE_SERVER]);let L=Dr.networkState;return il(async()=>{L&&Dr.networkState===Is.OFFLINE&&Dr.onlineWaiter&&await Ge.race([Dr.onlineWaiter,Ci(l&&l.maxRetryTimeout||Gr.maxRetryTimeout)]),L=Dr.networkState;const{data:H,headers:$}=await ll(d,{data:A,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);w=$.http3==="1"?1:-1,nt.reportResourceTiming(d,y),GK(H,d,a,_,[Lr.CHOOSE_SERVER],w);const G=Eb(H,Lr.CHOOSE_SERVER);return SD(G),fD(G,d)},H=>(H&&nt.joinChooseServer(y,{role:x,lts:_,succ:!0,csAddr:d,opid:I,serverList:H.gatewayAddrs.map($=>$.address),ec:null,cid:H.cid.toString(),uid:H.uid.toString(),csIp:H.csIp,unilbsServerIds:[Lr.CHOOSE_SERVER].toString(),isHttp3:w,corssRegionTagReq:a.apRequestDetail,corssRegionTagRes:H.res.detail&&H.res.detail[38]}),!1),H=>H.code!==ie.OPERATION_ABORTED&&(H.code===ie.CAN_NOT_GET_GATEWAY_SERVER?H.data.retry:(nt.joinChooseServer(y,{role:x,lts:_,succ:!1,csAddr:d,serverList:null,opid:I,ec:H.code,csIp:H.data&&H.data.csIp,unilbsServerIds:[Lr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:L}),isHttp3:w,corssRegionTagReq:a.apRequestDetail}),F.warning("[".concat(m||"sid-".concat(y.slice(0,6)),"] Choose server network error, retry"),H),!0)),l)}function WK(r,a,s,l){let d,{url:f,areaCode:m,serviceIds:y}=r;const _=Date.now(),w=a.role,[x,A]=xD(a,m,y);let I;return il(async()=>{I&&Dr.networkState===Is.OFFLINE&&Dr.onlineWaiter&&await Ge.race([Dr.onlineWaiter,Ci(l&&l.maxRetryTimeout||Gr.maxRetryTimeout)]),I=Dr.networkState;const{data:L,headers:H}=await ll(f,{data:x,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);d=H.http3==="1"?1:-1,nt.reportResourceTiming(f,a.sid),GK(L,f,a,_,y,d);const $=Eb(L,Lr.CHOOSE_SERVER),G=Eb(L,a.cloudProxyServer==="proxy5"?Lr.CLOUD_PROXY_5:a.cloudProxyServer==="proxy3"||a.cloudProxyServer==="proxy4"?Lr.CLOUD_PROXY:Lr.CLOUD_PROXY_FALLBACK),ne=performance.getEntriesByName(f),te=ne[ne.length-1];let ce;return te&&(ce={name:te.name,protocol:"nextHopProtocol"in te?te.nextHopProtocol:"",dnscost:"domainLookupEnd"in te&&"domainLookupStart"in te&&typeof te.domainLookupEnd=="number"&&typeof te.domainLookupStart=="number"?te.domainLookupEnd-te.domainLookupStart:-1,tcpTlsCost:"connectEnd"in te&&"connectStart"in te&&typeof te.connectEnd=="number"&&typeof te.connectStart=="number"?te.connectEnd-te.connectStart:-1,reqCost:"requestStart"in te&&typeof te.requestStart=="number"&&"responseEnd"in te&&typeof te.responseEnd=="number"?te.responseEnd-te.requestStart:-1,handleCost:"leave_ts"in L&&"enter_ts"in L&&typeof L.leave_ts=="number"&&typeof L.enter_ts=="number"?L.leave_ts-L.enter_ts:-1}),SD($),{gatewayInfo:fD($,f),proxyInfo:G,url:f,resourceTimingInfo:ce}},L=>(L.gatewayInfo&&nt.joinChooseServer(a.sid,{role:w,lts:_,succ:!0,csAddr:f,serverList:L.gatewayInfo.gatewayAddrs.map(H=>H.address),ec:null,opid:A,cid:L.gatewayInfo.cid.toString(),uid:L.gatewayInfo.uid.toString(),csIp:L.gatewayInfo.csIp,unilbsServerIds:y.toString(),isHttp3:d,corssRegionTagReq:a.apRequestDetail,corssRegionTagRes:L.gatewayInfo.res.detail&&L.gatewayInfo.res.detail[38],resourceTimingInfo:L.resourceTimingInfo?JSON.stringify(L.resourceTimingInfo):void 0}),L.proxyInfo&&nt.joinWebProxyAP(a.sid,{lts:_,sucess:1,apServerAddr:f,turnServerAddrList:L.proxyInfo.addresses.map(H=>H.ip).join(","),errorCode:null,eventType:a.cloudProxyServer,unilbsServerIds:y.toString()}),!1),L=>L.code!==ie.OPERATION_ABORTED&&(L.code===ie.CAN_NOT_GET_GATEWAY_SERVER?L.data.retry:(nt.joinWebProxyAP(a.sid,{lts:_,sucess:0,apServerAddr:f,turnServerAddrList:null,errorCode:L.code,eventType:a.cloudProxyServer,unilbsServerIds:y.toString(),extend:JSON.stringify({networkState:I})}),F.warning("[".concat(a.clientId,"] multi unilbs network error, retry"),L),!0)),l)}const GK=(r,a,s,l,d,f)=>{const{sid:m,clientId:y,cloudProxyServer:_}=s,w=[],x=A=>{A.flag===4096?nt.joinChooseServer(m,{role:s.role,lts:l,succ:!1,csAddr:a,opid:r.opid,serverList:null,ec:A.error.message,csIp:A.error.data&&A.error.data.csIp,unilbsServerIds:d.toString(),isHttp3:f,corssRegionTagReq:s.apRequestDetail}):A.flag!==1048576&&A.flag!==4194304&&A.flag!==4194310||nt.joinWebProxyAP(m,{lts:l,sucess:0,apServerAddr:a,turnServerAddrList:null,errorCode:A.error.code,eventType:_,unilbsServerIds:d.toString()})};if(r.response_body.forEach(A=>{const I=A.buffer.code;if(A.uri===23&&I===0&&!A.buffer.edges_services)if(A.buffer.flag===4194310)F.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),A.buffer.edges_services=[];else{const L={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:r.detail[502]}),flag:A.buffer.flag};w.push(L),x(L)}if(I!==0){const L=Fg(I),H={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,L.desc,{desc:L.desc,retry:L.retry,csIp:r.detail[502]}),flag:A.buffer.flag};A.buffer.flag===4194310?F.warning(H.error.toString()):w.push(H),x(H)}}),w.length)throw F.warning("[".concat(y||"sid-".concat(m.slice(0,6)),"] multi unilbs ").concat(a," failed, ").concat(w.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message,", retry: ").concat(A.error.data.retry)).join(" | "))),new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,w.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message)).join(" | "),{retry:!!w.find(A=>A.error.data.retry),csIp:r.detail[502],desc:[...new Set(w.map(A=>{var I;return A==null||(I=A.error)===null||I===void 0||(I=I.data)===null||I===void 0?void 0:I.desc}).filter(A=>!!A))]})},SD=r=>{var a,s,l,d;if(r.addresses&&r.addresses.length===0&&r.code===0)throw new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:r.detail&&r.detail[502]});if(se("AP_AREA")&&((l=r.detail)!==null&&l!==void 0&&l[23]&&typeof((d=r.detail)===null||d===void 0?void 0:d[23])=="string"?VK(r.detail[23].toLowerCase()):VK()),(a=r.detail)!==null&&a!==void 0&&a[19]&&typeof((s=r.detail)===null||s===void 0?void 0:s[19])=="string"){const m=r.detail[19],y=m==null?void 0:m.split(";");for(let _=0;_<y.length;_++){var f;const w=Ea(f=y[_]).call(f);r.addresses[_]&&y&&(r.addresses[_].fingerprint=w)}}if(se("GATEWAY_ADDRESS")&&se("GATEWAY_ADDRESS").length>0){F.debug("assign gateway address to",se("GATEWAY_ADDRESS"));const m=se("GATEWAY_ADDRESS").map(y=>{var _,w;const x=(_=(w=r.addresses.find(A=>A.ip===y.ip&&A.port===y.port))===null||w===void 0?void 0:w.fingerprint)!==null&&_!==void 0?_:"";return{ip:y.ip,port:y.port,ticket:r.addresses[0]&&r.addresses[0].ticket,fingerprint:x}});r.addresses=m}},hOe=(r,a)=>{if(r.response_body&&r.response_body.length){const s=r.response_body[0];if(s.buffer.code!==0){const l=Fg(s.buffer.code);throw new Ee(ie.UPDATE_TICKET_FAILED,"[".concat(s.buffer.code,"]: ").concat(l.desc),{retry:l.retry})}return s.buffer.ticket}throw F.debug("update ticket request received ap response without response body:",a),new Ee(ie.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},xD=(r,a,s)=>{const l=Math.floor(Math.random()*1e12),d=r.role==="host"?"1":r.role==="audience"?"2":void 0,f={appid:r.appId,client_ts:Date.now(),opid:l,sid:r.sid,request_bodies:[{uri:22,buffer:{cname:r.cname,detail:ou(ou(ou({6:r.stringUid,11:a,12:se("USE_NEW_TOKEN")?"1":void 0},d?{17:d}:{}),{},{22:a},r.apRequestDetail?{33:r.apRequestDetail}:{}),r.apRTM?{26:"RTM2"}:{}),key:r.token,service_ids:s,uid:r.uid||0}}]};f.request_bodies.forEach(y=>{r.multiIP&&r.multiIP.gateway_ip&&(y.buffer.detail[5]=JSON.stringify({vocs_ip:[r.multiIP.uni_lbs_ip],vos_ip:[r.multiIP.gateway_ip]}))});const m=new FormData;return m.append("request",JSON.stringify(f)),[m,l]},fOe=(r,a)=>{const s=Math.floor(Math.random()*1e12),l={appid:r.appId,client_ts:Date.now(),opid:s,sid:r.sid,request_bodies:[{uri:28,buffer:{cname:r.cname,detail:{1:"",6:r.stringUid,12:"1"},token:r.token,service_ids:a,uid:r.uid||0,edges_services:r.apResponse.addresses.map(f=>({ip:f.ip,port:f.port}))}}]},d=new FormData;return d.append("request",JSON.stringify(l)),[d,s]};let Wg=0;function Gg(r){return Ge.all(r.map(a=>a.then(s=>{throw s},s=>s))).then(a=>{throw a},a=>a)}const Cb=async r=>{let{fragementLength:a,referenceList:s,asyncMapHandler:l,allFailedhandler:d,promisesCollector:f}=r,m=0;const y=a;let _,w=0;const x=async()=>{const A=(()=>{const I=m*y,L=I+y;return s.slice(I,L).map(l)})();f&&f.push(...A);try{_=await Gg(A)}catch(I){if(w+=y,m++,!(w>=s.length))return void await x();d(I)}A.forEach(I=>I.cancel())};return await x(),_},HK=async r=>{let{referenceList:a,asyncMapHandler:s,closeFn:l}=r;const d=a.length;let f=0;const m=async()=>{const y=s(a.shift());try{return await y}catch(_){if(f++,f>=d||l!=null&&l(_))throw _;return m()}};return m()};async function pOe(){if(typeof VideoDecoder>"u")return!0;let r;const a=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,85,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,149,160,133,4,144,43,122,168,159,120,159,205,39,82,131,57,52,87,187,68,23,248,134,204,226,97,17,49,183,55,236,219,249,221,98,208,215,190,59,179,167,213,47,1,246,150,14,194,245,159,83,35,64,103,218,38,21,82,3,135,21,185,84,248,134],s=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,148,62,134,140,92,172,141,77,35,94,181,164,65,169,65,156,154,43,221,162,11,252,67,102,113,48,136,137,219,62,43,113,239,23,126,250,186,252,10,138,218,25,193,244,74,68,194,209,107,23,52,206,199,78,72,98,103,151,71,96,62,51,210,158,72,231,158],l=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,143,233,163,51,196,98,95,151,224,22,134,33,240,150,248,67,18,34,196,142,81,238,173,140,80,205,232,132,144,67,12,131,157,4,171,243,86,122,35,6,166,184,243,85,126,13,206,103,152,62,168,160,187,2,241,138,52,211,72,121,128,151,63,147,128,19,42],d=[18,0,50,138,1,48,192,64,253,248,65,17,67,192,32,0,16,0,0,0,0,0,0,0,195,12,48,144,64,32,0,209,75,61,9,204,25,115,79,226,115,63,63,208,70,210,220,153,126,241,237,37,107,195,153,1,99,112,230,189,209,169,130,10,11,22,167,215,159,205,197,7,183,162,26,48,254,141,134,103,32,16,235,45,1,15,18,119,169,110,206,251,51,115,202,60,148,1,46,39,109,25,28,86,168,15,77,211,239,2,58,43,146,26,230,184,81,48,140,226,226,250,222,146,171,133,164,13,188,180,64,122,142,146,32,208,238,170,193,35,53,44,225],f=[18,0,50,107,48,0,133,125,248,65,26,195,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,204,24,122,65,56,165,18,52,206,218,4,187,51,97,9,29,191,90,253,106,185,31,197,155,52,205,245,185,203,131,20,226,25,124,95,113,220,113,141,15,15,104,211,144,152,237,150,157,127,51,143,24,231,218,171,255,176,241,128,229,149,150,148,66,245,228,91,27,182,228,136,61,182,237,133,45,220,24,103,214,152],m=[18,0,50,122,48,1,9,253,248,65,26,67,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,198,182,231,242,220,235,163,140,12,36,36,166,46,132,210,4,71,23,218,132,27,30,17,45,244,79,31,243,195,136,100,169,76,88,142,85,204,217,121,168,29,163,198,17,251,223,73,12,212,244,139,123,151,179,75,216,96,208,136,40,229,42,59,149,10,116,228,85,99,93,221,108,255,140,248,20,30,167,122,109,206,164,108,197,110,251,23,243,133,160,63,13,207,177,12,128];return await new Ge((_,w)=>{let x;(async function(){r&&r.state!=="closed"||await async function(){r=new VideoDecoder({output:I=>{I.close(),clearTimeout(x),_(!0)},error:I=>{clearTimeout(x),_(!1)}}),await r.configure({codec:"av01.0.05M.08",width:160,height:90})}();const A=[a,s,l,d,f,m];for(let I=0;I<A.length;I++){const L=new EncodedVideoChunk({type:I==0?"key":"delta",timestamp:33333*I,duration:33333,data:new Uint8Array(A[I])});try{await r.decode(L)}catch{return void _(!1)}}})(),x=setTimeout(()=>{_(!1)},5e3)})}async function TD(r,a,s,l){return{gatewayInfo:await async function(f,m,y,_){let w=null;const x=[],A=async()=>{const L=se("WEBCS_DOMAIN").slice(0,se("AJAX_REQUEST_CONCURRENT")).map(G=>({url:f.proxyServer?"https://".concat(f.proxyServer,"/ap/?url=").concat(G+"/api/v2/transpond/webrtc?v=2"):"https://".concat(G,"/api/v2/transpond/webrtc?v=2"),areaCode:Tb()})),H=_.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Cb({fragementLength:se("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(F.debug("[".concat(f.clientId,"] Connect to choose_server:"),G.url),$K(G,f,m,y)),allFailedhandler:G=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},H),G[0]},promisesCollector:x});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},H),$},I=async()=>{if(await Ci(1e3),w!==null)return w;const L=se("WEBCS_DOMAIN_BACKUP_LIST").map(G=>({url:f.proxyServer?"https://".concat(f.proxyServer,"/ap/?url=").concat(G+"/api/v2/transpond/webrtc?v=2"):"https://".concat(G,"/api/v2/transpond/webrtc?v=2"),areaCode:Tb()})),H=_.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Cb({fragementLength:se("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(F.debug("[".concat(f.clientId,"] Connect to backup choose_server:"),G.url),$K(G,f,m,y)),allFailedhandler:G=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},H),G[0]},promisesCollector:x});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},H),$};try{return w=await Gg([A(),I()]),x.length&&x.forEach(L=>L.cancel&&typeof L.cancel=="function"&&L.cancel()),w}catch(L){throw L[0]}}(r,a,s,l)}}async function zK(r,a,s,l,d){const f=r.cloudProxyServer;if(f==="disabled"){if(r.useLocalAccessPoint)return await TD(r,a,s,d);if(se("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:I,proxyInfo:L}=await YK(r,a,s,d);if(r.turnServer&&r.turnServer.mode!=="auto")return{gatewayInfo:I};const H=L.map($=>({turnServerURL:$.address,tcpport:$.tcpport||Mi.tcpport,udpport:$.udpport||Mi.udpport,username:$.username||Mi.username,password:$.password||Mi.password,forceturn:!1,security:!0}));if(d.useP2P){var m;const $=(m=r.uid)!==null&&m!==void 0?m:I.uid,G="glb:".concat($.toString()),ne=await pj(G),te=L.map(ce=>({turnServerURL:ce.address,tcpport:ce.tcpport||Mi.tcpport,udpport:ce.udpport||Mi.udpport,username:G,password:ne,forceturn:!1,security:!0}));H.push(...te)}return r.turnServer={mode:"manual",servers:H},{gatewayInfo:I}}return await TD(r,a,s,d)}const{proxyInfo:y,gatewayInfo:_}=await YK(r,a,s,d),w={gatewayInfo:_},x=y.map(I=>({turnServerURL:I.address,tcpport:f==="proxy3"?void 0:I.tcpport?I.tcpport:Mi.tcpport,udpport:f==="proxy4"?void 0:I.udpport?I.udpport:Mi.udpport,username:I.username||Mi.username,password:I.password||Mi.password,forceturn:f!=="proxy4",security:f==="proxy5"}));if(d.useP2P){var A;const I=(A=r.uid)!==null&&A!==void 0?A:_.uid,L="glb:".concat(I.toString()),H=await pj(L),$=y.map(G=>({turnServerURL:G.address,tcpport:f==="proxy3"?void 0:G.tcpport||Mi.tcpport,udpport:f==="proxy4"?void 0:G.udpport||Mi.udpport,username:L,password:H,forceturn:f!=="proxy4",security:f==="proxy5"}));x.push(...$)}return r.turnServer={mode:"manual",servers:x},F.debug("[".concat(r.clientId,"] set proxy server: ").concat(r.proxyServer,", mode: ").concat(f)),w}async function KK(r,a,s,l,d){const f=se("ACCOUNT_REGISTER").slice(0,se("AJAX_REQUEST_CONCURRENT"));let m=[];m=a.proxyServer?f.map(_=>"https://".concat(a.proxyServer,"/ap/?url=").concat(_+"/api/v1")):f.map(_=>"https://".concat(_,"/api/v1"));const y=d==null?void 0:d.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:m});try{const _=await async function(w,x,A,I,L){const H=Date.now(),$={sid:A.sid,opid:10,appid:A.appId,string_uid:x};let G=w[0];const ne=await il(()=>ll(G+"".concat(G.indexOf("?")===-1?"?":"&","action=stringuid"),{data:$,cancelToken:I,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(te,ce)=>{if(te.code===0){if(te.uid<=0||te.uid>=Math.pow(2,32))throw F.error("Invalid Uint Uid ".concat(x," => ").concat(te.uid),te),nt.reqUserAccount($.sid,{lts:H,success:!1,serverAddr:G,stringUid:$.string_uid,uid:te.uid,errorCode:ie.INVALID_UINT_UID_FROM_STRING_UID,extend:$}),new Ee(ie.INVALID_UINT_UID_FROM_STRING_UID);return nt.reqUserAccount($.sid,{lts:H,success:!0,serverAddr:G,stringUid:$.string_uid,uid:te.uid,errorCode:null,extend:$}),!1}const pe=Fg(te.code);return pe.retry&&(G=w[(ce+1)%w.length]),nt.reqUserAccount($.sid,{lts:H,success:!1,serverAddr:G,stringUid:$.string_uid,uid:te.uid,errorCode:pe.desc,extend:$}),pe.retry},(te,ce)=>te.code!==ie.OPERATION_ABORTED&&(nt.reqUserAccount($.sid,{lts:H,success:!1,serverAddr:G,stringUid:$.string_uid,uid:null,errorCode:te.code,extend:$}),G=w[(ce+1)%w.length],!0),L);if(ne.code!==0){const te=Fg(ne.code);throw new Ee(ie.UNEXPECTED_RESPONSE,te.desc)}return ne}(m,r,a,s,l);return d==null||d.recordJoinChannelService({status:"success",endTs:Date.now()},y),_.uid}catch(_){throw d==null||d.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_]},y),_}}async function mOe(r,a,s){const l=se("ACCOUNT_REGISTER");let d=[];d=a.proxyServer?l.map(f=>"https://".concat(a.proxyServer,"/ap/?url=").concat(f+"/api/v1")):l.map(f=>"https://".concat(f,"/api/v1"));try{return await HK({referenceList:d,asyncMapHandler:m=>async function(y,_,w,x){const A=Date.now(),I={sid:w.sid,opid:10,appid:w.appId,string_uid:_};try{const L=await ll(y+"".concat(y.indexOf("?")===-1?"?":"&","action=stringuid"),{data:I,cancelToken:x,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(L.code!==0){const H=Fg(L.code);throw new Ee(ie.UNEXPECTED_RESPONSE,"preload sua error:".concat(H.desc),H)}if(L.uid<=0||L.uid>=Math.pow(2,32))throw new Ee(ie.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:A,url:y,req:I,uid:L.uid,elapse:Date.now()-A}}catch(L){throw L}}(m,r,a,s),closeFn:m=>m.code===ie.OPERATION_ABORTED||m.code===ie.UNEXPECTED_RESPONSE&&!m.data.retry})}catch(f){throw f}}async function gOe(r,a,s){const l=se("CDS_AP").slice(0,se("AJAX_REQUEST_CONCURRENT")).map(_=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(_+"/api/v1"):"https://".concat(_,"/api/v1?action=config")),d=l.map(_=>function(w,x,A,I){const L=sn(),H={flag:64,cipher_method:0,features:ou(ou(ou(ou(ou({install_id:Tj(),device:L.name,system:L.os,system_general:navigator.userAgent,vendor:x.appId,version:Co,cname:x.cname,session_id:x.sid,proxyServer:x.proxyServer,sdk_type:sOe.WEB_RTC,browser_name:L.name,browser_version:L.version,user_agent:navigator.userAgent,channel_name:x.cname},x.stringUid&&{string_uid:x.stringUid}),x.uid&&{uid:x.uid+""}),L.os&&{os_name:L.os}),L.osVersion&&{os_version:L.osVersion}),{},{detail:""})};return il(()=>ll(w,{data:H,timeout:1e3,cancelToken:A,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,$=>$.code!==ie.OPERATION_ABORTED,I)}(_,r,a,s));let f=null,m=null,y={};try{f=await Gg(d)}catch(_){if(_.code===ie.OPERATION_ABORTED)throw _;m=_}if(d.forEach(_=>_.cancel()),nt.reportApiInvoke(r.sid,{name:Er.REQUEST_CONFIG_DISTRIBUTE,options:{error:m,res:f}}).onSuccess(),f&&f.test_tags)try{y=function(_){if(!_.test_tags)return{};const w=_.test_tags,x=Object.keys(w),A={};return x.forEach(I=>{var L;const H=Ea(L=I.slice(4)).call(L),$=JSON.parse(w[I]),G=$[1];A[H]={tag:$[0]||"",value:G}}),A}(f)}catch{}return y}async function qK(r,a){const s=se("WEBCS_DOMAIN").concat(se("WEBCS_DOMAIN_BACKUP_LIST")).map(l=>({url:"https://".concat(l,"/api/v2/transpond/webrtc?v=2"),areaCode:Tb(),serviceIds:[Lr.CHOOSE_SERVER,Lr.CLOUD_PROXY_FALLBACK]}));try{return await HK({referenceList:s,asyncMapHandler:d=>async function(f,m,y){let _,{url:w,areaCode:x,serviceIds:A}=f;const I=Date.now(),[L,H]=xD(m,x,A);let $=Dr.networkState;try{$&&Dr.networkState===Is.OFFLINE&&Dr.onlineWaiter&&await Ge.race([Dr.onlineWaiter,Ci(Gr.maxRetryTimeout)]),$=Dr.networkState;const{data:G,headers:ne}=await ll(w,{data:L,cancelToken:y,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_=ne.http3==="1"?1:-1,(fe=>{const ue=[];if(fe.response_body.forEach(ye=>{const xe=ye.buffer.code;if(ye.uri===23&&xe===0&&!ye.buffer.edges_services)if(ye.buffer.flag===4194310)ye.buffer.edges_services=[];else{const Ae={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:fe.detail[502]}),flag:ye.buffer.flag};ue.push(Ae)}if(xe!==0){const Ae=Fg(xe),Le={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,Ae.desc,{desc:Ae.desc,retry:Ae.retry,csIp:fe.detail[502]}),flag:ye.buffer.flag};ye.buffer.flag===4194310?F.warning(Le.error.toString()):ue.push(Le)}}),ue.length)throw new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,ue.map(ye=>"flag: ".concat(ye.flag,", message: ").concat(ye.error.message)).join(" | "),{retry:!!ue.find(ye=>ye.error.data.retry),csIp:fe.detail[502],desc:[...new Set(ue.map(ye=>{var xe;return ye==null||(xe=ye.error)===null||xe===void 0||(xe=xe.data)===null||xe===void 0?void 0:xe.desc}).filter(ye=>!!ye))]})})(G);const ce=Eb(G,Lr.CHOOSE_SERVER),pe=Eb(G,Lr.CLOUD_PROXY_FALLBACK);return SD(ce),{gatewayInfo:fD(ce,w),proxyInfo:pe,opid:H,requestTime:I,url:w,isHttp3:_,elapse:Date.now()-I}}catch(G){throw G}}(d,r,a),closeFn:d=>d.code===ie.OPERATION_ABORTED||d.code===ie.CAN_NOT_GET_GATEWAY_SERVER&&!d.data.retry})}catch(l){throw l}}async function YK(r,a,s,l){const d=se("PROXY_SERVER_TYPE3"),f=(L,H,$)=>{let G=$||d;return Array.isArray(G)&&(G=H%2==0&&d[1]||d[0]),"https://".concat(G,"/ap/?url=").concat(L)};let m=null;const y=[],_=async()=>{const L=se("WEBCS_DOMAIN").slice(0,se("AJAX_REQUEST_CONCURRENT")).map((G,ne)=>{let te;return te=r.cloudProxyServer==="disabled"&&r.proxyServer?f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne,r.proxyServer):r.cloudProxyServer==="disabled"||r.cloudProxyServer==="fallback"?"https://".concat(G,"/api/v2/transpond/webrtc?v=2"):f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne),{url:te,areaCode:Tb(),serviceIds:[Lr.CHOOSE_SERVER,r.cloudProxyServer==="proxy5"?Lr.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Lr.CLOUD_PROXY:Lr.CLOUD_PROXY_FALLBACK]}}),H=l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Cb({fragementLength:se("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(F.debug("[".concat(r.clientId,"] Connect to choose_server:"),G.url),WK(G,r,a,s)),allFailedhandler:G=>{throw l.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},H),G[0]},promisesCollector:y});return l.recordJoinChannelService({endTs:Date.now(),status:"success"},H),$},w=async()=>{if(await Ci(1e3),m!==null)return m;const L=se("WEBCS_DOMAIN_BACKUP_LIST").map((G,ne)=>{let te;return te=r.cloudProxyServer==="disabled"&&r.proxyServer?f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne,r.proxyServer):r.cloudProxyServer==="disabled"||r.cloudProxyServer==="fallback"?"https://".concat(G,"/api/v2/transpond/webrtc?v=2"):f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne),{url:te,areaCode:Tb(),serviceIds:[Lr.CHOOSE_SERVER,r.cloudProxyServer==="proxy5"?Lr.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Lr.CLOUD_PROXY:Lr.CLOUD_PROXY_FALLBACK]}}),H=l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Cb({fragementLength:se("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(F.debug("[".concat(r.clientId,"] Connect to backup choose_server:"),G.url),WK(G,r,a,s)),allFailedhandler:G=>{throw l.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},H),G[0]},promisesCollector:y});return l.recordJoinChannelService({endTs:Date.now(),status:"success"},H),$};let x,A,I;try{({gatewayInfo:x,proxyInfo:A,url:I}=await Gg([_(),w()]))}catch(L){throw L[0]}if(y.length&&y.forEach(L=>L.cancel&&typeof L.cancel=="function"&&L.cancel()),!x||!A)throw new Ee(ie.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(r.apUrl=I,r.cloudProxyServer!=="disabled"&&Array.isArray(d)&&I){const L=/^https?:\/\/(.+?)(\/.*)?$/.exec(I)[1];Ve(d).call(d,L)&&(r.proxyServer=L,F.setProxyServer(L),nt.setProxyServer(L))}return m={gatewayInfo:x,proxyInfo:await _K(A,x.uid)},m}async function vOe(r,a,s){const l=se("UAP_AP").slice(0,se("AJAX_REQUEST_CONCURRENT")).map(f=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(f+"/api/v1?action=uap"):"https://".concat(f,"/api/v1?action=uap")),d=l.map(f=>function(m,y,_,w){const x={command:"convergeAllocateEdge",sid:y.sid,appId:y.appId,token:y.token,ts:Date.now(),version:Co,cname:y.cname,uid:y.uid.toString(),requestId:wD,seq:wD};wD+=1;const A={service_name:"tele_channel",json_body:JSON.stringify(x)};return il(async()=>{const I=await ll(m,{data:A,cancelToken:_,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(I.code!==0){const H=new Ee(ie.UNEXPECTED_RESPONSE,"cross channel ap error, code"+I.code,{retry:!0});throw F.error(H.toString()),H}const L=JSON.parse(I.json_body);if(L.code!==200){const H=new Ee(ie.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(L.code,", reason: ").concat(L.reason));throw F.error(H.toString()),H}if(!L.servers||L.servers.length===0){const H=new Ee(ie.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw F.error(H.toString()),H}return{vid:L.vid,workerToken:L.workerToken,addressList:(se("CHANNEL_MEDIA_RELAY_SERVERS")||L.servers).map(H=>"wss://".concat(H.address.replace(/\./g,"-"),".").concat(se("WORKER_DOMAIN"),":").concat(H.wss))}},void 0,I=>!!(I.code!==ie.OPERATION_ABORTED&&I.code!==ie.UNEXPECTED_RESPONSE||I.data&&I.data.retry),w)}(f,r,a,s));try{const f=await Gg(d);return d.forEach(m=>m.cancel()),f}catch(f){throw f[0]}}async function yOe(r,a,s){let l=null;const d=[],f=async m=>{const y=se(m?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(_+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_,"/api/v2/transpond/webrtc?v=2"));return m&&(await Ci(1e3),l!==null)?l:await Cb({fragementLength:se("FRAGEMENT_LENGTH"),referenceList:y,asyncMapHandler:_=>(F.debug("[".concat(r.clientId,"] update ticket, Connect to ").concat(m?"backup":""," choose_server:"),_),function(w,x,A,I){const[L]=fOe(x,[Lr.CHOOSE_SERVER]);let H=Dr.networkState;return il(async()=>{H&&Dr.networkState===Is.OFFLINE&&Dr.onlineWaiter&&await Ge.race([Dr.onlineWaiter,Ci(I&&I.maxRetryTimeout||Gr.maxRetryTimeout)]),H=Dr.networkState;const $=await ll(w,{data:L,cancelToken:A,headers:{"Content-Type":"multipart/form-data;"}},!0);return hOe($,w)},()=>!1,$=>$.code!==ie.OPERATION_ABORTED&&($.code===ie.UPDATE_TICKET_FAILED?$.data.retry:(F.warning("[".concat(x.clientId,"] update ticket network error, retry"),$),!0)),I)}(_,r,a,s)),allFailedhandler:_=>{throw _[0]},promisesCollector:d})};try{return l=await Gg([f(!1),f(!0)]),d.length&&d.forEach(m=>m.cancel&&typeof m.cancel=="function"&&m.cancel()),l}catch(m){throw m[0]}}function XK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function CD(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?XK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):XK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class _Oe extends lr{get isSuccess(){return!!this.configs}constructor(a,s){super(),Z(this,"configs",void 0),Z(this,"store",void 0),Z(this,"joinInfo",void 0),Z(this,"cancelToken",void 0),Z(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),Z(this,"interval",void 0),Z(this,"mutex",void 0),Z(this,"mutableParamsRead",!1),Z(this,"configCache",{}),Z(this,"limit_bitrate",void 0),this.mutex=new Gi("config-distribute",a),this.store=s}startGetConfigDistribute(a,s){this.joinInfo=a,this.cancelToken=s,this.interval&&this.stopGetConfigDistribute(),se("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},se("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,nt.reportApiInvoke(null,{options:void 0,name:Er.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:rr.TRACER}).onSuccess(JSON.stringify(al))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void F.debug("[config-distribute] get config distribute interrupted have no joininfo");let a;const s=await this.mutex.lock();try{a=await gOe(this.joinInfo,this.cancelToken,this.retryConfig),F.debug("[config-distribute] get config distribute",JSON.stringify(a));const l=function(d){var f;const m=Yf(f=Object.keys(d).filter(w=>/^webrtc_ng_global_parameter/.test(w))).call(f);for(let w=0;w<m.length;w++)for(let x=m.length-1;x>w;x--){const A=m[x],I=d[A].value;if(typeof I.__priority=="number"){const L=I.__priority,H=m[x-1],$=d[H].value;if(typeof $.__priority=="number"){if(!(L>$.__priority))continue;{const G=A;m[x]=m[x-1],m[x-1]=G}}else{const G=A;m[x]=m[x-1],m[x-1]=G}}}const y=Date.now();let _={};return m.forEach(w=>{const x=d[w].value.__expires;x&&x<=y||(_[w]=d[w])}),_}(a);this.cacheGlobalParameterConfig(l),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=l}catch(l){const d=new Ee(ie.NETWORK_RESPONSE_ERROR,l);F.warning("[config-distribute] ".concat(d.toString()))}finally{s()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(a){cK(a)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==a.id&&this.emit(yb.UPDATE_BITRATE_LIMIT,a):this.emit(yb.UPDATE_BITRATE_LIMIT,a))}getLowStreamConfigDistribute(){return this.limit_bitrate&&CD({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(a){try{const s={},l=Object.keys(a),d=[];l.forEach(f=>{const m=a[f].value;s[f]=m;const y=m.__id;if(y&&this.configCache[f]&&this.configCache[f].__id===y)return;const _=m.__type,w=a[f].value,x=a[f].tag;let A=0;_?_===Pz.REALTIME&&(A=1):Object.keys(w).some(I=>Object.prototype.hasOwnProperty.call(Aj,I)||!nD()&&Object.prototype.hasOwnProperty.call(zx,I)?(A=1,!0):void 0),d.push({tag:x,isApplied:A,feature:f,params:JSON.stringify(m)})}),d.forEach(f=>{let{tag:m,feature:y,params:_,isApplied:w}=f;this.store.sessionId&&nt.abTest(this.store.sessionId,{intSucc:1,isApplied:w,tag:m,feature:y,params:_,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=s}catch(s){F.debug("handleABTestConfigDistribute error",s)}}cacheGlobalParameterConfig(a){const s=function(d){const f={};return Object.keys(d).forEach(m=>{const y=d[m].value,_=y.__expires,w=y.__type;Object.keys(y).forEach(x=>{x==="__id"||x==="__type"||x==="__priority"||x==="__expires"||Object.prototype.hasOwnProperty.call(f,x)||(f[x]=CD(CD({value:y[x]},_&&{expires:_}),w&&{type:w}))})}),f}(a);try{var l;const d=(l=s.LIMIT_BITRATE)===null||l===void 0?void 0:l.value;delete s.LIMIT_BITRATE,d&&cK(d)&&this.handleBitrateLimit(d),this.limit_bitrate=d,this.handleGlobalParameterConfig(s),this.handleABTestConfigDistribute(a),function(y){try{const _=Date.now();Object.keys(y).forEach(w=>{const{value:x,type:A,expires:I}=y[w];I&&I<=_||((A===Pz.REALTIME||Object.prototype.hasOwnProperty.call(Aj,w))&&(al[w]=x,Zn[w]=x,F.debug("Update realtime parameters from config distribute",w,x)),A||nD()||!Object.prototype.hasOwnProperty.call(zx,w)||(al[w]=x,Zn[w]=x,F.debug("Update gateway parameters from config distribute",w,x)))})}catch(_){F.error("Error update config immediately: ".concat(y),_.message)}}(s);const f=JSON.stringify(s),m=window.btoa(f);window.localStorage.setItem("websdk_ng_global_parameter",m),F.debug("Caching global parameters ".concat(f))}catch(d){F.error("Error caching global parameters:",d.message)}}handleGlobalParameterConfig(a){try{const s=Date.now();Object.keys(a).forEach(l=>{if(l==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(Zn,l)){const{value:d,expires:f}=a[l];if(f&&f<=s)return;(function(m,y){try{return typeof m=="object"&&typeof y=="object"&&JSON.stringify(m)===JSON.stringify(y)}catch{return!1}})(Zn[l],d)||(al[l]=d,Zn[l]=d,this.emit(yb.UPDATE_CLIENT_ROLE_OPTIONS,d),F.debug("Updating client role options: ".concat(JSON.stringify(d))))}})}catch(s){F.error("Error handling global parameter config:",s.message)}}}class bOe extends lr{constructor(){super(...arguments),Z(this,"resultStorage",new Map)}setLocalAudioStats(a,s,l){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",a,this.checkAudioInputLevel(l,s)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",a,this.checkSendAudioBitrate(l,s))}setLocalVideoStats(a,s,l){this.record("SEND_VIDEO_BITRATE_TOO_LOW",a,this.checkSendVideoBitrate(l,s)),this.record("FRAMERATE_INPUT_TOO_LOW",a,this.checkFramerateInput(l,s)),this.record("FRAMERATE_SENT_TOO_LOW",a,this.checkFramerateSent(l)),!s.muted&&this.record("VIDEO_ENCODE_FAILED",a,this.checResolutionSent(l))}setRemoteAudioStats(a,s){const l=a.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",l,this.checkAudioOutputLevel(s))}setRemoteVideoStats(a,s){const l=a.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",l,this.checkVideoDecode(s))}record(a,s,l){if(se("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(a)||this.resultStorage.set(a,{result:[],isPrevNormal:!0});const d=this.resultStorage.get(a);if(!d)return;d.result.push(l);const f=a==="VIDEO_ENCODE_FAILED"?se("ENCODE_EXCEPTION_TIMES"):5;if(d.result.length>=f){var m;const y=Ve(m=d.result).call(m,!0);d.isPrevNormal&&!y&&this.emit("exception",RD[a],a,s),!d.isPrevNormal&&y&&this.emit("exception",RD[a]+2e3,a+"_RECOVER",s),d.isPrevNormal=y,d.result=[]}}checkAudioOutputLevel(a){return!(a.receiveBitrate>0&&a.receiveLevel===0)}checkAudioInputLevel(a,s){return s instanceof Yr&&!s.isActive||!!s.muted||a.sendVolumeLevel!==0}checkFramerateInput(a,s){let l=null;s._encoderConfig&&s._encoderConfig.frameRate&&(l=Os(s._encoderConfig.frameRate));const d=a.captureFrameRate;return!l||!d||!(l>10&&d<5||l<10&&l>=5&&d<=1)}checkFramerateSent(a){return!(a.captureFrameRate&&a.sendFrameRate&&a.captureFrameRate>5&&a.sendFrameRate<=1)}checResolutionSent(a){var s;return!(!a.codecType||Ve(s=se("ENCODE_EXCEPTION_VALIDATE_CODEC")).call(s,a.codecType.toLocaleLowerCase()))||!a.captureFrameRate||a.sendFrameRate!==0||a.sendResolutionWidth!==0||a.sendResolutionHeight!==0}checkSendVideoBitrate(a,s){return!!s.muted||a.sendBitrate!==0}checkSendAudioBitrate(a,s){return s instanceof Yr&&!s.isActive||!!s.muted||a.sendBitrate!==0}checkVideoDecode(a){return a.receiveBitrate===0||a.decodeFrameRate!==0}}const RD={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003,VIDEO_ENCODE_FAILED:2004},qi=new class{markSubscribeStart(r,a){performance.mark("agora-web-sdk/".concat(r,"/subscribe-").concat(a))}markPublishStart(r,a){performance.mark("agora-web-sdk/".concat(r,"/publish-").concat(a))}measureFromSubscribeStart(r,a){const s=performance.getEntriesByName("agora-web-sdk/".concat(r,"/subscribe-").concat(a));if(s.length>0){const l=s[s.length-1];return Math.round(performance.now()-l.startTime)}return 0}measureFromPublishStart(r,a){const s=performance.getEntriesByName("agora-web-sdk/".concat(r,"/publish-").concat(a));if(s.length>0){const l=s[s.length-1];return Math.round(performance.now()-l.startTime)}return 0}};function JK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function gp(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?JK(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):JK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class Rb{constructor(a){Z(this,"store",void 0),Z(this,"onStatsException",void 0),Z(this,"onUploadPublishDuration",void 0),Z(this,"onStatsChanged",void 0),Z(this,"onVideoCodecChanged",void 0),Z(this,"localStats",new Map),Z(this,"remoteStats",new Map),Z(this,"updateStatsInterval",void 0),Z(this,"trafficStats",void 0),Z(this,"trafficStatsPeerList",[]),Z(this,"uplinkStats",void 0),Z(this,"exceptionMonitor",void 0),Z(this,"p2pChannel",void 0),Z(this,"scalabilityMode",Hx.L1T1),Z(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=a,this.exceptionMonitor=new bOe,this.exceptionMonitor.on("exception",(s,l,d)=>{this.onStatsException&&this.onStatsException(s,l,d)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(ke.LocalAudioTrack)||gp({},Dj)}getLocalVideoTrackStats(){return this.localStats.get(ke.LocalVideoTrack)||gp({},Lj)}getRemoteAudioTrackStats(a){const s=(f,m)=>{if(!this.trafficStats)return m;const y=this.trafficStats.peer_delay.find(_=>_.peer_uid===f);return y&&(m.publishDuration=y.B_ppad+(Date.now()-this.trafficStats.timestamp)),m},l={};if(a){var d;const f=(d=this.remoteStats.get(a))===null||d===void 0?void 0:d.audioStats;f&&(l[a]=s(a,f))}else Array.from(this.remoteStats.entries()).forEach(f=>{let[m,{audioStats:y}]=f;y&&(l[m]=s(m,y))});return l}getRemoteNetworkQualityStats(a){const s={};if(a){var l;const d=(l=this.remoteStats.get(a))===null||l===void 0?void 0:l.networkStats;d&&(s[a]=d)}else Array.from(this.remoteStats.entries()).forEach(d=>{let[f,{networkStats:m}]=d;m&&(s[f]=m)});return s}getRemoteVideoTrackStats(a){const s=(f,m)=>{if(!this.trafficStats)return m;const y=this.trafficStats.peer_delay.find(_=>_.peer_uid===f);return y&&(m.publishDuration=y.B_ppvd+(Date.now()-this.trafficStats.timestamp)),m},l={};if(a){var d;const f=(d=this.remoteStats.get(a))===null||d===void 0?void 0:d.videoStats;f&&(l[a]=s(a,f))}else Array.from(this.remoteStats.entries()).forEach(f=>{let[m,{videoStats:y}]=f;y&&(l[m]=s(m,y))});return l}getRTCStats(){let a=0,s=0,l=0,d=0;const f=this.localStats.get(ke.LocalAudioTrack);f&&(a+=f.sendBytes,s+=f.sendBitrate);const m=this.localStats.get(ke.LocalVideoTrack);m&&(a+=m.sendBytes,s+=m.sendBitrate);const y=this.localStats.get(ke.LocalVideoLowTrack);y&&(a+=y.sendBytes,s+=y.sendBitrate),this.remoteStats.forEach(w=>{let{audioStats:x,videoStats:A}=w;x&&(l+=x.receiveBytes,d+=x.receiveBitrate),A&&(l+=A.receiveBytes,d+=A.receiveBitrate)});let _=1;return this.trafficStats&&(_+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_,SendBitrate:s,SendBytes:a,RecvBytes:l,RecvBitrate:d,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(a){this.localStats.set(a,void 0)}removeLocalStats(a){a?this.localStats.delete(a):this.localStats.clear()}addRemoteStats(a){this.remoteStats.set(a,{})}removeRemoteStats(a){a?this.remoteStats.delete(a):this.remoteStats.clear()}addP2PChannel(a){this.p2pChannel=a}updateTrafficStats(a){a.peer_delay=a.peer_delay.filter(s=>s.B_ppad!==void 0||s.B_ppvd!==void 0),a.peer_delay.filter(s=>this.trafficStatsPeerList.indexOf(s.peer_uid)===-1).forEach(s=>{var l;const d=(l=this.p2pChannel)===null||l===void 0?void 0:l.getRemoteMedia(s.peer_uid),f=d!=null&&d.videoSSRC?qi.measureFromSubscribeStart(this.store.clientId,d.videoSSRC):0,m=d!=null&&d.audioSSRC?qi.measureFromSubscribeStart(this.store.clientId,d.audioSSRC):0;s.B_ppad!==void 0&&s.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(s.peer_uid,s.B_ppad,s.B_ppvd,f>m?f:m),this.trafficStatsPeerList.push(s.peer_uid))}),this.trafficStats=a}updateUplinkStats(a){this.uplinkStats&&this.uplinkStats.B_fir!==a.B_fir&&F.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(a.B_fir)),this.uplinkStats=a}static isRemoteVideoFreeze(a,s,l){if(!a)return!1;const d=!!l&&s.framesDecodeFreezeTime>l.framesDecodeFreezeTime,f=!l||s.framesDecodeCount>l.framesDecodeCount;return d||!f}static isRemoteAudioFreeze(a){return!!a&&a._isFreeze()}isLocalVideoFreeze(a){return!(!a.inputFrame||!a.sentFrame)&&a.inputFrame.frameRate>5&&a.sentFrame.frameRate<3}updateLocalStats(a){Array.from(this.localStats.entries()).forEach(s=>{let[l,d]=s;switch(l){case ke.LocalVideoTrack:case ke.LocalVideoLowTrack:{const y=d,_=gp({},Lj),w=a.getStats(),x=a.getLocalMedia(l);if(w){const A=w.videoSend.find(I=>I.ssrc===(x==null?void 0:x.ssrcs[0].ssrcId));if(A){const I=a.getLocalVideoSize(),L=a.getEncoderConfig(ke.LocalVideoTrack);var f;(A.codec==="H264"||A.codec==="H265"||A.codec==="VP8"||A.codec==="VP9"||A.codec==="AV1X"||A.codec==="AV1")&&(_.codecType=A.codec,(y==null?void 0:y.codecType)!==A.codec&&((f=this.onVideoCodecChanged)===null||f===void 0||f.call(this,A.codec.toLocaleLowerCase()))),_.sendBytes=A.bytes,_.sendBitrate=y?8*Math.max(0,_.sendBytes-y.sendBytes):0,A.inputFrame?(_.captureFrameRate=A.inputFrame.frameRate,_.captureResolutionHeight=A.inputFrame.height,_.captureResolutionWidth=A.inputFrame.width):I&&(_.captureResolutionWidth=I.width,_.captureResolutionHeight=I.height),A.sentFrame?(_.sendFrameRate=A.sentFrame.frameRate,_.sendResolutionHeight=A.sentFrame.height,_.sendResolutionWidth=A.sentFrame.width):I&&(_.sendResolutionWidth=I.width,_.sendResolutionHeight=I.height),A.avgEncodeMs&&(_.encodeDelay=A.avgEncodeMs),L&&L.bitrateMax?_.targetSendBitrate=1e3*L.bitrateMax:A.targetBitrate&&(_.targetSendBitrate=A.targetBitrate),_.sendPackets=A.packets,_.sendPacketsLost=A.packetsLost,_.sendJitterMs=A.jitterMs,_.sendRttMs=A.rttMs,_.totalDuration=y?y.totalDuration+1:1,_.totalFreezeTime=y?y.totalFreezeTime:0,this.isLocalVideoFreeze(A)&&(_.totalFreezeTime+=1),A.scalabilityMode&&this.scalabilityMode!==A.scalabilityMode&&(F.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(A.scalabilityMode)),this.scalabilityMode=A.scalabilityMode)}this.trafficStats&&(_.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var m;this.localStats.set(l,_),((y==null?void 0:y.sendResolutionWidth)!==_.sendResolutionWidth||(y==null?void 0:y.sendResolutionHeight)!==_.sendResolutionHeight)&&((m=this.onStatsChanged)===null||m===void 0||m.call(this,"resolution",{width:_.sendResolutionWidth,height:_.sendResolutionHeight})),_&&x&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,x.track,_);break}case ke.LocalAudioTrack:{const y=d,_=gp({},Dj),w=a.getStats(),x=a.getLocalMedia(l);if(w){const A=w.audioSend.find(I=>I.ssrc===(x==null?void 0:x.ssrcs[0].ssrcId));if(A){if(A.codec!=="opus"&&A.codec!=="aac"&&A.codec!=="PCMU"&&A.codec!=="PCMA"&&A.codec!=="G722"||(_.codecType=A.codec),A.inputLevel)_.sendVolumeLevel=Math.round(32767*A.inputLevel);else{const I=a.getLocalAudioVolume();I&&(_.sendVolumeLevel=Math.round(32767*I))}_.sendBytes=A.bytes,_.sendPackets=A.packets,_.sendPacketsLost=A.packetsLost,_.sendJitterMs=A.jitterMs,_.sendRttMs=A.rttMs,_.sendBitrate=y?8*Math.max(0,_.sendBytes-y.sendBytes):0}}this.trafficStats&&(_.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(ke.LocalAudioTrack,_),_&&x&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,x.track,_);break}}})}updateRemoteStats(a){Array.from(this.remoteStats.entries()).forEach(s=>{var l,d;let[f,{videoStats:m,audioStats:y,videoPcStats:_}]=s;const w=y,x=m,A=_,I=gp({},Wz),L=gp({},Gz),H=gp({},rIe),{audioTrack:$,videoTrack:G,audioSSRC:ne,videoSSRC:te}=a.getRemoteMedia(f);let ce;ce=this.store.useP2P?a.getStats(!0):a.getStats();const pe=(l=ce)===null||l===void 0?void 0:l.audioRecv.find(xe=>xe.ssrc===ne),fe=(d=ce)===null||d===void 0?void 0:d.videoRecv.find(xe=>xe.ssrc===te),ue=this.trafficStats&&this.trafficStats.peer_delay.find(xe=>xe.peer_uid===f);if(pe&&(pe.codec!=="opus"&&pe.codec!=="aac"&&pe.codec!=="PCMU"&&pe.codec!=="PCMA"&&pe.codec!=="G722"||(I.codecType=pe.codec),pe.outputLevel?I.receiveLevel=Math.round(32767*pe.outputLevel):$&&(I.receiveLevel=Math.round(32767*$.getVolumeLevel())),I.receiveBytes=pe.bytes,I.receivePackets=pe.packets,I.receivePacketsLost=pe.packetsLost,I.receivePacketsDiscarded=pe.packetsDiscarded,I.packetLossRate=I.receivePacketsLost/(I.receivePackets+I.receivePacketsLost),I.receiveBitrate=w?8*Math.max(0,I.receiveBytes-w.receiveBytes):0,I.totalDuration=w?w.totalDuration+1:1,I.totalFreezeTime=w?w.totalFreezeTime:0,I.freezeRate=I.totalFreezeTime/I.totalDuration,I.receiveDelay=pe.jitterBufferMs,I.totalDuration>10&&Rb.isRemoteAudioFreeze($)&&(I.totalFreezeTime+=1)),fe){var ye;fe.codec!=="H264"&&fe.codec!=="H265"&&fe.codec!=="VP8"&&fe.codec!=="VP9"&&fe.codec!=="AV1X"&&fe.codec!=="AV1"||(L.codecType=fe.codec),L.receiveBytes=fe.bytes,L.receiveBitrate=x?8*Math.max(0,L.receiveBytes-x.receiveBytes):0,L.decodeFrameRate=fe.decodeFrameRate<0?0:fe.decodeFrameRate,L.renderFrameRate=fe.decodeFrameRate<0?0:fe.decodeFrameRate,fe.outputFrame&&(L.renderFrameRate=fe.outputFrame.frameRate),fe.receivedFrame?(L.receiveFrameRate=fe.receivedFrame.frameRate,L.receiveResolutionHeight=fe.receivedFrame.height,L.receiveResolutionWidth=fe.receivedFrame.width):G&&(L.receiveResolutionHeight=G._videoHeight||0,L.receiveResolutionWidth=G._videoWidth||0),fe.framesRateFirefox!==void 0&&(L.receiveFrameRate=Math.round(fe.framesRateFirefox)),L.receivePackets=fe.packets,L.receivePacketsLost=fe.packetsLost,L.packetLossRate=L.receivePacketsLost/(L.receivePackets+L.receivePacketsLost);const xe=x?x.totalFreezeTime:0,Ae=x?x.totalDuration:0;L.totalDuration=x?x.totalDuration+1:1,L.totalFreezeTime=(ye=fe.totalFreezesDuration)!==null&&ye!==void 0?ye:xe||0,L.receiveDelay=fe.jitterBufferMs||0;const Le=!!te&&a.getRemoteVideoIsReady(te);fe.totalFreezesDuration===void 0&&G&&Le&&Rb.isRemoteVideoFreeze(G,fe,A)&&(L.totalFreezeTime+=1),L.freezeRate=Math.max(0,Math.min((L.totalFreezeTime-xe)/(L.totalDuration-Ae),1))}ue&&(I.end2EndDelay=ue.B_ad,L.end2EndDelay=ue.B_vd,I.transportDelay=ue.B_ed,L.transportDelay=ue.B_ed,I.currentPacketLossRate=ue.B_ealr4/100,L.currentPacketLossRate=ue.B_evlr4/100,H.uplinkNetworkQuality=ue.B_punq?ue.B_punq:0,H.downlinkNetworkQuality=ue.B_pdnq?ue.B_pdnq:0),this.remoteStats.set(f,{audioStats:I,videoStats:L,videoPcStats:fe,networkStats:H}),$&&this.exceptionMonitor.setRemoteAudioStats($,I),G&&this.exceptionMonitor.setRemoteVideoStats(G,L)})}}class ZK{constructor(){Z(this,"destChannelMediaInfos",new Map),Z(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(a){sK(a),this.srcChannelMediaInfo=a}addDestChannelInfo(a){sK(a),this.destChannelMediaInfos.set(a.channelName,a)}removeDestChannelInfo(a){dT(a),this.destChannelMediaInfos.delete(a)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function QK(r){if(!(r instanceof ZK))return new Ee(ie.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const a=r.getSrcChannelMediaInfo(),s=r.getDestChannelMediaInfo();if(!a)return new Ee(ie.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(s.size===0)return new Ee(ie.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class xh{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(a,s){Z(this,"uid",void 0),Z(this,"_uintid",void 0),Z(this,"_trust_in_room_",!0),Z(this,"_trust_audio_enabled_state_",!0),Z(this,"_trust_video_enabled_state_",!0),Z(this,"_trust_audio_mute_state_",!0),Z(this,"_trust_video_mute_state_",!0),Z(this,"_audio_muted_",!1),Z(this,"_video_muted_",!1),Z(this,"_audio_enabled_",!0),Z(this,"_video_enabled_",!0),Z(this,"_audio_added_",!1),Z(this,"_video_added_",!1),Z(this,"_is_pre_created",!1),Z(this,"_video_pre_subscribed",!1),Z(this,"_audio_pre_subscribed",!1),Z(this,"_trust_video_stream_added_state_",!0),Z(this,"_trust_audio_stream_added_state_",!0),Z(this,"_audioTrack",void 0),Z(this,"_videoTrack",void 0),Z(this,"_dataChannels",[]),Z(this,"_audioSSRC",void 0),Z(this,"_videoSSRC",void 0),Z(this,"_audioOrtc",void 0),Z(this,"_videoOrtc",void 0),Z(this,"_cname",void 0),Z(this,"_rtxSsrcId",void 0),Z(this,"_videoMid",void 0),Z(this,"_audioMid",void 0),this.uid=a,this._uintid=s}}function eq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ND(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?eq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):eq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const CT="9",AD=2e4,RT=4e4;function tq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ud(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?tq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):tq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}var Hg=function(r){return r[r.DOWN=0]="DOWN",r[r.UP=1]="UP",r}(Hg||{});const NT=new Map;function nq(r,a,s,l){let{scale:d}=r;if(d===0&&l===Hg.UP||d>=a.length-1&&l===Hg.DOWN)return r;let f=ud(ud({},r),{},{scale:l===Hg.DOWN?++d:--d});switch(s){case"maintain-framerate":f=ud(ud({},f),a[d].motion);break;case"maintain-resolution":f=ud(ud({},f),a[d].detail);break;case"balanced":f=ud(ud({},f),a[d].balanced)}return f}function rq(r,a){if(a){const s={overUse:0,underUse:0,adaptationList:iq(a)};NT.set(r,s)}else NT.delete(r)}function iq(r){const a=ud({},r),{bitrateMax:s,frameRate:l,scaleResolutionDownBy:d,bitrateMin:f}=a,{MIN_FRAME_RATE:m,MAX_THRESHOLD_FRAMERATE:y,MAX_SCALE:_,BITRATE_MIN_THRESHOLD:w,BITRATE_MAX_THRESHOLD:x,BWE_SCALE_UP_THRESHOLD:A,BWE_SCALE_DOWN_THRESHOLD:I,PERF_SCALE_DOWN_THRESHOLD:L,PERF_SCALE_UP_THRESHOLD:H,BALANCE_BITRATE_FACTOR:$,BALANCE_FRAMERATE_FACTOR:G,BALANCE_RESOLUTION_FACTOR:ne,MOTION_RESOLUTION_FACTOR:te,MOTION_BITRATE_FACTOR:ce,DETAIL_FRAMERATE_FACTOR:pe,DETAIL_BITRATE_FACTOR:fe}=Rj,ue=Math.min(a.frameRate,y),ye=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(I,1)*s),bwe_up:s,fps_down:Math.round(Math.pow(L,1)*ue),fps_up:l},balanced:{scaleResolutionDownBy:1,frameRate:l,bitrateMax:s,bitrateMin:f},motion:{scaleResolutionDownBy:1,frameRate:l,bitrateMax:s,bitrateMin:f},detail:{scaleResolutionDownBy:1,frameRate:l,bitrateMax:s,bitrateMin:f}}];for(let xe=1;xe<=_;xe++){const Ae={bwe_up:Math.round(Math.pow(A,xe)*s),bwe_down:Math.round(Math.pow(I,xe+1)*s),fps_up:Math.round(Math.pow(H,xe)*ue),fps_down:Math.round(Math.pow(L,xe+1)*ue)},Le={scaleResolutionDownBy:d/Math.pow(ne,xe),frameRate:Math.max(Math.round(Math.pow(G,xe)*l),m),bitrateMax:Math.max(Math.round(Math.pow($,xe)*s),x),bitrateMin:Math.max(Math.round(Math.pow($,xe)*f),w)},Ht={scaleResolutionDownBy:d/Math.pow(te,xe),frameRate:l,bitrateMax:Math.max(Math.round(Math.pow(ce,xe)*s),x),bitrateMin:Math.max(Math.round(Math.pow(ce,xe)*f),w)},qt={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(pe,xe)*l),m),bitrateMax:Math.max(Math.round(Math.pow(fe,xe)*s),x),bitrateMin:Math.max(Math.round(Math.pow(fe,xe)*f),w)};ye.push({scale:xe,threshold:Ae,balanced:Le,motion:Ht,detail:qt})}return ye}function EOe(r,a,s,l,d,f){const m=NT.get(r)||{overUse:0,underUse:0,adaptationList:iq(d)},{adaptationList:y}=m;NT.set(r,m);const{OVERUSE_TIMES_THRESHOLD:_,UNDERUSE_TIMES_THRESHOLD:w}=Rj,{scale:x}=l;let A,I;return typeof a=="number"&&a>0&&function(L,H,$,G){if(H>=$.length)return!1;let{threshold:{fps_down:ne}}=$[H];return se("FORCE_AG_HIGH_FRAMERATE")&&G==="maintain-framerate"&&(ne=$[0].threshold.fps_down),L<ne}(a,x,y,f)&&(m.overUse++,I=ub.CPU,m.overUse>_)||typeof s=="number"&&s>0&&function(L,H,$){if(H>=$.length)return!1;const{threshold:{bwe_down:G}}=$[H];return L<G}(s,x,y)&&(m.overUse++,I=ub.BANDWIDTH,m.overUse>_)?(m.overUse=0,m.underUse=0,A=nq(l,y,f,Hg.DOWN),[A,I]):(typeof a=="number"&&a>0&&typeof s=="number"&&s>0&&function(L,H,$,G){if(H===0)return;let{threshold:{fps_up:ne}}=$[H];return se("FORCE_AG_HIGH_FRAMERATE")&&G==="maintain-framerate"&&(ne=$[1].threshold.fps_up),L>ne}(a,x,y,f)&&function(L,H,$){if(H===0)return;const{threshold:{bwe_up:G}}=$[H];return L>G}(s,x,y)&&(m.underUse++,m.underUse>w&&(m.overUse=0,m.underUse=0,A=nq(l,y,f,Hg.UP),A.scale===0&&(I=ub.NONE))),[A,I])}function aq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ID(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?aq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):aq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const AT=new Map;function IT(r,a){const s=AT.get(r);if(s){const{timer:l}=s;window.clearTimeout(l),AT.delete(r)}a.qualityLimitationReason=ub.NONE,rq(r)}function wOe(r,a){var s;let l;switch(a){case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoTrack:l=Ve(s=r._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalVideoLowTrack:l=xn.Low}return l}function OD(r){const a=un();if(r.some(s=>s._bypassWebAudio))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!a.webAudioMediaStreamDest)throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function PD(r,a){OD(r);const s=new Yr;return r.forEach(l=>s.addAudioTrack(l)),s}const SOe=!un().supportUnifiedPlan||se("CHROME_FORCE_PLAN_B")&&id();function OT(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;return SOe?(s={spec:a,store:r},ld("PlanBConnection").create(s)):new Oo(a,r)}function kD(r){return r&&(r.iceConnectionState==="disconnected"||r.iceConnectionState==="checking"||r.iceConnectionState==="failed")}function sq(r){try{if(r.iceServers)return!1;if(r.turnServer&&r.turnServer.mode!=="off"){if(ob(r.turnServer.servers))return!1;if(se("FORCE_TURN_TCP")||r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).some(a=>a.forceturn))return!0}return!1}catch{return!1}}var on;function oq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ul(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?oq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):oq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let Oo=(on=class Pp extends uK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var a,s;return(a=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&a!==void 0?a:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(a=>a.rtpMap&&a.rtpMap.encodingName.toLowerCase()||"").filter(a=>{var s;return Ve(s=Object.keys(hb)).call(s,a)}))]}constructor(a,s){super(a,s),Z(this,"id",Mn(5,"connection-")),Z(this,"store",void 0),Z(this,"peerConnection",void 0),Z(this,"forceTurn",!1),Z(this,"remoteSDP",void 0),Z(this,"initialOffer",void 0),Z(this,"transportEventReceiver",void 0),Z(this,"statsFilter",void 0),Z(this,"extension",{useXR:se("USE_XR")}),Z(this,"localCapabilities",void 0),Z(this,"remoteCodecs",void 0),Z(this,"localCandidateCount",0),Z(this,"allCandidatesReceived",!1),Z(this,"isPreallocation",!1),Z(this,"preMediaMap",new Map),Z(this,"dataStreamChannelMap",new Map),Z(this,"establishPromise",void 0),Z(this,"recoveredDataChannelIds",[]),Z(this,"currentDataChannelId",1),Z(this,"supportAV1RtpSpec",!1),Z(this,"mutex",void 0),Z(this,"qualityLimitationReason",ub.NONE),Z(this,"isFirstConnected",!1),this.store=s,this.forceTurn=sq(a),this.mutex=new Gi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(Pp.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=xj(this.peerConnection,se("STATS_UPDATE_INTERVAL"),void 0,dr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,a.isPreallocation&&(this.isPreallocation=!0),this.establishPromise=this.establish()}getPreMedia(a){return this.preMediaMap.get(a)}isPreSub(){return this.preMediaMap.size>0}async updateRemoteRTPCapabilities(a,s){if(this.remoteCodecs=s,!this.remoteSDP)return void F.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(s));if(this.remoteSDP.updateRemoteCodec(a,s,this.store.codec)){const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l);const f=this.remoteSDP.toString();d==null||d(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}else F.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const l=await this.peerConnection.createOffer();if(!l.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const d=bh(l.sdp),f=await AK({filterRTX:!se("USE_PUB_RTX")&&!se("USE_SUB_RTX"),filterVideoFec:se("FILTER_VIDEO_FEC"),filterAudioFec:se("FILTER_AUDIO_FEC"),filterVideoCodec:se("FILTER_VIDEO_CODEC"),unsupportedVideoUplinkCodec:se("UNSUPPORTED_VIDEO_UPLINK_CODEC"),unsupportedVideoDownlinkCodec:se("UNSUPPORTED_VIDEO_DOWNLINK_CODEC")},this.extension);if(this.localCapabilities=ET(f),this.initialOffer=l,se("ENABLE_SVC")&&this.store.codec=="av1"){const y=await async function(){try{const _=new RTCPeerConnection;_.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:Hx.L1T3}]});const w=await _.createOffer();if(!w.sdp)return void _.close();const x=ss(w.sdp).mediaDescriptions[0];if(!x)return;const A=x.attributes.extmaps.find(I=>I.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return _.close(),A}catch{return}}();var a;y&&(this.supportAV1RtpSpec=!0,(a=f.send)===null||a===void 0||a.videoExtensions.push(y))}let m;return l.sdp&&kK(l.sdp)&&(m=ir(f),(s=m).send&&(Vg(Ye.VIDEO,s.send.videoExtensions),Vg(Ye.AUDIO,s.send.audioExtensions)),s.recv&&(Vg(Ye.VIDEO,s.recv.videoExtensions),Vg(Ye.AUDIO,s.recv.audioExtensions)),s.sendrecv&&(Vg(Ye.VIDEO,s.sendrecv.videoExtensions),Vg(Ye.AUDIO,s.sendrecv.audioExtensions))),ul(ul({},d),{},{rtpCapabilities:m||f,offerSDP:l.sdp})}catch(l){throw new Se(ie.GET_LOCAL_CONNECTION_PARAMS_FAILED,l.toString())}var s}async connect(a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&kK(this.initialOffer.sdp)&&(s=a.rtpCapabilities,l=this.localCapabilities,s.send&&(yT(Ye.VIDEO,s.send.videoExtensions,l.send.videoExtensions),yT(Ye.AUDIO,s.send.audioExtensions,l.send.audioExtensions)),s.recv&&(yT(Ye.VIDEO,s.recv.videoExtensions,l.recv.videoExtensions),yT(Ye.AUDIO,s.recv.audioExtensions,l.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return ir(this._localCapabilities)}get rtpCapabilities(){return ir(this._rtpCapabilities)}get candidates(){return ir(this._candidates)}get iceParameters(){return ir(this._iceParameters)}get dtlsParameters(){return ir(this._dtlsParameters)}constructor(_){let w=arguments.length>1&&arguments[1]!==void 0&&arguments[1],x=arguments.length>2&&arguments[2]!==void 0&&arguments[2];Z(this,"sessionDesc",void 0),Z(this,"_localCapabilities",void 0),Z(this,"_rtpCapabilities",void 0),Z(this,"_candidates",void 0),Z(this,"_originCandidates",void 0),Z(this,"_iceParameters",void 0),Z(this,"_isUseExtmapAllowMixed",void 0),Z(this,"_isUseLocalCodecs",void 0),Z(this,"_dtlsParameters",void 0),Z(this,"setup",void 0),Z(this,"currentMidIndex",void 0),Z(this,"cname",void 0),Z(this,"useLocalCodecsMids",[]),Z(this,"preloadSsrcs",[]),Z(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=w,this._isUseLocalCodecs=x,_=ir(_);const{iceParameters:A,dtlsParameters:I,candidates:L,rtpCapabilities:H,setup:$,localCapabilities:G,cname:ne}=_;this._rtpCapabilities=H,this._candidates=L,this._originCandidates=ir(L),this._iceParameters=A,this._dtlsParameters=I,this._localCapabilities=G,this.setup=$,this.cname=ne,[this.sessionDesc]=this.updateRemoteRTPCapabilities(H),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}checkPreloadSsrcs(_){return _.length===this.preloadSsrcs.length&&_.every(w=>{var x;return Ve(x=this.preloadSsrcs).call(x,w)})}preloadRemoteMedia(_){let w=0;const x=[],A=[];for(;_>0;){const I=[ND({ssrcId:RT+w},se("USE_SUB_RTX")?{rtx:RT+w+1}:{})],L="".concat(RT+w,"_").concat(AD+w),{ssrcs:H,ssrcGroups:$}=Sb(I,this.cname,se("SYNC_GROUP")?L:void 0),G=this.preCreateOrRecycleSendMedia("video",H,$,void 0),ne=[{ssrcId:AD+w}],te="".concat(RT+w,"_").concat(AD+w),{ssrcs:ce,ssrcGroups:pe}=Sb(ne,this.cname,se("SYNC_GROUP")?te:void 0),fe=this.preCreateOrRecycleSendMedia("audio",ce,pe,void 0);_--,w+=2,x.push(G,fe),A.push(H[0].ssrcId,ce[0].ssrcId)}return this.useLocalCodecsMids.push(...x),this.preloadSsrcs=A,{mids:x,preSSRCs:A,isAvailable:!0}}preCreateOrRecycleSendMedia(_,w,x,A){const I=this.rtpCapabilities.send.videoCodecs,L=this._isUseLocalCodecs||I.length===0?this.localCapabilities.recv:this.rtpCapabilities.send;F.debug("create or recycle send media without remote rtp capabilities, ssrcs ",w[0].ssrcId);const H=_===Ye.VIDEO?L.videoCodecs:L.audioCodecs,$=_===Ye.VIDEO?L.videoExtensions:L.audioExtensions;this.currentMidIndex+=1;const G="".concat(this.currentMidIndex);let ne={media:{mediaType:_,port:CT,protos:["UDP","TLS","RTP","SAVPF"],fmts:H.map(te=>te.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:$,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:w,ssrcGroups:x,rtcpFeedbackWildcards:[],payloads:H,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(G)}};return ne=this.mungSendMediaDesc(ne,A),this.sessionDesc.mediaDescriptions.push(ne),this.updateBundleMids(),G}toString(){return ph(this.sessionDesc)}send(_,w,x,A){const{ssrcs:I,ssrcGroups:L}=Sb(w,this.cname,se("SYNC_GROUP")?x:void 0),H=this.findPreloadMediaDesc(I);if(H){if(dr()&&this.firefoxSsrcMidMap.set(I[0].ssrcId,H.attributes.mid),A&&(A.twcc||A.remb)){const $=this.sessionDesc.mediaDescriptions.indexOf(H);return this.sessionDesc.mediaDescriptions[$]=this.mungSendMediaDesc(H,A),{mid:H.attributes.mid,needExchangeSDP:!0}}return{mid:H.attributes.mid,needExchangeSDP:!1}}{const $=this.findAvailableMediaIndex(_,I);let G;return $===-1||$===1&&(ji()||function(){const ne=sn();return!(ne.name!==pn.CHROME||!ne.osVersion)&&Number(ne.version)<=90}()||se("ENABLE_ENCODED_TRANSFORM")&&rd())||$===0&&!function(ne){const te=sn();return!(te.name!==pn.FIREFOX||!te.osVersion)&&Number(te.version)===ne}(138)&&se("USE_SUB_RTX")||nz()?(G=this.createOrRecycleSendMedia(_,I,L,"sendonly",A),this.updateBundleMids()):(G=ir(this.sessionDesc.mediaDescriptions[$]),G.attributes.direction="sendonly",G.attributes.ssrcs=I,G.attributes.ssrcGroups=L,this.sessionDesc.mediaDescriptions[$]=this.mungSendMediaDesc(G,A)),dr()&&this.firefoxSsrcMidMap.set(I[0].ssrcId,G.attributes.mid),{mid:G.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:_,needExchangeSDP:w}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:_.attributes.mid,needExchangeSDP:w}}batchSend(_){const w=_.map(I=>{let{kind:L,ssrcMsg:H,mslabel:$}=I;return this.send(L,H,$)}),x=[];let A=!1;return w.forEach(I=>{let{mid:L,needExchangeSDP:H}=I;H&&(A=!0),x.push(L)}),{mids:x,needExchangeSDP:A}}stopSending(_){const w=this.sessionDesc.mediaDescriptions.filter(x=>x.attributes.mid&&_.indexOf(x.attributes.mid)!==-1);if(w.length!==_.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");w.forEach(x=>{x.attributes.mid==="0"||dr()||nz()?x.attributes.ssrcs=[]:(x.attributes.ssrcs=[],x.attributes.direction="inactive",x.media.port="0")}),this.updateBundleMids()}mute(_){const w=this.sessionDesc.mediaDescriptions.find(x=>x.attributes.mid===_);if(!w)throw new Error("mediaDescription not found with ".concat(_," in remote SDP when calling RemoteSDP.mute."));w.attributes.direction="inactive"}unmute(_){const w=this.sessionDesc.mediaDescriptions.find(x=>x.attributes.mid===_);if(!w)throw new Error("mediaDescription not found with ".concat(_," in remote SDP when calling RemoteSDP.unmute."));w.attributes.direction="sendonly"}muteRemote(_){const w=this.sessionDesc.mediaDescriptions.filter(x=>Ve(_).call(_,x.attributes.mid||""));if(w.length!==_.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");w.forEach(x=>{x.attributes.direction="inactive"})}unmuteRemote(_){const w=this.sessionDesc.mediaDescriptions.filter(x=>Ve(_).call(_,x.attributes.mid||""));if(w.length!==_.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");w.forEach(x=>{x.attributes.direction="recvonly"})}receive(_,w,x,A){_.forEach((I,L)=>{this.createOrRecycleRecvMedia(I,[],"recvonly",w,x,A[L])}),this.updateBundleMids()}stopReceiving(_){const w=this.sessionDesc.mediaDescriptions.filter(x=>_.indexOf(x.attributes.mid)!==-1);if(w.length!==_.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");w.forEach(x=>{x.media.port="0",x.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(_){const w=this.sessionDesc||ss((x=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(x?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var x;this._rtpCapabilities=_;let A=!1;const I=this.rtpCapabilities.send,L=this.localCapabilities.send,H=this.localCapabilities.recv,$=H.videoCodecs,G=H.audioCodecs,ne=H.videoExtensions,te=H.audioExtensions;for(const ue of w.mediaDescriptions){var ce;if(ue.attributes.direction!=="sendonly"||typeof ue.attributes.mid!="string"||!Ve(ce=this.useLocalCodecsMids).call(ce,ue.attributes.mid)){if(A=!0,ue.attributes.iceUfrag=this._iceParameters.iceUfrag,ue.attributes.icePwd=this._iceParameters.icePwd,ue.attributes.fingerprints=this._dtlsParameters.fingerprints,ue.attributes.candidates=this._candidates,ue.attributes.setup=this.setup,ue.media.mediaType==="application"&&(ue.attributes.sctpPort="5000"),ue.media.mediaType==="video")if(this._isUseLocalCodecs&&ue.attributes.direction==="sendonly"){var pe;ue.media.fmts=$.map(xe=>xe.payloadType.toString(10)),ue.attributes.payloads=$,ue.attributes.extmaps=ne;const ye=ue.attributes.mid;typeof ye!="string"||Ve(pe=this.useLocalCodecsMids).call(pe,ye)||this.useLocalCodecsMids.push(ye)}else if(I.videoCodecs.length===0){const ye=L.videoCodecs.filter(xe=>{var Ae,Le;return(Ae=xe.rtpMap)===null||Ae===void 0?void 0:Ve(Le=Ae.encodingName.toLowerCase()).call(Le,"vp8")})||[L.videoCodecs[0]];ue.media.fmts=ye.map(xe=>xe.payloadType.toString(10)),ue.attributes.payloads=ye,ue.attributes.extmaps=[]}else ue.media.fmts=I.videoCodecs.map(ye=>ye.payloadType.toString(10)),ue.attributes.payloads=I.videoCodecs,ue.attributes.extmaps=I.videoExtensions;if(ue.media.mediaType==="audio")if(this._isUseLocalCodecs&&ue.attributes.direction==="sendonly"){var fe;ue.media.fmts=G.map(xe=>xe.payloadType.toString(10)),ue.attributes.payloads=G,ue.attributes.extmaps=te;const ye=ue.attributes.mid;typeof ye!="string"||Ve(fe=this.useLocalCodecsMids).call(fe,ye)||this.useLocalCodecsMids.push(ye)}else if(I.audioCodecs.length===0){const ye=L.audioCodecs.filter(xe=>{var Ae,Le;return(Ae=xe.rtpMap)===null||Ae===void 0?void 0:Ve(Le=Ae.encodingName.toLowerCase()).call(Le,"opus")})||[L.audioCodecs[0]];ue.media.fmts=ye.map(xe=>xe.payloadType.toString(10)),ue.attributes.payloads=ye,ue.attributes.extmaps=[]}else ue.media.fmts=I.audioCodecs.map(ye=>ye.payloadType.toString(10)),ue.attributes.payloads=I.audioCodecs,ue.attributes.extmaps=I.audioExtensions,$g(ue)}}return this.sessionDesc=w,this.currentMidIndex=w.mediaDescriptions.length-1,[this.sessionDesc,A]}updateCandidates(_){const w=this._originCandidates.filter(A=>A.transport==="udp"),x=[];if(w.forEach(A=>{x.push(ND(ND({},A),{},{foundation:"tcpcandidate",priority:Number(A.priority)-1+"",transport:"tcp",port:Number(A.port)+90+""}))}),w.length!==0){switch(_){case Ki.TCP_RELAY:this._candidates=x;break;case Ki.UDP_TCP_RELAY:case Ki.RELAY:this._candidates=[...w,...x];break;default:this._candidates=w}for(const A of this.sessionDesc.mediaDescriptions)A.attributes.candidates=this.candidates}}restartICE(_){_=ir(_),this._iceParameters=_,this.sessionDesc.mediaDescriptions.forEach(w=>{w.attributes.iceUfrag=_.iceUfrag,w.attributes.icePwd=_.icePwd})}predictReceivingMids(_){const w=[];for(let x=0;x<_;x++)w.push((this.currentMidIndex+x+1).toString(10));return w}findAvailableMediaIndex(_,w){return this.sessionDesc.mediaDescriptions.findIndex(x=>{const A=x.media.mediaType===_&&x.media.port!=="0"&&(x.attributes.direction==="sendonly"||x.attributes.direction==="sendrecv")&&x.attributes.ssrcs.length===0;if(dr()){if(A){const I=this.firefoxSsrcMidMap.get(w[0].ssrcId);return!(I||x.attributes.mid!=="0"&&x.attributes.mid!=="1")||!(!I||I!==x.attributes.mid)}return!1}return A})}createOrRecycleDataChannel(){for(const x of this.sessionDesc.mediaDescriptions)if(x.media.mediaType==="application")return{mediaDesc:x,needExchangeSDP:!1};this.currentMidIndex+=1;const _="".concat(this.currentMidIndex),w={media:{mediaType:"application",port:CT,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(_),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(w),{mediaDesc:w,needExchangeSDP:!0}}createOrRecycleRecvMedia(_,w,x,A,I,L){const H=_._mediaStreamTrack.kind,$=this.rtpCapabilities.recv,G=xb(H,$,this.localCapabilities.send,H===Ye.VIDEO?A:I),ne=H===Ye.VIDEO?$.videoExtensions:$.audioExtensions;this.currentMidIndex+=1;const te="".concat(this.currentMidIndex);let ce={media:{mediaType:H,port:CT,protos:["UDP","TLS","RTP","SAVPF"],fmts:G.map(fe=>fe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ne,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:w,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:G,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:x,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(te)}};ce=this.mungRecvMediaDsec(ce,_,L);const pe=this.findFirstClosedMedia(H);if(pe){const fe=this.sessionDesc.mediaDescriptions.indexOf(pe);this.sessionDesc.mediaDescriptions[fe]=ce}else this.sessionDesc.mediaDescriptions.push(ce);return ce}updateRemoteDtlsParameters(_){const w=new Set(this._dtlsParameters.fingerprints.map(I=>I.fingerprint)),x=new Set(_.map(I=>I.fingerprint));let A=!1;w.size!==x.size&&(A=!0);for(const I of w)x.has(I)||(A=!0);return A}updateRemoteCodec(_,w,x){const A=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(ce=>ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||"").filter(ce=>{var pe;return Ve(pe=Object.keys(hb)).call(pe,ce)}))],I=new Set(w);if(A.every(ce=>I.has(ce)))return F.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(w)),!1;const L=this._rtpCapabilities.recv.videoCodecs.filter(ce=>w.some(pe=>{var fe;return Ve(fe=ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||"").call(fe,pe)}));if(L.length===0)return F.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(A," codecs: ").concat(w)),!1;const H=[...new Set(L.map(ce=>ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||""))];let $;if(F.debug("updateRemoteCodec, from ".concat(A," to ").concat(H)),_.length===0)$=this.sessionDesc.mediaDescriptions.filter(ce=>ce.media.mediaType==="video"&&ce.attributes.direction==="recvonly");else if($=this.sessionDesc.mediaDescriptions.filter(ce=>ce.attributes.mid&&ce.media.mediaType==="video"&&Ve(_).call(_,ce.attributes.mid)&&ce.attributes.direction==="recvonly"),$.length!==_.length)return F.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(_,", codecs: ").concat(w)),!1;if(se("USE_PUB_RTX")||se("USE_SUB_RTX")){const ce=Eh(L,this.rtpCapabilities.recv.videoCodecs);L.push(...ce)}this._rtpCapabilities.recv.videoCodecs=L;const G=this.localCapabilities.send,ne=this.rtpCapabilities.recv,te=xb(Ye.VIDEO,ne,G,x);return $.forEach(ce=>{const pe=te.map(fe=>fe.payloadType.toString(10));F.debug("updateRemoteCodec mid: ".concat(ce.attributes.mid,", from"),ce.attributes.payloads,"to",te),ce.attributes.payloads=te,ce.media.fmts=pe}),!0}createOrRecycleSendMedia(_,w,x,A,I){const L=this.rtpCapabilities.send.videoCodecs,H=this._isUseLocalCodecs||L.length===0?this.localCapabilities.recv:this.rtpCapabilities.send,$=_===Ye.VIDEO?H.videoCodecs:H.audioCodecs,G=_===Ye.VIDEO?H.videoExtensions:H.audioExtensions;this.currentMidIndex+=1;const ne="".concat(this.currentMidIndex);let te={media:{mediaType:_,port:CT,protos:["UDP","TLS","RTP","SAVPF"],fmts:$.map(pe=>pe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:G,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:w,ssrcGroups:x,rtcpFeedbackWildcards:[],payloads:$,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:A,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ne)}};te=this.mungSendMediaDesc(te,I);const ce=this.findFirstClosedMedia(_);if(ce){const pe=this.sessionDesc.mediaDescriptions.indexOf(ce);this.sessionDesc.mediaDescriptions[pe]=te}else this.sessionDesc.mediaDescriptions.push(te);return te}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(_=>_.media.port!=="0").map(_=>_.attributes.mid)}mungRecvMediaDsec(_,w,x){const A=ir(_);return mD(A),Bg(A,w),gD(A,w),RK(A),bT(A,x,this.localCapabilities.send),A}mungSendMediaDesc(_,w){const x=ir(_);return bT(x,w,this.localCapabilities.recv),$g(x),x}updateRecvMedia(_,w){const x=this.sessionDesc.mediaDescriptions.findIndex(A=>A.attributes.mid===_);if(x!==-1){const A=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[x],w);this.sessionDesc.mediaDescriptions[x]=A}}bumpMid(_){this.currentMidIndex+=_}findFirstClosedMedia(_){return this.sessionDesc.mediaDescriptions.find(w=>dr()?w.media.port==="0"&&w.media.mediaType===_:w.media.port==="0")}findPreloadMediaDesc(_){return this.sessionDesc.mediaDescriptions.find(w=>{var x;return((x=w.attributes)===null||x===void 0||(x=x.ssrcs[0])===null||x===void 0?void 0:x.ssrcId)===_[0].ssrcId})}getSSRC(_){var w;return(w=this.sessionDesc.mediaDescriptions.find(x=>x.attributes.mid===_))===null||w===void 0?void 0:w.attributes.ssrcs}}(ul(ul({},a),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec,!(!se("ENABLE_PRE_SUB_WITH_PRE_PC")||!se("PRE_USE_LOCAL_CODECS"))&&Pj(this.store)),a.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const d=this.remoteSDP.toString(),f=OK(this.initialOffer.sdp,this.extension),m=this.logSDPExchange(f||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:f}),m==null||m(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d});const y=this.peerConnection.getTransceivers()[0];if(y!=null&&y.receiver&&this.tryBindTransportEvents(y.receiver),Pj(this.store))if(a.preallocation&&se("ENABLE_PRE_SUB_WITH_PRE_PC")){const _=se("PRE_SUB_NUM"),{mids:w,preSSRCs:x}=this.remoteSDP.preloadRemoteMedia(_);await wh(this.peerConnection,this.remoteSDP,this.extension),F.debug("[".concat(this.store.clientId,"] [P2PConnection] preload media, in pre pc,add preload ssrcs ").concat(x)),this.presetMedia(w,x)}else{const{preSSRCs:_=[]}=a,w=_.map(A=>A.ssrcMsg[0].ssrcId);if(_.length===0)return;const{mids:x}=this.remoteSDP.batchSend(_.map(A=>Object.assign({},A)));await wh(this.peerConnection,this.remoteSDP,this.extension),F.debug("[P2PConnection.connect] preload media, after join, add preload ssrcs ".concat(w)),this.presetMedia(x,w)}}catch(d){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(d.toString()))}var s,l}presetMedia(a,s){a.forEach((l,d)=>{this.peerConnection.getTransceivers().forEach(f=>{if(f.mid!=null&&l===f.mid&&f.receiver.track){const m=f.receiver.track;let y;m.kind==="video"&&se("ENABLE_PRE_RENDER")&&(y=new Hj({trackId:"track-".concat(m.kind,"-unknown-").concat(this.store.clientId,"_").concat(Mn(5,""))},!0),y.updateVideoTrack(m),y.onFirstVideoFrameRender=()=>{var _;const w=this.preMediaMap.get(s[d]);w&&(w.firstVideoRender=Date.now()),(_=this.onFirstVideoRender)===null||_===void 0||_.call(this,s[d])},y.play(this.store.sessionId||void 0)),this.preMediaMap.set(s[d],{mid:l,track:m,player:y,transceiver:f})}}),this.store.peerReceiver()})}checkDtlsParameters(a){return!!this.remoteSDP&&a.length>0&&this.remoteSDP.updateRemoteDtlsParameters(a)}async updateRemoteConnect(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");let s=!1;const{rtpCapabilities:l}=a;if([,s]=this.remoteSDP.updateRemoteRTPCapabilities(l),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0){const m=this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);s=s||m}const{preSSRCs:d=[]}=a,f=d.map(m=>m.ssrcMsg[0].ssrcId);if(!this.remoteSDP.checkPreloadSsrcs(f)){const m=[],y=[];if(Array.from(this.preMediaMap.entries()).every(_=>{let[w,{mid:x,player:A,track:I}]=_;return m.push(x),y.push(w),this.preMediaMap.delete(w),A&&A.destroy(),!0}),m.length>0&&(this.remoteSDP.stopSending(m),await wh(this.peerConnection,this.remoteSDP,this.extension),F.warn("[P2PConnection.updateRemoteConnect] preload media, failed, del preload ssrcs ".concat(y)),nt.reportApiInvoke(this.store.sessionId,{name:Er.PRELOAD_MEDIA_FAILED,options:[d,y],tag:rr.TRACER}).onSuccess()),d.length>0){const{mids:_}=this.remoteSDP.batchSend(d.map(w=>Object.assign({},w)));await wh(this.peerConnection,this.remoteSDP,this.extension),F.debug("[P2PConnection.updateRemoteConnect] preload media, after join, add preload ssrcs ".concat(f)),this.presetMedia(_,f)}}s?(await wh(this.peerConnection,this.remoteSDP,this.extension),F.debug("[P2PConnection] updateRemoteConnect by exchanging SDP.")):F.debug("[P2PConnection] updateRemoteConnect no need to exchange SDP, because no need to update remote codecs (use local codecs)")}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(s.toString()))}}send(a,s,l){var d=this;return To(function*(){const f=yield ln(d.mutex.lock("From P2PConnection.send"));try{if(!d.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const m=[],y=vT();a.forEach(G=>{const ne=d.peerConnection.addTransceiver(G._mediaStreamTrack,ul({direction:"sendonly"},G.trackMediaType==="video"&&d.supportAV1RtpSpec&&y?{sendEncodings:[{scalabilityMode:y}]}:{}));m.push(ne),G._updateRtpTransceiver(ne)}),dr()&&se("SIMULCAST")===!0&&(yield ln(d.applySimulcastForFirefox(m,a)));const _=yield ln(d.peerConnection.createOffer()),w=d.remoteSDP.predictReceivingMids(a.length),x=d.mungSendOfferSDP(_.sdp,a,w),A=ss(x),I=w.map(G=>{const ne=A.mediaDescriptions.find(te=>te.attributes.mid===G);if(!ne)throw new Error("Cannot extract ssrc from mediaDescription.");return xK(ne,se("USE_PUB_RTX"))});let L;try{L=yield I}catch(G){L=[],d.remoteSDP.receive(a,s,l,L);const ne=d.remoteSDP.toString();throw yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(d.peerConnection.setRemoteDescription({type:"answer",sdp:ne})),yield ln(d.stopSending(w,!0)),G}d.remoteSDP.receive(a,s,l,L);const H=d.remoteSDP.toString(),$=d.logSDPExchange(x,"offer","local","send");return yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(d.applySimulcastEncodings(m,a)),yield ln(d.applySendEncodings(m,a)),$==null||$(H),yield ln(d.peerConnection.setRemoteDescription({type:"answer",sdp:H})),m.map((G,ne)=>{const te=w[ne];return{localSSRC:I[ne],id:te,transceiver:G}})}catch(m){throw m instanceof Se?m:new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(m.toString()))}finally{f()}})()}async createDataChannels(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let l=this.dataStreamChannelMap.get(a);if(l&&l.readyState==="open")F.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const f=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof f!="number")throw new Error("create DataChannel error, because cannot get dc id");l=this.peerConnection.createDataChannel("datastream-channel",{id:f,negotiated:!0,ordered:!1,maxRetransmits:se("DATASTREAM_MAX_RETRANSMITS")}),l.binaryType="arraybuffer",this.dataStreamChannelMap.set(a,l)}s.forEach(f=>{f._updateOriginDataChannel(l)});const{needExchangeSDP:d}=this.remoteSDP.sendDataChannel();if(d){const f=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:f});const m=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(m),F.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else F.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(l){throw l instanceof Se?l:new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(l.toString()))}}async stopDataChannels(a){try{const s=this.dataStreamChannelMap.get(a);return s&&(s.id&&this.recoveredDataChannelIds.push(s.id),s.close()),void this.dataStreamChannelMap.delete(a)}catch(s){throw s instanceof Se?s:new Se(ie.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(s.toString()))}}async stopSending(a,s){const l=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const d=this.peerConnection.getTransceivers().filter(_=>a.indexOf(_.mid)!==-1);if(d.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");d.map(_=>{var w;IT(this.id+_.mid,this),_.direction="inactive",(w=_.stop)===null||w===void 0||w.call(_)});const f=await this.peerConnection.createOffer(),m=this.logSDPExchange(f.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(a);const y=this.remoteSDP.toString();m==null||m(y),await this.peerConnection.setRemoteDescription({type:"answer",sdp:y})}catch(d){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(d.toString()))}finally{l&&l()}}async receive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(a,s,l,d);m&&(await wh(this.peerConnection,this.remoteSDP,this.extension),F.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," by exchanging SDP.")));const y=this.peerConnection.getTransceivers().find(_=>_.mid===f);if(!y)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:y.receiver.track,id:f,transceiver:y}}catch(f){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:l}=this.remoteSDP.batchSend(a);return l&&(await wh(this.peerConnection,this.remoteSDP,this.extension),F.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),s.map(d=>{const f=this.peerConnection.getTransceivers().find(m=>m.mid===d);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:d,transceiver:f}})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");a.forEach(f=>{Array.from(this.preMediaMap.entries()).some(m=>{let[y,{mid:_,player:w}]=m;if(_===f)return this.preMediaMap.delete(y),w&&w.destroy(),!0})}),this.remoteSDP.stopSending(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.mute(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(s.toString()))}}async unmuteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.unmute(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(s.toString()))}}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(m=>{m.direction="inactive"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.muteRemote(a);const f=this.remoteSDP.toString();d==null||d(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async(m,y)=>{m.direction="sendonly"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.unmuteRemote(a),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(a,this.remoteCodecs,this.store.codec);const f=this.remoteSDP.toString();d==null||d(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(a){var s=this;return To(function*(){const l=yield ln(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const d=un().supportPCSetConfiguration,f=se("FORCE_TURN_TCP")||s.forceTurn;if(a===Ki.RELAY&&!d)return;if(d&&!f){const A=a===Ki.RELAY?"relay":"all",I=s.peerConnection.getConfiguration();I.iceTransportPolicy!==A&&(F.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(I.iceTransportPolicy,"] to [").concat(A,"]")),I.iceTransportPolicy=A,s.peerConnection.setConfiguration(I))}s.remoteSDP.updateCandidates(a);const m=yield ln(s.peerConnection.createOffer({iceRestart:!0}));if(!m.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const y=bh(m.sdp),{remoteIceParameters:_}=yield y.iceParameters;s.remoteSDP.restartICE(_);const w=s.remoteSDP.toString(),x=s.logSDPExchange(m.sdp||"","offer","local","restartICE");s.store.descriptionStart(),yield ln(s.peerConnection.setLocalDescription(m)),x==null||x(w),yield ln(s.peerConnection.setRemoteDescription({type:"answer",sdp:w}))}catch(d){F.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),d)}finally{l()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const a=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(Ki.TCP_RELAY),await wh(this.peerConnection,this.remoteSDP,this.extension)}catch(s){F.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),s)}finally{a()}}close(){var a;this.peerConnection.getTransceivers().forEach(s=>{IT(this.id+s.mid,this)}),this.preMediaMap.forEach(s=>{let{player:l}=s;l&&l.destroy()}),this.preMediaMap.clear(),this.peerConnection.close(),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return ul(ul({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const l=await this.peerConnection.createOffer(),d=this.mungSendOfferSDP(l.sdp,[s],[a]);this.remoteSDP.updateRecvMedia(a,s);const f=this.remoteSDP.toString(),m=this.logSDPExchange(d,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:d}),m==null||m(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new Se(ie.EXCHANGE_SDP_FAILED,l.toString())}}async updateSendParameters(a,s){const l=this.peerConnection.getTransceivers().filter(d=>d.mid===a);l.length===1&&(this.isVP8Simulcast(s)?dr()||await this.applySimulcastEncodings(l,[s]):await this.applySendEncodings(l,[s]))}setStatsRemoteVideoIsReady(a,s){this.statsFilter.setVideoIsReady2(a,s)}async replaceTrack(a,s){const l=this.peerConnection.getTransceivers().find(d=>d.mid===s);l&&await l.sender.replaceTrack(a._mediaStreamTrack)}async getSelectedCandidatePair(){const a=this.peerConnection.getReceivers();if(a.length>0&&a[0].transport&&a[0].transport.iceTransport&&a[0].transport.iceTransport.getSelectedCandidatePair&&a[0].transport.iceTransport.getSelectedCandidatePair()){const s=a[0].transport.iceTransport,{local:l,remote:d}=s.getSelectedCandidatePair();return{local:ul(ul({},nu),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port}),remote:ul(ul({},nu),{},{candidateType:d.type,protocol:d.protocol,address:d.address,port:d.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=a=>{if(a&&(a.errorCode||a.errorText)){var s;const l="code: ".concat(a.errorCode,", message: ").concat(a.errorText),d=a.port?"local: ".concat(a.port):"",f=mp(a.url||"");F.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(l,"), url: ").concat(f||"",", host_candidate:").concat(d)),(s=this.onICECandidateError)===null||s===void 0||s.call(this,l)}},this.peerConnection.onicegatheringstatechange=a=>{a&&a.target&&"iceGatheringState"in a.target&&F.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(a.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,F.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,F.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},se("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const s={iceServers:[]},l=a.cloudProxyServer||"disabled";return a.iceServers?s.iceServers=a.iceServers:a.turnServer&&(ob(a.turnServer.servers)?s.iceServers=a.turnServer.servers:se("NEW_TURN_MODE")&&s.iceServers&&l==="disabled"?(se("USE_TURN_SERVER_OF_GATEWAY")?a.turnServer.serversFromGateway&&s.iceServers.push(...Pp.newTurnServerConfigToIceServers(a.turnServer.serversFromGateway)):s.iceServers.push(...Pp.newTurnServerConfigToIceServers(a.turnServer.servers)),se("NEW_FORCE_TURN")&&(s.iceTransportPolicy="relay")):a.turnServer.mode!=="off"&&(s.iceServers&&s.iceServers.push(...Pp.turnServerConfigToIceServers(a.turnServer.servers)),se("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&a.turnServer.serversFromGateway&&s.iceServers.push(...Pp.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),se("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(d=>{d.forceturn&&(s.iceTransportPolicy="relay")}))),se("ENABLE_ENCODED_TRANSFORM")&&un().supportWebRTCEncodedTransform&&(s.encodedInsertableStreams=!0),s}static turnServerConfigToIceServers(a){const s=[];return a.forEach(l=>{l.security?l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(yh(l.turnServerURL),":").concat(l.tcpport,"?transport=tcp")}):(l.udpport&&!se("FORCE_TURN_TCP")&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.udpport,"?transport=udp")}),l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.tcpport,"?transport=tcp")}))}),s}static newTurnServerConfigToIceServers(a){const s=[];return a.forEach(l=>{const d=se("NEW_TURN_MODE");d===1?s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=udp")}):d===2?s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=tcp")}):d===3?s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(yh(l.turnServerURL),":443?transport=tcp")}):d===4&&(s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=udp")}),s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=tcp")}),s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(yh(l.turnServerURL),":443?transport=tcp")}))}),s}tryBindTransportEvents(a){const s=a.transport;if(s){this.transportEventReceiver=a,s.onstatechange=()=>{var d;s!=null&&s.state&&((d=this.onDTLSTransportStateChange)===null||d===void 0||d.call(this,s.state))},s.onerror=d=>{var f;(f=this.onDTLSTransportError)===null||f===void 0||f.call(this,"error"in d?d.error:d)};const l=s.iceTransport;l&&(l.onstatechange=()=>{const d=s==null?void 0:s.iceTransport.state;var f;d&&((f=this.onICETransportStateChange)===null||f===void 0||f.call(this,d))},l.getSelectedCandidatePair&&(l.onselectedcandidatepairchange=()=>{if(l.getSelectedCandidatePair()){const{local:d,remote:f}=l.getSelectedCandidatePair()||{};if(d&&f){const m=d.address+":"+d.port,y=f.address+":"+f.port;F.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(mp(m)),", remote ").concat(JSON.stringify(mp(y))))}}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(a,s){var l,d;if(s||(s=this.peerConnection.getSenders().find(G=>G.track===a._mediaStreamTrack)),!s)return F.warn("[".concat(a.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(a))return F.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!un().supportSetRtpSenderParameters)return F.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const f={},m={};switch(a._optimizationMode){case"motion":f.degradationPreference="maintain-framerate";break;case"detail":f.degradationPreference="maintain-resolution";break;case"balanced":f.degradationPreference="balanced"}const y=function($,G){return $.getTransceivers().find(ne=>ne.sender.track===G||ne.receiver.track===G)}(this.peerConnection,a._mediaStreamTrack),_=cIe(a);if(function($){var G;return!(!se("ENABLE_AG_ADAPTATION")||!($ instanceof eT||Ve(G=$._hints).call(G,jn.CUSTOM_TRACK))||!se("FORCE_SUPPORT_AG_ADAPTATION")&&!(ez(14,0,!1)&&tz(17,4)||QH(14)&&oj(17,4,!0)))}(a)&&y&&s&&_&&this.getLocalVideoStats&&Ve(l=["vp8","vp9"]).call(l,this.store.codec)){var w;const $=f.degradationPreference||(Ve(w=a._hints).call(w,jn.CUSTOM_TRACK)?se("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(G,ne,te,ce,pe,fe){if(IT(G,te),pe(ne),ce!=="balanced"&&ce!=="maintain-framerate"&&ce!=="maintain-resolution")return;let ue=-1;rq(G,ne);const ye=window.setInterval(()=>{const Ae=AT.get(G);if(!se("ENABLE_AG_ADAPTATION")||!Ae)return IT(G,te),void pe(ne);const Le=fe();if(Le.sendPackets>0&&Le.OutgoingAvailableBandwidth>0){if(ue===-1)return void(ue=Date.now());if(Date.now()-ue<1e3)return;const Ht=Le.sendFrameRate,qt=Le.OutgoingAvailableBandwidth,[Rt,bn]=EOe(G,Ht,qt,Ae.adaptationConfig,ne,ce);bn&&(te.qualityLimitationReason=bn),Rt&&Ae.adaptationConfig.scale!==Rt.scale&&(F.debug("[".concat(G,"] applyAdaptation: ").concat(te.qualityLimitationReason,`
           sendFps `).concat(Ht,", bwe ").concat(qt,", switch from ").concat(Ae.adaptationConfig.scale," to ").concat(Rt.scale," ")),Ae.adaptationConfig=ID(ID({},Ae.adaptationConfig),Rt),pe(Rt))}},se("CHECK_LOCAL_STATS_INTERVAL")),xe=ID({},ne);AT.set(G,{timer:ye,adaptationConfig:xe,originConfig:ne,adaptationFunc:pe}),F.debug("[".concat(G,"] start adaptation, originConfig: ").concat(JSON.stringify(ne),", degradationPreference: ").concat(ce))})(this.id+y.mid,_,this,$,G=>{s&&this.updateAdaptation(s,G)},this.getLocalVideoStats.bind(this))}if(a._encoderConfig){var x;const{bitrateMax:$,frameRate:G,scaleResolutionDownBy:ne}=a._encoderConfig;$&&(m.maxBitrate=1e3*$),(Ve(x=a._hints).call(x,jn.LOW_STREAM)||a.isUseScaleResolutionDownBy)&&(G&&(m.maxFramerate=Os(G)),ne&&ne>=1&&(m.scaleResolutionDownBy=ne))}const{maxFramerate:A}=se("ENCODER_CONFIG_LIMIT");if(A&&typeof A=="number"&&(m.maxFramerate=m.maxFramerate?Math.min(m.maxFramerate,A):A),se("DSCP_TYPE")&&id()){var I;const $=se("DSCP_TYPE");Ve(I=["very-low","low","medium","high"]).call(I,$)&&(m.networkPriority=$)}const L=s.getParameters(),H=(d=L.encodings)===null||d===void 0?void 0:d[0];dr()&&!H&&(f.encodings=[m]),H&&Object.assign(H,m),Object.assign(L,f),F.debug("[".concat(a.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(L.encodings))),await s.setParameters(L),await async function($,G,ne){try{var te;if(!un().supportSetRtpSenderParameters||!function(ye){return ye==="vp9"||ye==="av1"}($)||!se("ENABLE_SVC"))return;const ce={},pe={},fe=G.getParameters(),ue=(te=fe.encodings)===null||te===void 0?void 0:te[0];pe.scalabilityMode=vT(ne),ue&&Object.assign(ue,pe),Object.assign(fe,ce),await G.setParameters(fe),F.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(fe.encodings)))}catch(ce){F.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",ce)}}(this.store.codec,s,se("SVC_MODE"))}async updateAdaptation(a,s){var l,d;if(!a)return F.debug("[updateAdaptation] no rtpSender found");if(!un().supportSetRtpSenderParameters)return F.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const f={},{bitrateMax:m,frameRate:y,scaleResolutionDownBy:_}=s;m&&(f.maxBitrate=1e3*m),y&&(f.maxFramerate=Os(y)),_&&_>=1&&Ve(l=["vp8","vp9"]).call(l,this.store.codec)&&(f.scaleResolutionDownBy=_);const w=a.getParameters(),x=(d=w.encodings)===null||d===void 0?void 0:d[0];x&&Object.assign(x,f),Object.assign(w,{});try{await a.setParameters(w),F.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(w.encodings)))}catch(A){!("transport"in a)||a.transport&&a.transport.state==="connected"?this.peerConnectionState!=="connected"?F.debug("[updateAdaptation] peerConnection not connected}"):F.debug("[updateAdaptation] updateRtpSenderEncodings failed",A):F.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(a,s){try{if(!un().supportSetRtpSenderParameters||a.length!==s.length)return;for(let l=0;l<a.length;l++){const d=a[l],f=s[l];f instanceof Wn&&!this.isVP8Simulcast(f)&&await this.updateRtpSenderEncodings(f,d.sender)}}catch{F.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(a,s,l){const d=ss(a);return s.forEach((f,m)=>{const y=l[m],_=d.mediaDescriptions.find(w=>w.attributes.mid===y);_&&(Bg(_,f),NK(_,f,this.store.codec))}),ph(d)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,s,l)=>{var d;(d=this.onFirstVideoDecoded)===null||d===void 0||d.call(this,a,s,l)},this.statsFilter.onSelectedLocalCandidateChanged=(a,s)=>{var l;(l=this.onSelectedLocalCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,s)=>{var l;(l=this.onSelectedRemoteCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onFirstVideoDecodedTimeout=a=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(a,s){if(a.length===s.length)for(let _=0;_<a.length;_++){var l,d,f,m,y;const w=a[_],x=s[_];if(x instanceof Wn&&!Ve(l=x._hints).call(l,jn.LOW_STREAM)&&(d=x._encoderConfig)!==null&&d!==void 0&&d.bitrateMax&&((f=x._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(m=x._scalabilityMode)!==null&&m!==void 0&&m.numSpatialLayers&&((y=x._scalabilityMode)===null||y===void 0?void 0:y.numSpatialLayers)>1&&this.store.codec==="vp8"){const A={},I={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};A.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const L=w.sender.getParameters();await w.sender.setParameters(Object.assign(L,A))}}}async applySimulcastEncodings(a,s){if(!dr()&&a.length===s.length)for(let l=0;l<a.length;l++){const d=s[l];if(d instanceof Wn&&this.isVP8Simulcast(d)){const f=a[l],m={},y={high:1e3*(d._encoderConfig.bitrateMax-50),medium:5e4};m.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:y.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:y.medium,scaleResolutionDownBy:4}];const _=f.sender.getParameters();await f.sender.setParameters(Object.assign(_,m))}}}isVP8Simulcast(a){var s,l,d,f,m;return!!(a instanceof Wn&&se("SIMULCAST")&&this.store.codec==="vp8"&&!Ve(s=a._hints).call(s,jn.LOW_STREAM)&&(l=a._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((d=a._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(f=a._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=a._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1)}logSDPExchange(a,s,l,d){if(se("SDP_LOGGING"))return F.upload("[".concat(this.store.clientId,"] exchanging ").concat(l," ").concat(s," SDP during P2PConnection.").concat(d,`
`),a),s==="offer"?f=>{this.logSDPExchange(f,"answer",l==="local"?"remote":"local",d)}:void 0}async getRemoteSSRC(a){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(a);return s&&s.length!==0?s[0].ssrcId:void 0}setConfiguration(a){if(un().supportPCSetConfiguration){const s=Pp.resolvePCConfiguration(a);this.peerConnection.setConfiguration(s)}a.isPreallocation&&(this.isPreallocation=!0)}},tt(on.prototype,"updateRemoteRTPCapabilities",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"updateRemoteRTPCapabilities"),on.prototype),tt(on.prototype,"connect",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"connect"),on.prototype),tt(on.prototype,"updateRemoteConnect",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"updateRemoteConnect"),on.prototype),tt(on.prototype,"createDataChannels",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"createDataChannels"),on.prototype),tt(on.prototype,"receive",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"receive"),on.prototype),tt(on.prototype,"batchReceive",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"batchReceive"),on.prototype),tt(on.prototype,"stopReceiving",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"stopReceiving"),on.prototype),tt(on.prototype,"muteRemote",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"muteRemote"),on.prototype),tt(on.prototype,"unmuteRemote",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"unmuteRemote"),on.prototype),tt(on.prototype,"muteLocal",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"muteLocal"),on.prototype),tt(on.prototype,"unmuteLocal",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"unmuteLocal"),on.prototype),tt(on.prototype,"close",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"close"),on.prototype),tt(on.prototype,"updateEncoderConfig",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"updateEncoderConfig"),on.prototype),tt(on.prototype,"updateSendParameters",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"updateSendParameters"),on.prototype),tt(on.prototype,"replaceTrack",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"replaceTrack"),on.prototype),tt(on.prototype,"updateAdaptation",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"updateAdaptation"),on.prototype),tt(on.prototype,"getRemoteSSRC",[Ya],Object.getOwnPropertyDescriptor(on.prototype,"getRemoteSSRC"),on.prototype),on);function Ya(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("From P2PConnection.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}function jD(r,a){let s=document.createElement("video"),l=document.createElement("canvas");s.setAttribute("style","display:none"),l.setAttribute("style","display:none"),s.setAttribute("muted",""),s.muted=!0,s.setAttribute("autoplay",""),s.autoplay=!0,s.setAttribute("playsinline",""),l.width=Os(a.width),l.height=Os(a.height);const d=Os(a.framerate||15);document.body.append(s),document.body.append(l);let f=r._mediaStreamTrack;s.srcObject=new MediaStream([f]),s.play();const m=l.getContext("2d");if(!m)throw new Ee(ie.UNEXPECTED_ERROR,"can not get canvas context");const y=un(),_=l.captureStream(y.supportRequestFrame?0:d).getVideoTracks()[0];_.canvas||(_.canvas=l),l.startCapture=()=>{if(!s)return l.stopCapture&&l.stopCapture();if(s.paused&&s.play(),s.videoHeight>2&&s.videoWidth>2){const x=s.videoWidth,A=s.videoHeight/x,I=l.width*A;Math.abs(I-l.height)>=2&&(F.debug("adjust low stream resolution","".concat(l.width,"x").concat(l.height," -> ").concat(l.width,"x").concat(I)),l.height=I)}m.drawImage(s,0,0,l.width,l.height),_.requestFrame&&_.requestFrame(),f!==r._mediaStreamTrack&&(f=r._mediaStreamTrack,s.srcObject=new MediaStream([f]))},l.stopCapture=Fj(()=>l.startCapture&&l.startCapture(),d);const w=_.stop;return _.stop=()=>{w.call(_),s&&(s.remove(),s.srcObject=null,s=null),l&&(l.width=0,l.remove(),l.stopCapture&&l.stopCapture(),l.startCapture=void 0,l.stopCapture=void 0,l=null),F.debug("clean low stream renderer")},_}var cq=function(r){return r[r.Video_Send_Type=190]="Video_Send_Type",r}(cq||{}),dl=function(r){return r[r.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",r[r.Video_Send_Freeze=2082]="Video_Send_Freeze",r[r.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",r[r.Video_Recv_Freeze=2084]="Video_Recv_Freeze",r[r.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",r[r.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",r[r.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",r[r.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",r}(dl||{}),Dt=function(r){return r[r.Video_Send_Retransmit=2062]="Video_Send_Retransmit",r[r.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",r[r.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",r[r.Video_Send_Transmit=2066]="Video_Send_Transmit",r[r.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",r[r.Video_Capture_Height=2033]="Video_Capture_Height",r[r.Video_Capture_Width=2035]="Video_Capture_Width",r[r.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",r[r.Video_Send_Low_Height=2073]="Video_Send_Low_Height",r[r.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",r[r.Video_Send_Low_Width=2077]="Video_Send_Low_Width",r[r.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",r[r.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",r[r.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",r[r.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",r[r.Video_Send_Width=2003]="Video_Send_Width",r[r.Video_Send_Height=2004]="Video_Send_Height",r[r.Video_Send_Disabled=2095]="Video_Send_Disabled",r[r.Video_Send_Adaptation=2032]="Video_Send_Adaptation",r[r.Video_Send_Player_Status=2128]="Video_Send_Player_Status",r[r.Video_Send_Nacks=2009]="Video_Send_Nacks",r[r.Video_Send_Plis=2010]="Video_Send_Plis",r[r.Video_Send_Firs=2011]="Video_Send_Firs",r[r.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",r[r.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",r[r.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",r[r.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",r[r.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",r[r.Video_Send_Bitrate=2012]="Video_Send_Bitrate",r[r.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",r[r.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",r[r.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",r[r.Audio_Send_Level=2038]="Audio_Send_Level",r[r.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",r[r.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",r[r.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",r[r.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",r[r.Audio_Send_Freeze=2081]="Audio_Send_Freeze",r[r.Audio_Send_Disabled=2096]="Audio_Send_Disabled",r[r.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",r[r.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",r[r.Video_Recv_Height=2019]="Video_Recv_Height",r[r.Video_Recv_Width=2018]="Video_Recv_Width",r[r.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",r[r.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",r[r.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",r[r.Video_Recv_Nacks=2026]="Video_Recv_Nacks",r[r.Video_Recv_Plis=2027]="Video_Recv_Plis",r[r.Video_Recv_Firs=2028]="Video_Recv_Firs",r[r.Video_Recv_Disabled=2101]="Video_Recv_Disabled",r[r.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",r[r.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",r[r.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",r[r.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",r[r.Audio_Render_Level=2043]="Audio_Render_Level",r[r.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",r[r.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",r[r.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",r[r.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",r[r.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",r[r.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",r[r.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",r[r.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",r[r.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",r[r.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",r[r.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",r[r.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",r}(Dt||{}),Ai=function(r){return r[r.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",r[r.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",r[r.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",r[r.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",r[r.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",r[r.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",r[r.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",r[r.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",r[r.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",r[r.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",r[r.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",r[r.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",r[r.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",r[r.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",r[r.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",r[r.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",r[r.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",r[r.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",r[r.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",r[r.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",r[r.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",r}(Ai||{}),Xa=function(r){return r[r.RTT=2006]="RTT",r[r.CONN_TYPE=801]="CONN_TYPE",r[r.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",r}(Xa||{}),PT=function(r){return r[r.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",r}(PT||{});const vp=1e3,kT=6,Nb=3,xOe=Math.max(kT,Nb,60);function _t(r,a,s){s!=null&&Number.isFinite(s)&&(r[a]=Math.round(Math.max(0,s)))}function lq(r){const a={[Xa.CONN_TYPE]:0,[Xa.RTT]:r.rtt,[Xa.STATS_UPDATE_INTERVAL]:r.updateInterval?Math.round(Math.max(0,r.updateInterval)):void 0};switch(r.selectedCandidatePair.localCandidate.candidateType){case"relay":{const s=r.selectedCandidatePair.localCandidate.relayProtocol;s==="udp"&&(a[Xa.CONN_TYPE]=1),s==="tcp"&&(a[Xa.CONN_TYPE]=3),s==="tls"&&(a[Xa.CONN_TYPE]=4);break}case"srflx":a[Xa.CONN_TYPE]=2;break;case"unknown":a[Xa.CONN_TYPE]=5;break;default:a[Xa.CONN_TYPE]=0}return a}function uq(r){let a=0;switch(r){case"none":a=0;break;case"cpu":a=1;break;case"bandwidth":a=2;break;case"other":a=3}return a}class dq extends lr{constructor(a){super(),Z(this,"store",void 0),Z(this,"uploadWRTCStatsTimer",void 0),Z(this,"uploadOutboundDenoiserStatsTimer",void 0),Z(this,"uploadExtStatsTimer",void 0),Z(this,"uploadExtUsageStatsTimer",void 0),Z(this,"uploadInboundExtStatsTimer",void 0),Z(this,"requestStats",void 0),Z(this,"requestTransportStats",void 0),Z(this,"requestLocalMedia",void 0),Z(this,"requestRemoteMedia",void 0),Z(this,"requestAllTracks",void 0),Z(this,"requestVideoIsReady",void 0),Z(this,"requestUploadStats",void 0),Z(this,"requestUpload",void 0),Z(this,"uploadOutboundStarted",!1),Z(this,"uploadInboundStarted",!1),Z(this,"uploadTransportStarted",!1),Z(this,"uploadBaseStatsStarted",!1),Z(this,"uploadExtensionUsageStarted",!1),Z(this,"lastRecvStats",void 0),Z(this,"lastSendStats",void 0),Z(this,"lastRefRecvStats",void 0),Z(this,"lastRefSendStats",void 0),Z(this,"lastNormalRecvStats",void 0),Z(this,"lastNormalSendStats",void 0),Z(this,"lastExtendStats",{}),Z(this,"needUploadStats",{}),Z(this,"needUploadRenderFreezeTime",!0),Z(this,"lastUploadCompensateTime",-1),Z(this,"uploadCompensateDeltaTime",0),this.store=a}uploadWRTCStats(a){if(!this.requestStats||!this.requestUploadStats)return;const s=a%Nb==0,l=a%kT==0,d=a%60==0;let f,m;if(this.uploadTransportStarted&&(f=this.requestStats(),this.store.useP2P&&(m=this.requestStats(!0))),!f&&this.uploadOutboundStarted&&(f=this.requestStats()),!m&&this.uploadInboundStarted&&(m=this.requestStats(!0)),f||m){var y;const _={};if(this.uploadTransportStarted&&f){const x=this.getTransportStats(f,m,s);x&&(_.misc=[x])}if(this.uploadOutboundStarted&&f){const x=this.getOutboundStats(f,l?this.lastNormalSendStats:void 0,s?this.lastRefSendStats:void 0,this.lastSendStats,d);x&&(_.outbound=[x])}if(this.uploadInboundStarted&&m){this.uploadCompensateStats(a);const x=this.getInboundStats(m,l?this.lastNormalRecvStats:void 0,s?this.lastRefRecvStats:void 0,this.lastRecvStats);x&&(_.inbound=x)}const w=(y=this.requestTransportStats)===null||y===void 0?void 0:y.call(this).connectState;w&&(Array.isArray(_.misc)?_.misc[0]&&_.misc[0].addition&&(_.misc[0].addition[PT.RTC_PEER_CONNECTION_STATE]=Sj[w]):_.misc=[{addition:{[PT.RTC_PEER_CONNECTION_STATE]:Sj[w]}}]),this.needUploadStats.sendType&&(Array.isArray(_.outbound)&&_.outbound[0]&&_.outbound[0].high&&(_.outbound[0].high[cq.Video_Send_Type]=this.needUploadStats.sendType),this.needUploadStats.sendType=void 0),this.requestUploadStats(_)}this.lastRecvStats=m,this.lastSendStats=f,l&&(this.lastNormalRecvStats=m,this.lastNormalSendStats=f),s&&(this.lastRefRecvStats=m,this.lastRefSendStats=f)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let a=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var s,l;const d=(s=this.requestTransportStats)===null||s===void 0?void 0:s.call(this);return void(d&&((l=this.requestUploadStats)===null||l===void 0||l.call(this,{misc:[{addition:{[PT.RTC_PEER_CONNECTION_STATE]:Sj[d.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(a),++a===xOe+1&&(a=1)},vp)}uploadCompensateStats(a){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const s=a%Nb==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!s)return;if(this.lastUploadCompensateTime===-1)return void(this.lastUploadCompensateTime=Date.now());const l=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=l,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const d=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*d;const f=this.requestStats(!0);new Array(d).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const m={};if(this.uploadInboundStarted&&f){const y=this.requestRemoteMedia()||[],_=[];y.forEach(w=>{let[x,A]=w;const I={peer:x.uid};if(x._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(x._videoSSRC)&&A.has(Ye.VIDEO)&&x.videoTrack){const L=function(H,$,G){if(!$.videoRecv.find(te=>te.ssrc===H))return;const ne={};if(G&&G._player){const te=G._player,{renderFreezeAccTime2:ce,videoElementStatus:pe}=te;if(au.visibility==="visible"&&pe===Hi.PLAYING&&un().supportRequestVideoFrameCallback){const fe=Math.min(6e3,ce);te.renderFreezeAccTime2=Math.max(0,ce-fe),_t(ne,dl.Video_Render_Freeze_Time_Render2,fe),se("USE_NEW_RENDER_FREEZE_TIME")&&_t(ne,dl.Video_Render_Freeze_Time_Render,fe)}}return ne}(x._videoSSRC,f,x.videoTrack);L&&(I.video=L)}I.video&&_.push(I)}),_.length>0&&(m.inbound=_,this.requestUploadStats(m))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(a,s,l){if(!this.requestStats)return;if(!l)return a.rtt==null?void 0:{addition:{[Xa.RTT]:a.rtt,[Xa.CONN_TYPE]:void 0,[Xa.STATS_UPDATE_INTERVAL]:a.updateInterval||void 0}};const d=lq(a);if(this.store.useP2P){if(s){const f=lq(s);d[Xa.CONN_TYPE]+=f[Xa.CONN_TYPE]<<3}d[Xa.CONN_TYPE]+=110}else d[Xa.CONN_TYPE]+=100;return{addition:d}}getOutboundStats(a,s,l,d,f){if(!this.requestUploadStats||!this.requestLocalMedia)return;const m=this.requestLocalMedia();if(!m||m.length===0)return;let y,_,w;return m.forEach(x=>{let[A,{track:I,ssrcs:L}]=x;switch(A){case ke.LocalVideoLowTrack:case ke.LocalVideoTrack:if(A===ke.LocalVideoTrack){var H;const $=function(ce,pe,fe,ue,ye,xe){const Ae=pe.videoSend.find(Rt=>Rt.ssrc===ce);if(!Ae)return;const Le={},{sentFrame:Ht,inputFrame:qt}=Ae;if(ue&&(_t(Le,dl.Video_Send_Qp_Sum,Ae.qpSumPerFrame),qt&&Ht)){const Rt=qt.frameRate,bn=Ht.frameRate;Le[dl.Video_Send_Freeze]=function(yn,Yi){let Re=!0;return Re=!(yn<=5)&&(yn<=10?Yi<3:yn<=20?Yi<4:Yi<5),Re}(Rt,bn)?1:0}if(ye){switch(Ht&&(_t(Le,Dt.Video_Send_Height,Ht.height),_t(Le,Dt.Video_Send_Width,Ht.width),_t(Le,Dt.Video_Send_Frame_Rate,Ht.frameRate)),Le[Dt.Video_Send_Disabled]=fe._originMediaStreamTrack&&!fe._originMediaStreamTrack.enabled||fe._mediaStreamTrack&&!fe._mediaStreamTrack.enabled?1:0,Ae.adaptionChangeReason){case"none":Le[Dt.Video_Send_Adaptation]=0;break;case"cpu":Le[Dt.Video_Send_Adaptation]=1;break;case"bandwidth":Le[Dt.Video_Send_Adaptation]=2;break;case"other":Le[Dt.Video_Send_Adaptation]=3}let Rt=0;Ae.adaptionChangeReason&&(Rt+=uq(Ae.adaptionChangeReason)),pe.qualityLimitationReason&&(Rt+=uq(pe.qualityLimitationReason)<<3),Le[Dt.Video_Send_Adaptation]=Rt,Le[Dt.Video_Send_Player_Status]=Mj[fe._player?fe._player.videoElementStatus:"uninit"],_t(Le,Dt.Video_Send_Nacks,Ae.nacksCount),_t(Le,Dt.Video_Send_Plis,Ae.plisCount),_t(Le,Dt.Video_Send_Firs,Ae.firsCount),_t(Le,Dt.Video_Send_Avg_Encode,Ae.avgEncodeMs),_t(Le,Dt.Video_Send_Huge_Frame_Sent,Ae.hugeFramesSent),_t(Le,Dt.Video_Send_Bytes_Retransmit,Ae.retransmittedBytesSent),_t(Le,Dt.Video_Send_Packages_Retransmit,Ae.retransmittedPacketsSent),_t(Le,Dt.Video_Send_Key_Frames_Encoded,Ae.keyFramesEncoded);const bn=ye.videoSend.find(yn=>yn.ssrc===ce);if(bn){let yn=vp*Nb;bn.timestamp&&Ae.timestamp&&(yn=Ae.timestamp-bn.timestamp),bn.packets!=null&&Ae.packets!=null&&_t(Le,Dt.Video_Send_Package_Rate,1e3*(Ae.packets-bn.packets)/yn),Ae.packetsLost!=null&&bn.packetsLost!=null&&_t(Le,Dt.Video_Send_Package_Lost,Ae.packetsLost-bn.packetsLost),bn.bytes!=null&&Ae.bytes!=null&&_t(Le,Dt.Video_Send_Bitrate,8*(Ae.bytes-bn.bytes)/yn)}}return Le}(L[0].ssrcId,a,I,s,l),G=I.__className__==="CameraVideoTrack"?3:Ve(H=I._hints).call(H,jn.SCREEN_TRACK)?7:10;(this.lastExtendStats.sendType!==G||f)&&(this.needUploadStats={sendType:G},this.lastExtendStats.sendType=G);const ne=I&&function(ce,pe,fe,ue){const ye=pe.videoSend.find(Ae=>Ae.ssrc===ce);if(!ye)return null;const xe={};if(ue){const Ae=ye.inputFrame,Le=Ae&&Ae.height||fe.videoHeight||0,Ht=Ae&&Ae.width||fe.videoWidth||0,qt=Ae&&Ae.frameRate||0;_t(xe,Dt.Video_Capture_Height,Le),_t(xe,Dt.Video_Capture_Width,Ht),_t(xe,Dt.Video_Capture_Frame_Rate,qt)}return xe}(L[0].ssrcId,a,I,!!l),te=function(ce,pe){const fe={};return pe&&(_t(fe,Dt.Video_Send_Retransmit,ce.bitrate.retransmit),_t(fe,Dt.Video_Send_Target_Encoded,ce.bitrate.targetEncoded),_t(fe,Dt.Video_Send_Actual_Encoded,ce.bitrate.actualEncoded),_t(fe,Dt.Video_Send_Transmit,ce.bitrate.transmit),_t(fe,Dt.Video_Send_Bandwidth,ce.sendBandwidth)),fe}(a,!!l);_=Object.assign({},$,ne,te)}else w=function($,G,ne,te,ce){const pe=G.videoSend.find(ue=>ue.ssrc===$);if(!pe)return;const fe={};if(te){const ue=pe.sentFrame;ue&&(_t(fe,Dt.Video_Send_Low_Height,ue.height),_t(fe,Dt.Video_Send_Low_Width,ue.width),_t(fe,Dt.Video_Send_Low_Frame_Rate,ue.frameRate));const ye=te.videoSend.find(xe=>xe.ssrc===$);if(ye){let xe=vp*kT;ye.timestamp&&pe.timestamp&&(xe=pe.timestamp-ye.timestamp),ye.packets!=null&&pe.packets!=null&&_t(fe,Dt.Video_Send_Low_Package_Rate,1e3*(pe.packets-ye.packets)/xe),pe.packetsLost!=null&&ye.packetsLost!=null&&_t(fe,Dt.Video_Send_Low_Package_Lost,pe.packetsLost-ye.packetsLost),ye.bytes!=null&&pe.bytes!=null&&_t(fe,Dt.Video_Send_Low_Bitrate,8*(pe.bytes-ye.bytes)/xe)}}return fe}(L[0].ssrcId,a,0,l);break;case ke.LocalAudioTrack:y=I&&function($,G,ne,te,ce,pe){const fe=G.audioSend.find(ye=>ye.ssrc===$);if(!fe)return;const ue={};if(ce){ue[Dt.Audio_Send_Disabled]=ne._originMediaStreamTrack&&!ne._originMediaStreamTrack.enabled||ne._mediaStreamTrack&&!ne._mediaStreamTrack.enabled?1:0;const ye=100*ne._source.getAccurateVolumeLevel(),xe=fe.inputLevel;if(xe!=null){const Le=Math.ceil(50*Math.log10(100*xe+1));_t(ue,Dt.Audio_Send_Level,Le)}_t(ue,Dt.Audio_Capture_PCM_Level,ye),_t(ue,Dt.Audio_Send_AEC_Return_Loss,fe.aecReturnLoss),_t(ue,Dt.Audio_Send_AEC_Return_Loss_Enhancement,fe.aecReturnLossEnhancement),_t(ue,Dt.Audio_Send_Bytes_Retransmit,fe.retransmittedBytesSent),_t(ue,Dt.Audio_Send_Packages_Retransmit,fe.retransmittedPacketsSent),ue[Dt.Audio_Send_Freeze]=0;const Ae=ce.audioSend.find(Le=>Le.ssrc===$);if(Ae){let Le=vp*kT;Ae.timestamp&&fe.timestamp&&(Le=fe.timestamp-Ae.timestamp),Ae.bytes!=null&&fe.bytes!=null&&_t(ue,Dt.Audio_Send_Bitrate,8*(fe.bytes-Ae.bytes)/Le),Ae.packets!=null&&fe.packets!=null&&_t(ue,Dt.Audio_Send_Package_Rate,1e3*(fe.packets-Ae.packets)/Le)}}return ue}(L[0].ssrcId,a,I,0,l)}}),{high:_,low:w,audio:y}}getInboundStats(a,s,l,d){if(!this.requestRemoteMedia)return;const f=this.requestRemoteMedia()||[],m=[];return f.forEach(y=>{let[_,w]=y;const x={peer:_.uid};if(w.has(Ye.VIDEO)&&_.videoTrack){const A=_._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(_._videoSSRC)||!1,I=_.videoTrack?function(L,H,$,G,ne,te,ce,pe){const fe=H.videoRecv.find(Rt=>Rt.ssrc===L);if(!fe)return;const ue={},{receivedFrame:ye,outputFrame:xe,decodeFrameRate:Ae}=fe;_t(ue,Ai.Video_Render_Frame_Rate_Decode,Ae),fe.framesRateFirefox&&_t(ue,Ai.Video_Recv_Frame_Rate,fe.framesRateFirefox),ye&&_t(ue,Ai.Video_Recv_Frame_Rate,ye.frameRate),_t(ue,Ai.Video_Recv_Frame_Dropped,fe.framesDroppedCount),_t(ue,Ai.Video_Recv_Bytes_Retransmit,fe.retransmittedBytesReceived),_t(ue,Ai.Video_Recv_Packages_Retransmit,fe.retransmittedPacketsReceived),_t(ue,Ai.Video_Recv_Packages_Discarded,fe.packetsDiscarded),_t(ue,Ai.Video_Recv_Avg_Decode,fe.avgDecodeMs),_t(ue,Ai.Video_Recv_Avg_Processing_Delay,fe.avgProcessingDelayMs),_t(ue,Ai.Video_Recv_Avg_Assembly_Time,fe.avgFramesAssembledFromMultiplePacketsMs),_t(ue,Ai.Video_Recv_Avg_Inter_Frame_Delay,fe.avgInterFrameDelayMs),_t(ue,Ai.Video_Recv_Key_Frames_Decoded,fe.keyFramesDecoded);const Le=pe&&pe.videoRecv.find(Rt=>Rt.ssrc===L);if(Le){const Rt=H.timestamp-pe.timestamp||vp;fe.packetsLost!=null&&Le.packetsLost!=null&&_t(ue,Ai.Video_Recv_Package_Lost,fe.packetsLost-Le.packetsLost),Le.bytes!=null&&fe.bytes!=null&&_t(ue,Ai.Video_Recv_Bitrate,8*(fe.bytes-Le.bytes)/Rt),Le.packets!=null&&fe.packets!=null&&_t(ue,Ai.Video_Recv_Package_Rate,1e3*(fe.packets-Le.packets)/Rt)}const Ht=te&&te.videoRecv.find(Rt=>Rt.ssrc===L);if(Ht&&(_t(ue,dl.Video_Recv_Qp_Sum,fe.qpSumPerFrame),ue[dl.Video_Recv_Freeze]=G&&Rb.isRemoteVideoFreeze($,fe,Ht)?1:0),ce){var qt;const Rt=ce.videoRecv.find(yn=>yn.ssrc===L);ye?(_t(ue,Dt.Video_Recv_Height,ye.height),_t(ue,Dt.Video_Recv_Width,ye.width)):$&&(_t(ue,Dt.Video_Recv_Height,$._videoHeight||0),_t(ue,Dt.Video_Recv_Width,$._videoWidth||0)),xe&&_t(ue,Dt.Video_Recv_Frame_Rate_Output,xe.frameRate);const bn=(qt=$._player)===null||qt===void 0?void 0:qt.rendFrameRate.toFixed(0);if(bn&&_t(ue,Dt.Video_Render_Frame_Rate_Render,+bn),_t(ue,Dt.Video_Recv_Jitter_Buffer,fe.jitterBufferMs),_t(ue,Dt.Video_Recv_Current_Delay,fe.currentDelayMs),_t(ue,Dt.Video_Recv_Firs,fe.firsCount),_t(ue,Dt.Video_Recv_Nacks,fe.nacksCount),_t(ue,Dt.Video_Recv_Plis,fe.plisCount),$){ue[Dt.Video_Recv_Disabled]=$._originMediaStreamTrack.enabled&&$._mediaStreamTrack.enabled?0:1;const yn=$._player;if(yn){const{freezeTimeCounterList:Yi,renderFreezeAccTime:Re,renderFreezeAccTime2:Fe,videoElementStatus:Xe}=yn;if(Yi&&Yi.length>0&&_t(ue,dl.Video_Render_Freeze_Time,Yi.splice(0,1)[0]),ne&&au.visibility==="visible"&&Xe===Hi.PLAYING&&un().supportRequestVideoFrameCallback){const Oe=Math.min(6e3,Fe);yn.renderFreezeAccTime2=Math.max(0,Fe-Oe),_t(ue,dl.Video_Render_Freeze_Time_Render2,Oe);const B=Math.min(6e3,Re);yn.renderFreezeAccTime=Math.max(0,Re-B),_t(ue,dl.Video_Render_Freeze_Time_Render,se("USE_NEW_RENDER_FREEZE_TIME")?Oe:B)}if(typeof fe.totalFreezesDuration=="number"){const Oe=Rt&&Rt.totalFreezesDuration?fe.totalFreezesDuration-Rt.totalFreezesDuration:fe.totalFreezesDuration;_t(ue,Dt.Video_Render_Freeze_Duration,1e3*Oe)}}}if(ue[Dt.Video_Recv_Player_Status]=Mj[$._player?$._player.videoElementStatus:"uninit"],Rt&&fe.totalInterFrameDelay!==void 0&&fe.totalSquaredInterFrameDelay!==void 0&&Rt.totalInterFrameDelay!==void 0&&Rt.totalSquaredInterFrameDelay!==void 0){const yn=fe.totalInterFrameDelay-Rt.totalInterFrameDelay,Yi=fe.totalSquaredInterFrameDelay-Rt.totalSquaredInterFrameDelay,Re=fe.framesDecodeCount-Rt.framesDecodeCount,Fe=yn/Re*1e3,Xe=Math.round(1e3*Math.sqrt((Yi-Math.pow(yn,2)/Re)/Re));!isNaN(Xe)&&Fe+Xe>Math.max(3*Fe,Fe+150)&&(ue[Dt.Video_Recv_I_Frame_Delay]=Xe)}}return ue}(_._videoSSRC,a,_.videoTrack,A===!0,this.needUploadRenderFreezeTime,s,l,d):void 0;I&&(x.video=I)}if(w.has(Ye.AUDIO)&&_.audioTrack){const A=_.audioTrack?function(I,L,H,$,G,ne){const te=L.audioRecv.find(ue=>ue.ssrc===I);if(!te)return;const ce={};_t(ce,Ai.Audio_Recv_Jitter,te.jitterMs),_t(ce,Ai.Audio_Recv_Bytes_Retransmit,te.retransmittedBytesReceived),_t(ce,Ai.Audio_Recv_Packages_Retransmit,te.retransmittedPacketsReceived),_t(ce,Ai.Audio_Recv_Packages_Discarded,te.packetsDiscarded),_t(ce,Ai.Audio_Recv_Avg_Processing_Delay,te.avgProcessingDelayMs);const pe=ne&&ne.audioRecv.find(ue=>ue.ssrc===I);if(pe){const ue=vp;te.packets!=null&&pe.packets!=null&&_t(ce,Ai.Audio_Recv_Package_Rate,1e3*(te.packets-pe.packets)/ue),te.packetsLost!=null&&pe.packetsLost!=null&&_t(ce,Ai.Audio_Recv_Package_Lost,te.packetsLost-pe.packetsLost)}if($){const{receivedFrames:ue,droppedFrames:ye}=te;ue!=null&&ye!=null&&(ce[dl.Audio_Recv_Freeze]=(fe=ue)===0||100*ye/fe>20?1:0)}var fe;if(G){const ue=100*H._source.getAccurateVolumeLevel(),ye=te.outputLevel;if(ye!=null){const Ae=Math.ceil(50*Math.log10(100*ye+1));_t(ce,Dt.Audio_Render_Level,Ae)}_t(ce,Dt.Audio_Recv_PCM_Level,ue),H&&(ce[Dt.Audio_Recv_Disabled]=H._originMediaStreamTrack.enabled&&H._mediaStreamTrack.enabled?0:1),_t(ce,Dt.Audio_Recv_Jitter_Buffer,te.jitterBufferMs),_t(ce,Dt.Audio_Recv_Current_Delay,te.jitterBufferMs),ce[Dt.Audio_Recv_Player_Status]=Mj[qa.getPlayerState(H.getTrackId())];const xe=G.audioRecv.find(Ae=>Ae.ssrc===I);if(xe){xe.bytes!=null&&te.bytes!=null&&_t(ce,Dt.Audio_Recv_Bitrate,8*(te.bytes-xe.bytes)/(vp*Nb));const Ae=te.concealedSamples-xe.concealedSamples;Ae>0&&_t(ce,Dt.Audio_Recv_Concealed_Samples,Ae);const Le=te.totalSamplesReceived-xe.totalSamplesReceived;Le>0&&_t(ce,Dt.Audio_Recv_Total_Samples_Received,Le);const Ht=te.freezeSamples80-xe.freezeSamples80;Ht>0&&_t(ce,Dt.Audio_Render_Freeze_Samples_80ms,Ht);const qt=te.freezeSamples200-xe.freezeSamples200;qt>0&&_t(ce,Dt.Audio_Render_Freeze_Samples_200ms,qt);const Rt=te.freezeMs80-xe.freezeMs80;_t(ce,Dt.Audio_Render_Freeze_Time_80ms,Rt<0?0:Rt);const bn=te.freezeMs200-xe.freezeMs200;_t(ce,Dt.Audio_Render_Freeze_Time_200ms,bn<0?0:bn)}}return ce}(_._audioSSRC,a,_.audioTrack,s,l,d):void 0;A&&(x.audio=A)}(x.video||x.audio)&&m.push(x)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,m}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const a=(this.requestAllTracks()||[]).find(s=>s instanceof mb);if(a&&a._external.getDenoiserStats){const s=a._external.getDenoiserStats();s&&this.requestUpload(vb.DENOISER_STATS,s)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(a=>{a.getProcessorStats().forEach(s=>{this.requestUpload&&this.requestUpload(s.type,s.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(a=>{let[s,l]=a;l.has(Ye.VIDEO)&&s.videoTrack&&s.videoTrack.getProcessorStats().forEach(d=>{this.requestUpload&&this.requestUpload(d.type,d.stats)}),l.has(Ye.AUDIO)&&s.audioTrack&&s.audioTrack.getProcessorStats().forEach(d=>{this.requestUpload&&this.requestUpload(d.type,d.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const a=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const s=Date.now(),l={connectionInterval:se("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:s};let d=[];const f=this.requestAllTracks&&this.requestAllTracks()||[];for(const w of f)!w.muted&&w.enabled&&(d=d.concat(await w.getProcessorUsage()));const m=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[w,x]of m)x.has(Ye.VIDEO)&&w.videoTrack&&(d=d.concat(await w.videoTrack.getProcessorUsage())),x.has(Ye.AUDIO)&&w.audioTrack&&(d=d.concat(await w.audioTrack.getProcessorUsage()));if(d.length===0)return;l.details=function(w,x){const A={};for(const{id:$,value:G,level:ne,direction:te}of w){var I;const ce=(I=x.get($))!==null&&I!==void 0?I:0,pe=G===2?ce+se("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:ce;var L,H;x.set($,pe),A[$]?(G===2&&(A[$].value=G),ne>A[$].level&&(A[$].level=ne),te==="remote"&&(A[$].remoteUidCount+=1),A[$].totalTs=(L=x.get($))!==null&&L!==void 0?L:0):A[$]={value:G,level:ne,remoteUidCount:te==="local"?0:1,totalTs:(H=x.get($))!==null&&H!==void 0?H:0}}return Object.keys(A).map($=>{const{level:G,value:ne,totalTs:te}=A[$];return{id:$,level:G,value:ne,totalTs:te}})}(d,a);const y=Date.now(),_=y>s?y:s+1;this.requestUpload&&this.requestUpload(vb.EXTENSION_USAGE_STATS,{usageStats:l,sendTs:_})},se("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const TOe=se("ICE_RESTART_INTERVAL");let jT=new Map,zg=new Map,Th=[Ki.UDP_TCP_RELAY,Ki.TCP_RELAY,Ki.RELAY],DD=se("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&un().supportPCSetConfiguration;function hq(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=jT.get(r.id);s&&(window.clearTimeout(s),jT.delete(r.id));const l=zg.get(r.id);a&&l&&l.index===Th.length-1&&(F.debug("[".concat(r.id,"] reset ICE restart policy")),zg.delete(r.id))}function fq(r,a,s){if(jT.size===0&&zg.size===0&&(Array.isArray(se("RESTART_SEQUENCE"))&&se("RESTART_SEQUENCE").length>0&&!function(y,_){if(y.length!==_.length)return!1;for(let w=0;w<y.length;w+=1){const x=y[w];if(y.filter(A=>A===x).length!==_.filter(A=>A===x).length)return!1}return!0}(Th,se("RESTART_SEQUENCE"))&&(Th=se("RESTART_SEQUENCE").filter(y=>{var _;if(Ve(_=Object.values(Ki)).call(_,y))return!0}),F.debug("use reconnection policy from config distribution, queues: ".concat(Th.join(" => ")))),DD=se("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&un().supportPCSetConfiguration),Th.length===0)return void s();let l,{index:d=0,type:f}=zg.get(r.id)||{};if(DD&&f===Ki.RELAY)return void s();let m=f&&d>=Th.length-1;if(DD)f=Ki.RELAY;else{if(m)return void s();f?(d++,f=Th[d]):(f=Th[0],d=0)}F.debug("[".concat(r.id,"] choose ICE restart policy: ").concat(f,", index: ").concat(d)),a(f),zg.set(r.id,{index:d,type:f}),l=window.setTimeout(()=>fq(r,a,s),TOe),jT.set(r.id,l)}var Zt;function pq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function cu(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?pq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):pq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function mq(r){var a,s,l,d=2;for(typeof Symbol<"u"&&(s=Xk,l=Symbol.iterator);d--;){if(s&&(a=r[s])!=null)return a.call(r);if(l&&(a=r[l])!=null)return new DT(a.call(r));s="@@asyncIterator",l="@@iterator"}throw new TypeError("Object is not async iterable")}function DT(r){function a(s){if(Object(s)!==s)return Ge.reject(new TypeError(s+" is not an object."));var l=s.done;return Ge.resolve(s.value).then(function(d){return{value:d,done:l}})}return DT=function(s){this.s=s,this.n=s.next},DT.prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(s){var l=this.s.return;return l===void 0?Ge.resolve({value:s,done:!0}):a(l.apply(this.s,arguments))},throw:function(s){var l=this.s.return;return l===void 0?Ge.reject(s):a(l.apply(this.s,arguments))}},new DT(r)}let Ab=(Zt=class extends lr{get state(){return this._state}set state(r){const a=this._state;this._state=r,this.emit(ut.StateChange,a,this._state)}constructor(r,a){super(),Z(this,"isPlanB",void 0),Z(this,"store",void 0),Z(this,"statsUploader",void 0),Z(this,"connection",void 0),Z(this,"localTrackMap",new Map),Z(this,"remoteUserMap",new Map),Z(this,"localDataChannels",[]),Z(this,"remoteDataChannelMap",new Map),Z(this,"pendingLocalTracks",[]),Z(this,"pendingRemoteTracks",[]),Z(this,"pendingLocalDataChannels",[]),Z(this,"pendingRemoteDataChannels",[]),Z(this,"statsCollector",void 0),Z(this,"shouldForwardP2PCreation",void 0),Z(this,"iceFailedCount",0),Z(this,"dtlsFailedCount",0),Z(this,"mutex",void 0),Z(this,"_state",wn.Disconnected),Z(this,"_pcStatsUploadType",se("NEW_ICE_RESTART")?cd.FIRST_CONNECTION:cd.OLD_FIRST_CONNECTION),Z(this,"_isStartRestartIce",!1),Z(this,"_restartTimer",void 0),Z(this,"_isTryConnecting",!1),Z(this,"_iceError",null),Z(this,"_forceTurn",!1),Z(this,"_isWaitPcToRePub",!1),Z(this,"handleMuteLocalTrack",async(s,l,d)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==wn.Connected)return void d(new Se(ie.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const m=this.filterTobeMutedTracks(s);if(m.length===0)return void l();const y=m.find(w=>w[0]==="videoLowTrack");if(y){const w=y[1];this.store.enableInstantMuteRestore?(w.track._originMediaStreamTrack.enabled=!1,F.info("[".concat(this.store.clientId,"] P2PChannel muteLocalLowTrack without close sender because enableInstantMuteRestore is true"))):w.track._originMediaStreamTrack.stop()}this.store.enableInstantMuteRestore?F.info("[".concat(this.store.clientId,"] P2PChannel muteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.muteLocal(m.map(w=>{let[,{id:x}]=w;return x}));const _=this.createMuteMessage(m);await Ln(this,ut.RequestMuteLocal,_),l()}catch(m){d(m)}finally{f()}}),Z(this,"handleUnmuteLocalTrack",async(s,l,d)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==wn.Connected)return void d(new Se(ie.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const m=this.filterTobeUnmutedTracks(s);if(m.length===0)return void l();const y=m.find(w=>w[0]==="videoLowTrack");if(y){const w=y[1];if(this.store.enableInstantMuteRestore)w.track._originMediaStreamTrack.enabled=!0,F.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalLowTrack without close sender because enableInstantMuteRestore is true"));else{if(w.track._originMediaStreamTrack.stop(),!se("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding){const x=s._mediaStreamTrack.clone();w.track._mediaStreamTrack=x,w.track._originMediaStreamTrack=x}else{const x=jD(s,cb(this,ut.RequestLowStreamParameter));w.track._mediaStreamTrack=x,w.track._originMediaStreamTrack=x}await new Ge((x,A)=>{this.handleReplaceTrack(w.track,x,A,!0)})}}this.store.enableInstantMuteRestore?F.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.unmuteLocal(m.map(w=>{let[,{id:x}]=w;return x}));const _=this.createUnmuteMessage(m);await Ln(this,ut.RequestUnmuteLocal,_),l()}catch(m){d(m)}finally{f()}}),Z(this,"handleUpdateVideoEncoder",async(s,l,d,f)=>{let m;f||(m=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const _=this.localTrackMap.get(ke.LocalVideoTrack);if(!this.connection||!_||_.track!==s||this.state!==wn.Connected)return void l();const{id:w,track:x}=_;await this.connection.updateSendParameters(w,x),await this.connection.updateEncoderConfig(w,x),this.emit(ut.UpdateVideoEncoder,x),l()}catch(_){d(_)}finally{var y;(y=m)===null||y===void 0||y()}}),Z(this,"handleUpdateVideoSendParameters",async(s,l,d)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const m=this.localTrackMap.get(ke.LocalVideoTrack);if(!this.connection||!m||m.track!==s||this.state!==wn.Connected)return void l();const{id:y,track:_}=m;await this.connection.updateSendParameters(y,_),l()}catch(m){d(m)}finally{f()}}),Z(this,"handleReplaceMixingTrack",async(s,l,d,f)=>{if(!this.connection||this.state!==wn.Connected)return void l();const m=PD([s]);let y;F.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(m.getTrackId(),"]")),typeof f=="boolean"&&f||(y=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(s,m),l()}catch(w){d(w)}finally{var _;(_=y)===null||_===void 0||_()}}),Z(this,"handleReplaceTrack",async(s,l,d,f)=>{let m;F.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof f=="boolean"&&f||(m=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var y;const w=Array.from(this.localTrackMap.entries()).find(x=>{let[,{track:A}]=x;return s===A});if(!this.connection||!w||this.state!==wn.Connected)return void l();if(await((y=this.connection)===null||y===void 0?void 0:y.replaceTrack(s,w[1].id)),this.isPlanB){const x=w[1];x.id=s._mediaStreamTrack.id,this.localTrackMap.set(w[0],x)}if(w[0]===ke.LocalVideoTrack&&!se("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding){const x=this.localTrackMap.get(ke.LocalVideoLowTrack);if(x){const A=s._mediaStreamTrack.clone();x.track._originMediaStreamTrack.stop(),x.track._mediaStreamTrack=A,x.track._originMediaStreamTrack=A,await new Ge((I,L)=>{this.handleReplaceTrack(x.track,I,L,!0)})}}l()}catch(w){d(w)}finally{var _;(_=m)===null||_===void 0||_()}}),Z(this,"handleGetRTCStats",s=>{s(this.statsCollector.getRTCStats())}),Z(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),Z(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),Z(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),Z(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=r,this.statsCollector=a,this.statsCollector.addP2PChannel(this),this.statsUploader=new dq(this.store),this.bindStatsUploaderEvents(),this.mutex=new Gi("P2PChannel-mutex",this.store.clientId),this.isPlanB=!un().supportUnifiedPlan||se("CHROME_FORCE_PLAN_B")&&id(),this.shouldForwardP2PCreation=se("FORWARD_P2P_CREATION")&&un().supportPCSetConfiguration&&uj(),this.shouldForwardP2PCreation&&(this.connection=OT(this.store),this.emit(ut.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(r,a){var s;this.state=wn.New,this._forceTurn=sq(r),F.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const l=this.shouldForwardP2PCreation&&((s=this.connection)===null||s===void 0?void 0:s.peerConnectionState)==="closed";if((!this.shouldForwardP2PCreation||l||a)&&((l||a)&&this.connection&&(F.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=OT(this.store,r),this.emit(ut.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new Se(ie.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=se("NEW_ICE_RESTART")?cd.FIRST_CONNECTION:cd.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(r),this.connection.establishPromise}async connect(r){if(!this.connection)throw new Se(ie.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");if(this.isPreallocation()&&this.state===wn.Connected){if(this.connection instanceof Oo&&this.connection.checkDtlsParameters(r.dtlsParameters.fingerprints))return F.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] dtls parameters mismatch, try next.")),nt.reportApiInvoke(this.store.sessionId,{name:Er.MISMATCH_DTLS_PARAMETERS,options:[r.dtlsParameters.fingerprints],tag:rr.TRACER}).onSuccess(),void setTimeout(()=>{this.emit(ut.RequestReconnect)});await this.connection.updateRemoteConnect(r)}else this.store.peerConnectionStart(),await this.connection.connect(r),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=wn.Connected}updateRemoteRTPCapabilities(r){const a=Array.from(this.localTrackMap.entries()).filter(d=>{var f;let[m]=d;return Ve(f=[ke.LocalVideoLowTrack,ke.LocalVideoTrack]).call(f,m)}),s=a.map(d=>{let[,{id:f}]=d;return f}),l=a.map(d=>{let[f]=d;return f});if(this.connection instanceof Oo){if(nt.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(l),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(r)}),!Ve(r).call(r,this.store.codec)){const d=["vp9","vp8","h264"].find(f=>Ve(r).call(r,f));d&&(this.store.codec=d,F.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(d,".")))}this.connection.updateRemoteRTPCapabilities(s,r)}}async getEstablishParams(){var r;if(this.connection instanceof Oo&&this.connection.peerConnectionState!=="closed"&&Ve(r=[wn.New,wn.Connected]).call(r,this.state))return this.connection.establishPromise}async publishDataChannel(r){if(!this.connection||this.state!==wn.Connected){if(this.state===wn.Disconnected)throw new Se(ie.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return r.forEach(s=>{var l;Ve(l=this.pendingLocalDataChannels).call(l,s)||this.pendingLocalDataChannels.push(s)}),[]}const a=this.filterTobePublishedDataChannels(r);return a.length===0?[]:(a.forEach(s=>{const l=Date.now();this.store.publish(s.id.toString(),"datachannel",l)}),await this.connection.createDataChannels(this.store.uid,a),a.forEach(s=>{this.localDataChannels.push(s);const l=Date.now();this.store.publish(s.id+"","datachannel",void 0,l)}),r.map(s=>({streamId:s.id,ordered:s.ordered,maxRetransmits:s.maxRetransmits,metadata:s.metadata,channelId:s._originDataChannelId})))}publish(r,a,s){var l=this;return To(function*(){const d=yield ln(l.mutex.lock("From P2PChannel.publish"));try{var f;const m=l.connection&&Ve(f=["disconnected","failed"]).call(f,l.connection.peerConnectionState);if(!l.connection||l.state!==wn.Connected||m){if(l.state===wn.Disconnected)throw new Se(ie.UNEXPECTED_ERROR,"PeerConnection already disconnected.");l.throwIfTrackTypeNotMatch(r);const _=r.filter(w=>l.pendingLocalTracks.indexOf(w)===-1);return l.pendingLocalTracks=l.pendingLocalTracks.concat(_),void(m&&(l._isWaitPcToRePub=!0))}l.store.pubId=l.store.pubId+1,qi.markPublishStart(l.store.clientId,l.store.pubId);const y=l.filterTobePublishedTracks(r,a,s);if(y.length===0)return void(yield ln(l.tryToUnmuteAudio(r)));yield*Rx(mq(l.doPublish(l.connection,y)))}finally{d()}})()}doPublish(r,a){var s=this;return To(function*(){a.forEach(I=>{let{track:L,type:H}=I;const $=Date.now();s.store.publish(L.getTrackId(),H===ke.LocalAudioTrack?"audio":"video",$)}),s.bindLocalTrackEvents(a);const l=a.map(I=>{let{track:L}=I;return L}),d=yield ln(r.send(l,s.store.codec,s.store.audioCodec)),f=(yield ln(d.next())).value,m=s.createGatewayPublishMessage(a,f);let y;try{y=yield m}catch(I){throw d.throw(I),(I==null?void 0:I.code)===ie.WS_ABORT&&a.forEach(L=>{let{track:H}=L;s.pendingLocalTracks.indexOf(H)===-1&&s.pendingLocalTracks.push(H)}),s.unbindLocalTrackEvents(a),I}const _=s.mapPubResToRemoteConfig(m,y,l),w=(yield ln(d.next(_))).value;if(s.state===wn.Disconnected)throw new Se(ie.UNEXPECTED_ERROR,"PeerConnection already disconnected.");se("ENABLE_VIDEO_SEI");const x=se("ENABLE_ENCODED_TRANSFORM"),A=se("ENABLE_AUDIO_METADATA");l.forEach(async I=>{const L=I.getRTCRtpTransceiver();if(!L||!x)return;const{interceptLocalVideoFrame:H,interceptLocalAudioFrame:$}=wT();I.trackMediaType===Ye.VIDEO?await H(L.sender,I):I.trackMediaType===Ye.AUDIO&&await $(L.sender,{metadata:A?()=>{const G=I.metadata.shift();return G&&G.value}:void 0})}),a.forEach(I=>{let{type:L}=I;s.statsCollector.addLocalStats(L)}),s.assignLocalTracks(a,w),s.statsUploader.startUploadOutboundStats(),a.forEach(I=>{let{track:L,type:H}=I;const $=Date.now();s.store.publish(L.getTrackId(),H===ke.LocalAudioTrack?"audio":"video",void 0,$)})})()}async updateVideoStreamParameter(r,a){const s=this.localTrackMap.get(a);if(!s||!this.connection)return;if(!(s.track instanceof Wn))return F.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:l}=s,d=function(f,m){const y={};return f.height&&f.width&&(y.scaleResolutionDownBy=pD(f,m)),y.maxFramerate=f.framerate?Os(f.framerate):void 0,y.maxBitrate=f.bitrate?1e3*f.bitrate:void 0,y}(r,l);if(l._encoderConfig||(l._encoderConfig={}),a!==ke.LocalVideoLowTrack||!se("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding)d.scaleResolutionDownBy!=null&&(l._encoderConfig.scaleResolutionDownBy=d.scaleResolutionDownBy);else{const f=l._originMediaStreamTrack;if(!f.canvas)return F.warn("[".concat(l.getTrackId(),"] no canvas on track"));(function(m,y){const _=m.canvas;y.width&&(_.width=Os(y.width)),y.height&&(_.height=Os(y.height)),y.framerate&&(_.stopCapture&&_.stopCapture(),_.stopCapture=Fj(()=>{!_.startCapture&&_.stopCapture&&_.stopCapture(),_.startCapture&&_.startCapture()},Os(y.framerate)))})(f,r)}d.maxBitrate!=null&&(l._encoderConfig.bitrateMax=d.maxBitrate/1e3),d.maxFramerate!=null&&(l._encoderConfig.frameRate&&typeof l._encoderConfig.frameRate=="object"?l._encoderConfig.frameRate.max=d.maxFramerate:l._encoderConfig.frameRate={max:d.maxFramerate}),F.debug("[".concat(l.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(l._encoderConfig))),await this.connection.updateRtpSenderEncodings(l)}publishLowStream(r){var a=this;return To(function*(){if(!a.connection||a.state!==wn.Connected)return;const s=yield ln(a.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const d=a.localTrackMap.get(ke.LocalVideoTrack);if(!d)throw new Se(ie.UNEXPECTED_ERROR,"Could not find high stream");if(a.localTrackMap.has(ke.LocalVideoLowTrack))throw new Se(ie.UNEXPECTED_ERROR,"[".concat(a.store.clientId,"] Can't publish low stream when stream already publish"));const f=[{track:a.getLowVideoTrack(d.track,r),type:ke.LocalVideoLowTrack}];if(yield*Rx(mq(a.doPublish(a.connection,f))),d.track.muted||!d.track.enabled){var l;const m=(l=a.localTrackMap.get(ke.LocalVideoLowTrack))===null||l===void 0?void 0:l.id;m!==void 0&&(yield ln(a.connection.muteLocal([m])))}}finally{s()}})()}async republish(){this.pendingLocalTracks.length>0&&(F.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Li(this,ut.RequestRePublish,this.pendingLocalTracks),this.emit(ut.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(F.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Li(this,ut.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(r){for(let a=this.pendingRemoteTracks.length-1;a>=0;a--){const{user:s,kind:l}=this.pendingRemoteTracks[a];(l!==Ye.AUDIO||s._audio_added_&&s._audioSSRC)&&(l!==Ye.VIDEO||s._video_added_&&s._videoSSRC)||this.pendingRemoteTracks.splice(a,1)}if(r)await Li(this,ut.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:a,kind:s}of this.pendingRemoteTracks)await this.subscribe(a,s,s===Ye.VIDEO?a._videoSSRC:a._audioSSRC);this.pendingRemoteTracks.forEach(a=>{let{user:s}=a;this.emit(ut.MediaReconnectEnd,s.uid)}),this.pendingRemoteTracks=[]}async unpublish(r){if(!this.connection||this.state!==wn.Connected)return void r.forEach(l=>{const d=this.pendingLocalTracks.indexOf(l);d!==-1&&this.pendingLocalTracks.splice(d,1)});const a=this.filterTobeUnpublishedTracks(r);if(a.length===0)return;const s=a.find(l=>l[0]==="videoLowTrack");return s&&s[1].track.close(),this.doUnpublish(this.connection,a)}async unpublishDataChannel(r){if(!this.connection||this.state!==wn.Connected)return void r.forEach(s=>{const l=this.pendingLocalDataChannels.indexOf(s);l!==-1&&this.pendingLocalDataChannels.splice(l,1)});const a=this.filterTobeUnpublishedDataChannels(r);return a.length!==0?(a.forEach(s=>{const l=this.localDataChannels.indexOf(s);l!==-1&&this.localDataChannels.splice(l,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),a.map(s=>s.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==wn.Connected)return;const r=this.localTrackMap.get(ke.LocalVideoLowTrack);if(!r)return;r.track.close();const a=[[ke.LocalVideoLowTrack,r]];return this.doUnpublish(this.connection,a)}async doUnpublish(r,a){const s=this.createGatewayUnpublishMessage(a);return await r.stopSending(a.map(l=>{let[,{id:d}]=l;return d})),this.withdrawLocalTracks(a),this.unbindLocalTrackEvents(a.map(l=>{let[d,{track:f}]=l;return{type:d,track:f}})),a.forEach(l=>{let[d]=l;this.statsCollector.removeLocalStats(d)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),s}async subscribeDataChannel(r,a){if(!this.connection||this.state!==wn.Connected)throw new Se(ie.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const s=a.filter(l=>{var d;return!((d=this.remoteDataChannelMap.get(r))!==null&&d!==void 0&&d.get(l.id))});if(s.length!==0)return await this.connection.createDataChannels(r.uid,s),s.forEach(l=>{var d;this.remoteDataChannelMap.has(r)?(d=this.remoteDataChannelMap.get(r))===null||d===void 0||d.set(l.id,l):this.remoteDataChannelMap.set(r,new Map([[l.id,l]]));const f=this.pendingRemoteDataChannels.findIndex(m=>{let{user:y,id:_}=m;return y.uid===r.uid&&_===l.id});f!==-1&&this.pendingRemoteDataChannels.splice(f,1)}),s.map(l=>l.id)}async subscribe(r,a,s,l,d){var f;if(!this.connection||this.state!==wn.Connected)throw new Se(ie.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((f=this.remoteUserMap.get(r))!==null&&f!==void 0&&f.has(a))return;let m,y,_,w;const x=this.connection.getPreMedia(s);if(x)F.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(s,", no need to send sub to gateway.")),_=x.transceiver,m=x.track,y=x.mid,w=x.player,x.firstVideoRender&&this.store.firstVideoFrameDecoded(r.uid,{firstPreRender:x.firstVideoRender});else if(d){const L=d.find($=>{let{stream_type:G}=$;return G===a});if(!L)throw new Se(ie.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(a," for user: ").concat(r.uid," because subscribe answer from gateway does not contain stream_type: ").concat(a,"."));const H=await this.connection.receive(a,L.ssrcs,String(r._uintid),L.attributes);this.connection instanceof Oo&&(_=H.transceiver),m=H.track,y=H.id}else{const L=await this.connection.receive(a,[{ssrcId:s,rtx:l}],String(r._uintid),void 0);this.connection instanceof Oo&&(_=L.transceiver),m=L.track,y=L.id}if(a===Ye.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(m):(r._audioTrack=new kg(m,r.uid,r._uintid,this.store),F.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),_&&r._audioTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(m):(r._videoTrack=new Pg(m,r.uid,r._uintid,this.store,w),F.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId())),r._videoTrack.once(No.PLAY_START,()=>{this.store.firstVideoFrameDecoded(r.uid,{playStart:Date.now()})}),r._videoTrack.once(No.PLAY_END,()=>{this.store.firstVideoFrameDecoded(r.uid,{playEnd:Date.now()}),this.reportVideoFirstFrameRender(r)}),w?r._videoTrack.once(No.FIRST_FRAME_RENDER,()=>{this.store.firstVideoFrameDecoded(r.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(r)}):r._videoTrack.once(No.FIRST_FRAME_DECODED,()=>{this.store.firstVideoFrameDecoded(r.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(r)})),_&&r._videoTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(r,r._videoTrack)),_&&se("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:L,interceptRemoteAudioFrame:H}=wT();a==Ye.VIDEO?await L(_.receiver,{onSei:se("ENABLE_VIDEO_SEI")&&($=>{var G;return(G=r._videoTrack)===null||G===void 0?void 0:G._onSei($)})}):a==Ye.AUDIO&&await H(_.receiver,{enableTopn:!!se("ENABLE_AUDIO_TOPN"),enableMetadata:!!se("ENABLE_AUDIO_METADATA"),enablePts:!!se("ENABLE_AUDIO_PTS"),onMetadata:$=>{this.safeEmit(ut.AudioMetadata,$)},onPts:$=>{this.safeEmit(ut.AudioPts,$)}})}const A=this.remoteUserMap.get(r);A?A.set(a,y):this.remoteUserMap.set(r,new Map([[a,y]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadInboundStats();const I=this.pendingRemoteTracks.findIndex(L=>{let{user:H,kind:$}=L;return H.uid===r.uid&&a===$});I!==-1&&(this.pendingRemoteTracks.splice(I,1),this.emit(ut.MediaReconnectEnd,r.uid))}async massSubscribe(r){return this.massSubscribeNoLock(r)}async massSubscribeNoLock(r){if(!this.connection||this.state!==wn.Connected)throw new Se(ie.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");r=r.filter(d=>{var f;let{user:m,mediaType:y}=d;return!((f=this.remoteUserMap.get(m))!==null&&f!==void 0&&f.has(y))});const a=[],s=new Map;r.forEach(d=>{if(!this.connection)return;const f=this.connection.getPreMedia(d.ssrcId);if(f){const{track:m,mid:y,transceiver:_,player:w}=f;s.set(d.ssrcId,{track:m,id:y,transceiver:_,player:w})}else a.push(d)});const l=await this.connection.batchReceive(a.map(d=>{let{user:f,mediaType:m,ssrcId:y,rtxSsrcId:_}=d;return{kind:m,ssrcMsg:[{ssrcId:y,rtx:_}],mslabel:String(f._uintid)}}));a.forEach((d,f)=>{s.set(d.ssrcId,l[f])});for(const{user:d,mediaType:f,ssrcId:m}of r){const y=s.get(m);if(!y)return void F.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(d.uid," subscribe data,").concat(f,", ").concat(m));const{track:_,id:w,transceiver:x,player:A}=y;if(x&&se("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:H,interceptRemoteAudioFrame:$}=wT();f==Ye.VIDEO?await H(x.receiver,{onSei:se("ENABLE_VIDEO_SEI")&&(G=>{var ne;return(ne=d._videoTrack)===null||ne===void 0?void 0:ne._onSei(G)})}):f==Ye.AUDIO&&await $(x.receiver,{enableTopn:!!se("ENABLE_AUDIO_TOPN"),enableMetadata:!!se("ENABLE_AUDIO_METADATA"),enablePts:!!se("ENABLE_AUDIO_PTS"),onMetadata:G=>{this.safeEmit(ut.AudioMetadata,G)},onPts:G=>{this.safeEmit(ut.AudioPts,G)}})}if(f===Ye.AUDIO?(d._audioTrack?d._audioTrack._updateOriginMediaStreamTrack(_):(d._audioTrack=new kg(_,d.uid,d._uintid,this.store),F.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(d._audioTrack.getTrackId()))),x&&d._audioTrack._updateRtpTransceiver(x),this.bindRemoteTrackEvents(d,d._audioTrack)):(d._videoTrack?d._videoTrack._updateOriginMediaStreamTrack(_):(d._videoTrack=new Pg(_,d.uid,d._uintid,this.store,A),F.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(d._videoTrack.getTrackId()))),x&&d._videoTrack._updateRtpTransceiver(x),this.bindRemoteTrackEvents(d,d._videoTrack)),se("ENABLE_VIDEO_SEI")&&x){const{interceptRemoteVideoFrame:H,interceptRemoteAudioFrame:$}=wT();f==Ye.VIDEO?await H(x.receiver,{onSei:G=>{var ne;(ne=d._videoTrack)===null||ne===void 0||ne._onSei(G)}}):f==Ye.AUDIO&&await $(x.receiver)}const I=this.remoteUserMap.get(d);I?I.set(f,w):this.remoteUserMap.set(d,new Map([[f,w]])),this.statsCollector.addRemoteStats(d.uid),this.statsUploader.startUploadInboundStats();const L=this.pendingRemoteTracks.findIndex(H=>{let{user:$,kind:G}=H;return $.uid===d.uid&&f===G});L!==-1&&(this.pendingRemoteTracks.splice(L,1),this.emit(ut.MediaReconnectEnd,d.uid))}}async unsubscribe(r,a,s){const l=this.pendingRemoteTracks.filter(m=>{let{user:y,kind:_}=m;return a!==void 0?y.uid===r.uid&&a===_:y.uid===r.uid});if(l.forEach(m=>{const y=this.pendingRemoteTracks.indexOf(m);this.pendingRemoteTracks.splice(y,1)}),this.connection&&this.state===wn.Connected||s||l.forEach(m=>{let{kind:y}=m;var _;if(y===Ye.AUDIO)(_=r._audioTrack)===null||_===void 0||_._destroy(),r._audioTrack=void 0;else if(y===Ye.VIDEO){var w;(w=r._videoTrack)===null||w===void 0||w._destroy(),r._videoTrack=void 0}}),!this.connection||this.state!==wn.Connected)return;const d=this.filterTobeUnSubscribedTracks(r,a);if(d.length===0)return;await this.connection.stopReceiving(d.map(m=>{let[,{id:y}]=m;return y}));const f=this.createUnsubscribeMessage(d);return this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),d.forEach(m=>{let[y,{kind:_}]=m;var w,x;if(_===Ye.VIDEO&&y._videoSSRC&&((w=this.connection)===null||w===void 0||w.setStatsRemoteVideoIsReady(y._videoSSRC,!1)),_===Ye.VIDEO)this.unbindRemoteTrackEvents(y._videoTrack),s||((x=y._videoTrack)===null||x===void 0||x._destroy(),y._videoTrack=void 0);else if(_===Ye.AUDIO){var A;this.unbindRemoteTrackEvents(y._audioTrack),!s&&((A=y._audioTrack)===null||A===void 0||A._destroy(),y._audioTrack=void 0)}}),f}async unsubscribeDataChannel(r,a){if(a.forEach(d=>{const f=this.pendingRemoteDataChannels.findIndex(m=>m.id===d.id);f!==-1&&this.pendingRemoteDataChannels.splice(f,1)}),!this.connection)return;const s=this.filterTobeUnSubscribedDataChannels(r,a);if(s.length===0)return;a.forEach(d=>{d._close()});const l=this.remoteDataChannelMap.get(r);return s.forEach(d=>{l&&l.delete(d.id)}),l&&l.size===0&&(this.remoteDataChannelMap.delete(r),await this.connection.stopDataChannels(r.uid)),s.map(d=>d.id)}async massUnsubscribe(r){return this.massUnsubscribeNoLock(r)}async massUnsubscribeNoLock(r){let a=[];for(const{user:d,mediaType:f}of r){const m=this.pendingRemoteTracks.filter(y=>{let{user:_,kind:w}=y;return f!==void 0?_.uid===d.uid&&f===w:_.uid===d.uid});m.forEach(y=>{const _=this.pendingRemoteTracks.indexOf(y);this.pendingRemoteTracks.splice(_,1)}),a=a.concat(m)}if(!this.connection||this.state!==wn.Connected)return void a.forEach(d=>{let{user:f,kind:m}=d;var y;if(m===Ye.AUDIO)(y=f._audioTrack)===null||y===void 0||y._destroy(),f._audioTrack=void 0;else if(m===Ye.VIDEO){var _;(_=f._videoTrack)===null||_===void 0||_._destroy(),f._videoTrack=void 0}});const s=sc(r).call(r,(d,f)=>{let{user:m,mediaType:y}=f;const _=this.filterTobeUnSubscribedTracks(m,y);return d.concat(_)},[]);if(s.length===0)return;await this.connection.stopReceiving(s.map(d=>{let[,{id:f}]=d;return f}));const l=this.createUnsubscribeAllMessage(s);return this.withdrawRemoteTracks(s),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),s.forEach(d=>{let[f,{kind:m}]=d;var y,_;if(m===Ye.VIDEO&&f._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(f._videoSSRC,!1)),m===Ye.VIDEO)this.unbindRemoteTrackEvents(f._videoTrack),(_=f._videoTrack)===null||_===void 0||_._destroy(),f._videoTrack=void 0;else if(m===Ye.AUDIO){var w;this.unbindRemoteTrackEvents(f._audioTrack),(w=f._audioTrack)===null||w===void 0||w._destroy(),f._audioTrack=void 0}}),l}isPreSubScribe(r){return!this.connection||this.state!==wn.Connected?!1:!!this.connection.getPreMedia(r)}async muteRemote(r,a){if(!this.connection)return;const s=this.remoteUserMap.get(r);if(!s)return void F.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(r.uid,"."));if(!s.get(a))return void F.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."));const l=a===Ye.VIDEO?r._videoSSRC:r._audioSSRC;l!==void 0&&this.connection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(r,a){return this.unmuteRemoteNoLock(r,a)}async unmuteRemoteNoLock(r,a){if(!this.connection)return;const s=this.remoteUserMap.get(r);if(!s)return void F.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(r.uid,"."));s.get(a)||F.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."))}addAudioMetadata(r){const a=this.localTrackMap.get(ke.LocalAudioTrack),s=a&&a.track;s&&s.metadata.push(r)}getAllTracks(r){const a=this.localTrackMap.get(ke.LocalAudioTrack);if((a==null?void 0:a.track)instanceof Yr){const s=a.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[d]=l;return d!==ke.LocalAudioTrack}).filter(l=>{let[d]=l;return!(r&&d===ke.LocalVideoLowTrack)}).map(l=>{let[,{track:d}]=l;return d}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[l]=s;return!(r&&l===ke.LocalVideoLowTrack)}).map(s=>{let[,{track:l}]=s;return l})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(r,a,s,l,d){if(r){const m=this.localTrackMap.get(ke.LocalAudioTrack),y=l?this.localTrackMap.get(ke.LocalVideoLowTrack):this.localTrackMap.get(ke.LocalVideoTrack);nt.publish(this.store.sessionId,{eventElapse:qi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.track.getTrackLabel(),videoName:y==null?void 0:y.track.getTrackLabel(),screenshare:(y==null?void 0:y.track._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}else{var f;s||(s=[]);const m=s.find(_=>_ instanceof vr),y=l?(f=this.localTrackMap.get(ke.LocalVideoTrack))===null||f===void 0?void 0:f.track:s.find(_=>_ instanceof Wn);nt.publish(this.store.sessionId,{eventElapse:qi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.getTrackLabel(),videoName:y==null?void 0:y.getTrackLabel(),screenshare:(y==null?void 0:y._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}}reportSubscribeEvent(r,a,s,l){const d=l===Ye.VIDEO?s._videoSSRC:s._audioSSRC;d&&nt.subscribe(this.store.sessionId,{succ:r,ec:a,video:l===Ye.VIDEO,audio:l===Ye.AUDIO,peerid:s.uid,subscribeRequestid:d,p2pid:this.store.p2pId,eventElapse:qi.measureFromSubscribeStart(this.store.clientId,d),preSsrc:this.isPreSubScribe(d)})}reset(){F.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Gi("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=OT(this.store),this.emit(ut.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const r=this.localTrackMap.get(ke.LocalAudioTrack);if((r==null?void 0:r.track)instanceof Yr){if(r.track.trackList.length>0){const a=r.track;r.track.trackList.forEach(s=>{a.removeAudioTrack(s)})}r.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=wn.Disconnected}getStats(){var r;return(r=this.connection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(r){var a;return((a=this.connection)===null||a===void 0?void 0:a.getRemoteVideoIsReady(r))||!1}getLocalAudioVolume(){const r=this.localTrackMap.get(ke.LocalAudioTrack);if(r)return r.track.getVolumeLevel()}getLocalVideoSize(){const r=this.localTrackMap.get(ke.LocalVideoTrack);if(r)return{width:r.track.videoWidth||0,height:r.track.videoHeight||0}}getEncoderConfig(r){const a=this.localTrackMap.get(r);return a&&a.track instanceof Wn||a&&a.track instanceof vr?a.track._encoderConfig:void 0}getLocalMedia(r){return this.localTrackMap.get(r)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}async hasRemoteMediaWithLock(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}getRemoteMedia(r){var a;const s=Array.from(os(a=this.remoteUserMap).call(a)).find(l=>l.uid===r);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let r=Array.from(this.remoteUserMap.entries()).map(s=>{let[l]=s;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const a=this.localTrackMap.get(ke.LocalAudioTrack);return a&&r.push({level:100*a.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=Yf(r).call(r,(s,l)=>s.level-l.level),r}async disconnectForReconnect(){this.connection&&(F.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=wn.Reconnecting,se("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a]=r;var s;a._videoTrack&&a._videoTrack._player&&((s=a._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),a._videoTrack._player.isKeepLastFrame=!0,a._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=OT(this.store),this.emit(ut.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(r=>{var a;let[s,{track:l}]=r;switch(s){case ke.LocalVideoTrack:Ve(a=l._hints).call(a,jn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case ke.LocalAudioTrack:l instanceof Yr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case ke.LocalVideoLowTrack:}}),this.emit(ut.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;Array.from(os(s).call(s)).forEach(l=>{this.setPendingRemoteMedia(a,l)}),this.emit(ut.MediaReconnectStart,a.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(r=>{this.pendingLocalDataChannels.push(r)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(r=>{let[a,s]=r;Array.from(os(s).call(s)).forEach(l=>{this.setPendingRemoteDataChannel(a,l)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),F.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(r,a){for(const s of this.pendingRemoteDataChannels){const{user:l,id:d}=s;if((r instanceof xh?r.uid:r)===l.uid&&d===a)return!0}return!1}setPendingRemoteDataChannel(r,a){this.hasPendingRemoteDataChannel(r,a)||this.pendingRemoteDataChannels.push({user:r,id:a})}hasPendingRemoteMedia(r,a){for(const s of this.pendingRemoteTracks){const{user:l,kind:d}=s;if((r instanceof xh?r.uid:r)===l.uid&&a===d)return!0}return!1}setPendingRemoteMedia(r,a){this.hasPendingRemoteMedia(r,a)||this.pendingRemoteTracks.push({user:r,kind:a})}restartICE(r){var a=this;return To(function*(){if(!a.connection||a.state!==wn.Connected)return;const s=yield ln(a.mutex.lock("From P2PChannel.restartICE"));let l;try{l=yield ln(a.connection.restartICE(r));const f=yield ln(l.next());if(f.done)return;const m=f.value,y=yield m;switch(kD(a.connection)&&a.reportPCStats(Date.now(),!1,a._pcStatsUploadType),r){case Ki.UDP_TCP_RELAY:a._pcStatsUploadType=cd.UDP_TCP_RESTART;break;case Ki.TCP_RELAY:a._pcStatsUploadType=cd.TCP_RESTART;break;case Ki.RELAY:a._pcStatsUploadType=cd.RELAY_RESTART;break;default:a._pcStatsUploadType=cd.OLD_RESTART}a._isTryConnecting=!0,l.next(y)}catch(f){var d;(d=l)===null||d===void 0||d.throw(f)}finally{s()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const r=this.connection.getStats(),a=this.localTrackMap.get(ke.LocalVideoTrack),s=this.localTrackMap.get(ke.LocalAudioTrack),l=r.videoSend.find(L=>L.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId)),d=r.audioSend.find(L=>L.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId));if(!l||!d)return 1;const f=Xs(this,ut.NeedSignalRTT),m=l?l.rttMs:void 0,y=d?d.rttMs:void 0,_=m&&y?(m+y)/2:m||y,w=(_&&f?(_+f)/2:_||f)||0,x=100*r.sendPacketLossRate*.7/50+.3*w/1500,A=x<.17?1:x<.36?2:x<.59?3:x<.1?4:5,I=a==null?void 0:a.track;if(I&&I._encoderConfig&&I._hints.indexOf(jn.SCREEN_TRACK)===-1){const L=I._encoderConfig.bitrateMax,H=r.bitrate.actualEncoded;if(L&&H){const $=(1e3*L-H)/(1e3*L);return tK[$<.15?0:$<.3?1:$<.45?2:$<.6?3:4][A]}}return A}getDownlinkNetworkQuality(){if(!this.connection)return 0;const r=this.connection.getStats();let a=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[l]=s;const d=l._audioSSRC,f=l._videoSSRC,m=r.audioRecv.find(H=>H.ssrc===d),y=r.videoRecv.find(H=>H.ssrc===f);if(!m&&!y)return void(a+=1);const _=Xs(this,ut.NeedSignalRTT),w=r.rtt,x=(w&&_?(w+_)/2:w||_)||0,A=m?m.jitterMs:void 0,I=r.recvPacketLossRate;let L=.7*I*100/50+.3*x/1500;A&&(L=.6*I*100/50+.2*x/1500+.2*A/400),a+=L<.1?1:L<.17?2:L<.36?3:L<.59?4:5}),this.remoteUserMap.size>0?Math.round(a/this.remoteUserMap.size):a}async muteLocalTrack(r){return new Ge((a,s)=>{this.handleMuteLocalTrack(r,a,s)})}async replaceTrack(r,a){var s;if(F.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(r.getTrackId(),"] to [").concat(a.getTrackId(),"]")),!this.connection||this.state!==wn.Connected)return;const l=Array.from(this.localTrackMap.entries()).find(f=>{let[,{track:m}]=f;return r===m});if(!l)return;const d=l[0];if(r!==a&&(this.unbindLocalTrackEvents([{track:r,type:d}]),this.bindLocalTrackEvents([{track:a,type:d}]),l[1].track=a),await((s=this.connection)===null||s===void 0?void 0:s.replaceTrack(a,l[1].id)),this.isPlanB){const f=l[1];f.id=a._mediaStreamTrack.id,this.localTrackMap.set(d,f)}if(d===ke.LocalVideoTrack&&!se("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding){const f=this.localTrackMap.get(ke.LocalVideoLowTrack);if(f){const m=r._mediaStreamTrack.clone();f.track._originMediaStreamTrack.stop(),f.track._mediaStreamTrack=m,f.track._originMediaStreamTrack=m,await new Ge((y,_)=>{this.handleReplaceTrack(f.track,y,_,!0)})}}}filterTobePublishedTracks(r,a,s){const l=[],d=this.getAllTracks();r=_g(r=r.filter(_=>d.indexOf(_)===-1));let f,m=!1;const y=this.localTrackMap.get(ke.LocalAudioTrack);for(const _ of r){if(_ instanceof Wn&&(this.localTrackMap.has(ke.LocalVideoTrack)||m?new Se(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:_,type:ke.LocalVideoTrack}),m=!0),a)){const w=this.getLowVideoTrack(_,s);l.push({track:w,type:ke.LocalVideoLowTrack})}if(_ instanceof vr)if(y){const w=y.track;if(w instanceof Yr)OD([_]),w.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0);else{const x=PD([w,_]);F.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(x.getTrackId(),"]")),this.replaceTrack(w,x)}}else f instanceof Yr?(OD([_]),f.addAudioTrack(_)):f||!_._useAudioElement&&un().webAudioMediaStreamDest&&!_._bypassWebAudio?f=PD(f?[_,f]:[_]):f=_}return f&&(F.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(f.getTrackId(),"]")),l.push({track:f,type:ke.LocalAudioTrack})),l}filterTobeUnpublishedTracks(r){const a=[],s=this.getAllTracks();r=_g(r=r.filter(l=>s.indexOf(l)!==-1));for(const l of r){if(l instanceof vr){const d=this.localTrackMap.get(ke.LocalAudioTrack);if(!d)continue;d.track instanceof Yr?(d.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),d.track.trackList.length===0&&(a.push([ke.LocalAudioTrack,d]),d.track.close())):a.push([ke.LocalAudioTrack,d])}if(l instanceof Wn){const d=this.localTrackMap.get(ke.LocalVideoTrack);if(!d)continue;a.push([ke.LocalVideoTrack,d]);const f=this.localTrackMap.get(ke.LocalVideoLowTrack);f&&a.push([ke.LocalVideoLowTrack,f])}}return a}filterTobePublishedDataChannels(r){return r=(r=_g(r)).filter(a=>this.localDataChannels.findIndex(s=>s.id===a.id)===-1)}filterTobeUnpublishedDataChannels(r){return r=(r=(r=_g(r)).filter(a=>this.localDataChannels.indexOf(a)!==-1)).filter(a=>a._originDataChannel)}bindLocalTrackEvents(r){r.forEach(a=>{let{track:s,type:l}=a;switch(l){case ke.LocalVideoTrack:s.addListener(Ze.GET_STATS,this.handleGetLocalVideoStats),s.addListener(Ze.GET_RTC_STATS,this.handleGetRTCStats),s.addListener(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ze.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(Ze.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.addListener(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ke.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case ke.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(r,a){r instanceof Yr?r.trackList.forEach(s=>{s.addListener(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ze.GET_STATS,this.handleGetLocalAudioStats),s.addListener(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.addListener(Ze.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),a||(r.addListener(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(Ze.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(r){r||(r=Array.from(this.localTrackMap.entries()).map(a=>{let[s,{track:l}]=a;return{track:l,type:s}})),r.forEach(a=>{let{track:s,type:l}=a;switch(l){case ke.LocalVideoTrack:s.off(Ze.GET_STATS,this.handleGetLocalVideoStats),s.off(Ze.GET_RTC_STATS,this.handleGetRTCStats),s.off(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(Ze.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(Ze.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.off(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ke.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case ke.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(r){r instanceof Yr?r.trackList.forEach(a=>{a.off(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(Ze.GET_STATS,this.handleGetLocalAudioStats),a.off(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.off(Ze.GET_STATS,this.handleGetLocalAudioStats),r.off(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Ze.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),r.off(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(r,a){a instanceof Pg&&a.addListener(Ze.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(r))}),a instanceof kg&&a.addListener(Ze.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(r))})}unbindRemoteTrackEvents(r){r&&r.removeAllListeners(Ze.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;s.has(Ye.AUDIO)&&this.unbindRemoteTrackEvents(a._audioTrack),s.has(Ye.VIDEO)&&this.unbindRemoteTrackEvents(a._videoTrack)})}createGatewayPublishMessage(r,a){return r.map((s,l)=>{var d;let f,m,{track:y,type:_}=s;switch(_){case ke.LocalAudioTrack:f=xn.Audio,m={dtx:y instanceof mb&&y._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case ke.LocalVideoTrack:f=Ve(d=y._hints).call(d,jn.SCREEN_TRACK)?xn.Screen:xn.High,m=cu(cu({},vK(y)),{},{codec:this.store.codec,svc_mode:vT()});break;case ke.LocalVideoLowTrack:f=xn.Low,m=cu(cu({},vK(y)),{},{codec:this.store.codec,svc_mode:vT()})}return{stream_type:f,attributes:m,ssrcs:a[l]}})}createGatewayUnpublishMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case ke.LocalVideoTrack:l=Ve(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}assignLocalTracks(r,a){r.forEach((s,l)=>{let{track:d,type:f}=s;this.localTrackMap.set(f,{track:d,id:a[l].id,ssrcs:a[l].localSSRC})})}withdrawLocalTracks(r){r.forEach(a=>{let[s]=a;this.localTrackMap.delete(s)})}bindConnectionEvents(r){r.onConnectionStateChange=async a=>{if(F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(a,")")),this.emit(ut.PeerConnectionStateChange,a),a==="connecting"&&r instanceof Oo&&!dr()&&se("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{a==="connecting"&&r.extendCandidate()},se("FIRST_TCP_CANDIDATE_INTERVAL")),a!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),a==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),r instanceof Oo&&hq(r,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=cd.DISCONNECTED_OR_FAILED,Xs(this,ut.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const s=this.pendingLocalTracks.map(d=>d.getTrackId()),l=this.pendingLocalDataChannels.map(d=>"dc_".concat(d.id));nt.reportApiInvoke(this.store.sessionId,{name:Er.REPUB_AFTER_PC_CONNECTED,options:s.concat(l),tag:rr.TRACER}).onSuccess(),this.republish()}if(se("NEW_ICE_RESTART")&&r instanceof Oo&&!dr()&&!this._forceTurn){if(Ve(dK).call(dK,a)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const s=d=>{kD(r)&&(F.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(d)),Xs(this,ut.QueryClientConnectionState)==="CONNECTED"&&this.emit(ut.RequestRestartICE,d))},l=()=>{kD(r)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),F.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(ut.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{fq(r,s,l)},800))}}else{if(a==="disconnected"&&r.iceConnectionState==="disconnected")return setTimeout(()=>{r.iceConnectionState==="disconnected"&&se("ICE_RESTART")&&Xs(this,ut.QueryClientConnectionState)==="CONNECTED"&&this.emit(ut.RequestRestartICE)},800),void setTimeout(()=>{r.peerConnectionState==="disconnected"&&(F.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(ut.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);a==="failed"&&(F.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(ut.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},r.onICEConnectionStateChange=a=>{a!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(a,")")),nt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:a,tag:rr.TRACER}).onSuccess(),this.emit(ut.IceConnectionStateChange,a)},r.onICETransportStateChange=a=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(a,")"))},r.onDTLSTransportStateChange=a=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(a,")"))},r.onDTLSTransportError=a=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(a,")"))},r.onFirstAudioDecoded=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(f=>f._audioSSRC===a);var d;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(d=l.audioTrack)===null||d===void 0||d.emit(No.FIRST_FRAME_DECODED),nt.firstRemoteFrame(this.store.sessionId,ri.FIRST_AUDIO_DECODE,Qn.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},r.onFirstAudioReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._audioSSRC===a);l&&nt.firstRemoteFrame(this.store.sessionId,ri.FIRST_AUDIO_RECEIVED,Qn.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},r.onFirstVideoDecoded=(a,s,l)=>{var d;const f=Array.from(os(d=this.remoteUserMap).call(d)).find(m=>m._videoSSRC===a);f&&this.store.firstVideoFrameDecoded(f.uid,{firstDecoded:Date.now()}),this.reportVideoFirstFrameDecoded(a,s,l)},r.onFirstVideoRender=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===a);l&&(this.store.firstVideoFrameDecoded(l.uid,{firstPreRender:Date.now()}),this.reportVideoFirstFrameRender(l))},r.onFirstVideoReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===a);l&&(this.store.firstVideoFrameDecoded(l.uid,{firstReceived:Date.now()}),nt.firstRemoteFrame(this.store.sessionId,ri.FIRST_VIDEO_RECEIVED,Qn.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},r.onSelectedLocalCandidateChanged=(a,s)=>{const l=a.candidateType==="relay",d=s.candidateType==="relay";s.candidateType!=="unknown"&&l===d||this.emit(ut.ConnectionTypeChange,l),F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(_h(s))," -> ").concat(JSON.stringify(_h(a)),")"))},r.onSelectedRemoteCandidateChanged=(a,s)=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(_h(s))," -> ").concat(JSON.stringify(_h(a)),")"))},r.onFirstVideoDecodedTimeout=a=>{this.reportVideoFirstFrameDecoded(a,void 0,void 0,!0)},r.getLocalVideoStats=()=>{const a=this.statsCollector.getLocalVideoTrackStats(),s=this.statsCollector.getRTCStats();return cu(cu({},a),s)},r.onICECandidateError=a=>{this._iceError=a}}resetConnection(r){r instanceof Oo&&function(a){zg.delete(a.id),hq(a)}(r),r.close(),this.emit(ut.PeerConnectionStateChange,"closed"),function(a){a.onConnectionStateChange=void 0,a.onICEConnectionStateChange=void 0,a.onICETransportStateChange=void 0,a.onDTLSTransportStateChange=void 0,a.onDTLSTransportError=void 0,a.onFirstAudioDecoded=void 0,a.onFirstAudioReceived=void 0,a.onFirstVideoDecoded=void 0,a.onFirstVideoReceived=void 0,a.onSelectedLocalCandidateChanged=void 0,a.onSelectedRemoteCandidateChanged=void 0,a.onFirstVideoDecodedTimeout=void 0,a.getLocalVideoStats=void 0}(r),this._isWaitPcToRePub=!1}filterTobeMutedTracks(r){const a=[];if(this.getAllTracks().indexOf(r)===-1)return a;const s=this.localTrackMap.get(ke.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive||a.push([ke.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l&&(a.push(l),l[0]===ke.LocalVideoTrack)){const d=this.localTrackMap.get(ke.LocalVideoLowTrack);d&&a.push([ke.LocalVideoLowTrack,d])}return a}filterTobeUnmutedTracks(r){const a=[],s=this.localTrackMap.get(ke.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive&&a.push([ke.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l)if(l[0]===ke.LocalVideoTrack){a.push(l);const d=this.localTrackMap.get(ke.LocalVideoLowTrack);d&&a.push([ke.LocalVideoLowTrack,d])}else a.push(l);return a}createMuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoTrack:l=Ve(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}createUnmuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoTrack:l=Ve(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}filterTobeUnSubscribedTracks(r,a){const s=[],l=this.remoteUserMap.get(r);if(!l)return s;if(a){const d=l.get(a);if(!d)return s;s.push([r,{kind:a,id:d}])}else Array.from(l.entries()).forEach(d=>{let[f,m]=d;s.push([r,{kind:f,id:m}])});return s}filterTobeUnSubscribedDataChannels(r,a){const s=[];return a.forEach(l=>{var d;(d=this.remoteDataChannelMap.get(r))!==null&&d!==void 0&&d.has(l.id)&&s.push(l)}),s}createUnsubscribeMessage(r){const a=[];return r.forEach(s=>{let[l,{kind:d,id:f}]=s;switch(d){case Ye.VIDEO:return void(l._videoSSRC&&a.push({stream_type:Ye.VIDEO,ssrcId:l._videoSSRC}));case Ye.AUDIO:return void(l._audioSSRC&&a.push({stream_type:Ye.AUDIO,ssrcId:l._audioSSRC}))}}),a}createUnsubscribeAllMessage(r){const a=new Map;return r.forEach(s=>{let[l,{kind:d}]=s;if(a.has(l)){let f=a.get(l);d===Ye.VIDEO?f|=ci.Video:f|=ci.Audio,a.set(l,f)}else d===Ye.VIDEO?a.set(l,ci.Video):a.set(l,ci.Audio)}),{users:Array.from(a.entries()).map(s=>{let[l,d]=s;return{stream_id:l.uid,stream_type:d}})}}withdrawRemoteTracks(r){r.forEach(a=>{let[s,{kind:l}]=a;const d=this.remoteUserMap.get(s);d&&(d.delete(l),Array.from(d.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(r){const a=this.localTrackMap.get(ke.LocalVideoTrack),s=this.localTrackMap.get(ke.LocalVideoLowTrack);a&&(await a.track.setBitrateLimit(r.uplink),await new Ge((l,d)=>{this.handleUpdateVideoEncoder(a.track,l,d,!0)})),s&&r.low_stream_uplink&&(await s.track.setBitrateLimit({max_bitrate:r.low_stream_uplink.bitrate,min_bitrate:r.low_stream_uplink.bitrate||0}),await new Ge((l,d)=>{this.handleUpdateVideoEncoder(s.track,l,d,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}isPreallocation(){return this.connection instanceof Oo&&this.connection.isPreallocation}isPreSub(){return this.connection instanceof Oo&&this.connection.isPreSub()}mapPubResToRemoteConfig(r,a,s){return r.map((l,d)=>{var f;let{stream_type:m}=l;const y=(f=a.find(_=>{let{stream_type:w}=_;return m===w}))===null||f===void 0?void 0:f.attributes;if(y&&se("DISABLE_SCREEN_SHARE_REMB")){const _=s[d]._hints;(Ve(_).call(_,jn.SCREEN_TRACK)||Ve(_).call(_,jn.SCREEN_LOW_TRACK))&&(y.remb=!1,F.debug("disable remb for screen share, hints:",_))}return y})}async tryToUnmuteAudio(r){for(let s=0;s<r.length;s++)if(r[s]instanceof vr){var a;const l=this.filterTobeUnmutedTracks(r[s]);if(l.length===0)continue;await((a=this.connection)===null||a===void 0?void 0:a.unmuteLocal(l.map(f=>{let[,{id:m}]=f;return m})));const d=this.createUnmuteMessage(l);return void await Ln(this,ut.RequestUnmuteLocal,d)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=r=>{var a;return!((a=this.connection)===null||a===void 0||!a.getRemoteVideoIsReady(r))},this.statsUploader.requestUpload=(r,a)=>this.emit(ut.RequestUpload,r,a),this.statsUploader.requestUploadStats=r=>this.emit(ut.RequestUploadStats,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var r;return{connectState:((r=this.connection)===null||r===void 0?void 0:r.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Ci(yj(this.dtlsFailedCount,Gr)),this.emit(ut.RequestReconnect)}async reconnectP2P(){const r=Array.from(this.localTrackMap.entries()),a=this.createGatewayUnpublishMessage(r);Array.from(this.remoteUserMap.entries()),a.length>0&&await Li(this,ut.RequestUnpublishForReconnectPC,a),this.disconnectForReconnect(),this.emit(ut.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(ke.LocalVideoTrack)||this.pendingLocalTracks.some(r=>r instanceof Wn)}throwIfTrackTypeNotMatch(r){if(r.filter(a=>a instanceof Wn).length>1)throw new Se(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r.filter(a=>a instanceof vr).length>1&&(r.some(a=>a instanceof vr&&a._bypassWebAudio)||!un().webAudioMediaStreamDest))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const a of r){if(a instanceof Wn&&this.pendingLocalTracks.some(s=>s instanceof Wn))throw new Se(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(a instanceof vr&&this.pendingLocalTracks.some(s=>s instanceof vr)&&(!un().webAudioMediaStreamDest||a._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof vr&&s._bypassWebAudio)))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(r,a){var s;const l=!se("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding,d=cu(cu({},{width:160,height:120,framerate:15,bitrate:50}),a);let f;f=l?r._mediaStreamTrack.clone():jD(r,d);const m=Mn(8,"track-low-"),y=new Wn(f,cu(cu({},l&&{scaleResolutionDownBy:pD(d,r)}),{},{frameRate:d.framerate,bitrateMax:d.bitrate,bitrateMin:d.bitrate}),void 0,void 0,m);return y.on(cp.TRANSCEIVER_UPDATED,_=>{r._updateRtpTransceiver(_,Cg.LOW_STREAM)}),y._hints.push(jn.LOW_STREAM),Ve(s=r._hints).call(s,jn.SCREEN_TRACK)&&y._hints.push(jn.SCREEN_LOW_TRACK),r.on("sei-to-send",_=>{y.emit("sei-to-send",_)}),r.addListener(Ze.NEED_CLOSE,()=>{y.close()}),y}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(r,a,s){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Oo){var d,f,m,y;const _=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:w,dtlsTransportState:x,peerConnectionState:A}=this.connection,{local:I,remote:L}=await this.connection.getSelectedCandidatePair();nt.pcStats(this.store.sessionId,{startTime:_,eventElapse:r-_||0,iceconnectionsate:w,dtlsstate:x,connectionstate:A,intSucc:a?1:2,error:this._iceError||l||"",selectedLocalCandidateProtocol:(d=I==null?void 0:I.protocol)!==null&&d!==void 0?d:"",selectedLocalCandidateType:(f=I.candidateType)!==null&&f!==void 0?f:"",selectedLocalCandidateAddress:"".concat(I.address,":").concat(I.port),selectedRemoteCandidateProtocol:(m=L.protocol)!==null&&m!==void 0?m:"",selectedRemoteCandidateType:(y=L.candidateType)!==null&&y!==void 0?y:"",selectedRemoteCandidateAddress:"".concat(L.address,":").concat(L.port),restartCnt:s,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameRender(r){const a=this.store.keyMetrics,s=a.firstVideoFrameDecoded.find(x=>x.userId===r.uid);if(!s)return;const{isInternalUpload:l,isExternalUpload:d}=s;if(l&&d)return;const{subscribeEnd:f,firstPreRender:m,peerPublishDuration:y,peerPubStatusMs:_}=s;let{firstRender:w=0}=s;if(f&&(w||m)&&y&&_){s.isInternalUpload=!0;const{playEnd:x}=s;x&&(s.isExternalUpload=!0);const{firstPreRender:A=0}=s;w=A||w;const I=r.videoTrack,L={peer:r._uintid,width:(I==null?void 0:I._videoWidth)||0,height:(I==null?void 0:I._videoHeight)||0,ssrc:r._videoSSRC||0,p2pid:this.store.p2pId,peerPublishDuration:y,peerPubStatusMs:_,joinChannelStart:a.joinStart||0,preloadStart:a.preloadStart||0,preloadEnd:a.preloadEnd||0,apStart:a.requestAPStart||0,apEnd:a.requestAPEnd||0,suaEnd:a.requestSUAEnd||0,beforeConnect:a.beforeConnect||0,peerReceiver:a.peerReceiver||0,ice:a.iceConnectionEnd||0,pc:a.peerConnectionEnd||0,signalConnected:a.signalConnected||0,joinReq:a.joinReq||0,joinRes:a.joinRep||0,userJoinNotify:s.userJoinNotify||0,videoAddNotify:s.videoAddNotify||0,subscribeStart:s.subscribeStart||0,subscribeEnd:s.subscribeEnd||0,firstReceived:s.firstReceived||0,firstDecoded:s.firstDecoded||0,firstPreRender:A||0,firstRender:x?Math.max(w,x):Math.max(w,f),playStart:s.playStart||0,playEnd:s.playEnd||0,isPreSub:!(!r._videoSSRC||!this.isPreSubScribe(r._videoSSRC)),isPrePc:this.isPreallocation(),isPreInstantVideo:Bz(this.store)};nt.firstXLAPeerFirstVideoFrame(this.store.sessionId,L)}}reportVideoFirstFrameDecoded(r,a,s,l){var d;const f=Array.from(os(d=this.remoteUserMap).call(d)).find(m=>m._videoSSRC===r);if(f){l||this.store.subscribe(f.uid,"video",void 0,void 0,void 0,void 0,Date.now());const m=this.store.keyMetrics,y=m.subscribe.find(_=>_.userId===f.uid&&_.type==="video");nt.firstRemoteVideoDecode(this.store.sessionId,ri.FIRST_VIDEO_DECODE,Qn.FIRST_VIDEO_DECODE,{peer:f._uintid,videowidth:a,videoheight:s,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId,apEnd:m.requestAPEnd||0,apStart:m.requestAPStart||0,joinGwEnd:m.joinGatewayEnd||0,joinGwStart:m.joinGatewayStart||0,pcEnd:m.peerConnectionEnd||0,pcStart:m.peerConnectionStart||0,subscriberEnd:(y==null?void 0:y.subscribeEnd)||0,subscriberStart:(y==null?void 0:y.subscribeStart)||0,videoAddNotify:(y==null?void 0:y.streamAdded)||0,state:l?1:0,firstFrame:(y==null?void 0:y.firstFrame)||0})}}async remoteMediaSsrcChanged(r,a,s){if(!this.connection)return!1;const l=this.remoteUserMap.get(r);if(!l)return!1;const d=l.get(a);if(!d)return!1;const f=await this.connection.getRemoteSSRC(d);return f!==void 0&&f!==s}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(r=>{let[a,{track:s}]=r;a===ke.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,Cg.LOW_STREAM):s._updateRtpTransceiver(void 0)})}},tt(Zt.prototype,"startP2PConnection",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"startP2PConnection"),Zt.prototype),tt(Zt.prototype,"connect",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"connect"),Zt.prototype),tt(Zt.prototype,"updateRemoteRTPCapabilities",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"updateRemoteRTPCapabilities"),Zt.prototype),tt(Zt.prototype,"publishDataChannel",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"publishDataChannel"),Zt.prototype),tt(Zt.prototype,"unpublish",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"unpublish"),Zt.prototype),tt(Zt.prototype,"unpublishDataChannel",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"unpublishDataChannel"),Zt.prototype),tt(Zt.prototype,"unpublishLowStream",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"unpublishLowStream"),Zt.prototype),tt(Zt.prototype,"subscribeDataChannel",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"subscribeDataChannel"),Zt.prototype),tt(Zt.prototype,"subscribe",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"subscribe"),Zt.prototype),tt(Zt.prototype,"massSubscribe",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"massSubscribe"),Zt.prototype),tt(Zt.prototype,"unsubscribe",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"unsubscribe"),Zt.prototype),tt(Zt.prototype,"unsubscribeDataChannel",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"unsubscribeDataChannel"),Zt.prototype),tt(Zt.prototype,"massUnsubscribe",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"massUnsubscribe"),Zt.prototype),tt(Zt.prototype,"muteRemote",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"muteRemote"),Zt.prototype),tt(Zt.prototype,"unmuteRemote",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"unmuteRemote"),Zt.prototype),tt(Zt.prototype,"hasRemoteMediaWithLock",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"hasRemoteMediaWithLock"),Zt.prototype),tt(Zt.prototype,"disconnectForReconnect",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"disconnectForReconnect"),Zt.prototype),tt(Zt.prototype,"updateBitrateLimit",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"updateBitrateLimit"),Zt.prototype),tt(Zt.prototype,"remoteMediaSsrcChanged",[Sa],Object.getOwnPropertyDescriptor(Zt.prototype,"remoteMediaSsrcChanged"),Zt.prototype),Zt);function Sa(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("From P2PChannel.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}function gq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function vq(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?gq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):gq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const COe=Date.now(),ROe=20,LD=new Map,LT=new Map;async function yq(r){const a=LD.get(r),s=Array.isArray(a)&&a[a.length-1],l=LT.get(r);if(!s)return void(l.isSyncing=!1);const d={uid:s.uid,payload:s.payload};l.firstRecvTs===0&&(l.firstRecvTs=s.recvTs,l.firstSendTs=s.sendTs);const f=s.sendTs-l.firstSendTs,m=f-(Date.now()-l.firstRecvTs);m>0&&(l.firstRecvTs=Date.now()-f);let y=s.mediaDelay+m;y<=0?(a.pop(),_q(s.context,d),y=0):y=Math.min(y,ROe),setTimeout(()=>a.length&&yq(r),y)}function _q(r,a){r.safeEmit(Qt.STREAM_MESSAGE,a.uid,a.payload),r.onStreamMessage&&r.onStreamMessage(a)}function NOe(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;if(!r.syncWithAudio)return _q(s,{uid:r.uid,payload:r.payload});const l="".concat(s.id,"-").concat(r.uid),d=LD.get(l)||[],f=d.findIndex(w=>r.sendTs>=w.sendTs),m=vq(vq({},r),{},{context:s,mediaDelay:a,recvTs:Date.now()});f===-1?d.push(m):d.splice(f,0,m),LD.set(l,d);let y=!1;var _;LT.has(l)?y=!((_=LT.get(l))===null||_===void 0||!_.isSyncing):LT.set(l,{isSyncing:y,firstRecvTs:0,firstSendTs:0}),y||yq(l)}const AOe=sn().name;function bq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Eq(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?bq(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):bq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const Kg="websdk_ng_cache_parameter",IOe=se("MAX_PRELOAD_ASYNC_LENGTH"),OOe=1e4,yp=new Map,_p=[];let MD=null,UD=0,FD=0;const MT=new Map,POe=function(r,a){const s=[];let l=0;const d=async()=>{const f=s.shift();f&&await f(),s.length>0&&l<a?d():l--};return async function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];return new Ge(async(_,w)=>{s.push(async()=>{try{const x=await r(...m);_(x)}catch(x){w(x)}}),l<a&&(l++,d())})}}(wq,IOe),VD=Ka.CancelToken.source();async function wq(r,a,s,l,d,f){try{if(!se("ENABLE_PRELOAD"))return;if(!un().supportWebCrypto)return void hh(()=>{F.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!s&&s!==null)throw new Se(ie.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));s&&Ti(s,"token",1,2047),Ti(r,"appid",1,2047),dT(a),l&&hT(l);const m=sp();F.debug("preload channel ".concat(a,", uid is ").concat(l));const y={appId:r,cname:a,token:s||r,uid:typeof l!="string"?l:null,sid:m,proxyServer:d};let _,w;typeof l=="string"?(y.stringUid=l,[w,_]=await Ge.all([mOe(l,{sid:m,appId:r},VD.token),qK(Eq(Eq({},y),{},{token:s||r,uid:0}),VD.token)]),y.uid=w.uid,_.gatewayInfo.uid=y.uid,_.gatewayInfo.res.uid=y.uid):(f&&(y.stringUid=f),_=await qK(y,VD.token));const x={sid:m,appId:r,cname:a,token:s||r,uid:y.stringUid||l,intUid:y.uid||_.gatewayInfo.uid,stringUid:y.stringUid,ts:Date.now(),sua:w,ap:_};await async function(A){let I;try{A.uid&&xq({appId:A.appId,cname:A.cname,token:A.token,uid:A.uid,stringUid:A.stringUid});const L=Nq(A),H=await async function(G,ne){try{const te=await window.crypto.subtle.importKey("raw",pz(ne),"AES-GCM",!1,["encrypt"]),ce=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},te,ap(window.btoa(JSON.stringify(G))));return fh(new Uint8Array(ce))}catch{return}}(A,A.token||A.appId);if(!H)return;I=Rq(Kg);const $=I?JSON.parse(I):[];$.push({[L]:H}),$.length>se("AP_CACHE_NUM")&&$.shift(),UT(Kg,JSON.stringify($))}catch(L){F.warn("Error caching server parameters:",L.message),UT(Kg,"")}}(x),UD++}catch(m){throw FD++,function(y){MD||(MD=window.setTimeout(()=>{let w="";MT.forEach((x,A)=>{w+="".concat(A,": ").concat(x," ;")}),nt.reportApiInvoke(null,{name:Er.PRELOAD,options:{success:UD,failed:FD,err:w}}).onError(y),UD=0,FD=0,MT.clear(),MD=null},OOe));const _=MT.get(y.code)||0;MT.set(y.code,_+1)}(m),m}}async function Sq(r){try{if(se("AP_REQUEST_DETAIL")||se("ENABLE_ROLE_SELECT_EDGE"))return;const a=xq(r);if(!a||r.cloudProxyServer!=="disabled")return;const s=await async function(l,d){try{const f=await window.crypto.subtle.importKey("raw",pz(d),"AES-GCM",!1,["decrypt"]),m=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},f,ap(l));return JSON.parse(window.atob(fh(new Uint8Array(m))))}catch{return}}(a,r.token||r.appId);if(!s||!function(l,d){return l.cname===d.cname&&l.appId===d.appId&&l.token===d.token?d.stringUid?l.stringUid===d.stringUid:typeof d.uid=="number"?l.uid===d.uid:l.uid==d.uid:!1}(s,r))return;if(s&&Date.now()-s.ts<se("AP_CACHE_LIFETIME"))return s}catch(a){F.warn("Error get preloadInfo",a.message)}}function xq(r){let a;try{if(a=Rq(Kg),!a)return;const s=JSON.parse(a),l=Nq(r),d=function(m,y){for(let _=m.length-1;_>=0;_--)if(y(m[_]))return _;return-1}(s,m=>l in m);if(d===-1)return;const f=s.splice(d,1)[0];return UT(Kg,JSON.stringify(s)),f[l]}catch(s){F.warn("Error delete preload info: ".concat(a),s.message),UT(Kg,"")}}function BD(r){if(r){let a=yp.get(r);a&&(window.clearTimeout(a),a=null,yp.delete(r)),Ve(_p).call(_p,r)||r.cloudProxyServer!=="disabled"||_p.push(r)}if(yp.size<se("AP_CACHE_NUM")&&_p.length>0){const a=_p.shift();yp.set(a,window.setTimeout(async()=>{const{appId:s,cname:l,token:d,stringUid:f,uid:m,proxyServer:y}=a;try{await POe(s,l,d,m,y,f),yp.has(a)&&BD(a)}catch(_){F.warn("update preload failed",_.message),Tq(a)}},se("AP_UPDATE_INTERVAL")))}}function Tq(r){const a=_p.indexOf(r);a!==-1&&_p.splice(a,1);let s=yp.get(r);s&&(window.clearTimeout(s),s=null,yp.delete(r),BD())}function Cq(r,a){const s=r.sua,l=r.ap;a&&s&&nt.reqUserAccount(r.sid,{lts:s.requestTime,elapse:s.elapse,success:!0,serverAddr:s.url,stringUid:a,uid:r.intUid,errorCode:null,extend:s.req}),nt.reportResourceTiming(r.ap.url,r.sid),nt.joinWebProxyAP(r.sid,{lts:l.requestTime,elapse:l.elapse,sucess:1,apServerAddr:l.url,turnServerAddrList:l.proxyInfo.addresses.map(d=>d.ip).join(","),eventType:"disabled",unilbsServerIds:[Lr.CHOOSE_SERVER,Lr.CLOUD_PROXY_FALLBACK].toString()}),nt.joinChooseServer(r.sid,{lts:l.requestTime,elapse:l.elapse,succ:!0,csAddr:l.url,opid:l.opid,serverList:l.gatewayInfo.gatewayAddrs.map(d=>d.address),ec:null,cid:l.gatewayInfo.cid.toString(),uid:l.gatewayInfo.uid.toString(),csIp:l.gatewayInfo.csIp,unilbsServerIds:[Lr.CHOOSE_SERVER].toString(),isHttp3:l.isHttp3})}function Rq(r){return window.atob(window.localStorage.getItem(r)||"")}function UT(r,a){window.localStorage.setItem(r,window.btoa(a))}function Nq(r){let a="".concat(r.appId,"_").concat(r.cname);return typeof r.uid=="string"&&(a+="_s_".concat(r.uid)),typeof r.uid=="number"&&(a+="_".concat(r.uid)),r.token&&(a+="_".concat(r.token)),Ez(a)}function kOe(r){let a=function(){const s=LOe.pop();return s?(s.offset=s.limit=0,s):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(s,l){let d=s.appId;d!==void 0&&(Mr(l,10),Ch(l,d));let f=s.cid;f!==void 0&&(Mr(l,16),Mr(l,f));let m=s.cname;m!==void 0&&(Mr(l,26),Ch(l,m));let y=s.deviceId;y!==void 0&&(Mr(l,34),Ch(l,y));let _=s.elapse;_!==void 0&&(Mr(l,40),Rh(l,_));let w=s.fileSize;w!==void 0&&(Mr(l,48),Rh(l,qg(w)));let x=s.height;x!==void 0&&(Mr(l,56),Rh(l,qg(x)));let A=s.jpg;A!==void 0&&(Mr(l,66),Mr(l,A.length),Iq(l,A));let I=s.networkType;I!==void 0&&(Mr(l,72),Rh(l,qg(I)));let L=s.osType;L!==void 0&&(Mr(l,80),Rh(l,qg(L)));let H=s.requestId;H!==void 0&&(Mr(l,90),Ch(l,H));let $=s.sdkVersion;$!==void 0&&(Mr(l,98),Ch(l,$));let G=s.sequence;G!==void 0&&(Mr(l,104),Rh(l,qg(G)));let ne=s.sid;ne!==void 0&&(Mr(l,114),Ch(l,ne));let te=s.timestamp;te!==void 0&&(Mr(l,120),Rh(l,te));let ce=s.uid;ce!==void 0&&(Mr(l,128),Mr(l,ce));let pe=s.vid;pe!==void 0&&(Mr(l,136),Mr(l,pe));let fe=s.width;fe!==void 0&&(Mr(l,144),Rh(l,qg(fe)));let ue=s.service;ue!==void 0&&(Mr(l,152),Mr(l,ue));let ye=s.callbackData;ye!==void 0&&(Mr(l,162),Mr(l,ye.length),Iq(l,ye));let xe=s.ticket;xe!==void 0&&(Mr(l,170),Ch(l,xe));let Ae=s.vendorConfigs;Ae!==void 0&&(Mr(l,178),Ch(l,Ae))}(r,a),function(s){let l=s.bytes,d=s.limit;return l.length===d?l:l.subarray(0,d)}(a)}function jOe(r){return function(s){let l={};e:for(;!MOe(s);){let d=Ib(s);switch(d>>>3){case 0:break e;case 1:l.code=Ib(s);break;case 2:l.msg=Oq(s,Ib(s));break;case 3:l.requestId=Oq(s,Ib(s));break;case 4:l.timestamp=UOe(s,!1);break;default:DOe(s,7&d)}}return l}({bytes:a=r,offset:0,limit:a.length});var a}function DOe(r,a){switch(a){case 0:for(;128&Ec(r););break;case 2:$D(r,Ib(r));break;case 5:$D(r,4);break;case 1:$D(r,8);break;default:throw new Error("Unimplemented type: "+a)}}function qg(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}let LOe=[];function $D(r,a){if(r.offset+a>r.limit)throw new Error("Skip past limit");r.offset+=a}function MOe(r){return r.offset>=r.limit}function FT(r,a){let s=r.bytes,l=r.offset,d=r.limit,f=l+a;if(f>s.length){let m=new Uint8Array(2*f);m.set(s),r.bytes=m}return r.offset=f,f>d&&(r.limit=f),l}function Aq(r,a){let s=r.offset;if(s+a>r.limit)throw new Error("Read past limit");return r.offset+=a,s}function Iq(r,a){let s=FT(r,a.length);r.bytes.set(a,s)}function Oq(r,a){let s=Aq(r,a),l=String.fromCharCode,d=r.bytes,f="�",m="";for(let y=0;y<a;y++){let _,w,x,A,I=d[y+s];128&I?(224&I)==192?y+1>=a?m+=f:(_=d[y+s+1],(192&_)!=128?m+=f:(A=(31&I)<<6|63&_,A<128?m+=f:(m+=l(A),y++))):(240&I)==224?y+2>=a?m+=f:(_=d[y+s+1],w=d[y+s+2],(49344&(_|w<<8))!=32896?m+=f:(A=(15&I)<<12|(63&_)<<6|63&w,A<2048||A>=55296&&A<=57343?m+=f:(m+=l(A),y+=2))):(248&I)==240?y+3>=a?m+=f:(_=d[y+s+1],w=d[y+s+2],x=d[y+s+3],(12632256&(_|w<<8|x<<16))!=8421504?m+=f:(A=(7&I)<<18|(63&_)<<12|(63&w)<<6|63&x,A<65536||A>1114111?m+=f:(A-=65536,m+=l(55296+(A>>10),56320+(1023&A)),y+=3))):m+=f:m+=l(I)}return m}function Ch(r,a){let s=a.length,l=0;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),l+=y<128?1:y<2048?2:y<65536?3:4}Mr(r,l);let d=FT(r,l),f=r.bytes;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),y<128?f[d++]=y:(y<2048?f[d++]=y>>6&31|192:(y<65536?f[d++]=y>>12&15|224:(f[d++]=y>>18&7|240,f[d++]=y>>12&63|128),f[d++]=y>>6&63|128),f[d++]=63&y|128)}}function Ec(r){return r.bytes[Aq(r,1)]}function Pq(r,a){let s=FT(r,1);r.bytes[s]=a}function Ib(r){let a,s=0,l=0;do a=Ec(r),s<32&&(l|=(127&a)<<s),s+=7;while(128&a);return l}function Mr(r,a){for(a>>>=0;a>=128;)Pq(r,127&a|128),a>>>=7;Pq(r,a)}function UOe(r,a){let s,l=0,d=0,f=0;return s=Ec(r),l=127&s,128&s&&(s=Ec(r),l|=(127&s)<<7,128&s&&(s=Ec(r),l|=(127&s)<<14,128&s&&(s=Ec(r),l|=(127&s)<<21,128&s&&(s=Ec(r),d=127&s,128&s&&(s=Ec(r),d|=(127&s)<<7,128&s&&(s=Ec(r),d|=(127&s)<<14,128&s&&(s=Ec(r),d|=(127&s)<<21,128&s&&(s=Ec(r),f=127&s,128&s&&(s=Ec(r),f|=(127&s)<<7))))))))),{low:l|d<<28,high:d>>>4|f<<24,unsigned:a}}function Rh(r,a){let s=a.low>>>0,l=(a.low>>>28|a.high<<4)>>>0,d=a.high>>>24,f=d===0?l===0?s<16384?s<128?1:2:s<1<<21?3:4:l<16384?l<128?5:6:l<1<<21?7:8:d<128?9:10,m=FT(r,f),y=r.bytes;switch(f){case 10:y[m+9]=d>>>7&1;case 9:y[m+8]=f!==9?128|d:127&d;case 8:y[m+7]=f!==8?l>>>21|128:l>>>21&127;case 7:y[m+6]=f!==7?l>>>14|128:l>>>14&127;case 6:y[m+5]=f!==6?l>>>7|128:l>>>7&127;case 5:y[m+4]=f!==5?128|l:127&l;case 4:y[m+3]=f!==4?s>>>21|128:s>>>21&127;case 3:y[m+2]=f!==3?s>>>14|128:s>>>14&127;case 2:y[m+1]=f!==2?s>>>7|128:s>>>7&127;case 1:y[m]=f!==1?128|s:127&s}}const kq={},jq={},VT=4294967296,FOe=VT*VT,Dq=FOe/2;Mq(0,!0);const Lq=Mq(0),VOe=Ob(0,-2147483648,!1),BOe=Ob(-1,2147483647,!1);function Mq(r,a){let s,l,d;return a?(d=0<=(r>>>=0)&&r<256)&&(l=jq[r],l)?l:(s=Ob(r,0,!0),d&&(jq[r]=s),s):(d=-128<=(r|=0)&&r<128)&&(l=kq[r],l)?l:(s=Ob(r,r<0?-1:0,!1),d&&(kq[r]=s),s)}function Ob(r,a,s){return{low:0|r,high:0|a,unsigned:!!s}}function Uq(r,a){if(isNaN(r))return Lq;{if(r<=-Dq)return VOe;if(r+1>=Dq)return BOe}return r<0?Lq:Ob(r%VT|0,r/VT|0,a)}function Fq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}class WD extends lr{get connectionState(){return this._connectionState}set connectionState(a){if(this._connectionState===a)return;const s=this._connectionState;this._connectionState=a,this.emit(cl.CONNECTION_STATE_CHANGE,a,s)}get quality(){return this._quality}set quality(a){this._quality=a>1?1:a<.1?.1:a,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(a){var s;super(),Z(this,"name","AgoraRTCImageModeration"),Z(this,"_connectionState",Io.CONNECTING),Z(this,"_sequence",0),Z(this,"_moderationStartTime",void 0),Z(this,"_workerConnection",void 0),Z(this,"_workerMessageLengthLimit",void 0),Z(this,"_qualityRatio",void 0),Z(this,"_connectInfo",void 0),Z(this,"_cancelTokenSource",Ka.CancelToken.source()),Z(this,"_retryConfig",void 0),Z(this,"_moderationInterval",void 0),Z(this,"_moderationTimer",null),Z(this,"_moderationMode",1),Z(this,"_quality",1),Z(this,"_qualityTimer",null),Z(this,"_ticket",void 0),Z(this,"_moderationIntervalMinimum",void 0),Z(this,"_uploadFailedNum",0),Z(this,"_uploadNum",0),Z(this,"_uploadTimer",null),Z(this,"_extraInfo",void 0),Z(this,"_vendor",""),Z(this,"_encoder",new TextEncoder),Z(this,"_moderationId",void 0),Z(this,"inspectImage",()=>{if(this.connectionState!==Io.CONNECTED)throw new Ee(ie.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Io.CONNECTED?this.requestToInspectImage():F.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=Mn(5,"image-moderation-"),this._workerMessageLengthLimit=se("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=se("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(s=a.interval)!==null&&s!==void 0?s:1e3,a.extraInfo&&(this._extraInfo=this._encoder.encode(a.extraInfo)),a.vendor&&(this._vendor=a.vendor),this._qualityRatio=se("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new bb("worker-"+this._moderationId,Gr),this.on(cl.STATE_CHANGE,(l,d)=>{F.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Mg[l]," ").concat(d||""))}),this.handleWorkerEvents()}async init(a,s){this.emit(cl.STATE_CHANGE,Mg.CONNECT_AP),this._connectInfo=a;const l=this._cancelTokenSource.token;return this._retryConfig=s,new Ge((d,f)=>{this.on(cl.CONNECTION_STATE_CHANGE,(m,y)=>{m===Io.CONNECTED&&d()}),this.requestAP(a,l,s).then(m=>{this.connectWorker(m)}).catch(m=>{f(m)})})}updateConfig(a){var s;this._moderationInterval=(s=a.interval)!==null&&s!==void 0?s:1e3,a.extraInfo&&(this._extraInfo=this._encoder.encode(a.extraInfo)),a.vendor&&(this._vendor=a.vendor),F.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(a))),this.connectionState===Io.CONNECTED&&this.inspectImage()}async requestAP(a,s,l){const d=se("WEBCS_DOMAIN").map(_=>"https://".concat(_,"/api/v1")),f=await function(_,w,x,A){let{appId:I,areaCode:L,cname:H,sid:$,token:G,uid:ne}=w;Wg++;const te="moderation_plugin",ce={service_name:te,json_body:JSON.stringify({appId:I,areaCode:L,cname:H,command:"allocateEdge",requestId:Wg,seq:Wg,sid:$,appToken:G,ts:Date.now(),uid:ne+""})};let pe,fe,ue=_[0];return il(async()=>{pe=Date.now();const ye=await ll(ue,{data:ce,cancelToken:x,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(fe=Date.now()-pe,ye.code!==0){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+ye.code,{retry:!0,responseTime:fe});throw F.error(Le.toString()),Le}const xe=JSON.parse(ye.json_body);if(xe.code!==200){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(xe.code,", reason: ").concat(xe.reason),{code:xe.code,responseTime:fe});throw F.error(Le.toString()),Le}if(!xe.servers||!Array.isArray(xe.servers)||xe.servers.length===0){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:xe.code,responseTime:fe});throw F.error(Le.toString()),Le}if(!xe.servers.some(Le=>!!Le.wss)){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:xe.code,responseTime:fe});throw F.error(Le.toString()),Le}const Ae=se("IMAGE_MODERATION_WORKER_HOST");return{addressList:xe.servers.map(Le=>{let{address:Ht,wss:qt}=Le;if(Ht&&qt)return"wss://".concat(Ht.replace(/\./g,"-"),".").concat(Ae,":").concat(qt,"/moderation")}).filter(Le=>!!Le),workerToken:xe.workerToken,vid:xe.vid,ticket:xe.appTicket,responseTime:fe}},(ye,xe)=>(nt.apworkerEvent($,{success:!0,sc:200,serviceName:te,responseDetail:JSON.stringify(ye.addressList),firstSuccess:xe===0,responseTime:fe,serverIp:_[xe%_.length]}),!1),(ye,xe)=>(nt.apworkerEvent($,{success:!1,sc:ye.data&&ye.data.code||200,serviceName:te,responseTime:fe,serverIp:_[xe%_.length]}),!!(ye.code!==ie.OPERATION_ABORTED&&ye.code!==ie.UNEXPECTED_RESPONSE||ye.data&&ye.data.retry)&&(ue=_[(xe+1)%_.length],!0)),A)}(d,a,s,l);this.emit(cl.STATE_CHANGE,Mg.AP_CONNECTED);const{addressList:m,ticket:y}=f;return this._ticket=y,m}async connectWorker(a){this.emit(cl.STATE_CHANGE,Mg.CONNECT_WORKER),await this._workerConnection.init(a,1e4)}handleWorkerEvents(){this._workerConnection.on(Bt.CONNECTED,async()=>{this.emit(cl.STATE_CHANGE,Mg.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Io.CONNECTED}),this._workerConnection.on(Bt.CLOSED,()=>{this.connectionState=Io.CLOSED}),this._workerConnection.on(Bt.FAILED,()=>{this.connectionState=Io.CLOSED}),this._workerConnection.on(Bt.RECONNECTING,()=>{this.connectionState=this.connectionState===Io.CONNECTED?Io.RECONNECTING:Io.CONNECTING}),this._workerConnection.on(Bt.ON_MESSAGE,async a=>{if(a.data instanceof ArrayBuffer){const s=jOe(new Uint8Array(a.data));se("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&F.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(s)),this._uploadNum++,s.code===void 0||s.code===0||(this._uploadFailedNum++,F.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(s.code,", msg is ").concat(s.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{nt.reportApiInvoke(this._connectInfo.sid||null,{name:Er.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,s.code],tag:rr.TRACER}).onError(new Ee(ie.IMAGE_MODERATION_UPLOAD_FAILED,s.msg)),this._uploadTimer=null},se("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else F.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(Bt.WILL_RECONNECT,(a,s,l)=>{a==="recover"&&l(a),l("tryNext")}),this._workerConnection.on(Bt.REQUEST_NEW_URLS,(a,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a).catch(s)})}static intToLong(a){return{low:a|=0,high:a>>31,unsigned:a>=0}}async requestToInspectImage(){const a=Xs(this,cl.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(a){if(!a.isPlaying)return void(se("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&F.debug("Only the track being played can be inspected"));this._sequence++;const l=await this.generateRequestData(a,s);this._workerConnection.sendMessage(l,!0,!0)}else se("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&F.debug("Only the track being published can be inspected")}async generateRequestData(a,s){let{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_}=s;const w=Date.now(),x=await a.getCurrentFrameImage("image/jpeg",this.quality),A=await u9(x,l,d),I=this._sequence+"-"+f+"-"+_+"-"+w+"-"+Mn(12,""),L={appId:l,cid:f,cname:d,deviceId:"",elapse:WD.intToLong(Number(w-this._moderationStartTime)),fileSize:x.buffer.byteLength,height:x.height,width:x.width,jpg:A,networkType:6,osType:7,requestId:I,sdkVersion:"4.24.0",sequence:this._sequence,sid:y,timestamp:Uq(w),uid:_,vid:m,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete L.callbackData;const H=kOe(L);if(H.byteLength<this._workerMessageLengthLimit){if(se("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const $=function(G){for(var ne=1;ne<arguments.length;ne++){var te=arguments[ne]!=null?arguments[ne]:{};ne%2?Fq(Object(te),!0).forEach(function(ce){Z(G,ce,te[ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(te)):Fq(Object(te)).forEach(function(ce){Object.defineProperty(G,ce,Object.getOwnPropertyDescriptor(te,ce))})}return G}({},L);delete $.jpg,F.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify($))}return H}{const $=this.quality*this._qualityRatio;return this.quality=$,await this.generateRequestData(a,{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Ka.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Io.CLOSED,this.emit(cl.STATE_CHANGE,Mg.CLOSED)}}function Vq(r){if(kn(r.interval,"interval",1e3,1/0),r&&r.extraInfo&&r.extraInfo.length>1024)throw new Ee(ie.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(r&&r.vendor&&r.vendor.length>1024)throw new Ee(ie.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const $Oe={name:"ImageModeration",create:function(r){let{config:a}=r;return Vq(a),new WD(a)}};var Bq,$q,Wq,Gq,Hq,zq,Kq,qq,Yq,Xq,Jq,Zq,Qq,eY,tY,nY,rY,iY,aY,sY,oY,cY,lY,uY,dY,hY,fY,pY,mY,gY,vY,yY,_Y,bY,EY,wY,SY,xY,TY,CY,RY,Ke;function NY(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function wc(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?NY(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):NY(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}Gi.setLogger(F);let WOe=(Bq=Et(),$q=Et({argsMap:(r,a)=>{if(!Array.isArray(a)){if(!(a instanceof Ag))return[a];a=[a]}return a.map(s=>s?Object(s).toString():"null")}}),Wq=Et({argsMap:(r,a)=>(a||(a=[]),Array.isArray(a)||a.trackMediaType!==Ng.DATA?(Array.isArray(a)||(a=[a]),a.map(s=>s.getTrackId())):[a.getChannelId()])}),Gq=Et({argsMap:(r,a,s,l)=>[typeof a=="object"?a.uid:a,s,l]}),Hq=Et({argsMap:(r,a,s)=>[a,s]}),zq=Et({argsMap:(r,a)=>a.map(s=>{let{user:l,mediaType:d}=s;return[l==null?void 0:l.uid,d]})}),Kq=Et({argsMap:(r,a,s,l)=>[typeof a=="object"?a.uid:a,s,l]}),qq=Et({argsMap:(r,a)=>a.map(s=>{let{user:l,mediaType:d}=s;return{uid:l==null?void 0:l.uid,mediaType:d}})}),Yq=Et(),Xq=Et(),Jq=Et(),Zq=Et(),Qq=Et(),eY=Et(),tY=Et(),nY=Et(),rY=Et(),iY=Et(),aY=Et(),sY=Et(),oY=Et(),cY=Et(),lY=Et(),uY=Et({argsMap:(r,a)=>[a]}),dY=Et(),hY=Et(),fY=Et(),pY=Et(),mY=Et(),gY=Et(),vY=Et(),yY=Et(),_Y=Et({argsMap:(r,a)=>(Array.isArray(a)||(a=[a]),[JSON.stringify(a)])}),bY=Et(),EY=Et(),wY=Et(),SY=Et(),xY=Et(),TY=Et(),CY=Et({reportResult:!0}),RY=Et(),Ke=class extends lr{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var r;return((r=this._config)===null||r===void 0?void 0:r.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(r,a){let s;if(super(),Z(this,"store",void 0),Z(this,"_uid",void 0),Z(this,"_channelName",void 0),Z(this,"_uintUid",void 0),Z(this,"_users",[]),Z(this,"_config",void 0),Z(this,"_clientId",void 0),Z(this,"_appId",void 0),Z(this,"_sessionId",null),Z(this,"_key",void 0),Z(this,"_rtmConfig",{}),Z(this,"_joinInfo",void 0),Z(this,"_gateway",void 0),Z(this,"_statsCollector",void 0),Z(this,"_configDistribute",void 0),Z(this,"_leaveMutex",void 0),Z(this,"_publishMutex",void 0),Z(this,"_renewTokenMutex",void 0),Z(this,"_subscribeMutex",void 0),Z(this,"_encryptionMode","none"),Z(this,"_encryptionSecret",null),Z(this,"_encryptionSalt",null),Z(this,"_encryptDataStream",!1),Z(this,"_encryptDataStreamKey",null),Z(this,"_encryptDataStreamIv",null),Z(this,"_proxyServer",void 0),Z(this,"_turnServer",{servers:[],mode:"auto"}),Z(this,"_cloudProxyServerMode","disabled"),Z(this,"_isDualStreamEnabled",!1),Z(this,"_defaultStreamFallbackType",void 0),Z(this,"_lowStreamParameter",void 0),Z(this,"_streamFallbackTypeCacheMap",new Map),Z(this,"_remoteStreamTypeCacheMap",new Map),Z(this,"_axiosCancelSource",Ka.CancelToken.source()),Z(this,"_audioVolumeIndicationInterval",void 0),Z(this,"_networkQualityInterval",void 0),Z(this,"_userOfflineTimeout",void 0),Z(this,"_streamRemovedTimeout",void 0),Z(this,"_liveTranscodeStreamingClient",void 0),Z(this,"_liveRawStreamingClient",void 0),Z(this,"_channelMediaRelayClient",void 0),Z(this,"_networkQualitySensitivity","normal"),Z(this,"_p2pChannel",void 0),Z(this,"_useLocalAccessPoint",!1),Z(this,"_setLocalAPVersion",void 0),Z(this,"_joinAndNotLeaveYet",!1),Z(this,"_numberOfJoinCount",0),Z(this,"_joinResponse",null),Z(this,"_remoteDefaultVideoStreamType",void 0),Z(this,"_inspect",void 0),Z(this,"_moderation",void 0),Z(this,"_license",void 0),Z(this,"_pendingPublishedUsers",[]),Z(this,"ntpAlignErrorCount",0),Z(this,"remoteInboundOffset",0),Z(this,"_peerConnectionState",void 0),Z(this,"_handleLocalTrackEnable",(d,f,m)=>{this.publish(d,!1).then(f).catch(m)}),Z(this,"_handleLocalTrackDisable",(d,f,m)=>{this.unpublish(d).then(f).catch(m)}),Z(this,"_handleUserOnline",d=>{if(se("BLOCK_LOCAL_CLIENT")&&pp(d.uid,this.channelName))return void F.debug("[".concat(d.uid,"] will be ignored in local"));this.isStringUID&&typeof d.uid!="string"&&F.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const f=this._users.find(m=>m.uid===d.uid);if(f)f._trust_in_room_=!0,f._is_pre_created&&(f._is_pre_created=!1,this.safeEmit(Qt.USER_JOINED,f));else{const m=new xh(d.uid,d.uint_id||d.uid);this._users.push(m),F.debug("[".concat(this._clientId,"] user online"),d.uid),this.store.firstVideoFrameDecoded(m.uid,{userJoinNotify:Date.now()}),this.safeEmit(Qt.USER_JOINED,m)}}),Z(this,"_handleUserOffline",d=>{if(se("BLOCK_LOCAL_CLIENT")&&pp(d.uid,this.channelName))return;const f=this._users.find(m=>m.uid===d.uid);f&&(this._handleRemoveStream(d),this._handleRemoveDataChannels(d),f._audio_pre_subscribed||f._video_pre_subscribed?f._is_pre_created=!0:Vx(this._users,f),this._remoteStreamTypeCacheMap.delete(f.uid),this._streamFallbackTypeCacheMap.delete(f.uid),F.debug("[".concat(this._clientId,"] user offline"),d.uid,"reason:",d.reason),this.safeEmit(Qt.USER_LEAVED,f,d.reason))}),Z(this,"_handleAddAudioOrVideoStream",(d,f,m,y,_,w,x,A)=>{if(se("BLOCK_LOCAL_CLIENT")&&pp(f,this.channelName))return;const I=this._users.find(H=>H.uid===f);if(!I)return void F.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));F.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(d)),this.store.subscribe(I.uid,d,void 0,void 0,void 0,Date.now()),d==="video"&&this.store.firstVideoFrameDecoded(I.uid,{videoAddNotify:Date.now()});const L=d==="audio"?I.hasAudio:I.hasVideo;if(I._uintid||(I._uintid=w||f),d==="audio"?I._trust_audio_stream_added_state_=!0:I._trust_video_stream_added_state_=!0,d==="audio"?(I._audio_added_=!0,m!==void 0&&(I._audioSSRC=m),y!==void 0&&(I._cname=y),x&&(I._audioOrtc=x)):(I._video_added_=!0,m!==void 0&&(I._videoSSRC=m),y!==void 0&&(I._cname=y),A!==void 0&&(I._rtxSsrcId=A),x&&(I._videoOrtc=x)),(d==="audio"?I.hasAudio:I.hasVideo)&&!L&&(F.info("[".concat(this._clientId,"] remote user ").concat(I.uid," published ").concat(d)),this.safeEmit(Qt.USER_PUBLISHED,I,d)),d==="video"?nt.onGatewayStream(this._sessionId,ri.ON_ADD_VIDEO_STREAM,Qn.ON_ADD_VIDEO_STREAM,{peer:w||f,ssrc:I._videoSSRC}):nt.onGatewayStream(this._sessionId,ri.ON_ADD_AUDIO_STREAM,Qn.ON_ADD_AUDIO_STREAM,{peer:w||f,ssrc:I._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(I,d,m).then(H=>{if(H&&(F.debug("[".concat(this._clientId,"] resubscribe ").concat(d," for user ").concat(I.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Ab))return this._p2pChannel.unsubscribe(I,d,!0).then(()=>this._subscribe(I,d,!0).catch($=>{F.error("[".concat(this._clientId,"] resubscribe error"),$.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(I,d)&&(F.debug("[".concat(this._clientId,"] resubscribe ").concat(d," for user ").concat(I.uid," after reconnect.")),this._subscribe(I,d,!0).catch(H=>{F.error("[".concat(this._clientId,"] resubscribe error"),H.toString())})),d==="video"&&!ji()&&!oa()){const H=this._getEncodingName(_);(H==null?void 0:H.toLocaleLowerCase())==hb.av1&&pOe().then($=>{$||this._gateway.downgradeCodec(H)})}}),Z(this,"_handleRemoveStream",d=>{if(se("BLOCK_LOCAL_CLIENT")&&pp(d.uid,this.channelName))return;const f=this._users.find(y=>y.uid===d.uid);if(!f)return void F.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));F.debug("[".concat(this._clientId,"] stream removed with uid ").concat(d.uid));let m=()=>{};f.hasAudio&&f.hasVideo?m=()=>{F.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),this.safeEmit(Qt.USER_UNPUBLISHED,f,"audio"),F.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),this.safeEmit(Qt.USER_UNPUBLISHED,f,"video")}:f.hasVideo?m=()=>{F.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),this.safeEmit(Qt.USER_UNPUBLISHED,f,"video")}:f.hasAudio&&(m=()=>{F.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),this.safeEmit(Qt.USER_UNPUBLISHED,f,"audio")}),f._video_pre_subscribed||f._audio_pre_subscribed||(f._trust_audio_stream_added_state_=!0,f._trust_video_stream_added_state_=!0,f._audio_added_=!1,f._video_added_=!1,this._p2pChannel instanceof Ab&&this._p2pChannel.unsubscribe(f).then(y=>{if(y)return this._gateway.unsubscribe(y,f.uid)}),f._audioSSRC=void 0,f._videoSSRC=void 0,f._audioOrtc=void 0,f._videoOrtc=void 0,f._rtxSsrcId=void 0),nt.onGatewayStream(this._sessionId,ri.ON_REMOVE_STREAM,Qn.ON_REMOVE_STREAM,{peer:d.uint_id||d.uid}),m()}),Z(this,"_handleSetStreamLocalEnable",(d,f,m)=>{if(se("BLOCK_LOCAL_CLIENT")&&pp(f,this.channelName))return;const y=this._users.find(x=>x.uid===f);if(!y)return void F.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));F.debug("[".concat(this._clientId,"] local ").concat(d," ").concat(m?"enabled":"disabled"," with uid ").concat(f));const _=d==="audio"?y.hasAudio:y.hasVideo;if(d==="audio"){y._trust_audio_enabled_state_=!0;const x=y._audio_enabled_;if(y._audio_enabled_=m,y._audio_enabled_===x)return;{const A=y._audio_enabled_?"enable-local-audio":"disable-local-audio";F.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(f,", msg: ").concat(A)),this.safeEmit(Qt.USER_INFO_UPDATED,f,A)}}else{y._trust_video_enabled_state_=!0;const x=y._video_enabled_;if(y._video_enabled_=m,y._video_enabled_===x)return;{const A=y._video_enabled_?"enable-local-video":"disable-local-video";F.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(f,", msg: ").concat(A)),this.safeEmit(Qt.USER_INFO_UPDATED,f,A)}}const w=d==="audio"?y.hasAudio:y.hasVideo;return _!==w?!_&&w?(F.info("[".concat(this._clientId,"] remote user ").concat(f," published ").concat(d)),void this.safeEmit(Qt.USER_PUBLISHED,y,d)):(d==="video"&&y._videoTrack&&y._videoTrack._destroy(),d==="audio"&&y._audioTrack,this._p2pChannel.muteRemote(y,d),F.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished ").concat(d)),void this.safeEmit(Qt.USER_UNPUBLISHED,y,d)):void 0}),Z(this,"_handleMuteStream",(d,f,m)=>{if(se("BLOCK_LOCAL_CLIENT")&&pp(d,this.channelName))return;F.debug("[".concat(this._clientId,"] receive mute message"),d,f,m);const y=this._users.find(x=>x.uid===d);if(!y)return void F.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(d));const _=f==="audio"?y.hasAudio:y.hasVideo;if(f==="audio"){y._trust_audio_mute_state_=!0;const x=y._audio_muted_;if(y._audio_muted_=m,y._audio_muted_===x)return;{const A=y._audio_muted_?"mute-audio":"unmute-audio";F.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(d,", msg: ").concat(A)),this.safeEmit(Qt.USER_INFO_UPDATED,d,A)}}else{y._trust_video_mute_state_=!0;const x=y._video_muted_;if(y._video_muted_=m,y._video_muted_===x)return;{const A=y._video_muted_?"mute-video":"unmute-video";F.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(d,", msg: ").concat(A)),this.safeEmit(Qt.USER_INFO_UPDATED,d,A)}}const w=f==="audio"?y.hasAudio:y.hasVideo;if(_!==w){if(!_&&w)return(f==="audio"?y._audioSSRC:y._videoSSRC)?(F.info("[".concat(this._clientId,"] remote user ").concat(d," published ").concat(f)),void this.safeEmit(Qt.USER_PUBLISHED,y,f)):void F.warning("[".concat(this._clientId,"] remote user ").concat(d," receive ").concat(f," unmute message  before add stream message, ").concat(f," SSRC doesn't exist yet."));f==="video"&&y._videoTrack&&!y._video_pre_subscribed&&y._videoTrack._destroy(),f==="audio"&&y._audioTrack,this._p2pChannel.muteRemote(y,f),F.info("[".concat(this._clientId,"] remote user ").concat(d," unpublished ").concat(f)),this.safeEmit(Qt.USER_UNPUBLISHED,y,f)}}),Z(this,"_handleP2PLost",async d=>{F.debug("[".concat(this._clientId,"] receive p2p lost"),d),parseInt(d.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():F.warning("[".concat(this._clientId,"] P2PLost stream not found"),d)}),Z(this,"_handleTokenWillExpire",()=>{F.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Qt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),Z(this,"_handleBeforeUnload",d=>{d.type==="beforeunload"&&d.returnValue!==void 0&&d.returnValue!==""||(this.leave(),F.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),Z(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Qt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const d={downlinkNetworkQuality:0,uplinkNetworkQuality:0};d.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),d.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Qt.NETWORK_QUALITY,d)}),Z(this,"_handleP2PAddAudioOrVideoStream",(d,f,m,y)=>{const _=this._users.find(x=>x.uid===f);if(!_)return void F.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));F.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(d)),this.store.subscribe(_.uid,d,void 0,void 0,void 0,Date.now());const w=d==="audio"?_.hasAudio:_.hasVideo;d==="audio"?_._trust_audio_stream_added_state_=!0:_._trust_video_stream_added_state_=!0,d==="audio"?(_._audio_added_=!0,m!==void 0&&(_._audioSSRC=m),y!==void 0&&(_._audioMid=y)):(_._video_added_=!0,m!==void 0&&(_._videoSSRC=m),y!==void 0&&(_._videoMid=y)),(d==="audio"?_.hasAudio:_.hasVideo)&&!w&&(F.info("[".concat(this._clientId,"] remote user ").concat(_.uid," published ").concat(d)),this.safeEmit(Qt.USER_PUBLISHED,_,d)),this._p2pChannel.hasPendingRemoteMedia(_,d)&&(F.debug("[".concat(this._clientId,"] resubscribe ").concat(d," for user ").concat(_.uid," after reconnect.")),this._subscribe(_,d,!0).catch(x=>{F.error("[".concat(this._clientId,"] resubscribe error"),x.toString())}))}),this._config=r,this._clientId=a||Mn(5,"client-"),this.store=new class{constructor(d,f,m,y){Pt(this,"state",void 0),this.state={codec:d,audioCodec:f,mode:m,clientId:y,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[],firstVideoFrameDecoded:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:op.Default,hasStartJoinChannel:!1,isABTestSuccess:!1,autoSubscribe:!1,enableInstantMuteRestore:!1}}dispatch(d){this.state=function(f,m){switch(m.type){case jt.SET_SESSION_ID:return Me(Me({},f),{},{sessionId:m.sessionId});case jt.SET_P2P_ID:return Me(Me({},f),{},{p2pId:m.p2pId});case jt.SET_UID:return Me(Me({},f),{},{uid:m.uid});case jt.SET_INT_UID:return Me(Me({},f),{},{intUid:m.intUid});case jt.SET_PUB_ID:return Me(Me({},f),{},{pubId:m.pubId});case jt.KEY_METRIC_CLIENT_CREATED:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{clientCreated:m.metric})});case jt.KEY_METRIC_JOIN_START:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{joinStart:m.metric})});case jt.KEY_METRIC_PRELOAD_START:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{preloadStart:m.metric})});case jt.KEY_METRIC_PRELOAD_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{preloadEnd:m.metric})});case jt.KEY_METRIC_JOIN_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{joinEnd:m.metric})});case jt.KEY_METRIC_REQUEST_AP_START:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{requestAPStart:m.metric})});case jt.KEY_METRIC_REQUEST_AP_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{requestAPEnd:m.metric})});case jt.KEY_METRIC_REQUEST_SUA_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{requestSUAEnd:m.metric})});case jt.KEY_METRIC_BEFORE_CONNECT:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{beforeConnect:m.metric})});case jt.KEY_METRIC_PEER_RECEIVER:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{peerReceiver:m.metric})});case jt.KEY_METRIC_SIGNAL_CONNECTED:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{signalConnected:m.metric})});case jt.KEY_METRIC_JOIN_REQ:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{joinReq:m.metric})});case jt.KEY_METRIC_JOIN_REP:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{joinRep:m.metric})});case jt.KEY_METRIC_JOIN_GATEWAY_START:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{joinGatewayStart:m.metric})});case jt.KEY_METRIC_JOIN_GATEWAY_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{joinGatewayEnd:m.metric})});case jt.KEY_METRIC_PEER_CONNECTION_START:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{peerConnectionStart:m.metric})});case jt.KEY_METRIC_PEER_CONNECTION_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{peerConnectionEnd:m.metric})});case jt.KEY_METRIC_DESCRIPTION_START:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{descriptionStart:m.metric})});case jt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{signalChannelOpen:m.metric})});case jt.KEY_METRIC_ICE_CONNECTION_END:return Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{iceConnectionEnd:m.metric})});case jt.KEY_METRIC_PUBLISH:{const y=f.keyMetrics.publish,_=y.findIndex(w=>w.trackId===m.metric.trackId);return _!==-1?(y[_]=Me(Me({},y[_]),m.metric),Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{publish:[...y]})})):Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{publish:[...f.keyMetrics.publish,m.metric]})})}case jt.KEY_METRIC_SUBSCRIBE:{const y=f.keyMetrics.subscribe,_=y.findIndex(w=>w.userId===m.metric.userId&&w.type===m.metric.type);return _!==-1?(y[_]=Me(Me({},y[_]),m.metric),Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{subscribe:[...y]})})):Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{subscribe:[...f.keyMetrics.subscribe,m.metric]})})}case jt.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED:{const y=f.keyMetrics.firstVideoFrameDecoded,_=y.findIndex(w=>w.userId===m.metric.userId);return _!==-1?(y[_]=Me(Me({},y[_]),m.metric),Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{firstVideoFrameDecoded:[...y]})})):Me(Me({},f),{},{keyMetrics:Me(Me({},f.keyMetrics),{},{firstVideoFrameDecoded:[...f.keyMetrics.firstVideoFrameDecoded,m.metric]})})}case jt.RESET_FIRST_VIDEO_FRAME_DECODED:return f.keyMetrics.firstVideoFrameDecoded=[],f;case jt.SET_CLOUD_PROXY_SERVER_MODE:return f.cloudProxyServerMode=m.mode,f;case jt.RECORD_JOIN_CHANNEL_SERVICE:return typeof m.index!="number"?f.joinChannelServiceRecords=[...f.joinChannelServiceRecords,m.record]:(f.joinChannelServiceRecords[m.index]=Me(Me({},f.joinChannelServiceRecords[m.index]),m.record),f.joinChannelServiceRecords=[...f.joinChannelServiceRecords]),f;case jt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return f.joinChannelServiceRecords=[],f;case jt.RESET_KEY_METRICS:return f.keyMetrics={publish:[],subscribe:[],firstVideoFrameDecoded:[]},f;case jt.SET_USE_P2P:return Me(Me({},f),{},{useP2P:m.val});case jt.SET_TRANSPORT_TYPE:return Me(Me({},f),{},{p2pTransport:m.val});default:return f}}(this.state,d)}set autoSubscribe(d){this.state.autoSubscribe=d}get autoSubscribe(){return this.state.autoSubscribe}set enableInstantMuteRestore(d){this.state.enableInstantMuteRestore=d}get enableInstantMuteRestore(){return this.state.enableInstantMuteRestore}set sessionId(d){this.dispatch({type:jt.SET_SESSION_ID,sessionId:d})}get sessionId(){return this.state.sessionId}set cid(d){this.state.cid=d}get cid(){return this.state.cid}set codec(d){this.state.codec=d}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(d){this.dispatch({type:jt.SET_P2P_ID,p2pId:d})}get p2pId(){return this.state.p2pId}set dcId(d){this.dispatch({type:jt.SET_DC_ID,dcId:d})}get dcId(){return this.state.dcId}set uid(d){this.dispatch({type:jt.SET_UID,uid:d})}get uid(){return this.state.uid}set intUid(d){this.dispatch({type:jt.SET_INT_UID,intUid:d})}get intUid(){return this.state.intUid}set pubId(d){this.dispatch({type:jt.SET_PUB_ID,pubId:d})}get pubId(){return this.state.pubId}set cloudProxyServerMode(d){this.dispatch({type:jt.SET_CLOUD_PROXY_SERVER_MODE,mode:d})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(d){this.dispatch({type:jt.SET_USE_P2P,val:d})}get useP2P(){return this.state.useP2P}set p2pTransport(d){this.dispatch({type:jt.SET_TRANSPORT_TYPE,val:d})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(d){this.state.hasStartJoinChannel=d}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(d){this.state.isABTestSuccess=d}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:jt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:jt.KEY_METRIC_JOIN_START,metric:Date.now()})}preloadStart(){this.dispatch({type:jt.KEY_METRIC_PRELOAD_START,metric:Date.now()})}preloadEnd(){this.dispatch({type:jt.KEY_METRIC_PRELOAD_END,metric:Date.now()})}joinEnd(){this.dispatch({type:jt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:jt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:jt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}requestSUAEnd(){this.dispatch({type:jt.KEY_METRIC_REQUEST_SUA_END,metric:Date.now()})}beforeConnect(){this.dispatch({type:jt.KEY_METRIC_BEFORE_CONNECT,metric:Date.now()})}peerReceiver(){this.dispatch({type:jt.KEY_METRIC_PEER_RECEIVER,metric:Date.now()})}signalConnected(){this.dispatch({type:jt.KEY_METRIC_SIGNAL_CONNECTED,metric:Date.now()})}joinReq(){this.dispatch({type:jt.KEY_METRIC_JOIN_REQ,metric:Date.now()})}joinRep(){this.dispatch({type:jt.KEY_METRIC_JOIN_REP,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:jt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:jt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:jt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:jt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}firstVideoFrameDecoded(d,f){this.dispatch({type:jt.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED,metric:Me({userId:d},f)})}descriptionStart(){this.dispatch({type:jt.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:jt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:jt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(d,f,m,y){this.dispatch({type:jt.KEY_METRIC_PUBLISH,metric:Me(Me({trackId:d,type:f},m&&{publishStart:m}),y&&{publishEnd:y})})}subscribe(d,f,m,y,_,w,x){this.dispatch({type:jt.KEY_METRIC_SUBSCRIBE,metric:Me(Me(Me(Me(Me({userId:d,type:f},m&&{subscribeStart:m}),y&&{subscribeEnd:y}),_&&{firstFrame:_}),w&&{streamAdded:w}),x&&{firstDecoded:x})})}massSubscribe(d,f,m,y){d.forEach(_=>{this.dispatch({type:jt.KEY_METRIC_SUBSCRIBE,metric:Me(Me(Me({userId:_.userId,type:_.type},f&&{subscribeStart:f}),m&&{subscribeEnd:m}),y&&{firstFrame:y})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(d,f){d.service==="gateway"&&Array.isArray(d.urls)&&(d.urls=d.urls.map(m=>m.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof f!="number"?(this.dispatch({type:jt.RECORD_JOIN_CHANNEL_SERVICE,record:Me(Me({},d),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(f<0||f>=this.state.joinChannelServiceRecords.length||this.dispatch({type:jt.RECORD_JOIN_CHANNEL_SERVICE,record:d,index:f}),f)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:jt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:jt.RESET_KEY_METRICS})}resetFirstVideoFrameDecoded(){this.dispatch({type:jt.RESET_FIRST_VIDEO_FRAME_DECODED})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}}(r.codec,r.audioCodec,r.mode,this._clientId),this._leaveMutex=new Gi("client-leave",this._clientId),this._publishMutex=new Gi("client-publish",this._clientId),this._renewTokenMutex=new Gi("client-renewtoken",this._clientId),this._subscribeMutex=new Gi("client-subscribe",this._clientId),this.store.clientCreated(),r.proxyServer&&this.setProxyServer(r.proxyServer,!0),r.turnServer&&this.setTurnServer(r.turnServer,!0),F.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Co," build: ").concat(Nj,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),r.clientRoleOptions)try{mj(r.clientRoleOptions),s=Object.assign({},r.clientRoleOptions)}catch(d){F.warning("[".concat(this._clientId,"] ").concat(d.toString()))}var l;this._statsCollector=new Rb(this.store),this._statsCollector.onStatsException=(d,f,m)=>{F.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(d,", msg: ").concat(f,", uid: ").concat(m)),d===RD.VIDEO_ENCODE_FAILED&&this.localTracks.forEach(y=>{y instanceof eT&&se("ENABLE_ENCODE_EXCEPTION")&&y.findClosestProfile()}),this.safeEmit(Qt.EXCEPTION,{code:d,msg:f,uid:m})},this._statsCollector.onUploadPublishDuration=(d,f,m,y)=>{const _=this._users.find(w=>w.uid===d);_&&(this.store.keyMetrics&&(this.store.firstVideoFrameDecoded(_._uintid,{peerPublishDuration:m,peerPubStatusMs:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(_)),nt.peerPublishStatus(this._sessionId,{subscribeElapse:y,audioPublishDuration:f,videoPublishDuration:m,peer:_._uintid}))},this._statsCollector.onVideoCodecChanged=d=>{if(se("VIDEO_STANDARD_BITRATE_VERSION")&&(d==="av1"||d==="h265"||d==="h264")){const f=this.localTracks.find(m=>m instanceof Wn);f&&f._saveEncodeBitrateRatio!==1&&f.setSaveEncodeBitrateRatio(d==="h264"?se("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P=r.mode==="p2p",this._gateway=new cOe(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:r.websocketRetryConfig||Gr,httpRetryConfig:r.httpRetryConfig||Gr,forceWaitGatewayResponse:r.forceWaitGatewayResponse===void 0||r.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:r.role,clientRoleOptions:s}),this._configDistribute=new _Oe(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(l={store:this.store,statsCollector:this._statsCollector},ld("P2PChannel").create(l)),this._handleP2PEvents()):this._p2pChannel=new Ab(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(r,a,s,l,d){let f=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],m=arguments.length>6&&arguments[6]!==void 0&&arguments[6];An("JOIN_GATEWAY_USE_443PORT_ONLY",f),An("JOIN_GATEWAY_USE_DUAL_DOMAIN",m);const y=this._gateway.signal.websocket;return y instanceof hD&&(y.use443PortOnly=f,y.tryDoubleDomain=m),async function(_,w,x){Dx.get(_)||Dx.set(_,[]),Lx.get(_)||Lx.set(_,w),eu.get(_)||eu.set(_,0);const A=Dx.get(_),I=Lx.get(_);if(!A||!I)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(eu.get(_)===I){const ne=rb();A.push(ne),await ne.promise}eu.set(_,eu.get(_)+1);for(var L=arguments.length,H=new Array(L>3?L-3:0),$=3;$<L;$++)H[$-3]=arguments[$];const G=await x(...H);return eu.set(_,eu.get(_)-1),eu.get(_)===I-1&&A.length>0&&(A[0].resolve(),A.shift()),eu.get(_)===0&&(Dx.set(_,[]),Lx.set(_,0),eu.set(_,0)),G}("client.join",se("JOIN_MAX_CONCURRENCY"),this.join.bind(this),r,a,s,l,d)}async join(r,a,s,l,d){const f=++this._numberOfJoinCount;this.store.joinStart(),l&&(this.store.uid=l);const m=(Wx||Wx||(Wx=(window.location.protocol.split(":")[0]||"").toUpperCase(),Wx))==="HTTPS",y=xz()?window.isSecureContext:"Browser Not Support";(!xz()&&!m||!window.isSecureContext)&&F.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser");let _;nt.setAppId(r);try{if(!s&&s!==null)throw new Ee(ie.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));if(s&&Ti(s,"token",1,2047),Ti(r,"appid",1,2047),dT(a),l&&hT(l),d)if(typeof d=="string")Ti(d,"optionalInfo",1,256),_=d;else{if(typeof d!="object")throw new Ee(ie.INVALID_PARAMS,"Invalid options: options is not a string or object");{const{autoSubscribe:G,enableInstantMuteRestore:ne}=d;G&&(rl(G,"autoSubscribe"),F.info("[".concat(this._clientId,"] join: autoSubscribe: ").concat(G)),this.store.autoSubscribe=G),ne&&(rl(ne,"enableInstantMuteRestore"),F.info("[".concat(this._clientId,"] join: enableInstantMuteRestore: ").concat(ne)),this.store.enableInstantMuteRestore=ne)}}}catch(G){throw nt.reportApiInvoke(sp(),{name:Er.JOIN,options:[r,a,s,l],states:{isHttps:m,isSecureContext:y},tag:rr.TRACER}).onError(G),G}if(this._leaveMutex.isLocked&&(F.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),F.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const G=new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw nt.reportApiInvoke(sp(),{name:Er.JOIN,options:[r,a,s,l],states:{isHttps:m,isSecureContext:y},tag:rr.TRACER}).onError(G),G}this._gateway.state="CONNECTING",this.store.preloadStart();const w=await Sq({appId:r,cname:a,uid:l,stringUid:typeof l=="string"?l:void 0,token:s||r,cloudProxyServer:this._cloudProxyServerMode});if(this.store.preloadEnd(),!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const x=(w==null?void 0:w.sid)||sp();F.info("[".concat(this._clientId,"] start join channel ").concat(a,", join number: ").concat(f)),this._sessionId||(this._sessionId=x,this.store.sessionId=this._sessionId);const A=nt.reportApiInvoke(x,{id:this._clientId,name:Er.JOIN,options:[r,a,s,l],states:{isHttps:m,isSecureContext:y},tag:rr.TRACER}),I=wc(wc(wc({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:r,sid:this._sessionId,cname:a,uid:typeof l!="string"?l:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:s||r,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:_,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!w},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:se("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(I.setLocalAPVersion=this._setLocalAPVersion),typeof l=="string"&&(I.stringUid=l,this._uintUid?(I.uid=this._uintUid,this._uintUid=void 0):I.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(I.aesmode=this._encryptionMode,I.aespassword=await(async G=>{const ne=function(fe){const ue=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),ye=new Uint8Array(new ArrayBuffer(ue.length));for(let xe=0;xe<ue.length;xe+=1)ye[xe]=ue.charCodeAt(xe);return ye}(),te=await window.crypto.subtle.importKey("spki",ne,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),ce=fj(G),pe=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},te,ce);return function(fe){let ue="";for(let ye=0;ye<fe.length;ye+=1)ue+=String.fromCharCode(fe[ye]);return window.btoa(ue)}(new Uint8Array(pe))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(I.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const G=new TextEncoder,ne=se("USE_PURE_ENCRYPTION_MASTER_KEY")?G.encode(I.appId+this._encryptionSecret+this._encryptionSecret):G.encode(I.appId+I.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(te,ce,pe){const fe=await window.crypto.subtle.importKey("raw",ce,"PBKDF2",!1,["deriveBits","deriveKey"]),ue=te==="aes-128-gcm2"?128:256,ye=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:jz,hash:"SHA-256",salt:pe},fe,ue+U1e);return new Uint8Array(ye).subarray(ue/8)}(this._encryptionMode,ne,ap(this._encryptionSalt)),this._encryptDataStreamKey=await async function(te,ce,pe){const fe=await window.crypto.subtle.importKey("raw",ce,"PBKDF2",!1,["deriveBits","deriveKey"]),ue=te==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:jz,hash:"SHA-256",salt:pe},fe,{name:"AES-GCM",length:ue},!0,["encrypt","decrypt"])}(this._encryptionMode,ne,ap(this._encryptionSalt))}else y?F.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):F.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,F.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:a,appId:r,stringUid:I.stringUid});const L=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&L===this._sessionId&&nt.joinChannelTimeout(this._sessionId,5)},5e3);try{var H;let G;const ne=I.cloudProxyServer;if(Ve(H=["proxy3","proxy4","proxy5"]).call(H,ne)){const ue=se("PROXY_SERVER_TYPE3");Array.isArray(ue)?I.proxyServer=ue[0]:I.proxyServer=ue}if(nt.setProxyServer(I.proxyServer),F.setProxyServer(I.proxyServer),this.store.requestAPStart(),w){if(F.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(I.stringUid?", ".concat(I.stringUid," => ").concat(w.intUid):""," ")),I.stringUid&&!I.uid&&(I.uid=w.intUid),G={gatewayInfo:w.ap.gatewayInfo},se("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&I.turnServer.mode==="auto")if(w.ap.proxyInfo.addresses.length===0)F.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const ue=(await _K(w.ap.proxyInfo,w.ap.gatewayInfo.uid)).map(ye=>({turnServerURL:ye.address,tcpport:ye.tcpport||Mi.tcpport,udpport:ye.udpport||Mi.udpport,username:ye.username||Mi.username,password:ye.password||Mi.password,forceturn:!1,security:!0}));I.turnServer={mode:"manual",servers:ue}}Cq(w,I.stringUid)}else{if(I.stringUid&&!I.uid){let ue;[ue,G]=await Ge.all([KK(I.stringUid,I,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,this.store).finally(()=>{this.store.requestSUAEnd()}),zK(I,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,!0,this.store).finally(()=>{this.store.requestAPEnd()})]),F.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(I.stringUid," => ").concat(ue)),I.uid=ue,G.gatewayInfo.uid=ue,G.gatewayInfo.res.uid=ue}else G=await zK(I,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(I,this._axiosCancelSource.token),this._configDistribute.on(yb.UPDATE_BITRATE_LIMIT,ue=>{this._p2pChannel.updateBitrateLimit(ue)}),this._configDistribute.on(yb.UPDATE_CLIENT_ROLE_OPTIONS,ue=>{this._setClientRoleOptions(ue)})},0),this._key=s||r;const te=G.gatewayInfo,ce=I.uid?I.uid:te.uid;this._joinInfo=wc(wc({},I),{},{cid:te.cid,uid:ce,vid:te.vid,apResponse:te.res,apGatewayAddress:te.apGatewayAddress,uni_lbs_ip:te.uni_lbs_ip,gatewayAddrs:te.gatewayAddrs}),this.store.intUid=ce,this.store.cid=te.cid;const pe=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));A.onSuccess(pe),this._appId=r,this._channelName=I.cname,this._uid=pe,this.store.uid=pe,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(ji()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const fe=I.stringUid?"string uid: ".concat(I.stringUid,",uid: ").concat(I.uid):"uid: ".concat(this._uid);return F.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(a,",").concat(fe)),setTimeout(()=>{F.startUpload()},5e3),this.store.joinEnd(),$=this,Ve(fp).call(fp,$)||fp.push($),this._cloudProxyServerMode==="disabled"&&un().supportWebCrypto&&se("ENABLE_PRELOAD")&&BD(this._joinInfo),pe}catch(G){const ne=Array.isArray(G)?G[0]:G;throw ne&&ne.code===ie.OPERATION_ABORTED?F.warning("[".concat(this._clientId,"] join number: ").concat(f,", Joining channel failed, rollback"),ne):F.error("[".concat(this._clientId,"] join number: ").concat(f,", Joining channel failed, rollback"),ne),ne.code!==ie.OPERATION_ABORTED&&this._numberOfJoinCount===f&&(this._gateway.state="DISCONNECTED",this._reset()),A.onError(ne),ne}var $}_joinGateway(){if(!this._joinInfo||!this._key)throw new Ee(ie.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!se("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){F.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(ji()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(a){const s=fp.indexOf(a);s!==-1&&fp.splice(s,1)}(this),this._statsCollector.stopUpdateStats();const r=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return F.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void r();await this._gateway.leave(this.connectionState!=="CONNECTED",En.LEAVE),F.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),r()}async publish(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(r)){if(!(r instanceof Ag))return this._publishDataChannel(r);r=[r]}if(r.length===0)throw new Ee(ie.INVALID_PARAMS,"param list is empty");const s=r;if(this._gateway.role==="audience")throw new Ee(ie.INVALID_OPERATION,"audience can not publish stream");for(const d of s){if(!(d instanceof Ag))throw new Ee(ie.INVALID_PARAMS,"parameter is not local track");if(!d._enabled&&a)throw new Ee(ie.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(d.getTrackId()))}F.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(s.map(d=>"".concat(d.getTrackId()," "))));const l=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),a&&s.forEach(d=>{const f=this._configDistribute.getBitrateLimit();d instanceof Wn&&f&&d.setBitrateLimit(f.uplink)});try{await this._publishHighStream(s),F.info("[".concat(this._clientId,"] Publish success, id ").concat(s.map(d=>"".concat(d.getTrackId()," "))))}catch(d){throw F.error("[".concat(this._clientId,"] publish error"),d.toString()),d}finally{l()}}async _publishDataChannel(r){if(r==null)throw new Ee(ie.INVALID_PARAMS,"parameter is not local track or datachannel config, config is ".concat(JSON.stringify(r)));kn(r.id,"id",0,65535,!0),rl(r.ordered,"ordered"),Ti(r.metadata,"metadata",0,512),F.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(r.id));const a=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(d=>d.id===r.id)!==-1)throw new Ee(ie.INVALID_PARAMS,"Invalid id: ".concat(r.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&se("FORCE_TURN")&&!se("TURN_ENABLE_TCP")&&!se("TURN_ENABLE_UDP"))throw new Ee(ie.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const s=function(d){return MK(d,!1)}(r),l=await this._p2pChannel.publishDataChannel([s]);if(l.length>0){if(typeof s._originDataChannelId!="number")throw F.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new Ee(ie.CREATE_DATACHANNEL_ERROR);try{await Ge.all(l.map(d=>this._uid&&this._gateway.publishDataChannel(this._uid,d,!0))),await s._waitTillOpen()}catch(d){if(d.code!==ie.DISCONNECT_P2P)throw d}}return F.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(s.id)),s}catch(s){throw F.error("[".concat(this._clientId,"] publish datachannels error"),s.toString()),s}finally{a()}}async unpublish(r){if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let a=[];if(r)if(Array.isArray(r))a=r;else{if(!(r instanceof Ag))return this._unpublishDataChannel([r]);a=[r]}else this.store.useP2P||await this._unpublishDataChannel(),a=this._p2pChannel.getAllTracks(!0);F.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(a.map(l=>"".concat(l.getTrackId()," "))," "));const s=await this._publishMutex.lock();try{if(this.store.useP2P){const l=await this._p2pChannel.unpublish(a);l&&await this._gateway.sendExtensionMessage(Ar.UNPUBLISH,{unpubMsg:l},!0)}else{const l=await this._p2pChannel.unpublish(a);l&&await this._gateway.unpublish(l,this._uid),F.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(a.map(d=>"".concat(d.getTrackId()))))}}catch(l){throw F.error("[".concat(this._clientId,"] unpublish error"),l.toString()),l}finally{s&&s()}}async _unpublishDataChannel(r){r!==void 0&&r.length!==0||(r=this._p2pChannel.getAllDataChannels()),F.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(r.map(s=>"".concat(s.id," "))," "));const a=await this._publishMutex.lock();try{const s=await this._p2pChannel.unpublishDataChannel(r);s&&await this._gateway.unpublishDataChannel(s),F.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(r.map(l=>"".concat(l.id))))}catch(s){throw F.error("[".concat(this._clientId,"] unpublish dataChannel error"),s.toString()),s}finally{a&&a()}}async subscribe(r,a,s){if(!(r instanceof xh)){const l=this.remoteUsers.find(d=>d.uid===r);if(!l)throw new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");r=l}return a==="datachannel"?this._subscribeDataChannel(r,s):this._subscribe(r,a)}async presubscribe(r,a){if(ni(a,"mediaType",["audio","video"]),this.store.useP2P)throw new Ee(ie.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const s=a===Ye.AUDIO,l=a===Ye.VIDEO,d=await this._subscribeMutex.lock();try{const{ssrcId:f,ortc:m,rtxSsrcId:y,cname:_,uint_id:w}=await this._gateway.presubscribe(r,a,!0);if(f==null)throw new Ee(ie.UNEXPECTED_RESPONSE,"no ssrc id");let x=this._users.find(I=>I.uid===r);x||(x=new xh(r,w||r),x._is_pre_created=!0,this._users.push(x)),_&&(x._cname=_),x._uintid||(x._uintid=w||r),s&&(x._audioSSRC=f,x._audio_pre_subscribed=!0,m&&(x._audioOrtc=m)),l&&(x._videoSSRC=f,x._video_pre_subscribed=!0,m&&(x._videoOrtc=m),y!=null&&(x._rtxSsrcId=y)),F.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(f)),await this._p2pChannel.subscribe(x,a,f,y,m);const A=s?x._audioTrack:x._videoTrack;if(!A)throw new Ee(ie.UNEXPECTED_ERROR,"can not find remote track in user");return s&&(x._trust_audio_stream_added_state_=!0,x._audio_added_=!0),l&&(x._trust_video_stream_added_state_=!0,x._video_added_=!0),A}catch(f){throw F.error("[".concat(this._clientId,"] presub user ").concat(r," error"),f),f}finally{d()}}async _subscribeDataChannel(r,a){var s;if(kn(a,"channelId",0,65535,!0),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(y=>y===r))throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");if(!r.hasAudio&&!r.hasVideo&&r._dataChannels.length===0)throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),new Ee(ie.INVALID_REMOTE_USER,"user is not published");const d=(s=r._dataChannels)===null||s===void 0?void 0:s.find(y=>y.id===a);if(!d)throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType datachannel, remote datachannel is not published")),new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);const f=await this._subscribeMutex.lock();F.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: datachannel"));try{const y=await this._p2pChannel.subscribeDataChannel(r,[d]);if(y&&Ve(y).call(y,d.id))try{var m;if(typeof d._originDataChannelId!="number")throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType datachannel, cannot get RTCDatachannel")),new Ee(ie.CREATE_DATACHANNEL_ERROR);const _={id:d.id,datachannelId:d._originDataChannelId,ordered:d.ordered,maxRetransmits:d.maxRetransmits,metadata:(m=d.metadata)!==null&&m!==void 0?m:""};await this._gateway.subscribeDataChannel(r.uid,_,!0),await d._waitTillOpen()}catch(_){if((_==null?void 0:_.code)!==ie.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(r,[d]),_;await this._p2pChannel.unsubscribeDataChannel(r,[d]),this._p2pChannel.setPendingRemoteDataChannel(r,d.id)}return F.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: datachannel")),d}finally{f()}}async _p2pSubscribe(r,a,s){if(ni(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(f=>f===r)){const f=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),f}if(!r.hasAudio&&!r.hasVideo){const f=new Ee(ie.INVALID_REMOTE_USER,"user is not published");throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),f}if(!s&&(a==="audio"&&!r.hasAudio||a==="video"&&!r.hasVideo)){const f=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType ").concat(a,", remote track is not published")),f}const d=await this._subscribeMutex.lock();F.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: ").concat(a));try{if(await this._p2pChannel.hasRemoteMediaWithLock(r,a))await this._p2pChannel.unmuteRemote(r,a);else try{const m=a==="audio"?r._audioSSRC:r._videoSSRC,y=a==="audio"?r._audioMid:r._videoMid;this.store.subscribe(r.uid,a,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(r,a,m,y)}catch(m){throw m}F.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: ").concat(a)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(r.uid,this._defaultStreamFallbackType).catch(m=>{F.warning("[".concat(this._clientId,"] auto set fallback failed"),m)});const f=a==="audio"?r._audioTrack:r._videoTrack;if(!f)throw new Ee(ie.UNEXPECTED_ERROR,"can not find remote track in user object");return f}catch(f){throw F.error("[".concat(this._clientId,"] subscribe user ").concat(r.uid," error"),f),f}finally{d()}}async _subscribe(r,a,s){if(this.store.useP2P)return this._p2pSubscribe(r,a);if(ni(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(w=>w===r)){const w=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),w}if(!r.hasAudio&&!r.hasVideo){const w=new Ee(ie.INVALID_REMOTE_USER,"user is not published");throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),w}if(!(s||(a!=="audio"||r.hasAudio&&r._audioSSRC!==void 0)&&(a!=="video"||r.hasVideo&&r._videoSSRC!==void 0))){const w=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);throw F.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType ").concat(a,", remote track is not published")),w}let d=a==="audio"?r._audioSSRC:r._videoSSRC,f=a==="audio"?r._audioOrtc:r._videoOrtc,m=a==="video"?r._rtxSsrcId:void 0,y={stream_type:a==="audio"?Ye.AUDIO:Ye.VIDEO,ssrcId:d};a==="video"&&this.store.firstVideoFrameDecoded(r.uid,{subscribeStart:Date.now()});const _=await this._subscribeMutex.lock();F.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: ").concat(a));try{if(await this._p2pChannel.hasRemoteMediaWithLock(r,a))await this._p2pChannel.unmuteRemote(r,a);else try{const x=a==="audio"?r._audioSSRC:r._videoSSRC;x!==void 0&&x!==d&&(d=x,f=a==="audio"?r._audioOrtc:r._videoOrtc,m=a==="video"?r._rtxSsrcId:void 0,y={stream_type:a==="audio"?Ye.AUDIO:Ye.VIDEO,ssrcId:d}),qi.markSubscribeStart(this.store.clientId,d),this.store.subscribe(r.uid,a,Date.now()),await this._p2pChannel.subscribe(r,a,d,m,f);try{this._p2pChannel.isPreSubScribe(d)||await this._gateway.subscribe(r.uid,y,!0)}catch(A){if((A==null?void 0:A.code)!==ie.WS_ABORT)throw await this._p2pChannel.unsubscribe(r,a),A;await this._p2pChannel.unsubscribe(r,a,!0),this._p2pChannel.setPendingRemoteMedia(r,a)}this.store.subscribe(r.uid,a,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,r,a)}catch(x){throw this._p2pChannel.reportSubscribeEvent(!1,x==null?void 0:x.code,r,a),x}F.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: ").concat(a)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(r.uid,this._defaultStreamFallbackType).catch(x=>{F.warning("[".concat(this._clientId,"] auto set fallback failed"),x)});const w=a==="audio"?r._audioTrack:r._videoTrack;if(!w)throw new Ee(ie.UNEXPECTED_ERROR,"can not find remote track in user object");return a==="video"&&(this.store.firstVideoFrameDecoded(r.uid,{subscribeEnd:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(r)),w}catch(w){throw F.error("[".concat(this._clientId,"] subscribe user ").concat(r.uid," error"),w),w}finally{_()}}async massSubscribe(r){if(ad(r,"subscribeList"),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const a=Date.now(),s=new Map,l=await this._subscribeMutex.lock();F.info("[".concat(this._clientId,"]start massSubscribe user ").concat(r.map(y=>{let{user:_,mediaType:w}=y;return"user: ".concat(_==null?void 0:_.uid,", mediaType: ").concat(w)}).join("; ")));const d=(r=[...r]).map(y=>{let{user:_,mediaType:w}=y;return{user:_,mediaType:w}}),f=await this._p2pChannel.globalLock();try{var m;for(let _=r.length-1;_>=0;_--){const w=r[_],{user:x,mediaType:A}=w;if(ni(A,"mediaType",["audio","video"]),!x){const $=new Ee(ie.INVALID_PARAMS,"user property does not exist in subscribeList item");throw F.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),$}if(!this._users.find($=>$===x)){const $=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");F.error("[".concat(this._clientId,"] can not massSubscribe ").concat(x.uid,", this user is not in the channel")),d[_].error=$,r.splice(_,1);continue}if(A==="audio"&&(!x.hasAudio||x._audioSSRC===void 0)||A==="video"&&(!x.hasVideo||x._videoSSRC===void 0)){const $=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);F.error("[".concat(this._clientId,"] can not subscribe ").concat(x.uid," with mediaType ").concat(A,", remote user is not published")),d[_].error=$,r.splice(_,1);continue}const L=ci.Video|ci.LwoVideo,H=s.get(x);if(H){if(A==="video"?H&L:H&ci.Audio){r.splice(_,1),F.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(x.uid,", mediaType:").concat(A," twice"));continue}s.set(x,H|(A==="video"?L:ci.Audio))}else s.set(x,A==="video"?L:ci.Audio)}for(let _=r.length-1;_>=0;_--){const w=r[_],{user:x,mediaType:A}=w,I=ci.Video|ci.LwoVideo;if(this._p2pChannel.hasRemoteMedia(x,A)){await this._p2pChannel.unmuteRemoteNoLock(x,A);const L=s.get(x);s.set(x,A==="video"?L^I:L^ci.Audio),r.splice(_,1)}}this.store.massSubscribe(r.map(_=>({userId:_.user.uid,type:_.mediaType})),a);let y=sc(m=Array.from(s.entries())).call(m,(_,w)=>{let[x,A]=w;if(A===0)return _;const I={stream_id:x.uid,stream_type:A};return A&ci.Audio&&(I.audio_ssrc=x._audioSSRC),A&ci.Video&&(I.video_ssrc=x._videoSSRC),_.push(I),_},[]);try{r.length>0&&await this._p2pChannel.massSubscribeNoLock(r.map(w=>{let{user:x,mediaType:A}=w;return{user:x,mediaType:A,ssrcId:A===Ye.VIDEO?x._videoSSRC:x._audioSSRC,rtxSsrcId:A===Ye.VIDEO?x._rtxSsrcId:void 0}}));const _=new Map;if(y=y.filter(w=>w.video_ssrc&&!this._p2pChannel.isPreSubScribe(w.video_ssrc)||w.audio_ssrc&&!this._p2pChannel.isPreSubScribe(w.audio_ssrc)||!w.video_ssrc&&!w.audio_ssrc),y.length>0){const w=await this._gateway.subscribeAll(y,!0);((w==null?void 0:w.users)||[]).forEach(x=>{let{stream_id:A,video_error_code:I,audio_error_code:L,error_code:H}=x;(I||L||H)&&_.set(A,{video_error_code:I,audio_error_code:L,error_code:H})})}if(Array.from(_.entries()).length>0){const w=[];Array.from(_.entries()).forEach(x=>{let[A,I]=x;const L=this.remoteUsers.find(H=>H.uid===A);if(L){let H;I.error_code||I.video_error_code&&I.audio_error_code?H=void 0:I.video_error_code?H=Ye.VIDEO:I.audio_error_code&&(H=Ye.AUDIO),w.push({user:L,mediaType:H})}}),w.length>0&&await this._p2pChannel.massUnsubscribeNoLock(w)}for(const w of d){const x=_.get(w.user.uid);if(x){const A=x.error_code||w.mediaType==="audio"&&x.audio_error_code||w.mediaType==="video"&&x.video_error_code;if(A){const I=_b(A);F.error("user:".concat(w.user.uid," mediaType:").concat(w.mediaType," has massSubscribe error ").concat(I.desc)),w.error=new Ee(ie.SUBSCRIBE_FAILED,"code ".concat(A,": ").concat(I.desc))}}w.error||(w.mediaType==="video"?w.track=w.user.videoTrack:w.track=w.user.audioTrack)}return this.store.massSubscribe(d.filter(w=>!w.error).map(w=>({userId:w.user.uid,type:w.mediaType})),void 0,Date.now()),d.forEach(w=>{var x;nt.subscribe(this.store.sessionId,{succ:!!w.error,ec:((x=w.error)===null||x===void 0?void 0:x.code)||null,video:w.mediaType===Ye.VIDEO,audio:w.mediaType===Ye.AUDIO,peerid:w.user.uid,subscribeRequestid:w.mediaType===Ye.VIDEO?w.user._videoSSRC:w.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-a),preSsrc:this._p2pChannel.isPreSubScribe(w.user._videoSSRC)},!0)}),F.info("[".concat(this._clientId,"] massSubscribe success ").concat(r.map(w=>{let{user:x,mediaType:A}=w;return"user: ".concat(x==null?void 0:x.uid,", mediaType: ").concat(A)}).join("; "))),d}catch(_){throw await this._p2pChannel.massUnsubscribeNoLock(r),_}}finally{f(),l()}}async unsubscribe(r,a,s){if(!(r instanceof xh)){const f=this.remoteUsers.find(m=>m.uid===r);if(!f)throw new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");r=f}if(a||this.store.useP2P){if(a==="datachannel")return this._unsubscribeDataChannel(r,s)}else await this._unsubscribeDataChannel(r,s);if(a&&ni(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(f=>f===r)){const f=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw F.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),f}F.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(r.uid,", mediaType: ").concat(a));const d=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(r,a);else{const f=await this._p2pChannel.unsubscribe(r,a);f&&await this._gateway.unsubscribe(f,r.uid),a&&a!=="audio"||(r._audio_pre_subscribed=!1),a&&a!=="video"||(r._video_pre_subscribed=!1),r._is_pre_created&&Vx(this._users,r),F.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(r.uid,", mediaType: ").concat(a))}}catch(f){if(f.code===ie.DISCONNECT_P2P)return void F.warning("disconnecting p2p, abort unsubscribe request.");throw F.error("[".concat(this._clientId,"] unsubscribe user ").concat(r.uid," error"),f.toString()),f}finally{d()}}async _unsubscribeDataChannel(r,a){if(a&&kn(a,"id",0,65535,!0),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(d=>d===r)){const d=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw F.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),d}let l;if(typeof a=="number"){const d=r._dataChannels.find(f=>f.id===a);d&&(l=[d])}else l=r._dataChannels;if(l===void 0){const d=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);throw F.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid," with channelId ").concat(a,", remote datachannel is not published")),d}F.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(r.uid,", mediaType: datachannel, ids: ").concat(l.map(d=>d.id)));try{const d=await this._p2pChannel.unsubscribeDataChannel(r,l);d&&await this._gateway.unsubscribeDataChannel(d,r.uid),F.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(r.uid,", mediaType: datachannel, ids: ").concat(d))}catch(d){if(d.code===ie.DISCONNECT_P2P)return void F.warning("disconnecting p2p, abort unsubscribe request.");throw F.error("[".concat(this._clientId,"] unsubscribe user ").concat(r.uid," error"),d.toString()),d}}async massUnsubscribe(r){if(ad(r,"unsubscribeList"),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");F.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(r.map(s=>{let{user:l,mediaType:d}=s;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(d,";")}).join())),r=[...r];const a=new Map;for(let s=r.length-1;s>=0;s--){const{user:l,mediaType:d}=r[s];if(!l){const y=new Ee(ie.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw F.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),y}if(ni(d,"mediaType",["video","audio",void 0]),!this._users.find(y=>y===l)){F.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(l.uid,", user is not in the channel")),r.splice(s,1);continue}const m=ci.Video|ci.LwoVideo;if(a.has(l)){const y=a.get(l);let _;switch(d){case"video":_=y&m;break;case"audio":_=y&ci.Audio;break;default:_=y&(ci.Audio|m)}if(_){F.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(l.uid,",mediaType:").concat(d," twice.")),r.splice(s,1);continue}d?d==="audio"?a.set(l,y|ci.Audio):d==="video"&&a.set(l,y|m):a.set(l,y|ci.Audio|m)}else d?d==="audio"?a.set(l,ci.Audio):d==="video"&&a.set(l,m):a.set(l,ci.Audio|m)}try{const s=await this._p2pChannel.massUnsubscribe(r);s&&await this._gateway.massUnsubscribe(s),F.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(r.map(l=>{let{user:d,mediaType:f}=l;return"user: ".concat(d==null?void 0:d.uid,", mediaType: ").concat(f,";")}).join()))}catch(s){if(s.code===ie.DISCONNECT_P2P)return void F.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw F.error("[".concat(this._clientId,"] massUnsubscribe error"),s.toString()),s}}async setLowStreamParameter(r){(function(s){if(!s)throw new Se(ie.INVALID_PARAMS);hr(s.width)||dj(s.width,"streamParameter.width"),hr(s.height)||dj(s.height,"streamParameter.height"),hr(s.framerate)||dj(s.framerate,"streamParameter.framerate"),hr(s.bitrate)||kn(s.bitrate,"streamParameter.bitrate")})(r),(!r.width&&r.height||r.width&&!r.height)&&F.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),F.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(r));const a=this._configDistribute.getLowStreamConfigDistribute();if(a&&a.bitrate&&r.bitrate&&a.bitrate<r.bitrate&&(r.bitrate=a.bitrate),this._lowStreamParameter=r,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(r,ke.LocalVideoLowTrack)}async enableDualStream(){if(!un().supportDualStream)throw nt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new Ee(ie.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new Ee(ie.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(r){throw nt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),r}this._isDualStreamEnabled=!0,nt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),F.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(ke.LocalVideoLowTrack))try{const r=await this._p2pChannel.unpublishLowStream();r&&await this._gateway.unpublish(r,this._joinInfo.stringUid||this._joinInfo.uid)}catch(r){throw nt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),r}this._isDualStreamEnabled=!1,nt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),F.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(r,a){if(function(l){ni(l,"role",["audience","host"])}(r),a&&mj(a),this.mode==="rtc"||this.mode==="p2p")throw F.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new Ee(ie.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(a&&a.level&&r==="host")throw new Ee(ie.INVALID_OPERATION,"host mode can not set audience latency level");if(r==="audience"&&this._p2pChannel.hasLocalMedia())throw new Ee(ie.INVALID_OPERATION,"can not set client role to audience when publishing stream");const s=this._config.role;this._joinInfo&&(this._joinInfo.role=r),r!==s&&se("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(r,a),this._config.role=r,this._gateway.reconnect("recover",Di.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(r,a),this._config.role=r),F.info("[".concat(this._clientId,"] set client role to ").concat(r,", level: ").concat(a&&a.level))}async _setClientRoleOptions(r){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let a=!1;try{r&&mj(r),await this._gateway.setClientRole(this._config.role,r),a=!0}catch{}finally{F.info("[".concat(this._clientId,"] set client role options ").concat(a?"succeed":"failed",", options is ").concat(r))}}getRemoteInboundOffset(){var r;const a=(r=this._p2pChannel.getStats())===null||r===void 0?void 0:r.audioSend[0];if(!a||!a.timestamp)return 0;const s=a.timestamp-Date.now();return Math.abs(s)>1e3+a.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?s:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(r,a){if(Ti(r,"proxyServer"),!a){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ee(ie.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=r,nt.setProxyServer(this._proxyServer),F.setProxyServer(this._proxyServer),F.info("[".concat(this._clientId,"] Set proxy server ").concat(a?"by initialize call":""," success."))}setTurnServer(r,a){if(Array.isArray(r)||(r=[r]),!a){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ee(ie.INVALID_OPERATION,"You have already set the proxy")}if(ob(r))return this._turnServer={servers:r,mode:"original-manual"},void F.info("[".concat(this._clientId,"] Set original turnserver ").concat(a?"by initialize call":""," success: ").concat(r.map(s=>s.urls).join(","),"."));r.forEach(s=>hz(s)),this._turnServer={servers:r,mode:"manual"},F.info("[".concat(this._clientId,"] Set turnserver ").concat(a?"by initialize call":""," success."))}setLicense(r){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"you should set license before join channel");if(Ti(r,"license",32,32),!/^[A-Za-z\d]+$/.test(r))throw new Ee(ie.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=r,F.info("[".concat(this._clientId,"] set license success"),r)}startProxyServer(r){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new Ee(ie.INVALID_OPERATION,"You have already set the proxy");const a=[3,4,5];let s;switch(r===void 0&&(r=3),r){case 1:case 2:throw new Ee(ie.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:s="proxy3";break;case 4:s="proxy4";break;case 5:s="proxy5";break;default:throw new Ee(ie.INVALID_PARAMS,"proxy server mode must be ".concat(a.join("|")))}this._cloudProxyServerMode=s,this.store.cloudProxyServerMode=s,F.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Stop proxy server after leave channel");nt.setProxyServer(),F.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",F.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(r){if(!r.accessPoints)throw new Ee(ie.INVALID_PARAMS,"accessPoints is required.");ad(r.accessPoints.serverList,"accessPoints.serverList"),Ti(r.accessPoints.domain,"accessPoints.domain");const a=(I,L)=>{kn(I,L,0,65535,!0)};let s=443;if(r.accessPoints.port&&(a(r.accessPoints.port,"accessPoints.port"),s=r.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ee(ie.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");se("CLOSE_AFB_FOR_LOCAL_AP")&&(An("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),An("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const l=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,d=r.accessPoints.domain,f=r.accessPoints.serverList.map(I=>l.test(I)?"".concat(I.replace(/\./g,"-"),".").concat(d):I),m=f.map(I=>"".concat(I,":").concat(s));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,An("WEBCS_DOMAIN",m),An("WEBCS_DOMAIN_BACKUP_LIST",m),An("GATEWAY_DOMAINS",[d]),r.report&&r.report.hostname&&Array.isArray(r.report.hostname)&&r.report.hostname.length?(ad(r.report.hostname,"report.hostname"),An("EVENT_REPORT_DOMAIN",r.report.hostname[0]),An("EVENT_REPORT_BACKUP_DOMAIN",r.report.hostname[1]||r.report.hostname[0])):(An("EVENT_REPORT_DOMAIN",f[0]),An("EVENT_REPORT_BACKUP_DOMAIN",f[1]||f[0]));let y=6443;r.report&&r.report.port&&(a(r.report.port,"report.port"),y=r.report.port),An("STATS_COLLECTOR_PORT",y),r.report?An("ENABLE_EVENT_REPORT",!0):An("ENABLE_EVENT_REPORT",!1);let _="";r.log&&r.log.hostname&&Array.isArray(r.log.hostname)&&r.log.hostname.length?(ad(r.log.hostname,"log.hostname"),_=r.log.hostname[0]):_=f[0];let w=6444;r.log&&r.log.port&&(a(r.log.port,"log.port"),w=r.log.port),An("LOG_UPLOAD_SERVER","".concat(_,":").concat(w));let x=[];r.cds&&r.cds.hostname&&Array.isArray(r.cds.hostname)&&r.cds.hostname.length?(ad(r.cds.hostname,"cds.hostname"),x=r.cds.hostname):x=f;let A=443;r.cds&&r.cds.port&&(a(r.cds.port,"cds.port"),A=r.cds.port),An("CDS_AP",x.map(I=>"".concat(I,":").concat(A))),r.cds?An("ENABLE_CONFIG_DISTRIBUTE",!0):An("ENABLE_CONFIG_DISTRIBUTE",!1),F.info("set local access point v2 success")}setLocalAccessPoints(r,a){if(ad(r,"serverList"),Ti(a,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ee(ie.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;r=r.map(l=>s.test(l)?"".concat(l.replace(/\./g,"-"),".").concat(a):l),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,An("WEBCS_DOMAIN",r),An("WEBCS_DOMAIN_BACKUP_LIST",r),An("GATEWAY_DOMAINS",[a]),An("EVENT_REPORT_DOMAIN",r[0]),An("EVENT_REPORT_BACKUP_DOMAIN",r[1]||r[0]),An("LOG_UPLOAD_SERVER","".concat(r[0],":6444")),F.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(r){if(ni(r,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=r,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(r),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(a){throw F.error("[".concat(this._clientId,"] set default remote video stream type error"),a.toString()),a}else F.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(r))}async setRemoteVideoStreamType(r,a){ni(a,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(r,a),setTimeout(()=>{const s=this._users.find(l=>l.uid===r);s&&s.videoTrack&&s.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(s){throw F.error("[".concat(this._clientId,"] set remote video stream type error"),s.toString()),s}F.info("[".concat(this._clientId,"] set remote ").concat(r," video stream type to ").concat(a)),this._remoteStreamTypeCacheMap.set(r,a)}async setStreamFallbackOption(r,a){ni(a,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(r,a)}catch(s){throw F.error("[".concat(this._clientId,"] set stream fallback option"),s.toString()),s}F.info("[".concat(this._clientId,"] set remote ").concat(r," stream fallback type to ").concat(a)),this._streamFallbackTypeCacheMap.set(r,a)}setEncryptionConfig(r,a,s,l){(function(f){ni(f,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(r),Ti(a,"secret");const d=["aes-128-gcm2","aes-256-gcm2"];if(Ve(d).call(d,r)){if(!s||!(s instanceof Uint8Array&&s.length===32))throw new Ee(ie.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(s)throw new Ee(ie.INVALID_PARAMS,"current encrypt mode does not need salt");if(l){if(rl(l,"encryptDataStream"),!Ve(d).call(d,r))throw new Ee(ie.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(a)||F.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=r,this._encryptionSecret=a,s&&(this._encryptionSalt=fh(s))}async renewToken(r){if(Ti(r,"token",1,2047),!this._key||!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"renewToken should not be called before user join");const a=this._key;this._key=r,this._joinInfo&&(this._joinInfo.token=r);const s=await this._renewTokenMutex.lock();try{if(se("USE_NEW_TOKEN")){F.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const l=await yOe(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr);F.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:r,ticket:l})}else F.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:r});F.debug("[".concat(this._clientId,"] renewToken success"))}catch(l){throw this._key=a,this._joinInfo.token=a,F.error("[".concat(this._clientId,"] renewToken failed"),l.toString()),l}finally{s()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?F.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const r=this._p2pChannel.getAudioLevels();this.safeEmit(Qt.VOLUME_INDICATOR,r)},se("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const r=this._statsCollector.getRTCStats(),a=this._gateway.getInChannelInfo();return r.Duration=Math.round(a.duration/1e3),r}async startLiveStreaming(r,a){if(!a){if(this.codec!=="h264")throw new Ee(ie.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new Ee(ie.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(r)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(r))throw new Ee(ie.LIVE_STREAMING_TASK_CONFLICT);const s=a?sd.TRANSCODE:sd.RAW;return this._createLiveStreamingClient(s).startLiveStreamingTask(r,s)}setLiveTranscoding(r){return this._createLiveStreamingClient(sd.TRANSCODE).setTranscodingConfig(r)}async stopLiveStreaming(r){const a=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(s=>s&&s.hasUrl(r));if(!a.length)throw new Ee(ie.INVALID_PARAMS,"can not find live streaming url to stop");await Ge.all(a.map(s=>s&&s.stopLiveStreamingTask(r)))}async startChannelMediaRelay(r){QK(r),await this._createChannelMediaRelayClient().startChannelMediaRelay(r)}async updateChannelMediaRelay(r){QK(r),await this._createChannelMediaRelayClient().updateChannelMediaRelay(r)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(r){this._p2pChannel instanceof Ab&&this._p2pChannel.addAudioMetadata(r)}async sendStreamMessage(r){var a;let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not send data stream, not joined");if((typeof r=="string"||r instanceof Uint8Array)&&(r={payload:r}),typeof r.payload=="string"){const d=new TextEncoder;r.payload=d.encode(r.payload)}let l=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Ve(a=["aes-128-gcm2","aes-256-gcm2"]).call(a,this._encryptionMode)&&(l=!0,r.payload=await async function(d,f,m){var y;const _=sc(y=Array.from(m)).call(y,($,G)=>$+G,0),w={serverTs:0,seq:F1e++,length:m.length,checkSum:_},x=new Uint8Array(bz(_,2)),A=new ArrayBuffer(Sg),I=new DataView(A);I.setUint32(0,w.serverTs),I.setUint16(4,w.seq),I.setUint16(6,w.length),I.setUint16(8,w.checkSum);const L=16-m.length%16;m=mz(m,new Uint8Array(L));const H=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:d,tagLength:kz,additionalData:x},f,m);return mz(new Uint8Array(A),new Uint8Array(H))}(this._encryptDataStreamIv,this._encryptDataStreamKey,r.payload)),new Blob([r.payload]).size>1024)throw new Ee(ie.INVALID_PARAMS,l?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(Ct.DATA_STREAM,{payload:fh(r.payload),syncWithAudio:r.syncWithAudio,sendTs:Date.now()-COe},!s)}sendMetadata(r){if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([r]).size>1024)throw new Ee(ie.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Ct.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:fh(r)})}async sendCustomReportMessage(r){if(Array.isArray(r)||(r=[r]),r.forEach(q1e),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not send custom report, not joined");await nt.sendCustomReportMessage(this._joinInfo.sid,r)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){const r=this._statsCollector.getRemoteNetworkQualityStats();if(se("DELETE_NEQ_AFTER_USER_LEAVE")){const a=this._users.map(s=>s.uid+"");Object.keys(r).forEach(s=>{Ve(a).call(a,s)||delete r[s]})}return r}async pickSVCLayer(r,a){ni(a.spatialLayer,"spatialLayer",[0,1,2,3]),ni(a.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(r,a)}catch(s){throw F.error("[".concat(this._clientId,"] pick SVC layer failed"),s.toString()),s}}async setRTMConfig(r){const{apRTM:a=!1,rtmFlag:s}=r;if(rl(a,"apRTM"),kn(s,"rtmFlag",0),this._rtmConfig.apRTM=a,this._rtmConfig.rtmFlag=s,F.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(r)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=a,this._joinInfo.rtmFlag=s,this._gateway.setRTM2Flag(s)}_reset(){if(F.debug("[".concat(this._clientId,"] reset client")),function(r){const a=Dg.indexOf(r);a!==-1&&Dg.splice(a,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this.store.autoSubscribe=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=Ka.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&Tq(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&nt.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this.store.resetFirstVideoFrameDecoded(),this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(r=>{r._audioTrack&&r._audioTrack._destroy(),r._videoTrack&&r._videoTrack._destroy(),r._dataChannels&&(r._dataChannels.forEach(a=>a._close()),r._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Gi("client-publish",this._clientId),this._subscribeMutex=new Gi("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(r,a){var s;const l=r||sp();r?F.debug("[".concat(this._clientId,"] new Session ").concat(l)):F.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(l));const d=r?"":this._sessionId||"";this._sessionId=l,this.store.sessionId=l,nt.addSid(l);const f={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(a==null?void 0:a.stringUid)||((s=this._joinInfo)===null||s===void 0?void 0:s.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:d,clientRole:this.role==="audience"?2:1};nt.sessionInit(this._sessionId,wc({cname:a.channel,appid:a.appId},f)),this._joinInfo&&(this._joinInfo.sid=l),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=l)}async _publishHighStream(r){if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&se("FORCE_TURN")&&!se("TURN_ENABLE_TCP")&&!se("TURN_ENABLE_UDP"))throw new Ee(ie.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");F.debug("[".concat(this._clientId,"] publish high stream"));try{const s=await this._p2pChannel.publish(r,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const l=(await s.next()).value;if(l){try{await this._gateway.sendExtensionMessage(Ar.PUBLISH,l,!0)}catch(d){throw s.throw(d),d}await s.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const l=(await s.next()).value;if(l){var a;let d;try{d=await this._gateway.publish(this._uid,l,!0)}catch(f){if(f.code!==ie.DISCONNECT_P2P)throw s.throw(f),f}await s.next(((a=d)===null||a===void 0?void 0:a.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const d of r)d instanceof Wn&&d._encoderConfig&&this._gateway.setVideoProfile(d._encoderConfig).catch(f=>{F.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!d.muted&&d.enabled||await this._p2pChannel.muteLocalTrack(d)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,r),(s==null?void 0:s.code)===ie.WS_ABORT)return;throw s}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));F.debug("[".concat(this._clientId,"] publish low stream"));const r=this._configDistribute.getLowStreamConfigDistribute();r&&r.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&r.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=r.bitrate));try{const s=await this._p2pChannel.publishLowStream(this._lowStreamParameter),l=(await s.next()).value;if(l){var a;let d;try{d=await this._gateway.publish(this._uid,l,!0)}catch(f){if(f.code!==ie.DISCONNECT_P2P)throw s.throw(f),f}s.next(((a=d)===null||a===void 0?void 0:a.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,void 0,!0),(s==null?void 0:s.code)===ie.WS_ABORT)return;throw s}}_createLiveStreamingClient(r){const a=()=>{if(!this._joinInfo||!this._appId)return new Ee(ie.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const s=(l={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},ld("LiveStreaming").create(l));var l;return s.onLiveStreamError=(d,f)=>{nt.reportApiInvoke(this._sessionId,{name:Er.ON_LIVE_STREAM_ERROR,options:[d,f],tag:rr.TRACER}).onSuccess(),this.safeEmit(Qt.LIVE_STREAMING_ERROR,d,f)},s.onLiveStreamWarning=(d,f)=>{nt.reportApiInvoke(this._sessionId,{name:Er.ON_LIVE_STREAM_WARNING,options:[d,f],tag:rr.TRACER}).onSuccess(),this.safeEmit(Qt.LIVE_STREAMING_WARNING,d,f)},s.on(lD.REQUEST_WORKER_MANAGER_LIST,(d,f,m)=>{if(!this._joinInfo)return m(new Ee(ie.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(y,_,w,x){const A=se("UAP_AP").slice(0,se("AJAX_REQUEST_CONCURRENT")).map(I=>_.proxyServer?"https://".concat(_.proxyServer,"/ap/?url=").concat(I+"/api/v1?action=uap"):"https://".concat(I,"/api/v1?action=uap"));return await dOe(A,y,_,w,x)})(d,this._joinInfo,this._axiosCancelSource.token,Gr).then(f).catch(m)}),s};return r===sd.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||a(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||a(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new Ee(ie.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:a,sendResolutionHeight:s}=this.getLocalVideoStats(),l=(r={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:a,height:s}},ld("ChannelMediaRelay").create(r));l.on("state",d=>{d===cs.RELAY_STATE_FAILURE&&l&&l.dispose(),this.safeEmit(Qt.CHANNEL_MEDIA_RELAY_STATE,d)}),l.on("event",d=>{this.safeEmit(Qt.CHANNEL_MEDIA_RELAY_EVENT,d)}),this._channelMediaRelayClient=l,this._statsCollector.onStatsChanged=(d,f)=>{var m;d==="resolution"&&((m=this._channelMediaRelayClient)===null||m===void 0||m.setVideoProfile(f))}}var r;return this._channelMediaRelayClient}_handleUpdateDataChannel(r,a){const{added:s,deleted:l}=r,d=[];if(a){const f=[];this._users.forEach(m=>{m._dataChannels.forEach(y=>{s.every(_=>_.uid!==m._uintid||_.stream_id!==y.id)&&f.push({uid:m._uintid,stream_id:y.id,ordered:y.ordered,max_retrans_times:y.maxRetransmits,metadata:y.metadata})})}),f.length>0&&this._handleUpdateDataChannel({added:[],deleted:f})}Array.isArray(s)&&s.length>0&&s.forEach(f=>{const{uid:m,stream_id:y,ordered:_,max_retrans_times:w,metadata:x}=f,A=this._users.find(I=>I._uintid===m);if(!A)return void F.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(F.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(m)),Ve(d).call(d,A)||d.push(A),A._uintid||(A._uintid=m),A._dataChannels.findIndex(I=>I.id===f.stream_id)===-1){const I={id:y,ordered:!!_,maxRetransmits:w,metadata:x},L=function(H){return MK(H,!0)}(I);A._dataChannels.push(L),F.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published datachannel")),a||this.safeEmit(Qt.USER_PUBLISHED,A,"datachannel",I)}this._p2pChannel.hasPendingRemoteDataChannel(A,f.stream_id)&&(F.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(A.uid," after reconnect.")),this._subscribeDataChannel(A,f.stream_id).catch(I=>{F.error("[".concat(this._clientId,"] resubscribe datachannel error"),I.toString())}))}),a&&(this.safeEmit(Qt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(l)&&l.length>0&&l.forEach(f=>{const{uid:m,stream_id:y}=f,_=this._users.find(x=>x._uintid===m);if(!_)return void F.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const w=_._dataChannels.find(x=>x.id===f.stream_id);w&&(F.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(m)),this._p2pChannel.unsubscribeDataChannel(_,[w]).then(x=>{if(_._dataChannels=_._dataChannels.filter(A=>A!==w),x)return this._gateway.unsubscribeDataChannel(x,_.uid)}),F.info("[".concat(this._clientId,"] remote user ").concat(m," unpublished datachannel ,id:").concat(w.id)),this.safeEmit(Qt.USER_UNPUBLISHED,_,"datachannel",w._config))})}_getEncodingName(r){var a;if(!this._joinResponse)return;const s=(a=this._joinResponse.ortc.rtpCapabilities.sendrecv)===null||a===void 0?void 0:a.videoCodecs;if(s)for(const d of s){var l;if(d.payloadType===r)return d==null||(l=d.rtpMap)===null||l===void 0?void 0:l.encodingName}}_handleRemoveDataChannels(r){const a=this._users.find(s=>s.uid===r.uid);if(a){if(a._dataChannels!==void 0&&a._dataChannels.length>0){F.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(r.uid));const s=()=>{F.info("[".concat(this._clientId,"] remote user ").concat(a.uid," unpublished datachannel")),a._dataChannels.forEach(l=>{this.safeEmit(Qt.USER_UNPUBLISHED,a,"datachannel",l._config)})};this._p2pChannel.unsubscribeDataChannel(a,a._dataChannels).then(l=>{if(l)return this._gateway.unsubscribeDataChannel(l,a.uid)}),s()}}else F.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(vi.UPDATE_GATEWAY_CONFIG,()=>{(function(){let r;try{r=window.localStorage.getItem("websdk_ng_global_parameter")}catch(a){return void F.error("Error loading sdk config",a.message)}if(r)try{const a=JSON.parse(window.atob(r)),s=Date.now();Object.keys(a).forEach(l=>{const{value:d,type:f,expires:m}=a[l];m&&m<=s||f||nD()||!Object.prototype.hasOwnProperty.call(zx,l)||(al[l]=d,Zn[l]=d,F.debug("Update gateway parameters from config distribute",l,d))})}catch(a){F.error("Error update config from local cache",a.message)}})()}),this._gateway.on(vi.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(vi.CONNECTION_STATE_CHANGE,(r,a,s)=>{var l;if(s===En.FALLBACK)return;const d=()=>{this.safeEmit(Qt.CONNECTION_STATE_CHANGE,r,a,s)};if(nt.reportApiInvoke(this._sessionId||((l=this._gateway.joinInfo)===null||l===void 0?void 0:l.sid)||null,{name:Er.CONNECTION_STATE_CHANGE,options:[r,a,s],tag:rr.TRACER}).onSuccess(JSON.stringify({cur:r,prev:a,reason:s})),F.info("[".concat(this._clientId,"] signal connection state change: ").concat(a," -> ").concat(r)),r==="DISCONNECTED")return this._reset(),void d();if(r==="RECONNECTING")this._users.forEach(m=>{m._trust_in_room_=!1,m._trust_audio_enabled_state_=!1,m._trust_video_enabled_state_=!1,m._trust_audio_mute_state_=!1,m._trust_video_mute_state_=!1,m._trust_audio_stream_added_state_=!1,m._trust_video_stream_added_state_=!1,m._is_pre_created||(m._audio_pre_subscribed||(m._audioSSRC=void 0,m._audioOrtc=void 0),m._video_pre_subscribed||(m._videoSSRC=void 0,m._videoOrtc=void 0,m._rtxSsrcId=void 0),m._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(r==="CONNECTED"){var f;this._streamFallbackTypeCacheMap.forEach((m,y)=>{this._gateway.setStreamFallbackOption(y,m).catch(_=>{F.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_)})}),this._remoteStreamTypeCacheMap.forEach((m,y)=>{this._gateway.setRemoteVideoStreamType(y,m).catch(_=>{F.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_)})}),this._remoteDefaultVideoStreamType!==void 0&&((f=this._joinInfo)===null||f===void 0?void 0:f.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{F.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(m=>{F.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(m))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(m=>!m._trust_in_room_).forEach(m=>{F.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(m.uid)),this._handleUserOffline({uid:m.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(m=>{m._trust_audio_mute_state_||(F.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(m.uid)),this._handleMuteStream(m.uid,Ye.AUDIO,!1)),m._trust_video_mute_state_||(F.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(m.uid)),this._handleMuteStream(m.uid,Ye.VIDEO,!1)),m._trust_audio_enabled_state_||(F.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(m.uid)),this._handleSetStreamLocalEnable("audio",m.uid,!0)),m._trust_video_enabled_state_||(F.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(m.uid)),this._handleSetStreamLocalEnable("video",m.uid,!0)),m._trust_video_stream_added_state_||(F.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(m.uid)),this._handleResetAddStream(m,"video")),m._trust_audio_stream_added_state_||(F.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(m.uid)),this._handleResetAddStream(m,"audio")),m._video_added_||m._audio_added_||(F.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(m.uid)),this._handleRemoveStream({uid:m.uid,uint_id:m._uintid}))}))},1e3))}d()}),this._gateway.on(vi.REQUEST_NEW_GATEWAY_LIST,async(r,a)=>{if(!this._joinInfo)return a(new Ee(ie.UNEXPECTED_ERROR,"can not recover, no join info"));try{let s;const l=await Sq(wc(wc({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));l?(s=l.ap,Cq(l),this._joinInfo.preload=!0):(s=await TD(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=s.gatewayInfo.res,this._joinInfo.gatewayAddrs=s.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=s.gatewayInfo.uni_lbs_ip);const d=[];s.gatewayInfo.gatewayAddrs.forEach(f=>{let{address:m}=f;const[y,_]=m.split(":");this._joinInfo&&this._joinInfo.proxyServer?d.push({proxy:this._joinInfo.proxyServer,host:y,port:_}):d.push({host:y,port:_})}),r(d)}catch(s){a(s)}}),this._gateway.on(vi.NETWORK_QUALITY,r=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Qt.NETWORK_QUALITY,r)}),this._gateway.on(vi.STREAM_TYPE_CHANGE,(r,a)=>{this.safeEmit(Qt.STREAM_TYPE_CHANGED,r,a),nt.reportApiInvoke(this._sessionId,{name:Er.STREAM_TYPE_CHANGE,options:[r,a],tag:rr.TRACER}).onSuccess(JSON.stringify({uid:r,streamType:a}))}),this._gateway.isPreSub=()=>"isPreSub"in this._p2pChannel&&this._p2pChannel.isPreSub(),this._gateway.isPreallocation=()=>"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation(),this._gateway.on(vi.IS_P2P_DISCONNECTED,r=>{this._p2pChannel.isP2PDisconnected()?r(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?r(!1):r(!0)}),this._gateway.on(vi.REQUEST_P2P_CONNECTION_PARAMS,async(r,a,s)=>{try{let l=await this._p2pChannel.getEstablishParams();l&&"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation()||(l=await this._p2pChannel.startP2PConnection(r)),a(l)}catch(l){s(l)}}),this._gateway.on(vi.JOIN_RESPONSE,(r,a)=>{if(this.store.useP2P)return;let s;this._joinResponse=r,r.attributes?s=r.attributes.userAttributes.preSubSsrcs:F.debug("no attributes in joinResponse");const l=TK(r.ortc,a,s);this._p2pChannel.connect(l)}),this._gateway.on(vi.PRE_CONNECT_PC,async r=>{const{candidates:a,fingerprint:s,turnServer:l}=r;if(this._joinInfo&&a.length>0&&!this._p2pChannel.isPlanB){const{cert:f,cid:m}=this._joinInfo.apResponse,y="".concat(m,"_").concat(f);if(y.length<4||y.length>256)return;await this._p2pChannel.startP2PConnection({turnServer:l,cloudProxyServer:this._joinInfo.cloudProxyServer,isPreallocation:!0});try{var d;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(m,"_").concat(f),icePwd:"".concat(m,"_").concat(f)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(d=se("FINGERPRINT"))!==null&&d!==void 0?d:s}]},candidates:a,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}catch(_){_.code&&_.code===ie.EXCHANGE_SDP_FAILED&&await this._p2pChannel.startP2PConnection({turnServer:l,cloudProxyServer:this._joinInfo.cloudProxyServer},!0)}}})}_handleGatewaySignalEvents(){this._gateway.signal.on(tn.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(tn.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(tn.ON_ADD_AUDIO_STREAM,r=>this._handleAddAudioOrVideoStream("audio",r.uid,r.ssrcId,r.cname,r.pt,r.uint_id,r.ortc)),this._gateway.signal.on(tn.ON_ADD_VIDEO_STREAM,r=>this._handleAddAudioOrVideoStream("video",r.uid,r.ssrcId,r.cname,r.pt,r.uint_id,r.ortc,r.rtxSsrcId)),this._gateway.signal.on(tn.ON_REMOTE_DATASTREAM_UPDATE,r=>{this._handleUpdateDataChannel(r)}),this._gateway.signal.on(tn.ON_REMOTE_FULL_DATASTREAM_INFO,r=>{this._handleUpdateDataChannel({added:r.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(tn.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(tn.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(tn.MUTE_AUDIO,r=>this._handleMuteStream(r.uid,Ye.AUDIO,!0)),this._gateway.signal.on(tn.UNMUTE_AUDIO,r=>this._handleMuteStream(r.uid,Ye.AUDIO,!1)),this._gateway.signal.on(tn.MUTE_VIDEO,r=>this._handleMuteStream(r.uid,Ye.VIDEO,!0)),this._gateway.signal.on(tn.UNMUTE_VIDEO,r=>this._handleMuteStream(r.uid,Ye.VIDEO,!1)),this._gateway.signal.on(tn.RECEIVE_METADATA,r=>{const a=ap(r.metadata);this.safeEmit(Qt.RECEIVE_METADATA,r.uid,a)}),this._gateway.signal.on(tn.ON_DATA_STREAM,async r=>{var a;if(!r)return;let s=ap(r.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Ve(a=["aes-128-gcm2","aes-256-gcm2"]).call(a,this._encryptionMode)){if(r.payload.length<Sg)throw new Ee(ie.UNEXPECTED_RESPONSE,"payload length ".concat(r.payload.length," is less than header length ").concat(Sg));s=await async function(f,m,y){const _=y.subarray(0,Sg),w=_.slice(8,Sg),x=(w[0]<<8)+w[1],A=(_[6]<<8)+_[7],I=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:f,tagLength:kz,additionalData:new Uint8Array(bz(x,2))},m,y.subarray(Sg));return new Uint8Array(I).subarray(0,A)}(this._encryptDataStreamIv,this._encryptDataStreamKey,s)}let l=0;if(r.ordered||r.syncWithAudio){const d=this._p2pChannel.getStats(),f=this.remoteUsers.find(y=>y.uid===r.uid),m=d==null?void 0:d.audioRecv.find(y=>y.ssrc===(f==null?void 0:f._audioSSRC));l=m==null?void 0:m.jitterBufferMs}(l==null||Number.isNaN(l))&&(l=0),NOe(wc(wc({},r),{},{payload:s}),l,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(tn.ON_CRYPT_ERROR,()=>{hh(()=>{F.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Qt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(tn.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(tn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{F.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,En.TOKEN_EXPIRE),this.safeEmit(Qt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(tn.ON_STREAM_FALLBACK_UPDATE,r=>{F.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(r.stream_id,", attr: ").concat(r.stream_type)),this.safeEmit(Qt.STREAM_FALLBACK,r.stream_id,r.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(tn.ON_PUBLISH_STREAM,r=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:r.proxy})),F.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(r))))}),this._gateway.signal.on(tn.ENABLE_LOCAL_VIDEO,r=>{this._handleSetStreamLocalEnable("video",r.uid,!0)}),this._gateway.signal.on(tn.DISABLE_LOCAL_VIDEO,r=>{this._handleSetStreamLocalEnable("video",r.uid,!1)}),this._gateway.signal.on(It.REQUEST_TIMEOUT,(r,a)=>{if(this._joinInfo)switch(r){case Ct.PUBLISH:{if(!a)return;const d=a.ortc;if(d){var s,l;const f=d.some(_=>{let{stream_type:w}=_;return w===xn.Audio}),m=d.some(_=>{let{stream_type:w}=_;return w!==xn.Audio}),y=d.some(_=>{let{stream_type:w}=_;return w===xn.Screen||w===xn.ScreenLow});a.state==="offer"&&nt.publish(this._joinInfo.sid,{eventElapse:qi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:ie.TIMEOUT,audio:f,video:m,p2pid:a.p2p_id,publishRequestid:this.store.pubId,screenshare:y,audioName:f?(s=d.find(_=>{let{stream_type:w}=_;return w===xn.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0,videoName:m?(l=d.find(_=>{let{stream_type:w}=_;return w!==xn.Audio}))===null||l===void 0||(l=l.ssrcs[0])===null||l===void 0?void 0:l.ssrcId.toString():void 0})}break}case Ct.SUBSCRIBE:a&&nt.subscribe(this._joinInfo.sid,{succ:!1,ec:ie.TIMEOUT,audio:a.stream_type===Ye.AUDIO,video:a.stream_type===Ye.VIDEO,peerid:a.stream_id,subscribeRequestid:a.ssrcId,p2pid:this.store.p2pId,eventElapse:qi.measureFromSubscribeStart(this.store.clientId,a.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(a.ssrcId)})}}),this._gateway.signal.on(tn.ON_P2P_OK,r=>{this.uid,this._uid}),this._gateway.signal.on(tn.ON_PUBLISHED_USER_LIST,r=>{if(r==null||!r.users)return;se("BLOCK_LOCAL_CLIENT")&&(r.users=r.users.filter(l=>!pp(l.string_id||l.stream_id,this.channelName)));const a=[],s=[];for(const l of r.users){let d=this._users.find(x=>x._uintid===l.stream_id);d?d._trust_in_room_=!0:(d=new xh(l.string_id||l.stream_id,l.stream_id),this._users.push(d),this.store.firstVideoFrameDecoded(d.uid,{userJoinNotify:Date.now()}),this.getListeners(Qt.PUBLISHED_USER_LIST).length===0&&(F.debug("[".concat(this._clientId,"] user online"),l.stream_id),this.safeEmit(Qt.USER_JOINED,d)));const f=ci.Audio&l.stream_type,m=(ci.Video|ci.LwoVideo)&l.stream_type,y=(65280&l.stream_type)!=0,_=f&&d.hasAudio,w=m&&d.hasVideo;m&&(d._trust_video_stream_added_state_=!0,d._video_added_=!0,d._videoSSRC=l.video_ssrc,d._rtxSsrcId=l.video_rtx),f&&(d._trust_audio_stream_added_state_=!0,d._audio_added_=!0,d._audioSSRC=l.audio_ssrc),f&&!_&&this.getListeners(Qt.PUBLISHED_USER_LIST).length===0&&(F.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published audio")),this.safeEmit(Qt.USER_PUBLISHED,d,"audio")),m&&!w&&this.getListeners(Qt.PUBLISHED_USER_LIST).length===0&&(F.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published video")),this.safeEmit(Qt.USER_PUBLISHED,d,"video")),(f&&!_||m&&!w||y)&&a.push(d),m&&this._p2pChannel.hasPendingRemoteMedia(d,"video")&&s.push({user:d,mediaType:"video"}),f&&this._p2pChannel.hasPendingRemoteMedia(d,"audio")&&s.push({user:d,mediaType:"audio"})}s.length>0&&(F.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(s.map(l=>"user: ".concat(l.user.uid,", mediaType: ").concat(l.mediaType)).join("; ")," ")),this.massSubscribe(s).catch(l=>{F.error("[".concat(this._clientId,"] mass resubscribe error"),l.toString())})),this.getListeners(Qt.PUBLISHED_USER_LIST).length>0?se("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=a:(F.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(a.map(l=>l.uid).join(", "))),this.safeEmit(Qt.PUBLISHED_USER_LIST,a)):F.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(a.map(l=>l.uid).join(", ")))}),this._gateway.signal.on(tn.ON_RTP_CAPABILITY_CHANGE,r=>{const{video_codec:a}=r;this._p2pChannel instanceof Ab&&this._p2pChannel.updateRemoteRTPCapabilities(a.map(s=>s.toLowerCase()).filter(s=>{var l;return Ve(l=Object.keys(hb)).call(l,s)}))})}_handleP2PEvents(){this._gateway.signal.on(tn.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Ar.PUBLISH,(r,a,s)=>{const{uid:l}=r;r.forEach(d=>{const{kind:f,ssrcs:m,mid:y,isMuted:_}=d;this._handleP2PAddAudioOrVideoStream(f,l,m[0].ssrcId,y);const w=this._users.find(x=>x.uid===l);return w&&this.store.useP2P?this._p2pChannel.mockSubscribe(w,f,m[0].ssrcId,y).then(()=>{a()}).catch(s):a(),this._handleMuteStream(l,f,!!_)})}),this._gateway.signal.on(Ar.CALL,async(r,a,s)=>{if(this.store.useP2P)try{var l;a(await this._p2pChannel.startP2P({turnServer:(l=this._joinInfo)===null||l===void 0?void 0:l.turnServer},r))}catch(d){s(d)}}),this._gateway.signal.on(It.P2P_CONNECTION,async r=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(r)}),this._gateway.signal.on(Ar.UNPUBLISH,async(r,a,s)=>{if(this.store.useP2P){const{unpubMsg:l,uid:d}=r,f=this._users.find(m=>m.uid===d);if(!f)return F.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(d)),void a();try{l.forEach(async m=>{let{stream_type:y}=m;const _=y===xn.Audio?Ye.AUDIO:Ye.VIDEO;await this._p2pChannel.unsubscribe(f,_),this._handleMuteStream(d,_,!0)}),a()}catch(m){s(m)}}}),this._gateway.signal.on(Ar.CONTROL,async(r,a)=>{const{action:s}=r;switch(s){case vh.MUTE_LOCAL_VIDEO:this._handleMuteStream(a,Ye.VIDEO,!0);break;case vh.MUTE_LOCAL_AUDIO:this._handleMuteStream(a,Ye.AUDIO,!0);break;case vh.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",a),this._handleMuteStream(a,Ye.VIDEO,!1);break;case vh.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",a),this._handleMuteStream(a,Ye.AUDIO,!1)}}),this._gateway.signal.on(Ar.RESTART_ICE,async(r,a,s)=>{if(this.store.useP2P)try{const{direction:l,iceParameter:d}=r;l!==La.SEND_ONLY||d?a(await this._p2pChannel.restartICE(l,d)):(this._p2pChannel.handleDisconnect(l),a())}catch(l){s(l)}}),this._gateway.signal.on(Ar.CANDIDATE,r=>{if(this.store.useP2P){const{candidate:a,direction:s}=r;this._p2pChannel.addRemoteCandidate(a,s)}}),this._p2pChannel.on(ut.RequestP2PRestartICE,async(r,a,s)=>{try{const{direction:l}=r;a(await this._gateway.sendExtensionMessage(Ar.RESTART_ICE,r,l===La.SEND_ONLY))}catch(l){s(l)}}),this._p2pChannel.on(ut.LocalCandidate,r=>{this._gateway.sendExtensionMessage(Ar.CANDIDATE,JSON.stringify(r),!0)}),this._p2pChannel.on(ut.RequestP2PMuteLocal,async(r,a,s)=>{try{await this._gateway.sendExtensionMessage(Ar.CONTROL,r,!0),a()}catch(l){s(l)}}),this._p2pChannel.on(ut.RequestP2PUnmuteRemote,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(ut.RequestP2PMuteRemote,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.muteRemote(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(ut.StateChange,(r,a)=>{a===wn.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(ut.PeerConnectionStateChange,r=>{const a=this._peerConnectionState;r!==a&&(this.safeEmit(Qt.PEERCONNECTION_STATE_CHANGE,r,a),this._peerConnectionState=r)}),this._p2pChannel.on(ut.RequestMuteLocal,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.muteLocal(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(ut.RequestUnmuteLocal,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(ut.RequestRePublish,(r,a,s)=>{this.publish(r,!1).then(a).catch(s)}),this._p2pChannel.on(ut.RequestRePublishDataChannel,(r,a,s)=>{Ge.all(r.map(async l=>{const d=await this._p2pChannel.publishDataChannel([l]);try{d.forEach(f=>{this._uid&&this._gateway.publishDataChannel(this._uid,f,!0)})}catch(f){if(f.code!==ie.DISCONNECT_P2P)throw f}})).then(a).catch(s)}),this._p2pChannel.on(ut.RequestReSubscribe,async(r,a,s)=>{try{for(const{user:l,kind:d}of r)d===Ye.VIDEO?await this.subscribe(l,"video"):await this.subscribe(l,"audio");a()}catch(l){s(l)}}),this._p2pChannel.on(ut.RequestUpload,(r,a)=>{this._gateway.upload(r,a)}),this._p2pChannel.on(ut.RequestUploadStats,r=>{this._gateway.uploadWRTCStats(r)}),this._p2pChannel.on(ut.MediaReconnectStart,r=>{this.safeEmit(Qt.MEDIA_RECONNECT_START,r)}),this._p2pChannel.on(ut.MediaReconnectEnd,r=>{this.safeEmit(Qt.MEDIA_RECONNECT_END,r)}),this._p2pChannel.on(ut.NeedSignalRTT,r=>{r(this._gateway.getSignalRTT())}),this._p2pChannel.on(ut.RequestRestartICE,async r=>{if(this.store.useP2P)return;const a=await this._p2pChannel.restartICE(r),s=await a.next();if(s.done)return;const l=s.value;let d;try{d=await this._gateway.restartICE({iceParameters:l})}catch(m){return void a.throw(m)}const{iceParameters:f}=function(m){const y=m.iceParameters;return{iceParameters:{iceUfrag:y.iceUfrag,icePwd:y.icePwd}}}(d);await a.next({remoteIceParameters:f})}),this._p2pChannel.on(ut.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(ut.RequestReconnectPC,async()=>{var r;const{iceParameters:a,dtlsParameters:s,rtpCapabilities:l}=await this._p2pChannel.startP2PConnection({turnServer:(r=this._joinInfo)===null||r===void 0?void 0:r.turnServer}),{gatewayEstablishParams:d,gatewayAddress:f}=await this._gateway.reconnectPC({iceParameters:a,dtlsParameters:s,rtpCapabilities:l}),m=TK(d,f);await this._p2pChannel.connect(m),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(ut.RequestUnpublishForReconnectPC,async(r,a,s)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(r,this._uid),a()):s()}),this._p2pChannel.on(ut.P2PLost,()=>{this.safeEmit(Qt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(ut.UpdateVideoEncoder,r=>{r._encoderConfig&&this._gateway.setVideoProfile(r._encoderConfig)}),this._p2pChannel.on(ut.ConnectionTypeChange,r=>{this.safeEmit(Qt.IS_USING_CLOUD_PROXY,r)}),this._p2pChannel.on(ut.RequestLowStreamParameter,r=>{r(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(ut.QueryClientConnectionState,r=>{r(this.connectionState)}),this._p2pChannel.on(ut.AudioMetadata,r=>{this.safeEmit(Qt.AUDIO_METADATA,r)}),this._p2pChannel.on(ut.AudioPts,r=>{this.safeEmit(Qt.AUDIO_PTS,Number(r))})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(r){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const s=(a={config:r},ld("ContentInspect").create(a));this._inspect=s,this.handleVideoInspectEvents(s);const{appId:l,cname:d,sid:f,token:m,uid:y,cid:_,vid:w}=this._joinInfo;await s.init({appId:l,areaCode:"",cname:d,sid:f,token:m,uid:y,cid:_,vid:w?Number(w):0},Gr)}catch(s){throw Array.isArray(s)?s[0]:s}var a}handleVideoInspectEvents(r){r.on(yi.CONNECTION_STATE_CHANGE,(a,s)=>{if(this.safeEmit(Qt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,a,s),s===yc.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Qt.CONTENT_INSPECT_ERROR,new Ee(ie.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));r.inspectImage()}}),r.on(yi.INSPECT_RESULT,(a,s)=>{var l;if((s==null?void 0:s.code)===ie.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return F.debug("Stop inspect content because that has left channel"),this==null||(l=this._inspect)===null||l===void 0||l.close(),void(this._inspect=void 0);this.safeEmit(Qt.CONTENT_INSPECT_RESULT,a,s)}),r.on(yi.CLIENT_LOCAL_VIDEO_TRACK,a=>{a(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(r){throw Array.isArray(r)?r[0]:r}}async setImageModeration(r,a){if(rl(r,"enabled"),r){if(!a)throw new Ee(ie.INVALID_PARAMS,"config is required");if(Vq(a),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(a);else{const l=(s={config:a},ld("ImageModeration").create(s));this._moderation=l,this.handleImageModerationEvents(l);const{appId:d,cname:f,sid:m,token:y,uid:_,cid:w,vid:x}=this._joinInfo;await l.init({appId:d,areaCode:"",cname:f,sid:m,token:y,uid:_,cid:w,vid:x?Number(x):0},Gr)}}catch(l){throw Array.isArray(l)?l[0]:l}}else{var s;if(!this._moderation)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(l){throw Array.isArray(l)?l[0]:l}}}handleImageModerationEvents(r){r.on(cl.CONNECTION_STATE_CHANGE,(a,s)=>{if(this.safeEmit(Qt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,a,s),a===Io.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new Ee(ie.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");r.inspectImage()}}),r.on(cl.CLIENT_LOCAL_VIDEO_TRACK,a=>{a(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}setP2PTransport(r){if(function(a){ni(a,"transport",["default","auto","relay","sd-rtn"])}(r),this.mode!=="p2p")throw new Ee(ie.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=r,F.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(r))}getJoinChannelServiceRecords(){return F.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(r){rl(r,"enabled"),An("ENABLE_PUBLISH_AUDIO_FILTER",r),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(r)}_handleResetAddStream(r,a){switch(a){case"audio":r._audio_added_=!1,r._trust_audio_stream_added_state_=!0;break;case"video":r._video_added_=!1,r._trust_video_stream_added_state_=!0}}},tt(Ke.prototype,"leave",[Bq],Object.getOwnPropertyDescriptor(Ke.prototype,"leave"),Ke.prototype),tt(Ke.prototype,"publish",[$q],Object.getOwnPropertyDescriptor(Ke.prototype,"publish"),Ke.prototype),tt(Ke.prototype,"unpublish",[Wq],Object.getOwnPropertyDescriptor(Ke.prototype,"unpublish"),Ke.prototype),tt(Ke.prototype,"subscribe",[Gq],Object.getOwnPropertyDescriptor(Ke.prototype,"subscribe"),Ke.prototype),tt(Ke.prototype,"presubscribe",[Hq],Object.getOwnPropertyDescriptor(Ke.prototype,"presubscribe"),Ke.prototype),tt(Ke.prototype,"massSubscribe",[zq],Object.getOwnPropertyDescriptor(Ke.prototype,"massSubscribe"),Ke.prototype),tt(Ke.prototype,"unsubscribe",[Kq],Object.getOwnPropertyDescriptor(Ke.prototype,"unsubscribe"),Ke.prototype),tt(Ke.prototype,"massUnsubscribe",[qq],Object.getOwnPropertyDescriptor(Ke.prototype,"massUnsubscribe"),Ke.prototype),tt(Ke.prototype,"setLowStreamParameter",[Yq],Object.getOwnPropertyDescriptor(Ke.prototype,"setLowStreamParameter"),Ke.prototype),tt(Ke.prototype,"enableDualStream",[Xq],Object.getOwnPropertyDescriptor(Ke.prototype,"enableDualStream"),Ke.prototype),tt(Ke.prototype,"disableDualStream",[Jq],Object.getOwnPropertyDescriptor(Ke.prototype,"disableDualStream"),Ke.prototype),tt(Ke.prototype,"setClientRole",[Zq],Object.getOwnPropertyDescriptor(Ke.prototype,"setClientRole"),Ke.prototype),tt(Ke.prototype,"_setClientRoleOptions",[Qq],Object.getOwnPropertyDescriptor(Ke.prototype,"_setClientRoleOptions"),Ke.prototype),tt(Ke.prototype,"setProxyServer",[eY],Object.getOwnPropertyDescriptor(Ke.prototype,"setProxyServer"),Ke.prototype),tt(Ke.prototype,"setTurnServer",[tY],Object.getOwnPropertyDescriptor(Ke.prototype,"setTurnServer"),Ke.prototype),tt(Ke.prototype,"setLicense",[nY],Object.getOwnPropertyDescriptor(Ke.prototype,"setLicense"),Ke.prototype),tt(Ke.prototype,"startProxyServer",[rY],Object.getOwnPropertyDescriptor(Ke.prototype,"startProxyServer"),Ke.prototype),tt(Ke.prototype,"stopProxyServer",[iY],Object.getOwnPropertyDescriptor(Ke.prototype,"stopProxyServer"),Ke.prototype),tt(Ke.prototype,"setLocalAccessPointsV2",[aY],Object.getOwnPropertyDescriptor(Ke.prototype,"setLocalAccessPointsV2"),Ke.prototype),tt(Ke.prototype,"setLocalAccessPoints",[sY],Object.getOwnPropertyDescriptor(Ke.prototype,"setLocalAccessPoints"),Ke.prototype),tt(Ke.prototype,"setRemoteDefaultVideoStreamType",[oY],Object.getOwnPropertyDescriptor(Ke.prototype,"setRemoteDefaultVideoStreamType"),Ke.prototype),tt(Ke.prototype,"setRemoteVideoStreamType",[cY],Object.getOwnPropertyDescriptor(Ke.prototype,"setRemoteVideoStreamType"),Ke.prototype),tt(Ke.prototype,"setStreamFallbackOption",[lY],Object.getOwnPropertyDescriptor(Ke.prototype,"setStreamFallbackOption"),Ke.prototype),tt(Ke.prototype,"setEncryptionConfig",[uY],Object.getOwnPropertyDescriptor(Ke.prototype,"setEncryptionConfig"),Ke.prototype),tt(Ke.prototype,"renewToken",[dY],Object.getOwnPropertyDescriptor(Ke.prototype,"renewToken"),Ke.prototype),tt(Ke.prototype,"enableAudioVolumeIndicator",[hY],Object.getOwnPropertyDescriptor(Ke.prototype,"enableAudioVolumeIndicator"),Ke.prototype),tt(Ke.prototype,"startLiveStreaming",[fY],Object.getOwnPropertyDescriptor(Ke.prototype,"startLiveStreaming"),Ke.prototype),tt(Ke.prototype,"setLiveTranscoding",[pY],Object.getOwnPropertyDescriptor(Ke.prototype,"setLiveTranscoding"),Ke.prototype),tt(Ke.prototype,"stopLiveStreaming",[mY],Object.getOwnPropertyDescriptor(Ke.prototype,"stopLiveStreaming"),Ke.prototype),tt(Ke.prototype,"startChannelMediaRelay",[gY],Object.getOwnPropertyDescriptor(Ke.prototype,"startChannelMediaRelay"),Ke.prototype),tt(Ke.prototype,"updateChannelMediaRelay",[vY],Object.getOwnPropertyDescriptor(Ke.prototype,"updateChannelMediaRelay"),Ke.prototype),tt(Ke.prototype,"stopChannelMediaRelay",[yY],Object.getOwnPropertyDescriptor(Ke.prototype,"stopChannelMediaRelay"),Ke.prototype),tt(Ke.prototype,"sendCustomReportMessage",[_Y],Object.getOwnPropertyDescriptor(Ke.prototype,"sendCustomReportMessage"),Ke.prototype),tt(Ke.prototype,"pickSVCLayer",[bY],Object.getOwnPropertyDescriptor(Ke.prototype,"pickSVCLayer"),Ke.prototype),tt(Ke.prototype,"setRTMConfig",[EY],Object.getOwnPropertyDescriptor(Ke.prototype,"setRTMConfig"),Ke.prototype),tt(Ke.prototype,"enableContentInspect",[wY],Object.getOwnPropertyDescriptor(Ke.prototype,"enableContentInspect"),Ke.prototype),tt(Ke.prototype,"disableContentInspect",[SY],Object.getOwnPropertyDescriptor(Ke.prototype,"disableContentInspect"),Ke.prototype),tt(Ke.prototype,"setImageModeration",[xY],Object.getOwnPropertyDescriptor(Ke.prototype,"setImageModeration"),Ke.prototype),tt(Ke.prototype,"setP2PTransport",[TY],Object.getOwnPropertyDescriptor(Ke.prototype,"setP2PTransport"),Ke.prototype),tt(Ke.prototype,"getJoinChannelServiceRecords",[CY],Object.getOwnPropertyDescriptor(Ke.prototype,"getJoinChannelServiceRecords"),Ke.prototype),tt(Ke.prototype,"setPublishAudioFilterEnabled",[RY],Object.getOwnPropertyDescriptor(Ke.prototype,"setPublishAudioFilterEnabled"),Ke.prototype),Ke);class Pb{constructor(a,s){Z(this,"id",0),Z(this,"element",void 0),Z(this,"peerPair",void 0),Z(this,"context",void 0),Z(this,"audioPlayerElement",void 0),Z(this,"audioTrack",void 0),Pb.count+=1,this.id=Pb.count,this.element=a,this.context=s}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=a=>{const s=document.createElement("audio");s.srcObject=new MediaStream([a.track]),s.play(),this.audioPlayerElement=s}}async switchSdp(){if(!this.peerPair)return;const a=async(l,d)=>{const f=d==="offer"?await l.createOffer():await l.createAnswer();return await l.setLocalDescription(f),l.iceGatheringState==="complete"?l.localDescription:new Ge(m=>{l.onicegatheringstatechange=()=>{l.iceGatheringState==="complete"&&m(l.localDescription)}})},s=async(l,d)=>await l.setRemoteDescription(d);try{const l=await a(this.peerPair[0],"offer");await s(this.peerPair[1],l);const d=await a(this.peerPair[1],"answer");await s(this.peerPair[0],d)}catch(l){throw new Ee(ie.LOCAL_AEC_ERROR,l.toString()).print()}}async getTracksFromMediaElement(a){if(this.audioTrack)return this.audioTrack;let s;try{a instanceof HTMLVideoElement&&(a.captureStream?a.captureStream():a.mozCaptureStream()),s=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(a).connect(s)}catch(d){throw new Ee(ie.LOCAL_AEC_ERROR,d.toString()).print()}if(!s)throw new Ee(ie.LOCAL_AEC_ERROR,"no dest node when local aec").print();const l=s.stream.getAudioTracks()[0];return this.audioTrack=l,l}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const a=this.element,s=await this.getTracksFromMediaElement(a);this.peerPair&&this.peerPair[0].addTrack(s),await this.switchSdp()}close(){F.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(a=>{a.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var AY,BT;Z(Pb,"count",0);const GOe=window.AudioContext||window.webkitAudioContext,HOe=new(AY=Et({report:nt}),tt((BT=class{constructor(){Z(this,"units",[]),Z(this,"context",void 0)}processExternalMediaAEC(r){if(!this._doesEnvironmentNeedAEC())return F.debug("the system does not need to process local aec"),-1;this.context||(this.context=new GOe);let a=this.units.find(s=>s&&s.getElement()===r);return a||(a=new Pb(r,this.context),this.units.push(a)),a.startEchoCancellation(),F.debug("start processing local audio echo cancellation, id is",a.id),a.id}_doesEnvironmentNeedAEC(){return sn().name!==pn.SAFARI}}).prototype,"processExternalMediaAEC",[AY],Object.getOwnPropertyDescriptor(BT.prototype,"processExternalMediaAEC"),BT.prototype),BT);function IY(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function OY(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?IY(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):IY(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const GD=window||document;function PY(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!GD)return;const s=Hr._cspEventHandlerPointer;if(s&&a)return void console.error(s,a);const l=d=>{if(!(d&&d.blockedURI&&(Hr.onSecurityPolicyViolation||Hr.getListeners(su.SECURITY_POLICY_VIOLATION).length>0)))return;const f=d.blockedURI;se("CSP_DETECTED_HOSTNAME_LIST").some(m=>Ve(f).call(f,m))&&(Hr.onSecurityPolicyViolation&&typeof Hr.onSecurityPolicyViolation=="function"&&Hr.onSecurityPolicyViolation(d),Hr.getListeners(su.SECURITY_POLICY_VIOLATION).length>0&&Hr.safeEmit(su.SECURITY_POLICY_VIOLATION,d))};s&&GD.removeEventListener("securitypolicyviolation",s),(a||r&&typeof r=="function"||Hr.getListeners(su.SECURITY_POLICY_VIOLATION).length>0)&&GD.addEventListener("securitypolicyviolation",l),Hr._cspEventHandlerPointer=l}var zOe=T,KOe=fH,kY=RegExp.prototype,qOe=function(r){return r===kY||zOe(kY,r)?KOe(r):r.flags},xa=o(qOe);function Yg(r){let a=r.length;for(;--a>=0;)r[a]=0}const HD=256,jY=286,kb=30,jb=15,zD=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),$T=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),YOe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),DY=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dd=new Array(576);Yg(dd);const Db=new Array(60);Yg(Db);const Lb=new Array(512);Yg(Lb);const Mb=new Array(256);Yg(Mb);const KD=new Array(29);Yg(KD);const WT=new Array(kb);function qD(r,a,s,l,d){this.static_tree=r,this.extra_bits=a,this.extra_base=s,this.elems=l,this.max_length=d,this.has_stree=r&&r.length}let LY,MY,UY;function YD(r,a){this.dyn_tree=r,this.max_code=0,this.stat_desc=a}Yg(WT);const FY=r=>r<256?Lb[r]:Lb[256+(r>>>7)],Ub=(r,a)=>{r.pending_buf[r.pending++]=255&a,r.pending_buf[r.pending++]=a>>>8&255},so=(r,a,s)=>{r.bi_valid>16-s?(r.bi_buf|=a<<r.bi_valid&65535,Ub(r,r.bi_buf),r.bi_buf=a>>16-r.bi_valid,r.bi_valid+=s-16):(r.bi_buf|=a<<r.bi_valid&65535,r.bi_valid+=s)},lu=(r,a,s)=>{so(r,s[2*a],s[2*a+1])},VY=(r,a)=>{let s=0;do s|=1&r,r>>>=1,s<<=1;while(--a>0);return s>>>1},BY=(r,a,s)=>{const l=new Array(16);let d,f,m=0;for(d=1;d<=jb;d++)m=m+s[d-1]<<1,l[d]=m;for(f=0;f<=a;f++){let y=r[2*f+1];y!==0&&(r[2*f]=VY(l[y]++,y))}},$Y=r=>{let a;for(a=0;a<jY;a++)r.dyn_ltree[2*a]=0;for(a=0;a<kb;a++)r.dyn_dtree[2*a]=0;for(a=0;a<19;a++)r.bl_tree[2*a]=0;r.dyn_ltree[512]=1,r.opt_len=r.static_len=0,r.sym_next=r.matches=0},WY=r=>{r.bi_valid>8?Ub(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},GY=(r,a,s,l)=>{const d=2*a,f=2*s;return r[d]<r[f]||r[d]===r[f]&&l[a]<=l[s]},XD=(r,a,s)=>{const l=r.heap[s];let d=s<<1;for(;d<=r.heap_len&&(d<r.heap_len&&GY(a,r.heap[d+1],r.heap[d],r.depth)&&d++,!GY(a,l,r.heap[d],r.depth));)r.heap[s]=r.heap[d],s=d,d<<=1;r.heap[s]=l},HY=(r,a,s)=>{let l,d,f,m,y=0;if(r.sym_next!==0)do l=255&r.pending_buf[r.sym_buf+y++],l+=(255&r.pending_buf[r.sym_buf+y++])<<8,d=r.pending_buf[r.sym_buf+y++],l===0?lu(r,d,a):(f=Mb[d],lu(r,f+HD+1,a),m=zD[f],m!==0&&(d-=KD[f],so(r,d,m)),l--,f=FY(l),lu(r,f,s),m=$T[f],m!==0&&(l-=WT[f],so(r,l,m)));while(y<r.sym_next);lu(r,256,a)},JD=(r,a)=>{const s=a.dyn_tree,l=a.stat_desc.static_tree,d=a.stat_desc.has_stree,f=a.stat_desc.elems;let m,y,_,w=-1;for(r.heap_len=0,r.heap_max=573,m=0;m<f;m++)s[2*m]!==0?(r.heap[++r.heap_len]=w=m,r.depth[m]=0):s[2*m+1]=0;for(;r.heap_len<2;)_=r.heap[++r.heap_len]=w<2?++w:0,s[2*_]=1,r.depth[_]=0,r.opt_len--,d&&(r.static_len-=l[2*_+1]);for(a.max_code=w,m=r.heap_len>>1;m>=1;m--)XD(r,s,m);_=f;do m=r.heap[1],r.heap[1]=r.heap[r.heap_len--],XD(r,s,1),y=r.heap[1],r.heap[--r.heap_max]=m,r.heap[--r.heap_max]=y,s[2*_]=s[2*m]+s[2*y],r.depth[_]=(r.depth[m]>=r.depth[y]?r.depth[m]:r.depth[y])+1,s[2*m+1]=s[2*y+1]=_,r.heap[1]=_++,XD(r,s,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],((x,A)=>{const I=A.dyn_tree,L=A.max_code,H=A.stat_desc.static_tree,$=A.stat_desc.has_stree,G=A.stat_desc.extra_bits,ne=A.stat_desc.extra_base,te=A.stat_desc.max_length;let ce,pe,fe,ue,ye,xe,Ae=0;for(ue=0;ue<=jb;ue++)x.bl_count[ue]=0;for(I[2*x.heap[x.heap_max]+1]=0,ce=x.heap_max+1;ce<573;ce++)pe=x.heap[ce],ue=I[2*I[2*pe+1]+1]+1,ue>te&&(ue=te,Ae++),I[2*pe+1]=ue,pe>L||(x.bl_count[ue]++,ye=0,pe>=ne&&(ye=G[pe-ne]),xe=I[2*pe],x.opt_len+=xe*(ue+ye),$&&(x.static_len+=xe*(H[2*pe+1]+ye)));if(Ae!==0){do{for(ue=te-1;x.bl_count[ue]===0;)ue--;x.bl_count[ue]--,x.bl_count[ue+1]+=2,x.bl_count[te]--,Ae-=2}while(Ae>0);for(ue=te;ue!==0;ue--)for(pe=x.bl_count[ue];pe!==0;)fe=x.heap[--ce],fe>L||(I[2*fe+1]!==ue&&(x.opt_len+=(ue-I[2*fe+1])*I[2*fe],I[2*fe+1]=ue),pe--)}})(r,a),BY(s,w,r.bl_count)},zY=(r,a,s)=>{let l,d,f=-1,m=a[1],y=0,_=7,w=4;for(m===0&&(_=138,w=3),a[2*(s+1)+1]=65535,l=0;l<=s;l++)d=m,m=a[2*(l+1)+1],++y<_&&d===m||(y<w?r.bl_tree[2*d]+=y:d!==0?(d!==f&&r.bl_tree[2*d]++,r.bl_tree[32]++):y<=10?r.bl_tree[34]++:r.bl_tree[36]++,y=0,f=d,m===0?(_=138,w=3):d===m?(_=6,w=3):(_=7,w=4))},KY=(r,a,s)=>{let l,d,f=-1,m=a[1],y=0,_=7,w=4;for(m===0&&(_=138,w=3),l=0;l<=s;l++)if(d=m,m=a[2*(l+1)+1],!(++y<_&&d===m)){if(y<w)do lu(r,d,r.bl_tree);while(--y!=0);else d!==0?(d!==f&&(lu(r,d,r.bl_tree),y--),lu(r,16,r.bl_tree),so(r,y-3,2)):y<=10?(lu(r,17,r.bl_tree),so(r,y-3,3)):(lu(r,18,r.bl_tree),so(r,y-11,7));y=0,f=d,m===0?(_=138,w=3):d===m?(_=6,w=3):(_=7,w=4)}};let qY=!1;const YY=(r,a,s,l)=>{so(r,0+(l?1:0),3),WY(r),Ub(r,s),Ub(r,~s),s&&r.pending_buf.set(r.window.subarray(a,a+s),r.pending),r.pending+=s};var XOe=r=>{qY||((()=>{let a,s,l,d,f;const m=new Array(16);for(l=0,d=0;d<28;d++)for(KD[d]=l,a=0;a<1<<zD[d];a++)Mb[l++]=d;for(Mb[l-1]=d,f=0,d=0;d<16;d++)for(WT[d]=f,a=0;a<1<<$T[d];a++)Lb[f++]=d;for(f>>=7;d<kb;d++)for(WT[d]=f<<7,a=0;a<1<<$T[d]-7;a++)Lb[256+f++]=d;for(s=0;s<=jb;s++)m[s]=0;for(a=0;a<=143;)dd[2*a+1]=8,a++,m[8]++;for(;a<=255;)dd[2*a+1]=9,a++,m[9]++;for(;a<=279;)dd[2*a+1]=7,a++,m[7]++;for(;a<=287;)dd[2*a+1]=8,a++,m[8]++;for(BY(dd,287,m),a=0;a<kb;a++)Db[2*a+1]=5,Db[2*a]=VY(a,5);LY=new qD(dd,zD,257,jY,jb),MY=new qD(Db,$T,0,kb,jb),UY=new qD(new Array(0),YOe,0,19,7)})(),qY=!0),r.l_desc=new YD(r.dyn_ltree,LY),r.d_desc=new YD(r.dyn_dtree,MY),r.bl_desc=new YD(r.bl_tree,UY),r.bi_buf=0,r.bi_valid=0,$Y(r)},JOe=(r,a,s,l)=>{let d,f,m=0;r.level>0?(r.strm.data_type===2&&(r.strm.data_type=(y=>{let _,w=4093624447;for(_=0;_<=31;_++,w>>>=1)if(1&w&&y.dyn_ltree[2*_]!==0)return 0;if(y.dyn_ltree[18]!==0||y.dyn_ltree[20]!==0||y.dyn_ltree[26]!==0)return 1;for(_=32;_<HD;_++)if(y.dyn_ltree[2*_]!==0)return 1;return 0})(r)),JD(r,r.l_desc),JD(r,r.d_desc),m=(y=>{let _;for(zY(y,y.dyn_ltree,y.l_desc.max_code),zY(y,y.dyn_dtree,y.d_desc.max_code),JD(y,y.bl_desc),_=18;_>=3&&y.bl_tree[2*DY[_]+1]===0;_--);return y.opt_len+=3*(_+1)+5+5+4,_})(r),d=r.opt_len+3+7>>>3,f=r.static_len+3+7>>>3,f<=d&&(d=f)):d=f=s+5,s+4<=d&&a!==-1?YY(r,a,s,l):r.strategy===4||f===d?(so(r,2+(l?1:0),3),HY(r,dd,Db)):(so(r,4+(l?1:0),3),((y,_,w,x)=>{let A;for(so(y,_-257,5),so(y,w-1,5),so(y,x-4,4),A=0;A<x;A++)so(y,y.bl_tree[2*DY[A]+1],3);KY(y,y.dyn_ltree,_-1),KY(y,y.dyn_dtree,w-1)})(r,r.l_desc.max_code+1,r.d_desc.max_code+1,m+1),HY(r,r.dyn_ltree,r.dyn_dtree)),$Y(r),l&&WY(r)},ZOe=(r,a,s)=>(r.pending_buf[r.sym_buf+r.sym_next++]=a,r.pending_buf[r.sym_buf+r.sym_next++]=a>>8,r.pending_buf[r.sym_buf+r.sym_next++]=s,a===0?r.dyn_ltree[2*s]++:(r.matches++,a--,r.dyn_ltree[2*(Mb[s]+HD+1)]++,r.dyn_dtree[2*FY(a)]++),r.sym_next===r.sym_end),QOe=r=>{so(r,2,3),lu(r,256,dd),(a=>{a.bi_valid===16?(Ub(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)})(r)},ePe={_tr_init:XOe,_tr_stored_block:YY,_tr_flush_block:JOe,_tr_tally:ZOe,_tr_align:QOe},Fb=(r,a,s,l)=>{let d=65535&r|0,f=r>>>16&65535|0,m=0;for(;s!==0;){m=s>2e3?2e3:s,s-=m;do d=d+a[l++]|0,f=f+d|0;while(--m);d%=65521,f%=65521}return d|f<<16|0};const tPe=new Uint32Array((()=>{let r,a=[];for(var s=0;s<256;s++){r=s;for(var l=0;l<8;l++)r=1&r?3988292384^r>>>1:r>>>1;a[s]=r}return a})());var Ua=(r,a,s,l)=>{const d=tPe,f=l+s;r^=-1;for(let m=l;m<f;m++)r=r>>>8^d[255&(r^a[m])];return-1^r},bp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},GT={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:nPe,_tr_stored_block:ZD,_tr_flush_block:rPe,_tr_tally:Nh,_tr_align:iPe}=ePe,{Z_NO_FLUSH:Ah,Z_PARTIAL_FLUSH:aPe,Z_FULL_FLUSH:sPe,Z_FINISH:Sc,Z_BLOCK:XY,Z_OK:Ja,Z_STREAM_END:JY,Z_STREAM_ERROR:uu,Z_DATA_ERROR:oPe,Z_BUF_ERROR:QD,Z_DEFAULT_COMPRESSION:cPe,Z_FILTERED:lPe,Z_HUFFMAN_ONLY:HT,Z_RLE:uPe,Z_FIXED:dPe,Z_DEFAULT_STRATEGY:hPe,Z_UNKNOWN:fPe,Z_DEFLATED:zT}=GT,e2=286,pPe=30,mPe=19,gPe=2*e2+1,vPe=15,Ep=258,du=262,Xg=42,wp=113,Vb=666,Sp=(r,a)=>(r.msg=bp[a],a),ZY=r=>2*r-(r>4?9:0),Ih=r=>{let a=r.length;for(;--a>=0;)r[a]=0},yPe=r=>{let a,s,l,d=r.w_size;a=r.hash_size,l=a;do s=r.head[--l],r.head[l]=s>=d?s-d:0;while(--a);a=d,l=a;do s=r.prev[--l],r.prev[l]=s>=d?s-d:0;while(--a)};let Oh=(r,a,s)=>(a<<r.hash_shift^s)&r.hash_mask;const Po=r=>{const a=r.state;let s=a.pending;s>r.avail_out&&(s=r.avail_out),s!==0&&(r.output.set(a.pending_buf.subarray(a.pending_out,a.pending_out+s),r.next_out),r.next_out+=s,a.pending_out+=s,r.total_out+=s,r.avail_out-=s,a.pending-=s,a.pending===0&&(a.pending_out=0))},ko=(r,a)=>{rPe(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,a),r.block_start=r.strstart,Po(r.strm)},wr=(r,a)=>{r.pending_buf[r.pending++]=a},Bb=(r,a)=>{r.pending_buf[r.pending++]=a>>>8&255,r.pending_buf[r.pending++]=255&a},t2=(r,a,s,l)=>{let d=r.avail_in;return d>l&&(d=l),d===0?0:(r.avail_in-=d,a.set(r.input.subarray(r.next_in,r.next_in+d),s),r.state.wrap===1?r.adler=Fb(r.adler,a,d,s):r.state.wrap===2&&(r.adler=Ua(r.adler,a,d,s)),r.next_in+=d,r.total_in+=d,d)},QY=(r,a)=>{let s,l,d=r.max_chain_length,f=r.strstart,m=r.prev_length,y=r.nice_match;const _=r.strstart>r.w_size-du?r.strstart-(r.w_size-du):0,w=r.window,x=r.w_mask,A=r.prev,I=r.strstart+Ep;let L=w[f+m-1],H=w[f+m];r.prev_length>=r.good_match&&(d>>=2),y>r.lookahead&&(y=r.lookahead);do if(s=a,w[s+m]===H&&w[s+m-1]===L&&w[s]===w[f]&&w[++s]===w[f+1]){f+=2,s++;do;while(w[++f]===w[++s]&&w[++f]===w[++s]&&w[++f]===w[++s]&&w[++f]===w[++s]&&w[++f]===w[++s]&&w[++f]===w[++s]&&w[++f]===w[++s]&&w[++f]===w[++s]&&f<I);if(l=Ep-(I-f),f=I-Ep,l>m){if(r.match_start=a,m=l,l>=y)break;L=w[f+m-1],H=w[f+m]}}while((a=A[a&x])>_&&--d!=0);return m<=r.lookahead?m:r.lookahead},Jg=r=>{const a=r.w_size;let s,l,d;do{if(l=r.window_size-r.lookahead-r.strstart,r.strstart>=a+(a-du)&&(r.window.set(r.window.subarray(a,a+a-l),0),r.match_start-=a,r.strstart-=a,r.block_start-=a,r.insert>r.strstart&&(r.insert=r.strstart),yPe(r),l+=a),r.strm.avail_in===0)break;if(s=t2(r.strm,r.window,r.strstart+r.lookahead,l),r.lookahead+=s,r.lookahead+r.insert>=3)for(d=r.strstart-r.insert,r.ins_h=r.window[d],r.ins_h=Oh(r,r.ins_h,r.window[d+1]);r.insert&&(r.ins_h=Oh(r,r.ins_h,r.window[d+3-1]),r.prev[d&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=d,d++,r.insert--,!(r.lookahead+r.insert<3)););}while(r.lookahead<du&&r.strm.avail_in!==0)},eX=(r,a)=>{let s,l,d,f=r.pending_buf_size-5>r.w_size?r.w_size:r.pending_buf_size-5,m=0,y=r.strm.avail_in;do{if(s=65535,d=r.bi_valid+42>>3,r.strm.avail_out<d||(d=r.strm.avail_out-d,l=r.strstart-r.block_start,s>l+r.strm.avail_in&&(s=l+r.strm.avail_in),s>d&&(s=d),s<f&&(s===0&&a!==Sc||a===Ah||s!==l+r.strm.avail_in)))break;m=a===Sc&&s===l+r.strm.avail_in?1:0,ZD(r,0,0,m),r.pending_buf[r.pending-4]=s,r.pending_buf[r.pending-3]=s>>8,r.pending_buf[r.pending-2]=~s,r.pending_buf[r.pending-1]=~s>>8,Po(r.strm),l&&(l>s&&(l=s),r.strm.output.set(r.window.subarray(r.block_start,r.block_start+l),r.strm.next_out),r.strm.next_out+=l,r.strm.avail_out-=l,r.strm.total_out+=l,r.block_start+=l,s-=l),s&&(t2(r.strm,r.strm.output,r.strm.next_out,s),r.strm.next_out+=s,r.strm.avail_out-=s,r.strm.total_out+=s)}while(m===0);return y-=r.strm.avail_in,y&&(y>=r.w_size?(r.matches=2,r.window.set(r.strm.input.subarray(r.strm.next_in-r.w_size,r.strm.next_in),0),r.strstart=r.w_size,r.insert=r.strstart):(r.window_size-r.strstart<=y&&(r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,r.insert>r.strstart&&(r.insert=r.strstart)),r.window.set(r.strm.input.subarray(r.strm.next_in-y,r.strm.next_in),r.strstart),r.strstart+=y,r.insert+=y>r.w_size-r.insert?r.w_size-r.insert:y),r.block_start=r.strstart),r.high_water<r.strstart&&(r.high_water=r.strstart),m?4:a!==Ah&&a!==Sc&&r.strm.avail_in===0&&r.strstart===r.block_start?2:(d=r.window_size-r.strstart,r.strm.avail_in>d&&r.block_start>=r.w_size&&(r.block_start-=r.w_size,r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,d+=r.w_size,r.insert>r.strstart&&(r.insert=r.strstart)),d>r.strm.avail_in&&(d=r.strm.avail_in),d&&(t2(r.strm,r.window,r.strstart,d),r.strstart+=d,r.insert+=d>r.w_size-r.insert?r.w_size-r.insert:d),r.high_water<r.strstart&&(r.high_water=r.strstart),d=r.bi_valid+42>>3,d=r.pending_buf_size-d>65535?65535:r.pending_buf_size-d,f=d>r.w_size?r.w_size:d,l=r.strstart-r.block_start,(l>=f||(l||a===Sc)&&a!==Ah&&r.strm.avail_in===0&&l<=d)&&(s=l>d?d:l,m=a===Sc&&r.strm.avail_in===0&&s===l?1:0,ZD(r,r.block_start,s,m),r.block_start+=s,Po(r.strm)),m?3:1)},n2=(r,a)=>{let s,l;for(;;){if(r.lookahead<du){if(Jg(r),r.lookahead<du&&a===Ah)return 1;if(r.lookahead===0)break}if(s=0,r.lookahead>=3&&(r.ins_h=Oh(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),s!==0&&r.strstart-s<=r.w_size-du&&(r.match_length=QY(r,s)),r.match_length>=3)if(l=Nh(r,r.strstart-r.match_start,r.match_length-3),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=3){r.match_length--;do r.strstart++,r.ins_h=Oh(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Oh(r,r.ins_h,r.window[r.strstart+1]);else l=Nh(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(l&&(ko(r,!1),r.strm.avail_out===0))return 1}return r.insert=r.strstart<2?r.strstart:2,a===Sc?(ko(r,!0),r.strm.avail_out===0?3:4):r.sym_next&&(ko(r,!1),r.strm.avail_out===0)?1:2},Zg=(r,a)=>{let s,l,d;for(;;){if(r.lookahead<du){if(Jg(r),r.lookahead<du&&a===Ah)return 1;if(r.lookahead===0)break}if(s=0,r.lookahead>=3&&(r.ins_h=Oh(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=2,s!==0&&r.prev_length<r.max_lazy_match&&r.strstart-s<=r.w_size-du&&(r.match_length=QY(r,s),r.match_length<=5&&(r.strategy===lPe||r.match_length===3&&r.strstart-r.match_start>4096)&&(r.match_length=2)),r.prev_length>=3&&r.match_length<=r.prev_length){d=r.strstart+r.lookahead-3,l=Nh(r,r.strstart-1-r.prev_match,r.prev_length-3),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=d&&(r.ins_h=Oh(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=2,r.strstart++,l&&(ko(r,!1),r.strm.avail_out===0))return 1}else if(r.match_available){if(l=Nh(r,0,r.window[r.strstart-1]),l&&ko(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return 1}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(l=Nh(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<2?r.strstart:2,a===Sc?(ko(r,!0),r.strm.avail_out===0?3:4):r.sym_next&&(ko(r,!1),r.strm.avail_out===0)?1:2};function hu(r,a,s,l,d){this.good_length=r,this.max_lazy=a,this.nice_length=s,this.max_chain=l,this.func=d}const $b=[new hu(0,0,0,0,eX),new hu(4,4,8,4,n2),new hu(4,5,16,8,n2),new hu(4,6,32,32,n2),new hu(4,4,16,16,Zg),new hu(8,16,32,32,Zg),new hu(8,16,128,128,Zg),new hu(8,32,128,256,Zg),new hu(32,128,258,1024,Zg),new hu(32,258,258,4096,Zg)];function _Pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=zT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*gPe),this.dyn_dtree=new Uint16Array(2*(2*pPe+1)),this.bl_tree=new Uint16Array(2*(2*mPe+1)),Ih(this.dyn_ltree),Ih(this.dyn_dtree),Ih(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(vPe+1),this.heap=new Uint16Array(2*e2+1),Ih(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*e2+1),Ih(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Wb=r=>{if(!r)return 1;const a=r.state;return!a||a.strm!==r||a.status!==Xg&&a.status!==57&&a.status!==69&&a.status!==73&&a.status!==91&&a.status!==103&&a.status!==wp&&a.status!==Vb?1:0},tX=r=>{if(Wb(r))return Sp(r,uu);r.total_in=r.total_out=0,r.data_type=fPe;const a=r.state;return a.pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap===2?57:a.wrap?Xg:wp,r.adler=a.wrap===2?0:1,a.last_flush=-2,nPe(a),Ja},nX=r=>{const a=tX(r);return a===Ja&&(s=>{s.window_size=2*s.w_size,Ih(s.head),s.max_lazy_match=$b[s.level].max_lazy,s.good_match=$b[s.level].good_length,s.nice_match=$b[s.level].nice_length,s.max_chain_length=$b[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0})(r.state),a},rX=(r,a,s,l,d,f)=>{if(!r)return uu;let m=1;if(a===cPe&&(a=6),l<0?(m=0,l=-l):l>15&&(m=2,l-=16),d<1||d>9||s!==zT||l<8||l>15||a<0||a>9||f<0||f>dPe||l===8&&m!==1)return Sp(r,uu);l===8&&(l=9);const y=new _Pe;return r.state=y,y.strm=r,y.status=Xg,y.wrap=m,y.gzhead=null,y.w_bits=l,y.w_size=1<<y.w_bits,y.w_mask=y.w_size-1,y.hash_bits=d+7,y.hash_size=1<<y.hash_bits,y.hash_mask=y.hash_size-1,y.hash_shift=~~((y.hash_bits+3-1)/3),y.window=new Uint8Array(2*y.w_size),y.head=new Uint16Array(y.hash_size),y.prev=new Uint16Array(y.w_size),y.lit_bufsize=1<<d+6,y.pending_buf_size=4*y.lit_bufsize,y.pending_buf=new Uint8Array(y.pending_buf_size),y.sym_buf=y.lit_bufsize,y.sym_end=3*(y.lit_bufsize-1),y.level=a,y.strategy=f,y.method=s,nX(r)};var bPe=(r,a)=>{if(Wb(r)||a>XY||a<0)return r?Sp(r,uu):uu;const s=r.state;if(!r.output||r.avail_in!==0&&!r.input||s.status===Vb&&a!==Sc)return Sp(r,r.avail_out===0?QD:uu);const l=s.last_flush;if(s.last_flush=a,s.pending!==0){if(Po(r),r.avail_out===0)return s.last_flush=-1,Ja}else if(r.avail_in===0&&ZY(a)<=ZY(l)&&a!==Sc)return Sp(r,QD);if(s.status===Vb&&r.avail_in!==0)return Sp(r,QD);if(s.status===Xg&&s.wrap===0&&(s.status=wp),s.status===Xg){let d=zT+(s.w_bits-8<<4)<<8,f=-1;if(f=s.strategy>=HT||s.level<2?0:s.level<6?1:s.level===6?2:3,d|=f<<6,s.strstart!==0&&(d|=32),d+=31-d%31,Bb(s,d),s.strstart!==0&&(Bb(s,r.adler>>>16),Bb(s,65535&r.adler)),r.adler=1,s.status=wp,Po(r),s.pending!==0)return s.last_flush=-1,Ja}if(s.status===57){if(r.adler=0,wr(s,31),wr(s,139),wr(s,8),s.gzhead)wr(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),wr(s,255&s.gzhead.time),wr(s,s.gzhead.time>>8&255),wr(s,s.gzhead.time>>16&255),wr(s,s.gzhead.time>>24&255),wr(s,s.level===9?2:s.strategy>=HT||s.level<2?4:0),wr(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(wr(s,255&s.gzhead.extra.length),wr(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(r.adler=Ua(r.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if(wr(s,0),wr(s,0),wr(s,0),wr(s,0),wr(s,0),wr(s,s.level===9?2:s.strategy>=HT||s.level<2?4:0),wr(s,3),s.status=wp,Po(r),s.pending!==0)return s.last_flush=-1,Ja}if(s.status===69){if(s.gzhead.extra){let d=s.pending,f=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+f>s.pending_buf_size;){let y=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+y),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>d&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-d,d)),s.gzindex+=y,Po(r),s.pending!==0)return s.last_flush=-1,Ja;d=0,f-=y}let m=new Uint8Array(s.gzhead.extra);s.pending_buf.set(m.subarray(s.gzindex,s.gzindex+f),s.pending),s.pending+=f,s.gzhead.hcrc&&s.pending>d&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-d,d)),s.gzindex=0}s.status=73}if(s.status===73){if(s.gzhead.name){let d,f=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f)),Po(r),s.pending!==0)return s.last_flush=-1,Ja;f=0}d=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,wr(s,d)}while(d!==0);s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f)),s.gzindex=0}s.status=91}if(s.status===91){if(s.gzhead.comment){let d,f=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f)),Po(r),s.pending!==0)return s.last_flush=-1,Ja;f=0}d=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,wr(s,d)}while(d!==0);s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f))}s.status=103}if(s.status===103){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&(Po(r),s.pending!==0))return s.last_flush=-1,Ja;wr(s,255&r.adler),wr(s,r.adler>>8&255),r.adler=0}if(s.status=wp,Po(r),s.pending!==0)return s.last_flush=-1,Ja}if(r.avail_in!==0||s.lookahead!==0||a!==Ah&&s.status!==Vb){let d=s.level===0?eX(s,a):s.strategy===HT?((f,m)=>{let y;for(;;){if(f.lookahead===0&&(Jg(f),f.lookahead===0)){if(m===Ah)return 1;break}if(f.match_length=0,y=Nh(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++,y&&(ko(f,!1),f.strm.avail_out===0))return 1}return f.insert=0,m===Sc?(ko(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(ko(f,!1),f.strm.avail_out===0)?1:2})(s,a):s.strategy===uPe?((f,m)=>{let y,_,w,x;const A=f.window;for(;;){if(f.lookahead<=Ep){if(Jg(f),f.lookahead<=Ep&&m===Ah)return 1;if(f.lookahead===0)break}if(f.match_length=0,f.lookahead>=3&&f.strstart>0&&(w=f.strstart-1,_=A[w],_===A[++w]&&_===A[++w]&&_===A[++w])){x=f.strstart+Ep;do;while(_===A[++w]&&_===A[++w]&&_===A[++w]&&_===A[++w]&&_===A[++w]&&_===A[++w]&&_===A[++w]&&_===A[++w]&&w<x);f.match_length=Ep-(x-w),f.match_length>f.lookahead&&(f.match_length=f.lookahead)}if(f.match_length>=3?(y=Nh(f,1,f.match_length-3),f.lookahead-=f.match_length,f.strstart+=f.match_length,f.match_length=0):(y=Nh(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++),y&&(ko(f,!1),f.strm.avail_out===0))return 1}return f.insert=0,m===Sc?(ko(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(ko(f,!1),f.strm.avail_out===0)?1:2})(s,a):$b[s.level].func(s,a);if(d!==3&&d!==4||(s.status=Vb),d===1||d===3)return r.avail_out===0&&(s.last_flush=-1),Ja;if(d===2&&(a===aPe?iPe(s):a!==XY&&(ZD(s,0,0,!1),a===sPe&&(Ih(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),Po(r),r.avail_out===0))return s.last_flush=-1,Ja}return a!==Sc?Ja:s.wrap<=0?JY:(s.wrap===2?(wr(s,255&r.adler),wr(s,r.adler>>8&255),wr(s,r.adler>>16&255),wr(s,r.adler>>24&255),wr(s,255&r.total_in),wr(s,r.total_in>>8&255),wr(s,r.total_in>>16&255),wr(s,r.total_in>>24&255)):(Bb(s,r.adler>>>16),Bb(s,65535&r.adler)),Po(r),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?Ja:JY)},EPe=(r,a)=>{let s=a.length;if(Wb(r))return uu;const l=r.state,d=l.wrap;if(d===2||d===1&&l.status!==Xg||l.lookahead)return uu;if(d===1&&(r.adler=Fb(r.adler,a,s,0)),l.wrap=0,s>=l.w_size){d===0&&(Ih(l.head),l.strstart=0,l.block_start=0,l.insert=0);let _=new Uint8Array(l.w_size);_.set(a.subarray(s-l.w_size,s),0),a=_,s=l.w_size}const f=r.avail_in,m=r.next_in,y=r.input;for(r.avail_in=s,r.next_in=0,r.input=a,Jg(l);l.lookahead>=3;){let _=l.strstart,w=l.lookahead-2;do l.ins_h=Oh(l,l.ins_h,l.window[_+3-1]),l.prev[_&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=_,_++;while(--w);l.strstart=_,l.lookahead=2,Jg(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=2,l.match_available=0,r.next_in=m,r.input=y,r.avail_in=f,l.wrap=d,Ja},Gb={deflateInit:(r,a)=>rX(r,a,zT,15,8,hPe),deflateInit2:rX,deflateReset:nX,deflateResetKeep:tX,deflateSetHeader:(r,a)=>Wb(r)||r.state.wrap!==2?uu:(r.state.gzhead=a,Ja),deflate:bPe,deflateEnd:r=>{if(Wb(r))return uu;const a=r.state.status;return r.state=null,a===wp?Sp(r,oPe):Ja},deflateSetDictionary:EPe,deflateInfo:"pako deflate (from Nodeca project)"};const wPe=(r,a)=>Object.prototype.hasOwnProperty.call(r,a);var KT={assign:function(r){const a=Array.prototype.slice.call(arguments,1);for(;a.length;){const s=a.shift();if(s){if(typeof s!="object")throw new TypeError(s+"must be non-object");for(const l in s)wPe(s,l)&&(r[l]=s[l])}}return r},flattenChunks:r=>{let a=0;for(let l=0,d=r.length;l<d;l++)a+=r[l].length;const s=new Uint8Array(a);for(let l=0,d=0,f=r.length;l<f;l++){let m=r[l];s.set(m,d),d+=m.length}return s}};let iX=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{iX=!1}const Hb=new Uint8Array(256);for(let r=0;r<256;r++)Hb[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;Hb[254]=Hb[254]=1;var zb={string2buf:r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let a,s,l,d,f,m=r.length,y=0;for(d=0;d<m;d++)s=r.charCodeAt(d),(64512&s)==55296&&d+1<m&&(l=r.charCodeAt(d+1),(64512&l)==56320&&(s=65536+(s-55296<<10)+(l-56320),d++)),y+=s<128?1:s<2048?2:s<65536?3:4;for(a=new Uint8Array(y),f=0,d=0;f<y;d++)s=r.charCodeAt(d),(64512&s)==55296&&d+1<m&&(l=r.charCodeAt(d+1),(64512&l)==56320&&(s=65536+(s-55296<<10)+(l-56320),d++)),s<128?a[f++]=s:s<2048?(a[f++]=192|s>>>6,a[f++]=128|63&s):s<65536?(a[f++]=224|s>>>12,a[f++]=128|s>>>6&63,a[f++]=128|63&s):(a[f++]=240|s>>>18,a[f++]=128|s>>>12&63,a[f++]=128|s>>>6&63,a[f++]=128|63&s);return a},buf2string:(r,a)=>{const s=a||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,a));let l,d;const f=new Array(2*s);for(d=0,l=0;l<s;){let m=r[l++];if(m<128){f[d++]=m;continue}let y=Hb[m];if(y>4)f[d++]=65533,l+=y-1;else{for(m&=y===2?31:y===3?15:7;y>1&&l<s;)m=m<<6|63&r[l++],y--;y>1?f[d++]=65533:m<65536?f[d++]=m:(m-=65536,f[d++]=55296|m>>10&1023,f[d++]=56320|1023&m)}}return((m,y)=>{if(y<65534&&m.subarray&&iX)return String.fromCharCode.apply(null,m.length===y?m:m.subarray(0,y));let _="";for(let w=0;w<y;w++)_+=String.fromCharCode(m[w]);return _})(f,d)},utf8border:(r,a)=>{(a=a||r.length)>r.length&&(a=r.length);let s=a-1;for(;s>=0&&(192&r[s])==128;)s--;return s<0||s===0?a:s+Hb[r[s]]>a?s:a}},aX=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const sX=Object.prototype.toString,{Z_NO_FLUSH:SPe,Z_SYNC_FLUSH:xPe,Z_FULL_FLUSH:TPe,Z_FINISH:CPe,Z_OK:qT,Z_STREAM_END:RPe,Z_DEFAULT_COMPRESSION:NPe,Z_DEFAULT_STRATEGY:APe,Z_DEFLATED:IPe}=GT;function YT(r){this.options=KT.assign({level:NPe,method:IPe,chunkSize:16384,windowBits:15,memLevel:8,strategy:APe},r||{});let a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new aX,this.strm.avail_out=0;let s=Gb.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(s!==qT)throw new Error(bp[s]);if(a.header&&Gb.deflateSetHeader(this.strm,a.header),a.dictionary){let l;if(l=typeof a.dictionary=="string"?zb.string2buf(a.dictionary):sX.call(a.dictionary)==="[object ArrayBuffer]"?new Uint8Array(a.dictionary):a.dictionary,s=Gb.deflateSetDictionary(this.strm,l),s!==qT)throw new Error(bp[s]);this._dict_set=!0}}function OPe(r,a){const s=new YT(a);if(s.push(r,!0),s.err)throw s.msg||bp[s.err];return s.result}YT.prototype.push=function(r,a){const s=this.strm,l=this.options.chunkSize;let d,f;if(this.ended)return!1;for(f=a===~~a?a:a===!0?CPe:SPe,typeof r=="string"?s.input=zb.string2buf(r):sX.call(r)==="[object ArrayBuffer]"?s.input=new Uint8Array(r):s.input=r,s.next_in=0,s.avail_in=s.input.length;;)if(s.avail_out===0&&(s.output=new Uint8Array(l),s.next_out=0,s.avail_out=l),(f===xPe||f===TPe)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(d=Gb.deflate(s,f),d===RPe)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),d=Gb.deflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===qT;if(s.avail_out!==0){if(f>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(s.avail_in===0)break}else this.onData(s.output)}return!0},YT.prototype.onData=function(r){this.chunks.push(r)},YT.prototype.onEnd=function(r){r===qT&&(this.result=KT.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var PPe={deflate:OPe};const XT=16209;var kPe=function(r,a){let s,l,d,f,m,y,_,w,x,A,I,L,H,$,G,ne,te,ce,pe,fe,ue,ye,xe,Ae;const Le=r.state;s=r.next_in,xe=r.input,l=s+(r.avail_in-5),d=r.next_out,Ae=r.output,f=d-(a-r.avail_out),m=d+(r.avail_out-257),y=Le.dmax,_=Le.wsize,w=Le.whave,x=Le.wnext,A=Le.window,I=Le.hold,L=Le.bits,H=Le.lencode,$=Le.distcode,G=(1<<Le.lenbits)-1,ne=(1<<Le.distbits)-1;e:do{L<15&&(I+=xe[s++]<<L,L+=8,I+=xe[s++]<<L,L+=8),te=H[I&G];t:for(;;){if(ce=te>>>24,I>>>=ce,L-=ce,ce=te>>>16&255,ce===0)Ae[d++]=65535&te;else{if(!(16&ce)){if(!(64&ce)){te=H[(65535&te)+(I&(1<<ce)-1)];continue t}if(32&ce){Le.mode=16191;break e}r.msg="invalid literal/length code",Le.mode=XT;break e}pe=65535&te,ce&=15,ce&&(L<ce&&(I+=xe[s++]<<L,L+=8),pe+=I&(1<<ce)-1,I>>>=ce,L-=ce),L<15&&(I+=xe[s++]<<L,L+=8,I+=xe[s++]<<L,L+=8),te=$[I&ne];n:for(;;){if(ce=te>>>24,I>>>=ce,L-=ce,ce=te>>>16&255,!(16&ce)){if(!(64&ce)){te=$[(65535&te)+(I&(1<<ce)-1)];continue n}r.msg="invalid distance code",Le.mode=XT;break e}if(fe=65535&te,ce&=15,L<ce&&(I+=xe[s++]<<L,L+=8,L<ce&&(I+=xe[s++]<<L,L+=8)),fe+=I&(1<<ce)-1,fe>y){r.msg="invalid distance too far back",Le.mode=XT;break e}if(I>>>=ce,L-=ce,ce=d-f,fe>ce){if(ce=fe-ce,ce>w&&Le.sane){r.msg="invalid distance too far back",Le.mode=XT;break e}if(ue=0,ye=A,x===0){if(ue+=_-ce,ce<pe){pe-=ce;do Ae[d++]=A[ue++];while(--ce);ue=d-fe,ye=Ae}}else if(x<ce){if(ue+=_+x-ce,ce-=x,ce<pe){pe-=ce;do Ae[d++]=A[ue++];while(--ce);if(ue=0,x<pe){ce=x,pe-=ce;do Ae[d++]=A[ue++];while(--ce);ue=d-fe,ye=Ae}}}else if(ue+=x-ce,ce<pe){pe-=ce;do Ae[d++]=A[ue++];while(--ce);ue=d-fe,ye=Ae}for(;pe>2;)Ae[d++]=ye[ue++],Ae[d++]=ye[ue++],Ae[d++]=ye[ue++],pe-=3;pe&&(Ae[d++]=ye[ue++],pe>1&&(Ae[d++]=ye[ue++]))}else{ue=d-fe;do Ae[d++]=Ae[ue++],Ae[d++]=Ae[ue++],Ae[d++]=Ae[ue++],pe-=3;while(pe>2);pe&&(Ae[d++]=Ae[ue++],pe>1&&(Ae[d++]=Ae[ue++]))}break}}break}}while(s<l&&d<m);pe=L>>3,s-=pe,L-=pe<<3,I&=(1<<L)-1,r.next_in=s,r.next_out=d,r.avail_in=s<l?l-s+5:5-(s-l),r.avail_out=d<m?m-d+257:257-(d-m),Le.hold=I,Le.bits=L};const JT=15,jPe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),DPe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),LPe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),MPe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Kb=(r,a,s,l,d,f,m,y)=>{const _=y.bits;let w,x,A,I,L,H,$=0,G=0,ne=0,te=0,ce=0,pe=0,fe=0,ue=0,ye=0,xe=0,Ae=null;const Le=new Uint16Array(16),Ht=new Uint16Array(16);let qt,Rt,bn,yn=null;for($=0;$<=JT;$++)Le[$]=0;for(G=0;G<l;G++)Le[a[s+G]]++;for(ce=_,te=JT;te>=1&&Le[te]===0;te--);if(ce>te&&(ce=te),te===0)return d[f++]=20971520,d[f++]=20971520,y.bits=1,0;for(ne=1;ne<te&&Le[ne]===0;ne++);for(ce<ne&&(ce=ne),ue=1,$=1;$<=JT;$++)if(ue<<=1,ue-=Le[$],ue<0)return-1;if(ue>0&&(r===0||te!==1))return-1;for(Ht[1]=0,$=1;$<JT;$++)Ht[$+1]=Ht[$]+Le[$];for(G=0;G<l;G++)a[s+G]!==0&&(m[Ht[a[s+G]]++]=G);if(r===0?(Ae=yn=m,H=20):r===1?(Ae=jPe,yn=DPe,H=257):(Ae=LPe,yn=MPe,H=0),xe=0,G=0,$=ne,L=f,pe=ce,fe=0,A=-1,ye=1<<ce,I=ye-1,r===1&&ye>852||r===2&&ye>592)return 1;for(;;){qt=$-fe,m[G]+1<H?(Rt=0,bn=m[G]):m[G]>=H?(Rt=yn[m[G]-H],bn=Ae[m[G]-H]):(Rt=96,bn=0),w=1<<$-fe,x=1<<pe,ne=x;do x-=w,d[L+(xe>>fe)+x]=qt<<24|Rt<<16|bn|0;while(x!==0);for(w=1<<$-1;xe&w;)w>>=1;if(w!==0?(xe&=w-1,xe+=w):xe=0,G++,--Le[$]==0){if($===te)break;$=a[s+m[G]]}if($>ce&&(xe&I)!==A){for(fe===0&&(fe=ce),L+=ne,pe=$-fe,ue=1<<pe;pe+fe<te&&(ue-=Le[pe+fe],!(ue<=0));)pe++,ue<<=1;if(ye+=1<<pe,r===1&&ye>852||r===2&&ye>592)return 1;A=xe&I,d[A]=ce<<24|pe<<16|L-f|0}}return xe!==0&&(d[L+xe]=$-fe<<24|64<<16|0),y.bits=ce,0};const{Z_FINISH:oX,Z_BLOCK:UPe,Z_TREES:ZT,Z_OK:xp,Z_STREAM_END:FPe,Z_NEED_DICT:VPe,Z_STREAM_ERROR:xc,Z_DATA_ERROR:cX,Z_MEM_ERROR:lX,Z_BUF_ERROR:BPe,Z_DEFLATED:uX}=GT,QT=16180,eC=16190,hd=16191,r2=16192,i2=16194,tC=16199,nC=16200,a2=16206,_i=16209,dX=r=>(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24);function $Pe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Tp=r=>{if(!r)return 1;const a=r.state;return!a||a.strm!==r||a.mode<QT||a.mode>16211?1:0},hX=r=>{if(Tp(r))return xc;const a=r.state;return r.total_in=r.total_out=a.total=0,r.msg="",a.wrap&&(r.adler=1&a.wrap),a.mode=QT,a.last=0,a.havedict=0,a.flags=-1,a.dmax=32768,a.head=null,a.hold=0,a.bits=0,a.lencode=a.lendyn=new Int32Array(852),a.distcode=a.distdyn=new Int32Array(592),a.sane=1,a.back=-1,xp},fX=r=>{if(Tp(r))return xc;const a=r.state;return a.wsize=0,a.whave=0,a.wnext=0,hX(r)},pX=(r,a)=>{let s;if(Tp(r))return xc;const l=r.state;return a<0?(s=0,a=-a):(s=5+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?xc:(l.window!==null&&l.wbits!==a&&(l.window=null),l.wrap=s,l.wbits=a,fX(r))},mX=(r,a)=>{if(!r)return xc;const s=new $Pe;r.state=s,s.strm=r,s.window=null,s.mode=QT;const l=pX(r,a);return l!==xp&&(r.state=null),l};let s2,o2,gX=!0;const WPe=r=>{if(gX){s2=new Int32Array(512),o2=new Int32Array(32);let a=0;for(;a<144;)r.lens[a++]=8;for(;a<256;)r.lens[a++]=9;for(;a<280;)r.lens[a++]=7;for(;a<288;)r.lens[a++]=8;for(Kb(1,r.lens,0,288,s2,0,r.work,{bits:9}),a=0;a<32;)r.lens[a++]=5;Kb(2,r.lens,0,32,o2,0,r.work,{bits:5}),gX=!1}r.lencode=s2,r.lenbits=9,r.distcode=o2,r.distbits=5},vX=(r,a,s,l)=>{let d;const f=r.state;return f.window===null&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new Uint8Array(f.wsize)),l>=f.wsize?(f.window.set(a.subarray(s-f.wsize,s),0),f.wnext=0,f.whave=f.wsize):(d=f.wsize-f.wnext,d>l&&(d=l),f.window.set(a.subarray(s-l,s-l+d),f.wnext),(l-=d)?(f.window.set(a.subarray(s-l,s),0),f.wnext=l,f.whave=f.wsize):(f.wnext+=d,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=d))),0};var GPe=(r,a)=>{let s,l,d,f,m,y,_,w,x,A,I,L,H,$,G,ne,te,ce,pe,fe,ue,ye,xe=0;const Ae=new Uint8Array(4);let Le,Ht;const qt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Tp(r)||!r.output||!r.input&&r.avail_in!==0)return xc;s=r.state,s.mode===hd&&(s.mode=r2),m=r.next_out,d=r.output,_=r.avail_out,f=r.next_in,l=r.input,y=r.avail_in,w=s.hold,x=s.bits,A=y,I=_,ye=xp;e:for(;;)switch(s.mode){case QT:if(s.wrap===0){s.mode=r2;break}for(;x<16;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(2&s.wrap&&w===35615){s.wbits===0&&(s.wbits=15),s.check=0,Ae[0]=255&w,Ae[1]=w>>>8&255,s.check=Ua(s.check,Ae,2,0),w=0,x=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&w)<<8)+(w>>8))%31){r.msg="incorrect header check",s.mode=_i;break}if((15&w)!==uX){r.msg="unknown compression method",s.mode=_i;break}if(w>>>=4,x-=4,ue=8+(15&w),s.wbits===0&&(s.wbits=ue),ue>15||ue>s.wbits){r.msg="invalid window size",s.mode=_i;break}s.dmax=1<<s.wbits,s.flags=0,r.adler=s.check=1,s.mode=512&w?16189:hd,w=0,x=0;break;case 16181:for(;x<16;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(s.flags=w,(255&xa(s))!==uX){r.msg="unknown compression method",s.mode=_i;break}if(57344&xa(s)){r.msg="unknown header flags set",s.mode=_i;break}s.head&&(s.head.text=w>>8&1),512&xa(s)&&4&s.wrap&&(Ae[0]=255&w,Ae[1]=w>>>8&255,s.check=Ua(s.check,Ae,2,0)),w=0,x=0,s.mode=16182;case 16182:for(;x<32;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}s.head&&(s.head.time=w),512&xa(s)&&4&s.wrap&&(Ae[0]=255&w,Ae[1]=w>>>8&255,Ae[2]=w>>>16&255,Ae[3]=w>>>24&255,s.check=Ua(s.check,Ae,4,0)),w=0,x=0,s.mode=16183;case 16183:for(;x<16;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}s.head&&(s.head.xflags=255&w,s.head.os=w>>8),512&xa(s)&&4&s.wrap&&(Ae[0]=255&w,Ae[1]=w>>>8&255,s.check=Ua(s.check,Ae,2,0)),w=0,x=0,s.mode=16184;case 16184:if(1024&xa(s)){for(;x<16;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}s.length=w,s.head&&(s.head.extra_len=w),512&xa(s)&&4&s.wrap&&(Ae[0]=255&w,Ae[1]=w>>>8&255,s.check=Ua(s.check,Ae,2,0)),w=0,x=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&xa(s)&&(L=s.length,L>y&&(L=y),L&&(s.head&&(ue=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(l.subarray(f,f+L),ue)),512&xa(s)&&4&s.wrap&&(s.check=Ua(s.check,l,L,f)),y-=L,f+=L,s.length-=L),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&xa(s)){if(y===0)break e;L=0;do ue=l[f+L++],s.head&&ue&&s.length<65536&&(s.head.name+=String.fromCharCode(ue));while(ue&&L<y);if(512&xa(s)&&4&s.wrap&&(s.check=Ua(s.check,l,L,f)),y-=L,f+=L,ue)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&xa(s)){if(y===0)break e;L=0;do ue=l[f+L++],s.head&&ue&&s.length<65536&&(s.head.comment+=String.fromCharCode(ue));while(ue&&L<y);if(512&xa(s)&&4&s.wrap&&(s.check=Ua(s.check,l,L,f)),y-=L,f+=L,ue)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&xa(s)){for(;x<16;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(4&s.wrap&&w!==(65535&s.check)){r.msg="header crc mismatch",s.mode=_i;break}w=0,x=0}s.head&&(s.head.hcrc=xa(s)>>9&1,s.head.done=!0),r.adler=s.check=0,s.mode=hd;break;case 16189:for(;x<32;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}r.adler=s.check=dX(w),w=0,x=0,s.mode=eC;case eC:if(s.havedict===0)return r.next_out=m,r.avail_out=_,r.next_in=f,r.avail_in=y,s.hold=w,s.bits=x,VPe;r.adler=s.check=1,s.mode=hd;case hd:if(a===UPe||a===ZT)break e;case r2:if(s.last){w>>>=7&x,x-=7&x,s.mode=a2;break}for(;x<3;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}switch(s.last=1&w,w>>>=1,x-=1,3&w){case 0:s.mode=16193;break;case 1:if(WPe(s),s.mode=tC,a===ZT){w>>>=2,x-=2;break e}break;case 2:s.mode=16196;break;case 3:r.msg="invalid block type",s.mode=_i}w>>>=2,x-=2;break;case 16193:for(w>>>=7&x,x-=7&x;x<32;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if((65535&w)!=(w>>>16^65535)){r.msg="invalid stored block lengths",s.mode=_i;break}if(s.length=65535&w,w=0,x=0,s.mode=i2,a===ZT)break e;case i2:s.mode=16195;case 16195:if(L=s.length,L){if(L>y&&(L=y),L>_&&(L=_),L===0)break e;d.set(l.subarray(f,f+L),m),y-=L,f+=L,_-=L,m+=L,s.length-=L;break}s.mode=hd;break;case 16196:for(;x<14;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(s.nlen=257+(31&w),w>>>=5,x-=5,s.ndist=1+(31&w),w>>>=5,x-=5,s.ncode=4+(15&w),w>>>=4,x-=4,s.nlen>286||s.ndist>30){r.msg="too many length or distance symbols",s.mode=_i;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;x<3;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}s.lens[qt[s.have++]]=7&w,w>>>=3,x-=3}for(;s.have<19;)s.lens[qt[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,Le={bits:s.lenbits},ye=Kb(0,s.lens,0,19,s.lencode,0,s.work,Le),s.lenbits=Le.bits,ye){r.msg="invalid code lengths set",s.mode=_i;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;xe=s.lencode[w&(1<<s.lenbits)-1],G=xe>>>24,ne=xe>>>16&255,te=65535&xe,!(G<=x);){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(te<16)w>>>=G,x-=G,s.lens[s.have++]=te;else{if(te===16){for(Ht=G+2;x<Ht;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(w>>>=G,x-=G,s.have===0){r.msg="invalid bit length repeat",s.mode=_i;break}ue=s.lens[s.have-1],L=3+(3&w),w>>>=2,x-=2}else if(te===17){for(Ht=G+3;x<Ht;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}w>>>=G,x-=G,ue=0,L=3+(7&w),w>>>=3,x-=3}else{for(Ht=G+7;x<Ht;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}w>>>=G,x-=G,ue=0,L=11+(127&w),w>>>=7,x-=7}if(s.have+L>s.nlen+s.ndist){r.msg="invalid bit length repeat",s.mode=_i;break}for(;L--;)s.lens[s.have++]=ue}}if(s.mode===_i)break;if(s.lens[256]===0){r.msg="invalid code -- missing end-of-block",s.mode=_i;break}if(s.lenbits=9,Le={bits:s.lenbits},ye=Kb(1,s.lens,0,s.nlen,s.lencode,0,s.work,Le),s.lenbits=Le.bits,ye){r.msg="invalid literal/lengths set",s.mode=_i;break}if(s.distbits=6,s.distcode=s.distdyn,Le={bits:s.distbits},ye=Kb(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,Le),s.distbits=Le.bits,ye){r.msg="invalid distances set",s.mode=_i;break}if(s.mode=tC,a===ZT)break e;case tC:s.mode=nC;case nC:if(y>=6&&_>=258){r.next_out=m,r.avail_out=_,r.next_in=f,r.avail_in=y,s.hold=w,s.bits=x,kPe(r,I),m=r.next_out,d=r.output,_=r.avail_out,f=r.next_in,l=r.input,y=r.avail_in,w=s.hold,x=s.bits,s.mode===hd&&(s.back=-1);break}for(s.back=0;xe=s.lencode[w&(1<<s.lenbits)-1],G=xe>>>24,ne=xe>>>16&255,te=65535&xe,!(G<=x);){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(ne&&!(240&ne)){for(ce=G,pe=ne,fe=te;xe=s.lencode[fe+((w&(1<<ce+pe)-1)>>ce)],G=xe>>>24,ne=xe>>>16&255,te=65535&xe,!(ce+G<=x);){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}w>>>=ce,x-=ce,s.back+=ce}if(w>>>=G,x-=G,s.back+=G,s.length=te,ne===0){s.mode=16205;break}if(32&ne){s.back=-1,s.mode=hd;break}if(64&ne){r.msg="invalid literal/length code",s.mode=_i;break}s.extra=15&ne,s.mode=16201;case 16201:if(s.extra){for(Ht=s.extra;x<Ht;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}s.length+=w&(1<<s.extra)-1,w>>>=s.extra,x-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;xe=s.distcode[w&(1<<s.distbits)-1],G=xe>>>24,ne=xe>>>16&255,te=65535&xe,!(G<=x);){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(!(240&ne)){for(ce=G,pe=ne,fe=te;xe=s.distcode[fe+((w&(1<<ce+pe)-1)>>ce)],G=xe>>>24,ne=xe>>>16&255,te=65535&xe,!(ce+G<=x);){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}w>>>=ce,x-=ce,s.back+=ce}if(w>>>=G,x-=G,s.back+=G,64&ne){r.msg="invalid distance code",s.mode=_i;break}s.offset=te,s.extra=15&ne,s.mode=16203;case 16203:if(s.extra){for(Ht=s.extra;x<Ht;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}s.offset+=w&(1<<s.extra)-1,w>>>=s.extra,x-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){r.msg="invalid distance too far back",s.mode=_i;break}s.mode=16204;case 16204:if(_===0)break e;if(L=I-_,s.offset>L){if(L=s.offset-L,L>s.whave&&s.sane){r.msg="invalid distance too far back",s.mode=_i;break}L>s.wnext?(L-=s.wnext,H=s.wsize-L):H=s.wnext-L,L>s.length&&(L=s.length),$=s.window}else $=d,H=m-s.offset,L=s.length;L>_&&(L=_),_-=L,s.length-=L;do d[m++]=$[H++];while(--L);s.length===0&&(s.mode=nC);break;case 16205:if(_===0)break e;d[m++]=s.length,_--,s.mode=nC;break;case a2:if(s.wrap){for(;x<32;){if(y===0)break e;y--,w|=l[f++]<<x,x+=8}if(I-=_,r.total_out+=I,s.total+=I,4&s.wrap&&I&&(r.adler=s.check=xa(s)?Ua(s.check,d,I,m-I):Fb(s.check,d,I,m-I)),I=_,4&s.wrap&&(xa(s)?w:dX(w))!==s.check){r.msg="incorrect data check",s.mode=_i;break}w=0,x=0}s.mode=16207;case 16207:if(s.wrap&&xa(s)){for(;x<32;){if(y===0)break e;y--,w+=l[f++]<<x,x+=8}if(4&s.wrap&&w!==(4294967295&s.total)){r.msg="incorrect length check",s.mode=_i;break}w=0,x=0}s.mode=16208;case 16208:ye=FPe;break e;case _i:ye=cX;break e;case 16210:return lX;default:return xc}return r.next_out=m,r.avail_out=_,r.next_in=f,r.avail_in=y,s.hold=w,s.bits=x,(s.wsize||I!==r.avail_out&&s.mode<_i&&(s.mode<a2||a!==oX))&&vX(r,r.output,r.next_out,I-r.avail_out),A-=r.avail_in,I-=r.avail_out,r.total_in+=A,r.total_out+=I,s.total+=I,4&s.wrap&&I&&(r.adler=s.check=xa(s)?Ua(s.check,d,I,r.next_out-I):Fb(s.check,d,I,r.next_out-I)),r.data_type=s.bits+(s.last?64:0)+(s.mode===hd?128:0)+(s.mode===tC||s.mode===i2?256:0),(A===0&&I===0||a===oX)&&ye===xp&&(ye=BPe),ye},fd={inflateReset:fX,inflateReset2:pX,inflateResetKeep:hX,inflateInit:r=>mX(r,15),inflateInit2:mX,inflate:GPe,inflateEnd:r=>{if(Tp(r))return xc;let a=r.state;return a.window&&(a.window=null),r.state=null,xp},inflateGetHeader:(r,a)=>{if(Tp(r))return xc;const s=r.state;return 2&s.wrap?(s.head=a,a.done=!1,xp):xc},inflateSetDictionary:(r,a)=>{const s=a.length;let l,d,f;return Tp(r)?xc:(l=r.state,l.wrap!==0&&l.mode!==eC?xc:l.mode===eC&&(d=1,d=Fb(d,a,s,0),d!==l.check)?cX:(f=vX(r,a,s,s),f?(l.mode=16210,lX):(l.havedict=1,xp)))},inflateInfo:"pako inflate (from Nodeca project)"},HPe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const yX=Object.prototype.toString,{Z_NO_FLUSH:zPe,Z_FINISH:KPe,Z_OK:qb,Z_STREAM_END:c2,Z_NEED_DICT:l2,Z_STREAM_ERROR:qPe,Z_DATA_ERROR:_X,Z_MEM_ERROR:YPe}=GT;function rC(r){this.options=KT.assign({chunkSize:65536,windowBits:15,to:""},r||{});const a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),!(a.windowBits>=0&&a.windowBits<16)||r&&r.windowBits||(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&!(15&a.windowBits)&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new aX,this.strm.avail_out=0;let s=fd.inflateInit2(this.strm,a.windowBits);if(s!==qb)throw new Error(bp[s]);if(this.header=new HPe,fd.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=zb.string2buf(a.dictionary):yX.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(s=fd.inflateSetDictionary(this.strm,a.dictionary),s!==qb)))throw new Error(bp[s])}function XPe(r,a){const s=new rC(a);if(s.push(r),s.err)throw s.msg||bp[s.err];return s.result}rC.prototype.push=function(r,a){const s=this.strm,l=this.options.chunkSize,d=this.options.dictionary;let f,m,y;if(this.ended)return!1;for(m=a===~~a?a:a===!0?KPe:zPe,yX.call(r)==="[object ArrayBuffer]"?s.input=new Uint8Array(r):s.input=r,s.next_in=0,s.avail_in=s.input.length;;){for(s.avail_out===0&&(s.output=new Uint8Array(l),s.next_out=0,s.avail_out=l),f=fd.inflate(s,m),f===l2&&d&&(f=fd.inflateSetDictionary(s,d),f===qb?f=fd.inflate(s,m):f===_X&&(f=l2));s.avail_in>0&&f===c2&&s.state.wrap>0&&r[s.next_in]!==0;)fd.inflateReset(s),f=fd.inflate(s,m);switch(f){case qPe:case _X:case l2:case YPe:return this.onEnd(f),this.ended=!0,!1}if(y=s.avail_out,s.next_out&&(s.avail_out===0||f===c2))if(this.options.to==="string"){let _=zb.utf8border(s.output,s.next_out),w=s.next_out-_,x=zb.buf2string(s.output,_);s.next_out=w,s.avail_out=l-w,w&&s.output.set(s.output.subarray(_,_+w),0),this.onData(x)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(f!==qb||y!==0){if(f===c2)return f=fd.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,!0;if(s.avail_in===0)break}}return!0},rC.prototype.onData=function(r){this.chunks.push(r)},rC.prototype.onEnd=function(r){r===qb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=KT.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var JPe={inflate:XPe};const{deflate:ZPe}=PPe,{inflate:QPe}=JPe;var eke=ZPe,tke=QPe,bX=function(r){return r[r.ONE_BYTE=0]="ONE_BYTE",r[r.TWO_BYTE=1]="TWO_BYTE",r}(bX||{});class nke{constructor(){Z(this,"_sequence",0),Z(this,"_startTime",Date.now()),Z(this,"isUseOneByte",!0)}get startTime(){const a=Date.now()-this._startTime;return a<Math.pow(2,16)?a:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(a){const s={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:a};if(a.byteLength>128){const y=new Uint8Array(4);y.set([1,0,0,0]);const _={id:0,length:4,data:y.buffer},w={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[_]};s.commonPacketHeader.extension=1,s.extension=w,s.payload=this.compress(a),s.commonPacketHeader.length=8+(s.extension.length+2)+s.payload.byteLength}else s.commonPacketHeader.length=8+s.payload.byteLength;se("SHOW_DATASTREAM2_LOG")&&F.debug("send data header: ".concat(JSON.stringify(s.commonPacketHeader)));const l=new ArrayBuffer(s.commonPacketHeader.length),d=new Uint8Array(l),f=new DataView(l);let m=0;if(f.setUint16(m,s.commonPacketHeader.extension<<15|s.commonPacketHeader.reserved<<14|s.commonPacketHeader.length,!0),m+=2,f.setUint32(m,s.commonPacketHeader.sequence,!0),m+=4,f.setUint16(m,s.commonStreamHeader,!0),m+=2,s.extension){const y=this.serializeExtension(s.extension);d.set(new Uint8Array(y),m),m+=y.byteLength}if(d.set(new Uint8Array(s.payload),m),m+=s.payload.byteLength,m!==s.commonPacketHeader.length)throw Error("serialize error!");return l}deserialize(a){if(a.byteLength<4)return new ArrayBuffer(0);const s=new DataView(a);let l=0;const d=s.getUint16(l,!0);l+=2;const f={length:16383&d,reserved:(16384&d)>>14,extension:(32768&d)>>15,sequence:s.getUint16(l+2,!0)<<16|s.getUint16(l,!0)};let m,y;if(l+=4,se("SHOW_DATASTREAM2_LOG")&&F.debug("receive data header: ".concat(JSON.stringify(f))),s.getUint16(l,!0),l+=2,f.extension){y=this.deserializeExtension(a.slice(l)),l+=2+y.length,m=a.slice(l);let _=!1;if(y.datas.length>0){const w=y.datas.find(x=>x.id===0);w&&(_=(1&new DataView(w.data).getUint32(0,!0))==1)}m=_?this.decompress(m):m}else m=a.slice(8);return m}serializeExtension(a){const{profile:s,length:l,datas:d}=a,f=new ArrayBuffer(l+2),m=new Uint8Array(f),y=new DataView(f);let _=0;if(y.setUint8(_++,s),y.setUint8(_++,l),d.forEach(w=>{s?(y.setUint8(_++,w.id),y.setUint8(_++,w.length),m.set(new Uint8Array(w.data),_),_+=w.data.byteLength):(y.setUint8(_++,w.id|w.length<<4),m.set(new Uint8Array(w.data),_),_+=w.data.byteLength)}),_!==l+2)throw Error("serialize extension error, is ".concat(_,"!==").concat(l+2));return f}deserializeExtension(a){const s=new DataView(a);let l=0;const d=s.getUint8(l);l++;const f=s.getUint8(l);l++;const m=d===bX.TWO_BYTE,y=[],_=new DataView(a,2);let w=0;for(;w<f;){let x=0,A=0,I=new ArrayBuffer(0);m?(x=_.getUint8(w),w++,A=_.getUint8(w),w++):(x=15&_.getUint8(w),A=_.getUint8(w)>>4,w++),A>0&&(I=_.buffer.slice(w+2,w+2+A),w+=I.byteLength),y.push({id:x,length:A,data:I})}if(w!==f)throw Error("parse error");return{profile:d,length:f,datas:y}}decompress(a){return tke(new Uint8Array(a))}compress(a){return eke(new Uint8Array(a))}}const rke={name:"DataStream",create:(r,a)=>{const s=a?new dIe(r):new hIe(r);return s.useDataStream(new nke),s}};class ike extends lr{constructor(a,s,l){super(),Z(this,"ws",void 0),Z(this,"requestId",1),Z(this,"heartBeatTimer",void 0),Z(this,"joinInfo",void 0),Z(this,"clientId",void 0),Z(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),Z(this,"onClose",d=>{this.emit("close"),this.dispose()}),Z(this,"onMessage",d=>{const f=JSON.parse(d.data);if(!f||f.command!=="serverResponse"||!f.requestId)return f&&f.command==="serverStatus"&&f.serverStatus&&f.serverStatus.command?(this.emit("status",f.serverStatus),void this.emit(f.serverStatus.command,f.serverStatus)):void 0;this.emit("req_".concat(f.requestId),f)}),this.joinInfo=a,this.clientId=s,this.ws=new bb("cross-channel-".concat(this.clientId),l),this.ws.on(Bt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(Bt.CONNECTED,this.onOpen),this.ws.on(Bt.ON_MESSAGE,this.onMessage),this.ws.on(Bt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(a){const s=this.requestId++;return a.requestId=s,a.seq=s,this.ws.sendMessage(a),s}waitStatus(a){return new Ge((s,l)=>{const d=window.setTimeout(()=>{l(new Ee(ie.TIMEOUT,"wait status timeout, status: ".concat(a)))},5e3);this.once(a,f=>{window.clearTimeout(d),f.state&&f.state!==0?l(new Ee(ie.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(a))):s(void 0)}),this.once("dispose",()=>{window.clearTimeout(d),l(new Ee(ie.WS_ABORT))})})}async request(a){if(this.ws.state==="closed")throw new Ee(ie.WS_DISCONNECT);const s=()=>new Ge((m,y)=>{this.ws.once(Bt.CLOSED,()=>y(new Ee(ie.WS_ABORT))),this.ws.once(Bt.CONNECTED,m)});this.ws.state!=="connected"&&await s();const l=this.sendMessage(a),d=new Ge((m,y)=>{const _=()=>{y(new Ee(ie.WS_ABORT))};this.ws.once(Bt.RECONNECTING,_),this.ws.once(Bt.CLOSED,_),this.once("req_".concat(l),m),Ci(3e3).then(()=>{this.removeAllListeners("req_".concat(l)),this.ws.off(Bt.RECONNECTING,_),this.ws.off(Bt.CLOSED,_),y(new Ee(ie.TIMEOUT,"cross channel ws request timeout"))})}),f=await d;if(!f||f.code!==200)throw new Ee(ie.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(f)));return f}async connect(a){this.ws.removeAllListeners(Bt.REQUEST_NEW_URLS),this.ws.on(Bt.REQUEST_NEW_URLS,s=>{s(a)}),await this.ws.init(a)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(a){const s=this.requestId++;return a.requestId=s,this.ws.sendMessage(a),s}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class ake extends lr{set state(a){a!==this._state&&(a!==cs.RELAY_STATE_FAILURE&&(this.errorCode=Lg.RELAY_OK),this.emit("state",a,this.errorCode),this._state=a)}get state(){return this._state}constructor(a,s,l,d,f){super(),Z(this,"joinInfo",void 0),Z(this,"sid",void 0),Z(this,"clientId",void 0),Z(this,"cancelToken",Ka.CancelToken.source()),Z(this,"workerToken",void 0),Z(this,"requestId",0),Z(this,"signal",void 0),Z(this,"prevChannelMediaConfig",void 0),Z(this,"httpRetryConfig",void 0),Z(this,"_resolution",void 0),Z(this,"_state",cs.RELAY_STATE_IDLE),Z(this,"errorCode",Lg.RELAY_OK),Z(this,"onStatus",m=>{F.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(m))),m&&m.command&&(m.command==="onAudioPacketReceived"&&this.emit("event",od.PACKET_RECEIVED_AUDIO_FROM_SRC),m.command==="onVideoPacketReceived"&&this.emit("event",od.PACKET_RECEIVED_VIDEO_FROM_SRC),m.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=Lg.SRC_TOKEN_EXPIRED,this.state=cs.RELAY_STATE_FAILURE),m.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=Lg.DEST_TOKEN_EXPIRED,this.state=cs.RELAY_STATE_FAILURE))}),Z(this,"onReconnect",async()=>{F.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",od.NETWORK_DISCONNECTED),this.state=cs.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(m=>{this.state!==cs.RELAY_STATE_IDLE&&(F.error("auto restart channel media relay failed",m.toString()),this.errorCode=Lg.SERVER_CONNECTION_LOST,this.state=cs.RELAY_STATE_FAILURE)})}),this.joinInfo=a,this.clientId=s,this.sid=sp(),this.signal=new ike(this.joinInfo,this.clientId,l),this.httpRetryConfig=d,this._resolution=f}async startChannelMediaRelay(a){if(this.state!==cs.RELAY_STATE_IDLE)throw new Ee(ie.INVALID_OPERATION);this.state=cs.RELAY_STATE_CONNECTING,await this.connect(),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(a)}catch(s){throw s.data&&s.data.serverResponse&&s.data.serverResponse.command==="SetSourceChannel"?new Ee(ie.CROSS_CHANNEL_FAILED_JOIN_SRC):s.data&&s.data.serverResponse&&s.serverResponse.command==="SetDestChannelStatus"?new Ee(ie.CROSS_CHANNEL_FAILED_JOIN_DEST):s.data&&s.data.serverResponse&&s.serverResponse.command==="StartPacketTransfer"?new Ee(ie.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):s}this.prevChannelMediaConfig=a}async updateChannelMediaRelay(a){if(this.state!==cs.RELAY_STATE_RUNNING)throw new Ee(ie.INVALID_OPERATION);await this.sendUpdateMessage(a),this.prevChannelMediaConfig=a}async setVideoProfile(a){if(this._resolution=a,this.state!==cs.RELAY_STATE_RUNNING)throw new Ee(ie.INVALID_OPERATION);const s=this.genMessage(Ma.SetVideoProfile);await this.signal.request(s),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),F.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=cs.RELAY_STATE_IDLE,this.dispose()}dispose(){F.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Ka.CancelToken.source(),this.state=cs.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const a=await vOe(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=a.workerToken,await this.signal.connect(a.addressList),this.emit("event",od.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(a){const s=this.genMessage(Ma.StopPacketTransfer);await this.signal.request(s),await this.signal.waitStatus("Normal Quit"),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const l=this.genMessage(Ma.SetSdkProfile,a);await this.signal.request(l),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const d=this.genMessage(Ma.SetSourceChannel,a);await this.signal.request(d),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",od.PACKET_JOINED_SRC_CHANNEL),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const f=this.genMessage(Ma.SetSourceUserId,a);await this.signal.request(f),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const m=this.genMessage(Ma.SetDestChannel,a);await this.signal.request(m),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",od.PACKET_JOINED_DEST_CHANNEL),F.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const y=this.genMessage(Ma.StartPacketTransfer,a);await this.signal.request(y),this.emit("event",od.PACKET_SENT_TO_DEST_CHANNEL),this.state=cs.RELAY_STATE_RUNNING,F.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(a){const s=this.genMessage(Ma.UpdateDestChannel,a);await this.signal.request(s),this.emit("event",od.PACKET_UPDATE_DEST_CHANNEL),F.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const a=this.genMessage(Ma.StopPacketTransfer);await this.signal.request(a),F.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(a,s){const l=[],d=[],f=[];this.requestId+=1;const m={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Co,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};m.sdkVersion==="4.24.0"&&(m.sdkVersion="0.0.1");let y=null,_=null;switch(a){case Ma.SetSdkProfile:return m.clientRequest={command:"SetSdkProfile",type:"multi_channel"},m;case Ma.SetSourceChannel:if(_=s&&s.getSrcChannelMediaInfo(),!_)throw new Ee(ie.UNEXPECTED_ERROR,"can not find source config");return m.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_.channelName,token:_.token||this.joinInfo.appId},m;case Ma.SetSourceUserId:if(_=s&&s.getSrcChannelMediaInfo(),!_)throw new Ee(ie.UNEXPECTED_ERROR,"can not find source config");return m.clientRequest={command:"SetSourceUserId",uid:_.uid+""},m;case Ma.SetDestChannel:if(y=s&&s.getDestChannelMediaInfo(),!y)throw new Ee(ie.UNEXPECTED_ERROR,"can not find dest config");return y.forEach(w=>{l.push(w.channelName),d.push(w.uid+""),f.push(w.token||this.joinInfo.appId)}),m.clientRequest={command:"SetDestChannel",channelName:l,uid:d,token:f},m;case Ma.StartPacketTransfer:return m.clientRequest={command:"StartPacketTransfer"},m;case Ma.Reconnect:return m.clientRequest={command:"Reconnect"},m;case Ma.StopPacketTransfer:return m.clientRequest={command:"StopPacketTransfer"},m;case Ma.UpdateDestChannel:if(y=s&&s.getDestChannelMediaInfo(),!y)throw new Ee(ie.UNEXPECTED_ERROR,"can not find dest config");return y.forEach(w=>{l.push(w.channelName),d.push(w.uid+""),f.push(w.token||this.joinInfo.appId)}),m.clientRequest={command:"UpdateDestChannel",channelName:l,uid:d,token:f},m;case Ma.SetVideoProfile:m.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return m}}const ske={name:"ChannelMediaRelay",create:function(r){return new ake(r.joinInfo,r.clientId,r.websocketRetryConfig||Gr,r.httpRetryConfig||Gr,r.resolution)}};function EX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Yb(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?EX(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):EX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class oke extends lr{constructor(a,s,l,d){super(),Z(this,"spec",void 0),Z(this,"token",void 0),Z(this,"websocket",void 0),Z(this,"pingpongTimer",void 0),Z(this,"reconnectMode","retry"),Z(this,"serviceMode",void 0),Z(this,"reqId",0),Z(this,"commandReqId",0),Z(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),Z(this,"handleWebSocketMessage",f=>{if(!f.data)return;const m=JSON.parse(f.data);m.requestId?this.emit("@".concat(m.requestId,"-").concat(m.sid),m):(nt.workerEvent(this.spec.sid,{actionType:"status",serverCode:m.code,workerType:this.serviceMode===sd.TRANSCODE?1:2}),this.emit(gh.PUBLISH_STREAM_STATUS,m))}),this.spec=s,this.token=a,this.serviceMode=d,this.websocket=new bb("live-streaming",l),this.websocket.on(Bt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(Bt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(Bt.REQUEST_NEW_URLS,(f,m)=>{Li(this,gh.REQUEST_NEW_ADDRESS).then(f).catch(m)}),this.websocket.on(Bt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(a){return this.websocket.init(a)}async request(a,s,l,d){this.reqId+=1,a==="request"&&(this.commandReqId+=1);const f=this.commandReqId,m=this.reqId;if(!m||!this.websocket)throw new Ee(ie.UNEXPECTED_ERROR);const y=Yb({command:a,sdkVersion:Co==="4.24.0"?"0.0.1":Co,seq:m,requestId:m,allocate:l,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},s);if(this.websocket.state==="closed")throw new Ee(ie.WS_DISCONNECT);const _=()=>new Ge((I,L)=>{this.websocket.once(Bt.CLOSED,()=>L(new Ee(ie.WS_ABORT))),this.websocket.once(Bt.CONNECTED,I)});this.websocket.state!=="connected"&&await _(),y.clientRequest&&(y.clientRequest.workerToken=this.token);const w=new Ge((I,L)=>{const H=()=>{L(new Ee(ie.WS_ABORT))};this.websocket.once(Bt.RECONNECTING,H),this.websocket.once(Bt.CLOSED,H),this.once("@".concat(m,"-").concat(this.spec.sid),$=>{I($)})});d&&nt.workerEvent(this.spec.sid,Yb(Yb({},d),{},{requestId:f,actionType:"request",payload:JSON.stringify(s.clientRequest),serverCode:0,code:0}));const x=Date.now();this.websocket.sendMessage(y);let A=null;try{A=await w}catch(I){if(this.websocket.state==="closed")throw I;return await _(),await this.request(a,s,l)}return d&&nt.workerEvent(this.spec.sid,Yb(Yb({},d),{},{requestId:f,actionType:"response",payload:JSON.stringify(A.serverResponse),serverCode:A.code,success:A.code===200,responseTime:Date.now()-x})),A.code!==200&&this.handleResponseError(A),A}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const a=Co==="4.24.0"?"0.0.1":Co;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:a,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(a){switch(a.code){case Xr.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void F.warning("live stream response already exists stream");case Xr.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Xr.LIVE_STREAM_RESPONSE_BAD_STREAM:case Xr.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new Ee(ie.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(a.serverResponse.command==="UnpublishStream")return;throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Xr.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new Ee(ie.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const s=new Ee(ie.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(gh.WARNING,s,a.serverResponse.url)}case Xr.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const s=new Ee(ie.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(gh.WARNING,s,a.serverResponse.url)}case Xr.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Xr.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new Ee(ie.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const s=new Ee(ie.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(gh.WARNING,s,a.serverResponse.url)}case Xr.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Xr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Xr.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(a.serverResponse.command==="UnpublishStream")return;throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Xr.ERROR_FAIL_SEND_MESSAGE:if(a.serverResponse.command==="UnpublishStream")return;if(a.serverResponse.command==="UpdateTranscoding"||a.serverResponse.command==="ControlStream")return new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:a.code}).throw();throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Xr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new Ee(ie.LIVE_STREAMING_CDN_ERROR,"",{code:a.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch($x)},6e3)}}function wX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ls(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?wX(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):wX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class cke extends lr{constructor(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gr,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gr;super(),Z(this,"onLiveStreamWarning",void 0),Z(this,"onLiveStreamError",void 0),Z(this,"spec",void 0),Z(this,"retryTimeout",1e4),Z(this,"connection",void 0),Z(this,"httpRetryConfig",void 0),Z(this,"wsRetryConfig",void 0),Z(this,"streamingTasks",new Map),Z(this,"isStartingStreamingTask",!1),Z(this,"taskMutex",new Gi("live-streaming")),Z(this,"cancelToken",Ka.CancelToken.source()),Z(this,"transcodingConfig",void 0),Z(this,"uapResponse",void 0),Z(this,"lastTaskId",1),Z(this,"statusError",new Map),this.spec=a,this.httpRetryConfig=l,this.wsRetryConfig=s}async setTranscodingConfig(a){const s=ls(ls({},YIe),a);s.videoCodecProfile!==66&&s.videoCodecProfile!==77&&s.videoCodecProfile!==100&&(F.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(s.videoCodecProfile," -> 100")),s.videoCodecProfile=100),s.transcodingUsers||(s.transcodingUsers=s.userConfigs),s.transcodingUsers&&(s.transcodingUsers=s.transcodingUsers.map(m=>ls(ls(ls({},qIe),m),{},{zOrder:m.zOrder?m.zOrder+1:1}))),function(m){hr(m.width)||kn(m.width,"config.width",0,1e4),hr(m.height)||kn(m.height,"config.height",0,1e4),hr(m.videoBitrate)||kn(m.videoBitrate,"config.videoBitrate",1,1e6),hr(m.videoFrameRate)||kn(m.videoFrameRate,"config.videoFrameRate"),hr(m.lowLatency)||rl(m.lowLatency,"config.lowLatency"),hr(m.audioSampleRate)||ni(m.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),hr(m.audioBitrate)||kn(m.audioBitrate,"config.audioBitrate",1,128),hr(m.audioChannels)||ni(m.audioChannels,"config.audioChannels",[1,2,3,4,5]),hr(m.videoGop)||kn(m.videoGop,"config.videoGop"),hr(m.videoCodecProfile)||ni(m.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),hr(m.userCount)||kn(m.userCount,"config.userCount",0,17),hr(m.backgroundColor)||kn(m.backgroundColor,"config.backgroundColor",0,16777215),hr(m.userConfigExtraInfo)||Ti(m.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),m.transcodingUsers&&!hr(m.transcodingUsers)&&(ad(m.transcodingUsers,"config.transcodingUsers"),m.transcodingUsers.forEach((y,_)=>{hT(y.uid),hr(y.x)||kn(y.x,"transcodingUser[".concat(_,"].x"),0,1e4),hr(y.y)||kn(y.y,"transcodingUser[".concat(_,"].y"),0,1e4),hr(y.width)||kn(y.width,"transcodingUser[".concat(_,"].width"),0,1e4),hr(y.height)||kn(y.height,"transcodingUser[".concat(_,"].height"),0,1e4),hr(y.zOrder)||kn(y.zOrder-1,"transcodingUser[".concat(_,"].zOrder"),0,100),hr(y.alpha)||kn(y.alpha,"transcodingUser[".concat(_,"].alpha"),0,1,!1)})),hr(m.watermark)||cD(m.watermark,"watermark"),hr(m.backgroundImage)||cD(m.backgroundImage,"backgroundImage"),m.images&&!hr(m.images)&&(ad(m.images,"config.images"),m.images.forEach((y,_)=>{cD(y,"images[".concat(_,"]"))}))}(s);const l=[];s.images&&l.push(...s.images.map(m=>ls(ls(ls({},oD),m),{},{zOrder:255}))),s.backgroundImage&&(l.push(ls(ls(ls({},oD),s.backgroundImage),{},{zOrder:0})),delete s.backgroundImage),s.watermark&&(l.push(ls(ls(ls({},oD),s.watermark),{},{zOrder:255})),delete s.watermark),s.images=l,s.transcodingUsers&&(s.userConfigs=s.transcodingUsers.map(m=>ls({},m)),s.userCount=s.transcodingUsers.length,delete s.transcodingUsers);const d=(s.userConfigs||[]).map(m=>typeof m.uid=="number"?Ge.resolve(m.uid):KK(m.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await Ge.all(d)).forEach((m,y)=>{s.userConfigs&&s.userConfigs[y]&&(s.userConfigs[y].uid=m)}),this.transcodingConfig=s,this.connection)try{var f;const m=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Rs(f=this.streamingTasks).call(f)).map(y=>y.taskId).join("#")});F.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(m.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(m){if(!m.data||!m.data.retry)throw m;m.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(y=>{F.warning("[".concat(this.spec.clientId,"] live streaming receive error"),m.toString(),"try to republish",y.url),this.startLiveStreamingTask(y.url,y.mode,m).then(()=>{F.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(y.url," success"))}).catch(_=>{F.error("[".concat(this.spec.clientId,"] live streaming republish failed"),y.url,_.toString()),this.onLiveStreamError&&this.onLiveStreamError(y.url,_)})})}}async startLiveStreamingTask(a,s,l){if(!this.transcodingConfig&&s===sd.TRANSCODE)throw new Ee(ie.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const d={command:"PublishStream",ts:Date.now(),url:a,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};F.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(a,", mode: ").concat(s));const f=await this.taskMutex.lock();if(!this.connection&&l)return void f();if(this.streamingTasks.get(a)&&!l)return f(),new Ee(ie.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(s))}catch(y){throw f(),y}switch(s){case sd.TRANSCODE:d.transcodingConfig=ls({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(d.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const m=this.lastTaskId++;try{const y=new Ge((w,x)=>{Ci(this.retryTimeout).then(()=>{if(l)return x(l);const A=this.statusError.get(a);return A?(this.statusError.delete(a),x(A)):void 0})}),_=await Ge.race([this.connection.request("request",{clientRequest:d},!0,{url:a,command:"PublishStream",workerType:s===sd.TRANSCODE?1:2,requestByUser:!l,tid:m.toString()}),y]);this.isStartingStreamingTask=!1,F.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_.code)),this.streamingTasks.set(a,{clientRequest:d,mode:s,url:a,taskId:m}),f()}catch(y){if(f(),this.isStartingStreamingTask=!1,!y.data||!y.data.retry||l)throw y;return y.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(a,s,y)):await this.startLiveStreamingTask(a,s,y)}}stopLiveStreamingTask(a){return new Ge((s,l)=>{const d=this.streamingTasks.get(a);if(!d||!this.connection)return new Ee(ie.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const f=d.mode;d.abortTask=()=>{F.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(a),s()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:d.url}},!1,{url:a,command:"UnPublishStream",workerType:f===sd.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(m=>{F.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(m.code)),this.streamingTasks.delete(a),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),s()}).catch(l)})}resetAllTask(){var a;const s=Array.from(Rs(a=this.streamingTasks).call(a));this.terminate();for(const l of s)this.startLiveStreamingTask(l.url,l.mode).catch(d=>{this.onLiveStreamError&&this.onLiveStreamError(l.url,d)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Ka.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(a){if(this.connection)throw new Ee(ie.UNEXPECTED_ERROR,"live streaming connection has already connected");const s=await Li(this,lD.REQUEST_WORKER_MANAGER_LIST,a);return this.uapResponse=s,this.connection=new oke(s.workerToken,this.spec,this.wsRetryConfig,a),this.connection.on(gh.WARNING,(l,d)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(d,l)),this.connection.on(gh.PUBLISH_STREAM_STATUS,l=>this.handlePublishStreamServer(l)),this.connection.on(gh.REQUEST_NEW_ADDRESS,(l,d)=>{if(!this.connection)return d(new Ee(ie.UNEXPECTED_ERROR,"can not get new live streaming address list"));Li(this,lD.REQUEST_WORKER_MANAGER_LIST,a).then(f=>{this.uapResponse=f,l(f.addressList)}).catch(d)}),await this.connection.init(s.addressList),this.connection}handlePublishStreamServer(a){const s=a.serverStatus&&a.serverStatus.url||"empty_url",l=this.streamingTasks.get(s),d=a.reason;switch(a.code){case Xr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const m=new Ee(ie.LIVE_STREAMING_CDN_ERROR,"",{code:a.code});if(l)return F.error(m.toString()),this.onLiveStreamError&&this.onLiveStreamError(s,m);if(!this.isStartingStreamingTask)return;this.statusError.set(s,m)}case Xr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const m=new Ee(ie.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,d);return this.onLiveStreamWarning&&this.onLiveStreamWarning(s,m)}case Xr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Xr.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var f;if(!this.connection)return;this.connection.tryNextAddress();const m=Array.from(Rs(f=this.streamingTasks).call(f));for(const y of m)y.abortTask?y.abortTask():(F.warning("[".concat(this.spec.clientId,"] publish stream status code"),a.code,"try to republish",y.url),this.startLiveStreamingTask(y.url,y.mode,new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:a.code})).then(()=>{F.debug("[".concat(this.spec.clientId,"] republish live stream success"),y.url)}).catch(_=>{F.error(_.toString()),this.onLiveStreamError&&this.onLiveStreamError(y.url,_)}));return}}}hasUrl(a){return this.streamingTasks.has(a)}}const lke={name:"LiveStreaming",create:function(r){return new cke(r.joinInfo,r.websocketRetryConfig||Gr,r.httpRetryConfig||Gr)}};function uke(r){let a=TX();return function(s,l){let d=s.appId;d!==void 0&&(Cn(l,10),fu(l,d));let f=s.cid;f!==void 0&&(Cn(l,16),Cn(l,f));let m=s.cname;m!==void 0&&(Cn(l,26),fu(l,m));let y=s.deviceId;y!==void 0&&(Cn(l,34),fu(l,y));let _=s.elapse;_!==void 0&&(Cn(l,40),Ph(l,_));let w=s.fileSize;w!==void 0&&(Cn(l,48),Ph(l,Qg(w)));let x=s.height;x!==void 0&&(Cn(l,56),Ph(l,Qg(x)));let A=s.jpg;A!==void 0&&(Cn(l,66),Cn(l,A.length),function(Yi,Re){let Fe=ev(Yi,Re.length);Yi.bytes.set(Re,Fe)}(l,A));let I=s.networkType;I!==void 0&&(Cn(l,72),Ph(l,Qg(I)));let L=s.osType;L!==void 0&&(Cn(l,80),Ph(l,Qg(L)));let H=s.requestId;H!==void 0&&(Cn(l,90),fu(l,H));let $=s.sdkVersion;$!==void 0&&(Cn(l,98),fu(l,$));let G=s.sequence;G!==void 0&&(Cn(l,104),Ph(l,Qg(G)));let ne=s.sid;ne!==void 0&&(Cn(l,114),fu(l,ne));let te=s.timestamp;te!==void 0&&(Cn(l,120),Ph(l,te));let ce=s.uid;ce!==void 0&&(Cn(l,128),Cn(l,ce));let pe=s.vid;pe!==void 0&&(Cn(l,136),Cn(l,pe));let fe=s.width;fe!==void 0&&(Cn(l,144),Ph(l,Qg(fe)));let ue=s.service;ue!==void 0&&(Cn(l,152),Cn(l,ue));let ye=s.callbackData;ye!==void 0&&(Cn(l,162),fu(l,ye));let xe=s.jpgEncryption;xe!==void 0&&(Cn(l,168),Cn(l,xe));let Ae=s.requestType;Ae!==void 0&&(Cn(l,176),Cn(l,Ae));let Le=s.scorePorn;Le!==void 0&&(Cn(l,185),p2(l,Le));let Ht=s.scoreSexy;Ht!==void 0&&(Cn(l,193),p2(l,Ht));let qt=s.scoreNeutral;qt!==void 0&&(Cn(l,201),p2(l,qt));let Rt=s.scene;Rt!==void 0&&(Cn(l,208),Cn(l,Rt));let bn=s.ossFilePrefix;bn!==void 0&&(Cn(l,218),fu(l,bn));let yn=s.serviceVendor;if(yn!==void 0)for(let Yi of yn){Cn(l,226);let Re=TX();fke(Yi,Re),Cn(l,Re.limit),vke(l,Re),gke(Re)}}(r,a),function(s){let l=s.bytes,d=s.limit;return l.length===d?l:l.subarray(0,d)}(a)}function dke(r){return function(s){let l={};e:for(;!CX(s);){let d=pu(s);switch(d>>>3){case 0:break e;case 1:l.code=pu(s);break;case 2:l.msg=RX(s,pu(s));break;case 3:{let f=pke(s);l.data=hke(s),s.limit=f;break}default:SX(s,7&d)}}return l}({bytes:a=r,offset:0,limit:a.length});var a}function hke(r){let a={};e:for(;!CX(r);){let s=pu(r);switch(s>>>3){case 0:break e;case 1:a.requestId=RX(r,pu(r));break;case 2:a.requestType=pu(r)>>>0;break;case 3:a.scorePorn=f2(r);break;case 4:a.scoreSexy=f2(r);break;case 5:a.scoreNeutral=f2(r);break;case 6:a.requestScene=pu(r)>>>0;break;case 7:a.scene=pu(r)>>>0;break;default:SX(r,7&s)}}return a}function fke(r,a){let s=r.service;s!==void 0&&(Cn(a,8),Cn(a,s));let l=r.vendor;l!==void 0&&(Cn(a,16),Cn(a,l));let d=r.token;d!==void 0&&(Cn(a,26),fu(a,d));let f=r.callbackUrl;f!==void 0&&(Cn(a,34),fu(a,f))}function pke(r){let a=pu(r),s=r.limit;return r.limit=r.offset+a,s}function SX(r,a){switch(a){case 0:for(;128&NX(r););break;case 2:d2(r,pu(r));break;case 5:d2(r,4);break;case 1:d2(r,8);break;default:throw new Error("Unimplemented type: "+a)}}let mke=new Float32Array(1);new Uint8Array(mke.buffer);let u2=new Float64Array(1),us=new Uint8Array(u2.buffer);function Qg(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}let xX=[];function TX(){const r=xX.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}function gke(r){xX.push(r)}function d2(r,a){if(r.offset+a>r.limit)throw new Error("Skip past limit");r.offset+=a}function CX(r){return r.offset>=r.limit}function ev(r,a){let s=r.bytes,l=r.offset,d=r.limit,f=l+a;if(f>s.length){let m=new Uint8Array(2*f);m.set(s),r.bytes=m}return r.offset=f,f>d&&(r.limit=f),l}function h2(r,a){let s=r.offset;if(s+a>r.limit)throw new Error("Read past limit");return r.offset+=a,s}function RX(r,a){let s=h2(r,a),l=String.fromCharCode,d=r.bytes,f="�",m="";for(let y=0;y<a;y++){let _,w,x,A,I=d[y+s];128&I?(224&I)==192?y+1>=a?m+=f:(_=d[y+s+1],(192&_)!=128?m+=f:(A=(31&I)<<6|63&_,A<128?m+=f:(m+=l(A),y++))):(240&I)==224?y+2>=a?m+=f:(_=d[y+s+1],w=d[y+s+2],(49344&(_|w<<8))!=32896?m+=f:(A=(15&I)<<12|(63&_)<<6|63&w,A<2048||A>=55296&&A<=57343?m+=f:(m+=l(A),y+=2))):(248&I)==240?y+3>=a?m+=f:(_=d[y+s+1],w=d[y+s+2],x=d[y+s+3],(12632256&(_|w<<8|x<<16))!=8421504?m+=f:(A=(7&I)<<18|(63&_)<<12|(63&w)<<6|63&x,A<65536||A>1114111?m+=f:(A-=65536,m+=l(55296+(A>>10),56320+(1023&A)),y+=3))):m+=f:m+=l(I)}return m}function fu(r,a){let s=a.length,l=0;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),l+=y<128?1:y<2048?2:y<65536?3:4}Cn(r,l);let d=ev(r,l),f=r.bytes;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),y<128?f[d++]=y:(y<2048?f[d++]=y>>6&31|192:(y<65536?f[d++]=y>>12&15|224:(f[d++]=y>>18&7|240,f[d++]=y>>12&63|128),f[d++]=y>>6&63|128),f[d++]=63&y|128)}}function vke(r,a){let s=ev(r,a.limit),l=r.bytes,d=a.bytes;for(let f=0,m=a.limit;f<m;f++)l[f+s]=d[f]}function NX(r){return r.bytes[h2(r,1)]}function AX(r,a){let s=ev(r,1);r.bytes[s]=a}function f2(r){let a=h2(r,8),s=r.bytes;return us[0]=s[a++],us[1]=s[a++],us[2]=s[a++],us[3]=s[a++],us[4]=s[a++],us[5]=s[a++],us[6]=s[a++],us[7]=s[a++],u2[0]}function p2(r,a){let s=ev(r,8),l=r.bytes;u2[0]=a,l[s++]=us[0],l[s++]=us[1],l[s++]=us[2],l[s++]=us[3],l[s++]=us[4],l[s++]=us[5],l[s++]=us[6],l[s++]=us[7]}function pu(r){let a,s=0,l=0;do a=NX(r),s<32&&(l|=(127&a)<<s),s+=7;while(128&a);return l}function Cn(r,a){for(a>>>=0;a>=128;)AX(r,127&a|128),a>>>=7;AX(r,a)}function Ph(r,a){let s=a.low>>>0,l=(a.low>>>28|a.high<<4)>>>0,d=a.high>>>24,f=d===0?l===0?s<16384?s<128?1:2:s<1<<21?3:4:l<16384?l<128?5:6:l<1<<21?7:8:d<128?9:10,m=ev(r,f),y=r.bytes;switch(f){case 10:y[m+9]=d>>>7&1;case 9:y[m+8]=f!==9?128|d:127&d;case 8:y[m+7]=f!==8?l>>>21|128:l>>>21&127;case 7:y[m+6]=f!==7?l>>>14|128:l>>>14&127;case 6:y[m+5]=f!==6?l>>>7|128:l>>>7&127;case 5:y[m+4]=f!==5?128|l:127&l;case 4:y[m+3]=f!==4?s>>>21|128:s>>>21&127;case 3:y[m+2]=f!==3?s>>>14|128:s>>>14&127;case 2:y[m+1]=f!==2?s>>>7|128:s>>>7&127;case 1:y[m]=f!==1?128|s:127&s}}function IX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}const yke=new Map([["moderation",1],["supervise",2]]);class _ke extends lr{get connectionState(){return this._connectionState}set connectionState(a){if(this._connectionState===a)return;const s=this._connectionState;this._connectionState=a,this.emit(yi.CONNECTION_STATE_CHANGE,s,a)}get inspectType(){return this._inspectType}set inspectType(a){var s;this._inspectMode=sc(s=a.map(l=>yke.get(l)||0)).call(s,(l,d)=>l+d),this._inspectType=a}get quality(){return this._quality}set quality(a){this._quality=a>1?1:a<.1?.1:a,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(a){super(),Z(this,"name","AgoraRTCVideoContentInspect"),Z(this,"_connectionState",yc.CONNECTING),Z(this,"_innerConnectionState",void 0),Z(this,"sequence",0),Z(this,"inspectStartTime",void 0),Z(this,"workerManagerConnection",void 0),Z(this,"workerConnection",void 0),Z(this,"workerMessageLengthLimit",void 0),Z(this,"inspectIntervalMinimum",void 0),Z(this,"qualityRatio",void 0),Z(this,"_connectInfo",void 0),Z(this,"_cancelTokenSource",Ka.CancelToken.source()),Z(this,"_retryConfig",void 0),Z(this,"wmSequence",0),Z(this,"inspectInterval",void 0),Z(this,"inspectTimer",null),Z(this,"ossFilePrefix",void 0),Z(this,"extraInfo",void 0),Z(this,"_inspectType",void 0),Z(this,"_inspectMode",void 0),Z(this,"_quality",1),Z(this,"qualityTimer",null),Z(this,"_inspectId",void 0),Z(this,"_needWorkUrlOnly",!1),Z(this,"inspectImage",()=>{if(this.connectionState!==yc.CONNECTED)throw new Ee(ie.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===yc.CONNECTED?this.requestToInspectImage():F.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=Mn(5,"inspect-"),this.workerMessageLengthLimit=se("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=se("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=se("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=a.interval,this.ossFilePrefix=a.ossFilePrefix,this.extraInfo=a.extraInfo,this.inspectType=a.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new bb("worker-manager-"+this._inspectId,Gr),this.on(yi.STATE_CHANGE,(s,l)=>{this._innerConnectionState=s,F.debug("[".concat(this._inspectId,"] Inspect operation :").concat(_c[s]," ").concat(l||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new bb("worker-"+this._inspectId,Gr),this.handleWorkerEvents()}async init(a,s){this.emit(yi.STATE_CHANGE,_c.CONNECT_AP),this._connectInfo=a;const l=this._cancelTokenSource.token;return this._retryConfig=s,new Ge((d,f)=>{this.on(yi.CONNECTION_STATE_CHANGE,(m,y)=>{y===yc.CONNECTED&&d()}),this.requestAP(a,l,s).then(m=>{this.connectWorkerManager(m)}).catch(m=>{f(m)})})}async requestAP(a,s,l){const d=se("WEBCS_DOMAIN").map(y=>"https://".concat(y,"/api/v1")),f=await function(y,_,w,x){let{appId:A,areaCode:I,cname:L,sid:H,token:$,uid:G}=_;Wg++;const ne="image_moderation_api",te={service_name:ne,json_body:JSON.stringify({appId:A,areaCode:I,cname:L,command:"allocateEdge",requestId:Wg,seq:Wg,sid:H,token:$,ts:Date.now(),uid:G+""})};let ce,pe,fe=y[0];return il(async()=>{ce=Date.now();const ue=await ll(fe,{data:te,cancelToken:w,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(pe=Date.now()-ce,ue.code!==0){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"image inspect ap error, code"+ue.code,{retry:!0,responseTime:pe});throw F.error(Le.toString()),Le}const ye=JSON.parse(ue.json_body);if(ye.code!==200){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(ye.code,", reason: ").concat(ye.reason),{code:ye.code,responseTime:pe});throw F.error(Le.toString()),Le}if(!ye.servers||!Array.isArray(ye.servers)||ye.servers.length===0){const Le=new Ee(ie.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:ye.code,responseTime:pe});throw F.error(Le.toString()),Le}const xe=se("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Ae=se("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:ye.servers.map(Le=>{let{address:Ht,wss:qt}=Le;if(Ht&&qt)return"wss://".concat(Ht.replace(/\./g,"-"),".").concat(xe,":").concat(Ae||qt)}).filter(Le=>!!Le),workerToken:ye.workerToken,vid:ye.vid,responseTime:pe}},(ue,ye)=>(nt.apworkerEvent(H,{success:!0,sc:200,serviceName:ne,responseDetail:JSON.stringify(ue.addressList),firstSuccess:ye===0,responseTime:pe,serverIp:y[ye%y.length]}),!1),(ue,ye)=>(nt.apworkerEvent(H,{success:!1,sc:ue.data&&ue.data.code||200,serviceName:ne,responseTime:pe,serverIp:y[ye%y.length]}),!!(ue.code!==ie.OPERATION_ABORTED&&ue.code!==ie.UNEXPECTED_RESPONSE||ue.data&&ue.data.retry)&&(fe=y[(ye+1)%y.length],!0)),x)}(d,a,s,l);this.emit(yi.STATE_CHANGE,_c.AP_CONNECTED);const{addressList:m}=f;return this.wmSequence++,m}async connectWorkerManager(a){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=s,this.emit(yi.STATE_CHANGE,_c.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(a,1e4)}async connectWorker(a){await this.workerConnection.init([a])}handleWorkerManagerEvents(){this.workerManagerConnection.on(Bt.CONNECTED,async()=>{this.emit(yi.STATE_CHANGE,_c.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.24.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(Bt.CLOSED,()=>{this._innerConnectionState<_c.GET_WORKER_MANAGER_RESPONSE&&F.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(Bt.FAILED,()=>{this._innerConnectionState<_c.GET_WORKER_MANAGER_RESPONSE&&F.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(Bt.RECONNECTING,()=>{this._innerConnectionState<_c.GET_WORKER_MANAGER_RESPONSE&&F.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(Bt.ON_MESSAGE,async a=>{this.emit(yi.STATE_CHANGE,_c.GET_WORKER_MANAGER_RESPONSE);const s=this.workerManagerConnection.url;this.workerManagerConnection.close();const l=JSON.parse(a.data);if(l.code!==200)throw F.error("[".concat(this._inspectId,"] Unexpected code ").concat(l.code," from worker manager")),new Ee(ie.UNEXPECTED_RESPONSE,"response code of worker is unexpected",l);if(!(l.serverResponse&&l.serverResponse.portWss&&s))throw F.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(l))),new Ee(ie.UNEXPECTED_RESPONSE,"response content of worker is unexpected",l);{const d=se("VIDEO_INSPECT_WORKER_PORT")||l.serverResponse.portWss,f=s.replace(/:\d+\/?$/,":".concat(d));this.emit(yi.STATE_CHANGE,_c.CONNECT_WORKER,f),this._needWorkUrlOnly?this.emit(yi.REQUEST_NEW_WORKER_URL,f):await this.connectWorker(f)}}),this.workerManagerConnection.on(Bt.WILL_RECONNECT,(a,s,l)=>{l(a)}),this.workerManagerConnection.on(Bt.REQUEST_NEW_URLS,(a,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a).catch(s)})}handleWorkerEvents(){this.workerConnection.on(Bt.CONNECTED,async()=>{this.emit(yi.STATE_CHANGE,_c.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=yc.CONNECTED}),this.workerConnection.on(Bt.ON_MESSAGE,async a=>{if(a.data instanceof ArrayBuffer){const l=dke(new Uint8Array(a.data));if(se("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&F.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(l)),l.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(yi.INSPECT_RESULT,void 0,void 0);if(l.data&&l.data.scorePorn&&l.data.scoreSexy&&l.data.scoreNeutral){var s;const d={porn:l.data.scorePorn,sexy:l.data.scoreSexy,neutral:l.data.scoreNeutral},f=sc(s=Object.keys(d)).call(s,(y,_)=>d[y]>d[_]?y:_,"porn"),m=Object.keys(d).find(y=>y===f);this.emit(yi.INSPECT_RESULT,m)}else this.emit(yi.INSPECT_RESULT,void 0,new Ee(ie.UNEXPECTED_RESPONSE,l.code+"","There is an unexpected data on message"))}else this.emit(yi.INSPECT_RESULT,void 0,new Ee(ie.UNEXPECTED_RESPONSE,l.code+"",l.msg))}else F.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(yi.INSPECT_RESULT,void 0,new Ee(ie.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(Bt.CLOSED,()=>{this.connectionState=yc.CLOSED}),this.workerConnection.on(Bt.FAILED,()=>{this.connectionState=yc.CLOSED}),this.workerConnection.on(Bt.RECONNECTING,()=>{this.connectionState=this.connectionState===yc.CONNECTED?yc.RECONNECTING:yc.CONNECTING}),this.workerConnection.on(Bt.WILL_RECONNECT,(a,s,l)=>{a==="recover"&&l(a),l("tryNext")}),this.workerConnection.on(Bt.REQUEST_NEW_URLS,(a,s)=>{this.workerManagerConnection.close(),this.once(yi.REQUEST_NEW_WORKER_URL,l=>{a([l])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(l=>{this.connectWorkerManager(l,!0)}).catch(l=>{s(l)})})}async requestToInspectImage(){this.sequence++;const a=Xs(this,yi.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(a){if(!a.isPlaying)return void this.emit(yi.INSPECT_RESULT,void 0,new Ee(ie.INVALID_OPERATION,"Only the track being played can be inspected"));const l=await this.generateRequestData(a,s);this.workerConnection.sendMessage(l,!0,!0)}else this.emit(yi.INSPECT_RESULT,void 0,new Ee(ie.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(a,s){let{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_}=s;const w=Date.now(),x=await a.getCurrentFrameImage("image/jpeg",this.quality),A=await u9(x,l,d),I=this.sequence+"-"+f+"-"+_+"-"+w+"-"+Mn(12,""),L={appId:l,cid:f,cname:d,deviceId:"",elapse:(H=Number(w-this.inspectStartTime),{low:H|=0,high:H>>31,unsigned:H>=0}),fileSize:A.byteLength,jpgEncryption:2,height:x.height,width:x.width,jpg:A,networkType:6,osType:7,requestId:I,sdkVersion:"4.24.0",sequence:this.sequence,sid:y,timestamp:Uq(w),uid:_,vid:m,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var H;this.extraInfo===void 0&&delete L.callbackData,this.ossFilePrefix===void 0&&delete L.ossFilePrefix;const $=uke(L);if($.byteLength<this.workerMessageLengthLimit){if(se("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const G=function(ne){for(var te=1;te<arguments.length;te++){var ce=arguments[te]!=null?arguments[te]:{};te%2?IX(Object(ce),!0).forEach(function(pe){Z(ne,pe,ce[pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(ce)):IX(Object(ce)).forEach(function(pe){Object.defineProperty(ne,pe,Object.getOwnPropertyDescriptor(ce,pe))})}return ne}({},L);delete G.jpg,F.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(G))}return $}{const G=this.quality*this.qualityRatio;return this.quality=G,await this.generateRequestData(a,{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Ka.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=yc.CLOSED,this.emit(yi.STATE_CHANGE,_c.CLOSED)}}const bke={name:"ContentInspect",create:function(r){let{config:a}=r;return function(s){if(!s)throw new Ee(ie.INVALID_PARAMS,"inspectConfig is necessary.");if(!s.inspectType||!Array.isArray(s.inspectType))throw new Ee(ie.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const l=[...new Set(s.inspectType)];l.forEach(d=>{var f;if(!Ve(f=["supervise","moderation"]).call(f,d))throw new Ee(ie.INVALID_PARAMS,"".concat(d," is not a valid inspect type."))}),s.inspectType=l}if(s&&s.extraInfo&&s.extraInfo.length>1024)throw new Ee(ie.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(a),new _ke(a)}};var OX=o(it.Object.getOwnPropertySymbols),Eke=Tn,wke=xO.indexOf,Ske=hS,m2=Y([].indexOf),PX=!!m2&&1/m2([1],1,-0)<0;Eke({target:"Array",proto:!0,forced:PX||!Ske("indexOf")},{indexOf:function(r){var a=arguments.length>1?arguments[1]:void 0;return PX?m2(this,r,a)||0:wke(this,r,a)}});var xke=ac("Array","indexOf"),Tke=T,Cke=xke,g2=Array.prototype,Rke=function(r){var a=r.indexOf;return r===g2||Tke(g2,r)&&a===g2.indexOf?Cke:a},kX=o(Rke);function Nke(r,a){if(r==null)return{};var s,l,d=function(m,y){if(m==null)return{};var _={};for(var w in m)if({}.hasOwnProperty.call(m,w)){if(kX(y).call(y,w)!==-1)continue;_[w]=m[w]}return _}(r,a);if(OX){var f=OX(r);for(l=0;l<f.length;l++)s=f[l],kX(a).call(a,s)===-1&&{}.propertyIsEnumerable.call(r,s)&&(d[s]=r[s])}return d}let jX=class{get localCapabilities(){return ir(this._localCapabilities)}get rtpCapabilities(){return ir(this._rtpCapabilities)}get candidates(){return ir(this._candidates)}get iceParameters(){return ir(this._iceParameters)}get dtlsParameters(){return ir(this._dtlsParameters)}constructor(r){Z(this,"sessionDesc",void 0),Z(this,"_localCapabilities",void 0),Z(this,"_rtpCapabilities",void 0),Z(this,"_candidates",void 0),Z(this,"_iceParameters",void 0),Z(this,"_dtlsParameters",void 0),Z(this,"setup",void 0),Z(this,"currentMidIndex",void 0),Z(this,"cname","o/i14u9pJrxRKAsu"),Z(this,"firefoxSsrcMidMap",new Map),r=ir(r);const{remoteIceParameters:a,remoteDtlsParameters:s,candidates:l,remoteRTPCapabilities:d,localCapabilities:f,direction:m,setup:y,videoCodec:_,audioCodec:w}=r;let x;this.setup=y,x=m===La.RECEIVE_ONLY?ss(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):ss(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=d,this._candidates=l,this._iceParameters=a,this._dtlsParameters=s,this._localCapabilities=f;const A=m===La.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,I=m===La.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,L=m===La.RECEIVE_ONLY?d.send.videoCodecs:xb(Ye.VIDEO,A,I,_),H=m===La.RECEIVE_ONLY?d.send.audioCodecs:xb(Ye.AUDIO,A,I,w);for(const $ of x.mediaDescriptions)$.attributes.iceUfrag=a.iceUfrag,$.attributes.icePwd=a.icePwd,$.attributes.fingerprints=s.fingerprints,$.attributes.candidates=l,$.attributes.setup=this.setup,$.media.mediaType==="application"&&($.attributes.sctpPort="5000"),$.media.mediaType==="video"&&($.media.fmts=L.map(G=>G.payloadType.toString(10)),$.attributes.payloads=L,$.attributes.extmaps=A.videoExtensions),$.media.mediaType==="audio"&&($.media.fmts=H.map(G=>G.payloadType.toString(10)),$.attributes.payloads=H,$.attributes.extmaps=A.audioExtensions,$g($));this.sessionDesc=x,this.currentMidIndex=x.mediaDescriptions.length-1}toString(){return ph(this.sessionDesc)}hasMid(r){return Array.isArray(r)?r.every(a=>this.hasMid(a)):this.sessionDesc.mediaDescriptions.some(a=>a.attributes.mid===r)}send(r,a,s,l,d){s=s.replace(/ /g,"-");const{ssrcs:f,ssrcGroups:m}=Sb(a,this.cname,se("SYNC_GROUP")?s:void 0),y=this.findPreloadMediaDesc(f);if(y){if(dr()&&this.firefoxSsrcMidMap.set(f[0].ssrcId,y.attributes.mid),d&&(d.twcc||d.remb)){const _=this.sessionDesc.mediaDescriptions.indexOf(y);return this.sessionDesc.mediaDescriptions[_]=this.mungSendMediaDesc(y,d),{mid:y.attributes.mid,needExchangeSDP:!0}}return{mid:y.attributes.mid,needExchangeSDP:!1}}{const _=this.findAvailableMediaIndex(r,f,l);let w;return _===-1?(w=this.createOrRecycleSendMedia(r,f,m,"sendonly",l,d),this.updateBundleMids()):(w=ir(this.sessionDesc.mediaDescriptions[_]),w.attributes.direction="sendonly",w.attributes.ssrcs=f,w.attributes.ssrcGroups=m,this.sessionDesc.mediaDescriptions[_]=this.mungSendMediaDesc(w,d)),dr()&&this.firefoxSsrcMidMap.set(f[0].ssrcId,w.attributes.mid),{needExchangeSDP:!0,mid:w.attributes.mid}}}stopSending(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>s.attributes.mid&&r.indexOf(s.attributes.mid)!==-1);if(a.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");a.forEach(s=>{s.attributes.ssrcs=[]}),this.updateBundleMids()}receive(r,a,s){const l=[];return r.forEach(d=>{const f=d._mediaStreamTrack.kind,m=this.findAvailableRecvMediaIndex(f);let y,_=!1;m===-1?(_=!0,y=this.createOrRecycleRecvMedia(d,[],"recvonly",a,s),this.updateBundleMids()):(y=ir(this.sessionDesc.mediaDescriptions[m]),y.attributes.direction="recvonly"),l.push({mid:y.attributes.mid,needCreateTransceiver:_})}),l}stopReceiving(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>r.indexOf(s.attributes.mid)!==-1);if(a.length!==r.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");a.forEach(s=>{s.media.port="0",s.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(r){const{foundation:a,protocol:s,address:l,port:d,type:f,relatedAddress:m,relatedPort:y,priority:_}=new RTCIceCandidate(r),w={foundation:a??"",componentId:"1",transport:s??"",priority:_?_+"":"",connectionAddress:l??"",port:d?d+"":"",type:f?f+"":"",relAddr:m??"",relPort:y?y+"":"",extension:{}};this.candidates.some(x=>x.priority===w.priority&&x.connectionAddress===w.connectionAddress&&x.port===w.port)||(this._candidates.push(w),this.sessionDesc.mediaDescriptions.forEach(x=>{x.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(r,a,s,l,d){const f=r._mediaStreamTrack.kind,m=this.rtpCapabilities.recv,y=xb(f,m,this.localCapabilities.send,f===Ye.AUDIO?d:l),_=f===Ye.VIDEO?m.videoExtensions:m.audioExtensions,w="".concat(++this.currentMidIndex);let x={media:{mediaType:f,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:y.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:y,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(w)}};x=this.mungRecvMediaDsec(x,r);const A=this.findFirstClosedMedia(f);if(A){const I=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[I]=x}else this.sessionDesc.mediaDescriptions.push(x);return x}muteRemote(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>Ve(r).call(r,s.attributes.mid||""));if(a.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");a.forEach(s=>{s.attributes.direction="inactive"})}unmuteRemote(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>Ve(r).call(r,s.attributes.mid||""));if(a.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");a.forEach(s=>{s.attributes.direction="recvonly"})}findAvailableMediaIndex(r,a,s){return this.sessionDesc.mediaDescriptions.findIndex(l=>{const d=l.media.mediaType===r&&l.media.port!=="0"&&(l.attributes.direction==="sendonly"||l.attributes.direction==="sendrecv")&&l.attributes.ssrcs.length===0;if(dr()){if(d){const f=this.firefoxSsrcMidMap.get(a[0].ssrcId);return!(f||l.attributes.mid!=="0"&&l.attributes.mid!=="1")||!(!f||f!==l.attributes.mid)}return!1}return d&&l.attributes.mid===s})}findAvailableRecvMediaIndex(r){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const s=a.media.mediaType===r&&a.media.port!=="0"&&(a.attributes.direction==="recvonly"||a.attributes.direction==="sendrecv");return a.attributes.mid!=="0"&&a.attributes.mid!=="1"&&s})}predictReceivingMids(r){const a=[];for(let s=0;s<r;s++)a.push((this.currentMidIndex+s+1).toString(10));return a}restartICE(r){r=ir(r),this._iceParameters=r,this.sessionDesc.mediaDescriptions.forEach(a=>{a.attributes.iceUfrag=r.iceUfrag,a.attributes.icePwd=r.icePwd})}createOrRecycleSendMedia(r,a,s,l,d,f){const m=this.rtpCapabilities.send,y=r===Ye.VIDEO?m.videoCodecs:m.audioCodecs,_=r===Ye.VIDEO?m.videoExtensions:m.audioExtensions;dr()&&(d="".concat(++this.currentMidIndex));let w={media:{mediaType:r,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:y.map(A=>A.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:s,rtcpFeedbackWildcards:[],payloads:y,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:l,rtcpMux:!0,rtcpRsize:!0,mid:d}};w=this.mungSendMediaDesc(w,f);const x=this.findFirstClosedMedia(r);if(x){const A=this.sessionDesc.mediaDescriptions.indexOf(x);this.sessionDesc.mediaDescriptions[A]=w}else this.sessionDesc.mediaDescriptions.push(w);return w}mungRecvMediaDsec(r,a,s){const l=ir(r);return mD(l),Bg(l,a),gD(l,a),RK(l),bT(l,s,this.localCapabilities.send),l}mungSendMediaDesc(r,a){const s=ir(r);return bT(s,a,this.localCapabilities.recv),$g(s),s}updateRecvMedia(r,a){const s=this.sessionDesc.mediaDescriptions.findIndex(l=>l.attributes.mid===r);if(s!==-1){const l=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],a);this.sessionDesc.mediaDescriptions[s]=l}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(r=>r.media.port!=="0").map(r=>r.attributes.mid)}findPreloadMediaDesc(r){return this.sessionDesc.mediaDescriptions.find(a=>{var s;return((s=a.attributes)===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId)===r[0].ssrcId})}findFirstClosedMedia(r){return this.sessionDesc.mediaDescriptions.find(a=>dr()?a.media.port==="0"&&a.media.mediaType===r:a.media.port==="0")}};const Ake=["sdp"];var Gn;function DX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function kh(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?DX(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):DX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let LX=(Gn=class mv extends lK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var a,s;return(a=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&a!==void 0?a:null}get localCodecs(){return[]}set isInRestartIce(a){this._isInRestartIce=a}get isInRestartIce(){return this._isInRestartIce}constructor(a,s,l){super(a,s),Z(this,"direction",void 0),Z(this,"name",void 0),Z(this,"store",void 0),Z(this,"spec",void 0),Z(this,"peerConnection",void 0),Z(this,"initialOffer",void 0),Z(this,"transport",void 0),Z(this,"statsFilter",void 0),Z(this,"localCandidateCount",0),Z(this,"_isInRestartIce",!1),Z(this,"mutex",void 0),Z(this,"onLocalCandidate",void 0),Z(this,"remoteSDP",void 0),Z(this,"pendingCandidates",[]),Z(this,"localCapabilities",void 0),Z(this,"isReady",!1),Z(this,"restartCnt",0),Z(this,"curTurnServerIndex",0),this.store=s,this.spec=a,this.mutex=new Gi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(mv.resolvePCConfiguration(a,s.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=l??La.SEND_ONLY,this.name=this.direction===La.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=xj(this.peerConnection,se("STATS_UPDATE_INTERVAL"),void 0,dr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(a){try{const s=await AK();if(this.localCapabilities=ET(s),a){const{sdp:l}=a,d=Nke(a,Ake),f=function(){const x={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},A=wb(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},L={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},H={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(bc(A,x,"videoExtensions",I,L,H),bc(A,x,"videoCodecs",I,L,H),bc(A,x,"audioExtensions",I,L,H),bc(A,x,"audioCodecs",I,L,H),se("RAISE_H264_BASELINE_PRIORITY")){const $=H.videoCodecs.findIndex(G=>G.rtpMap&&G.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&G.fmtp&&G.fmtp.parameters["profile-level-id"]==="42001f");if($!==-1){const G=H.videoCodecs.findIndex(ne=>ne.rtpMap&&ne.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(G<$){F.debug("raising H264 baseline profile priority");const ne=H.videoCodecs[$];H.videoCodecs.splice($,1),H.videoCodecs.splice(G,0,ne)}G!==-1&&se("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(ne=>!(ne.rtpMap&&ne.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&ne.fmtp&&ne.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:I,recv:L,sendrecv:H}}({},{},l);this.remoteSDP=new jX({remoteIceParameters:d.iceParameters,remoteDtlsParameters:d.dtlsParameters,candidates:[],remoteRTPCapabilities:f,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const m=await this.peerConnection.createAnswer();if(!m.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const y=bh(m.sdp);await this.peerConnection.setLocalDescription(m);const _=await IK({},{},m.sdp);this.localCapabilities=ET(_);const w=this.peerConnection.getTransceivers()[0];return w!=null&&w.receiver&&w.receiver.transport&&this.tryBindTransportEvents(w.receiver.transport),kh(kh({},y),{},{sdp:m.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const l=await this.peerConnection.createOffer();if(!l.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const d=bh(l.sdp);return this.initialOffer=l,kh(kh({},d),{},{sdp:l.sdp})}}catch(s){throw new Se(ie.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:s,iceParameters:l,dtlsParameters:d}=a,f=await IK({},{},s);this.remoteSDP=new jX({remoteIceParameters:l,remoteDtlsParameters:d,candidates:[],remoteRTPCapabilities:f,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const m=this.peerConnection.getTransceivers()[0];m!=null&&m.sender&&m.sender.transport&&this.tryBindTransportEvents(m.sender.transport)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async addRemoteCandidate(a){try{a&&this.pendingCandidates.push(a),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(s=>{this.peerConnection.addIceCandidate(s)}),this.pendingCandidates=[])}catch(s){throw new Se(ie.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(s.toString()))}}send(a,s,l){var d=this;return To(function*(){const f=yield ln(d.mutex.lock("From P2PConnection.send"));try{if(!d.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const m=[],y=d.remoteSDP.receive(a,s,l);a.forEach((G,ne)=>{if(y[ne].needCreateTransceiver){const te=d.peerConnection.addTransceiver(G._mediaStreamTrack,{direction:"sendonly"});m.push(te),G._updateRtpTransceiver(te)}else{const te=d.peerConnection.getTransceivers().find(ce=>ce.mid===y[ne].mid);if(!te)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(y[ne].mid));m.push(te),G._updateRtpTransceiver(te)}}),dr()&&se("SIMULCAST")===!0&&(yield ln(d.applySimulcastForFirefox(m,a)));const _=y.map(G=>G.mid),w=yield ln(d.peerConnection.createOffer()),x=d.mungSendOfferSDP(w.sdp,a,_),A=ss(x),I=_.map(G=>{const ne=A.mediaDescriptions.find(te=>te.attributes.mid===G);if(!ne)throw new Error("Cannot extract ssrc from mediaDescription.");return xK(ne,se("USE_PUB_RTX"))}),L=m.map((G,ne)=>{const te=_[ne];return{localSSRC:I[ne],id:te}});yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x}));try{yield L}catch(G){const ne=d.remoteSDP.toString();throw yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(d.peerConnection.setRemoteDescription({type:"answer",sdp:ne})),yield ln(d.stopSending(_,!0)),G}yield ln(d.applySimulcastEncodings(m,a)),yield ln(d.applySendEncodings(m,a));const H=d.remoteSDP.toString(),$=d.logSDPExchange(x,"offer","local","send");return $==null||$(H),yield ln(d.setRemoteDescription({type:"answer",sdp:H})),m.map((G,ne)=>{const te=_[ne];return{localSSRC:I[ne],id:te}})}catch(m){throw m instanceof Se?m:new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(m.toString()))}finally{f()}})()}async stopSending(a,s){const l=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const d=this.peerConnection.getTransceivers().filter(_=>a.indexOf(_.mid)!==-1);if(d.length!==a.length)throw new Error("Transceivers' length (".concat(d.length,") doesn't match mids' length (").concat(a.length,") when trying to call P2PConnection.stopSending."));d.map(_=>{var w;_.direction="inactive",(w=_.stop)===null||w===void 0||w.call(_)});const f=await this.peerConnection.createOffer(),m=this.logSDPExchange(f.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(a);const y=this.remoteSDP.toString();m==null||m(y),await this.setRemoteDescription({type:"answer",sdp:y})}catch(d){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(d.toString()))}finally{l&&l()}}async receive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(a,s,l,d);if(m){const _=this.remoteSDP.toString(),w=this.logSDPExchange(_,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:_});const x=await this.peerConnection.createAnswer(),A=this.mungReceiveAnswerSDP(x.sdp,f,a);w==null||w(A||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:A}),F.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," by exchanging SDP."))}else F.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," no need to exchange SDP."));const y=this.peerConnection.getTransceivers().find(_=>_.mid===f);if(!y||y.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:y.receiver.track,mid:y.mid,transceiver:y}}catch(f){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async mockReceive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(a,s,l,d);if(m){const y=this.remoteSDP.toString(),_=this.logSDPExchange(y,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:y});const w=await this.peerConnection.createAnswer(),x=this.mungReceiveAnswerSDP(w.sdp,f,a);_==null||_(x||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:x}),F.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," by exchanging SDP."))}else F.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," no need to exchange SDP."))}catch(f){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async restartICE(a){try{if(this.store.p2pTransport===op.Auto&&(this.store.p2pTransport=op.SdRtn,un().supportPCSetConfiguration&&this.peerConnection.setConfiguration(mv.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,un().supportPCSetConfiguration&&this.peerConnection.setConfiguration(mv.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!a){this.restartCnt++,this.isReady=!1;const s=await this.peerConnection.createOffer({iceRestart:!0});if(!s.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:l}=bh(s.sdp);return this.store.descriptionStart(),this.direction===La.SEND_ONLY&&await this.peerConnection.setLocalDescription(s),l}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(a),this.store.descriptionStart(),this.direction===La.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const s=await this.peerConnection.createAnswer();if(!s.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:l}=bh(s.sdp);return await this.peerConnection.setLocalDescription(s),l}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}close(){var a;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const l=await this.peerConnection.createOffer(),d=this.mungSendOfferSDP(l.sdp,[s],[a]);this.remoteSDP.updateRecvMedia(a,s);const f=this.remoteSDP.toString(),m=this.logSDPExchange(d,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:d}),m==null||m(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new Se(ie.EXCHANGE_SDP_FAILED,l.toString())}}async updateSendParameters(a,s){const l=this.peerConnection.getTransceivers().filter(d=>d.mid===a);l.length===1&&(this.isVP8Simulcast(s)?dr()||await this.applySimulcastEncodings(l,[s]):await this.applySendEncodings(l,[s]))}setStatsRemoteVideoIsReady(a,s){this.statsFilter.setVideoIsReady2(a,s)}async replaceTrack(a,s){const l=this.peerConnection.getTransceivers().find(d=>d.mid===s);l&&await l.sender.replaceTrack(a._mediaStreamTrack)}async getSelectedCandidatePair(){const a=this.peerConnection.getReceivers();if(a.length>0&&a[0].transport&&a[0].transport.iceTransport&&a[0].transport.iceTransport.getSelectedCandidatePair&&a[0].transport.iceTransport.getSelectedCandidatePair()){const s=a[0].transport.iceTransport,{local:l,remote:d}=s.getSelectedCandidatePair();return{local:kh(kh({},nu),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port}),remote:kh(kh({},nu),{},{candidateType:d.type,protocol:d.protocol,address:d.address,port:d.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a,s;Ve(a=["connected","completed"]).call(a,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(s=this.onICEConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=a=>{if(a.candidate){var s;a.candidate.candidate&&((s=this.onLocalCandidate)===null||s===void 0||s.call(this,a.candidate.toJSON())),this.localCandidateCount+=1}else F.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const d={iceServers:[]};var f;return a.iceServers?d.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(ob(a.turnServer.servers)?d.iceServers=a.turnServer.servers:(d.iceServers&&d.iceServers.push(...mv.turnServerConfigToIceServers(a.turnServer.servers,s,l)),se("USE_TURN_SERVER_OF_GATEWAY")&&d.iceServers&&a.turnServer.serversFromGateway&&d.iceServers.push(...mv.turnServerConfigToIceServers(a.turnServer.serversFromGateway,s,l)),Ve(f=[op.Relay,op.SdRtn]).call(f,s)&&(d.iceTransportPolicy="relay"),se("FORCE_TURN_TCP")?d.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(m=>{m.forceturn&&(d.iceTransportPolicy="relay")}))),se("ENABLE_ENCODED_TRANSFORM")&&un().supportWebRTCEncodedTransform&&(d.encodedInsertableStreams=!0),F.debug("P2PConnection p2pTransport is ".concat(s)),d}static turnServerConfigToIceServers(a,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const d=[],f=a.filter(y=>y.tcpport);F.debug("P2PConnection turnServers is ".concat(f,", current index is ").concat(l));const m=f.length>l?f[l]:f[0];switch(s){case op.SdRtn:const y=a.filter(w=>{var x;return Ve(x=w.username).call(x,"glb:")&&w.turnServerURL==w.turnServerURL}),_=y.length>l?y[l]:y[0];_&&(d.push({username:_.username,credential:_.password,credentialType:"password",urls:"turn:".concat(yh(_.turnServerURL),":").concat(_.tcpport,"?transport=udp")}),d.push({username:_.username,credential:_.password,credentialType:"password",urls:"turns:".concat(yh(_.turnServerURL),":").concat(_.tcpport,"?transport=tcp")}));break;case op.Relay:m&&(d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(m.turnServerURL,":").concat(m.tcpport,"?transport=udp")}),d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(yh(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}));break;default:m&&(d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(m.turnServerURL,":").concat(m.tcpport,"?transport=udp")}),d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(yh(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}),d.push({username:m.username,credential:m.password,credentialType:"password",urls:"stun:".concat(m.turnServerURL,":").concat(m.tcpport)}))}return d}tryBindTransportEvents(a){if(a){this.transport=a,a.onstatechange=()=>{var l;a!=null&&a.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,a.state))},a.onerror=l=>{var d;(d=this.onDTLSTransportError)===null||d===void 0||d.call(this,"error"in l?l.error:l)};const s=a.iceTransport;s&&(s.onstatechange=()=>{const l=a==null?void 0:a.iceTransport.state;var d;l&&((d=this.onICETransportStateChange)===null||d===void 0||d.call(this,l))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:l,remote:d}=s.getSelectedCandidatePair()||{};if(l&&d){const f=l.address+":"+l.port,m=d.address+":"+d.port;F.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(mp(f)),", remote ").concat(JSON.stringify(mp(m))))}}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(a,s){var l;if(s||(s=this.peerConnection.getSenders().find(x=>x.track===a._mediaStreamTrack)),!s)return F.warn("[".concat(a.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(a))return F.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!un().supportSetRtpSenderParameters)return F.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const d={},f={};switch(a._optimizationMode){case"motion":d.degradationPreference="maintain-framerate";break;case"detail":d.degradationPreference="maintain-resolution";break;default:d.degradationPreference="balanced"}if(a._encoderConfig){var m;const{bitrateMax:x,frameRate:A,scaleResolutionDownBy:I}=a._encoderConfig;x&&(f.maxBitrate=1e3*x),Ve(m=a._hints).call(m,jn.LOW_STREAM)&&(A&&(f.maxFramerate=Os(A)),I&&I>=1&&(f.scaleResolutionDownBy=I))}if(se("DSCP_TYPE")&&id()){var y;const x=se("DSCP_TYPE");Ve(y=["very-low","low","medium","high"]).call(y,x)&&(f.networkPriority=x)}const _=s.getParameters(),w=(l=_.encodings)===null||l===void 0?void 0:l[0];dr()&&!w&&(d.encodings=[f]),w&&Object.assign(w,f),Object.assign(_,d),F.debug("[".concat(a.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(_.encodings))),await s.setParameters(_)}async applySendEncodings(a,s){try{if(!un().supportSetRtpSenderParameters||a.length!==s.length)return;for(let l=0;l<a.length;l++){const d=a[l],f=s[l];f instanceof Wn&&!this.isVP8Simulcast(f)&&await this.updateRtpSenderEncodings(f,d.sender)}}catch{F.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(a,s,l){const d=ss(a);return s.forEach((f,m)=>{const y=l[m],_=d.mediaDescriptions.find(w=>w.attributes.mid===y);_&&(Bg(_,f),NK(_,f,this.store.codec))}),ph(d)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,s,l)=>{var d;(d=this.onFirstVideoDecoded)===null||d===void 0||d.call(this,a,s,l)},this.statsFilter.onSelectedLocalCandidateChanged=(a,s)=>{var l;(l=this.onSelectedLocalCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,s)=>{var l;(l=this.onSelectedRemoteCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onFirstVideoDecodedTimeout=a=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(a,s){if(a.length===s.length)for(let _=0;_<a.length;_++){var l,d,f,m,y;const w=a[_],x=s[_];if(x instanceof Wn&&!Ve(l=x._hints).call(l,jn.LOW_STREAM)&&(d=x._encoderConfig)!==null&&d!==void 0&&d.bitrateMax&&((f=x._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(m=x._scalabilityMode)!==null&&m!==void 0&&m.numSpatialLayers&&((y=x._scalabilityMode)===null||y===void 0?void 0:y.numSpatialLayers)>1&&this.store.codec==="vp8"){const A={},I={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};A.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const L=w.sender.getParameters();await w.sender.setParameters(Object.assign(L,A))}}}async applySimulcastEncodings(a,s){if(!dr()&&a.length===s.length)for(let l=0;l<a.length;l++){const d=s[l];if(d instanceof Wn&&this.isVP8Simulcast(d)){const f=a[l],m={},y={high:1e3*(d._encoderConfig.bitrateMax-50),medium:5e4};m.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:y.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:y.medium,scaleResolutionDownBy:4}];const _=f.sender.getParameters();await f.sender.setParameters(Object.assign(_,m))}}}isVP8Simulcast(a){var s,l,d,f,m;return!!(a instanceof Wn&&se("SIMULCAST")&&this.store.codec==="vp8"&&!Ve(s=a._hints).call(s,jn.LOW_STREAM)&&(l=a._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((d=a._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(f=a._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=a._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1)}logSDPExchange(a,s,l,d){if(se("SDP_LOGGING"))return F.upload("[".concat(this.store.clientId,"] exchanging ").concat(l," ").concat(s," SDP during P2PConnection.").concat(d,`
`),a),s==="offer"?f=>{this.logSDPExchange(f,"answer",l==="local"?"remote":"local",d)}:void 0}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(m=>{m.direction="inactive"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.muteRemote(a);const f=this.remoteSDP.toString();d==null||d(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async m=>{m.direction="sendonly"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.unmuteRemote(a);const f=this.remoteSDP.toString();d==null||d(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}async getRemoteSSRC(a,s){var l;if(s=s??((l=this.currentRemoteDescription)===null||l===void 0?void 0:l.sdp)){var d;const f=(d=ss(s).mediaDescriptions.find(m=>m.attributes.mid===a))===null||d===void 0?void 0:d.attributes.ssrcs;return f==null?void 0:f[0].ssrcId}}async setRemoteDescription(a){var s;await this.peerConnection.setRemoteDescription(a),Ve(s=["connected","completed"]).call(s,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(a,s,l){const d=ss(a),f=d.mediaDescriptions.find(m=>m.attributes.mid===s);return f&&l===Ye.AUDIO&&f.media.mediaType==="audio"&&$g(f),ph(d)}},tt(Gn.prototype,"establish",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"establish"),Gn.prototype),tt(Gn.prototype,"connect",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"connect"),Gn.prototype),tt(Gn.prototype,"receive",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"receive"),Gn.prototype),tt(Gn.prototype,"mockReceive",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"mockReceive"),Gn.prototype),tt(Gn.prototype,"stopReceiving",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"stopReceiving"),Gn.prototype),tt(Gn.prototype,"restartICE",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"restartICE"),Gn.prototype),tt(Gn.prototype,"close",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"close"),Gn.prototype),tt(Gn.prototype,"updateEncoderConfig",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"updateEncoderConfig"),Gn.prototype),tt(Gn.prototype,"updateSendParameters",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"updateSendParameters"),Gn.prototype),tt(Gn.prototype,"replaceTrack",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"replaceTrack"),Gn.prototype),tt(Gn.prototype,"muteLocal",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"muteLocal"),Gn.prototype),tt(Gn.prototype,"unmuteLocal",[Tc],Object.getOwnPropertyDescriptor(Gn.prototype,"unmuteLocal"),Gn.prototype),Gn);function Tc(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("From P2PConnection.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}let hl=function(r){return r.SEND_ONLY="SEND_ONLY",r.RECEIVE_ONLY="RECEIVE_ONLY",r}({});var MX,UX,FX,VX,BX,$X,WX,GX,HX,zX,KX,ar;function qX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function iC(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?qX(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):qX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let Ike=(MX=fl(hl.SEND_ONLY),UX=fl(hl.SEND_ONLY),FX=fl(),VX=fl(hl.RECEIVE_ONLY),BX=fl(hl.RECEIVE_ONLY),$X=fl(hl.RECEIVE_ONLY),WX=fl(hl.RECEIVE_ONLY),GX=fl(hl.RECEIVE_ONLY),HX=fl(hl.RECEIVE_ONLY),zX=fl(),KX=fl(hl.RECEIVE_ONLY),ar=class extends lr{get state(){return this._state}set state(r){const a=this._state;this._state=r,this.emit(ut.StateChange,a,this._state)}constructor(r,a){super(),Z(this,"isPlanB",!1),Z(this,"store",void 0),Z(this,"statsUploader",void 0),Z(this,"sendConnection",void 0),Z(this,"recvConnection",void 0),Z(this,"localTrackMap",new Map),Z(this,"remoteUserMap",new Map),Z(this,"localDataChannels",[]),Z(this,"pendingLocalTracks",[]),Z(this,"pendingRemoteTracks",[]),Z(this,"statsCollector",void 0),Z(this,"dtlsFailedCount",0),Z(this,"sendMutex",void 0),Z(this,"recvMutex",void 0),Z(this,"_state",wn.Disconnected),Z(this,"_restartStates",["disconnected","failed"]),Z(this,"reconnectInterval",void 0),Z(this,"uploadUnplinkStarted",!1),Z(this,"uploadDownlinkStarted",!1),Z(this,"uplinkStateUploadInterval",void 0),Z(this,"downlinkStatsUploadInterval",void 0),Z(this,"handleMuteLocalTrack",async(s,l,d)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==wn.Connected)return void d(new Se(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const _=this.filterTobeMutedTracks(s);if(_.length===0)return void l();const w=_.find(L=>L[0]==="videoLowTrack");w&&w[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(_.map(L=>{let[,{id:H}]=L;return H}));let x=!1;var m,y;s.trackMediaType==="video"?x=!((m=this.localTrackMap.get(ke.LocalAudioTrack))===null||m===void 0||!m.track._muted):x=((y=this.localTrackMap.get(ke.LocalVideoTrack))===null||y===void 0?void 0:y.id)===void 0;const A=this.createMuteMessage(_);await Ln(this,ut.RequestMuteLocal,A);const I=s.trackMediaType==="video"?vh.MUTE_LOCAL_VIDEO:vh.MUTE_LOCAL_AUDIO;await Ln(this,ut.RequestP2PMuteLocal,{action:I,message:A,isMuteAll:x}),l()}catch(_){d(_)}finally{f()}}),Z(this,"handleUnmuteLocalTrack",async(s,l,d)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==wn.Connected)return void d(new Se(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const m=this.filterTobeUnmutedTracks(s);if(m.length===0)return void l();await this.sendConnection.unmuteLocal(m.map(w=>{let[,{id:x}]=w;return x}));const y=this.createUnmuteMessage(m),_=s.trackMediaType==="video"?vh.UNMUTE_LOCAL_VIDEO:vh.UNMUTE_LOCAL_AUDIO;await Ln(this,ut.RequestP2PMuteLocal,{action:_,message:y}),l()}catch(m){d(m)}finally{f()}}),Z(this,"handleUpdateVideoEncoder",async(s,l,d,f)=>{let m;typeof f=="boolean"&&f||(m=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const _=this.localTrackMap.get(ke.LocalVideoTrack);if(!this.sendConnection||!_||_.track!==s||this.state!==wn.Connected)return void l();const{id:w,track:x}=_;w&&(await this.sendConnection.updateSendParameters(w,x),await this.sendConnection.updateEncoderConfig(w,x),this.emit(ut.UpdateVideoEncoder,x)),l()}catch(_){d(_)}finally{var y;(y=m)===null||y===void 0||y()}}),Z(this,"handleUpdateVideoSendParameters",async(s,l,d)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const m=this.localTrackMap.get(ke.LocalVideoTrack);if(!this.sendConnection||!m||m.track!==s||this.state!==wn.Connected)return void l();const{id:y,track:_}=m;y&&await this.sendConnection.updateSendParameters(y,_),l()}catch(m){d(m)}finally{f()}}),Z(this,"handleReplaceTrack",async(s,l,d,f)=>{let m;F.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof f=="boolean"&&f||(m=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var y;const w=Array.from(this.localTrackMap.entries()).find(x=>{let[,{track:A}]=x;return s===A});if(!this.sendConnection||!w||w[1].id===void 0||this.state!==wn.Connected)return void l();if(await((y=this.sendConnection)===null||y===void 0?void 0:y.replaceTrack(s,w[1].id)),w[0]===ke.LocalVideoTrack&&un().supportDualStreamEncoding){const x=this.localTrackMap.get(ke.LocalVideoLowTrack);if(x){const A=s._mediaStreamTrack.clone();x.track._originMediaStreamTrack.stop(),x.track._mediaStreamTrack=A,x.track._originMediaStreamTrack=A,await new Ge((I,L)=>{this.handleReplaceTrack(x.track,I,L,!0)})}}l()}catch(w){d(w)}finally{var _;(_=m)===null||_===void 0||_()}}),Z(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),Z(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),Z(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),Z(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=r,this.statsCollector=a,this.statsCollector.addP2PChannel(this),this.statsUploader=new dq(r),this.bindStatsUploaderEvents(),this.sendMutex=new Gi("P2PChannel2-send-mutex",r.clientId),this.recvMutex=new Gi("P2PChannel2-recv-mutex",r.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(s=>{s&&(s.iceConnectionState!=="disconnected"&&s.iceConnectionState!=="failed"||this.handleDisconnect(s.direction))})},se("ICE_RESTART_INTERVAL"))}async startP2PConnection(r,a){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(r){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(r,a){let s;try{if(a){this.recvConnection&&(F.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),s=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new LX(r,this.store,La.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const l=await this.recvConnection.establish(a);return{iceParameters:l.iceParameters,dtlsParameters:l.dtlsParameters,sdp:l.sdp}}{this.state=wn.New,this.sendConnection&&(F.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),s=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new LX(r,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const l=await this.sendConnection.establish();return{iceParameters:l.iceParameters,dtlsParameters:l.dtlsParameters,sdp:l.sdp}}}finally{s&&s()}}async p2pConnect(r){if(!this.sendConnection)throw new Se(ie.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(r),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=wn.Connected}async addRemoteCandidate(r,a){if(a===La.RECEIVE_ONLY){if(!this.sendConnection)throw new Se(ie.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(r)}else{if(!this.recvConnection)throw new Se(ie.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(r)}}publish(r,a,s){var l=this;return To(function*(){const d=yield ln(l.sendMutex.lock("From P2PChannel.publish"));try{if(!l.sendConnection||l.state!==wn.Connected){l.throwIfTrackTypeNotMatch(r);const w=r.filter(x=>l.pendingLocalTracks.indexOf(x)===-1);return void(l.pendingLocalTracks=l.pendingLocalTracks.concat(w))}l.store.pubId=l.store.pubId+1,qi.markPublishStart(l.store.clientId,l.store.pubId);const f=l.filterTobePublishedTracks(r,a,s);if(f.length===0)return void(yield ln(l.tryToUnmuteAudio(r)));f.forEach(w=>{let{track:x,type:A}=w;const I=Date.now();l.store.publish(x.getTrackId(),A===ke.LocalAudioTrack?"audio":"video",I)}),l.bindLocalTrackEvents(f);const m=yield ln(l.sendConnection.send(f.map(w=>{let{track:x}=w;return x}),l.store.codec,l.store.audioCodec)),y=(yield ln(m.next())).value,_=l.createGatewayPublishMessage(f,y);try{yield _}catch(w){throw m.throw(w),(w==null?void 0:w.code)===ie.WS_ABORT&&f.forEach(x=>{let{track:A}=x;l.pendingLocalTracks.indexOf(A)===-1&&l.pendingLocalTracks.push(A)}),l.unbindLocalTrackEvents(f),w}yield ln(m.next()),f.forEach(w=>{let{type:x}=w;l.statsCollector.addLocalStats(x)}),l.statsUploader.startUploadOutboundStats(),l.assignLocalTracks(f,y),f.forEach(w=>{let{track:x,type:A}=w;const I=Date.now();l.store.publish(x.getTrackId(),A===ke.LocalAudioTrack?"audio":"video",void 0,I)}),l.startUploadUplinkState()}finally{d()}})()}async unpublish(r){if(!this.sendConnection||this.state!==wn.Connected)return void(r.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(d=>!Ve(r).call(r,d)));const a=this.filterTobeUnpublishedTracks(r);if(a.length===0)return;const s=a.find(d=>d[0]==="videoLowTrack");s&&s[1].track.close();const l=this.createGatewayUnpublishMessage(a);if(await this.sendConnection.stopSending(a.map(d=>{let[,{id:f}]=d;return f})),this.withdrawLocalTracks(a),this.unbindLocalTrackEvents(a.map(d=>{let[f,{track:m}]=d;return{type:f,track:m}})),a.forEach(d=>{let[f]=d;this.statsCollector.removeLocalStats(f)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===wn.Connected)return s&&s[1].track.close(),l;r.forEach(d=>{const f=this.pendingLocalTracks.indexOf(d);f!==-1&&this.pendingLocalTracks.splice(f,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const r=()=>{const a=[],s=[];Array.from(this.localTrackMap.entries()).forEach(l=>{let[d,{track:f,ssrcs:m}]=l;const y={stream_type:wOe(f,d),ssrcs:m};f._muted||!f._enabled?a.push(y):s.push(y)}),a.length>0&&a.forEach(l=>{Ln(this,ut.RequestMuteLocal,[l])}),s.length>0&&s.forEach(l=>{Ln(this,ut.RequestUnmuteLocal,[l])})};r(),this.uplinkStateUploadInterval=window.setInterval(()=>{r()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(r){return To(function*(){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(F.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Li(this,ut.RequestRePublish,this.pendingLocalTracks),this.emit(ut.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(r,a,s,l){var d;if(!this.recvConnection)throw new Se(ie.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((d=this.remoteUserMap.get(r))!==null&&d!==void 0&&d.has(a))return;const{track:f,mid:m,transceiver:y}=await this.recvConnection.receive(a,[{ssrcId:s}],String(r.uid),l);a===Ye.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(f):(r._audioTrack=new kg(f,r.uid,r._uintid,this.store),F.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),y&&r._audioTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoSSRC=s,r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(f):(r._videoTrack=new Pg(f,r.uid,r._uintid,this.store),F.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId()))),y&&r._videoTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(r,r._videoTrack));const _=this.remoteUserMap.get(r);_?_.set(a,m):this.remoteUserMap.set(r,new Map([[a,m]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const w=this.pendingRemoteTracks.findIndex(x=>{let{user:A,kind:I}=x;return A.uid===r.uid&&a===I});w!==-1&&(this.pendingRemoteTracks.splice(w,1),this.emit(ut.MediaReconnectEnd,r.uid))}async mockSubscribe(r,a,s,l){if(!this.recvConnection)throw new Se(ie.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(a,[{ssrcId:s}],String(r.uid),l)}async unsubscribe(r,a,s){const l=this.pendingRemoteTracks.filter(f=>{let{user:m,kind:y}=f;return a!==void 0?m.uid===r.uid&&a===y:m.uid===r.uid});if(l.forEach(f=>{const m=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(m,1)}),this.recvConnection||s||l.forEach(f=>{let{kind:m}=f;var y;if(m===Ye.AUDIO)(y=r._audioTrack)===null||y===void 0||y._destroy(),r._audioTrack=void 0;else if(m===Ye.VIDEO){var _;(_=r._videoTrack)===null||_===void 0||_._destroy(),r._videoTrack=void 0}}),!this.recvConnection)return;const d=this.filterTobeUnSubscribedTracks(r,a);d.length!==0&&(await this.recvConnection.stopReceiving(d.map(f=>{let[,{id:m}]=f;return m})),this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),d.forEach(f=>{let[m,{kind:y}]=f;var _,w;if(y===Ye.VIDEO&&m._videoSSRC&&((_=this.recvConnection)===null||_===void 0||_.setStatsRemoteVideoIsReady(m._videoSSRC,!1)),y===Ye.VIDEO)this.unbindRemoteTrackEvents(m._videoTrack),s||((w=m._videoTrack)===null||w===void 0||w._destroy(),m._videoTrack=void 0);else if(y===Ye.AUDIO){var x;this.unbindRemoteTrackEvents(m._audioTrack),!s&&((x=m._audioTrack)===null||x===void 0||x._destroy(),m._audioTrack=void 0)}}),d.forEach(f=>{let[,{kind:m}]=f;Ln(this,ut.RequestP2PMuteRemote,m)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const r=()=>Array.from(this.remoteUserMap.entries()).forEach(a=>{let[,s]=a;[Ye.VIDEO,Ye.AUDIO].forEach(l=>{s.has(l)?Ln(this,ut.RequestP2PUnmuteRemote,l):Ln(this,ut.RequestP2PMuteRemote,l)})});r(),this.downlinkStatsUploadInterval=window.setInterval(()=>{r()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(r){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(r){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(r){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(r){throw new Se(ie.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(r,a){if(!this.recvConnection)return;const s=this.remoteUserMap.get(r);if(!s)return void F.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(r.uid,"."));if(!s.get(a))return void F.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."));const l=a===Ye.VIDEO?r._videoSSRC:r._audioSSRC;l!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(r,a){return this.unmuteRemoteNoLock(r,a)}async unmuteRemoteNoLock(r,a){if(!this.recvConnection)return;const s=this.remoteUserMap.get(r);if(!s)return void F.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(r.uid,"."));s.get(a)||F.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."))}getAllTracks(r){const a=this.localTrackMap.get(ke.LocalAudioTrack);if((a==null?void 0:a.track)instanceof Yr){const s=a.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[d]=l;return d!==ke.LocalAudioTrack}).filter(l=>{let[d]=l;return!(r&&d===ke.LocalVideoLowTrack)}).map(l=>{let[,{track:d}]=l;return d}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[l]=s;return!(r&&l===ke.LocalVideoLowTrack)}).map(s=>{let[,{track:l}]=s;return l})}reportPublishEvent(r,a,s,l,d){if(r){const m=this.localTrackMap.get(ke.LocalAudioTrack),y=l?this.localTrackMap.get(ke.LocalVideoLowTrack):this.localTrackMap.get(ke.LocalVideoTrack);nt.publish(this.store.sessionId,{eventElapse:qi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.track.getTrackLabel(),videoName:y==null?void 0:y.track.getTrackLabel(),screenshare:(y==null?void 0:y.track._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}else{var f;s||(s=[]);const m=s.find(_=>_ instanceof vr),y=l?(f=this.localTrackMap.get(ke.LocalVideoTrack))===null||f===void 0?void 0:f.track:s.find(_=>_ instanceof Wn);nt.publish(this.store.sessionId,{eventElapse:qi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.getTrackLabel(),videoName:y==null?void 0:y.getTrackLabel(),screenshare:(y==null?void 0:y._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}}reportSubscribeEvent(r,a,s,l){const d=l===Ye.VIDEO?s._videoSSRC:s._audioSSRC;d&&nt.subscribe(this.store.sessionId,{succ:r,ec:a,video:l===Ye.VIDEO,audio:l===Ye.AUDIO,peerid:s.uid,subscribeRequestid:l===Ye.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:qi.measureFromSubscribeStart(this.store.clientId,d)})}reset(){F.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Gi("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Gi("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const r=this.localTrackMap.get(ke.LocalAudioTrack);if((r==null?void 0:r.track)instanceof Yr){if(r.track.trackList.length>0){const a=r.track;r.track.trackList.forEach(s=>{a.removeAudioTrack(s)})}r.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=wn.Disconnected}getStats(r){var a,s;return r?(s=this.recvConnection)===null||s===void 0?void 0:s.getStats():(a=this.sendConnection)===null||a===void 0?void 0:a.getStats()}getRemoteVideoIsReady(r){var a;return((a=this.recvConnection)===null||a===void 0?void 0:a.getRemoteVideoIsReady(r))||!1}getLocalAudioVolume(){const r=this.localTrackMap.get(ke.LocalAudioTrack);if(r)return r.track.getVolumeLevel()}getLocalVideoSize(){const r=this.localTrackMap.get(ke.LocalVideoTrack);if(r)return{width:r.track.videoWidth||0,height:r.track.videoHeight||0}}getEncoderConfig(r){const a=this.localTrackMap.get(r);return a&&a.track instanceof Wn||a&&a.track instanceof vr?a.track._encoderConfig:void 0}getLocalMedia(r){return this.localTrackMap.get(r)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}async hasRemoteMediaWithLock(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}getRemoteMedia(r){var a;const s=Array.from(os(a=this.remoteUserMap).call(a)).find(l=>l.uid===r);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let r=Array.from(this.remoteUserMap.entries()).map(s=>{let[l]=s;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const a=this.localTrackMap.get(ke.LocalAudioTrack);return a&&r.push({level:100*a.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=Yf(r).call(r,(s,l)=>s.level-l.level),r}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(F.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=wn.Reconnecting,se("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a]=r;var s;a._videoTrack&&a._videoTrack._player&&((s=a._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),a._videoTrack._player.isKeepLastFrame=!0,a._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(r=>{var a;let[s,{track:l}]=r;switch(s){case ke.LocalVideoTrack:Ve(a=l._hints).call(a,jn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case ke.LocalAudioTrack:l instanceof Yr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case ke.LocalVideoLowTrack:}}),this.emit(ut.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;Array.from(os(s).call(s)).forEach(l=>{this.setPendingRemoteMedia(a,l)}),this.emit(ut.MediaReconnectStart,a.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),F.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(r,a){for(const s of this.pendingRemoteTracks){const{user:l,kind:d}=s;if((r instanceof xh?r.uid:r)===l.uid&&a===d)return!0}return!1}setPendingRemoteMedia(r,a){this.hasPendingRemoteMedia(r,a)||this.pendingRemoteTracks.push({user:r,kind:a})}async restartICE(r,a){let s,l;if(r===La.SEND_ONLY){if(!this.sendConnection)throw new Se(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");s=await this.sendMutex.lock("From P2PChannel.restartICE"),l=this.sendConnection}else{if(!this.recvConnection)throw new Se(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");s=await this.recvMutex.lock("From P2PChannel.restartICE"),l=this.recvConnection}try{if(a){const d=await l.restartICE(a);return l.isInRestartIce=!1,d}{const d=await l.restartICE();if(d){const f=await Li(this,ut.RequestP2PRestartICE,{direction:La.RECEIVE_ONLY,iceParameter:d});await l.restartICE(f),l.isInRestartIce=!1}}}finally{s()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const r=this.sendConnection.getStats(),a=this.localTrackMap.get(ke.LocalVideoTrack),s=this.localTrackMap.get(ke.LocalAudioTrack),l=r.videoSend.find(L=>{var H;return L.ssrc===(a==null||(H=a.ssrcs)===null||H===void 0?void 0:H[0].ssrcId)}),d=r.audioSend.find(L=>{var H;return L.ssrc===(s==null||(H=s.ssrcs)===null||H===void 0?void 0:H[0].ssrcId)});if(!l||!d)return 1;const f=Xs(this,ut.NeedSignalRTT),m=l?l.rttMs:void 0,y=d?d.rttMs:void 0,_=m&&y?(m+y)/2:m||y,w=(_&&f?(_+f)/2:_||f)||0,x=100*r.sendPacketLossRate*.7/50+.3*w/1500,A=x<.17?1:x<.36?2:x<.59?3:x<.1?4:5,I=a==null?void 0:a.track;if(I&&I._encoderConfig&&I._hints.indexOf(jn.SCREEN_TRACK)===-1){const L=I._encoderConfig.bitrateMax,H=r.bitrate.actualEncoded;if(L&&H){const $=(1e3*L-H)/(1e3*L);return tK[$<.15?0:$<.3?1:$<.45?2:$<.6?3:4][A]}}return A}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const r=this.recvConnection.getStats();let a=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[l]=s;const d=l._audioSSRC,f=l._videoSSRC,m=r.audioRecv.find(H=>H.ssrc===d),y=r.videoRecv.find(H=>H.ssrc===f);if(!m&&!y)return void(a+=1);const _=Xs(this,ut.NeedSignalRTT),w=r.rtt,x=(w&&_?(w+_)/2:w||_)||0,A=m?m.jitterMs:void 0,I=r.recvPacketLossRate;let L=.7*I*100/50+.3*x/1500;A&&(L=.6*I*100/50+.2*x/1500+.2*A/400),a+=L<.1?1:L<.17?2:L<.36?3:L<.59?4:5}),this.remoteUserMap.size>0?Math.round(a/this.remoteUserMap.size):a}async muteLocalTrack(r){return new Ge((a,s)=>{this.handleMuteLocalTrack(r,a,s)})}filterTobePublishedTracks(r,a,s){const l=[],d=un(),f=this.getAllTracks();r=_g(r=r.filter(_=>f.indexOf(_)===-1));let m=!1,y=!1;for(const _ of r){if(_ instanceof Wn&&(this.localTrackMap.has(ke.LocalVideoTrack)||m?new Se(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:_,type:ke.LocalVideoTrack}),m=!0),a)){const w=this.getLowVideoTrack(_,s);l.push({track:w,type:ke.LocalVideoLowTrack})}if(_ instanceof vr){const w=this.localTrackMap.get(ke.LocalAudioTrack);if(w){if(!(w.track instanceof Yr))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");w.track.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0)}else if(y){const x=l.find(A=>{let{type:I}=A;return I===ke.LocalAudioTrack});if(!(x.track instanceof Yr))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");x.track.addAudioTrack(_)}else{if(!d.webAudioMediaStreamDest||_ instanceof Yr||_._bypassWebAudio)l.push({track:_,type:ke.LocalAudioTrack});else{const x=new Yr;x.addAudioTrack(_),l.push({track:x,type:ke.LocalAudioTrack})}y=!0}}}return l}filterTobeUnpublishedTracks(r){const a=[],s=this.getAllTracks();r=_g(r=r.filter(l=>s.indexOf(l)!==-1));for(const l of r){if(l instanceof vr){const d=this.localTrackMap.get(ke.LocalAudioTrack);if(!d)continue;d.track instanceof Yr?(d.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),d.track.trackList.length===0&&(a.push([ke.LocalAudioTrack,d]),d.track.close())):a.push([ke.LocalAudioTrack,d])}if(l instanceof Wn){const d=this.localTrackMap.get(ke.LocalVideoTrack);if(!d)continue;a.push([ke.LocalVideoTrack,d]);const f=this.localTrackMap.get(ke.LocalVideoLowTrack);f&&a.push([ke.LocalVideoLowTrack,f])}}return a}bindLocalTrackEvents(r){r.forEach(a=>{let{track:s,type:l}=a;switch(l){case ke.LocalVideoTrack:s.addListener(Ze.GET_STATS,this.handleGetLocalVideoStats),s.addListener(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ze.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(Ze.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.addListener(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ke.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case ke.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(r,a){r instanceof Yr?r.trackList.forEach(s=>{s.addListener(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Ze.GET_STATS,this.handleGetLocalAudioStats),s.addListener(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.addListener(Ze.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),a||r.addListener(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(r){r||(r=Array.from(this.localTrackMap.entries()).map(a=>{let[s,{track:l}]=a;return{track:l,type:s}})),r.forEach(a=>{let{track:s,type:l}=a;switch(l){case ke.LocalVideoTrack:s.off(Ze.GET_STATS,this.handleGetLocalVideoStats),s.off(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(Ze.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(Ze.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.off(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case ke.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case ke.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(r){r instanceof Yr?r.trackList.forEach(a=>{a.off(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(Ze.GET_STATS,this.handleGetLocalAudioStats),a.off(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.off(Ze.GET_STATS,this.handleGetLocalAudioStats),r.off(Ze.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Ze.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Ze.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Ze.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Ze.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(r,a){a instanceof Pg&&a.addListener(Ze.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(r))}),a instanceof kg&&a.addListener(Ze.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(r))})}unbindRemoteTrackEvents(r){r&&r.removeAllListeners(Ze.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;s.has(Ye.AUDIO)&&this.unbindRemoteTrackEvents(a._audioTrack),s.has(Ye.VIDEO)&&this.unbindRemoteTrackEvents(a._videoTrack)})}createGatewayPublishMessage(r,a){return r.map((s,l)=>{var d;let f,{track:m,type:y}=s;switch(y){case ke.LocalAudioTrack:f=xn.Audio;break;case ke.LocalVideoTrack:f=Ve(d=m._hints).call(d,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalVideoLowTrack:f=xn.Low}return{kind:y===ke.LocalAudioTrack?Ye.AUDIO:Ye.VIDEO,stream_type:f,mid:a[l].id,ssrcs:a[l].localSSRC,isMuted:m.muted||!m.enabled}})}createGatewayUnpublishMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case ke.LocalVideoTrack:l=Ve(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}assignLocalTracks(r,a){r.forEach((s,l)=>{let{track:d,type:f}=s;this.localTrackMap.set(f,{track:d,id:a[l].id,ssrcs:a[l].localSSRC})})}withdrawLocalTracks(r){r.forEach(a=>{let[s]=a;this.localTrackMap.delete(s)})}bindConnectionEvents(r){r.onConnectionStateChange=async a=>{var s;F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(r.name,".onConnectionStateChange(").concat(a,")")),this.emit(ut.PeerConnectionStateChange,a),a!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),a==="connected"&&(r.isInRestartIce=!1),Ve(s=this._restartStates).call(s,a)&&!r.isInRestartIce&&(a==="disconnected"&&await Ci(800),r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))},r.onICEConnectionStateChange=a=>{a!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(a,")")),nt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:a,tag:rr.TRACER}).onSuccess(),this.emit(ut.IceConnectionStateChange,a)},r.onICETransportStateChange=a=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(a,")"))},r.onDTLSTransportStateChange=a=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(a,")"))},r.onDTLSTransportError=a=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(a,")"))},r.onFirstAudioDecoded=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(f=>f._audioSSRC===a);var d;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(d=l.audioTrack)===null||d===void 0||d.emit(No.FIRST_FRAME_DECODED),nt.firstRemoteFrame(this.store.sessionId,ri.FIRST_AUDIO_DECODE,Qn.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},r.onFirstAudioReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._audioSSRC===a);l&&nt.firstRemoteFrame(this.store.sessionId,ri.FIRST_AUDIO_RECEIVED,Qn.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},r.onFirstVideoDecoded=(a,s,l)=>{this.reportVideoFirstFrameDecoded(a,s,l)},r.onFirstVideoReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===a);l&&nt.firstRemoteFrame(this.store.sessionId,ri.FIRST_VIDEO_RECEIVED,Qn.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},r.onSelectedLocalCandidateChanged=(a,s)=>{const l=a.candidateType==="relay",d=s.candidateType==="relay";s.candidateType!=="unknown"&&l===d||this.emit(ut.ConnectionTypeChange,l),F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(_h(s))," -> ").concat(JSON.stringify(_h(a)),")"))},r.onSelectedRemoteCandidateChanged=(a,s)=>{F.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(_h(s))," -> ").concat(JSON.stringify(_h(a)),")"))},r.onFirstVideoDecodedTimeout=a=>{this.reportVideoFirstFrameDecoded(a,void 0,void 0,!0)},r.onLocalCandidate=a=>{this.emit(ut.LocalCandidate,{candidate:a,direction:r.direction})}}unbindConnectionEvents(r){r.onConnectionStateChange=void 0,r.onICEConnectionStateChange=void 0,r.onICETransportStateChange=void 0,r.onDTLSTransportStateChange=void 0,r.onDTLSTransportError=void 0,r.onFirstAudioDecoded=void 0,r.onFirstAudioReceived=void 0,r.onFirstVideoDecoded=void 0,r.onFirstVideoReceived=void 0,r.onSelectedLocalCandidateChanged=void 0,r.onSelectedRemoteCandidateChanged=void 0,r.onFirstVideoDecodedTimeout=void 0,r.onLocalCandidate=void 0}async handleDisconnect(r){const a=r===La.SEND_ONLY?this.sendConnection:this.recvConnection;a&&!a.isInRestartIce&&(a.isInRestartIce=!0,F.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(a.name,"] start use restartICE")),r===La.SEND_ONLY?this.restartICE(r):Li(this,ut.RequestP2PRestartICE,{direction:La.SEND_ONLY}))}filterTobeMutedTracks(r){const a=[];if(this.getAllTracks().indexOf(r)===-1)return a;const s=this.localTrackMap.get(ke.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive||a.push([ke.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l&&(a.push(l),l[0]===ke.LocalVideoTrack)){const d=this.localTrackMap.get(ke.LocalVideoLowTrack);d&&a.push([ke.LocalVideoLowTrack,d])}return a}filterTobeUnmutedTracks(r){const a=[],s=this.localTrackMap.get(ke.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive&&a.push([ke.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l)if(l[0]===ke.LocalVideoTrack){a.push(l);const d=this.localTrackMap.get(ke.LocalVideoLowTrack);d&&a.push([ke.LocalVideoLowTrack,d])}else a.push(l);return a}createMuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoTrack:l=Ve(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}createUnmuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case ke.LocalAudioTrack:l=xn.Audio;break;case ke.LocalVideoTrack:l=Ve(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case ke.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}filterTobeUnSubscribedTracks(r,a){const s=[],l=this.remoteUserMap.get(r);if(!l)return s;if(a){const d=l.get(a);if(!d)return s;s.push([r,{kind:a,id:d}])}else Array.from(l.entries()).forEach(d=>{let[f,m]=d;s.push([r,{kind:f,id:m}])});return s}createUnsubscribeMessage(r){const a=[];return r.forEach(s=>{let[l,{kind:d,id:f}]=s;switch(d){case Ye.VIDEO:return void(l._videoSSRC&&a.push({stream_type:Ye.VIDEO,ssrcId:l._videoSSRC}));case Ye.AUDIO:return void(l._audioSSRC&&a.push({stream_type:Ye.AUDIO,ssrcId:l._audioSSRC}))}}),a}withdrawRemoteTracks(r){r.forEach(a=>{let[s,{kind:l}]=a;const d=this.remoteUserMap.get(s);d&&(d.delete(l),Array.from(d.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(r){const a=this.localTrackMap.get(ke.LocalVideoTrack),s=this.localTrackMap.get(ke.LocalVideoLowTrack);a&&(await a.track.setBitrateLimit(r.uplink),await new Ge((l,d)=>{this.handleUpdateVideoEncoder(a.track,l,d,!0)})),s&&r.low_stream_uplink&&(await s.track.setBitrateLimit({max_bitrate:r.low_stream_uplink.bitrate,min_bitrate:r.low_stream_uplink.bitrate||0}),await new Ge((l,d)=>{this.handleUpdateVideoEncoder(s.track,l,d,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const r=this.sendConnection.peerConnectionState,a=this.recvConnection.peerConnectionState;return r!=="connected"&&a!=="connected"}return!0}async tryToUnmuteAudio(r){for(let a=0;a<r.length;a++)if(r[a]instanceof vr){const s=this.filterTobeUnmutedTracks(r[a]);if(s.length===0)continue;const l=this.createUnmuteMessage(s);return void await Ln(this,ut.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=r=>this.getStats(r),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(r=>{let[,{ssrcs:a}]=r;return!!a}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=r=>{var a;return!((a=this.recvConnection)===null||a===void 0||!a.getRemoteVideoIsReady(r))},this.statsUploader.requestUpload=(r,a)=>this.emit(ut.RequestUpload,r,a),this.statsUploader.requestUploadStats=r=>this.emit(ut.RequestUploadStats,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Ci(yj(this.dtlsFailedCount,Gr)),this.emit(ut.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(ke.LocalVideoTrack)||this.pendingLocalTracks.some(r=>r instanceof Wn)}throwIfTrackTypeNotMatch(r){if(r.filter(a=>a instanceof Wn).length>1)throw new Se(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r.filter(a=>a instanceof vr).length>1&&(r.some(a=>a instanceof vr&&a._bypassWebAudio)||!un().webAudioMediaStreamDest))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const a of r){if(a instanceof Wn&&this.pendingLocalTracks.some(s=>s instanceof Wn))throw new Se(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(a instanceof vr&&this.pendingLocalTracks.some(s=>s instanceof vr)&&(!un().webAudioMediaStreamDest||a._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof vr&&s._bypassWebAudio)))throw new Se(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(r,a){const s=!se("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding,l=iC(iC({},{width:160,height:120,framerate:15,bitrate:50}),a);let d;d=s?r._mediaStreamTrack.clone():jD(r,l);const f=Mn(8,"track-low-"),m=new Wn(d,iC(iC({},s&&{scaleResolutionDownBy:pD(l,r)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,f);return m.on(cp.TRANSCEIVER_UPDATED,y=>{r._updateRtpTransceiver(y,Cg.LOW_STREAM)}),m._hints.push(jn.LOW_STREAM),r.addListener(Ze.NEED_CLOSE,()=>{m.close()}),m}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(r,a,s,l){var d;const f=Array.from(os(d=this.remoteUserMap).call(d)).find(m=>m._videoSSRC===r);if(f){l||this.store.subscribe(f.uid,"video",void 0,void 0,void 0,void 0,Date.now());const m=this.store.keyMetrics,y=m.subscribe.find(_=>_.userId===f.uid&&_.type==="video");nt.firstRemoteVideoDecode(this.store.sessionId,ri.FIRST_VIDEO_DECODE,Qn.FIRST_VIDEO_DECODE,{peer:f._uintid,videowidth:a,videoheight:s,subscribeElapse:qi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId,apEnd:m.requestAPEnd||0,apStart:m.requestAPStart||0,joinGwEnd:m.joinGatewayEnd||0,joinGwStart:m.joinGatewayStart||0,pcEnd:m.peerConnectionEnd||0,pcStart:m.peerConnectionStart||0,subscriberEnd:(y==null?void 0:y.subscribeEnd)||0,subscriberStart:(y==null?void 0:y.subscribeStart)||0,videoAddNotify:(y==null?void 0:y.streamAdded)||0,state:l?1:0})}}async remoteMediaSsrcChanged(r,a,s){if(!this.recvConnection)return!1;const l=this.remoteUserMap.get(r);if(!l)return!1;const d=l.get(a);if(!d)return!1;const f=await this.recvConnection.getRemoteSSRC(d);return f!==void 0&&f!==s}isPreSubScribe(r){return!1}async publishDataChannel(r){throw new Se(ie.NOT_SUPPORTED)}async unpublishDataChannel(r){throw new Se(ie.NOT_SUPPORTED)}async subscribeDataChannel(r,a){throw new Se(ie.NOT_SUPPORTED)}async unsubscribeDataChannel(r,a){throw new Se(ie.NOT_SUPPORTED)}hasPendingRemoteDataChannel(r,a){throw new Se(ie.NOT_SUPPORTED)}setPendingRemoteDataChannel(r,a){throw new Se(ie.NOT_SUPPORTED)}async preConnect(r){throw new Se(ie.NOT_SUPPORTED)}getEstablishParams(){throw new Se(ie.NOT_SUPPORTED)}async reSubscribe(r){throw new Se(ie.NOT_SUPPORTED)}reportVideoFirstFrameRender(r){}async updateVideoStreamParameter(r,a){throw new Se(ie.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(r=>{let[a,{track:s}]=r;a===ke.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,Cg.LOW_STREAM):s._updateRtpTransceiver(void 0)})}},tt(ar.prototype,"p2pConnect",[MX],Object.getOwnPropertyDescriptor(ar.prototype,"p2pConnect"),ar.prototype),tt(ar.prototype,"unpublish",[UX],Object.getOwnPropertyDescriptor(ar.prototype,"unpublish"),ar.prototype),tt(ar.prototype,"unpublishLowStream",[FX],Object.getOwnPropertyDescriptor(ar.prototype,"unpublishLowStream"),ar.prototype),tt(ar.prototype,"subscribe",[VX],Object.getOwnPropertyDescriptor(ar.prototype,"subscribe"),ar.prototype),tt(ar.prototype,"mockSubscribe",[BX],Object.getOwnPropertyDescriptor(ar.prototype,"mockSubscribe"),ar.prototype),tt(ar.prototype,"unsubscribe",[$X],Object.getOwnPropertyDescriptor(ar.prototype,"unsubscribe"),ar.prototype),tt(ar.prototype,"muteRemote",[WX],Object.getOwnPropertyDescriptor(ar.prototype,"muteRemote"),ar.prototype),tt(ar.prototype,"unmuteRemote",[GX],Object.getOwnPropertyDescriptor(ar.prototype,"unmuteRemote"),ar.prototype),tt(ar.prototype,"hasRemoteMediaWithLock",[HX],Object.getOwnPropertyDescriptor(ar.prototype,"hasRemoteMediaWithLock"),ar.prototype),tt(ar.prototype,"disconnectForReconnect",[zX],Object.getOwnPropertyDescriptor(ar.prototype,"disconnectForReconnect"),ar.prototype),tt(ar.prototype,"remoteMediaSsrcChanged",[KX],Object.getOwnPropertyDescriptor(ar.prototype,"remoteMediaSsrcChanged"),ar.prototype),ar);function fl(r){return function(a,s,l){const d=a[s];if(typeof d!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];switch(r){case hl.SEND_ONLY:{const _=await this.sendMutex.lock("From P2PChannel2.".concat(s));try{return await d.apply(this,m)}finally{_()}}case hl.RECEIVE_ONLY:{const _=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await d.apply(this,m)}finally{_()}}default:{const _=await this.sendMutex.lock("From P2PChannel2.".concat(s)),w=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await d.apply(this,m)}finally{_(),w()}}}},l}}class Cp extends lr{constructor(a,s){super(),Z(this,"signal",void 0),Z(this,"token",void 0),Z(this,"tokenTimeout",void 0),Z(this,"tokenInterval",void 0),Z(this,"_sequence",0),Z(this,"userMap",new Map),Z(this,"encoder",new TextEncoder),this.signal=a,this.token=s;const l=()=>{this.signal.connectionState===$n.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(l,1e3):this.tokenInterval=window.setTimeout(l,3*se("P2P_TOKEN_INTERVAL"))};l()}async send(a,s,l,d,f){var m;if(this.userMap.size===0)return;const y=Array.from(Rs(m=this.userMap).call(m))[0].token;typeof s!="string"&&(s=JSON.stringify(s)),d=d??Mn(6,""),f=f??this._sequence++;const _={_id:d,_type:a,_seq:f,_message:s,token:"".concat(this.token,"_").concat(y)};se("SHOW_P2P_LOG")&&F.debug("send message",_,"noNeedResponse : ".concat(l)),this.splitMessage(JSON.stringify(_)).forEach(x=>{this.signal.request(Ct.DATA_STREAM,{payload:fh(this.encoder.encode(x))})});const w=new Ge((x,A)=>{const I=window.setTimeout(()=>{this.off("res-@".concat(d,"_ack"),L),this.off("res-@".concat(d),$),this.off(Ug.ABORT,H),F.debug("[external-signal] request timeout, type: ".concat(a,", requestId: ").concat(d)),this.userMap.size===0?A(new Se(ie.INVALID_REMOTE_USER)):A(new Se(ie.TIMEOUT))},se("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),L=()=>{I&&window.clearTimeout(I),this.off(Ug.ABORT,H),l&&x()},H=()=>{I&&window.clearTimeout(I),this.off("res-@".concat(d,"_ack"),L),this.off("res-@".concat(d),$),A(new Se(ie.EXTERNAL_SIGNAL_ABORT,"type: ".concat(a,", requestId: ").concat(d)))};this.once(Ug.ABORT,H),this.once("res-@".concat(d,"_ack"),L);const $=(ne,te)=>{G=!0,I&&window.clearTimeout(I),this.off("res-@".concat(d,"_ack"),L),this.off(Ug.ABORT,H),ne==="success"?x(te):A(new Se(ie.P2P_MESSAGE_FAILED,"request ".concat(a," failed, requestId: ").concat(d)))};let G=!1;l||(this.once("res-@".concat(d),$),Ci(se("SIGNAL_REQUEST_TIMEOUT")).then(()=>{G||F.warning("external_signal request timeout, type: ".concat(a,", requestId: ").concat(d,", ").concat(_))}))});try{return await w}catch(x){if(x.code===ie.TIMEOUT)return await this.send(a,s,l,d,f);throw x}}onMessage(a){var s;const{_uid:l}=a;let d,f=this.userMap.get(l);if(f)d=f.splitMessageMap;else{if(this.userMap.size>0||!("_type"in a)||a._type!==Ar.CHECK)return;const{token:w}=a;d=new Map,f={uid:l,isStart:!0,token:w,splitMessageMap:d,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(l,f),this.signal.emit(tn.ON_USER_ONLINE,{uid:l}),this.handleUserOnline()}if("id"in a&&"total"in a){var m;const{id:w,total:x}=a,A=(m=d.get(w))!==null&&m!==void 0?m:[];if(A.push(a),d.has(w)||d.set(w,A),A.length!==x)return;{const I=Yf(A).call(A,(L,H)=>L.index-H.index).map(L=>L.payload).join("");d.delete(w),(a=JSON.parse(I))._uid=l}}const{_type:y,token:_}=a;if(Ve(s=[Ar.ACK,Ar.CHECK]).call(s,y))return y===Ar.CHECK&&this.handleCheckToken(f,_),void this.receiveMessage(a);_==="".concat(f.token,"_").concat(this.token)?this.handleReceivedMessage(a):F.debug('Receive unexpected message", '.concat(_,", cur_token: ").concat(f.token,"_").concat(this.token),a)}check(){const a={_id:Mn(6,""),token:this.token,_type:Ar.CHECK};se("SHOW_P2P_LOG")&&F.debug("send message",a),this.signal.request(Ct.DATA_STREAM,{payload:fh(this.encoder.encode(JSON.stringify(a)))})}ack(a){const s={_id:a,_type:Ar.ACK,token:this.token};se("SHOW_P2P_LOG")&&F.debug("send message",s),this.signal.request(Ct.DATA_STREAM,{payload:fh(this.encoder.encode(JSON.stringify(s)))})}response(a,s,l){this.send(Ar.RESPONSE,JSON.stringify({success:!l,message:s}),!0,a)}handleReceivedMessage(a){const s=()=>{this.userMap.forEach(w=>{const{receivedMessagesMap:x,nextExpectedSequenceNumber:A}=w;for(;x.has(A);){const I=x.get(A);x.delete(A),this.receiveMessage(I),w.nextExpectedSequenceNumber++}})};if(!a)return void s();const{_uid:l,_seq:d}=a,f=this.userMap.get(l),{receivedMessagesMap:m,isStart:y,nextExpectedSequenceNumber:_}=f;if(d<_)return this.ack(a._id),void F.debug("[external-signal] receive old message, seq: ".concat(d,", ").concat(a._message));m.set(d,a),y&&d===_&&(this.receiveMessage(a),m.delete(_),f.nextExpectedSequenceNumber++,s())}receiveMessage(a){const{_id:s,_type:l,_message:d,_uid:f}=a;if(se("SHOW_P2P_LOG")&&F.debug("receive message",a),s){let m;switch(a._type!==Ar.ACK&&(d&&(m=JSON.parse(d)),this.ack(a._id)),a._type){case Ar.CANDIDATE:case Ar.CONTROL:this.signal.emit(l,m,f);break;case Ar.PUBLISH:case Ar.UNPUBLISH:case Ar.RESTART_ICE:case Ar.CALL:m.uid=f,Li(this.signal,l,m).then(y=>{this.response(a._id,y)}).catch(()=>{this.response(a._id,void 0,!0)});break;case Ar.ACK:this.getListeners("res-@".concat(s,"_ack")).length>0&&this.emit("res-@".concat(s,"_ack"));break;case Ar.RESPONSE:{const{success:y,message:_}=m;this.emit("res-@".concat(s),y?"success":"failed",_);break}}}}splitMessage(a){if(a.length<Cp.MAX_MESSAGE_SIZE)return[a];const s=[],{remoteToken:l}=JSON.parse(a),d=Mn(6,"");let f=0,m=800;const y=Math.ceil(a.length/m);for(;a.length>0;){f++;const _={id:d,index:f,total:y,payload:a.slice(0,m),token:"".concat(this.token,"_").concat(l)};JSON.stringify(_).length>Cp.MAX_MESSAGE_SIZE?m-=50:(s.push(_),a=a.slice(m))}return s.map(_=>JSON.stringify(_))}handleCheckToken(a,s){return a.token!==s?(F.debug("token changed, from ".concat(a.token," to ").concat(s)),this.reset(a.uid,s),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{F.debug("token timeout, ".concat(s)),this.reset(a.uid)},se("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const a=await Li(this.signal,Ar.CALL,void 0),s=await this.send(Ar.CALL,a);this.signal.emit(It.P2P_CONNECTION,s,!0)}async reset(a,s){const l=this.userMap.get(a);l&&(this.emit(Ug.ABORT),this.signal.emit(tn.ON_USER_OFFLINE,{uid:l.uid,reason:XIe.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),s||(F.debug("change local token from ".concat(s," to ").concat(s)),this.token=Mn(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Ug.ABORT)}}Z(Cp,"MAX_SIZE",1),Z(Cp,"MAX_MESSAGE_SIZE",1024);class Oke extends lr{get connectionState(){return this._connectionState}set connectionState(a){a!==this._connectionState&&(this._connectionState=a,a===$n.CONNECTED?this.emit(It.WS_CONNECTED):a===$n.RECONNECTING?this.emit(It.WS_RECONNECTING,this._websocketReconnectReason):a===$n.CLOSED&&this.emit(It.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(a,s){super(),Z(this,"_disconnectedReason",void 0),Z(this,"_websocketReconnectReason",void 0),Z(this,"_connectionState",$n.CLOSED),Z(this,"reconnectToken",void 0),Z(this,"p2pToken",void 0),Z(this,"websocket",void 0),Z(this,"openConnectionTime",void 0),Z(this,"clientId",void 0),Z(this,"lastMsgTime",Date.now()),Z(this,"uploadCache",[]),Z(this,"uploadCacheInterval",void 0),Z(this,"rttRolling",new Sz(5)),Z(this,"pingpongTimer",void 0),Z(this,"pingpongTimeoutCount",0),Z(this,"joinResponse",void 0),Z(this,"multiIpOption",void 0),Z(this,"initError",void 0),Z(this,"spec",void 0),Z(this,"store",void 0),Z(this,"_external_signal",void 0),Z(this,"onWebsocketMessage",l=>{if(l.data instanceof ArrayBuffer)return void this.emit(It.ON_BINARY_DATA,l.data);const d=JSON.parse(l.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(d,"_id")){const f="res-@".concat(d._id);this.emit(f,d._result,d._message)}else if(Object.prototype.hasOwnProperty.call(d,"_type")){switch(d._type){case tn.ON_DATA_STREAM:return void this.handleDataStream(d._message);case tn.MUTE_AUDIO:case tn.MUTE_VIDEO:case tn.ON_P2P_LOST:case tn.ON_USER_ONLINE:return;case tn.ON_USER_OFFLINE:const{uid:f}=d._message;return F.debug("[".concat(this.clientId,"] user-offline uid: ").concat(f)),void this._external_signal.reset(f)}if(this.emit(d._type,d._message),d._type===tn.ON_NOTIFICATION&&this.handleNotification(d._message),d._type===tn.ON_USER_BANNED)switch(d._message.error_code){case 14:this.close(En.UID_BANNED);break;case 15:this.close(En.IP_BANNED);break;case 16:this.close(En.CHANNEL_BANNED)}if(d._type===tn.ON_USER_LICENSE_BANNED)switch(d._message.error_code){case yt.ERR_LICENSE_MISSING:this.close(En.LICENSE_MISSING);break;case yt.ERR_LICENSE_EXPIRED:this.close(En.LICENSE_EXPIRED);break;case yt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(En.LICENSE_MINUTES_EXCEEDED);break;case yt.ERR_LICENSE_PERIOD_INVALID:this.close(En.LICENSE_PERIOD_INVALID);break;case yt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(En.LICENSE_MULTIPLE_SDK_SERVICE);break;case yt.ERR_LICENSE_ILLEGAL:this.close(En.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=a.clientId,this.spec=a,this.store=s,this.websocket=new hD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,se("JOIN_GATEWAY_USE_DUAL_DOMAIN"),se("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===$n.CONNECTED&&this.reconnect("retry",Di.OFFLINE)}),this.p2pToken=Mn(6,""),this._external_signal=new Cp(this,this.p2pToken)}async request(a,s,l,d){const f=Mn(6,""),m={_id:f,_type:a,_message:s},y=this.websocket.connectionID,_=()=>new Ge((H,$)=>{if(this.connectionState===$n.CONNECTED)return H();const G=()=>{this.off(It.WS_CLOSED,ne),H()},ne=()=>{this.off(It.WS_CONNECTED,G),$(new Se(ie.WS_ABORT))};this.once(It.WS_CONNECTED,G),this.once(It.WS_CLOSED,ne)});if(this.connectionState!==$n.CONNECTING&&this.connectionState!==$n.RECONNECTING||a===Ct.JOIN||a===Ct.REJOIN||await _(),this.websocket.sendMessage(m,!0),d)return;const w=new Ge((H,$)=>{let G=!1;const ne=(ce,pe)=>{G=!0,H({isSuccess:ce==="success",message:pe||{}}),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.emit(It.REQUEST_SUCCESS,a,s)};this.once("res-@".concat(f),ne);const te=()=>{$(new Se(ie.WS_ABORT,"type: ".concat(a))),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.off("res-@".concat(f),ne)};this.once(It.WS_CLOSED,te),this.once(It.WS_RECONNECTING,te),Ci(se("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==y||G||(F.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(a)),this.emit(It.REQUEST_TIMEOUT,a,s))})});let x=null;try{x=await w}catch(H){if(this.connectionState===$n.CLOSED||a===Ct.LEAVE)throw new Se(ie.WS_ABORT);return!this.spec.forceWaitGatewayResponse||l?H.throw():a===Ct.JOIN||a===Ct.REJOIN?null:(await _(),await this.request(a,s))}if(x.isSuccess)return x.message;const A=Number(x.message.error_code||x.message.code),I=_b(A),L=new Se(ie.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(x.message.error_str),{code:A,data:x.message,desc:I.desc});return I.action==="success"?x.message:(F.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(a,", error_code: ").concat(A,", message: ").concat(I.desc,", action: ").concat(I.action)),A===yt.ERR_TOO_MANY_BROADCASTERS?((a===Ct.JOIN||a===Ct.REJOIN)&&(this.initError=L,this.close()),L.throw()):I.action==="failed"?L.throw():I.action==="quit"?(this.initError=L,this.close(),L.throw()):(A===yt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,F.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Di.MULTI_IP)):this.reconnect(I.action,Di.SERVER_ERROR),a===Ct.JOIN||a===Ct.REJOIN?null:await this.request(a,s)))}waitMessage(a,s){return new Ge(l=>{const d=f=>{(!s||s(f))&&(this.off(a,d),l(f))};this.on(a,d)})}uploadWRTCStats(a){if(!this.store.sessionId)return void F.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const s={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:a};this.upload(vb.WRTC_STATS,s)}upload(a,s){const l={_type:a,_message:s};try{this.websocket.sendMessage(l)}catch{const f=se("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(l),this.uploadCache.length>f&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==$n.CONNECTED)return;const m=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(m._type,m._message)},se("UPLOAD_CACHE_INTERVAL")||2e3))}}send(a,s){const l={_type:a,_message:s};this.websocket.sendMessage(l)}async sendExtensionMessage(a,s,l){return await this._external_signal.send(a,s,l)}init(a){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ge((s,l)=>{this.once(It.WS_CONNECTED,()=>s(this.joinResponse)),this.once(It.WS_CLOSED,()=>l(this.initError||new Se(ie.WS_ABORT))),this.connectionState=$n.CONNECTING,this.websocket.init(a).catch(l)})}close(a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=a||En.LEAVE,this.connectionState=$n.CLOSED,F.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=Mn(6,""),this._external_signal.clear(),this._external_signal=new Cp(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(It.ABORT_P2P_EXECUTION);const a=await Li(this,It.REQUEST_JOIN_INFO),s=await this.request(Ct.JOIN,a);if(!s)return this.emit(It.REPORT_JOIN_GATEWAY,ie.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(It.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=$n.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(a,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(a,s)}async downgradeCodec(a){return!1}handleDataStream(a){try{var s;const l=ap(a.payload),d=new TextDecoder().decode(l),f=JSON.parse(d);"total"in f&&"id"in f||Ve(s=Object.values(Ar)).call(s,f._type)?(f._uid=a.uid,this._external_signal.onMessage(f)):this.emit(tn.ON_DATA_STREAM,a)}catch{this.emit(tn.ON_DATA_STREAM,a)}}handleNotification(a){F.debug("[".concat(this.clientId,"] receive notification: "),a);const s=_b(a.code);if(s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(En.UID_BANNED),void this.close()):void this.reconnect(s.action,Di.SERVER_ERROR);F.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const a=se("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=a&&(F.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>se("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Di.TIMEOUT):this.request(Ct.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const l=Date.now()-s;this.rttRolling.add(l),se("REPORT_STATS")&&this.send(Ct.PING_BACK,{pingpongElapse:l})}).catch(l=>{})}handleWebsocketEvents(){this.websocket.on(Bt.RECONNECT_CREATE_CONNECTION,a=>{this.emit(It.WS_RECONNECT_CREATE_CONNECTION,a)}),this.websocket.on(Bt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Bt.CLOSED,()=>{this.connectionState=$n.CLOSED}),this.websocket.on(Bt.FAILED,()=>{this._disconnectedReason=En.NETWORK_ERROR,this.connectionState=$n.CLOSED}),this.websocket.on(Bt.RECONNECTING,a=>{this._websocketReconnectReason=a,this.joinResponse=void 0,this.connectionState===$n.CONNECTED?this.connectionState=$n.RECONNECTING:this.connectionState=$n.CONNECTING}),this.websocket.on(Bt.WILL_RECONNECT,(a,s,l)=>{a!=="retry"?(F.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(a)),this.reconnectToken=void 0):F.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),l(a)}),this.websocket.on(Bt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(a=>{if(this.emit(It.REPORT_JOIN_GATEWAY,a,this.url||""),a instanceof Se&&a.code===ie.UNEXPECTED_RESPONSE&&a.data.code===yt.ERR_NO_AUTHORIZED)return F.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Di.SERVER_ERROR);F.error("[".concat(this.clientId,"] join gateway request failed"),a.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Di.SERVER_ERROR):(this.initError=a,this.close())})}),this.websocket.on(Bt.REQUEST_NEW_URLS,(a,s)=>{Li(this,It.REQUEST_RECOVER,this.multiIpOption).then(a).catch(s)}),this.websocket.on(Bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(tn.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const Pke={name:"P2PChannel",create:function(r){let{store:a,statsCollector:s}=r;return new Ike(a,s)},createSubmodule:function(r){let{store:a,spec:s}=r;return new Oke(s,a)}};function YX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function XX(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?YX(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):YX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class kke{constructor(a){Z(this,"sessionDesc",void 0),Z(this,"localCapabilities",void 0),Z(this,"rtpCapabilities",void 0),Z(this,"candidates",void 0),Z(this,"_originCandidates",void 0),Z(this,"iceParameters",void 0),Z(this,"dtlsParameters",void 0),Z(this,"setup",void 0),Z(this,"currentMidIndex",void 0),Z(this,"cname",void 0),a=ir(a);const{iceParameters:s,dtlsParameters:l,candidates:d,rtpCapabilities:f,setup:m,localCapabilities:y,sdkCodec:_,cname:w}=a,x=ss(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=f,this.candidates=d,this._originCandidates=ir(d),this.iceParameters=s,this.dtlsParameters=l,this.setup=m,this.localCapabilities=y,this.cname=w;for(let A=0;A<x.mediaDescriptions.length;A++){const I=x.mediaDescriptions[A];if(I.attributes.iceUfrag=s.iceUfrag,I.attributes.icePwd=s.icePwd,I.attributes.fingerprints=l.fingerprints,I.attributes.candidates=d,I.attributes.setup=m,I.media.mediaType==="video"){I.media.fmts=f.videoCodecs.map($=>$.payloadType.toString(10));const L=f.videoCodecs.filter($=>{var G,ne;return(G=$.rtpMap)===null||G===void 0?void 0:Ve(ne=G.encodingName.toLowerCase()).call(ne,_)}),H=f.videoCodecs.filter($=>!Ve(L).call(L,$));I.attributes.payloads=[...L,...H],I.attributes.extmaps=f.videoExtensions}I.media.mediaType==="audio"&&(I.media.fmts=f.audioCodecs.map(L=>L.payloadType.toString(10)),I.attributes.payloads=f.audioCodecs,I.attributes.extmaps=f.audioExtensions),x.mediaDescriptions[A]=this.mungMediaDesc(I)}this.sessionDesc=x,this.currentMidIndex=x.mediaDescriptions.length-1}toString(){return ph(this.sessionDesc)}send(a,s,l){const{ssrcs:d,ssrcGroups:f}=Sb(s,this.cname),m=this.sessionDesc.mediaDescriptions.find(w=>a===Ye.VIDEO?w.media.mediaType==="video":w.media.mediaType==="audio"),y=d[0].attributes.label,_=d[0].attributes.mslabel;return m.attributes.ssrcs=m.attributes.ssrcs.concat(d),m.attributes.ssrcGroups=m.attributes.ssrcGroups.concat(f),{id:y,mslabel:_}}batchSend(a){return a.map(s=>{let{kind:l,ssrcMsg:d}=s;return this.send(l,d,void 0)})}stopSending(a){this.sessionDesc.mediaDescriptions.forEach(s=>{const l=[],d=[],f=[];s.attributes.ssrcs.forEach(m=>{Ve(a).call(a,m.attributes.label||"")?f.push(m):l.push(m)}),s.attributes.ssrcGroups.forEach(m=>{var y;Ve(y=f.map(_=>_.ssrcId)).call(y,m.ssrcIds[0])||d.push(m)}),s.attributes.ssrcs=l,s.attributes.ssrcGroups=d})}mute(a){const s=this.sessionDesc.mediaDescriptions.find(l=>l.attributes.mid===a);if(!s)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.mute."));s.attributes.direction="inactive"}unmute(a){const s=this.sessionDesc.mediaDescriptions.find(l=>l.attributes.mid===a);if(!s)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.unmute."));s.attributes.direction="sendonly"}receive(a,s,l){a.forEach((d,f)=>{const m=d._mediaStreamTrack,y=this.sessionDesc.mediaDescriptions.findIndex(w=>w.attributes.mid===m.kind),_=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[y],d);this.sessionDesc.mediaDescriptions[y]=_})}stopReceiving(a){}updateCandidates(a){const s=this._originCandidates.filter(d=>d.transport==="udp"),l=[];if(s.forEach(d=>{l.push(XX(XX({},d),{},{foundation:"tcpcandidate",priority:Number(d.priority)-1+"",transport:"tcp",port:Number(d.port)+90+""}))}),s.length!==0){switch(a){case Ki.TCP_RELAY:this.candidates=l;break;case Ki.UDP_TCP_RELAY:case Ki.RELAY:this.candidates=[...s,...l];break;default:this.candidates=s}for(const d of this.sessionDesc.mediaDescriptions)d.attributes.candidates=this.candidates}}restartICE(a){a=ir(a),this.iceParameters=a,this.sessionDesc.mediaDescriptions.forEach(s=>{s.attributes.iceUfrag=a.iceUfrag,s.attributes.icePwd=a.icePwd})}predictReceivingMids(a){const s=[];for(let l=0;l<a;l++)s.push((this.currentMidIndex+l+1).toString(10));return s}mungRecvMediaDsec(a,s){const l=ir(a);return Bg(l,s),gD(l,s),l}updateRecvMedia(a,s){const l=this.sessionDesc.mediaDescriptions.findIndex(d=>d.attributes.mid===a);if(l!==-1){const d=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[l],s);this.sessionDesc.mediaDescriptions[l]=d}}bumpMid(a){this.currentMidIndex+=a}updateTrackLabel(a,s,l){const d=this.sessionDesc.mediaDescriptions.find(m=>a===Ye.VIDEO?m.attributes.mid==="video":m.attributes.mid==="audio");if(d){const m=d.attributes.ssrcs.find(y=>y.attributes.label===s);var f;m&&(m.attributes.label=l,(f=m.attributes.msid)===null||f===void 0||f.replace(s,l))}}mungMediaDesc(a){const s=ir(a);return mD(s),function(l){const d=l.attributes.extmaps.find(f=>_T(f.extensionName));d&&l.attributes.extmaps.splice(l.attributes.extmaps.indexOf(d),1),l.attributes.payloads.forEach(f=>{const m=f.rtcpFeedbacks.findIndex(y=>y.type==="transport-cc");m!==-1&&f.rtcpFeedbacks.splice(m,1)})}(s),s}getSSRC(a){for(const s of this.sessionDesc.mediaDescriptions)for(const l of s.attributes.ssrcs)if(l.attributes.label===a)return[l]}}var Un;function JX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function aC(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?JX(Object(s),!0).forEach(function(l){Z(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):JX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let jke=(Un=class DE extends uK{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(a=>a.rtpMap&&a.rtpMap.encodingName.toLowerCase()||"").filter(a=>{var s;return Ve(s=Object.keys(hb)).call(s,a)}))]}constructor(a,s){super(a,s),Z(this,"store",void 0),Z(this,"peerConnection",void 0),Z(this,"remoteSDP",void 0),Z(this,"initialOffer",void 0),Z(this,"statsFilter",void 0),Z(this,"useRTX",!1),Z(this,"localCapabilities",void 0),Z(this,"localCandidateCount",0),Z(this,"allCandidatesReceived",!1),Z(this,"establishPromise",void 0),Z(this,"mutex",void 0),this.store=s,this.mutex=new Gi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(DE.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.statsFilter=xj(this.peerConnection,se("STATS_UPDATE_INTERVAL"),void 0,dr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const a=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!a.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=bh(a.sdp),l=wb(a.sdp,{filterRTX:!this.useRTX,filterVideoFec:se("FILTER_VIDEO_FEC"),filterAudioFec:se("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=l,this.initialOffer=a,aC(aC({},s),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:l},offerSDP:a.sdp})}catch(a){throw new Se(ie.GET_LOCAL_CONNECTION_PARAMS_FAILED,a.toString())}}async updateRemoteConnect(){}async connect(a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new kke(aC(aC({},a),{},{rtpCapabilities:a.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const s=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async updateRemoteRTPCapabilities(a,s){throw new Se(ie.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(a){}send(a,s){var l=this;return To(function*(){const d=yield ln(l.mutex.lock());try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const f=a.map(I=>l.peerConnection.addTrack(I._mediaStreamTrack)),m=yield ln(l.peerConnection.createOffer()),y=ss(m.sdp),_=a.map(I=>{const L=I._mediaStreamTrack,H=y.mediaDescriptions.find($=>$.attributes.mid===L.kind);if(!H)throw new Error("Cannot extract ssrc from mediaDescription.");return function($,G,ne){const te=$.attributes.ssrcs.filter(pe=>pe.attributes.label===G),ce=$.attributes.ssrcGroups;if(te.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(ce&&te.length>1){const pe=ce.find(fe=>fe.ssrcIds.indexOf(te[0].ssrcId)!==-1);return pe?[{ssrcId:pe.ssrcIds[0],rtx:ne?pe.ssrcIds[1]:void 0}]:[{ssrcId:te[0].ssrcId}]}return[{ssrcId:te[0].ssrcId}]}(H,L.id,l.useRTX)});let w;try{w=yield _}catch(I){throw f.forEach(L=>{ji()&&L.replaceTrack(null),l.peerConnection.removeTrack(L)}),I}const x=l.mungSendOfferSDP(m.sdp,a);l.remoteSDP.receive(a,s,w);const A=l.remoteSDP.toString();return yield ln(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(l.applySendEncodings(f,a)),yield ln(l.peerConnection.setRemoteDescription({type:"answer",sdp:A})),a.map((I,L)=>{const H=I._mediaStreamTrack.id;return{localSSRC:_[L],id:H}})}catch(f){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(f.toString()))}finally{d()}})()}async stopSending(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const s=this.peerConnection.getSenders().filter(f=>{var m;return a.indexOf(((m=f.track)===null||m===void 0?void 0:m.id)||"")!==-1});if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");s.map(f=>{ji()&&f.replaceTrack(null),this.peerConnection.removeTrack(f)});const l=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(a);const d=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(s.toString()))}}async receive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{id:f,mslabel:m}=this.remoteSDP.send(a,s,d),y=new Ge((x,A)=>{const I=setTimeout(()=>{A(new Error("Cannot receive track, id: ".concat(f)))},1e4),L=H=>{const $=sn();if(($.name==="Safari"&&Number($.version)===11||oa())&&H.track.id!==f&&H.streams[0].id===m){var G;const ne=H.streams[0].getTracks()[0];return(G=this.remoteSDP)===null||G===void 0||G.updateTrackLabel(a,f,H.track.id),this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x(ne)}if(H.track.id===f)return this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x(H.track)};this.peerConnection.addEventListener("track",L)}),_=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_});const w=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(w),{track:await y,id:f}}catch(f){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(l)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(a){}async unmuteRemote(a){}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(l=>{var d;return a.indexOf(((d=l.track)===null||d===void 0?void 0:d.id)||"")!==-1});if(s.length!==a.length)throw new Error("sender' length doesn't match mids' length.");s.map(l=>{if(ji()&&l.track)l.track.enabled=!1;else{const d=l.getParameters();d.encodings.forEach(f=>f.active=!1),l.setParameters(d)}})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(f=>{var m;return a.indexOf(((m=f.track)===null||m===void 0?void 0:m.id)||"")!==-1});if(s.length!==a.length)throw new Error("Senders' length doesn't match mids' length.");s.map(async f=>{if(ji()&&f.track)f.track.enabled=!0;else{const m=f.getParameters();m.encodings.forEach(y=>y.active=!0),await f.setParameters(m)}});const l=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(l);const d=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(a){var s=this;return To(function*(){const l=yield ln(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const d=un().supportPCSetConfiguration;if(a===Ki.RELAY&&!d)return;if(d){const w=s.peerConnection.getConfiguration(),x=a===Ki.RELAY?"relay":"all";w.iceTransportPolicy!==x&&(F.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(w.iceTransportPolicy,"] to [").concat(x,"]")),w.iceTransportPolicy=x,s.peerConnection.setConfiguration(w))}a!==Ki.RELAY&&s.remoteSDP.updateCandidates(a);const f=yield ln(s.peerConnection.createOffer({iceRestart:!0}));if(!f.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const m=bh(f.sdp),{remoteIceParameters:y}=yield m.iceParameters;s.remoteSDP.restartICE(y);const _=s.remoteSDP.toString();yield ln(s.peerConnection.setLocalDescription(f)),yield ln(s.peerConnection.setRemoteDescription({type:"answer",sdp:_}))}catch(d){F.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),d)}finally{l()}})()}close(){var a;this.peerConnection.close(),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const l=await this.peerConnection.createOffer(),d=this.mungSendOfferSDP(l.sdp,[s]);this.remoteSDP.updateRecvMedia(s._mediaStreamTrack.kind,s);const f=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:d}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new Se(ie.EXCHANGE_SDP_FAILED,l.toString())}}async updateSendParameters(a,s){const l=this.peerConnection.getSenders().filter(d=>{var f;return((f=d.track)===null||f===void 0?void 0:f.id)===a});l.length===1&&await this.applySendEncodings(l,[s])}setStatsRemoteVideoIsReady(a,s){this.statsFilter.setVideoIsReady2(a,s)}async replaceTrack(a,s){const l=this.peerConnection.getSenders().find(d=>{var f;return((f=d.track)===null||f===void 0?void 0:f.id)===s});l&&await l.replaceTrack(a._mediaStreamTrack)}createDataChannels(a,s){throw new Se(ie.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(a){throw new Se(ie.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,F.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,F.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},se("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const s={iceServers:[],sdpSemantics:"plan-b"};return a.iceServers?s.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(ob(a.turnServer.servers)?s.iceServers=a.turnServer.servers:(s.iceServers&&s.iceServers.push(...DE.turnServerConfigToIceServers(a.turnServer.servers)),se("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&a.turnServer.serversFromGateway&&s.iceServers.push(...DE.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(l=>{l.forceturn&&(s.iceTransportPolicy="relay")}))),s}static turnServerConfigToIceServers(a){const s=[];return a.forEach(l=>{l.security?l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(l.turnServerURL,":").concat(l.tcpport,"?transport=tcp")}):(l.udpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.udpport,"?transport=udp")}),l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.tcpport,"?transport=tcp")}))}),s}async updateRtpSenderEncodings(a,s){var l;if(s||(s=this.peerConnection.getSenders().find(w=>{var x;return((x=w.track)===null||x===void 0?void 0:x.id)===a._mediaStreamTrack.id})),!s)return F.warn("[".concat(a.getTrackId(),"] no rtpSender found}"));if(!un().supportSetRtpSenderParameters)return F.warn("Browser not support set rtp-sender parameters");const d={},f={};if(a instanceof Wn)switch(a._optimizationMode){case"motion":d.degradationPreference="maintain-framerate";break;case"detail":d.degradationPreference="maintain-resolution";break;default:d.degradationPreference="balanced"}if(se("DSCP_TYPE")&&id()){var m;const w=se("DSCP_TYPE");Ve(m=["very-low","low","medium","high"]).call(m,w)&&(f.networkPriority=w)}const y=s.getParameters(),_=(l=y.encodings)===null||l===void 0?void 0:l[0];_&&Object.assign(_,f),Object.assign(y,d),F.debug("[".concat(a.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(y.encodings))),await s.setParameters(y)}async applySendEncodings(a,s){try{if(!un().supportSetRtpSenderParameters||a.length!==s.length)return;for(let l=0;l<a.length;l++){const d=a[l],f=s[l];d&&f&&await this.updateRtpSenderEncodings(f,d)}}catch{F.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(a,s){const l=ss(a);return s.forEach((d,f)=>{const m=d._mediaStreamTrack,y=l.mediaDescriptions.find(_=>_.attributes.mid===m.kind);y&&Bg(y,d)}),ph(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,s,l)=>{var d;(d=this.onFirstVideoDecoded)===null||d===void 0||d.call(this,a,s,l)},this.statsFilter.onSelectedLocalCandidateChanged=(a,s)=>{var l;(l=this.onSelectedLocalCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,s)=>{var l;(l=this.onSelectedRemoteCandidateChanged)===null||l===void 0||l.call(this,a,s)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const s=this.remoteSDP.batchSend(a).map((f,m)=>{let{id:y,mslabel:_}=f;const{kind:w}=a[m];return new Ge((x,A)=>{const I=setTimeout(()=>{A(new Error("Cannot receive track, id: ".concat(y)))},1e4),L=H=>{const $=sn();if($.name==="Safari"&&Number($.version)===11&&H.track.id!==y&&H.streams[0].id===_){var G;const ne=H.streams[0].getTracks()[0];return(G=this.remoteSDP)===null||G===void 0||G.updateTrackLabel(w,y,H.track.id),this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x({track:ne,id:y})}if(H.track.id===y)return this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x({track:H.track,id:y})};this.peerConnection.addEventListener("track",L)})}),l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const d=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(d),await Ge.all(s)}catch(s){throw new Se(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async getRemoteSSRC(a){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(a);return s==null?void 0:s[0].ssrcId}setConfiguration(a){if(un().supportPCSetConfiguration){const s=DE.resolvePCConfiguration(a);this.peerConnection.setConfiguration(s)}}},tt(Un.prototype,"connect",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"connect"),Un.prototype),tt(Un.prototype,"stopSending",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"stopSending"),Un.prototype),tt(Un.prototype,"receive",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"receive"),Un.prototype),tt(Un.prototype,"stopReceiving",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"stopReceiving"),Un.prototype),tt(Un.prototype,"muteRemote",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"muteRemote"),Un.prototype),tt(Un.prototype,"unmuteRemote",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"unmuteRemote"),Un.prototype),tt(Un.prototype,"muteLocal",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"muteLocal"),Un.prototype),tt(Un.prototype,"unmuteLocal",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"unmuteLocal"),Un.prototype),tt(Un.prototype,"close",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"close"),Un.prototype),tt(Un.prototype,"updateEncoderConfig",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"updateEncoderConfig"),Un.prototype),tt(Un.prototype,"updateSendParameters",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"updateSendParameters"),Un.prototype),tt(Un.prototype,"replaceTrack",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"replaceTrack"),Un.prototype),tt(Un.prototype,"getRemoteSSRC",[jo],Object.getOwnPropertyDescriptor(Un.prototype,"getRemoteSSRC"),Un.prototype),Un);function jo(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("Locking from P2PConnection.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}const Dke={name:"PlanBConnection",create:function(r){let{store:a,spec:s}=r;return new jke(s,a)}},Lke={interceptLocalAudioFrame:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!un().supportWebRTCEncodedTransform)return void F.warning("browser not support audio encoded transform");if(nT.has(r)||!r.track)return;const s={track:r.track};if(rd()){if(!r.createEncodedStreams)return void F.warning("browser not support createEncodedStreams() API");let d=null;try{d=r.createEncodedStreams()}catch(m){return void F.error("create audio-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(F.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l));const _=a.metadata&&a.metadata();_?function(w,x){const{chunk:A,controller:I}=x,L=mh.METADATA;A.data=function(H,$,G){const ne=G.byteLength,te=ne+Yj+K7,ce=Kj+qj+te,pe=new ArrayBuffer(H.byteLength+ce),fe=new DataView(pe);fe.setUint8(0,z7),fe.setUint16(1,te),fe.setUint8(3,$),fe.setUint16(4,ne);for(let ye=0;ye<ne;ye++)fe.setUint8(6+ye,G[ye]);const ue=new Uint8Array(fe.buffer);return ue.set(new Uint8Array(H),ce),ue.buffer}(A.data,L,w),I.enqueue(A)}(_,{chunk:m,controller:y}):y.enqueue(m)}});d.readable.pipeThrough(f).pipeTo(d.writable)}else if(ji()){if(typeof RTCRtpScriptTransform>"u")return void F.warning("browser not support RTCRtpScriptTransform");const d=tT(),f=new MessageChannel;await new Ge(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"audio-metadata-tx",port:f.port2},[f.port2]);r.transform=m,await new Ge(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),f.port1.onmessage=y=>{var _;if(y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id)F.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l);else if(y.data.getMetadata){const w=a.metadata&&a.metadata();w&&f.port1.postMessage({metadata:w})}},s.worker=d}function l(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",l)}const d=nT.get(r);if(d){nT.delete(r);try{var f,m;(f=d.controller)===null||f===void 0||f.terminate(),(m=d.worker)===null||m===void 0||m.terminate()}catch(y){F.warning(y&&y.message)}}}nT.set(r,s),r.track.addEventListener("ended",l)},interceptRemoteAudioFrame:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!un().supportWebRTCEncodedTransform)return void F.warning("browser not support audio encoded transform");if(cT.has(r))return;const s={track:r.track,onMetadata:a.onMetadata,onPts:a.onPts};if(rd()&&!oa()){if(!r.createEncodedStreams)return void F.warning("browser not support createEncodedStreams() API");ij(pn.CHROME,87,116)||(a.enableTopn=!1);let d=null;try{d=r.createEncodedStreams()}catch(m){return void F.error("create audio-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(F.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l)),a.enableTopn?function(_,w,x){var A;const I=Xj(new DataView(w.data));if(!I)return x.enqueue(w);const L=_.track.id;vIe.set(L,_.track);const H=(A=I.tlv.find(pe=>pe.tag===mh.AUDIO_LEVEL))===null||A===void 0?void 0:A.value;let $=0;typeof H=="number"&&($=127-H);const G=Math.round(Math.pow(10,$/60)-1),{selected:ne,speaker:te}=function(pe,fe){let ue=jg.get(pe);if(ue||(ue=function(ye){const xe=new Y7;return jg.set(ye,xe),sl||(sl=new mIe(se("TOPN_SILENCE_THRESHOLD")||500),sl.on("ActiveSpeakerChanged",Ae=>{Ae!=null&&(aT=Ae)})),sl.addSpeakers([xe]),xe}(pe)),jg.size<=X7)return{selected:!0,speaker:ue};if(!sl)throw new Error("no active speaker detector");return sl.levelChanged(ue.id,fe),hp=sl.loudest.map(ye=>ye.id),aT&&!Ve(hp).call(hp,aT)&&hp.length>=X7&&hp.pop(),{selected:Ve(hp).call(hp,ue.id)||ue.id===aT,speaker:ue}}(_,G),ce=function(pe,fe,ue){const ye=ol.get(pe)||new gIe(pe,fe);return ye.score=ue,ol.set(pe,ye),function(xe){if(sT.set(xe,!0),!oT)return void(oT=Date.now());const Ae=Date.now();Ae-oT>1e3&&(sT.get(xe)?sT.set(xe,!1):(J7(xe),sT.delete(xe)),oT=Ae)}(pe),ye}(L,_.track,te.energyScore);ce.addSample(ne),ce.active&&(w.data=I.frame.buffer,x.enqueue(w))}(r,m,y):a.enableMetadata||a.enablePts?function(_,w,x,A){const I=new DataView(_.data),L=I.getUint8(0);let H;if(128&L&&L!==71){const ne=function(te){if(te.byteLength<=0)return[];const ce=[];let pe=0;for(;pe<te.byteLength;){const ue=(128&te.getUint8(pe))>>7,ye=127&te.getUint8(pe);if(!(ue&&pe+4<=te.byteLength)){pe++;break}{const xe=te.getUint32(pe,!1),Ae=(16776192&xe)>>10,Le=1023&xe;ce.push({pt:ye,ts_offset:Ae,length:Le,data:new Uint8Array}),pe+=4}}let fe=te.byteLength-pe;for(const ue of ce){if(ue.length>fe)return console.warn("Broken red payload"),[];ue.length>0&&(ue.data=new Uint8Array(te.buffer,te.byteOffset+pe,ue.length),pe+=ue.length,fe-=ue.length)}if(fe>0){const ue={pt:ce.length>0?ce[ce.length-1].pt:0,ts_offset:0,length:fe,data:new Uint8Array(te.buffer,te.byteOffset+pe,fe)};ce.push(ue)}return ce}(I);if(ne.length>0){const te=function(ce){let pe=0;for(let ye=0;ye<ce.length;ye++)pe+=ye<ce.length-1?4:1,pe+=ce[ye].length;const fe=new Uint8Array(pe);let ue=0;for(let ye=0;ye<ce.length;ye++)if(ye<ce.length-1){const xe=(2147483648|(127&ce[ye].pt)<<24|(262143&ce[ye].ts_offset)<<10|1023&ce[ye].length)>>>0;fe[ue++]=xe>>24&255,fe[ue++]=xe>>16&255,fe[ue++]=xe>>8&255,fe[ue++]=255&xe}else fe[ue++]=127&ce[ye].pt;for(const ye of ce)fe.set(ye.data,ue),ue+=ye.length;return fe}(ne.map(ce=>{const pe=new Uint8Array(ce.length);pe.set(ce.data);const fe=Xj(new DataView(pe.buffer));return fe!=null&&fe.frame&&(ce.data=fe==null?void 0:fe.frame),H=fe,ce}));_.data=te.buffer}}else H=Xj(I),H&&(_.data=H.frame.buffer);if(w.enqueue(_),!H)return;const $=H.tlv.find(ne=>ne.tag===mh.METADATA);$&&x&&$.value instanceof Uint8Array&&x($.value);const G=H.tlv.find(ne=>ne.tag===mh.AUDIO_64_BIT_PTS);G&&A&&G.value instanceof Uint8Array&&G.value.length==8&&A(new DataView(G.value.buffer).getBigUint64(0,!0))}(m,y,a.onMetadata,a.onPts):y.enqueue(m)}});d.readable.pipeThrough(f).pipeTo(d.writable)}else{if(typeof RTCRtpScriptTransform>"u")return void F.warning("browser not support RTCRtpScriptTransform");const d=tT(),f=new MessageChannel;await new Ge(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"audio-metadata-rx",port:f.port2},[f.port2]);r.transform=m,await new Ge(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),f.port1.onmessage=y=>{var _;y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id?(F.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l)):y.data.metadata&&s.onMetadata?s.onMetadata(y.data.metadata):y.data.pts&&s.onPts&&s.onPts(y.data.pts)},s.worker=d}function l(){r.track.removeEventListener("ended",l),function(d){const f=cT.get(d);if(f){(function(_){const w=jg.get(_);w&&(jg.delete(_),sl&&(sl.removeSpeakers([w]),jg.size===0&&(sl.destroy(),sl=null)))})(d),J7(d.track.id),cT.delete(d);try{var m,y;(m=f.controller)===null||m===void 0||m.terminate(),(y=f.worker)===null||y===void 0||y.terminate()}catch(_){F.warning(_&&_.message)}}}(r)}cT.set(r,s),r.track.addEventListener("ended",l)},interceptLocalVideoFrame:async function(r,a){if(!un().supportWebRTCEncodedTransform)return void F.warning("browser not support video encoded transform");if(lT.has(r)||!r.track)return;const s={track:r.track};if(rd()){if(!r.createEncodedStreams)return void F.warning("browser not support createEncodedStreams() API");let d=null;try{d=r.createEncodedStreams()}catch(y){return void F.error("create video-encoded-streams error",y&&y.message)}const f=[];a.on("sei-to-send",y=>{f.push(y)});const m=new TransformStream({transform(y,_){s.controller||(s.controller=_),r.track&&r.track.id!==s.track.id&&(F.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l));const w=eK(new Uint8Array(y.data)),x=f.shift();if(x){const A=function(I,L,H){switch(H){case eD:return function($,G){const ne=Q7(G),te=ne.length,ce=Math.floor(te/255),pe=te%255,fe=new Uint8Array(6+ce+1+te+$.byteLength);fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe[4]=6,fe[5]=101;let ue=0;for(;ue<ce;)fe[6+ue]=255,ue++;return fe[6+ue]=pe,ue++,fe.set(ne,6+ue),fe.set(new Uint8Array($),6+ue+te),fe.buffer}(I,L);case tD:return function($,G){const ne=Q7(G),te=ne.length,ce=Math.floor(te/255),pe=te%255,fe=new Uint8Array(7+ce+1+te+1+$.byteLength);fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe[4]=78,fe[5]=1,fe[6]=101;let ue=0;for(;ue<ce;)fe[7+ue]=255,ue++;return fe[7+ue]=pe,ue++,fe.set(ne,7+ue),ue+=te,fe[7+ue]=128,ue++,fe.set(new Uint8Array($),7+ue),fe.buffer}(I,L);default:return null}}(y.data,x,w);A&&(y.data=A)}_.enqueue(y)}});d.readable.pipeThrough(m).pipeTo(d.writable)}else{if(!ji())return;{if(typeof RTCRtpScriptTransform>"u")return void F.warning("browser not support RTCRtpScriptTransform");const d=tT(),f=new MessageChannel;await new Ge(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"sei-tx",port:f.port2},[f.port2]);r.transform=m,await new Ge(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),a.on("sei-to-send",y=>{f.port1.postMessage({sei:y})}),f.port1.onmessage=y=>{var _;y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id&&(F.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l))},s.worker=d}}function l(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",l)}const d=lT.get(r);if(d){lT.delete(r);try{var f,m;(f=d.controller)===null||f===void 0||f.terminate(),(m=d.worker)===null||m===void 0||m.terminate()}catch(y){F.warning(y&&y.message)}}}lT.set(r,s),r.track.addEventListener("ended",l)},interceptRemoteVideoFrame:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!un().supportWebRTCEncodedTransform)return void F.warning("browser not support video encoded transform");if(!r.track)return;if(gb.has(r)){const d=gb.get(r);return void(d&&(d.onSei=a.onSei))}const s={track:r.track,onSei:a.onSei};if(rd()){if(!r.createEncodedStreams)return void F.warning("browser not support createEncodedStreams() API");let d=null;try{d=r.createEncodedStreams()}catch(m){return void F.error("create video-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(F.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l));const _=function(w,x){switch(x){case eD:return function(A){const I=new DataView(A.data);let L=0;for(;L+4<A.data.byteLength;){if(I.getUint8(L+0)===0&&I.getUint8(L+1)===0&&I.getUint8(L+2)===0&&I.getUint8(L+3)===1&&I.getUint8(L+4)===6){let H=L+6,$=0,G=0;for(;(G=I.getUint8(H++))===255;)$+=255;$+=G;const ne=Z7(A.data,H,$);return new Uint8Array(ne)}L++}return null}(w);case tD:return function(A){const I=new DataView(A.data);let L=0;for(;L+5<A.data.byteLength;){if(I.getUint8(L+0)===0&&I.getUint8(L+1)===0&&I.getUint8(L+2)===0&&I.getUint8(L+3)===1&&I.getUint8(L+4)===78&&I.getUint8(L+5)===1&&I.getUint8(L+6)===101){let H=L+7,$=0,G=0;for(;(G=I.getUint8(H++))===255;)$+=255;$+=G;const ne=Z7(A.data,H,$);return new Uint8Array(ne)}L++}return null}(w);default:return null}}(m,eK(new Uint8Array(m.data)));_&&s.onSei&&s.onSei(_),y.enqueue(m)}});d.readable.pipeThrough(f).pipeTo(d.writable)}else if(ji()){if(typeof RTCRtpScriptTransform>"u")return void F.warning("browser not support RTCRtpScriptTransform");const d=tT(),f=new MessageChannel;await new Ge(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"sei-rx",port:f.port2},[f.port2]);r.transform=m,await new Ge(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),f.port1.onmessage=y=>{var _;y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id?(F.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l)):y.data.sei&&s.onSei&&s.onSei(y.data.sei)},s.worker=d}function l(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",l)}(function(d){const f=gb.get(d);if(f){gb.delete(d);try{var m,y;(m=f.controller)===null||m===void 0||m.terminate(),(y=f.worker)===null||y===void 0||y.terminate()}catch(_){F.warning(_&&_.message)}}})(r)}gb.set(r,s),r.track.addEventListener("ended",l)}},Mke={name:"InterceptFrame",create:()=>Lke};Tj(),An("PROCESS_ID","process-".concat(Mn(8,""),"-").concat(Mn(4,""),"-").concat(Mn(4,""),"-").concat(Mn(4,""),"-").concat(Mn(12,""))),function(){let r;try{r=window.localStorage.getItem("websdk_ng_global_parameter")}catch(a){return void F.error("Error loading sdk config",a.message)}if(r)try{const a=JSON.parse(window.atob(r)),s=Date.now();F.debug("Loading global parameters from cache",a),Object.keys(a).forEach(l=>{if(Object.prototype.hasOwnProperty.call(Zn,l)){const{value:d,expires:f}=a[l];if(f&&f<=s)return;al[l]=d,Zn[l]=d}})}catch(a){F.error("Error loading mutableParamsCache: ".concat(r),a.message)}}(),Array.isArray(al.AREAS)&&al.AREAS.length>0&&bD(al.AREAS,!0);const ZX=(r,a,s)=>{F.debug("setParameter key:".concat(r,", value:").concat(JSON.stringify(a))),An(r,a,s)};Sh(ske,!1),Sh(lke,!1),Sh($Oe,!1),Sh(bke,!1),Sh(rke,!1),Sh(Pke,!1),Sh(Dke,!1),Sh(Mke,!1);const Hr=function(r){const a=new lr,s=r,l={getListeners:a.getListeners.bind(a),on:(d,f)=>(function(m,y){m===su.SECURITY_POLICY_VIOLATION&&PY(y,!0)}(d,f),a.on.bind(a)(d,f)),addListener:a.addListener.bind(a),once:a.once.bind(a),off:a.off.bind(a),removeAllListeners:a.removeAllListeners.bind(a),emit:a.emit.bind(a),safeEmit:a.safeEmit.bind(a)};return OY(OY({},s),l)}({__TRACK_LIST__:Tg,VERSION:Co,BUILD:Nj,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:ZX,getParameter:se,getSupportedCodec:async function(){let r={audio:[],video:[]};try{let a=new RTCPeerConnection;const s=await async function(l){let d;return un().supportUnifiedPlan?(l.addTransceiver("video",{direction:"recvonly"}),l.addTransceiver("audio",{direction:"recvonly"}),d=(await l.createOffer()).sdp):d=(await l.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,d}(a);if(!s)return r;a.close(),a=null,r=function(l){const d={video:[],audio:[]};return l.match(/ VP8/i)&&d.video.push("VP8"),l.match(/ VP9/i)&&d.video.push("VP9"),l.match(/ AV1/i)&&d.video.push("AV1"),l.match(/ H264/i)&&d.video.push("H264"),l.match(/ H265/i)&&d.video.push("H265"),l.match(/ opus/i)&&d.audio.push("OPUS"),l.match(/ PCMU/i)&&d.audio.push("PCMU"),l.match(/ PCMA/i)&&d.audio.push("PCMA"),l.match(/ G722/i)&&d.audio.push("G722"),d}(s)}catch(a){throw new Ee(ie.CREATE_OFFER_FAILED,a.toString&&a.toString()).print()}return r},checkSystemRequirements:function(){const r=nt.reportApiInvoke(null,{name:Er.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:rr.TRACER});let a=!1;try{const f=window.RTCPeerConnection,m=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,y=window.WebSocket;a=!!(f&&m&&y),a&&uj()&&ZH(75)&&new f().close()}catch(f){return F.error("check system requirement failed: ",f),!1}let s=!1;const l=sn();l.name===pn.CHROME&&Number(l.version)>=58&&(nl.engine.name!=="WebKit"||function(){const f=sn();if(Ux()){if(f.os===oi.MAC_OS)return!0;if(f.os===oi.IOS){const m=nl.os.version&&nl.os.version.split(".");if(m&&Number(m[0])===14&&m[1]&&Number(m[1])>=3||m&&Number(m[0])>14)return!0}}return!1}())&&(s=!0),(l.name===pn.FIREFOX&&Number(l.version)>=56||l.name===pn.OPERA&&Number(l.version)>=45||l.name===pn.SAFARI&&Number(l.version)>=11||l.name==="WebKit"&&(oa()||fc())&&l.osVersion&&Number(l.osVersion.split(".")[0])>=11||iz()||sn().name===pn.QQ)&&(s=!0),F.debug("checkSystemRequirements, api:",a,"browser",s);const d=a&&s;return r.onSuccess(d),d},getDevices:function(r){return no.enumerateDevices(!0,!0,r)},getMicrophones:function(r){return no.getRecordingDevices(r)},getCameras:function(r){return no.getCamerasDevices(r)},getElectronScreenSources:Zz,getPlaybackDevices:function(r){return no.getSpeakers(r)},createClient:function(){var r;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const s=Mn(5,"client-"),l=nt.reportApiInvoke(null,{id:s,name:Er.CREATE_CLIENT,options:[a],tag:rr.TRACER});try{(function(d){ni(d.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),ni(d.mode,"config.mode",["rtc","live","p2p"]),d.audioCodec!==void 0&&ni(d.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),d.proxyServer!==void 0&&Ti(d.proxyServer,"config.proxyServer",1,1e4),d.turnServer!==void 0&&hz(d.turnServer),d.httpRetryConfig!==void 0&&dz(d.httpRetryConfig),d.websocketRetryConfig!==void 0&&dz(d.websocketRetryConfig)})(a)}catch(d){throw l.onError(d),d}return(tz(16,0)||oj(16,0,!0))&&(a.codec==="vp9"&&(a.codec="vp8",F.debug("browser not support vp9, force use vp8")),An("UNSUPPORTED_VIDEO_CODEC",["vp9"])),a.audioCodec===void 0&&(a.audioCodec="opus"),l.onSuccess(),new WOe(wc(wc({forceWaitGatewayResponse:!0},a),{},{role:Ve(r=["rtc","p2p"]).call(r,a.mode)?"host":a.role||"audience"}),s)},createCameraVideoTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=se("CAMERA_CAPTURE_CONFIG"),s=Mn(8,"track-cam-"),l=nt.reportApiInvoke(null,{id:s,tag:rr.TRACER,name:Er.CREATE_CAM_VIDEO_TRACK,options:[Bn({},r),a]});a&&(r.encoderConfig=a);const d=Qx(r);let f=null;F.info("start create camera video track with config",JSON.stringify(r),"trackId",s);try{f=(await to({video:d},s)).getVideoTracks()[0]||null}catch(y){throw l.onError(y),y}if(!f){const y=new Se(ie.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(y),y.throw(F)}if(r.optimizationMode&&zj(s,f,r,gc(r.encoderConfig)),se("USE_STANDARD_BITRATE_DEFAULT")){const y=gc(r.encoderConfig);r.encoderConfig=y,delete y.bitrateMax,delete y.bitrateMin}const m=new eT(f,r,d,r.scalabiltyMode?Yx(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,s);return l.onSuccess(m.getTrackId()),F.info("create camera video success, trackId:",s),m},createCustomVideoTrack:function(r){const a=Mn(8,"track-cus-"),s=nt.reportApiInvoke(null,{id:a,tag:rr.TRACER,name:Er.CREATE_CUSTOM_VIDEO_TRACK,options:[r]});se("USE_STANDARD_BITRATE_DEFAULT")&&(delete r.bitrateMax,delete r.bitrateMin);const l=new Wn(r.mediaStreamTrack,{width:r.width,height:r.height,frameRate:r.frameRate,bitrateMax:r.bitrateMax,bitrateMin:r.bitrateMin},r.scalabiltyMode?Yx(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,a,[jn.CUSTOM_TRACK]);return s.onSuccess(l.getTrackId()),F.info("create custom video track success with config",r,"trackId",l.getTrackId()),l},createScreenVideoTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const s=typeof a=="object"?function(I){return c9(I)}(a):void 0;s&&(a="auto");const l=Mn(8,"track-scr-v-"),d=nt.reportApiInvoke(null,{id:l,tag:rr.TRACER,name:Er.CREATE_SCREEN_VIDEO_TRACK,options:[Bn({},r),a]});r.encoderConfig?typeof r.encoderConfig=="string"||r.encoderConfig.width&&r.encoderConfig.height||(r.encoderConfig.width={max:1920},r.encoderConfig.height={max:1080}):r.encoderConfig="1080p_2";const f=function(I){const L={};I.screenSourceType&&(L.mediaSource=I.screenSourceType),I.extensionId&&rd()&&(L.extensionId=I.extensionId);const{displaySurface:H,selfBrowserSurface:$,surfaceSwitching:G,systemAudio:ne,preferCurrentTab:te}=I;(gg(107)||aj(107)||cj(93))&&(H&&(ni(H,"displaySurface",["browser","window","monitor"]),L.displaySurface=H),$?(ni($,"selfBrowserSurface",["exclude","include"]),L.selfBrowserSurface=$):L.selfBrowserSurface="include",G&&(ni(G,"surfaceSwitching",["exclude","include"]),L.surfaceSwitching=G)),(gg(105)||aj(105)||cj(91))&&ne&&(ni(ne,"systemAudio",["exclude","include"]),L.systemAudio=ne),(gg(94)||aj(94)||cj(80))&&te&&(L.preferCurrentTab=!0),I.electronScreenSourceId&&(L.sourceId=I.electronScreenSourceId);const ce=I.encoderConfig?jj(I.encoderConfig):null;return L.mandatory={chromeMediaSource:"desktop",maxWidth:ce?ce.width:void 0,maxHeight:ce?ce.height:void 0},ce&&(ce.frameRate&&(typeof ce.frameRate=="number"?(L.mandatory.maxFrameRate=ce.frameRate,L.mandatory.minFrameRate=ce.frameRate):(L.mandatory.maxFrameRate=ce.frameRate.max||ce.frameRate.ideal||ce.frameRate.exact||void 0,L.mandatory.minFrameRate=ce.frameRate.min||ce.frameRate.ideal||ce.frameRate.exact||void 0),L.frameRate=ce.frameRate),ce.width&&(L.width=ce.width),ce.height&&(L.height=ce.height)),L}(r);let m=null,y=null;const _=un();if(!_.supportShareAudio&&a==="enable"){const I=new Se(ie.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return d.onError(I),I.throw(F)}F.info("start create screen video track with config",r,"withAudio",a,"trackId",l);const w=_.supportShareAudio&&a!=="disable";try{const I=await to({screen:f,screenAudio:w?s||!0:void 0},l);m=I.getVideoTracks()[0]||null,y=I.getAudioTracks()[0]||null}catch(I){throw d.onError(I),I}if(!m){const I=new Se(ie.UNEXPECTED_ERROR,"can not find track in media stream");return d.onError(I),I.throw(F)}if(!y&&a==="enable"){m&&m.stop();const I=new Se(ie.SHARE_AUDIO_NOT_ALLOWED);return d.onError(I),I.throw(F)}r.optimizationMode||(r.optimizationMode="detail"),r.optimizationMode&&(zj(l,m,r,r.encoderConfig&&jj(r.encoderConfig)||void 0),r.encoderConfig&&typeof r.encoderConfig!="string"&&(r.encoderConfig.bitrateMin=r.encoderConfig.bitrateMax));const x=new Wn(m,r.encoderConfig?jj(r.encoderConfig):{},r.scalabiltyMode?Yx(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,l,[jn.SCREEN_TRACK]);if(!y)return d.onSuccess(x.getTrackId()),F.info("create screen video track success","video:",x.getTrackId()),x;const A=new vr(y,void 0,Mn(8,"track-scr-a-"),!1);return d.onSuccess([x.getTrackId(),A.getTrackId()]),F.info("create screen video track success","video:",x.getTrackId(),"audio:",A.getTrackId()),[x,A]},createMicrophoneAndCameraTracks:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=se("CAMERA_CAPTURE_CONFIG"),l=Mn(8,"track-mic-"),d=Mn(8,"track-cam-"),f=nt.reportApiInvoke(null,{id:"".concat(l,"-").concat(d),tag:rr.TRACER,name:Er.CREATE_MIC_AND_CAM_TRACKS,options:[r,a,s]});s&&(a.encoderConfig=s);const m=Qx(a),y=l9(r);let _=null,w=null;F.info("start create camera video track(".concat(d,") and microphone audio track(").concat(l,") with config, audio: ").concat(JSON.stringify(r),", video: ").concat(JSON.stringify(a)));try{const I=await to({audio:y,video:m},"".concat(l,"-").concat(d));_=I.getAudioTracks()[0],w=I.getVideoTracks()[0]}catch(I){throw f.onError(I),I}if(!_||!w){const I=new Se(ie.UNEXPECTED_ERROR,"can not find tracks in media stream");return f.onError(I),I.throw(F)}if(a.optimizationMode&&zj(d,w,a,gc(a.encoderConfig)),se("USE_STANDARD_BITRATE_DEFAULT")){const I=gc(a.encoderConfig);a.encoderConfig=I,delete I.bitrateMax,delete I.bitrateMin}const x=new mb(_,r,y,l),A=new eT(w,a,m,a.scalabiltyMode?Yx(a.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},a.optimizationMode,d);return f.onSuccess([x.getTrackId(),A.getTrackId()]),F.info("create camera video track(".concat(d,") and microphone audio track(").concat(l,") success")),[x,A]},createMicrophoneAudioTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=Mn(8,"track-mic-"),s=nt.reportApiInvoke(null,{id:a,tag:rr.TRACER,name:Er.CREATE_MIC_AUDIO_TRACK,options:[r]}),l=l9(r);let d=null;F.info("start create microphone audio track with config",JSON.stringify(r),"trackId",a);try{d=(await to({audio:l},a)).getAudioTracks()[0]||null}catch(m){throw s.onError(m),m}if(!d){const m=new Se(ie.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(m),m.throw(F)}const f=new mb(d,r,l,a);return s.onSuccess(f.getTrackId()),F.info("create microphone audio track success, trackId:",a),f},createCustomAudioTrack:function(r){const a=Mn(8,"track-cus-"),s=nt.reportApiInvoke(null,{id:a,tag:rr.TRACER,name:Er.CREATE_CUSTOM_AUDIO_TRACK,options:[r]}),l=new vr(r.mediaStreamTrack,r.encoderConfig?Xx(r.encoderConfig):{},a,!1);return F.info("create custom audio track success with config",r,"trackId",l.getTrackId()),s.onSuccess(l.getTrackId()),l},createBufferSourceAudioTrack:async function(r){var a;const{cacheOnlineFile:s,encoderConfig:l}=r;let{source:d}=r;const f={source:d instanceof AudioBuffer?"AudioBuffer":d instanceof File?(a=File.name)!==null&&a!==void 0?a:"File":d,cacheOnlineFile:s,encoderConfig:l},m=Mn(8,"track-buf-"),y=nt.reportApiInvoke(null,{id:m,tag:rr.TRACER,name:Er.CREATE_BUFFER_AUDIO_TRACK,options:[f]});if(se("DISABLE_WEBAUDIO"))throw new Se(ie.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");F.info("start create buffer source audio track with config",JSON.stringify(f),"trackId",m);const _=d;if(!(d instanceof AudioBuffer))try{d=await async function(A,I){let L=null;if(typeof A=="string"){const $=Y9.get(A);if($)return F.debug("use cached audio resource: ",A),$;try{L=(await il(()=>Ka.get(A,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(G){throw new Se(ie.FETCH_AUDIO_FILE_FAILED,G.toString())}}else L=await new Ge((G,ne)=>{const te=new FileReader;te.onload=ce=>{ce.target?G(ce.target.result):ne(new Se(ie.READ_LOCAL_AUDIO_FILE_ERROR))},te.onerror=()=>{ne(new Se(ie.READ_LOCAL_AUDIO_FILE_ERROR))},te.readAsArrayBuffer(A)});const H=await function($){const G=Ig();return new Ge((ne,te)=>{G.decodeAudioData($,ce=>{ne(ce)},ce=>{te(new Se(ie.DECODE_AUDIO_FILE_FAILED,ce.toString()))})})}(L);return typeof A=="string"&&I&&Y9.set(A,H),H}(d,s)}catch(A){return y.onError(A),A.throw(F)}const w=new uIe(d),x=new lIe(_,w,l?Xx(l):{},m);return F.info("create buffer source audio track success, trackId:",m),y.onSuccess(x.getTrackId()),x},setAppType:function(r){if(F.debug("setAppType: ".concat(r)),!(Number.isInteger(r)&&r>=0))throw F.debug("Invalid appType"),new Ee(ie.INVALID_PARAMS,"invalid app type",r);An("APP_TYPE",Math.floor(r))},setLogLevel:function(r){F.setLogLevel(r)},enableLogUpload:function(){se("USE_NEW_LOG")?An("UPLOAD_LOG",!0):F.enableLogUpload()},disableLogUpload:function(){se("USE_NEW_LOG")?An("UPLOAD_LOG",!1):F.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new ZK},checkAudioTrackIsActive:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=nt.reportApiInvoke(null,{tag:rr.TRACER,name:Er.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[a]});if(!(r instanceof vr||r instanceof kg)){const _=new Ee(ie.INVALID_TRACK,"the parameter is not a audio track");return s.onError(_),_.throw()}a&&a<1e3&&(a=1e3);const l=r instanceof vr?r.getTrackLabel():"remote_track",d=r.getVolumeLevel();let f=d,m=d;const y=Date.now();return new Ge(_=>{const w=setInterval(()=>{const x=r.getVolumeLevel();f=x>f?x:f,m=x<m?x:m;const A=f-m>1e-4,I=Date.now()-y;if(A||I>a){clearInterval(w);const L=A,H={duration:I,deviceLabel:l,maxVolumeLevel:f,result:L};F.info("[track-".concat(r.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(H))),s.onSuccess(H),_(L)}},200)})},checkVideoTrackIsActive:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=nt.reportApiInvoke(null,{tag:rr.TRACER,name:Er.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[a]});if(!(r instanceof Wn||r instanceof Pg)){const A=new Ee(ie.INVALID_TRACK,"the parameter is not a video track");return s.onError(A),A.throw()}a&&a<1e3&&(a=1e3);const l=r instanceof Wn?r.getTrackLabel():"remote_track",d=r.getMediaStreamTrack(!0),f=document.createElement("video");f.style.width="1px",f.style.height="1px",f.setAttribute("muted",""),f.muted=!0,f.setAttribute("playsinline",""),f.controls=!1,(ji()||Ux())&&(f.style.opacity="0.01",f.style.position="fixed",f.style.left="0",f.style.top="0",document.body.appendChild(f)),f.srcObject=new MediaStream([d]),f.play();const m=document.createElement("canvas");m.width=160,m.height=120;let y=0,_=0;try{const A=Date.now();y=await function(I,L,H,$){let G,ne=0,te=null;return new Ge((ce,pe)=>{function fe(){ne>$&&G&&(G(),ce(ne));const ue=H.getContext("2d");if(!ue){const Ae=new Ee(ie.UNEXPECTED_ERROR,"can not get canvas 2d context.");return F.error(Ae.toString()),void pe(Ae)}ue.drawImage(I,0,0,160,120);const ye=ue.getImageData(0,0,H.width,H.height),xe=Math.floor(ye.data.length/3);if(te){for(let Ae=0;Ae<xe;Ae+=3)if(ye.data[Ae]!==te[Ae])return ne+=1,void(te=ye.data);te=ye.data}else te=ye.data}setTimeout(()=>{G&&(G(),ce(ne))},L),G=Fj(()=>{fe()},30)})}(f,a,m,4),_=Date.now()-A}catch(A){throw s.onError(A),A}AOe===pn.SAFARI&&(f.pause(),f.remove()),f.srcObject=null;const w=y>4,x={duration:_,changedPicNum:y,deviceLabel:l,result:w};return F.info("[track-".concat(r.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(x))),s.onSuccess(x),w},setArea:bD,audioElementPlayCenter:qa,resumeAudioContext:function(){qa.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(r){HOe.processExternalMediaAEC(r)},registerExtensions:function(r){const a=se("PLUGIN_INFO")||[];r.forEach(s=>{"name"in s&&!Ve(a).call(a,s.name)&&a.push(s.name);const l=s;l.__registered__=!0,l.logger.hookLog=F.extLog,l.reporter.hookApiInvoke=nt.extApiInvoke,l.parameters&&Object.keys(l.parameters).forEach(d=>{l.parameters[d]=se(d)})}),ZX("PLUGIN_INFO",a)},ChannelMediaRelayError:Lg,ChannelMediaRelayEvent:od,ChannelMediaRelayState:cs,RemoteStreamFallbackType:nIe,RemoteStreamType:tIe,ConnectionDisconnectedReason:En,AudienceLatencyLevelType:P1e,AREAS:_n,preload:async function(r,a,s,l){return wq(r,a,s,l)}});return Object.defineProperties(Hr,{onAudioAutoplayFailed:{get:()=>ro.onAudioAutoplayFailed,set:r=>{ro.onAudioAutoplayFailed=r}},onAutoplayFailed:{get:()=>ro.onAutoplayFailed,set:r=>{ro.onAutoplayFailed=r}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Hr._onSecurityPolicyViolation,set(r){Hr._onSecurityPolicyViolation=r,PY(r)}},__CLIENT_LIST__:{get:()=>se("SHOW_GLOBAL_CLIENT_LIST")?fp:[]}}),no.on(lp.CAMERA_DEVICE_CHANGED,r=>{F.info("camera device changed",JSON.stringify(r)),Hr.onCameraChanged&&Hr.onCameraChanged(r),Hr.safeEmit(su.CAMERA_CHANGED,r)}),no.on(lp.RECORDING_DEVICE_CHANGED,r=>{F.info("microphone device changed",JSON.stringify(r)),Hr.onMicrophoneChanged&&Hr.onMicrophoneChanged(r),Hr.safeEmit(su.MICROPHONE_CHANGED,r)}),no.on(lp.PLAYOUT_DEVICE_CHANGED,r=>{F.debug("playout device changed",JSON.stringify(r)),Hr.onPlaybackDeviceChanged&&Hr.onPlaybackDeviceChanged(r),Hr.safeEmit(su.PLAYBACK_DEVICE_CHANGED,r)}),qa.onAutoplayFailed=()=>{F.info("detect audio element autoplay failed"),ro.onAudioAutoplayFailed&&ro.onAudioAutoplayFailed()},In.on("autoplay-failed",()=>{F.info("detect webaudio autoplay failed"),ro.onAudioAutoplayFailed&&ro.onAudioAutoplayFailed(),Hr.safeEmit(su.AUTOPLAY_FAILED)}),In.on(Ni.STATE_CHANGE,(r,a)=>{F.info("audio context state changed: ".concat(a," => ").concat(r)),Hr.onAudioContextStateChanged&&Hr.onAudioContextStateChanged(r,a),Hr.safeEmit(su.AUDIO_CONTEXT_STATE_CHANGED,r,a)}),Dr.on(yg.NETWORK_STATE_CHANGE,(r,a)=>{F.info("[network-indicator] network state changed, ".concat(a," => ").concat(r))}),window&&(window.__ARTC__=Hr),Hr})})(Yle);var LBe=Yle.exports;const kR=jr(LBe),MBe="https://api.gada.chat";function UBe({open:e,onOpenChange:t,onStarted:n}){const{user:i,accessToken:o}=st(),u=wt(o),[h,p]=S.useState(""),[g,v]=S.useState("public"),[b,E]=S.useState(""),[T,C]=S.useState(!1),[R,N]=S.useState(null),[O,k]=S.useState(null),j=S.useRef(null),P=S.useRef(null),M=S.useRef(null),D=S.useRef(null),U=S.useRef(null);S.useEffect(()=>{let q=!1;return(async()=>{if(!(!e||R))try{const ee=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});if(q){ee.getTracks().forEach(oe=>oe.stop());return}P.current=ee,j.current&&(j.current.srcObject=ee,await j.current.play().catch(()=>{}))}catch{Ce.error("Could not access camera/microphone")}})(),()=>{q=!0,P.current&&(P.current.getTracks().forEach(ee=>ee.stop()),P.current=null),j.current&&(j.current.pause(),j.current.srcObject=null)}},[e,R]);async function V(){var oe,ae;const q=D.current;if(!q)return null;try{const J=document.createElement("video");J.muted=!0,J.playsInline=!0,J.autoplay=!0;const re=new MediaStream([q.getMediaStreamTrack()]);J.srcObject=re,await J.play().catch(()=>{});const X=((ae=(oe=q.getMediaStreamTrack()).getSettings)==null?void 0:ae.call(oe))||{},de=Number(X.width||J.videoWidth||1280),we=Number(X.height||J.videoHeight||720);if(!de||!we)return null;const ge=1280,Te=720,Pe=document.createElement("canvas");Pe.width=ge,Pe.height=Te;const rt=Pe.getContext("2d");rt.fillStyle="#0b0f19",rt.fillRect(0,0,ge,Te);const dt=de/we,ze=ge/Te;let vt=ge,Be=Te,ot=0,De=0;dt>ze?(vt=ge,Be=Math.round(ge/dt),De=Math.round((Te-Be)/2)):(Be=Te,vt=Math.round(Te*dt),ot=Math.round((ge-vt)/2)),rt.drawImage(J,0,0,de,we,ot,De,vt,Be),rt.fillStyle="#ef4444";const je=100,Mt=40,Ut=12,fn=24,ht=24;return ee(rt,fn,ht,je,Mt,Ut),rt.fill(),rt.font="bold 18px system-ui, -apple-system, Segoe UI, Roboto, Arial",rt.fillStyle="#fff",rt.textBaseline="middle",rt.fillText("LIVE",fn+16,ht+Mt/2),Pe.toDataURL("image/png")}catch{return null}function ee(J,re,X,de,we,ge){J.beginPath(),J.moveTo(re+ge,X),J.arcTo(re+de,X,re+de,X+we,ge),J.arcTo(re+de,X+we,re,X+we,ge),J.arcTo(re,X+we,re,X,ge),J.arcTo(re,X,re+de,X,ge),J.closePath()}}async function z(){const q=b.trim();if(q.startsWith("data:image/"))return q;if(q.length>0)return;const ee=await V();if(ee)return ee;const oe=j.current;if(oe)try{const ae=document.createElement("canvas");return ae.width=640,ae.height=360,ae.getContext("2d").drawImage(oe,0,0,ae.width,ae.height),ae.toDataURL("image/png")}catch{return}}async function W(){if(!T){C(!0);try{const q=O??await jBe({text:h||"Live",privacy:g,userId:(i==null?void 0:i.id)??(i==null?void 0:i.userId)},u);k(q);const ee=await z(),oe=Number((i==null?void 0:i.userId)??(i==null?void 0:i.id)??Date.now()),ae=`live_${oe}_${Date.now()}`;console.log(ee,"thumbnailDataUrlthumbnailDataUrlthumbnailDataUrl");const J=await DBe({postId:q,channelName:ae,agoraUid:oe,thumbnailDataUrl:ee},u);N(J),n==null||n(J);const re=await fetch(`${MBe}/api/live/agora/host-join?postId=${q}`,{credentials:"include",headers:u});if(!re.ok)throw new Error(`Host join failed (${re.status})`);const X=await re.json(),de=kR.createClient({mode:"live",codec:"vp8"});M.current=de,await de.setClientRole("host"),await de.join(X.appId,X.channelName,X.token,X.uid);const we=await kR.createMicrophoneAudioTrack(),ge=await kR.createCameraVideoTrack();if(U.current=we,D.current=ge,await de.publish([we,ge]),j.current){P.current&&(P.current.getTracks().forEach(rt=>rt.stop()),P.current=null,j.current.pause(),j.current.srcObject=null);const Te=j.current.parentElement;Te.innerHTML="";const Pe=document.createElement("div");Pe.style.width="100%",Pe.style.height="260px",Pe.style.background="black",Te.appendChild(Pe),await ge.play(Pe)}Ce.success("Live started")}catch(q){console.error(q),Ce.error((q==null?void 0:q.message)||"Could not start live"),await Q()}finally{C(!1)}}}async function Y(){if(!T){C(!0);try{const q=O;await Q();const ee=await z();q&&await kBe(q,u,ee),Ce.success("Live ended"),N(null),k(null),t(!1)}catch(q){console.error(q),Ce.error((q==null?void 0:q.message)||"Failed to stop live")}finally{C(!1)}}}async function Q(){try{if(D.current){try{await D.current.stop()}catch{}try{await D.current.close()}catch{}}if(U.current){try{await U.current.stop()}catch{}try{await U.current.close()}catch{}}if(D.current=null,U.current=null,M.current){const q=M.current;M.current=null;try{await q.unpublish().catch(()=>{})}catch{}try{await q.leave().catch(()=>{})}catch{}q.removeAllListeners()}}catch{}}S.useEffect(()=>{e||Q()},[e]);const K=R==null?void 0:R.live;return c.jsx(Yo,{open:e,onOpenChange:q=>!T&&t(q),children:c.jsxs(vo,{className:"sm:max-w-[720px]",children:[c.jsx(Xo,{children:c.jsx(Jo,{children:K?"You are live":"Go Live"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("div",{className:"rounded-md overflow-hidden bg-black",children:c.jsx("video",{ref:j,className:"w-full h-[260px] object-contain bg-black",muted:!0,playsInline:!0})}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Title"}),c.jsx(Ne,{value:h,onChange:q=>p(q.target.value),placeholder:"My live…",disabled:!!K})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Privacy"}),c.jsxs("select",{className:"mt-1 w-full border rounded-md px-2 py-1 text-sm",value:g,onChange:q=>v(q.target.value),disabled:!!K,children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Thumbnail (optional URL/dataURL — leave blank to auto-capture)"}),c.jsx(Ne,{value:b,onChange:q=>E(q.target.value),placeholder:"/uploads/.../thumb.png or data:image/png;base64,…",disabled:!!K}),c.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:"If blank, we capture a frame from your camera and upload it automatically."})]}),K&&c.jsxs("div",{className:"text-xs text-slate-600 p-2 bg-slate-50 rounded",children:["Channel: ",c.jsx("b",{children:K.channelName||"—"}),c.jsx("br",{}),"UID: ",c.jsx("b",{children:K.agoraUid??"—"})]})]})]}),c.jsx(lm,{children:K?c.jsx(c.Fragment,{children:c.jsx(be,{variant:"destructive",onClick:Y,disabled:T,children:T?"Stopping…":"End Live"})}):c.jsxs(c.Fragment,{children:[c.jsx(be,{variant:"outline",onClick:()=>t(!1),disabled:T,children:"Cancel"}),c.jsx(be,{onClick:W,disabled:T,children:T?"Starting…":"Start Live"})]})})]})})}const FBe="https://api.gada.chat";function VBe(){const{user:e}=st(),{addPost:t}=w1(),[n,i]=S.useState(""),[o,u]=S.useState([]),[h,p]=S.useState([]),[g,v]=S.useState([]),[b,E]=S.useState([]),[T,C]=S.useState(!1),R=S.useRef(null),N=S.useRef(null),[O,k]=S.useState(!1);if(!e)return null;const j=z=>z.split(" ").map(W=>W[0]).join("").toUpperCase();function P(z){u(W=>W.filter((Y,Q)=>Q!==z)),v(W=>W.filter((Y,Q)=>Q!==z))}function M(z){p(W=>W.filter((Y,Q)=>Q!==z)),E(W=>W.filter((Y,Q)=>Q!==z))}const D=z=>{const W=z.target.files;if(!(W!=null&&W.length))return;const Y=Array.from(W);u(Q=>[...Q,...Y]),v(Q=>[...Q,...Y.map(K=>URL.createObjectURL(K))]),z.target.value=""},U=z=>{const W=z.target.files;if(!(W!=null&&W.length))return;const Y=Array.from(W);p(Q=>[...Q,...Y]),E(Q=>[...Q,...Y.map(K=>URL.createObjectURL(K))]),z.target.value=""},V=async z=>{if(z.preventDefault(),!(!n.trim()&&o.length===0&&h.length===0)){C(!0);try{await t(n,o,h),i(""),u([]),p([]),v([]),E([])}catch(W){console.error("Failed to create post:",W)}finally{C(!1)}}};return c.jsxs(Vr,{className:"mb-6",children:[c.jsx(mi,{className:"p-4 md:p-6",children:c.jsx("form",{onSubmit:V,children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3",children:[c.jsxs($i,{className:"mb-3 sm:mb-0 h-10 w-10 flex-shrink-0",children:[c.jsx(Oi,{src:FBe+"/uploads/"+Kn(e.profileImage?e.profileImage:"/profile/defaultavatar.png"),alt:e.username}),c.jsx(Qi,{children:j(e.username)})]}),c.jsxs("div",{className:"flex-1 space-y-4",children:[c.jsx(wi,{placeholder:`What's on your mind, ${e.username.split(" ")[0]}?`,value:n,onChange:z=>i(z.target.value),className:"resize-none min-h-[80px] focus-visible:ring-[#1877F2]"}),g.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2",children:g.map((z,W)=>c.jsxs("div",{className:"relative group rounded-md overflow-hidden",children:[c.jsx("img",{src:z,alt:`preview-${W}`,className:"w-full h-32 object-cover"}),c.jsx(be,{type:"button",variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>P(W),children:c.jsx(go,{className:"h-3 w-3"})})]},W))}),b.length>0&&c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:b.map((z,W)=>c.jsxs("div",{className:"relative group rounded-md overflow-hidden",children:[c.jsx("video",{src:z,controls:!0,className:"w-full h-48 object-cover"}),c.jsx(be,{type:"button",variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>M(W),children:c.jsx(go,{className:"h-3 w-3"})})]},W))}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between pt-2 border-t border-gray-200 space-y-2 sm:space-y-0",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Ne,{ref:R,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:D,id:"image-upload"}),c.jsxs(be,{type:"button",variant:"outline",onClick:()=>{var z;return(z=R.current)==null?void 0:z.click()},className:"flex items-center text-gray-600",disabled:T,children:[c.jsx(Zce,{className:"h-4 w-4 mr-1 text-[#45BD62]"})," Photo"]}),c.jsx(Ne,{ref:N,type:"file",accept:"video/*",multiple:!0,className:"hidden",onChange:U,id:"video-upload"}),c.jsxs(be,{type:"button",variant:"outline",onClick:()=>{var z;return(z=N.current)==null?void 0:z.click()},className:"flex items-center text-gray-600",disabled:T,children:[c.jsx(AN,{className:"h-4 w-4 mr-1 text-[#F3425F]"})," Video"]}),c.jsxs(be,{type:"button",variant:"outline",onClick:()=>k(!0),className:"flex items-center text-gray-600",children:[c.jsx(nle,{className:"h-4 w-4 mr-1 text-[#E12F2F]"})," Go Live"]})]}),c.jsx(be,{type:"submit",disabled:T||!n.trim()&&o.length===0&&h.length===0,className:"bg-[#1877F2] hover:bg-[#166FE5] w-full sm:w-auto",children:T?c.jsxs(c.Fragment,{children:[c.jsx(si,{className:"h-4 w-4 mr-1 animate-spin"}),"Posting..."]}):"Post"})]})]})]})})}),c.jsx(UBe,{open:O,onOpenChange:k,postId:null})]})}var BBe="Separator",fQ="horizontal",$Be=["horizontal","vertical"],Zle=S.forwardRef((e,t)=>{const{decorative:n,orientation:i=fQ,...o}=e,u=WBe(i)?i:fQ,p=n?{role:"none"}:{"aria-orientation":u==="vertical"?u:void 0,role:"separator"};return c.jsx(en.div,{"data-orientation":u,...p,...o,ref:t})});Zle.displayName=BBe;function WBe(e){return $Be.includes(e)}var Qle=Zle;const k0=S.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...i},o)=>c.jsx(Qle,{ref:o,decorative:n,orientation:t,className:kt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...i}));k0.displayName=Qle.displayName;function GBe({isOpen:e,onClose:t,children:n}){return S.useEffect(()=>(document.body.style.overflow=e?"hidden":"",()=>{document.body.style.overflow=""}),[e]),e?c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black opacity-50",onClick:t}),c.jsxs("div",{className:"relative bg-white rounded-lg p-6 shadow-lg max-w-md w-full z-10",children:[c.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700",children:c.jsx(go,{className:"w-5 h-5"})}),n]})]}):null}function eue({isOpen:e,onClose:t,onShare:n}){const[i,o]=S.useState(""),u=async()=>{await n(i.trim()||""),o(""),t()};return c.jsxs(GBe,{isOpen:e,onClose:t,children:[c.jsx("h2",{className:"text-lg font-medium mb-4",children:"Share Post"}),c.jsx(wi,{value:i,onChange:h=>o(h.target.value),placeholder:"Say something about this...",rows:4,className:"w-full"}),c.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[c.jsx(be,{variant:"outline",onClick:t,children:"Cancel"}),c.jsx(be,{onClick:u,disabled:i.trim()==="",children:"Share"})]})]})}function H4(e){const t=e+"CollectionProvider",[n,i]=Vs(t),[o,u]=n(t,{collectionRef:{current:null},itemMap:new Map}),h=N=>{const{scope:O,children:k}=N,j=me.useRef(null),P=me.useRef(new Map).current;return c.jsx(o,{scope:O,itemMap:P,collectionRef:j,children:k})};h.displayName=t;const p=e+"CollectionSlot",g=bf(p),v=me.forwardRef((N,O)=>{const{scope:k,children:j}=N,P=u(p,k),M=Dn(O,P.collectionRef);return c.jsx(g,{ref:M,children:j})});v.displayName=p;const b=e+"CollectionItemSlot",E="data-radix-collection-item",T=bf(b),C=me.forwardRef((N,O)=>{const{scope:k,children:j,...P}=N,M=me.useRef(null),D=Dn(O,M),U=u(b,k);return me.useEffect(()=>(U.itemMap.set(M,{ref:M,...P}),()=>void U.itemMap.delete(M))),c.jsx(T,{[E]:"",ref:D,children:j})});C.displayName=b;function R(N){const O=u(e+"CollectionConsumer",N);return me.useCallback(()=>{const j=O.collectionRef.current;if(!j)return[];const P=Array.from(j.querySelectorAll(`[${E}]`));return Array.from(O.itemMap.values()).sort((U,V)=>P.indexOf(U.ref.current)-P.indexOf(V.ref.current))},[O.collectionRef,O.itemMap])}return[{Provider:h,Slot:v,ItemSlot:C},R,i]}var HBe=S.createContext(void 0);function n_(e){const t=S.useContext(HBe);return e||t||"ltr"}var aL="rovingFocusGroup.onEntryFocus",zBe={bubbles:!1,cancelable:!0},Bw="RovingFocusGroup",[yU,tue,KBe]=H4(Bw),[qBe,r_]=Vs(Bw,[KBe]),[YBe,XBe]=qBe(Bw),nue=S.forwardRef((e,t)=>c.jsx(yU.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(yU.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(JBe,{...e,ref:t})})}));nue.displayName=Bw;var JBe=S.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:o=!1,dir:u,currentTabStopId:h,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:g,onEntryFocus:v,preventScrollOnEntryFocus:b=!1,...E}=e,T=S.useRef(null),C=Dn(t,T),R=n_(u),[N,O]=$d({prop:h,defaultProp:p??null,onChange:g,caller:Bw}),[k,j]=S.useState(!1),P=Ba(v),M=tue(n),D=S.useRef(!1),[U,V]=S.useState(0);return S.useEffect(()=>{const z=T.current;if(z)return z.addEventListener(aL,P),()=>z.removeEventListener(aL,P)},[P]),c.jsx(YBe,{scope:n,orientation:i,dir:R,loop:o,currentTabStopId:N,onItemFocus:S.useCallback(z=>O(z),[O]),onItemShiftTab:S.useCallback(()=>j(!0),[]),onFocusableItemAdd:S.useCallback(()=>V(z=>z+1),[]),onFocusableItemRemove:S.useCallback(()=>V(z=>z-1),[]),children:c.jsx(en.div,{tabIndex:k||U===0?-1:0,"data-orientation":i,...E,ref:C,style:{outline:"none",...e.style},onMouseDown:Tt(e.onMouseDown,()=>{D.current=!0}),onFocus:Tt(e.onFocus,z=>{const W=!D.current;if(z.target===z.currentTarget&&W&&!k){const Y=new CustomEvent(aL,zBe);if(z.currentTarget.dispatchEvent(Y),!Y.defaultPrevented){const Q=M().filter(ae=>ae.focusable),K=Q.find(ae=>ae.active),q=Q.find(ae=>ae.id===N),oe=[K,q,...Q].filter(Boolean).map(ae=>ae.ref.current);aue(oe,b)}}D.current=!1}),onBlur:Tt(e.onBlur,()=>j(!1))})})}),rue="RovingFocusGroupItem",iue=S.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:o=!1,tabStopId:u,children:h,...p}=e,g=Vl(),v=u||g,b=XBe(rue,n),E=b.currentTabStopId===v,T=tue(n),{onFocusableItemAdd:C,onFocusableItemRemove:R,currentTabStopId:N}=b;return S.useEffect(()=>{if(i)return C(),()=>R()},[i,C,R]),c.jsx(yU.ItemSlot,{scope:n,id:v,focusable:i,active:o,children:c.jsx(en.span,{tabIndex:E?0:-1,"data-orientation":b.orientation,...p,ref:t,onMouseDown:Tt(e.onMouseDown,O=>{i?b.onItemFocus(v):O.preventDefault()}),onFocus:Tt(e.onFocus,()=>b.onItemFocus(v)),onKeyDown:Tt(e.onKeyDown,O=>{if(O.key==="Tab"&&O.shiftKey){b.onItemShiftTab();return}if(O.target!==O.currentTarget)return;const k=e3e(O,b.orientation,b.dir);if(k!==void 0){if(O.metaKey||O.ctrlKey||O.altKey||O.shiftKey)return;O.preventDefault();let P=T().filter(M=>M.focusable).map(M=>M.ref.current);if(k==="last")P.reverse();else if(k==="prev"||k==="next"){k==="prev"&&P.reverse();const M=P.indexOf(O.currentTarget);P=b.loop?t3e(P,M+1):P.slice(M+1)}setTimeout(()=>aue(P))}}),children:typeof h=="function"?h({isCurrentTabStop:E,hasTabStop:N!=null}):h})})});iue.displayName=rue;var ZBe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function QBe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function e3e(e,t,n){const i=QBe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return ZBe[i]}function aue(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function t3e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var z4=nue,K4=iue,_U=["Enter"," "],n3e=["ArrowDown","PageUp","Home"],sue=["ArrowUp","PageDown","End"],r3e=[...n3e,...sue],i3e={ltr:[..._U,"ArrowRight"],rtl:[..._U,"ArrowLeft"]},a3e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},$w="Menu",[j0,s3e,o3e]=H4($w),[Cm,oue]=Vs($w,[o3e,Of,r_]),j1=Of(),cue=r_(),[c3e,Rm]=Cm($w),[l3e,Ww]=Cm($w),lue=e=>{const{__scopeMenu:t,open:n=!1,children:i,dir:o,onOpenChange:u,modal:h=!0}=e,p=j1(t),[g,v]=S.useState(null),b=S.useRef(!1),E=Ba(u),T=n_(o);return S.useEffect(()=>{const C=()=>{b.current=!0,document.addEventListener("pointerdown",R,{capture:!0,once:!0}),document.addEventListener("pointermove",R,{capture:!0,once:!0})},R=()=>b.current=!1;return document.addEventListener("keydown",C,{capture:!0}),()=>{document.removeEventListener("keydown",C,{capture:!0}),document.removeEventListener("pointerdown",R,{capture:!0}),document.removeEventListener("pointermove",R,{capture:!0})}},[]),c.jsx(E4,{...p,children:c.jsx(c3e,{scope:t,open:n,onOpenChange:E,content:g,onContentChange:v,children:c.jsx(l3e,{scope:t,onClose:S.useCallback(()=>E(!1),[E]),isUsingKeyboardRef:b,dir:T,modal:h,children:i})})})};lue.displayName=$w;var u3e="MenuAnchor",q4=S.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,o=j1(n);return c.jsx(kw,{...o,...i,ref:t})});q4.displayName=u3e;var Y4="MenuPortal",[d3e,uue]=Cm(Y4,{forceMount:void 0}),due=e=>{const{__scopeMenu:t,forceMount:n,children:i,container:o}=e,u=Rm(Y4,t);return c.jsx(d3e,{scope:t,forceMount:n,children:c.jsx(is,{present:n||u.open,children:c.jsx(jw,{asChild:!0,container:o,children:i})})})};due.displayName=Y4;var Fc="MenuContent",[h3e,X4]=Cm(Fc),hue=S.forwardRef((e,t)=>{const n=uue(Fc,e.__scopeMenu),{forceMount:i=n.forceMount,...o}=e,u=Rm(Fc,e.__scopeMenu),h=Ww(Fc,e.__scopeMenu);return c.jsx(j0.Provider,{scope:e.__scopeMenu,children:c.jsx(is,{present:i||u.open,children:c.jsx(j0.Slot,{scope:e.__scopeMenu,children:h.modal?c.jsx(f3e,{...o,ref:t}):c.jsx(p3e,{...o,ref:t})})})})}),f3e=S.forwardRef((e,t)=>{const n=Rm(Fc,e.__scopeMenu),i=S.useRef(null),o=Dn(t,i);return S.useEffect(()=>{const u=i.current;if(u)return N1(u)},[]),c.jsx(J4,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Tt(e.onFocusOutside,u=>u.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),p3e=S.forwardRef((e,t)=>{const n=Rm(Fc,e.__scopeMenu);return c.jsx(J4,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),m3e=bf("MenuContent.ScrollLock"),J4=S.forwardRef((e,t)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:o,onOpenAutoFocus:u,onCloseAutoFocus:h,disableOutsidePointerEvents:p,onEntryFocus:g,onEscapeKeyDown:v,onPointerDownOutside:b,onFocusOutside:E,onInteractOutside:T,onDismiss:C,disableOutsideScroll:R,...N}=e,O=Rm(Fc,n),k=Ww(Fc,n),j=j1(n),P=cue(n),M=s3e(n),[D,U]=S.useState(null),V=S.useRef(null),z=Dn(t,V,O.onContentChange),W=S.useRef(0),Y=S.useRef(""),Q=S.useRef(0),K=S.useRef(null),q=S.useRef("right"),ee=S.useRef(0),oe=R?Vw:S.Fragment,ae=R?{as:m3e,allowPinchZoom:!0}:void 0,J=X=>{var ze,vt;const de=Y.current+X,we=M().filter(Be=>!Be.disabled),ge=document.activeElement,Te=(ze=we.find(Be=>Be.ref.current===ge))==null?void 0:ze.textValue,Pe=we.map(Be=>Be.textValue),rt=R3e(Pe,de,Te),dt=(vt=we.find(Be=>Be.textValue===rt))==null?void 0:vt.ref.current;(function Be(ot){Y.current=ot,window.clearTimeout(W.current),ot!==""&&(W.current=window.setTimeout(()=>Be(""),1e3))})(de),dt&&setTimeout(()=>dt.focus())};S.useEffect(()=>()=>window.clearTimeout(W.current),[]),C1();const re=S.useCallback(X=>{var we,ge;return q.current===((we=K.current)==null?void 0:we.side)&&A3e(X,(ge=K.current)==null?void 0:ge.area)},[]);return c.jsx(h3e,{scope:n,searchRef:Y,onItemEnter:S.useCallback(X=>{re(X)&&X.preventDefault()},[re]),onItemLeave:S.useCallback(X=>{var de;re(X)||((de=V.current)==null||de.focus(),U(null))},[re]),onTriggerLeave:S.useCallback(X=>{re(X)&&X.preventDefault()},[re]),pointerGraceTimerRef:Q,onPointerGraceIntentChange:S.useCallback(X=>{K.current=X},[]),children:c.jsx(oe,{...ae,children:c.jsx(Fw,{asChild:!0,trapped:o,onMountAutoFocus:Tt(u,X=>{var de;X.preventDefault(),(de=V.current)==null||de.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:c.jsx(Hy,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:v,onPointerDownOutside:b,onFocusOutside:E,onInteractOutside:T,onDismiss:C,children:c.jsx(z4,{asChild:!0,...P,dir:k.dir,orientation:"vertical",loop:i,currentTabStopId:D,onCurrentTabStopIdChange:U,onEntryFocus:Tt(g,X=>{k.isUsingKeyboardRef.current||X.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(m1,{role:"menu","aria-orientation":"vertical","data-state":Nue(O.open),"data-radix-menu-content":"",dir:k.dir,...j,...N,ref:z,style:{outline:"none",...N.style},onKeyDown:Tt(N.onKeyDown,X=>{const we=X.target.closest("[data-radix-menu-content]")===X.currentTarget,ge=X.ctrlKey||X.altKey||X.metaKey,Te=X.key.length===1;we&&(X.key==="Tab"&&X.preventDefault(),!ge&&Te&&J(X.key));const Pe=V.current;if(X.target!==Pe||!r3e.includes(X.key))return;X.preventDefault();const dt=M().filter(ze=>!ze.disabled).map(ze=>ze.ref.current);sue.includes(X.key)&&dt.reverse(),T3e(dt)}),onBlur:Tt(e.onBlur,X=>{X.currentTarget.contains(X.target)||(window.clearTimeout(W.current),Y.current="")}),onPointerMove:Tt(e.onPointerMove,D0(X=>{const de=X.target,we=ee.current!==X.clientX;if(X.currentTarget.contains(de)&&we){const ge=X.clientX>ee.current?"right":"left";q.current=ge,ee.current=X.clientX}}))})})})})})})});hue.displayName=Fc;var g3e="MenuGroup",Z4=S.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return c.jsx(en.div,{role:"group",...i,ref:t})});Z4.displayName=g3e;var v3e="MenuLabel",fue=S.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return c.jsx(en.div,{...i,ref:t})});fue.displayName=v3e;var PN="MenuItem",pQ="menu.itemSelect",D1=S.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:i,...o}=e,u=S.useRef(null),h=Ww(PN,e.__scopeMenu),p=X4(PN,e.__scopeMenu),g=Dn(t,u),v=S.useRef(!1),b=()=>{const E=u.current;if(!n&&E){const T=new CustomEvent(pQ,{bubbles:!0,cancelable:!0});E.addEventListener(pQ,C=>i==null?void 0:i(C),{once:!0}),Doe(E,T),T.defaultPrevented?v.current=!1:h.onClose()}};return c.jsx(pue,{...o,ref:g,disabled:n,onClick:Tt(e.onClick,b),onPointerDown:E=>{var T;(T=e.onPointerDown)==null||T.call(e,E),v.current=!0},onPointerUp:Tt(e.onPointerUp,E=>{var T;v.current||(T=E.currentTarget)==null||T.click()}),onKeyDown:Tt(e.onKeyDown,E=>{const T=p.searchRef.current!=="";n||T&&E.key===" "||_U.includes(E.key)&&(E.currentTarget.click(),E.preventDefault())})})});D1.displayName=PN;var pue=S.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:i=!1,textValue:o,...u}=e,h=X4(PN,n),p=cue(n),g=S.useRef(null),v=Dn(t,g),[b,E]=S.useState(!1),[T,C]=S.useState("");return S.useEffect(()=>{const R=g.current;R&&C((R.textContent??"").trim())},[u.children]),c.jsx(j0.ItemSlot,{scope:n,disabled:i,textValue:o??T,children:c.jsx(K4,{asChild:!0,...p,focusable:!i,children:c.jsx(en.div,{role:"menuitem","data-highlighted":b?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...u,ref:v,onPointerMove:Tt(e.onPointerMove,D0(R=>{i?h.onItemLeave(R):(h.onItemEnter(R),R.defaultPrevented||R.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Tt(e.onPointerLeave,D0(R=>h.onItemLeave(R))),onFocus:Tt(e.onFocus,()=>E(!0)),onBlur:Tt(e.onBlur,()=>E(!1))})})})}),y3e="MenuCheckboxItem",mue=S.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:i,...o}=e;return c.jsx(bue,{scope:e.__scopeMenu,checked:n,children:c.jsx(D1,{role:"menuitemcheckbox","aria-checked":kN(n)?"mixed":n,...o,ref:t,"data-state":eB(n),onSelect:Tt(o.onSelect,()=>i==null?void 0:i(kN(n)?!0:!n),{checkForDefaultPrevented:!1})})})});mue.displayName=y3e;var gue="MenuRadioGroup",[_3e,b3e]=Cm(gue,{value:void 0,onValueChange:()=>{}}),vue=S.forwardRef((e,t)=>{const{value:n,onValueChange:i,...o}=e,u=Ba(i);return c.jsx(_3e,{scope:e.__scopeMenu,value:n,onValueChange:u,children:c.jsx(Z4,{...o,ref:t})})});vue.displayName=gue;var yue="MenuRadioItem",_ue=S.forwardRef((e,t)=>{const{value:n,...i}=e,o=b3e(yue,e.__scopeMenu),u=n===o.value;return c.jsx(bue,{scope:e.__scopeMenu,checked:u,children:c.jsx(D1,{role:"menuitemradio","aria-checked":u,...i,ref:t,"data-state":eB(u),onSelect:Tt(i.onSelect,()=>{var h;return(h=o.onValueChange)==null?void 0:h.call(o,n)},{checkForDefaultPrevented:!1})})})});_ue.displayName=yue;var Q4="MenuItemIndicator",[bue,E3e]=Cm(Q4,{checked:!1}),Eue=S.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:i,...o}=e,u=E3e(Q4,n);return c.jsx(is,{present:i||kN(u.checked)||u.checked===!0,children:c.jsx(en.span,{...o,ref:t,"data-state":eB(u.checked)})})});Eue.displayName=Q4;var w3e="MenuSeparator",wue=S.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return c.jsx(en.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});wue.displayName=w3e;var S3e="MenuArrow",Sue=S.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,o=j1(n);return c.jsx(g1,{...o,...i,ref:t})});Sue.displayName=S3e;var x3e="MenuSub",[txt,xue]=Cm(x3e),LE="MenuSubTrigger",Tue=S.forwardRef((e,t)=>{const n=Rm(LE,e.__scopeMenu),i=Ww(LE,e.__scopeMenu),o=xue(LE,e.__scopeMenu),u=X4(LE,e.__scopeMenu),h=S.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:g}=u,v={__scopeMenu:e.__scopeMenu},b=S.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return S.useEffect(()=>b,[b]),S.useEffect(()=>{const E=p.current;return()=>{window.clearTimeout(E),g(null)}},[p,g]),c.jsx(q4,{asChild:!0,...v,children:c.jsx(pue,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":Nue(n.open),...e,ref:d1(t,o.onTriggerChange),onClick:E=>{var T;(T=e.onClick)==null||T.call(e,E),!(e.disabled||E.defaultPrevented)&&(E.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Tt(e.onPointerMove,D0(E=>{u.onItemEnter(E),!E.defaultPrevented&&!e.disabled&&!n.open&&!h.current&&(u.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{n.onOpenChange(!0),b()},100))})),onPointerLeave:Tt(e.onPointerLeave,D0(E=>{var C,R;b();const T=(C=n.content)==null?void 0:C.getBoundingClientRect();if(T){const N=(R=n.content)==null?void 0:R.dataset.side,O=N==="right",k=O?-5:5,j=T[O?"left":"right"],P=T[O?"right":"left"];u.onPointerGraceIntentChange({area:[{x:E.clientX+k,y:E.clientY},{x:j,y:T.top},{x:P,y:T.top},{x:P,y:T.bottom},{x:j,y:T.bottom}],side:N}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>u.onPointerGraceIntentChange(null),300)}else{if(u.onTriggerLeave(E),E.defaultPrevented)return;u.onPointerGraceIntentChange(null)}})),onKeyDown:Tt(e.onKeyDown,E=>{var C;const T=u.searchRef.current!=="";e.disabled||T&&E.key===" "||i3e[i.dir].includes(E.key)&&(n.onOpenChange(!0),(C=n.content)==null||C.focus(),E.preventDefault())})})})});Tue.displayName=LE;var Cue="MenuSubContent",Rue=S.forwardRef((e,t)=>{const n=uue(Fc,e.__scopeMenu),{forceMount:i=n.forceMount,...o}=e,u=Rm(Fc,e.__scopeMenu),h=Ww(Fc,e.__scopeMenu),p=xue(Cue,e.__scopeMenu),g=S.useRef(null),v=Dn(t,g);return c.jsx(j0.Provider,{scope:e.__scopeMenu,children:c.jsx(is,{present:i||u.open,children:c.jsx(j0.Slot,{scope:e.__scopeMenu,children:c.jsx(J4,{id:p.contentId,"aria-labelledby":p.triggerId,...o,ref:v,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:b=>{var E;h.isUsingKeyboardRef.current&&((E=g.current)==null||E.focus()),b.preventDefault()},onCloseAutoFocus:b=>b.preventDefault(),onFocusOutside:Tt(e.onFocusOutside,b=>{b.target!==p.trigger&&u.onOpenChange(!1)}),onEscapeKeyDown:Tt(e.onEscapeKeyDown,b=>{h.onClose(),b.preventDefault()}),onKeyDown:Tt(e.onKeyDown,b=>{var C;const E=b.currentTarget.contains(b.target),T=a3e[h.dir].includes(b.key);E&&T&&(u.onOpenChange(!1),(C=p.trigger)==null||C.focus(),b.preventDefault())})})})})})});Rue.displayName=Cue;function Nue(e){return e?"open":"closed"}function kN(e){return e==="indeterminate"}function eB(e){return kN(e)?"indeterminate":e?"checked":"unchecked"}function T3e(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function C3e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}function R3e(e,t,n){const o=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,u=n?e.indexOf(n):-1;let h=C3e(e,Math.max(u,0));o.length===1&&(h=h.filter(v=>v!==n));const g=h.find(v=>v.toLowerCase().startsWith(o.toLowerCase()));return g!==n?g:void 0}function N3e(e,t){const{x:n,y:i}=e;let o=!1;for(let u=0,h=t.length-1;u<t.length;h=u++){const p=t[u],g=t[h],v=p.x,b=p.y,E=g.x,T=g.y;b>i!=T>i&&n<(E-v)*(i-b)/(T-b)+v&&(o=!o)}return o}function A3e(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return N3e(n,t)}function D0(e){return t=>t.pointerType==="mouse"?e(t):void 0}var I3e=lue,O3e=q4,P3e=due,k3e=hue,j3e=Z4,D3e=fue,L3e=D1,M3e=mue,U3e=vue,F3e=_ue,V3e=Eue,B3e=wue,$3e=Sue,W3e=Tue,G3e=Rue,L1="DropdownMenu",[H3e,nxt]=Vs(L1,[oue]),Bs=oue(),[z3e,Aue]=H3e(L1),Iue=e=>{const{__scopeDropdownMenu:t,children:n,dir:i,open:o,defaultOpen:u,onOpenChange:h,modal:p=!0}=e,g=Bs(t),v=S.useRef(null),[b,E]=$d({prop:o,defaultProp:u??!1,onChange:h,caller:L1});return c.jsx(z3e,{scope:t,triggerId:Vl(),triggerRef:v,contentId:Vl(),open:b,onOpenChange:E,onOpenToggle:S.useCallback(()=>E(T=>!T),[E]),modal:p,children:c.jsx(I3e,{...g,open:b,onOpenChange:E,dir:i,modal:p,children:n})})};Iue.displayName=L1;var Oue="DropdownMenuTrigger",Pue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...o}=e,u=Aue(Oue,n),h=Bs(n);return c.jsx(O3e,{asChild:!0,...h,children:c.jsx(en.button,{type:"button",id:u.triggerId,"aria-haspopup":"menu","aria-expanded":u.open,"aria-controls":u.open?u.contentId:void 0,"data-state":u.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...o,ref:d1(t,u.triggerRef),onPointerDown:Tt(e.onPointerDown,p=>{!i&&p.button===0&&p.ctrlKey===!1&&(u.onOpenToggle(),u.open||p.preventDefault())}),onKeyDown:Tt(e.onKeyDown,p=>{i||(["Enter"," "].includes(p.key)&&u.onOpenToggle(),p.key==="ArrowDown"&&u.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});Pue.displayName=Oue;var K3e="DropdownMenuPortal",kue=e=>{const{__scopeDropdownMenu:t,...n}=e,i=Bs(t);return c.jsx(P3e,{...i,...n})};kue.displayName=K3e;var jue="DropdownMenuContent",Due=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Aue(jue,n),u=Bs(n),h=S.useRef(!1);return c.jsx(k3e,{id:o.contentId,"aria-labelledby":o.triggerId,...u,...i,ref:t,onCloseAutoFocus:Tt(e.onCloseAutoFocus,p=>{var g;h.current||(g=o.triggerRef.current)==null||g.focus(),h.current=!1,p.preventDefault()}),onInteractOutside:Tt(e.onInteractOutside,p=>{const g=p.detail.originalEvent,v=g.button===0&&g.ctrlKey===!0,b=g.button===2||v;(!o.modal||b)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Due.displayName=jue;var q3e="DropdownMenuGroup",Y3e=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(j3e,{...o,...i,ref:t})});Y3e.displayName=q3e;var X3e="DropdownMenuLabel",Lue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(D3e,{...o,...i,ref:t})});Lue.displayName=X3e;var J3e="DropdownMenuItem",Mue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(L3e,{...o,...i,ref:t})});Mue.displayName=J3e;var Z3e="DropdownMenuCheckboxItem",Uue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(M3e,{...o,...i,ref:t})});Uue.displayName=Z3e;var Q3e="DropdownMenuRadioGroup",e5e=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(U3e,{...o,...i,ref:t})});e5e.displayName=Q3e;var t5e="DropdownMenuRadioItem",Fue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(F3e,{...o,...i,ref:t})});Fue.displayName=t5e;var n5e="DropdownMenuItemIndicator",Vue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(V3e,{...o,...i,ref:t})});Vue.displayName=n5e;var r5e="DropdownMenuSeparator",Bue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(B3e,{...o,...i,ref:t})});Bue.displayName=r5e;var i5e="DropdownMenuArrow",a5e=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx($3e,{...o,...i,ref:t})});a5e.displayName=i5e;var s5e="DropdownMenuSubTrigger",$ue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(W3e,{...o,...i,ref:t})});$ue.displayName=s5e;var o5e="DropdownMenuSubContent",Wue=S.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Bs(n);return c.jsx(G3e,{...o,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Wue.displayName=o5e;var c5e=Iue,l5e=Pue,u5e=kue,Gue=Due,Hue=Lue,zue=Mue,Kue=Uue,que=Fue,Yue=Vue,Xue=Bue,Jue=$ue,Zue=Wue;const tB=c5e,nB=l5e,d5e=S.forwardRef(({className:e,inset:t,children:n,...i},o)=>c.jsxs(Jue,{ref:o,className:kt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...i,children:[n,c.jsx(Lw,{className:"ml-auto h-4 w-4"})]}));d5e.displayName=Jue.displayName;const h5e=S.forwardRef(({className:e,...t},n)=>c.jsx(Zue,{ref:n,className:kt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));h5e.displayName=Zue.displayName;const M1=S.forwardRef(({className:e,sideOffset:t=4,...n},i)=>c.jsx(u5e,{children:c.jsx(Gue,{ref:i,sideOffset:t,className:kt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));M1.displayName=Gue.displayName;const Dc=S.forwardRef(({className:e,inset:t,...n},i)=>c.jsx(zue,{ref:i,className:kt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));Dc.displayName=zue.displayName;const f5e=S.forwardRef(({className:e,children:t,checked:n,...i},o)=>c.jsxs(Kue,{ref:o,className:kt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...i,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Yue,{children:c.jsx(Dw,{className:"h-4 w-4"})})}),t]}));f5e.displayName=Kue.displayName;const p5e=S.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(que,{ref:i,className:kt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Yue,{children:c.jsx(Kce,{className:"h-2 w-2 fill-current"})})}),t]}));p5e.displayName=que.displayName;const m5e=S.forwardRef(({className:e,inset:t,...n},i)=>c.jsx(Hue,{ref:i,className:kt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));m5e.displayName=Hue.displayName;const nf=S.forwardRef(({className:e,...t},n)=>c.jsx(Xue,{ref:n,className:kt("-mx-1 my-1 h-px bg-muted",e),...t}));nf.displayName=Xue.displayName;const g5e=e=>[...new Set(e)],v5e=(e,t)=>e.filter(n=>!t.includes(n)),y5e=(e,t)=>e.filter(n=>t.includes(n)),_5e=e=>typeof e=="bigint"||!Number.isNaN(Number(e))&&Math.floor(Number(e))===e,b5e=e=>typeof e=="bigint"||e>=0&&Number.isSafeInteger(e);function cE(e,t){if(t.length===0)return e;let n;const i=[...e];for(let o=i.length-1,u=0,h=0;o>0;o--,u++){u%=t.length,h+=n=t[u].codePointAt(0);const p=(n+u+h)%o,g=i[o],v=i[p];i[p]=g,i[o]=v}return i}const E5e=(e,t)=>{const n=[];let i=e;if(typeof i=="bigint"){const o=BigInt(t.length);do n.unshift(t[Number(i%o)]),i/=o;while(i>BigInt(0))}else do n.unshift(t[i%t.length]),i=Math.floor(i/t.length);while(i>0);return n},w5e=(e,t)=>e.reduce((n,i)=>{const o=t.indexOf(i);if(o===-1)throw new Error(`The provided ID (${e.join("")}) is invalid, as it contains characters that do not exist in the alphabet (${t.join("")})`);if(typeof n=="bigint")return n*BigInt(t.length)+BigInt(o);const u=n*t.length+o;return Number.isSafeInteger(u)?u:(ede("Unable to decode the provided string, due to lack of support for BigInt numbers in the current environment"),BigInt(n)*BigInt(t.length)+BigInt(o))},0),S5e=/^\+?\d+$/,x5e=e=>{if(!S5e.test(e))return Number.NaN;const t=Number.parseInt(e,10);return Number.isSafeInteger(t)?t:(ede("Unable to encode the provided BigInt string without loss of information due to lack of support for BigInt type in the current environment"),BigInt(e))},T5e=(e,t,n)=>Array.from({length:Math.ceil(e.length/t)},(i,o)=>n(e.slice(o*t,(o+1)*t))),mQ=e=>new RegExp(e.map(t=>Que(t)).sort((t,n)=>n.length-t.length).join("|")),C5e=e=>new RegExp(`^[${e.map(t=>Que(t)).sort((t,n)=>n.length-t.length).join("")}]+$`),Que=e=>e.replace(/[\s#$()*+,.?[\\\]^{|}-]/g,"\\$&"),ede=(e="BigInt is not available in this environment")=>{if(typeof BigInt!="function")throw new TypeError(e)},gQ=16,vQ=3.5,R5e=12,yQ=16,N5e=12,_Q=100;class A5e{constructor(t="",n=0,i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",o="cfhistuCFHISTU"){if(this.minLength=n,typeof n!="number")throw new TypeError(`Hashids: Provided 'minLength' has to be a number (is ${typeof n})`);if(typeof t!="string")throw new TypeError(`Hashids: Provided 'salt' has to be a string (is ${typeof t})`);if(typeof i!="string")throw new TypeError(`Hashids: Provided alphabet has to be a string (is ${typeof i})`);const u=Array.from(t),h=Array.from(i),p=Array.from(o);this.salt=u;const g=g5e(h);if(g.length<gQ)throw new Error(`Hashids: alphabet must contain at least ${gQ} unique characters, provided: ${g.join("")}`);this.alphabet=v5e(g,p);const v=y5e(p,g);this.seps=cE(v,u);let b,E;(this.seps.length===0||this.alphabet.length/this.seps.length>vQ)&&(b=Math.ceil(this.alphabet.length/vQ),b>this.seps.length&&(E=b-this.seps.length,this.seps.push(...this.alphabet.slice(0,E)),this.alphabet=this.alphabet.slice(E))),this.alphabet=cE(this.alphabet,u);const T=Math.ceil(this.alphabet.length/R5e);this.alphabet.length<3?(this.guards=this.seps.slice(0,T),this.seps=this.seps.slice(T)):(this.guards=this.alphabet.slice(0,T),this.alphabet=this.alphabet.slice(T)),this.guardsRegExp=mQ(this.guards),this.sepsRegExp=mQ(this.seps),this.allowedCharsRegExp=C5e([...this.alphabet,...this.guards,...this.seps])}encode(t,...n){const i="";let o=Array.isArray(t)?t:[...t!=null?[t]:[],...n];return o.length===0||(o.every(_5e)||(o=o.map(u=>typeof u=="bigint"||typeof u=="number"?u:x5e(String(u)))),!o.every(b5e))?i:this._encode(o).join("")}decode(t){return!t||typeof t!="string"||t.length===0?[]:this._decode(t)}encodeHex(t){let n=t;switch(typeof n){case"bigint":n=n.toString(yQ);break;case"string":if(!/^[\dA-Fa-f]+$/.test(n))return"";break;default:throw new Error(`Hashids: The provided value is neither a string, nor a BigInt (got: ${typeof n})`)}const i=T5e(n,N5e,o=>Number.parseInt(`1${o}`,16));return this.encode(i)}decodeHex(t){return this.decode(t).map(n=>n.toString(yQ).slice(1)).join("")}isValidId(t){return this.allowedCharsRegExp.test(t)}_encode(t){let{alphabet:n}=this;const i=t.reduce((v,b,E)=>v+(typeof b=="bigint"?Number(b%BigInt(E+_Q)):b%(E+_Q)),0);let o=[n[i%n.length]];const u=[...o],{seps:h}=this,{guards:p}=this;if(t.forEach((v,b)=>{const E=u.concat(this.salt,n);n=cE(n,E);const T=E5e(v,n);if(o.push(...T),b+1<t.length){const C=T[0].codePointAt(0)+b,R=typeof v=="bigint"?Number(v%BigInt(C)):v%C;o.push(h[R%h.length])}}),o.length<this.minLength){const v=(i+o[0].codePointAt(0))%p.length;if(o.unshift(p[v]),o.length<this.minLength){const b=(i+o[2].codePointAt(0))%p.length;o.push(p[b])}}const g=Math.floor(n.length/2);for(;o.length<this.minLength;){n=cE(n,n),o.unshift(...n.slice(g)),o.push(...n.slice(0,g));const v=o.length-this.minLength;if(v>0){const b=v/2;o=o.slice(b,b+this.minLength)}}return o}_decode(t){if(!this.isValidId(t))throw new Error(`The provided ID (${t}) is invalid, as it contains characters that do not exist in the alphabet (${this.guards.join("")}${this.seps.join("")}${this.alphabet.join("")})`);const n=t.split(this.guardsRegExp),i=n.length===3||n.length===2?1:0,o=n[i];if(o.length===0)return[];const u=o[Symbol.iterator]().next().value,h=o.slice(u.length).split(this.sepsRegExp);let p=this.alphabet;const g=[];for(const v of h){const b=[u,...this.salt,...p],E=cE(p,b.slice(0,p.length));g.push(w5e(Array.from(v),E)),p=E}return this._encode(g).join("")!==t?[]:g}}const tde=new A5e("vEauO4VD-wjCuA7bf",10),L0=e=>tde.encode(e),I5e=e=>{const t=tde.decode(e);if(!t.length)throw new Error("Invalid ID");return t[0]},O5e="https://api.gada.chat";function P5e({open:e,postId:t,initialText:n,initialPrivacy:i="public",authKey:o,onClose:u,onSaved:h}){const[p,g]=S.useState(n),[v,b]=S.useState(i),[E,T]=S.useState(!1),C=S.useMemo(()=>E||!p.trim(),[E,p]);async function R(){if(!C){T(!0);try{const N=await fetch(`${O5e}/api/posts/edit/${t}`,{method:"POST",headers:{"Content-Type":"application/json",...o?{Authorization:o}:{}},body:JSON.stringify({text:p.trim(),privacy:v})}),O=await N.json();if(!N.ok)throw new Error((O==null?void 0:O.error)||"Failed to update");Ce.success("Post has been updated successfully"),h(O.post),u()}catch(N){console.error(N)}finally{T(!1)}}}return c.jsx(Yo,{open:e,onOpenChange:N=>!E&&!N&&u(),children:c.jsxs(vo,{className:"sm:max-w-lg",children:[c.jsx(Xo,{children:c.jsx(Jo,{children:"Edit Post"})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(wi,{value:p,onChange:N=>g(N.target.value),rows:6,placeholder:"Update your post…"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-slate-600",children:"Privacy"}),c.jsxs("select",{className:"border rounded-md px-2 py-1 text-sm",value:v,onChange:N=>b(N.target.value),children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]})]}),c.jsxs(lm,{className:"gap-2",children:[c.jsx(be,{variant:"outline",onClick:u,disabled:E,children:"Cancel"}),c.jsx(be,{onClick:R,disabled:C,children:E?"Saving…":"Save changes"})]})]})})}function rB(e){const t=S.useRef({value:e,previous:e});return S.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var iB="Radio",[k5e,nde]=Vs(iB),[j5e,D5e]=k5e(iB),rde=S.forwardRef((e,t)=>{const{__scopeRadio:n,name:i,checked:o=!1,required:u,disabled:h,value:p="on",onCheck:g,form:v,...b}=e,[E,T]=S.useState(null),C=Dn(t,O=>T(O)),R=S.useRef(!1),N=E?v||!!E.closest("form"):!0;return c.jsxs(j5e,{scope:n,checked:o,disabled:h,children:[c.jsx(en.button,{type:"button",role:"radio","aria-checked":o,"data-state":ode(o),"data-disabled":h?"":void 0,disabled:h,value:p,...b,ref:C,onClick:Tt(e.onClick,O=>{o||g==null||g(),N&&(R.current=O.isPropagationStopped(),R.current||O.stopPropagation())})}),N&&c.jsx(sde,{control:E,bubbles:!R.current,name:i,value:p,checked:o,required:u,disabled:h,form:v,style:{transform:"translateX(-100%)"}})]})});rde.displayName=iB;var ide="RadioIndicator",ade=S.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:i,...o}=e,u=D5e(ide,n);return c.jsx(is,{present:i||u.checked,children:c.jsx(en.span,{"data-state":ode(u.checked),"data-disabled":u.disabled?"":void 0,...o,ref:t})})});ade.displayName=ide;var L5e="RadioBubbleInput",sde=S.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:i=!0,...o},u)=>{const h=S.useRef(null),p=Dn(h,u),g=rB(n),v=y4(t);return S.useEffect(()=>{const b=h.current;if(!b)return;const E=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(E,"checked").set;if(g!==n&&C){const R=new Event("click",{bubbles:i});C.call(b,n),b.dispatchEvent(R)}},[g,n,i]),c.jsx(en.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:p,style:{...o.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});sde.displayName=L5e;function ode(e){return e?"checked":"unchecked"}var M5e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],U1="RadioGroup",[U5e,rxt]=Vs(U1,[r_,nde]),cde=r_(),lde=nde(),[F5e,V5e]=U5e(U1),ude=S.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:i,defaultValue:o,value:u,required:h=!1,disabled:p=!1,orientation:g,dir:v,loop:b=!0,onValueChange:E,...T}=e,C=cde(n),R=n_(v),[N,O]=$d({prop:u,defaultProp:o??null,onChange:E,caller:U1});return c.jsx(F5e,{scope:n,name:i,required:h,disabled:p,value:N,onValueChange:O,children:c.jsx(z4,{asChild:!0,...C,orientation:g,dir:R,loop:b,children:c.jsx(en.div,{role:"radiogroup","aria-required":h,"aria-orientation":g,"data-disabled":p?"":void 0,dir:R,...T,ref:t})})})});ude.displayName=U1;var dde="RadioGroupItem",hde=S.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:i,...o}=e,u=V5e(dde,n),h=u.disabled||i,p=cde(n),g=lde(n),v=S.useRef(null),b=Dn(t,v),E=u.value===o.value,T=S.useRef(!1);return S.useEffect(()=>{const C=N=>{M5e.includes(N.key)&&(T.current=!0)},R=()=>T.current=!1;return document.addEventListener("keydown",C),document.addEventListener("keyup",R),()=>{document.removeEventListener("keydown",C),document.removeEventListener("keyup",R)}},[]),c.jsx(K4,{asChild:!0,...p,focusable:!h,active:E,children:c.jsx(rde,{disabled:h,required:u.required,checked:E,...g,...o,name:u.name,ref:b,onCheck:()=>u.onValueChange(o.value),onKeyDown:Tt(C=>{C.key==="Enter"&&C.preventDefault()}),onFocus:Tt(o.onFocus,()=>{var C;T.current&&((C=v.current)==null||C.click())})})})});hde.displayName=dde;var B5e="RadioGroupIndicator",fde=S.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...i}=e,o=lde(n);return c.jsx(ade,{...o,...i,ref:t})});fde.displayName=B5e;var pde=ude,mde=hde,$5e=fde;const gde=S.forwardRef(({className:e,...t},n)=>c.jsx(pde,{className:kt("grid gap-2",e),...t,ref:n}));gde.displayName=pde.displayName;const vde=S.forwardRef(({className:e,...t},n)=>c.jsx(mde,{ref:n,className:kt("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:c.jsx($5e,{className:"flex items-center justify-center",children:c.jsx(Kce,{className:"h-2.5 w-2.5 fill-current text-current"})})}));vde.displayName=mde.displayName;function bU(e,[t,n]){return Math.min(n,Math.max(t,e))}function W5e(e,t){return S.useReducer((n,i)=>t[n][i]??n,e)}var aB="ScrollArea",[yde,ixt]=Vs(aB),[G5e,Hc]=yde(aB),_de=S.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:i="hover",dir:o,scrollHideDelay:u=600,...h}=e,[p,g]=S.useState(null),[v,b]=S.useState(null),[E,T]=S.useState(null),[C,R]=S.useState(null),[N,O]=S.useState(null),[k,j]=S.useState(0),[P,M]=S.useState(0),[D,U]=S.useState(!1),[V,z]=S.useState(!1),W=Dn(t,Q=>g(Q)),Y=n_(o);return c.jsx(G5e,{scope:n,type:i,dir:Y,scrollHideDelay:u,scrollArea:p,viewport:v,onViewportChange:b,content:E,onContentChange:T,scrollbarX:C,onScrollbarXChange:R,scrollbarXEnabled:D,onScrollbarXEnabledChange:U,scrollbarY:N,onScrollbarYChange:O,scrollbarYEnabled:V,onScrollbarYEnabledChange:z,onCornerWidthChange:j,onCornerHeightChange:M,children:c.jsx(en.div,{dir:Y,...h,ref:W,style:{position:"relative","--radix-scroll-area-corner-width":k+"px","--radix-scroll-area-corner-height":P+"px",...e.style}})})});_de.displayName=aB;var bde="ScrollAreaViewport",Ede=S.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:i,nonce:o,...u}=e,h=Hc(bde,n),p=S.useRef(null),g=Dn(t,p,h.onViewportChange);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),c.jsx(en.div,{"data-radix-scroll-area-viewport":"",...u,ref:g,style:{overflowX:h.scrollbarXEnabled?"scroll":"hidden",overflowY:h.scrollbarYEnabled?"scroll":"hidden",...e.style},children:c.jsx("div",{ref:h.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});Ede.displayName=bde;var Ku="ScrollAreaScrollbar",sB=S.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=Hc(Ku,e.__scopeScrollArea),{onScrollbarXEnabledChange:u,onScrollbarYEnabledChange:h}=o,p=e.orientation==="horizontal";return S.useEffect(()=>(p?u(!0):h(!0),()=>{p?u(!1):h(!1)}),[p,u,h]),o.type==="hover"?c.jsx(H5e,{...i,ref:t,forceMount:n}):o.type==="scroll"?c.jsx(z5e,{...i,ref:t,forceMount:n}):o.type==="auto"?c.jsx(wde,{...i,ref:t,forceMount:n}):o.type==="always"?c.jsx(oB,{...i,ref:t}):null});sB.displayName=Ku;var H5e=S.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=Hc(Ku,e.__scopeScrollArea),[u,h]=S.useState(!1);return S.useEffect(()=>{const p=o.scrollArea;let g=0;if(p){const v=()=>{window.clearTimeout(g),h(!0)},b=()=>{g=window.setTimeout(()=>h(!1),o.scrollHideDelay)};return p.addEventListener("pointerenter",v),p.addEventListener("pointerleave",b),()=>{window.clearTimeout(g),p.removeEventListener("pointerenter",v),p.removeEventListener("pointerleave",b)}}},[o.scrollArea,o.scrollHideDelay]),c.jsx(is,{present:n||u,children:c.jsx(wde,{"data-state":u?"visible":"hidden",...i,ref:t})})}),z5e=S.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=Hc(Ku,e.__scopeScrollArea),u=e.orientation==="horizontal",h=V1(()=>g("SCROLL_END"),100),[p,g]=W5e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return S.useEffect(()=>{if(p==="idle"){const v=window.setTimeout(()=>g("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(v)}},[p,o.scrollHideDelay,g]),S.useEffect(()=>{const v=o.viewport,b=u?"scrollLeft":"scrollTop";if(v){let E=v[b];const T=()=>{const C=v[b];E!==C&&(g("SCROLL"),h()),E=C};return v.addEventListener("scroll",T),()=>v.removeEventListener("scroll",T)}},[o.viewport,u,g,h]),c.jsx(is,{present:n||p!=="hidden",children:c.jsx(oB,{"data-state":p==="hidden"?"hidden":"visible",...i,ref:t,onPointerEnter:Tt(e.onPointerEnter,()=>g("POINTER_ENTER")),onPointerLeave:Tt(e.onPointerLeave,()=>g("POINTER_LEAVE"))})})}),wde=S.forwardRef((e,t)=>{const n=Hc(Ku,e.__scopeScrollArea),{forceMount:i,...o}=e,[u,h]=S.useState(!1),p=e.orientation==="horizontal",g=V1(()=>{if(n.viewport){const v=n.viewport.offsetWidth<n.viewport.scrollWidth,b=n.viewport.offsetHeight<n.viewport.scrollHeight;h(p?v:b)}},10);return fy(n.viewport,g),fy(n.content,g),c.jsx(is,{present:i||u,children:c.jsx(oB,{"data-state":u?"visible":"hidden",...o,ref:t})})}),oB=S.forwardRef((e,t)=>{const{orientation:n="vertical",...i}=e,o=Hc(Ku,e.__scopeScrollArea),u=S.useRef(null),h=S.useRef(0),[p,g]=S.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),v=Rde(p.viewport,p.content),b={...i,sizes:p,onSizesChange:g,hasThumb:v>0&&v<1,onThumbChange:T=>u.current=T,onThumbPointerUp:()=>h.current=0,onThumbPointerDown:T=>h.current=T};function E(T,C){return Z5e(T,h.current,p,C)}return n==="horizontal"?c.jsx(K5e,{...b,ref:t,onThumbPositionChange:()=>{if(o.viewport&&u.current){const T=o.viewport.scrollLeft,C=bQ(T,p,o.dir);u.current.style.transform=`translate3d(${C}px, 0, 0)`}},onWheelScroll:T=>{o.viewport&&(o.viewport.scrollLeft=T)},onDragScroll:T=>{o.viewport&&(o.viewport.scrollLeft=E(T,o.dir))}}):n==="vertical"?c.jsx(q5e,{...b,ref:t,onThumbPositionChange:()=>{if(o.viewport&&u.current){const T=o.viewport.scrollTop,C=bQ(T,p);u.current.style.transform=`translate3d(0, ${C}px, 0)`}},onWheelScroll:T=>{o.viewport&&(o.viewport.scrollTop=T)},onDragScroll:T=>{o.viewport&&(o.viewport.scrollTop=E(T))}}):null}),K5e=S.forwardRef((e,t)=>{const{sizes:n,onSizesChange:i,...o}=e,u=Hc(Ku,e.__scopeScrollArea),[h,p]=S.useState(),g=S.useRef(null),v=Dn(t,g,u.onScrollbarXChange);return S.useEffect(()=>{g.current&&p(getComputedStyle(g.current))},[g]),c.jsx(xde,{"data-orientation":"horizontal",...o,ref:v,sizes:n,style:{bottom:0,left:u.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:u.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":F1(n)+"px",...e.style},onThumbPointerDown:b=>e.onThumbPointerDown(b.x),onDragScroll:b=>e.onDragScroll(b.x),onWheelScroll:(b,E)=>{if(u.viewport){const T=u.viewport.scrollLeft+b.deltaX;e.onWheelScroll(T),Ade(T,E)&&b.preventDefault()}},onResize:()=>{g.current&&u.viewport&&h&&i({content:u.viewport.scrollWidth,viewport:u.viewport.offsetWidth,scrollbar:{size:g.current.clientWidth,paddingStart:DN(h.paddingLeft),paddingEnd:DN(h.paddingRight)}})}})}),q5e=S.forwardRef((e,t)=>{const{sizes:n,onSizesChange:i,...o}=e,u=Hc(Ku,e.__scopeScrollArea),[h,p]=S.useState(),g=S.useRef(null),v=Dn(t,g,u.onScrollbarYChange);return S.useEffect(()=>{g.current&&p(getComputedStyle(g.current))},[g]),c.jsx(xde,{"data-orientation":"vertical",...o,ref:v,sizes:n,style:{top:0,right:u.dir==="ltr"?0:void 0,left:u.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":F1(n)+"px",...e.style},onThumbPointerDown:b=>e.onThumbPointerDown(b.y),onDragScroll:b=>e.onDragScroll(b.y),onWheelScroll:(b,E)=>{if(u.viewport){const T=u.viewport.scrollTop+b.deltaY;e.onWheelScroll(T),Ade(T,E)&&b.preventDefault()}},onResize:()=>{g.current&&u.viewport&&h&&i({content:u.viewport.scrollHeight,viewport:u.viewport.offsetHeight,scrollbar:{size:g.current.clientHeight,paddingStart:DN(h.paddingTop),paddingEnd:DN(h.paddingBottom)}})}})}),[Y5e,Sde]=yde(Ku),xde=S.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:i,hasThumb:o,onThumbChange:u,onThumbPointerUp:h,onThumbPointerDown:p,onThumbPositionChange:g,onDragScroll:v,onWheelScroll:b,onResize:E,...T}=e,C=Hc(Ku,n),[R,N]=S.useState(null),O=Dn(t,W=>N(W)),k=S.useRef(null),j=S.useRef(""),P=C.viewport,M=i.content-i.viewport,D=Ba(b),U=Ba(g),V=V1(E,10);function z(W){if(k.current){const Y=W.clientX-k.current.left,Q=W.clientY-k.current.top;v({x:Y,y:Q})}}return S.useEffect(()=>{const W=Y=>{const Q=Y.target;(R==null?void 0:R.contains(Q))&&D(Y,M)};return document.addEventListener("wheel",W,{passive:!1}),()=>document.removeEventListener("wheel",W,{passive:!1})},[P,R,M,D]),S.useEffect(U,[i,U]),fy(R,V),fy(C.content,V),c.jsx(Y5e,{scope:n,scrollbar:R,hasThumb:o,onThumbChange:Ba(u),onThumbPointerUp:Ba(h),onThumbPositionChange:U,onThumbPointerDown:Ba(p),children:c.jsx(en.div,{...T,ref:O,style:{position:"absolute",...T.style},onPointerDown:Tt(e.onPointerDown,W=>{W.button===0&&(W.target.setPointerCapture(W.pointerId),k.current=R.getBoundingClientRect(),j.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",C.viewport&&(C.viewport.style.scrollBehavior="auto"),z(W))}),onPointerMove:Tt(e.onPointerMove,z),onPointerUp:Tt(e.onPointerUp,W=>{const Y=W.target;Y.hasPointerCapture(W.pointerId)&&Y.releasePointerCapture(W.pointerId),document.body.style.webkitUserSelect=j.current,C.viewport&&(C.viewport.style.scrollBehavior=""),k.current=null})})})}),jN="ScrollAreaThumb",Tde=S.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=Sde(jN,e.__scopeScrollArea);return c.jsx(is,{present:n||o.hasThumb,children:c.jsx(X5e,{ref:t,...i})})}),X5e=S.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:i,...o}=e,u=Hc(jN,n),h=Sde(jN,n),{onThumbPositionChange:p}=h,g=Dn(t,E=>h.onThumbChange(E)),v=S.useRef(void 0),b=V1(()=>{v.current&&(v.current(),v.current=void 0)},100);return S.useEffect(()=>{const E=u.viewport;if(E){const T=()=>{if(b(),!v.current){const C=Q5e(E,p);v.current=C,p()}};return p(),E.addEventListener("scroll",T),()=>E.removeEventListener("scroll",T)}},[u.viewport,b,p]),c.jsx(en.div,{"data-state":h.hasThumb?"visible":"hidden",...o,ref:g,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:Tt(e.onPointerDownCapture,E=>{const C=E.target.getBoundingClientRect(),R=E.clientX-C.left,N=E.clientY-C.top;h.onThumbPointerDown({x:R,y:N})}),onPointerUp:Tt(e.onPointerUp,h.onThumbPointerUp)})});Tde.displayName=jN;var cB="ScrollAreaCorner",Cde=S.forwardRef((e,t)=>{const n=Hc(cB,e.__scopeScrollArea),i=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&i?c.jsx(J5e,{...e,ref:t}):null});Cde.displayName=cB;var J5e=S.forwardRef((e,t)=>{const{__scopeScrollArea:n,...i}=e,o=Hc(cB,n),[u,h]=S.useState(0),[p,g]=S.useState(0),v=!!(u&&p);return fy(o.scrollbarX,()=>{var E;const b=((E=o.scrollbarX)==null?void 0:E.offsetHeight)||0;o.onCornerHeightChange(b),g(b)}),fy(o.scrollbarY,()=>{var E;const b=((E=o.scrollbarY)==null?void 0:E.offsetWidth)||0;o.onCornerWidthChange(b),h(b)}),v?c.jsx(en.div,{...i,ref:t,style:{width:u,height:p,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function DN(e){return e?parseInt(e,10):0}function Rde(e,t){const n=e/t;return isNaN(n)?0:n}function F1(e){const t=Rde(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=(e.scrollbar.size-n)*t;return Math.max(i,18)}function Z5e(e,t,n,i="ltr"){const o=F1(n),u=o/2,h=t||u,p=o-h,g=n.scrollbar.paddingStart+h,v=n.scrollbar.size-n.scrollbar.paddingEnd-p,b=n.content-n.viewport,E=i==="ltr"?[0,b]:[b*-1,0];return Nde([g,v],E)(e)}function bQ(e,t,n="ltr"){const i=F1(t),o=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,u=t.scrollbar.size-o,h=t.content-t.viewport,p=u-i,g=n==="ltr"?[0,h]:[h*-1,0],v=bU(e,g);return Nde([0,h],[0,p])(v)}function Nde(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(n-e[0])}}function Ade(e,t){return e>0&&e<t}var Q5e=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},i=0;return function o(){const u={left:e.scrollLeft,top:e.scrollTop},h=n.left!==u.left,p=n.top!==u.top;(h||p)&&t(),n=u,i=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(i)};function V1(e,t){const n=Ba(e),i=S.useRef(0);return S.useEffect(()=>()=>window.clearTimeout(i.current),[]),S.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(n,t)},[n,t])}function fy(e,t){const n=Ba(t);va(()=>{let i=0;if(e){const o=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(n)});return o.observe(e),()=>{window.cancelAnimationFrame(i),o.unobserve(e)}}},[e,n])}var Ide=_de,e$e=Ede,t$e=Cde;const Ode=S.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(Ide,{ref:i,className:kt("relative overflow-hidden",e),...n,children:[c.jsx(e$e,{className:"h-full w-full rounded-[inherit]",children:t}),c.jsx(Pde,{}),c.jsx(t$e,{})]}));Ode.displayName=Ide.displayName;const Pde=S.forwardRef(({className:e,orientation:t="vertical",...n},i)=>c.jsx(sB,{ref:i,orientation:t,className:kt("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:c.jsx(Tde,{className:"relative flex-1 rounded-full bg-border"})}));Pde.displayName=sB.displayName;const kde="https://api.gada.chat";async function n$e(e){const t=await fetch(`${kde}/api/reports/categories`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to load categories");return t.json()}async function r$e(e,t){const n=await fetch(`${kde}/api/reports`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to submit report");return n.json()}function i$e({postId:e,open:t,onOpenChange:n}){const{accessToken:i}=st(),o=wt(i),[u,h]=S.useState(null),[p,g]=S.useState(!1),[v,b]=S.useState(null),[E,T]=S.useState("");S.useEffect(()=>{!t||u||(async()=>{try{const O=await n$e(o);h(Array.isArray(O==null?void 0:O.data)?O.data:[])}catch{Ce.error("Failed to load reasons")}})()},[t,u,o]);function C(){b(null),T("")}async function R(){if(!v){Ce.error("Please choose a reason");return}g(!0);try{await r$e({nodeId:e,nodeType:"post",categoryId:v,reason:E},o),Ce.success("Thanks, we’ve received your report."),n(!1),C()}catch{Ce.error("Could not submit report")}finally{g(!1)}}const N=S.useMemo(()=>(u||[]).filter(O=>O.category_parent_id===0).sort((O,k)=>O.category_order-k.category_order),[u]);return c.jsx(Yo,{open:t,onOpenChange:O=>{n(O),O||C()},children:c.jsxs(vo,{className:"sm:max-w-[520px]",children:[c.jsxs(Xo,{children:[c.jsx(Jo,{children:"Report post"}),c.jsx(t_,{children:"Tell us what’s wrong. Reports are anonymous to the post author."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Je,{className:"mb-2 block",children:"Reason"}),c.jsx(Ode,{className:"h-[220px] rounded border",children:c.jsx(gde,{value:v?String(v):"",onValueChange:O=>b(Number(O)),className:"p-3",children:N.map(O=>c.jsxs("div",{className:"flex items-start gap-3 py-2",children:[c.jsx(vde,{id:`cat-${O.category_id}`,value:String(O.category_id)}),c.jsxs("label",{htmlFor:`cat-${O.category_id}`,className:"cursor-pointer",children:[c.jsx("div",{className:"font-medium",children:O.category_name}),O.category_description&&c.jsx("div",{className:"text-xs text-slate-500",children:O.category_description})]})]},O.category_id))})})]}),c.jsxs("div",{children:[c.jsx(Je,{htmlFor:"report-reason",className:"mb-2 block",children:"Additional details (optional)"}),c.jsx(wi,{id:"report-reason",placeholder:"Add context for our team",value:E,onChange:O=>T(O.target.value),className:"min-h-[90px]"})]})]}),c.jsxs(lm,{children:[c.jsx(be,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),c.jsx(be,{onClick:R,disabled:p,children:p?"Sending…":"Submit report"})]})]})})}function jde({postId:e,open:t,onOpenChange:n}){const{accessToken:i}=st(),o=wt(i),[u,h]=S.useState(null);return S.useEffect(()=>{t&&$ce(e,o).then(h).catch(console.error)},[t,e]),c.jsx(Yo,{open:t,onOpenChange:n,children:c.jsx(vo,{className:"max-w-3xl p-0 overflow-hidden",children:u?c.jsx(Vu,{post:u,trackViews:!1}):c.jsx("div",{className:"p-8",children:"Loading…"})})})}const EQ="https://api.gada.chat";function a$e({open:e,postId:t,onClose:n}){const[i,o]=S.useState(e);S.useEffect(()=>o(e),[e]);const u=S.useRef(null),[h,p]=S.useState(!1),[g,v]=S.useState(null),[b,E]=S.useState(0),T=S.useRef(null),C=S.useRef(null),R=S.useRef(null),N=S.useRef(null),O=S.useRef(!1),k=S.useRef(null),j=S.useRef(null),P=W=>typeof(W==null?void 0:W.message)=="string"&&W.message.includes("OPERATION_ABORTED")||(W==null?void 0:W.code)==="OPERATION_ABORTED",M=()=>{o(!1),O.current=!0,V(),z(),n==null||n()};S.useEffect(()=>{if(!i)return;const W=Y=>{Y.key==="Escape"&&(Y.preventDefault(),M())};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[i]),S.useEffect(()=>{if(!i){O.current=!0,V(),z();return}O.current=!1;let W=!1;return v(null),p(!0),(async()=>{try{const Y=await fetch(`${EQ}/api/live/agora/join-info?postId=${t}`,{credentials:"include"});if(!Y.ok)throw new Error(`join-info ${Y.status}`);const Q=await Y.json();if(W||O.current)return;await D(Q),!W&&!O.current&&U()}catch(Y){P(Y)||(console.error(Y),v((Y==null?void 0:Y.message)||"Failed to start player"))}finally{W||p(!1)}})(),()=>{W=!0,O.current=!0,V(),z()}},[i,t]);async function D(W){const Y=String((W==null?void 0:W.appId)||"").trim(),Q=String((W==null?void 0:W.channelName)||"").trim(),K=Number(W==null?void 0:W.uid),q=(W==null?void 0:W.token)||void 0;if(!Y||!Q||!K&&K!==0)throw new Error("Incomplete join-info (appId/channel/uid)");const ee=kR.createClient({mode:"live",codec:"vp8"});T.current=ee;const oe=async(J,re)=>{if(!(O.current||!T.current)){try{await ee.subscribe(J,re)}catch(X){if(P(X))return;console.error("[subscribe]",X);return}if(!O.current){if(re==="video"&&J.videoTrack&&(C.current=J.videoTrack,u.current)){u.current.innerHTML="";const X=document.createElement("div");X.style.width="100%",X.style.height="100%",u.current.appendChild(X);try{await J.videoTrack.play(X)}catch(de){P(de)||console.error("[video.play]",de)}}if(re==="audio"&&J.audioTrack){R.current=J.audioTrack;try{J.audioTrack.play()}catch(X){P(X)||console.error("[audio.play]",X)}}}}},ae=()=>{var J,re;try{(J=C.current)==null||J.stop()}catch{}try{(re=R.current)==null||re.stop()}catch{}C.current=null,R.current=null};k.current=oe,j.current=ae,ee.on("user-published",oe),ee.on("user-unpublished",ae);try{await ee.setClientRole("audience"),await ee.join(Y,Q,q,K)}catch(J){if(P(J))return;throw J}}function U(){V();const W=async()=>{if(!O.current){try{const Y=await fetch(`${EQ}/api/live/heartbeat`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({postId:t})});if(Y.ok){const Q=await Y.json();typeof Q.viewers=="number"&&E(Q.viewers)}}catch{}O.current||(N.current=window.setTimeout(W,1e4))}};W()}function V(){N.current&&(clearTimeout(N.current),N.current=null)}function z(){var Y,Q;const W=T.current;if(W){k.current&&W.off("user-published",k.current),j.current&&W.off("user-unpublished",j.current),k.current=null,j.current=null;try{(Y=C.current)==null||Y.stop()}catch{}try{(Q=R.current)==null||Q.stop()}catch{}C.current=null,R.current=null,W.leave().catch(K=>{P(K)||console.warn("[client.leave]",K)}),W.removeAllListeners(),T.current=null,u.current&&(u.current.innerHTML="")}}return i?c.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",role:"dialog","aria-modal":"true",onMouseDown:W=>{W.currentTarget===W.target&&M()},children:c.jsxs("div",{className:"w-[min(920px,95vw)] max-h-[90vh] bg-white rounded-2xl shadow-xl overflow-hidden",onMouseDown:W=>W.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Live"}),c.jsx("button",{type:"button",onClick:M,className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:c.jsx(go,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"p-4",children:c.jsx("div",{ref:u,className:"w-full h-[420px] bg-black text-white grid place-items-center rounded-lg overflow-hidden",children:h?c.jsx("span",{className:"opacity-80",children:"Connecting…"}):g?c.jsx("span",{className:"text-red-400",children:g}):c.jsx("span",{className:"opacity-60",children:"Waiting for video…"})})}),c.jsxs("div",{className:"px-4 pb-4 flex items-center justify-between text-sm text-gray-600",children:[c.jsxs("div",{children:["Viewers: ",c.jsx("strong",{children:b})]}),c.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 rounded-lg bg-gray-900 text-white",children:"Close"})]})]})}):null}const Dde="https://api.gada.chat",Il=Dde.replace(/\/+$/,""),s$e=Dde+"/uploads/gadalogo.png";function wQ(){return c.jsx("div",{className:"pointer-events-none absolute bottom-2 right-2 opacity-70",style:{zIndex:5},"aria-hidden":!0,children:c.jsx("img",{src:s$e,style:{maxWidth:96,maxHeight:36},onError:e=>{var n;e.currentTarget.style.display="none";const t=document.createElement("span");t.textContent="GADA",t.style.fontWeight="700",t.style.fontSize="14px",t.style.color="rgba(255,255,255,0.9)",t.style.textShadow="0 1px 2px rgba(0,0,0,0.6)",(n=e.currentTarget.parentElement)==null||n.appendChild(t)}})})}const o$e=[{reaction:"like",title:"Like",image:""},{reaction:"love",title:"Love",image:""},{reaction:"haha",title:"Haha",image:""},{reaction:"yay",title:"Yay",image:""},{reaction:"wow",title:"Wow",image:""},{reaction:"sad",title:"Sad",image:""},{reaction:"angry",title:"Angry",image:""}],SQ={like:"👍",love:"❤️",haha:"😆",yay:"🤩",wow:"😲",sad:"😢",angry:"😡"};let ME=null,xQ=null,lE=null,TQ=0;const c$e=12*60*60*1e3;async function l$e(e,t){const n=Date.now();return ME&&xQ===t&&n-TQ<c$e?ME:lE||(lE=fetch(`${e}/api/posts/getreactions`,{headers:t?{Authorization:t}:void 0}).then(async o=>{if(!o.ok)throw new Error(`getreactions ${o.status}`);const u=await o.json();return ME=Array.isArray(u==null?void 0:u.data)?u.data:[],xQ=t,TQ=Date.now(),ME}).finally(()=>{lE=null}),lE)}function u$e(){return ME}const CQ=new Set;let EU=new Set,wU=null;async function d$e(e){const t=Array.from(EU);if(EU.clear(),wU=null,!!t.length)try{await fetch(`${Il}/api/postsviews/batch`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify({ids:t})})}catch{}}function h$e(e,t){CQ.has(e)||(CQ.add(e),EU.add(e),wU||(wU=window.setTimeout(()=>d$e(t),1200)))}const uE=e=>{if(!e)return`${Il}/uploads/profile/defaultavatar.png`;if(e.startsWith("http"))return e;const t=Kn(e);return`${Il}/uploads/${t}`},dE=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":String(e);function f$e({text:e,maxLines:t=6,charThreshold:n=400}){const[i,o]=S.useState(!1),u=((e==null?void 0:e.length)||0)>n,h=`${(t*1.5).toFixed(1)}rem`;return c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx("p",{className:"whitespace-pre-line break-words leading-6 text-[15px] overflow-hidden",style:!i&&u?{maxHeight:h}:void 0,children:e}),!i&&u&&c.jsx("div",{className:"pointer-events-none absolute bottom-0 left-0 right-0 h-10 bg-gradient-to-t from-white to-transparent"})]}),u&&c.jsx("button",{type:"button",onClick:()=>o(p=>!p),className:"mt-2 text-[#1877F2] font-medium hover:underline",children:i?"See less":"See more"})]})}function p$e({open:e,catalog:t,onPick:n,onClear:i}){if(!e)return null;const o=t!=null&&t.length?t:o$e;return c.jsxs("div",{className:"relative z-[80] select-none ",children:[c.jsx("div",{className:`
          inline-flex w-max min-w-[240px] shrink-0
          items-center bg-white rounded-full px-4 py-2
          border border-slate-200 shadow-2xl ml-[220px]
        `,role:"menu","aria-label":"Choose a reaction",children:c.jsxs("div",{className:"flex items-center gap-2 w-max shrink-0",children:[o.map(u=>c.jsx("button",{type:"button",onClick:()=>n(u.reaction),className:`
                rounded-full h-9 w-9 flex items-center justify-center
                hover:scale-110 transition first:ml-1 last:mr-1
              `,title:u.title,"aria-label":u.title,children:u.image?c.jsx("img",{src:`${Il}/uploads/${String(u.image).replace(/^\/+/,"")}`,alt:u.title,className:"h-8 w-8 object-contain",onError:h=>{var g;h.currentTarget.style.display="none";const p=document.createElement("span");p.textContent=SQ[u.reaction]??"👍",p.style.fontSize="20px",(g=h.currentTarget.parentElement)==null||g.appendChild(p)}}):c.jsx("span",{style:{fontSize:20},children:SQ[u.reaction]??"👍"})},u.reaction)),i&&c.jsx("button",{type:"button",onClick:i,className:"ml-1 text-[11px] px-2 py-1 rounded bg-slate-100 hover:bg-slate-200",children:"Remove"})]})}),c.jsx("div",{className:"mx-auto h-3 w-3 -mt-1 rotate-45 bg-white border-r border-b border-slate-200 shadow"})]})}function Vu({post:e,live:t,trackViews:n=!0}){var Hs,eh;const{user:i,accessToken:o}=st(),u=wt(o),{likePost:h,commentPost:p,deletePost:g,sharePost:v,toggleSave:b}=w1(),[E,T]=S.useState(""),[C,R]=S.useState(!1),[N,O]=S.useState(!1),[k,j]=S.useState(!1),[P,M]=S.useState(!1),[D,U]=S.useState(!1),[V,z]=S.useState(!1),[W,Y]=S.useState(!1),Q=()=>{n!==!1&&Y(!0)},[K,q]=S.useState(!1),oe=(Array.isArray(e==null?void 0:e.comments)?e.comments:[]).length||Number((e==null?void 0:e.comments)??0),ae=Number((e==null?void 0:e.shareCount)??(e==null?void 0:e.shares)??0),J=Number((e==null?void 0:e.views)??(e==null?void 0:e.views)??(e==null?void 0:e.viewCount)??0),[re,X]=S.useState(!1),[de,we]=S.useState(String(e.boosted)==="1"||e.boosted===!0),[ge,Te]=S.useState(!1),Pe=e.author,rt=!!i&&((e==null?void 0:e.hasLiked)===!0||((Hs=e==null?void 0:e.likes)==null?void 0:Hs.some(lt=>String(lt.userId)===String(i.id)))),[dt,ze]=S.useState([]),[vt,Be]=S.useState(!1),[ot,De]=S.useState(!1),[je,Mt]=S.useState(!1),Ut=S.useRef(null);function fn(){Be(!1),console.log("calling this"),Ut.current&&window.clearTimeout(Ut.current),console.log("here"),Ut.current=window.setTimeout(()=>{console.log("this fun "),!ot&&!je&&Be(!1)},120)}const ht=S.useMemo(()=>{const lt=e.reactions;if(lt&&Array.isArray(lt))return lt.map(Yn=>({reaction:Yn.reaction,c:Number(Yn.c||0)}));const Gt=Array.isArray(e.likes)?e.likes.length:0;return Gt>0?[{reaction:"like",c:Gt}]:[]},[e]),St=S.useMemo(()=>{const lt=e.myReaction;return typeof lt=="string"?lt:rt?"like":null},[e,rt]),[At,it]=S.useState(ht),[ve,Ie]=S.useState(St);S.useEffect(()=>{it(ht),Ie(St)},[ht,St]);const $e=S.useMemo(()=>At.reduce((lt,Gt)=>lt+Number(Gt.c||0),0),[At]),gt=S.useMemo(()=>(u==null?void 0:u.Authorization)??"",[u==null?void 0:u.Authorization]);S.useEffect(()=>{const lt=u$e();lt&&ze(lt)},[]),S.useEffect(()=>{let lt=!0;if(gt)return l$e(Il,gt).then(Gt=>{lt&&ze(Gt)}).catch(()=>{}),()=>{lt=!1}},[gt]);function at(lt,Gt){const Yn=new Map;for(const zs of At)Yn.set(zs.reaction,Number(zs.c||0));lt&&Yn.set(lt,Math.max(0,(Yn.get(lt)||0)-1)),Gt&&Yn.set(Gt,(Yn.get(Gt)||0)+1);const gi=Array.from(Yn.entries()).map(([zs,Ts])=>({reaction:zs,c:Ts}));it(gi.filter(zs=>zs.c>0))}async function pt(lt){if(!i)return;if(!dt.length&&lt==="like"){await h(e.id);return}const Gt=ve;try{Ie(lt),at(Gt,lt);const Yn=await fetch(`${Il}/api/posts/${e.id}/react`,{method:"POST",headers:{"Content-Type":"application/json",...u},body:JSON.stringify({reaction:lt})});if(Yn.ok){const gi=await Yn.json();gi!=null&&gi.counts&&it(gi.counts),typeof(gi==null?void 0:gi.myReaction)<"u"&&Ie(gi.myReaction)}}catch{Ie(Gt),at(lt,Gt)}finally{Be(!1)}}async function Ft(){if(!i||!ve)return;const lt=ve;try{Ie(null),at(lt,null);const Gt=await fetch(`${Il}/api/posts/${e.id}/react`,{method:"DELETE",headers:{...u}});if(Gt.ok){const Yn=await Gt.json();Yn!=null&&Yn.counts&&it(Yn.counts),Ie((Yn==null?void 0:Yn.myReaction)??null)}}catch{Ie(lt),at(null,lt)}finally{Be(!1)}}const vn=!!i&&String(i.id)===String(Pe.id)&&i.packageactive,cr=S.useRef(null);function ra(lt){let Gt=(lt==null?void 0:lt.parentElement)||null;for(;Gt&&Gt!==document.body;){const Yn=getComputedStyle(Gt).overflowY;if(/(auto|scroll|overlay)/i.test(Yn))return Gt;Gt=Gt.parentElement}return null}function Gs(lt,Gt=.75){return(typeof lt.isIntersecting=="boolean"?lt.isIntersecting:lt.intersectionRatio>0)&&lt.intersectionRatio>=Gt}S.useEffect(()=>{if(!n)return;const lt=cr.current;if(!lt||typeof window>"u")return;let Gt=null;const Yn=ra(lt),gi=new IntersectionObserver(zs=>{for(const Ts of zs)Ts.target===lt&&(Gs(Ts,.75)?(Gt&&clearTimeout(Gt),Gt=window.setTimeout(()=>{h$e(String(e.id),u),gi.unobserve(lt)},1e3)):Gt&&(clearTimeout(Gt),Gt=null))},{root:Yn,threshold:[0,.25,.5,.75,1]});return gi.observe(lt),()=>{Gt&&clearTimeout(Gt),gi.disconnect()}},[e.id,u,n]);const xs=lt=>{lt.preventDefault(),!(!i||!E.trim())&&(p(e.id,E),T(""))},Ju=()=>{i&&g(e.id)},rc=async()=>{M(!0);try{await b(e.id,e.hasSaved)}catch(lt){console.error(lt)}finally{M(!1)}},ia=async()=>{if(!vn||re)return;X(!0);const lt=!de;try{const Gt=`${Il}/api/posts/${e.id}/boost`,Yn=await fetch(Gt,{method:lt?"POST":"DELETE",headers:{"Content-Type":"application/json",...u}});if(!Yn.ok){const gi=await Yn.json().catch(()=>({}));throw new Error((gi==null?void 0:gi.error)||"Boost error")}we(lt),Ce.success(lt?"This post is now boosted.":"This post is no longer boosted.")}catch(Gt){console.error(Gt),Ce.success((Gt==null?void 0:Gt.message)||"Please try again.")}finally{X(!1)}},Yc=lt=>lt.split(" ").map(Gt=>Gt[0]).join("").toUpperCase();return c.jsx("div",{ref:cr,children:c.jsxs(Vr,{className:"mb-4",children:[c.jsx(pa,{className:"p-4 pb-0",children:c.jsxs("div",{className:"flex items-center",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Nt,{to:`/profile/${L0(Pe.id)}`,children:c.jsxs($i,{children:[c.jsx(Oi,{src:Pe.profileImage?uE(Pe.profileImage):`${Il}/uploads/profile/defaultavatar.png`,alt:Pe.username}),c.jsx(Qi,{children:Yc(Pe.username)})]})}),c.jsxs("div",{className:"leading-tight",children:[c.jsx(Nt,{to:`/profile/${Pe.id}`,className:"font-semibold hover:underline",children:Pe.username}),c.jsx("p",{className:"text-sm text-gray-500",children:e.boosted=="1"?"Sponsored":bN(e.createdAt)})]})]}),c.jsx("div",{className:"ml-auto",children:c.jsxs(tB,{children:[c.jsx(nB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8","aria-label":"Post options",children:c.jsx(Yce,{className:"h-5 w-5"})})}),c.jsxs(M1,{align:"end",className:"w-56",children:[c.jsxs(Dc,{onClick:rc,disabled:P,className:"flex items-center gap-2",children:[e.hasSaved?c.jsx(jVe,{className:"w-4 h-4 text-gray-600"}):c.jsx(I4,{className:"w-4 h-4 text-gray-600"}),c.jsx("span",{children:e.hasSaved?"Unsave Post":"Save Post"})]}),c.jsx(nf,{}),c.jsxs(Dc,{onClick:()=>z(!0),className:"text-gray-600",children:[c.jsx(NN,{size:16}),"   Report post"]}),vn&&c.jsxs(c.Fragment,{children:[c.jsx(nf,{}),c.jsxs(Dc,{onClick:ia,disabled:re,className:"flex items-center gap-2",children:[c.jsx(U4,{className:`w-4 h-4 ${e.boosted?"text-[#1877F2]":"text-gray-600"}`}),c.jsx("span",{children:e.boosted?"Unboost this post":"Boost this post"})]})]}),i&&String(i.id)===String(Pe.id)&&c.jsxs(c.Fragment,{children:[c.jsx(nf,{}),c.jsxs(Dc,{onClick:()=>Te(!0),className:"text-gray-600",children:[c.jsx(tle,{size:16})," Edit post"]})]}),i&&String(i.id)===String(Pe.id)&&c.jsxs(c.Fragment,{children:[c.jsx(nf,{}),c.jsxs(Dc,{onClick:Ju,className:"text-red-600",children:[c.jsx($Ve,{size:16})," Delete post"]})]})]})]})})]})}),c.jsxs(mi,{className:"p-4",children:[e.content&&c.jsx(f$e,{text:e.content,maxLines:6,charThreshold:400}),e.images.length>0&&c.jsx("div",{className:`grid ${e.images.length===1?"grid-cols-1":"grid-cols-2"} gap-2 mb-3`,children:e.images.map((lt,Gt)=>c.jsxs("div",{className:"relative group rounded-md overflow-hidden",children:[c.jsx("img",{src:uE(lt),alt:"Post",className:"rounded-md w-full object-cover cursor-zoom-in",style:{maxHeight:e.images.length===1?"500px":"250px"},onError:Yn=>{Yn.currentTarget.src=`${Il}/uploads/profile/defaultavatar.png`},onClick:Q,loading:"lazy",decoding:"async"}),c.jsx(wQ,{})]},Gt))}),e.videos.length>0&&c.jsx("div",{className:"mb-3",children:e.videos.map((lt,Gt)=>c.jsxs("div",{className:"relative rounded-md overflow-hidden",children:[c.jsx("video",{src:uE(lt),controls:!0,className:"rounded-md w-full cursor-zoom-in",style:{maxHeight:"500px"},onClick:Q,preload:"metadata"}),c.jsx(wQ,{})]},Gt))})]}),c.jsx(mi,{className:"px-4 pt-3 pb-0",children:c.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-600",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex -space-x-1",children:At.slice().sort((lt,Gt)=>Number(Gt.c||0)-Number(lt.c||0)).slice(0,3).map(lt=>{const Gt=dt.find(gi=>gi.reaction===lt.reaction),Yn=(Gt==null?void 0:Gt.image)||`reactions/${lt.reaction}.png`;return c.jsx("img",{src:`${Il}/uploads/${String(Yn).replace(/^\/+/,"")}`,alt:(Gt==null?void 0:Gt.title)||lt.reaction,title:`${(Gt==null?void 0:Gt.title)||lt.reaction} • ${lt.c}`,className:"h-5 w-5 rounded-full ring-2 ring-white"},lt.reaction)})}),$e>0&&c.jsx("span",{className:"ml-2",children:dE($e)})]}),c.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[c.jsxs("div",{children:[dE(oe)," ",oe===1?"comment":"comments"]}),c.jsxs("div",{children:[dE(ae)," ",ae===1?"Share":"Shares"]}),c.jsxs("div",{children:[dE(J)," ",J===1?"View":"Views"]})]})]})}),c.jsx(k0,{}),c.jsx(e_,{className:"p-0 overflow-visible",children:c.jsxs("div",{className:"relative grid grid-cols-4 w-full divide-x divide-slate-100",children:[c.jsxs("div",{className:"relative",onMouseEnter:()=>{De(!0),Be(!0)},onMouseLeave:()=>{De(!1),fn()},children:[c.jsxs(be,{variant:"ghost",onClick:()=>{dt.length?Be(lt=>!lt):i&&pt("like")},"aria-pressed":!!ve,className:`w-full h-11 rounded-none flex items-center justify-center gap-2 transition-colors ${ve?"text-[#1877F2]":"text-slate-600"}`,title:ve?`You reacted (${ve})`:"Like",children:[c.jsx(P0,{className:`h-5 w-5 ${ve?"fill-[#1877F2] text-[#1877F2]":""}`}),c.jsx("span",{className:"font-medium",children:ve&&((eh=dt.find(lt=>lt.reaction===ve))==null?void 0:eh.title)||"Like"})]}),dt.length>0&&vt&&c.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-3 -mt-4 z-50",onMouseEnter:()=>{Mt(!0)},onMouseLeave:()=>{Mt(!1),fn()},children:c.jsx(p$e,{open:vt,catalog:dt,onPick:lt=>{Be(!1),pt(lt)},onClear:ve?()=>{Be(!1),Ft()}:void 0})})]}),c.jsx("div",{children:c.jsxs(be,{variant:"ghost",className:"w-full h-11 rounded-none flex items-center justify-center gap-2 text-slate-600",onClick:()=>R(!C),children:[c.jsx(Mw,{className:"h-5 w-5"}),c.jsx("span",{className:"font-medium",children:"Comment"})]})}),c.jsx("div",{children:c.jsxs(be,{variant:"ghost",className:"w-full h-11 rounded-none flex items-center justify-center gap-2 text-slate-600",onClick:()=>j(!0),children:[c.jsx(T1,{className:"h-5 w-5"}),c.jsx("span",{className:"font-medium",children:"Share"})]})}),!!t&&(t==null?void 0:t.live)&&!t.ended&&c.jsxs("button",{type:"button",onClick:()=>U(!0),className:"inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full bg-red-50 text-red-600 border border-red-200 hover:bg-red-100",title:"Watch live",children:[c.jsx(nle,{className:"h-4 w-4 fill-red-600 text-red-600"}),c.jsx("span",{className:"font-medium",children:"LIVE"}),c.jsxs("span",{className:"text-slate-500",children:["· ",t.viewers]})]}),c.jsx("div",{children:c.jsxs("div",{className:"w-full h-11 rounded-none flex items-center justify-center gap-2 text-slate-600 select-none",children:[c.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5","aria-hidden":"true",children:c.jsx("path",{fill:"currentColor",d:"M12 5c5.5 0 9.5 4.5 10 6-.5 1.6-4.5 6-10 6S2.5 12.6 2 11c.5-1.6 4.5-6 10-6Zm0 2c-3.7 0-6.8 2.7-7.7 4 .9 1.3 4 4 7.7 4s6.8-2.7 7.7-4c-.9-1.3-4-4-7.7-4Zm0 2.5A3.5 3.5 0 1 1 8.5 13 3.5 3.5 0 0 1 12 9.5Zm0 2a1.5 1.5 0 1 0 1.5 1.5A1.5 1.5 0 0 0 12 11.5Z"})}),c.jsx("span",{className:"font-medium",children:dE(J)})]})})]})}),c.jsx(eue,{isOpen:k,onClose:()=>j(!1),onShare:lt=>v(e.id,lt)}),c.jsx(i$e,{open:V,onOpenChange:z,postId:Number((e==null?void 0:e.id)??(e==null?void 0:e.post_id))}),c.jsx(P5e,{open:ge,onClose:()=>Te(!1),postId:(e==null?void 0:e.id)??(e==null?void 0:e.post_id),initialText:(e==null?void 0:e.content)??"",initialPrivacy:(e==null?void 0:e.privacy)??"public",authKey:(u==null?void 0:u.Authorization)??"",onSaved:lt=>{e.content=lt.text,console.log(lt,"updatedupdated")}}),(e.comments.length>0||C)&&c.jsxs("div",{className:"p-4 pt-0",children:[c.jsx(k0,{className:"my-4"}),e.comments.length>0&&c.jsxs("div",{className:"space-y-3 mb-4",children:[(N?e.comments:e.comments.slice(0,2)).map(lt=>c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Oi,{src:uE(lt.profileImage||""),alt:lt.username}),c.jsx(Qi,{children:Yc(lt.username)})]}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 px-3",children:[c.jsx(Nt,{to:`/profile/${lt.userId}`,className:"font-semibold hover:underline",children:lt.username}),c.jsx("p",{className:"text-sm",children:lt.content})]}),c.jsxs("div",{className:"flex space-x-3 text-xs text-gray-500 mt-1 ml-2",children:[c.jsx("span",{children:bN(lt.createdAt)}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Like"}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Reply"})]})]})]},lt.id)),e.comments.length>2&&c.jsx(be,{variant:"ghost",onClick:()=>O(!N),className:"text-gray-600 pl-0 pb-0",children:N?"Show fewer comments":`View all ${e.comments.length} comments`})]}),(C||e.comments.length>0)&&i&&c.jsxs("form",{onSubmit:xs,className:"flex space-x-2",children:[c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Oi,{src:uE(i.profileImage||""),alt:i.username}),c.jsx(Qi,{children:Yc(i.username)})]}),c.jsxs("div",{className:"flex-1 flex",children:[c.jsx(wi,{placeholder:"Write a comment...",value:E,onChange:lt=>T(lt.target.value),className:"flex-1 resize-none min-h-[40px] max-h-[120px] focus-visible:ring-[#1877F2] rounded-full py-2"}),c.jsx(be,{type:"submit",size:"icon",disabled:!E.trim(),className:"ml-2",children:c.jsx(rle,{className:"h-4 w-4"})})]})]})]}),c.jsx(jde,{postId:String(e.id),open:W,onOpenChange:Y}),D&&c.jsx(a$e,{postId:Number((e==null?void 0:e.id)??(e==null?void 0:e.post_id)),open:D,onOpenChange:U})]})})}const B1=Wle,lB=ABe,m$e=Gle,Lde=S.forwardRef(({className:e,...t},n)=>c.jsx(I1,{className:kt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));Lde.displayName=I1.displayName;const g$e=Uw("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Gw=S.forwardRef(({side:e="right",className:t,children:n,...i},o)=>c.jsxs(m$e,{children:[c.jsx(Lde,{}),c.jsxs(O1,{ref:o,className:kt(g$e({side:e}),t),...i,children:[n,c.jsxs(Hle,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[c.jsx(go,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Gw.displayName=O1.displayName;const uB=({className:e,...t})=>c.jsx("div",{className:kt("flex flex-col space-y-2 text-center sm:text-left",e),...t});uB.displayName="SheetHeader";const dB=S.forwardRef(({className:e,...t},n)=>c.jsx(P1,{ref:n,className:kt("text-lg font-semibold text-foreground",e),...t}));dB.displayName=P1.displayName;const v$e=S.forwardRef(({className:e,...t},n)=>c.jsx(k1,{ref:n,className:kt("text-sm text-muted-foreground",e),...t}));v$e.displayName=k1.displayName;const $1="https://api.gada.chat";async function Mde(e,t,n){const i=await fetch($1+"/api/payments/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,amount:t,metadata:n})});if(console.log(i,"resresresres"),!i.ok)throw new Error("Payment initialization failed");return i.json()}async function RQ(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>{u!=null&&u!==""&&n.set(o,String(u))});const i=await fetch(`${$1}/api/payments/transactions?${n.toString()}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function y$e(e){const t=await fetch($1+"/api/payments/getsystemdetails",{headers:e});if(!t.ok)throw new Error("Failed to load transactions");return t.json()}async function jR(e){const t=await fetch(`${$1}/api/users/fetchuserbalance`,{method:"GET",headers:e,credentials:"include"});if(!t.ok){const i=await t.text().catch(()=>"Failed to load balance");throw new Error(i||"Failed to load balance")}const n=await t.json();return{user_wallet_balance:Number(n.user_wallet_balance)||0,user_points:Number(n.user_points)||0}}const Hw="https://api.gada.chat";async function zw(e){return e.status===401&&(Ce.error("Your session has been ended Please login again"),localStorage.clear()),e.ok?e.json():e.json().catch(()=>({})).then(t=>{throw new Error(t.error||"Request failed")})}async function NQ(e,t={}){const{cursor:n=0,limit:i=20}=t,o=await fetch(`${Hw}/api/notifications?cursor=${n}&limit=${i}`,{headers:e,credentials:"include"});return zw(o)}async function _$e(e){const t=await fetch(`${Hw}/api/notifications/unread-count`,{headers:e,credentials:"include"});return zw(t)}async function b$e(e,t){const n=await fetch(`${Hw}/api/notifications/mark-read`,{method:"POST",headers:{...e,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({ids:t})});return zw(n)}async function E$e(e){const t=await fetch(`${Hw}/api/notifications/mark-all-read`,{method:"POST",headers:e,credentials:"include"});return zw(t)}async function w$e(e){const t=await fetch(`${Hw}/api/notifications/mark-seen`,{method:"POST",headers:e,credentials:"include"});return zw(t)}const Bu=Object.create(null);Bu.open="0";Bu.close="1";Bu.ping="2";Bu.pong="3";Bu.message="4";Bu.upgrade="5";Bu.noop="6";const DR=Object.create(null);Object.keys(Bu).forEach(e=>{DR[Bu[e]]=e});const SU={type:"error",data:"parser error"},Ude=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Fde=typeof ArrayBuffer=="function",Vde=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,hB=({type:e,data:t},n,i)=>Ude&&t instanceof Blob?n?i(t):AQ(t,i):Fde&&(t instanceof ArrayBuffer||Vde(t))?n?i(t):AQ(new Blob([t]),i):i(Bu[e]+(t||"")),AQ=(e,t)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];t("b"+(i||""))},n.readAsDataURL(e)};function IQ(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let sL;function S$e(e,t){if(Ude&&e.data instanceof Blob)return e.data.arrayBuffer().then(IQ).then(t);if(Fde&&(e.data instanceof ArrayBuffer||Vde(e.data)))return t(IQ(e.data));hB(e,!1,n=>{sL||(sL=new TextEncoder),t(sL.encode(n))})}const OQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",UE=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<OQ.length;e++)UE[OQ.charCodeAt(e)]=e;const x$e=e=>{let t=e.length*.75,n=e.length,i,o=0,u,h,p,g;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const v=new ArrayBuffer(t),b=new Uint8Array(v);for(i=0;i<n;i+=4)u=UE[e.charCodeAt(i)],h=UE[e.charCodeAt(i+1)],p=UE[e.charCodeAt(i+2)],g=UE[e.charCodeAt(i+3)],b[o++]=u<<2|h>>4,b[o++]=(h&15)<<4|p>>2,b[o++]=(p&3)<<6|g&63;return v},T$e=typeof ArrayBuffer=="function",fB=(e,t)=>{if(typeof e!="string")return{type:"message",data:Bde(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:C$e(e.substring(1),t)}:DR[n]?e.length>1?{type:DR[n],data:e.substring(1)}:{type:DR[n]}:SU},C$e=(e,t)=>{if(T$e){const n=x$e(e);return Bde(n,t)}else return{base64:!0,data:e}},Bde=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},$de="",R$e=(e,t)=>{const n=e.length,i=new Array(n);let o=0;e.forEach((u,h)=>{hB(u,!1,p=>{i[h]=p,++o===n&&t(i.join($de))})})},N$e=(e,t)=>{const n=e.split($de),i=[];for(let o=0;o<n.length;o++){const u=fB(n[o],t);if(i.push(u),u.type==="error")break}return i};function A$e(){return new TransformStream({transform(e,t){S$e(e,n=>{const i=n.length;let o;if(i<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,i);else if(i<65536){o=new Uint8Array(3);const u=new DataView(o.buffer);u.setUint8(0,126),u.setUint16(1,i)}else{o=new Uint8Array(9);const u=new DataView(o.buffer);u.setUint8(0,127),u.setBigUint64(1,BigInt(i))}e.data&&typeof e.data!="string"&&(o[0]|=128),t.enqueue(o),t.enqueue(n)})}})}let oL;function DC(e){return e.reduce((t,n)=>t+n.length,0)}function LC(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let i=0;for(let o=0;o<t;o++)n[o]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),n}function I$e(e,t){oL||(oL=new TextDecoder);const n=[];let i=0,o=-1,u=!1;return new TransformStream({transform(h,p){for(n.push(h);;){if(i===0){if(DC(n)<1)break;const g=LC(n,1);u=(g[0]&128)===128,o=g[0]&127,o<126?i=3:o===126?i=1:i=2}else if(i===1){if(DC(n)<2)break;const g=LC(n,2);o=new DataView(g.buffer,g.byteOffset,g.length).getUint16(0),i=3}else if(i===2){if(DC(n)<8)break;const g=LC(n,8),v=new DataView(g.buffer,g.byteOffset,g.length),b=v.getUint32(0);if(b>Math.pow(2,21)-1){p.enqueue(SU);break}o=b*Math.pow(2,32)+v.getUint32(4),i=3}else{if(DC(n)<o)break;const g=LC(n,o);p.enqueue(fB(u?g:oL.decode(g),t)),i=0}if(o===0||o>e){p.enqueue(SU);break}}}})}const Wde=4;function ma(e){if(e)return O$e(e)}function O$e(e){for(var t in ma.prototype)e[t]=ma.prototype[t];return e}ma.prototype.on=ma.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};ma.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};ma.prototype.off=ma.prototype.removeListener=ma.prototype.removeAllListeners=ma.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var i,o=0;o<n.length;o++)if(i=n[o],i===t||i.fn===t){n.splice(o,1);break}return n.length===0&&delete this._callbacks["$"+e],this};ma.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,o=n.length;i<o;++i)n[i].apply(this,t)}return this};ma.prototype.emitReserved=ma.prototype.emit;ma.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};ma.prototype.hasListeners=function(e){return!!this.listeners(e).length};const W1=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),jc=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),P$e="arraybuffer";function Gde(e,...t){return t.reduce((n,i)=>(e.hasOwnProperty(i)&&(n[i]=e[i]),n),{})}const k$e=jc.setTimeout,j$e=jc.clearTimeout;function G1(e,t){t.useNativeTimers?(e.setTimeoutFn=k$e.bind(jc),e.clearTimeoutFn=j$e.bind(jc)):(e.setTimeoutFn=jc.setTimeout.bind(jc),e.clearTimeoutFn=jc.clearTimeout.bind(jc))}const D$e=1.33;function L$e(e){return typeof e=="string"?M$e(e):Math.ceil((e.byteLength||e.size)*D$e)}function M$e(e){let t=0,n=0;for(let i=0,o=e.length;i<o;i++)t=e.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function Hde(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function U$e(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function F$e(e){let t={},n=e.split("&");for(let i=0,o=n.length;i<o;i++){let u=n[i].split("=");t[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}return t}class V$e extends Error{constructor(t,n,i){super(t),this.description=n,this.context=i,this.type="TransportError"}}class pB extends ma{constructor(t){super(),this.writable=!1,G1(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,i){return super.emitReserved("error",new V$e(t,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=fB(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=U$e(t);return n.length?"?"+n:""}}class B$e extends pB{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};N$e(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,R$e(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Hde()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let zde=!1;try{zde=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const $$e=zde;function W$e(){}class G$e extends B$e{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,n){const i=this.request({method:"POST",data:t});i.on("success",n),i.on("error",(o,u)=>{this.onError("xhr post error",o,u)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=t}}let Bv=class LR extends ma{constructor(t,n,i){super(),this.createRequest=t,G1(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const n=Gde(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var o;i.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=LR.requestsCount++,LR.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=W$e,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete LR.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Bv.requestsCount=0;Bv.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",PQ);else if(typeof addEventListener=="function"){const e="onpagehide"in jc?"pagehide":"unload";addEventListener(e,PQ,!1)}}function PQ(){for(let e in Bv.requests)Bv.requests.hasOwnProperty(e)&&Bv.requests[e].abort()}const H$e=function(){const e=Kde({xdomain:!1});return e&&e.responseType!==null}();class z$e extends G$e{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=H$e&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Bv(Kde,this.uri(),t)}}function Kde(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||$$e))return new XMLHttpRequest}catch{}if(!t)try{return new jc[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const qde=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class K$e extends pB{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,i=qde?{}:Gde(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,i)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],o=n===t.length-1;hB(i,this.supportsBinary,u=>{try{this.doWrite(i,u)}catch{}o&&W1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Hde()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const cL=jc.WebSocket||jc.MozWebSocket;class q$e extends K$e{createSocket(t,n,i){return qde?new cL(t,n,i):n?new cL(t,n):new cL(t)}doWrite(t,n){this.ws.send(n)}}class Y$e extends pB{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=I$e(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(n).getReader(),o=A$e();o.readable.pipeTo(t.writable),this._writer=o.writable.getWriter();const u=()=>{i.read().then(({done:p,value:g})=>{p||(this.onPacket(g),u())}).catch(p=>{})};u();const h={type:"open"};this.query.sid&&(h.data=`{"sid":"${this.query.sid}"}`),this._writer.write(h).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],o=n===t.length-1;this._writer.write(i).then(()=>{o&&W1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const X$e={websocket:q$e,webtransport:Y$e,polling:z$e},J$e=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Z$e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function xU(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),i=e.indexOf("]");n!=-1&&i!=-1&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));let o=J$e.exec(e||""),u={},h=14;for(;h--;)u[Z$e[h]]=o[h]||"";return n!=-1&&i!=-1&&(u.source=t,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=Q$e(u,u.path),u.queryKey=e6e(u,u.query),u}function Q$e(e,t){const n=/\/{2,9}/g,i=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function e6e(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,o,u){o&&(n[o]=u)}),n}const TU=typeof addEventListener=="function"&&typeof removeEventListener=="function",MR=[];TU&&addEventListener("offline",()=>{MR.forEach(e=>e())},!1);class mf extends ma{constructor(t,n){if(super(),this.binaryType=P$e,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const i=xU(t);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=xU(n.host).host);G1(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const o=i.prototype.name;this.transports.push(o),this._transportsByName[o]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=F$e(this.opts.query)),TU&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},MR.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=Wde,n.transport=t,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&mf.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",mf.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const o=this.writeBuffer[i].data;if(o&&(n+=L$e(o)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,W1(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,i){return this._sendPacket("message",t,n,i),this}send(t,n,i){return this._sendPacket("message",t,n,i),this}_sendPacket(t,n,i,o){if(typeof n=="function"&&(o=n,n=void 0),typeof i=="function"&&(o=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const u={type:t,data:n,options:i};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),o&&this.once("flush",o),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(mf.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),TU&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=MR.indexOf(this._offlineEventListener);i!==-1&&MR.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}mf.protocol=Wde;class t6e extends mf{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),i=!1;mf.priorWebsocketSuccess=!1;const o=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",E=>{if(!i)if(E.type==="pong"&&E.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;mf.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(b(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const T=new Error("probe error");T.transport=n.name,this.emitReserved("upgradeError",T)}}))};function u(){i||(i=!0,b(),n.close(),n=null)}const h=E=>{const T=new Error("probe error: "+E);T.transport=n.name,u(),this.emitReserved("upgradeError",T)};function p(){h("transport closed")}function g(){h("socket closed")}function v(E){n&&E.name!==n.name&&u()}const b=()=>{n.removeListener("open",o),n.removeListener("error",h),n.removeListener("close",p),this.off("close",g),this.off("upgrading",v)};n.once("open",o),n.once("error",h),n.once("close",p),this.once("close",g),this.once("upgrading",v),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&n.push(t[i]);return n}}let n6e=class extends t6e{constructor(t,n={}){const i=typeof t=="object"?t:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(o=>X$e[o]).filter(o=>!!o)),super(t,i)}};function r6e(e,t="",n){let i=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),i=xU(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const u=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+u+":"+i.port+t,i.href=i.protocol+"://"+u+(n&&n.port===i.port?"":":"+i.port),i}const i6e=typeof ArrayBuffer=="function",a6e=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Yde=Object.prototype.toString,s6e=typeof Blob=="function"||typeof Blob<"u"&&Yde.call(Blob)==="[object BlobConstructor]",o6e=typeof File=="function"||typeof File<"u"&&Yde.call(File)==="[object FileConstructor]";function mB(e){return i6e&&(e instanceof ArrayBuffer||a6e(e))||s6e&&e instanceof Blob||o6e&&e instanceof File}function UR(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,i=e.length;n<i;n++)if(UR(e[n]))return!0;return!1}if(mB(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return UR(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&UR(e[n]))return!0;return!1}function c6e(e){const t=[],n=e.data,i=e;return i.data=CU(n,t),i.attachments=t.length,{packet:i,buffers:t}}function CU(e,t){if(!e)return e;if(mB(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=CU(e[i],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=CU(e[i],t));return n}return e}function l6e(e,t){return e.data=RU(e.data,t),delete e.attachments,e}function RU(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=RU(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=RU(e[n],t));return e}const u6e=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],d6e=5;var sr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(sr||(sr={}));class h6e{constructor(t){this.replacer=t}encode(t){return(t.type===sr.EVENT||t.type===sr.ACK)&&UR(t)?this.encodeAsBinary({type:t.type===sr.EVENT?sr.BINARY_EVENT:sr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===sr.BINARY_EVENT||t.type===sr.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=c6e(t),i=this.encodeAsString(n.packet),o=n.buffers;return o.unshift(i),o}}function kQ(e){return Object.prototype.toString.call(e)==="[object Object]"}class gB extends ma{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const i=n.type===sr.BINARY_EVENT;i||n.type===sr.BINARY_ACK?(n.type=i?sr.EVENT:sr.ACK,this.reconstructor=new f6e(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(mB(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const i={type:Number(t.charAt(0))};if(sr[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===sr.BINARY_EVENT||i.type===sr.BINARY_ACK){const u=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const h=t.substring(u,n);if(h!=Number(h)||t.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(h)}if(t.charAt(n+1)==="/"){const u=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););i.nsp=t.substring(u,n)}else i.nsp="/";const o=t.charAt(n+1);if(o!==""&&Number(o)==o){const u=n+1;for(;++n;){const h=t.charAt(n);if(h==null||Number(h)!=h){--n;break}if(n===t.length)break}i.id=Number(t.substring(u,n+1))}if(t.charAt(++n)){const u=this.tryParse(t.substr(n));if(gB.isPayloadValid(i.type,u))i.data=u;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case sr.CONNECT:return kQ(n);case sr.DISCONNECT:return n===void 0;case sr.CONNECT_ERROR:return typeof n=="string"||kQ(n);case sr.EVENT:case sr.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&u6e.indexOf(n[0])===-1);case sr.ACK:case sr.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class f6e{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=l6e(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const p6e=Object.freeze(Object.defineProperty({__proto__:null,Decoder:gB,Encoder:h6e,get PacketType(){return sr},protocol:d6e},Symbol.toStringTag,{value:"Module"}));function Ol(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const m6e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xde extends ma{constructor(t,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ol(t,"open",this.onopen.bind(this)),Ol(t,"packet",this.onpacket.bind(this)),Ol(t,"error",this.onerror.bind(this)),Ol(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var i,o,u;if(m6e.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const h={type:sr.EVENT,data:n};if(h.options={},h.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const b=this.ids++,E=n.pop();this._registerAckCallback(b,E),h.id=b}const p=(o=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||o===void 0?void 0:o.writable,g=this.connected&&!(!((u=this.io.engine)===null||u===void 0)&&u._hasPingExpired());return this.flags.volatile&&!p||(g?(this.notifyOutgoingListeners(h),this.packet(h)):this.sendBuffer.push(h)),this.flags={},this}_registerAckCallback(t,n){var i;const o=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(o===void 0){this.acks[t]=n;return}const u=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let p=0;p<this.sendBuffer.length;p++)this.sendBuffer[p].id===t&&this.sendBuffer.splice(p,1);n.call(this,new Error("operation has timed out"))},o),h=(...p)=>{this.io.clearTimeoutFn(u),n.apply(this,p)};h.withError=!0,this.acks[t]=h}emitWithAck(t,...n){return new Promise((i,o)=>{const u=(h,p)=>h?o(h):i(p);u.withError=!0,n.push(u),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((o,...u)=>i!==this._queue[0]?void 0:(o!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(o)):(this._queue.shift(),n&&n(null,...u)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:sr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case sr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case sr.EVENT:case sr.BINARY_EVENT:this.onevent(t);break;case sr.ACK:case sr.BINARY_ACK:this.onack(t);break;case sr.DISCONNECT:this.ondisconnect();break;case sr.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let i=!1;return function(...o){i||(i=!0,n.packet({type:sr.ACK,id:t,data:o}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:sr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,t.data)}}}function i_(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}i_.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};i_.prototype.reset=function(){this.attempts=0};i_.prototype.setMin=function(e){this.ms=e};i_.prototype.setMax=function(e){this.max=e};i_.prototype.setJitter=function(e){this.jitter=e};class NU extends ma{constructor(t,n){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,G1(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new i_({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const o=n.parser||p6e;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new n6e(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const o=Ol(n,"open",function(){i.onopen(),t&&t()}),u=p=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",p),t?t(p):this.maybeReconnectOnOpen()},h=Ol(n,"error",u);if(this._timeout!==!1){const p=this._timeout,g=this.setTimeoutFn(()=>{o(),u(new Error("timeout")),n.close()},p);this.opts.autoUnref&&g.unref(),this.subs.push(()=>{this.clearTimeoutFn(g)})}return this.subs.push(o),this.subs.push(h),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Ol(t,"ping",this.onping.bind(this)),Ol(t,"data",this.ondata.bind(this)),Ol(t,"error",this.onerror.bind(this)),Ol(t,"close",this.onclose.bind(this)),Ol(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){W1(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new Xde(this,t,n),this.nsps[t]=i),i}_destroy(t){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let i=0;i<n.length;i++)this.engine.write(n[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(o=>{o?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",o)):t.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const hE={};function FR(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=r6e(e,t.path||"/socket.io"),i=n.source,o=n.id,u=n.path,h=hE[o]&&u in hE[o].nsps,p=t.forceNew||t["force new connection"]||t.multiplex===!1||h;let g;return p?g=new NU(i,t):(hE[o]||(hE[o]=new NU(i,t)),g=hE[o]),n.query&&!t.query&&(t.query=n.queryKey),g.socket(n.path,t)}Object.assign(FR,{Manager:NU,Socket:Xde,io:FR,connect:FR});const g6e="https://api.gada.chat";function vB(e){console.log(e,"connectSockettoken");const n=FR(g6e,{transports:["websocket"],auth:{token:e},withCredentials:!0});return n.on("connect",()=>console.log("[client] connected",n.id)),n.on("connect_error",i=>console.warn("[client] connect_error",i)),n.on("error",i=>console.warn("[client] error",i)),n.on("disconnect",i=>console.warn("[client] disconnected",i)),n}const Jde=S.createContext(null),Zde=()=>{const e=S.useContext(Jde);if(!e)throw new Error("useNotifications must be used within NotificationProvider");return e},jQ="notif_sound_enabled";function v6e({children:e}){const{accessToken:t}=st(),n=wt(t),[i,o]=S.useState([]),[u,h]=S.useState(0),p=S.useRef(0),g=S.useRef(20),v=S.useRef(null),[b,E]=S.useState(()=>{const Y=localStorage.getItem(jQ);return Y===null?!0:Y==="1"}),T=Y=>{const Q=typeof Y=="function"?Y(b):Y;E(Q),localStorage.setItem(jQ,Q?"1":"0")},C=b,R=S.useRef(null),N=S.useRef(!1),O=S.useRef(null),k=S.useRef(0),j=()=>{const Y=window.AudioContext||window.webkitAudioContext;if(!Y)return;O.current||(O.current=new Y);const Q=O.current,K=Q.createOscillator(),q=Q.createGain();K.type="sine",K.frequency.value=880,K.connect(q),q.connect(Q.destination);const ee=Q.currentTime;q.gain.setValueAtTime(0,ee),q.gain.linearRampToValueAtTime(.12,ee+.01),q.gain.exponentialRampToValueAtTime(.001,ee+.25),K.start(ee),K.stop(ee+.3)};S.useEffect(()=>{const Y=new Audio("/sounds/notify.mp3");Y.preload="auto",Y.crossOrigin="anonymous",Y.volume=.9,R.current=Y;const Q=async()=>{try{await Y.play(),Y.pause(),Y.currentTime=0,N.current=!0}catch{}window.removeEventListener("pointerdown",Q),window.removeEventListener("keydown",Q),window.removeEventListener("touchstart",Q)};return window.addEventListener("pointerdown",Q,{once:!0}),window.addEventListener("keydown",Q,{once:!0}),window.addEventListener("touchstart",Q,{once:!0}),()=>{try{Y.pause()}catch{}}},[]);const P=()=>{if(!C)return;const Y=Date.now();if(Y-k.current<300)return;k.current=Y;const Q=R.current;Q&&N.current?(Q.currentTime=0,Q.play().catch(()=>j())):j()},M=async()=>{p.current=0;const Y=g.current,[Q,{count:K}]=await Promise.all([NQ(n,{cursor:0,limit:Y}),_$e(n)]);o(Q),h(K),p.current=Q.length},D=async()=>{const Y=p.current,Q=g.current,K=await NQ(n,{cursor:Y,limit:Q});K.length&&(o(q=>[...q,...K]),p.current=Y+K.length)},U=async Y=>{Y!=null&&Y.length&&(await b$e(n,Y),o(Q=>Q.map(K=>Y.includes(K.id)?{...K,readAt:K.readAt??new Date().toISOString()}:K)),h(Q=>Math.max(0,Q-Y.length)))},V=async()=>{await E$e(n),o(Y=>Y.map(Q=>({...Q,readAt:Q.readAt??new Date().toISOString()}))),h(0)},z=async()=>{await w$e(n),o(Y=>Y.map(Q=>({...Q,seenAt:Q.seenAt??new Date().toISOString()})))};S.useEffect(()=>{if(!t)return;M().catch(console.error);const Y=vB(t);return v.current=Y,Y.on("notification:new",Q=>{o(K=>[Q,...K]),h(K=>K+1),P()}),()=>{Y.close()}},[t]);const W={items:i,unreadCount:u,loadMore:D,refresh:M,markAsRead:U,markAll:V,markSeenNow:z,soundEnabled:C,setSoundEnabled:T};return c.jsx(Jde.Provider,{value:W,children:e})}const DQ="https://api.gada.chat";function y6e(){const{items:e,unreadCount:t,markAll:n,markSeenNow:i,soundEnabled:o,setSoundEnabled:u}=Zde(),[h,p]=S.useState(!1),g=S.useRef(null),b=Gc().state,E=(b==null?void 0:b.modal)===!0;return S.useEffect(()=>{h&&i().catch(console.error)},[h]),S.useEffect(()=>{const T=C=>{g.current&&!g.current.contains(C.target)&&p(!1)};return window.addEventListener("click",T),()=>window.removeEventListener("click",T)},[]),c.jsxs("div",{className:"relative",ref:g,children:[c.jsxs("button",{onClick:()=>p(T=>!T),className:"relative p-2 rounded-full hover:bg-gray-100","aria-label":"Notifications",children:[c.jsx($Z,{className:"h-6 w-6 text-gray-700"}),t>0&&c.jsx("span",{className:"absolute -top-0.5 -right-0.5 bg-red-600 text-white text-[10px] leading-none px-1.5 py-0.5 rounded-full",children:t>99?"99+":t})]}),h&&c.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white shadow-xl rounded-lg overflow-hidden z-50",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b",children:[c.jsx("div",{className:"font-semibold",children:"Notifications"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>u(T=>!T),className:"inline-flex items-center gap-1 text-sm text-gray-600 hover:text-gray-900",title:o?"Mute notification sound":"Unmute notification sound",children:[o?c.jsx($Z,{className:"h-4 w-4"}):c.jsx(PVe,{className:"h-4 w-4"}),c.jsx("span",{children:o?"Sound on":"Muted"})]}),c.jsx("span",{className:"text-gray-300",children:"•"}),c.jsx("button",{onClick:()=>n().catch(console.error),className:"text-sm text-blue-600 hover:underline",children:"Mark all as read"})]})]}),c.jsxs("ul",{className:"max-h-96 overflow-y-auto divide-y",children:[e.slice(0,20).map(T=>c.jsx("li",{className:`p-3 ${T.readAt?"":"bg-blue-50"}`,children:c.jsx(_6e,{n:T})},T.id)),e.length===0&&c.jsx("li",{className:"p-6 text-center text-gray-500",children:"No notifications"})]}),c.jsx("div",{className:"p-2 text-center",children:c.jsx(Nt,{to:"/notifications",className:"text-sm text-blue-600 hover:underline",children:"See all"})})]}),E&&(b==null?void 0:b.postId)&&c.jsx(jde,{postId:String(b.postId),open:!0,onOpenChange:()=>window.history.back()})]})}function _6e({n:e}){const t=b6e(e),n=E6e(e),i=Gc(),o=`${i.pathname}${i.search}${i.hash}`;return c.jsxs(Nt,{to:n,state:{isModal:!0,returnTo:o},className:"flex items-start gap-3",children:[c.jsx("img",{src:e.actorAvatar?DQ+"/uploads/"+Kn(e.actorAvatar):DQ+"/uploads//profile/defaultavatar.png",alt:"",className:"h-9 w-9 rounded-full object-cover"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:e.actorName})," ",t]}),c.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),!e.readAt&&c.jsx("span",{className:"mt-2 h-2 w-2 bg-blue-600 rounded-full"})]})}function b6e(e){switch(e.type){case"post_like":return"liked your post.";case"post_comment":return"commented on your post.";case"post_share":return"shared your post.";case"friend_request":return"sent you a friend request.";case"friend_accept":return"accepted your friend request.";case"reel_like":return"liked your reel.";case"reel_comment":return"commented on your reel.";case"group_post":return"posted in your group.";case"new_message":return"sent new message.";default:return"sent you a notification."}}function E6e(e){const t=e.meta||{};switch(e.entityType){case"post":return`/posts/${t.postId||e.entityId}`;case"reel":return"/reels";case"group":return`/groups/${t.groupId||e.entityId}`;case"group_post":return`/groups/${t.groupId}/posts/${e.entityId}`;case"user":return`/profile/${e.actorId}`;default:return"#"}}var H1="Popover",[Qde,sxt]=Vs(H1,[Of]),Kw=Of(),[w6e,kf]=Qde(H1),ehe=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:o,onOpenChange:u,modal:h=!1}=e,p=Kw(t),g=S.useRef(null),[v,b]=S.useState(!1),[E,T]=$d({prop:i,defaultProp:o??!1,onChange:u,caller:H1});return c.jsx(E4,{...p,children:c.jsx(w6e,{scope:t,contentId:Vl(),triggerRef:g,open:E,onOpenChange:T,onOpenToggle:S.useCallback(()=>T(C=>!C),[T]),hasCustomAnchor:v,onCustomAnchorAdd:S.useCallback(()=>b(!0),[]),onCustomAnchorRemove:S.useCallback(()=>b(!1),[]),modal:h,children:n})})};ehe.displayName=H1;var the="PopoverAnchor",S6e=S.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=kf(the,n),u=Kw(n),{onCustomAnchorAdd:h,onCustomAnchorRemove:p}=o;return S.useEffect(()=>(h(),()=>p()),[h,p]),c.jsx(kw,{...u,...i,ref:t})});S6e.displayName=the;var nhe="PopoverTrigger",rhe=S.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=kf(nhe,n),u=Kw(n),h=Dn(t,o.triggerRef),p=c.jsx(en.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":che(o.open),...i,ref:h,onClick:Tt(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?p:c.jsx(kw,{asChild:!0,...u,children:p})});rhe.displayName=nhe;var yB="PopoverPortal",[x6e,T6e]=Qde(yB,{forceMount:void 0}),ihe=e=>{const{__scopePopover:t,forceMount:n,children:i,container:o}=e,u=kf(yB,t);return c.jsx(x6e,{scope:t,forceMount:n,children:c.jsx(is,{present:n||u.open,children:c.jsx(jw,{asChild:!0,container:o,children:i})})})};ihe.displayName=yB;var py="PopoverContent",ahe=S.forwardRef((e,t)=>{const n=T6e(py,e.__scopePopover),{forceMount:i=n.forceMount,...o}=e,u=kf(py,e.__scopePopover);return c.jsx(is,{present:i||u.open,children:u.modal?c.jsx(R6e,{...o,ref:t}):c.jsx(N6e,{...o,ref:t})})});ahe.displayName=py;var C6e=bf("PopoverContent.RemoveScroll"),R6e=S.forwardRef((e,t)=>{const n=kf(py,e.__scopePopover),i=S.useRef(null),o=Dn(t,i),u=S.useRef(!1);return S.useEffect(()=>{const h=i.current;if(h)return N1(h)},[]),c.jsx(Vw,{as:C6e,allowPinchZoom:!0,children:c.jsx(she,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Tt(e.onCloseAutoFocus,h=>{var p;h.preventDefault(),u.current||(p=n.triggerRef.current)==null||p.focus()}),onPointerDownOutside:Tt(e.onPointerDownOutside,h=>{const p=h.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,v=p.button===2||g;u.current=v},{checkForDefaultPrevented:!1}),onFocusOutside:Tt(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),N6e=S.forwardRef((e,t)=>{const n=kf(py,e.__scopePopover),i=S.useRef(!1),o=S.useRef(!1);return c.jsx(she,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h,p;(h=e.onCloseAutoFocus)==null||h.call(e,u),u.defaultPrevented||(i.current||(p=n.triggerRef.current)==null||p.focus(),u.preventDefault()),i.current=!1,o.current=!1},onInteractOutside:u=>{var g,v;(g=e.onInteractOutside)==null||g.call(e,u),u.defaultPrevented||(i.current=!0,u.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const h=u.target;((v=n.triggerRef.current)==null?void 0:v.contains(h))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&o.current&&u.preventDefault()}})}),she=S.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:u,disableOutsidePointerEvents:h,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:v,onInteractOutside:b,...E}=e,T=kf(py,n),C=Kw(n);return C1(),c.jsx(Fw,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:u,children:c.jsx(Hy,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:b,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:v,onDismiss:()=>T.onOpenChange(!1),children:c.jsx(m1,{"data-state":che(T.open),role:"dialog",id:T.contentId,...C,...E,ref:t,style:{...E.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ohe="PopoverClose",A6e=S.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=kf(ohe,n);return c.jsx(en.button,{type:"button",...i,ref:t,onClick:Tt(e.onClick,()=>o.onOpenChange(!1))})});A6e.displayName=ohe;var I6e="PopoverArrow",O6e=S.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=Kw(n);return c.jsx(g1,{...o,...i,ref:t})});O6e.displayName=I6e;function che(e){return e?"open":"closed"}var P6e=ehe,k6e=rhe,j6e=ihe,lhe=ahe;const D6e=P6e,L6e=k6e,uhe=S.forwardRef(({className:e,align:t="center",sideOffset:n=4,...i},o)=>c.jsx(j6e,{children:c.jsx(lhe,{ref:o,align:t,sideOffset:n,className:kt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i})}));uhe.displayName=lhe.displayName;const Nm="https://api.gada.chat";async function ZE(e={}){const t=await fetch(`${Nm}/api/messenger/conversations`,{credentials:"include",headers:e});if(!t.ok)throw new Error("Failed to load conversations");return t.json()}async function AU(e,t={}){const n=await fetch(`${Nm}/api/messenger/conversations/open`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({userId:e})});if(!n.ok)throw new Error("Failed to open conversation");return n.json()}async function dhe(e,{cursor:t,limit:n=20}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=await fetch(`${Nm}/api/messenger/conversations/${e}/messages?${o.toString()}`,{credentials:"include",headers:i});if(!u.ok)throw new Error("Failed to load messages");return u.json()}async function M6e(e,{text:t,image:n,voice:i},o={}){const u=new FormData;t&&u.append("message",t),n&&u.append("image",n),i&&u.append("voice",i);const h=await fetch(`${Nm}/api/messenger/conversations/${e}/messages`,{method:"POST",credentials:"include",headers:o,body:u});if(!h.ok)throw new Error("Failed to send message");return h.json()}async function hhe(e,t,n={}){const i=await fetch(`${Nm}/api/messenger/conversations/${e}/typing`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({typing:t})});if(!i.ok)throw new Error("Failed to set typing");return i.json()}async function fhe(e,t={}){const n=await fetch(`${Nm}/api/messenger/conversations/${e}/seen`,{method:"POST",credentials:"include",headers:t});if(!n.ok)throw new Error("Failed to mark seen");return n.json()}async function U6e(e,t={}){const n=await fetch(`${Nm}/api/messenger/users/suggest?q=${encodeURIComponent(e)}`,{credentials:"include",headers:t});if(!n.ok)throw new Error("Failed to search users");return n.json()}const z1="https://api.gada.chat",F6e={iceServers:[{urls:["stun:stun.l.google.com:19302"]}],iceTransportPolicy:"all"};async function V6e(e,t,n,i){const o=await fetch(`${z1}/api/messenger/call/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:i},body:JSON.stringify({conversationId:e,toUserId:t,type:n})});if(!o.ok)throw new Error("Failed to start call");return o.json()}async function B6e(e,t,n){fetch(`${z1}/api/messenger/call/answer`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({callId:e,type:t})})}async function $6e(e,t,n,i){fetch(`${z1}/api/messenger/call/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({callId:e,type:t,declined:!!i})})}function W6e({open:e,onOpenChange:t,kind:n,peer:i,conversationId:o,socket:u,authKey:h,incoming:p,offer:g,room:v,callId:b}){const E=S.useRef(null),T=S.useRef(null),C=S.useRef(null),R=S.useRef(null),[N,O]=S.useState(!1),[k,j]=S.useState(n==="audio"),[P,M]=S.useState(!1),[D,U]=S.useState(b??null),[V,z]=S.useState(v??null);function W(){if(C.current)return C.current;const J=new RTCPeerConnection(F6e);return J.ontrack=re=>{const[X]=re.streams;T.current&&X&&(T.current.srcObject=X)},J.onicecandidate=re=>{!re.candidate||!V||u==null||u.emit("call:candidate",{room:V,candidate:re.candidate})},C.current=J,J}async function Y(J){const re=await navigator.mediaDevices.getUserMedia({audio:!0,video:J==="video"});R.current=re,E.current&&(E.current.srcObject=re);const X=W();re.getTracks().forEach(de=>X.addTrack(de,re))}async function Q(){M(!0);try{const J=await V6e(o,i.id,n,h);z(J.room),U(J.callId),u==null||u.emit("call:join",{room:J.room}),await Y(n);const re=W(),X=await re.createOffer();await re.setLocalDescription(X),u==null||u.emit("call:offer",{toUserId:i.id,conversationId:o,kind:n,room:J.room,callId:J.callId,sdp:X})}finally{M(!1)}}async function K(J,re,X){M(!0);try{u==null||u.emit("call:join",{room:X}),await Y(n);const de=W();await de.setRemoteDescription(new RTCSessionDescription(J));const we=await de.createAnswer();await de.setLocalDescription(we),u==null||u.emit("call:answer",{room:X,sdp:we,callId:re,kind:n,conversationId:o}),await B6e(re,n,h)}finally{M(!1)}}S.useEffect(()=>{if(!u)return;const J=async({room:de,sdp:we})=>{!V||de!==V||await W().setRemoteDescription(new RTCSessionDescription(we))},re=async({room:de,candidate:we})=>{if(!(!V||de!==V))try{await W().addIceCandidate(new RTCIceCandidate(we))}catch{}},X=({room:de})=>{V&&de===V&&ae()};return u.on("call:answer",J),u.on("call:candidate",re),u.on("call:end",X),()=>{u.off("call:answer",J),u.off("call:candidate",re),u.off("call:end",X)}},[u,V]),S.useEffect(()=>{e&&(async()=>p&&g&&v&&b?(z(v),U(b),await K(g,b,v)):await Q())()},[e]);function q(){const J=R.current;J&&(J.getAudioTracks().forEach(re=>re.enabled=!re.enabled),O(!N))}function ee(){const J=R.current;J&&(J.getVideoTracks().forEach(re=>re.enabled=!re.enabled),j(!k))}function oe(){var J,re,X;try{(J=C.current)==null||J.getSenders().forEach(de=>{var we;return(we=de.track)==null?void 0:we.stop()})}catch{}try{(re=R.current)==null||re.getTracks().forEach(de=>de.stop())}catch{}try{(X=C.current)==null||X.close()}catch{}C.current=null,R.current=null}function ae(J){D&&$6e(D,n,h,J),V&&(u==null||u.emit("call:end",{room:V})),oe(),t(!1)}return e?c.jsx("div",{className:"fixed inset-0 z-[95] bg-black/50 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white w-full max-w-[820px] rounded-xl shadow-xl overflow-hidden",children:[c.jsxs("div",{className:"px-4 h-12 bg-[#1877F2] text-white flex items-center justify-between",children:[c.jsxs("div",{className:"font-medium",children:[n==="video"?"Video call":"Audio call"," with ",(i==null?void 0:i.fullName)||(i==null?void 0:i.username)]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(be,{size:"icon",variant:"ghost",className:"text-white hover:bg-white/10",onClick:q,title:N?"Unmute":"Mute",children:N?c.jsx(ZVe,{className:"h-5 w-5"}):c.jsx(ele,{className:"h-5 w-5"})}),n==="video"&&c.jsx(be,{size:"icon",variant:"ghost",className:"text-white hover:bg-white/10",onClick:ee,title:k?"Camera on":"Camera off",children:k?c.jsx(u4e,{className:"h-5 w-5"}):c.jsx(xN,{className:"h-5 w-5"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"text-white hover:bg-red-500/20",onClick:()=>ae(!1),title:"End call",children:c.jsx(t4e,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:"p-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx("video",{ref:E,muted:!0,playsInline:!0,autoPlay:!0,className:"w-full aspect-video bg-black rounded"}),c.jsx("video",{ref:T,playsInline:!0,autoPlay:!0,className:"w-full aspect-video bg-black rounded"})]}),P&&c.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"Connecting…"})]})}):null}function G6e({item:e,incomingOffer:t,onConsumeIncoming:n}){const{conversationId:i,peer:o}=e,{minimizeWindow:u,closeWindow:h,socket:p,authKey:g,authKeyUpload:v}=a_(),[b,E]=S.useState(!!e.minimized),[T,C]=S.useState(null),[R,N]=S.useState(null),[O,k]=S.useState(!1),[j,P]=S.useState(!1),[M,D]=S.useState(""),[U,V]=S.useState(null),[z,W]=S.useState(null),[Y,Q]=S.useState(!1),[K,q]=S.useState("audio"),[ee,oe]=S.useState(null),ae=S.useRef(null),J=S.useRef(!0),re=S.useRef(!1);S.useEffect(()=>{function Te(Pe){const dt=Pe.detail;dt&&dt.conversationId===i&&oe({kind:dt.kind,offer:dt.sdp,room:dt.room,callId:dt.callId})}return window.addEventListener("gada:call-offer",Te),()=>window.removeEventListener("gada:call-offer",Te)},[i]),S.useEffect(()=>{const Te=window.__GADA_OFFERS__;if(!Te)return;const Pe=Te[i];Pe&&(oe({kind:Pe.kind,offer:Pe.sdp,room:Pe.room,callId:Pe.callId}),delete Te[i])},[i]),S.useEffect(()=>{t&&t.conversationId===i&&(oe({kind:t.kind,offer:t.sdp,room:t.room,callId:t.callId}),n==null||n(i))},[t,i,n]),S.useEffect(()=>{u(i,b)},[b,i,u]),S.useEffect(()=>{X()},[i]);async function X(){C(null),N(null),k(!1),await de(!0),requestAnimationFrame(()=>{ae.current&&(ae.current.scrollTop=ae.current.scrollHeight)})}async function de(Te=!1){if(!(re.current||O&&!Te)){re.current=!0,P(!0);try{const{items:Pe=[],nextCursor:rt}=await dhe(i,{cursor:Te?null:R,limit:25},{Authorization:g});C(dt=>dt?[...Pe,...dt]:Pe),N(rt??null),(!rt||Pe.length===0)&&k(!0),Te&&await fhe(i,{Authorization:g})}catch(Pe){console.error(Pe)}finally{re.current=!1,P(!1)}}}async function we(){if(!(!M&&!U&&!z))try{const Te=await M6e(i,{text:M,image:U,voice:z},{Authorization:v});C(Pe=>Pe?[...Pe,{...Te}]:[{...Te}]),D(""),V(null),W(null)}catch(Te){console.error(Te)}}S.useEffect(()=>{const Te=setTimeout(()=>{hhe(i,!1,{Authorization:g}).catch(()=>{})},900);return()=>clearTimeout(Te)},[M,i,g]),S.useEffect(()=>{if(!p)return;const Te=({message:Pe})=>{Pe.conversationId===i&&C(rt=>rt?[...rt,Pe]:[Pe])};return p.on("message:new",Te),()=>{p.off("message:new",Te)}},[p,i]),S.useEffect(()=>{if(!p)return;const Te=({conversationId:Pe,kind:rt,room:dt,callId:ze,sdp:vt})=>{Pe===i&&oe({kind:rt,offer:vt,room:dt,callId:ze})};return p.on("call:offer",Te),()=>{p.off("call:offer",Te)}},[p,i]),S.useEffect(()=>{!ae.current||!T||b||J.current&&(ae.current.scrollTop=ae.current.scrollHeight)},[T,b]);function ge(Te){const Pe=Te.currentTarget,rt=Pe.scrollHeight-Pe.scrollTop-Pe.clientHeight;if(J.current=rt<80,Pe.scrollTop<=0&&!j&&!O){const dt=Pe.scrollHeight;de(!1).then(()=>{requestAnimationFrame(()=>{const ze=Pe.scrollHeight-dt;Pe.scrollTop=ze})})}}return c.jsxs("div",{className:"w-[320px] bg-white rounded-xl shadow-xl border border-slate-200 flex flex-col overflow-hidden max-h-[75vh] md:max-h-[620px]",children:[c.jsxs("div",{className:"h-12 px-3 rounded-t-xl bg-[#1877F2] text-white flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs($i,{className:"h-7 w-7 ring-2 ring-white/20",children:[c.jsx(Oi,{src:o!=null&&o.avatar?z1+"/uploads/"+Kn(o.avatar):""}),c.jsx(Qi,{children:((o==null?void 0:o.fullName)||(o==null?void 0:o.username)||"?").slice(0,1).toUpperCase()})]}),c.jsx("div",{className:"text-sm font-medium",children:(o==null?void 0:o.fullName)||(o==null?void 0:o.username)})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>{q("audio"),Q(!0)},title:"Audio call",children:c.jsx(n4e,{className:"h-4 w-4"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>{q("video"),Q(!0)},title:"Video call",children:c.jsx(AN,{className:"h-4 w-4"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>E(Te=>!Te),title:b?"Expand":"Minimize",children:b?c.jsx(S1,{className:"h-4 w-4"}):c.jsx(Zy,{className:"h-4 w-4"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>h(i),title:"Close",children:c.jsx(go,{className:"h-4 w-4"})})]})]}),ee&&c.jsxs("div",{className:"px-3 py-2 bg-amber-50 border-b text-sm flex items-center justify-between",children:[c.jsxs("div",{children:[ee.kind==="video"?"Video":"Audio"," call from ",(o==null?void 0:o.fullName)||(o==null?void 0:o.username)]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{size:"sm",onClick:()=>{q(ee.kind),Q(!0)},children:"Accept"}),c.jsx(be,{size:"sm",variant:"secondary",onClick:()=>oe(null),children:"Decline"})]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-3 py-2",ref:ae,onScroll:ge,children:[!T&&c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"}),T==null?void 0:T.map(Te=>c.jsx("div",{className:`my-1 flex ${Te.authorId===(o==null?void 0:o.id)?"justify-start":"justify-end"}`,children:c.jsx("div",{className:"max-w-[75%] rounded-lg px-3 py-2 text-sm bg-gray-100",children:Te.text})},Te.id))]}),c.jsxs("div",{className:"px-2 py-2 border-t flex items-end gap-2",children:[c.jsx(be,{size:"icon",variant:"ghost",children:c.jsx(Zce,{className:"h-5 w-5"})}),c.jsx(be,{size:"icon",variant:"ghost",children:c.jsx(ele,{className:"h-5 w-5"})}),c.jsx(Ne,{value:M,onChange:Te=>D(Te.target.value),placeholder:"Write a message…",onKeyDown:Te=>{Te.key==="Enter"&&we()}}),c.jsxs(be,{onClick:we,children:[c.jsx(rle,{className:"h-4 w-4 mr-1"}),"Send"]})]}),c.jsx(W6e,{open:Y,onOpenChange:Te=>{Q(Te),Te||oe(null)},kind:K,peer:o,conversationId:i,socket:p,authKey:g,incoming:!!ee,offer:ee==null?void 0:ee.offer,room:ee==null?void 0:ee.room,callId:ee==null?void 0:ee.callId})]})}function H6e({stashIncoming:e}){const{socket:t}=a_(),n=S.useRef(!1);return S.useEffect(()=>{if(!t)return;const i=()=>{if(n.current)return;const o=u=>{console.log("emit received");const h={conversationId:Number(u.conversationId),fromUserId:Number(u.fromUserId),kind:u.kind,room:u.room,callId:Number(u.callId),sdp:u.sdp};e(h)};t.on("call:offer",o),n.current=!0,t.once("disconnect",()=>{try{t.off("call:offer",o)}catch{}n.current=!1})};return t.connected&&i(),t.on("connect",i),()=>{try{t.off("connect",i)}catch{}n.current=!1}},[t,e]),null}function z6e(){const{windows:e,socket:t,ensureWindowForConversation:n,openConversation:i,openChatWith:o,openWindowForUser:u}=a_(),[h,p]=S.useState({}),g=async b=>{n?await n(b.conversationId,b.fromUserId):o?await o(b.fromUserId):u?await u(b.fromUserId):i&&i(b.conversationId,void 0),p(E=>({...E,[b.conversationId]:b}))},v=b=>p(E=>{const{[b]:T,...C}=E;return C});return c.jsxs(c.Fragment,{children:[c.jsx(H6e,{stashIncoming:g}),(e==null?void 0:e.length)>0&&c.jsx("div",{className:"fixed bottom-2 right-2 z-[90] flex gap-2 overflow-x-auto max-w-full pr-2",children:e.map(b=>c.jsx(G6e,{item:b,incomingOffer:h[b.conversationId],onConsumeIncoming:v},b.conversationId))})]})}const phe=S.createContext(null);function K6e({children:e}){const{accessToken:t}=st(),n=wt(t),i=Hl(t),o=(n==null?void 0:n.Authorization)??"",u=(i==null?void 0:i.Authorization)??"",[h,p]=S.useState([]),[g,v]=S.useState({}),b=S.useRef(null);S.useEffect(()=>{if(!t)return;const k=vB(t);return b.current=k,()=>{try{k.close()}catch{}b.current=null}},[t]);const E=S.useCallback(async k=>{if(g[k])return g[k];try{const P=(await ZE(n)).find(M=>M.conversationId===k);if(P)return v(M=>({...M,[k]:P.peer})),P.peer}catch{}return null},[n,g]),T=S.useCallback(async(k,j)=>{const P=j||await E(k);P&&p(M=>{if(M.some(V=>V.conversationId===k))return M.map(V=>V.conversationId===k?{...V,minimized:!1}:V);const U=[...M,{conversationId:k,peer:P,minimized:!1}];return U.length>4?U.slice(U.length-4):U})},[E]),C=S.useCallback(async(k,j)=>{const{conversationId:P}=await AU(k,n);j&&v(M=>({...M,[P]:j})),await T(P,j)},[n,T]),R=S.useCallback(k=>{p(j=>j.filter(P=>P.conversationId!==k))},[]),N=S.useCallback((k,j)=>{p(P=>P.map(M=>M.conversationId===k?{...M,minimized:j}:M))},[]),O=S.useMemo(()=>({windows:h,openConversation:T,openChatWith:C,closeWindow:R,minimizeWindow:N,socket:b.current,authKey:o,authKeyUpload:u}),[h,T,C,R,N,o,u]);return c.jsxs(phe.Provider,{value:O,children:[e,c.jsx(z6e,{})]})}function a_(){const e=S.useContext(phe);if(!e)throw new Error("useChatDock must be used within ChatDockProvider");return e}const q6e="https://api.gada.chat";function mhe({open:e,onOpenChange:t,onPick:n,search:i}){const[o,u]=S.useState(""),[h,p]=S.useState(!1),[g,v]=S.useState([]),b=S.useRef(null),E=S.useRef();return S.useEffect(()=>{if(!e){u(""),v([]);return}},[e]),S.useEffect(()=>{if(!e)return;const T=o.trim();if(E.current&&clearTimeout(E.current),b.current&&b.current.abort(),T.length<2){v([]),p(!1);return}return p(!0),E.current=window.setTimeout(async()=>{try{b.current=new AbortController;const C=await i(T);v(C)}finally{p(!1)}},250),()=>{E.current&&clearTimeout(E.current),b.current&&b.current.abort()}},[o,e,i]),c.jsx(Yo,{open:e,onOpenChange:t,children:c.jsxs(vo,{className:"sm:max-w-lg",children:[c.jsx(Xo,{children:c.jsx(Jo,{children:"New message"})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ne,{value:o,onChange:T=>u(T.target.value),placeholder:"Search people",autoFocus:!0}),h&&c.jsx("div",{className:"text-sm text-gray-500",children:"Searching…"}),c.jsxs("div",{className:"max-h-80 overflow-y-auto",children:[g.map(T=>c.jsxs("button",{className:"w-full flex items-center gap-3 px-2 py-2 rounded hover:bg-gray-50 text-left",onClick:()=>n(T),children:[c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Oi,{src:T.avatar?q6e+"/uploads/"+Kn(T.avatar):""}),c.jsx(Qi,{children:(T.fullName||T.username).slice(0,1).toUpperCase()})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium",children:T.fullName||T.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",T.username]})]})]},T.id)),!h&&g.length===0&&o.trim().length>=2&&c.jsx("div",{className:"text-sm text-gray-500 px-2 py-4",children:"No people found"})]})]})]})})}const Y6e="https://api.gada.chat",X6e=e=>(e||"?").split(" ").filter(Boolean).map(t=>t[0].toUpperCase()).slice(0,2).join("");function J6e(){const{accessToken:e}=st(),t=wt(e),{openConversation:n,openChatWith:i,ensureWindowForConversation:o,socket:u}=a_(),[h,p]=S.useState(null),[g,v]=S.useState(!1),[b,E]=S.useState(null),[T,C]=S.useState(null),[R,N]=S.useState(!1),[O,k]=S.useState(""),j=S.useMemo(()=>{const q=O.trim().toLowerCase();return!q||!h?h||[]:h.filter(ee=>{const oe=(ee.peer.fullName||ee.peer.username||"").toLowerCase(),ae=(ee.lastText||"").toLowerCase();return oe.includes(q)||ae.includes(q)})},[O,h]),[P,M]=S.useState(!1),[D,U]=S.useState(!1),[V,z]=S.useState(!1);S.useEffect(()=>{!(D||V)||h||W(!0)},[D,V]);async function W(q=!1){if(!g){v(!0),E(null);try{const ee=await ZE(t),oe=Array.isArray(ee==null?void 0:ee.items)?ee.items:Array.isArray(ee)?ee:[],ae=(ee==null?void 0:ee.nextCursor)??null;p(J=>q?oe:[...J||[],...oe]),C(ae),N(!!ae)}catch(ee){console.error(ee),E("Failed to load conversations")}finally{v(!1)}}}function Y(q){n(q.conversationId,q.peer),U(!1),z(!1)}const Q=S.useRef(!1);S.useEffect(()=>{if(!u)return;const q=()=>{if(Q.current)return;const ee=async oe=>{console.log("recieved here");const ae={conversationId:Number(oe.conversationId),fromUserId:Number(oe.fromUserId),kind:oe.kind,room:oe.room,callId:Number(oe.callId),sdp:oe.sdp};try{o?await o(ae.conversationId,ae.fromUserId):i?await i(ae.fromUserId):n(ae.conversationId,{id:ae.fromUserId,username:"",fullName:""})}catch(J){console.error("[call:offer] failed to open chat window",J)}window.__GADA_OFFERS__=window.__GADA_OFFERS__||{},window.__GADA_OFFERS__[ae.conversationId]=ae;try{window.dispatchEvent(new CustomEvent("gada:call-offer",{detail:ae}))}catch{}};u.on("call:offer",ee),Q.current=!0,u.once("disconnect",()=>{try{u.off("call:offer",ee)}catch{}Q.current=!1})};return u.connected&&q(),u.on("connect",q),()=>{try{u.off("connect",q)}catch{}Q.current=!1}},[u,o,n,i]);function K(q){return c.jsxs("div",{className:"w-full",children:[c.jsx("div",{className:"p-3 border-b",children:c.jsxs("div",{className:"relative",children:[c.jsx(Sf,{className:"h-4 w-4 text-gray-400 absolute left-3 top-2.5"}),c.jsx(Ne,{placeholder:"Search messages",value:O,onChange:ee=>k(ee.target.value),className:"pl-9 bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})}),b&&c.jsx("div",{className:"p-3 text-sm text-red-600",children:b}),!b&&!h&&c.jsxs("div",{className:"p-4 text-sm text-gray-500 flex items-center gap-2",children:[c.jsx(si,{className:"h-4 w-4 animate-spin"})," Loading…"]}),h&&c.jsxs("div",{className:"max-h-[70vh] overflow-y-auto",children:[j.length===0&&c.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No conversations"}),j.map(ee=>{var oe;return c.jsxs("button",{onClick:()=>Y(ee),className:"w-full flex items-center gap-3 px-3 py-2 hover:bg-gray-50",children:[c.jsxs($i,{className:"h-9 w-9",children:[c.jsx(Oi,{src:(oe=ee.peer)!=null&&oe.avatar?Y6e+"/uploads/"+Kn(ee.peer.avatar):""}),c.jsx(Qi,{children:X6e(ee.peer.fullName||ee.peer.username)})]}),c.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:ee.peer.fullName||ee.peer.username}),ee.lastTime&&c.jsx("div",{className:"ml-3 text-[11px] text-gray-500 shrink-0",children:new Date(ee.lastTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),c.jsx("div",{className:"text-xs text-gray-500 truncate",children:ee.lastText||" "})]}),!!ee.unread&&c.jsx("span",{className:"ml-2 inline-flex items-center justify-center h-5 min-w-[20px] px-1 rounded-full bg-[#1877F2] text-white text-[11px]",children:ee.unread})]},ee.conversationId)}),R&&c.jsx("div",{className:"p-2",children:c.jsx(be,{onClick:()=>W(!1),disabled:g,variant:"outline",className:"w-full",children:g?"Loading…":"Load more"})})]}),c.jsxs("div",{className:"p-3 border-t flex items-center justify-between",children:[c.jsx(be,{variant:"outline",size:"sm",onClick:()=>M(!0),children:"New message"}),c.jsx(be,{variant:"ghost",size:"sm",onClick:q,children:"Close"})]}),c.jsx(mhe,{open:P,onOpenChange:ee=>M(ee),onPicked:async ee=>{await i(ee.id,{id:ee.id,username:ee.username,fullName:ee.fullName,avatar:ee.avatar}),M(!1),q==null||q()}})]})}return c.jsxs(c.Fragment,{children:[c.jsxs(D6e,{open:D,onOpenChange:U,children:[c.jsx(L6e,{asChild:!0,children:c.jsx(be,{variant:"ghost",className:"hidden md:inline-flex p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full","aria-label":"Messages",children:c.jsx(RN,{className:"h-6 w-6"})})}),c.jsx(uhe,{className:"w-[360px] p-0 overflow-hidden",align:"end",sideOffset:8,children:K(()=>U(!1))})]}),c.jsxs(B1,{open:V,onOpenChange:z,children:[c.jsx(lB,{asChild:!0,children:c.jsx(be,{variant:"ghost",className:"md:hidden p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full","aria-label":"Messages",children:c.jsx(RN,{className:"h-6 w-6"})})}),c.jsxs(Gw,{side:"bottom",className:"p-0 h-[85vh] rounded-t-2xl",children:[c.jsx(uB,{className:"px-4 py-3 border-b",children:c.jsx(dB,{className:"text-left",children:"Messages"})}),K(()=>z(!1))]})]})]})}const sv="https://api.gada.chat",MC=e=>e.split(" ").map(t=>t[0]).join("").toUpperCase();function or(){const{user:e,accessToken:t,logout:n}=st(),i=tr(),[o,u]=S.useState(!0),[h,p]=S.useState(""),[g,v]=S.useState({user_wallet_balance:0,user_points:0}),b=wt(t),[E,T]=S.useState(!1),[C,R]=S.useState(!1),[N,O]=S.useState(null),[k,j]=S.useState(-1),P=S.useRef(null),M=S.useRef(null),D=S.useRef(null),U=S.useRef(null),V=S.useRef(b);S.useEffect(()=>{V.current=b},[b]);const z=S.useRef("");S.useEffect(()=>{const oe=ae=>{P.current&&(P.current.contains(ae.target)||M.current&&M.current.contains(ae.target)||(T(!1),j(-1)))};return document.addEventListener("mousedown",oe),()=>document.removeEventListener("mousedown",oe)},[]),S.useEffect(()=>{t&&(u(!0),jR(b).then(v).catch(console.error).finally(()=>u(!1)))},[t]),S.useEffect(()=>{const oe=h.trim();if(U.current&&window.clearTimeout(U.current),D.current&&D.current.abort(),oe.length<2){O(null),T(!!oe),R(!1),z.current="";return}if(z.current!==oe)return R(!0),T(!0),U.current=window.setTimeout(async()=>{try{z.current=oe,D.current=new AbortController;const ae=await fetch(`${sv.replace(/\/+$/,"")}/api/search/suggest?q=${encodeURIComponent(oe)}`,{headers:V.current,signal:D.current.signal});if(!ae.ok)throw new Error("search failed");if(z.current!==oe)return;const J=await ae.json();O(J),j(-1)}catch(ae){(ae==null?void 0:ae.name)!=="AbortError"&&console.error("[search]",ae)}finally{z.current===oe&&R(!1)}},250),()=>{U.current&&window.clearTimeout(U.current),D.current&&D.current.abort()}},[h,t]);const W=oe=>{oe.preventDefault();const ae=h.trim();ae&&(T(!1),j(-1),i(`/search?q=${encodeURIComponent(ae)}`))},Y=(()=>{if(!N)return[];const oe=N.top.map(X=>({group:"Top",kind:X.kind,data:X.data})),ae=N.users.map(X=>({group:"People",kind:"user",data:X})),J=N.posts.map(X=>({group:"Posts",kind:"post",data:X})),re=N.tags.map(X=>({group:"Hashtags",kind:"tag",data:X}));return[...oe,...ae,...J,...re]})(),Q=oe=>{if(E)if(oe.key==="ArrowDown")oe.preventDefault(),j(ae=>Math.min(ae+1,Y.length-1));else if(oe.key==="ArrowUp")oe.preventDefault(),j(ae=>Math.max(ae-1,-1));else if(oe.key==="Enter")if(k>=0&&Y[k]){const ae=Y[k];K(ae.kind,ae.data)}else W(oe);else oe.key==="Escape"&&(T(!1),j(-1))};function K(oe,ae){T(!1),j(-1),oe==="user"?i(`/profile/${L0(String(ae.id))}`):oe==="post"?i(`/posts/${ae.id}`):oe==="tag"&&i(`/hashtag/${encodeURIComponent(ae.tag)}`)}const q=()=>{n(),i("/login")},ee=oe=>MC(oe);return e?c.jsx("nav",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between h-16",children:[c.jsxs("div",{className:"flex items-center flex-1",children:[c.jsxs(Nt,{to:"/",className:"flex-shrink-0 flex items-center",children:[c.jsx("h1",{className:"text-[#1877F2] text-2xl font-bold"}),c.jsx("img",{src:sv+"/uploads/gadalogo.png",alt:"Gada",className:"h-10 w-auto",onError:oe=>{oe.currentTarget.src="/placeholder.png"}})]}),c.jsxs("div",{className:"hidden sm:block ml-6 w-full max-w-md relative",ref:P,children:[c.jsx("form",{onSubmit:W,className:"flex",children:c.jsxs("div",{className:"relative w-full",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Sf,{className:"h-4 w-4 text-gray-400"})}),c.jsx(Ne,{ref:M,type:"text",placeholder:"Search people, posts, #hashtags",value:h,onChange:oe=>p(oe.target.value),onKeyDown:Q,className:"pl-10 w-full bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})}),E&&c.jsxs("div",{className:"absolute left-0 right-0 mt-2 bg-white border border-gray-200 rounded-xl shadow-xl overflow-hidden",children:[C&&c.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Searching…"}),!C&&(!N||N.users.length+N.posts.length+N.tags.length+N.top.length===0)&&c.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No results"}),!C&&N&&c.jsxs("div",{className:"max-h-[70vh] overflow-y-auto",children:[N.top.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"Top"}),N.top.map((oe,ae)=>{const J=ae;return c.jsxs("button",{onMouseEnter:()=>j(J),onClick:()=>K(oe.kind,oe.data),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-3 ${k===J?"bg-gray-50":""}`,children:[oe.kind==="user"&&c.jsxs(c.Fragment,{children:[c.jsxs($i,{className:"h-7 w-7",children:[c.jsx(Oi,{src:sv+"/uploads/"+Kn(oe.data.avatar||"")}),c.jsx(Qi,{children:MC(oe.data.fullName||oe.data.username)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium",children:oe.data.fullName||oe.data.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",oe.data.username]})]})]}),oe.kind==="post"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-7 w-7 rounded bg-blue-100 flex items-center justify-center text-blue-600 text-xs",children:"Post"}),c.jsx("div",{className:"text-sm line-clamp-2",dangerouslySetInnerHTML:{__html:oe.data.snippet}})]}),oe.kind==="tag"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-7 w-7 rounded bg-purple-100 flex items-center justify-center text-purple-600 text-xs",children:"#"}),c.jsxs("div",{className:"text-sm",children:["#",oe.data.tag," ",c.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:[oe.data.count," posts"]})]})]})]},`top-${ae}`)})]}),N.users.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"People"}),N.users.map((oe,ae)=>{const J=N.top.length+ae;return c.jsxs("button",{onMouseEnter:()=>j(J),onClick:()=>K("user",oe),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-3 ${k===J?"bg-gray-50":""}`,children:[c.jsxs($i,{className:"h-7 w-7",children:[c.jsx(Oi,{src:sv+"/uploads/"+Kn(oe.avatar||"")}),c.jsx(Qi,{children:MC(oe.fullName||oe.username)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium",children:oe.fullName||oe.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",oe.username]})]})]},`u-${oe.id}`)})]}),N.posts.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"Posts"}),N.posts.map((oe,ae)=>{var re,X;const J=N.top.length+N.users.length+ae;return c.jsxs("button",{onMouseEnter:()=>j(J),onClick:()=>K("post",oe),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-start gap-3 ${k===J?"bg-gray-50":""}`,children:[c.jsxs($i,{className:"h-7 w-7 mt-0.5",children:[c.jsx(Oi,{src:sv+"/uploads/"+Kn(((re=oe.author)==null?void 0:re.avatar)||"")}),c.jsx(Qi,{children:MC(((X=oe.author)==null?void 0:X.username)||"U")})]}),c.jsx("div",{className:"text-sm line-clamp-2",dangerouslySetInnerHTML:{__html:oe.snippet}})]},`p-${oe.id}`)})]}),N.tags.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"Hashtags"}),N.tags.map((oe,ae)=>{const J=N.top.length+N.users.length+N.posts.length+ae;return c.jsxs("button",{onMouseEnter:()=>j(J),onClick:()=>K("tag",oe),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-3 ${k===J?"bg-gray-50":""}`,children:[c.jsx("div",{className:"h-7 w-7 rounded bg-purple-100 flex items-center justify-center text-purple-600 text-xs",children:"#"}),c.jsxs("div",{className:"text-sm",children:["#",oe.tag," ",c.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:[oe.count," posts"]})]})]},`t-${oe.id}`)})]})]})]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[c.jsx(Nt,{to:"/",className:"p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full",children:c.jsx(gU,{className:"h-6 w-6"})}),c.jsx(Nt,{to:"/friends",className:"p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full",children:c.jsx(uy,{className:"h-6 w-6"})}),c.jsx(J6e,{}),c.jsx(y6e,{}),c.jsxs(tB,{children:[c.jsx(nB,{asChild:!0,children:c.jsx(be,{variant:"ghost",className:"p-1 rounded-full",children:c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Oi,{src:sv+"/uploads/"+Kn(e.profileImage),alt:e.username}),c.jsx(Qi,{children:ee(e.username)})]})})}),c.jsxs(M1,{align:"end",children:[c.jsx(Nt,{to:`/profile/${L0(e.id.toString())}`,children:c.jsxs(Dc,{className:"cursor-pointer",children:[c.jsx(QZ,{className:"mr-2 h-4 w-4"})," Profile"]})}),c.jsx(nf,{}),c.jsx(Nt,{to:"/points",children:c.jsxs(Dc,{className:"cursor-pointer",children:[c.jsx(HZ,{className:"mr-2 h-4 w-4"})," Points"," ",c.jsx("span",{className:"badge bg-light text-primary",children:g.user_points})]})}),(e==null?void 0:e.roles)=="admin"?c.jsx(Nt,{to:"/admin",children:c.jsxs(Dc,{className:"cursor-pointer",children:[c.jsx(JZ,{className:"mr-2 h-4 w-4"})," Admin panel"," "]})}):"",c.jsx(nf,{}),c.jsx(Nt,{to:"/wallet",children:c.jsxs(Dc,{className:"cursor-pointer",children:[c.jsx(dy,{className:"mr-2 h-4 w-4"})," Wallet"," ",c.jsxs("span",{className:"badge bg-light text-primary",children:["₦",g.user_wallet_balance]})]})}),c.jsx(nf,{}),c.jsxs(Dc,{onClick:n,className:"cursor-pointer",children:[c.jsx(qZ,{className:"mr-2 h-4 w-4"})," Logout"]})]})]})]}),c.jsx("div",{className:"sm:hidden flex items-center",children:c.jsxs(B1,{children:[c.jsx(lB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"ml-2",children:c.jsx(Qce,{className:"h-6 w-6"})})}),c.jsxs(Gw,{className:"flex flex-col h-screen overflow-y-auto p-6",children:[c.jsx("div",{className:"flex items-center justify-between pb-4 border-b",children:c.jsx("h2",{className:"text-lg font-semibold",children:"Menu"})}),c.jsx("form",{onSubmit:W,className:"my-6",children:c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Sf,{className:"h-4 w-4 text-gray-400"})}),c.jsx(Ne,{ref:M,type:"text",placeholder:"Search people, posts, #hashtags",value:h,onChange:oe=>p(oe.target.value),onKeyDown:Q,className:"pl-10 w-full bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})}),c.jsxs("div",{className:"flex flex-col space-y-2",children:[c.jsxs(Nt,{to:"/",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(gU,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Home"})]}),c.jsxs(Nt,{to:`/profile/${e.id}`,className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(QZ,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Profile"})]}),c.jsxs(Nt,{to:"/friends",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(uy,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"People"})]}),(e==null?void 0:e.roles)=="admin"?c.jsxs(Nt,{to:"/admin",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(JZ,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Admin panel"})]}):"",c.jsxs(Nt,{to:"/wallet",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(dy,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsxs("span",{children:["Wallet"," ",c.jsxs("span",{className:"badge bg-light text-primary",children:["₦",g.user_wallet_balance]})]})]}),c.jsxs(Nt,{to:"/points",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(HZ,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsxs("span",{children:["Points",c.jsx("span",{className:"badge bg-light text-primary",children:g.user_points})]})]}),c.jsxs(Nt,{to:"/saved",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(I4,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Saved"})]}),c.jsxs(Nt,{to:"/affiliates",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(Jce,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Affiliates"})]}),c.jsxs(Nt,{to:"/packages",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(k4,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Packages"})]}),c.jsxs(Nt,{to:"/memories",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(j4,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Memories"})]}),c.jsxs(Nt,{to:"/ads",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(O0,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Ads Management"})]}),c.jsxs(Nt,{to:"/representative",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(Tm,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Representative"})]}),c.jsxs(Nt,{to:"/messages",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(RN,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Messages"})]}),c.jsxs(Nt,{to:"/pages",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(ly,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Pages"})]}),c.jsxs(Nt,{to:"/scheduled",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(A0,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Scheduled"})]}),c.jsx(Nt,{to:"/notifications",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:c.jsx("span",{children:"Notifications"})}),c.jsx("div",{className:"pt-2 mt-2 border-t",children:c.jsxs(be,{onClick:q,variant:"ghost",className:"flex items-center w-full justify-start p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(qZ,{className:"h-5 w-5 mr-3 text-red-500"}),c.jsx("span",{children:"Logout"})]})})]})]})]})})]})})}):null}const Z6e=[{name:"News Feed",icon:gU,route:"/"},{name:"Mine",icon:DVe},{name:"Saved",icon:I4,route:"/saved"},{name:"Scheduled",icon:A0,route:"/scheduled"},{name:"Memories",icon:j4,route:"/memories"},{name:"Packages",icon:k4,route:"/packages"},{name:"Affiliates",icon:Jce,route:"/affiliates"}],Q6e=[{name:"Popular",icon:ly,route:"/mine/popular"},{name:"My Offers",icon:ale,route:"/mine/offers"},{name:"My Blogs",icon:ly,route:"/mine/blogs"}],e8e=[{name:"People",icon:uy,route:"/friends"},{name:"Representative",icon:Tm,route:"/representative"},{name:"Wallet",icon:dy,route:"/wallet"},{name:"Pages",icon:ly,route:"/pages"},{name:"Groups",icon:uy,route:"/groups"},{name:"Events",icon:LVe,route:"/events"},{name:"Reels",icon:AN,route:"/reels"},{name:"Watch",icon:AN,route:"/watch"},{name:"Blogs",icon:ly,route:"/blogs"},{name:"Offers",icon:ale,route:"/offers"}],Ss=()=>{const e=tr(),{user:t,isLoading:n}=st();console.log(t,n,"useruser");const[i,o]=S.useState(window.location.pathname),[u,h]=S.useState(!1),[p,g]=S.useState(!1);S.useEffect(()=>{var R;const T=window.matchMedia("(orientation: landscape)"),C=()=>{const N=window.innerWidth||document.documentElement.clientWidth;g(T.matches&&N>=640)};return C(),(R=T.addEventListener)==null||R.call(T,"change",C),window.addEventListener("resize",C),()=>{var N;(N=T.removeEventListener)==null||N.call(T,"change",C),window.removeEventListener("resize",C)}},[]);const v=T=>{if(T.name==="Mine"){h(C=>!C);return}T.route&&(e(T.route),o(T.route),u&&h(!1))},b=(T,C=!1)=>{const R=T.route===i,N=T.icon;return c.jsxs("button",{onClick:()=>!C&&v(T),disabled:C,className:`
          flex items-center w-full text-left px-3 py-2 rounded-lg transition-colors duration-150
          ${C?"text-gray-400 cursor-not-allowed":R?"bg-purple-100 text-purple-700":"text-gray-600 hover:bg-gray-100"}
        `,children:[c.jsx(N,{className:"w-5 h-5","aria-hidden":"true"}),c.jsx("span",{className:"ml-3 flex-1",children:T.name}),T.name==="Mine"&&(u?c.jsx(S1,{className:"w-4 h-4"}):c.jsx(Zy,{className:"w-4 h-4"}))]},T.name)},E=[...Z6e];return n||(t!=null&&t.packageactive?E.push({name:"Ads Manager",icon:O0,route:"/ads"}):E.push({name:"Ads Manager",icon:O0})),c.jsxs("aside",{className:`
        ${p?"flex":"hidden"}
        lg:flex lg:w-64 bg-white p-4 border-r border-gray-200 h-full flex-col rounded-lg shadow
      `,children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-2",children:"Main"}),c.jsx("ul",{className:"space-y-1",children:E.map(T=>c.jsxs("li",{children:[b(T,T.name==="Ads Manager"&&!(t!=null&&t.packageactive)),T.name==="Mine"&&u&&c.jsx("ul",{className:"mt-1 space-y-1 pl-8",children:Q6e.map(C=>c.jsx("li",{children:c.jsxs("button",{onClick:()=>v(C),className:`
                          flex items-center w-full text-left px-2 py-1 rounded-lg transition-colors duration-150
                          ${C.route===i?"bg-purple-50 text-purple-700":"text-gray-600 hover:bg-gray-100"}
                        `,children:[c.jsx(C.icon,{className:"w-4 h-4","aria-hidden":"true"}),c.jsx("span",{className:"ml-2 text-sm",children:C.name})]})},C.name))})]},T.name))})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-2",children:"Explore"}),c.jsx("ul",{className:"space-y-1",children:e8e.map(T=>c.jsx("li",{children:b(T)},T.name))})]}),c.jsx("div",{className:"mt-auto pt-4 border-t border-gray-200",children:c.jsxs("button",{onClick:()=>e("/settings"),className:"flex items-center w-full text-left p-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors duration-150",children:[c.jsx(ile,{className:"w-5 h-5","aria-hidden":"true"}),c.jsx("span",{className:"ml-3 text-sm font-medium",children:"Settings"})]})})]})},K1="https://api.gada.chat";async function t8e(e,t=12){const n=await fetch(`${K1}/api/pro/users?limit=${t}`,{headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to load pro users");return n.json()}async function n8e(e){const t=await fetch(`${K1}/api/pro/activepackage`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to load pro users");return t.json()}async function r8e(e,t=12){const n=await fetch(`${K1}/api/pro/trending?limit=${t}`,{headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to load pro users");return n.json()}async function i8e(e,t=12){const n=new URL(`${K1}/api/pro/pages`);n.searchParams.set("limit",String(t));const i=await fetch(n.toString(),{headers:e});if(!i.ok)throw new Error("pro-pages");return((await i.json()).items||[]).map(u=>{let h=u.avatar||"profile/defaultavatar.png";return h.startsWith("/uploads")||(h=`/uploads/${h}`.replace("//uploads","/uploads")),{id:u.id,name:u.name,avatar:h,likes:u.likes}})}const s_="https://api.gada.chat";async function ghe(e,t){const n=await fetch(`${s_}/api/friends/requests`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({toUserId:e})});if(!n.ok)throw new Error("Failed to send request");return n.json()}async function a8e(e){const t=await fetch(`${s_}/api/friends/requests`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to load requests");return t.json()}async function s8e(e,t,n){const i=await fetch(`${s_}/api/friends/requests/${e}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({action:t})});if(!i.ok)throw new Error("Failed to respond");return i.json()}async function LQ(e){const t=await fetch(`${s_}/api/friends/list`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to fetch friends");return t.json()}async function VR(e){const t=await fetch(`${s_}/api/friends/suggestions`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to fetch suggestions");return t.json()}async function o8e(e,t){const n=await fetch(`${s_}/api/users/search?q=${encodeURIComponent(e)}`,{credentials:"include",headers:{Accept:"application/json",...t}});if(!n.ok)throw new Error("User search failed");return n.json()}const qu="https://api.gada.chat";async function c8e(e,t){const n=new FormData;return n.append("image",e),(await fetch(`${qu}/api/ads/upload`,{method:"POST",credentials:"include",headers:t,body:n})).json()}async function l8e(e,t){return(await fetch(`${qu}/api/ads/campaigns`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)})).json()}async function u8e(e=1,t=10,n){return(await fetch(`${qu}/api/ads/campaigns?page=${e}&limit=${t}`,{credentials:"include",headers:n})).json()}async function UC(e,t,n){return(await fetch(`${qu}/api/ads/campaigns/${e}/status`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({active:t})})).json()}async function d8e(e,t){const n=new URLSearchParams(e).toString();return(await fetch(`${qu}/api/ads/serve?${n}`,{headers:t})).json()}async function h8e(e,t){return fetch(`${qu}/api/ads/${e}/track-view`,{method:"POST",headers:t}).then(n=>n.json())}async function f8e(e,t){return fetch(`${qu}/api/ads/${e}/track-click`,{method:"POST",headers:t}).then(n=>n.json())}async function p8e(e){return(await fetch("https://api.gada.chat/api/ads/countries",{headers:{...e||{}}})).json()}async function m8e(e,t,n){return(await fetch(`${qu}/api/ads/campaigns/${e}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",...n||{}},body:JSON.stringify(t)})).json()}async function g8e(e,t){return(await fetch(`${qu}/api/ads/campaigns/${e}`,{method:"DELETE",credentials:"include",headers:{...t||{}}})).json()}async function v8e(e){return(await fetch(`${qu}/api/ads/whoami`,{headers:{...e||{}},credentials:"include"})).json()}const y8e="https://api.gada.chat";function _8e(e="0px"){const t=S.useRef(null),[n,i]=S.useState(!1);return S.useEffect(()=>{const o=t.current;if(!o||n)return;const u=new IntersectionObserver(([h])=>{h!=null&&h.isIntersecting&&(i(!0),u.disconnect())},{root:null,rootMargin:e,threshold:.15});return u.observe(o),()=>u.disconnect()},[n,e]),{ref:t,isVisible:n}}function vhe({placement:e,className:t=""}){const{accessToken:n,user:i}=st(),o=wt(n),[u,h]=S.useState(null),[p,g]=S.useState(!0),[v,b]=S.useState(null),[E,T]=S.useState(!1),[C,R]=S.useState({});S.useEffect(()=>{let P=!0;const M=i&&i.country_id?{country_id:i.country_id}:{};if(M.country_id){R(D=>({...D,...M}));return}return(async()=>{try{const D=await v8e(o);if(!P)return;D!=null&&D.ok&&R({country_id:D.country_id||void 0,gender:D.gender||void 0,relationship:D.relationship||void 0})}catch{}})(),()=>{P=!1}},[i,n]),S.useEffect(()=>{let P=!0;return(async()=>{try{g(!0);const M={placement:e};C.country_id&&(M.country_id=C.country_id),C.gender&&(M.gender=C.gender),C.relationship&&(M.relationship=C.relationship);const D=await d8e(M,o);if(!P)return;D!=null&&D.ok&&(D!=null&&D.item)?(h(D.item),b(null)):(h(null),b((D==null?void 0:D.error)||"No ad"))}catch(M){if(!P)return;b((M==null?void 0:M.message)||"Failed to load ad"),h(null)}finally{P&&g(!1)}})(),()=>{P=!1}},[e,C.country_id,C.gender,C.relationship,n]);const{ref:N,isVisible:O}=_8e("120px");S.useEffect(()=>{!u||E||!O||(T(!0),h8e(u.campaign_id,o).catch(()=>{}))},[u,O,E,o]);const k=()=>{u&&(f8e(u.campaign_id,o).catch(()=>{}),u.ads_url&&window.open(u.ads_url,"_blank","noopener,noreferrer"))};if(p)return c.jsx("div",{className:`rounded-2xl border bg-white p-4 flex items-center justify-center ${t}`,children:c.jsx(si,{className:"h-5 w-5 animate-spin text-purple-600"})});if(!u)return null;const j=e==="sidebar";return c.jsxs("div",{ref:N,className:`rounded-2xl border bg-white overflow-hidden ${t}`,role:"region","aria-label":"Sponsored",children:[c.jsx("div",{className:"px-4 pt-4 flex items-center gap-2 text-sm text-gray-500",children:c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx("span",{className:"text-yellow-500",children:"📣"}),c.jsx("span",{className:"font-semibold",children:"Sponsored"})]})}),u.ads_image&&c.jsx("div",{className:`${j?"aspect-[16/10]":"aspect-[16/9]"} w-full bg-gray-100 cursor-pointer`,onClick:k,children:c.jsx("img",{src:y8e+"/uploads/"+Kn(u.ads_image),alt:u.ads_title||"Sponsored",className:"h-full w-full object-cover",loading:"lazy"})}),c.jsxs("div",{className:"px-4 py-3",children:[u.ads_title&&c.jsx("div",{onClick:k,className:"font-semibold text-gray-900 hover:underline cursor-pointer line-clamp-2",title:u.ads_title||"",children:u.ads_title}),u.ads_description&&c.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:u.ads_description}),u.ads_url&&c.jsxs("button",{onClick:k,className:"mt-3 inline-flex items-center gap-2 rounded-xl bg-purple-600 text-white px-4 py-2 hover:bg-purple-700",children:["Learn more ",c.jsx(Xce,{className:"h-4 w-4"})]})]})]})}const ju="https://api.gada.chat",b8e=[{id:1,name:"Chibuzor Okafor",avatar:`${ju}/uploads/profile/defaultavatar.png`},{id:2,name:"Ajibo Chima",avatar:`${ju}/uploads/profile/defaultavatar.png`},{id:3,name:"Anthonia Adoyi",avatar:`${ju}/uploads/profile/defaultavatar.png`}],E8e=[{id:"p1",name:"STAGES",avatar:`${ju}/uploads//profile/defaultavatar.png`},{id:"p2",name:"Movie World",avatar:`${ju}/uploads//profile/defaultavatar.png`},{id:"p3",name:"EBUKABEST",avatar:`${ju}/uploads//profile/defaultavatar.png`}],w8e=[{tag:"#movieworld",count:15},{tag:"#space",count:5},{tag:"#gada",count:4},{tag:"#science",count:6},{tag:"#Fact",count:4},{tag:"#sports",count:3}];function _B({children:e,className:t}){return c.jsx("section",{className:kt("bg-white rounded-2xl shadow-sm border p-4",t),children:e})}function MQ({items:e,title:t,cta:n,onCta:i,onItemClick:o}){return c.jsxs(_B,{className:"p-5",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(BVe,{className:"h-5 w-5 text-yellow-500"}),c.jsx("h3",{className:"text-base font-semibold",children:t})]}),n&&c.jsx("button",{type:"button",onClick:i,className:"text-sm font-medium text-indigo-600 hover:text-indigo-700",children:n})]}),c.jsx("div",{className:"flex gap-5 overflow-x-auto pb-1 hide-scrollbar",children:e.map(u=>c.jsxs("button",{type:"button",onClick:()=>o==null?void 0:o(u),className:"min-w-[84px] flex flex-col items-center focus:outline-none","aria-label":`Open ${u.name}`,children:[c.jsx("div",{className:"h-20 w-20 rounded-full shadow ring-2 ring-white overflow-hidden",children:c.jsx("img",{src:u.avatar,alt:u.name,className:"h-full w-full object-cover"})}),c.jsx("div",{className:"mt-2 text-center text-sm font-medium text-gray-900 line-clamp-1",children:u.name})]},u.id))})]})}function S8e({tags:e}){return!Array.isArray(e)||e.length===0?c.jsxs("div",{className:"rounded-2xl p-5 bg-gradient-to-tr from-pink-500 to-rose-500 text-white shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(ZZ,{className:"h-5 w-5"}),c.jsx("h3",{className:"text-base font-semibold",children:"Trending"})]}),c.jsx("div",{className:"text-white/90 text-sm",children:"No trends right now"})]}):c.jsxs("div",{className:"rounded-2xl p-5 bg-gradient-to-tr from-pink-500 to-rose-500 text-white shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(ZZ,{className:"h-5 w-5"}),c.jsx("h3",{className:"text-base font-semibold",children:"Trending"})]}),c.jsx("ul",{className:"space-y-2",children:e.map(t=>{const n=(t.tag||"").replace(/^#/,""),i=`/hashtag/${encodeURIComponent(n)}`;return c.jsx("li",{children:c.jsxs(Nt,{to:i,title:`Open #${n}`,className:`flex items-center justify-between rounded-md px-2 py-2
                           hover:bg-white/10 focus:bg-white/10 focus:outline-none
                           transition-colors`,children:[c.jsxs("div",{className:"text-lg font-semibold",children:["#",n]}),c.jsxs("div",{className:"text-sm/5 opacity-90",children:[t.count," Posts"]})]})},t.tag)})})]})}function x8e({list:e,onAdd:t,onSeeAll:n}){return c.jsxs(_B,{className:"p-5",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Suggested Friends"}),c.jsxs("button",{type:"button",onClick:n,className:"text-sm font-medium text-gray-600 hover:text-gray-900 inline-flex items-center gap-1",children:["See All ",c.jsx(OVe,{className:"h-4 w-4"})]})]}),c.jsx("ul",{className:"divide-y",children:e.map(i=>{const o=i.id??i.user_id,u=i.user_name??i.username??"User";let h;if(i.profileImage){let p=i.profileImage;h=ju+"/uploads/"+p}else h=`${ju}/uploads//profile/defaultavatar.png`;return c.jsxs("li",{className:"py-3 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("img",{src:h,alt:u,className:"h-12 w-12 rounded-full object-cover bg-gray-100"}),c.jsx("div",{className:"min-w-0",children:c.jsx(Nt,{to:`/profile/${L0(o)}`,children:c.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:u})})})]}),c.jsx(be,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>t==null?void 0:t(o),"aria-label":`Add ${u}`,children:c.jsx(Tm,{className:"h-4 w-4"})})]},o)})})]})}function q1({onAddFriend:e,onUpgradeClick:t,onSeeAllSuggestions:n}){const{accessToken:i}=st(),o=wt(i),u=tr(),h=S.useRef(o);S.useEffect(()=>{h.current=o},[o]);const[p,g]=S.useState(b8e),[v,b]=S.useState([]),[E,T]=S.useState(w8e),[C,R]=S.useState(!1),N=C?{}:{cta:"Upgrade",onCta:()=>u("/packages")},[O,k]=S.useState(E8e),j=async M=>{const D=String(M);try{await ghe(M,h.current),b(U=>U.filter(V=>String(V.id??V.user_id)!==D)),Ce.success("Your request has been sent successfully.")}catch(U){console.error("Failed to send friend request",U),Ce.error("Failed to send friend request",U)}},P=S.useRef(!1);return S.useEffect(()=>{if(!i||P.current)return;P.current=!0;let M=!0;return(async()=>{try{const D=await t8e(o,12);if(!M)return;g(D.map(U=>{const V=`${ju}`.replace(/\/+$/,"");let z=U.avatar||"/uploads//profile/defaultavatar.png";return z.startsWith("/uploads")||(z=`/uploads/${z}`.replace("//uploads","/uploads")),{id:U.id,name:U.name,avatar:`${V}${z}`}}))}catch(D){console.error("[RightSidebar] failed to load pro users",D)}})(),(async()=>{var D;try{const U=await n8e(o);if(console.log(U,"listlist"),!M)return;R((D=U==null?void 0:U.data)==null?void 0:D.active)}catch(U){console.error("[RightSidebar] failed to load pro users",U)}})(),(async()=>{try{const D=await i8e(o,12);if(!M)return;const U=`${ju}`.replace(/\/+$/,"");k(D.map(V=>({id:V.id,name:V.name,avatar:`${U}${V.avatar}`})))}catch(D){console.error("[RightSidebar] failed to load pro pages",D)}})(),(async()=>{try{const D=await r8e(o,12,"24 HOUR");if(!M)return;T(D.data.map(U=>({tag:U.hashtag.startsWith("#")?U.hashtag:`#${U.hashtag}`,count:Number(U.post_count)||0})))}catch(D){console.error("[RightSidebar] failed to load trending hashtags",D)}})(),(async()=>{try{const D=await VR(o);if(!M)return;b(D||[])}catch(D){console.error("[RightSidebar] failed to load friend suggestions",D),b([])}})(),()=>{M=!1}},[i]),c.jsxs("div",{className:"sticky top-20 space-y-6",children:[c.jsx(MQ,{items:p,title:"Pro Users",...N,onItemClick:M=>u(`/profile/${L0(M.id)}`)}),c.jsx(MQ,{items:O,title:"Pro Pages",...N,onItemClick:M=>u(`/pages/${M.id}`)}),c.jsx(S8e,{tags:E}),c.jsx(vhe,{placement:"sidebar"}),c.jsxs(_B,{className:"p-5",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Gadashares"}),c.jsx("div",{className:"mt-2 h-14 rounded-xl bg-gray-50"})]}),c.jsx(x8e,{list:v,onAdd:j,onSeeAll:()=>u("/friends")})]})}const lL="https://api.gada.chat",T8e=6e3,C8e=1e4;function R8e({group:e,onClose:t,initialIndex:n=0}){var K;const[i,o]=S.useState(n),u=e.stories.length,h=e.stories[i],p=S.useMemo(()=>(h==null?void 0:h.meta)||(h==null?void 0:h.metadata)||(h==null?void 0:h.extras)||{},[h]),g=h.type==="video",v=lL+"/uploads/"+Kn(h.url),[b,E]=S.useState(!1),[T,C]=S.useState(0),[R,N]=S.useState(null),O=g?R??C8e:T8e,k=S.useRef(null),j=S.useRef(null),P=S.useRef(null),M=S.useRef(null);S.useEffect(()=>{let q=!1;E(!1);async function ee(){if(g)P.current&&P.current.readyState>=2?E(!0):E(!1);else{const re=new Image;re.decoding="async",re.fetchPriority="high",re.src=v;try{await re.decode()}catch{await new Promise(X=>{re.onload=()=>X(),re.onerror=()=>X()})}q||E(!0)}}function oe(re){if(!re)return;const X=new Image;X.fetchPriority="low",X.loading="eager",X.src=re}ee();const ae=i+1<u?lL+"/uploads/"+Kn(e.stories[i+1].url):null,J=i-1>=0?lL+"/uploads/"+Kn(e.stories[i-1].url):null;return ae&&e.stories[i+1].type==="image"&&oe(ae),J&&e.stories[i-1].type==="image"&&oe(J),C(0),N(null),j.current=null,()=>{q=!0}},[i,v,g,u]);const D=()=>{k.current&&cancelAnimationFrame(k.current),k.current=null},U=S.useCallback(()=>{if(D(),i<u-1){o(q=>q+1);return}t("finished")},[i,u,t]),V=S.useCallback(()=>{if(D(),i>0){o(q=>q-1);return}t("prevGroup")},[i,t]);S.useEffect(()=>{if(D(),C(0),!b)return;const q=ee=>{j.current==null&&(j.current=ee);const oe=ee-j.current,ae=Math.min(100,oe/O*100);if(C(ae),ae>=100){U();return}k.current=requestAnimationFrame(q)};return k.current=requestAnimationFrame(q),()=>D()},[b,O,U]);const z=()=>{var q;if((q=P.current)!=null&&q.duration&&isFinite(P.current.duration)){const ee=Math.max(1e3,Math.floor(P.current.duration*1e3));N(ee)}},W=()=>{E(!0)},Y=()=>U();S.useEffect(()=>{const q=ee=>{ee.key==="ArrowRight"&&U(),ee.key==="ArrowLeft"&&V(),ee.key==="Escape"&&t("user")};return window.addEventListener("keydown",q),()=>window.removeEventListener("keydown",q)},[U,V,t]);const Q=e.stories.map((q,ee)=>ee<i?100:ee===i?T:0);return S.useEffect(()=>{if(!(!M.current||!(p!=null&&p.musicUrl)))return M.current.volume=Math.min(1,Math.max(0,p.musicVolume??.8)),M.current.play().catch(()=>{}),()=>{var q;try{(q=M.current)==null||q.pause()}catch{}}},[i,p==null?void 0:p.musicUrl,p==null?void 0:p.musicVolume]),c.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:c.jsxs("div",{className:"relative w-full max-w-lg",children:[c.jsx("div",{className:"absolute top-3 left-3 right-3 flex gap-1 z-30",children:Q.map((q,ee)=>c.jsx("div",{className:"h-1.5 w-full bg-white/30 rounded overflow-hidden",children:c.jsx("div",{className:"h-full bg-white",style:{width:`${q}%`,transition:q===0||q===100?"width 0.2s linear":"none"}})},ee))}),c.jsxs("div",{className:"relative rounded overflow-hidden",children:[!b&&c.jsx("div",{className:"w-full max-h-[80vh] rounded bg-[#111] flex items-center justify-center",style:p!=null&&p.blurDataURL?{backgroundImage:`url("${p.blurDataURL}")`,backgroundSize:"cover",backgroundPosition:"center",filter:"blur(12px)"}:{},children:!(p!=null&&p.blurDataURL)&&c.jsx("div",{className:"w-2/3 h-3/4 bg-white/10 animate-pulse rounded"})}),h.type==="image"?c.jsx("img",{src:v,className:`w-full max-h-[80vh] object-contain rounded transition-opacity duration-150 ${b?"opacity-100":"opacity-0"}`,alt:"",draggable:!1,loading:"eager",fetchpriority:"high",onLoad:()=>E(!0)}):c.jsx("video",{ref:P,src:v,className:`w-full max-h-[80vh] object-contain rounded transition-opacity duration-150 ${b?"opacity-100":"opacity-0"}`,autoPlay:!0,playsInline:!0,preload:"metadata",onLoadedMetadata:z,onLoadedData:W,onEnded:Y}),!!((K=p==null?void 0:p.overlays)!=null&&K.length)&&b&&c.jsx("div",{className:"pointer-events-none absolute inset-0 z-20",children:p.overlays.map(q=>c.jsx("div",{className:"absolute select-none",style:{left:`${q.xPct}%`,top:`${q.yPct}%`,transform:`translate(-50%, -50%) rotate(${q.rotateDeg??0}deg)`,fontSize:(q.fontSize??22)+"px",color:q.color??"#fff",fontWeight:q.weight??600,textShadow:"0 2px 6px rgba(0,0,0,0.5)",whiteSpace:"pre-wrap",textAlign:"center"},children:q.text},q.id))}),(p==null?void 0:p.caption)&&b&&c.jsx("div",{className:"absolute bottom-3 left-3 right-3 z-20",children:c.jsx("div",{className:"bg-black/50 text-white rounded px-3 py-2 text-sm",children:p.caption})}),c.jsx("button",{className:"absolute top-2 right-2 inline-flex items-center justify-center rounded-full bg-black/50 hover:bg-black/70 text-white p-2 transition z-40",onClick:q=>{q.stopPropagation(),t("user")},"aria-label":"Close",children:c.jsx(go,{className:"h-5 w-5"})}),c.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-2 pr-10 z-30",children:c.jsx("button",{className:"inline-flex items-center justify-center rounded-full bg-black/40 hover:bg-black/60 text-white p-2 transition",onClick:q=>{q.stopPropagation(),V()},"aria-label":"Previous",children:c.jsx(P4,{className:"h-6 w-6"})})}),c.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pl-10 z-30",children:c.jsx("button",{className:"inline-flex items-center justify-center rounded-full bg-black/40 hover:bg-black/60 text-white p-2 transition",onClick:q=>{q.stopPropagation(),U()},"aria-label":"Next",children:c.jsx(Lw,{className:"h-6 w-6"})})}),c.jsx("button",{className:"absolute inset-y-0 left-0 w-1/3 cursor-pointer bg-transparent z-20",onClick:q=>{q.stopPropagation(),V()},"aria-label":"Previous zone"}),c.jsx("button",{className:"absolute inset-y-0 right-0 w-1/3 cursor-pointer bg-transparent z-20",onClick:q=>{q.stopPropagation(),U()},"aria-label":"Next zone"})]}),(p==null?void 0:p.musicUrl)&&c.jsx("audio",{ref:M,src:p.musicUrl,autoPlay:!0,loop:!0})]})})}const N8e=["😀","😃","😄","😁","😆","🥹","😊","🙂","😉","😍","😘","😜","🤩","🥳","🤗","😎","😇","🤔","🤨","😐","😴","🥱","😪","😮","😯","😲","😳","🥵","🥶","😱","😭","😅","😬","🤤","😷","🤒","🤕","🤧","🤮","🤢","😈","👿","💀","👻","👽","🤖","💩","👍","👎","👏","🙌","🙏","🤝","💪","🫶","🤟","✌️","👌","👉","👈","👇","👆","☝️","❤️","🧡","💛","💚","💙","💜","🖤","🤍","💖","💘","💝","💫","✨","⭐️","🔥","🎉","🌟","⚡️","❄️","🌈","🍕","🍔","🍟","🍩","🍰","🍓","🍎","🍇","🍪","☕️","🍺","🎧"],UQ=[{label:"Chill Vibes",url:"https://cdn.example.com/music/chill_vibes.mp3"},{label:"Uplift Pop",url:"https://cdn.example.com/music/uplift_pop.mp3"},{label:"Ambient Pad",url:"https://cdn.example.com/music/ambient_pad.mp3"},{label:"Lo-fi Beat",url:"https://cdn.example.com/music/lofi_beat.mp3"},{label:"Acoustic Loop",url:"https://cdn.example.com/music/acoustic_loop.mp3"},{label:"Cinematic Rise",url:"https://cdn.example.com/music/cinematic_rise.mp3"}],A8e=({file:e,onCancel:t,onPublish:n})=>{const i=S.useMemo(()=>URL.createObjectURL(e),[e]),o=e.type.startsWith("video/"),u=S.useRef(null),[h,p]=S.useState([]),[g,v]=S.useState(null),[b,E]=S.useState(""),[T,C]=S.useState(""),[R,N]=S.useState(.8),[O,k]=S.useState(!0),[j,P]=S.useState(""),M=S.useRef(null),[D,U]=S.useState(!1);S.useEffect(()=>()=>URL.revokeObjectURL(i),[i]);const V=(X,de=X==="emoji"?"🙂":"Your text")=>{const we=Math.random().toString(36).slice(2);p(ge=>[...ge,{id:we,type:X,text:de,xPct:50,yPct:50,fontSize:X==="emoji"?48:22,color:"#ffffff",weight:700,rotateDeg:0}]),v(we)},z=X=>{p(de=>de.filter(we=>we.id!==X)),g===X&&v(null)},W=S.useRef(null),Y=(X,de)=>{var Te;if(!((Te=u.current)==null?void 0:Te.getBoundingClientRect()))return;const ge=h.find(Pe=>Pe.id===de);ge&&(W.current={id:de,startX:X.clientX,startY:X.clientY,startXPct:ge.xPct,startYPct:ge.yPct},X.target.setPointerCapture(X.pointerId),v(de))},Q=X=>{if(!W.current||!u.current)return;const de=u.current.getBoundingClientRect(),we=(X.clientX-W.current.startX)/de.width*100,ge=(X.clientY-W.current.startY)/de.height*100;p(Te=>Te.map(Pe=>Pe.id===W.current.id?{...Pe,xPct:FQ(W.current.startXPct+we,0,100),yPct:FQ(W.current.startYPct+ge,0,100)}:Pe))},K=X=>{if(W.current)try{X.target.releasePointerCapture(X.pointerId)}catch{}W.current=null},q=h.find(X=>X.id===g)||null,ee=X=>{q&&p(de=>de.map(we=>we.id===q.id?{...we,...X}:we))},oe=X=>{V("emoji",X)},ae=async()=>{if(T&&M.current){M.current.volume=Math.min(1,Math.max(0,R));try{await M.current.play(),U(!0)}catch{}}},J=()=>{var X;try{(X=M.current)==null||X.pause()}catch{}U(!1)},re=()=>{n({caption:b.trim()||void 0,overlays:h,musicUrl:T.trim()||void 0,musicVolume:R})};return c.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white w-full max-w-6xl h-[90vh] rounded-xl shadow-2xl flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 py-3 border-b bg-white",children:[c.jsx("h3",{className:"font-semibold",children:"Create Story"}),c.jsx("button",{onClick:t,className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:c.jsx(go,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"flex-1 overflow-hidden bg-white",children:c.jsxs("div",{className:"h-full flex overflow-hidden",children:[c.jsx("div",{className:"flex-1 flex items-center justify-center bg-black",children:c.jsxs("div",{ref:u,className:"relative w-full max-w-[400px] max-h-[72vh] aspect-[9/16] bg-black rounded-lg overflow-hidden",onPointerMove:Q,onPointerUp:K,children:[o?c.jsx("video",{src:i,className:"w-full h-full object-contain",autoPlay:!0,muted:!0,loop:!0}):c.jsx("img",{src:i,className:"w-full h-full object-contain",alt:""}),h.map(X=>c.jsx("div",{className:`absolute cursor-move select-none ${g===X.id?"ring-2 ring-purple-400 rounded":""}`,style:{left:`${X.xPct}%`,top:`${X.yPct}%`,transform:`translate(-50%, -50%) rotate(${X.rotateDeg??0}deg)`,fontSize:(X.fontSize??22)+"px",color:X.color??"#fff",fontWeight:X.weight??700,textShadow:"0 2px 6px rgba(0,0,0,0.6)",whiteSpace:"pre-wrap",textAlign:"center",pointerEvents:"auto"},onPointerDown:de=>Y(de,X.id),onClick:()=>v(X.id),children:X.text},X.id)),b&&c.jsx("div",{className:"absolute bottom-3 left-3 right-3",children:c.jsx("div",{className:"bg-black/50 text-white rounded px-3 py-2 text-sm",children:b})})]})}),c.jsxs("div",{className:"w-96 border-l p-4 space-y-4 overflow-y-auto",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>V("text"),children:[c.jsx(o4e,{className:"h-4 w-4"})," Add Text"]}),c.jsxs("button",{className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>k(X=>!X),children:[c.jsx(a4e,{className:"h-4 w-4"})," Emojis ",O?c.jsx(S1,{className:"h-4 w-4"}):c.jsx(Zy,{className:"h-4 w-4"})]})]}),O&&c.jsxs("div",{className:"border rounded-lg p-3",children:[c.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Tap any emoji to add as a sticker (add as many as you like)"}),c.jsx("div",{className:"grid grid-cols-8 gap-2 text-xl",children:N8e.map((X,de)=>c.jsx("button",{className:"h-9 w-9 flex items-center justify-center rounded hover:bg-gray-100",onClick:()=>oe(X),title:X,type:"button",children:X},de))})]}),q&&c.jsxs("div",{className:"border rounded-lg p-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"font-medium text-sm",children:["Selected ",q.type==="emoji"?"Emoji":"Text"]}),c.jsx("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>z(q.id),"aria-label":"Remove",children:c.jsx(F4,{className:"h-4 w-4"})})]}),c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Content"}),c.jsx("input",{className:"w-full border rounded px-2 py-1",value:q.text,onChange:X=>ee({text:X.target.value})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Font size"}),c.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:q.fontSize??22,onChange:X=>ee({fontSize:Number(X.target.value||22)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Weight"}),c.jsxs("select",{className:"w-full border rounded px-2 py-1",value:q.weight??700,onChange:X=>ee({weight:Number(X.target.value)}),children:[c.jsx("option",{value:400,children:"400"}),c.jsx("option",{value:600,children:"600"}),c.jsx("option",{value:700,children:"700"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Color"}),c.jsx("input",{type:"color",className:"w-full border rounded px-2 py-1 h-9",value:q.color??"#ffffff",onChange:X=>ee({color:X.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Rotate"}),c.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:q.rotateDeg??0,onChange:X=>ee({rotateDeg:Number(X.target.value||0)})})]})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs text-gray-600",children:"Caption"}),c.jsx("textarea",{className:"w-full border rounded px-2 py-1",rows:3,value:b,onChange:X=>E(X.target.value),placeholder:"Say something..."})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"block text-xs text-gray-600 flex items-center gap-2",children:[c.jsx(QVe,{className:"h-4 w-4"})," Default Music"]}),c.jsxs("select",{className:"w-full border rounded px-2 py-2",value:j,onChange:X=>{const de=UQ.find(we=>we.label===X.target.value);P(X.target.value),de&&C(de.url)},children:[c.jsx("option",{value:"",children:"— Select a track (optional) —"}),UQ.map(X=>c.jsx("option",{value:X.label,children:X.label},X.label))]}),c.jsx("label",{className:"block text-xs text-gray-600",children:"Or paste a Music URL"}),c.jsx("input",{className:"w-full border rounded px-2 py-1",value:T,onChange:X=>C(X.target.value),placeholder:"https://your-cdn.com/track.mp3"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"block text-xs text-gray-600",children:["Volume: ",R*100|0,"%"]}),c.jsx("input",{type:"range",min:0,max:1,step:.01,value:R,onChange:X=>{const de=Number(X.target.value);N(de),M.current&&(M.current.volume=Math.min(1,Math.max(0,de)))},className:"w-full"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{type:"button",onClick:ae,disabled:!T,className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:[c.jsx(r4e,{className:"h-4 w-4"})," Preview"]}),c.jsxs("button",{type:"button",onClick:J,className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-gray-100 hover:bg-gray-200",children:[c.jsx(s4e,{className:"h-4 w-4"})," Stop"]})]}),c.jsx("audio",{ref:M,src:T||void 0}),c.jsx("div",{className:"text-xs text-gray-500",children:D&&T?"Playing…":""})]})]})]})}),c.jsxs("div",{className:"shrink-0 sticky bottom-0 bg-white border-t px-4 py-3 flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancel"}),c.jsxs("button",{onClick:re,className:"inline-flex items-center gap-2 px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",children:[c.jsx(Dw,{className:"h-4 w-4"})," Publish"]})]})]})})};function FQ(e,t,n){return Math.min(n,Math.max(t,e))}const uL="https://api.gada.chat",I8e=()=>{var P;const{user:e}=st(),{stories:t,addStory:n}=CVe(),i=S.useRef(null),[o,u]=S.useState(null),[h,p]=S.useState(!1),[g,v]=S.useState(null),[b,E]=S.useState(0);g!==null&&t[g]&&t[g];const T=()=>{var M;return(M=i.current)==null?void 0:M.click()},C=M=>{var U;const D=((U=M.target.files)==null?void 0:U[0])??null;M.target.value="",D&&(u(D),p(!0))},R=()=>{p(!1),u(null)},N=()=>{setTimeout(()=>{var U,V;const M=(e==null?void 0:e.userId)??(e==null?void 0:e._id),D=t.findIndex(z=>String(z.userId)===String(M));if(D>=0){const z=Math.max(0,(((V=(U=t[D])==null?void 0:U.stories)==null?void 0:V.length)??1)-1);E(z),v(D)}},400)},O=async M=>{try{if(!o)return;console.log(M,"metametameta"),await n(o,M)}finally{p(!1),u(null),N()}},k=M=>{v(M),E(0)},j=M=>{if(M==="finished"){v(D=>{if(D==null)return D;const U=D+1;return U>=t.length?null:(E(0),U)});return}if(M==="prevGroup"){v(D=>{var z,W;if(D==null)return D;const U=D-1;if(U<0)return null;const V=(W=(z=t[U])==null?void 0:z.stories)!=null&&W.length?t[U].stories.length-1:0;return E(V),U});return}v(null)};return S.useEffect(()=>{g!==null&&g>=t.length&&v(null)},[t.length,g]),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex space-x-3 overflow-x-auto pb-2",children:[e&&c.jsxs("div",{className:"flex-shrink-0 text-center",children:[c.jsx("div",{className:"relative w-16 h-16 rounded-full ring-2 ring-purple-400 overflow-hidden mx-auto cursor-pointer",onClick:T,children:e.profileImage?c.jsx("img",{src:uL+"/uploads/"+Kn(e.profileImage),alt:"Your story",className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:c.jsx(xN,{className:"h-6 w-6 text-gray-500"})})}),c.jsx("span",{className:"mt-1 block text-xs text-gray-700 truncate w-16",children:"Your Story"}),c.jsx("input",{type:"file",accept:"image/*,video/*",className:"hidden",ref:i,onChange:C})]}),t.map((M,D)=>c.jsxs("div",{className:"flex-shrink-0 text-center cursor-pointer",onClick:()=>k(D),children:[c.jsx("div",{className:"w-16 h-16 rounded-full ring-2 ring-purple-400 overflow-hidden mx-auto",children:c.jsx("img",{src:uL+"/uploads/"+Kn(M.avatar||"/profile/defaultavatar.png"),alt:M.username,onError:U=>{U.currentTarget.onerror=null,U.currentTarget.src=uL+"/uploads//profile/defaultavatar.png"},className:"w-full h-full object-cover"})}),c.jsx("span",{className:"mt-1 block text-xs text-gray-700 truncate w-16",children:M.username})]},M.userId??D))]}),g!==null&&t[g]&&c.jsx(R8e,{group:t[g],initialIndex:b,onClose:j},`${((P=t[g])==null?void 0:P.userId)??g}-${b}`),h&&o&&c.jsx(A8e,{file:o,onCancel:R,onPublish:O})]})},O8e="https://api.gada.chat",P8e=O8e.replace(/\/+$/,"");function k8e(e){return Array.isArray(e)?{promotedPost:null,list:e}:e&&typeof e=="object"?{promotedPost:e.promoted??null,list:Array.isArray(e.items)?e.items:[]}:{promotedPost:null,list:[]}}function FC(e){const t=(e==null?void 0:e.post_id)??(e==null?void 0:e.id),n=Number(t);return Number.isFinite(n)&&n>0?n:null}function j8e(){const{user:e,accessToken:t,isLoading:n}=st(),i=wt(t),{posts:o,loading:u,busy:h,loadMore:p}=w1(),g=tr();S.useEffect(()=>aVe(),[]),S.useEffect(()=>{!n&&!t&&g("/login")},[n,t,g]);const{promotedPost:v,list:b}=S.useMemo(()=>k8e(o),[o]),E=S.useMemo(()=>{const k=[],j=v?FC(v):null;j&&k.push(j);for(const P of b){const M=FC(P);M&&k.push(M)}return Array.from(new Set(k))},[v,b]),[T,C]=S.useState({}),R=S.useRef("");S.useEffect(()=>{const k=E.join(",");if(!k||k===R.current)return;R.current=k;let j=!1,P;const M=async()=>{try{const D=`${P8e}/api/live/for-posts?ids=${encodeURIComponent(k)}`,U=await fetch(D,{headers:i});if(!U.ok)return;const V=await U.json();!j&&V&&typeof V=="object"&&C(V.data)}catch{}};return M(),P=window.setInterval(M,12e3),()=>{j=!0,P&&window.clearInterval(P)}},[i,E]);const N=S.useMemo(()=>{if(!v)return null;const k=FC(v);return k?{...v,live:T[k]||null}:v},[v,T]),O=S.useMemo(()=>b!=null&&b.length?b.map(k=>{const j=FC(k);return j?{...k,live:T[j]||null}:k}):[],[b,T]);return n||u?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(si,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 show-sidebar-landscape min-h-0 overflow-y-auto py-6",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsxs("div",{className:"space-y-6 py-6",children:[c.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:c.jsx(VBe,{})}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Stories"}),c.jsx(I8e,{})]}),c.jsx("div",{className:"mx-auto max-w-[680px] w-full",children:c.jsx(vhe,{placement:"newsfeed"})}),c.jsxs("div",{className:"mx-auto max-w-[680px] w-full flex flex-col gap-4",children:[N&&c.jsx("div",{className:"rounded-2xl overflow-hidden border border-slate-200 bg-white",children:c.jsx(Vu,{post:N,live:N.live})}),O.map(k=>c.jsx("div",{className:"rounded-2xl overflow-hidden border border-slate-200 bg-white",children:c.jsx(Vu,{post:k,live:k.live})},String(k.post_id??k.id))),c.jsx("div",{className:"flex items-center justify-center py-6",children:c.jsx(be,{variant:"outline",disabled:h,onClick:()=>p==null?void 0:p(),className:"min-w-[180px]",children:h?c.jsxs(c.Fragment,{children:[c.jsx(si,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading…"]}):"Load more"})})]})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-96 min-h-0 overflow-y-auto pt-6",children:c.jsx(q1,{})})]})})]})}const D8e=Uw("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),xf=S.forwardRef(({className:e,variant:t,...n},i)=>c.jsx("div",{ref:i,role:"alert",className:kt(D8e({variant:t}),e),...n}));xf.displayName="Alert";const L8e=S.forwardRef(({className:e,...t},n)=>c.jsx("h5",{ref:n,className:kt("mb-1 font-medium leading-none tracking-tight",e),...t}));L8e.displayName="AlertTitle";const my=S.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:kt("text-sm [&_p]:leading-relaxed",e),...t}));my.displayName="AlertDescription";function yhe(){const[e,t]=S.useState(""),[n,i]=S.useState(""),[o,u]=S.useState(!1),[h,p]=S.useState(""),[g,v]=S.useState(!1),b=tr(),{login:E}=st(),T=async C=>{if(C.preventDefault(),!e||!n){p("Please fill in all fields");return}v(!0),p("");try{await E(e,n)?b("/"):p("Invalid email or password")}catch(R){p(""+R)}finally{v(!1)}};return c.jsxs(Vr,{className:"w-full max-w-md mx-auto",children:[c.jsxs(pa,{children:[c.jsx(Wa,{className:"text-2xl text-[#1877F2] font-bold",children:"Login to Gada"}),c.jsx(Qy,{children:"Enter your credentials to access your account"})]}),c.jsxs(mi,{children:[h&&c.jsxs(xf,{variant:"destructive",className:"mb-4",children:[c.jsx(x1,{className:"h-4 w-4"}),c.jsx(my,{children:h})]}),c.jsxs("form",{onSubmit:T,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"email",children:"Email/Username"}),c.jsx(Ne,{id:"email",type:"text",placeholder:"your.email@example.com",value:e,onChange:C=>t(C.target.value),required:!0,className:"border-gray-300",autoComplete:"username"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Je,{htmlFor:"password",children:"Password"}),c.jsx(Nt,{to:"/forgot-password",className:"text-sm text-[#1877F2] hover:underline",children:"Forgot password?"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(Ne,{id:"password",type:o?"text":"password",placeholder:"••••••••",value:n,onChange:C=>i(C.target.value),required:!0,className:"border-gray-300 pr-10",autoComplete:"current-password"}),c.jsx("button",{type:"button",onClick:()=>u(C=>!C),className:"absolute inset-y-0 right-2 flex items-center text-gray-500","aria-label":o?"Hide password":"Show password",children:o?c.jsx(pU,{size:18}):c.jsx(TN,{size:18})})]})]}),c.jsx(be,{type:"submit",disabled:g,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:g?"Logging in...":"Login"})]})]}),c.jsx(e_,{className:"flex justify-center border-t p-4",children:c.jsxs("p",{children:["Don't have an account?"," ",c.jsx(Nt,{to:"/register",className:"text-[#1877F2] hover:underline font-medium",children:"Create an account"})]})})]})}const M8e="https://api.gada.chat";function U8e(){const{accessToken:e,isLoading:t}=st(),n=tr();return S.useEffect(()=>{!t&&e&&n("/")},[e,t,n]),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(Nt,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${M8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Connect with friends and the world around you"})]}),c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsx(yhe,{})})]})}function F8e(){const[e,t]=S.useState(""),[n,i]=S.useState(""),[o,u]=S.useState(""),[h,p]=S.useState(""),[g,v]=S.useState(""),[b,E]=S.useState(""),[T,C]=S.useState(""),[R,N]=S.useState(""),[O,k]=S.useState(!1),[j,P]=S.useState(!1),[M,D]=S.useState(!1),U=tr(),{register:V}=st(),z=S.useMemo(()=>{const Y=new URLSearchParams(location.search);return Y.get("ref")||Y.get("r")||""},[location.search]),W=async Y=>{if(Y.preventDefault(),!e||!n||!o||!h||!g||!b){C("Please fill in all fields");return}if(g!==b){C("Passwords do not match");return}if(g.length<6){C("Password must be at least 6 characters long");return}k(!0),C("");try{await V(e,n,o,h,g,z||void 0)?(N("Registration completed successfully, Please check your email and activate the account"),window.setTimeout(()=>U("/login"),3e3)):C("Email is already in use")}catch(Q){C("An error occurred."+Q+" Please try again.")}finally{k(!1)}};return c.jsxs(Vr,{className:"w-full max-w-md mx-auto",children:[c.jsxs(pa,{children:[c.jsx(Wa,{className:"text-2xl text-[#1877F2] font-bold",children:"Create an Account"}),c.jsx(Qy,{children:"Join Gada today and connect with friends"})]}),c.jsxs(mi,{children:[c.jsxs("form",{onSubmit:W,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"firstname",children:"First Name"}),c.jsx(Ne,{id:"firstname",placeholder:"John",value:e,onChange:Y=>t(Y.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"lastname",children:"Last Name"}),c.jsx(Ne,{id:"lastname",placeholder:"Doe",value:n,onChange:Y=>i(Y.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"username",children:"User Name"}),c.jsx(Ne,{id:"username",placeholder:"johndoe",value:o,onChange:Y=>u(Y.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"email",children:"Email"}),c.jsx(Ne,{id:"email",type:"email",placeholder:"your.email@example.com",value:h,onChange:Y=>p(Y.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2 relative",children:[c.jsx(Je,{htmlFor:"password",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ne,{id:"password",type:j?"text":"password",placeholder:"••••••••",value:g,onChange:Y=>v(Y.target.value),required:!0,className:"border-gray-300 pr-10"}),c.jsx("button",{type:"button",onClick:()=>P(!j),className:"absolute inset-y-0 right-2 flex items-center text-gray-500",children:j?c.jsx(pU,{size:18}):c.jsx(TN,{size:18})})]})]}),c.jsxs("div",{className:"space-y-2 relative",children:[c.jsx(Je,{htmlFor:"confirmPassword",children:"Confirm Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ne,{id:"confirmPassword",type:M?"text":"password",placeholder:"••••••••",value:b,onChange:Y=>E(Y.target.value),required:!0,className:"border-gray-300 pr-10"}),c.jsx("button",{type:"button",onClick:()=>D(!M),className:"absolute inset-y-0 right-2 flex items-center text-gray-500",children:M?c.jsx(pU,{size:18}):c.jsx(TN,{size:18})})]})]}),z&&c.jsxs("div",{className:"space-y-1",children:[c.jsx(Je,{children:"Referred by"}),c.jsx(Ne,{value:z,readOnly:!0,className:"bg-gray-100"})]}),c.jsx(be,{type:"submit",disabled:O,className:"w-full bg-[#42B72A] hover:bg-[#36A420] text-white",children:O?"Creating account...":"Sign Up"})]}),c.jsxs("div",{className:"space-y-2 mt-2",children:[T&&c.jsxs(xf,{variant:"destructive",className:"mb-4",children:[c.jsx(x1,{className:"h-4 w-4"}),c.jsx(my,{children:T})]}),R&&c.jsxs(xf,{variant:"success",className:"mb-4",children:[c.jsx(UVe,{className:"h-4 w-4 text-green-600"}),c.jsx(my,{className:"ml-2 text-green-800",children:R})]})]})]}),c.jsx(e_,{className:"flex justify-center border-t p-4",children:c.jsxs("p",{children:["Already have an account?"," ",c.jsx(Nt,{to:"/login",className:"text-[#1877F2] hover:underline font-medium",children:"Log in"})]})})]})}const V8e="https://api.gada.chat";function B8e(){const{user:e,isLoading:t}=st(),n=tr();return S.useEffect(()=>{},[e,t,n]),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(Nt,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${V8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Create an account and connect with friends"})]}),c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsx(F8e,{})})]})}function $8e(){const[e,t]=S.useState(1),[n,i]=S.useState(1),[o,u]=S.useState(""),[h,p]=S.useState(""),[g,v]=S.useState(""),[b,E]=S.useState(""),[T,C]=S.useState(""),[R,N]=S.useState(!1),O=tr(),{sendOtp:k,forgotpassword:j,resetpassword:P,resendOtp:M}=st(),[D,U]=S.useState(!1),[V,z]=S.useState(0);S.useEffect(()=>{if(V>0){const q=setTimeout(()=>z(V-1),1e3);return()=>clearTimeout(q)}},[V]);const W=async()=>{if(!o){C("Please enter your email");return}N(!0),C("");try{await k(o)?(i(2),z(30)):C("Failed to send OTP")}catch(q){C(String(q))}finally{N(!1)}},Y=async q=>{if(q.preventDefault(),console.log("yeah its comes"),!/^\d{4}$/.test(h)){C("OTP must be a 4-digit number");return}N(!0),C("");try{await j(o,h)?t(2):C("Invalid or expired OTP")}catch(ee){C(""+ee)}finally{N(!1)}},Q=async()=>{if(!o){C("Please enter your email first");return}U(!0),C("");try{await M(o),z(30)}catch{C("Failed to resend OTP")}finally{U(!1)}},K=async q=>{if(q.preventDefault(),!g||!b){C("Please fill in both password fields");return}if(g.length<6){C("Password must be at least 6 characters long");return}if(g!==b){C("Passwords do not match");return}N(!0),C("");try{await P(o,h,g)?O("/login"):C("Failed to reset password")}catch(ee){C(String(ee))}finally{N(!1)}};return c.jsxs(Vr,{className:"w-full max-w-md mx-auto",children:[c.jsxs(pa,{children:[c.jsx(Wa,{className:"text-2xl text-[#1877F2] font-bold",children:e===1?"Forgot Password":"Reset Password"}),c.jsx(Qy,{children:e===1?n===1?"Enter your email to receive OTP":"Enter the OTP sent to your email":"Set your new password"})]}),c.jsxs(mi,{children:[T&&c.jsxs(xf,{variant:"destructive",className:"mb-4",children:[c.jsx(x1,{className:"h-4 w-4"}),c.jsx(my,{children:T})]}),e===1&&n===1&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-2 mb-2",children:[c.jsx(Je,{htmlFor:"email",children:"Email"}),c.jsx(Ne,{id:"email",type:"email",placeholder:"your.email@example.com",value:o,onChange:q=>u(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsx(be,{onClick:W,disabled:R,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:R?"Sending...":"Send OTP"})]}),e===1&&n===2&&c.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"email",children:"Email"}),c.jsx(Ne,{value:o,disabled:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Je,{htmlFor:"otp",children:"4-Digit OTP"}),c.jsx("span",{onClick:()=>{!D&&V===0&&Q()},style:{color:V>0?"#999":"#007bff",cursor:V>0||D?"not-allowed":"pointer",textDecoration:V===0&&!D?"underline":"none",fontSize:"14px",display:"inline-block",marginTop:"6px"},children:D?"Sending...":V>0?`Resend in ${V}s`:"Resend"})]}),c.jsx(Ne,{id:"otp",type:"number",onInput:q=>{q.currentTarget.value=q.currentTarget.value.slice(0,4)},placeholder:"1234",value:h,onChange:q=>p(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsx(be,{type:"submit",disabled:R,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:R?"Verifying...":"Verify OTP"})]}),e===2&&c.jsxs("form",{onSubmit:K,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"newPassword",children:"New Password"}),c.jsx(Ne,{id:"newPassword",type:"password",placeholder:"••••••••",value:g,onChange:q=>v(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"confirmPassword",children:"Confirm Password"}),c.jsx(Ne,{id:"confirmPassword",type:"password",placeholder:"••••••••",value:b,onChange:q=>E(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsx(be,{type:"submit",disabled:R,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:R?"Resetting...":"Reset Password"})]})]}),c.jsx(e_,{className:"flex justify-center border-t p-4",children:c.jsxs("p",{children:["Back to ","",c.jsx(Nt,{to:"/login",className:"text-[#1877F2] hover:underline font-medium",children:"Login"})]})})]})}const W8e="https://api.gada.chat";function G8e(){const{accessToken:e,user:t,isLoading:n}=st();return tr(),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(Nt,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${W8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Connect with friends and the world around you"})]}),c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsx($8e,{})})]})}const bB="https://api.gada.chat";async function H8e(e,t={}){const n=await fetch(`${bB}/api/profile/${e}/summary`,{credentials:"include",headers:t});if(!n.ok)throw new Error("Failed to load profile summary");return n.json()}async function z8e(e,{cursor:t,limit:n=10}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=await fetch(`${bB}/api/profile/${e}/posts?`+o.toString(),{credentials:"include",headers:i});if(!u.ok)throw new Error("Failed to load profile posts");return u.json()}async function K8e(e,{cursor:t,limit:n=24}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=await fetch(`${bB}/api/profile/${e}/friends?`+o.toString(),{credentials:"include",headers:i});if(!u.ok)throw new Error("Failed to load profile friends");return u.json()}var Y1="Tabs",[q8e,oxt]=Vs(Y1,[r_]),_he=r_(),[Y8e,EB]=q8e(Y1),bhe=S.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:o,defaultValue:u,orientation:h="horizontal",dir:p,activationMode:g="automatic",...v}=e,b=n_(p),[E,T]=$d({prop:i,onChange:o,defaultProp:u??"",caller:Y1});return c.jsx(Y8e,{scope:n,baseId:Vl(),value:E,onValueChange:T,orientation:h,dir:b,activationMode:g,children:c.jsx(en.div,{dir:b,"data-orientation":h,...v,ref:t})})});bhe.displayName=Y1;var Ehe="TabsList",whe=S.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...o}=e,u=EB(Ehe,n),h=_he(n);return c.jsx(z4,{asChild:!0,...h,orientation:u.orientation,dir:u.dir,loop:i,children:c.jsx(en.div,{role:"tablist","aria-orientation":u.orientation,...o,ref:t})})});whe.displayName=Ehe;var She="TabsTrigger",xhe=S.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:o=!1,...u}=e,h=EB(She,n),p=_he(n),g=Rhe(h.baseId,i),v=Nhe(h.baseId,i),b=i===h.value;return c.jsx(K4,{asChild:!0,...p,focusable:!o,active:b,children:c.jsx(en.button,{type:"button",role:"tab","aria-selected":b,"aria-controls":v,"data-state":b?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:g,...u,ref:t,onMouseDown:Tt(e.onMouseDown,E=>{!o&&E.button===0&&E.ctrlKey===!1?h.onValueChange(i):E.preventDefault()}),onKeyDown:Tt(e.onKeyDown,E=>{[" ","Enter"].includes(E.key)&&h.onValueChange(i)}),onFocus:Tt(e.onFocus,()=>{const E=h.activationMode!=="manual";!b&&!o&&E&&h.onValueChange(i)})})})});xhe.displayName=She;var The="TabsContent",Che=S.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:o,children:u,...h}=e,p=EB(The,n),g=Rhe(p.baseId,i),v=Nhe(p.baseId,i),b=i===p.value,E=S.useRef(b);return S.useEffect(()=>{const T=requestAnimationFrame(()=>E.current=!1);return()=>cancelAnimationFrame(T)},[]),c.jsx(is,{present:o||b,children:({present:T})=>c.jsx(en.div,{"data-state":b?"active":"inactive","data-orientation":p.orientation,role:"tabpanel","aria-labelledby":g,hidden:!T,id:v,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:E.current?"0s":void 0},children:T&&u})})});Che.displayName=The;function Rhe(e,t){return`${e}-trigger-${t}`}function Nhe(e,t){return`${e}-content-${t}`}var X8e=bhe,Ahe=whe,Ihe=xhe,Ohe=Che;const Am=X8e,jf=S.forwardRef(({className:e,...t},n)=>c.jsx(Ahe,{ref:n,className:kt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));jf.displayName=Ahe.displayName;const Ia=S.forwardRef(({className:e,...t},n)=>c.jsx(Ihe,{ref:n,className:kt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Ia.displayName=Ihe.displayName;const fi=S.forwardRef(({className:e,...t},n)=>c.jsx(Ohe,{ref:n,className:kt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));fi.displayName=Ohe.displayName;const VQ="https://api.gada.chat";function J8e({open:e,onOpenChange:t,onSaved:n}){const{accessToken:i}=st(),o=wt(i),[u,h]=S.useState(!1),[p,g]=S.useState(null),[v,b]=S.useState("basic"),[E,T]=S.useState({firstName:"",lastName:"",gender:"",birthdate:"",bio:"",website:"",workTitle:"",workPlace:"",currentCity:"",hometown:"",socialFacebook:"",socialTwitter:"",socialInstagram:"",socialYoutube:"",socialLinkedin:"",privacyChat:"public",privacyWall:"friends",privacyPhotos:"public"}),C=S.useRef(!1);S.useEffect(()=>{!e||C.current||(C.current=!0,(async()=>{try{g(null);const O=await fetch(`${VQ}/api/profile/me`,{headers:o});if(!O.ok)throw new Error("Failed to load");const k=await O.json();T({firstName:k.firstName??"",lastName:k.lastName??"",gender:k.gender??"",birthdate:k.birthdate??"",bio:k.bio??"",website:k.website??"",workTitle:k.workTitle??"",workPlace:k.workPlace??"",currentCity:k.currentCity??"",hometown:k.hometown??"",socialFacebook:k.socialFacebook??"",socialTwitter:k.socialTwitter??"",socialInstagram:k.socialInstagram??"",socialYoutube:k.socialYoutube??"",socialLinkedin:k.socialLinkedin??"",privacyChat:k.privacyChat??"public",privacyWall:k.privacyWall??"friends",privacyPhotos:k.privacyPhotos??"public"})}catch(O){g((O==null?void 0:O.message)||"Failed to load profile")}})())},[e,o]);const R=O=>k=>{const j=k!=null&&k.target?k.target.value:k;T(P=>({...P,[O]:j}))};async function N(){try{h(!0),g(null);const O=await fetch(`${VQ}/api/profile`,{method:"PUT",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(E)});if(!O.ok){const k=await O.json().catch(()=>({}));throw new Error((k==null?void 0:k.error)||"Update failed")}Ce.success("Profile data has been updated successfully"),n==null||n(),t(!1)}catch(O){g((O==null?void 0:O.message)||"Update failed")}finally{h(!1)}}return c.jsx(Yo,{open:e,onOpenChange:O=>{u||t(O)},children:c.jsxs(vo,{className:"sm:max-w-[720px]",children:[c.jsx(Xo,{children:c.jsx(Jo,{children:"Edit profile"})}),p&&c.jsx("div",{className:"text-red-600 text-sm mb-2",children:p}),c.jsxs(Am,{value:v,onValueChange:b,children:[c.jsxs(jf,{className:"grid grid-cols-4 w-full",children:[c.jsx(Ia,{value:"basic",children:"Basic"}),c.jsx(Ia,{value:"about",children:"About"}),c.jsx(Ia,{value:"social",children:"Social"}),c.jsx(Ia,{value:"privacy",children:"Privacy"})]}),c.jsxs(fi,{value:"basic",className:"mt-4 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(ms,{label:"First name",children:c.jsx(Ne,{value:E.firstName,onChange:R("firstName")})}),c.jsx(ms,{label:"Last name",children:c.jsx(Ne,{value:E.lastName,onChange:R("lastName")})}),c.jsx(ms,{label:"Gender",children:c.jsx(Ne,{value:E.gender,onChange:R("gender"),placeholder:"male/female/other"})}),c.jsx(ms,{label:"Birthdate",children:c.jsx(Ne,{type:"date",value:E.birthdate||"",onChange:R("birthdate")})})]}),c.jsx(ms,{label:"Bio",children:c.jsx(wi,{value:E.bio,onChange:R("bio"),rows:4})}),c.jsx(ms,{label:"Website",children:c.jsx(Ne,{value:E.website,onChange:R("website"),placeholder:"https://…"})})]}),c.jsx(fi,{value:"about",className:"mt-4 space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(ms,{label:"Work title",children:c.jsx(Ne,{value:E.workTitle,onChange:R("workTitle")})}),c.jsx(ms,{label:"Work place",children:c.jsx(Ne,{value:E.workPlace,onChange:R("workPlace")})}),c.jsx(ms,{label:"Current city",children:c.jsx(Ne,{value:E.currentCity,onChange:R("currentCity")})}),c.jsx(ms,{label:"Hometown",children:c.jsx(Ne,{value:E.hometown,onChange:R("hometown")})})]})}),c.jsx(fi,{value:"social",className:"mt-4 space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(ms,{label:"Facebook",children:c.jsx(Ne,{value:E.socialFacebook,onChange:R("socialFacebook")})}),c.jsx(ms,{label:"Twitter / X",children:c.jsx(Ne,{value:E.socialTwitter,onChange:R("socialTwitter")})}),c.jsx(ms,{label:"Instagram",children:c.jsx(Ne,{value:E.socialInstagram,onChange:R("socialInstagram")})}),c.jsx(ms,{label:"YouTube",children:c.jsx(Ne,{value:E.socialYoutube,onChange:R("socialYoutube")})}),c.jsx(ms,{label:"LinkedIn",children:c.jsx(Ne,{value:E.socialLinkedin,onChange:R("socialLinkedin")})})]})}),c.jsx(fi,{value:"privacy",className:"mt-4 space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsx(dL,{label:"Who can chat with me?",value:E.privacyChat,onChange:R("privacyChat")}),c.jsx(dL,{label:"Who can post on my wall?",value:E.privacyWall,onChange:R("privacyWall")}),c.jsx(dL,{label:"Who can see my photos?",value:E.privacyPhotos,onChange:R("privacyPhotos")})]})})]}),c.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>t(!1),disabled:u,children:"Cancel"}),c.jsx(be,{onClick:N,disabled:u,children:u?"Saving…":"Save changes"})]})]})})}function ms({label:e,children:t}){return c.jsxs("div",{className:"space-y-1.5",children:[c.jsx(Je,{className:"text-sm",children:e}),t]})}function dL({label:e,value:t,onChange:n}){return c.jsx(ms,{label:e,children:c.jsxs("select",{value:t,onChange:n,className:"h-9 px-3 rounded-md border border-gray-300 bg-white",children:[c.jsx("option",{value:"me",children:"Only me"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"public",children:"Public"})]})})}function BQ({isOpen:e,onClose:t,onSave:n,title:i,type:o,description:u,onUploadingChange:h}){const[p,g]=S.useState(null),[v,b]=S.useState(null),[E,T]=S.useState(null),[C,R]=S.useState(!1),N=S.useRef(null),{id:O}=tc(),{accessToken:k}=st(),j=Hl(k),P=tr(),M=U=>{var z;const V=((z=U.target.files)==null?void 0:z[0])||null;if(g(null),!V){T(null),b(null);return}if(V.size>5*1024*1024){g("File is too large. Maximum size is 5MB.");return}if(!V.type.startsWith("image/")){g("Only image files are allowed.");return}T(V),b(URL.createObjectURL(V))},D=async()=>{if(!(!E||!O)){R(!0),h==null||h(!0),g(null);try{const U=await fVe(O,E,j,o);n(U),b(U),t(),P("/profile/"+O)}catch(U){console.error("Avatar upload failed",U),g((U==null?void 0:U.message)||"Upload failed")}finally{R(!1),h==null||h(!1),N.current&&(N.current.value="")}}};return c.jsx(Yo,{open:e,onOpenChange:U=>!U&&t(),children:c.jsxs(vo,{className:"sm:max-w-[425px]",children:[c.jsxs(Xo,{children:[c.jsx(Jo,{children:i}),c.jsx(t_,{children:u})]}),c.jsxs("div",{className:"grid gap-4 py-4",children:[p&&c.jsxs(xf,{variant:"destructive",children:[c.jsx(x1,{className:"h-4 w-4"}),c.jsx(my,{children:p})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Je,{htmlFor:"image-upload",children:"Upload an image"}),c.jsx(Ne,{id:"image-upload",type:"file",accept:"image/*",ref:N,onChange:M})]}),v&&c.jsxs("div",{className:"mt-2",children:[c.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Preview:"}),c.jsx("div",{className:"relative w-full max-w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:c.jsx("img",{src:v,alt:"Preview",className:"object-cover w-full h-full"})})]})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(be,{variant:"outline",onClick:t,disabled:C,children:"Cancel"}),c.jsx(be,{onClick:D,disabled:!E||C,children:C?c.jsxs(c.Fragment,{children:[c.jsx(si,{className:"h-4 w-4 animate-spin mr-2"})," Uploading…"]}):"Save"})]})]})})}const VC="https://api.gada.chat";function Z8e(){const{id:e}=tc(),t=tr(),{user:n,isLoading:i,accessToken:o,updateProfile:u}=st(),h=wt(o),[p,g]=S.useState(!1),{openChatWith:v}=a_(),[b,E]=S.useState(!1),[T,C]=S.useState(!1),R=S.useMemo(()=>{if(!e)return null;try{return Number(I5e(e))}catch{return Number(e)}},[e]),[N,O]=S.useState("posts"),[k,j]=S.useState(null),[P,M]=S.useState(!0),[D,U]=S.useState(null),[V,z]=S.useState(null),[W,Y]=S.useState(null),[Q,K]=S.useState(!1),[q,ee]=S.useState(!1),[oe,ae]=S.useState([]),[J,re]=S.useState(null),[X,de]=S.useState(!1),[we,ge]=S.useState(!1),Te=S.useRef(h);S.useEffect(()=>{Te.current=h},[h]),S.useEffect(()=>{!i&&!n&&t("/login")},[i,n,t]);const Pe=S.useRef({userId:null,done:!1});S.useEffect(()=>{if(!R||!o||(Pe.current.userId!==R&&(Pe.current={userId:R,done:!1}),Pe.current.done))return;Pe.current.done=!0,M(!0),U(null);let St=!1;return H8e(R,Te.current).then(At=>{St||j(At)}).catch(At=>{St||U((At==null?void 0:At.message)||"Failed to load")}).finally(()=>{St||M(!1)}),()=>{St=!0}},[R,o]);const rt=S.useRef(!1),dt=S.useRef(""),ze=async(St=!1)=>{if(!(!R||!o)&&!rt.current&&!(!St&&q)){rt.current=!0,K(!0);try{const{items:At=[],nextCursor:it}=await z8e(R,{cursor:St?null:W,limit:10},Te.current);z(ve=>St?At:[...ve||[],...At]),Y(it??null),(!it||At.length===0)&&ee(!0)}catch(At){console.error("[profile posts]",At)}finally{rt.current=!1,K(!1)}}};S.useEffect(()=>{if(!R||N!=="posts"||!o)return;const St=`posts|${R}`;dt.current!==St&&(dt.current=St,z(null),Y(null),ee(!1),Promise.resolve().then(()=>ze(!0)))},[R,N,o]);const vt=S.useRef(!1),Be=S.useRef(""),ot=async(St=!1)=>{if(!(!R||!o)&&!vt.current&&!(!St&&we)){vt.current=!0,de(!0);try{const{items:At=[],nextCursor:it}=await K8e(R,{cursor:St?void 0:J??void 0,limit:24},Te.current);ae(ve=>St?At:[...ve,...At]),re(it??null),(!it||At.length===0)&&ge(!0)}catch(At){console.error("[profile friends]",At)}finally{vt.current=!1,de(!1)}}};if(S.useEffect(()=>{if(!R||N!=="friends"||!o)return;const St=`friends|${R}`;Be.current!==St&&(Be.current=St,ae([]),re(null),ge(!1),Promise.resolve().then(()=>ot(!0)))},[R,N,o]),i||P)return c.jsxs("div",{className:"min-h-screen bg-white",children:[c.jsx(or,{}),c.jsx("div",{className:"flex items-center justify-center py-24",children:c.jsx(si,{className:"h-8 w-8 animate-spin text-[#1877F2]"})})]});if(D||!k)return c.jsxs("div",{className:"min-h-screen bg-white",children:[c.jsx(or,{}),c.jsx("div",{className:"max-w-4xl mx-auto p-6 text-center text-red-600",children:D||"Profile not found"})]});const De=k.user.fullName||k.user.username,je=k.user.avatar?VC+"/uploads/"+Kn(k.user.avatar):"",Mt=k.user.cover?VC+"/uploads/"+Kn(k.user.cover):"",Ut=k.relationship==="me",fn=St=>{u==null||u({profileImage:St}),j(At=>At&&{...At,user:{...At.user,avatar:St}}),E(!1)},ht=St=>{u==null||u({coverImage:St}),j(At=>At&&{...At,user:{...At.user,cover:St}}),C(!1)};return c.jsxs("div",{className:"min-h-screen bg-gray-100",children:[c.jsx(or,{}),c.jsxs("div",{className:"bg-white shadow",children:[c.jsxs("div",{className:"relative max-w-5xl mx-auto",children:[c.jsxs("div",{className:"h-56 sm:h-64 w-full bg-gray-200 overflow-hidden rounded-b-lg relative",children:[Mt?c.jsx("img",{src:Mt,alt:"",className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full bg-gradient-to-r from-slate-200 to-slate-300"}),Ut&&c.jsx(be,{size:"icon",variant:"secondary",className:"absolute bottom-3 right-3 bg-white/80 backdrop-blur-sm hover:bg-white",onClick:()=>C(!0),"aria-label":"Change cover photo",children:c.jsx(xN,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"px-4 sm:px-6",children:[c.jsxs("div",{className:"flex items-end gap-4 -mt-10 sm:-mt-12",children:[c.jsxs("div",{className:"relative h-24 w-24 sm:h-32 sm:w-32 rounded-full ring-4 ring-white overflow-hidden bg-gray-200",children:[je?c.jsx("img",{src:je,alt:De,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl text-gray-500",children:(De==null?void 0:De[0])??"U"}),Ut&&c.jsx(be,{size:"icon",variant:"secondary",className:"absolute bottom-1 right-1 bg-white/85 hover:bg-white h-8 w-8 rounded-full shadow",onClick:()=>E(!0),"aria-label":"Change profile picture",children:c.jsx(xN,{className:"h-4 w-4"})})]}),c.jsxs("div",{className:"pb-2",children:[c.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:De}),c.jsxs("div",{className:"text-gray-600 text-sm",children:[k.counts.friends," friends · ",k.counts.posts," posts"]})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 pb-4",children:[k.relationship!=="me"&&c.jsxs(c.Fragment,{children:[c.jsxs(be,{variant:"secondary",onClick:()=>v(Number(k.user.id),{id:Number(k.user.id),username:k.user.username,fullName:k.user.fullName,avatar:k.user.avatar||null}),"aria-label":`Message ${k.user.fullName||k.user.username}`,children:[c.jsx(RN,{className:"h-4 w-4 mr-2"}),"Message"]}),c.jsx(be,{className:"bg-[#1877F2] hover:bg-[#166FE5]",children:k.relationship==="friends"?"Friends":k.relationship==="requested"?"Requested":"Add Friend"})]}),Ut&&c.jsx(be,{variant:"outline",onClick:()=>g(!0),children:"Edit Profile"}),c.jsx(J8e,{open:p,onOpenChange:g,onSaved:()=>window.location.reload()})]})]})]}),c.jsx("div",{className:"border-t",children:c.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6",children:c.jsxs("div",{className:"flex gap-6",children:[c.jsx(hL,{active:N==="posts",onClick:()=>O("posts"),children:"Posts"}),c.jsx(hL,{active:N==="friends",onClick:()=>O("friends"),children:"Friends"}),c.jsx(hL,{active:N==="photos",onClick:()=>O("photos"),children:"Photos"})]})})})]}),c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h2",{className:"text-lg font-semibold mb-2",children:"About"}),k.user.bio?c.jsx("p",{className:"text-gray-700",children:k.user.bio}):c.jsx("p",{className:"text-gray-500 italic",children:"No bio yet"})]}),N==="posts"&&c.jsxs("div",{className:"space-y-4",children:[V===null&&Q&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"Loading…"}),Array.isArray(V)&&V.length>0&&c.jsxs(c.Fragment,{children:[V.map(St=>c.jsx(Vu,{post:St},St.id)),!q&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>ze(!1),disabled:Q,children:Q?"Loading…":"Load more"})})]}),V!==null&&V.length===0&&q&&!Q&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts yet"})]}),N==="friends"&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:oe.map(St=>{var At;return c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("div",{className:"h-20 w-20 rounded-md overflow-hidden bg-gray-200",children:St.avatar?c.jsx("img",{src:VC+"/uploads/"+Kn(St.avatar),alt:St.fullName,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-lg text-gray-500",children:((At=St.fullName)==null?void 0:At[0])??"U"})}),c.jsx("div",{className:"mt-2 text-sm font-medium text-center leading-tight",children:St.fullName})]},St.id)})}),!we&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>ot(!1),disabled:X,children:X?"Loading…":"Load more"})}),oe.length===0&&we&&c.jsx("div",{className:"text-center text-gray-500 py-6",children:"No friends to show"})]}),N==="photos"&&c.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:c.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:[k.previews.photos.map((St,At)=>c.jsx("div",{className:"aspect-square overflow-hidden rounded",children:c.jsx("img",{src:VC+"/uploads/"+Kn(St),className:"w-full h-full object-cover"})},At)),k.previews.photos.length===0&&c.jsx("div",{className:"text-gray-500 text-center py-6 col-span-full",children:"No photos yet"})]})})]}),c.jsx(BQ,{isOpen:b,onClose:()=>E(!1),onSave:fn,title:"Change Profile Picture",type:"profile",description:"Upload a new profile picture or enter an image URL"}),c.jsx(BQ,{isOpen:T,onClose:()=>C(!1),onSave:ht,title:"Change Cover Photo",type:"cover",description:"Upload a new cover photo or enter an image URL"})]})}function hL({active:e,onClick:t,children:n}){return c.jsx("button",{onClick:t,className:`py-3 px-1 border-b-2 -mb-px text-sm sm:text-base ${e?"border-[#1877F2] text-[#1877F2] font-medium":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:n})}const Q8e="https://api.gada.chat";function eWe(){const{accessToken:e,user:t,isLoading:n}=st(),i=wt(e),o=tr(),{token:u}=tc(),[h,p]=S.useState(""),[g,v]=S.useState("");return S.useEffect(()=>{if(!u){o("/login");return}if(e){o("/");return}async function b(){try{if(await dVe({token:u},i)){v("Your account has been activated successfully, You can login now");const T=window.setTimeout(()=>{v(""),o("/login")},5e3);return!1}}catch(E){console.log(E),p(""+E)}}b()},[u,o]),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(Nt,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${Q8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Connect with friends and the world around you"})]}),c.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[h&&c.jsx(xf,{variant:"destructive",className:"mb-4",children:h}),g&&c.jsx(xf,{variant:"default",className:"mb-4",children:g}),c.jsx(yhe,{})]})]})}const Phe=S.createContext(null);function tWe({children:e}){const{accessToken:t,user:n}=st(),i=wt(t),[o,u]=S.useState([]),[h,p]=S.useState([]),[g,v]=S.useState([]);S.useEffect(()=>{t&&(LQ(i).then(u).catch(console.error),a8e(i).then(p).catch(console.error),VR(i).then(v).catch(console.error))},[t]);const b=async T=>{const C=await ghe(T,i);Ce.success("Request sent successfully "),VR(i).then(v).catch(console.error),p(R=>[C,...R]),v(R=>R.filter(N=>N.id!==T))},E=async(T,C)=>{if(await s8e(T,C,i),p(R=>R.map(N=>N.id===T?{...N,status:C}:N)),Ce.success("Request "+C+" successfully "),C==="accepted"){const R=await LQ(i);u(R)}VR(i).then(v).catch(console.error)};return c.jsx(Phe.Provider,{value:{friends:o,requests:h,suggestions:g,sendRequest:b,respondRequest:E},children:e})}function X1(){const e=S.useContext(Phe);if(!e)throw new Error("useFriends must be in FriendProvider");return e}const nWe="https://api.gada.chat";function rWe(){const{friends:e}=X1();return e.length===0?c.jsx("p",{className:"p-4 text-gray-500",children:"You have no friends yet."}):c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 p-4",children:e.map(t=>c.jsxs(Nt,{to:`/profile/${t.id}`,className:"flex flex-col items-center hover:bg-gray-100 p-2 rounded",children:[c.jsx($i,{className:"h-16 w-16",children:t.profileImage?c.jsx(Oi,{src:nWe+"/uploads/"+t.profileImage}):c.jsx(Qi,{children:t.user_name[0].toUpperCase()})}),c.jsx("span",{className:"mt-2 text-sm text-gray-800",children:t.user_name})]},t.id))})}const $Q="https://api.gada.chat";function iWe(){const{user:e}=st(),{requests:t,respondRequest:n}=X1(),i=t.filter(o=>o.toUserId===e.id&&o.status===0);return i.length===0?c.jsx("p",{className:"p-4 text-gray-500",children:"No new friend requests."}):c.jsx("div",{className:"p-4 space-y-4",children:i.map(o=>c.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded shadow",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("img",{src:o.fromProfileImage?$Q+"/uploads/"+o.fromProfileImage:$Q+"/uploads//profile/defaultavatar.png",alt:o.fromUsername,className:"h-10 w-10 rounded-full object-cover"}),c.jsx("span",{children:o.fromUsername})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(be,{size:"sm",onClick:()=>n(o.id,"accepted"),children:"Accept"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>n(o.id,"declined"),children:"Decline"})]})]},o.id))})}function aWe(){const[e,t]=S.useState(""),[n,i]=S.useState([]),[o,u]=S.useState(!1),{accessToken:h}=st(),p=wt(h),{sendRequest:g}=X1(),v=async b=>{if(b.preventDefault(),!!e.trim()){u(!0);try{const E=await o8e(e,p);i(E)}catch(E){console.error("Search failed",E)}finally{u(!1)}}};return c.jsxs("div",{className:"p-4 bg-white rounded shadow",children:[c.jsxs("form",{onSubmit:v,className:"flex space-x-2 mb-4",children:[c.jsx(Ne,{value:e,onChange:b=>t(b.target.value),placeholder:"Find friends"}),c.jsx(be,{type:"submit",disabled:o,children:o?"Searching…":"Search"})]}),c.jsxs("div",{className:"space-y-3",children:[n.map(b=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx($i,{className:"h-8 w-8",children:b.profileImage?c.jsx(Oi,{src:b.profileImage}):c.jsx(Qi,{children:b.user_name[0].toUpperCase()})}),c.jsx("span",{children:b.user_name})]}),c.jsx(be,{size:"sm",onClick:()=>g(b.user_id),children:"Add Friend"})]},b.user_id)),n.length===0&&!o&&c.jsx("p",{className:"text-gray-500 text-sm",children:"No users found."})]})]})}const fL="https://api.gada.chat";function sWe(){const{suggestions:e,sendRequest:t}=X1();return console.log(e,"suggestionssuggestions"),e.length===0?null:c.jsx("div",{className:"p-4 bg-white rounded shadow",children:c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:e.map(n=>c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx($i,{className:"h-16 w-16 mx-auto",children:n!=null&&n.profileImage?c.jsx(Oi,{src:n!=null&&n.profileImage?fL+"/uploads/"+n.profileImage:fL+"/uploads//profile/defaultavatar.png"}):c.jsx(Oi,{src:fL+"/uploads//profile/defaultavatar.png"})}),c.jsx("div",{className:"text-sm font-medium",children:n.user_name}),c.jsx(be,{size:"sm",onClick:()=>t(n.user_id),className:"w-full",children:"Add Friend"})]},n.id))})})}function oWe(){const{accessToken:e,isLoading:t}=st(),n=tr();return S.useEffect(()=>{!t&&!e&&n("/login")},[t,e,n]),t?null:c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsxs("div",{className:"sticky top-16",children:["   ",c.jsx(Ss,{})]})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsx("div",{className:"space-y-6 py-6",children:c.jsxs(tWe,{children:[c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"People You May Know"}),c.jsx(sWe,{})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Friend Requests"}),c.jsx(iWe,{})]}),c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Find Friends"}),c.jsx(aWe,{})]})]}),c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Your Friends"}),c.jsx(rWe,{})]})]})})}),c.jsx("aside",{className:"hidden xl:block xl:w-80 py-6",children:c.jsx(q1,{})})]})})]})}function cWe(){const{accessToken:e,isLoading:t}=st(),n=wt(e),[i,o]=S.useState([]),[u,h]=S.useState(!0),p=tr();return S.useEffect(()=>{!t&&!e&&p("/login")},[t,e,p]),S.useEffect(()=>{e&&wVe(n).then(o).catch(console.error).finally(()=>h(!1))},[e]),t||u?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx(si,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsx(Ss,{})}),c.jsx("main",{className:"flex-1 overflow-auto p-6 space-y-6",children:c.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h1",{className:"text-3xl font-bold",children:"Saved Posts"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"All the posts you’ve saved for later"})]}),i.length>0?i.map(g=>c.jsx(Vu,{post:g},g.id)):c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:"No saved posts yet"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"When you save a post, it’ll show up here."})]})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-96 min-h-0 overflow-y-auto pt-6",children:c.jsx(q1,{})})]})})]})}const lWe="https://api.gada.chat";async function uWe(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error((t==null?void 0:t.error)||"Request failed");return t}async function dWe(e){const t=await fetch(`${lWe}/api/memories`,{headers:e,credentials:"include"});return uWe(t)}function hWe(){const{accessToken:e,isLoading:t}=st(),n=wt(e),[i,o]=S.useState([]),[u,h]=S.useState(!0),p=tr();return S.useEffect(()=>{!t&&!e&&p("/login")},[t,e,p]),S.useEffect(()=>{e&&dWe(n).then(o).catch(console.error).finally(()=>h(!1))},[e]),t||u?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(si,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsxs("div",{className:"space-y-6 py-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h1",{className:"text-2xl font-bold",children:"On This Day"}),c.jsx("p",{className:"text-gray-600",children:"Your posts from this date in previous years."})]}),i.length>0?i.map(g=>c.jsx(Vu,{post:g},g.id)):c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:"No memories today"}),c.jsx("p",{className:"text-gray-500",children:"Come back tomorrow!"})]})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-80 py-6",children:c.jsx("div",{className:"sticky space-y-8"})})]})})]})}const fWe=({email:e,amount:t,metadata:n,onSuccess:i,onClose:o})=>{const u=async()=>{try{const{authorization_url:h,reference:p}=await Mde(e,t,n);h&&window.location.assign(h)}catch(h){console.error(h),alert("Could not initialize payment")}};return c.jsxs("button",{onClick:u,className:"bg-green-500 text-white px-4 py-2 rounded",children:["Pay ₦",t.toLocaleString()]})};function pWe(){const{user:e}=st();if(!e)return null;const t=n=>{alert(`Payment successful! Reference: ${n}`)};return c.jsxs("div",{className:"p-6",children:[c.jsx("h1",{className:"text-2xl mb-4",children:"Complete Your Payment"}),c.jsx(fWe,{email:e.email,amount:5e3,metadata:{userId:e.id},onSuccess:t})]})}function Kl(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function um(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const khe=6048e5,mWe=864e5;let gWe={};function J1(){return gWe}function M0(e,t){var p,g,v,b;const n=J1(),i=(t==null?void 0:t.weekStartsOn)??((g=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((b=(v=n.locale)==null?void 0:v.options)==null?void 0:b.weekStartsOn)??0,o=Kl(e),u=o.getDay(),h=(u<i?7:0)+u-i;return o.setDate(o.getDate()-h),o.setHours(0,0,0,0),o}function LN(e){return M0(e,{weekStartsOn:1})}function jhe(e){const t=Kl(e),n=t.getFullYear(),i=um(e,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const o=LN(i),u=um(e,0);u.setFullYear(n,0,4),u.setHours(0,0,0,0);const h=LN(u);return t.getTime()>=o.getTime()?n+1:t.getTime()>=h.getTime()?n:n-1}function WQ(e){const t=Kl(e);return t.setHours(0,0,0,0),t}function GQ(e){const t=Kl(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function vWe(e,t){const n=WQ(e),i=WQ(t),o=+n-GQ(n),u=+i-GQ(i);return Math.round((o-u)/mWe)}function yWe(e){const t=jhe(e),n=um(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),LN(n)}function _We(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function bWe(e){if(!_We(e)&&typeof e!="number")return!1;const t=Kl(e);return!isNaN(Number(t))}function EWe(e){const t=Kl(e),n=um(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}const wWe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},SWe=(e,t,n)=>{let i;const o=wWe[e];return typeof o=="string"?i=o:t===1?i=o.one:i=o.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function pL(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const xWe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},TWe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},CWe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},RWe={date:pL({formats:xWe,defaultWidth:"full"}),time:pL({formats:TWe,defaultWidth:"full"}),dateTime:pL({formats:CWe,defaultWidth:"full"})},NWe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},AWe=(e,t,n,i)=>NWe[e];function fE(e){return(t,n)=>{const i=n!=null&&n.context?String(n.context):"standalone";let o;if(i==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,p=n!=null&&n.width?String(n.width):h;o=e.formattingValues[p]||e.formattingValues[h]}else{const h=e.defaultWidth,p=n!=null&&n.width?String(n.width):e.defaultWidth;o=e.values[p]||e.values[h]}const u=e.argumentCallback?e.argumentCallback(t):t;return o[u]}}const IWe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},OWe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},PWe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kWe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jWe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},DWe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},LWe=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},MWe={ordinalNumber:LWe,era:fE({values:IWe,defaultWidth:"wide"}),quarter:fE({values:OWe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fE({values:PWe,defaultWidth:"wide"}),day:fE({values:kWe,defaultWidth:"wide"}),dayPeriod:fE({values:jWe,defaultWidth:"wide",formattingValues:DWe,defaultFormattingWidth:"wide"})};function pE(e){return(t,n={})=>{const i=n.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],u=t.match(o);if(!u)return null;const h=u[0],p=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],g=Array.isArray(p)?FWe(p,E=>E.test(h)):UWe(p,E=>E.test(h));let v;v=e.valueCallback?e.valueCallback(g):g,v=n.valueCallback?n.valueCallback(v):v;const b=t.slice(h.length);return{value:v,rest:b}}}function UWe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function FWe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function VWe(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const o=i[0],u=t.match(e.parsePattern);if(!u)return null;let h=e.valueCallback?e.valueCallback(u[0]):u[0];h=n.valueCallback?n.valueCallback(h):h;const p=t.slice(o.length);return{value:h,rest:p}}}const BWe=/^(\d+)(th|st|nd|rd)?/i,$We=/\d+/i,WWe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},GWe={any:[/^b/i,/^(a|c)/i]},HWe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},zWe={any:[/1/i,/2/i,/3/i,/4/i]},KWe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},qWe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},YWe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},XWe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},JWe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ZWe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},QWe={ordinalNumber:VWe({matchPattern:BWe,parsePattern:$We,valueCallback:e=>parseInt(e,10)}),era:pE({matchPatterns:WWe,defaultMatchWidth:"wide",parsePatterns:GWe,defaultParseWidth:"any"}),quarter:pE({matchPatterns:HWe,defaultMatchWidth:"wide",parsePatterns:zWe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:pE({matchPatterns:KWe,defaultMatchWidth:"wide",parsePatterns:qWe,defaultParseWidth:"any"}),day:pE({matchPatterns:YWe,defaultMatchWidth:"wide",parsePatterns:XWe,defaultParseWidth:"any"}),dayPeriod:pE({matchPatterns:JWe,defaultMatchWidth:"any",parsePatterns:ZWe,defaultParseWidth:"any"})},eGe={code:"en-US",formatDistance:SWe,formatLong:RWe,formatRelative:AWe,localize:MWe,match:QWe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function tGe(e){const t=Kl(e);return vWe(t,EWe(t))+1}function nGe(e){const t=Kl(e),n=+LN(t)-+yWe(t);return Math.round(n/khe)+1}function Dhe(e,t){var b,E,T,C;const n=Kl(e),i=n.getFullYear(),o=J1(),u=(t==null?void 0:t.firstWeekContainsDate)??((E=(b=t==null?void 0:t.locale)==null?void 0:b.options)==null?void 0:E.firstWeekContainsDate)??o.firstWeekContainsDate??((C=(T=o.locale)==null?void 0:T.options)==null?void 0:C.firstWeekContainsDate)??1,h=um(e,0);h.setFullYear(i+1,0,u),h.setHours(0,0,0,0);const p=M0(h,t),g=um(e,0);g.setFullYear(i,0,u),g.setHours(0,0,0,0);const v=M0(g,t);return n.getTime()>=p.getTime()?i+1:n.getTime()>=v.getTime()?i:i-1}function rGe(e,t){var p,g,v,b;const n=J1(),i=(t==null?void 0:t.firstWeekContainsDate)??((g=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??n.firstWeekContainsDate??((b=(v=n.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,o=Dhe(e,t),u=um(e,0);return u.setFullYear(o,0,i),u.setHours(0,0,0,0),M0(u,t)}function iGe(e,t){const n=Kl(e),i=+M0(n,t)-+rGe(n,t);return Math.round(i/khe)+1}function Fr(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const Mh={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return Fr(t==="yy"?i%100:i,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Fr(n+1,2)},d(e,t){return Fr(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Fr(e.getHours()%12||12,t.length)},H(e,t){return Fr(e.getHours(),t.length)},m(e,t){return Fr(e.getMinutes(),t.length)},s(e,t){return Fr(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),o=Math.trunc(i*Math.pow(10,n-3));return Fr(o,t.length)}},ov={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},HQ={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const i=e.getFullYear(),o=i>0?i:1-i;return n.ordinalNumber(o,{unit:"year"})}return Mh.y(e,t)},Y:function(e,t,n,i){const o=Dhe(e,i),u=o>0?o:1-o;if(t==="YY"){const h=u%100;return Fr(h,2)}return t==="Yo"?n.ordinalNumber(u,{unit:"year"}):Fr(u,t.length)},R:function(e,t){const n=jhe(e);return Fr(n,t.length)},u:function(e,t){const n=e.getFullYear();return Fr(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Fr(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Fr(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return Mh.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Fr(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const o=iGe(e,i);return t==="wo"?n.ordinalNumber(o,{unit:"week"}):Fr(o,t.length)},I:function(e,t,n){const i=nGe(e);return t==="Io"?n.ordinalNumber(i,{unit:"week"}):Fr(i,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Mh.d(e,t)},D:function(e,t,n){const i=tGe(e);return t==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Fr(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const o=e.getDay(),u=(o-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(u);case"ee":return Fr(u,2);case"eo":return n.ordinalNumber(u,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const o=e.getDay(),u=(o-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(u);case"cc":return Fr(u,t.length);case"co":return n.ordinalNumber(u,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),o=i===0?7:i;switch(t){case"i":return String(o);case"ii":return Fr(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const o=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let o;switch(i===12?o=ov.noon:i===0?o=ov.midnight:o=i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let o;switch(i>=17?o=ov.evening:i>=12?o=ov.afternoon:i>=4?o=ov.morning:o=ov.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Mh.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Mh.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return t==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Fr(i,t.length)},k:function(e,t,n){let i=e.getHours();return i===0&&(i=24),t==="ko"?n.ordinalNumber(i,{unit:"hour"}):Fr(i,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Mh.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Mh.s(e,t)},S:function(e,t){return Mh.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return KQ(i);case"XXXX":case"XX":return kp(i);case"XXXXX":case"XXX":default:return kp(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return KQ(i);case"xxxx":case"xx":return kp(i);case"xxxxx":case"xxx":default:return kp(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+zQ(i,":");case"OOOO":default:return"GMT"+kp(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+zQ(i,":");case"zzzz":default:return"GMT"+kp(i,":")}},t:function(e,t,n){const i=Math.trunc(e.getTime()/1e3);return Fr(i,t.length)},T:function(e,t,n){const i=e.getTime();return Fr(i,t.length)}};function zQ(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),o=Math.trunc(i/60),u=i%60;return u===0?n+String(o):n+String(o)+t+Fr(u,2)}function KQ(e,t){return e%60===0?(e>0?"-":"+")+Fr(Math.abs(e)/60,2):kp(e,t)}function kp(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),o=Fr(Math.trunc(i/60),2),u=Fr(i%60,2);return n+o+t+u}const qQ=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Lhe=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},aGe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],o=n[2];if(!o)return qQ(e,t);let u;switch(i){case"P":u=t.dateTime({width:"short"});break;case"PP":u=t.dateTime({width:"medium"});break;case"PPP":u=t.dateTime({width:"long"});break;case"PPPP":default:u=t.dateTime({width:"full"});break}return u.replace("{{date}}",qQ(i,t)).replace("{{time}}",Lhe(o,t))},sGe={p:Lhe,P:aGe},oGe=/^D+$/,cGe=/^Y+$/,lGe=["D","DD","YY","YYYY"];function uGe(e){return oGe.test(e)}function dGe(e){return cGe.test(e)}function hGe(e,t,n){const i=fGe(e,t,n);if(console.warn(i),lGe.includes(e))throw new RangeError(i)}function fGe(e,t,n){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const pGe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,mGe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,gGe=/^'([^]*?)'?$/,vGe=/''/g,yGe=/[a-zA-Z]/;function Id(e,t,n){var b,E,T,C;const i=J1(),o=i.locale??eGe,u=i.firstWeekContainsDate??((E=(b=i.locale)==null?void 0:b.options)==null?void 0:E.firstWeekContainsDate)??1,h=i.weekStartsOn??((C=(T=i.locale)==null?void 0:T.options)==null?void 0:C.weekStartsOn)??0,p=Kl(e);if(!bWe(p))throw new RangeError("Invalid time value");let g=t.match(mGe).map(R=>{const N=R[0];if(N==="p"||N==="P"){const O=sGe[N];return O(R,o.formatLong)}return R}).join("").match(pGe).map(R=>{if(R==="''")return{isToken:!1,value:"'"};const N=R[0];if(N==="'")return{isToken:!1,value:_Ge(R)};if(HQ[N])return{isToken:!0,value:R};if(N.match(yGe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:R}});o.localize.preprocessor&&(g=o.localize.preprocessor(p,g));const v={firstWeekContainsDate:u,weekStartsOn:h,locale:o};return g.map(R=>{if(!R.isToken)return R.value;const N=R.value;(dGe(N)||uGe(N))&&hGe(N,t,String(e));const O=HQ[N[0]];return O(p,N,o.localize,v)}).join("")}function _Ge(e){const t=e.match(gGe);return t?t[1].replace(vGe,"'"):e}const ya=S.forwardRef(({className:e,...t},n)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:n,className:kt("w-full caption-bottom text-sm",e),...t})}));ya.displayName="Table";const _a=S.forwardRef(({className:e,...t},n)=>c.jsx("thead",{ref:n,className:kt("[&_tr]:border-b",e),...t}));_a.displayName="TableHeader";const ba=S.forwardRef(({className:e,...t},n)=>c.jsx("tbody",{ref:n,className:kt("[&_tr:last-child]:border-0",e),...t}));ba.displayName="TableBody";const bGe=S.forwardRef(({className:e,...t},n)=>c.jsx("tfoot",{ref:n,className:kt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));bGe.displayName="TableFooter";const nn=S.forwardRef(({className:e,...t},n)=>c.jsx("tr",{ref:n,className:kt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));nn.displayName="TableRow";const et=S.forwardRef(({className:e,...t},n)=>c.jsx("th",{ref:n,className:kt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));et.displayName="TableHead";const He=S.forwardRef(({className:e,...t},n)=>c.jsx("td",{ref:n,className:kt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));He.displayName="TableCell";const EGe=S.forwardRef(({className:e,...t},n)=>c.jsx("caption",{ref:n,className:kt("mt-4 text-sm text-muted-foreground",e),...t}));EGe.displayName="TableCaption";const Mhe="https://api.gada.chat";async function wGe(e,t){const n=await fetch(`${Mhe}/api/wallet/withdrawals`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function YQ(e){const t=await fetch(`${Mhe}/api/wallet/withdrawals`,{headers:e});if(!t.ok)throw new Error(await t.text());return await t.json()}function SGe({headers:e,balance:t,refreshBalance:n}){const[i,o]=S.useState(""),[u,h]=S.useState("bank"),[p,g]=S.useState(""),[v,b]=S.useState(!1),[E,T]=S.useState([]),[C,R]=S.useState(!0),[N,O]=S.useState(1),[k]=S.useState(10),[j,P]=S.useState(!1),[M,D]=S.useState(""),[U,V]=S.useState(""),[z,W]=S.useState("all"),[Y,Q]=S.useState("all"),[K,q]=S.useState(""),ee=S.useRef(null);S.useEffect(()=>{ee.current&&window.clearTimeout(ee.current),ee.current=window.setTimeout(()=>{oe()},300)},[M,U,z,Y,K]),S.useEffect(()=>{oe()},[e]);const oe=async()=>{R(!0);try{const ge=await YQ(e,{page:1,pageSize:k,startDate:M||void 0,endDate:U||void 0,status:z,method:Y,q:K||void 0});console.log(ge,"resprespresp"),T(ge.data),O(ge.page),P(ge.hasMore)}catch(ge){console.error(ge),Ce.error("Failed to load history")}finally{R(!1)}},ae=async()=>{if(j)try{const ge=await YQ(e,{page:N+1,pageSize:k,startDate:M||void 0,endDate:U||void 0,status:z,method:Y,q:K||void 0});T(Te=>[...Te,...ge.data]),O(ge.page),P(ge.hasMore)}catch(ge){console.error(ge),Ce.error("Failed to load more")}},J=()=>{D(""),V(""),W("all"),Q("all"),q("")},re=1e3,X=S.useMemo(()=>{const ge=Number(i||0);return!ge||ge<re||!p.trim()||v},[i,p,v]),de=async ge=>{ge.preventDefault();const Te=Number(i||0);if(!Te||Te<=0)return Ce.error("Enter a valid amount");if(Te<re)return Ce.error(`Minimum withdrawal is ₦${re}`);if(!p.trim())return Ce.error("Please fill ‘Transfer To’");try{b(!0),await wGe(e,{amount:Te,method:u,transferTo:p.trim()}),Ce.success("Withdrawal request submitted"),o(""),g(""),await(n==null?void 0:n()),await oe()}catch(Pe){console.error(Pe),Ce.error("Failed to submit request")}finally{b(!1)}},we=ge=>`₦${(isNaN(ge)?0:ge).toLocaleString(void 0,{maximumFractionDigits:2})}`;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex items-center gap-4",children:[c.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:c.jsx(I0,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Your Balance"}),c.jsx("p",{className:"text-2xl font-semibold",children:we(t||0)})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Withdrawal Method"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors ${u==="bank"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"withdrawMethod",className:"hidden",value:"bank",checked:u==="bank",onChange:()=>h("bank")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-emerald-100 flex items-center justify-center",children:c.jsx(CN,{className:"h-5 w-5 text-emerald-600"})}),c.jsx("span",{className:"font-medium",children:"Bank Transfer"})]}),c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors ${u==="gada_token"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"withdrawMethod",className:"hidden",value:"gada_token",checked:u==="gada_token",onChange:()=>h("gada_token")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-yellow-100 flex items-center justify-center",children:c.jsx(qce,{className:"h-5 w-5 text-yellow-700"})}),c.jsx("span",{className:"font-medium",children:"gada token"})]})]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Amount (₦)"}),c.jsx(Ne,{type:"number",min:1,inputMode:"numeric",value:i,onChange:ge=>o(ge.target.value===""?"":Number(ge.target.value)),placeholder:"Enter amount",className:"h-11"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["The minimum withdrawal request amount is ",`₦${re.toLocaleString()}`]})]})})]}),c.jsx("form",{onSubmit:de,className:"bg-white rounded-lg shadow p-6 space-y-3",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:items-end",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Transfer To"}),c.jsx(Ne,{value:p,onChange:ge=>g(ge.target.value),placeholder:u==="bank"?"e.g., 2027267123, Kuda Bank, Account Name":"e.g., 0xYourTokenAddress",className:"h-11"})]}),c.jsx("div",{className:"flex md:justify-end",children:c.jsx(be,{type:"submit",className:"h-11 w-full md:w-auto",disabled:X,children:v?"Submitting...":"Make a withdrawal"})})]})}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 md:items-end",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),c.jsx(Ne,{type:"date",value:M,onChange:ge=>D(ge.target.value),max:Id(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"End Date"}),c.jsx(Ne,{type:"date",value:U,onChange:ge=>V(ge.target.value),max:Id(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Method"}),c.jsxs("select",{className:"h-11 w-full border rounded-md px-3",value:Y,onChange:ge=>Q(ge.target.value),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"bank",children:"Bank"}),c.jsx("option",{value:"gada_token",children:"gada token"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Status"}),c.jsxs("select",{className:"h-11 w-full border rounded-md px-3",value:z,onChange:ge=>W(ge.target.value),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"0",children:"Pending"}),c.jsx("option",{value:"1",children:"Approved"}),c.jsx("option",{value:"-1",children:"Declined"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Search (Transfer To)"}),c.jsx(Ne,{value:K,onChange:ge=>q(ge.target.value),placeholder:"e.g., bank name / address",className:"h-11"})]})]}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(be,{variant:"secondary",className:"h-11",onClick:J,children:"Clear"})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Withdrawal History"}),C?c.jsx("div",{className:"flex justify-center py-10",children:c.jsxs("svg",{className:"animate-spin h-6 w-6 text-gray-500",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}):c.jsxs(c.Fragment,{children:[E&&c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"ID"}),c.jsx(et,{children:"Amount"}),c.jsx(et,{children:"Method"}),c.jsx(et,{children:"Transfer To"}),c.jsx(et,{children:"Time"}),c.jsx(et,{children:"Status"})]})}),c.jsxs(ba,{children:[E.map(ge=>c.jsxs(nn,{children:[c.jsx(He,{children:ge.id}),c.jsx(He,{children:we(Number(ge.amount))}),c.jsx(He,{className:"capitalize",children:ge.method}),c.jsx(He,{className:"truncate max-w-[260px]",title:ge.transferTo,children:ge.transferTo}),c.jsx(He,{children:new Date(ge.time).toLocaleString()}),c.jsxs(He,{children:[ge.status===1&&c.jsx("span",{className:"px-2 py-1 text-xs rounded bg-emerald-100 text-emerald-700",children:"Approved"}),ge.status===0&&c.jsx("span",{className:"px-2 py-1 text-xs rounded bg-amber-100 text-amber-700",children:"Pending"}),ge.status===-1&&c.jsx("span",{className:"px-2 py-1 text-xs rounded bg-rose-100 text-rose-700",children:"Declined"})]})]},ge.id)),E.length===0&&c.jsx(nn,{children:c.jsx(He,{colSpan:6,className:"text-center text-gray-500 py-10",children:"No withdrawal requests found."})})]})]}),j&&c.jsx("div",{className:"flex justify-center mt-6",children:c.jsx(be,{onClick:ae,className:"h-11 px-6",children:"Load more"})})]})]})]})}const xGe="https://api.gada.chat";function TGe(){const{user:e,accessToken:t}=st(),n=wt(t),i=Hl(t),[o,u]=S.useState([]),[h,p]=S.useState(!0),g=20,[v,b]=S.useState(1),[E,T]=S.useState(!1),[C,R]=S.useState(!1),[N,O]=S.useState({user_wallet_balance:0,user_points:0}),[k,j]=S.useState(""),[P,M]=S.useState(""),[D,U]=S.useState(""),[V,z]=S.useState([]),[W,Y]=S.useState(!1),[Q,K]=S.useState("paystack"),[q,ee]=S.useState(!1),[oe,ae]=S.useState(!1),[J,re]=S.useState("wallet"),[X,de]=S.useState(null),[we,ge]=S.useState(!1),Te=Number((V==null?void 0:V.payment_vat_percentage)||2),Pe=Number((V==null?void 0:V.payment_fees_percentage)||6),rt=Number(D||0),dt=S.useMemo(()=>+(rt*(Te/100)).toFixed(2),[rt]),ze=S.useMemo(()=>+(rt*(Pe/100)).toFixed(2),[rt]),vt=S.useMemo(()=>+(rt+dt+ze).toFixed(2),[rt,dt,ze]),Be=async()=>{if(t){p(!0);try{const ht=await RQ(n,{page:1,pageSize:g,startDate:k||void 0,endDate:P||void 0});u(ht.data),b(ht.page),T(ht.hasMore)}catch(ht){console.error(ht),Ce.error("Failed to load transactions")}finally{p(!1)}}},ot=async()=>{if(!(!E||C)){R(!0);try{const ht=await RQ(n,{page:v+1,pageSize:g,startDate:k||void 0,endDate:P||void 0});u(St=>[...St,...ht.data]),b(ht.page),T(ht.hasMore)}catch(ht){console.error(ht),Ce.error("Failed to load more")}finally{R(!1)}}};S.useEffect(()=>{t&&(Be(),jR(n).then(O).catch(console.error),y$e(n).then(z).catch(console.error))},[t]),S.useEffect(()=>{Be()},[k,P]);const De=ht=>`₦${(isNaN(ht)?0:ht).toLocaleString(void 0,{maximumFractionDigits:2})}`,je=ht=>{ht.preventDefault();const St=Number(D);!St||St<=0||ee(!0)},Mt=async()=>{const ht=vt;if(Q==="bank"){ee(!1),ae(!0);return}if(e!=null&&e.email){Y(!0);try{const{authorization_url:St,reference:At}=await Mde(e.email,ht,{userId:e.id,method:"paystack",baseAmount:rt});console.log(St,At,"fjskdfjlskdjflsdkf"),window.location.href=St}catch(St){console.error(St),alert("Could not initiate Paystack payment")}finally{Y(!1),ee(!1)}}},Ut=async()=>{if(!(!e||!X)){ge(!0);try{const ht=new FormData;ht.append("userId",String(e.id)),ht.append("amount",String(vt)),ht.append("baseAmount",String(rt)),ht.append("vat",String(dt)),ht.append("fees",String(ze)),ht.append("method","bank"),ht.append("receipt",X),await fetch(xGe+"/api/payments/bank-transfer/receipt",{method:"POST",headers:{...i},body:ht}),Ce.success("Receipt submitted. We’ll verify within 48 hours."),de(null),ae(!1),U(""),Be(),jR(n).then(O).catch(console.error)}catch(ht){console.error(ht),alert("Failed to submit receipt. Please try again.")}finally{ge(!1)}}},fn={bank_name:(V==null?void 0:V.bank_name)||"moniepoint MFB",account_number:(V==null?void 0:V.bank_account_number)||"5329604228",account_name:(V==null?void 0:V.bank_account_name)||"mega fruitful vine services limited",country:(V==null?void 0:V.bank_account_country)||"nigeria"};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx(Ss,{})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsx("div",{className:"bg-white",children:c.jsxs("nav",{className:"flex gap-8 px-6",children:[c.jsx("button",{type:"button",className:`py-4 border-b-2 font-medium ${J==="wallet"?"text-blue-600 border-blue-600":"text-gray-600 hover:text-gray-900 border-transparent"}`,onClick:()=>re("wallet"),children:"Wallet"}),c.jsx("button",{type:"button",className:`py-4 border-b-2 font-medium ${J==="payments"?"text-blue-600 border-blue-600":"text-gray-600 hover:text-gray-900 border-transparent"}`,onClick:()=>re("payments"),children:"Payments"})]})}),J==="wallet"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex items-center gap-4",children:[c.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:c.jsx(I0,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Your Credit"}),c.jsx("p",{className:"text-2xl font-semibold",children:De(N.user_wallet_balance)})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Payment Method"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors
                        ${Q==="paystack"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"paymentMethod",className:"hidden",value:"paystack",checked:Q==="paystack",onChange:()=>K("paystack")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-sky-100 flex items-center justify-center",children:c.jsx(I0,{className:"h-5 w-5 text-sky-600"})}),c.jsx("span",{className:"font-medium",children:"Paystack"})]}),c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors
                        ${Q==="bank"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"paymentMethod",className:"hidden",value:"bank",checked:Q==="bank",onChange:()=>K("bank")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-emerald-100 flex items-center justify-center",children:c.jsx(CN,{className:"h-5 w-5 text-emerald-600"})}),c.jsx("span",{className:"font-medium",children:"Bank Transfer"})]})]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("form",{onSubmit:je,className:"flex flex-col sm:flex-row gap-3 sm:items-end",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:"amount",className:"block text-sm text-gray-600 mb-1",children:"Amount (₦)"}),c.jsx(Ne,{id:"amount",type:"number",min:"1",inputMode:"numeric",value:D,onChange:ht=>U(ht.target.value===""?"":Number(ht.target.value)),placeholder:"Enter amount",className:"h-11"})]}),c.jsx(be,{type:"submit",disabled:W||!D||Number(D)<=0,className:"h-11 px-6 w-full sm:w-auto",children:W?"Processing…":"Pay ₦"})]})})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:items-end",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"startDate",className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),c.jsx(Ne,{id:"startDate",type:"date",value:k,onChange:ht=>j(ht.target.value),max:Id(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"endDate",className:"block text-sm text-gray-600 mb-1",children:"End Date"}),c.jsx(Ne,{id:"endDate",type:"date",value:P,onChange:ht=>M(ht.target.value),max:Id(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsx("div",{className:"flex sm:justify-end",children:c.jsx(be,{type:"button",variant:"secondary",onClick:()=>{j(""),M("")},className:"h-11 w-full sm:w-auto",children:"Clear"})})]})}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:h?c.jsx("div",{className:"flex justify-center py-10",children:c.jsxs("svg",{className:"animate-spin h-6 w-6 text-gray-500",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"max-h-[420px] overflow-y-auto pr-2",children:c.jsxs(ya,{children:[c.jsx(_a,{className:"sticky top-0 bg-white",children:c.jsxs(nn,{children:[c.jsx(et,{children:"Date"}),c.jsx(et,{children:"Type"}),c.jsx(et,{className:"text-right",children:"Amount (₦)"})]})}),c.jsxs(ba,{children:[o.map(ht=>c.jsxs(nn,{children:[c.jsx(He,{children:Id(new Date(ht.createdAt),"MMM d, yyyy")}),c.jsx(He,{className:"capitalize",children:ht.type}),c.jsx(He,{className:"text-right",children:ht.amount.toLocaleString()})]},ht.id)),o.length===0&&c.jsx(nn,{children:c.jsx(He,{colSpan:3,className:"text-center text-gray-500 py-10",children:"No transactions found."})})]})]})}),E&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:ot,disabled:C,className:"h-11 px-6",children:C?"Loading...":"Load more"})})]})})]}),J==="payments"&&c.jsx(SGe,{headers:n,balance:N.user_wallet_balance,refreshBalance:()=>jR(n).then(O).catch(console.error)})]})]})}),c.jsx(Yo,{open:q,onOpenChange:ee,children:c.jsxs(vo,{className:"sm:max-w-md",children:[c.jsx(Xo,{children:c.jsx(Jo,{children:"Payment"})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Amount"}),c.jsx("span",{children:rt||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:["VAT +%",Te]}),c.jsx("span",{children:dt})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:["Fees +%",Pe]}),c.jsx("span",{children:ze})]}),c.jsx(k0,{}),c.jsxs("div",{className:"flex justify-between font-semibold",children:[c.jsx("span",{children:"Total"}),c.jsx("span",{className:"text-gray-900",children:De(vt)})]})]}),c.jsxs(lm,{className:"mt-6",children:[c.jsx(be,{variant:"secondary",onClick:()=>ee(!1),children:"Cancel"}),c.jsx(be,{onClick:Mt,disabled:W,children:"Continue"})]})]})}),c.jsx(Yo,{open:oe,onOpenChange:ae,children:c.jsxs(vo,{className:"sm:max-w-2xl",children:[c.jsx(Xo,{children:c.jsxs(Jo,{className:"flex items-center gap-2",children:[c.jsx(CN,{className:"h-5 w-5"})," Bank Transfer"]})}),c.jsxs("div",{className:"rounded-xl border bg-gradient-to-b from-blue-600 to-blue-500 text-white p-6",children:[c.jsx("div",{className:"text-xl font-semibold",children:fn.bank_name}),c.jsx("div",{className:"mt-4 text-2xl tracking-wide",children:fn.account_number}),c.jsx("div",{className:"mt-1 capitalize",children:fn.account_name}),c.jsx("div",{className:"mt-1 uppercase text-white/80",children:fn.country}),c.jsxs("div",{className:"mt-4 text-white/90",children:["Amount to pay: ",c.jsx("span",{className:"font-semibold",children:De(vt)})]})]}),c.jsxs("div",{className:"mt-4 rounded-md bg-orange-50 border border-orange-200 p-4 text-sm text-orange-800",children:["In order to confirm the bank transfer, you will need to upload a receipt (or a screenshot) within ",c.jsx("strong",{children:"1 day"})," from your payment date. We will verify and confirm within ",c.jsx("strong",{children:"48 hours"})," after upload."]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bank Receipt"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ne,{type:"file",accept:"image/*,application/pdf",onChange:ht=>{var St;return de(((St=ht.target.files)==null?void 0:St[0])||null)},className:"cursor-pointer"}),X&&c.jsx("span",{className:"text-sm text-gray-600",children:X.name})]})]}),c.jsxs(lm,{className:"mt-6",children:[c.jsx(be,{variant:"secondary",onClick:()=>ae(!1),children:"Cancel"}),c.jsx(be,{onClick:Ut,disabled:!X||we,children:we?"Sending...":"Send"})]})]})})]})}function CGe({onSelected:e}){const t=S.useRef(null),[n,i]=S.useState(null),o=()=>{var h;return(h=t.current)==null?void 0:h.click()},u=async h=>{var b;const p=(b=h.target.files)==null?void 0:b[0];if(!p)return;if(!["video/mp4","video/webm","video/quicktime"].includes(p.type)){i("Only MP4, WEBM or MOV allowed");return}if(p.size>50*1024*1024){i("Max 50MB");return}i(null);const g=URL.createObjectURL(p),v=document.createElement("video");v.preload="metadata",v.src=g,v.onloadedmetadata=()=>{const E=Math.round(v.duration||0);e(p,g,E)}};return c.jsxs("div",{className:"border-2 border-dashed rounded-xl p-6 text-center bg-white",children:[c.jsx("input",{ref:t,type:"file",accept:"video/*",className:"hidden",onChange:u}),c.jsx("p",{className:"text-gray-600 mb-3",children:"Upload reel (9:16, up to 90s / 50MB)"}),c.jsx(be,{onClick:o,children:"Add video"}),n&&c.jsx("p",{className:"text-red-600 mt-3 text-sm",children:n})]})}const Im="https://api.gada.chat";async function Om(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error((t==null?void 0:t.error)||"Request failed");return t}async function RGe(e,t){const n=new FormData;n.append("files",e);const i=await fetch(`${Im}/api/media/upload`,{method:"POST",body:n,headers:t,credentials:"include"}),{urls:o}=await Om(i);return o[0]}async function NGe(e,t){console.log(e,"inputinputinputinput");const n=await fetch(`${Im}/api/reels`,{method:"POST",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"});return Om(n)}async function Uhe(e){const t=await fetch(`${Im}/api/reels`,{headers:e,credentials:"include"});return Om(t)}async function Fhe(e,t){const n=await fetch(`${Im}/api/reels/${e}/like`,{method:"POST",headers:t,credentials:"include"});return Om(n)}async function Vhe(e,t){const n=await fetch(`${Im}/api/reels/${e}/share`,{method:"POST",headers:t,credentials:"include"});return Om(n)}async function AGe(e,t){const n=await fetch(`${Im}/api/reels/${e}/comments`,{headers:t,credentials:"include"});return Om(n)}async function IGe(e,t,n){const i=await fetch(`${Im}/api/reels/${e}/comments`,{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({content:t}),credentials:"include"});return Om(i)}function OGe(){const{accessToken:e}=st(),t=wt(e),n=Hl(e),[i,o]=S.useState(null),[u,h]=S.useState(""),[p,g]=S.useState(),[v,b]=S.useState(""),[E,T]=S.useState(!1),C=(N,O,k)=>{o(N),h(O),g(k)},R=async()=>{if(i){T(!0);try{const N=await RGe(i,n);console.log(N,"urlurlurlurl"),await NGe({videoUrl:N,caption:v},t),window.location.href="/reels"}catch(N){console.error(N)}finally{T(!1)}}};return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-1",children:[c.jsx(CGe,{onSelected:C}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Caption"}),c.jsx(Ne,{value:v,onChange:N=>b(N.target.value),placeholder:"Say something…"})]}),c.jsx(be,{onClick:R,disabled:!i||E,className:"mt-4 w-full",children:E?"Uploading…":"Next"})]}),c.jsx("div",{className:"lg:col-span-2",children:c.jsxs("div",{className:"bg-white rounded-xl p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Preview"}),c.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-xl min-h-[420px]",children:u?c.jsx("video",{src:u,className:"max-h-[80vh] aspect-[9/16]",controls:!0,playsInline:!0}):c.jsx("div",{className:"text-gray-500",children:"Upload your video to see preview here."})})]})})]})})]})})]})}const IU="https://api.gada.chat",mL=`${IU}/uploads//profile/defaultavatar.png`;function PGe({reel:e,onLike:t,onShare:n,active:i}){const o=S.useRef(null),{accessToken:u}=st(),h=wt(u),[p,g]=S.useState([]),[v,b]=S.useState(!1),[E,T]=S.useState("");S.useEffect(()=>{o.current&&(i?o.current.play().catch(()=>{}):(o.current.pause(),o.current.currentTime=0))},[i]);const C=async()=>{const k=await AGe(e.id,h);g(k)},R=()=>{b(k=>{const j=!k;return j&&p.length===0&&C().catch(console.error),j})},N=async k=>{if(k.preventDefault(),!E.trim())return;const j=await IGe(e.id,E.trim(),h);g(P=>[...P,j]),T("")},O=k=>k?`${IU}/uploads/${Kn(k)}`:mL;return c.jsxs("div",{className:`mx-auto w-full md:max-w-[820px] ${v?"md:max-w-[820px]":"md:max-w-[480px]"}`,children:[c.jsxs("div",{className:v?"md:grid md:grid-cols-[420px,360px] md:gap-5":"",children:[c.jsxs("div",{className:"relative w-full max-w-[420px] aspect-[9/16] bg-black rounded-2xl overflow-hidden shadow-xl mx-auto",children:[c.jsx("video",{ref:o,src:`${IU}/uploads/${Kn(e.videoUrl)}`,className:"h-full w-full object-cover",playsInline:!0,muted:!0,loop:!0,controls:!1}),c.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-4 bg-gradient-to-t from-black/60 to-transparent text-white",children:[c.jsx("div",{className:"text-sm font-semibold",children:e.authorUsername}),e.caption&&c.jsx("div",{className:"text-sm opacity-90 line-clamp-2",children:e.caption})]}),c.jsxs("div",{className:"absolute right-3 bottom-24 flex flex-col items-center gap-4 text-white",children:[c.jsx("button",{onClick:()=>t(e.id),className:`p-3 rounded-full bg-black/50 hover:bg-black/60 ${e.hasLiked?"text-blue-400":""}`,children:c.jsx(P0,{})}),c.jsx("div",{className:"text-xs",children:e.likeCount}),c.jsx("button",{onClick:R,className:"p-3 rounded-full bg-black/50 hover:bg-black/60",children:c.jsx(Mw,{})}),c.jsx("div",{className:"text-xs",children:e.commentCount}),c.jsx("button",{onClick:()=>n(e.id),className:"p-3 rounded-full bg-black/50 hover:bg-black/60",children:c.jsx(T1,{})}),c.jsx("div",{className:"text-xs",children:e.shareCount})]})]}),v&&c.jsxs("aside",{className:"hidden md:flex flex-col h-[calc(100vh-160px)] w-[360px] bg-white rounded-2xl border shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("div",{className:"font-semibold",children:"Comments"}),c.jsx("button",{onClick:()=>b(!1),className:"p-1 rounded hover:bg-gray-100","aria-label":"Close comments",children:c.jsx(go,{className:"h-4 w-4"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:[p.length===0&&c.jsx("div",{className:"text-sm text-gray-500",children:"Be the first to comment"}),p.map(k=>c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("img",{src:O(k.profileImage),alt:k.username,className:"h-8 w-8 rounded-full object-cover border",onError:j=>j.currentTarget.src=mL}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium leading-none",children:k.username}),c.jsx("div",{className:"text-sm mt-1",children:k.content})]})]},k.id))]}),c.jsx("form",{onSubmit:N,className:"sticky bottom-0 bg-white border-t p-3",children:c.jsx("input",{value:E,onChange:k=>T(k.target.value),placeholder:"Write a comment…",className:"w-full border rounded-md px-3 py-2 text-sm"})})]})]}),v&&c.jsxs("div",{className:"md:hidden inset-x-0 bottom-0 h-[60vh] bg-white rounded-t-2xl z-50 shadow-2xl flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("div",{className:"font-semibold",children:"Comments"}),c.jsx("button",{onClick:()=>b(!1),className:"p-1 rounded hover:bg-gray-100","aria-label":"Close comments",children:c.jsx(go,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:[p.length===0&&c.jsx("div",{className:"text-sm text-gray-500",children:"Be the first to comment"}),p.map(k=>c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("img",{src:O(k.profileImage),alt:k.username,className:"h-8 w-8 rounded-full object-cover border",onError:j=>j.currentTarget.src=mL}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium leading-none",children:k.username}),c.jsx("div",{className:"text-sm mt-1",children:k.content})]})]},k.id))]}),c.jsx("form",{onSubmit:N,className:"sticky bottom-0 bg-white border-t p-3",children:c.jsx("input",{value:E,onChange:k=>T(k.target.value),placeholder:"Write a comment…",className:"w-full border rounded-md px-3 py-2 text-sm"})})]})]})}function kGe(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState([]),[o,u]=S.useState(0),h=S.useRef(null),p=S.useMemo(()=>[],[]);S.useEffect(()=>{e&&Uhe(t).then(i).catch(console.error)},[e]),S.useEffect(()=>{for(;p.length<n.length;)p.push({current:null});for(;p.length>n.length;)p.pop()},[n.length,p]),S.useEffect(()=>{const E=h.current;if(!E||n.length===0)return;const T=new IntersectionObserver(C=>{const R=C.filter(O=>O.isIntersecting).sort((O,k)=>k.intersectionRatio-O.intersectionRatio)[0];if(!R)return;const N=p.findIndex(O=>O.current===R.target);N!==-1&&u(N)},{root:E,threshold:[.3,.6,.9]});return p.forEach(C=>C.current&&T.observe(C.current)),()=>T.disconnect()},[n.length,p]);const g=E=>{var R;const T=h.current,C=(R=p[E])==null?void 0:R.current;!T||!C||T.scrollTo({top:C.offsetTop,behavior:"smooth"})};S.useEffect(()=>{const E=T=>{if(T.key==="ArrowDown"){const C=Math.min(o+1,n.length-1);g(C)}if(T.key==="ArrowUp"){const C=Math.max(o-1,0);g(C)}};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[o,n.length]);const v=async E=>{const{liked:T}=await Fhe(E,t);i(C=>C.map(R=>R.id===E?{...R,hasLiked:T,likeCount:R.likeCount+(T?1:-1)}:R))},b=async E=>{await Vhe(E,t),i(T=>T.map(C=>C.id===E?{...C,shareCount:C.shareCount+1}:C))};return c.jsxs("div",{className:"flex flex-col h-screen bg-black",children:[c.jsx(or,{}),c.jsxs(Nt,{to:"/reels/create",className:`fixed right-6 top-[88px] z-30 hidden md:inline-flex items-center gap-2 
             bg-white/90 hover:bg-white text-gray-900 px-3 py-2 rounded-full shadow`,children:[c.jsx(M4,{className:"h-4 w-4"})," Create reel"]}),c.jsx("div",{ref:h,className:"flex-1 overflow-y-scroll snap-y snap-mandatory",children:n.map((E,T)=>c.jsx("section",{ref:C=>p[T]={current:C},className:`
              snap-start
              h-[calc(100vh-72px)]   /* full height minus navbar */
              flex items-center justify-center
            `,children:c.jsx("div",{className:"w-full flex justify-center",children:c.jsx(PGe,{reel:E,onLike:v,onShare:b,active:T===o})})},E.id))}),n.length>1&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>g(Math.max(o-1,0)),className:"hidden md:flex absolute left-6 top-1/2 -translate-y-1/2 h-12 w-12 rounded-full bg-white/10 hover:bg-white/20 text-white items-center justify-center",children:"◂"}),c.jsx("button",{onClick:()=>g(Math.min(o+1,n.length-1)),className:"hidden md:flex absolute right-6 top-1/2 -translate-y-1/2 h-12 w-12 rounded-full bg-white/10 hover:bg-white/20 text-white items-center justify-center",children:"▸"})]})]})}const XQ="https://api.gada.chat";function jGe(){const{accessToken:e}=st(),{items:t,unreadCount:n,loadMore:i,refresh:o,markAll:u}=Zde();return S.useEffect(()=>{e&&o().catch(console.error)},[e]),c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 overflow-y-auto",children:c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[c.jsx("h1",{className:"text-xl font-semibold",children:"Notifications"}),n>0&&c.jsx("button",{onClick:()=>u().catch(console.error),className:"text-sm text-blue-600 hover:underline",children:"Mark all as read"})]}),c.jsxs("ul",{className:"divide-y",children:[t.map(h=>c.jsx("li",{className:`p-4 ${h.readAt?"":"bg-blue-50"}`,children:c.jsx(DGe,{n:h})},h.id)),t.length===0&&c.jsx("li",{className:"p-10 text-center text-gray-500",children:"You have no notifications."})]}),c.jsx("div",{className:"p-4 text-center",children:c.jsx("button",{onClick:()=>i().catch(console.error),className:"text-blue-600 hover:underline",children:"Load more"})})]})})]})})]})}function DGe({n:e}){e.message||`${e.actorName}${JQ(e.type)}`;const t=e.meta&&e.meta.postId?`/posts/${e.meta.postId}`:"#";return c.jsxs(Nt,{to:t,className:"flex items-start gap-3",children:[c.jsx("img",{src:e.actorAvatar?XQ+"/uploads/"+Kn(e.actorAvatar):XQ+"/uploads//profile/defaultavatar.png",alt:"",className:"h-10 w-10 rounded-full object-cover"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:e.actorName})," ",JQ(e.type)]}),c.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),!e.readAt&&c.jsx("span",{className:"mt-2 h-2 w-2 bg-blue-600 rounded-full"})]})}function JQ(e){switch(e){case"post_like":return"liked your post";case"post_comment":return"commented on your post";case"friend_request":return"sent you a friend request";case"friend_accept":return"accepted your friend request";case"reel_like":return"liked your reel";case"new_message":return"sent new message.";default:return"sent you a notification"}}function LGe(){const{postId:e}=tc();Gc();const{accessToken:t}=st(),n=wt(t),[i,o]=S.useState(null),[u,h]=S.useState(!0);return S.useEffect(()=>{e&&(h(!0),$ce(e,n).then(o).catch(console.error).finally(()=>h(!1)))},[e,t]),u?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(si,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):i?c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsxs("div",{className:"sticky top-16",children:["   ",c.jsx(Ss,{})]})}),c.jsx("main",{className:"flex-1 overflow-y-auto py-6",children:c.jsx("div",{className:"max-w-4xl mx-auto",children:c.jsx(Vu,{post:i})})})]})})]}):c.jsx("div",{className:"p-8 text-center",children:"Post not found."})}const MGe=S.createContext(null);function UGe({children:e}){const{accessToken:t}=st(),n=wt(t),[i,o]=S.useState([]),u=S.useRef(0),h=async()=>{const v=await Uhe(n);u.current=10,o(v)};S.useEffect(()=>{t&&h().catch(console.error)},[t]);const p=async v=>{const{liked:b}=await Fhe(v,n);o(E=>E.map(T=>T.id===v?{...T,hasLiked:b,likeCount:T.likeCount+(b?1:-1)}:T))},g=async v=>{await Vhe(v,n),o(b=>b.map(E=>E.id===v?{...E,shareCount:E.shareCount+1}:E))};return c.jsx(MGe.Provider,{value:{reels:i,like:p,share:g,refresh:h},children:e})}const Yd="https://api.gada.chat";async function FGe(e){const t=await fetch(`${Yd}/api/settings/profile`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch profile");return t.json()}async function VGe(e,t){const n=await fetch(`${Yd}/api/settings/profile`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to update profile");return n.json()}async function BGe(e){const t=await fetch(`${Yd}/api/settings/privacy`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch privacy");return t.json()}async function $Ge(e,t){const n=await fetch(`${Yd}/api/settings/privacy`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to update privacy");return n.json()}async function WGe(e){const t=await fetch(`${Yd}/api/settings/notifications`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch notifications");return t.json()}async function GGe(e,t){const n=await fetch(`${Yd}/api/settings/notifications`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to update notifications");return n.json()}async function HGe(e,t,n){const i=await fetch(`${Yd}/api/settings/security/password`,{method:"PUT",headers:{...n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentPassword:e,newPassword:t})});if(!i.ok)throw new Error((await i.json()).error||"Failed to change password");return i.json()}async function zGe(e){const t=await fetch(`${Yd}/api/settings/security/sessions`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch sessions");return t.json()}async function KGe(e,t){const n=await fetch(`${Yd}/api/settings/security/sessions/${e}`,{method:"DELETE",headers:t,credentials:"include"});if(!n.ok)throw new Error("Failed to revoke session");return n.json()}const qGe=[{value:"AF",label:"Afghanistan"},{value:"AX",label:"Åland Islands"},{value:"AL",label:"Albania"},{value:"DZ",label:"Algeria"},{value:"AS",label:"American Samoa"},{value:"AD",label:"Andorra"},{value:"AO",label:"Angola"},{value:"AI",label:"Anguilla"},{value:"AQ",label:"Antarctica"},{value:"AG",label:"Antigua and Barbuda"},{value:"AR",label:"Argentina"},{value:"AM",label:"Armenia"},{value:"AW",label:"Aruba"},{value:"AU",label:"Australia"},{value:"AT",label:"Austria"},{value:"AZ",label:"Azerbaijan"},{value:"BS",label:"Bahamas"},{value:"BH",label:"Bahrain"},{value:"BD",label:"Bangladesh"},{value:"BB",label:"Barbados"},{value:"BY",label:"Belarus"},{value:"BE",label:"Belgium"},{value:"BZ",label:"Belize"},{value:"BJ",label:"Benin"},{value:"BM",label:"Bermuda"},{value:"BT",label:"Bhutan"},{value:"BO",label:"Bolivia, Plurinational State of"},{value:"BQ",label:"Bonaire, Sint Eustatius and Saba"},{value:"BA",label:"Bosnia and Herzegovina"},{value:"BW",label:"Botswana"},{value:"BV",label:"Bouvet Island"},{value:"BR",label:"Brazil"},{value:"IO",label:"British Indian Ocean Territory"},{value:"BN",label:"Brunei Darussalam"},{value:"BG",label:"Bulgaria"},{value:"BF",label:"Burkina Faso"},{value:"BI",label:"Burundi"},{value:"CV",label:"Cabo Verde"},{value:"KH",label:"Cambodia"},{value:"CM",label:"Cameroon"},{value:"CA",label:"Canada"},{value:"KY",label:"Cayman Islands"},{value:"CF",label:"Central African Republic"},{value:"TD",label:"Chad"},{value:"CL",label:"Chile"},{value:"CN",label:"China"},{value:"CX",label:"Christmas Island"},{value:"CC",label:"Cocos (Keeling) Islands"},{value:"CO",label:"Colombia"},{value:"KM",label:"Comoros"},{value:"CG",label:"Congo"},{value:"CD",label:"Congo, Democratic Republic of the"},{value:"CK",label:"Cook Islands"},{value:"CR",label:"Costa Rica"},{value:"HR",label:"Croatia"},{value:"CU",label:"Cuba"},{value:"CW",label:"Curaçao"},{value:"CY",label:"Cyprus"},{value:"CZ",label:"Czechia"},{value:"CI",label:"Côte d'Ivoire"},{value:"DK",label:"Denmark"},{value:"DJ",label:"Djibouti"},{value:"DM",label:"Dominica"},{value:"DO",label:"Dominican Republic"},{value:"EC",label:"Ecuador"},{value:"EG",label:"Egypt"},{value:"SV",label:"El Salvador"},{value:"GQ",label:"Equatorial Guinea"},{value:"ER",label:"Eritrea"},{value:"EE",label:"Estonia"},{value:"SZ",label:"Eswatini"},{value:"ET",label:"Ethiopia"},{value:"FK",label:"Falkland Islands (Malvinas)"},{value:"FO",label:"Faroe Islands"},{value:"FJ",label:"Fiji"},{value:"FI",label:"Finland"},{value:"FR",label:"France"},{value:"GF",label:"French Guiana"},{value:"PF",label:"French Polynesia"},{value:"TF",label:"French Southern Territories"},{value:"GA",label:"Gabon"},{value:"GM",label:"Gambia"},{value:"GE",label:"Georgia"},{value:"DE",label:"Germany"},{value:"GH",label:"Ghana"},{value:"GI",label:"Gibraltar"},{value:"GR",label:"Greece"},{value:"GL",label:"Greenland"},{value:"GD",label:"Grenada"},{value:"GP",label:"Guadeloupe"},{value:"GU",label:"Guam"},{value:"GT",label:"Guatemala"},{value:"GG",label:"Guernsey"},{value:"GN",label:"Guinea"},{value:"GW",label:"Guinea-Bissau"},{value:"GY",label:"Guyana"},{value:"HT",label:"Haiti"},{value:"HM",label:"Heard Island and McDonald Islands"},{value:"VA",label:"Holy See"},{value:"HN",label:"Honduras"},{value:"HK",label:"Hong Kong"},{value:"HU",label:"Hungary"},{value:"IS",label:"Iceland"},{value:"IN",label:"India"},{value:"ID",label:"Indonesia"},{value:"IR",label:"Iran, Islamic Republic of"},{value:"IQ",label:"Iraq"},{value:"IE",label:"Ireland"},{value:"IM",label:"Isle of Man"},{value:"IL",label:"Israel"},{value:"IT",label:"Italy"},{value:"JM",label:"Jamaica"},{value:"JP",label:"Japan"},{value:"JE",label:"Jersey"},{value:"JO",label:"Jordan"},{value:"KZ",label:"Kazakhstan"},{value:"KE",label:"Kenya"},{value:"KI",label:"Kiribati"},{value:"KP",label:"Korea, Democratic People's Republic of"},{value:"KR",label:"Korea, Republic of"},{value:"KW",label:"Kuwait"},{value:"KG",label:"Kyrgyzstan"},{value:"LA",label:"Lao People's Democratic Republic"},{value:"LV",label:"Latvia"},{value:"LB",label:"Lebanon"},{value:"LS",label:"Lesotho"},{value:"LR",label:"Liberia"},{value:"LY",label:"Libya"},{value:"LI",label:"Liechtenstein"},{value:"LT",label:"Lithuania"},{value:"LU",label:"Luxembourg"},{value:"MO",label:"Macao"},{value:"MG",label:"Madagascar"},{value:"MW",label:"Malawi"},{value:"MY",label:"Malaysia"},{value:"MV",label:"Maldives"},{value:"ML",label:"Mali"},{value:"MT",label:"Malta"},{value:"MH",label:"Marshall Islands"},{value:"MQ",label:"Martinique"},{value:"MR",label:"Mauritania"},{value:"MU",label:"Mauritius"},{value:"YT",label:"Mayotte"},{value:"MX",label:"Mexico"},{value:"FM",label:"Micronesia, Federated States of"},{value:"MD",label:"Moldova, Republic of"},{value:"MC",label:"Monaco"},{value:"MN",label:"Mongolia"},{value:"ME",label:"Montenegro"},{value:"MS",label:"Montserrat"},{value:"MA",label:"Morocco"},{value:"MZ",label:"Mozambique"},{value:"MM",label:"Myanmar"},{value:"NA",label:"Namibia"},{value:"NR",label:"Nauru"},{value:"NP",label:"Nepal"},{value:"NL",label:"Netherlands"},{value:"NC",label:"New Caledonia"},{value:"NZ",label:"New Zealand"},{value:"NI",label:"Nicaragua"},{value:"NE",label:"Niger"},{value:"NG",label:"Nigeria"},{value:"NU",label:"Niue"},{value:"NF",label:"Norfolk Island"},{value:"MK",label:"North Macedonia"},{value:"MP",label:"Northern Mariana Islands"},{value:"NO",label:"Norway"},{value:"OM",label:"Oman"},{value:"PK",label:"Pakistan"},{value:"PW",label:"Palau"},{value:"PS",label:"Palestine, State of"},{value:"PA",label:"Panama"},{value:"PG",label:"Papua New Guinea"},{value:"PY",label:"Paraguay"},{value:"PE",label:"Peru"},{value:"PH",label:"Philippines"},{value:"PN",label:"Pitcairn"},{value:"PL",label:"Poland"},{value:"PT",label:"Portugal"},{value:"PR",label:"Puerto Rico"},{value:"QA",label:"Qatar"},{value:"RO",label:"Romania"},{value:"RU",label:"Russian Federation"},{value:"RW",label:"Rwanda"},{value:"RE",label:"Réunion"},{value:"BL",label:"Saint Barthélemy"},{value:"SH",label:"Saint Helena, Ascension and Tristan da Cunha"},{value:"KN",label:"Saint Kitts and Nevis"},{value:"LC",label:"Saint Lucia"},{value:"MF",label:"Saint Martin (French part)"},{value:"PM",label:"Saint Pierre and Miquelon"},{value:"VC",label:"Saint Vincent and the Grenadines"},{value:"WS",label:"Samoa"},{value:"SM",label:"San Marino"},{value:"ST",label:"Sao Tome and Principe"},{value:"SA",label:"Saudi Arabia"},{value:"SN",label:"Senegal"},{value:"RS",label:"Serbia"},{value:"SC",label:"Seychelles"},{value:"SL",label:"Sierra Leone"},{value:"SG",label:"Singapore"},{value:"SX",label:"Sint Maarten (Dutch part)"},{value:"SK",label:"Slovakia"},{value:"SI",label:"Slovenia"},{value:"SB",label:"Solomon Islands"},{value:"SO",label:"Somalia"},{value:"ZA",label:"South Africa"},{value:"GS",label:"South Georgia and the South Sandwich Islands"},{value:"SS",label:"South Sudan"},{value:"ES",label:"Spain"},{value:"LK",label:"Sri Lanka"},{value:"SD",label:"Sudan"},{value:"SR",label:"Suriname"},{value:"SJ",label:"Svalbard and Jan Mayen"},{value:"SE",label:"Sweden"},{value:"CH",label:"Switzerland"},{value:"SY",label:"Syrian Arab Republic"},{value:"TW",label:"Taiwan, Province of China"},{value:"TJ",label:"Tajikistan"},{value:"TZ",label:"Tanzania, United Republic of"},{value:"TH",label:"Thailand"},{value:"TL",label:"Timor-Leste"},{value:"TG",label:"Togo"},{value:"TK",label:"Tokelau"},{value:"TO",label:"Tonga"},{value:"TT",label:"Trinidad and Tobago"},{value:"TN",label:"Tunisia"},{value:"TR",label:"Turkey"},{value:"TM",label:"Turkmenistan"},{value:"TC",label:"Turks and Caicos Islands"},{value:"TV",label:"Tuvalu"},{value:"UG",label:"Uganda"},{value:"UA",label:"Ukraine"},{value:"AE",label:"United Arab Emirates"},{value:"GB",label:"United Kingdom"},{value:"UM",label:"United States Minor Outlying Islands"},{value:"US",label:"United States"},{value:"UY",label:"Uruguay"},{value:"UZ",label:"Uzbekistan"},{value:"VU",label:"Vanuatu"},{value:"VE",label:"Venezuela, Bolivarian Republic of"},{value:"VN",label:"Viet Nam"},{value:"VG",label:"Virgin Islands, British"},{value:"VI",label:"Virgin Islands, U.S."},{value:"WF",label:"Wallis and Futuna"},{value:"EH",label:"Western Sahara"},{value:"YE",label:"Yemen"},{value:"ZM",label:"Zambia"},{value:"ZW",label:"Zimbabwe"}],YGe=[{value:"AF",label:"افغانستان"},{value:"AX",label:"Åland"},{value:"AL",label:"Shqipëria"},{value:"DZ",label:"الجزائر"},{value:"AS",label:"American Samoa"},{value:"AD",label:"Andorra"},{value:"AO",label:"Angola"},{value:"AI",label:"Anguilla"},{value:"AQ",label:"Antarctica"},{value:"AG",label:"Antigua and Barbuda"},{value:"AR",label:"Argentina"},{value:"AM",label:"Հայաստան"},{value:"AW",label:"Aruba"},{value:"AU",label:"Australia"},{value:"AT",label:"Österreich"},{value:"AZ",label:"Azərbaycan"},{value:"BS",label:"Bahamas"},{value:"BH",label:"‏البحرين"},{value:"BD",label:"Bangladesh"},{value:"BB",label:"Barbados"},{value:"BY",label:"Белару́сь"},{value:"BE",label:"België"},{value:"BZ",label:"Belize"},{value:"BJ",label:"Bénin"},{value:"BM",label:"Bermuda"},{value:"BT",label:"ʼbrug-yul"},{value:"BO",label:"Bolivia"},{value:"BQ",label:"Bonaire"},{value:"BA",label:"Bosna i Hercegovina"},{value:"BW",label:"Botswana"},{value:"BV",label:"Bouvetøya"},{value:"BR",label:"Brasil"},{value:"IO",label:"British Indian Ocean Territory"},{value:"BN",label:"Negara Brunei Darussalam"},{value:"BG",label:"България"},{value:"BF",label:"Burkina Faso"},{value:"BI",label:"Burundi"},{value:"KH",label:"Kâmpŭchéa"},{value:"CM",label:"Cameroon"},{value:"CA",label:"Canada"},{value:"CV",label:"Cabo Verde"},{value:"KY",label:"Cayman Islands"},{value:"CF",label:"Ködörösêse tî Bêafrîka"},{value:"TD",label:"Tchad"},{value:"CL",label:"Chile"},{value:"CN",label:"中国"},{value:"CX",label:"Christmas Island"},{value:"CC",label:"Cocos (Keeling) Islands"},{value:"CO",label:"Colombia"},{value:"KM",label:"Komori"},{value:"CG",label:"République du Congo"},{value:"CD",label:"République démocratique du Congo"},{value:"CK",label:"Cook Islands"},{value:"CR",label:"Costa Rica"},{value:"CI",label:"Côte d'Ivoire"},{value:"HR",label:"Hrvatska"},{value:"CU",label:"Cuba"},{value:"CW",label:"Curaçao"},{value:"CY",label:"Κύπρος"},{value:"CZ",label:"Česká republika"},{value:"DK",label:"Danmark"},{value:"DJ",label:"Djibouti"},{value:"DM",label:"Dominica"},{value:"DO",label:"República Dominicana"},{value:"EC",label:"Ecuador"},{value:"EG",label:"مصر‎"},{value:"SV",label:"El Salvador"},{value:"GQ",label:"Guinea Ecuatorial"},{value:"ER",label:"ኤርትራ"},{value:"EE",label:"Eesti"},{value:"ET",label:"ኢትዮጵያ"},{value:"FK",label:"Falkland Islands"},{value:"FO",label:"Føroyar"},{value:"FJ",label:"Fiji"},{value:"FI",label:"Suomi"},{value:"FR",label:"France"},{value:"GF",label:"Guyane française"},{value:"PF",label:"Polynésie française"},{value:"TF",label:"Territoire des Terres australes et antarctiques fr"},{value:"GA",label:"Gabon"},{value:"GM",label:"Gambia"},{value:"GE",label:"საქართველო"},{value:"DE",label:"Deutschland"},{value:"GH",label:"Ghana"},{value:"GI",label:"Gibraltar"},{value:"GR",label:"Ελλάδα"},{value:"GL",label:"Kalaallit Nunaat"},{value:"GD",label:"Grenada"},{value:"GP",label:"Guadeloupe"},{value:"GU",label:"Guam"},{value:"GT",label:"Guatemala"},{value:"GG",label:"Guernsey"},{value:"GN",label:"Guinée"},{value:"GW",label:"Guiné-Bissau"},{value:"GY",label:"Guyana"},{value:"HT",label:"Haïti"},{value:"HM",label:"Heard Island and McDonald Islands"},{value:"VA",label:"Vaticano"},{value:"HN",label:"Honduras"},{value:"HK",label:"香港"},{value:"HU",label:"Magyarország"},{value:"IS",label:"Ísland"},{value:"IN",label:"भारत"},{value:"ID",label:"Indonesia"},{value:"IR",label:"ایران"},{value:"IQ",label:"العراق"},{value:"IE",label:"Éire"},{value:"IM",label:"Isle of Man"},{value:"IL",label:"יִשְׂרָאֵל"},{value:"IT",label:"Italia"},{value:"JM",label:"Jamaica"},{value:"JP",label:"日本"},{value:"JE",label:"Jersey"},{value:"JO",label:"الأردن"},{value:"KZ",label:"Қазақстан"},{value:"KE",label:"Kenya"},{value:"KI",label:"Kiribati"},{value:"KP",label:"북한"},{value:"KR",label:"대한민국"},{value:"KW",label:"الكويت"},{value:"KG",label:"Кыргызстан"},{value:"LA",label:"ສປປລາວ"},{value:"LV",label:"Latvija"},{value:"LB",label:"لبنان"},{value:"LS",label:"Lesotho"},{value:"LR",label:"Liberia"},{value:"LY",label:"‏ليبيا"},{value:"LI",label:"Liechtenstein"},{value:"LT",label:"Lietuva"},{value:"LU",label:"Luxembourg"},{value:"MO",label:"澳門"},{value:"MK",label:"Северна Македонија"},{value:"MG",label:"Madagasikara"},{value:"MW",label:"Malawi"},{value:"MY",label:"Malaysia"},{value:"MV",label:"Maldives"},{value:"ML",label:"Mali"},{value:"MT",label:"Malta"},{value:"MH",label:"M̧ajeļ"},{value:"MQ",label:"Martinique"},{value:"MR",label:"موريتانيا"},{value:"MU",label:"Maurice"},{value:"YT",label:"Mayotte"},{value:"MX",label:"México"},{value:"FM",label:"Micronesia"},{value:"MD",label:"Moldova"},{value:"MC",label:"Monaco"},{value:"MN",label:"Монгол улс"},{value:"ME",label:"Црна Гора"},{value:"MS",label:"Montserrat"},{value:"MA",label:"المغرب"},{value:"MZ",label:"Moçambique"},{value:"MM",label:"မြန်မာ"},{value:"NA",label:"Namibia"},{value:"NR",label:"Nauru"},{value:"NP",label:"नपल"},{value:"NL",label:"Nederland"},{value:"NC",label:"Nouvelle-Calédonie"},{value:"NZ",label:"New Zealand"},{value:"NI",label:"Nicaragua"},{value:"NE",label:"Niger"},{value:"NG",label:"Nigeria"},{value:"NU",label:"Niuē"},{value:"NF",label:"Norfolk Island"},{value:"MP",label:"Northern Mariana Islands"},{value:"NO",label:"Norge"},{value:"OM",label:"عمان"},{value:"PK",label:"Pakistan"},{value:"PW",label:"Palau"},{value:"PS",label:"فلسطين"},{value:"PA",label:"Panamá"},{value:"PG",label:"Papua Niugini"},{value:"PY",label:"Paraguay"},{value:"PE",label:"Perú"},{value:"PH",label:"Pilipinas"},{value:"PN",label:"Pitcairn Islands"},{value:"PL",label:"Polska"},{value:"PT",label:"Portugal"},{value:"PR",label:"Puerto Rico"},{value:"QA",label:"قطر"},{value:"RE",label:"La Réunion"},{value:"RO",label:"România"},{value:"RU",label:"Россия"},{value:"RW",label:"Rwanda"},{value:"BL",label:"Saint-Barthélemy"},{value:"SH",label:"Saint Helena"},{value:"KN",label:"Saint Kitts and Nevis"},{value:"LC",label:"Saint Lucia"},{value:"MF",label:"Saint-Martin"},{value:"PM",label:"Saint-Pierre-et-Miquelon"},{value:"VC",label:"Saint Vincent and the Grenadines"},{value:"WS",label:"Samoa"},{value:"SM",label:"San Marino"},{value:"ST",label:"São Tomé e Príncipe"},{value:"SA",label:"العربية السعودية"},{value:"SN",label:"Sénégal"},{value:"RS",label:"Србија"},{value:"SC",label:"Seychelles"},{value:"SL",label:"Sierra Leone"},{value:"SG",label:"Singapore"},{value:"SX",label:"Sint Maarten"},{value:"SK",label:"Slovensko"},{value:"SI",label:"Slovenija"},{value:"SB",label:"Solomon Islands"},{value:"SO",label:"Soomaaliya"},{value:"ZA",label:"South Africa"},{value:"GS",label:"South Georgia"},{value:"SS",label:"South Sudan"},{value:"ES",label:"España"},{value:"LK",label:"śrī laṃkāva"},{value:"SD",label:"السودان"},{value:"SR",label:"Suriname"},{value:"SJ",label:"Svalbard og Jan Mayen"},{value:"SZ",label:"Swaziland"},{value:"SE",label:"Sverige"},{value:"CH",label:"Schweiz"},{value:"SY",label:"سوريا"},{value:"TW",label:"臺灣"},{value:"TJ",label:"Тоҷикистон"},{value:"TZ",label:"Tanzania"},{value:"TH",label:"ประเทศไทย"},{value:"TL",label:"Timor-Leste"},{value:"TG",label:"Togo"},{value:"TK",label:"Tokelau"},{value:"TO",label:"Tonga"},{value:"TT",label:"Trinidad and Tobago"},{value:"TN",label:"تونس"},{value:"TR",label:"Türkiye"},{value:"TM",label:"Türkmenistan"},{value:"TC",label:"Turks and Caicos Islands"},{value:"TV",label:"Tuvalu"},{value:"UG",label:"Uganda"},{value:"UA",label:"Україна"},{value:"AE",label:"دولة الإمارات العربية المتحدة"},{value:"GB",label:"United Kingdom"},{value:"US",label:"United States"},{value:"UM",label:"United States Minor Outlying Islands"},{value:"UY",label:"Uruguay"},{value:"UZ",label:"O‘zbekiston"},{value:"VU",label:"Vanuatu"},{value:"VE",label:"Venezuela"},{value:"VN",label:"Việt Nam"},{value:"VG",label:"British Virgin Islands"},{value:"VI",label:"United States Virgin Islands"},{value:"WF",label:"Wallis et Futuna"},{value:"EH",label:"الصحراء الغربية"},{value:"YE",label:"اليَمَن"},{value:"ZM",label:"Zambia"},{value:"ZW",label:"Zimbabwe"}];class ZQ{constructor(){this.data=qGe,this.labelMap={},this.valueMap={},this.data.forEach(t=>{this.labelMap[t.label.toLowerCase()]=t.value,this.valueMap[t.value.toLowerCase()]=t.label})}getValue(t){return this.labelMap[t.toLowerCase()]}getLabel(t){return this.valueMap[t.toLowerCase()]}getLabels(){return this.data.map(t=>t.label)}getValues(){return this.data.map(t=>t.value)}getLabelList(){return this.labelMap}getValueList(){return this.valueMap}getData(){return this.data}setLabel(t,n){return this.data.forEach(i=>{i.value===t&&(i.label=n,this.valueMap[i.value.toLowerCase()]=i.label)}),this}setEmpty(t){return this.data.unshift({value:"",label:t}),this.valueMap[""]=t,this.labelMap[t]="",this}native(){return this.nativeData=YGe,this.nativeData.forEach(t=>{this.labelMap[t.label.toLowerCase()]=t.value,this.valueMap[t.value.toLowerCase()]=t.label}),this}}const XGe=()=>{if(!(void 0 instanceof ZQ))return new ZQ};var JGe=XGe;const ZGe=jr(JGe);function QGe(){const{accessToken:e,user:t}=st(),n=S.useMemo(()=>ZGe().getData(),[]),i=wt(e),[o,u]=S.useState(null),[h,p]=S.useState(!1);S.useEffect(()=>{e&&(FGe(i).then(v=>{u({...v,dateOfBirth:v.dateOfBirth?new Date(v.dateOfBirth).toISOString().split("T")[0]:""})}).catch(console.error),console.log(o,"datadata"))},[e]);const g=async()=>{if(o){p(!0);try{await VGe(o,i),Ce.success("Your settings were updated successfully")}catch(v){console.error(v),Ce.error((v==null?void 0:v.message)||"Something went wrong. Please try again.")}finally{p(!1)}}};return o?c.jsxs(Vr,{className:"mb-6",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"General"})}),c.jsxs(mi,{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Username"}),c.jsx(Ne,{value:o.username,disabled:!0,required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Email"}),c.jsx(Ne,{value:o.user_email,disabled:!0,required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Phone"}),c.jsx(Ne,{type:"number",value:o.phone??"",onChange:v=>u({...o,phone:v.target.value}),onKeyDown:v=>{["e","E","+","-"].includes(v.key)&&v.preventDefault()},required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Date of Birth"}),c.jsx(Ne,{type:"date",value:o.dateOfBirth??"",onChange:v=>u({...o,dateOfBirth:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Gender"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3",value:o.gender??"",onChange:v=>u({...o,gender:v.target.value}),required:!0,children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"}),c.jsx("option",{value:"non_binary",children:"Non-binary"}),c.jsx("option",{value:"prefer_not",children:"Prefer not to say"})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Website"}),c.jsx(Ne,{value:o.website??"",onChange:v=>u({...o,website:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"City"}),c.jsx(Ne,{value:o.city??"",onChange:v=>u({...o,city:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Country"}),c.jsxs("select",{value:(o==null?void 0:o.country)??"",onChange:v=>u({...o,country:v.target.value}),required:!0,className:"w-full border rounded-md h-10 px-3",children:[c.jsx("option",{value:"",children:"Select Country"}),n.map(v=>c.jsx("option",{value:v.label,children:v.label},v.value))]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Timezone"}),c.jsx(Ne,{value:o.timezone??"UTC",onChange:v=>u({...o,timezone:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Language"}),c.jsx(Ne,{value:o.language??"en",onChange:v=>u({...o,language:v.target.value}),required:!0})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx(Je,{children:"Work"}),c.jsx(Ne,{value:o.work??"",onChange:v=>u({...o,work:v.target.value}),required:!0})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx(Je,{children:"Education"}),c.jsx(Ne,{value:o.education??"",onChange:v=>u({...o,education:v.target.value}),required:!0})]})]}),c.jsx(k0,{}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:g,disabled:h,children:h?"Saving…":"Save changes"})})]})]}):c.jsx("div",{className:"p-4",children:"Loading…"})}var Z1="Switch",[eHe,cxt]=Vs(Z1),[tHe,nHe]=eHe(Z1),Bhe=S.forwardRef((e,t)=>{const{__scopeSwitch:n,name:i,checked:o,defaultChecked:u,required:h,disabled:p,value:g="on",onCheckedChange:v,form:b,...E}=e,[T,C]=S.useState(null),R=Dn(t,P=>C(P)),N=S.useRef(!1),O=T?b||!!T.closest("form"):!0,[k,j]=$d({prop:o,defaultProp:u??!1,onChange:v,caller:Z1});return c.jsxs(tHe,{scope:n,checked:k,disabled:p,children:[c.jsx(en.button,{type:"button",role:"switch","aria-checked":k,"aria-required":h,"data-state":Hhe(k),"data-disabled":p?"":void 0,disabled:p,value:g,...E,ref:R,onClick:Tt(e.onClick,P=>{j(M=>!M),O&&(N.current=P.isPropagationStopped(),N.current||P.stopPropagation())})}),O&&c.jsx(Ghe,{control:T,bubbles:!N.current,name:i,value:g,checked:k,required:h,disabled:p,form:b,style:{transform:"translateX(-100%)"}})]})});Bhe.displayName=Z1;var $he="SwitchThumb",Whe=S.forwardRef((e,t)=>{const{__scopeSwitch:n,...i}=e,o=nHe($he,n);return c.jsx(en.span,{"data-state":Hhe(o.checked),"data-disabled":o.disabled?"":void 0,...i,ref:t})});Whe.displayName=$he;var rHe="SwitchBubbleInput",Ghe=S.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:i=!0,...o},u)=>{const h=S.useRef(null),p=Dn(h,u),g=rB(n),v=y4(t);return S.useEffect(()=>{const b=h.current;if(!b)return;const E=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(E,"checked").set;if(g!==n&&C){const R=new Event("click",{bubbles:i});C.call(b,n),b.dispatchEvent(R)}},[g,n,i]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:p,style:{...o.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ghe.displayName=rHe;function Hhe(e){return e?"checked":"unchecked"}var zhe=Bhe,iHe=Whe;const Zi=S.forwardRef(({className:e,...t},n)=>c.jsx(zhe,{className:kt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:c.jsx(iHe,{className:kt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Zi.displayName=zhe.displayName;function aHe(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(null),[o,u]=S.useState(!1);if(S.useEffect(()=>{e&&BGe(t).then(i).catch(console.error)},[e]),!n)return c.jsx("div",{className:"p-4",children:"Loading…"});const h=async()=>{u(!0);try{await $Ge(n,t)}finally{u(!1)}};return c.jsxs(Vr,{className:"mb-6",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Privacy"})}),c.jsxs(mi,{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Profile visibility"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.profileVisibility,onChange:p=>i({...n,profileVisibility:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Who can send you friend requests"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.friendRequestPolicy,onChange:p=>i({...n,friendRequestPolicy:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends_of_friends",children:"Friends of friends"})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Who can look you up by email"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.lookupEmail,onChange:p=>i({...n,lookupEmail:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Who can look you up by phone"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.lookupPhone,onChange:p=>i({...n,lookupPhone:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Zi,{checked:n.showOnline,onCheckedChange:p=>i({...n,showOnline:p})}),c.jsx(Je,{children:"Show online status"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Zi,{checked:n.tagReview,onCheckedChange:p=>i({...n,tagReview:p})}),c.jsx(Je,{children:"Require review before tags appear"})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:h,disabled:o,children:o?"Saving…":"Save changes"})})]})]})}function sHe(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(null),[o,u]=S.useState(!1);if(S.useEffect(()=>{e&&WGe(t).then(i).catch(console.error)},[e]),!n)return c.jsx("div",{className:"p-4",children:"Loading…"});const h=g=>i(v=>v&&{...v,[g]:!v[g]}),p=async()=>{u(!0);try{await GGe(n,t)}finally{u(!1)}};return c.jsxs(Vr,{className:"mb-6",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Notifications"})}),c.jsxs(mi,{className:"space-y-6",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[["inappLikes","Likes"],["inappComments","Comments"],["inappMentions","Mentions"],["inappFriendRequests","Friend requests"],["inappGroupActivity","Group activity"],["inappPayments","Payments"],["emailDigest","Email weekly digest"],["emailSecurity","Email security alerts"]].map(([g,v])=>c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Zi,{checked:n[g],onCheckedChange:()=>h(g)}),c.jsx(Je,{children:v})]},g))}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:p,disabled:o,children:o?"Saving…":"Save changes"})})]})]})}function oHe(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(""),[o,u]=S.useState(""),[h,p]=S.useState(!1),[g,v]=S.useState([]),[b,E]=S.useState(!0);S.useEffect(()=>{e&&zGe(t).then(v).catch(console.error).finally(()=>E(!1))},[e]);const T=async()=>{p(!0);try{let R=await HGe(n,o,t);i(""),u(""),Ce.success("Your password has been updated successfully")}catch(R){Ce.error(R.message)}finally{p(!1)}},C=async R=>{await KGe(R,t).catch(console.error),v(N=>N.filter(O=>O.id!==R))};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Vr,{children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Change Password"})}),c.jsxs(mi,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Current password"}),c.jsx(Ne,{type:"password",value:n,onChange:R=>i(R.target.value)})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"New password"}),c.jsx(Ne,{type:"password",value:o,onChange:R=>u(R.target.value)})]}),c.jsx("div",{className:"md:col-span-2 flex justify-end",children:c.jsx(be,{onClick:T,disabled:h||!n||o.length<8,children:h?"Saving…":"Change password"})})]})]}),c.jsxs(Vr,{children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Active Sessions"})}),c.jsx(mi,{children:b?c.jsx("div",{children:"Loading…"}):g.length===0?c.jsx("div",{className:"text-gray-500",children:"No active sessions."}):c.jsx("div",{className:"space-y-3",children:g.map(R=>c.jsxs("div",{className:"flex items-center justify-between border rounded-md p-3 bg-white",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium",children:R.userAgent||"Unknown device"}),c.jsxs("div",{className:"text-gray-500",children:["IP ",R.ip||"—"," • Created ",new Date(R.createdAt).toLocaleString(),R.lastSeen&&c.jsxs(c.Fragment,{children:[" • Last seen ",new Date(R.lastSeen).toLocaleString()]})]})]}),c.jsx(be,{variant:"outline",onClick:()=>C(R.id),children:"Revoke"})]},R.id))})})]})]})}const cHe=[{key:"general",label:"General"},{key:"privacy",label:"Privacy"},{key:"notifications",label:"Notifications"},{key:"security",label:"Security"}];function lHe(){const[e,t]=S.useState("general");return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex w-full max-w-[1440px] mx-auto gap-6 min-w-0",children:[c.jsx("aside",{className:"hidden lg:block w-64 shrink-0 min-h-0",children:c.jsx("div",{className:"sticky top-16 h-[calc(100vh-4rem)] overflow-y-auto",children:c.jsx(Ss,{})})}),c.jsx("div",{className:"flex-1 min-h-0 min-w-0",children:c.jsx("div",{className:"bg-white rounded-xl shadow-sm border h-full overflow-hidden flex flex-col",children:c.jsxs(Am,{value:e,onValueChange:n=>t(n),className:"flex h-full flex-col min-w-0",children:[c.jsx("div",{className:"sticky z-20 bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-b",children:c.jsx("div",{className:"px-3 sm:px-4 md:px-6",children:c.jsx(jf,{"aria-label":"Settings sections",className:`
                        !bg-transparent p-0 h-auto
                        w-full
                        flex flex-wrap sm:flex-nowrap gap-2 items-stretch
                        overflow-x-visible sm:overflow-x-auto hide-scrollbar
                      `,children:cHe.map(n=>c.jsx(Ia,{value:n.key,className:`
                            rounded-md
                            px-3 md:px-4 py-2
                            text-sm font-medium
                            text-gray-600
                            outline-none ring-0 focus:outline-none
                            focus-visible:ring-0 focus-visible:ring-offset-0
                            data-[state=active]:text-gray-900
                            data-[state=active]:bg-white
                            data-[state=active]:border
                            data-[state=active]:shadow-none
                            whitespace-nowrap
                          `,children:n.label},n.key))})})}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 sm:p-4 md:p-6 pt-4 sm:pt-6",children:[c.jsx(fi,{value:"general",className:"m-0",children:c.jsx(QGe,{})}),c.jsx(fi,{value:"privacy",className:"m-0",children:c.jsx(aHe,{})}),c.jsx(fi,{value:"notifications",className:"m-0",children:c.jsx(sHe,{})}),c.jsx(fi,{value:"security",className:"m-0",children:c.jsx(oHe,{})})]})]})})})]})})]})}function uHe(){return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1400px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"max-w-3xl mx-auto",children:c.jsxs("div",{className:"rounded-xl shadow-sm border bg-white overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-[#7C3AED] via-[#5B6CFA] to-[#1D4ED8] p-6 text-white",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"bg-white/20 rounded-2xl p-3",children:c.jsx(U4,{className:"h-6 w-6"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Something exciting is on the way"}),c.jsx("p",{className:"text-white/90",children:"We’re polishing the last bits. Stay tuned!"})]})]})}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"rounded-lg border bg-gray-50 px-4 py-3 text-gray-700 flex items-center gap-2",children:[c.jsx("span",{className:"inline-flex h-2 w-2 rounded-full bg-amber-500 animate-pulse"}),"Launching soon"]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx(Nt,{to:"/",children:c.jsxs(be,{variant:"outline",className:"gap-2",children:[c.jsx(IVe,{className:"h-4 w-4"}),"Back to feed"]})}),c.jsx(Nt,{to:"/help"})]})]})]})})}),c.jsx("aside",{className:"hidden xl:block xl:w-80"})]})})]})}var qw=e=>e.type==="checkbox",Vp=e=>e instanceof Date,js=e=>e==null;const Khe=e=>typeof e=="object";var ta=e=>!js(e)&&!Array.isArray(e)&&Khe(e)&&!Vp(e),qhe=e=>ta(e)&&e.target?qw(e.target)?e.target.checked:e.target.value:e,dHe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Yhe=(e,t)=>e.has(dHe(t)),hHe=e=>{const t=e.constructor&&e.constructor.prototype;return ta(t)&&t.hasOwnProperty("isPrototypeOf")},wB=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ra(e){let t;const n=Array.isArray(e),i=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(wB&&(e instanceof Blob||i))&&(n||ta(e)))if(t=n?[]:{},!n&&!hHe(e))t=e;else for(const o in e)e.hasOwnProperty(o)&&(t[o]=Ra(e[o]));else return e;return t}var Q1=e=>/^\w*$/.test(e),Xi=e=>e===void 0,SB=e=>Array.isArray(e)?e.filter(Boolean):[],xB=e=>SB(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Ot=(e,t,n)=>{if(!t||!ta(e))return n;const i=(Q1(t)?[t]:xB(t)).reduce((o,u)=>js(o)?o:o[u],e);return Xi(i)||i===e?Xi(e[t])?n:e[t]:i},Vo=e=>typeof e=="boolean",Ur=(e,t,n)=>{let i=-1;const o=Q1(t)?[t]:xB(t),u=o.length,h=u-1;for(;++i<u;){const p=o[i];let g=n;if(i!==h){const v=e[p];g=ta(v)||Array.isArray(v)?v:isNaN(+o[i+1])?{}:[]}if(p==="__proto__"||p==="constructor"||p==="prototype")return;e[p]=g,e=e[p]}};const MN={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},jl={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},vd={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},TB=me.createContext(null);TB.displayName="HookFormContext";const eI=()=>me.useContext(TB),fHe=e=>{const{children:t,...n}=e;return me.createElement(TB.Provider,{value:n},t)};var Xhe=(e,t,n,i=!0)=>{const o={defaultValues:t._defaultValues};for(const u in e)Object.defineProperty(o,u,{get:()=>{const h=u;return t._proxyFormState[h]!==jl.all&&(t._proxyFormState[h]=!i||jl.all),n&&(n[h]=!0),e[h]}});return o};const CB=typeof window<"u"?me.useLayoutEffect:me.useEffect;function pHe(e){const t=eI(),{control:n=t.control,disabled:i,name:o,exact:u}=e||{},[h,p]=me.useState(n._formState),g=me.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return CB(()=>n._subscribe({name:o,formState:g.current,exact:u,callback:v=>{!i&&p({...n._formState,...v})}}),[o,i,u]),me.useEffect(()=>{g.current.isValid&&n._setValid(!0)},[n]),me.useMemo(()=>Xhe(h,n,g.current,!1),[h,n])}var Au=e=>typeof e=="string",Jhe=(e,t,n,i,o)=>Au(e)?(i&&t.watch.add(e),Ot(n,e,o)):Array.isArray(e)?e.map(u=>(i&&t.watch.add(u),Ot(n,u))):(i&&(t.watchAll=!0),n),OU=e=>js(e)||!Khe(e);function Sd(e,t,n=new WeakSet){if(OU(e)||OU(t))return e===t;if(Vp(e)&&Vp(t))return e.getTime()===t.getTime();const i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const u of i){const h=e[u];if(!o.includes(u))return!1;if(u!=="ref"){const p=t[u];if(Vp(h)&&Vp(p)||ta(h)&&ta(p)||Array.isArray(h)&&Array.isArray(p)?!Sd(h,p,n):h!==p)return!1}}return!0}function mHe(e){const t=eI(),{control:n=t.control,name:i,defaultValue:o,disabled:u,exact:h,compute:p}=e||{},g=me.useRef(o),v=me.useRef(p),b=me.useRef(void 0);v.current=p;const E=me.useMemo(()=>n._getWatch(i,g.current),[n,i]),[T,C]=me.useState(v.current?v.current(E):E);return CB(()=>n._subscribe({name:i,formState:{values:!0},exact:h,callback:R=>{if(!u){const N=Jhe(i,n._names,R.values||n._formValues,!1,g.current);if(v.current){const O=v.current(N);Sd(O,b.current)||(C(O),b.current=O)}else C(N)}}}),[n,u,i,h]),me.useEffect(()=>n._removeUnmounted()),T}function gHe(e){const t=eI(),{name:n,disabled:i,control:o=t.control,shouldUnregister:u,defaultValue:h}=e,p=Yhe(o._names.array,n),g=me.useMemo(()=>Ot(o._formValues,n,Ot(o._defaultValues,n,h)),[o,n,h]),v=mHe({control:o,name:n,defaultValue:g,exact:!0}),b=pHe({control:o,name:n,exact:!0}),E=me.useRef(e),T=me.useRef(o.register(n,{...e.rules,value:v,...Vo(e.disabled)?{disabled:e.disabled}:{}}));E.current=e;const C=me.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ot(b.errors,n)},isDirty:{enumerable:!0,get:()=>!!Ot(b.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Ot(b.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Ot(b.validatingFields,n)},error:{enumerable:!0,get:()=>Ot(b.errors,n)}}),[b,n]),R=me.useCallback(j=>T.current.onChange({target:{value:qhe(j),name:n},type:MN.CHANGE}),[n]),N=me.useCallback(()=>T.current.onBlur({target:{value:Ot(o._formValues,n),name:n},type:MN.BLUR}),[n,o._formValues]),O=me.useCallback(j=>{const P=Ot(o._fields,n);P&&j&&(P._f.ref={focus:()=>j.focus&&j.focus(),select:()=>j.select&&j.select(),setCustomValidity:M=>j.setCustomValidity(M),reportValidity:()=>j.reportValidity()})},[o._fields,n]),k=me.useMemo(()=>({name:n,value:v,...Vo(i)||b.disabled?{disabled:b.disabled||i}:{},onChange:R,onBlur:N,ref:O}),[n,i,b.disabled,R,N,O,v]);return me.useEffect(()=>{const j=o._options.shouldUnregister||u;o.register(n,{...E.current.rules,...Vo(E.current.disabled)?{disabled:E.current.disabled}:{}});const P=(M,D)=>{const U=Ot(o._fields,M);U&&U._f&&(U._f.mount=D)};if(P(n,!0),j){const M=Ra(Ot(o._options.defaultValues,n));Ur(o._defaultValues,n,M),Xi(Ot(o._formValues,n))&&Ur(o._formValues,n,M)}return!p&&o.register(n),()=>{(p?j&&!o._state.action:j)?o.unregister(n):P(n,!1)}},[n,o,p,u]),me.useEffect(()=>{o._setDisabledField({disabled:i,name:n})},[i,n,o]),me.useMemo(()=>({field:k,formState:b,fieldState:C}),[k,b,C])}const vHe=e=>e.render(gHe(e));var Zhe=(e,t,n,i,o)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[i]:o||!0}}:{},QE=e=>Array.isArray(e)?e:[e],QQ=()=>{let e=[];return{get observers(){return e},next:o=>{for(const u of e)u.next&&u.next(o)},subscribe:o=>(e.push(o),{unsubscribe:()=>{e=e.filter(u=>u!==o)}}),unsubscribe:()=>{e=[]}}},oo=e=>ta(e)&&!Object.keys(e).length,RB=e=>e.type==="file",Dl=e=>typeof e=="function",UN=e=>{if(!wB)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Qhe=e=>e.type==="select-multiple",NB=e=>e.type==="radio",yHe=e=>NB(e)||qw(e),gL=e=>UN(e)&&e.isConnected;function _He(e,t){const n=t.slice(0,-1).length;let i=0;for(;i<n;)e=Xi(e)?i++:e[t[i++]];return e}function bHe(e){for(const t in e)if(e.hasOwnProperty(t)&&!Xi(e[t]))return!1;return!0}function la(e,t){const n=Array.isArray(t)?t:Q1(t)?[t]:xB(t),i=n.length===1?e:_He(e,n),o=n.length-1,u=n[o];return i&&delete i[u],o!==0&&(ta(i)&&oo(i)||Array.isArray(i)&&bHe(i))&&la(e,n.slice(0,-1)),e}var efe=e=>{for(const t in e)if(Dl(e[t]))return!0;return!1};function FN(e,t={}){const n=Array.isArray(e);if(ta(e)||n)for(const i in e)Array.isArray(e[i])||ta(e[i])&&!efe(e[i])?(t[i]=Array.isArray(e[i])?[]:{},FN(e[i],t[i])):js(e[i])||(t[i]=!0);return t}function tfe(e,t,n){const i=Array.isArray(e);if(ta(e)||i)for(const o in e)Array.isArray(e[o])||ta(e[o])&&!efe(e[o])?Xi(t)||OU(n[o])?n[o]=Array.isArray(e[o])?FN(e[o],[]):{...FN(e[o])}:tfe(e[o],js(t)?{}:t[o],n[o]):n[o]=!Sd(e[o],t[o]);return n}var mE=(e,t)=>tfe(e,t,FN(t));const eee={value:!1,isValid:!1},tee={value:!0,isValid:!0};var nfe=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Xi(e[0].attributes.value)?Xi(e[0].value)||e[0].value===""?tee:{value:e[0].value,isValid:!0}:tee:eee}return eee},rfe=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:i})=>Xi(e)?e:t?e===""?NaN:e&&+e:n&&Au(e)?new Date(e):i?i(e):e;const nee={isValid:!1,value:null};var ife=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,nee):nee;function ree(e){const t=e.ref;return RB(t)?t.files:NB(t)?ife(e.refs).value:Qhe(t)?[...t.selectedOptions].map(({value:n})=>n):qw(t)?nfe(e.refs).value:rfe(Xi(t.value)?e.ref.value:t.value,e)}var EHe=(e,t,n,i)=>{const o={};for(const u of e){const h=Ot(t,u);h&&Ur(o,u,h._f)}return{criteriaMode:n,names:[...e],fields:o,shouldUseNativeValidation:i}},VN=e=>e instanceof RegExp,gE=e=>Xi(e)?e:VN(e)?e.source:ta(e)?VN(e.value)?e.value.source:e.value:e,iee=e=>({isOnSubmit:!e||e===jl.onSubmit,isOnBlur:e===jl.onBlur,isOnChange:e===jl.onChange,isOnAll:e===jl.all,isOnTouch:e===jl.onTouched});const aee="AsyncFunction";var wHe=e=>!!e&&!!e.validate&&!!(Dl(e.validate)&&e.validate.constructor.name===aee||ta(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===aee)),SHe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),see=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const e0=(e,t,n,i)=>{for(const o of n||Object.keys(e)){const u=Ot(e,o);if(u){const{_f:h,...p}=u;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],o)&&!i)return!0;if(h.ref&&t(h.ref,h.name)&&!i)return!0;if(e0(p,t))break}else if(ta(p)&&e0(p,t))break}}};function oee(e,t,n){const i=Ot(e,n);if(i||Q1(n))return{error:i,name:n};const o=n.split(".");for(;o.length;){const u=o.join("."),h=Ot(t,u),p=Ot(e,u);if(h&&!Array.isArray(h)&&n!==u)return{name:n};if(p&&p.type)return{name:u,error:p};if(p&&p.root&&p.root.type)return{name:`${u}.root`,error:p.root};o.pop()}return{name:n}}var xHe=(e,t,n,i)=>{n(e);const{name:o,...u}=e;return oo(u)||Object.keys(u).length>=Object.keys(t).length||Object.keys(u).find(h=>t[h]===(!i||jl.all))},THe=(e,t,n)=>!e||!t||e===t||QE(e).some(i=>i&&(n?i===t:i.startsWith(t)||t.startsWith(i))),CHe=(e,t,n,i,o)=>o.isOnAll?!1:!n&&o.isOnTouch?!(t||e):(n?i.isOnBlur:o.isOnBlur)?!e:(n?i.isOnChange:o.isOnChange)?e:!0,RHe=(e,t)=>!SB(Ot(e,t)).length&&la(e,t),NHe=(e,t,n)=>{const i=QE(Ot(e,n));return Ur(i,"root",t[n]),Ur(e,n,i),e},BR=e=>Au(e);function cee(e,t,n="validate"){if(BR(e)||Array.isArray(e)&&e.every(BR)||Vo(e)&&!e)return{type:n,message:BR(e)?e:"",ref:t}}var cv=e=>ta(e)&&!VN(e)?e:{value:e,message:""},lee=async(e,t,n,i,o,u)=>{const{ref:h,refs:p,required:g,maxLength:v,minLength:b,min:E,max:T,pattern:C,validate:R,name:N,valueAsNumber:O,mount:k}=e._f,j=Ot(n,N);if(!k||t.has(N))return{};const P=p?p[0]:h,M=K=>{o&&P.reportValidity&&(P.setCustomValidity(Vo(K)?"":K||""),P.reportValidity())},D={},U=NB(h),V=qw(h),z=U||V,W=(O||RB(h))&&Xi(h.value)&&Xi(j)||UN(h)&&h.value===""||j===""||Array.isArray(j)&&!j.length,Y=Zhe.bind(null,N,i,D),Q=(K,q,ee,oe=vd.maxLength,ae=vd.minLength)=>{const J=K?q:ee;D[N]={type:K?oe:ae,message:J,ref:h,...Y(K?oe:ae,J)}};if(u?!Array.isArray(j)||!j.length:g&&(!z&&(W||js(j))||Vo(j)&&!j||V&&!nfe(p).isValid||U&&!ife(p).isValid)){const{value:K,message:q}=BR(g)?{value:!!g,message:g}:cv(g);if(K&&(D[N]={type:vd.required,message:q,ref:P,...Y(vd.required,q)},!i))return M(q),D}if(!W&&(!js(E)||!js(T))){let K,q;const ee=cv(T),oe=cv(E);if(!js(j)&&!isNaN(j)){const ae=h.valueAsNumber||j&&+j;js(ee.value)||(K=ae>ee.value),js(oe.value)||(q=ae<oe.value)}else{const ae=h.valueAsDate||new Date(j),J=de=>new Date(new Date().toDateString()+" "+de),re=h.type=="time",X=h.type=="week";Au(ee.value)&&j&&(K=re?J(j)>J(ee.value):X?j>ee.value:ae>new Date(ee.value)),Au(oe.value)&&j&&(q=re?J(j)<J(oe.value):X?j<oe.value:ae<new Date(oe.value))}if((K||q)&&(Q(!!K,ee.message,oe.message,vd.max,vd.min),!i))return M(D[N].message),D}if((v||b)&&!W&&(Au(j)||u&&Array.isArray(j))){const K=cv(v),q=cv(b),ee=!js(K.value)&&j.length>+K.value,oe=!js(q.value)&&j.length<+q.value;if((ee||oe)&&(Q(ee,K.message,q.message),!i))return M(D[N].message),D}if(C&&!W&&Au(j)){const{value:K,message:q}=cv(C);if(VN(K)&&!j.match(K)&&(D[N]={type:vd.pattern,message:q,ref:h,...Y(vd.pattern,q)},!i))return M(q),D}if(R){if(Dl(R)){const K=await R(j,n),q=cee(K,P);if(q&&(D[N]={...q,...Y(vd.validate,q.message)},!i))return M(q.message),D}else if(ta(R)){let K={};for(const q in R){if(!oo(K)&&!i)break;const ee=cee(await R[q](j,n),P,q);ee&&(K={...ee,...Y(q,ee.message)},M(ee.message),i&&(D[N]=K))}if(!oo(K)&&(D[N]={ref:P,...K},!i))return D}}return M(!0),D};const AHe={mode:jl.onSubmit,reValidateMode:jl.onChange,shouldFocusError:!0};function IHe(e={}){let t={...AHe,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Dl(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},o=ta(t.defaultValues)||ta(t.values)?Ra(t.defaultValues||t.values)||{}:{},u=t.shouldUnregister?{}:Ra(o),h={action:!1,mount:!1,watch:!1},p={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},g,v=0;const b={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let E={...b};const T={array:QQ(),state:QQ()},C=t.criteriaMode===jl.all,R=ve=>Ie=>{clearTimeout(v),v=setTimeout(ve,Ie)},N=async ve=>{if(!t.disabled&&(b.isValid||E.isValid||ve)){const Ie=t.resolver?oo((await V()).errors):await W(i,!0);Ie!==n.isValid&&T.state.next({isValid:Ie})}},O=(ve,Ie)=>{!t.disabled&&(b.isValidating||b.validatingFields||E.isValidating||E.validatingFields)&&((ve||Array.from(p.mount)).forEach($e=>{$e&&(Ie?Ur(n.validatingFields,$e,Ie):la(n.validatingFields,$e))}),T.state.next({validatingFields:n.validatingFields,isValidating:!oo(n.validatingFields)}))},k=(ve,Ie=[],$e,gt,at=!0,pt=!0)=>{if(gt&&$e&&!t.disabled){if(h.action=!0,pt&&Array.isArray(Ot(i,ve))){const Ft=$e(Ot(i,ve),gt.argA,gt.argB);at&&Ur(i,ve,Ft)}if(pt&&Array.isArray(Ot(n.errors,ve))){const Ft=$e(Ot(n.errors,ve),gt.argA,gt.argB);at&&Ur(n.errors,ve,Ft),RHe(n.errors,ve)}if((b.touchedFields||E.touchedFields)&&pt&&Array.isArray(Ot(n.touchedFields,ve))){const Ft=$e(Ot(n.touchedFields,ve),gt.argA,gt.argB);at&&Ur(n.touchedFields,ve,Ft)}(b.dirtyFields||E.dirtyFields)&&(n.dirtyFields=mE(o,u)),T.state.next({name:ve,isDirty:Q(ve,Ie),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Ur(u,ve,Ie)},j=(ve,Ie)=>{Ur(n.errors,ve,Ie),T.state.next({errors:n.errors})},P=ve=>{n.errors=ve,T.state.next({errors:n.errors,isValid:!1})},M=(ve,Ie,$e,gt)=>{const at=Ot(i,ve);if(at){const pt=Ot(u,ve,Xi($e)?Ot(o,ve):$e);Xi(pt)||gt&&gt.defaultChecked||Ie?Ur(u,ve,Ie?pt:ree(at._f)):ee(ve,pt),h.mount&&N()}},D=(ve,Ie,$e,gt,at)=>{let pt=!1,Ft=!1;const vn={name:ve};if(!t.disabled){if(!$e||gt){(b.isDirty||E.isDirty)&&(Ft=n.isDirty,n.isDirty=vn.isDirty=Q(),pt=Ft!==vn.isDirty);const cr=Sd(Ot(o,ve),Ie);Ft=!!Ot(n.dirtyFields,ve),cr?la(n.dirtyFields,ve):Ur(n.dirtyFields,ve,!0),vn.dirtyFields=n.dirtyFields,pt=pt||(b.dirtyFields||E.dirtyFields)&&Ft!==!cr}if($e){const cr=Ot(n.touchedFields,ve);cr||(Ur(n.touchedFields,ve,$e),vn.touchedFields=n.touchedFields,pt=pt||(b.touchedFields||E.touchedFields)&&cr!==$e)}pt&&at&&T.state.next(vn)}return pt?vn:{}},U=(ve,Ie,$e,gt)=>{const at=Ot(n.errors,ve),pt=(b.isValid||E.isValid)&&Vo(Ie)&&n.isValid!==Ie;if(t.delayError&&$e?(g=R(()=>j(ve,$e)),g(t.delayError)):(clearTimeout(v),g=null,$e?Ur(n.errors,ve,$e):la(n.errors,ve)),($e?!Sd(at,$e):at)||!oo(gt)||pt){const Ft={...gt,...pt&&Vo(Ie)?{isValid:Ie}:{},errors:n.errors,name:ve};n={...n,...Ft},T.state.next(Ft)}},V=async ve=>{O(ve,!0);const Ie=await t.resolver(u,t.context,EHe(ve||p.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return O(ve),Ie},z=async ve=>{const{errors:Ie}=await V(ve);if(ve)for(const $e of ve){const gt=Ot(Ie,$e);gt?Ur(n.errors,$e,gt):la(n.errors,$e)}else n.errors=Ie;return Ie},W=async(ve,Ie,$e={valid:!0})=>{for(const gt in ve){const at=ve[gt];if(at){const{_f:pt,...Ft}=at;if(pt){const vn=p.array.has(pt.name),cr=at._f&&wHe(at._f);cr&&b.validatingFields&&O([gt],!0);const ra=await lee(at,p.disabled,u,C,t.shouldUseNativeValidation&&!Ie,vn);if(cr&&b.validatingFields&&O([gt]),ra[pt.name]&&($e.valid=!1,Ie))break;!Ie&&(Ot(ra,pt.name)?vn?NHe(n.errors,ra,pt.name):Ur(n.errors,pt.name,ra[pt.name]):la(n.errors,pt.name))}!oo(Ft)&&await W(Ft,Ie,$e)}}return $e.valid},Y=()=>{for(const ve of p.unMount){const Ie=Ot(i,ve);Ie&&(Ie._f.refs?Ie._f.refs.every($e=>!gL($e)):!gL(Ie._f.ref))&&ze(ve)}p.unMount=new Set},Q=(ve,Ie)=>!t.disabled&&(ve&&Ie&&Ur(u,ve,Ie),!Sd(de(),o)),K=(ve,Ie,$e)=>Jhe(ve,p,{...h.mount?u:Xi(Ie)?o:Au(ve)?{[ve]:Ie}:Ie},$e,Ie),q=ve=>SB(Ot(h.mount?u:o,ve,t.shouldUnregister?Ot(o,ve,[]):[])),ee=(ve,Ie,$e={})=>{const gt=Ot(i,ve);let at=Ie;if(gt){const pt=gt._f;pt&&(!pt.disabled&&Ur(u,ve,rfe(Ie,pt)),at=UN(pt.ref)&&js(Ie)?"":Ie,Qhe(pt.ref)?[...pt.ref.options].forEach(Ft=>Ft.selected=at.includes(Ft.value)):pt.refs?qw(pt.ref)?pt.refs.forEach(Ft=>{(!Ft.defaultChecked||!Ft.disabled)&&(Array.isArray(at)?Ft.checked=!!at.find(vn=>vn===Ft.value):Ft.checked=at===Ft.value||!!at)}):pt.refs.forEach(Ft=>Ft.checked=Ft.value===at):RB(pt.ref)?pt.ref.value="":(pt.ref.value=at,pt.ref.type||T.state.next({name:ve,values:Ra(u)})))}($e.shouldDirty||$e.shouldTouch)&&D(ve,at,$e.shouldTouch,$e.shouldDirty,!0),$e.shouldValidate&&X(ve)},oe=(ve,Ie,$e)=>{for(const gt in Ie){if(!Ie.hasOwnProperty(gt))return;const at=Ie[gt],pt=ve+"."+gt,Ft=Ot(i,pt);(p.array.has(ve)||ta(at)||Ft&&!Ft._f)&&!Vp(at)?oe(pt,at,$e):ee(pt,at,$e)}},ae=(ve,Ie,$e={})=>{const gt=Ot(i,ve),at=p.array.has(ve),pt=Ra(Ie);Ur(u,ve,pt),at?(T.array.next({name:ve,values:Ra(u)}),(b.isDirty||b.dirtyFields||E.isDirty||E.dirtyFields)&&$e.shouldDirty&&T.state.next({name:ve,dirtyFields:mE(o,u),isDirty:Q(ve,pt)})):gt&&!gt._f&&!js(pt)?oe(ve,pt,$e):ee(ve,pt,$e),see(ve,p)&&T.state.next({...n,name:ve}),T.state.next({name:h.mount?ve:void 0,values:Ra(u)})},J=async ve=>{h.mount=!0;const Ie=ve.target;let $e=Ie.name,gt=!0;const at=Ot(i,$e),pt=cr=>{gt=Number.isNaN(cr)||Vp(cr)&&isNaN(cr.getTime())||Sd(cr,Ot(u,$e,cr))},Ft=iee(t.mode),vn=iee(t.reValidateMode);if(at){let cr,ra;const Gs=Ie.type?ree(at._f):qhe(ve),xs=ve.type===MN.BLUR||ve.type===MN.FOCUS_OUT,Ju=!SHe(at._f)&&!t.resolver&&!Ot(n.errors,$e)&&!at._f.deps||CHe(xs,Ot(n.touchedFields,$e),n.isSubmitted,vn,Ft),rc=see($e,p,xs);Ur(u,$e,Gs),xs?(at._f.onBlur&&at._f.onBlur(ve),g&&g(0)):at._f.onChange&&at._f.onChange(ve);const ia=D($e,Gs,xs),Yc=!oo(ia)||rc;if(!xs&&T.state.next({name:$e,type:ve.type,values:Ra(u)}),Ju)return(b.isValid||E.isValid)&&(t.mode==="onBlur"?xs&&N():xs||N()),Yc&&T.state.next({name:$e,...rc?{}:ia});if(!xs&&rc&&T.state.next({...n}),t.resolver){const{errors:Hs}=await V([$e]);if(pt(Gs),gt){const eh=oee(n.errors,i,$e),lt=oee(Hs,i,eh.name||$e);cr=lt.error,$e=lt.name,ra=oo(Hs)}}else O([$e],!0),cr=(await lee(at,p.disabled,u,C,t.shouldUseNativeValidation))[$e],O([$e]),pt(Gs),gt&&(cr?ra=!1:(b.isValid||E.isValid)&&(ra=await W(i,!0)));gt&&(at._f.deps&&X(at._f.deps),U($e,ra,cr,ia))}},re=(ve,Ie)=>{if(Ot(n.errors,Ie)&&ve.focus)return ve.focus(),1},X=async(ve,Ie={})=>{let $e,gt;const at=QE(ve);if(t.resolver){const pt=await z(Xi(ve)?ve:at);$e=oo(pt),gt=ve?!at.some(Ft=>Ot(pt,Ft)):$e}else ve?(gt=(await Promise.all(at.map(async pt=>{const Ft=Ot(i,pt);return await W(Ft&&Ft._f?{[pt]:Ft}:Ft)}))).every(Boolean),!(!gt&&!n.isValid)&&N()):gt=$e=await W(i);return T.state.next({...!Au(ve)||(b.isValid||E.isValid)&&$e!==n.isValid?{}:{name:ve},...t.resolver||!ve?{isValid:$e}:{},errors:n.errors}),Ie.shouldFocus&&!gt&&e0(i,re,ve?at:p.mount),gt},de=ve=>{const Ie={...h.mount?u:o};return Xi(ve)?Ie:Au(ve)?Ot(Ie,ve):ve.map($e=>Ot(Ie,$e))},we=(ve,Ie)=>({invalid:!!Ot((Ie||n).errors,ve),isDirty:!!Ot((Ie||n).dirtyFields,ve),error:Ot((Ie||n).errors,ve),isValidating:!!Ot(n.validatingFields,ve),isTouched:!!Ot((Ie||n).touchedFields,ve)}),ge=ve=>{ve&&QE(ve).forEach(Ie=>la(n.errors,Ie)),T.state.next({errors:ve?n.errors:{}})},Te=(ve,Ie,$e)=>{const gt=(Ot(i,ve,{_f:{}})._f||{}).ref,at=Ot(n.errors,ve)||{},{ref:pt,message:Ft,type:vn,...cr}=at;Ur(n.errors,ve,{...cr,...Ie,ref:gt}),T.state.next({name:ve,errors:n.errors,isValid:!1}),$e&&$e.shouldFocus&&gt&&gt.focus&&gt.focus()},Pe=(ve,Ie)=>Dl(ve)?T.state.subscribe({next:$e=>"values"in $e&&ve(K(void 0,Ie),$e)}):K(ve,Ie,!0),rt=ve=>T.state.subscribe({next:Ie=>{THe(ve.name,Ie.name,ve.exact)&&xHe(Ie,ve.formState||b,St,ve.reRenderRoot)&&ve.callback({values:{...u},...n,...Ie,defaultValues:o})}}).unsubscribe,dt=ve=>(h.mount=!0,E={...E,...ve.formState},rt({...ve,formState:E})),ze=(ve,Ie={})=>{for(const $e of ve?QE(ve):p.mount)p.mount.delete($e),p.array.delete($e),Ie.keepValue||(la(i,$e),la(u,$e)),!Ie.keepError&&la(n.errors,$e),!Ie.keepDirty&&la(n.dirtyFields,$e),!Ie.keepTouched&&la(n.touchedFields,$e),!Ie.keepIsValidating&&la(n.validatingFields,$e),!t.shouldUnregister&&!Ie.keepDefaultValue&&la(o,$e);T.state.next({values:Ra(u)}),T.state.next({...n,...Ie.keepDirty?{isDirty:Q()}:{}}),!Ie.keepIsValid&&N()},vt=({disabled:ve,name:Ie})=>{(Vo(ve)&&h.mount||ve||p.disabled.has(Ie))&&(ve?p.disabled.add(Ie):p.disabled.delete(Ie))},Be=(ve,Ie={})=>{let $e=Ot(i,ve);const gt=Vo(Ie.disabled)||Vo(t.disabled);return Ur(i,ve,{...$e||{},_f:{...$e&&$e._f?$e._f:{ref:{name:ve}},name:ve,mount:!0,...Ie}}),p.mount.add(ve),$e?vt({disabled:Vo(Ie.disabled)?Ie.disabled:t.disabled,name:ve}):M(ve,!0,Ie.value),{...gt?{disabled:Ie.disabled||t.disabled}:{},...t.progressive?{required:!!Ie.required,min:gE(Ie.min),max:gE(Ie.max),minLength:gE(Ie.minLength),maxLength:gE(Ie.maxLength),pattern:gE(Ie.pattern)}:{},name:ve,onChange:J,onBlur:J,ref:at=>{if(at){Be(ve,Ie),$e=Ot(i,ve);const pt=Xi(at.value)&&at.querySelectorAll&&at.querySelectorAll("input,select,textarea")[0]||at,Ft=yHe(pt),vn=$e._f.refs||[];if(Ft?vn.find(cr=>cr===pt):pt===$e._f.ref)return;Ur(i,ve,{_f:{...$e._f,...Ft?{refs:[...vn.filter(gL),pt,...Array.isArray(Ot(o,ve))?[{}]:[]],ref:{type:pt.type,name:ve}}:{ref:pt}}}),M(ve,!1,void 0,pt)}else $e=Ot(i,ve,{}),$e._f&&($e._f.mount=!1),(t.shouldUnregister||Ie.shouldUnregister)&&!(Yhe(p.array,ve)&&h.action)&&p.unMount.add(ve)}}},ot=()=>t.shouldFocusError&&e0(i,re,p.mount),De=ve=>{Vo(ve)&&(T.state.next({disabled:ve}),e0(i,(Ie,$e)=>{const gt=Ot(i,$e);gt&&(Ie.disabled=gt._f.disabled||ve,Array.isArray(gt._f.refs)&&gt._f.refs.forEach(at=>{at.disabled=gt._f.disabled||ve}))},0,!1))},je=(ve,Ie)=>async $e=>{let gt;$e&&($e.preventDefault&&$e.preventDefault(),$e.persist&&$e.persist());let at=Ra(u);if(T.state.next({isSubmitting:!0}),t.resolver){const{errors:pt,values:Ft}=await V();n.errors=pt,at=Ra(Ft)}else await W(i);if(p.disabled.size)for(const pt of p.disabled)la(at,pt);if(la(n.errors,"root"),oo(n.errors)){T.state.next({errors:{}});try{await ve(at,$e)}catch(pt){gt=pt}}else Ie&&await Ie({...n.errors},$e),ot(),setTimeout(ot);if(T.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:oo(n.errors)&&!gt,submitCount:n.submitCount+1,errors:n.errors}),gt)throw gt},Mt=(ve,Ie={})=>{Ot(i,ve)&&(Xi(Ie.defaultValue)?ae(ve,Ra(Ot(o,ve))):(ae(ve,Ie.defaultValue),Ur(o,ve,Ra(Ie.defaultValue))),Ie.keepTouched||la(n.touchedFields,ve),Ie.keepDirty||(la(n.dirtyFields,ve),n.isDirty=Ie.defaultValue?Q(ve,Ra(Ot(o,ve))):Q()),Ie.keepError||(la(n.errors,ve),b.isValid&&N()),T.state.next({...n}))},Ut=(ve,Ie={})=>{const $e=ve?Ra(ve):o,gt=Ra($e),at=oo(ve),pt=at?o:gt;if(Ie.keepDefaultValues||(o=$e),!Ie.keepValues){if(Ie.keepDirtyValues){const Ft=new Set([...p.mount,...Object.keys(mE(o,u))]);for(const vn of Array.from(Ft))Ot(n.dirtyFields,vn)?Ur(pt,vn,Ot(u,vn)):ae(vn,Ot(pt,vn))}else{if(wB&&Xi(ve))for(const Ft of p.mount){const vn=Ot(i,Ft);if(vn&&vn._f){const cr=Array.isArray(vn._f.refs)?vn._f.refs[0]:vn._f.ref;if(UN(cr)){const ra=cr.closest("form");if(ra){ra.reset();break}}}}if(Ie.keepFieldsRef)for(const Ft of p.mount)ae(Ft,Ot(pt,Ft));else i={}}u=t.shouldUnregister?Ie.keepDefaultValues?Ra(o):{}:Ra(pt),T.array.next({values:{...pt}}),T.state.next({values:{...pt}})}p={mount:Ie.keepDirtyValues?p.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!b.isValid||!!Ie.keepIsValid||!!Ie.keepDirtyValues,h.watch=!!t.shouldUnregister,T.state.next({submitCount:Ie.keepSubmitCount?n.submitCount:0,isDirty:at?!1:Ie.keepDirty?n.isDirty:!!(Ie.keepDefaultValues&&!Sd(ve,o)),isSubmitted:Ie.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:at?{}:Ie.keepDirtyValues?Ie.keepDefaultValues&&u?mE(o,u):n.dirtyFields:Ie.keepDefaultValues&&ve?mE(o,ve):Ie.keepDirty?n.dirtyFields:{},touchedFields:Ie.keepTouched?n.touchedFields:{},errors:Ie.keepErrors?n.errors:{},isSubmitSuccessful:Ie.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},fn=(ve,Ie)=>Ut(Dl(ve)?ve(u):ve,Ie),ht=(ve,Ie={})=>{const $e=Ot(i,ve),gt=$e&&$e._f;if(gt){const at=gt.refs?gt.refs[0]:gt.ref;at.focus&&(at.focus(),Ie.shouldSelect&&Dl(at.select)&&at.select())}},St=ve=>{n={...n,...ve}},it={control:{register:Be,unregister:ze,getFieldState:we,handleSubmit:je,setError:Te,_subscribe:rt,_runSchema:V,_focusError:ot,_getWatch:K,_getDirty:Q,_setValid:N,_setFieldArray:k,_setDisabledField:vt,_setErrors:P,_getFieldArray:q,_reset:Ut,_resetDefaultValues:()=>Dl(t.defaultValues)&&t.defaultValues().then(ve=>{fn(ve,t.resetOptions),T.state.next({isLoading:!1})}),_removeUnmounted:Y,_disableForm:De,_subjects:T,_proxyFormState:b,get _fields(){return i},get _formValues(){return u},get _state(){return h},set _state(ve){h=ve},get _defaultValues(){return o},get _names(){return p},set _names(ve){p=ve},get _formState(){return n},get _options(){return t},set _options(ve){t={...t,...ve}}},subscribe:dt,trigger:X,register:Be,handleSubmit:je,watch:Pe,setValue:ae,getValues:de,reset:fn,resetField:Mt,clearErrors:ge,unregister:ze,setError:Te,setFocus:ht,getFieldState:we};return{...it,formControl:it}}function OHe(e={}){const t=me.useRef(void 0),n=me.useRef(void 0),[i,o]=me.useState({isDirty:!1,isValidating:!1,isLoading:Dl(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Dl(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:i},e.defaultValues&&!Dl(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:h,...p}=IHe(e);t.current={...p,formState:i}}const u=t.current.control;return u._options=e,CB(()=>{const h=u._subscribe({formState:u._proxyFormState,callback:()=>o({...u._formState}),reRenderRoot:!0});return o(p=>({...p,isReady:!0})),u._formState.isReady=!0,h},[u]),me.useEffect(()=>u._disableForm(e.disabled),[u,e.disabled]),me.useEffect(()=>{e.mode&&(u._options.mode=e.mode),e.reValidateMode&&(u._options.reValidateMode=e.reValidateMode)},[u,e.mode,e.reValidateMode]),me.useEffect(()=>{e.errors&&(u._setErrors(e.errors),u._focusError())},[u,e.errors]),me.useEffect(()=>{e.shouldUnregister&&u._subjects.state.next({values:u._getWatch()})},[u,e.shouldUnregister]),me.useEffect(()=>{if(u._proxyFormState.isDirty){const h=u._getDirty();h!==i.isDirty&&u._subjects.state.next({isDirty:h})}},[u,i.isDirty]),me.useEffect(()=>{e.values&&!Sd(e.values,n.current)?(u._reset(e.values,{keepFieldsRef:!0,...u._options.resetOptions}),n.current=e.values,o(h=>({...h}))):u._resetDefaultValues()},[u,e.values]),me.useEffect(()=>{u._state.mount||(u._setValid(),u._state.mount=!0),u._state.watch&&(u._state.watch=!1,u._subjects.state.next({...u._formState})),u._removeUnmounted()}),t.current.formState=Xhe(i,u),t.current}var _r;(function(e){e.assertEqual=o=>{};function t(o){}e.assertIs=t;function n(o){throw new Error}e.assertNever=n,e.arrayToEnum=o=>{const u={};for(const h of o)u[h]=h;return u},e.getValidEnumValues=o=>{const u=e.objectKeys(o).filter(p=>typeof o[o[p]]!="number"),h={};for(const p of u)h[p]=o[p];return e.objectValues(h)},e.objectValues=o=>e.objectKeys(o).map(function(u){return o[u]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const u=[];for(const h in o)Object.prototype.hasOwnProperty.call(o,h)&&u.push(h);return u},e.find=(o,u)=>{for(const h of o)if(u(h))return h},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function i(o,u=" | "){return o.map(h=>typeof h=="string"?`'${h}'`:h).join(u)}e.joinValues=i,e.jsonStringifyReplacer=(o,u)=>typeof u=="bigint"?u.toString():u})(_r||(_r={}));var uee;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(uee||(uee={}));const Yt=_r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),$h=e=>{switch(typeof e){case"undefined":return Yt.undefined;case"string":return Yt.string;case"number":return Number.isNaN(e)?Yt.nan:Yt.number;case"boolean":return Yt.boolean;case"function":return Yt.function;case"bigint":return Yt.bigint;case"symbol":return Yt.symbol;case"object":return Array.isArray(e)?Yt.array:e===null?Yt.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Yt.promise:typeof Map<"u"&&e instanceof Map?Yt.map:typeof Set<"u"&&e instanceof Set?Yt.set:typeof Date<"u"&&e instanceof Date?Yt.date:Yt.object;default:return Yt.unknown}},bt=_r.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Gd extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(u){return u.message},i={_errors:[]},o=u=>{for(const h of u.issues)if(h.code==="invalid_union")h.unionErrors.map(o);else if(h.code==="invalid_return_type")o(h.returnTypeError);else if(h.code==="invalid_arguments")o(h.argumentsError);else if(h.path.length===0)i._errors.push(n(h));else{let p=i,g=0;for(;g<h.path.length;){const v=h.path[g];g===h.path.length-1?(p[v]=p[v]||{_errors:[]},p[v]._errors.push(n(h))):p[v]=p[v]||{_errors:[]},p=p[v],g++}}};return o(this),i}static assert(t){if(!(t instanceof Gd))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,_r.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},i=[];for(const o of this.issues)if(o.path.length>0){const u=o.path[0];n[u]=n[u]||[],n[u].push(t(o))}else i.push(t(o));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Gd.create=e=>new Gd(e);const PU=(e,t)=>{let n;switch(e.code){case bt.invalid_type:e.received===Yt.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case bt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,_r.jsonStringifyReplacer)}`;break;case bt.unrecognized_keys:n=`Unrecognized key(s) in object: ${_r.joinValues(e.keys,", ")}`;break;case bt.invalid_union:n="Invalid input";break;case bt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${_r.joinValues(e.options)}`;break;case bt.invalid_enum_value:n=`Invalid enum value. Expected ${_r.joinValues(e.options)}, received '${e.received}'`;break;case bt.invalid_arguments:n="Invalid function arguments";break;case bt.invalid_return_type:n="Invalid function return type";break;case bt.invalid_date:n="Invalid date";break;case bt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:_r.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case bt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case bt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case bt.custom:n="Invalid input";break;case bt.invalid_intersection_types:n="Intersection results could not be merged";break;case bt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case bt.not_finite:n="Number must be finite";break;default:n=t.defaultError,_r.assertNever(e)}return{message:n}};let PHe=PU;function kHe(){return PHe}const jHe=e=>{const{data:t,path:n,errorMaps:i,issueData:o}=e,u=[...n,...o.path||[]],h={...o,path:u};if(o.message!==void 0)return{...o,path:u,message:o.message};let p="";const g=i.filter(v=>!!v).slice().reverse();for(const v of g)p=v(h,{data:t,defaultError:p}).message;return{...o,path:u,message:p}};function $t(e,t){const n=kHe(),i=jHe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===PU?void 0:PU].filter(o=>!!o)});e.common.issues.push(i)}class Zo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const i=[];for(const o of n){if(o.status==="aborted")return Rn;o.status==="dirty"&&t.dirty(),i.push(o.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,n){const i=[];for(const o of n){const u=await o.key,h=await o.value;i.push({key:u,value:h})}return Zo.mergeObjectSync(t,i)}static mergeObjectSync(t,n){const i={};for(const o of n){const{key:u,value:h}=o;if(u.status==="aborted"||h.status==="aborted")return Rn;u.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),u.value!=="__proto__"&&(typeof h.value<"u"||o.alwaysSet)&&(i[u.value]=h.value)}return{status:t.value,value:i}}}const Rn=Object.freeze({status:"aborted"}),FE=e=>({status:"dirty",value:e}),zc=e=>({status:"valid",value:e}),dee=e=>e.status==="aborted",hee=e=>e.status==="dirty",gy=e=>e.status==="valid",BN=e=>typeof Promise<"u"&&e instanceof Promise;var Xt;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Xt||(Xt={}));class Tf{constructor(t,n,i,o){this._cachedPath=[],this.parent=t,this.data=n,this._path=i,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const fee=(e,t)=>{if(gy(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Gd(e.common.issues);return this._error=n,this._error}}};function qn(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:o}=e;if(t&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(h,p)=>{const{message:g}=e;return h.code==="invalid_enum_value"?{message:g??p.defaultError}:typeof p.data>"u"?{message:g??i??p.defaultError}:h.code!=="invalid_type"?{message:p.defaultError}:{message:g??n??p.defaultError}},description:o}}class mr{get description(){return this._def.description}_getType(t){return $h(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:$h(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Zo,ctx:{common:t.parent.common,data:t.data,parsedType:$h(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(BN(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const i=this.safeParse(t,n);if(i.success)return i.data;throw i.error}safeParse(t,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$h(t)},o=this._parseSync({data:t,path:i.path,parent:i});return fee(i,o)}"~validate"(t){var i,o;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$h(t)};if(!this["~standard"].async)try{const u=this._parseSync({data:t,path:[],parent:n});return gy(u)?{value:u.value}:{issues:n.common.issues}}catch(u){(o=(i=u==null?void 0:u.message)==null?void 0:i.toLowerCase())!=null&&o.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(u=>gy(u)?{value:u.value}:{issues:n.common.issues})}async parseAsync(t,n){const i=await this.safeParseAsync(t,n);if(i.success)return i.data;throw i.error}async safeParseAsync(t,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$h(t)},o=this._parse({data:t,path:i.path,parent:i}),u=await(BN(o)?o:Promise.resolve(o));return fee(i,u)}refine(t,n){const i=o=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(o):n;return this._refinement((o,u)=>{const h=t(o),p=()=>u.addIssue({code:bt.custom,...i(o)});return typeof Promise<"u"&&h instanceof Promise?h.then(g=>g?!0:(p(),!1)):h?!0:(p(),!1)})}refinement(t,n){return this._refinement((i,o)=>t(i)?!0:(o.addIssue(typeof n=="function"?n(i,o):n),!1))}_refinement(t){return new yy({schema:this,typeName:Nn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return gf.create(this,this._def)}nullable(){return _y.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Du.create(this)}promise(){return HN.create(this,this._def)}or(t){return WN.create([this,t],this._def)}and(t){return GN.create(this,t,this._def)}transform(t){return new yy({...qn(this._def),schema:this,typeName:Nn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new jU({...qn(this._def),innerType:this,defaultValue:n,typeName:Nn.ZodDefault})}brand(){return new rze({typeName:Nn.ZodBranded,type:this,...qn(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new DU({...qn(this._def),innerType:this,catchValue:n,typeName:Nn.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return AB.create(this,t)}readonly(){return LU.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const DHe=/^c[^\s-]{8,}$/i,LHe=/^[0-9a-z]+$/,MHe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,UHe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,FHe=/^[a-z0-9_-]{21}$/i,VHe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,BHe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$He=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,WHe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vL;const GHe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,HHe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,zHe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,KHe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,qHe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,YHe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,afe="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",XHe=new RegExp(`^${afe}$`);function sfe(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function JHe(e){return new RegExp(`^${sfe(e)}$`)}function ZHe(e){let t=`${afe}T${sfe(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function QHe(e,t){return!!((t==="v4"||!t)&&GHe.test(e)||(t==="v6"||!t)&&zHe.test(e))}function eze(e,t){if(!VHe.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(i));return!(typeof o!="object"||o===null||"typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||t&&o.alg!==t)}catch{return!1}}function tze(e,t){return!!((t==="v4"||!t)&&HHe.test(e)||(t==="v6"||!t)&&KHe.test(e))}class rf extends mr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Yt.string){const u=this._getOrReturnCtx(t);return $t(u,{code:bt.invalid_type,expected:Yt.string,received:u.parsedType}),Rn}const i=new Zo;let o;for(const u of this._def.checks)if(u.kind==="min")t.data.length<u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="max")t.data.length>u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="length"){const h=t.data.length>u.value,p=t.data.length<u.value;(h||p)&&(o=this._getOrReturnCtx(t,o),h?$t(o,{code:bt.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):p&&$t(o,{code:bt.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),i.dirty())}else if(u.kind==="email")$He.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"email",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="emoji")vL||(vL=new RegExp(WHe,"u")),vL.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"emoji",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="uuid")UHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"uuid",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="nanoid")FHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"nanoid",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid")DHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"cuid",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid2")LHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"cuid2",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="ulid")MHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"ulid",code:bt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="url")try{new URL(t.data)}catch{o=this._getOrReturnCtx(t,o),$t(o,{validation:"url",code:bt.invalid_string,message:u.message}),i.dirty()}else u.kind==="regex"?(u.regex.lastIndex=0,u.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"regex",code:bt.invalid_string,message:u.message}),i.dirty())):u.kind==="trim"?t.data=t.data.trim():u.kind==="includes"?t.data.includes(u.value,u.position)||(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),i.dirty()):u.kind==="toLowerCase"?t.data=t.data.toLowerCase():u.kind==="toUpperCase"?t.data=t.data.toUpperCase():u.kind==="startsWith"?t.data.startsWith(u.value)||(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.invalid_string,validation:{startsWith:u.value},message:u.message}),i.dirty()):u.kind==="endsWith"?t.data.endsWith(u.value)||(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.invalid_string,validation:{endsWith:u.value},message:u.message}),i.dirty()):u.kind==="datetime"?ZHe(u).test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.invalid_string,validation:"datetime",message:u.message}),i.dirty()):u.kind==="date"?XHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.invalid_string,validation:"date",message:u.message}),i.dirty()):u.kind==="time"?JHe(u).test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.invalid_string,validation:"time",message:u.message}),i.dirty()):u.kind==="duration"?BHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"duration",code:bt.invalid_string,message:u.message}),i.dirty()):u.kind==="ip"?QHe(t.data,u.version)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"ip",code:bt.invalid_string,message:u.message}),i.dirty()):u.kind==="jwt"?eze(t.data,u.alg)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"jwt",code:bt.invalid_string,message:u.message}),i.dirty()):u.kind==="cidr"?tze(t.data,u.version)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"cidr",code:bt.invalid_string,message:u.message}),i.dirty()):u.kind==="base64"?qHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"base64",code:bt.invalid_string,message:u.message}),i.dirty()):u.kind==="base64url"?YHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"base64url",code:bt.invalid_string,message:u.message}),i.dirty()):_r.assertNever(u);return{status:i.value,value:t.data}}_regex(t,n,i){return this.refinement(o=>t.test(o),{validation:n,code:bt.invalid_string,...Xt.errToObj(i)})}_addCheck(t){return new rf({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Xt.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Xt.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Xt.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Xt.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Xt.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Xt.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Xt.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Xt.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Xt.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Xt.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Xt.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Xt.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Xt.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Xt.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Xt.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Xt.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Xt.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Xt.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Xt.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Xt.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Xt.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Xt.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Xt.errToObj(n)})}nonempty(t){return this.min(1,Xt.errToObj(t))}trim(){return new rf({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new rf({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new rf({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}rf.create=e=>new rf({checks:[],typeName:Nn.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...qn(e)});function nze(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,o=n>i?n:i,u=Number.parseInt(e.toFixed(o).replace(".","")),h=Number.parseInt(t.toFixed(o).replace(".",""));return u%h/10**o}class U0 extends mr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Yt.number){const u=this._getOrReturnCtx(t);return $t(u,{code:bt.invalid_type,expected:Yt.number,received:u.parsedType}),Rn}let i;const o=new Zo;for(const u of this._def.checks)u.kind==="int"?_r.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.invalid_type,expected:"integer",received:"float",message:u.message}),o.dirty()):u.kind==="min"?(u.inclusive?t.data<u.value:t.data<=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.too_small,minimum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),o.dirty()):u.kind==="max"?(u.inclusive?t.data>u.value:t.data>=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.too_big,maximum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),o.dirty()):u.kind==="multipleOf"?nze(t.data,u.value)!==0&&(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.not_multiple_of,multipleOf:u.value,message:u.message}),o.dirty()):u.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.not_finite,message:u.message}),o.dirty()):_r.assertNever(u);return{status:o.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Xt.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Xt.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Xt.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Xt.toString(n))}setLimit(t,n,i,o){return new U0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:i,message:Xt.toString(o)}]})}_addCheck(t){return new U0({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Xt.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Xt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Xt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Xt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Xt.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Xt.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Xt.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Xt.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Xt.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&_r.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(n)&&Number.isFinite(t)}}U0.create=e=>new U0({checks:[],typeName:Nn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...qn(e)});class F0 extends mr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Yt.bigint)return this._getInvalidInput(t);let i;const o=new Zo;for(const u of this._def.checks)u.kind==="min"?(u.inclusive?t.data<u.value:t.data<=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.too_small,type:"bigint",minimum:u.value,inclusive:u.inclusive,message:u.message}),o.dirty()):u.kind==="max"?(u.inclusive?t.data>u.value:t.data>=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.too_big,type:"bigint",maximum:u.value,inclusive:u.inclusive,message:u.message}),o.dirty()):u.kind==="multipleOf"?t.data%u.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:bt.not_multiple_of,multipleOf:u.value,message:u.message}),o.dirty()):_r.assertNever(u);return{status:o.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return $t(n,{code:bt.invalid_type,expected:Yt.bigint,received:n.parsedType}),Rn}gte(t,n){return this.setLimit("min",t,!0,Xt.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Xt.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Xt.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Xt.toString(n))}setLimit(t,n,i,o){return new F0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:i,message:Xt.toString(o)}]})}_addCheck(t){return new F0({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Xt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Xt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Xt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Xt.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Xt.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}F0.create=e=>new F0({checks:[],typeName:Nn.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...qn(e)});class pee extends mr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Yt.boolean){const i=this._getOrReturnCtx(t);return $t(i,{code:bt.invalid_type,expected:Yt.boolean,received:i.parsedType}),Rn}return zc(t.data)}}pee.create=e=>new pee({typeName:Nn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...qn(e)});class $N extends mr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Yt.date){const u=this._getOrReturnCtx(t);return $t(u,{code:bt.invalid_type,expected:Yt.date,received:u.parsedType}),Rn}if(Number.isNaN(t.data.getTime())){const u=this._getOrReturnCtx(t);return $t(u,{code:bt.invalid_date}),Rn}const i=new Zo;let o;for(const u of this._def.checks)u.kind==="min"?t.data.getTime()<u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.too_small,message:u.message,inclusive:!0,exact:!1,minimum:u.value,type:"date"}),i.dirty()):u.kind==="max"?t.data.getTime()>u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:bt.too_big,message:u.message,inclusive:!0,exact:!1,maximum:u.value,type:"date"}),i.dirty()):_r.assertNever(u);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new $N({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Xt.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Xt.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}$N.create=e=>new $N({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Nn.ZodDate,...qn(e)});class mee extends mr{_parse(t){if(this._getType(t)!==Yt.symbol){const i=this._getOrReturnCtx(t);return $t(i,{code:bt.invalid_type,expected:Yt.symbol,received:i.parsedType}),Rn}return zc(t.data)}}mee.create=e=>new mee({typeName:Nn.ZodSymbol,...qn(e)});class gee extends mr{_parse(t){if(this._getType(t)!==Yt.undefined){const i=this._getOrReturnCtx(t);return $t(i,{code:bt.invalid_type,expected:Yt.undefined,received:i.parsedType}),Rn}return zc(t.data)}}gee.create=e=>new gee({typeName:Nn.ZodUndefined,...qn(e)});class vee extends mr{_parse(t){if(this._getType(t)!==Yt.null){const i=this._getOrReturnCtx(t);return $t(i,{code:bt.invalid_type,expected:Yt.null,received:i.parsedType}),Rn}return zc(t.data)}}vee.create=e=>new vee({typeName:Nn.ZodNull,...qn(e)});class yee extends mr{constructor(){super(...arguments),this._any=!0}_parse(t){return zc(t.data)}}yee.create=e=>new yee({typeName:Nn.ZodAny,...qn(e)});class _ee extends mr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return zc(t.data)}}_ee.create=e=>new _ee({typeName:Nn.ZodUnknown,...qn(e)});class Cf extends mr{_parse(t){const n=this._getOrReturnCtx(t);return $t(n,{code:bt.invalid_type,expected:Yt.never,received:n.parsedType}),Rn}}Cf.create=e=>new Cf({typeName:Nn.ZodNever,...qn(e)});class bee extends mr{_parse(t){if(this._getType(t)!==Yt.undefined){const i=this._getOrReturnCtx(t);return $t(i,{code:bt.invalid_type,expected:Yt.void,received:i.parsedType}),Rn}return zc(t.data)}}bee.create=e=>new bee({typeName:Nn.ZodVoid,...qn(e)});class Du extends mr{_parse(t){const{ctx:n,status:i}=this._processInputParams(t),o=this._def;if(n.parsedType!==Yt.array)return $t(n,{code:bt.invalid_type,expected:Yt.array,received:n.parsedType}),Rn;if(o.exactLength!==null){const h=n.data.length>o.exactLength.value,p=n.data.length<o.exactLength.value;(h||p)&&($t(n,{code:h?bt.too_big:bt.too_small,minimum:p?o.exactLength.value:void 0,maximum:h?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),i.dirty())}if(o.minLength!==null&&n.data.length<o.minLength.value&&($t(n,{code:bt.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),i.dirty()),o.maxLength!==null&&n.data.length>o.maxLength.value&&($t(n,{code:bt.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((h,p)=>o.type._parseAsync(new Tf(n,h,n.path,p)))).then(h=>Zo.mergeArray(i,h));const u=[...n.data].map((h,p)=>o.type._parseSync(new Tf(n,h,n.path,p)));return Zo.mergeArray(i,u)}get element(){return this._def.type}min(t,n){return new Du({...this._def,minLength:{value:t,message:Xt.toString(n)}})}max(t,n){return new Du({...this._def,maxLength:{value:t,message:Xt.toString(n)}})}length(t,n){return new Du({...this._def,exactLength:{value:t,message:Xt.toString(n)}})}nonempty(t){return this.min(1,t)}}Du.create=(e,t)=>new Du({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Nn.ZodArray,...qn(t)});function gv(e){if(e instanceof da){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=gf.create(gv(i))}return new da({...e._def,shape:()=>t})}else return e instanceof Du?new Du({...e._def,type:gv(e.element)}):e instanceof gf?gf.create(gv(e.unwrap())):e instanceof _y?_y.create(gv(e.unwrap())):e instanceof dm?dm.create(e.items.map(t=>gv(t))):e}class da extends mr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=_r.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==Yt.object){const v=this._getOrReturnCtx(t);return $t(v,{code:bt.invalid_type,expected:Yt.object,received:v.parsedType}),Rn}const{status:i,ctx:o}=this._processInputParams(t),{shape:u,keys:h}=this._getCached(),p=[];if(!(this._def.catchall instanceof Cf&&this._def.unknownKeys==="strip"))for(const v in o.data)h.includes(v)||p.push(v);const g=[];for(const v of h){const b=u[v],E=o.data[v];g.push({key:{status:"valid",value:v},value:b._parse(new Tf(o,E,o.path,v)),alwaysSet:v in o.data})}if(this._def.catchall instanceof Cf){const v=this._def.unknownKeys;if(v==="passthrough")for(const b of p)g.push({key:{status:"valid",value:b},value:{status:"valid",value:o.data[b]}});else if(v==="strict")p.length>0&&($t(o,{code:bt.unrecognized_keys,keys:p}),i.dirty());else if(v!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const v=this._def.catchall;for(const b of p){const E=o.data[b];g.push({key:{status:"valid",value:b},value:v._parse(new Tf(o,E,o.path,b)),alwaysSet:b in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const v=[];for(const b of g){const E=await b.key,T=await b.value;v.push({key:E,value:T,alwaysSet:b.alwaysSet})}return v}).then(v=>Zo.mergeObjectSync(i,v)):Zo.mergeObjectSync(i,g)}get shape(){return this._def.shape()}strict(t){return Xt.errToObj,new da({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,i)=>{var u,h;const o=((h=(u=this._def).errorMap)==null?void 0:h.call(u,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:Xt.errToObj(t).message??o}:{message:o}}}:{}})}strip(){return new da({...this._def,unknownKeys:"strip"})}passthrough(){return new da({...this._def,unknownKeys:"passthrough"})}extend(t){return new da({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new da({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Nn.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new da({...this._def,catchall:t})}pick(t){const n={};for(const i of _r.objectKeys(t))t[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new da({...this._def,shape:()=>n})}omit(t){const n={};for(const i of _r.objectKeys(this.shape))t[i]||(n[i]=this.shape[i]);return new da({...this._def,shape:()=>n})}deepPartial(){return gv(this)}partial(t){const n={};for(const i of _r.objectKeys(this.shape)){const o=this.shape[i];t&&!t[i]?n[i]=o:n[i]=o.optional()}return new da({...this._def,shape:()=>n})}required(t){const n={};for(const i of _r.objectKeys(this.shape))if(t&&!t[i])n[i]=this.shape[i];else{let u=this.shape[i];for(;u instanceof gf;)u=u._def.innerType;n[i]=u}return new da({...this._def,shape:()=>n})}keyof(){return ofe(_r.objectKeys(this.shape))}}da.create=(e,t)=>new da({shape:()=>e,unknownKeys:"strip",catchall:Cf.create(),typeName:Nn.ZodObject,...qn(t)});da.strictCreate=(e,t)=>new da({shape:()=>e,unknownKeys:"strict",catchall:Cf.create(),typeName:Nn.ZodObject,...qn(t)});da.lazycreate=(e,t)=>new da({shape:e,unknownKeys:"strip",catchall:Cf.create(),typeName:Nn.ZodObject,...qn(t)});class WN extends mr{_parse(t){const{ctx:n}=this._processInputParams(t),i=this._def.options;function o(u){for(const p of u)if(p.result.status==="valid")return p.result;for(const p of u)if(p.result.status==="dirty")return n.common.issues.push(...p.ctx.common.issues),p.result;const h=u.map(p=>new Gd(p.ctx.common.issues));return $t(n,{code:bt.invalid_union,unionErrors:h}),Rn}if(n.common.async)return Promise.all(i.map(async u=>{const h={...n,common:{...n.common,issues:[]},parent:null};return{result:await u._parseAsync({data:n.data,path:n.path,parent:h}),ctx:h}})).then(o);{let u;const h=[];for(const g of i){const v={...n,common:{...n.common,issues:[]},parent:null},b=g._parseSync({data:n.data,path:n.path,parent:v});if(b.status==="valid")return b;b.status==="dirty"&&!u&&(u={result:b,ctx:v}),v.common.issues.length&&h.push(v.common.issues)}if(u)return n.common.issues.push(...u.ctx.common.issues),u.result;const p=h.map(g=>new Gd(g));return $t(n,{code:bt.invalid_union,unionErrors:p}),Rn}}get options(){return this._def.options}}WN.create=(e,t)=>new WN({options:e,typeName:Nn.ZodUnion,...qn(t)});function kU(e,t){const n=$h(e),i=$h(t);if(e===t)return{valid:!0,data:e};if(n===Yt.object&&i===Yt.object){const o=_r.objectKeys(t),u=_r.objectKeys(e).filter(p=>o.indexOf(p)!==-1),h={...e,...t};for(const p of u){const g=kU(e[p],t[p]);if(!g.valid)return{valid:!1};h[p]=g.data}return{valid:!0,data:h}}else if(n===Yt.array&&i===Yt.array){if(e.length!==t.length)return{valid:!1};const o=[];for(let u=0;u<e.length;u++){const h=e[u],p=t[u],g=kU(h,p);if(!g.valid)return{valid:!1};o.push(g.data)}return{valid:!0,data:o}}else return n===Yt.date&&i===Yt.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class GN extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t),o=(u,h)=>{if(dee(u)||dee(h))return Rn;const p=kU(u.value,h.value);return p.valid?((hee(u)||hee(h))&&n.dirty(),{status:n.value,value:p.data}):($t(i,{code:bt.invalid_intersection_types}),Rn)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([u,h])=>o(u,h)):o(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}GN.create=(e,t,n)=>new GN({left:e,right:t,typeName:Nn.ZodIntersection,...qn(n)});class dm extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.parsedType!==Yt.array)return $t(i,{code:bt.invalid_type,expected:Yt.array,received:i.parsedType}),Rn;if(i.data.length<this._def.items.length)return $t(i,{code:bt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Rn;!this._def.rest&&i.data.length>this._def.items.length&&($t(i,{code:bt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const u=[...i.data].map((h,p)=>{const g=this._def.items[p]||this._def.rest;return g?g._parse(new Tf(i,h,i.path,p)):null}).filter(h=>!!h);return i.common.async?Promise.all(u).then(h=>Zo.mergeArray(n,h)):Zo.mergeArray(n,u)}get items(){return this._def.items}rest(t){return new dm({...this._def,rest:t})}}dm.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new dm({items:e,typeName:Nn.ZodTuple,rest:null,...qn(t)})};class Eee extends mr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.parsedType!==Yt.map)return $t(i,{code:bt.invalid_type,expected:Yt.map,received:i.parsedType}),Rn;const o=this._def.keyType,u=this._def.valueType,h=[...i.data.entries()].map(([p,g],v)=>({key:o._parse(new Tf(i,p,i.path,[v,"key"])),value:u._parse(new Tf(i,g,i.path,[v,"value"]))}));if(i.common.async){const p=new Map;return Promise.resolve().then(async()=>{for(const g of h){const v=await g.key,b=await g.value;if(v.status==="aborted"||b.status==="aborted")return Rn;(v.status==="dirty"||b.status==="dirty")&&n.dirty(),p.set(v.value,b.value)}return{status:n.value,value:p}})}else{const p=new Map;for(const g of h){const v=g.key,b=g.value;if(v.status==="aborted"||b.status==="aborted")return Rn;(v.status==="dirty"||b.status==="dirty")&&n.dirty(),p.set(v.value,b.value)}return{status:n.value,value:p}}}}Eee.create=(e,t,n)=>new Eee({valueType:t,keyType:e,typeName:Nn.ZodMap,...qn(n)});class V0 extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.parsedType!==Yt.set)return $t(i,{code:bt.invalid_type,expected:Yt.set,received:i.parsedType}),Rn;const o=this._def;o.minSize!==null&&i.data.size<o.minSize.value&&($t(i,{code:bt.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),n.dirty()),o.maxSize!==null&&i.data.size>o.maxSize.value&&($t(i,{code:bt.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),n.dirty());const u=this._def.valueType;function h(g){const v=new Set;for(const b of g){if(b.status==="aborted")return Rn;b.status==="dirty"&&n.dirty(),v.add(b.value)}return{status:n.value,value:v}}const p=[...i.data.values()].map((g,v)=>u._parse(new Tf(i,g,i.path,v)));return i.common.async?Promise.all(p).then(g=>h(g)):h(p)}min(t,n){return new V0({...this._def,minSize:{value:t,message:Xt.toString(n)}})}max(t,n){return new V0({...this._def,maxSize:{value:t,message:Xt.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}V0.create=(e,t)=>new V0({valueType:e,minSize:null,maxSize:null,typeName:Nn.ZodSet,...qn(t)});class wee extends mr{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}wee.create=(e,t)=>new wee({getter:e,typeName:Nn.ZodLazy,...qn(t)});class See extends mr{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return $t(n,{received:n.data,code:bt.invalid_literal,expected:this._def.value}),Rn}return{status:"valid",value:t.data}}get value(){return this._def.value}}See.create=(e,t)=>new See({value:e,typeName:Nn.ZodLiteral,...qn(t)});function ofe(e,t){return new vy({values:e,typeName:Nn.ZodEnum,...qn(t)})}class vy extends mr{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),i=this._def.values;return $t(n,{expected:_r.joinValues(i),received:n.parsedType,code:bt.invalid_type}),Rn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),i=this._def.values;return $t(n,{received:n.data,code:bt.invalid_enum_value,options:i}),Rn}return zc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return vy.create(t,{...this._def,...n})}exclude(t,n=this._def){return vy.create(this.options.filter(i=>!t.includes(i)),{...this._def,...n})}}vy.create=ofe;class xee extends mr{_parse(t){const n=_r.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==Yt.string&&i.parsedType!==Yt.number){const o=_r.objectValues(n);return $t(i,{expected:_r.joinValues(o),received:i.parsedType,code:bt.invalid_type}),Rn}if(this._cache||(this._cache=new Set(_r.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const o=_r.objectValues(n);return $t(i,{received:i.data,code:bt.invalid_enum_value,options:o}),Rn}return zc(t.data)}get enum(){return this._def.values}}xee.create=(e,t)=>new xee({values:e,typeName:Nn.ZodNativeEnum,...qn(t)});class HN extends mr{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Yt.promise&&n.common.async===!1)return $t(n,{code:bt.invalid_type,expected:Yt.promise,received:n.parsedType}),Rn;const i=n.parsedType===Yt.promise?n.data:Promise.resolve(n.data);return zc(i.then(o=>this._def.type.parseAsync(o,{path:n.path,errorMap:n.common.contextualErrorMap})))}}HN.create=(e,t)=>new HN({type:e,typeName:Nn.ZodPromise,...qn(t)});class yy extends mr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Nn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:i}=this._processInputParams(t),o=this._def.effect||null,u={addIssue:h=>{$t(i,h),h.fatal?n.abort():n.dirty()},get path(){return i.path}};if(u.addIssue=u.addIssue.bind(u),o.type==="preprocess"){const h=o.transform(i.data,u);if(i.common.async)return Promise.resolve(h).then(async p=>{if(n.value==="aborted")return Rn;const g=await this._def.schema._parseAsync({data:p,path:i.path,parent:i});return g.status==="aborted"?Rn:g.status==="dirty"||n.value==="dirty"?FE(g.value):g});{if(n.value==="aborted")return Rn;const p=this._def.schema._parseSync({data:h,path:i.path,parent:i});return p.status==="aborted"?Rn:p.status==="dirty"||n.value==="dirty"?FE(p.value):p}}if(o.type==="refinement"){const h=p=>{const g=o.refinement(p,u);if(i.common.async)return Promise.resolve(g);if(g instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return p};if(i.common.async===!1){const p=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return p.status==="aborted"?Rn:(p.status==="dirty"&&n.dirty(),h(p.value),{status:n.value,value:p.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(p=>p.status==="aborted"?Rn:(p.status==="dirty"&&n.dirty(),h(p.value).then(()=>({status:n.value,value:p.value}))))}if(o.type==="transform")if(i.common.async===!1){const h=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!gy(h))return Rn;const p=o.transform(h.value,u);if(p instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:p}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(h=>gy(h)?Promise.resolve(o.transform(h.value,u)).then(p=>({status:n.value,value:p})):Rn);_r.assertNever(o)}}yy.create=(e,t,n)=>new yy({schema:e,typeName:Nn.ZodEffects,effect:t,...qn(n)});yy.createWithPreprocess=(e,t,n)=>new yy({schema:t,effect:{type:"preprocess",transform:e},typeName:Nn.ZodEffects,...qn(n)});class gf extends mr{_parse(t){return this._getType(t)===Yt.undefined?zc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}gf.create=(e,t)=>new gf({innerType:e,typeName:Nn.ZodOptional,...qn(t)});class _y extends mr{_parse(t){return this._getType(t)===Yt.null?zc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_y.create=(e,t)=>new _y({innerType:e,typeName:Nn.ZodNullable,...qn(t)});class jU extends mr{_parse(t){const{ctx:n}=this._processInputParams(t);let i=n.data;return n.parsedType===Yt.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}jU.create=(e,t)=>new jU({innerType:e,typeName:Nn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...qn(t)});class DU extends mr{_parse(t){const{ctx:n}=this._processInputParams(t),i={...n,common:{...n.common,issues:[]}},o=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return BN(o)?o.then(u=>({status:"valid",value:u.status==="valid"?u.value:this._def.catchValue({get error(){return new Gd(i.common.issues)},input:i.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Gd(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}DU.create=(e,t)=>new DU({innerType:e,typeName:Nn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...qn(t)});class Tee extends mr{_parse(t){if(this._getType(t)!==Yt.nan){const i=this._getOrReturnCtx(t);return $t(i,{code:bt.invalid_type,expected:Yt.nan,received:i.parsedType}),Rn}return{status:"valid",value:t.data}}}Tee.create=e=>new Tee({typeName:Nn.ZodNaN,...qn(e)});class rze extends mr{_parse(t){const{ctx:n}=this._processInputParams(t),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class AB extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const u=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?Rn:u.status==="dirty"?(n.dirty(),FE(u.value)):this._def.out._parseAsync({data:u.value,path:i.path,parent:i})})();{const o=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?Rn:o.status==="dirty"?(n.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:i.path,parent:i})}}static create(t,n){return new AB({in:t,out:n,typeName:Nn.ZodPipeline})}}class LU extends mr{_parse(t){const n=this._def.innerType._parse(t),i=o=>(gy(o)&&(o.value=Object.freeze(o.value)),o);return BN(n)?n.then(o=>i(o)):i(n)}unwrap(){return this._def.innerType}}LU.create=(e,t)=>new LU({innerType:e,typeName:Nn.ZodReadonly,...qn(t)});var Nn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Nn||(Nn={}));const vu=rf.create;Cf.create;Du.create;const ize=da.create;WN.create;GN.create;dm.create;vy.create;HN.create;gf.create;_y.create;const Cee=(e,t,n)=>{if(e&&"reportValidity"in e){const i=Ot(n,t);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},cfe=(e,t)=>{for(const n in t.fields){const i=t.fields[n];i&&i.ref&&"reportValidity"in i.ref?Cee(i.ref,n,e):i.refs&&i.refs.forEach(o=>Cee(o,n,e))}},aze=(e,t)=>{t.shouldUseNativeValidation&&cfe(e,t);const n={};for(const i in e){const o=Ot(t.fields,i),u=Object.assign(e[i]||{},{ref:o&&o.ref});if(sze(t.names||Object.keys(e),i)){const h=Object.assign({},Ot(n,i));Ur(h,"root",u),Ur(n,i,h)}else Ur(n,i,u)}return n},sze=(e,t)=>e.some(n=>n.startsWith(t+"."));var oze=function(e,t){for(var n={};e.length;){var i=e[0],o=i.code,u=i.message,h=i.path.join(".");if(!n[h])if("unionErrors"in i){var p=i.unionErrors[0].errors[0];n[h]={message:p.message,type:p.code}}else n[h]={message:u,type:o};if("unionErrors"in i&&i.unionErrors.forEach(function(b){return b.errors.forEach(function(E){return e.push(E)})}),t){var g=n[h].types,v=g&&g[i.code];n[h]=Zhe(h,t,n,o,v?[].concat(v,i.message):i.message)}e.shift()}return n},cze=function(e,t,n){return n===void 0&&(n={}),function(i,o,u){try{return Promise.resolve(function(h,p){try{var g=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](i,t)).then(function(v){return u.shouldUseNativeValidation&&cfe({},u),{errors:{},values:n.raw?i:v}})}catch(v){return p(v)}return g&&g.then?g.then(void 0,p):g}(0,function(h){if(function(p){return Array.isArray(p==null?void 0:p.errors)}(h))return{values:{},errors:aze(oze(h.errors,!u.shouldUseNativeValidation&&u.criteriaMode==="all"),u)};throw h}))}catch(h){return Promise.reject(h)}}};const lze=fHe,lfe=S.createContext({}),yu=({...e})=>c.jsx(lfe.Provider,{value:{name:e.name},children:c.jsx(vHe,{...e})}),tI=()=>{const e=S.useContext(lfe),t=S.useContext(ufe),{getFieldState:n,formState:i}=eI(),o=n(e.name,i);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:u}=t;return{id:u,name:e.name,formItemId:`${u}-form-item`,formDescriptionId:`${u}-form-item-description`,formMessageId:`${u}-form-item-message`,...o}},ufe=S.createContext({}),bl=S.forwardRef(({className:e,...t},n)=>{const i=S.useId();return c.jsx(ufe.Provider,{value:{id:i},children:c.jsx("div",{ref:n,className:kt("space-y-2",e),...t})})});bl.displayName="FormItem";const El=S.forwardRef(({className:e,...t},n)=>{const{error:i,formItemId:o}=tI();return c.jsx(Je,{ref:n,className:kt(i&&"text-destructive",e),htmlFor:o,...t})});El.displayName="FormLabel";const wl=S.forwardRef(({...e},t)=>{const{error:n,formItemId:i,formDescriptionId:o,formMessageId:u}=tI();return c.jsx(koe,{ref:t,id:i,"aria-describedby":n?`${o} ${u}`:`${o}`,"aria-invalid":!!n,...e})});wl.displayName="FormControl";const uze=S.forwardRef(({className:e,...t},n)=>{const{formDescriptionId:i}=tI();return c.jsx("p",{ref:n,id:i,className:kt("text-sm text-muted-foreground",e),...t})});uze.displayName="FormDescription";const Sl=S.forwardRef(({className:e,children:t,...n},i)=>{const{error:o,formMessageId:u}=tI(),h=o?String(o==null?void 0:o.message):t;return h?c.jsx("p",{ref:i,id:u,className:kt("text-sm font-medium text-destructive",e),...n,children:h}):null});Sl.displayName="FormMessage";const dze=Uw("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function hze({className:e,variant:t,...n}){return c.jsx("div",{className:kt(dze({variant:t}),e),...n})}const BC="https://api.gada.chat",fze=ize({name:vu().min(2,"Name is required"),username:vu().min(3,"Username must be at least 3 characters").regex(/^[a-z0-9._-]+$/i,"Only letters, numbers, dot, underscore, dash"),phone:vu().min(7,"Phone is required").max(20).regex(/^[+0-9 ()-]+$/,"Invalid phone number"),email:vu().email("Invalid email"),state:vu().min(2,"State is required"),residentAddress:vu().min(5,"Address is required"),residentialState:vu().min(2,"Residential state is required"),proposedLocation:vu().min(2,"Proposed location is required"),gadaChatUsername:vu().min(3,"Gada.chat username is required").regex(/^[a-z0-9._-]+$/i,"Only letters, numbers, dot, underscore, dash"),note:vu().min(10,"Please add a short note").max(600,"Max 600 chars")});function Ree(){const{user:e,accessToken:t}=st(),n=wt(t),[i,o]=S.useState(!1),[u,h]=S.useState(!0),[p,g]=S.useState(null),[v,b]=S.useState(!0),[E,T]=S.useState([]),C=S.useRef(!1),R=OHe({resolver:cze(fze),defaultValues:{name:"",username:"",phone:"",email:"",state:"",residentAddress:"",residentialState:"",proposedLocation:"",gadaChatUsername:"",note:""},mode:"onBlur"});S.useEffect(()=>{C.current=!1},[t]),S.useEffect(()=>{if(!t||C.current)return;C.current=!0;const j=new AbortController;return(async()=>{try{h(!0);const P=await fetch(`${BC}/api/pro/activepackage/`,{headers:n,credentials:"include",signal:j.signal});if(P.ok){const U=await P.json();T(U==null?void 0:U.data)}console.log(P,"packagedet");const M=await fetch(`${BC}/api/representatives/me`,{headers:n,credentials:"include",signal:j.signal});if(M.status===404){g(null),b(!0);return}if(!M.ok){const U=await M.json().catch(()=>({}));throw new Error((U==null?void 0:U.error)||"Failed to load application")}const D=await M.json();g(D),R.reset({name:D.name,username:D.username,phone:D.phone,email:D.email,state:D.state,residentAddress:D.residentAddress,residentialState:D.residentialState,proposedLocation:D.proposedLocation,gadaChatUsername:D.gadaChatUsername,note:D.note}),b(!1)}catch(P){if((P==null?void 0:P.name)==="AbortError")return;console.error(P),Ce.error("Could not load representative application.")}finally{h(!1)}})(),()=>j.abort()},[t]);const N=async j=>{try{o(!0);const P=!!p,M=P?`${BC}/api/representatives/me`:`${BC}/api/representatives`,U=await fetch(M,{method:P?"PUT":"POST",headers:{...n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(j)});if(!U.ok){const z=await U.json().catch(()=>({}));throw new Error((z==null?void 0:z.error)||"Failed to save application")}const V=await U.json();g(V),b(!1),Ce.success(P?"Your changes have been saved":"We’ll review and get back to you shortly")}catch(P){Ce.error((P==null?void 0:P.message)??"Please try again")}finally{o(!1)}},O=p!=null&&p.status?c.jsx(hze,{variant:p.status==="approved"?"default":p.status==="rejected"?"destructive":"secondary",className:"capitalize",children:p.status}):null,k=u||i||!v&&!!p;return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"w-full max-w-5xl 2xl:max-w-6xl mx-auto",children:c.jsxs("div",{className:"rounded-xl shadow-sm border bg-white overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-[#7C3AED] via-[#5B6CFA] to-[#1D4ED8] p-6",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-white text-2xl font-bold",children:"Become a Representative"}),c.jsx("p",{className:"text-white/90",children:"Share a few details and the team will reach out if it’s a fit."})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[O,!!p&&c.jsx(be,{type:"button",variant:v?"secondary":"outline",onClick:()=>b(j=>!j),disabled:u||i,className:"bg-white/10 text-white hover:bg-white/20 border-white/20",children:v?"Cancel":"Edit"})]})]})}),c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"mb-6 rounded-lg border border-amber-300 bg-amber-50 p-4",children:c.jsx("p",{className:"text-sm text-amber-900",children:"Only VVIP user can request to be a Representative"})}),c.jsx(lze,{...R,children:c.jsxs("form",{onSubmit:R.handleSubmit(N),className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(yu,{control:R.control,name:"name",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Name"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"Full name",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsx(yu,{control:R.control,name:"username",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Username"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"username",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsx(yu,{control:R.control,name:"phone",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Phone number"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"+234...",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsx(yu,{control:R.control,name:"email",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Email"}),c.jsx(wl,{children:c.jsx(Ne,{type:"email",placeholder:"you@example.com",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsx(yu,{control:R.control,name:"state",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"State"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"e.g., Lagos",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsx(yu,{control:R.control,name:"residentialState",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Residential state"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"e.g., Lagos",...j,disabled:k})}),c.jsx(Sl,{})]})})]}),c.jsx(yu,{control:R.control,name:"residentAddress",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Resident address"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"Street, city, state",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(yu,{control:R.control,name:"proposedLocation",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Proposed location to represent"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"City / area",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsx(yu,{control:R.control,name:"gadaChatUsername",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Gada.chat username"}),c.jsx(wl,{children:c.jsx(Ne,{placeholder:"@yourhandle",...j,disabled:k})}),c.jsx(Sl,{})]})})]}),c.jsx(yu,{control:R.control,name:"note",render:({field:j})=>c.jsxs(bl,{children:[c.jsx(El,{children:"Little note about yourself"}),c.jsx(wl,{children:c.jsx(wi,{placeholder:"Tell us briefly about yourself, experience, and why you’d like to represent.",className:"min-h-[120px] resize-y",...j,disabled:k})}),c.jsx(Sl,{})]})}),c.jsxs("div",{className:"flex justify-end gap-3",children:[!!p&&v&&c.jsx(be,{type:"button",variant:"outline",onClick:()=>{p&&(ti,R.reset({name:p.name,username:p.username,phone:p.phone,email:p.email,state:p.state,residentAddress:p.residentAddress,residentialState:p.residentialState,proposedLocation:p.proposedLocation,gadaChatUsername:p.gadaChatUsername,note:p.note})),b(!1)},disabled:i,children:"Cancel"}),(E==null?void 0:E.packageName)&&(E==null?void 0:E.packageName)=="GADA VVIP"&&c.jsx(be,{type:"submit",disabled:i||!v&&!!p,className:"bg-[#1877F2] hover:bg-[#166FE5]",children:i?"Saving…":p?v?"Save Changes":"Locked":"Submit application"})]})]})}),!!p&&c.jsxs("p",{className:"mt-4 text-xs text-gray-500",children:["Last updated: ",p.updatedAt?new Date(p.updatedAt).toLocaleString():"—"]})]})]})})})]})})]})}var pze=[" ","Enter","ArrowUp","ArrowDown"],mze=[" ","Enter"],hm="Select",[nI,rI,gze]=H4(hm),[o_,lxt]=Vs(hm,[gze,Of]),iI=Of(),[vze,Df]=o_(hm),[yze,_ze]=o_(hm),dfe=e=>{const{__scopeSelect:t,children:n,open:i,defaultOpen:o,onOpenChange:u,value:h,defaultValue:p,onValueChange:g,dir:v,name:b,autoComplete:E,disabled:T,required:C,form:R}=e,N=iI(t),[O,k]=S.useState(null),[j,P]=S.useState(null),[M,D]=S.useState(!1),U=n_(v),[V,z]=$d({prop:i,defaultProp:o??!1,onChange:u,caller:hm}),[W,Y]=$d({prop:h,defaultProp:p,onChange:g,caller:hm}),Q=S.useRef(null),K=O?R||!!O.closest("form"):!0,[q,ee]=S.useState(new Set),oe=Array.from(q).map(ae=>ae.props.value).join(";");return c.jsx(E4,{...N,children:c.jsxs(vze,{required:C,scope:t,trigger:O,onTriggerChange:k,valueNode:j,onValueNodeChange:P,valueNodeHasChildren:M,onValueNodeHasChildrenChange:D,contentId:Vl(),value:W,onValueChange:Y,open:V,onOpenChange:z,dir:U,triggerPointerDownPosRef:Q,disabled:T,children:[c.jsx(nI.Provider,{scope:t,children:c.jsx(yze,{scope:e.__scopeSelect,onNativeOptionAdd:S.useCallback(ae=>{ee(J=>new Set(J).add(ae))},[]),onNativeOptionRemove:S.useCallback(ae=>{ee(J=>{const re=new Set(J);return re.delete(ae),re})},[]),children:n})}),K?c.jsxs(Dfe,{"aria-hidden":!0,required:C,tabIndex:-1,name:b,autoComplete:E,value:W,onChange:ae=>Y(ae.target.value),disabled:T,form:R,children:[W===void 0?c.jsx("option",{value:""}):null,Array.from(q)]},oe):null]})})};dfe.displayName=hm;var hfe="SelectTrigger",ffe=S.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:i=!1,...o}=e,u=iI(n),h=Df(hfe,n),p=h.disabled||i,g=Dn(t,h.onTriggerChange),v=rI(n),b=S.useRef("touch"),[E,T,C]=Mfe(N=>{const O=v().filter(P=>!P.disabled),k=O.find(P=>P.value===h.value),j=Ufe(O,N,k);j!==void 0&&h.onValueChange(j.value)}),R=N=>{p||(h.onOpenChange(!0),C()),N&&(h.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return c.jsx(kw,{asChild:!0,...u,children:c.jsx(en.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:p,"data-disabled":p?"":void 0,"data-placeholder":Lfe(h.value)?"":void 0,...o,ref:g,onClick:Tt(o.onClick,N=>{N.currentTarget.focus(),b.current!=="mouse"&&R(N)}),onPointerDown:Tt(o.onPointerDown,N=>{b.current=N.pointerType;const O=N.target;O.hasPointerCapture(N.pointerId)&&O.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(R(N),N.preventDefault())}),onKeyDown:Tt(o.onKeyDown,N=>{const O=E.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&T(N.key),!(O&&N.key===" ")&&pze.includes(N.key)&&(R(),N.preventDefault())})})})});ffe.displayName=hfe;var pfe="SelectValue",mfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:o,children:u,placeholder:h="",...p}=e,g=Df(pfe,n),{onValueNodeHasChildrenChange:v}=g,b=u!==void 0,E=Dn(t,g.onValueNodeChange);return va(()=>{v(b)},[v,b]),c.jsx(en.span,{...p,ref:E,style:{pointerEvents:"none"},children:Lfe(g.value)?c.jsx(c.Fragment,{children:h}):u})});mfe.displayName=pfe;var bze="SelectIcon",gfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,children:i,...o}=e;return c.jsx(en.span,{"aria-hidden":!0,...o,ref:t,children:i||"▼"})});gfe.displayName=bze;var Eze="SelectPortal",vfe=e=>c.jsx(jw,{asChild:!0,...e});vfe.displayName=Eze;var fm="SelectContent",yfe=S.forwardRef((e,t)=>{const n=Df(fm,e.__scopeSelect),[i,o]=S.useState();if(va(()=>{o(new DocumentFragment)},[]),!n.open){const u=i;return u?wm.createPortal(c.jsx(_fe,{scope:e.__scopeSelect,children:c.jsx(nI.Slot,{scope:e.__scopeSelect,children:c.jsx("div",{children:e.children})})}),u):null}return c.jsx(bfe,{...e,ref:t})});yfe.displayName=fm;var xl=10,[_fe,Lf]=o_(fm),wze="SelectContentImpl",Sze=bf("SelectContent.RemoveScroll"),bfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:u,onPointerDownOutside:h,side:p,sideOffset:g,align:v,alignOffset:b,arrowPadding:E,collisionBoundary:T,collisionPadding:C,sticky:R,hideWhenDetached:N,avoidCollisions:O,...k}=e,j=Df(fm,n),[P,M]=S.useState(null),[D,U]=S.useState(null),V=Dn(t,ze=>M(ze)),[z,W]=S.useState(null),[Y,Q]=S.useState(null),K=rI(n),[q,ee]=S.useState(!1),oe=S.useRef(!1);S.useEffect(()=>{if(P)return N1(P)},[P]),C1();const ae=S.useCallback(ze=>{const[vt,...Be]=K().map(je=>je.ref.current),[ot]=Be.slice(-1),De=document.activeElement;for(const je of ze)if(je===De||(je==null||je.scrollIntoView({block:"nearest"}),je===vt&&D&&(D.scrollTop=0),je===ot&&D&&(D.scrollTop=D.scrollHeight),je==null||je.focus(),document.activeElement!==De))return},[K,D]),J=S.useCallback(()=>ae([z,P]),[ae,z,P]);S.useEffect(()=>{q&&J()},[q,J]);const{onOpenChange:re,triggerPointerDownPosRef:X}=j;S.useEffect(()=>{if(P){let ze={x:0,y:0};const vt=ot=>{var De,je;ze={x:Math.abs(Math.round(ot.pageX)-(((De=X.current)==null?void 0:De.x)??0)),y:Math.abs(Math.round(ot.pageY)-(((je=X.current)==null?void 0:je.y)??0))}},Be=ot=>{ze.x<=10&&ze.y<=10?ot.preventDefault():P.contains(ot.target)||re(!1),document.removeEventListener("pointermove",vt),X.current=null};return X.current!==null&&(document.addEventListener("pointermove",vt),document.addEventListener("pointerup",Be,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",vt),document.removeEventListener("pointerup",Be,{capture:!0})}}},[P,re,X]),S.useEffect(()=>{const ze=()=>re(!1);return window.addEventListener("blur",ze),window.addEventListener("resize",ze),()=>{window.removeEventListener("blur",ze),window.removeEventListener("resize",ze)}},[re]);const[de,we]=Mfe(ze=>{const vt=K().filter(De=>!De.disabled),Be=vt.find(De=>De.ref.current===document.activeElement),ot=Ufe(vt,ze,Be);ot&&setTimeout(()=>ot.ref.current.focus())}),ge=S.useCallback((ze,vt,Be)=>{const ot=!oe.current&&!Be;(j.value!==void 0&&j.value===vt||ot)&&(W(ze),ot&&(oe.current=!0))},[j.value]),Te=S.useCallback(()=>P==null?void 0:P.focus(),[P]),Pe=S.useCallback((ze,vt,Be)=>{const ot=!oe.current&&!Be;(j.value!==void 0&&j.value===vt||ot)&&Q(ze)},[j.value]),rt=i==="popper"?MU:Efe,dt=rt===MU?{side:p,sideOffset:g,align:v,alignOffset:b,arrowPadding:E,collisionBoundary:T,collisionPadding:C,sticky:R,hideWhenDetached:N,avoidCollisions:O}:{};return c.jsx(_fe,{scope:n,content:P,viewport:D,onViewportChange:U,itemRefCallback:ge,selectedItem:z,onItemLeave:Te,itemTextRefCallback:Pe,focusSelectedItem:J,selectedItemText:Y,position:i,isPositioned:q,searchRef:de,children:c.jsx(Vw,{as:Sze,allowPinchZoom:!0,children:c.jsx(Fw,{asChild:!0,trapped:j.open,onMountAutoFocus:ze=>{ze.preventDefault()},onUnmountAutoFocus:Tt(o,ze=>{var vt;(vt=j.trigger)==null||vt.focus({preventScroll:!0}),ze.preventDefault()}),children:c.jsx(Hy,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:u,onPointerDownOutside:h,onFocusOutside:ze=>ze.preventDefault(),onDismiss:()=>j.onOpenChange(!1),children:c.jsx(rt,{role:"listbox",id:j.contentId,"data-state":j.open?"open":"closed",dir:j.dir,onContextMenu:ze=>ze.preventDefault(),...k,...dt,onPlaced:()=>ee(!0),ref:V,style:{display:"flex",flexDirection:"column",outline:"none",...k.style},onKeyDown:Tt(k.onKeyDown,ze=>{const vt=ze.ctrlKey||ze.altKey||ze.metaKey;if(ze.key==="Tab"&&ze.preventDefault(),!vt&&ze.key.length===1&&we(ze.key),["ArrowUp","ArrowDown","Home","End"].includes(ze.key)){let ot=K().filter(De=>!De.disabled).map(De=>De.ref.current);if(["ArrowUp","End"].includes(ze.key)&&(ot=ot.slice().reverse()),["ArrowUp","ArrowDown"].includes(ze.key)){const De=ze.target,je=ot.indexOf(De);ot=ot.slice(je+1)}setTimeout(()=>ae(ot)),ze.preventDefault()}})})})})})})});bfe.displayName=wze;var xze="SelectItemAlignedPosition",Efe=S.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:i,...o}=e,u=Df(fm,n),h=Lf(fm,n),[p,g]=S.useState(null),[v,b]=S.useState(null),E=Dn(t,V=>b(V)),T=rI(n),C=S.useRef(!1),R=S.useRef(!0),{viewport:N,selectedItem:O,selectedItemText:k,focusSelectedItem:j}=h,P=S.useCallback(()=>{if(u.trigger&&u.valueNode&&p&&v&&N&&O&&k){const V=u.trigger.getBoundingClientRect(),z=v.getBoundingClientRect(),W=u.valueNode.getBoundingClientRect(),Y=k.getBoundingClientRect();if(u.dir!=="rtl"){const De=Y.left-z.left,je=W.left-De,Mt=V.left-je,Ut=V.width+Mt,fn=Math.max(Ut,z.width),ht=window.innerWidth-xl,St=bU(je,[xl,Math.max(xl,ht-fn)]);p.style.minWidth=Ut+"px",p.style.left=St+"px"}else{const De=z.right-Y.right,je=window.innerWidth-W.right-De,Mt=window.innerWidth-V.right-je,Ut=V.width+Mt,fn=Math.max(Ut,z.width),ht=window.innerWidth-xl,St=bU(je,[xl,Math.max(xl,ht-fn)]);p.style.minWidth=Ut+"px",p.style.right=St+"px"}const Q=T(),K=window.innerHeight-xl*2,q=N.scrollHeight,ee=window.getComputedStyle(v),oe=parseInt(ee.borderTopWidth,10),ae=parseInt(ee.paddingTop,10),J=parseInt(ee.borderBottomWidth,10),re=parseInt(ee.paddingBottom,10),X=oe+ae+q+re+J,de=Math.min(O.offsetHeight*5,X),we=window.getComputedStyle(N),ge=parseInt(we.paddingTop,10),Te=parseInt(we.paddingBottom,10),Pe=V.top+V.height/2-xl,rt=K-Pe,dt=O.offsetHeight/2,ze=O.offsetTop+dt,vt=oe+ae+ze,Be=X-vt;if(vt<=Pe){const De=Q.length>0&&O===Q[Q.length-1].ref.current;p.style.bottom="0px";const je=v.clientHeight-N.offsetTop-N.offsetHeight,Mt=Math.max(rt,dt+(De?Te:0)+je+J),Ut=vt+Mt;p.style.height=Ut+"px"}else{const De=Q.length>0&&O===Q[0].ref.current;p.style.top="0px";const Mt=Math.max(Pe,oe+N.offsetTop+(De?ge:0)+dt)+Be;p.style.height=Mt+"px",N.scrollTop=vt-Pe+N.offsetTop}p.style.margin=`${xl}px 0`,p.style.minHeight=de+"px",p.style.maxHeight=K+"px",i==null||i(),requestAnimationFrame(()=>C.current=!0)}},[T,u.trigger,u.valueNode,p,v,N,O,k,u.dir,i]);va(()=>P(),[P]);const[M,D]=S.useState();va(()=>{v&&D(window.getComputedStyle(v).zIndex)},[v]);const U=S.useCallback(V=>{V&&R.current===!0&&(P(),j==null||j(),R.current=!1)},[P,j]);return c.jsx(Cze,{scope:n,contentWrapper:p,shouldExpandOnScrollRef:C,onScrollButtonChange:U,children:c.jsx("div",{ref:g,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:M},children:c.jsx(en.div,{...o,ref:E,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});Efe.displayName=xze;var Tze="SelectPopperPosition",MU=S.forwardRef((e,t)=>{const{__scopeSelect:n,align:i="start",collisionPadding:o=xl,...u}=e,h=iI(n);return c.jsx(m1,{...h,...u,ref:t,align:i,collisionPadding:o,style:{boxSizing:"border-box",...u.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});MU.displayName=Tze;var[Cze,IB]=o_(fm,{}),UU="SelectViewport",wfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:i,...o}=e,u=Lf(UU,n),h=IB(UU,n),p=Dn(t,u.onViewportChange),g=S.useRef(0);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),c.jsx(nI.Slot,{scope:n,children:c.jsx(en.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:p,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:Tt(o.onScroll,v=>{const b=v.currentTarget,{contentWrapper:E,shouldExpandOnScrollRef:T}=h;if(T!=null&&T.current&&E){const C=Math.abs(g.current-b.scrollTop);if(C>0){const R=window.innerHeight-xl*2,N=parseFloat(E.style.minHeight),O=parseFloat(E.style.height),k=Math.max(N,O);if(k<R){const j=k+C,P=Math.min(R,j),M=j-P;E.style.height=P+"px",E.style.bottom==="0px"&&(b.scrollTop=M>0?M:0,E.style.justifyContent="flex-end")}}}g.current=b.scrollTop})})})]})});wfe.displayName=UU;var Sfe="SelectGroup",[Rze,Nze]=o_(Sfe),Aze=S.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,o=Vl();return c.jsx(Rze,{scope:n,id:o,children:c.jsx(en.div,{role:"group","aria-labelledby":o,...i,ref:t})})});Aze.displayName=Sfe;var xfe="SelectLabel",Tfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,o=Nze(xfe,n);return c.jsx(en.div,{id:o.id,...i,ref:t})});Tfe.displayName=xfe;var zN="SelectItem",[Ize,Cfe]=o_(zN),Rfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,value:i,disabled:o=!1,textValue:u,...h}=e,p=Df(zN,n),g=Lf(zN,n),v=p.value===i,[b,E]=S.useState(u??""),[T,C]=S.useState(!1),R=Dn(t,j=>{var P;return(P=g.itemRefCallback)==null?void 0:P.call(g,j,i,o)}),N=Vl(),O=S.useRef("touch"),k=()=>{o||(p.onValueChange(i),p.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return c.jsx(Ize,{scope:n,value:i,disabled:o,textId:N,isSelected:v,onItemTextChange:S.useCallback(j=>{E(P=>P||((j==null?void 0:j.textContent)??"").trim())},[]),children:c.jsx(nI.ItemSlot,{scope:n,value:i,disabled:o,textValue:b,children:c.jsx(en.div,{role:"option","aria-labelledby":N,"data-highlighted":T?"":void 0,"aria-selected":v&&T,"data-state":v?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...h,ref:R,onFocus:Tt(h.onFocus,()=>C(!0)),onBlur:Tt(h.onBlur,()=>C(!1)),onClick:Tt(h.onClick,()=>{O.current!=="mouse"&&k()}),onPointerUp:Tt(h.onPointerUp,()=>{O.current==="mouse"&&k()}),onPointerDown:Tt(h.onPointerDown,j=>{O.current=j.pointerType}),onPointerMove:Tt(h.onPointerMove,j=>{var P;O.current=j.pointerType,o?(P=g.onItemLeave)==null||P.call(g):O.current==="mouse"&&j.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Tt(h.onPointerLeave,j=>{var P;j.currentTarget===document.activeElement&&((P=g.onItemLeave)==null||P.call(g))}),onKeyDown:Tt(h.onKeyDown,j=>{var M;((M=g.searchRef)==null?void 0:M.current)!==""&&j.key===" "||(mze.includes(j.key)&&k(),j.key===" "&&j.preventDefault())})})})})});Rfe.displayName=zN;var VE="SelectItemText",Nfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:o,...u}=e,h=Df(VE,n),p=Lf(VE,n),g=Cfe(VE,n),v=_ze(VE,n),[b,E]=S.useState(null),T=Dn(t,k=>E(k),g.onItemTextChange,k=>{var j;return(j=p.itemTextRefCallback)==null?void 0:j.call(p,k,g.value,g.disabled)}),C=b==null?void 0:b.textContent,R=S.useMemo(()=>c.jsx("option",{value:g.value,disabled:g.disabled,children:C},g.value),[g.disabled,g.value,C]),{onNativeOptionAdd:N,onNativeOptionRemove:O}=v;return va(()=>(N(R),()=>O(R)),[N,O,R]),c.jsxs(c.Fragment,{children:[c.jsx(en.span,{id:g.textId,...u,ref:T}),g.isSelected&&h.valueNode&&!h.valueNodeHasChildren?wm.createPortal(u.children,h.valueNode):null]})});Nfe.displayName=VE;var Afe="SelectItemIndicator",Ife=S.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return Cfe(Afe,n).isSelected?c.jsx(en.span,{"aria-hidden":!0,...i,ref:t}):null});Ife.displayName=Afe;var FU="SelectScrollUpButton",Ofe=S.forwardRef((e,t)=>{const n=Lf(FU,e.__scopeSelect),i=IB(FU,e.__scopeSelect),[o,u]=S.useState(!1),h=Dn(t,i.onScrollButtonChange);return va(()=>{if(n.viewport&&n.isPositioned){let p=function(){const v=g.scrollTop>0;u(v)};const g=n.viewport;return p(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[n.viewport,n.isPositioned]),o?c.jsx(kfe,{...e,ref:h,onAutoScroll:()=>{const{viewport:p,selectedItem:g}=n;p&&g&&(p.scrollTop=p.scrollTop-g.offsetHeight)}}):null});Ofe.displayName=FU;var VU="SelectScrollDownButton",Pfe=S.forwardRef((e,t)=>{const n=Lf(VU,e.__scopeSelect),i=IB(VU,e.__scopeSelect),[o,u]=S.useState(!1),h=Dn(t,i.onScrollButtonChange);return va(()=>{if(n.viewport&&n.isPositioned){let p=function(){const v=g.scrollHeight-g.clientHeight,b=Math.ceil(g.scrollTop)<v;u(b)};const g=n.viewport;return p(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[n.viewport,n.isPositioned]),o?c.jsx(kfe,{...e,ref:h,onAutoScroll:()=>{const{viewport:p,selectedItem:g}=n;p&&g&&(p.scrollTop=p.scrollTop+g.offsetHeight)}}):null});Pfe.displayName=VU;var kfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:i,...o}=e,u=Lf("SelectScrollButton",n),h=S.useRef(null),p=rI(n),g=S.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return S.useEffect(()=>()=>g(),[g]),va(()=>{var b;const v=p().find(E=>E.ref.current===document.activeElement);(b=v==null?void 0:v.ref.current)==null||b.scrollIntoView({block:"nearest"})},[p]),c.jsx(en.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:Tt(o.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(i,50))}),onPointerMove:Tt(o.onPointerMove,()=>{var v;(v=u.onItemLeave)==null||v.call(u),h.current===null&&(h.current=window.setInterval(i,50))}),onPointerLeave:Tt(o.onPointerLeave,()=>{g()})})}),Oze="SelectSeparator",jfe=S.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return c.jsx(en.div,{"aria-hidden":!0,...i,ref:t})});jfe.displayName=Oze;var BU="SelectArrow",Pze=S.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,o=iI(n),u=Df(BU,n),h=Lf(BU,n);return u.open&&h.position==="popper"?c.jsx(g1,{...o,...i,ref:t}):null});Pze.displayName=BU;var kze="SelectBubbleInput",Dfe=S.forwardRef(({__scopeSelect:e,value:t,...n},i)=>{const o=S.useRef(null),u=Dn(i,o),h=rB(t);return S.useEffect(()=>{const p=o.current;if(!p)return;const g=window.HTMLSelectElement.prototype,b=Object.getOwnPropertyDescriptor(g,"value").set;if(h!==t&&b){const E=new Event("change",{bubbles:!0});b.call(p,t),p.dispatchEvent(E)}},[h,t]),c.jsx(en.select,{...n,style:{...sce,...n.style},ref:u,defaultValue:t})});Dfe.displayName=kze;function Lfe(e){return e===""||e===void 0}function Mfe(e){const t=Ba(e),n=S.useRef(""),i=S.useRef(0),o=S.useCallback(h=>{const p=n.current+h;t(p),function g(v){n.current=v,window.clearTimeout(i.current),v!==""&&(i.current=window.setTimeout(()=>g(""),1e3))}(p)},[t]),u=S.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return S.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,o,u]}function Ufe(e,t,n){const o=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,u=n?e.indexOf(n):-1;let h=jze(e,Math.max(u,0));o.length===1&&(h=h.filter(v=>v!==n));const g=h.find(v=>v.textValue.toLowerCase().startsWith(o.toLowerCase()));return g!==n?g:void 0}function jze(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var Dze=dfe,Ffe=ffe,Lze=mfe,Mze=gfe,Uze=vfe,Vfe=yfe,Fze=wfe,Bfe=Tfe,$fe=Rfe,Vze=Nfe,Bze=Ife,Wfe=Ofe,Gfe=Pfe,Hfe=jfe;const Pr=Dze,kr=Lze,Cr=S.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(Ffe,{ref:i,className:kt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,c.jsx(Mze,{asChild:!0,children:c.jsx(Zy,{className:"h-4 w-4 opacity-50"})})]}));Cr.displayName=Ffe.displayName;const zfe=S.forwardRef(({className:e,...t},n)=>c.jsx(Wfe,{ref:n,className:kt("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(S1,{className:"h-4 w-4"})}));zfe.displayName=Wfe.displayName;const Kfe=S.forwardRef(({className:e,...t},n)=>c.jsx(Gfe,{ref:n,className:kt("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(Zy,{className:"h-4 w-4"})}));Kfe.displayName=Gfe.displayName;const Rr=S.forwardRef(({className:e,children:t,position:n="popper",...i},o)=>c.jsx(Uze,{children:c.jsxs(Vfe,{ref:o,className:kt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...i,children:[c.jsx(zfe,{}),c.jsx(Fze,{className:kt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),c.jsx(Kfe,{})]})}));Rr.displayName=Vfe.displayName;const $ze=S.forwardRef(({className:e,...t},n)=>c.jsx(Bfe,{ref:n,className:kt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));$ze.displayName=Bfe.displayName;const ft=S.forwardRef(({className:e,children:t,...n},i)=>c.jsxs($fe,{ref:i,className:kt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Bze,{children:c.jsx(Dw,{className:"h-4 w-4"})})}),c.jsx(Vze,{children:t})]}));ft.displayName=$fe.displayName;const Wze=S.forwardRef(({className:e,...t},n)=>c.jsx(Hfe,{ref:n,className:kt("-mx-1 my-1 h-px bg-muted",e),...t}));Wze.displayName=Hfe.displayName;const qfe="https://api.gada.chat";async function Nee(e){const t=await fetch(`${qfe}/api/points/overview`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to load points overview");return t.json()}async function Gze(e,t={}){const{page:n=1,limit:i=10,q:o="",sort:u="time",dir:h="desc"}=t,p=new URLSearchParams({page:String(n),limit:String(i),q:o,sort:u,dir:h}),g=await fetch(`${qfe}/api/points/logs?${p.toString()}`,{headers:e,credentials:"include"});if(!g.ok)throw new Error("Failed to load transactions");return g.json()}function Hze({type:e}){const t="h-5 w-5";switch(e){case"post":return c.jsx(qce,{className:t});case"view":return c.jsx(TN,{className:t});case"comment":return c.jsx(Mw,{className:t});case"follow":return c.jsx(Tm,{className:t});case"refer":return c.jsx(i4e,{className:t});case"transfer":return c.jsx(dy,{className:t})}}function zze(){const{accessToken:e}=st(),t=wt(e);S.useRef(0);const n=S.useRef(0);function i(ae,J=300){const[re,X]=S.useState(ae);return S.useEffect(()=>{const de=setTimeout(()=>X(ae),J);return()=>clearTimeout(de)},[ae,J]),re}const[o,u]=S.useState(!0),[h,p]=S.useState(null),[g,v]=S.useState(10),[b,E]=S.useState(1),[T,C]=S.useState(""),[R,N]=S.useState([]),[O,k]=S.useState(0),j=e||"",P=i(T,350),[M,D]=S.useState(""),[U,V]=S.useState(!1),z=(h==null?void 0:h.rules.conversion.pointsPerNaira)??10,W=!!(h!=null&&h.rules.conversion.enabled),Y=typeof M=="number"&&M>0?Math.floor(M/z*100)/100:0,Q=S.useRef(!1);S.useEffect(()=>{if(!j||Q.current)return;Q.current=!0;const ae=new AbortController;return(async()=>{try{u(!0);const J=await Nee(t,{signal:ae.signal});p(J)}catch(J){(J==null?void 0:J.name)!=="AbortError"&&console.error(J)}finally{u(!1)}})(),()=>ae.abort()},[j]),S.useEffect(()=>{if(!j)return;const ae=++n.current,J=new AbortController;return u(!0),(async()=>{try{const re=await Gze(t,{page:b,limit:g,q:P,sort:"time",dir:"desc",signal:J.signal});N(re.rows),k(re.total),re.page!==b&&E(re.page)}catch(re){(re==null?void 0:re.name)!=="AbortError"&&console.error(re)}finally{n.current===ae&&u(!1)}})(),()=>J.abort()},[j,b,g,P]);const K=Math.max(1,Math.ceil(O/g)),q=Math.min(b,K),ee=S.useMemo(()=>h?[{title:"Points",subtitle:"For creating a new post",points:h.rules.post_create,icon:"post"},{title:"Points",subtitle:"For each post view",points:h.rules.post_view,icon:"view"},{title:"Points",subtitle:"For any comment on your post",points:h.rules.post_comment,icon:"comment"},{title:"Points",subtitle:"For each follower you got",points:h.rules.follow,icon:"follow"},{title:"Points",subtitle:"For referring user",points:h.rules.refer,icon:"refer"}]:[],[h]),oe=async()=>{if(!h)return;const ae=typeof M=="number"?M:0;if(ae<=0)return toast.error("Enter points amount");if(!W)return toast.error("Transfer is currently disabled");if(ae>h.balances.points)return toast.error("Insufficient points");V(!0);try{const J=await fetch("https://api.gada.chat/api/points/transfer",{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({points:ae})}),re=await J.json();if(!J.ok||!(re!=null&&re.ok))throw new Error((re==null?void 0:re.error)||"Transfer failed");toast.success(`Transferred ${ae} points → ₦${re.moved.money}`);const X=await Nee(t);p(X),D("")}catch(J){toast.error((J==null?void 0:J.message)||"Transfer failed")}finally{V(!1)}};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky",children:c.jsx(Ss,{})})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsx(Vr,{className:"mb-6 overflow-hidden",children:c.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-indigo-500 p-4 text-white",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"bg-white/20 rounded-md p-2",children:c.jsx(zVe,{className:"h-5 w-5"})}),c.jsxs("div",{className:"space-y-1 text-sm leading-6",children:[c.jsx("div",{className:"font-semibold",children:"Points System"}),c.jsxs("div",{children:["Each ",c.jsx("b",{children:z})," points equal ₦1.",h&&c.jsxs("span",{className:"ml-2",children:["Daily limit: ",c.jsx("b",{children:h.rules.daily_limit})," • Remaining today: ",c.jsx("b",{children:h.remainingToday})]})]}),c.jsxs("div",{children:["Your daily points limit resets ",h?`~ every ${h.windowHours}h`:"daily"," after your last valid earn."]}),c.jsx("div",{children:"You can transfer your money to your wallet."})]})]})})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-indigo-500 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Points Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:[h?h.balances.points.toLocaleString():"—"," Points"]})]})}),c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Wallet Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:["₦",h?h.balances.money.toLocaleString():"—"]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[ee.map((ae,J)=>c.jsx(Vr,{children:c.jsxs(mi,{className:"p-4 flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold",children:ae.points}),c.jsx("div",{className:"text-sm text-gray-500",children:"Points"}),c.jsx("div",{className:"mt-2 text-gray-700 text-sm",children:ae.subtitle})]}),c.jsx("div",{className:"rounded-full bg-gray-100 p-2 text-gray-600",children:c.jsx(Hze,{type:ae.icon})})]})},J)),c.jsx(Vr,{children:c.jsxs(mi,{className:"p-4 flex flex-col sm:flex-row sm:items-end gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Points to convert"}),c.jsx(Ne,{type:"number",min:0,step:1,value:M,onChange:ae=>D(ae.target.value===""?"":Math.max(0,Math.floor(Number(ae.target.value)))),placeholder:"e.g. 100",className:"max-w-xs"}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Preview: ₦",Y,"  •  Rate: ",z," pts = ₦1"]}),!W&&c.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Transfers are currently disabled."})]}),c.jsxs("div",{children:[c.jsx(be,{disabled:!W||U||!M||(h?Number(M)>h.balances.points:!0),onClick:oe,children:U?c.jsxs(c.Fragment,{children:[c.jsx(si,{className:"h-4 w-4 animate-spin mr-2"})," Transferring…"]}):"Transfer to Wallet"}),h&&M&&Number(M)>h.balances.points&&c.jsx("div",{className:"text-xs text-red-600 mt-2",children:"Insufficient points"})]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-indigo-500 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Points Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:[h?h.balances.points.toLocaleString():"—"," Points"]})]})}),c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Points Money Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:["₦",h?h.balances.money.toLocaleString():"—"]})]})})]}),c.jsx(Vr,{children:c.jsxs(mi,{className:"p-4 md:p-6",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Points Transactions"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Show"}),c.jsxs(Pr,{value:String(g),onValueChange:ae=>{v(Number(ae)),E(1)},children:[c.jsx(Cr,{className:"h-8 w-16",children:c.jsx(kr,{})}),c.jsx(Rr,{children:[10,20,50].map(ae=>c.jsx(ft,{value:String(ae),children:ae},ae))})]}),c.jsx("span",{className:"text-sm text-gray-600",children:"entries"})]}),c.jsx("div",{className:"w-56",children:c.jsx(Ne,{placeholder:"Search…",value:T,onChange:ae=>{C(ae.target.value),E(1)},className:"h-9"})})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"ID"}),c.jsx(et,{children:"Points"}),c.jsx(et,{children:"From"}),c.jsx(et,{children:"Time"})]})}),c.jsxs(ba,{children:[R.map(ae=>c.jsxs(nn,{children:[c.jsx(He,{className:"font-medium",children:ae.id}),c.jsx(He,{children:ae.points}),c.jsx(He,{children:ae.from}),c.jsx(He,{children:new Date(ae.time).toLocaleString()})]},ae.id)),!R.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:4,className:"text-center text-gray-500",children:o?"Loading…":"No transactions found."})})]})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(1),disabled:q===1,children:"First"}),c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(ae=>Math.max(1,ae-1)),disabled:q===1,children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",c.jsx("b",{children:q})," of ",c.jsx("b",{children:Math.max(1,Math.ceil(O/g))})]}),c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(ae=>ae+1),disabled:q>=K,children:"Next"}),c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(K),disabled:q>=K,children:"Last"})]}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Showing ",R.length?(q-1)*g+1:0," to ",(q-1)*g+R.length," of ",O," entries"]})]})})]})]})})]})}const Yfe="https://api.gada.chat";async function Kze(e,t={}){const n=`${Yfe}/api/hashtag/${encodeURIComponent(e)}/summary`,i=await fetch(n,{credentials:"include",headers:t});if(!i.ok)throw new Error("Failed to load hashtag summary");return i.json()}async function qze(e,{cursor:t,limit:n=10}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=`${Yfe}/api/hashtag/${encodeURIComponent(e)}/posts?${o.toString()}`,h=await fetch(u,{credentials:"include",headers:i});if(!h.ok)throw new Error("Failed to load hashtag posts");return h.json()}const Yze="https://api.gada.chat";function Xze(e=""){const t=String(e).trim();return t.startsWith("#")?t.slice(1).toLowerCase():t.toLowerCase()}function Jze(){var V;const{tag:e}=tc(),{accessToken:t}=st(),n=wt(t),i=S.useMemo(()=>Xze(e||""),[e]),o=S.useRef(n);S.useEffect(()=>{o.current=n},[n]);const[u,h]=S.useState(null),[p,g]=S.useState(!0),[v,b]=S.useState(null),[E,T]=S.useState(null),[C,R]=S.useState(null),[N,O]=S.useState(!1),[k,j]=S.useState(!1),P=S.useRef(""),M=S.useRef(""),D=S.useRef(!1);S.useEffect(()=>{if(!i||!t)return;const z=`sum|${i}`;if(P.current===z)return;P.current=z,g(!0),b(null);let W=!1;return Kze(i,o.current).then(Y=>{W||h(Y)}).catch(Y=>{W||b((Y==null?void 0:Y.message)||"Failed to load")}).finally(()=>{W||g(!1)}),()=>{W=!0}},[i,t]),S.useEffect(()=>{if(!i||!t)return;const z=`posts|${i}`;M.current!==z&&(M.current=z,T(null),R(null),j(!1),Promise.resolve().then(()=>U(!0)))},[i,t]);const U=async(z=!1)=>{if(!(!i||!t)&&!D.current&&!(!z&&k)){D.current=!0,O(!0);try{const{items:W=[],nextCursor:Y}=await qze(i,{cursor:z?null:C,limit:10},o.current);T(Q=>Q?[...Q,...W]:W),R(Y??null),(!Y||W.length===0)&&j(!0)}catch(W){console.error("[hashtag posts]",W)}finally{D.current=!1,O(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"bg-white shadow",children:c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6",children:[c.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold break-all",children:["#",i]}),c.jsx("div",{className:"text-gray-600 text-sm mt-1",children:p?"Loading…":`${(u==null?void 0:u.counts.posts)??0} posts`}),c.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mt-4",children:[((u==null?void 0:u.previews.photos)||[]).map((z,W)=>c.jsx("div",{className:"aspect-square overflow-hidden rounded bg-gray-100",children:c.jsx("img",{src:Yze+"/uploads/"+Kn(z),alt:"",className:"w-full h-full object-cover"})},W)),!p&&(((V=u==null?void 0:u.previews.photos)==null?void 0:V.length)??0)===0&&c.jsx("div",{className:"text-gray-500 text-sm py-6 col-span-full",children:"No photos yet"})]})]})}),c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 space-y-4",children:[E===null&&N&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:[c.jsx(si,{className:"h-5 w-5 inline animate-spin mr-2"}),"Loading…"]}),Array.isArray(E)&&E.length>0&&c.jsxs(c.Fragment,{children:[E.map(z=>c.jsx(Vu,{post:z},z.id)),!k&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>U(!1),disabled:N,children:N?"Loading…":"Load more"})})]}),E!==null&&E.length===0&&k&&!N&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts for this hashtag yet"})]})]})}const Zze="https://api.gada.chat";function Qze(){const{accessToken:e,user:t}=st(),n=wt(e),i=Hl(e),o=S.useRef(n),u=S.useRef(i);S.useEffect(()=>{o.current=n,u.current=i},[n,i]);const[h]=Jy(),p=S.useMemo(()=>{const X=h.get("user");return X?Number(X):null},[h]),{openConversation:g}=a_(),[v,b]=S.useState(null),[E,T]=S.useState(!1),[C,R]=S.useState(null),[N,O]=S.useState(null),[k,j]=S.useState(null),[P,M]=S.useState(!1),[D,U]=S.useState(!1),[V,z]=S.useState(""),[W,Y]=S.useState(null),[Q,K]=S.useState(null),q=S.useRef(!1),[ee,oe]=S.useState(!1),ae=S.useRef(null);S.useEffect(()=>{e&&(E||v||(T(!0),ZE(o.current).then(b).catch(console.error).finally(()=>T(!1))))},[e,v,E]),S.useEffect(()=>{e&&p&&(async()=>{try{const{conversationId:X}=await AU(p,o.current);if(!v){const de=await ZE(o.current);b(de)}R(X)}catch(X){console.error("[open from query]",X)}})()},[e,p]),S.useEffect(()=>{!e||!C||(O(null),j(null),U(!1),Promise.resolve().then(()=>J(!0)))},[e,C]),S.useEffect(()=>{if(!e)return;const X=vB(e);return ae.current=X,X.on("message:new",({message:de})=>{C&&de.conversationId===C&&de.authorId!==(t==null?void 0:t.id)&&O(we=>we?[...we,de]:[de]),b(we=>{if(!we)return we;const ge=de.text||(de.image?"[image]":de.voice?"[voice]":"");return we.some(Pe=>Pe.conversationId===de.conversationId)?we.map(Pe=>Pe.conversationId===de.conversationId?{...Pe,lastMessage:ge,lastTime:de.time,unread:Pe.conversationId!==C}:Pe):we})}),X.on("message:typing",de=>{de.userId!==(t==null?void 0:t.id)&&b(we=>(we==null?void 0:we.map(ge=>ge.conversationId===de.conversationId?{...ge,typing:de.typing}:ge))||null)}),X.on("message:seen",de=>{de.userId===(t==null?void 0:t.id)&&b(we=>(we==null?void 0:we.map(ge=>ge.conversationId===de.conversationId?{...ge,unread:!1}:ge))||null)}),X.on("conversation:update",de=>{b(we=>!we||!we.find(Te=>Te.conversationId===de.conversationId)?we:we.map(Te=>Te.conversationId===de.conversationId?{...Te,lastMessage:de.lastMessage,lastTime:de.lastTime}:Te))}),()=>{X.close()}},[e,C,t==null?void 0:t.id]),S.useEffect(()=>{if(!C)return;const X=setTimeout(()=>{hhe(C,!1,o.current).catch(()=>{})},1e3);return()=>clearTimeout(X)},[V,C]);const J=async(X=!1)=>{if(!(!C||!e)&&!q.current&&!(!X&&D)){q.current=!0,M(!0);try{const{items:de=[],nextCursor:we}=await dhe(C,{cursor:X?null:k,limit:25},o.current);O(ge=>ge?[...de,...ge]:de),j(we??null),(!we||de.length===0)&&U(!0),X&&(await fhe(C,o.current),b(ge=>(ge==null?void 0:ge.map(Te=>Te.conversationId===C?{...Te,unread:!1}:Te))||null))}catch(de){console.error(de)}finally{q.current=!1,M(!1)}}},re=async X=>{try{const{conversationId:de}=await AU(X.id,o.current);if(!v){const we=await ZE(o.current);b(we)}R(de),oe(!1)}catch(de){console.error("[open from pick]",de)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"max-w-6xl mx-auto px-2 sm:px-6 py-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-3 md:col-span-1 flex flex-col h-[70vh]",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"text-lg font-semibold",children:"Messages"}),c.jsxs(be,{size:"sm",variant:"secondary",onClick:()=>oe(!0),children:[c.jsx(M4,{className:"h-4 w-4 mr-1"})," New"]})]}),E&&c.jsxs("div",{className:"text-sm text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),Array.isArray(v)&&v.length===0&&c.jsxs("div",{className:"text-sm text-gray-500",children:["No conversations yet. Click ",c.jsx("span",{className:"font-medium",children:"New"})," to start one."]}),c.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain pr-1",children:c.jsx("div",{className:"space-y-1",children:Array.isArray(v)&&v.map(X=>c.jsxs("button",{onClick:()=>g(X.conversationId,X.peer),className:`w-full flex items-center gap-3 px-2 py-2 rounded hover:bg-gray-50 ${C===X.conversationId?"bg-gray-50":""}`,children:[c.jsxs($i,{className:"h-9 w-9",children:[c.jsx(Oi,{src:X.peer.avatar?Zze+"/uploads/"+Kn(X.peer.avatar):""}),c.jsx(Qi,{children:(X.peer.fullName||X.peer.username).slice(0,1).toUpperCase()})]}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"font-medium truncate",children:X.peer.fullName||X.peer.username}),X.unread&&c.jsx("span",{className:"ml-2 inline-block w-2 h-2 rounded-full bg-[#1877F2]"})]}),c.jsx("div",{className:"text-xs text-gray-500 truncate",children:X.typing?"typing…":X.lastMessage})]})]},X.conversationId))})})]})}),c.jsx(mhe,{open:ee,onOpenChange:oe,search:X=>U6e(X,o.current),onPick:re})]})}const e9e="https://api.gada.chat";function $s(e,t){const n=new URL(`${e9e}/api/pages${e}`);return t&&Object.entries(t).forEach(([i,o])=>{o!=null&&o!==""&&n.searchParams.set(i,String(o))}),n.toString()}function Yw(e={}){return fetch($s("/categories"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load categories");return t.json()})}function t9e(e,t={}){return fetch($s(""),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to create page");return n.json()})}function n9e(e,t={}){return fetch($s("",e),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load pages");return n.json()})}function r9e(e,t={}){return fetch($s(`/${e}`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to fetch page");return n.json()})}function i9e(e,t,n={}){const i=new FormData;return i.append("cover",t),fetch($s(`/${e}/cover`),{method:"POST",credentials:"include",headers:n,body:i}).then(o=>{if(!o.ok)throw new Error("Failed to update cover");return o.json()})}function a9e(e,t={}){return fetch($s(`/${e}/like`),{method:"POST",credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to like/unlike");return n.json()})}function s9e(e,t,n={}){return fetch($s(`/${e}/posts`,t),{credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to load posts");return i.json()})}function o9e(e,t,n={}){return fetch($s(`/${e}/posts`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify(t)}).then(i=>{if(!i.ok)throw new Error("Failed to create post");return i.json()})}function c9e(e,t={}){return fetch($s("/users/suggest",{q:e}),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to search users");return n.json()})}function Xw(e={}){return fetch($s("/invites"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load invites");return t.json()})}function Aee(e,t={}){return fetch($s(`/${e}/invites`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load page invites");return n.json()})}function l9e(e,t,n={}){return fetch($s(`/${e}/invites`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({userId:t})}).then(i=>{if(!i.ok)throw new Error("Failed to invite");return i.json()})}function u9e(e,t,n={}){return fetch($s(`/${e}/invites/${t}/accept`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to accept");return i.json()})}function d9e(e,t,n={}){return fetch($s(`/${e}/invites/${t}/decline`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to decline");return i.json()})}function h9e(e,t,n){return fetch($s(`/${encodeURIComponent(String(e))}/boost`),{method:t?"POST":"DELETE",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to decline");return i.json()})}function aI({cats:e,invCount:t,highlight:n=null}){const{accessToken:i}=st(),o=wt(i),u=S.useRef(o);S.useEffect(()=>{u.current=o},[o]);const[h,p]=S.useState(e??[]),[g,v]=S.useState(t??0);S.useEffect(()=>{if(e){p(e);return}i&&Yw(u.current).then(p).catch(()=>{})},[i,e]),S.useEffect(()=>{if(typeof t=="number"){v(t);return}i&&Xw(u.current).then(E=>v(E.length)).catch(()=>{})},[i,t]);const b=E=>n===E?"bg-gray-50":"";return c.jsxs("div",{className:"md:sticky md:top-20 bg-white rounded-lg shadow p-3 space-y-2",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Pages"}),c.jsxs(Nt,{to:"/pages",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(Sf,{className:"h-4 w-4 mr-2"})," Discover"]}),c.jsxs(Nt,{to:"/pages?my=1",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(GVe,{className:"h-4 w-4 mr-2"})," Your Pages"]}),c.jsxs(Nt,{to:"/pages/invites",className:`flex items-center justify-between px-3 py-2 rounded hover:bg-gray-100 ${b("invites")}`,children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(L4,{className:"h-4 w-4 mr-2"})," Invites"]}),g>0&&c.jsx("span",{className:"text-xs bg-[#1877F2] text-white rounded-full px-2 py-0.5",children:g})]}),c.jsxs(Nt,{to:"/pages/create",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(D4,{className:"h-4 w-4 mr-2"})," Create Page"]}),c.jsx("div",{className:"h-px bg-gray-200 my-2"}),c.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide px-1 mb-1",children:"Categories"}),c.jsxs("div",{className:"max-h-64 overflow-auto pr-1 space-y-1",children:[c.jsx(Nt,{to:"/pages",className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:"All"}),h.map(E=>c.jsx(Nt,{to:`/pages?categoryId=${E.category_id}`,className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:E.category_name},E.category_id))]})]})}const Iee="https://api.gada.chat";function f9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const[i,o]=Jy();tr();const[u,h]=S.useState(i.get("q")||""),[p,g]=S.useState(i.get("categoryId")?Number(i.get("categoryId")):""),[v,b]=S.useState(i.get("sort")||"popular"),E=i.get("my")==="1",[T,C]=S.useState([]),[R,N]=S.useState(null),[O,k]=S.useState(null),[j,P]=S.useState(!1),[M,D]=S.useState(!1),[U,V]=S.useState(0);S.useEffect(()=>{e&&(Yw(n.current).then(C).catch(console.error),Xw(n.current).then(W=>V(W.length)).catch(()=>{}))},[e]),S.useEffect(()=>{const W={};u&&(W.q=u),p&&(W.categoryId=p),v&&v!=="popular"&&(W.sort=v),E&&(W.my="1"),o(W,{replace:!0})},[u,p,v,E]),S.useEffect(()=>{e&&(N(null),k(null),D(!1),Promise.resolve().then(()=>z(!0)))},[u,p,v,E,e]);const z=async(W=!1)=>{if(!j&&!(!W&&M)){P(!0);try{const{items:Y=[],nextCursor:Q}=await n9e({q:u.trim(),categoryId:p||void 0,sort:v,my:E?1:void 0,cursor:W?void 0:O,limit:12},n.current);N(K=>K?[...K,...Y]:Y),k(Q??null),(!Q||Y.length===0)&&D(!0)}finally{P(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(aI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[c.jsx(Ne,{value:u,onChange:W=>h(W.target.value),placeholder:"Search pages…",className:"max-w-sm"}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:p,onChange:W=>g(W.target.value?Number(W.target.value):""),children:[c.jsx("option",{value:"",children:"All categories"}),T.map(W=>c.jsx("option",{value:W.category_id,children:W.category_name},W.category_id))]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:v,onChange:W=>b(W.target.value),children:[c.jsx("option",{value:"popular",children:"Popular"}),c.jsx("option",{value:"recent",children:"Recent"})]})]}),R===null&&c.jsxs("div",{className:"text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-4",children:Array.isArray(R)&&R.map(W=>c.jsxs(Nt,{to:`/pages/${W.page_name}`,className:"bg-white rounded-lg shadow hover:shadow-md transition",children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:W.page_cover&&c.jsx("img",{src:`${Iee}/uploads/${W.page_cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 overflow-hidden",children:W.page_picture&&c.jsx("img",{src:`${Iee}/uploads/${W.page_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-semibold truncate",children:W.page_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",W.page_name]})]})]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:[W.page_likes," likes"]})]})]},W.page_id??W.pageId))}),!M&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>z(!1),disabled:j,children:j?"Loading…":"Load more"})})]})]})]})}const $C="https://api.gada.chat";function p9e(){var Mt,Ut,fn,ht,St,At;const{handle:e}=tc(),{accessToken:t,user:n}=st(),i=wt(t),o=S.useRef(i);S.useEffect(()=>{o.current=i},[i]);const[u,h]=S.useState([]),[p,g]=S.useState(0),[v,b]=S.useState(null),[E,T]=S.useState(!0),[C,R]=S.useState(!1),[N,O]=S.useState(null),[k,j]=S.useState(null),[P,M]=S.useState(!1),[D,U]=S.useState(!1),V=!!((Mt=v==null?void 0:v.admins)!=null&&Mt.some(it=>String(it.id)===String(n==null?void 0:n.id)))||((Ut=v==null?void 0:v.page)==null?void 0:Ut.adminId)===(n==null?void 0:n.id),[z,W]=S.useState(""),[Y,Q]=S.useState(null),[K,q]=S.useState(!1),[ee,oe]=S.useState(""),[ae,J]=S.useState([]),[re,X]=S.useState(null);S.useEffect(()=>{t&&(Yw(o.current).then(h).catch(()=>{}),Xw(o.current).then(it=>g(it.length)).catch(()=>{}))},[t]),S.useEffect(()=>{if(!t||!e)return;let it=!1;return T(!0),r9e(e,o.current).then(ve=>{it||b(ve)}).catch(console.error).finally(()=>{it||T(!1)}),()=>{it=!0}},[t,e]),S.useEffect(()=>{!t||!e||(O(null),j(null),U(!1),de(!0))},[t,e]);const de=async(it=!1)=>{if(e&&!P&&!(!it&&D)){M(!0);try{const{items:ve=[],nextCursor:Ie}=await s9e(e,{cursor:it?null:k,limit:10},o.current);O($e=>$e?[...$e,...ve]:ve),j(Ie??null),(!Ie||ve.length===0)&&U(!0)}finally{M(!1)}}};S.useEffect(()=>{if(!V||!e||!t){Q(null);return}Aee(e,o.current).then(Q).catch(console.error)},[V,e,t]);const we=async()=>{if(!(!v||C)){R(!0);try{const{hasLiked:it}=await a9e(v.page.id??v.page.name,o.current);b(ve=>{if(!ve)return ve;const Ie=Math.max(0,Number(ve.page.likes||0)+(it?1:-1));return{...ve,hasLiked:it,page:{...ve.page,likes:Ie}}})}catch(it){console.error(it)}finally{R(!1)}}},ge=async()=>{if(z.trim())try{await o9e(e,{content:z},o.current),W(""),O(null),j(null),U(!1),de(!0)}catch(it){console.error(it)}},Te=async it=>{if(it)try{const{cover:ve}=await i9e(e,it,o.current);b(Ie=>Ie&&{...Ie,page:{...Ie.page,cover:ve}})}catch(ve){console.error(ve)}};S.useEffect(()=>{const it=setTimeout(()=>{if(!K||!ee.trim()){J([]);return}c9e(ee.trim(),o.current).then(J).catch(()=>J([]))},250);return()=>clearTimeout(it)},[ee,K]);function Pe(it,ve){const Ie=String(ve),$e=it.findIndex(gt=>String(gt.id)===Ie);$e!==-1&&it.splice($e,1)}const rt=async it=>{X(it);try{await l9e(e,it,o.current),Pe(ae,it),await Aee(e,o.current).then(Q)}catch(ve){console.error(ve)}finally{X(null)}},dt=!!(v!=null&&v.hasLiked),ze=String((fn=v==null?void 0:v.page)==null?void 0:fn.page_boosted)==="1"||String((ht=v==null?void 0:v.page)==null?void 0:ht.boosted)==="1"||((St=v==null?void 0:v.page)==null?void 0:St.boosted)===!0,[vt,Be]=S.useState(!1),[ot,De]=S.useState(!1);S.useEffect(()=>{Be(!!ze)},[ze]);const je=async()=>{if(!V||!e||ot)return;De(!0);const it=!vt;try{await h9e(e,it,o.current),Be(it),b(ve=>ve&&{...ve,page:{...ve.page,page_boosted:it?"1":"0"}}),Ce.success("This page is now boosted.")}catch(ve){console.error(ve),Ce.error("Boost action failed"+(ve==null?void 0:ve.message)||"Please try again")}finally{De(!1)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),E?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):v?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(aI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[c.jsxs("div",{className:"relative h-48 sm:h-64 bg-gray-200",children:[v.page.cover&&c.jsx("img",{src:`${$C}/uploads/${v.page.cover}`,className:"w-full h-full object-cover"}),V&&c.jsxs("label",{className:"absolute right-3 bottom-3 bg-white/80 rounded px-3 py-1 text-sm cursor-pointer",children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:it=>{var ve;return Te((ve=it.target.files)==null?void 0:ve[0])}}),"Change cover"]})]}),c.jsx("div",{className:"px-4 sm:px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-white p-1 shadow -mt-14",children:c.jsx("div",{className:"h-full w-full rounded-full overflow-hidden bg-gray-100",children:v.page.picture&&c.jsx("img",{src:`${$C}/uploads/${v.page.picture}`,className:"w-full h-full object-cover"})})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"text-2xl font-bold truncate",children:v.page.title}),c.jsxs("div",{className:"text-gray-500 truncate",children:["@",v.page.name]})]}),c.jsxs(be,{variant:"ghost",onClick:we,disabled:C,className:`rounded-full ${dt?"text-[#1877F2]":"text-gray-700"}`,children:[c.jsx(P0,{className:"h-5 w-5 mr-2"}),dt?"Liked":"Like"," · ",v.page.likes]}),V&&c.jsxs(be,{variant:"ghost",onClick:je,disabled:ot,className:`rounded-full ${vt?"text-[#1877F2]":"text-gray-700"}`,title:vt?"Unboost page":"Boost page",children:[c.jsx(U4,{className:"h-5 w-5 mr-2"}),vt?"Unboost":"Boost"]})]})})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-6",children:[c.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-4",children:[v.page.description&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-1",children:"About"}),c.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:v.page.description})]}),V&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsxs("div",{className:"font-semibold mb-2",children:["Create a post as ",v.page.title]}),c.jsx(wi,{value:z,onChange:it=>W(it.target.value),placeholder:"Say something…"}),c.jsx("div",{className:"mt-2 flex justify-end",children:c.jsx(be,{onClick:ge,disabled:!z.trim(),children:"Post"})})]}),c.jsxs("div",{className:"space-y-4",children:[N===null&&P&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin mr-1"})," Loading…"]}),Array.isArray(N)&&N.map(it=>c.jsx(Vu,{post:it},it.id)),Array.isArray(N)&&N.length===0&&D&&!P&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts yet"}),!D&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>de(!1),disabled:P,children:P?"Loading…":"Load more"})})]})]}),c.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Admins"}),c.jsx("ul",{className:"space-y-2",children:(At=v.admins)==null?void 0:At.map(it=>c.jsxs("li",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:it.avatar&&c.jsx("img",{src:`${$C}/uploads/${Kn(it.avatar)}`,className:"w-full h-full object-cover"})}),c.jsx("div",{className:"text-sm truncate",children:it.fullName||it.username})]},it.id))}),V&&c.jsx("div",{className:"mt-3",children:c.jsxs(be,{size:"sm",onClick:()=>q(!0),children:[c.jsx(Tm,{className:"h-4 w-4 mr-2"})," Invite admin"]})})]}),V&&Y&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Pending invites"}),Y.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No pending invites"}):c.jsx("ul",{className:"space-y-2",children:Y.map(it=>c.jsxs("li",{className:"text-sm flex items-center gap-2",children:[c.jsx("span",{className:"truncate",children:it.toUsername}),c.jsx("span",{className:"text-gray-400",children:"·"}),c.jsxs("span",{className:"text-gray-500",children:["invited by ",it.fromUsername]})]},it.inviteId))})]})]})]})]}),K&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white rounded-lg shadow w-full max-w-md p-4 relative",children:[c.jsx("button",{className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>{q(!1),oe(""),J([])},children:c.jsx(go,{className:"h-5 w-5"})}),c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invite admin"}),c.jsx("input",{className:"w-full border rounded px-3 py-2 mb-3",placeholder:"Search users…",value:ee,onChange:it=>oe(it.target.value)}),c.jsx("div",{className:"max-h-64 overflow-auto -mx-2 px-2",children:ae.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"Type a name or username…"}):c.jsx("ul",{className:"divide-y",children:ae.map(it=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:it.avatar&&c.jsx("img",{src:`${$C}/uploads/${Kn(it.avatar)}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:it.fullName||it.username}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",it.username]})]})]}),c.jsx(be,{size:"sm",onClick:()=>rt(Number(it.id)),disabled:re===Number(it.id),children:re===Number(it.id)?"...":"Invite"})]},it.id))})})]})})]}):c.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:"Page not found"})]})}function m9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const i=tr(),[o,u]=S.useState([]),[h,p]=S.useState(0),[g,v]=S.useState({page_name:"",page_title:"",page_category:"",page_country:"",page_description:""}),[b,E]=S.useState(!1);S.useEffect(()=>{e&&(Yw(n.current).then(u).catch(console.error),Xw(n.current).then(C=>p(C.length)).catch(()=>{}))},[e]);const T=async()=>{if(!(!g.page_name||!g.page_title||!g.page_category||!g.page_country)&&!b){E(!0);try{await t9e({...g,page_category:Number(g.page_category),page_country:Number(g.page_country)},n.current),i(`/pages/${g.page_name}`)}catch(C){console.error(C)}finally{E(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(aI,{})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-3",children:[c.jsx("div",{className:"text-xl font-semibold",children:"Create a Page"}),c.jsx(Ne,{placeholder:"Username (handle)",value:g.page_name,onChange:C=>v({...g,page_name:C.target.value})}),c.jsx(Ne,{placeholder:"Title",value:g.page_title,onChange:C=>v({...g,page_title:C.target.value})}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white w-full",value:g.page_category,onChange:C=>v({...g,page_category:C.target.value}),children:[c.jsx("option",{value:"",children:"Select category"}),o.map(C=>c.jsx("option",{value:C.category_id,children:C.category_name},C.category_id))]}),c.jsx(Ne,{placeholder:"Country ID (numeric)",value:g.page_country,onChange:C=>v({...g,page_country:C.target.value})}),c.jsx(wi,{placeholder:"Description",value:g.page_description,onChange:C=>v({...g,page_description:C.target.value})}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:T,disabled:b,children:b?"Creating…":"Create"})})]})})]})]})}const g9e="https://api.gada.chat";function v9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]),tr();const[i,o]=S.useState([]),[u,h]=S.useState(0),[p,g]=S.useState(null),[v,b]=S.useState(null),E=()=>Xw(n.current).then(R=>{g(R),h(R.length)}).catch(console.error);S.useEffect(()=>{e&&(g(null),E(),Yw(n.current).then(o).catch(()=>{}))},[e]);const T=async(R,N)=>{b(N);try{await u9e(R,N,n.current),await E()}finally{b(null)}},C=async(R,N)=>{b(N);try{await d9e(R,N,n.current),await E()}finally{b(null)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(aI,{})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"text-xl font-semibold mb-3",children:"Page Invites"}),p===null?c.jsxs("div",{className:"text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):p.length===0?c.jsx("div",{className:"text-gray-500",children:"No invites"}):c.jsx("ul",{className:"divide-y",children:p.map(R=>c.jsxs("li",{className:"py-3 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-10 w-10 rounded-full overflow-hidden bg-gray-200",children:R.page_picture&&c.jsx("img",{src:`${g9e}/uploads/${R.page_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-medium truncate",children:R.page_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",R.page_name," • invited by ",R.fromUsername]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{size:"sm",onClick:()=>T(R.page_name,R.inviteId),disabled:v===R.inviteId,children:v===R.inviteId?"...":"Accept"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>C(R.page_name,R.inviteId),disabled:v===R.inviteId,children:"Decline"})]})]},R.inviteId))})]})})]})]})}const y9e="https://api.gada.chat";function Ws(e,t){const n=new URL(`${y9e}/api/groups${e}`);return t&&Object.entries(t).forEach(([i,o])=>{o!=null&&o!==""&&n.searchParams.set(i,String(o))}),n.toString()}function Jw(e={}){return fetch(Ws("/categories"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load categories");return t.json()})}function _9e(e,t={}){return fetch(Ws(""),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to create group");return n.json()})}function b9e(e,t={}){return fetch(Ws("",e),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load groups");return n.json()})}function E9e(e,t={}){return fetch(Ws(`/${e}`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to fetch group");return n.json()})}function w9e(e,t,n={}){const i=new FormData;return i.append("cover",t),fetch(Ws(`/${e}/cover`),{method:"POST",credentials:"include",headers:n,body:i}).then(o=>{if(!o.ok)throw new Error("Failed to update cover");return o.json()})}function S9e(e,t={}){return fetch(Ws(`/${e}/join`),{method:"POST",credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to join");return n.json()})}function x9e(e,t={}){return fetch(Ws(`/${e}/leave`),{method:"POST",credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to leave");return n.json()})}function T9e(e,t,n={}){return fetch(Ws(`/${e}/posts`,t),{credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to load posts");return i.json()})}function C9e(e,t,n={}){return fetch(Ws(`/${e}/posts`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify(t)}).then(i=>{if(!i.ok)throw new Error("Failed to create post");return i.json()})}function R9e(e,t={}){return fetch(Ws("/users/suggest",{q:e}),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to search users");return n.json()})}function Zw(e={}){return fetch(Ws("/invites"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load invites");return t.json()})}function Oee(e,t={}){return fetch(Ws(`/${e}/invites`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load group invites");return n.json()})}function N9e(e,t,n={}){return fetch(Ws(`/${e}/invites`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({userId:t})}).then(i=>{if(!i.ok)throw new Error("Failed to invite");return i.json()})}function A9e(e,t,n={}){return fetch(Ws(`/${e}/invites/${t}/accept`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to accept");return i.json()})}function I9e(e,t,n={}){return fetch(Ws(`/${e}/invites/${t}/decline`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to decline");return i.json()})}function sI({highlight:e=null,cats:t,invCount:n}){const{accessToken:i}=st(),o=wt(i),u=S.useRef(o);S.useEffect(()=>{u.current=o},[o]);const[h,p]=S.useState(t??[]),[g,v]=S.useState(n??0);S.useEffect(()=>{if(t){p(t);return}i&&Jw(u.current).then(p).catch(()=>{})},[i,t]),S.useEffect(()=>{if(typeof n=="number"){v(n);return}i&&Zw(u.current).then(E=>v(E.length)).catch(()=>{})},[i,n]);const b=E=>e===E?"bg-gray-50":"";return c.jsxs("div",{className:"md:sticky md:top-20 bg-white rounded-lg shadow p-3 space-y-2",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Groups"}),c.jsxs(Nt,{to:"/groups",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(Sf,{className:"h-4 w-4 mr-2"})," Discover"]}),c.jsxs(Nt,{to:"/groups?my=1",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(mU,{className:"h-4 w-4 mr-2"})," Your Groups"]}),c.jsxs(Nt,{to:"/groups/invites",className:`flex items-center justify-between px-3 py-2 rounded hover:bg-gray-100 ${b("invites")}`,children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(L4,{className:"h-4 w-4 mr-2"})," Invites"]}),g>0&&c.jsx("span",{className:"text-xs bg-[#1877F2] text-white rounded-full px-2 py-0.5",children:g})]}),c.jsxs(Nt,{to:"/groups/create",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(D4,{className:"h-4 w-4 mr-2"})," Create Group"]}),c.jsx("div",{className:"h-px bg-gray-200 my-2"}),c.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide px-1 mb-1",children:"Categories"}),c.jsxs("div",{className:"max-h-64 overflow-auto pr-1 space-y-1",children:[c.jsx(Nt,{to:"/groups",className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:"All"}),h.map(E=>c.jsx(Nt,{to:`/groups?categoryId=${E.category_id}`,className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:E.category_name},E.category_id))]})]})}const Pee="https://api.gada.chat";function O9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const[i,o]=Jy();tr();const[u,h]=S.useState(i.get("q")||""),[p,g]=S.useState(i.get("categoryId")?Number(i.get("categoryId")):""),[v,b]=S.useState(i.get("sort")||"popular"),E=i.get("my")==="1",[T,C]=S.useState([]),[R,N]=S.useState(null),[O,k]=S.useState(null),[j,P]=S.useState(!1),[M,D]=S.useState(!1),[U,V]=S.useState(0);S.useEffect(()=>{e&&(Jw(n.current).then(C).catch(console.error),Zw(n.current).then(W=>V(W.length)).catch(()=>{}))},[e]),S.useEffect(()=>{const W={};u&&(W.q=u),p&&(W.categoryId=p),v&&v!=="popular"&&(W.sort=v),E&&(W.my="1"),o(W,{replace:!0})},[u,p,v,E]),S.useEffect(()=>{e&&(N(null),k(null),D(!1),Promise.resolve().then(()=>z(!0)))},[u,p,v,E,e]);const z=async(W=!1)=>{if(!j&&!(!W&&M)){P(!0);try{const{items:Y=[],nextCursor:Q}=await b9e({q:u.trim(),categoryId:p||void 0,sort:v,my:E?1:void 0,cursor:W?void 0:O,limit:12},n.current);N(K=>K?[...K,...Y]:Y),k(Q??null),(!Q||Y.length===0)&&D(!0)}finally{P(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(sI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[c.jsx(Ne,{value:u,onChange:W=>h(W.target.value),placeholder:"Search groups…",className:"max-w-sm"}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:p,onChange:W=>g(W.target.value?Number(W.target.value):""),children:[c.jsx("option",{value:"",children:"All categories"}),T.map(W=>c.jsx("option",{value:W.category_id,children:W.category_name},W.category_id))]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:v,onChange:W=>b(W.target.value),children:[c.jsx("option",{value:"popular",children:"Popular"}),c.jsx("option",{value:"recent",children:"Recent"})]})]}),R===null&&c.jsxs("div",{className:"text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-4",children:Array.isArray(R)&&R.map(W=>c.jsxs(Nt,{to:`/groups/${W.group_name}`,className:"bg-white rounded-lg shadow hover:shadow-md transition",children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:W.group_cover&&c.jsx("img",{src:`${Pee}/uploads/${W.group_cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 overflow-hidden",children:W.group_picture&&c.jsx("img",{src:`${Pee}/uploads/${W.group_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-semibold truncate",children:W.group_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",W.group_name]})]})]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:[W.group_members," members · ",W.group_privacy]})]})]},W.group_id??W.groupId))}),!M&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>z(!1),disabled:j,children:j?"Loading…":"Load more"})})]})]})]})}const WC="https://api.gada.chat";function P9e(){var ze,vt,Be,ot;const{handle:e}=tc(),{accessToken:t,user:n}=st(),i=wt(t),o=S.useRef(i);S.useEffect(()=>{o.current=i},[i]);const[u,h]=S.useState([]),[p,g]=S.useState(0),[v,b]=S.useState(null),[E,T]=S.useState(!0),[C,R]=S.useState(null),[N,O]=S.useState(null),[k,j]=S.useState(!1),[P,M]=S.useState(!1),[D,U]=S.useState(""),[V,z]=S.useState(null),[W,Y]=S.useState(!1),[Q,K]=S.useState(""),[q,ee]=S.useState([]),[oe,ae]=S.useState(null),J=!!((ze=v==null?void 0:v.admins)!=null&&ze.some(De=>String(De.id)===String(n==null?void 0:n.id)))||((vt=v==null?void 0:v.group)==null?void 0:vt.adminId)===(n==null?void 0:n.id),re=!!(v!=null&&v.isMember),X=!!(v!=null&&v.isPending),de=re&&((Be=v==null?void 0:v.group)==null?void 0:Be.privacy)!=="secret";S.useEffect(()=>{t&&(Jw(o.current).then(h).catch(()=>{}),Zw(o.current).then(De=>g(De.length)).catch(()=>{}))},[t]),S.useEffect(()=>{if(!t||!e)return;let De=!1;return T(!0),E9e(e,o.current).then(je=>{De||b(je)}).catch(console.error).finally(()=>{De||T(!1)}),()=>{De=!0}},[t,e]),S.useEffect(()=>{!t||!e||(R(null),O(null),M(!1),we(!0))},[t,e]);const we=async(De=!1)=>{if(!(!e||k||!De&&P)){j(!0);try{const{items:je=[],nextCursor:Mt}=await T9e(e,{cursor:De?null:N,limit:10},o.current);R(Ut=>Ut?[...Ut,...je]:je),O(Mt??null),(!Mt||je.length===0)&&M(!0)}finally{j(!1)}}};S.useEffect(()=>{if(!J||!e||!t){z(null);return}Oee(e,o.current).then(z).catch(console.error)},[J,e,t]);const ge=async()=>{try{const De=await S9e(e,o.current);b(je=>je&&{...je,isMember:De.isMember,isPending:De.isPending,group:{...je.group,members:je.group.members+(De.isMember?1:0)}})}catch(De){console.error(De)}},Te=async()=>{try{await x9e(e,o.current),b(De=>De&&{...De,isMember:!1,isPending:!1,group:{...De.group,members:Math.max(0,De.group.members-1)}})}catch(De){console.error(De)}},Pe=async()=>{if(D.trim())try{const{hidden:De}=await C9e(e,{content:D},o.current);U(""),De||(R(null),O(null),M(!1),we(!0))}catch(De){console.error(De)}},rt=async De=>{if(De)try{const{cover:je}=await w9e(e,De,o.current);b(Mt=>Mt&&{...Mt,group:{...Mt.group,cover:je}})}catch(je){console.error(je)}};S.useEffect(()=>{const De=setTimeout(()=>{if(!W||!Q.trim()){ee([]);return}R9e(Q.trim(),o.current).then(ee).catch(()=>ee([]))},250);return()=>clearTimeout(De)},[Q,W]);const dt=async De=>{ae(De);try{await N9e(e,De,o.current),K(""),ee([]),await Oee(e,o.current).then(z)}catch(je){console.error(je)}finally{ae(null)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),E?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):v?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(sI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[c.jsxs("div",{className:"relative h-48 sm:h-64 bg-gray-200",children:[v.group.cover&&c.jsx("img",{src:`${WC}/uploads/${v.group.cover}`,className:"w-full h-full object-cover"}),J&&c.jsxs("label",{className:"absolute right-3 bottom-3 bg-white/80 rounded px-3 py-1 text-sm cursor-pointer",children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:De=>{var je;return rt((je=De.target.files)==null?void 0:je[0])}}),"Change cover"]})]}),c.jsx("div",{className:"px-4 sm:px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-white p-1 shadow -mt-14",children:c.jsx("div",{className:"h-full w-full rounded-full overflow-hidden bg-gray-100",children:v.group.picture&&c.jsx("img",{src:`${WC}/uploads/${v.group.picture}`,className:"w-full h-full object-cover"})})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"text-2xl font-bold truncate",children:v.group.title}),c.jsxs("div",{className:"text-gray-500 truncate",children:["@",v.group.name," · ",v.group.members," members · ",v.group.privacy]})]}),!re&&!X&&c.jsx(be,{onClick:ge,children:"Join"}),X&&c.jsx(be,{variant:"outline",disabled:!0,children:"Request sent"}),re&&c.jsx(be,{variant:"outline",onClick:Te,children:"Leave"})]})})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-6",children:[c.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-4",children:[v.group.description&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-1",children:"About"}),c.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:v.group.description})]}),de&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Create a post"}),c.jsx(wi,{value:D,onChange:De=>U(De.target.value),placeholder:"Say something…"}),c.jsx("div",{className:"mt-2 flex justify-end",children:c.jsx(be,{onClick:Pe,disabled:!D.trim(),children:"Post"})})]}),c.jsxs("div",{className:"space-y-4",children:[C===null&&k&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin mr-1"})," Loading…"]}),Array.isArray(C)&&C.map(De=>c.jsx(Vu,{post:De},De.id)),Array.isArray(C)&&C.length===0&&P&&!k&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts yet"}),!P&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>we(!1),disabled:k,children:k?"Loading…":"Load more"})})]})]}),c.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Admins"}),c.jsx("ul",{className:"space-y-2",children:(ot=v.admins)==null?void 0:ot.map(De=>c.jsxs("li",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:De.avatar&&c.jsx("img",{src:`${WC}/uploads/${Kn(De.avatar)}`,className:"w-full h-full object-cover"})}),c.jsx("div",{className:"text-sm truncate",children:De.fullName||De.username})]},De.id))}),J&&c.jsx("div",{className:"mt-3",children:c.jsxs(be,{size:"sm",onClick:()=>Y(!0),children:[c.jsx(Tm,{className:"h-4 w-4 mr-2"})," Invite member"]})})]}),J&&V&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Pending invites"}),V.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No pending invites"}):c.jsx("ul",{className:"space-y-2",children:V.map(De=>c.jsxs("li",{className:"text-sm flex items-center gap-2",children:[c.jsx("span",{className:"truncate",children:De.toUsername}),c.jsx("span",{className:"text-gray-400",children:"·"}),c.jsxs("span",{className:"text-gray-500",children:["invited by ",De.fromUsername]})]},De.inviteId))})]})]})]})]}),W&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white rounded-lg shadow w-full max-w-md p-4 relative",children:[c.jsx("button",{className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>{Y(!1),K(""),ee([])},children:c.jsx(go,{className:"h-5 w-5"})}),c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invite to group"}),c.jsx("input",{className:"w-full border rounded px-3 py-2 mb-3",placeholder:"Search users…",value:Q,onChange:De=>K(De.target.value)}),c.jsx("div",{className:"max-h-64 overflow-auto -mx-2 px-2",children:q.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"Type a name or username…"}):c.jsx("ul",{className:"divide-y",children:q.map(De=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:De.avatar&&c.jsx("img",{src:`${WC}/uploads/${Kn(De.avatar)}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:De.fullName||De.username}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",De.username]})]})]}),c.jsx(be,{size:"sm",onClick:()=>dt(Number(De.id)),disabled:oe===Number(De.id),children:oe===Number(De.id)?"...":"Invite"})]},De.id))})})]})})]}):c.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:"Group not found"})]})}const k9e="https://api.gada.chat";function j9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]),tr();const[i,o]=S.useState([]),[u,h]=S.useState(0),[p,g]=S.useState(null),[v,b]=S.useState(null),E=()=>Zw(n.current).then(R=>{g(R),h(R.length)}).catch(console.error);S.useEffect(()=>{e&&(g(null),E(),Jw(n.current).then(o).catch(()=>{}))},[e]);const T=async(R,N)=>{b(N);try{await A9e(R,N,n.current),await E()}finally{b(null)}},C=async(R,N)=>{b(N);try{await I9e(R,N,n.current),await E()}finally{b(null)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(sI,{})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"text-xl font-semibold mb-3",children:"Group Invites"}),p===null?c.jsxs("div",{className:"text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):p.length===0?c.jsx("div",{className:"text-gray-500",children:"No invites"}):c.jsx("ul",{className:"divide-y",children:p.map(R=>c.jsxs("li",{className:"py-3 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-10 w-10 rounded-full overflow-hidden bg-gray-200",children:R.group_picture&&c.jsx("img",{src:`${k9e}/uploads/${R.group_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-medium truncate",children:R.group_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",R.group_name," • invited by ",R.fromUsername]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{size:"sm",onClick:()=>T(R.group_name,R.inviteId),disabled:v===R.inviteId,children:v===R.inviteId?"...":"Accept"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>C(R.group_name,R.inviteId),disabled:v===R.inviteId,children:"Decline"})]})]},R.inviteId))})]})})]})]})}function D9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const i=tr(),[o,u]=S.useState([]),[h,p]=S.useState(0),[g,v]=S.useState({group_name:"",group_title:"",group_privacy:"public",group_category:"",group_country:"",group_description:""}),[b,E]=S.useState(!1);S.useEffect(()=>{e&&(Jw(n.current).then(u).catch(console.error),Zw(n.current).then(C=>p(C.length)).catch(()=>{}))},[e]);const T=async()=>{const{group_name:C,group_title:R,group_category:N,group_country:O}=g;if(!(!C||!R||!N||!O)&&!b){E(!0);try{await _9e({...g,group_category:Number(g.group_category),group_country:Number(g.group_country)},n.current),i(`/groups/${g.group_name}`)}catch(k){console.error(k)}finally{E(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(sI,{highlight:"discover"})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-3",children:[c.jsx("div",{className:"text-xl font-semibold",children:"Create a Group"}),c.jsx(Ne,{placeholder:"Username (handle)",value:g.group_name,onChange:C=>v({...g,group_name:C.target.value})}),c.jsx(Ne,{placeholder:"Title",value:g.group_title,onChange:C=>v({...g,group_title:C.target.value})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("select",{className:"border rounded px-2 py-2 bg-white w-full",value:g.group_privacy,onChange:C=>v({...g,group_privacy:C.target.value}),children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"closed",children:"Closed (approval)"}),c.jsx("option",{value:"secret",children:"Secret (invite only)"})]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white w-full",value:g.group_category,onChange:C=>v({...g,group_category:C.target.value}),children:[c.jsx("option",{value:"",children:"Select category"}),o.map(C=>c.jsx("option",{value:C.category_id,children:C.category_name},C.category_id))]})]}),c.jsx(Ne,{placeholder:"Country ID (numeric)",value:g.group_country,onChange:C=>v({...g,group_country:C.target.value})}),c.jsx(wi,{placeholder:"Description",value:g.group_description,onChange:C=>v({...g,group_description:C.target.value})}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:T,disabled:b,children:b?"Creating…":"Create"})})]})})]})]})}const Yu="https://api.gada.chat";function Xfe(e={}){return{"Content-Type":"application/json",...e}}async function OB(e){const t=await fetch(`${Yu}/api/events/categories`,{headers:e});if(!t.ok)throw new Error("categories");return t.json()}async function L9e(e,t){const n=new URL(`${Yu}/api/events`);Object.entries(e).forEach(([o,u])=>{u!=null&&u!==""&&n.searchParams.set(o,String(u))});const i=await fetch(n.toString(),{headers:t});if(!i.ok)throw new Error("events");return i.json()}async function kee(e,t){const n=await fetch(`${Yu}/api/events/${e}`,{headers:t});if(!n.ok)throw new Error("event");return n.json()}async function jee(e,t){const n=await fetch(`${Yu}/api/events/${e}/members`,{headers:t});if(!n.ok)throw new Error("members");return n.json()}async function M9e(e,t,n){const i=await fetch(`${Yu}/api/events/${e}/rsvp`,{method:"POST",headers:Xfe(n),body:JSON.stringify({status:t})});if(!i.ok)throw new Error("rsvp");return i.json()}async function Jfe(e){const t=await fetch(`${Yu}/api/events/invites/me`,{headers:e});if(!t.ok)throw new Error("my invites");return t.json()}async function U9e(e,t,n){const i=new FormData;Object.entries(e).forEach(([h,p])=>i.append(h,String(p??""))),t&&i.append("cover",t);const o=await fetch(`${Yu}/api/events`,{method:"POST",headers:{...n},body:i});if(!o.ok)throw new Error("create");return(await o.json()).id}async function F9e(e,t,n){const i=new FormData;i.append("cover",t);const o=await fetch(`${Yu}/api/events/${e}`,{method:"PATCH",headers:{...n},body:i});if(!o.ok)throw new Error("cover");return o.json()}async function V9e(e,t,n){const i=await fetch(`${Yu}/api/events/${e}/invite`,{method:"POST",headers:Xfe(n),body:JSON.stringify({userId:t})});if(!i.ok)throw new Error("invite");return i.json()}async function B9e(e,t){const n=new URL(`${Yu}/api/users/suggest`);console.log(encodeURIComponent(e),"encodeURIComponent(q)"),n.searchParams.set("q",encodeURIComponent(e));const i=await fetch(n.toString(),{headers:t});if(!i.ok)throw new Error("suggest-users");return i.json()}function oI({highlight:e=null,cats:t,invCount:n}){const{accessToken:i}=st(),o=wt(i),u=S.useRef(o);S.useEffect(()=>{u.current=o},[o]);const[h,p]=S.useState(t??[]),[g,v]=S.useState(n??0);Jy(),S.useEffect(()=>{if(t){p(t);return}i&&OB(u.current).then(p).catch(()=>{})},[i,t]),S.useEffect(()=>{if(typeof n=="number"){v(n);return}i&&Jfe(u.current).then(E=>v(E.length)).catch(()=>{})},[i,n]);const b=E=>e===E?"bg-gray-50":"";return c.jsxs("div",{className:"md:sticky md:top-20 bg-white rounded-lg shadow p-3 space-y-2",children:[c.jsxs("div",{className:"text-sm font-semibold text-gray-700 mb-1 flex items-center",children:[c.jsx(O4,{className:"h-4 w-4 mr-2"})," Events"]}),c.jsxs(Nt,{to:"/events",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(Sf,{className:"h-4 w-4 mr-2"})," Discover"]}),c.jsxs(Nt,{to:"/events?my=going",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(A0,{className:"h-4 w-4 mr-2"})," Your Events"]}),c.jsxs(Nt,{to:"/events/invites",className:`flex items-center justify-between px-3 py-2 rounded hover:bg-gray-100 ${b("invites")}`,children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(L4,{className:"h-4 w-4 mr-2"})," Invites"]}),g>0&&c.jsx("span",{className:"text-xs bg-[#1877F2] text-white rounded-full px-2 py-0.5",children:g})]}),c.jsxs(Nt,{to:"/events/create",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(D4,{className:"h-4 w-4 mr-2"})," Create Event"]}),c.jsx("div",{className:"h-px bg-gray-200 my-2"}),c.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide px-1 mb-1",children:"Categories"}),c.jsxs("div",{className:"max-h-64 overflow-auto pr-1 space-y-1",children:[c.jsx(Nt,{to:"/events",className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:"All"}),h.map(E=>c.jsx(Nt,{to:`/events?categoryId=${E.category_id}`,className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:E.category_name},E.category_id))]})]})}const $9e="https://api.gada.chat";function W9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const[i,o]=Jy(),[u,h]=S.useState(i.get("q")||""),[p,g]=S.useState(i.get("categoryId")?Number(i.get("categoryId")):""),[v,b]=S.useState(i.get("when")||"upcoming"),[E,T]=S.useState([]),[C,R]=S.useState(null),[N,O]=S.useState(null),[k,j]=S.useState(!1),[P,M]=S.useState(!1);S.useEffect(()=>{const U=i.get("q")||"",V=i.get("categoryId")?Number(i.get("categoryId")):"",z=i.get("when")||"upcoming";U!==u&&h(U),V!==p&&g(V),z!==v&&b(z)},[i.toString()]),S.useEffect(()=>{const U={};u&&(U.q=u),p&&(U.categoryId=p),v&&v!=="upcoming"&&(U.when=v),o(U,{replace:!0})},[u,p,v]),S.useEffect(()=>{e&&OB(n.current).then(T).catch(()=>{})},[e]),S.useEffect(()=>{e&&(R(null),O(null),M(!1),Promise.resolve().then(()=>D(!0)))},[u,p,v,e]);const D=async(U=!1)=>{if(!k&&!(!U&&P)){j(!0);try{const{items:V,nextCursor:z}=await L9e({q:u.trim(),categoryId:p||void 0,when:v,cursor:U?void 0:N,limit:12},n.current);R(W=>W?[...W,...V]:V),O(z??null),(!z||V.length===0)&&M(!0)}finally{j(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(oI,{highlight:"discover"})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[c.jsx(Ne,{value:u,onChange:U=>h(U.target.value),placeholder:"Search events…",className:"max-w-sm"}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:p,onChange:U=>g(U.target.value?Number(U.target.value):""),children:[c.jsx("option",{value:"",children:"All categories"}),E.map(U=>c.jsx("option",{value:U.category_id,children:U.category_name},U.category_id))]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:v,onChange:U=>b(U.target.value),children:[c.jsx("option",{value:"upcoming",children:"Upcoming"}),c.jsx("option",{value:"today",children:"Today"}),c.jsx("option",{value:"week",children:"This week"}),c.jsx("option",{value:"month",children:"This month"}),c.jsx("option",{value:"past",children:"Past"})]})]}),C===null&&c.jsxs("div",{className:"text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.isArray(C)&&C.map(U=>c.jsxs(Nt,{to:`/events/${U.id}`,className:"bg-white rounded-lg shadow hover:shadow-md transition",children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:U.cover&&c.jsx("img",{src:`${$9e}/uploads/${U.cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsx("div",{className:"font-semibold line-clamp-1",children:U.title}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(U.startAt).toLocaleString()}),c.jsx("div",{className:"text-xs text-gray-600 mt-1",children:U.location}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[U.stats.going," going · ",U.stats.interested," interested"]})]})]},U.id))}),!P&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>D(!1),disabled:k,children:k?"Loading…":"Load more"})})]})]})]})}function G9e(){const{accessToken:e}=st(),t=Hl(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const[i,o]=S.useState([]),[u,h]=S.useState(""),[p,g]=S.useState(""),[v,b]=S.useState(""),[E,T]=S.useState(161),[C,R]=S.useState(16),[N,O]=S.useState("public"),[k,j]=S.useState(""),[P,M]=S.useState(""),[D,U]=S.useState(""),[V,z]=S.useState(""),[W,Y]=S.useState(null),[Q,K]=S.useState(!1),q=tr();S.useEffect(()=>{e&&OB(n.current).then(o).catch(()=>{})},[e]);const ee=async()=>{if(!(!u.trim()||!p.trim()||!k||!P||!C)){K(!0);try{const oe=await U9e({title:u,description:p,location:v,countryId:E,categoryId:C,privacy:N,startAt:new Date(k).toISOString(),endAt:new Date(P).toISOString(),ticketsLink:D||null,prices:V||null},W,n.current);q(`/events/${oe}`)}catch(oe){console.error(oe)}finally{K(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(oI,{highlight:"create",cats:i})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-4",children:[c.jsx("div",{className:"text-lg font-semibold",children:"Create Event"}),c.jsx(Ne,{value:u,onChange:oe=>h(oe.target.value),placeholder:"Title"}),c.jsx(wi,{value:p,onChange:oe=>g(oe.target.value),placeholder:"Description"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(Ne,{value:v,onChange:oe=>b(oe.target.value),placeholder:"Location"}),c.jsx(Ne,{value:E,onChange:oe=>T(Number(oe.target.value)||161),placeholder:"Country ID"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx("select",{className:"border rounded px-2 py-2 bg-white",value:C,onChange:oe=>R(Number(oe.target.value)),children:i.map(oe=>c.jsx("option",{value:oe.category_id,children:oe.category_name},oe.category_id))}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:N,onChange:oe=>O(oe.target.value),children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"closed",children:"Closed"}),c.jsx("option",{value:"secret",children:"Secret"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(Ne,{type:"datetime-local",value:k,onChange:oe=>j(oe.target.value)}),c.jsx(Ne,{type:"datetime-local",value:P,onChange:oe=>M(oe.target.value)})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(Ne,{value:D,onChange:oe=>U(oe.target.value),placeholder:"Tickets link (optional)"}),c.jsx(Ne,{value:V,onChange:oe=>z(oe.target.value),placeholder:"Prices (optional)"})]}),c.jsx("div",{children:c.jsx("input",{type:"file",accept:"image/*",onChange:oe=>{var ae;return Y(((ae=oe.target.files)==null?void 0:ae[0])||null)}})}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:ee,disabled:Q||!u.trim()||!p.trim()||!k||!P,children:Q?"Creating…":"Create Event"})})]})})]})]})}const H9e="https://api.gada.chat";function z9e(){const{accessToken:e}=st(),t=wt(e),n=S.useRef(t);S.useEffect(()=>{n.current=t},[t]);const[i,o]=S.useState(null);return S.useEffect(()=>{e&&Jfe(n.current).then(o).catch(()=>o([]))},[e]),c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(oI,{highlight:"invites"})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invites"}),i?i.length===0?c.jsx("div",{className:"text-gray-500",children:"No invites"}):c.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(u=>c.jsx("li",{className:"bg-white rounded-lg shadow",children:c.jsxs(Nt,{to:`/events/${u.id}`,children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:u.cover&&c.jsx("img",{src:`${H9e}/uploads/${u.cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsx("div",{className:"font-semibold line-clamp-1",children:u.title}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(u.startAt).toLocaleString()})]})]})},u.id))}):c.jsx("div",{className:"text-gray-500",children:"Loading…"})]})})]})]})}const yL="https://api.gada.chat";function K9e(){var Y,Q,K,q,ee,oe;const{id:e}=tc(),{accessToken:t,user:n}=st(),i=wt(t),o=S.useRef(i);S.useEffect(()=>{o.current=i},[i]);const[u,h]=S.useState(null),[p,g]=S.useState(!0),[v,b]=S.useState(!1),[E,T]=S.useState(null),[C,R]=S.useState(!1),[N,O]=S.useState(""),[k,j]=S.useState([]),[P,M]=S.useState(null),D=!!((Y=u==null?void 0:u.admins)!=null&&Y.some(ae=>String(ae.id)===String(n==null?void 0:n.id)))||String((Q=u==null?void 0:u.event)==null?void 0:Q.adminId)===String(n==null?void 0:n.id);S.useEffect(()=>{if(!t||!e)return;let ae=!1;return g(!0),kee(e,o.current).then(J=>!ae&&h(J)).catch(console.error).finally(()=>!ae&&g(!1)),()=>{ae=!0}},[t,e]),S.useEffect(()=>{!t||!e||jee(e,o.current).then(T).catch(()=>T([]))},[t,e]),S.useEffect(()=>{const ae=setTimeout(()=>{if(!C||!N.trim()){j([]);return}B9e(N.trim(),o.current).then(j).catch(()=>j([]))},250);return()=>clearTimeout(ae)},[C,N]);const U=async ae=>{if(!(!e||v)){b(!0);try{await M9e(e,ae,o.current);const J=await kee(e,o.current);h(J);const re=await jee(e,o.current);T(re)}finally{b(!1)}}};function V(ae,J){const re=String(J),X=ae.findIndex(de=>String(de.id)===re);X!==-1&&ae.splice(X,1)}const z=async ae=>{if(e){M(ae);try{await V9e(e,ae,o.current),V(k,ae)}catch(J){console.error(J)}finally{M(null)}}},W=async ae=>{if(!(!ae||!e))try{const J=await F9e(e,ae,o.current);h(re=>re&&{...re,event:{...re.event,cover:J.cover}})}catch(J){console.error(J)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),p?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:[c.jsx(si,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):u?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(oI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[c.jsxs("div",{className:"relative h-48 sm:h-64 bg-gray-200",children:[u.event.cover&&c.jsx("img",{src:`${yL}/uploads/${u.event.cover}`,className:"w-full h-full object-cover"}),D&&c.jsxs("label",{className:"absolute right-3 bottom-3 bg-white/80 rounded px-3 py-1 text-sm cursor-pointer",children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:ae=>{var J;return W((J=ae.target.files)==null?void 0:J[0])}}),"Change cover"]})]}),c.jsxs("div",{className:"px-4 sm:px-6 py-4",children:[c.jsx("div",{className:"text-2xl font-bold",children:u.event.title}),c.jsxs("div",{className:"text-gray-600 mt-1 flex flex-wrap gap-4",children:[c.jsxs("span",{className:"inline-flex items-center",children:[c.jsx(O4,{className:"h-4 w-4 mr-2"}),new Date(u.event.startAt).toLocaleString()," – ",new Date(u.event.endAt).toLocaleString()]}),u.event.location&&c.jsxs("span",{className:"inline-flex items-center",children:[c.jsx(XVe,{className:"h-4 w-4 mr-2"}),u.event.location]}),u.event.ticketsLink&&c.jsxs("a",{href:u.event.ticketsLink,target:"_blank",className:"inline-flex items-center text-[#1877F2]",children:[c.jsx(qVe,{className:"h-4 w-4 mr-1"})," Tickets"]})]}),c.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[c.jsx(be,{variant:(K=u.my)!=null&&K.interested?"default":"outline",onClick:()=>U("interested"),disabled:v,children:"Interested"}),c.jsx(be,{variant:(q=u.my)!=null&&q.going?"default":"outline",onClick:()=>U("going"),disabled:v,children:"Going"}),c.jsxs(be,{variant:"outline",onClick:()=>R(!0),children:[c.jsx(Tm,{className:"h-4 w-4 mr-2"})," Invite people"]}),(((ee=u.my)==null?void 0:ee.interested)||((oe=u.my)==null?void 0:oe.going))&&c.jsx(be,{variant:"ghost",onClick:()=>U("none"),disabled:v,children:"Remove response"}),c.jsxs("div",{className:"ml-auto text-sm text-gray-600",children:[u.event.stats.going," going · ",u.event.stats.interested," interested"]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-6",children:[c.jsx("div",{className:"col-span-12 lg:col-span-8 space-y-4",children:u.event.description&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-1",children:"About"}),c.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:u.event.description})]})}),c.jsx("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Attendees"}),E?E.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No attendees yet"}):c.jsx("ul",{className:"space-y-2",children:E.slice(0,12).map(ae=>c.jsxs("li",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 overflow-hidden",children:ae.avatar&&c.jsx("img",{src:`${yL}/uploads/${ae.avatar}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"text-sm truncate",children:[ae.fullName||ae.username,ae.going?c.jsx("span",{className:"text-xs text-green-600 ml-2",children:"Going"}):ae.interested?c.jsx("span",{className:"text-xs text-amber-600 ml-2",children:"Interested"}):null]})]},ae.id))}):c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"})]})})]})]}),C&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white rounded-lg shadow w-full max-w-md p-4 relative",children:[c.jsx("button",{className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>{R(!1),O(""),j([])},children:c.jsx(go,{className:"h-5 w-5"})}),c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invite people"}),c.jsx("input",{className:"w-full border rounded px-3 py-2 mb-3",placeholder:"Search users…",value:N,onChange:ae=>O(ae.target.value)}),c.jsx("div",{className:"max-h-64 overflow-auto -mx-2 px-2",children:k.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"Type a name or username…"}):c.jsx("ul",{className:"divide-y",children:k.map(ae=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:ae.avatar&&c.jsx("img",{src:`${yL}/uploads/${ae.avatar}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:ae.fullName||ae.username}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",ae.username]})]})]}),c.jsx(be,{size:"sm",onClick:()=>z(Number(ae.id)),disabled:P===Number(ae.id),children:P===Number(ae.id)?"...":"Invite"})]},ae.id))})})]})})]}):c.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:"Event not found"})]})}const GC="https://api.gada.chat".replace(/\/+$/,"");function q9e({post:e,onEnded:t}){const{user:n}=st(),{likePost:i,commentPost:o,deletePost:u,sharePost:h,toggleSave:p}=w1(),g=S.useMemo(()=>{var re,X;return n?(e==null?void 0:e.hasLiked)===!0||((X=(re=e==null?void 0:e.likes)==null?void 0:re.some)==null?void 0:X.call(re,de=>String(de.userId)===String(n.id))):!!(e!=null&&e.hasLiked)},[e==null?void 0:e.hasLiked,e==null?void 0:e.likes,n]),v=S.useMemo(()=>Array.isArray(e==null?void 0:e.likes)?e.likes.length:Number((e==null?void 0:e.likeCount)??0),[e==null?void 0:e.likes,e==null?void 0:e.likeCount]),[b,E]=S.useState(g),[T,C]=S.useState(v),[R,N]=S.useState(!1);S.useEffect(()=>{E(g),C(v)},[g,v,e==null?void 0:e.id]);const O=b,[k,j]=S.useState(!1),[P,M]=S.useState(""),[D,U]=S.useState(!1),[V,z]=S.useState(!1),W=S.useRef(null),Y=S.useRef(null),[Q,K]=S.useState(!0);S.useEffect(()=>{const re=Y.current,X=W.current;if(!re||!X)return;const de=new IntersectionObserver(([we])=>{we.isIntersecting&&we.intersectionRatio>=.6?X.play().catch(()=>{}):X.pause()},{threshold:[0,.6,1]});return de.observe(re),()=>de.disconnect()},[]),S.useEffect(()=>{const re=W.current;if(!re||!t)return;const X=()=>t();return re.addEventListener("ended",X),()=>re.removeEventListener("ended",X)},[t]);const q=()=>{const re=W.current;re&&(re.muted=!re.muted,K(re.muted))},ee=async()=>{if(!n||R)return;const re=!b;E(re),N(!0),C(X=>Math.max(0,X+(re?1:-1)));try{await i(e.id)}catch(X){E(!re),C(de=>Math.max(0,de+(re?-1:1))),console.error(X)}finally{N(!1)}},oe=re=>{re.preventDefault(),!(!n||!P.trim())&&(o(e.id,P),M(""))},ae=()=>{n&&u(e.id)},J=re=>re.split(" ").map(X=>X[0]).join("").toUpperCase();return c.jsx("div",{ref:Y,children:c.jsxs(Vr,{className:"mb-6 overflow-hidden",children:[c.jsxs(pa,{className:"p-4 pb-2 flex items-start",children:[c.jsxs("div",{className:"flex-1 flex items-center space-x-3",children:[c.jsx(Nt,{to:`/profile/${e.author.id}`,children:c.jsx($i,{children:e.author.profileImage?c.jsx(Oi,{src:`${GC}/uploads/${Kn(e.author.profileImage)}`,alt:e.author.username}):c.jsx(Qi,{children:J(e.author.username)})})}),c.jsxs("div",{children:[c.jsx(Nt,{to:`/profile/${e.author.id}`,className:"font-semibold hover:underline",children:e.author.username}),c.jsx("p",{className:"text-sm text-gray-500",children:bN(e.createdAt)})]})]}),c.jsxs(tB,{children:[c.jsx(nB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8",children:c.jsx(Yce,{className:"h-5 w-5"})})}),n&&String(n.id)===String(e.author.id)&&c.jsx(M1,{align:"end",children:c.jsx(Dc,{onClick:ae,className:"text-red-600",children:"Delete post"})})]})]}),c.jsxs(mi,{className:"p-0",children:[e.content&&c.jsx("p",{className:"px-4 pt-2 pb-3",children:e.content}),c.jsxs("div",{className:"relative bg-black",children:[c.jsx("video",{ref:W,src:`${GC}/uploads/${Kn(e.videos[0])}`,className:"w-full max-h-[70vh] object-contain",controls:!1,playsInline:!0,muted:Q,preload:"metadata"}),c.jsx("button",{onClick:q,className:"absolute right-3 bottom-3 bg-white/80 rounded-full p-2",title:Q?"Unmute":"Mute",children:Q?c.jsx(h4e,{className:"h-5 w-5"}):c.jsx(d4e,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-sm text-gray-500",children:[T>0&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(P0,{className:"h-4 w-4 text-[#1877F2]"}),c.jsx("span",{children:T})]}),e.comments.length>0&&c.jsxs("div",{children:[e.comments.length," comments"]}),c.jsxs("div",{children:[e.shareCount??e.shares??0," shares"]})]})]}),c.jsx(e_,{className:"p-0",children:c.jsxs("div",{className:"grid grid-cols-3 w-full",children:[c.jsxs(be,{variant:"ghost",onClick:ee,"aria-pressed":O,disabled:R,className:`flex items-center justify-center py-2 rounded-none ${O?"text-[#1877F2]":"text-gray-600"}`,children:[c.jsx(P0,{className:`h-5 w-5 mr-1 ${O?"fill-[#1877F2] text-[#1877F2]":""}`}),"Like"]}),c.jsxs(be,{variant:"ghost",onClick:()=>j(!k),className:"flex items-center justify-center py-2 rounded-none text-gray-600",children:[c.jsx(Mw,{className:"h-5 w-5 mr-1"}),"Comment"]}),c.jsxs(be,{variant:"ghost",className:"flex items-center justify-center py-2 rounded-none text-gray-600",onClick:()=>z(!0),children:[c.jsx(T1,{className:"h-5 w-5 mr-1"}),"Share"]})]})}),c.jsx(eue,{isOpen:V,onClose:()=>z(!1),onShare:re=>h(e.id,re)}),(e.comments.length>0||k)&&c.jsxs("div",{className:"p-4 pt-0",children:[c.jsx("div",{className:"h-px bg-gray-200 my-4"}),e.comments.length>0&&c.jsxs("div",{className:"space-y-3 mb-4",children:[(D?e.comments:e.comments.slice(0,2)).map(re=>c.jsxs("div",{className:"flex space-x-2",children:[c.jsx($i,{className:"h-8 w-8",children:re.profileImage?c.jsx(Oi,{src:`${GC}/uploads/${Kn(re.profileImage)}`,alt:re.username}):c.jsx(Qi,{children:J(re.username)})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 px-3",children:[c.jsx(Nt,{to:`/profile/${re.userId}`,className:"font-semibold hover:underline",children:re.username}),c.jsx("p",{className:"text-sm",children:re.content})]}),c.jsxs("div",{className:"flex space-x-3 text-xs text-gray-500 mt-1 ml-2",children:[c.jsx("span",{children:bN(re.createdAt)}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Like"}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Reply"})]})]})]},re.id)),e.comments.length>2&&c.jsx(be,{variant:"ghost",onClick:()=>U(!D),className:"text-gray-600 pl-0 pb-0",children:D?"Show fewer comments":`View all ${e.comments.length} comments`})]}),(k||e.comments.length>0)&&n&&c.jsxs("form",{onSubmit:oe,className:"flex space-x-2",children:[c.jsx($i,{className:"h-8 w-8",children:n.profileImage?c.jsx(Oi,{src:`${GC}/uploads/${Kn(n.profileImage)}`,alt:n.username}):c.jsx(Qi,{children:J(n.username)})}),c.jsx("input",{className:"flex-1 rounded-full border px-3 py-2 text-sm",placeholder:"Write a comment...",value:P,onChange:re=>M(re.target.value)}),c.jsx(be,{type:"submit",size:"sm",disabled:!P.trim(),children:"Post"})]})]})]})})}const Y9e="https://api.gada.chat".replace(/\/+$/,"")||"http://localhost:8085";async function X9e(e,t){const n=new URL(`${Y9e}/api/watch`);n.searchParams.set("limit",String(e.limit)),e.cursor&&n.searchParams.set("cursor",String(e.cursor));const i=await fetch(n.toString(),{headers:t});if(!i.ok)throw new Error("watch-feed");return i.json()}function J9e(){const{accessToken:e,isLoading:t}=st(),n=wt(e),i=S.useRef(n);S.useEffect(()=>{i.current=n},[n]);const[o,u]=S.useState(null),[h,p]=S.useState(null),[g,v]=S.useState(!1),[b,E]=S.useState(!1);S.useEffect(()=>{t||e&&(u(null),p(null),E(!1),T(!0))},[t,e]);const T=async(R=!1)=>{if(!g&&!(!R&&b)){v(!0);try{const{items:N,nextCursor:O}=await X9e({limit:8,cursor:R?null:h},i.current);u(k=>k?[...k,...N]:N),p(O??null),(!O||N.length===0)&&E(!0)}finally{v(!1)}}};S.useEffect(()=>{const R=()=>{if(g||b)return;window.innerHeight+window.scrollY>=document.body.offsetHeight-800&&T(!1)};return window.addEventListener("scroll",R),()=>window.removeEventListener("scroll",R)},[g,b]);const C=R=>{const N=document.querySelectorAll("[data-watch-card]")[R+1];N&&N.scrollIntoView({behavior:"smooth",block:"center"})};return t||o===null?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(si,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsxs("div",{className:"space-y-6 py-6",children:[o.map((R,N)=>c.jsx("div",{"data-watch-card":!0,children:c.jsx(q9e,{post:R,onEnded:()=>C(N)})},R.id)),!b&&c.jsx("div",{className:"flex justify-center py-4",children:c.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 rounded bg-[#1877F2] text-white disabled:opacity-50",disabled:g,children:g?"Loading…":"Load more"})})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-96 min-h-0 overflow-y-auto pt-6",children:c.jsx(q1,{})})]})})]})}const PB="https://api.gada.chat";async function Dee(e){const t=await fetch(`${PB}/api/affiliates/overview`,{headers:e});if(!t.ok)throw new Error("overview failed");return t.json()}async function Z9e(e,t={}){const n=new URLSearchParams;t.page&&n.set("page",String(t.page)),t.limit&&n.set("limit",String(t.limit)),t.level&&n.set("level",String(t.level)),t.search&&n.set("search",t.search);const i=await fetch(`${PB}/api/affiliates/referrals?`+n.toString(),{headers:e});if(!i.ok)throw new Error("referrals failed");return i.json()}async function Q9e(e,t){const n=await fetch(`${PB}/api/affiliates/transfer`,{method:"POST",headers:{...e,"Content-Type":"application/json"},body:JSON.stringify({amount:t})});if(!n.ok)throw new Error(await n.text());return n.json()}function Lee({url:e,text:t="Join me here!",title:n="Check this out",className:i,size:o="sm",fbAppId:u,fbRedirectUri:h}){if(!e)return null;const p=encodeURIComponent(e),g=encodeURIComponent(t),v=encodeURIComponent(n),b=[{key:"facebook",label:"Facebook",href:`https://www.facebook.com/sharer/sharer.php?u=${p}`,color:"#1877F2"},{key:"x",label:"X",href:`https://twitter.com/intent/tweet?url=${p}&text=${g}`,color:"#000000"},{key:"linkedin",label:"LinkedIn",href:`https://www.linkedin.com/sharing/share-offsite/?url=${p}`,color:"#0A66C2"},{key:"whatsapp",label:"WhatsApp",href:`https://api.whatsapp.com/send?text=${g}%20${p}`,color:"#25D366"},{key:"telegram",label:"Telegram",href:`https://t.me/share/url?url=${p}&text=${g}`,color:"#0088CC"},{key:"reddit",label:"Reddit",href:`https://www.reddit.com/submit?url=${p}&title=${v}`,color:"#FF4500"},{key:"email",label:"Email",href:`mailto:?subject=${v}&body=${g}%0A%0A${p}`,color:"#475569"},{key:"messenger",label:"Messenger",href:`https://www.facebook.com/dialog/send?link=${p}&app_id=${encodeURIComponent(u||"")}&redirect_uri=${encodeURIComponent(h||"")}`,color:"#1877F2",hidden:!u||!h}],E=typeof navigator<"u"&&!!navigator.share,T=async()=>{try{await navigator.share({title:n,text:t,url:e})}catch{}},C=o==="sm"?"h-8 px-2 text-[12px]":"h-9 px-3 text-[13px]";return c.jsxs("div",{className:er("flex flex-wrap items-center gap-2",i),children:[E&&c.jsxs(be,{type:"button",onClick:T,className:er(C,"rounded-full bg-gray-900 hover:bg-gray-800"),children:[c.jsx(T1,{className:"h-4 w-4 mr-2"}),"Share…"]}),b.filter(R=>!R.hidden).map(R=>c.jsx("a",{href:R.href,target:"_blank",rel:"noreferrer noopener",className:er(C,"inline-flex items-center rounded-full text-white font-medium"),style:{backgroundColor:R.color},"aria-label":`Share on ${R.label}`,title:`Share on ${R.label}`,children:R.label},R.key))]})}const e7e="https://api.gada.chat",t7e=e=>(e||"?").split(" ").filter(Boolean).map(t=>t[0].toUpperCase()).slice(0,2).join(""),n7e=e=>`₦${(isNaN(e)?0:e).toLocaleString(void 0,{maximumFractionDigits:2})}`;function r7e(){var W,Y,Q;const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(null),[o,u]=S.useState(!1),[h,p]=S.useState(null),[g,v]=S.useState(1),[b,E]=S.useState(1),[T,C]=S.useState(10),[R,N]=S.useState(""),[O,k]=S.useState(null),j=S.useMemo(()=>O?Math.max(1,Math.ceil((O.total||0)/T)):1,[O,T]);S.useEffect(()=>{e&&(u(!0),p(null),Dee(t).then(i).catch(K=>p(String((K==null?void 0:K.message)||"Failed to load"))).finally(()=>u(!1)))},[e]),S.useEffect(()=>{e&&Z9e(t,{page:b,limit:T,level:g,search:R}).then(K=>k({items:K.items||[],total:K.total||0})).catch(console.error)},[e,b,T,g,R]);const[P,M]=S.useState(!1),D=async()=>{if(n!=null&&n.shareLink)try{await navigator.clipboard.writeText(n.shareLink),M(!0),setTimeout(()=>M(!1),1500)}catch{}},[U,V]=S.useState(""),z=async()=>{if(n)try{const K=Number(U);if(!Number.isFinite(K)||K<=0)return;await Q9e(t,K);const q=await Dee(t);Ce.success("Balance transfered successfully!"),i(q),V("")}catch(K){alert((K==null?void 0:K.message)||"Transfer failed")}};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx(Ss,{})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsxs("div",{className:"rounded-xl bg-cyan-50 text-cyan-900 border border-cyan-200 p-4",children:[c.jsx("div",{className:"font-semibold",children:"Affiliates System"}),c.jsxs("div",{className:"text-sm opacity-90",children:["Earn up to multi-level commissions when people join via your link. Earn up to ",(W=n==null?void 0:n.settings)==null?void 0:W.level1per,"% (Level 1) , ",(Y=n==null?void 0:n.settings)==null?void 0:Y.level2per,"% (Level 2) , ",(Q=n==null?void 0:n.settings)==null?void 0:Q.level3per,"% (Level 3) From the package of your refered user. You will be paid when new user registered & bought a package. your affiliate balance to your wallet."]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0 w-full",children:[c.jsx("div",{className:"font-medium text-sm text-gray-700",children:"Your affiliate link"}),c.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[c.jsx(Ne,{value:(n==null?void 0:n.shareLink)||"",readOnly:!0,className:"bg-gray-50 flex-1"}),c.jsxs(be,{variant:"outline",onClick:D,className:"shrink-0",children:[P?c.jsx(Dw,{className:"h-4 w-4 mr-2"}):c.jsx(VVe,{className:"h-4 w-4 mr-2"}),P?"Copied":"Copy"]}),c.jsx("div",{className:"hidden md:block",children:c.jsx(Lee,{url:(n==null?void 0:n.shareLink)||"",title:"Join me on Gada Chat",text:"Sign up using my invitation link!"})})]}),c.jsx("div",{className:"mt-3 md:hidden",children:c.jsx(Lee,{url:(n==null?void 0:n.shareLink)||"",title:"Join me on Gada Chat",text:"Sign up using my invitation link!"})})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Affiliates Money Balance"}),c.jsx("div",{className:"mt-1 text-3xl font-semibold",children:n7e(Number((n==null?void 0:n.balance.affiliate)||0))})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Amount (₦)"}),c.jsx(Ne,{type:"number",min:0,step:"0.01",placeholder:"Enter amount",value:U,onChange:K=>V(K.target.value),className:"h-11"})]}),c.jsx(be,{onClick:z,disabled:!(n!=null&&n.settings.transferEnabled)||!U||Number(U)<=0,className:"h-11 px-6 w-full sm:w-auto",children:"Transfer to Wallet"})]}),!(n!=null&&n.settings.transferEnabled)&&c.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Transfers are currently disabled by admin."})]}),n&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:n.referrals.perLevel.map((K,q)=>c.jsxs("div",{className:"rounded-xl bg-white shadow p-4 text-center",children:[c.jsxs("div",{className:"text-xs text-gray-500",children:["Level ",q+1]}),c.jsx("div",{className:"text-xl font-semibold",children:K})]},q))}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Show"}),c.jsx("select",{value:T,onChange:K=>{E(1),C(Number(K.target.value))},className:"h-9 rounded-md border border-gray-300 px-2 text-sm",children:[10,20,50].map(K=>c.jsxs("option",{value:K,children:[K," / page"]},K))}),c.jsx("select",{value:g,onChange:K=>{E(1),v(Number(K.target.value))},className:"h-9 rounded-md border border-gray-300 px-2 text-sm",children:Array.from({length:Math.max(1,(n==null?void 0:n.settings.levels)||1)}).map((K,q)=>c.jsxs("option",{value:q+1,children:["Level ",q+1]},q))})]}),c.jsxs("div",{className:"relative w-full md:w-80",children:[c.jsx(Sf,{className:"h-4 w-4 text-gray-400 absolute left-3 top-2.5"}),c.jsx(Ne,{placeholder:"Search by name or username",value:R,onChange:K=>{E(1),N(K.target.value)},className:"pl-9 bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-0",children:O?O.items.length===0?c.jsx("div",{className:"p-6 text-gray-500",children:"No referrals found"}):c.jsx("div",{className:"max-h-[420px] overflow-y-auto pr-2",children:c.jsx("ul",{className:"divide-y",children:O.items.map(K=>c.jsxs("li",{className:"px-4 py-3 flex items-center gap-3",children:[c.jsxs($i,{className:"h-9 w-9",children:[c.jsx(Oi,{src:K.avatar?`${e7e}/uploads/${Kn(K.avatar)}`:""}),c.jsx(Qi,{children:t7e(K.fullName||K.username)})]}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"font-medium truncate",children:K.fullName||K.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",K.username]})]}),c.jsx("div",{className:"text-xs text-gray-500",children:K.joinedAt?new Date(K.joinedAt).toLocaleDateString():""})]},K.id))})}):c.jsxs("div",{className:"p-6 text-gray-500 flex items-center gap-2",children:[c.jsx(si,{className:"h-4 w-4 animate-spin"})," Loading…"]})}),c.jsxs("div",{className:"flex items-center justify-center gap-2 pb-6",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:b<=1,onClick:()=>E(K=>K-1),children:c.jsx(P4,{className:"h-4 w-4"})}),c.jsxs("div",{className:"text-sm",children:[Math.min(b,j)," / ",j]}),c.jsx(be,{variant:"outline",size:"sm",disabled:b>=j,onClick:()=>E(K=>K+1),children:c.jsx(Lw,{className:"h-4 w-4"})})]})]})]})})]})}function pm(e){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(e)}function i7e(e,t){if(pm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(pm(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zfe(e){var t=i7e(e,"string");return pm(t)=="symbol"?t:t+""}function BE(e,t,n){return(t=Zfe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mee(Object(n),!0).forEach(function(i){BE(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mee(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function a7e(e){if(Array.isArray(e))return e}function s7e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function $U(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Qfe(e,t){if(e){if(typeof e=="string")return $U(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$U(e,t):void 0}}function o7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Od(e,t){return a7e(e)||s7e(e,t)||Qfe(e,t)||o7e()}function c7e(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Xd(e,t){if(e==null)return{};var n,i,o=c7e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(i=0;i<u.length;i++)n=u[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l7e=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function u7e(e){var t=e.defaultInputValue,n=t===void 0?"":t,i=e.defaultMenuIsOpen,o=i===void 0?!1:i,u=e.defaultValue,h=u===void 0?null:u,p=e.inputValue,g=e.menuIsOpen,v=e.onChange,b=e.onInputChange,E=e.onMenuClose,T=e.onMenuOpen,C=e.value,R=Xd(e,l7e),N=S.useState(p!==void 0?p:n),O=Od(N,2),k=O[0],j=O[1],P=S.useState(g!==void 0?g:o),M=Od(P,2),D=M[0],U=M[1],V=S.useState(C!==void 0?C:h),z=Od(V,2),W=z[0],Y=z[1],Q=S.useCallback(function(re,X){typeof v=="function"&&v(re,X),Y(re)},[v]),K=S.useCallback(function(re,X){var de;typeof b=="function"&&(de=b(re,X)),j(de!==void 0?de:re)},[b]),q=S.useCallback(function(){typeof T=="function"&&T(),U(!0)},[T]),ee=S.useCallback(function(){typeof E=="function"&&E(),U(!1)},[E]),oe=p!==void 0?p:k,ae=g!==void 0?g:D,J=C!==void 0?C:W;return hn(hn({},R),{},{inputValue:oe,menuIsOpen:ae,onChange:Q,onInputChange:K,onMenuClose:ee,onMenuOpen:q,value:J})}function gn(){return gn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},gn.apply(null,arguments)}function d7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zfe(i.key),i)}}function h7e(e,t,n){return t&&Uee(e.prototype,t),n&&Uee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function WU(e,t){return WU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WU(e,t)}function f7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WU(e,t)}function KN(e){return KN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},KN(e)}function epe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(epe=function(){return!!e})()}function p7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m7e(e,t){if(t&&(pm(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p7e(e)}function g7e(e){var t=epe();return function(){var n,i=KN(e);if(t){var o=KN(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return m7e(this,n)}}function v7e(e){if(Array.isArray(e))return $U(e)}function y7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kB(e){return v7e(e)||y7e(e)||Qfe(e)||_7e()}function b7e(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function E7e(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var w7e=function(){function e(n){var i=this;this._insertTag=function(o){var u;i.tags.length===0?i.insertionPoint?u=i.insertionPoint.nextSibling:i.prepend?u=i.container.firstChild:u=i.before:u=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(o,u),i.tags.push(o)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(i){i.forEach(this._insertTag)},t.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(E7e(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var u=b7e(o);try{u.insertRule(i,u.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(i));this.ctr++},t.flush=function(){this.tags.forEach(function(i){var o;return(o=i.parentNode)==null?void 0:o.removeChild(i)}),this.tags=[],this.ctr=0},e}(),gs="-ms-",qN="-moz-",Sr="-webkit-",tpe="comm",jB="rule",DB="decl",S7e="@import",npe="@keyframes",x7e="@layer",T7e=Math.abs,cI=String.fromCharCode,C7e=Object.assign;function R7e(e,t){return es(e,0)^45?(((t<<2^es(e,0))<<2^es(e,1))<<2^es(e,2))<<2^es(e,3):0}function rpe(e){return e.trim()}function N7e(e,t){return(e=t.exec(e))?e[0]:e}function xr(e,t,n){return e.replace(t,n)}function GU(e,t){return e.indexOf(t)}function es(e,t){return e.charCodeAt(t)|0}function B0(e,t,n){return e.slice(t,n)}function xu(e){return e.length}function LB(e){return e.length}function HC(e,t){return t.push(e),e}function A7e(e,t){return e.map(t).join("")}var lI=1,by=1,ipe=0,yo=0,ha=0,c_="";function uI(e,t,n,i,o,u,h){return{value:e,root:t,parent:n,type:i,props:o,children:u,line:lI,column:by,length:h,return:""}}function vE(e,t){return C7e(uI("",null,null,"",null,null,0),e,{length:-e.length},t)}function I7e(){return ha}function O7e(){return ha=yo>0?es(c_,--yo):0,by--,ha===10&&(by=1,lI--),ha}function Ko(){return ha=yo<ipe?es(c_,yo++):0,by++,ha===10&&(by=1,lI++),ha}function Lu(){return es(c_,yo)}function $R(){return yo}function Qw(e,t){return B0(c_,e,t)}function $0(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ape(e){return lI=by=1,ipe=xu(c_=e),yo=0,[]}function spe(e){return c_="",e}function WR(e){return rpe(Qw(yo-1,HU(e===91?e+2:e===40?e+1:e)))}function P7e(e){for(;(ha=Lu())&&ha<33;)Ko();return $0(e)>2||$0(ha)>3?"":" "}function k7e(e,t){for(;--t&&Ko()&&!(ha<48||ha>102||ha>57&&ha<65||ha>70&&ha<97););return Qw(e,$R()+(t<6&&Lu()==32&&Ko()==32))}function HU(e){for(;Ko();)switch(ha){case e:return yo;case 34:case 39:e!==34&&e!==39&&HU(ha);break;case 40:e===41&&HU(e);break;case 92:Ko();break}return yo}function j7e(e,t){for(;Ko()&&e+ha!==57;)if(e+ha===84&&Lu()===47)break;return"/*"+Qw(t,yo-1)+"*"+cI(e===47?e:Ko())}function D7e(e){for(;!$0(Lu());)Ko();return Qw(e,yo)}function L7e(e){return spe(GR("",null,null,null,[""],e=ape(e),0,[0],e))}function GR(e,t,n,i,o,u,h,p,g){for(var v=0,b=0,E=h,T=0,C=0,R=0,N=1,O=1,k=1,j=0,P="",M=o,D=u,U=i,V=P;O;)switch(R=j,j=Ko()){case 40:if(R!=108&&es(V,E-1)==58){GU(V+=xr(WR(j),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:V+=WR(j);break;case 9:case 10:case 13:case 32:V+=P7e(R);break;case 92:V+=k7e($R()-1,7);continue;case 47:switch(Lu()){case 42:case 47:HC(M7e(j7e(Ko(),$R()),t,n),g);break;default:V+="/"}break;case 123*N:p[v++]=xu(V)*k;case 125*N:case 59:case 0:switch(j){case 0:case 125:O=0;case 59+b:k==-1&&(V=xr(V,/\f/g,"")),C>0&&xu(V)-E&&HC(C>32?Vee(V+";",i,n,E-1):Vee(xr(V," ","")+";",i,n,E-2),g);break;case 59:V+=";";default:if(HC(U=Fee(V,t,n,v,b,o,p,P,M=[],D=[],E),u),j===123)if(b===0)GR(V,t,U,U,M,u,E,p,D);else switch(T===99&&es(V,3)===110?100:T){case 100:case 108:case 109:case 115:GR(e,U,U,i&&HC(Fee(e,U,U,0,0,o,p,P,o,M=[],E),D),o,D,E,p,i?M:D);break;default:GR(V,U,U,U,[""],D,0,p,D)}}v=b=C=0,N=k=1,P=V="",E=h;break;case 58:E=1+xu(V),C=R;default:if(N<1){if(j==123)--N;else if(j==125&&N++==0&&O7e()==125)continue}switch(V+=cI(j),j*N){case 38:k=b>0?1:(V+="\f",-1);break;case 44:p[v++]=(xu(V)-1)*k,k=1;break;case 64:Lu()===45&&(V+=WR(Ko())),T=Lu(),b=E=xu(P=V+=D7e($R())),j++;break;case 45:R===45&&xu(V)==2&&(N=0)}}return u}function Fee(e,t,n,i,o,u,h,p,g,v,b){for(var E=o-1,T=o===0?u:[""],C=LB(T),R=0,N=0,O=0;R<i;++R)for(var k=0,j=B0(e,E+1,E=T7e(N=h[R])),P=e;k<C;++k)(P=rpe(N>0?T[k]+" "+j:xr(j,/&\f/g,T[k])))&&(g[O++]=P);return uI(e,t,n,o===0?jB:p,g,v,b)}function M7e(e,t,n){return uI(e,t,n,tpe,cI(I7e()),B0(e,2,-2),0)}function Vee(e,t,n,i){return uI(e,t,n,DB,B0(e,0,i),B0(e,i+1,-1),i)}function $v(e,t){for(var n="",i=LB(e),o=0;o<i;o++)n+=t(e[o],o,e,t)||"";return n}function U7e(e,t,n,i){switch(e.type){case x7e:if(e.children.length)break;case S7e:case DB:return e.return=e.return||e.value;case tpe:return"";case npe:return e.return=e.value+"{"+$v(e.children,i)+"}";case jB:e.value=e.props.join(",")}return xu(n=$v(e.children,i))?e.return=e.value+"{"+n+"}":""}function F7e(e){var t=LB(e);return function(n,i,o,u){for(var h="",p=0;p<t;p++)h+=e[p](n,i,o,u)||"";return h}}function V7e(e){return function(t){t.root||(t=t.return)&&e(t)}}function B7e(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var $7e=function(t,n,i){for(var o=0,u=0;o=u,u=Lu(),o===38&&u===12&&(n[i]=1),!$0(u);)Ko();return Qw(t,yo)},W7e=function(t,n){var i=-1,o=44;do switch($0(o)){case 0:o===38&&Lu()===12&&(n[i]=1),t[i]+=$7e(yo-1,n,i);break;case 2:t[i]+=WR(o);break;case 4:if(o===44){t[++i]=Lu()===58?"&\f":"",n[i]=t[i].length;break}default:t[i]+=cI(o)}while(o=Ko());return t},G7e=function(t,n){return spe(W7e(ape(t),n))},Bee=new WeakMap,H7e=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,i=t.parent,o=t.column===i.column&&t.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!Bee.get(i))&&!o){Bee.set(t,!0);for(var u=[],h=G7e(n,u),p=i.props,g=0,v=0;g<h.length;g++)for(var b=0;b<p.length;b++,v++)t.props[v]=u[g]?h[g].replace(/&\f/g,p[b]):p[b]+" "+h[g]}}},z7e=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function ope(e,t){switch(R7e(e,t)){case 5103:return Sr+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Sr+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Sr+e+qN+e+gs+e+e;case 6828:case 4268:return Sr+e+gs+e+e;case 6165:return Sr+e+gs+"flex-"+e+e;case 5187:return Sr+e+xr(e,/(\w+).+(:[^]+)/,Sr+"box-$1$2"+gs+"flex-$1$2")+e;case 5443:return Sr+e+gs+"flex-item-"+xr(e,/flex-|-self/,"")+e;case 4675:return Sr+e+gs+"flex-line-pack"+xr(e,/align-content|flex-|-self/,"")+e;case 5548:return Sr+e+gs+xr(e,"shrink","negative")+e;case 5292:return Sr+e+gs+xr(e,"basis","preferred-size")+e;case 6060:return Sr+"box-"+xr(e,"-grow","")+Sr+e+gs+xr(e,"grow","positive")+e;case 4554:return Sr+xr(e,/([^-])(transform)/g,"$1"+Sr+"$2")+e;case 6187:return xr(xr(xr(e,/(zoom-|grab)/,Sr+"$1"),/(image-set)/,Sr+"$1"),e,"")+e;case 5495:case 3959:return xr(e,/(image-set\([^]*)/,Sr+"$1$`$1");case 4968:return xr(xr(e,/(.+:)(flex-)?(.*)/,Sr+"box-pack:$3"+gs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Sr+e+e;case 4095:case 3583:case 4068:case 2532:return xr(e,/(.+)-inline(.+)/,Sr+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xu(e)-1-t>6)switch(es(e,t+1)){case 109:if(es(e,t+4)!==45)break;case 102:return xr(e,/(.+:)(.+)-([^]+)/,"$1"+Sr+"$2-$3$1"+qN+(es(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~GU(e,"stretch")?ope(xr(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(es(e,t+1)!==115)break;case 6444:switch(es(e,xu(e)-3-(~GU(e,"!important")&&10))){case 107:return xr(e,":",":"+Sr)+e;case 101:return xr(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Sr+(es(e,14)===45?"inline-":"")+"box$3$1"+Sr+"$2$3$1"+gs+"$2box$3")+e}break;case 5936:switch(es(e,t+11)){case 114:return Sr+e+gs+xr(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Sr+e+gs+xr(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Sr+e+gs+xr(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Sr+e+gs+e+e}return e}var K7e=function(t,n,i,o){if(t.length>-1&&!t.return)switch(t.type){case DB:t.return=ope(t.value,t.length);break;case npe:return $v([vE(t,{value:xr(t.value,"@","@"+Sr)})],o);case jB:if(t.length)return A7e(t.props,function(u){switch(N7e(u,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return $v([vE(t,{props:[xr(u,/:(read-\w+)/,":"+qN+"$1")]})],o);case"::placeholder":return $v([vE(t,{props:[xr(u,/:(plac\w+)/,":"+Sr+"input-$1")]}),vE(t,{props:[xr(u,/:(plac\w+)/,":"+qN+"$1")]}),vE(t,{props:[xr(u,/:(plac\w+)/,gs+"input-$1")]})],o)}return""})}},q7e=[K7e],Y7e=function(t){var n=t.key;if(n==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(N){var O=N.getAttribute("data-emotion");O.indexOf(" ")!==-1&&(document.head.appendChild(N),N.setAttribute("data-s",""))})}var o=t.stylisPlugins||q7e,u={},h,p=[];h=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(N){for(var O=N.getAttribute("data-emotion").split(" "),k=1;k<O.length;k++)u[O[k]]=!0;p.push(N)});var g,v=[H7e,z7e];{var b,E=[U7e,V7e(function(N){b.insert(N)})],T=F7e(v.concat(o,E)),C=function(O){return $v(L7e(O),T)};g=function(O,k,j,P){b=j,C(O?O+"{"+k.styles+"}":k.styles),P&&(R.inserted[k.name]=!0)}}var R={key:n,sheet:new w7e({key:n,container:h,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:u,registered:{},insert:g};return R.sheet.hydrate(p),R},cpe={exports:{}},$r={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ha=typeof Symbol=="function"&&Symbol.for,MB=Ha?Symbol.for("react.element"):60103,UB=Ha?Symbol.for("react.portal"):60106,dI=Ha?Symbol.for("react.fragment"):60107,hI=Ha?Symbol.for("react.strict_mode"):60108,fI=Ha?Symbol.for("react.profiler"):60114,pI=Ha?Symbol.for("react.provider"):60109,mI=Ha?Symbol.for("react.context"):60110,FB=Ha?Symbol.for("react.async_mode"):60111,gI=Ha?Symbol.for("react.concurrent_mode"):60111,vI=Ha?Symbol.for("react.forward_ref"):60112,yI=Ha?Symbol.for("react.suspense"):60113,X7e=Ha?Symbol.for("react.suspense_list"):60120,_I=Ha?Symbol.for("react.memo"):60115,bI=Ha?Symbol.for("react.lazy"):60116,J7e=Ha?Symbol.for("react.block"):60121,Z7e=Ha?Symbol.for("react.fundamental"):60117,Q7e=Ha?Symbol.for("react.responder"):60118,eKe=Ha?Symbol.for("react.scope"):60119;function nc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case MB:switch(e=e.type,e){case FB:case gI:case dI:case fI:case hI:case yI:return e;default:switch(e=e&&e.$$typeof,e){case mI:case vI:case bI:case _I:case pI:return e;default:return t}}case UB:return t}}}function lpe(e){return nc(e)===gI}$r.AsyncMode=FB;$r.ConcurrentMode=gI;$r.ContextConsumer=mI;$r.ContextProvider=pI;$r.Element=MB;$r.ForwardRef=vI;$r.Fragment=dI;$r.Lazy=bI;$r.Memo=_I;$r.Portal=UB;$r.Profiler=fI;$r.StrictMode=hI;$r.Suspense=yI;$r.isAsyncMode=function(e){return lpe(e)||nc(e)===FB};$r.isConcurrentMode=lpe;$r.isContextConsumer=function(e){return nc(e)===mI};$r.isContextProvider=function(e){return nc(e)===pI};$r.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===MB};$r.isForwardRef=function(e){return nc(e)===vI};$r.isFragment=function(e){return nc(e)===dI};$r.isLazy=function(e){return nc(e)===bI};$r.isMemo=function(e){return nc(e)===_I};$r.isPortal=function(e){return nc(e)===UB};$r.isProfiler=function(e){return nc(e)===fI};$r.isStrictMode=function(e){return nc(e)===hI};$r.isSuspense=function(e){return nc(e)===yI};$r.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===dI||e===gI||e===fI||e===hI||e===yI||e===X7e||typeof e=="object"&&e!==null&&(e.$$typeof===bI||e.$$typeof===_I||e.$$typeof===pI||e.$$typeof===mI||e.$$typeof===vI||e.$$typeof===Z7e||e.$$typeof===Q7e||e.$$typeof===eKe||e.$$typeof===J7e)};$r.typeOf=nc;cpe.exports=$r;var tKe=cpe.exports,upe=tKe,nKe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},rKe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},dpe={};dpe[upe.ForwardRef]=nKe;dpe[upe.Memo]=rKe;var iKe=!0;function aKe(e,t,n){var i="";return n.split(" ").forEach(function(o){e[o]!==void 0?t.push(e[o]+";"):o&&(i+=o+" ")}),i}var hpe=function(t,n,i){var o=t.key+"-"+n.name;(i===!1||iKe===!1)&&t.registered[o]===void 0&&(t.registered[o]=n.styles)},sKe=function(t,n,i){hpe(t,n,i);var o=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var u=n;do t.insert(n===u?"."+o:"",u,t.sheet,!0),u=u.next;while(u!==void 0)}};function oKe(e){for(var t=0,n,i=0,o=e.length;o>=4;++i,o-=4)n=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(o){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var cKe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},lKe=/[A-Z]|^ms/g,uKe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,fpe=function(t){return t.charCodeAt(1)===45},$ee=function(t){return t!=null&&typeof t!="boolean"},_L=B7e(function(e){return fpe(e)?e:e.replace(lKe,"-$&").toLowerCase()}),Wee=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(uKe,function(i,o,u){return Tu={name:o,styles:u,next:Tu},o})}return cKe[t]!==1&&!fpe(t)&&typeof n=="number"&&n!==0?n+"px":n};function W0(e,t,n){if(n==null)return"";var i=n;if(i.__emotion_styles!==void 0)return i;switch(typeof n){case"boolean":return"";case"object":{var o=n;if(o.anim===1)return Tu={name:o.name,styles:o.styles,next:Tu},o.name;var u=n;if(u.styles!==void 0){var h=u.next;if(h!==void 0)for(;h!==void 0;)Tu={name:h.name,styles:h.styles,next:Tu},h=h.next;var p=u.styles+";";return p}return dKe(e,t,n)}case"function":{if(e!==void 0){var g=Tu,v=n(e);return Tu=g,W0(e,t,v)}break}}var b=n;return b}function dKe(e,t,n){var i="";if(Array.isArray(n))for(var o=0;o<n.length;o++)i+=W0(e,t,n[o])+";";else for(var u in n){var h=n[u];if(typeof h!="object"){var p=h;$ee(p)&&(i+=_L(u)+":"+Wee(u,p)+";")}else if(Array.isArray(h)&&typeof h[0]=="string"&&t==null)for(var g=0;g<h.length;g++)$ee(h[g])&&(i+=_L(u)+":"+Wee(u,h[g])+";");else{var v=W0(e,t,h);switch(u){case"animation":case"animationName":{i+=_L(u)+":"+v+";";break}default:i+=u+"{"+v+"}"}}}return i}var Gee=/label:\s*([^\s;{]+)\s*(;|$)/g,Tu;function ppe(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,o="";Tu=void 0;var u=e[0];if(u==null||u.raw===void 0)i=!1,o+=W0(n,t,u);else{var h=u;o+=h[0]}for(var p=1;p<e.length;p++)if(o+=W0(n,t,e[p]),i){var g=u;o+=g[p]}Gee.lastIndex=0;for(var v="",b;(b=Gee.exec(o))!==null;)v+="-"+b[1];var E=oKe(o)+v;return{name:E,styles:o,next:Tu}}var hKe=function(t){return t()},fKe=a0.useInsertionEffect?a0.useInsertionEffect:!1,pKe=fKe||hKe,mpe=S.createContext(typeof HTMLElement<"u"?Y7e({key:"css"}):null);mpe.Provider;var mKe=function(t){return S.forwardRef(function(n,i){var o=S.useContext(mpe);return t(n,o,i)})},gKe=S.createContext({}),VB={}.hasOwnProperty,zU="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",vKe=function(t,n){var i={};for(var o in n)VB.call(n,o)&&(i[o]=n[o]);return i[zU]=t,i},yKe=function(t){var n=t.cache,i=t.serialized,o=t.isStringTag;return hpe(n,i,o),pKe(function(){return sKe(n,i,o)}),null},_Ke=mKe(function(e,t,n){var i=e.css;typeof i=="string"&&t.registered[i]!==void 0&&(i=t.registered[i]);var o=e[zU],u=[i],h="";typeof e.className=="string"?h=aKe(t.registered,u,e.className):e.className!=null&&(h=e.className+" ");var p=ppe(u,void 0,S.useContext(gKe));h+=t.key+"-"+p.name;var g={};for(var v in e)VB.call(e,v)&&v!=="css"&&v!==zU&&(g[v]=e[v]);return g.className=h,n&&(g.ref=n),S.createElement(S.Fragment,null,S.createElement(yKe,{cache:t,serialized:p,isStringTag:typeof o=="string"}),S.createElement(o,g))}),bKe=_Ke,rn=function(t,n){var i=arguments;if(n==null||!VB.call(n,"css"))return S.createElement.apply(void 0,i);var o=i.length,u=new Array(o);u[0]=bKe,u[1]=vKe(t,n);for(var h=2;h<o;h++)u[h]=i[h];return S.createElement.apply(null,u)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(rn||(rn={}));function BB(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ppe(t)}function EKe(){var e=BB.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function wKe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var KU=S.useLayoutEffect,SKe=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],YN=function(){};function xKe(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function TKe(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var u=[].concat(i);if(t&&e)for(var h in t)t.hasOwnProperty(h)&&t[h]&&u.push("".concat(xKe(e,h)));return u.filter(function(p){return p}).map(function(p){return String(p).trim()}).join(" ")}var Hee=function(t){return jKe(t)?t.filter(Boolean):pm(t)==="object"&&t!==null?[t]:[]},gpe=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var n=Xd(t,SKe);return hn({},n)},Wi=function(t,n,i){var o=t.cx,u=t.getStyles,h=t.getClassNames,p=t.className;return{css:u(n,t),className:o(i??{},h(n,t),p)}};function EI(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function CKe(e){return EI(e)?window.innerHeight:e.clientHeight}function vpe(e){return EI(e)?window.pageYOffset:e.scrollTop}function XN(e,t){if(EI(e)){window.scrollTo(0,t);return}e.scrollTop=t}function RKe(e){var t=getComputedStyle(e),n=t.position==="absolute",i=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var o=e;o=o.parentElement;)if(t=getComputedStyle(o),!(n&&t.position==="static")&&i.test(t.overflow+t.overflowY+t.overflowX))return o;return document.documentElement}function NKe(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t}function zC(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:YN,o=vpe(e),u=t-o,h=10,p=0;function g(){p+=h;var v=NKe(p,o,u,n);XN(e,v),p<n?window.requestAnimationFrame(g):i(e)}g()}function zee(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),o=t.offsetHeight/3;i.bottom+o>n.bottom?XN(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+o,e.scrollHeight)):i.top-o<n.top&&XN(e,Math.max(t.offsetTop-o,0))}function AKe(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function Kee(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function IKe(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var ype=!1,OKe={get passive(){return ype=!0}},KC=typeof window<"u"?window:{};KC.addEventListener&&KC.removeEventListener&&(KC.addEventListener("p",YN,OKe),KC.removeEventListener("p",YN,!1));var PKe=ype;function kKe(e){return e!=null}function jKe(e){return Array.isArray(e)}function qC(e,t,n){return e?t:n}var DKe=function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var u=Object.entries(t).filter(function(h){var p=Od(h,1),g=p[0];return!i.includes(g)});return u.reduce(function(h,p){var g=Od(p,2),v=g[0],b=g[1];return h[v]=b,h},{})},LKe=["children","innerProps"],MKe=["children","innerProps"];function UKe(e){var t=e.maxHeight,n=e.menuEl,i=e.minHeight,o=e.placement,u=e.shouldScroll,h=e.isFixedPosition,p=e.controlHeight,g=RKe(n),v={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return v;var b=g.getBoundingClientRect(),E=b.height,T=n.getBoundingClientRect(),C=T.bottom,R=T.height,N=T.top,O=n.offsetParent.getBoundingClientRect(),k=O.top,j=h?window.innerHeight:CKe(g),P=vpe(g),M=parseInt(getComputedStyle(n).marginBottom,10),D=parseInt(getComputedStyle(n).marginTop,10),U=k-D,V=j-N,z=U+P,W=E-P-N,Y=C-j+P+M,Q=P+N-D,K=160;switch(o){case"auto":case"bottom":if(V>=R)return{placement:"bottom",maxHeight:t};if(W>=R&&!h)return u&&zC(g,Y,K),{placement:"bottom",maxHeight:t};if(!h&&W>=i||h&&V>=i){u&&zC(g,Y,K);var q=h?V-M:W-M;return{placement:"bottom",maxHeight:q}}if(o==="auto"||h){var ee=t,oe=h?U:z;return oe>=i&&(ee=Math.min(oe-M-p,t)),{placement:"top",maxHeight:ee}}if(o==="bottom")return u&&XN(g,Y),{placement:"bottom",maxHeight:t};break;case"top":if(U>=R)return{placement:"top",maxHeight:t};if(z>=R&&!h)return u&&zC(g,Q,K),{placement:"top",maxHeight:t};if(!h&&z>=i||h&&U>=i){var ae=t;return(!h&&z>=i||h&&U>=i)&&(ae=h?U-D:z-D),u&&zC(g,Q,K),{placement:"top",maxHeight:ae}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(o,'".'))}return v}function FKe(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var _pe=function(t){return t==="auto"?"bottom":t},VKe=function(t,n){var i,o=t.placement,u=t.theme,h=u.borderRadius,p=u.spacing,g=u.colors;return hn((i={label:"menu"},BE(i,FKe(o),"100%"),BE(i,"position","absolute"),BE(i,"width","100%"),BE(i,"zIndex",1),i),n?{}:{backgroundColor:g.neutral0,borderRadius:h,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:p.menuGutter,marginTop:p.menuGutter})},bpe=S.createContext(null),BKe=function(t){var n=t.children,i=t.minMenuHeight,o=t.maxMenuHeight,u=t.menuPlacement,h=t.menuPosition,p=t.menuShouldScrollIntoView,g=t.theme,v=S.useContext(bpe)||{},b=v.setPortalPlacement,E=S.useRef(null),T=S.useState(o),C=Od(T,2),R=C[0],N=C[1],O=S.useState(null),k=Od(O,2),j=k[0],P=k[1],M=g.spacing.controlHeight;return KU(function(){var D=E.current;if(D){var U=h==="fixed",V=p&&!U,z=UKe({maxHeight:o,menuEl:D,minHeight:i,placement:u,shouldScroll:V,isFixedPosition:U,controlHeight:M});N(z.maxHeight),P(z.placement),b==null||b(z.placement)}},[o,u,h,p,i,b,M]),n({ref:E,placerProps:hn(hn({},t),{},{placement:j||_pe(u),maxHeight:R})})},$Ke=function(t){var n=t.children,i=t.innerRef,o=t.innerProps;return rn("div",gn({},Wi(t,"menu",{menu:!0}),{ref:i},o),n)},WKe=$Ke,GKe=function(t,n){var i=t.maxHeight,o=t.theme.spacing.baseUnit;return hn({maxHeight:i,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},n?{}:{paddingBottom:o,paddingTop:o})},HKe=function(t){var n=t.children,i=t.innerProps,o=t.innerRef,u=t.isMulti;return rn("div",gn({},Wi(t,"menuList",{"menu-list":!0,"menu-list--is-multi":u}),{ref:o},i),n)},Epe=function(t,n){var i=t.theme,o=i.spacing.baseUnit,u=i.colors;return hn({textAlign:"center"},n?{}:{color:u.neutral40,padding:"".concat(o*2,"px ").concat(o*3,"px")})},zKe=Epe,KKe=Epe,qKe=function(t){var n=t.children,i=n===void 0?"No options":n,o=t.innerProps,u=Xd(t,LKe);return rn("div",gn({},Wi(hn(hn({},u),{},{children:i,innerProps:o}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),o),i)},YKe=function(t){var n=t.children,i=n===void 0?"Loading...":n,o=t.innerProps,u=Xd(t,MKe);return rn("div",gn({},Wi(hn(hn({},u),{},{children:i,innerProps:o}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),o),i)},XKe=function(t){var n=t.rect,i=t.offset,o=t.position;return{left:n.left,position:o,top:i,width:n.width,zIndex:1}},JKe=function(t){var n=t.appendTo,i=t.children,o=t.controlElement,u=t.innerProps,h=t.menuPlacement,p=t.menuPosition,g=S.useRef(null),v=S.useRef(null),b=S.useState(_pe(h)),E=Od(b,2),T=E[0],C=E[1],R=S.useMemo(function(){return{setPortalPlacement:C}},[]),N=S.useState(null),O=Od(N,2),k=O[0],j=O[1],P=S.useCallback(function(){if(o){var V=AKe(o),z=p==="fixed"?0:window.pageYOffset,W=V[T]+z;(W!==(k==null?void 0:k.offset)||V.left!==(k==null?void 0:k.rect.left)||V.width!==(k==null?void 0:k.rect.width))&&j({offset:W,rect:V})}},[o,p,T,k==null?void 0:k.offset,k==null?void 0:k.rect.left,k==null?void 0:k.rect.width]);KU(function(){P()},[P]);var M=S.useCallback(function(){typeof v.current=="function"&&(v.current(),v.current=null),o&&g.current&&(v.current=qoe(o,g.current,P,{elementResize:"ResizeObserver"in window}))},[o,P]);KU(function(){M()},[M]);var D=S.useCallback(function(V){g.current=V,M()},[M]);if(!n&&p!=="fixed"||!k)return null;var U=rn("div",gn({ref:D},Wi(hn(hn({},t),{},{offset:k.offset,position:p,rect:k.rect}),"menuPortal",{"menu-portal":!0}),u),i);return rn(bpe.Provider,{value:R},n?wm.createPortal(U,n):U)},ZKe=function(t){var n=t.isDisabled,i=t.isRtl;return{label:"container",direction:i?"rtl":void 0,pointerEvents:n?"none":void 0,position:"relative"}},QKe=function(t){var n=t.children,i=t.innerProps,o=t.isDisabled,u=t.isRtl;return rn("div",gn({},Wi(t,"container",{"--is-disabled":o,"--is-rtl":u}),i),n)},eqe=function(t,n){var i=t.theme.spacing,o=t.isMulti,u=t.hasValue,h=t.selectProps.controlShouldRenderValue;return hn({alignItems:"center",display:o&&u&&h?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},n?{}:{padding:"".concat(i.baseUnit/2,"px ").concat(i.baseUnit*2,"px")})},tqe=function(t){var n=t.children,i=t.innerProps,o=t.isMulti,u=t.hasValue;return rn("div",gn({},Wi(t,"valueContainer",{"value-container":!0,"value-container--is-multi":o,"value-container--has-value":u}),i),n)},nqe=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},rqe=function(t){var n=t.children,i=t.innerProps;return rn("div",gn({},Wi(t,"indicatorsContainer",{indicators:!0}),i),n)},qee,iqe=["size"],aqe=["innerProps","isRtl","size"],sqe={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},wpe=function(t){var n=t.size,i=Xd(t,iqe);return rn("svg",gn({height:n,width:n,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:sqe},i))},$B=function(t){return rn(wpe,gn({size:20},t),rn("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Spe=function(t){return rn(wpe,gn({size:20},t),rn("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},xpe=function(t,n){var i=t.isFocused,o=t.theme,u=o.spacing.baseUnit,h=o.colors;return hn({label:"indicatorContainer",display:"flex",transition:"color 150ms"},n?{}:{color:i?h.neutral60:h.neutral20,padding:u*2,":hover":{color:i?h.neutral80:h.neutral40}})},oqe=xpe,cqe=function(t){var n=t.children,i=t.innerProps;return rn("div",gn({},Wi(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),i),n||rn(Spe,null))},lqe=xpe,uqe=function(t){var n=t.children,i=t.innerProps;return rn("div",gn({},Wi(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),i),n||rn($B,null))},dqe=function(t,n){var i=t.isDisabled,o=t.theme,u=o.spacing.baseUnit,h=o.colors;return hn({label:"indicatorSeparator",alignSelf:"stretch",width:1},n?{}:{backgroundColor:i?h.neutral10:h.neutral20,marginBottom:u*2,marginTop:u*2})},hqe=function(t){var n=t.innerProps;return rn("span",gn({},n,Wi(t,"indicatorSeparator",{"indicator-separator":!0})))},fqe=EKe(qee||(qee=wKe([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),pqe=function(t,n){var i=t.isFocused,o=t.size,u=t.theme,h=u.colors,p=u.spacing.baseUnit;return hn({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:o,lineHeight:1,marginRight:o,textAlign:"center",verticalAlign:"middle"},n?{}:{color:i?h.neutral60:h.neutral20,padding:p*2})},bL=function(t){var n=t.delay,i=t.offset;return rn("span",{css:BB({animation:"".concat(fqe," 1s ease-in-out ").concat(n,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:i?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},mqe=function(t){var n=t.innerProps,i=t.isRtl,o=t.size,u=o===void 0?4:o,h=Xd(t,aqe);return rn("div",gn({},Wi(hn(hn({},h),{},{innerProps:n,isRtl:i,size:u}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),n),rn(bL,{delay:0,offset:i}),rn(bL,{delay:160,offset:!0}),rn(bL,{delay:320,offset:!i}))},gqe=function(t,n){var i=t.isDisabled,o=t.isFocused,u=t.theme,h=u.colors,p=u.borderRadius,g=u.spacing;return hn({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:g.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},n?{}:{backgroundColor:i?h.neutral5:h.neutral0,borderColor:i?h.neutral10:o?h.primary:h.neutral20,borderRadius:p,borderStyle:"solid",borderWidth:1,boxShadow:o?"0 0 0 1px ".concat(h.primary):void 0,"&:hover":{borderColor:o?h.primary:h.neutral30}})},vqe=function(t){var n=t.children,i=t.isDisabled,o=t.isFocused,u=t.innerRef,h=t.innerProps,p=t.menuIsOpen;return rn("div",gn({ref:u},Wi(t,"control",{control:!0,"control--is-disabled":i,"control--is-focused":o,"control--menu-is-open":p}),h,{"aria-disabled":i||void 0}),n)},yqe=vqe,_qe=["data"],bqe=function(t,n){var i=t.theme.spacing;return n?{}:{paddingBottom:i.baseUnit*2,paddingTop:i.baseUnit*2}},Eqe=function(t){var n=t.children,i=t.cx,o=t.getStyles,u=t.getClassNames,h=t.Heading,p=t.headingProps,g=t.innerProps,v=t.label,b=t.theme,E=t.selectProps;return rn("div",gn({},Wi(t,"group",{group:!0}),g),rn(h,gn({},p,{selectProps:E,theme:b,getStyles:o,getClassNames:u,cx:i}),v),rn("div",null,n))},wqe=function(t,n){var i=t.theme,o=i.colors,u=i.spacing;return hn({label:"group",cursor:"default",display:"block"},n?{}:{color:o.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:u.baseUnit*3,paddingRight:u.baseUnit*3,textTransform:"uppercase"})},Sqe=function(t){var n=gpe(t);n.data;var i=Xd(n,_qe);return rn("div",gn({},Wi(t,"groupHeading",{"group-heading":!0}),i))},xqe=Eqe,Tqe=["innerRef","isDisabled","isHidden","inputClassName"],Cqe=function(t,n){var i=t.isDisabled,o=t.value,u=t.theme,h=u.spacing,p=u.colors;return hn(hn({visibility:i?"hidden":"visible",transform:o?"translateZ(0)":""},Rqe),n?{}:{margin:h.baseUnit/2,paddingBottom:h.baseUnit/2,paddingTop:h.baseUnit/2,color:p.neutral80})},Tpe={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Rqe={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":hn({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Tpe)},Nqe=function(t){return hn({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},Tpe)},Aqe=function(t){var n=t.cx,i=t.value,o=gpe(t),u=o.innerRef,h=o.isDisabled,p=o.isHidden,g=o.inputClassName,v=Xd(o,Tqe);return rn("div",gn({},Wi(t,"input",{"input-container":!0}),{"data-value":i||""}),rn("input",gn({className:n({input:!0},g),ref:u,style:Nqe(p),disabled:h},v)))},Iqe=Aqe,Oqe=function(t,n){var i=t.theme,o=i.spacing,u=i.borderRadius,h=i.colors;return hn({label:"multiValue",display:"flex",minWidth:0},n?{}:{backgroundColor:h.neutral10,borderRadius:u/2,margin:o.baseUnit/2})},Pqe=function(t,n){var i=t.theme,o=i.borderRadius,u=i.colors,h=t.cropWithEllipsis;return hn({overflow:"hidden",textOverflow:h||h===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},n?{}:{borderRadius:o/2,color:u.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},kqe=function(t,n){var i=t.theme,o=i.spacing,u=i.borderRadius,h=i.colors,p=t.isFocused;return hn({alignItems:"center",display:"flex"},n?{}:{borderRadius:u/2,backgroundColor:p?h.dangerLight:void 0,paddingLeft:o.baseUnit,paddingRight:o.baseUnit,":hover":{backgroundColor:h.dangerLight,color:h.danger}})},Cpe=function(t){var n=t.children,i=t.innerProps;return rn("div",i,n)},jqe=Cpe,Dqe=Cpe;function Lqe(e){var t=e.children,n=e.innerProps;return rn("div",gn({role:"button"},n),t||rn($B,{size:14}))}var Mqe=function(t){var n=t.children,i=t.components,o=t.data,u=t.innerProps,h=t.isDisabled,p=t.removeProps,g=t.selectProps,v=i.Container,b=i.Label,E=i.Remove;return rn(v,{data:o,innerProps:hn(hn({},Wi(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":h})),u),selectProps:g},rn(b,{data:o,innerProps:hn({},Wi(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:g},n),rn(E,{data:o,innerProps:hn(hn({},Wi(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(n||"option")},p),selectProps:g}))},Uqe=Mqe,Fqe=function(t,n){var i=t.isDisabled,o=t.isFocused,u=t.isSelected,h=t.theme,p=h.spacing,g=h.colors;return hn({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},n?{}:{backgroundColor:u?g.primary:o?g.primary25:"transparent",color:i?g.neutral20:u?g.neutral0:"inherit",padding:"".concat(p.baseUnit*2,"px ").concat(p.baseUnit*3,"px"),":active":{backgroundColor:i?void 0:u?g.primary:g.primary50}})},Vqe=function(t){var n=t.children,i=t.isDisabled,o=t.isFocused,u=t.isSelected,h=t.innerRef,p=t.innerProps;return rn("div",gn({},Wi(t,"option",{option:!0,"option--is-disabled":i,"option--is-focused":o,"option--is-selected":u}),{ref:h,"aria-disabled":i},p),n)},Bqe=Vqe,$qe=function(t,n){var i=t.theme,o=i.spacing,u=i.colors;return hn({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},n?{}:{color:u.neutral50,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},Wqe=function(t){var n=t.children,i=t.innerProps;return rn("div",gn({},Wi(t,"placeholder",{placeholder:!0}),i),n)},Gqe=Wqe,Hqe=function(t,n){var i=t.isDisabled,o=t.theme,u=o.spacing,h=o.colors;return hn({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n?{}:{color:i?h.neutral40:h.neutral80,marginLeft:u.baseUnit/2,marginRight:u.baseUnit/2})},zqe=function(t){var n=t.children,i=t.isDisabled,o=t.innerProps;return rn("div",gn({},Wi(t,"singleValue",{"single-value":!0,"single-value--is-disabled":i}),o),n)},Kqe=zqe,qqe={ClearIndicator:uqe,Control:yqe,DropdownIndicator:cqe,DownChevron:Spe,CrossIcon:$B,Group:xqe,GroupHeading:Sqe,IndicatorsContainer:rqe,IndicatorSeparator:hqe,Input:Iqe,LoadingIndicator:mqe,Menu:WKe,MenuList:HKe,MenuPortal:JKe,LoadingMessage:YKe,NoOptionsMessage:qKe,MultiValue:Uqe,MultiValueContainer:jqe,MultiValueLabel:Dqe,MultiValueRemove:Lqe,Option:Bqe,Placeholder:Gqe,SelectContainer:QKe,SingleValue:Kqe,ValueContainer:tqe},Yqe=function(t){return hn(hn({},qqe),t.components)},Yee=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Xqe(e,t){return!!(e===t||Yee(e)&&Yee(t))}function Jqe(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Xqe(e[n],t[n]))return!1;return!0}function Zqe(e,t){t===void 0&&(t=Jqe);var n=null;function i(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];if(n&&n.lastThis===this&&t(o,n.lastArgs))return n.lastResult;var h=e.apply(this,o);return n={lastResult:h,lastArgs:o,lastThis:this},h}return i.clear=function(){n=null},i}var Qqe={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},eYe=function(t){return rn("span",gn({css:Qqe},t))},Xee=eYe,tYe={guidance:function(t){var n=t.isSearchable,i=t.isMulti,o=t.tabSelectsValue,u=t.context,h=t.isInitialFocus;switch(u){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(o?", press Tab to select the option and exit the menu":"",".");case"input":return h?"".concat(t["aria-label"]||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(i?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var n=t.action,i=t.label,o=i===void 0?"":i,u=t.labels,h=t.isDisabled;switch(n){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(o,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(u.length>1?"s":""," ").concat(u.join(","),", selected.");case"select-option":return h?"option ".concat(o," is disabled. Select another option."):"option ".concat(o,", selected.");default:return""}},onFocus:function(t){var n=t.context,i=t.focused,o=t.options,u=t.label,h=u===void 0?"":u,p=t.selectValue,g=t.isDisabled,v=t.isSelected,b=t.isAppleDevice,E=function(N,O){return N&&N.length?"".concat(N.indexOf(O)+1," of ").concat(N.length):""};if(n==="value"&&p)return"value ".concat(h," focused, ").concat(E(p,i),".");if(n==="menu"&&b){var T=g?" disabled":"",C="".concat(v?" selected":"").concat(T);return"".concat(h).concat(C,", ").concat(E(o,i),".")}return""},onFilter:function(t){var n=t.inputValue,i=t.resultsMessage;return"".concat(i).concat(n?" for search term "+n:"",".")}},nYe=function(t){var n=t.ariaSelection,i=t.focusedOption,o=t.focusedValue,u=t.focusableOptions,h=t.isFocused,p=t.selectValue,g=t.selectProps,v=t.id,b=t.isAppleDevice,E=g.ariaLiveMessages,T=g.getOptionLabel,C=g.inputValue,R=g.isMulti,N=g.isOptionDisabled,O=g.isSearchable,k=g.menuIsOpen,j=g.options,P=g.screenReaderStatus,M=g.tabSelectsValue,D=g.isLoading,U=g["aria-label"],V=g["aria-live"],z=S.useMemo(function(){return hn(hn({},tYe),E||{})},[E]),W=S.useMemo(function(){var oe="";if(n&&z.onChange){var ae=n.option,J=n.options,re=n.removedValue,X=n.removedValues,de=n.value,we=function(vt){return Array.isArray(vt)?null:vt},ge=re||ae||we(de),Te=ge?T(ge):"",Pe=J||X||void 0,rt=Pe?Pe.map(T):[],dt=hn({isDisabled:ge&&N(ge,p),label:Te,labels:rt},n);oe=z.onChange(dt)}return oe},[n,z,N,p,T]),Y=S.useMemo(function(){var oe="",ae=i||o,J=!!(i&&p&&p.includes(i));if(ae&&z.onFocus){var re={focused:ae,label:T(ae),isDisabled:N(ae,p),isSelected:J,options:u,context:ae===i?"menu":"value",selectValue:p,isAppleDevice:b};oe=z.onFocus(re)}return oe},[i,o,T,N,z,u,p,b]),Q=S.useMemo(function(){var oe="";if(k&&j.length&&!D&&z.onFilter){var ae=P({count:u.length});oe=z.onFilter({inputValue:C,resultsMessage:ae})}return oe},[u,C,k,z,j,P,D]),K=(n==null?void 0:n.action)==="initial-input-focus",q=S.useMemo(function(){var oe="";if(z.guidance){var ae=o?"value":k?"menu":"input";oe=z.guidance({"aria-label":U,context:ae,isDisabled:i&&N(i,p),isMulti:R,isSearchable:O,tabSelectsValue:M,isInitialFocus:K})}return oe},[U,i,o,R,N,O,k,z,p,M,K]),ee=rn(S.Fragment,null,rn("span",{id:"aria-selection"},W),rn("span",{id:"aria-focused"},Y),rn("span",{id:"aria-results"},Q),rn("span",{id:"aria-guidance"},q));return rn(S.Fragment,null,rn(Xee,{id:v},K&&ee),rn(Xee,{"aria-live":V,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},h&&!K&&ee))},rYe=nYe,qU=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],iYe=new RegExp("["+qU.map(function(e){return e.letters}).join("")+"]","g"),Rpe={};for(var EL=0;EL<qU.length;EL++)for(var wL=qU[EL],SL=0;SL<wL.letters.length;SL++)Rpe[wL.letters[SL]]=wL.base;var Npe=function(t){return t.replace(iYe,function(n){return Rpe[n]})},aYe=Zqe(Npe),Jee=function(t){return t.replace(/^\s+|\s+$/g,"")},sYe=function(t){return"".concat(t.label," ").concat(t.value)},oYe=function(t){return function(n,i){if(n.data.__isNew__)return!0;var o=hn({ignoreCase:!0,ignoreAccents:!0,stringify:sYe,trim:!0,matchFrom:"any"},t),u=o.ignoreCase,h=o.ignoreAccents,p=o.stringify,g=o.trim,v=o.matchFrom,b=g?Jee(i):i,E=g?Jee(p(n)):p(n);return u&&(b=b.toLowerCase(),E=E.toLowerCase()),h&&(b=aYe(b),E=Npe(E)),v==="start"?E.substr(0,b.length)===b:E.indexOf(b)>-1}},cYe=["innerRef"];function lYe(e){var t=e.innerRef,n=Xd(e,cYe),i=DKe(n,"onExited","in","enter","exit","appear");return rn("input",gn({ref:t},i,{css:BB({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var uYe=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function dYe(e){var t=e.isEnabled,n=e.onBottomArrive,i=e.onBottomLeave,o=e.onTopArrive,u=e.onTopLeave,h=S.useRef(!1),p=S.useRef(!1),g=S.useRef(0),v=S.useRef(null),b=S.useCallback(function(O,k){if(v.current!==null){var j=v.current,P=j.scrollTop,M=j.scrollHeight,D=j.clientHeight,U=v.current,V=k>0,z=M-D-P,W=!1;z>k&&h.current&&(i&&i(O),h.current=!1),V&&p.current&&(u&&u(O),p.current=!1),V&&k>z?(n&&!h.current&&n(O),U.scrollTop=M,W=!0,h.current=!0):!V&&-k>P&&(o&&!p.current&&o(O),U.scrollTop=0,W=!0,p.current=!0),W&&uYe(O)}},[n,i,o,u]),E=S.useCallback(function(O){b(O,O.deltaY)},[b]),T=S.useCallback(function(O){g.current=O.changedTouches[0].clientY},[]),C=S.useCallback(function(O){var k=g.current-O.changedTouches[0].clientY;b(O,k)},[b]),R=S.useCallback(function(O){if(O){var k=PKe?{passive:!1}:!1;O.addEventListener("wheel",E,k),O.addEventListener("touchstart",T,k),O.addEventListener("touchmove",C,k)}},[C,T,E]),N=S.useCallback(function(O){O&&(O.removeEventListener("wheel",E,!1),O.removeEventListener("touchstart",T,!1),O.removeEventListener("touchmove",C,!1))},[C,T,E]);return S.useEffect(function(){if(t){var O=v.current;return R(O),function(){N(O)}}},[t,R,N]),function(O){v.current=O}}var Zee=["boxSizing","height","overflow","paddingRight","position"],Qee={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function ete(e){e.cancelable&&e.preventDefault()}function tte(e){e.stopPropagation()}function nte(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;e===0?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function rte(){return"ontouchstart"in window||navigator.maxTouchPoints}var ite=!!(typeof window<"u"&&window.document&&window.document.createElement),yE=0,lv={capture:!1,passive:!1};function hYe(e){var t=e.isEnabled,n=e.accountForScrollbars,i=n===void 0?!0:n,o=S.useRef({}),u=S.useRef(null),h=S.useCallback(function(g){if(ite){var v=document.body,b=v&&v.style;if(i&&Zee.forEach(function(R){var N=b&&b[R];o.current[R]=N}),i&&yE<1){var E=parseInt(o.current.paddingRight,10)||0,T=document.body?document.body.clientWidth:0,C=window.innerWidth-T+E||0;Object.keys(Qee).forEach(function(R){var N=Qee[R];b&&(b[R]=N)}),b&&(b.paddingRight="".concat(C,"px"))}v&&rte()&&(v.addEventListener("touchmove",ete,lv),g&&(g.addEventListener("touchstart",nte,lv),g.addEventListener("touchmove",tte,lv))),yE+=1}},[i]),p=S.useCallback(function(g){if(ite){var v=document.body,b=v&&v.style;yE=Math.max(yE-1,0),i&&yE<1&&Zee.forEach(function(E){var T=o.current[E];b&&(b[E]=T)}),v&&rte()&&(v.removeEventListener("touchmove",ete,lv),g&&(g.removeEventListener("touchstart",nte,lv),g.removeEventListener("touchmove",tte,lv)))}},[i]);return S.useEffect(function(){if(t){var g=u.current;return h(g),function(){p(g)}}},[t,h,p]),function(g){u.current=g}}var fYe=function(t){var n=t.target;return n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()},pYe={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function mYe(e){var t=e.children,n=e.lockEnabled,i=e.captureEnabled,o=i===void 0?!0:i,u=e.onBottomArrive,h=e.onBottomLeave,p=e.onTopArrive,g=e.onTopLeave,v=dYe({isEnabled:o,onBottomArrive:u,onBottomLeave:h,onTopArrive:p,onTopLeave:g}),b=hYe({isEnabled:n}),E=function(C){v(C),b(C)};return rn(S.Fragment,null,n&&rn("div",{onClick:fYe,css:pYe}),t(E))}var gYe={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},vYe=function(t){var n=t.name,i=t.onFocus;return rn("input",{required:!0,name:n,tabIndex:-1,"aria-hidden":"true",onFocus:i,css:gYe,value:"",onChange:function(){}})},yYe=vYe;function WB(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function _Ye(){return WB(/^iPhone/i)}function Ape(){return WB(/^Mac/i)}function bYe(){return WB(/^iPad/i)||Ape()&&navigator.maxTouchPoints>1}function EYe(){return _Ye()||bYe()}function wYe(){return Ape()||EYe()}var SYe=function(t){return t.label},xYe=function(t){return t.label},TYe=function(t){return t.value},CYe=function(t){return!!t.isDisabled},RYe={clearIndicator:lqe,container:ZKe,control:gqe,dropdownIndicator:oqe,group:bqe,groupHeading:wqe,indicatorsContainer:nqe,indicatorSeparator:dqe,input:Cqe,loadingIndicator:pqe,loadingMessage:KKe,menu:VKe,menuList:GKe,menuPortal:XKe,multiValue:Oqe,multiValueLabel:Pqe,multiValueRemove:kqe,noOptionsMessage:zKe,option:Fqe,placeholder:$qe,singleValue:Hqe,valueContainer:eqe},NYe={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},AYe=4,Ipe=4,IYe=38,OYe=Ipe*2,PYe={baseUnit:Ipe,controlHeight:IYe,menuGutter:OYe},xL={borderRadius:AYe,colors:NYe,spacing:PYe},kYe={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Kee(),captureMenuScroll:!Kee(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:oYe(),formatGroupLabel:SYe,getOptionLabel:xYe,getOptionValue:TYe,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:CYe,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!IKe(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var n=t.count;return"".concat(n," result").concat(n!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function ate(e,t,n,i){var o=kpe(e,t,n),u=jpe(e,t,n),h=Ppe(e,t),p=JN(e,t);return{type:"option",data:t,isDisabled:o,isSelected:u,label:h,value:p,index:i}}function HR(e,t){return e.options.map(function(n,i){if("options"in n){var o=n.options.map(function(h,p){return ate(e,h,t,p)}).filter(function(h){return ote(e,h)});return o.length>0?{type:"group",data:n,options:o,index:i}:void 0}var u=ate(e,n,t,i);return ote(e,u)?u:void 0}).filter(kKe)}function Ope(e){return e.reduce(function(t,n){return n.type==="group"?t.push.apply(t,kB(n.options.map(function(i){return i.data}))):t.push(n.data),t},[])}function ste(e,t){return e.reduce(function(n,i){return i.type==="group"?n.push.apply(n,kB(i.options.map(function(o){return{data:o.data,id:"".concat(t,"-").concat(i.index,"-").concat(o.index)}}))):n.push({data:i.data,id:"".concat(t,"-").concat(i.index)}),n},[])}function jYe(e,t){return Ope(HR(e,t))}function ote(e,t){var n=e.inputValue,i=n===void 0?"":n,o=t.data,u=t.isSelected,h=t.label,p=t.value;return(!Lpe(e)||!u)&&Dpe(e,{label:h,value:p,data:o},i)}function DYe(e,t){var n=e.focusedValue,i=e.selectValue,o=i.indexOf(n);if(o>-1){var u=t.indexOf(n);if(u>-1)return n;if(o<t.length)return t[o]}return null}function LYe(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}var TL=function(t,n){var i,o=(i=t.find(function(u){return u.data===n}))===null||i===void 0?void 0:i.id;return o||null},Ppe=function(t,n){return t.getOptionLabel(n)},JN=function(t,n){return t.getOptionValue(n)};function kpe(e,t,n){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,n):!1}function jpe(e,t,n){if(n.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,n);var i=JN(e,t);return n.some(function(o){return JN(e,o)===i})}function Dpe(e,t,n){return e.filterOption?e.filterOption(t,n):!0}var Lpe=function(t){var n=t.hideSelectedOptions,i=t.isMulti;return n===void 0?i:n},MYe=1,Mpe=function(e){f7e(n,e);var t=g7e(n);function n(i){var o;if(d7e(this,n),o=t.call(this,i),o.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},o.blockOptionHover=!1,o.isComposing=!1,o.commonProps=void 0,o.initialTouchX=0,o.initialTouchY=0,o.openAfterFocus=!1,o.scrollToFocusedOptionOnUpdate=!1,o.userIsDragging=void 0,o.controlRef=null,o.getControlRef=function(g){o.controlRef=g},o.focusedOptionRef=null,o.getFocusedOptionRef=function(g){o.focusedOptionRef=g},o.menuListRef=null,o.getMenuListRef=function(g){o.menuListRef=g},o.inputRef=null,o.getInputRef=function(g){o.inputRef=g},o.focus=o.focusInput,o.blur=o.blurInput,o.onChange=function(g,v){var b=o.props,E=b.onChange,T=b.name;v.name=T,o.ariaOnChange(g,v),E(g,v)},o.setValue=function(g,v,b){var E=o.props,T=E.closeMenuOnSelect,C=E.isMulti,R=E.inputValue;o.onInputChange("",{action:"set-value",prevInputValue:R}),T&&(o.setState({inputIsHiddenAfterUpdate:!C}),o.onMenuClose()),o.setState({clearFocusValueOnUpdate:!0}),o.onChange(g,{action:v,option:b})},o.selectOption=function(g){var v=o.props,b=v.blurInputOnSelect,E=v.isMulti,T=v.name,C=o.state.selectValue,R=E&&o.isOptionSelected(g,C),N=o.isOptionDisabled(g,C);if(R){var O=o.getOptionValue(g);o.setValue(C.filter(function(k){return o.getOptionValue(k)!==O}),"deselect-option",g)}else if(!N)E?o.setValue([].concat(kB(C),[g]),"select-option",g):o.setValue(g,"select-option");else{o.ariaOnChange(g,{action:"select-option",option:g,name:T});return}b&&o.blurInput()},o.removeValue=function(g){var v=o.props.isMulti,b=o.state.selectValue,E=o.getOptionValue(g),T=b.filter(function(R){return o.getOptionValue(R)!==E}),C=qC(v,T,T[0]||null);o.onChange(C,{action:"remove-value",removedValue:g}),o.focusInput()},o.clearValue=function(){var g=o.state.selectValue;o.onChange(qC(o.props.isMulti,[],null),{action:"clear",removedValues:g})},o.popValue=function(){var g=o.props.isMulti,v=o.state.selectValue,b=v[v.length-1],E=v.slice(0,v.length-1),T=qC(g,E,E[0]||null);b&&o.onChange(T,{action:"pop-value",removedValue:b})},o.getFocusedOptionId=function(g){return TL(o.state.focusableOptionsWithIds,g)},o.getFocusableOptionsWithIds=function(){return ste(HR(o.props,o.state.selectValue),o.getElementId("option"))},o.getValue=function(){return o.state.selectValue},o.cx=function(){for(var g=arguments.length,v=new Array(g),b=0;b<g;b++)v[b]=arguments[b];return TKe.apply(void 0,[o.props.classNamePrefix].concat(v))},o.getOptionLabel=function(g){return Ppe(o.props,g)},o.getOptionValue=function(g){return JN(o.props,g)},o.getStyles=function(g,v){var b=o.props.unstyled,E=RYe[g](v,b);E.boxSizing="border-box";var T=o.props.styles[g];return T?T(E,v):E},o.getClassNames=function(g,v){var b,E;return(b=(E=o.props.classNames)[g])===null||b===void 0?void 0:b.call(E,v)},o.getElementId=function(g){return"".concat(o.state.instancePrefix,"-").concat(g)},o.getComponents=function(){return Yqe(o.props)},o.buildCategorizedOptions=function(){return HR(o.props,o.state.selectValue)},o.getCategorizedOptions=function(){return o.props.menuIsOpen?o.buildCategorizedOptions():[]},o.buildFocusableOptions=function(){return Ope(o.buildCategorizedOptions())},o.getFocusableOptions=function(){return o.props.menuIsOpen?o.buildFocusableOptions():[]},o.ariaOnChange=function(g,v){o.setState({ariaSelection:hn({value:g},v)})},o.onMenuMouseDown=function(g){g.button===0&&(g.stopPropagation(),g.preventDefault(),o.focusInput())},o.onMenuMouseMove=function(g){o.blockOptionHover=!1},o.onControlMouseDown=function(g){if(!g.defaultPrevented){var v=o.props.openMenuOnClick;o.state.isFocused?o.props.menuIsOpen?g.target.tagName!=="INPUT"&&g.target.tagName!=="TEXTAREA"&&o.onMenuClose():v&&o.openMenu("first"):(v&&(o.openAfterFocus=!0),o.focusInput()),g.target.tagName!=="INPUT"&&g.target.tagName!=="TEXTAREA"&&g.preventDefault()}},o.onDropdownIndicatorMouseDown=function(g){if(!(g&&g.type==="mousedown"&&g.button!==0)&&!o.props.isDisabled){var v=o.props,b=v.isMulti,E=v.menuIsOpen;o.focusInput(),E?(o.setState({inputIsHiddenAfterUpdate:!b}),o.onMenuClose()):o.openMenu("first"),g.preventDefault()}},o.onClearIndicatorMouseDown=function(g){g&&g.type==="mousedown"&&g.button!==0||(o.clearValue(),g.preventDefault(),o.openAfterFocus=!1,g.type==="touchend"?o.focusInput():setTimeout(function(){return o.focusInput()}))},o.onScroll=function(g){typeof o.props.closeMenuOnScroll=="boolean"?g.target instanceof HTMLElement&&EI(g.target)&&o.props.onMenuClose():typeof o.props.closeMenuOnScroll=="function"&&o.props.closeMenuOnScroll(g)&&o.props.onMenuClose()},o.onCompositionStart=function(){o.isComposing=!0},o.onCompositionEnd=function(){o.isComposing=!1},o.onTouchStart=function(g){var v=g.touches,b=v&&v.item(0);b&&(o.initialTouchX=b.clientX,o.initialTouchY=b.clientY,o.userIsDragging=!1)},o.onTouchMove=function(g){var v=g.touches,b=v&&v.item(0);if(b){var E=Math.abs(b.clientX-o.initialTouchX),T=Math.abs(b.clientY-o.initialTouchY),C=5;o.userIsDragging=E>C||T>C}},o.onTouchEnd=function(g){o.userIsDragging||(o.controlRef&&!o.controlRef.contains(g.target)&&o.menuListRef&&!o.menuListRef.contains(g.target)&&o.blurInput(),o.initialTouchX=0,o.initialTouchY=0)},o.onControlTouchEnd=function(g){o.userIsDragging||o.onControlMouseDown(g)},o.onClearIndicatorTouchEnd=function(g){o.userIsDragging||o.onClearIndicatorMouseDown(g)},o.onDropdownIndicatorTouchEnd=function(g){o.userIsDragging||o.onDropdownIndicatorMouseDown(g)},o.handleInputChange=function(g){var v=o.props.inputValue,b=g.currentTarget.value;o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange(b,{action:"input-change",prevInputValue:v}),o.props.menuIsOpen||o.onMenuOpen()},o.onInputFocus=function(g){o.props.onFocus&&o.props.onFocus(g),o.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(o.openAfterFocus||o.props.openMenuOnFocus)&&o.openMenu("first"),o.openAfterFocus=!1},o.onInputBlur=function(g){var v=o.props.inputValue;if(o.menuListRef&&o.menuListRef.contains(document.activeElement)){o.inputRef.focus();return}o.props.onBlur&&o.props.onBlur(g),o.onInputChange("",{action:"input-blur",prevInputValue:v}),o.onMenuClose(),o.setState({focusedValue:null,isFocused:!1})},o.onOptionHover=function(g){if(!(o.blockOptionHover||o.state.focusedOption===g)){var v=o.getFocusableOptions(),b=v.indexOf(g);o.setState({focusedOption:g,focusedOptionId:b>-1?o.getFocusedOptionId(g):null})}},o.shouldHideSelectedOptions=function(){return Lpe(o.props)},o.onValueInputFocus=function(g){g.preventDefault(),g.stopPropagation(),o.focus()},o.onKeyDown=function(g){var v=o.props,b=v.isMulti,E=v.backspaceRemovesValue,T=v.escapeClearsValue,C=v.inputValue,R=v.isClearable,N=v.isDisabled,O=v.menuIsOpen,k=v.onKeyDown,j=v.tabSelectsValue,P=v.openMenuOnFocus,M=o.state,D=M.focusedOption,U=M.focusedValue,V=M.selectValue;if(!N&&!(typeof k=="function"&&(k(g),g.defaultPrevented))){switch(o.blockOptionHover=!0,g.key){case"ArrowLeft":if(!b||C)return;o.focusValue("previous");break;case"ArrowRight":if(!b||C)return;o.focusValue("next");break;case"Delete":case"Backspace":if(C)return;if(U)o.removeValue(U);else{if(!E)return;b?o.popValue():R&&o.clearValue()}break;case"Tab":if(o.isComposing||g.shiftKey||!O||!j||!D||P&&o.isOptionSelected(D,V))return;o.selectOption(D);break;case"Enter":if(g.keyCode===229)break;if(O){if(!D||o.isComposing)return;o.selectOption(D);break}return;case"Escape":O?(o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange("",{action:"menu-close",prevInputValue:C}),o.onMenuClose()):R&&T&&o.clearValue();break;case" ":if(C)return;if(!O){o.openMenu("first");break}if(!D)return;o.selectOption(D);break;case"ArrowUp":O?o.focusOption("up"):o.openMenu("last");break;case"ArrowDown":O?o.focusOption("down"):o.openMenu("first");break;case"PageUp":if(!O)return;o.focusOption("pageup");break;case"PageDown":if(!O)return;o.focusOption("pagedown");break;case"Home":if(!O)return;o.focusOption("first");break;case"End":if(!O)return;o.focusOption("last");break;default:return}g.preventDefault()}},o.state.instancePrefix="react-select-"+(o.props.instanceId||++MYe),o.state.selectValue=Hee(i.value),i.menuIsOpen&&o.state.selectValue.length){var u=o.getFocusableOptionsWithIds(),h=o.buildFocusableOptions(),p=h.indexOf(o.state.selectValue[0]);o.state.focusableOptionsWithIds=u,o.state.focusedOption=h[p],o.state.focusedOptionId=TL(u,h[p])}return o}return h7e(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&zee(this.menuListRef,this.focusedOptionRef),wYe()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(o){var u=this.props,h=u.isDisabled,p=u.menuIsOpen,g=this.state.isFocused;(g&&!h&&o.isDisabled||g&&p&&!o.menuIsOpen)&&this.focusInput(),g&&h&&!o.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!g&&!h&&o.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(zee(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(o,u){this.props.onInputChange(o,u)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(o){var u=this,h=this.state,p=h.selectValue,g=h.isFocused,v=this.buildFocusableOptions(),b=o==="first"?0:v.length-1;if(!this.props.isMulti){var E=v.indexOf(p[0]);E>-1&&(b=E)}this.scrollToFocusedOptionOnUpdate=!(g&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:v[b],focusedOptionId:this.getFocusedOptionId(v[b])},function(){return u.onMenuOpen()})}},{key:"focusValue",value:function(o){var u=this.state,h=u.selectValue,p=u.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var g=h.indexOf(p);p||(g=-1);var v=h.length-1,b=-1;if(h.length){switch(o){case"previous":g===0?b=0:g===-1?b=v:b=g-1;break;case"next":g>-1&&g<v&&(b=g+1);break}this.setState({inputIsHidden:b!==-1,focusedValue:h[b]})}}}},{key:"focusOption",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",u=this.props.pageSize,h=this.state.focusedOption,p=this.getFocusableOptions();if(p.length){var g=0,v=p.indexOf(h);h||(v=-1),o==="up"?g=v>0?v-1:p.length-1:o==="down"?g=(v+1)%p.length:o==="pageup"?(g=v-u,g<0&&(g=0)):o==="pagedown"?(g=v+u,g>p.length-1&&(g=p.length-1)):o==="last"&&(g=p.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:p[g],focusedValue:null,focusedOptionId:this.getFocusedOptionId(p[g])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(xL):hn(hn({},xL),this.props.theme):xL}},{key:"getCommonProps",value:function(){var o=this.clearValue,u=this.cx,h=this.getStyles,p=this.getClassNames,g=this.getValue,v=this.selectOption,b=this.setValue,E=this.props,T=E.isMulti,C=E.isRtl,R=E.options,N=this.hasValue();return{clearValue:o,cx:u,getStyles:h,getClassNames:p,getValue:g,hasValue:N,isMulti:T,isRtl:C,options:R,selectOption:v,selectProps:E,setValue:b,theme:this.getTheme()}}},{key:"hasValue",value:function(){var o=this.state.selectValue;return o.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var o=this.props,u=o.isClearable,h=o.isMulti;return u===void 0?h:u}},{key:"isOptionDisabled",value:function(o,u){return kpe(this.props,o,u)}},{key:"isOptionSelected",value:function(o,u){return jpe(this.props,o,u)}},{key:"filterOption",value:function(o,u){return Dpe(this.props,o,u)}},{key:"formatOptionLabel",value:function(o,u){if(typeof this.props.formatOptionLabel=="function"){var h=this.props.inputValue,p=this.state.selectValue;return this.props.formatOptionLabel(o,{context:u,inputValue:h,selectValue:p})}else return this.getOptionLabel(o)}},{key:"formatGroupLabel",value:function(o){return this.props.formatGroupLabel(o)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var o=this.props,u=o.isDisabled,h=o.isSearchable,p=o.inputId,g=o.inputValue,v=o.tabIndex,b=o.form,E=o.menuIsOpen,T=o.required,C=this.getComponents(),R=C.Input,N=this.state,O=N.inputIsHidden,k=N.ariaSelection,j=this.commonProps,P=p||this.getElementId("input"),M=hn(hn(hn({"aria-autocomplete":"list","aria-expanded":E,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":T,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},E&&{"aria-controls":this.getElementId("listbox")}),!h&&{"aria-readonly":!0}),this.hasValue()?(k==null?void 0:k.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return h?S.createElement(R,gn({},j,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:P,innerRef:this.getInputRef,isDisabled:u,isHidden:O,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:v,form:b,type:"text",value:g},M)):S.createElement(lYe,gn({id:P,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:YN,onFocus:this.onInputFocus,disabled:u,tabIndex:v,inputMode:"none",form:b,value:""},M))}},{key:"renderPlaceholderOrValue",value:function(){var o=this,u=this.getComponents(),h=u.MultiValue,p=u.MultiValueContainer,g=u.MultiValueLabel,v=u.MultiValueRemove,b=u.SingleValue,E=u.Placeholder,T=this.commonProps,C=this.props,R=C.controlShouldRenderValue,N=C.isDisabled,O=C.isMulti,k=C.inputValue,j=C.placeholder,P=this.state,M=P.selectValue,D=P.focusedValue,U=P.isFocused;if(!this.hasValue()||!R)return k?null:S.createElement(E,gn({},T,{key:"placeholder",isDisabled:N,isFocused:U,innerProps:{id:this.getElementId("placeholder")}}),j);if(O)return M.map(function(z,W){var Y=z===D,Q="".concat(o.getOptionLabel(z),"-").concat(o.getOptionValue(z));return S.createElement(h,gn({},T,{components:{Container:p,Label:g,Remove:v},isFocused:Y,isDisabled:N,key:Q,index:W,removeProps:{onClick:function(){return o.removeValue(z)},onTouchEnd:function(){return o.removeValue(z)},onMouseDown:function(q){q.preventDefault()}},data:z}),o.formatOptionLabel(z,"value"))});if(k)return null;var V=M[0];return S.createElement(b,gn({},T,{data:V,isDisabled:N}),this.formatOptionLabel(V,"value"))}},{key:"renderClearIndicator",value:function(){var o=this.getComponents(),u=o.ClearIndicator,h=this.commonProps,p=this.props,g=p.isDisabled,v=p.isLoading,b=this.state.isFocused;if(!this.isClearable()||!u||g||!this.hasValue()||v)return null;var E={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return S.createElement(u,gn({},h,{innerProps:E,isFocused:b}))}},{key:"renderLoadingIndicator",value:function(){var o=this.getComponents(),u=o.LoadingIndicator,h=this.commonProps,p=this.props,g=p.isDisabled,v=p.isLoading,b=this.state.isFocused;if(!u||!v)return null;var E={"aria-hidden":"true"};return S.createElement(u,gn({},h,{innerProps:E,isDisabled:g,isFocused:b}))}},{key:"renderIndicatorSeparator",value:function(){var o=this.getComponents(),u=o.DropdownIndicator,h=o.IndicatorSeparator;if(!u||!h)return null;var p=this.commonProps,g=this.props.isDisabled,v=this.state.isFocused;return S.createElement(h,gn({},p,{isDisabled:g,isFocused:v}))}},{key:"renderDropdownIndicator",value:function(){var o=this.getComponents(),u=o.DropdownIndicator;if(!u)return null;var h=this.commonProps,p=this.props.isDisabled,g=this.state.isFocused,v={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return S.createElement(u,gn({},h,{innerProps:v,isDisabled:p,isFocused:g}))}},{key:"renderMenu",value:function(){var o=this,u=this.getComponents(),h=u.Group,p=u.GroupHeading,g=u.Menu,v=u.MenuList,b=u.MenuPortal,E=u.LoadingMessage,T=u.NoOptionsMessage,C=u.Option,R=this.commonProps,N=this.state.focusedOption,O=this.props,k=O.captureMenuScroll,j=O.inputValue,P=O.isLoading,M=O.loadingMessage,D=O.minMenuHeight,U=O.maxMenuHeight,V=O.menuIsOpen,z=O.menuPlacement,W=O.menuPosition,Y=O.menuPortalTarget,Q=O.menuShouldBlockScroll,K=O.menuShouldScrollIntoView,q=O.noOptionsMessage,ee=O.onMenuScrollToTop,oe=O.onMenuScrollToBottom;if(!V)return null;var ae=function(Te,Pe){var rt=Te.type,dt=Te.data,ze=Te.isDisabled,vt=Te.isSelected,Be=Te.label,ot=Te.value,De=N===dt,je=ze?void 0:function(){return o.onOptionHover(dt)},Mt=ze?void 0:function(){return o.selectOption(dt)},Ut="".concat(o.getElementId("option"),"-").concat(Pe),fn={id:Ut,onClick:Mt,onMouseMove:je,onMouseOver:je,tabIndex:-1,role:"option","aria-selected":o.state.isAppleDevice?void 0:vt};return S.createElement(C,gn({},R,{innerProps:fn,data:dt,isDisabled:ze,isSelected:vt,key:Ut,label:Be,type:rt,value:ot,isFocused:De,innerRef:De?o.getFocusedOptionRef:void 0}),o.formatOptionLabel(Te.data,"menu"))},J;if(this.hasOptions())J=this.getCategorizedOptions().map(function(ge){if(ge.type==="group"){var Te=ge.data,Pe=ge.options,rt=ge.index,dt="".concat(o.getElementId("group"),"-").concat(rt),ze="".concat(dt,"-heading");return S.createElement(h,gn({},R,{key:dt,data:Te,options:Pe,Heading:p,headingProps:{id:ze,data:ge.data},label:o.formatGroupLabel(ge.data)}),ge.options.map(function(vt){return ae(vt,"".concat(rt,"-").concat(vt.index))}))}else if(ge.type==="option")return ae(ge,"".concat(ge.index))});else if(P){var re=M({inputValue:j});if(re===null)return null;J=S.createElement(E,R,re)}else{var X=q({inputValue:j});if(X===null)return null;J=S.createElement(T,R,X)}var de={minMenuHeight:D,maxMenuHeight:U,menuPlacement:z,menuPosition:W,menuShouldScrollIntoView:K},we=S.createElement(BKe,gn({},R,de),function(ge){var Te=ge.ref,Pe=ge.placerProps,rt=Pe.placement,dt=Pe.maxHeight;return S.createElement(g,gn({},R,de,{innerRef:Te,innerProps:{onMouseDown:o.onMenuMouseDown,onMouseMove:o.onMenuMouseMove},isLoading:P,placement:rt}),S.createElement(mYe,{captureEnabled:k,onTopArrive:ee,onBottomArrive:oe,lockEnabled:Q},function(ze){return S.createElement(v,gn({},R,{innerRef:function(Be){o.getMenuListRef(Be),ze(Be)},innerProps:{role:"listbox","aria-multiselectable":R.isMulti,id:o.getElementId("listbox")},isLoading:P,maxHeight:dt,focusedOption:N}),J)}))});return Y||W==="fixed"?S.createElement(b,gn({},R,{appendTo:Y,controlElement:this.controlRef,menuPlacement:z,menuPosition:W}),we):we}},{key:"renderFormField",value:function(){var o=this,u=this.props,h=u.delimiter,p=u.isDisabled,g=u.isMulti,v=u.name,b=u.required,E=this.state.selectValue;if(b&&!this.hasValue()&&!p)return S.createElement(yYe,{name:v,onFocus:this.onValueInputFocus});if(!(!v||p))if(g)if(h){var T=E.map(function(N){return o.getOptionValue(N)}).join(h);return S.createElement("input",{name:v,type:"hidden",value:T})}else{var C=E.length>0?E.map(function(N,O){return S.createElement("input",{key:"i-".concat(O),name:v,type:"hidden",value:o.getOptionValue(N)})}):S.createElement("input",{name:v,type:"hidden",value:""});return S.createElement("div",null,C)}else{var R=E[0]?this.getOptionValue(E[0]):"";return S.createElement("input",{name:v,type:"hidden",value:R})}}},{key:"renderLiveRegion",value:function(){var o=this.commonProps,u=this.state,h=u.ariaSelection,p=u.focusedOption,g=u.focusedValue,v=u.isFocused,b=u.selectValue,E=this.getFocusableOptions();return S.createElement(rYe,gn({},o,{id:this.getElementId("live-region"),ariaSelection:h,focusedOption:p,focusedValue:g,isFocused:v,selectValue:b,focusableOptions:E,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var o=this.getComponents(),u=o.Control,h=o.IndicatorsContainer,p=o.SelectContainer,g=o.ValueContainer,v=this.props,b=v.className,E=v.id,T=v.isDisabled,C=v.menuIsOpen,R=this.state.isFocused,N=this.commonProps=this.getCommonProps();return S.createElement(p,gn({},N,{className:b,innerProps:{id:E,onKeyDown:this.onKeyDown},isDisabled:T,isFocused:R}),this.renderLiveRegion(),S.createElement(u,gn({},N,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:T,isFocused:R,menuIsOpen:C}),S.createElement(g,gn({},N,{isDisabled:T}),this.renderPlaceholderOrValue(),this.renderInput()),S.createElement(h,gn({},N,{isDisabled:T}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(o,u){var h=u.prevProps,p=u.clearFocusValueOnUpdate,g=u.inputIsHiddenAfterUpdate,v=u.ariaSelection,b=u.isFocused,E=u.prevWasFocused,T=u.instancePrefix,C=o.options,R=o.value,N=o.menuIsOpen,O=o.inputValue,k=o.isMulti,j=Hee(R),P={};if(h&&(R!==h.value||C!==h.options||N!==h.menuIsOpen||O!==h.inputValue)){var M=N?jYe(o,j):[],D=N?ste(HR(o,j),"".concat(T,"-option")):[],U=p?DYe(u,j):null,V=LYe(u,M),z=TL(D,V);P={selectValue:j,focusedOption:V,focusedOptionId:z,focusableOptionsWithIds:D,focusedValue:U,clearFocusValueOnUpdate:!1}}var W=g!=null&&o!==h?{inputIsHidden:g,inputIsHiddenAfterUpdate:void 0}:{},Y=v,Q=b&&E;return b&&!Q&&(Y={value:qC(k,j,j[0]||null),options:j,action:"initial-input-focus"},Q=!E),(v==null?void 0:v.action)==="initial-input-focus"&&(Y=null),hn(hn(hn({},P),W),{},{prevProps:o,ariaSelection:Y,prevWasFocused:Q})}}]),n}(S.Component);Mpe.defaultProps=kYe;var UYe=S.forwardRef(function(e,t){var n=u7e(e);return S.createElement(Mpe,gn({ref:t},n))}),cte=UYe;const FYe="https://api.gada.chat";function VYe(){const{accessToken:e,isLoading:t}=st(),n=wt(e),i=Hl(e),[o,u]=S.useState([]),[h,p]=S.useState(!0),[g,v]=S.useState({campaign_title:"",campaign_start_date:"",campaign_end_date:"",campaign_budget:"",campaign_bidding:"click",audience_countries:[],audience_gender:"all",audience_relationship:"all",ads_title:"",ads_description:"",ads_type:"url",ads_url:"",ads_placement:"newsfeed",ads_image:""}),[b,E]=S.useState(!1),[T,C]=S.useState(!1),[R,N]=S.useState([]),[O,k]=S.useState(1),[j,P]=S.useState(0),M=S.useMemo(()=>Math.max(1,Math.ceil(j/10)),[j]),[D,U]=S.useState(null),[V,z]=S.useState(null),[W,Y]=S.useState(!1);S.useEffect(()=>{if(!D)return z(null);const J=(D.audience_countries||"").split(",").map(re=>Number(re.trim())).filter(Boolean).map(re=>o.find(de=>de.value===re)||{value:re,label:String(re)});z({campaign_title:D.campaign_title||"",campaign_start_date:D.campaign_start_date?new Date(D.campaign_start_date).toISOString().slice(0,16):"",campaign_end_date:D.campaign_end_date?new Date(D.campaign_end_date).toISOString().slice(0,16):"",campaign_budget:D.campaign_budget??"",campaign_bidding:D.campaign_bidding||"click",audience_countries:J,audience_gender:D.audience_gender||"all",audience_relationship:D.audience_relationship||"all",ads_title:D.ads_title||"",ads_description:D.ads_description||"",ads_type:D.ads_type||"url",ads_url:D.ads_url||"",ads_placement:D.ads_placement||"newsfeed",ads_image:D.ads_image||""})},[D,o]),S.useEffect(()=>{(async()=>{try{p(!0);const J=await p8e(n);if(!(J!=null&&J.ok))throw new Error((J==null?void 0:J.error)||"Failed to load countries");u(J.items||[])}catch(J){Ce.error((J==null?void 0:J.message)||"Failed to load countries")}finally{p(!1)}})()},[e]);const Q=async J=>{var X;const re=(X=J.target.files)==null?void 0:X[0];if(re){E(!0);try{const de=await c8e(re,i);de!=null&&de.ok?(v(we=>({...we,ads_image:de.path})),Ce.success("Image uploaded successfully")):Ce.error((de==null?void 0:de.error)||"Upload failed")}catch(de){Ce.error((de==null?void 0:de.message)||"Upload failed")}finally{E(!1)}}},K=J=>{var X,de;if(!((X=J.campaign_title)!=null&&X.trim()))return"Campaign title is required";if(!J.campaign_start_date||!J.campaign_end_date)return"Start and End dates are required";const re=Number(J.campaign_budget);return!re||isNaN(re)||re<=0?"Budget must be a positive number":J.ads_type==="url"&&!((de=J.ads_url)!=null&&de.trim())?"Target URL is required for URL ads":null},q=async J=>{J.preventDefault();const re=K(g);if(re)return Ce.error(re);C(!0);try{const X={...g,campaign_budget:Number(g.campaign_budget),campaign_start_date:new Date(g.campaign_start_date).toISOString(),campaign_end_date:new Date(g.campaign_end_date).toISOString(),audience_countries:g.audience_countries.map(we=>we.value).join(",")},de=await l8e(X,n);if(!(de!=null&&de.ok))throw new Error((de==null?void 0:de.error)||"Failed to create campaign");Ce.success("Campaign created successfully!"),v(we=>({...we,campaign_title:"",campaign_start_date:"",campaign_end_date:"",campaign_budget:"",audience_countries:[],ads_title:"",ads_description:"",ads_url:"",ads_image:""})),ae(1)}catch(X){Ce.error((X==null?void 0:X.message)||"Failed to create campaign")}finally{C(!1)}},ee=async()=>{if(!D||!V)return;const J=K(V);if(J)return Ce.error(J);Y(!0);try{const re={...V,campaign_budget:Number(V.campaign_budget),campaign_start_date:new Date(V.campaign_start_date).toISOString(),campaign_end_date:new Date(V.campaign_end_date).toISOString(),audience_countries:V.audience_countries.map(de=>de.value).join(",")},X=await m8e(D.campaign_id,re,n);if(!(X!=null&&X.ok))throw new Error((X==null?void 0:X.error)||"Failed to update campaign");Ce.success("Campaign updated"),U(null),ae()}catch(re){Ce.error((re==null?void 0:re.message)||"Failed to update campaign")}finally{Y(!1)}},oe=async J=>{const re=J.campaign_id;if(window.confirm(`Delete campaign "${J.campaign_title}"?`))try{const de=await g8e(re,n);if(!(de!=null&&de.ok))throw new Error((de==null?void 0:de.error)||"Failed to delete");Ce.success("Campaign deleted"),ae()}catch(de){Ce.error((de==null?void 0:de.message)||"Failed to delete")}};async function ae(J=O){try{const re=await u8e(J,10,n);if(!(re!=null&&re.ok))throw new Error((re==null?void 0:re.error)||"Failed to load campaigns");N(re.items||[]),P(re.total||0),k(re.page||1)}catch(re){Ce.error((re==null?void 0:re.message)||"Failed to load campaigns")}}return S.useEffect(()=>{!e||t||ae(1)},[t,e]),c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx(Ss,{})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsxs("header",{className:"rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-6 sm:p-8",children:[c.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Ads Manager"}),c.jsx("p",{className:"opacity-90",children:"Manage Ads, Create new Campaign"})]}),c.jsxs("section",{className:"rounded-2xl border bg-white shadow p-4 sm:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"New Campaign"}),c.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[c.jsxs("div",{className:"md:col-span-6 grid gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Campaign Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:g.campaign_title,onChange:J=>v({...g,campaign_title:J.target.value}),placeholder:"Set a title for your campaign"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Start"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:g.campaign_start_date,onChange:J=>v({...g,campaign_start_date:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"End"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:g.campaign_end_date,onChange:J=>v({...g,campaign_end_date:J.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Budget (₦)"}),c.jsx("input",{type:"number",min:0,className:"w-full border rounded-lg p-2",value:g.campaign_budget,onChange:J=>v({...g,campaign_budget:J.target.value}),placeholder:"E.g., 10000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Bidding"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.campaign_bidding,onChange:J=>v({...g,campaign_bidding:J.target.value}),children:[c.jsx("option",{value:"click",children:"Pay Per Click (₦50)"}),c.jsx("option",{value:"view",children:"Pay Per View (₦10)"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-sm mb-1",children:"Target Audience"}),c.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Countries"}),c.jsx(cte,{isMulti:!0,options:o,isLoading:h,value:g.audience_countries,onChange:J=>v({...g,audience_countries:J||[]}),classNamePrefix:"select",placeholder:"Select countries..."}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Gender"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.audience_gender,onChange:J=>v({...g,audience_gender:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Relationship"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.audience_relationship,onChange:J=>v({...g,audience_relationship:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"single",children:"Single"}),c.jsx("option",{value:"married",children:"Married"})]})]})]})]})]}),c.jsxs("div",{className:"md:col-span-6 grid gap-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:g.ads_title,onChange:J=>v({...g,ads_title:J.target.value}),placeholder:"Set a title for your ads"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Placement"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.ads_placement,onChange:J=>v({...g,ads_placement:J.target.value}),children:[c.jsx("option",{value:"newsfeed",children:"Newsfeed"}),c.jsx("option",{value:"sidebar",children:"Sidebar"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Description (max 200)"}),c.jsx("textarea",{maxLength:200,rows:5,className:"w-full border rounded-lg p-2",value:g.ads_description,onChange:J=>v({...g,ads_description:J.target.value}),placeholder:"Set a description for your ads"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Advertise For"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.ads_type,onChange:J=>v({...g,ads_type:J.target.value}),children:[c.jsx("option",{value:"url",children:"URL"}),c.jsx("option",{value:"post",children:"Post"}),c.jsx("option",{value:"page",children:"Page"}),c.jsx("option",{value:"group",children:"Group"}),c.jsx("option",{value:"event",children:"Event"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Target URL"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:g.ads_url,onChange:J=>v({...g,ads_url:J.target.value}),placeholder:"https://example.com"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Image"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"file",accept:"image/*",onChange:Q}),b&&c.jsx("span",{className:"text-sm",children:"Uploading…"})]}),g.ads_image&&c.jsx("img",{src:FYe+"/uploads/"+Kn(g.ads_image),className:"h-24 mt-2 rounded-lg"})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{disabled:T,className:"w-full sm:w-auto px-5 py-2 rounded-xl bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",children:T?"Publishing…":"Publish"})})]})]})]}),c.jsxs("section",{className:"rounded-2xl border bg-white shadow p-4 sm:p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsx("h2",{className:"text-xl font-semibold",children:"My Campaigns"})}),c.jsxs("div",{className:"grid md:hidden gap-3",children:[R.map(J=>c.jsxs("div",{className:"rounded-xl border p-4",children:[c.jsx("div",{className:"font-semibold",children:J.campaign_title}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[new Date(J.campaign_start_date).toLocaleDateString()," –"," ",new Date(J.campaign_end_date).toLocaleDateString()]}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[c.jsxs("div",{children:["Budget: ₦",J.campaign_budget.toFixed(2)]}),c.jsxs("div",{children:["Spend: ₦",J.campaign_spend.toFixed(2)]}),c.jsxs("div",{children:["Bidding: ",J.campaign_bidding==="click"?"Click":"View"]}),c.jsxs("div",{children:["Clicks/Views: ",J.campaign_clicks," / ",J.campaign_views]})]}),c.jsx("div",{className:"mt-2",children:J.campaign_is_active==="1"?c.jsx("span",{className:"rounded-full bg-green-100 text-green-700 px-2 py-0.5 text-xs",children:"Active"}):c.jsx("span",{className:"rounded-full bg-gray-100 text-gray-700 px-2 py-0.5 text-xs",children:"Not Active"})}),c.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[J.campaign_is_active==="1"?c.jsx("button",{onClick:async()=>{const re=await UC(J.campaign_id,!1,n);re!=null&&re.ok?(Ce.success("Campaign paused"),ae()):Ce.error((re==null?void 0:re.error)||"Failed to pause")},className:"text-xs rounded-md border px-3 py-1",children:"Pause"}):c.jsx("button",{onClick:async()=>{const re=await UC(J.campaign_id,!0,n);re!=null&&re.ok?(Ce.success("Campaign resumed"),ae()):Ce.error((re==null?void 0:re.error)||"Failed to resume")},className:"text-xs rounded-md border px-3 py-1",children:"Resume"}),c.jsx("button",{onClick:()=>U(J),className:"text-xs rounded-md border px-3 py-1",children:"Edit"}),c.jsx("button",{onClick:()=>oe(J),className:"text-xs rounded-md border px-3 py-1 text-red-600 border-red-300",children:"Delete"})]})]},J.campaign_id)),!R.length&&c.jsx("div",{className:"text-center text-gray-500 py-6",children:"No campaigns yet."})]}),c.jsx("div",{className:"hidden md:block overflow-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"[&>th]:text-left [&>th]:py-2",children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Start - End"}),c.jsx("th",{children:"Budget"}),c.jsx("th",{children:"Spend"}),c.jsx("th",{children:"Bidding"}),c.jsx("th",{children:"Clicks/Views"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Created"}),c.jsx("th",{children:"Actions"})]})}),c.jsxs("tbody",{children:[R.map(J=>c.jsxs("tr",{className:"[&>td]:py-2 border-t",children:[c.jsx("td",{children:J.campaign_title}),c.jsxs("td",{children:[new Date(J.campaign_start_date).toLocaleDateString()," -"," ",new Date(J.campaign_end_date).toLocaleDateString()]}),c.jsxs("td",{children:["₦",J.campaign_budget.toFixed(2)]}),c.jsxs("td",{children:["₦",J.campaign_spend.toFixed(2)]}),c.jsx("td",{children:J.campaign_bidding==="click"?"🖱 Click":"👁 View"}),c.jsxs("td",{children:[J.campaign_clicks," / ",J.campaign_views]}),c.jsx("td",{children:J.campaign_is_active==="1"?c.jsx("span",{className:"rounded-full bg-green-100 text-green-700 px-2 py-0.5",children:"Active"}):c.jsx("span",{className:"rounded-full bg-gray-100 text-gray-700 px-2 py-0.5",children:"Not Active"})}),c.jsx("td",{children:new Date(J.campaign_created_date).toLocaleDateString()}),c.jsxs("td",{className:"space-x-2",children:[J.campaign_is_active==="1"?c.jsx("button",{onClick:async()=>{const re=await UC(J.campaign_id,!1,n);re!=null&&re.ok?(Ce.success("Campaign paused"),ae()):Ce.error((re==null?void 0:re.error)||"Failed to pause")},className:"text-xs rounded-md border px-2 py-1",children:"Pause"}):c.jsx("button",{onClick:async()=>{const re=await UC(J.campaign_id,!0,n);re!=null&&re.ok?(Ce.success("Campaign resumed"),ae()):Ce.error((re==null?void 0:re.error)||"Failed to resume")},className:"text-xs rounded-md border px-2 py-1",children:"Resume"}),c.jsx("button",{onClick:()=>U(J),className:"text-xs rounded-md border px-2 py-1",children:"Edit"}),c.jsx("button",{onClick:()=>oe(J),className:"text-xs rounded-md border px-2 py-1 text-red-600 border-red-300",children:"Delete"})]})]},J.campaign_id)),!R.length&&c.jsx("tr",{children:c.jsx("td",{colSpan:9,className:"py-8 text-center text-gray-500",children:"No campaigns yet."})})]})]})}),c.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[c.jsx("button",{disabled:O<=1,onClick:()=>ae(O-1),className:"text-sm border px-3 py-1 rounded-md disabled:opacity-50",children:"Previous"}),c.jsxs("div",{className:"text-sm",children:["Page ",O," / ",M]}),c.jsx("button",{disabled:O>=M,onClick:()=>ae(O+1),className:"text-sm border px-3 py-1 rounded-md disabled:opacity-50",children:"Next"})]})]})]})]})}),D&&V&&c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>U(null)}),c.jsxs("div",{className:"relative bg-white w-[95%] max-w-3xl rounded-2xl shadow-xl p-4 sm:p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Edit Campaign"}),c.jsx("button",{onClick:()=>U(null),className:"text-sm",children:"✕"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Campaign Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:V.campaign_title,onChange:J=>z({...V,campaign_title:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Budget (₦)"}),c.jsx("input",{type:"number",min:0,className:"w-full border rounded-lg p-2",value:V.campaign_budget,onChange:J=>z({...V,campaign_budget:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Start"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:V.campaign_start_date,onChange:J=>z({...V,campaign_start_date:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"End"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:V.campaign_end_date,onChange:J=>z({...V,campaign_end_date:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Bidding"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:V.campaign_bidding,onChange:J=>z({...V,campaign_bidding:J.target.value}),children:[c.jsx("option",{value:"click",children:"Pay Per Click (₦50)"}),c.jsx("option",{value:"view",children:"Pay Per View (₦10)"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Placement"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:V.ads_placement,onChange:J=>z({...V,ads_placement:J.target.value}),children:[c.jsx("option",{value:"newsfeed",children:"Newsfeed"}),c.jsx("option",{value:"sidebar",children:"Sidebar"})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:V.ads_title,onChange:J=>z({...V,ads_title:J.target.value})})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Description (max 200)"}),c.jsx("textarea",{maxLength:200,rows:4,className:"w-full border rounded-lg p-2",value:V.ads_description,onChange:J=>z({...V,ads_description:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Advertise For"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:V.ads_type,onChange:J=>z({...V,ads_type:J.target.value}),children:[c.jsx("option",{value:"url",children:"URL"}),c.jsx("option",{value:"post",children:"Post"}),c.jsx("option",{value:"page",children:"Page"}),c.jsx("option",{value:"group",children:"Group"}),c.jsx("option",{value:"event",children:"Event"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Target URL"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:V.ads_url,onChange:J=>z({...V,ads_url:J.target.value})})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium",children:"Countries"}),c.jsx(cte,{isMulti:!0,options:o,value:V.audience_countries,onChange:J=>z({...V,audience_countries:J||[]}),classNamePrefix:"select",placeholder:"Select countries..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Gender"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:V.audience_gender,onChange:J=>z({...V,audience_gender:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Relationship"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:V.audience_relationship,onChange:J=>z({...V,audience_relationship:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"single",children:"Single"}),c.jsx("option",{value:"married",children:"Married"})]})]})]}),c.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>U(null),className:"px-4 py-2 border rounded-lg",children:"Cancel"}),c.jsx("button",{onClick:ee,disabled:W,className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",children:W?"Saving…":"Save changes"})]})]})]})]})}function BYe({children:e}){const{accessToken:t,isLoading:n}=st(),i=Gc();return n?null:t?e:c.jsx(Fce,{to:"/login",replace:!0,state:{from:i}})}function $Ye(e,t){return Array.isArray(e)?e:typeof e=="string"&&e?[e]:Array.isArray(t)?t:typeof t=="string"&&t?[t]:[]}function WYe(e,t){return $Ye(e==null?void 0:e.roles,e==null?void 0:e.role).some(i=>t.includes(i))}function GYe({roles:e,children:t}){const{user:n,isLoading:i}=st(),o=Gc();return i?null:(console.log(n,"useruseruser"),n&&WYe(n,e)?t:c.jsx(Fce,{to:"/",replace:!0,state:{from:o}}))}const lte=[{to:"/admin/",label:"Dashboard",icon:HVe},{to:"/admin/users",label:"Users",icon:uy},{to:"/admin/posts",label:"Posts",icon:e4e},{to:"/admin/representatives",label:"Representatives",icon:KVe},{to:"/admin/banktransfers",label:"Bank Transfers",icon:CN},{to:"/admin/earningspayments",label:"Earning-Payments",icon:k4},{label:"Earnings",icon:fU,children:[{to:"/admin/earnings/packages",label:"Earnings",icon:fU}]},{label:"Pages",icon:SN,children:[{to:"/admin/pages",label:"Pages",icon:SN},{to:"/admin/page-categories",label:"Pages Categories",icon:XZ}]},{label:"Wallet",icon:dy,children:[{to:"/admin/payment-requests",label:"Payment requests",icon:dy},{to:"/admin/wallet-settings",label:"Wallet settings",icon:XZ}]},{label:"Settings",icon:ile,children:[{to:"/admin/settings/payments",label:"Payment setttings",icon:I0},{to:"/admin/settings/points",label:"Points setttings",icon:I0}]},{label:"Groups",icon:mU,children:[{to:"/admin/groups",label:"Groups",icon:mU},{to:"/admin/group-categories",label:"Group Categories",icon:Y2}]},{label:"Events",icon:A0,children:[{to:"/admin/events",label:"Events",icon:A0},{to:"/admin/events-categories",label:"Events Categories",icon:Y2}]},{label:"Ads Management",icon:O0,children:[{to:"/admin/ads",label:"Ads Management",icon:O0},{to:"/admin/adssettings",label:"AdminAdsSettings",icon:GZ}]},{label:"Pros",icon:YZ,children:[{to:"/admin/packages",label:"Packages",icon:YZ},{to:"/admin/subscribers",label:"Subscribers",icon:Y2}]},{label:"Reports",icon:NN,children:[{to:"/admin/reports",label:"Reports",icon:NN},{to:"/admin/reports/categories",label:"Reports categories",icon:GZ}]}];function HYe(){const{pathname:e}=Gc(),[t,n]=S.useState(!1),i=S.useMemo(()=>{const v=new Map;return lte.forEach(b=>{var E;if((E=b.children)!=null&&E.length){const T=b.children.some(C=>e===C.to||e.startsWith(`${C.to}/`));v.set(b.label,T)}}),v},[e]),[o,u]=S.useState({});S.useEffect(()=>{u(v=>{const b={...v};return i.forEach((E,T)=>{E&&(b[T]=!0)}),b})},[i]);const h=v=>u(b=>({...b,[v]:!b[v]})),p=({active:v,children:b,onClick:E})=>c.jsx(be,{variant:v?"default":"ghost",className:"w-full justify-start",onClick:E,children:b}),g=c.jsx("nav",{className:"p-4 space-y-2",children:lte.map(v=>{var T;if((T=v.children)!=null&&T.length){const C=v.icon,R=v.label,N=!!i.get(R),O=!!o[R];return c.jsxs("div",{className:"space-y-1",children:[c.jsxs(p,{active:N,onClick:()=>h(R),children:[c.jsx(C,{className:"h-4 w-4 mr-2"}),c.jsx("span",{className:"flex-1 text-left",children:R}),O?c.jsx(Zy,{className:"h-4 w-4 opacity-70"}):c.jsx(Lw,{className:"h-4 w-4 opacity-70"})]}),O&&c.jsx("div",{className:"ml-6 space-y-1",children:v.children.map(k=>{const j=k.icon||SN,P=e===k.to||e.startsWith(`${k.to}/`);return c.jsx(Nt,{to:k.to,onClick:()=>n(!1),className:"block",children:c.jsxs(p,{active:P,children:[c.jsx(j,{className:"h-4 w-4 mr-2"}),k.label]})},k.to)})})]},R)}const b=v.icon,E=e===v.to||e.startsWith(`${v.to}/`);return c.jsx(Nt,{to:v.to,onClick:()=>n(!1),className:"block",children:c.jsxs(p,{active:E,children:[c.jsx(b,{className:"h-4 w-4 mr-2"}),v.label]})},v.to)})});return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[c.jsx("aside",{className:"hidden md:block w-64 border-r bg-white",children:c.jsx("div",{className:"sticky top-16 h-[calc(100vh-4rem)] overflow-y-auto",children:g})}),c.jsxs(B1,{open:t,onOpenChange:n,children:[c.jsx(lB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"md:hidden fixed top-16 left-2 z-20",children:c.jsx(Qce,{className:"h-5 w-5"})})}),c.jsx(Gw,{side:"left",className:"p-0 w-72",children:g})]}),c.jsx("main",{className:"flex-1 min-h-0 overflow-y-auto p-4 md:p-6",children:c.jsx(BFe,{})})]})]})}var zYe=Array.isArray,_o=zYe,KYe=typeof Zh=="object"&&Zh&&Zh.Object===Object&&Zh,Upe=KYe,qYe=Upe,YYe=typeof self=="object"&&self&&self.Object===Object&&self,XYe=qYe||YYe||Function("return this")(),Xu=XYe,JYe=Xu,ZYe=JYe.Symbol,eS=ZYe,ute=eS,Fpe=Object.prototype,QYe=Fpe.hasOwnProperty,eXe=Fpe.toString,_E=ute?ute.toStringTag:void 0;function tXe(e){var t=QYe.call(e,_E),n=e[_E];try{e[_E]=void 0;var i=!0}catch{}var o=eXe.call(e);return i&&(t?e[_E]=n:delete e[_E]),o}var nXe=tXe,rXe=Object.prototype,iXe=rXe.toString;function aXe(e){return iXe.call(e)}var sXe=aXe,dte=eS,oXe=nXe,cXe=sXe,lXe="[object Null]",uXe="[object Undefined]",hte=dte?dte.toStringTag:void 0;function dXe(e){return e==null?e===void 0?uXe:lXe:hte&&hte in Object(e)?oXe(e):cXe(e)}var Jd=dXe;function hXe(e){return e!=null&&typeof e=="object"}var Zd=hXe,fXe=Jd,pXe=Zd,mXe="[object Symbol]";function gXe(e){return typeof e=="symbol"||pXe(e)&&fXe(e)==mXe}var l_=gXe,vXe=_o,yXe=l_,_Xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bXe=/^\w*$/;function EXe(e,t){if(vXe(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||yXe(e)?!0:bXe.test(e)||!_Xe.test(e)||t!=null&&e in Object(t)}var GB=EXe;function wXe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Mf=wXe;const u_=jr(Mf);var SXe=Jd,xXe=Mf,TXe="[object AsyncFunction]",CXe="[object Function]",RXe="[object GeneratorFunction]",NXe="[object Proxy]";function AXe(e){if(!xXe(e))return!1;var t=SXe(e);return t==CXe||t==RXe||t==TXe||t==NXe}var HB=AXe;const zn=jr(HB);var IXe=Xu,OXe=IXe["__core-js_shared__"],PXe=OXe,CL=PXe,fte=function(){var e=/[^.]+$/.exec(CL&&CL.keys&&CL.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function kXe(e){return!!fte&&fte in e}var jXe=kXe,DXe=Function.prototype,LXe=DXe.toString;function MXe(e){if(e!=null){try{return LXe.call(e)}catch{}try{return e+""}catch{}}return""}var Vpe=MXe,UXe=HB,FXe=jXe,VXe=Mf,BXe=Vpe,$Xe=/[\\^$.*+?()[\]{}|]/g,WXe=/^\[object .+?Constructor\]$/,GXe=Function.prototype,HXe=Object.prototype,zXe=GXe.toString,KXe=HXe.hasOwnProperty,qXe=RegExp("^"+zXe.call(KXe).replace($Xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function YXe(e){if(!VXe(e)||FXe(e))return!1;var t=UXe(e)?qXe:WXe;return t.test(BXe(e))}var XXe=YXe;function JXe(e,t){return e==null?void 0:e[t]}var ZXe=JXe,QXe=XXe,eJe=ZXe;function tJe(e,t){var n=eJe(e,t);return QXe(n)?n:void 0}var Pm=tJe,nJe=Pm,rJe=nJe(Object,"create"),wI=rJe,pte=wI;function iJe(){this.__data__=pte?pte(null):{},this.size=0}var aJe=iJe;function sJe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var oJe=sJe,cJe=wI,lJe="__lodash_hash_undefined__",uJe=Object.prototype,dJe=uJe.hasOwnProperty;function hJe(e){var t=this.__data__;if(cJe){var n=t[e];return n===lJe?void 0:n}return dJe.call(t,e)?t[e]:void 0}var fJe=hJe,pJe=wI,mJe=Object.prototype,gJe=mJe.hasOwnProperty;function vJe(e){var t=this.__data__;return pJe?t[e]!==void 0:gJe.call(t,e)}var yJe=vJe,_Je=wI,bJe="__lodash_hash_undefined__";function EJe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_Je&&t===void 0?bJe:t,this}var wJe=EJe,SJe=aJe,xJe=oJe,TJe=fJe,CJe=yJe,RJe=wJe;function d_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}d_.prototype.clear=SJe;d_.prototype.delete=xJe;d_.prototype.get=TJe;d_.prototype.has=CJe;d_.prototype.set=RJe;var NJe=d_;function AJe(){this.__data__=[],this.size=0}var IJe=AJe;function OJe(e,t){return e===t||e!==e&&t!==t}var zB=OJe,PJe=zB;function kJe(e,t){for(var n=e.length;n--;)if(PJe(e[n][0],t))return n;return-1}var SI=kJe,jJe=SI,DJe=Array.prototype,LJe=DJe.splice;function MJe(e){var t=this.__data__,n=jJe(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():LJe.call(t,n,1),--this.size,!0}var UJe=MJe,FJe=SI;function VJe(e){var t=this.__data__,n=FJe(t,e);return n<0?void 0:t[n][1]}var BJe=VJe,$Je=SI;function WJe(e){return $Je(this.__data__,e)>-1}var GJe=WJe,HJe=SI;function zJe(e,t){var n=this.__data__,i=HJe(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}var KJe=zJe,qJe=IJe,YJe=UJe,XJe=BJe,JJe=GJe,ZJe=KJe;function h_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}h_.prototype.clear=qJe;h_.prototype.delete=YJe;h_.prototype.get=XJe;h_.prototype.has=JJe;h_.prototype.set=ZJe;var xI=h_,QJe=Pm,eZe=Xu,tZe=QJe(eZe,"Map"),KB=tZe,mte=NJe,nZe=xI,rZe=KB;function iZe(){this.size=0,this.__data__={hash:new mte,map:new(rZe||nZe),string:new mte}}var aZe=iZe;function sZe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var oZe=sZe,cZe=oZe;function lZe(e,t){var n=e.__data__;return cZe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var TI=lZe,uZe=TI;function dZe(e){var t=uZe(this,e).delete(e);return this.size-=t?1:0,t}var hZe=dZe,fZe=TI;function pZe(e){return fZe(this,e).get(e)}var mZe=pZe,gZe=TI;function vZe(e){return gZe(this,e).has(e)}var yZe=vZe,_Ze=TI;function bZe(e,t){var n=_Ze(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}var EZe=bZe,wZe=aZe,SZe=hZe,xZe=mZe,TZe=yZe,CZe=EZe;function f_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}f_.prototype.clear=wZe;f_.prototype.delete=SZe;f_.prototype.get=xZe;f_.prototype.has=TZe;f_.prototype.set=CZe;var qB=f_,Bpe=qB,RZe="Expected a function";function YB(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(RZe);var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],u=n.cache;if(u.has(o))return u.get(o);var h=e.apply(this,i);return n.cache=u.set(o,h)||u,h};return n.cache=new(YB.Cache||Bpe),n}YB.Cache=Bpe;var $pe=YB;const NZe=jr($pe);var AZe=$pe,IZe=500;function OZe(e){var t=AZe(e,function(i){return n.size===IZe&&n.clear(),i}),n=t.cache;return t}var PZe=OZe,kZe=PZe,jZe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,DZe=/\\(\\)?/g,LZe=kZe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(jZe,function(n,i,o,u){t.push(o?u.replace(DZe,"$1"):i||n)}),t}),MZe=LZe;function UZe(e,t){for(var n=-1,i=e==null?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}var XB=UZe,gte=eS,FZe=XB,VZe=_o,BZe=l_,vte=gte?gte.prototype:void 0,yte=vte?vte.toString:void 0;function Wpe(e){if(typeof e=="string")return e;if(VZe(e))return FZe(e,Wpe)+"";if(BZe(e))return yte?yte.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var $Ze=Wpe,WZe=$Ze;function GZe(e){return e==null?"":WZe(e)}var Gpe=GZe,HZe=_o,zZe=GB,KZe=MZe,qZe=Gpe;function YZe(e,t){return HZe(e)?e:zZe(e,t)?[e]:KZe(qZe(e))}var Hpe=YZe,XZe=l_;function JZe(e){if(typeof e=="string"||XZe(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var CI=JZe,ZZe=Hpe,QZe=CI;function eQe(e,t){t=ZZe(t,e);for(var n=0,i=t.length;e!=null&&n<i;)e=e[QZe(t[n++])];return n&&n==i?e:void 0}var JB=eQe,tQe=JB;function nQe(e,t,n){var i=e==null?void 0:tQe(e,t);return i===void 0?n:i}var zpe=nQe;const Vc=jr(zpe);function rQe(e){return e==null}var iQe=rQe;const Nr=jr(iQe);var aQe=Jd,sQe=_o,oQe=Zd,cQe="[object String]";function lQe(e){return typeof e=="string"||!sQe(e)&&oQe(e)&&aQe(e)==cQe}var uQe=lQe;const mm=jr(uQe);var Kpe={exports:{}},Wr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZB=Symbol.for("react.element"),QB=Symbol.for("react.portal"),RI=Symbol.for("react.fragment"),NI=Symbol.for("react.strict_mode"),AI=Symbol.for("react.profiler"),II=Symbol.for("react.provider"),OI=Symbol.for("react.context"),dQe=Symbol.for("react.server_context"),PI=Symbol.for("react.forward_ref"),kI=Symbol.for("react.suspense"),jI=Symbol.for("react.suspense_list"),DI=Symbol.for("react.memo"),LI=Symbol.for("react.lazy"),hQe=Symbol.for("react.offscreen"),qpe;qpe=Symbol.for("react.module.reference");function Kc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case ZB:switch(e=e.type,e){case RI:case AI:case NI:case kI:case jI:return e;default:switch(e=e&&e.$$typeof,e){case dQe:case OI:case PI:case LI:case DI:case II:return e;default:return t}}case QB:return t}}}Wr.ContextConsumer=OI;Wr.ContextProvider=II;Wr.Element=ZB;Wr.ForwardRef=PI;Wr.Fragment=RI;Wr.Lazy=LI;Wr.Memo=DI;Wr.Portal=QB;Wr.Profiler=AI;Wr.StrictMode=NI;Wr.Suspense=kI;Wr.SuspenseList=jI;Wr.isAsyncMode=function(){return!1};Wr.isConcurrentMode=function(){return!1};Wr.isContextConsumer=function(e){return Kc(e)===OI};Wr.isContextProvider=function(e){return Kc(e)===II};Wr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ZB};Wr.isForwardRef=function(e){return Kc(e)===PI};Wr.isFragment=function(e){return Kc(e)===RI};Wr.isLazy=function(e){return Kc(e)===LI};Wr.isMemo=function(e){return Kc(e)===DI};Wr.isPortal=function(e){return Kc(e)===QB};Wr.isProfiler=function(e){return Kc(e)===AI};Wr.isStrictMode=function(e){return Kc(e)===NI};Wr.isSuspense=function(e){return Kc(e)===kI};Wr.isSuspenseList=function(e){return Kc(e)===jI};Wr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===RI||e===AI||e===NI||e===kI||e===jI||e===hQe||typeof e=="object"&&e!==null&&(e.$$typeof===LI||e.$$typeof===DI||e.$$typeof===II||e.$$typeof===OI||e.$$typeof===PI||e.$$typeof===qpe||e.getModuleId!==void 0)};Wr.typeOf=Kc;Kpe.exports=Wr;var fQe=Kpe.exports,pQe=Jd,mQe=Zd,gQe="[object Number]";function vQe(e){return typeof e=="number"||mQe(e)&&pQe(e)==gQe}var Ype=vQe;const yQe=jr(Ype);var _Qe=Ype;function bQe(e){return _Qe(e)&&e!=+e}var EQe=bQe;const tS=jr(EQe);var Ml=function(t){return t===0?0:t>0?1:-1},Bp=function(t){return mm(t)&&t.indexOf("%")===t.length-1},xt=function(t){return yQe(t)&&!tS(t)},wQe=function(t){return Nr(t)},Oa=function(t){return xt(t)||mm(t)},SQe=0,MI=function(t){var n=++SQe;return"".concat(t||"").concat(n)},gm=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!xt(t)&&!mm(t))return i;var u;if(Bp(t)){var h=t.indexOf("%");u=n*parseFloat(t.slice(0,h))/100}else u=+t;return tS(u)&&(u=i),o&&u>n&&(u=n),u},zh=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},xQe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,i={},o=0;o<n;o++)if(!i[t[o]])i[t[o]]=!0;else return!0;return!1},uv=function(t,n){return xt(t)&&xt(n)?function(i){return t+i*(n-t)}:function(){return n}};function YU(e,t,n){return!e||!e.length?null:e.find(function(i){return i&&(typeof t=="function"?t(i):Vc(i,t))===n})}var TQe=function(t,n){return xt(t)&&xt(n)?t-n:mm(t)&&mm(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function Wv(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function XU(e){"@babel/helpers - typeof";return XU=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XU(e)}var CQe=["viewBox","children"],RQe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],_te=["points","pathLength"],RL={svg:CQe,polygon:_te,polyline:_te},e3=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ZN=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(S.isValidElement(t)&&(i=t.props),!u_(i))return null;var o={};return Object.keys(i).forEach(function(u){e3.includes(u)&&(o[u]=n||function(h){return i[u](i,h)})}),o},NQe=function(t,n,i){return function(o){return t(n,i,o),null}},QN=function(t,n,i){if(!u_(t)||XU(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(u){var h=t[u];e3.includes(u)&&typeof h=="function"&&(o||(o={}),o[u]=NQe(h,n,i))}),o},AQe=["children"],IQe=["children"];function bte(e,t){if(e==null)return{};var n=OQe(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function OQe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var Ete={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Pd=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},wte=null,NL=null,t3=function e(t){if(t===wte&&Array.isArray(NL))return NL;var n=[];return S.Children.forEach(t,function(i){Nr(i)||(fQe.isFragment(i)?n=n.concat(e(i.props.children)):n.push(i))}),NL=n,wte=t,n};function Bl(e,t){var n=[],i=[];return Array.isArray(t)?i=t.map(function(o){return Pd(o)}):i=[Pd(t)],t3(e).forEach(function(o){var u=Vc(o,"type.displayName")||Vc(o,"type.name");i.indexOf(u)!==-1&&n.push(o)}),n}function Fo(e,t){var n=Bl(e,t);return n&&n[0]}var Ste=function(t){if(!t||!t.props)return!1;var n=t.props,i=n.width,o=n.height;return!(!xt(i)||i<=0||!xt(o)||o<=0)},PQe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],kQe=function(t){return t&&t.type&&mm(t.type)&&PQe.indexOf(t.type)>=0},jQe=function(t,n,i,o){var u,h=(u=RL==null?void 0:RL[o])!==null&&u!==void 0?u:[];return n.startsWith("data-")||!zn(t)&&(o&&h.includes(n)||RQe.includes(n))||i&&e3.includes(n)},Tr=function(t,n,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(S.isValidElement(t)&&(o=t.props),!u_(o))return null;var u={};return Object.keys(o).forEach(function(h){var p;jQe((p=o)===null||p===void 0?void 0:p[h],h,n,i)&&(u[h]=o[h])}),u},JU=function e(t,n){if(t===n)return!0;var i=S.Children.count(t);if(i!==S.Children.count(n))return!1;if(i===0)return!0;if(i===1)return xte(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var o=0;o<i;o++){var u=t[o],h=n[o];if(Array.isArray(u)||Array.isArray(h)){if(!e(u,h))return!1}else if(!xte(u,h))return!1}return!0},xte=function(t,n){if(Nr(t)&&Nr(n))return!0;if(!Nr(t)&&!Nr(n)){var i=t.props||{},o=i.children,u=bte(i,AQe),h=n.props||{},p=h.children,g=bte(h,IQe);return o&&p?Wv(u,g)&&JU(o,p):!o&&!p?Wv(u,g):!1}return!1},Tte=function(t,n){var i=[],o={};return t3(t).forEach(function(u,h){if(kQe(u))i.push(u);else if(u){var p=Pd(u.type),g=n[p]||{},v=g.handler,b=g.once;if(v&&(!b||!o[p])){var E=v(u,p,h);i.push(E),o[p]=!0}}}),i},DQe=function(t){var n=t&&t.type;return n&&Ete[n]?Ete[n]:null},LQe=function(t,n){return t3(n).indexOf(t)},MQe=["children","width","height","viewBox","className","style","title","desc"];function ZU(){return ZU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ZU.apply(this,arguments)}function UQe(e,t){if(e==null)return{};var n=FQe(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function FQe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function QU(e){var t=e.children,n=e.width,i=e.height,o=e.viewBox,u=e.className,h=e.style,p=e.title,g=e.desc,v=UQe(e,MQe),b=o||{width:n,height:i,x:0,y:0},E=er("recharts-surface",u);return me.createElement("svg",ZU({},Tr(v,!0,"svg"),{className:E,width:n,height:i,style:h,viewBox:"".concat(b.x," ").concat(b.y," ").concat(b.width," ").concat(b.height)}),me.createElement("title",null,p),me.createElement("desc",null,g),t)}var VQe=["children","className"];function eF(){return eF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},eF.apply(this,arguments)}function BQe(e,t){if(e==null)return{};var n=$Qe(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function $Qe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var $a=me.forwardRef(function(e,t){var n=e.children,i=e.className,o=BQe(e,VQe),u=er("recharts-layer",i);return me.createElement("g",eF({className:u},Tr(o,!0),{ref:t}),n)}),kd=function(t,n){for(var i=arguments.length,o=new Array(i>2?i-2:0),u=2;u<i;u++)o[u-2]=arguments[u]};function WQe(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var u=Array(o);++i<o;)u[i]=e[i+t];return u}var GQe=WQe,HQe=GQe;function zQe(e,t,n){var i=e.length;return n=n===void 0?i:n,!t&&n>=i?e:HQe(e,t,n)}var KQe=zQe,qQe="\\ud800-\\udfff",YQe="\\u0300-\\u036f",XQe="\\ufe20-\\ufe2f",JQe="\\u20d0-\\u20ff",ZQe=YQe+XQe+JQe,QQe="\\ufe0e\\ufe0f",eet="\\u200d",tet=RegExp("["+eet+qQe+ZQe+QQe+"]");function net(e){return tet.test(e)}var Xpe=net;function ret(e){return e.split("")}var iet=ret,Jpe="\\ud800-\\udfff",aet="\\u0300-\\u036f",set="\\ufe20-\\ufe2f",oet="\\u20d0-\\u20ff",cet=aet+set+oet,uet="\\ufe0e\\ufe0f",det="["+Jpe+"]",tF="["+cet+"]",nF="\\ud83c[\\udffb-\\udfff]",het="(?:"+tF+"|"+nF+")",Zpe="[^"+Jpe+"]",Qpe="(?:\\ud83c[\\udde6-\\uddff]){2}",eme="[\\ud800-\\udbff][\\udc00-\\udfff]",fet="\\u200d",tme=het+"?",nme="["+uet+"]?",pet="(?:"+fet+"(?:"+[Zpe,Qpe,eme].join("|")+")"+nme+tme+")*",met=nme+tme+pet,get="(?:"+[Zpe+tF+"?",tF,Qpe,eme,det].join("|")+")",vet=RegExp(nF+"(?="+nF+")|"+get+met,"g");function yet(e){return e.match(vet)||[]}var _et=yet,bet=iet,Eet=Xpe,wet=_et;function xet(e){return Eet(e)?wet(e):bet(e)}var Tet=xet,Cet=KQe,Ret=Xpe,Net=Tet,Aet=Gpe;function Iet(e){return function(t){t=Aet(t);var n=Ret(t)?Net(t):void 0,i=n?n[0]:t.charAt(0),o=n?Cet(n,1).join(""):t.slice(1);return i[e]()+o}}var Oet=Iet,Pet=Oet,ket=Pet("toUpperCase"),jet=ket;const UI=jr(jet);function ii(e){return function(){return e}}const rme=Math.cos,eA=Math.sin,ql=Math.sqrt,tA=Math.PI,FI=2*tA,rF=Math.PI,iF=2*rF,jp=1e-6,Det=iF-jp;function ime(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Let(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ime;const n=10**t;return function(i){this._+=i[0];for(let o=1,u=i.length;o<u;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}class Met{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ime:Let(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,o){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+o}`}bezierCurveTo(t,n,i,o,u,h){this._append`C${+t},${+n},${+i},${+o},${this._x1=+u},${this._y1=+h}`}arcTo(t,n,i,o,u){if(t=+t,n=+n,i=+i,o=+o,u=+u,u<0)throw new Error(`negative radius: ${u}`);let h=this._x1,p=this._y1,g=i-t,v=o-n,b=h-t,E=p-n,T=b*b+E*E;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(T>jp)if(!(Math.abs(E*g-v*b)>jp)||!u)this._append`L${this._x1=t},${this._y1=n}`;else{let C=i-h,R=o-p,N=g*g+v*v,O=C*C+R*R,k=Math.sqrt(N),j=Math.sqrt(T),P=u*Math.tan((rF-Math.acos((N+T-O)/(2*k*j)))/2),M=P/j,D=P/k;Math.abs(M-1)>jp&&this._append`L${t+M*b},${n+M*E}`,this._append`A${u},${u},0,0,${+(E*C>b*R)},${this._x1=t+D*g},${this._y1=n+D*v}`}}arc(t,n,i,o,u,h){if(t=+t,n=+n,i=+i,h=!!h,i<0)throw new Error(`negative radius: ${i}`);let p=i*Math.cos(o),g=i*Math.sin(o),v=t+p,b=n+g,E=1^h,T=h?o-u:u-o;this._x1===null?this._append`M${v},${b}`:(Math.abs(this._x1-v)>jp||Math.abs(this._y1-b)>jp)&&this._append`L${v},${b}`,i&&(T<0&&(T=T%iF+iF),T>Det?this._append`A${i},${i},0,1,${E},${t-p},${n-g}A${i},${i},0,1,${E},${this._x1=v},${this._y1=b}`:T>jp&&this._append`A${i},${i},0,${+(T>=rF)},${E},${this._x1=t+i*Math.cos(u)},${this._y1=n+i*Math.sin(u)}`)}rect(t,n,i,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+o}h${-i}Z`}toString(){return this._}}function n3(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new Met(t)}function r3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ame(e){this._context=e}ame.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function VI(e){return new ame(e)}function sme(e){return e[0]}function ome(e){return e[1]}function cme(e,t){var n=ii(!0),i=null,o=VI,u=null,h=n3(p);e=typeof e=="function"?e:e===void 0?sme:ii(e),t=typeof t=="function"?t:t===void 0?ome:ii(t);function p(g){var v,b=(g=r3(g)).length,E,T=!1,C;for(i==null&&(u=o(C=h())),v=0;v<=b;++v)!(v<b&&n(E=g[v],v,g))===T&&((T=!T)?u.lineStart():u.lineEnd()),T&&u.point(+e(E,v,g),+t(E,v,g));if(C)return u=null,C+""||null}return p.x=function(g){return arguments.length?(e=typeof g=="function"?g:ii(+g),p):e},p.y=function(g){return arguments.length?(t=typeof g=="function"?g:ii(+g),p):t},p.defined=function(g){return arguments.length?(n=typeof g=="function"?g:ii(!!g),p):n},p.curve=function(g){return arguments.length?(o=g,i!=null&&(u=o(i)),p):o},p.context=function(g){return arguments.length?(g==null?i=u=null:u=o(i=g),p):i},p}function YC(e,t,n){var i=null,o=ii(!0),u=null,h=VI,p=null,g=n3(v);e=typeof e=="function"?e:e===void 0?sme:ii(+e),t=typeof t=="function"?t:ii(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?ome:ii(+n);function v(E){var T,C,R,N=(E=r3(E)).length,O,k=!1,j,P=new Array(N),M=new Array(N);for(u==null&&(p=h(j=g())),T=0;T<=N;++T){if(!(T<N&&o(O=E[T],T,E))===k)if(k=!k)C=T,p.areaStart(),p.lineStart();else{for(p.lineEnd(),p.lineStart(),R=T-1;R>=C;--R)p.point(P[R],M[R]);p.lineEnd(),p.areaEnd()}k&&(P[T]=+e(O,T,E),M[T]=+t(O,T,E),p.point(i?+i(O,T,E):P[T],n?+n(O,T,E):M[T]))}if(j)return p=null,j+""||null}function b(){return cme().defined(o).curve(h).context(u)}return v.x=function(E){return arguments.length?(e=typeof E=="function"?E:ii(+E),i=null,v):e},v.x0=function(E){return arguments.length?(e=typeof E=="function"?E:ii(+E),v):e},v.x1=function(E){return arguments.length?(i=E==null?null:typeof E=="function"?E:ii(+E),v):i},v.y=function(E){return arguments.length?(t=typeof E=="function"?E:ii(+E),n=null,v):t},v.y0=function(E){return arguments.length?(t=typeof E=="function"?E:ii(+E),v):t},v.y1=function(E){return arguments.length?(n=E==null?null:typeof E=="function"?E:ii(+E),v):n},v.lineX0=v.lineY0=function(){return b().x(e).y(t)},v.lineY1=function(){return b().x(e).y(n)},v.lineX1=function(){return b().x(i).y(t)},v.defined=function(E){return arguments.length?(o=typeof E=="function"?E:ii(!!E),v):o},v.curve=function(E){return arguments.length?(h=E,u!=null&&(p=h(u)),v):h},v.context=function(E){return arguments.length?(E==null?u=p=null:p=h(u=E),v):u},v}class lme{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Uet(e){return new lme(e,!0)}function Fet(e){return new lme(e,!1)}const i3={draw(e,t){const n=ql(t/tA);e.moveTo(n,0),e.arc(0,0,n,0,FI)}},Vet={draw(e,t){const n=ql(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},ume=ql(1/3),Bet=ume*2,$et={draw(e,t){const n=ql(t/Bet),i=n*ume;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}},Wet={draw(e,t){const n=ql(t),i=-n/2;e.rect(i,i,n,n)}},Get=.8908130915292852,dme=eA(tA/10)/eA(7*tA/10),Het=eA(FI/10)*dme,zet=-rme(FI/10)*dme,Ket={draw(e,t){const n=ql(t*Get),i=Het*n,o=zet*n;e.moveTo(0,-n),e.lineTo(i,o);for(let u=1;u<5;++u){const h=FI*u/5,p=rme(h),g=eA(h);e.lineTo(g*n,-p*n),e.lineTo(p*i-g*o,g*i+p*o)}e.closePath()}},AL=ql(3),qet={draw(e,t){const n=-ql(t/(AL*3));e.moveTo(0,n*2),e.lineTo(-AL*n,-n),e.lineTo(AL*n,-n),e.closePath()}},Rc=-.5,Nc=ql(3)/2,aF=1/ql(12),Yet=(aF/2+1)*3,Xet={draw(e,t){const n=ql(t/Yet),i=n/2,o=n*aF,u=i,h=n*aF+n,p=-u,g=h;e.moveTo(i,o),e.lineTo(u,h),e.lineTo(p,g),e.lineTo(Rc*i-Nc*o,Nc*i+Rc*o),e.lineTo(Rc*u-Nc*h,Nc*u+Rc*h),e.lineTo(Rc*p-Nc*g,Nc*p+Rc*g),e.lineTo(Rc*i+Nc*o,Rc*o-Nc*i),e.lineTo(Rc*u+Nc*h,Rc*h-Nc*u),e.lineTo(Rc*p+Nc*g,Rc*g-Nc*p),e.closePath()}};function Jet(e,t){let n=null,i=n3(o);e=typeof e=="function"?e:ii(e||i3),t=typeof t=="function"?t:ii(t===void 0?64:+t);function o(){let u;if(n||(n=u=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),u)return n=null,u+""||null}return o.type=function(u){return arguments.length?(e=typeof u=="function"?u:ii(u),o):e},o.size=function(u){return arguments.length?(t=typeof u=="function"?u:ii(+u),o):t},o.context=function(u){return arguments.length?(n=u??null,o):n},o}function nA(){}function rA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function hme(e){this._context=e}hme.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Zet(e){return new hme(e)}function fme(e){this._context=e}fme.prototype={areaStart:nA,areaEnd:nA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:rA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Qet(e){return new fme(e)}function pme(e){this._context=e}pme.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:rA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ett(e){return new pme(e)}function mme(e){this._context=e}mme.prototype={areaStart:nA,areaEnd:nA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function ttt(e){return new mme(e)}function Cte(e){return e<0?-1:1}function Rte(e,t,n){var i=e._x1-e._x0,o=t-e._x1,u=(e._y1-e._y0)/(i||o<0&&-0),h=(n-e._y1)/(o||i<0&&-0),p=(u*o+h*i)/(i+o);return(Cte(u)+Cte(h))*Math.min(Math.abs(u),Math.abs(h),.5*Math.abs(p))||0}function Nte(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function IL(e,t,n){var i=e._x0,o=e._y0,u=e._x1,h=e._y1,p=(u-i)/3;e._context.bezierCurveTo(i+p,o+p*t,u-p,h-p*n,u,h)}function iA(e){this._context=e}iA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:IL(this,this._t0,Nte(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,IL(this,Nte(this,n=Rte(this,e,t)),n);break;default:IL(this,this._t0,n=Rte(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function gme(e){this._context=new vme(e)}(gme.prototype=Object.create(iA.prototype)).point=function(e,t){iA.prototype.point.call(this,t,e)};function vme(e){this._context=e}vme.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,o,u){this._context.bezierCurveTo(t,e,i,n,u,o)}};function ntt(e){return new iA(e)}function rtt(e){return new gme(e)}function yme(e){this._context=e}yme.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=Ate(e),o=Ate(t),u=0,h=1;h<n;++u,++h)this._context.bezierCurveTo(i[0][u],o[0][u],i[1][u],o[1][u],e[h],t[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Ate(e){var t,n=e.length-1,i,o=new Array(n),u=new Array(n),h=new Array(n);for(o[0]=0,u[0]=2,h[0]=e[0]+2*e[1],t=1;t<n-1;++t)o[t]=1,u[t]=4,h[t]=4*e[t]+2*e[t+1];for(o[n-1]=2,u[n-1]=7,h[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=o[t]/u[t-1],u[t]-=i,h[t]-=i*h[t-1];for(o[n-1]=h[n-1]/u[n-1],t=n-2;t>=0;--t)o[t]=(h[t]-o[t+1])/u[t];for(u[n-1]=(e[n]+o[n-1])/2,t=0;t<n-1;++t)u[t]=2*e[t+1]-o[t+1];return[o,u]}function itt(e){return new yme(e)}function BI(e,t){this._context=e,this._t=t}BI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function att(e){return new BI(e,.5)}function stt(e){return new BI(e,0)}function ott(e){return new BI(e,1)}function Ey(e,t){if((h=e.length)>1)for(var n=1,i,o,u=e[t[0]],h,p=u.length;n<h;++n)for(o=u,u=e[t[n]],i=0;i<p;++i)u[i][1]+=u[i][0]=isNaN(o[i][1])?o[i][0]:o[i][1]}function sF(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function ctt(e,t){return e[t]}function ltt(e){const t=[];return t.key=e,t}function utt(){var e=ii([]),t=sF,n=Ey,i=ctt;function o(u){var h=Array.from(e.apply(this,arguments),ltt),p,g=h.length,v=-1,b;for(const E of u)for(p=0,++v;p<g;++p)(h[p][v]=[0,+i(E,h[p].key,v,u)]).data=E;for(p=0,b=r3(t(h));p<g;++p)h[b[p]].index=p;return n(h,b),h}return o.keys=function(u){return arguments.length?(e=typeof u=="function"?u:ii(Array.from(u)),o):e},o.value=function(u){return arguments.length?(i=typeof u=="function"?u:ii(+u),o):i},o.order=function(u){return arguments.length?(t=u==null?sF:typeof u=="function"?u:ii(Array.from(u)),o):t},o.offset=function(u){return arguments.length?(n=u??Ey,o):n},o}function dtt(e,t){if((i=e.length)>0){for(var n,i,o=0,u=e[0].length,h;o<u;++o){for(h=n=0;n<i;++n)h+=e[n][o][1]||0;if(h)for(n=0;n<i;++n)e[n][o][1]/=h}Ey(e,t)}}function htt(e,t){if((o=e.length)>0){for(var n=0,i=e[t[0]],o,u=i.length;n<u;++n){for(var h=0,p=0;h<o;++h)p+=e[h][n][1]||0;i[n][1]+=i[n][0]=-p/2}Ey(e,t)}}function ftt(e,t){if(!(!((h=e.length)>0)||!((u=(o=e[t[0]]).length)>0))){for(var n=0,i=1,o,u,h;i<u;++i){for(var p=0,g=0,v=0;p<h;++p){for(var b=e[t[p]],E=b[i][1]||0,T=b[i-1][1]||0,C=(E-T)/2,R=0;R<p;++R){var N=e[t[R]],O=N[i][1]||0,k=N[i-1][1]||0;C+=O-k}g+=E,v+=C*E}o[i-1][1]+=o[i-1][0]=n,g&&(n-=v/g)}o[i-1][1]+=o[i-1][0]=n,Ey(e,t)}}function G0(e){"@babel/helpers - typeof";return G0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G0(e)}var ptt=["type","size","sizeType"];function oF(){return oF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},oF.apply(this,arguments)}function Ite(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ote(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ite(Object(n),!0).forEach(function(i){mtt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ite(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function mtt(e,t,n){return t=gtt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gtt(e){var t=vtt(e,"string");return G0(t)=="symbol"?t:t+""}function vtt(e,t){if(G0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(G0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ytt(e,t){if(e==null)return{};var n=_tt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function _tt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var _me={symbolCircle:i3,symbolCross:Vet,symbolDiamond:$et,symbolSquare:Wet,symbolStar:Ket,symbolTriangle:qet,symbolWye:Xet},btt=Math.PI/180,Ett=function(t){var n="symbol".concat(UI(t));return _me[n]||i3},wtt=function(t,n,i){if(n==="area")return t;switch(i){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*btt;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Stt=function(t,n){_me["symbol".concat(UI(t))]=n},a3=function(t){var n=t.type,i=n===void 0?"circle":n,o=t.size,u=o===void 0?64:o,h=t.sizeType,p=h===void 0?"area":h,g=ytt(t,ptt),v=Ote(Ote({},g),{},{type:i,size:u,sizeType:p}),b=function(){var O=Ett(i),k=Jet().type(O).size(wtt(u,p,i));return k()},E=v.className,T=v.cx,C=v.cy,R=Tr(v,!0);return T===+T&&C===+C&&u===+u?me.createElement("path",oF({},R,{className:er("recharts-symbols",E),transform:"translate(".concat(T,", ").concat(C,")"),d:b()})):null};a3.registerSymbol=Stt;function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function cF(){return cF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cF.apply(this,arguments)}function Pte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function xtt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pte(Object(n),!0).forEach(function(i){H0(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Ttt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ctt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Eme(i.key),i)}}function Rtt(e,t,n){return t&&Ctt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ntt(e,t,n){return t=aA(t),Att(e,bme()?Reflect.construct(t,n||[],aA(e).constructor):t.apply(e,n))}function Att(e,t){if(t&&(wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Itt(e)}function Itt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bme=function(){return!!e})()}function aA(e){return aA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},aA(e)}function Ott(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lF(e,t)}function lF(e,t){return lF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},lF(e,t)}function H0(e,t,n){return t=Eme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eme(e){var t=Ptt(e,"string");return wy(t)=="symbol"?t:t+""}function Ptt(e,t){if(wy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(wy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ac=32,s3=function(e){function t(){return Ttt(this,t),Ntt(this,t,arguments)}return Ott(t,e),Rtt(t,[{key:"renderIcon",value:function(i){var o=this.props.inactiveColor,u=Ac/2,h=Ac/6,p=Ac/3,g=i.inactive?o:i.color;if(i.type==="plainline")return me.createElement("line",{strokeWidth:4,fill:"none",stroke:g,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:u,x2:Ac,y2:u,className:"recharts-legend-icon"});if(i.type==="line")return me.createElement("path",{strokeWidth:4,fill:"none",stroke:g,d:"M0,".concat(u,"h").concat(p,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*p,",").concat(u,`
            H`).concat(Ac,"M").concat(2*p,",").concat(u,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(p,",").concat(u),className:"recharts-legend-icon"});if(i.type==="rect")return me.createElement("path",{stroke:"none",fill:g,d:"M0,".concat(Ac/8,"h").concat(Ac,"v").concat(Ac*3/4,"h").concat(-Ac,"z"),className:"recharts-legend-icon"});if(me.isValidElement(i.legendIcon)){var v=xtt({},i);return delete v.legendIcon,me.cloneElement(i.legendIcon,v)}return me.createElement(a3,{fill:g,cx:u,cy:u,size:Ac,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,o=this.props,u=o.payload,h=o.iconSize,p=o.layout,g=o.formatter,v=o.inactiveColor,b={x:0,y:0,width:Ac,height:Ac},E={display:p==="horizontal"?"inline-block":"block",marginRight:10},T={display:"inline-block",verticalAlign:"middle",marginRight:4};return u.map(function(C,R){var N=C.formatter||g,O=er(H0(H0({"recharts-legend-item":!0},"legend-item-".concat(R),!0),"inactive",C.inactive));if(C.type==="none")return null;var k=zn(C.value)?null:C.value;kd(!zn(C.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var j=C.inactive?v:C.color;return me.createElement("li",cF({className:O,style:E,key:"legend-item-".concat(R)},QN(i.props,C,R)),me.createElement(QU,{width:h,height:h,viewBox:b,style:T},i.renderIcon(C)),me.createElement("span",{className:"recharts-legend-item-text",style:{color:j}},N?N(k,C,R):k))})}},{key:"render",value:function(){var i=this.props,o=i.payload,u=i.layout,h=i.align;if(!o||!o.length)return null;var p={padding:0,margin:0,textAlign:u==="horizontal"?h:"left"};return me.createElement("ul",{className:"recharts-default-legend",style:p},this.renderItems())}}])}(S.PureComponent);H0(s3,"displayName","Legend");H0(s3,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var ktt=xI;function jtt(){this.__data__=new ktt,this.size=0}var Dtt=jtt;function Ltt(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Mtt=Ltt;function Utt(e){return this.__data__.get(e)}var Ftt=Utt;function Vtt(e){return this.__data__.has(e)}var Btt=Vtt,$tt=xI,Wtt=KB,Gtt=qB,Htt=200;function ztt(e,t){var n=this.__data__;if(n instanceof $tt){var i=n.__data__;if(!Wtt||i.length<Htt-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Gtt(i)}return n.set(e,t),this.size=n.size,this}var Ktt=ztt,qtt=xI,Ytt=Dtt,Xtt=Mtt,Jtt=Ftt,Ztt=Btt,Qtt=Ktt;function p_(e){var t=this.__data__=new qtt(e);this.size=t.size}p_.prototype.clear=Ytt;p_.prototype.delete=Xtt;p_.prototype.get=Jtt;p_.prototype.has=Ztt;p_.prototype.set=Qtt;var wme=p_,ent="__lodash_hash_undefined__";function tnt(e){return this.__data__.set(e,ent),this}var nnt=tnt;function rnt(e){return this.__data__.has(e)}var int=rnt,ant=qB,snt=nnt,ont=int;function sA(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new ant;++t<n;)this.add(e[t])}sA.prototype.add=sA.prototype.push=snt;sA.prototype.has=ont;var Sme=sA;function cnt(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var xme=cnt;function lnt(e,t){return e.has(t)}var Tme=lnt,unt=Sme,dnt=xme,hnt=Tme,fnt=1,pnt=2;function mnt(e,t,n,i,o,u){var h=n&fnt,p=e.length,g=t.length;if(p!=g&&!(h&&g>p))return!1;var v=u.get(e),b=u.get(t);if(v&&b)return v==t&&b==e;var E=-1,T=!0,C=n&pnt?new unt:void 0;for(u.set(e,t),u.set(t,e);++E<p;){var R=e[E],N=t[E];if(i)var O=h?i(N,R,E,t,e,u):i(R,N,E,e,t,u);if(O!==void 0){if(O)continue;T=!1;break}if(C){if(!dnt(t,function(k,j){if(!hnt(C,j)&&(R===k||o(R,k,n,i,u)))return C.push(j)})){T=!1;break}}else if(!(R===N||o(R,N,n,i,u))){T=!1;break}}return u.delete(e),u.delete(t),T}var Cme=mnt,gnt=Xu,vnt=gnt.Uint8Array,ynt=vnt;function _nt(e){var t=-1,n=Array(e.size);return e.forEach(function(i,o){n[++t]=[o,i]}),n}var bnt=_nt;function Ent(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}var o3=Ent,kte=eS,jte=ynt,wnt=zB,Snt=Cme,xnt=bnt,Tnt=o3,Cnt=1,Rnt=2,Nnt="[object Boolean]",Ant="[object Date]",Int="[object Error]",Ont="[object Map]",Pnt="[object Number]",knt="[object RegExp]",jnt="[object Set]",Dnt="[object String]",Lnt="[object Symbol]",Mnt="[object ArrayBuffer]",Unt="[object DataView]",Dte=kte?kte.prototype:void 0,OL=Dte?Dte.valueOf:void 0;function Fnt(e,t,n,i,o,u,h){switch(n){case Unt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Mnt:return!(e.byteLength!=t.byteLength||!u(new jte(e),new jte(t)));case Nnt:case Ant:case Pnt:return wnt(+e,+t);case Int:return e.name==t.name&&e.message==t.message;case knt:case Dnt:return e==t+"";case Ont:var p=xnt;case jnt:var g=i&Cnt;if(p||(p=Tnt),e.size!=t.size&&!g)return!1;var v=h.get(e);if(v)return v==t;i|=Rnt,h.set(e,t);var b=Snt(p(e),p(t),i,o,u,h);return h.delete(e),b;case Lnt:if(OL)return OL.call(e)==OL.call(t)}return!1}var Vnt=Fnt;function Bnt(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}var Rme=Bnt,$nt=Rme,Wnt=_o;function Gnt(e,t,n){var i=t(e);return Wnt(e)?i:$nt(i,n(e))}var Hnt=Gnt;function znt(e,t){for(var n=-1,i=e==null?0:e.length,o=0,u=[];++n<i;){var h=e[n];t(h,n,e)&&(u[o++]=h)}return u}var Knt=znt;function qnt(){return[]}var Ynt=qnt,Xnt=Knt,Jnt=Ynt,Znt=Object.prototype,Qnt=Znt.propertyIsEnumerable,Lte=Object.getOwnPropertySymbols,ert=Lte?function(e){return e==null?[]:(e=Object(e),Xnt(Lte(e),function(t){return Qnt.call(e,t)}))}:Jnt,trt=ert;function nrt(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}var rrt=nrt,irt=Jd,art=Zd,srt="[object Arguments]";function ort(e){return art(e)&&irt(e)==srt}var crt=ort,Mte=crt,lrt=Zd,Nme=Object.prototype,urt=Nme.hasOwnProperty,drt=Nme.propertyIsEnumerable,hrt=Mte(function(){return arguments}())?Mte:function(e){return lrt(e)&&urt.call(e,"callee")&&!drt.call(e,"callee")},c3=hrt,oA={exports:{}};function frt(){return!1}var prt=frt;oA.exports;(function(e,t){var n=Xu,i=prt,o=t&&!t.nodeType&&t,u=o&&!0&&e&&!e.nodeType&&e,h=u&&u.exports===o,p=h?n.Buffer:void 0,g=p?p.isBuffer:void 0,v=g||i;e.exports=v})(oA,oA.exports);var Ame=oA.exports,mrt=9007199254740991,grt=/^(?:0|[1-9]\d*)$/;function vrt(e,t){var n=typeof e;return t=t??mrt,!!t&&(n=="number"||n!="symbol"&&grt.test(e))&&e>-1&&e%1==0&&e<t}var l3=vrt,yrt=9007199254740991;function _rt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=yrt}var u3=_rt,brt=Jd,Ert=u3,wrt=Zd,Srt="[object Arguments]",xrt="[object Array]",Trt="[object Boolean]",Crt="[object Date]",Rrt="[object Error]",Nrt="[object Function]",Art="[object Map]",Irt="[object Number]",Ort="[object Object]",Prt="[object RegExp]",krt="[object Set]",jrt="[object String]",Drt="[object WeakMap]",Lrt="[object ArrayBuffer]",Mrt="[object DataView]",Urt="[object Float32Array]",Frt="[object Float64Array]",Vrt="[object Int8Array]",Brt="[object Int16Array]",$rt="[object Int32Array]",Wrt="[object Uint8Array]",Grt="[object Uint8ClampedArray]",Hrt="[object Uint16Array]",zrt="[object Uint32Array]",di={};di[Urt]=di[Frt]=di[Vrt]=di[Brt]=di[$rt]=di[Wrt]=di[Grt]=di[Hrt]=di[zrt]=!0;di[Srt]=di[xrt]=di[Lrt]=di[Trt]=di[Mrt]=di[Crt]=di[Rrt]=di[Nrt]=di[Art]=di[Irt]=di[Ort]=di[Prt]=di[krt]=di[jrt]=di[Drt]=!1;function Krt(e){return wrt(e)&&Ert(e.length)&&!!di[brt(e)]}var qrt=Krt;function Yrt(e){return function(t){return e(t)}}var Ime=Yrt,cA={exports:{}};cA.exports;(function(e,t){var n=Upe,i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,u=o&&o.exports===i,h=u&&n.process,p=function(){try{var g=o&&o.require&&o.require("util").types;return g||h&&h.binding&&h.binding("util")}catch{}}();e.exports=p})(cA,cA.exports);var Xrt=cA.exports,Jrt=qrt,Zrt=Ime,Ute=Xrt,Fte=Ute&&Ute.isTypedArray,Qrt=Fte?Zrt(Fte):Jrt,Ome=Qrt,eit=rrt,tit=c3,nit=_o,rit=Ame,iit=l3,ait=Ome,sit=Object.prototype,oit=sit.hasOwnProperty;function cit(e,t){var n=nit(e),i=!n&&tit(e),o=!n&&!i&&rit(e),u=!n&&!i&&!o&&ait(e),h=n||i||o||u,p=h?eit(e.length,String):[],g=p.length;for(var v in e)(t||oit.call(e,v))&&!(h&&(v=="length"||o&&(v=="offset"||v=="parent")||u&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||iit(v,g)))&&p.push(v);return p}var lit=cit,uit=Object.prototype;function dit(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||uit;return e===n}var hit=dit;function fit(e,t){return function(n){return e(t(n))}}var Pme=fit,pit=Pme,mit=pit(Object.keys,Object),git=mit,vit=hit,yit=git,_it=Object.prototype,bit=_it.hasOwnProperty;function Eit(e){if(!vit(e))return yit(e);var t=[];for(var n in Object(e))bit.call(e,n)&&n!="constructor"&&t.push(n);return t}var wit=Eit,Sit=HB,xit=u3;function Tit(e){return e!=null&&xit(e.length)&&!Sit(e)}var nS=Tit,Cit=lit,Rit=wit,Nit=nS;function Ait(e){return Nit(e)?Cit(e):Rit(e)}var $I=Ait,Iit=Hnt,Oit=trt,Pit=$I;function kit(e){return Iit(e,Pit,Oit)}var jit=kit,Vte=jit,Dit=1,Lit=Object.prototype,Mit=Lit.hasOwnProperty;function Uit(e,t,n,i,o,u){var h=n&Dit,p=Vte(e),g=p.length,v=Vte(t),b=v.length;if(g!=b&&!h)return!1;for(var E=g;E--;){var T=p[E];if(!(h?T in t:Mit.call(t,T)))return!1}var C=u.get(e),R=u.get(t);if(C&&R)return C==t&&R==e;var N=!0;u.set(e,t),u.set(t,e);for(var O=h;++E<g;){T=p[E];var k=e[T],j=t[T];if(i)var P=h?i(j,k,T,t,e,u):i(k,j,T,e,t,u);if(!(P===void 0?k===j||o(k,j,n,i,u):P)){N=!1;break}O||(O=T=="constructor")}if(N&&!O){var M=e.constructor,D=t.constructor;M!=D&&"constructor"in e&&"constructor"in t&&!(typeof M=="function"&&M instanceof M&&typeof D=="function"&&D instanceof D)&&(N=!1)}return u.delete(e),u.delete(t),N}var Fit=Uit,Vit=Pm,Bit=Xu,$it=Vit(Bit,"DataView"),Wit=$it,Git=Pm,Hit=Xu,zit=Git(Hit,"Promise"),Kit=zit,qit=Pm,Yit=Xu,Xit=qit(Yit,"Set"),kme=Xit,Jit=Pm,Zit=Xu,Qit=Jit(Zit,"WeakMap"),eat=Qit,uF=Wit,dF=KB,hF=Kit,fF=kme,pF=eat,jme=Jd,m_=Vpe,Bte="[object Map]",tat="[object Object]",$te="[object Promise]",Wte="[object Set]",Gte="[object WeakMap]",Hte="[object DataView]",nat=m_(uF),rat=m_(dF),iat=m_(hF),aat=m_(fF),sat=m_(pF),Dp=jme;(uF&&Dp(new uF(new ArrayBuffer(1)))!=Hte||dF&&Dp(new dF)!=Bte||hF&&Dp(hF.resolve())!=$te||fF&&Dp(new fF)!=Wte||pF&&Dp(new pF)!=Gte)&&(Dp=function(e){var t=jme(e),n=t==tat?e.constructor:void 0,i=n?m_(n):"";if(i)switch(i){case nat:return Hte;case rat:return Bte;case iat:return $te;case aat:return Wte;case sat:return Gte}return t});var oat=Dp,PL=wme,cat=Cme,lat=Vnt,uat=Fit,zte=oat,Kte=_o,qte=Ame,dat=Ome,hat=1,Yte="[object Arguments]",Xte="[object Array]",XC="[object Object]",fat=Object.prototype,Jte=fat.hasOwnProperty;function pat(e,t,n,i,o,u){var h=Kte(e),p=Kte(t),g=h?Xte:zte(e),v=p?Xte:zte(t);g=g==Yte?XC:g,v=v==Yte?XC:v;var b=g==XC,E=v==XC,T=g==v;if(T&&qte(e)){if(!qte(t))return!1;h=!0,b=!1}if(T&&!b)return u||(u=new PL),h||dat(e)?cat(e,t,n,i,o,u):lat(e,t,g,n,i,o,u);if(!(n&hat)){var C=b&&Jte.call(e,"__wrapped__"),R=E&&Jte.call(t,"__wrapped__");if(C||R){var N=C?e.value():e,O=R?t.value():t;return u||(u=new PL),o(N,O,n,i,u)}}return T?(u||(u=new PL),uat(e,t,n,i,o,u)):!1}var mat=pat,gat=mat,Zte=Zd;function Dme(e,t,n,i,o){return e===t?!0:e==null||t==null||!Zte(e)&&!Zte(t)?e!==e&&t!==t:gat(e,t,n,i,Dme,o)}var d3=Dme,vat=wme,yat=d3,_at=1,bat=2;function Eat(e,t,n,i){var o=n.length,u=o,h=!i;if(e==null)return!u;for(e=Object(e);o--;){var p=n[o];if(h&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++o<u;){p=n[o];var g=p[0],v=e[g],b=p[1];if(h&&p[2]){if(v===void 0&&!(g in e))return!1}else{var E=new vat;if(i)var T=i(v,b,g,e,t,E);if(!(T===void 0?yat(b,v,_at|bat,i,E):T))return!1}}return!0}var wat=Eat,Sat=Mf;function xat(e){return e===e&&!Sat(e)}var Lme=xat,Tat=Lme,Cat=$I;function Rat(e){for(var t=Cat(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,Tat(o)]}return t}var Nat=Rat;function Aat(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var Mme=Aat,Iat=wat,Oat=Nat,Pat=Mme;function kat(e){var t=Oat(e);return t.length==1&&t[0][2]?Pat(t[0][0],t[0][1]):function(n){return n===e||Iat(n,e,t)}}var jat=kat;function Dat(e,t){return e!=null&&t in Object(e)}var Lat=Dat,Mat=Hpe,Uat=c3,Fat=_o,Vat=l3,Bat=u3,$at=CI;function Wat(e,t,n){t=Mat(t,e);for(var i=-1,o=t.length,u=!1;++i<o;){var h=$at(t[i]);if(!(u=e!=null&&n(e,h)))break;e=e[h]}return u||++i!=o?u:(o=e==null?0:e.length,!!o&&Bat(o)&&Vat(h,o)&&(Fat(e)||Uat(e)))}var Gat=Wat,Hat=Lat,zat=Gat;function Kat(e,t){return e!=null&&zat(e,t,Hat)}var qat=Kat,Yat=d3,Xat=zpe,Jat=qat,Zat=GB,Qat=Lme,est=Mme,tst=CI,nst=1,rst=2;function ist(e,t){return Zat(e)&&Qat(t)?est(tst(e),t):function(n){var i=Xat(n,e);return i===void 0&&i===t?Jat(n,e):Yat(t,i,nst|rst)}}var ast=ist;function sst(e){return e}var g_=sst;function ost(e){return function(t){return t==null?void 0:t[e]}}var cst=ost,lst=JB;function ust(e){return function(t){return lst(t,e)}}var dst=ust,hst=cst,fst=dst,pst=GB,mst=CI;function gst(e){return pst(e)?hst(mst(e)):fst(e)}var vst=gst,yst=jat,_st=ast,bst=g_,Est=_o,wst=vst;function Sst(e){return typeof e=="function"?e:e==null?bst:typeof e=="object"?Est(e)?_st(e[0],e[1]):yst(e):wst(e)}var Uf=Sst;function xst(e,t,n,i){for(var o=e.length,u=n+(i?1:-1);i?u--:++u<o;)if(t(e[u],u,e))return u;return-1}var Ume=xst;function Tst(e){return e!==e}var Cst=Tst;function Rst(e,t,n){for(var i=n-1,o=e.length;++i<o;)if(e[i]===t)return i;return-1}var Nst=Rst,Ast=Ume,Ist=Cst,Ost=Nst;function Pst(e,t,n){return t===t?Ost(e,t,n):Ast(e,Ist,n)}var kst=Pst,jst=kst;function Dst(e,t){var n=e==null?0:e.length;return!!n&&jst(e,t,0)>-1}var Lst=Dst;function Mst(e,t,n){for(var i=-1,o=e==null?0:e.length;++i<o;)if(n(t,e[i]))return!0;return!1}var Ust=Mst;function Fst(){}var Vst=Fst,kL=kme,Bst=Vst,$st=o3,Wst=1/0,Gst=kL&&1/$st(new kL([,-0]))[1]==Wst?function(e){return new kL(e)}:Bst,Hst=Gst,zst=Sme,Kst=Lst,qst=Ust,Yst=Tme,Xst=Hst,Jst=o3,Zst=200;function Qst(e,t,n){var i=-1,o=Kst,u=e.length,h=!0,p=[],g=p;if(n)h=!1,o=qst;else if(u>=Zst){var v=t?null:Xst(e);if(v)return Jst(v);h=!1,o=Yst,g=new zst}else g=t?[]:p;e:for(;++i<u;){var b=e[i],E=t?t(b):b;if(b=n||b!==0?b:0,h&&E===E){for(var T=g.length;T--;)if(g[T]===E)continue e;t&&g.push(E),p.push(b)}else o(g,E,n)||(g!==p&&g.push(E),p.push(b))}return p}var eot=Qst,tot=Uf,not=eot;function rot(e,t){return e&&e.length?not(e,tot(t)):[]}var iot=rot;const Qte=jr(iot);function Fme(e,t,n){return t===!0?Qte(e,n):zn(t)?Qte(e,t):e}function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}var aot=["ref"];function ene(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function yd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ene(Object(n),!0).forEach(function(i){WI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ene(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function sot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Bme(i.key),i)}}function oot(e,t,n){return t&&tne(e.prototype,t),n&&tne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function cot(e,t,n){return t=lA(t),lot(e,Vme()?Reflect.construct(t,n||[],lA(e).constructor):t.apply(e,n))}function lot(e,t){if(t&&(Sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uot(e)}function uot(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vme=function(){return!!e})()}function lA(e){return lA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lA(e)}function dot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mF(e,t)}function mF(e,t){return mF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},mF(e,t)}function WI(e,t,n){return t=Bme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bme(e){var t=hot(e,"string");return Sy(t)=="symbol"?t:t+""}function hot(e,t){if(Sy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Sy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function fot(e,t){if(e==null)return{};var n=pot(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function pot(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function mot(e){return e.value}function got(e,t){if(me.isValidElement(e))return me.cloneElement(e,t);if(typeof e=="function")return me.createElement(e,t);t.ref;var n=fot(t,aot);return me.createElement(s3,n)}var nne=1,jd=function(e){function t(){var n;sot(this,t);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return n=cot(this,t,[].concat(o)),WI(n,"lastBoundingBox",{width:-1,height:-1}),n}return dot(t,e),oot(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>nne||Math.abs(o.height-this.lastBoundingBox.height)>nne)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,i&&i(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?yd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var o=this.props,u=o.layout,h=o.align,p=o.verticalAlign,g=o.margin,v=o.chartWidth,b=o.chartHeight,E,T;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(h==="center"&&u==="vertical"){var C=this.getBBoxSnapshot();E={left:((v||0)-C.width)/2}}else E=h==="right"?{right:g&&g.right||0}:{left:g&&g.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(p==="middle"){var R=this.getBBoxSnapshot();T={top:((b||0)-R.height)/2}}else T=p==="bottom"?{bottom:g&&g.bottom||0}:{top:g&&g.top||0};return yd(yd({},E),T)}},{key:"render",value:function(){var i=this,o=this.props,u=o.content,h=o.width,p=o.height,g=o.wrapperStyle,v=o.payloadUniqBy,b=o.payload,E=yd(yd({position:"absolute",width:h||"auto",height:p||"auto"},this.getDefaultPosition(g)),g);return me.createElement("div",{className:"recharts-legend-wrapper",style:E,ref:function(C){i.wrapperNode=C}},got(u,yd(yd({},this.props),{},{payload:Fme(b,v,mot)})))}}],[{key:"getWithHeight",value:function(i,o){var u=yd(yd({},this.defaultProps),i.props),h=u.layout;return h==="vertical"&&xt(i.props.height)?{height:i.props.height}:h==="horizontal"?{width:i.props.width||o}:null}}])}(S.PureComponent);WI(jd,"displayName","Legend");WI(jd,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var rne=eS,vot=c3,yot=_o,ine=rne?rne.isConcatSpreadable:void 0;function _ot(e){return yot(e)||vot(e)||!!(ine&&e&&e[ine])}var bot=_ot,Eot=Rme,wot=bot;function $me(e,t,n,i,o){var u=-1,h=e.length;for(n||(n=wot),o||(o=[]);++u<h;){var p=e[u];t>0&&n(p)?t>1?$me(p,t-1,n,i,o):Eot(o,p):i||(o[o.length]=p)}return o}var Wme=$me;function Sot(e){return function(t,n,i){for(var o=-1,u=Object(t),h=i(t),p=h.length;p--;){var g=h[e?p:++o];if(n(u[g],g,u)===!1)break}return t}}var xot=Sot,Tot=xot,Cot=Tot(),Rot=Cot,Not=Rot,Aot=$I;function Iot(e,t){return e&&Not(e,t,Aot)}var Gme=Iot,Oot=nS;function Pot(e,t){return function(n,i){if(n==null)return n;if(!Oot(n))return e(n,i);for(var o=n.length,u=t?o:-1,h=Object(n);(t?u--:++u<o)&&i(h[u],u,h)!==!1;);return n}}var kot=Pot,jot=Gme,Dot=kot,Lot=Dot(jot),h3=Lot,Mot=h3,Uot=nS;function Fot(e,t){var n=-1,i=Uot(e)?Array(e.length):[];return Mot(e,function(o,u,h){i[++n]=t(o,u,h)}),i}var Hme=Fot;function Vot(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var Bot=Vot,ane=l_;function $ot(e,t){if(e!==t){var n=e!==void 0,i=e===null,o=e===e,u=ane(e),h=t!==void 0,p=t===null,g=t===t,v=ane(t);if(!p&&!v&&!u&&e>t||u&&h&&g&&!p&&!v||i&&h&&g||!n&&g||!o)return 1;if(!i&&!u&&!v&&e<t||v&&n&&o&&!i&&!u||p&&n&&o||!h&&o||!g)return-1}return 0}var Wot=$ot,Got=Wot;function Hot(e,t,n){for(var i=-1,o=e.criteria,u=t.criteria,h=o.length,p=n.length;++i<h;){var g=Got(o[i],u[i]);if(g){if(i>=p)return g;var v=n[i];return g*(v=="desc"?-1:1)}}return e.index-t.index}var zot=Hot,jL=XB,Kot=JB,qot=Uf,Yot=Hme,Xot=Bot,Jot=Ime,Zot=zot,Qot=g_,ect=_o;function tct(e,t,n){t.length?t=jL(t,function(u){return ect(u)?function(h){return Kot(h,u.length===1?u[0]:u)}:u}):t=[Qot];var i=-1;t=jL(t,Jot(qot));var o=Yot(e,function(u,h,p){var g=jL(t,function(v){return v(u)});return{criteria:g,index:++i,value:u}});return Xot(o,function(u,h){return Zot(u,h,n)})}var nct=tct;function rct(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var ict=rct,act=ict,sne=Math.max;function sct(e,t,n){return t=sne(t===void 0?e.length-1:t,0),function(){for(var i=arguments,o=-1,u=sne(i.length-t,0),h=Array(u);++o<u;)h[o]=i[t+o];o=-1;for(var p=Array(t+1);++o<t;)p[o]=i[o];return p[t]=n(h),act(e,this,p)}}var oct=sct;function cct(e){return function(){return e}}var lct=cct,uct=Pm,dct=function(){try{var e=uct(Object,"defineProperty");return e({},"",{}),e}catch{}}(),zme=dct,hct=lct,one=zme,fct=g_,pct=one?function(e,t){return one(e,"toString",{configurable:!0,enumerable:!1,value:hct(t),writable:!0})}:fct,mct=pct,gct=800,vct=16,yct=Date.now;function _ct(e){var t=0,n=0;return function(){var i=yct(),o=vct-(i-n);if(n=i,o>0){if(++t>=gct)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var bct=_ct,Ect=mct,wct=bct,Sct=wct(Ect),xct=Sct,Tct=g_,Cct=oct,Rct=xct;function Nct(e,t){return Rct(Cct(e,t,Tct),e+"")}var Act=Nct,Ict=zB,Oct=nS,Pct=l3,kct=Mf;function jct(e,t,n){if(!kct(n))return!1;var i=typeof t;return(i=="number"?Oct(n)&&Pct(t,n.length):i=="string"&&t in n)?Ict(n[t],e):!1}var GI=jct,Dct=Wme,Lct=nct,Mct=Act,cne=GI,Uct=Mct(function(e,t){if(e==null)return[];var n=t.length;return n>1&&cne(e,t[0],t[1])?t=[]:n>2&&cne(t[0],t[1],t[2])&&(t=[t[0]]),Lct(e,Dct(t,1),[])}),Fct=Uct;const f3=jr(Fct);function z0(e){"@babel/helpers - typeof";return z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z0(e)}function gF(){return gF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},gF.apply(this,arguments)}function Vct(e,t){return Gct(e)||Wct(e,t)||$ct(e,t)||Bct()}function Bct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ct(e,t){if(e){if(typeof e=="string")return lne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lne(e,t)}}function lne(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Wct(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Gct(e){if(Array.isArray(e))return e}function une(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function DL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?une(Object(n),!0).forEach(function(i){Hct(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):une(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Hct(e,t,n){return t=zct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zct(e){var t=Kct(e,"string");return z0(t)=="symbol"?t:t+""}function Kct(e,t){if(z0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(z0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qct(e){return Array.isArray(e)&&Oa(e[0])&&Oa(e[1])?e.join(" ~ "):e}var Yct=function(t){var n=t.separator,i=n===void 0?" : ":n,o=t.contentStyle,u=o===void 0?{}:o,h=t.itemStyle,p=h===void 0?{}:h,g=t.labelStyle,v=g===void 0?{}:g,b=t.payload,E=t.formatter,T=t.itemSorter,C=t.wrapperClassName,R=t.labelClassName,N=t.label,O=t.labelFormatter,k=t.accessibilityLayer,j=k===void 0?!1:k,P=function(){if(b&&b.length){var K={padding:0,margin:0},q=(T?f3(b,T):b).map(function(ee,oe){if(ee.type==="none")return null;var ae=DL({display:"block",paddingTop:4,paddingBottom:4,color:ee.color||"#000"},p),J=ee.formatter||E||qct,re=ee.value,X=ee.name,de=re,we=X;if(J&&de!=null&&we!=null){var ge=J(re,X,ee,oe,b);if(Array.isArray(ge)){var Te=Vct(ge,2);de=Te[0],we=Te[1]}else de=ge}return me.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(oe),style:ae},Oa(we)?me.createElement("span",{className:"recharts-tooltip-item-name"},we):null,Oa(we)?me.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,me.createElement("span",{className:"recharts-tooltip-item-value"},de),me.createElement("span",{className:"recharts-tooltip-item-unit"},ee.unit||""))});return me.createElement("ul",{className:"recharts-tooltip-item-list",style:K},q)}return null},M=DL({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},u),D=DL({margin:0},v),U=!Nr(N),V=U?N:"",z=er("recharts-default-tooltip",C),W=er("recharts-tooltip-label",R);U&&O&&b!==void 0&&b!==null&&(V=O(N,b));var Y=j?{role:"status","aria-live":"assertive"}:{};return me.createElement("div",gF({className:z,style:M},Y),me.createElement("p",{className:W,style:D},me.isValidElement(V)?V:"".concat(V)),P())};function K0(e){"@babel/helpers - typeof";return K0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K0(e)}function JC(e,t,n){return t=Xct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xct(e){var t=Jct(e,"string");return K0(t)=="symbol"?t:t+""}function Jct(e,t){if(K0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(K0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bE="recharts-tooltip-wrapper",Zct={visibility:"hidden"};function Qct(e){var t=e.coordinate,n=e.translateX,i=e.translateY;return er(bE,JC(JC(JC(JC({},"".concat(bE,"-right"),xt(n)&&t&&xt(t.x)&&n>=t.x),"".concat(bE,"-left"),xt(n)&&t&&xt(t.x)&&n<t.x),"".concat(bE,"-bottom"),xt(i)&&t&&xt(t.y)&&i>=t.y),"".concat(bE,"-top"),xt(i)&&t&&xt(t.y)&&i<t.y))}function dne(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.key,o=e.offsetTopLeft,u=e.position,h=e.reverseDirection,p=e.tooltipDimension,g=e.viewBox,v=e.viewBoxDimension;if(u&&xt(u[i]))return u[i];var b=n[i]-p-o,E=n[i]+o;if(t[i])return h[i]?b:E;if(h[i]){var T=b,C=g[i];return T<C?Math.max(E,g[i]):Math.max(b,g[i])}var R=E+p,N=g[i]+v;return R>N?Math.max(b,g[i]):Math.max(E,g[i])}function elt(e){var t=e.translateX,n=e.translateY,i=e.useTranslate3d;return{transform:i?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function tlt(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.offsetTopLeft,o=e.position,u=e.reverseDirection,h=e.tooltipBox,p=e.useTranslate3d,g=e.viewBox,v,b,E;return h.height>0&&h.width>0&&n?(b=dne({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:i,position:o,reverseDirection:u,tooltipDimension:h.width,viewBox:g,viewBoxDimension:g.width}),E=dne({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:i,position:o,reverseDirection:u,tooltipDimension:h.height,viewBox:g,viewBoxDimension:g.height}),v=elt({translateX:b,translateY:E,useTranslate3d:p})):v=Zct,{cssProperties:v,cssClasses:Qct({translateX:b,translateY:E,coordinate:n})}}function xy(e){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function hne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function fne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hne(Object(n),!0).forEach(function(i){yF(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function nlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rlt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,qme(i.key),i)}}function ilt(e,t,n){return t&&rlt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function alt(e,t,n){return t=uA(t),slt(e,Kme()?Reflect.construct(t,n||[],uA(e).constructor):t.apply(e,n))}function slt(e,t){if(t&&(xy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return olt(e)}function olt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kme=function(){return!!e})()}function uA(e){return uA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uA(e)}function clt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vF(e,t)}function vF(e,t){return vF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},vF(e,t)}function yF(e,t,n){return t=qme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qme(e){var t=llt(e,"string");return xy(t)=="symbol"?t:t+""}function llt(e,t){if(xy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(xy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pne=1,ult=function(e){function t(){var n;nlt(this,t);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return n=alt(this,t,[].concat(o)),yF(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),yF(n,"handleKeyDown",function(h){if(h.key==="Escape"){var p,g,v,b;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(p=(g=n.props.coordinate)===null||g===void 0?void 0:g.x)!==null&&p!==void 0?p:0,y:(v=(b=n.props.coordinate)===null||b===void 0?void 0:b.y)!==null&&v!==void 0?v:0}})}}),n}return clt(t,e),ilt(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>pne||Math.abs(i.height-this.state.lastBoundingBox.height)>pne)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,o=this.props,u=o.active,h=o.allowEscapeViewBox,p=o.animationDuration,g=o.animationEasing,v=o.children,b=o.coordinate,E=o.hasPayload,T=o.isAnimationActive,C=o.offset,R=o.position,N=o.reverseDirection,O=o.useTranslate3d,k=o.viewBox,j=o.wrapperStyle,P=tlt({allowEscapeViewBox:h,coordinate:b,offsetTopLeft:C,position:R,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:O,viewBox:k}),M=P.cssClasses,D=P.cssProperties,U=fne(fne({transition:T&&u?"transform ".concat(p,"ms ").concat(g):void 0},D),{},{pointerEvents:"none",visibility:!this.state.dismissed&&u&&E?"visible":"hidden",position:"absolute",top:0,left:0},j);return me.createElement("div",{tabIndex:-1,className:M,style:U,ref:function(z){i.wrapperNode=z}},v)}}])}(S.PureComponent),dlt=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},rS={isSsr:dlt()};function Ty(e){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function mne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function gne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mne(Object(n),!0).forEach(function(i){p3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function hlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function flt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Xme(i.key),i)}}function plt(e,t,n){return t&&flt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mlt(e,t,n){return t=dA(t),glt(e,Yme()?Reflect.construct(t,n||[],dA(e).constructor):t.apply(e,n))}function glt(e,t){if(t&&(Ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vlt(e)}function vlt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yme=function(){return!!e})()}function dA(e){return dA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dA(e)}function ylt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_F(e,t)}function _F(e,t){return _F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},_F(e,t)}function p3(e,t,n){return t=Xme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xme(e){var t=_lt(e,"string");return Ty(t)=="symbol"?t:t+""}function _lt(e,t){if(Ty(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ty(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function blt(e){return e.dataKey}function Elt(e,t){return me.isValidElement(e)?me.cloneElement(e,t):typeof e=="function"?me.createElement(e,t):me.createElement(Yct,t)}var Oc=function(e){function t(){return hlt(this,t),mlt(this,t,arguments)}return ylt(t,e),plt(t,[{key:"render",value:function(){var i=this,o=this.props,u=o.active,h=o.allowEscapeViewBox,p=o.animationDuration,g=o.animationEasing,v=o.content,b=o.coordinate,E=o.filterNull,T=o.isAnimationActive,C=o.offset,R=o.payload,N=o.payloadUniqBy,O=o.position,k=o.reverseDirection,j=o.useTranslate3d,P=o.viewBox,M=o.wrapperStyle,D=R??[];E&&D.length&&(D=Fme(R.filter(function(V){return V.value!=null&&(V.hide!==!0||i.props.includeHidden)}),N,blt));var U=D.length>0;return me.createElement(ult,{allowEscapeViewBox:h,animationDuration:p,animationEasing:g,isAnimationActive:T,active:u,coordinate:b,hasPayload:U,offset:C,position:O,reverseDirection:k,useTranslate3d:j,viewBox:P,wrapperStyle:M},Elt(v,gne(gne({},this.props),{},{payload:D})))}}])}(S.PureComponent);p3(Oc,"displayName","Tooltip");p3(Oc,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!rS.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var wlt=Xu,Slt=function(){return wlt.Date.now()},xlt=Slt,Tlt=/\s/;function Clt(e){for(var t=e.length;t--&&Tlt.test(e.charAt(t)););return t}var Rlt=Clt,Nlt=Rlt,Alt=/^\s+/;function Ilt(e){return e&&e.slice(0,Nlt(e)+1).replace(Alt,"")}var Olt=Ilt,Plt=Olt,vne=Mf,klt=l_,yne=NaN,jlt=/^[-+]0x[0-9a-f]+$/i,Dlt=/^0b[01]+$/i,Llt=/^0o[0-7]+$/i,Mlt=parseInt;function Ult(e){if(typeof e=="number")return e;if(klt(e))return yne;if(vne(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=vne(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Plt(e);var n=Dlt.test(e);return n||Llt.test(e)?Mlt(e.slice(2),n?2:8):jlt.test(e)?yne:+e}var Jme=Ult,Flt=Mf,LL=xlt,_ne=Jme,Vlt="Expected a function",Blt=Math.max,$lt=Math.min;function Wlt(e,t,n){var i,o,u,h,p,g,v=0,b=!1,E=!1,T=!0;if(typeof e!="function")throw new TypeError(Vlt);t=_ne(t)||0,Flt(n)&&(b=!!n.leading,E="maxWait"in n,u=E?Blt(_ne(n.maxWait)||0,t):u,T="trailing"in n?!!n.trailing:T);function C(U){var V=i,z=o;return i=o=void 0,v=U,h=e.apply(z,V),h}function R(U){return v=U,p=setTimeout(k,t),b?C(U):h}function N(U){var V=U-g,z=U-v,W=t-V;return E?$lt(W,u-z):W}function O(U){var V=U-g,z=U-v;return g===void 0||V>=t||V<0||E&&z>=u}function k(){var U=LL();if(O(U))return j(U);p=setTimeout(k,N(U))}function j(U){return p=void 0,T&&i?C(U):(i=o=void 0,h)}function P(){p!==void 0&&clearTimeout(p),v=0,i=g=o=p=void 0}function M(){return p===void 0?h:j(LL())}function D(){var U=LL(),V=O(U);if(i=arguments,o=this,g=U,V){if(p===void 0)return R(g);if(E)return clearTimeout(p),p=setTimeout(k,t),C(g)}return p===void 0&&(p=setTimeout(k,t)),h}return D.cancel=P,D.flush=M,D}var Glt=Wlt,Hlt=Glt,zlt=Mf,Klt="Expected a function";function qlt(e,t,n){var i=!0,o=!0;if(typeof e!="function")throw new TypeError(Klt);return zlt(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),Hlt(e,t,{leading:i,maxWait:t,trailing:o})}var Ylt=qlt;const Zme=jr(Ylt);function q0(e){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}function bne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function ZC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bne(Object(n),!0).forEach(function(i){Xlt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Xlt(e,t,n){return t=Jlt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jlt(e){var t=Zlt(e,"string");return q0(t)=="symbol"?t:t+""}function Zlt(e,t){if(q0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(q0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qlt(e,t){return rut(e)||nut(e,t)||tut(e,t)||eut()}function eut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tut(e,t){if(e){if(typeof e=="string")return Ene(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ene(e,t)}}function Ene(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function nut(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function rut(e){if(Array.isArray(e))return e}var m3=S.forwardRef(function(e,t){var n=e.aspect,i=e.initialDimension,o=i===void 0?{width:-1,height:-1}:i,u=e.width,h=u===void 0?"100%":u,p=e.height,g=p===void 0?"100%":p,v=e.minWidth,b=v===void 0?0:v,E=e.minHeight,T=e.maxHeight,C=e.children,R=e.debounce,N=R===void 0?0:R,O=e.id,k=e.className,j=e.onResize,P=e.style,M=P===void 0?{}:P,D=S.useRef(null),U=S.useRef();U.current=j,S.useImperativeHandle(t,function(){return Object.defineProperty(D.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),D.current},configurable:!0})});var V=S.useState({containerWidth:o.width,containerHeight:o.height}),z=Qlt(V,2),W=z[0],Y=z[1],Q=S.useCallback(function(q,ee){Y(function(oe){var ae=Math.round(q),J=Math.round(ee);return oe.containerWidth===ae&&oe.containerHeight===J?oe:{containerWidth:ae,containerHeight:J}})},[]);S.useEffect(function(){var q=function(X){var de,we=X[0].contentRect,ge=we.width,Te=we.height;Q(ge,Te),(de=U.current)===null||de===void 0||de.call(U,ge,Te)};N>0&&(q=Zme(q,N,{trailing:!0,leading:!1}));var ee=new ResizeObserver(q),oe=D.current.getBoundingClientRect(),ae=oe.width,J=oe.height;return Q(ae,J),ee.observe(D.current),function(){ee.disconnect()}},[Q,N]);var K=S.useMemo(function(){var q=W.containerWidth,ee=W.containerHeight;if(q<0||ee<0)return null;kd(Bp(h)||Bp(g),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,g),kd(!n||n>0,"The aspect(%s) must be greater than zero.",n);var oe=Bp(h)?q:h,ae=Bp(g)?ee:g;n&&n>0&&(oe?ae=oe/n:ae&&(oe=ae*n),T&&ae>T&&(ae=T)),kd(oe>0||ae>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,oe,ae,h,g,b,E,n);var J=!Array.isArray(C)&&Pd(C.type).endsWith("Chart");return me.Children.map(C,function(re){return me.isValidElement(re)?S.cloneElement(re,ZC({width:oe,height:ae},J?{style:ZC({height:"100%",width:"100%",maxHeight:ae,maxWidth:oe},re.props.style)}:{})):re})},[n,C,g,T,E,b,W,h]);return me.createElement("div",{id:O?"".concat(O):void 0,className:er("recharts-responsive-container",k),style:ZC(ZC({},M),{},{width:h,height:g,minWidth:b,minHeight:E,maxHeight:T}),ref:D},K)}),Qme=function(t){return null};Qme.displayName="Cell";function Y0(e){"@babel/helpers - typeof";return Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y0(e)}function wne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function bF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wne(Object(n),!0).forEach(function(i){iut(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function iut(e,t,n){return t=aut(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aut(e){var t=sut(e,"string");return Y0(t)=="symbol"?t:t+""}function sut(e,t){if(Y0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Y0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dv={widthCache:{},cacheCount:0},out=2e3,cut={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Sne="recharts_measurement_span";function lut(e){var t=bF({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var t0=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||rS.isSsr)return{width:0,height:0};var i=lut(n),o=JSON.stringify({text:t,copyStyle:i});if(dv.widthCache[o])return dv.widthCache[o];try{var u=document.getElementById(Sne);u||(u=document.createElement("span"),u.setAttribute("id",Sne),u.setAttribute("aria-hidden","true"),document.body.appendChild(u));var h=bF(bF({},cut),i);Object.assign(u.style,h),u.textContent="".concat(t);var p=u.getBoundingClientRect(),g={width:p.width,height:p.height};return dv.widthCache[o]=g,++dv.cacheCount>out&&(dv.cacheCount=0,dv.widthCache={}),g}catch{return{width:0,height:0}}},uut=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function X0(e){"@babel/helpers - typeof";return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(e)}function hA(e,t){return put(e)||fut(e,t)||hut(e,t)||dut()}function dut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hut(e,t){if(e){if(typeof e=="string")return xne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xne(e,t)}}function xne(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function fut(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function put(e){if(Array.isArray(e))return e}function mut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,vut(i.key),i)}}function gut(e,t,n){return t&&Tne(e.prototype,t),n&&Tne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vut(e){var t=yut(e,"string");return X0(t)=="symbol"?t:t+""}function yut(e,t){if(X0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(X0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Cne=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Rne=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_ut=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,but=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,ege={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Eut=Object.keys(ege),Av="NaN";function wut(e,t){return e*ege[t]}var QC=function(){function e(t,n){mut(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!_ut.test(n)&&(this.num=NaN,this.unit=""),Eut.includes(n)&&(this.num=wut(t,n),this.unit="px")}return gut(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var i,o=(i=but.exec(n))!==null&&i!==void 0?i:[],u=hA(o,3),h=u[1],p=u[2];return new e(parseFloat(h),p??"")}}])}();function tge(e){if(e.includes(Av))return Av;for(var t=e;t.includes("*")||t.includes("/");){var n,i=(n=Cne.exec(t))!==null&&n!==void 0?n:[],o=hA(i,4),u=o[1],h=o[2],p=o[3],g=QC.parse(u??""),v=QC.parse(p??""),b=h==="*"?g.multiply(v):g.divide(v);if(b.isNaN())return Av;t=t.replace(Cne,b.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var E,T=(E=Rne.exec(t))!==null&&E!==void 0?E:[],C=hA(T,4),R=C[1],N=C[2],O=C[3],k=QC.parse(R??""),j=QC.parse(O??""),P=N==="+"?k.add(j):k.subtract(j);if(P.isNaN())return Av;t=t.replace(Rne,P.toString())}return t}var Nne=/\(([^()]*)\)/;function Sut(e){for(var t=e;t.includes("(");){var n=Nne.exec(t),i=hA(n,2),o=i[1];t=t.replace(Nne,tge(o))}return t}function xut(e){var t=e.replace(/\s+/g,"");return t=Sut(t),t=tge(t),t}function Tut(e){try{return xut(e)}catch{return Av}}function ML(e){var t=Tut(e.slice(5,-1));return t===Av?"":t}var Cut=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Rut=["dx","dy","angle","className","breakAll"];function EF(){return EF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},EF.apply(this,arguments)}function Ane(e,t){if(e==null)return{};var n=Nut(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Nut(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Ine(e,t){return Put(e)||Out(e,t)||Iut(e,t)||Aut()}function Aut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iut(e,t){if(e){if(typeof e=="string")return One(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return One(e,t)}}function One(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Out(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Put(e){if(Array.isArray(e))return e}var nge=/[ \f\n\r\t\v\u2028\u2029]+/,rge=function(t){var n=t.children,i=t.breakAll,o=t.style;try{var u=[];Nr(n)||(i?u=n.toString().split(""):u=n.toString().split(nge));var h=u.map(function(g){return{word:g,width:t0(g,o).width}}),p=i?0:t0(" ",o).width;return{wordsWithComputedWidth:h,spaceWidth:p}}catch{return null}},kut=function(t,n,i,o,u){var h=t.maxLines,p=t.children,g=t.style,v=t.breakAll,b=xt(h),E=p,T=function(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return oe.reduce(function(ae,J){var re=J.word,X=J.width,de=ae[ae.length-1];if(de&&(o==null||u||de.width+X+i<Number(o)))de.words.push(re),de.width+=X+i;else{var we={words:[re],width:X};ae.push(we)}return ae},[])},C=T(n),R=function(oe){return oe.reduce(function(ae,J){return ae.width>J.width?ae:J})};if(!b)return C;for(var N="…",O=function(oe){var ae=E.slice(0,oe),J=rge({breakAll:v,style:g,children:ae+N}).wordsWithComputedWidth,re=T(J),X=re.length>h||R(re).width>Number(o);return[X,re]},k=0,j=E.length-1,P=0,M;k<=j&&P<=E.length-1;){var D=Math.floor((k+j)/2),U=D-1,V=O(U),z=Ine(V,2),W=z[0],Y=z[1],Q=O(D),K=Ine(Q,1),q=K[0];if(!W&&!q&&(k=D+1),W&&q&&(j=D-1),!W&&q){M=Y;break}P++}return M||C},Pne=function(t){var n=Nr(t)?[]:t.toString().split(nge);return[{words:n}]},jut=function(t){var n=t.width,i=t.scaleToFit,o=t.children,u=t.style,h=t.breakAll,p=t.maxLines;if((n||i)&&!rS.isSsr){var g,v,b=rge({breakAll:h,children:o,style:u});if(b){var E=b.wordsWithComputedWidth,T=b.spaceWidth;g=E,v=T}else return Pne(o);return kut({breakAll:h,children:o,maxLines:p,style:u},g,v,n,i)}return Pne(o)},kne="#808080",fA=function(t){var n=t.x,i=n===void 0?0:n,o=t.y,u=o===void 0?0:o,h=t.lineHeight,p=h===void 0?"1em":h,g=t.capHeight,v=g===void 0?"0.71em":g,b=t.scaleToFit,E=b===void 0?!1:b,T=t.textAnchor,C=T===void 0?"start":T,R=t.verticalAnchor,N=R===void 0?"end":R,O=t.fill,k=O===void 0?kne:O,j=Ane(t,Cut),P=S.useMemo(function(){return jut({breakAll:j.breakAll,children:j.children,maxLines:j.maxLines,scaleToFit:E,style:j.style,width:j.width})},[j.breakAll,j.children,j.maxLines,E,j.style,j.width]),M=j.dx,D=j.dy,U=j.angle,V=j.className,z=j.breakAll,W=Ane(j,Rut);if(!Oa(i)||!Oa(u))return null;var Y=i+(xt(M)?M:0),Q=u+(xt(D)?D:0),K;switch(N){case"start":K=ML("calc(".concat(v,")"));break;case"middle":K=ML("calc(".concat((P.length-1)/2," * -").concat(p," + (").concat(v," / 2))"));break;default:K=ML("calc(".concat(P.length-1," * -").concat(p,")"));break}var q=[];if(E){var ee=P[0].width,oe=j.width;q.push("scale(".concat((xt(oe)?oe/ee:1)/ee,")"))}return U&&q.push("rotate(".concat(U,", ").concat(Y,", ").concat(Q,")")),q.length&&(W.transform=q.join(" ")),me.createElement("text",EF({},Tr(W,!0),{x:Y,y:Q,className:er("recharts-text",V),textAnchor:C,fill:k.includes("url")?kne:k}),P.map(function(ae,J){var re=ae.words.join(z?"":" ");return me.createElement("tspan",{x:Y,dy:J===0?K:p,key:"".concat(re,"-").concat(J)},re)}))};function vf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Dut(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function g3(e){let t,n,i;e.length!==2?(t=vf,n=(p,g)=>vf(e(p),g),i=(p,g)=>e(p)-g):(t=e===vf||e===Dut?e:Lut,n=e,i=e);function o(p,g,v=0,b=p.length){if(v<b){if(t(g,g)!==0)return b;do{const E=v+b>>>1;n(p[E],g)<0?v=E+1:b=E}while(v<b)}return v}function u(p,g,v=0,b=p.length){if(v<b){if(t(g,g)!==0)return b;do{const E=v+b>>>1;n(p[E],g)<=0?v=E+1:b=E}while(v<b)}return v}function h(p,g,v=0,b=p.length){const E=o(p,g,v,b-1);return E>v&&i(p[E-1],g)>-i(p[E],g)?E-1:E}return{left:o,center:h,right:u}}function Lut(){return 0}function ige(e){return e===null?NaN:+e}function*Mut(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const Uut=g3(vf),iS=Uut.right;g3(ige).center;class jne extends Map{constructor(t,n=But){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,o]of t)this.set(i,o)}get(t){return super.get(Dne(this,t))}has(t){return super.has(Dne(this,t))}set(t,n){return super.set(Fut(this,t),n)}delete(t){return super.delete(Vut(this,t))}}function Dne({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function Fut({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function Vut({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function But(e){return e!==null&&typeof e=="object"?e.valueOf():e}function $ut(e=vf){if(e===vf)return age;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function age(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Wut=Math.sqrt(50),Gut=Math.sqrt(10),Hut=Math.sqrt(2);function pA(e,t,n){const i=(t-e)/Math.max(0,n),o=Math.floor(Math.log10(i)),u=i/Math.pow(10,o),h=u>=Wut?10:u>=Gut?5:u>=Hut?2:1;let p,g,v;return o<0?(v=Math.pow(10,-o)/h,p=Math.round(e*v),g=Math.round(t*v),p/v<e&&++p,g/v>t&&--g,v=-v):(v=Math.pow(10,o)*h,p=Math.round(e/v),g=Math.round(t/v),p*v<e&&++p,g*v>t&&--g),g<p&&.5<=n&&n<2?pA(e,t,n*2):[p,g,v]}function wF(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[o,u,h]=i?pA(t,e,n):pA(e,t,n);if(!(u>=o))return[];const p=u-o+1,g=new Array(p);if(i)if(h<0)for(let v=0;v<p;++v)g[v]=(u-v)/-h;else for(let v=0;v<p;++v)g[v]=(u-v)*h;else if(h<0)for(let v=0;v<p;++v)g[v]=(o+v)/-h;else for(let v=0;v<p;++v)g[v]=(o+v)*h;return g}function SF(e,t,n){return t=+t,e=+e,n=+n,pA(e,t,n)[2]}function xF(e,t,n){t=+t,e=+e,n=+n;const i=t<e,o=i?SF(t,e,n):SF(e,t,n);return(i?-1:1)*(o<0?1/-o:o)}function Lne(e,t){let n;for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function Mne(e,t){let n;for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function sge(e,t,n=0,i=1/0,o){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(o=o===void 0?age:$ut(o);i>n;){if(i-n>600){const g=i-n+1,v=t-n+1,b=Math.log(g),E=.5*Math.exp(2*b/3),T=.5*Math.sqrt(b*E*(g-E)/g)*(v-g/2<0?-1:1),C=Math.max(n,Math.floor(t-v*E/g+T)),R=Math.min(i,Math.floor(t+(g-v)*E/g+T));sge(e,t,C,R,o)}const u=e[t];let h=n,p=i;for(EE(e,n,t),o(e[i],u)>0&&EE(e,n,i);h<p;){for(EE(e,h,p),++h,--p;o(e[h],u)<0;)++h;for(;o(e[p],u)>0;)--p}o(e[n],u)===0?EE(e,n,p):(++p,EE(e,p,i)),p<=t&&(n=p+1),t<=p&&(i=p-1)}return e}function EE(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function zut(e,t,n){if(e=Float64Array.from(Mut(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return Mne(e);if(t>=1)return Lne(e);var i,o=(i-1)*t,u=Math.floor(o),h=Lne(sge(e,u).subarray(0,u+1)),p=Mne(e.subarray(u+1));return h+(p-h)*(o-u)}}function Kut(e,t,n=ige){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,o=(i-1)*t,u=Math.floor(o),h=+n(e[u],u,e),p=+n(e[u+1],u+1,e);return h+(p-h)*(o-u)}}function qut(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var i=-1,o=Math.max(0,Math.ceil((t-e)/n))|0,u=new Array(o);++i<o;)u[i]=e+i*n;return u}function qc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Qd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const TF=Symbol("implicit");function v3(){var e=new jne,t=[],n=[],i=TF;function o(u){let h=e.get(u);if(h===void 0){if(i!==TF)return i;e.set(u,h=t.push(u)-1)}return n[h%n.length]}return o.domain=function(u){if(!arguments.length)return t.slice();t=[],e=new jne;for(const h of u)e.has(h)||e.set(h,t.push(h)-1);return o},o.range=function(u){return arguments.length?(n=Array.from(u),o):n.slice()},o.unknown=function(u){return arguments.length?(i=u,o):i},o.copy=function(){return v3(t,n).unknown(i)},qc.apply(o,arguments),o}function J0(){var e=v3().unknown(void 0),t=e.domain,n=e.range,i=0,o=1,u,h,p=!1,g=0,v=0,b=.5;delete e.unknown;function E(){var T=t().length,C=o<i,R=C?o:i,N=C?i:o;u=(N-R)/Math.max(1,T-g+v*2),p&&(u=Math.floor(u)),R+=(N-R-u*(T-g))*b,h=u*(1-g),p&&(R=Math.round(R),h=Math.round(h));var O=qut(T).map(function(k){return R+u*k});return n(C?O.reverse():O)}return e.domain=function(T){return arguments.length?(t(T),E()):t()},e.range=function(T){return arguments.length?([i,o]=T,i=+i,o=+o,E()):[i,o]},e.rangeRound=function(T){return[i,o]=T,i=+i,o=+o,p=!0,E()},e.bandwidth=function(){return h},e.step=function(){return u},e.round=function(T){return arguments.length?(p=!!T,E()):p},e.padding=function(T){return arguments.length?(g=Math.min(1,v=+T),E()):g},e.paddingInner=function(T){return arguments.length?(g=Math.min(1,T),E()):g},e.paddingOuter=function(T){return arguments.length?(v=+T,E()):v},e.align=function(T){return arguments.length?(b=Math.max(0,Math.min(1,T)),E()):b},e.copy=function(){return J0(t(),[i,o]).round(p).paddingInner(g).paddingOuter(v).align(b)},qc.apply(E(),arguments)}function oge(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return oge(t())},e}function n0(){return oge(J0.apply(null,arguments).paddingInner(1))}function y3(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function cge(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function aS(){}var Z0=.7,mA=1/Z0,Gv="\\s*([+-]?\\d+)\\s*",Q0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yut=/^#([0-9a-f]{3,8})$/,Xut=new RegExp(`^rgb\\(${Gv},${Gv},${Gv}\\)$`),Jut=new RegExp(`^rgb\\(${Mu},${Mu},${Mu}\\)$`),Zut=new RegExp(`^rgba\\(${Gv},${Gv},${Gv},${Q0}\\)$`),Qut=new RegExp(`^rgba\\(${Mu},${Mu},${Mu},${Q0}\\)$`),edt=new RegExp(`^hsl\\(${Q0},${Mu},${Mu}\\)$`),tdt=new RegExp(`^hsla\\(${Q0},${Mu},${Mu},${Q0}\\)$`),Une={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};y3(aS,ew,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Fne,formatHex:Fne,formatHex8:ndt,formatHsl:rdt,formatRgb:Vne,toString:Vne});function Fne(){return this.rgb().formatHex()}function ndt(){return this.rgb().formatHex8()}function rdt(){return lge(this).formatHsl()}function Vne(){return this.rgb().formatRgb()}function ew(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Yut.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Bne(t):n===3?new ho(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?eR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?eR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Xut.exec(e))?new ho(t[1],t[2],t[3],1):(t=Jut.exec(e))?new ho(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Zut.exec(e))?eR(t[1],t[2],t[3],t[4]):(t=Qut.exec(e))?eR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=edt.exec(e))?Gne(t[1],t[2]/100,t[3]/100,1):(t=tdt.exec(e))?Gne(t[1],t[2]/100,t[3]/100,t[4]):Une.hasOwnProperty(e)?Bne(Une[e]):e==="transparent"?new ho(NaN,NaN,NaN,0):null}function Bne(e){return new ho(e>>16&255,e>>8&255,e&255,1)}function eR(e,t,n,i){return i<=0&&(e=t=n=NaN),new ho(e,t,n,i)}function idt(e){return e instanceof aS||(e=ew(e)),e?(e=e.rgb(),new ho(e.r,e.g,e.b,e.opacity)):new ho}function CF(e,t,n,i){return arguments.length===1?idt(e):new ho(e,t,n,i??1)}function ho(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}y3(ho,CF,cge(aS,{brighter(e){return e=e==null?mA:Math.pow(mA,e),new ho(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Z0:Math.pow(Z0,e),new ho(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ho(Qp(this.r),Qp(this.g),Qp(this.b),gA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$ne,formatHex:$ne,formatHex8:adt,formatRgb:Wne,toString:Wne}));function $ne(){return`#${$p(this.r)}${$p(this.g)}${$p(this.b)}`}function adt(){return`#${$p(this.r)}${$p(this.g)}${$p(this.b)}${$p((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wne(){const e=gA(this.opacity);return`${e===1?"rgb(":"rgba("}${Qp(this.r)}, ${Qp(this.g)}, ${Qp(this.b)}${e===1?")":`, ${e})`}`}function gA(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $p(e){return e=Qp(e),(e<16?"0":"")+e.toString(16)}function Gne(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ll(e,t,n,i)}function lge(e){if(e instanceof Ll)return new Ll(e.h,e.s,e.l,e.opacity);if(e instanceof aS||(e=ew(e)),!e)return new Ll;if(e instanceof Ll)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,o=Math.min(t,n,i),u=Math.max(t,n,i),h=NaN,p=u-o,g=(u+o)/2;return p?(t===u?h=(n-i)/p+(n<i)*6:n===u?h=(i-t)/p+2:h=(t-n)/p+4,p/=g<.5?u+o:2-u-o,h*=60):p=g>0&&g<1?0:h,new Ll(h,p,g,e.opacity)}function sdt(e,t,n,i){return arguments.length===1?lge(e):new Ll(e,t,n,i??1)}function Ll(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}y3(Ll,sdt,cge(aS,{brighter(e){return e=e==null?mA:Math.pow(mA,e),new Ll(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Z0:Math.pow(Z0,e),new Ll(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,o=2*n-i;return new ho(UL(e>=240?e-240:e+120,o,i),UL(e,o,i),UL(e<120?e+240:e-120,o,i),this.opacity)},clamp(){return new Ll(Hne(this.h),tR(this.s),tR(this.l),gA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=gA(this.opacity);return`${e===1?"hsl(":"hsla("}${Hne(this.h)}, ${tR(this.s)*100}%, ${tR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hne(e){return e=(e||0)%360,e<0?e+360:e}function tR(e){return Math.max(0,Math.min(1,e||0))}function UL(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const _3=e=>()=>e;function odt(e,t){return function(n){return e+n*t}}function cdt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ldt(e){return(e=+e)==1?uge:function(t,n){return n-t?cdt(t,n,e):_3(isNaN(t)?n:t)}}function uge(e,t){var n=t-e;return n?odt(e,n):_3(isNaN(e)?t:e)}const zne=function e(t){var n=ldt(t);function i(o,u){var h=n((o=CF(o)).r,(u=CF(u)).r),p=n(o.g,u.g),g=n(o.b,u.b),v=uge(o.opacity,u.opacity);return function(b){return o.r=h(b),o.g=p(b),o.b=g(b),o.opacity=v(b),o+""}}return i.gamma=e,i}(1);function udt(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),o;return function(u){for(o=0;o<n;++o)i[o]=e[o]*(1-u)+t[o]*u;return i}}function ddt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hdt(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,o=new Array(i),u=new Array(n),h;for(h=0;h<i;++h)o[h]=v_(e[h],t[h]);for(;h<n;++h)u[h]=t[h];return function(p){for(h=0;h<i;++h)u[h]=o[h](p);return u}}function fdt(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function vA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function pdt(e,t){var n={},i={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=v_(e[o],t[o]):i[o]=t[o];return function(u){for(o in n)i[o]=n[o](u);return i}}var RF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,FL=new RegExp(RF.source,"g");function mdt(e){return function(){return e}}function gdt(e){return function(t){return e(t)+""}}function vdt(e,t){var n=RF.lastIndex=FL.lastIndex=0,i,o,u,h=-1,p=[],g=[];for(e=e+"",t=t+"";(i=RF.exec(e))&&(o=FL.exec(t));)(u=o.index)>n&&(u=t.slice(n,u),p[h]?p[h]+=u:p[++h]=u),(i=i[0])===(o=o[0])?p[h]?p[h]+=o:p[++h]=o:(p[++h]=null,g.push({i:h,x:vA(i,o)})),n=FL.lastIndex;return n<t.length&&(u=t.slice(n),p[h]?p[h]+=u:p[++h]=u),p.length<2?g[0]?gdt(g[0].x):mdt(t):(t=g.length,function(v){for(var b=0,E;b<t;++b)p[(E=g[b]).i]=E.x(v);return p.join("")})}function v_(e,t){var n=typeof t,i;return t==null||n==="boolean"?_3(t):(n==="number"?vA:n==="string"?(i=ew(t))?(t=i,zne):vdt:t instanceof ew?zne:t instanceof Date?fdt:ddt(t)?udt:Array.isArray(t)?hdt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?pdt:vA)(e,t)}function b3(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function ydt(e,t){t===void 0&&(t=e,e=v_);for(var n=0,i=t.length-1,o=t[0],u=new Array(i<0?0:i);n<i;)u[n]=e(o,o=t[++n]);return function(h){var p=Math.max(0,Math.min(i-1,Math.floor(h*=i)));return u[p](h-p)}}function _dt(e){return function(){return e}}function yA(e){return+e}var Kne=[0,1];function Ls(e){return e}function NF(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:_dt(isNaN(t)?NaN:.5)}function bdt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function Edt(e,t,n){var i=e[0],o=e[1],u=t[0],h=t[1];return o<i?(i=NF(o,i),u=n(h,u)):(i=NF(i,o),u=n(u,h)),function(p){return u(i(p))}}function wdt(e,t,n){var i=Math.min(e.length,t.length)-1,o=new Array(i),u=new Array(i),h=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<i;)o[h]=NF(e[h],e[h+1]),u[h]=n(t[h],t[h+1]);return function(p){var g=iS(e,p,1,i)-1;return u[g](o[g](p))}}function sS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function HI(){var e=Kne,t=Kne,n=v_,i,o,u,h=Ls,p,g,v;function b(){var T=Math.min(e.length,t.length);return h!==Ls&&(h=bdt(e[0],e[T-1])),p=T>2?wdt:Edt,g=v=null,E}function E(T){return T==null||isNaN(T=+T)?u:(g||(g=p(e.map(i),t,n)))(i(h(T)))}return E.invert=function(T){return h(o((v||(v=p(t,e.map(i),vA)))(T)))},E.domain=function(T){return arguments.length?(e=Array.from(T,yA),b()):e.slice()},E.range=function(T){return arguments.length?(t=Array.from(T),b()):t.slice()},E.rangeRound=function(T){return t=Array.from(T),n=b3,b()},E.clamp=function(T){return arguments.length?(h=T?!0:Ls,b()):h!==Ls},E.interpolate=function(T){return arguments.length?(n=T,b()):n},E.unknown=function(T){return arguments.length?(u=T,E):u},function(T,C){return i=T,o=C,b()}}function E3(){return HI()(Ls,Ls)}function Sdt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function _A(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Cy(e){return e=_A(Math.abs(e)),e?e[1]:NaN}function xdt(e,t){return function(n,i){for(var o=n.length,u=[],h=0,p=e[0],g=0;o>0&&p>0&&(g+p+1>i&&(p=Math.max(1,i-g)),u.push(n.substring(o-=p,o+p)),!((g+=p+1)>i));)p=e[h=(h+1)%e.length];return u.reverse().join(t)}}function Tdt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Cdt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tw(e){if(!(t=Cdt.exec(e)))throw new Error("invalid format: "+e);var t;return new w3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}tw.prototype=w3.prototype;function w3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}w3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Rdt(e){e:for(var t=e.length,n=1,i=-1,o;n<t;++n)switch(e[n]){case".":i=o=n;break;case"0":i===0&&(i=n),o=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(o+1):e}var dge;function Ndt(e,t){var n=_A(e,t);if(!n)return e+"";var i=n[0],o=n[1],u=o-(dge=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,h=i.length;return u===h?i:u>h?i+new Array(u-h+1).join("0"):u>0?i.slice(0,u)+"."+i.slice(u):"0."+new Array(1-u).join("0")+_A(e,Math.max(0,t+u-1))[0]}function qne(e,t){var n=_A(e,t);if(!n)return e+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")}const Yne={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Sdt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>qne(e*100,t),r:qne,s:Ndt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Xne(e){return e}var Jne=Array.prototype.map,Zne=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Adt(e){var t=e.grouping===void 0||e.thousands===void 0?Xne:xdt(Jne.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",u=e.numerals===void 0?Xne:Tdt(Jne.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",p=e.minus===void 0?"−":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function v(E){E=tw(E);var T=E.fill,C=E.align,R=E.sign,N=E.symbol,O=E.zero,k=E.width,j=E.comma,P=E.precision,M=E.trim,D=E.type;D==="n"?(j=!0,D="g"):Yne[D]||(P===void 0&&(P=12),M=!0,D="g"),(O||T==="0"&&C==="=")&&(O=!0,T="0",C="=");var U=N==="$"?n:N==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",V=N==="$"?i:/[%p]/.test(D)?h:"",z=Yne[D],W=/[defgprs%]/.test(D);P=P===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,P)):Math.max(0,Math.min(20,P));function Y(Q){var K=U,q=V,ee,oe,ae;if(D==="c")q=z(Q)+q,Q="";else{Q=+Q;var J=Q<0||1/Q<0;if(Q=isNaN(Q)?g:z(Math.abs(Q),P),M&&(Q=Rdt(Q)),J&&+Q==0&&R!=="+"&&(J=!1),K=(J?R==="("?R:p:R==="-"||R==="("?"":R)+K,q=(D==="s"?Zne[8+dge/3]:"")+q+(J&&R==="("?")":""),W){for(ee=-1,oe=Q.length;++ee<oe;)if(ae=Q.charCodeAt(ee),48>ae||ae>57){q=(ae===46?o+Q.slice(ee+1):Q.slice(ee))+q,Q=Q.slice(0,ee);break}}}j&&!O&&(Q=t(Q,1/0));var re=K.length+Q.length+q.length,X=re<k?new Array(k-re+1).join(T):"";switch(j&&O&&(Q=t(X+Q,X.length?k-q.length:1/0),X=""),C){case"<":Q=K+Q+q+X;break;case"=":Q=K+X+Q+q;break;case"^":Q=X.slice(0,re=X.length>>1)+K+Q+q+X.slice(re);break;default:Q=X+K+Q+q;break}return u(Q)}return Y.toString=function(){return E+""},Y}function b(E,T){var C=v((E=tw(E),E.type="f",E)),R=Math.max(-8,Math.min(8,Math.floor(Cy(T)/3)))*3,N=Math.pow(10,-R),O=Zne[8+R/3];return function(k){return C(N*k)+O}}return{format:v,formatPrefix:b}}var nR,S3,hge;Idt({thousands:",",grouping:[3],currency:["$",""]});function Idt(e){return nR=Adt(e),S3=nR.format,hge=nR.formatPrefix,nR}function Odt(e){return Math.max(0,-Cy(Math.abs(e)))}function Pdt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cy(t)/3)))*3-Cy(Math.abs(e)))}function kdt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Cy(t)-Cy(e))+1}function fge(e,t,n,i){var o=xF(e,t,n),u;switch(i=tw(i??",f"),i.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(u=Pdt(o,h))&&(i.precision=u),hge(i,h)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(u=kdt(o,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=u-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(u=Odt(o))&&(i.precision=u-(i.type==="%")*2);break}}return S3(i)}function Ff(e){var t=e.domain;return e.ticks=function(n){var i=t();return wF(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var o=t();return fge(o[0],o[o.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),o=0,u=i.length-1,h=i[o],p=i[u],g,v,b=10;for(p<h&&(v=h,h=p,p=v,v=o,o=u,u=v);b-- >0;){if(v=SF(h,p,n),v===g)return i[o]=h,i[u]=p,t(i);if(v>0)h=Math.floor(h/v)*v,p=Math.ceil(p/v)*v;else if(v<0)h=Math.ceil(h*v)/v,p=Math.floor(p*v)/v;else break;g=v}return e},e}function bA(){var e=E3();return e.copy=function(){return sS(e,bA())},qc.apply(e,arguments),Ff(e)}function pge(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,yA),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return pge(e).unknown(t)},e=arguments.length?Array.from(e,yA):[0,1],Ff(n)}function mge(e,t){e=e.slice();var n=0,i=e.length-1,o=e[n],u=e[i],h;return u<o&&(h=n,n=i,i=h,h=o,o=u,u=h),e[n]=t.floor(o),e[i]=t.ceil(u),e}function Qne(e){return Math.log(e)}function ere(e){return Math.exp(e)}function jdt(e){return-Math.log(-e)}function Ddt(e){return-Math.exp(-e)}function Ldt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Mdt(e){return e===10?Ldt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Udt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function tre(e){return(t,n)=>-e(-t,n)}function x3(e){const t=e(Qne,ere),n=t.domain;let i=10,o,u;function h(){return o=Udt(i),u=Mdt(i),n()[0]<0?(o=tre(o),u=tre(u),e(jdt,Ddt)):e(Qne,ere),t}return t.base=function(p){return arguments.length?(i=+p,h()):i},t.domain=function(p){return arguments.length?(n(p),h()):n()},t.ticks=p=>{const g=n();let v=g[0],b=g[g.length-1];const E=b<v;E&&([v,b]=[b,v]);let T=o(v),C=o(b),R,N;const O=p==null?10:+p;let k=[];if(!(i%1)&&C-T<O){if(T=Math.floor(T),C=Math.ceil(C),v>0){for(;T<=C;++T)for(R=1;R<i;++R)if(N=T<0?R/u(-T):R*u(T),!(N<v)){if(N>b)break;k.push(N)}}else for(;T<=C;++T)for(R=i-1;R>=1;--R)if(N=T>0?R/u(-T):R*u(T),!(N<v)){if(N>b)break;k.push(N)}k.length*2<O&&(k=wF(v,b,O))}else k=wF(T,C,Math.min(C-T,O)).map(u);return E?k.reverse():k},t.tickFormat=(p,g)=>{if(p==null&&(p=10),g==null&&(g=i===10?"s":","),typeof g!="function"&&(!(i%1)&&(g=tw(g)).precision==null&&(g.trim=!0),g=S3(g)),p===1/0)return g;const v=Math.max(1,i*p/t.ticks().length);return b=>{let E=b/u(Math.round(o(b)));return E*i<i-.5&&(E*=i),E<=v?g(b):""}},t.nice=()=>n(mge(n(),{floor:p=>u(Math.floor(o(p))),ceil:p=>u(Math.ceil(o(p)))})),t}function gge(){const e=x3(HI()).domain([1,10]);return e.copy=()=>sS(e,gge()).base(e.base()),qc.apply(e,arguments),e}function nre(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function rre(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function T3(e){var t=1,n=e(nre(t),rre(t));return n.constant=function(i){return arguments.length?e(nre(t=+i),rre(t)):t},Ff(n)}function vge(){var e=T3(HI());return e.copy=function(){return sS(e,vge()).constant(e.constant())},qc.apply(e,arguments)}function ire(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Fdt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Vdt(e){return e<0?-e*e:e*e}function C3(e){var t=e(Ls,Ls),n=1;function i(){return n===1?e(Ls,Ls):n===.5?e(Fdt,Vdt):e(ire(n),ire(1/n))}return t.exponent=function(o){return arguments.length?(n=+o,i()):n},Ff(t)}function R3(){var e=C3(HI());return e.copy=function(){return sS(e,R3()).exponent(e.exponent())},qc.apply(e,arguments),e}function Bdt(){return R3.apply(null,arguments).exponent(.5)}function are(e){return Math.sign(e)*e*e}function $dt(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function yge(){var e=E3(),t=[0,1],n=!1,i;function o(u){var h=$dt(e(u));return isNaN(h)?i:n?Math.round(h):h}return o.invert=function(u){return e.invert(are(u))},o.domain=function(u){return arguments.length?(e.domain(u),o):e.domain()},o.range=function(u){return arguments.length?(e.range((t=Array.from(u,yA)).map(are)),o):t.slice()},o.rangeRound=function(u){return o.range(u).round(!0)},o.round=function(u){return arguments.length?(n=!!u,o):n},o.clamp=function(u){return arguments.length?(e.clamp(u),o):e.clamp()},o.unknown=function(u){return arguments.length?(i=u,o):i},o.copy=function(){return yge(e.domain(),t).round(n).clamp(e.clamp()).unknown(i)},qc.apply(o,arguments),Ff(o)}function _ge(){var e=[],t=[],n=[],i;function o(){var h=0,p=Math.max(1,t.length);for(n=new Array(p-1);++h<p;)n[h-1]=Kut(e,h/p);return u}function u(h){return h==null||isNaN(h=+h)?i:t[iS(n,h)]}return u.invertExtent=function(h){var p=t.indexOf(h);return p<0?[NaN,NaN]:[p>0?n[p-1]:e[0],p<n.length?n[p]:e[e.length-1]]},u.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let p of h)p!=null&&!isNaN(p=+p)&&e.push(p);return e.sort(vf),o()},u.range=function(h){return arguments.length?(t=Array.from(h),o()):t.slice()},u.unknown=function(h){return arguments.length?(i=h,u):i},u.quantiles=function(){return n.slice()},u.copy=function(){return _ge().domain(e).range(t).unknown(i)},qc.apply(u,arguments)}function bge(){var e=0,t=1,n=1,i=[.5],o=[0,1],u;function h(g){return g!=null&&g<=g?o[iS(i,g,0,n)]:u}function p(){var g=-1;for(i=new Array(n);++g<n;)i[g]=((g+1)*t-(g-n)*e)/(n+1);return h}return h.domain=function(g){return arguments.length?([e,t]=g,e=+e,t=+t,p()):[e,t]},h.range=function(g){return arguments.length?(n=(o=Array.from(g)).length-1,p()):o.slice()},h.invertExtent=function(g){var v=o.indexOf(g);return v<0?[NaN,NaN]:v<1?[e,i[0]]:v>=n?[i[n-1],t]:[i[v-1],i[v]]},h.unknown=function(g){return arguments.length&&(u=g),h},h.thresholds=function(){return i.slice()},h.copy=function(){return bge().domain([e,t]).range(o).unknown(u)},qc.apply(Ff(h),arguments)}function Ege(){var e=[.5],t=[0,1],n,i=1;function o(u){return u!=null&&u<=u?t[iS(e,u,0,i)]:n}return o.domain=function(u){return arguments.length?(e=Array.from(u),i=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(u){return arguments.length?(t=Array.from(u),i=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(u){var h=t.indexOf(u);return[e[h-1],e[h]]},o.unknown=function(u){return arguments.length?(n=u,o):n},o.copy=function(){return Ege().domain(e).range(t).unknown(n)},qc.apply(o,arguments)}const VL=new Date,BL=new Date;function Pa(e,t,n,i){function o(u){return e(u=arguments.length===0?new Date:new Date(+u)),u}return o.floor=u=>(e(u=new Date(+u)),u),o.ceil=u=>(e(u=new Date(u-1)),t(u,1),e(u),u),o.round=u=>{const h=o(u),p=o.ceil(u);return u-h<p-u?h:p},o.offset=(u,h)=>(t(u=new Date(+u),h==null?1:Math.floor(h)),u),o.range=(u,h,p)=>{const g=[];if(u=o.ceil(u),p=p==null?1:Math.floor(p),!(u<h)||!(p>0))return g;let v;do g.push(v=new Date(+u)),t(u,p),e(u);while(v<u&&u<h);return g},o.filter=u=>Pa(h=>{if(h>=h)for(;e(h),!u(h);)h.setTime(h-1)},(h,p)=>{if(h>=h)if(p<0)for(;++p<=0;)for(;t(h,-1),!u(h););else for(;--p>=0;)for(;t(h,1),!u(h););}),n&&(o.count=(u,h)=>(VL.setTime(+u),BL.setTime(+h),e(VL),e(BL),Math.floor(n(VL,BL))),o.every=u=>(u=Math.floor(u),!isFinite(u)||!(u>0)?null:u>1?o.filter(i?h=>i(h)%u===0:h=>o.count(0,h)%u===0):o)),o}const EA=Pa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);EA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Pa(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):EA);EA.range;const Cd=1e3,Mc=Cd*60,Rd=Mc*60,Hd=Rd*24,N3=Hd*7,sre=Hd*30,$L=Hd*365,Wp=Pa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Cd)},(e,t)=>(t-e)/Cd,e=>e.getUTCSeconds());Wp.range;const A3=Pa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cd)},(e,t)=>{e.setTime(+e+t*Mc)},(e,t)=>(t-e)/Mc,e=>e.getMinutes());A3.range;const I3=Pa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Mc)},(e,t)=>(t-e)/Mc,e=>e.getUTCMinutes());I3.range;const O3=Pa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Cd-e.getMinutes()*Mc)},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getHours());O3.range;const P3=Pa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getUTCHours());P3.range;const oS=Pa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mc)/Hd,e=>e.getDate()-1);oS.range;const zI=Pa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hd,e=>e.getUTCDate()-1);zI.range;const wge=Pa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hd,e=>Math.floor(e/Hd));wge.range;function km(e){return Pa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Mc)/N3)}const KI=km(0),wA=km(1),Wdt=km(2),Gdt=km(3),Ry=km(4),Hdt=km(5),zdt=km(6);KI.range;wA.range;Wdt.range;Gdt.range;Ry.range;Hdt.range;zdt.range;function jm(e){return Pa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/N3)}const qI=jm(0),SA=jm(1),Kdt=jm(2),qdt=jm(3),Ny=jm(4),Ydt=jm(5),Xdt=jm(6);qI.range;SA.range;Kdt.range;qdt.range;Ny.range;Ydt.range;Xdt.range;const k3=Pa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());k3.range;const j3=Pa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());j3.range;const zd=Pa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Pa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});zd.range;const Kd=Pa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Kd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Pa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Kd.range;function Sge(e,t,n,i,o,u){const h=[[Wp,1,Cd],[Wp,5,5*Cd],[Wp,15,15*Cd],[Wp,30,30*Cd],[u,1,Mc],[u,5,5*Mc],[u,15,15*Mc],[u,30,30*Mc],[o,1,Rd],[o,3,3*Rd],[o,6,6*Rd],[o,12,12*Rd],[i,1,Hd],[i,2,2*Hd],[n,1,N3],[t,1,sre],[t,3,3*sre],[e,1,$L]];function p(v,b,E){const T=b<v;T&&([v,b]=[b,v]);const C=E&&typeof E.range=="function"?E:g(v,b,E),R=C?C.range(v,+b+1):[];return T?R.reverse():R}function g(v,b,E){const T=Math.abs(b-v)/E,C=g3(([,,O])=>O).right(h,T);if(C===h.length)return e.every(xF(v/$L,b/$L,E));if(C===0)return EA.every(Math.max(xF(v,b,E),1));const[R,N]=h[T/h[C-1][2]<h[C][2]/T?C-1:C];return R.every(N)}return[p,g]}const[Jdt,Zdt]=Sge(Kd,j3,qI,wge,P3,I3),[Qdt,eht]=Sge(zd,k3,KI,oS,O3,A3);function WL(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function GL(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function wE(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function tht(e){var t=e.dateTime,n=e.date,i=e.time,o=e.periods,u=e.days,h=e.shortDays,p=e.months,g=e.shortMonths,v=SE(o),b=xE(o),E=SE(u),T=xE(u),C=SE(h),R=xE(h),N=SE(p),O=xE(p),k=SE(g),j=xE(g),P={a:J,A:re,b:X,B:de,c:null,d:hre,e:hre,f:xht,g:jht,G:Lht,H:Eht,I:wht,j:Sht,L:xge,m:Tht,M:Cht,p:we,q:ge,Q:mre,s:gre,S:Rht,u:Nht,U:Aht,V:Iht,w:Oht,W:Pht,x:null,X:null,y:kht,Y:Dht,Z:Mht,"%":pre},M={a:Te,A:Pe,b:rt,B:dt,c:null,d:fre,e:fre,f:Bht,g:Jht,G:Qht,H:Uht,I:Fht,j:Vht,L:Cge,m:$ht,M:Wht,p:ze,q:vt,Q:mre,s:gre,S:Ght,u:Hht,U:zht,V:Kht,w:qht,W:Yht,x:null,X:null,y:Xht,Y:Zht,Z:eft,"%":pre},D={a:Y,A:Q,b:K,B:q,c:ee,d:ure,e:ure,f:vht,g:lre,G:cre,H:dre,I:dre,j:fht,L:ght,m:hht,M:pht,p:W,q:dht,Q:_ht,s:bht,S:mht,u:sht,U:oht,V:cht,w:aht,W:lht,x:oe,X:ae,y:lre,Y:cre,Z:uht,"%":yht};P.x=U(n,P),P.X=U(i,P),P.c=U(t,P),M.x=U(n,M),M.X=U(i,M),M.c=U(t,M);function U(Be,ot){return function(De){var je=[],Mt=-1,Ut=0,fn=Be.length,ht,St,At;for(De instanceof Date||(De=new Date(+De));++Mt<fn;)Be.charCodeAt(Mt)===37&&(je.push(Be.slice(Ut,Mt)),(St=ore[ht=Be.charAt(++Mt)])!=null?ht=Be.charAt(++Mt):St=ht==="e"?" ":"0",(At=ot[ht])&&(ht=At(De,St)),je.push(ht),Ut=Mt+1);return je.push(Be.slice(Ut,Mt)),je.join("")}}function V(Be,ot){return function(De){var je=wE(1900,void 0,1),Mt=z(je,Be,De+="",0),Ut,fn;if(Mt!=De.length)return null;if("Q"in je)return new Date(je.Q);if("s"in je)return new Date(je.s*1e3+("L"in je?je.L:0));if(ot&&!("Z"in je)&&(je.Z=0),"p"in je&&(je.H=je.H%12+je.p*12),je.m===void 0&&(je.m="q"in je?je.q:0),"V"in je){if(je.V<1||je.V>53)return null;"w"in je||(je.w=1),"Z"in je?(Ut=GL(wE(je.y,0,1)),fn=Ut.getUTCDay(),Ut=fn>4||fn===0?SA.ceil(Ut):SA(Ut),Ut=zI.offset(Ut,(je.V-1)*7),je.y=Ut.getUTCFullYear(),je.m=Ut.getUTCMonth(),je.d=Ut.getUTCDate()+(je.w+6)%7):(Ut=WL(wE(je.y,0,1)),fn=Ut.getDay(),Ut=fn>4||fn===0?wA.ceil(Ut):wA(Ut),Ut=oS.offset(Ut,(je.V-1)*7),je.y=Ut.getFullYear(),je.m=Ut.getMonth(),je.d=Ut.getDate()+(je.w+6)%7)}else("W"in je||"U"in je)&&("w"in je||(je.w="u"in je?je.u%7:"W"in je?1:0),fn="Z"in je?GL(wE(je.y,0,1)).getUTCDay():WL(wE(je.y,0,1)).getDay(),je.m=0,je.d="W"in je?(je.w+6)%7+je.W*7-(fn+5)%7:je.w+je.U*7-(fn+6)%7);return"Z"in je?(je.H+=je.Z/100|0,je.M+=je.Z%100,GL(je)):WL(je)}}function z(Be,ot,De,je){for(var Mt=0,Ut=ot.length,fn=De.length,ht,St;Mt<Ut;){if(je>=fn)return-1;if(ht=ot.charCodeAt(Mt++),ht===37){if(ht=ot.charAt(Mt++),St=D[ht in ore?ot.charAt(Mt++):ht],!St||(je=St(Be,De,je))<0)return-1}else if(ht!=De.charCodeAt(je++))return-1}return je}function W(Be,ot,De){var je=v.exec(ot.slice(De));return je?(Be.p=b.get(je[0].toLowerCase()),De+je[0].length):-1}function Y(Be,ot,De){var je=C.exec(ot.slice(De));return je?(Be.w=R.get(je[0].toLowerCase()),De+je[0].length):-1}function Q(Be,ot,De){var je=E.exec(ot.slice(De));return je?(Be.w=T.get(je[0].toLowerCase()),De+je[0].length):-1}function K(Be,ot,De){var je=k.exec(ot.slice(De));return je?(Be.m=j.get(je[0].toLowerCase()),De+je[0].length):-1}function q(Be,ot,De){var je=N.exec(ot.slice(De));return je?(Be.m=O.get(je[0].toLowerCase()),De+je[0].length):-1}function ee(Be,ot,De){return z(Be,t,ot,De)}function oe(Be,ot,De){return z(Be,n,ot,De)}function ae(Be,ot,De){return z(Be,i,ot,De)}function J(Be){return h[Be.getDay()]}function re(Be){return u[Be.getDay()]}function X(Be){return g[Be.getMonth()]}function de(Be){return p[Be.getMonth()]}function we(Be){return o[+(Be.getHours()>=12)]}function ge(Be){return 1+~~(Be.getMonth()/3)}function Te(Be){return h[Be.getUTCDay()]}function Pe(Be){return u[Be.getUTCDay()]}function rt(Be){return g[Be.getUTCMonth()]}function dt(Be){return p[Be.getUTCMonth()]}function ze(Be){return o[+(Be.getUTCHours()>=12)]}function vt(Be){return 1+~~(Be.getUTCMonth()/3)}return{format:function(Be){var ot=U(Be+="",P);return ot.toString=function(){return Be},ot},parse:function(Be){var ot=V(Be+="",!1);return ot.toString=function(){return Be},ot},utcFormat:function(Be){var ot=U(Be+="",M);return ot.toString=function(){return Be},ot},utcParse:function(Be){var ot=V(Be+="",!0);return ot.toString=function(){return Be},ot}}}var ore={"-":"",_:" ",0:"0"},za=/^\s*\d+/,nht=/^%/,rht=/[\\^$*+?|[\]().{}]/g;function br(e,t,n){var i=e<0?"-":"",o=(i?-e:e)+"",u=o.length;return i+(u<n?new Array(n-u+1).join(t)+o:o)}function iht(e){return e.replace(rht,"\\$&")}function SE(e){return new RegExp("^(?:"+e.map(iht).join("|")+")","i")}function xE(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function aht(e,t,n){var i=za.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function sht(e,t,n){var i=za.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function oht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function cht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function lht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function cre(e,t,n){var i=za.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function lre(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function uht(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function dht(e,t,n){var i=za.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function hht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function ure(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function fht(e,t,n){var i=za.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function dre(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function pht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function mht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function ght(e,t,n){var i=za.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function vht(e,t,n){var i=za.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function yht(e,t,n){var i=nht.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function _ht(e,t,n){var i=za.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function bht(e,t,n){var i=za.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function hre(e,t){return br(e.getDate(),t,2)}function Eht(e,t){return br(e.getHours(),t,2)}function wht(e,t){return br(e.getHours()%12||12,t,2)}function Sht(e,t){return br(1+oS.count(zd(e),e),t,3)}function xge(e,t){return br(e.getMilliseconds(),t,3)}function xht(e,t){return xge(e,t)+"000"}function Tht(e,t){return br(e.getMonth()+1,t,2)}function Cht(e,t){return br(e.getMinutes(),t,2)}function Rht(e,t){return br(e.getSeconds(),t,2)}function Nht(e){var t=e.getDay();return t===0?7:t}function Aht(e,t){return br(KI.count(zd(e)-1,e),t,2)}function Tge(e){var t=e.getDay();return t>=4||t===0?Ry(e):Ry.ceil(e)}function Iht(e,t){return e=Tge(e),br(Ry.count(zd(e),e)+(zd(e).getDay()===4),t,2)}function Oht(e){return e.getDay()}function Pht(e,t){return br(wA.count(zd(e)-1,e),t,2)}function kht(e,t){return br(e.getFullYear()%100,t,2)}function jht(e,t){return e=Tge(e),br(e.getFullYear()%100,t,2)}function Dht(e,t){return br(e.getFullYear()%1e4,t,4)}function Lht(e,t){var n=e.getDay();return e=n>=4||n===0?Ry(e):Ry.ceil(e),br(e.getFullYear()%1e4,t,4)}function Mht(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+br(t/60|0,"0",2)+br(t%60,"0",2)}function fre(e,t){return br(e.getUTCDate(),t,2)}function Uht(e,t){return br(e.getUTCHours(),t,2)}function Fht(e,t){return br(e.getUTCHours()%12||12,t,2)}function Vht(e,t){return br(1+zI.count(Kd(e),e),t,3)}function Cge(e,t){return br(e.getUTCMilliseconds(),t,3)}function Bht(e,t){return Cge(e,t)+"000"}function $ht(e,t){return br(e.getUTCMonth()+1,t,2)}function Wht(e,t){return br(e.getUTCMinutes(),t,2)}function Ght(e,t){return br(e.getUTCSeconds(),t,2)}function Hht(e){var t=e.getUTCDay();return t===0?7:t}function zht(e,t){return br(qI.count(Kd(e)-1,e),t,2)}function Rge(e){var t=e.getUTCDay();return t>=4||t===0?Ny(e):Ny.ceil(e)}function Kht(e,t){return e=Rge(e),br(Ny.count(Kd(e),e)+(Kd(e).getUTCDay()===4),t,2)}function qht(e){return e.getUTCDay()}function Yht(e,t){return br(SA.count(Kd(e)-1,e),t,2)}function Xht(e,t){return br(e.getUTCFullYear()%100,t,2)}function Jht(e,t){return e=Rge(e),br(e.getUTCFullYear()%100,t,2)}function Zht(e,t){return br(e.getUTCFullYear()%1e4,t,4)}function Qht(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Ny(e):Ny.ceil(e),br(e.getUTCFullYear()%1e4,t,4)}function eft(){return"+0000"}function pre(){return"%"}function mre(e){return+e}function gre(e){return Math.floor(+e/1e3)}var hv,Nge,Age;tft({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function tft(e){return hv=tht(e),Nge=hv.format,hv.parse,Age=hv.utcFormat,hv.utcParse,hv}function nft(e){return new Date(e)}function rft(e){return e instanceof Date?+e:+new Date(+e)}function D3(e,t,n,i,o,u,h,p,g,v){var b=E3(),E=b.invert,T=b.domain,C=v(".%L"),R=v(":%S"),N=v("%I:%M"),O=v("%I %p"),k=v("%a %d"),j=v("%b %d"),P=v("%B"),M=v("%Y");function D(U){return(g(U)<U?C:p(U)<U?R:h(U)<U?N:u(U)<U?O:i(U)<U?o(U)<U?k:j:n(U)<U?P:M)(U)}return b.invert=function(U){return new Date(E(U))},b.domain=function(U){return arguments.length?T(Array.from(U,rft)):T().map(nft)},b.ticks=function(U){var V=T();return e(V[0],V[V.length-1],U??10)},b.tickFormat=function(U,V){return V==null?D:v(V)},b.nice=function(U){var V=T();return(!U||typeof U.range!="function")&&(U=t(V[0],V[V.length-1],U??10)),U?T(mge(V,U)):b},b.copy=function(){return sS(b,D3(e,t,n,i,o,u,h,p,g,v))},b}function ift(){return qc.apply(D3(Qdt,eht,zd,k3,KI,oS,O3,A3,Wp,Nge).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function aft(){return qc.apply(D3(Jdt,Zdt,Kd,j3,qI,zI,P3,I3,Wp,Age).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function YI(){var e=0,t=1,n,i,o,u,h=Ls,p=!1,g;function v(E){return E==null||isNaN(E=+E)?g:h(o===0?.5:(E=(u(E)-n)*o,p?Math.max(0,Math.min(1,E)):E))}v.domain=function(E){return arguments.length?([e,t]=E,n=u(e=+e),i=u(t=+t),o=n===i?0:1/(i-n),v):[e,t]},v.clamp=function(E){return arguments.length?(p=!!E,v):p},v.interpolator=function(E){return arguments.length?(h=E,v):h};function b(E){return function(T){var C,R;return arguments.length?([C,R]=T,h=E(C,R),v):[h(0),h(1)]}}return v.range=b(v_),v.rangeRound=b(b3),v.unknown=function(E){return arguments.length?(g=E,v):g},function(E){return u=E,n=E(e),i=E(t),o=n===i?0:1/(i-n),v}}function Vf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Ige(){var e=Ff(YI()(Ls));return e.copy=function(){return Vf(e,Ige())},Qd.apply(e,arguments)}function Oge(){var e=x3(YI()).domain([1,10]);return e.copy=function(){return Vf(e,Oge()).base(e.base())},Qd.apply(e,arguments)}function Pge(){var e=T3(YI());return e.copy=function(){return Vf(e,Pge()).constant(e.constant())},Qd.apply(e,arguments)}function L3(){var e=C3(YI());return e.copy=function(){return Vf(e,L3()).exponent(e.exponent())},Qd.apply(e,arguments)}function sft(){return L3.apply(null,arguments).exponent(.5)}function kge(){var e=[],t=Ls;function n(i){if(i!=null&&!isNaN(i=+i))return t((iS(e,i,1)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(vf),n},n.interpolator=function(i){return arguments.length?(t=i,n):t},n.range=function(){return e.map((i,o)=>t(o/(e.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(o,u)=>zut(e,u/i))},n.copy=function(){return kge(t).domain(e)},Qd.apply(n,arguments)}function XI(){var e=0,t=.5,n=1,i=1,o,u,h,p,g,v=Ls,b,E=!1,T;function C(N){return isNaN(N=+N)?T:(N=.5+((N=+b(N))-u)*(i*N<i*u?p:g),v(E?Math.max(0,Math.min(1,N)):N))}C.domain=function(N){return arguments.length?([e,t,n]=N,o=b(e=+e),u=b(t=+t),h=b(n=+n),p=o===u?0:.5/(u-o),g=u===h?0:.5/(h-u),i=u<o?-1:1,C):[e,t,n]},C.clamp=function(N){return arguments.length?(E=!!N,C):E},C.interpolator=function(N){return arguments.length?(v=N,C):v};function R(N){return function(O){var k,j,P;return arguments.length?([k,j,P]=O,v=ydt(N,[k,j,P]),C):[v(0),v(.5),v(1)]}}return C.range=R(v_),C.rangeRound=R(b3),C.unknown=function(N){return arguments.length?(T=N,C):T},function(N){return b=N,o=N(e),u=N(t),h=N(n),p=o===u?0:.5/(u-o),g=u===h?0:.5/(h-u),i=u<o?-1:1,C}}function jge(){var e=Ff(XI()(Ls));return e.copy=function(){return Vf(e,jge())},Qd.apply(e,arguments)}function Dge(){var e=x3(XI()).domain([.1,1,10]);return e.copy=function(){return Vf(e,Dge()).base(e.base())},Qd.apply(e,arguments)}function Lge(){var e=T3(XI());return e.copy=function(){return Vf(e,Lge()).constant(e.constant())},Qd.apply(e,arguments)}function M3(){var e=C3(XI());return e.copy=function(){return Vf(e,M3()).exponent(e.exponent())},Qd.apply(e,arguments)}function oft(){return M3.apply(null,arguments).exponent(.5)}const vre=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:J0,scaleDiverging:jge,scaleDivergingLog:Dge,scaleDivergingPow:M3,scaleDivergingSqrt:oft,scaleDivergingSymlog:Lge,scaleIdentity:pge,scaleImplicit:TF,scaleLinear:bA,scaleLog:gge,scaleOrdinal:v3,scalePoint:n0,scalePow:R3,scaleQuantile:_ge,scaleQuantize:bge,scaleRadial:yge,scaleSequential:Ige,scaleSequentialLog:Oge,scaleSequentialPow:L3,scaleSequentialQuantile:kge,scaleSequentialSqrt:sft,scaleSequentialSymlog:Pge,scaleSqrt:Bdt,scaleSymlog:vge,scaleThreshold:Ege,scaleTime:ift,scaleUtc:aft,tickFormat:fge},Symbol.toStringTag,{value:"Module"}));var cft=l_;function lft(e,t,n){for(var i=-1,o=e.length;++i<o;){var u=e[i],h=t(u);if(h!=null&&(p===void 0?h===h&&!cft(h):n(h,p)))var p=h,g=u}return g}var Mge=lft;function uft(e,t){return e>t}var dft=uft,hft=Mge,fft=dft,pft=g_;function mft(e){return e&&e.length?hft(e,pft,fft):void 0}var gft=mft;const JI=jr(gft);function vft(e,t){return e<t}var yft=vft,_ft=Mge,bft=yft,Eft=g_;function wft(e){return e&&e.length?_ft(e,Eft,bft):void 0}var Sft=wft;const ZI=jr(Sft);var xft=XB,Tft=Uf,Cft=Hme,Rft=_o;function Nft(e,t){var n=Rft(e)?xft:Cft;return n(e,Tft(t))}var Aft=Nft,Ift=Wme,Oft=Aft;function Pft(e,t){return Ift(Oft(e,t),1)}var kft=Pft;const jft=jr(kft);var Dft=d3;function Lft(e,t){return Dft(e,t)}var Mft=Lft;const U3=jr(Mft);var y_=1e9,Uft={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},V3,Ei=!0,Wc="[DecimalError] ",em=Wc+"Invalid argument: ",F3=Wc+"Exponent out of range: ",__=Math.floor,Lp=Math.pow,Fft=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$o,Fa=1e7,hi=7,Uge=9007199254740991,xA=__(Uge/hi),Kt={};Kt.absoluteValue=Kt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Kt.comparedTo=Kt.cmp=function(e){var t,n,i,o,u=this;if(e=new u.constructor(e),u.s!==e.s)return u.s||-e.s;if(u.e!==e.e)return u.e>e.e^u.s<0?1:-1;for(i=u.d.length,o=e.d.length,t=0,n=i<o?i:o;t<n;++t)if(u.d[t]!==e.d[t])return u.d[t]>e.d[t]^u.s<0?1:-1;return i===o?0:i>o^u.s<0?1:-1};Kt.decimalPlaces=Kt.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*hi;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Kt.dividedBy=Kt.div=function(e){return Dd(this,new this.constructor(e))};Kt.dividedToIntegerBy=Kt.idiv=function(e){var t=this,n=t.constructor;return Qr(Dd(t,new n(e),0,1),n.precision)};Kt.equals=Kt.eq=function(e){return!this.cmp(e)};Kt.exponent=function(){return ga(this)};Kt.greaterThan=Kt.gt=function(e){return this.cmp(e)>0};Kt.greaterThanOrEqualTo=Kt.gte=function(e){return this.cmp(e)>=0};Kt.isInteger=Kt.isint=function(){return this.e>this.d.length-2};Kt.isNegative=Kt.isneg=function(){return this.s<0};Kt.isPositive=Kt.ispos=function(){return this.s>0};Kt.isZero=function(){return this.s===0};Kt.lessThan=Kt.lt=function(e){return this.cmp(e)<0};Kt.lessThanOrEqualTo=Kt.lte=function(e){return this.cmp(e)<1};Kt.logarithm=Kt.log=function(e){var t,n=this,i=n.constructor,o=i.precision,u=o+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq($o))throw Error(Wc+"NaN");if(n.s<1)throw Error(Wc+(n.s?"NaN":"-Infinity"));return n.eq($o)?new i(0):(Ei=!1,t=Dd(nw(n,u),nw(e,u),u),Ei=!0,Qr(t,o))};Kt.minus=Kt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Bge(t,e):Fge(t,(e.s=-e.s,e))};Kt.modulo=Kt.mod=function(e){var t,n=this,i=n.constructor,o=i.precision;if(e=new i(e),!e.s)throw Error(Wc+"NaN");return n.s?(Ei=!1,t=Dd(n,e,0,1).times(e),Ei=!0,n.minus(t)):Qr(new i(n),o)};Kt.naturalExponential=Kt.exp=function(){return Vge(this)};Kt.naturalLogarithm=Kt.ln=function(){return nw(this)};Kt.negated=Kt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Kt.plus=Kt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Fge(t,e):Bge(t,(e.s=-e.s,e))};Kt.precision=Kt.sd=function(e){var t,n,i,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(em+e);if(t=ga(o)+1,i=o.d.length-1,n=i*hi+1,i=o.d[i],i){for(;i%10==0;i/=10)n--;for(i=o.d[0];i>=10;i/=10)n++}return e&&t>n?t:n};Kt.squareRoot=Kt.sqrt=function(){var e,t,n,i,o,u,h,p=this,g=p.constructor;if(p.s<1){if(!p.s)return new g(0);throw Error(Wc+"NaN")}for(e=ga(p),Ei=!1,o=Math.sqrt(+p),o==0||o==1/0?(t=Iu(p.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=__((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new g(t)):i=new g(o.toString()),n=g.precision,o=h=n+3;;)if(u=i,i=u.plus(Dd(p,u,h+2)).times(.5),Iu(u.d).slice(0,h)===(t=Iu(i.d)).slice(0,h)){if(t=t.slice(h-3,h+1),o==h&&t=="4999"){if(Qr(u,n+1,0),u.times(u).eq(p)){i=u;break}}else if(t!="9999")break;h+=4}return Ei=!0,Qr(i,n)};Kt.times=Kt.mul=function(e){var t,n,i,o,u,h,p,g,v,b=this,E=b.constructor,T=b.d,C=(e=new E(e)).d;if(!b.s||!e.s)return new E(0);for(e.s*=b.s,n=b.e+e.e,g=T.length,v=C.length,g<v&&(u=T,T=C,C=u,h=g,g=v,v=h),u=[],h=g+v,i=h;i--;)u.push(0);for(i=v;--i>=0;){for(t=0,o=g+i;o>i;)p=u[o]+C[i]*T[o-i-1]+t,u[o--]=p%Fa|0,t=p/Fa|0;u[o]=(u[o]+t)%Fa|0}for(;!u[--h];)u.pop();return t?++n:u.shift(),e.d=u,e.e=n,Ei?Qr(e,E.precision):e};Kt.toDecimalPlaces=Kt.todp=function(e,t){var n=this,i=n.constructor;return n=new i(n),e===void 0?n:($u(e,0,y_),t===void 0?t=i.rounding:$u(t,0,8),Qr(n,e+ga(n)+1,t))};Kt.toExponential=function(e,t){var n,i=this,o=i.constructor;return e===void 0?n=vm(i,!0):($u(e,0,y_),t===void 0?t=o.rounding:$u(t,0,8),i=Qr(new o(i),e+1,t),n=vm(i,!0,e+1)),n};Kt.toFixed=function(e,t){var n,i,o=this,u=o.constructor;return e===void 0?vm(o):($u(e,0,y_),t===void 0?t=u.rounding:$u(t,0,8),i=Qr(new u(o),e+ga(o)+1,t),n=vm(i.abs(),!1,e+ga(i)+1),o.isneg()&&!o.isZero()?"-"+n:n)};Kt.toInteger=Kt.toint=function(){var e=this,t=e.constructor;return Qr(new t(e),ga(e)+1,t.rounding)};Kt.toNumber=function(){return+this};Kt.toPower=Kt.pow=function(e){var t,n,i,o,u,h,p=this,g=p.constructor,v=12,b=+(e=new g(e));if(!e.s)return new g($o);if(p=new g(p),!p.s){if(e.s<1)throw Error(Wc+"Infinity");return p}if(p.eq($o))return p;if(i=g.precision,e.eq($o))return Qr(p,i);if(t=e.e,n=e.d.length-1,h=t>=n,u=p.s,h){if((n=b<0?-b:b)<=Uge){for(o=new g($o),t=Math.ceil(i/hi+4),Ei=!1;n%2&&(o=o.times(p),_re(o.d,t)),n=__(n/2),n!==0;)p=p.times(p),_re(p.d,t);return Ei=!0,e.s<0?new g($o).div(o):Qr(o,i)}}else if(u<0)throw Error(Wc+"NaN");return u=u<0&&e.d[Math.max(t,n)]&1?-1:1,p.s=1,Ei=!1,o=e.times(nw(p,i+v)),Ei=!0,o=Vge(o),o.s=u,o};Kt.toPrecision=function(e,t){var n,i,o=this,u=o.constructor;return e===void 0?(n=ga(o),i=vm(o,n<=u.toExpNeg||n>=u.toExpPos)):($u(e,1,y_),t===void 0?t=u.rounding:$u(t,0,8),o=Qr(new u(o),e,t),n=ga(o),i=vm(o,e<=n||n<=u.toExpNeg,e)),i};Kt.toSignificantDigits=Kt.tosd=function(e,t){var n=this,i=n.constructor;return e===void 0?(e=i.precision,t=i.rounding):($u(e,1,y_),t===void 0?t=i.rounding:$u(t,0,8)),Qr(new i(n),e,t)};Kt.toString=Kt.valueOf=Kt.val=Kt.toJSON=Kt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ga(e),n=e.constructor;return vm(e,t<=n.toExpNeg||t>=n.toExpPos)};function Fge(e,t){var n,i,o,u,h,p,g,v,b=e.constructor,E=b.precision;if(!e.s||!t.s)return t.s||(t=new b(e)),Ei?Qr(t,E):t;if(g=e.d,v=t.d,h=e.e,o=t.e,g=g.slice(),u=h-o,u){for(u<0?(i=g,u=-u,p=v.length):(i=v,o=h,p=g.length),h=Math.ceil(E/hi),p=h>p?h+1:p+1,u>p&&(u=p,i.length=1),i.reverse();u--;)i.push(0);i.reverse()}for(p=g.length,u=v.length,p-u<0&&(u=p,i=v,v=g,g=i),n=0;u;)n=(g[--u]=g[u]+v[u]+n)/Fa|0,g[u]%=Fa;for(n&&(g.unshift(n),++o),p=g.length;g[--p]==0;)g.pop();return t.d=g,t.e=o,Ei?Qr(t,E):t}function $u(e,t,n){if(e!==~~e||e<t||e>n)throw Error(em+e)}function Iu(e){var t,n,i,o=e.length-1,u="",h=e[0];if(o>0){for(u+=h,t=1;t<o;t++)i=e[t]+"",n=hi-i.length,n&&(u+=Wh(n)),u+=i;h=e[t],i=h+"",n=hi-i.length,n&&(u+=Wh(n))}else if(h===0)return"0";for(;h%10===0;)h/=10;return u+h}var Dd=function(){function e(i,o){var u,h=0,p=i.length;for(i=i.slice();p--;)u=i[p]*o+h,i[p]=u%Fa|0,h=u/Fa|0;return h&&i.unshift(h),i}function t(i,o,u,h){var p,g;if(u!=h)g=u>h?1:-1;else for(p=g=0;p<u;p++)if(i[p]!=o[p]){g=i[p]>o[p]?1:-1;break}return g}function n(i,o,u){for(var h=0;u--;)i[u]-=h,h=i[u]<o[u]?1:0,i[u]=h*Fa+i[u]-o[u];for(;!i[0]&&i.length>1;)i.shift()}return function(i,o,u,h){var p,g,v,b,E,T,C,R,N,O,k,j,P,M,D,U,V,z,W=i.constructor,Y=i.s==o.s?1:-1,Q=i.d,K=o.d;if(!i.s)return new W(i);if(!o.s)throw Error(Wc+"Division by zero");for(g=i.e-o.e,V=K.length,D=Q.length,C=new W(Y),R=C.d=[],v=0;K[v]==(Q[v]||0);)++v;if(K[v]>(Q[v]||0)&&--g,u==null?j=u=W.precision:h?j=u+(ga(i)-ga(o))+1:j=u,j<0)return new W(0);if(j=j/hi+2|0,v=0,V==1)for(b=0,K=K[0],j++;(v<D||b)&&j--;v++)P=b*Fa+(Q[v]||0),R[v]=P/K|0,b=P%K|0;else{for(b=Fa/(K[0]+1)|0,b>1&&(K=e(K,b),Q=e(Q,b),V=K.length,D=Q.length),M=V,N=Q.slice(0,V),O=N.length;O<V;)N[O++]=0;z=K.slice(),z.unshift(0),U=K[0],K[1]>=Fa/2&&++U;do b=0,p=t(K,N,V,O),p<0?(k=N[0],V!=O&&(k=k*Fa+(N[1]||0)),b=k/U|0,b>1?(b>=Fa&&(b=Fa-1),E=e(K,b),T=E.length,O=N.length,p=t(E,N,T,O),p==1&&(b--,n(E,V<T?z:K,T))):(b==0&&(p=b=1),E=K.slice()),T=E.length,T<O&&E.unshift(0),n(N,E,O),p==-1&&(O=N.length,p=t(K,N,V,O),p<1&&(b++,n(N,V<O?z:K,O))),O=N.length):p===0&&(b++,N=[0]),R[v++]=b,p&&N[0]?N[O++]=Q[M]||0:(N=[Q[M]],O=1);while((M++<D||N[0]!==void 0)&&j--)}return R[0]||R.shift(),C.e=g,Qr(C,h?u+ga(C)+1:u)}}();function Vge(e,t){var n,i,o,u,h,p,g=0,v=0,b=e.constructor,E=b.precision;if(ga(e)>16)throw Error(F3+ga(e));if(!e.s)return new b($o);for(Ei=!1,p=E,h=new b(.03125);e.abs().gte(.1);)e=e.times(h),v+=5;for(i=Math.log(Lp(2,v))/Math.LN10*2+5|0,p+=i,n=o=u=new b($o),b.precision=p;;){if(o=Qr(o.times(e),p),n=n.times(++g),h=u.plus(Dd(o,n,p)),Iu(h.d).slice(0,p)===Iu(u.d).slice(0,p)){for(;v--;)u=Qr(u.times(u),p);return b.precision=E,t==null?(Ei=!0,Qr(u,E)):u}u=h}}function ga(e){for(var t=e.e*hi,n=e.d[0];n>=10;n/=10)t++;return t}function HL(e,t,n){if(t>e.LN10.sd())throw Ei=!0,n&&(e.precision=n),Error(Wc+"LN10 precision limit exceeded");return Qr(new e(e.LN10),t)}function Wh(e){for(var t="";e--;)t+="0";return t}function nw(e,t){var n,i,o,u,h,p,g,v,b,E=1,T=10,C=e,R=C.d,N=C.constructor,O=N.precision;if(C.s<1)throw Error(Wc+(C.s?"NaN":"-Infinity"));if(C.eq($o))return new N(0);if(t==null?(Ei=!1,v=O):v=t,C.eq(10))return t==null&&(Ei=!0),HL(N,v);if(v+=T,N.precision=v,n=Iu(R),i=n.charAt(0),u=ga(C),Math.abs(u)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)C=C.times(e),n=Iu(C.d),i=n.charAt(0),E++;u=ga(C),i>1?(C=new N("0."+n),u++):C=new N(i+"."+n.slice(1))}else return g=HL(N,v+2,O).times(u+""),C=nw(new N(i+"."+n.slice(1)),v-T).plus(g),N.precision=O,t==null?(Ei=!0,Qr(C,O)):C;for(p=h=C=Dd(C.minus($o),C.plus($o),v),b=Qr(C.times(C),v),o=3;;){if(h=Qr(h.times(b),v),g=p.plus(Dd(h,new N(o),v)),Iu(g.d).slice(0,v)===Iu(p.d).slice(0,v))return p=p.times(2),u!==0&&(p=p.plus(HL(N,v+2,O).times(u+""))),p=Dd(p,new N(E),v),N.precision=O,t==null?(Ei=!0,Qr(p,O)):p;p=g,o+=2}}function yre(e,t){var n,i,o;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length),i=0;t.charCodeAt(i)===48;)++i;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(i,o),t){if(o-=i,n=n-i-1,e.e=__(n/hi),e.d=[],i=(n+1)%hi,n<0&&(i+=hi),i<o){for(i&&e.d.push(+t.slice(0,i)),o-=hi;i<o;)e.d.push(+t.slice(i,i+=hi));t=t.slice(i),i=hi-t.length}else i-=o;for(;i--;)t+="0";if(e.d.push(+t),Ei&&(e.e>xA||e.e<-xA))throw Error(F3+n)}else e.s=0,e.e=0,e.d=[0];return e}function Qr(e,t,n){var i,o,u,h,p,g,v,b,E=e.d;for(h=1,u=E[0];u>=10;u/=10)h++;if(i=t-h,i<0)i+=hi,o=t,v=E[b=0];else{if(b=Math.ceil((i+1)/hi),u=E.length,b>=u)return e;for(v=u=E[b],h=1;u>=10;u/=10)h++;i%=hi,o=i-hi+h}if(n!==void 0&&(u=Lp(10,h-o-1),p=v/u%10|0,g=t<0||E[b+1]!==void 0||v%u,g=n<4?(p||g)&&(n==0||n==(e.s<0?3:2)):p>5||p==5&&(n==4||g||n==6&&(i>0?o>0?v/Lp(10,h-o):0:E[b-1])%10&1||n==(e.s<0?8:7))),t<1||!E[0])return g?(u=ga(e),E.length=1,t=t-u-1,E[0]=Lp(10,(hi-t%hi)%hi),e.e=__(-t/hi)||0):(E.length=1,E[0]=e.e=e.s=0),e;if(i==0?(E.length=b,u=1,b--):(E.length=b+1,u=Lp(10,hi-i),E[b]=o>0?(v/Lp(10,h-o)%Lp(10,o)|0)*u:0),g)for(;;)if(b==0){(E[0]+=u)==Fa&&(E[0]=1,++e.e);break}else{if(E[b]+=u,E[b]!=Fa)break;E[b--]=0,u=1}for(i=E.length;E[--i]===0;)E.pop();if(Ei&&(e.e>xA||e.e<-xA))throw Error(F3+ga(e));return e}function Bge(e,t){var n,i,o,u,h,p,g,v,b,E,T=e.constructor,C=T.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new T(e),Ei?Qr(t,C):t;if(g=e.d,E=t.d,i=t.e,v=e.e,g=g.slice(),h=v-i,h){for(b=h<0,b?(n=g,h=-h,p=E.length):(n=E,i=v,p=g.length),o=Math.max(Math.ceil(C/hi),p)+2,h>o&&(h=o,n.length=1),n.reverse(),o=h;o--;)n.push(0);n.reverse()}else{for(o=g.length,p=E.length,b=o<p,b&&(p=o),o=0;o<p;o++)if(g[o]!=E[o]){b=g[o]<E[o];break}h=0}for(b&&(n=g,g=E,E=n,t.s=-t.s),p=g.length,o=E.length-p;o>0;--o)g[p++]=0;for(o=E.length;o>h;){if(g[--o]<E[o]){for(u=o;u&&g[--u]===0;)g[u]=Fa-1;--g[u],g[o]+=Fa}g[o]-=E[o]}for(;g[--p]===0;)g.pop();for(;g[0]===0;g.shift())--i;return g[0]?(t.d=g,t.e=i,Ei?Qr(t,C):t):new T(0)}function vm(e,t,n){var i,o=ga(e),u=Iu(e.d),h=u.length;return t?(n&&(i=n-h)>0?u=u.charAt(0)+"."+u.slice(1)+Wh(i):h>1&&(u=u.charAt(0)+"."+u.slice(1)),u=u+(o<0?"e":"e+")+o):o<0?(u="0."+Wh(-o-1)+u,n&&(i=n-h)>0&&(u+=Wh(i))):o>=h?(u+=Wh(o+1-h),n&&(i=n-o-1)>0&&(u=u+"."+Wh(i))):((i=o+1)<h&&(u=u.slice(0,i)+"."+u.slice(i)),n&&(i=n-h)>0&&(o+1===h&&(u+="."),u+=Wh(i))),e.s<0?"-"+u:u}function _re(e,t){if(e.length>t)return e.length=t,!0}function $ge(e){var t,n,i;function o(u){var h=this;if(!(h instanceof o))return new o(u);if(h.constructor=o,u instanceof o){h.s=u.s,h.e=u.e,h.d=(u=u.d)?u.slice():u;return}if(typeof u=="number"){if(u*0!==0)throw Error(em+u);if(u>0)h.s=1;else if(u<0)u=-u,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(u===~~u&&u<1e7){h.e=0,h.d=[u];return}return yre(h,u.toString())}else if(typeof u!="string")throw Error(em+u);if(u.charCodeAt(0)===45?(u=u.slice(1),h.s=-1):h.s=1,Fft.test(u))yre(h,u);else throw Error(em+u)}if(o.prototype=Kt,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=$ge,o.config=o.set=Vft,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return o.config(e),o}function Vft(e){if(!e||typeof e!="object")throw Error(Wc+"Object expected");var t,n,i,o=["precision",1,y_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((i=e[n=o[t]])!==void 0)if(__(i)===i&&i>=o[t+1]&&i<=o[t+2])this[n]=i;else throw Error(em+n+": "+i);if((i=e[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(em+n+": "+i);return this}var V3=$ge(Uft);$o=new V3(1);const Kr=V3;function Bft(e){return Hft(e)||Gft(e)||Wft(e)||$ft()}function $ft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wft(e,t){if(e){if(typeof e=="string")return AF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AF(e,t)}}function Gft(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Hft(e){if(Array.isArray(e))return AF(e)}function AF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var zft=function(t){return t},Wge={},Gge=function(t){return t===Wge},bre=function(t){return function n(){return arguments.length===0||arguments.length===1&&Gge(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},Kft=function e(t,n){return t===1?n:bre(function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];var h=o.filter(function(p){return p!==Wge}).length;return h>=t?n.apply(void 0,o):e(t-h,bre(function(){for(var p=arguments.length,g=new Array(p),v=0;v<p;v++)g[v]=arguments[v];var b=o.map(function(E){return Gge(E)?g.shift():E});return n.apply(void 0,Bft(b).concat(g))}))})},QI=function(t){return Kft(t.length,t)},IF=function(t,n){for(var i=[],o=t;o<n;++o)i[o-t]=o;return i},qft=QI(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),Yft=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.length)return zft;var o=n.reverse(),u=o[0],h=o.slice(1);return function(){return h.reduce(function(p,g){return g(p)},u.apply(void 0,arguments))}},OF=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Hge=function(t){var n=null,i=null;return function(){for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];return n&&u.every(function(p,g){return p===n[g]})||(n=u,i=t.apply(void 0,u)),i}};function Xft(e){var t;return e===0?t=1:t=Math.floor(new Kr(e).abs().log(10).toNumber())+1,t}function Jft(e,t,n){for(var i=new Kr(e),o=0,u=[];i.lt(t)&&o<1e5;)u.push(i.toNumber()),i=i.add(n),o++;return u}var Zft=QI(function(e,t,n){var i=+e,o=+t;return i+n*(o-i)}),Qft=QI(function(e,t,n){var i=t-+e;return i=i||1/0,(n-e)/i}),ept=QI(function(e,t,n){var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(n-e)/i))});const eO={rangeStep:Jft,getDigitCount:Xft,interpolateNumber:Zft,uninterpolateNumber:Qft,uninterpolateTruncation:ept};function PF(e){return rpt(e)||npt(e)||zge(e)||tpt()}function tpt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function npt(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function rpt(e){if(Array.isArray(e))return kF(e)}function rw(e,t){return spt(e)||apt(e,t)||zge(e,t)||ipt()}function ipt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zge(e,t){if(e){if(typeof e=="string")return kF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kF(e,t)}}function kF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function apt(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],i=!0,o=!1,u=void 0;try{for(var h=e[Symbol.iterator](),p;!(i=(p=h.next()).done)&&(n.push(p.value),!(t&&n.length===t));i=!0);}catch(g){o=!0,u=g}finally{try{!i&&h.return!=null&&h.return()}finally{if(o)throw u}}return n}}function spt(e){if(Array.isArray(e))return e}function Kge(e){var t=rw(e,2),n=t[0],i=t[1],o=n,u=i;return n>i&&(o=i,u=n),[o,u]}function qge(e,t,n){if(e.lte(0))return new Kr(0);var i=eO.getDigitCount(e.toNumber()),o=new Kr(10).pow(i),u=e.div(o),h=i!==1?.05:.1,p=new Kr(Math.ceil(u.div(h).toNumber())).add(n).mul(h),g=p.mul(o);return t?g:new Kr(Math.ceil(g))}function opt(e,t,n){var i=1,o=new Kr(e);if(!o.isint()&&n){var u=Math.abs(e);u<1?(i=new Kr(10).pow(eO.getDigitCount(e)-1),o=new Kr(Math.floor(o.div(i).toNumber())).mul(i)):u>1&&(o=new Kr(Math.floor(e)))}else e===0?o=new Kr(Math.floor((t-1)/2)):n||(o=new Kr(Math.floor(e)));var h=Math.floor((t-1)/2),p=Yft(qft(function(g){return o.add(new Kr(g-h).mul(i)).toNumber()}),IF);return p(0,t)}function Yge(e,t,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Kr(0),tickMin:new Kr(0),tickMax:new Kr(0)};var u=qge(new Kr(t).sub(e).div(n-1),i,o),h;e<=0&&t>=0?h=new Kr(0):(h=new Kr(e).add(t).div(2),h=h.sub(new Kr(h).mod(u)));var p=Math.ceil(h.sub(e).div(u).toNumber()),g=Math.ceil(new Kr(t).sub(h).div(u).toNumber()),v=p+g+1;return v>n?Yge(e,t,n,i,o+1):(v<n&&(g=t>0?g+(n-v):g,p=t>0?p:p+(n-v)),{step:u,tickMin:h.sub(new Kr(p).mul(u)),tickMax:h.add(new Kr(g).mul(u))})}function cpt(e){var t=rw(e,2),n=t[0],i=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(o,2),p=Kge([n,i]),g=rw(p,2),v=g[0],b=g[1];if(v===-1/0||b===1/0){var E=b===1/0?[v].concat(PF(IF(0,o-1).map(function(){return 1/0}))):[].concat(PF(IF(0,o-1).map(function(){return-1/0})),[b]);return n>i?OF(E):E}if(v===b)return opt(v,o,u);var T=Yge(v,b,h,u),C=T.step,R=T.tickMin,N=T.tickMax,O=eO.rangeStep(R,N.add(new Kr(.1).mul(C)),C);return n>i?OF(O):O}function lpt(e,t){var n=rw(e,2),i=n[0],o=n[1],u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Kge([i,o]),p=rw(h,2),g=p[0],v=p[1];if(g===-1/0||v===1/0)return[i,o];if(g===v)return[g];var b=Math.max(t,2),E=qge(new Kr(v).sub(g).div(b-1),u,0),T=[].concat(PF(eO.rangeStep(new Kr(g),new Kr(v).sub(new Kr(.99).mul(E)),E)),[v]);return i>o?OF(T):T}var upt=Hge(cpt),dpt=Hge(lpt),hpt="Invariant failed";function ym(e,t){throw new Error(hpt)}var fpt=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function TA(){return TA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},TA.apply(this,arguments)}function ppt(e,t){return ypt(e)||vpt(e,t)||gpt(e,t)||mpt()}function mpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gpt(e,t){if(e){if(typeof e=="string")return Ere(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ere(e,t)}}function Ere(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function vpt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function ypt(e){if(Array.isArray(e))return e}function _pt(e,t){if(e==null)return{};var n=bpt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function bpt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Ept(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wpt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zge(i.key),i)}}function Spt(e,t,n){return t&&wpt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xpt(e,t,n){return t=CA(t),Tpt(e,Xge()?Reflect.construct(t,n||[],CA(e).constructor):t.apply(e,n))}function Tpt(e,t){if(t&&(Ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cpt(e)}function Cpt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xge=function(){return!!e})()}function CA(e){return CA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CA(e)}function Rpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jF(e,t)}function jF(e,t){return jF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},jF(e,t)}function Jge(e,t,n){return t=Zge(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zge(e){var t=Npt(e,"string");return Ay(t)=="symbol"?t:t+""}function Npt(e,t){if(Ay(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ay(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tO=function(e){function t(){return Ept(this,t),xpt(this,t,arguments)}return Rpt(t,e),Spt(t,[{key:"render",value:function(){var i=this.props,o=i.offset,u=i.layout,h=i.width,p=i.dataKey,g=i.data,v=i.dataPointFormatter,b=i.xAxis,E=i.yAxis,T=_pt(i,fpt),C=Tr(T,!1);this.props.direction==="x"&&b.type!=="number"&&ym();var R=g.map(function(N){var O=v(N,p),k=O.x,j=O.y,P=O.value,M=O.errorVal;if(!M)return null;var D=[],U,V;if(Array.isArray(M)){var z=ppt(M,2);U=z[0],V=z[1]}else U=V=M;if(u==="vertical"){var W=b.scale,Y=j+o,Q=Y+h,K=Y-h,q=W(P-U),ee=W(P+V);D.push({x1:ee,y1:Q,x2:ee,y2:K}),D.push({x1:q,y1:Y,x2:ee,y2:Y}),D.push({x1:q,y1:Q,x2:q,y2:K})}else if(u==="horizontal"){var oe=E.scale,ae=k+o,J=ae-h,re=ae+h,X=oe(P-U),de=oe(P+V);D.push({x1:J,y1:de,x2:re,y2:de}),D.push({x1:ae,y1:X,x2:ae,y2:de}),D.push({x1:J,y1:X,x2:re,y2:X})}return me.createElement($a,TA({className:"recharts-errorBar",key:"bar-".concat(D.map(function(we){return"".concat(we.x1,"-").concat(we.x2,"-").concat(we.y1,"-").concat(we.y2)}))},C),D.map(function(we){return me.createElement("line",TA({},we,{key:"line-".concat(we.x1,"-").concat(we.x2,"-").concat(we.y1,"-").concat(we.y2)}))}))});return me.createElement($a,{className:"recharts-errorBars"},R)}}])}(me.Component);Jge(tO,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Jge(tO,"displayName","ErrorBar");function iw(e){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function wre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ap(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wre(Object(n),!0).forEach(function(i){Apt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Apt(e,t,n){return t=Ipt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ipt(e){var t=Opt(e,"string");return iw(t)=="symbol"?t:t+""}function Opt(e,t){if(iw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(iw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qge=function(t){var n=t.children,i=t.formattedGraphicalItems,o=t.legendWidth,u=t.legendContent,h=Fo(n,jd);if(!h)return null;var p=jd.defaultProps,g=p!==void 0?Ap(Ap({},p),h.props):{},v;return h.props&&h.props.payload?v=h.props&&h.props.payload:u==="children"?v=(i||[]).reduce(function(b,E){var T=E.item,C=E.props,R=C.sectors||C.data||[];return b.concat(R.map(function(N){return{type:h.props.iconType||T.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):v=(i||[]).map(function(b){var E=b.item,T=E.type.defaultProps,C=T!==void 0?Ap(Ap({},T),E.props):{},R=C.dataKey,N=C.name,O=C.legendType,k=C.hide;return{inactive:k,dataKey:R,type:g.iconType||O||"square",color:B3(E),value:N||R,payload:C}}),Ap(Ap(Ap({},g),jd.getWithHeight(h,o)),{},{payload:v,item:h})};function aw(e){"@babel/helpers - typeof";return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function Sre(e){return Dpt(e)||jpt(e)||kpt(e)||Ppt()}function Ppt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kpt(e,t){if(e){if(typeof e=="string")return DF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DF(e,t)}}function jpt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dpt(e){if(Array.isArray(e))return DF(e)}function DF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function xre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Bi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xre(Object(n),!0).forEach(function(i){Hv(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Hv(e,t,n){return t=Lpt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lpt(e){var t=Mpt(e,"string");return aw(t)=="symbol"?t:t+""}function Mpt(e,t){if(aw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(aw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wu(e,t,n){return Nr(e)||Nr(t)?n:Oa(t)?Vc(e,t,n):zn(t)?t(e):n}function r0(e,t,n,i){var o=jft(e,function(p){return Wu(p,t)});if(n==="number"){var u=o.filter(function(p){return xt(p)||parseFloat(p)});return u.length?[ZI(u),JI(u)]:[1/0,-1/0]}var h=i?o.filter(function(p){return!Nr(p)}):o;return h.map(function(p){return Oa(p)||p instanceof Date?p:""})}var Upt=function(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,h=-1,p=(n=i==null?void 0:i.length)!==null&&n!==void 0?n:0;if(p<=1)return 0;if(u&&u.axisType==="angleAxis"&&Math.abs(Math.abs(u.range[1]-u.range[0])-360)<=1e-6)for(var g=u.range,v=0;v<p;v++){var b=v>0?o[v-1].coordinate:o[p-1].coordinate,E=o[v].coordinate,T=v>=p-1?o[0].coordinate:o[v+1].coordinate,C=void 0;if(Ml(E-b)!==Ml(T-E)){var R=[];if(Ml(T-E)===Ml(g[1]-g[0])){C=T;var N=E+g[1]-g[0];R[0]=Math.min(N,(N+b)/2),R[1]=Math.max(N,(N+b)/2)}else{C=b;var O=T+g[1]-g[0];R[0]=Math.min(E,(O+E)/2),R[1]=Math.max(E,(O+E)/2)}var k=[Math.min(E,(C+E)/2),Math.max(E,(C+E)/2)];if(t>k[0]&&t<=k[1]||t>=R[0]&&t<=R[1]){h=o[v].index;break}}else{var j=Math.min(b,T),P=Math.max(b,T);if(t>(j+E)/2&&t<=(P+E)/2){h=o[v].index;break}}}else for(var M=0;M<p;M++)if(M===0&&t<=(i[M].coordinate+i[M+1].coordinate)/2||M>0&&M<p-1&&t>(i[M].coordinate+i[M-1].coordinate)/2&&t<=(i[M].coordinate+i[M+1].coordinate)/2||M===p-1&&t>(i[M].coordinate+i[M-1].coordinate)/2){h=i[M].index;break}return h},B3=function(t){var n,i=t,o=i.type.displayName,u=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Bi(Bi({},t.type.defaultProps),t.props):t.props,h=u.stroke,p=u.fill,g;switch(o){case"Line":g=h;break;case"Area":case"Radar":g=h&&h!=="none"?h:p;break;default:g=p;break}return g},Fpt=function(t){var n=t.barSize,i=t.totalSize,o=t.stackGroups,u=o===void 0?{}:o;if(!u)return{};for(var h={},p=Object.keys(u),g=0,v=p.length;g<v;g++)for(var b=u[p[g]].stackGroups,E=Object.keys(b),T=0,C=E.length;T<C;T++){var R=b[E[T]],N=R.items,O=R.cateAxisId,k=N.filter(function(V){return Pd(V.type).indexOf("Bar")>=0});if(k&&k.length){var j=k[0].type.defaultProps,P=j!==void 0?Bi(Bi({},j),k[0].props):k[0].props,M=P.barSize,D=P[O];h[D]||(h[D]=[]);var U=Nr(M)?n:M;h[D].push({item:k[0],stackList:k.slice(1),barSize:Nr(U)?void 0:gm(U,i,0)})}}return h},Vpt=function(t){var n=t.barGap,i=t.barCategoryGap,o=t.bandSize,u=t.sizeList,h=u===void 0?[]:u,p=t.maxBarSize,g=h.length;if(g<1)return null;var v=gm(n,o,0,!0),b,E=[];if(h[0].barSize===+h[0].barSize){var T=!1,C=o/g,R=h.reduce(function(M,D){return M+D.barSize||0},0);R+=(g-1)*v,R>=o&&(R-=(g-1)*v,v=0),R>=o&&C>0&&(T=!0,C*=.9,R=g*C);var N=(o-R)/2>>0,O={offset:N-v,size:0};b=h.reduce(function(M,D){var U={item:D.item,position:{offset:O.offset+O.size+v,size:T?C:D.barSize}},V=[].concat(Sre(M),[U]);return O=V[V.length-1].position,D.stackList&&D.stackList.length&&D.stackList.forEach(function(z){V.push({item:z,position:O})}),V},E)}else{var k=gm(i,o,0,!0);o-2*k-(g-1)*v<=0&&(v=0);var j=(o-2*k-(g-1)*v)/g;j>1&&(j>>=0);var P=p===+p?Math.min(j,p):j;b=h.reduce(function(M,D,U){var V=[].concat(Sre(M),[{item:D.item,position:{offset:k+(j+v)*U+(j-P)/2,size:P}}]);return D.stackList&&D.stackList.length&&D.stackList.forEach(function(z){V.push({item:z,position:V[V.length-1].position})}),V},E)}return b},Bpt=function(t,n,i,o){var u=i.children,h=i.width,p=i.margin,g=h-(p.left||0)-(p.right||0),v=Qge({children:u,legendWidth:g});if(v){var b=o||{},E=b.width,T=b.height,C=v.align,R=v.verticalAlign,N=v.layout;if((N==="vertical"||N==="horizontal"&&R==="middle")&&C!=="center"&&xt(t[C]))return Bi(Bi({},t),{},Hv({},C,t[C]+(E||0)));if((N==="horizontal"||N==="vertical"&&C==="center")&&R!=="middle"&&xt(t[R]))return Bi(Bi({},t),{},Hv({},R,t[R]+(T||0)))}return t},$pt=function(t,n,i){return Nr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||i==="x"?n==="xAxis":i==="y"?n==="yAxis":!0},eve=function(t,n,i,o,u){var h=n.props.children,p=Bl(h,tO).filter(function(v){return $pt(o,u,v.props.direction)});if(p&&p.length){var g=p.map(function(v){return v.props.dataKey});return t.reduce(function(v,b){var E=Wu(b,i);if(Nr(E))return v;var T=Array.isArray(E)?[ZI(E),JI(E)]:[E,E],C=g.reduce(function(R,N){var O=Wu(b,N,0),k=T[0]-Math.abs(Array.isArray(O)?O[0]:O),j=T[1]+Math.abs(Array.isArray(O)?O[1]:O);return[Math.min(k,R[0]),Math.max(j,R[1])]},[1/0,-1/0]);return[Math.min(C[0],v[0]),Math.max(C[1],v[1])]},[1/0,-1/0])}return null},Wpt=function(t,n,i,o,u){var h=n.map(function(p){return eve(t,p,i,u,o)}).filter(function(p){return!Nr(p)});return h&&h.length?h.reduce(function(p,g){return[Math.min(p[0],g[0]),Math.max(p[1],g[1])]},[1/0,-1/0]):null},tve=function(t,n,i,o,u){var h=n.map(function(g){var v=g.props.dataKey;return i==="number"&&v&&eve(t,g,v,o)||r0(t,v,i,u)});if(i==="number")return h.reduce(function(g,v){return[Math.min(g[0],v[0]),Math.max(g[1],v[1])]},[1/0,-1/0]);var p={};return h.reduce(function(g,v){for(var b=0,E=v.length;b<E;b++)p[v[b]]||(p[v[b]]=!0,g.push(v[b]));return g},[])},nve=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},rve=function(t,n,i,o){if(o)return t.map(function(g){return g.coordinate});var u,h,p=t.map(function(g){return g.coordinate===n&&(u=!0),g.coordinate===i&&(h=!0),g.coordinate});return u||p.push(n),h||p.push(i),p},Nd=function(t,n,i){if(!t)return null;var o=t.scale,u=t.duplicateDomain,h=t.type,p=t.range,g=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,v=(n||i)&&h==="category"&&o.bandwidth?o.bandwidth()/g:0;if(v=t.axisType==="angleAxis"&&(p==null?void 0:p.length)>=2?Ml(p[0]-p[1])*2*v:v,n&&(t.ticks||t.niceTicks)){var b=(t.ticks||t.niceTicks).map(function(E){var T=u?u.indexOf(E):E;return{coordinate:o(T)+v,value:E,offset:v}});return b.filter(function(E){return!tS(E.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(E,T){return{coordinate:o(E)+v,value:E,index:T,offset:v}}):o.ticks&&!i?o.ticks(t.tickCount).map(function(E){return{coordinate:o(E)+v,value:E,offset:v}}):o.domain().map(function(E,T){return{coordinate:o(E)+v,value:u?u[E]:E,index:T,offset:v}})},zL=new WeakMap,rR=function(t,n){if(typeof n!="function")return t;zL.has(t)||zL.set(t,new WeakMap);var i=zL.get(t);if(i.has(n))return i.get(n);var o=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return i.set(n,o),o},Gpt=function(t,n,i){var o=t.scale,u=t.type,h=t.layout,p=t.axisType;if(o==="auto")return h==="radial"&&p==="radiusAxis"?{scale:J0(),realScaleType:"band"}:h==="radial"&&p==="angleAxis"?{scale:bA(),realScaleType:"linear"}:u==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!i)?{scale:n0(),realScaleType:"point"}:u==="category"?{scale:J0(),realScaleType:"band"}:{scale:bA(),realScaleType:"linear"};if(mm(o)){var g="scale".concat(UI(o));return{scale:(vre[g]||n0)(),realScaleType:vre[g]?g:"point"}}return zn(o)?{scale:o}:{scale:n0(),realScaleType:"point"}},Tre=1e-4,Hpt=function(t){var n=t.domain();if(!(!n||n.length<=2)){var i=n.length,o=t.range(),u=Math.min(o[0],o[1])-Tre,h=Math.max(o[0],o[1])+Tre,p=t(n[0]),g=t(n[i-1]);(p<u||p>h||g<u||g>h)&&t.domain([n[0],n[i-1]])}},zpt=function(t,n){if(!t)return null;for(var i=0,o=t.length;i<o;i++)if(t[i].item===n)return t[i].position;return null},Kpt=function(t,n){if(!n||n.length!==2||!xt(n[0])||!xt(n[1]))return t;var i=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]),u=[t[0],t[1]];return(!xt(t[0])||t[0]<i)&&(u[0]=i),(!xt(t[1])||t[1]>o)&&(u[1]=o),u[0]>o&&(u[0]=o),u[1]<i&&(u[1]=i),u},qpt=function(t){var n=t.length;if(!(n<=0))for(var i=0,o=t[0].length;i<o;++i)for(var u=0,h=0,p=0;p<n;++p){var g=tS(t[p][i][1])?t[p][i][0]:t[p][i][1];g>=0?(t[p][i][0]=u,t[p][i][1]=u+g,u=t[p][i][1]):(t[p][i][0]=h,t[p][i][1]=h+g,h=t[p][i][1])}},Ypt=function(t){var n=t.length;if(!(n<=0))for(var i=0,o=t[0].length;i<o;++i)for(var u=0,h=0;h<n;++h){var p=tS(t[h][i][1])?t[h][i][0]:t[h][i][1];p>=0?(t[h][i][0]=u,t[h][i][1]=u+p,u=t[h][i][1]):(t[h][i][0]=0,t[h][i][1]=0)}},Xpt={sign:qpt,expand:dtt,none:Ey,silhouette:htt,wiggle:ftt,positive:Ypt},Jpt=function(t,n,i){var o=n.map(function(p){return p.props.dataKey}),u=Xpt[i],h=utt().keys(o).value(function(p,g){return+Wu(p,g,0)}).order(sF).offset(u);return h(t)},Zpt=function(t,n,i,o,u,h){if(!t)return null;var p=h?n.reverse():n,g={},v=p.reduce(function(E,T){var C,R=(C=T.type)!==null&&C!==void 0&&C.defaultProps?Bi(Bi({},T.type.defaultProps),T.props):T.props,N=R.stackId,O=R.hide;if(O)return E;var k=R[i],j=E[k]||{hasStack:!1,stackGroups:{}};if(Oa(N)){var P=j.stackGroups[N]||{numericAxisId:i,cateAxisId:o,items:[]};P.items.push(T),j.hasStack=!0,j.stackGroups[N]=P}else j.stackGroups[MI("_stackId_")]={numericAxisId:i,cateAxisId:o,items:[T]};return Bi(Bi({},E),{},Hv({},k,j))},g),b={};return Object.keys(v).reduce(function(E,T){var C=v[T];if(C.hasStack){var R={};C.stackGroups=Object.keys(C.stackGroups).reduce(function(N,O){var k=C.stackGroups[O];return Bi(Bi({},N),{},Hv({},O,{numericAxisId:i,cateAxisId:o,items:k.items,stackedData:Jpt(t,k.items,u)}))},R)}return Bi(Bi({},E),{},Hv({},T,C))},b)},Qpt=function(t,n){var i=n.realScaleType,o=n.type,u=n.tickCount,h=n.originalDomain,p=n.allowDecimals,g=i||n.scale;if(g!=="auto"&&g!=="linear")return null;if(u&&o==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var v=t.domain();if(!v.length)return null;var b=upt(v,u,p);return t.domain([ZI(b),JI(b)]),{niceTicks:b}}if(u&&o==="number"){var E=t.domain(),T=dpt(E,u,p);return{niceTicks:T}}return null},Cre=function(t){var n=t.axis,i=t.ticks,o=t.offset,u=t.bandSize,h=t.entry,p=t.index;if(n.type==="category")return i[p]?i[p].coordinate+o:null;var g=Wu(h,n.dataKey,n.domain[p]);return Nr(g)?null:n.scale(g)-u/2+o},emt=function(t){var n=t.numericAxis,i=n.scale.domain();if(n.type==="number"){var o=Math.min(i[0],i[1]),u=Math.max(i[0],i[1]);return o<=0&&u>=0?0:u<0?u:o}return i[0]},tmt=function(t,n){var i,o=(i=t.type)!==null&&i!==void 0&&i.defaultProps?Bi(Bi({},t.type.defaultProps),t.props):t.props,u=o.stackId;if(Oa(u)){var h=n[u];if(h){var p=h.items.indexOf(t);return p>=0?h.stackedData[p]:null}}return null},nmt=function(t){return t.reduce(function(n,i){return[ZI(i.concat([n[0]]).filter(xt)),JI(i.concat([n[1]]).filter(xt))]},[1/0,-1/0])},ive=function(t,n,i){return Object.keys(t).reduce(function(o,u){var h=t[u],p=h.stackedData,g=p.reduce(function(v,b){var E=nmt(b.slice(n,i+1));return[Math.min(v[0],E[0]),Math.max(v[1],E[1])]},[1/0,-1/0]);return[Math.min(g[0],o[0]),Math.max(g[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},Rre=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Nre=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,LF=function(t,n,i){if(zn(t))return t(n,i);if(!Array.isArray(t))return n;var o=[];if(xt(t[0]))o[0]=i?t[0]:Math.min(t[0],n[0]);else if(Rre.test(t[0])){var u=+Rre.exec(t[0])[1];o[0]=n[0]-u}else zn(t[0])?o[0]=t[0](n[0]):o[0]=n[0];if(xt(t[1]))o[1]=i?t[1]:Math.max(t[1],n[1]);else if(Nre.test(t[1])){var h=+Nre.exec(t[1])[1];o[1]=n[1]+h}else zn(t[1])?o[1]=t[1](n[1]):o[1]=n[1];return o},RA=function(t,n,i){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!i||o>0)return o}if(t&&n&&n.length>=2){for(var u=f3(n,function(E){return E.coordinate}),h=1/0,p=1,g=u.length;p<g;p++){var v=u[p],b=u[p-1];h=Math.min((v.coordinate||0)-(b.coordinate||0),h)}return h===1/0?0:h}return i?void 0:0},Are=function(t,n,i){return!t||!t.length||U3(t,Vc(i,"type.defaultProps.domain"))?n:t},ave=function(t,n){var i=t.type.defaultProps?Bi(Bi({},t.type.defaultProps),t.props):t.props,o=i.dataKey,u=i.name,h=i.unit,p=i.formatter,g=i.tooltipType,v=i.chartType,b=i.hide;return Bi(Bi({},Tr(t,!1)),{},{dataKey:o,unit:h,formatter:p,name:u||o,color:B3(t),value:Wu(n,o),type:g,payload:n,chartType:v,hide:b})};function sw(e){"@babel/helpers - typeof";return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sw(e)}function Ire(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ore(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ire(Object(n),!0).forEach(function(i){rmt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ire(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function rmt(e,t,n){return t=imt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function imt(e){var t=amt(e,"string");return sw(t)=="symbol"?t:t+""}function amt(e,t){if(sw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(sw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NA=Math.PI/180,smt=function(t){return t*180/Math.PI},ts=function(t,n,i,o){return{x:t+Math.cos(-NA*o)*i,y:n+Math.sin(-NA*o)*i}},omt=function(t,n){var i=t.x,o=t.y,u=n.x,h=n.y;return Math.sqrt(Math.pow(i-u,2)+Math.pow(o-h,2))},cmt=function(t,n){var i=t.x,o=t.y,u=n.cx,h=n.cy,p=omt({x:i,y:o},{x:u,y:h});if(p<=0)return{radius:p};var g=(i-u)/p,v=Math.acos(g);return o>h&&(v=2*Math.PI-v),{radius:p,angle:smt(v),angleInRadian:v}},lmt=function(t){var n=t.startAngle,i=t.endAngle,o=Math.floor(n/360),u=Math.floor(i/360),h=Math.min(o,u);return{startAngle:n-h*360,endAngle:i-h*360}},umt=function(t,n){var i=n.startAngle,o=n.endAngle,u=Math.floor(i/360),h=Math.floor(o/360),p=Math.min(u,h);return t+p*360},Pre=function(t,n){var i=t.x,o=t.y,u=cmt({x:i,y:o},n),h=u.radius,p=u.angle,g=n.innerRadius,v=n.outerRadius;if(h<g||h>v)return!1;if(h===0)return!0;var b=lmt(n),E=b.startAngle,T=b.endAngle,C=p,R;if(E<=T){for(;C>T;)C-=360;for(;C<E;)C+=360;R=C>=E&&C<=T}else{for(;C>E;)C-=360;for(;C<T;)C+=360;R=C>=T&&C<=E}return R?Ore(Ore({},n),{},{radius:h,angle:umt(C,n)}):null};function ow(e){"@babel/helpers - typeof";return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(e)}var dmt=["offset"];function hmt(e){return gmt(e)||mmt(e)||pmt(e)||fmt()}function fmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pmt(e,t){if(e){if(typeof e=="string")return MF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MF(e,t)}}function mmt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gmt(e){if(Array.isArray(e))return MF(e)}function MF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function vmt(e,t){if(e==null)return{};var n=ymt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function ymt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function kre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ca(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kre(Object(n),!0).forEach(function(i){_mt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function _mt(e,t,n){return t=bmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bmt(e){var t=Emt(e,"string");return ow(t)=="symbol"?t:t+""}function Emt(e,t){if(ow(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(ow(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cw(){return cw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cw.apply(this,arguments)}var wmt=function(t){var n=t.value,i=t.formatter,o=Nr(t.children)?n:t.children;return zn(i)?i(o):o},Smt=function(t,n){var i=Ml(n-t),o=Math.min(Math.abs(n-t),360);return i*o},xmt=function(t,n,i){var o=t.position,u=t.viewBox,h=t.offset,p=t.className,g=u,v=g.cx,b=g.cy,E=g.innerRadius,T=g.outerRadius,C=g.startAngle,R=g.endAngle,N=g.clockWise,O=(E+T)/2,k=Smt(C,R),j=k>=0?1:-1,P,M;o==="insideStart"?(P=C+j*h,M=N):o==="insideEnd"?(P=R-j*h,M=!N):o==="end"&&(P=R+j*h,M=N),M=k<=0?M:!M;var D=ts(v,b,O,P),U=ts(v,b,O,P+(M?1:-1)*359),V="M".concat(D.x,",").concat(D.y,`
    A`).concat(O,",").concat(O,",0,1,").concat(M?0:1,`,
    `).concat(U.x,",").concat(U.y),z=Nr(t.id)?MI("recharts-radial-line-"):t.id;return me.createElement("text",cw({},i,{dominantBaseline:"central",className:er("recharts-radial-bar-label",p)}),me.createElement("defs",null,me.createElement("path",{id:z,d:V})),me.createElement("textPath",{xlinkHref:"#".concat(z)},n))},Tmt=function(t){var n=t.viewBox,i=t.offset,o=t.position,u=n,h=u.cx,p=u.cy,g=u.innerRadius,v=u.outerRadius,b=u.startAngle,E=u.endAngle,T=(b+E)/2;if(o==="outside"){var C=ts(h,p,v+i,T),R=C.x,N=C.y;return{x:R,y:N,textAnchor:R>=h?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:h,y:p,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:h,y:p,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:h,y:p,textAnchor:"middle",verticalAnchor:"end"};var O=(g+v)/2,k=ts(h,p,O,T),j=k.x,P=k.y;return{x:j,y:P,textAnchor:"middle",verticalAnchor:"middle"}},Cmt=function(t){var n=t.viewBox,i=t.parentViewBox,o=t.offset,u=t.position,h=n,p=h.x,g=h.y,v=h.width,b=h.height,E=b>=0?1:-1,T=E*o,C=E>0?"end":"start",R=E>0?"start":"end",N=v>=0?1:-1,O=N*o,k=N>0?"end":"start",j=N>0?"start":"end";if(u==="top"){var P={x:p+v/2,y:g-E*o,textAnchor:"middle",verticalAnchor:C};return Ca(Ca({},P),i?{height:Math.max(g-i.y,0),width:v}:{})}if(u==="bottom"){var M={x:p+v/2,y:g+b+T,textAnchor:"middle",verticalAnchor:R};return Ca(Ca({},M),i?{height:Math.max(i.y+i.height-(g+b),0),width:v}:{})}if(u==="left"){var D={x:p-O,y:g+b/2,textAnchor:k,verticalAnchor:"middle"};return Ca(Ca({},D),i?{width:Math.max(D.x-i.x,0),height:b}:{})}if(u==="right"){var U={x:p+v+O,y:g+b/2,textAnchor:j,verticalAnchor:"middle"};return Ca(Ca({},U),i?{width:Math.max(i.x+i.width-U.x,0),height:b}:{})}var V=i?{width:v,height:b}:{};return u==="insideLeft"?Ca({x:p+O,y:g+b/2,textAnchor:j,verticalAnchor:"middle"},V):u==="insideRight"?Ca({x:p+v-O,y:g+b/2,textAnchor:k,verticalAnchor:"middle"},V):u==="insideTop"?Ca({x:p+v/2,y:g+T,textAnchor:"middle",verticalAnchor:R},V):u==="insideBottom"?Ca({x:p+v/2,y:g+b-T,textAnchor:"middle",verticalAnchor:C},V):u==="insideTopLeft"?Ca({x:p+O,y:g+T,textAnchor:j,verticalAnchor:R},V):u==="insideTopRight"?Ca({x:p+v-O,y:g+T,textAnchor:k,verticalAnchor:R},V):u==="insideBottomLeft"?Ca({x:p+O,y:g+b-T,textAnchor:j,verticalAnchor:C},V):u==="insideBottomRight"?Ca({x:p+v-O,y:g+b-T,textAnchor:k,verticalAnchor:C},V):u_(u)&&(xt(u.x)||Bp(u.x))&&(xt(u.y)||Bp(u.y))?Ca({x:p+gm(u.x,v),y:g+gm(u.y,b),textAnchor:"end",verticalAnchor:"end"},V):Ca({x:p+v/2,y:g+b/2,textAnchor:"middle",verticalAnchor:"middle"},V)},Rmt=function(t){return"cx"in t&&xt(t.cx)};function bs(e){var t=e.offset,n=t===void 0?5:t,i=vmt(e,dmt),o=Ca({offset:n},i),u=o.viewBox,h=o.position,p=o.value,g=o.children,v=o.content,b=o.className,E=b===void 0?"":b,T=o.textBreakAll;if(!u||Nr(p)&&Nr(g)&&!S.isValidElement(v)&&!zn(v))return null;if(S.isValidElement(v))return S.cloneElement(v,o);var C;if(zn(v)){if(C=S.createElement(v,o),S.isValidElement(C))return C}else C=wmt(o);var R=Rmt(u),N=Tr(o,!0);if(R&&(h==="insideStart"||h==="insideEnd"||h==="end"))return xmt(o,C,N);var O=R?Tmt(o):Cmt(o);return me.createElement(fA,cw({className:er("recharts-label",E)},N,O,{breakAll:T}),C)}bs.displayName="Label";var sve=function(t){var n=t.cx,i=t.cy,o=t.angle,u=t.startAngle,h=t.endAngle,p=t.r,g=t.radius,v=t.innerRadius,b=t.outerRadius,E=t.x,T=t.y,C=t.top,R=t.left,N=t.width,O=t.height,k=t.clockWise,j=t.labelViewBox;if(j)return j;if(xt(N)&&xt(O)){if(xt(E)&&xt(T))return{x:E,y:T,width:N,height:O};if(xt(C)&&xt(R))return{x:C,y:R,width:N,height:O}}return xt(E)&&xt(T)?{x:E,y:T,width:0,height:0}:xt(n)&&xt(i)?{cx:n,cy:i,startAngle:u||o||0,endAngle:h||o||0,innerRadius:v||0,outerRadius:b||g||p||0,clockWise:k}:t.viewBox?t.viewBox:{}},Nmt=function(t,n){return t?t===!0?me.createElement(bs,{key:"label-implicit",viewBox:n}):Oa(t)?me.createElement(bs,{key:"label-implicit",viewBox:n,value:t}):S.isValidElement(t)?t.type===bs?S.cloneElement(t,{key:"label-implicit",viewBox:n}):me.createElement(bs,{key:"label-implicit",content:t,viewBox:n}):zn(t)?me.createElement(bs,{key:"label-implicit",content:t,viewBox:n}):u_(t)?me.createElement(bs,cw({viewBox:n},t,{key:"label-implicit"})):null:null},Amt=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&i&&!t.label)return null;var o=t.children,u=sve(t),h=Bl(o,bs).map(function(g,v){return S.cloneElement(g,{viewBox:n||u,key:"label-".concat(v)})});if(!i)return h;var p=Nmt(t.label,n||u);return[p].concat(hmt(h))};bs.parseViewBox=sve;bs.renderCallByParent=Amt;function Imt(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Omt=Imt;const Pmt=jr(Omt);function lw(e){"@babel/helpers - typeof";return lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(e)}var kmt=["valueAccessor"],jmt=["data","dataKey","clockWise","id","textBreakAll"];function Dmt(e){return Fmt(e)||Umt(e)||Mmt(e)||Lmt()}function Lmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mmt(e,t){if(e){if(typeof e=="string")return UF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UF(e,t)}}function Umt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fmt(e){if(Array.isArray(e))return UF(e)}function UF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function AA(){return AA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},AA.apply(this,arguments)}function jre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Dre(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jre(Object(n),!0).forEach(function(i){Vmt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Vmt(e,t,n){return t=Bmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bmt(e){var t=$mt(e,"string");return lw(t)=="symbol"?t:t+""}function $mt(e,t){if(lw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(lw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lre(e,t){if(e==null)return{};var n=Wmt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Wmt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var Gmt=function(t){return Array.isArray(t.value)?Pmt(t.value):t.value};function tm(e){var t=e.valueAccessor,n=t===void 0?Gmt:t,i=Lre(e,kmt),o=i.data,u=i.dataKey,h=i.clockWise,p=i.id,g=i.textBreakAll,v=Lre(i,jmt);return!o||!o.length?null:me.createElement($a,{className:"recharts-label-list"},o.map(function(b,E){var T=Nr(u)?n(b,E):Wu(b&&b.payload,u),C=Nr(p)?{}:{id:"".concat(p,"-").concat(E)};return me.createElement(bs,AA({},Tr(b,!0),v,C,{parentViewBox:b.parentViewBox,value:T,textBreakAll:g,viewBox:bs.parseViewBox(Nr(h)?b:Dre(Dre({},b),{},{clockWise:h})),key:"label-".concat(E),index:E}))}))}tm.displayName="LabelList";function Hmt(e,t){return e?e===!0?me.createElement(tm,{key:"labelList-implicit",data:t}):me.isValidElement(e)||zn(e)?me.createElement(tm,{key:"labelList-implicit",data:t,content:e}):u_(e)?me.createElement(tm,AA({data:t},e,{key:"labelList-implicit"})):null:null}function zmt(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,o=Bl(i,tm).map(function(h,p){return S.cloneElement(h,{data:t,key:"labelList-".concat(p)})});if(!n)return o;var u=Hmt(e.label,t);return[u].concat(Dmt(o))}tm.renderCallByParent=zmt;function uw(e){"@babel/helpers - typeof";return uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uw(e)}function FF(){return FF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},FF.apply(this,arguments)}function Mre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ure(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mre(Object(n),!0).forEach(function(i){Kmt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Kmt(e,t,n){return t=qmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qmt(e){var t=Ymt(e,"string");return uw(t)=="symbol"?t:t+""}function Ymt(e,t){if(uw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(uw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xmt=function(t,n){var i=Ml(n-t),o=Math.min(Math.abs(n-t),359.999);return i*o},iR=function(t){var n=t.cx,i=t.cy,o=t.radius,u=t.angle,h=t.sign,p=t.isExternal,g=t.cornerRadius,v=t.cornerIsExternal,b=g*(p?1:-1)+o,E=Math.asin(g/b)/NA,T=v?u:u+h*E,C=ts(n,i,b,T),R=ts(n,i,o,T),N=v?u-h*E:u,O=ts(n,i,b*Math.cos(E*NA),N);return{center:C,circleTangency:R,lineTangency:O,theta:E}},ove=function(t){var n=t.cx,i=t.cy,o=t.innerRadius,u=t.outerRadius,h=t.startAngle,p=t.endAngle,g=Xmt(h,p),v=h+g,b=ts(n,i,u,h),E=ts(n,i,u,v),T="M ".concat(b.x,",").concat(b.y,`
    A `).concat(u,",").concat(u,`,0,
    `).concat(+(Math.abs(g)>180),",").concat(+(h>v),`,
    `).concat(E.x,",").concat(E.y,`
  `);if(o>0){var C=ts(n,i,o,h),R=ts(n,i,o,v);T+="L ".concat(R.x,",").concat(R.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(g)>180),",").concat(+(h<=v),`,
            `).concat(C.x,",").concat(C.y," Z")}else T+="L ".concat(n,",").concat(i," Z");return T},Jmt=function(t){var n=t.cx,i=t.cy,o=t.innerRadius,u=t.outerRadius,h=t.cornerRadius,p=t.forceCornerRadius,g=t.cornerIsExternal,v=t.startAngle,b=t.endAngle,E=Ml(b-v),T=iR({cx:n,cy:i,radius:u,angle:v,sign:E,cornerRadius:h,cornerIsExternal:g}),C=T.circleTangency,R=T.lineTangency,N=T.theta,O=iR({cx:n,cy:i,radius:u,angle:b,sign:-E,cornerRadius:h,cornerIsExternal:g}),k=O.circleTangency,j=O.lineTangency,P=O.theta,M=g?Math.abs(v-b):Math.abs(v-b)-N-P;if(M<0)return p?"M ".concat(R.x,",").concat(R.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):ove({cx:n,cy:i,innerRadius:o,outerRadius:u,startAngle:v,endAngle:b});var D="M ".concat(R.x,",").concat(R.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(C.x,",").concat(C.y,`
    A`).concat(u,",").concat(u,",0,").concat(+(M>180),",").concat(+(E<0),",").concat(k.x,",").concat(k.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(j.x,",").concat(j.y,`
  `);if(o>0){var U=iR({cx:n,cy:i,radius:o,angle:v,sign:E,isExternal:!0,cornerRadius:h,cornerIsExternal:g}),V=U.circleTangency,z=U.lineTangency,W=U.theta,Y=iR({cx:n,cy:i,radius:o,angle:b,sign:-E,isExternal:!0,cornerRadius:h,cornerIsExternal:g}),Q=Y.circleTangency,K=Y.lineTangency,q=Y.theta,ee=g?Math.abs(v-b):Math.abs(v-b)-W-q;if(ee<0&&h===0)return"".concat(D,"L").concat(n,",").concat(i,"Z");D+="L".concat(K.x,",").concat(K.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(Q.x,",").concat(Q.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(ee>180),",").concat(+(E>0),",").concat(V.x,",").concat(V.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(z.x,",").concat(z.y,"Z")}else D+="L".concat(n,",").concat(i,"Z");return D},Zmt={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},cve=function(t){var n=Ure(Ure({},Zmt),t),i=n.cx,o=n.cy,u=n.innerRadius,h=n.outerRadius,p=n.cornerRadius,g=n.forceCornerRadius,v=n.cornerIsExternal,b=n.startAngle,E=n.endAngle,T=n.className;if(h<u||b===E)return null;var C=er("recharts-sector",T),R=h-u,N=gm(p,R,0,!0),O;return N>0&&Math.abs(b-E)<360?O=Jmt({cx:i,cy:o,innerRadius:u,outerRadius:h,cornerRadius:Math.min(N,R/2),forceCornerRadius:g,cornerIsExternal:v,startAngle:b,endAngle:E}):O=ove({cx:i,cy:o,innerRadius:u,outerRadius:h,startAngle:b,endAngle:E}),me.createElement("path",FF({},Tr(n,!0),{className:C,d:O,role:"img"}))};function dw(e){"@babel/helpers - typeof";return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dw(e)}function VF(){return VF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},VF.apply(this,arguments)}function Fre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Vre(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fre(Object(n),!0).forEach(function(i){Qmt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Qmt(e,t,n){return t=egt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function egt(e){var t=tgt(e,"string");return dw(t)=="symbol"?t:t+""}function tgt(e,t){if(dw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(dw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bre={curveBasisClosed:Qet,curveBasisOpen:ett,curveBasis:Zet,curveBumpX:Uet,curveBumpY:Fet,curveLinearClosed:ttt,curveLinear:VI,curveMonotoneX:ntt,curveMonotoneY:rtt,curveNatural:itt,curveStep:att,curveStepAfter:ott,curveStepBefore:stt},aR=function(t){return t.x===+t.x&&t.y===+t.y},TE=function(t){return t.x},CE=function(t){return t.y},ngt=function(t,n){if(zn(t))return t;var i="curve".concat(UI(t));return(i==="curveMonotone"||i==="curveBump")&&n?Bre["".concat(i).concat(n==="vertical"?"Y":"X")]:Bre[i]||VI},rgt=function(t){var n=t.type,i=n===void 0?"linear":n,o=t.points,u=o===void 0?[]:o,h=t.baseLine,p=t.layout,g=t.connectNulls,v=g===void 0?!1:g,b=ngt(i,p),E=v?u.filter(function(N){return aR(N)}):u,T;if(Array.isArray(h)){var C=v?h.filter(function(N){return aR(N)}):h,R=E.map(function(N,O){return Vre(Vre({},N),{},{base:C[O]})});return p==="vertical"?T=YC().y(CE).x1(TE).x0(function(N){return N.base.x}):T=YC().x(TE).y1(CE).y0(function(N){return N.base.y}),T.defined(aR).curve(b),T(R)}return p==="vertical"&&xt(h)?T=YC().y(CE).x1(TE).x0(h):xt(h)?T=YC().x(TE).y1(CE).y0(h):T=cme().x(TE).y(CE),T.defined(aR).curve(b),T(E)},$re=function(t){var n=t.className,i=t.points,o=t.path,u=t.pathRef;if((!i||!i.length)&&!o)return null;var h=i&&i.length?rgt(t):o;return S.createElement("path",VF({},Tr(t,!1),ZN(t),{className:er("recharts-curve",n),d:h,ref:u}))},lve={exports:{}},igt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",agt=igt,sgt=agt;function uve(){}function dve(){}dve.resetWarningCache=uve;var ogt=function(){function e(i,o,u,h,p,g){if(g!==sgt){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:dve,resetWarningCache:uve};return n.PropTypes=n,n};lve.exports=ogt();var cgt=lve.exports;const Or=jr(cgt);var lgt=Object.getOwnPropertyNames,ugt=Object.getOwnPropertySymbols,dgt=Object.prototype.hasOwnProperty;function Wre(e,t){return function(i,o,u){return e(i,o,u)&&t(i,o,u)}}function sR(e){return function(n,i,o){if(!n||!i||typeof n!="object"||typeof i!="object")return e(n,i,o);var u=o.cache,h=u.get(n),p=u.get(i);if(h&&p)return h===i&&p===n;u.set(n,i),u.set(i,n);var g=e(n,i,o);return u.delete(n),u.delete(i),g}}function Gre(e){return lgt(e).concat(ugt(e))}var hgt=Object.hasOwn||function(e,t){return dgt.call(e,t)};function Dm(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var fgt="__v",pgt="__o",mgt="_owner",Hre=Object.getOwnPropertyDescriptor,zre=Object.keys;function ggt(e,t,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!n.equals(e[i],t[i],i,i,e,t,n))return!1;return!0}function vgt(e,t){return Dm(e.getTime(),t.getTime())}function ygt(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function _gt(e,t){return e===t}function Kre(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var o=new Array(i),u=e.entries(),h,p,g=0;(h=u.next())&&!h.done;){for(var v=t.entries(),b=!1,E=0;(p=v.next())&&!p.done;){if(o[E]){E++;continue}var T=h.value,C=p.value;if(n.equals(T[0],C[0],g,E,e,t,n)&&n.equals(T[1],C[1],T[0],C[0],e,t,n)){b=o[E]=!0;break}E++}if(!b)return!1;g++}return!0}var bgt=Dm;function Egt(e,t,n){var i=zre(e),o=i.length;if(zre(t).length!==o)return!1;for(;o-- >0;)if(!hve(e,t,n,i[o]))return!1;return!0}function RE(e,t,n){var i=Gre(e),o=i.length;if(Gre(t).length!==o)return!1;for(var u,h,p;o-- >0;)if(u=i[o],!hve(e,t,n,u)||(h=Hre(e,u),p=Hre(t,u),(h||p)&&(!h||!p||h.configurable!==p.configurable||h.enumerable!==p.enumerable||h.writable!==p.writable)))return!1;return!0}function wgt(e,t){return Dm(e.valueOf(),t.valueOf())}function Sgt(e,t){return e.source===t.source&&e.flags===t.flags}function qre(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var o=new Array(i),u=e.values(),h,p;(h=u.next())&&!h.done;){for(var g=t.values(),v=!1,b=0;(p=g.next())&&!p.done;){if(!o[b]&&n.equals(h.value,p.value,h.value,p.value,e,t,n)){v=o[b]=!0;break}b++}if(!v)return!1}return!0}function xgt(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Tgt(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function hve(e,t,n,i){return(i===mgt||i===pgt||i===fgt)&&(e.$$typeof||t.$$typeof)?!0:hgt(t,i)&&n.equals(e[i],t[i],i,i,e,t,n)}var Cgt="[object Arguments]",Rgt="[object Boolean]",Ngt="[object Date]",Agt="[object Error]",Igt="[object Map]",Ogt="[object Number]",Pgt="[object Object]",kgt="[object RegExp]",jgt="[object Set]",Dgt="[object String]",Lgt="[object URL]",Mgt=Array.isArray,Yre=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Xre=Object.assign,Ugt=Object.prototype.toString.call.bind(Object.prototype.toString);function Fgt(e){var t=e.areArraysEqual,n=e.areDatesEqual,i=e.areErrorsEqual,o=e.areFunctionsEqual,u=e.areMapsEqual,h=e.areNumbersEqual,p=e.areObjectsEqual,g=e.arePrimitiveWrappersEqual,v=e.areRegExpsEqual,b=e.areSetsEqual,E=e.areTypedArraysEqual,T=e.areUrlsEqual;return function(R,N,O){if(R===N)return!0;if(R==null||N==null)return!1;var k=typeof R;if(k!==typeof N)return!1;if(k!=="object")return k==="number"?h(R,N,O):k==="function"?o(R,N,O):!1;var j=R.constructor;if(j!==N.constructor)return!1;if(j===Object)return p(R,N,O);if(Mgt(R))return t(R,N,O);if(Yre!=null&&Yre(R))return E(R,N,O);if(j===Date)return n(R,N,O);if(j===RegExp)return v(R,N,O);if(j===Map)return u(R,N,O);if(j===Set)return b(R,N,O);var P=Ugt(R);return P===Ngt?n(R,N,O):P===kgt?v(R,N,O):P===Igt?u(R,N,O):P===jgt?b(R,N,O):P===Pgt?typeof R.then!="function"&&typeof N.then!="function"&&p(R,N,O):P===Lgt?T(R,N,O):P===Agt?i(R,N,O):P===Cgt?p(R,N,O):P===Rgt||P===Ogt||P===Dgt?g(R,N,O):!1}}function Vgt(e){var t=e.circular,n=e.createCustomConfig,i=e.strict,o={areArraysEqual:i?RE:ggt,areDatesEqual:vgt,areErrorsEqual:ygt,areFunctionsEqual:_gt,areMapsEqual:i?Wre(Kre,RE):Kre,areNumbersEqual:bgt,areObjectsEqual:i?RE:Egt,arePrimitiveWrappersEqual:wgt,areRegExpsEqual:Sgt,areSetsEqual:i?Wre(qre,RE):qre,areTypedArraysEqual:i?RE:xgt,areUrlsEqual:Tgt};if(n&&(o=Xre({},o,n(o))),t){var u=sR(o.areArraysEqual),h=sR(o.areMapsEqual),p=sR(o.areObjectsEqual),g=sR(o.areSetsEqual);o=Xre({},o,{areArraysEqual:u,areMapsEqual:h,areObjectsEqual:p,areSetsEqual:g})}return o}function Bgt(e){return function(t,n,i,o,u,h,p){return e(t,n,p)}}function $gt(e){var t=e.circular,n=e.comparator,i=e.createState,o=e.equals,u=e.strict;if(i)return function(g,v){var b=i(),E=b.cache,T=E===void 0?t?new WeakMap:void 0:E,C=b.meta;return n(g,v,{cache:T,equals:o,meta:C,strict:u})};if(t)return function(g,v){return n(g,v,{cache:new WeakMap,equals:o,meta:void 0,strict:u})};var h={cache:void 0,equals:o,meta:void 0,strict:u};return function(g,v){return n(g,v,h)}}var Wgt=Bf();Bf({strict:!0});Bf({circular:!0});Bf({circular:!0,strict:!0});Bf({createInternalComparator:function(){return Dm}});Bf({strict:!0,createInternalComparator:function(){return Dm}});Bf({circular:!0,createInternalComparator:function(){return Dm}});Bf({circular:!0,createInternalComparator:function(){return Dm},strict:!0});function Bf(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,i=e.createInternalComparator,o=e.createState,u=e.strict,h=u===void 0?!1:u,p=Vgt(e),g=Fgt(p),v=i?i(g):Bgt(g);return $gt({circular:n,comparator:g,createState:o,equals:v,strict:h})}function Ggt(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Jre(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=function o(u){n<0&&(n=u),u-n>t?(e(u),n=-1):Ggt(o)};requestAnimationFrame(i)}function BF(e){"@babel/helpers - typeof";return BF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BF(e)}function Hgt(e){return Ygt(e)||qgt(e)||Kgt(e)||zgt()}function zgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kgt(e,t){if(e){if(typeof e=="string")return Zre(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zre(e,t)}}function Zre(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ygt(e){if(Array.isArray(e))return e}function Xgt(){var e={},t=function(){return null},n=!1,i=function o(u){if(!n){if(Array.isArray(u)){if(!u.length)return;var h=u,p=Hgt(h),g=p[0],v=p.slice(1);if(typeof g=="number"){Jre(o.bind(null,v),g);return}o(g),Jre(o.bind(null,v));return}BF(u)==="object"&&(e=u,t(e)),typeof u=="function"&&u()}};return{stop:function(){n=!0},start:function(u){n=!1,i(u)},subscribe:function(u){return t=u,function(){t=function(){return null}}}}}function hw(e){"@babel/helpers - typeof";return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(e)}function Qre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function eie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qre(Object(n),!0).forEach(function(i){fve(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function fve(e,t,n){return t=Jgt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jgt(e){var t=Zgt(e,"string");return hw(t)==="symbol"?t:String(t)}function Zgt(e,t){if(hw(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(hw(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qgt=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(i,o){return i.filter(function(u){return o.includes(u)})})},evt=function(t){return t},tvt=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},i0=function(t,n){return Object.keys(n).reduce(function(i,o){return eie(eie({},i),{},fve({},o,t(o,n[o])))},{})},tie=function(t,n,i){return t.map(function(o){return"".concat(tvt(o)," ").concat(n,"ms ").concat(i)}).join(",")};function nvt(e,t){return avt(e)||ivt(e,t)||pve(e,t)||rvt()}function rvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ivt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function avt(e){if(Array.isArray(e))return e}function svt(e){return lvt(e)||cvt(e)||pve(e)||ovt()}function ovt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pve(e,t){if(e){if(typeof e=="string")return $F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $F(e,t)}}function cvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lvt(e){if(Array.isArray(e))return $F(e)}function $F(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var IA=1e-4,mve=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},gve=function(t,n){return t.map(function(i,o){return i*Math.pow(n,o)}).reduce(function(i,o){return i+o})},nie=function(t,n){return function(i){var o=mve(t,n);return gve(o,i)}},uvt=function(t,n){return function(i){var o=mve(t,n),u=[].concat(svt(o.map(function(h,p){return h*p}).slice(1)),[0]);return gve(u,i)}},rie=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0],u=n[1],h=n[2],p=n[3];if(n.length===1)switch(n[0]){case"linear":o=0,u=0,h=1,p=1;break;case"ease":o=.25,u=.1,h=.25,p=1;break;case"ease-in":o=.42,u=0,h=1,p=1;break;case"ease-out":o=.42,u=0,h=.58,p=1;break;case"ease-in-out":o=0,u=0,h=.58,p=1;break;default:{var g=n[0].split("(");if(g[0]==="cubic-bezier"&&g[1].split(")")[0].split(",").length===4){var v=g[1].split(")")[0].split(",").map(function(O){return parseFloat(O)}),b=nvt(v,4);o=b[0],u=b[1],h=b[2],p=b[3]}}}var E=nie(o,h),T=nie(u,p),C=uvt(o,h),R=function(k){return k>1?1:k<0?0:k},N=function(k){for(var j=k>1?1:k,P=j,M=0;M<8;++M){var D=E(P)-j,U=C(P);if(Math.abs(D-j)<IA||U<IA)return T(P);P=R(P-D/U)}return T(P)};return N.isStepper=!1,N},dvt=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,i=n===void 0?100:n,o=t.damping,u=o===void 0?8:o,h=t.dt,p=h===void 0?17:h,g=function(b,E,T){var C=-(b-E)*i,R=T*u,N=T+(C-R)*p/1e3,O=T*p/1e3+b;return Math.abs(O-E)<IA&&Math.abs(N)<IA?[E,0]:[O,N]};return g.isStepper=!0,g.dt=p,g},hvt=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return rie(o);case"spring":return dvt();default:if(o.split("(")[0]==="cubic-bezier")return rie(o)}return typeof o=="function"?o:null};function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}function iie(e){return mvt(e)||pvt(e)||vve(e)||fvt()}function fvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mvt(e){if(Array.isArray(e))return GF(e)}function aie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Za(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aie(Object(n),!0).forEach(function(i){WF(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function WF(e,t,n){return t=gvt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gvt(e){var t=vvt(e,"string");return fw(t)==="symbol"?t:String(t)}function vvt(e,t){if(fw(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(fw(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yvt(e,t){return Evt(e)||bvt(e,t)||vve(e,t)||_vt()}function _vt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vve(e,t){if(e){if(typeof e=="string")return GF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GF(e,t)}}function GF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function bvt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Evt(e){if(Array.isArray(e))return e}var OA=function(t,n,i){return t+(n-t)*i},HF=function(t){var n=t.from,i=t.to;return n!==i},wvt=function e(t,n,i){var o=i0(function(u,h){if(HF(h)){var p=t(h.from,h.to,h.velocity),g=yvt(p,2),v=g[0],b=g[1];return Za(Za({},h),{},{from:v,velocity:b})}return h},n);return i<1?i0(function(u,h){return HF(h)?Za(Za({},h),{},{velocity:OA(h.velocity,o[u].velocity,i),from:OA(h.from,o[u].from,i)}):h},n):e(t,o,i-1)};const Svt=function(e,t,n,i,o){var u=Qgt(e,t),h=u.reduce(function(O,k){return Za(Za({},O),{},WF({},k,[e[k],t[k]]))},{}),p=u.reduce(function(O,k){return Za(Za({},O),{},WF({},k,{from:e[k],velocity:0,to:t[k]}))},{}),g=-1,v,b,E=function(){return null},T=function(){return i0(function(k,j){return j.from},p)},C=function(){return!Object.values(p).filter(HF).length},R=function(k){v||(v=k);var j=k-v,P=j/n.dt;p=wvt(n,p,P),o(Za(Za(Za({},e),t),T())),v=k,C()||(g=requestAnimationFrame(E))},N=function(k){b||(b=k);var j=(k-b)/i,P=i0(function(D,U){return OA.apply(void 0,iie(U).concat([n(j)]))},h);if(o(Za(Za(Za({},e),t),P)),j<1)g=requestAnimationFrame(E);else{var M=i0(function(D,U){return OA.apply(void 0,iie(U).concat([n(1)]))},h);o(Za(Za(Za({},e),t),M))}};return E=n.isStepper?R:N,function(){return requestAnimationFrame(E),function(){cancelAnimationFrame(g)}}};function Iy(e){"@babel/helpers - typeof";return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}var xvt=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Tvt(e,t){if(e==null)return{};var n=Cvt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Cvt(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,u;for(u=0;u<i.length;u++)o=i[u],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function KL(e){return Ivt(e)||Avt(e)||Nvt(e)||Rvt()}function Rvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nvt(e,t){if(e){if(typeof e=="string")return zF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zF(e,t)}}function Avt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ivt(e){if(Array.isArray(e))return zF(e)}function zF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function sie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function yl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sie(Object(n),!0).forEach(function(i){$E(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function $E(e,t,n){return t=yve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ovt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pvt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,yve(i.key),i)}}function kvt(e,t,n){return t&&Pvt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yve(e){var t=jvt(e,"string");return Iy(t)==="symbol"?t:String(t)}function jvt(e,t){if(Iy(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Iy(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KF(e,t)}function KF(e,t){return KF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},KF(e,t)}function Lvt(e){var t=Mvt();return function(){var i=PA(e),o;if(t){var u=PA(this).constructor;o=Reflect.construct(i,arguments,u)}else o=i.apply(this,arguments);return qF(this,o)}}function qF(e,t){if(t&&(Iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YF(e)}function YF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function PA(e){return PA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},PA(e)}var Rf=function(e){Dvt(n,e);var t=Lvt(n);function n(i,o){var u;Ovt(this,n),u=t.call(this,i,o);var h=u.props,p=h.isActive,g=h.attributeName,v=h.from,b=h.to,E=h.steps,T=h.children,C=h.duration;if(u.handleStyleChange=u.handleStyleChange.bind(YF(u)),u.changeStyle=u.changeStyle.bind(YF(u)),!p||C<=0)return u.state={style:{}},typeof T=="function"&&(u.state={style:b}),qF(u);if(E&&E.length)u.state={style:E[0].style};else if(v){if(typeof T=="function")return u.state={style:v},qF(u);u.state={style:g?$E({},g,v):v}}else u.state={style:{}};return u}return kvt(n,[{key:"componentDidMount",value:function(){var o=this.props,u=o.isActive,h=o.canBegin;this.mounted=!0,!(!u||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var u=this.props,h=u.isActive,p=u.canBegin,g=u.attributeName,v=u.shouldReAnimate,b=u.to,E=u.from,T=this.state.style;if(p){if(!h){var C={style:g?$E({},g,b):b};this.state&&T&&(g&&T[g]!==b||!g&&T!==b)&&this.setState(C);return}if(!(Wgt(o.to,b)&&o.canBegin&&o.isActive)){var R=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=R||v?E:o.to;if(this.state&&T){var O={style:g?$E({},g,N):N};(g&&T[g]!==N||!g&&T!==N)&&this.setState(O)}this.runAnimation(yl(yl({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var u=this,h=o.from,p=o.to,g=o.duration,v=o.easing,b=o.begin,E=o.onAnimationEnd,T=o.onAnimationStart,C=Svt(h,p,hvt(v),g,this.changeStyle),R=function(){u.stopJSAnimation=C()};this.manager.start([T,b,R,g,E])}},{key:"runStepAnimation",value:function(o){var u=this,h=o.steps,p=o.begin,g=o.onAnimationStart,v=h[0],b=v.style,E=v.duration,T=E===void 0?0:E,C=function(N,O,k){if(k===0)return N;var j=O.duration,P=O.easing,M=P===void 0?"ease":P,D=O.style,U=O.properties,V=O.onAnimationEnd,z=k>0?h[k-1]:O,W=U||Object.keys(D);if(typeof M=="function"||M==="spring")return[].concat(KL(N),[u.runJSAnimation.bind(u,{from:z.style,to:D,duration:j,easing:M}),j]);var Y=tie(W,j,M),Q=yl(yl(yl({},z.style),D),{},{transition:Y});return[].concat(KL(N),[Q,j,V]).filter(evt)};return this.manager.start([g].concat(KL(h.reduce(C,[b,Math.max(T,p)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=Xgt());var u=o.begin,h=o.duration,p=o.attributeName,g=o.to,v=o.easing,b=o.onAnimationStart,E=o.onAnimationEnd,T=o.steps,C=o.children,R=this.manager;if(this.unSubscribe=R.subscribe(this.handleStyleChange),typeof v=="function"||typeof C=="function"||v==="spring"){this.runJSAnimation(o);return}if(T.length>1){this.runStepAnimation(o);return}var N=p?$E({},p,g):g,O=tie(Object.keys(N),h,v);R.start([b,u,yl(yl({},N),{},{transition:O}),h,E])}},{key:"render",value:function(){var o=this.props,u=o.children;o.begin;var h=o.duration;o.attributeName,o.easing;var p=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var g=Tvt(o,xvt),v=S.Children.count(u),b=this.state.style;if(typeof u=="function")return u(b);if(!p||v===0||h<=0)return u;var E=function(C){var R=C.props,N=R.style,O=N===void 0?{}:N,k=R.className,j=S.cloneElement(C,yl(yl({},g),{},{style:yl(yl({},O),b),className:k}));return j};return v===1?E(S.Children.only(u)):me.createElement("div",null,S.Children.map(u,function(T){return E(T)}))}}]),n}(S.PureComponent);Rf.displayName="Animate";Rf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Rf.propTypes={from:Or.oneOfType([Or.object,Or.string]),to:Or.oneOfType([Or.object,Or.string]),attributeName:Or.string,duration:Or.number,begin:Or.number,easing:Or.oneOfType([Or.string,Or.func]),steps:Or.arrayOf(Or.shape({duration:Or.number.isRequired,style:Or.object.isRequired,easing:Or.oneOfType([Or.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Or.func]),properties:Or.arrayOf("string"),onAnimationEnd:Or.func})),children:Or.oneOfType([Or.node,Or.func]),isActive:Or.bool,canBegin:Or.bool,onAnimationEnd:Or.func,shouldReAnimate:Or.bool,onAnimationStart:Or.func,onAnimationReStart:Or.func};function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function kA(){return kA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},kA.apply(this,arguments)}function Uvt(e,t){return $vt(e)||Bvt(e,t)||Vvt(e,t)||Fvt()}function Fvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vvt(e,t){if(e){if(typeof e=="string")return oie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oie(e,t)}}function oie(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Bvt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function $vt(e){if(Array.isArray(e))return e}function cie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function lie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cie(Object(n),!0).forEach(function(i){Wvt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Wvt(e,t,n){return t=Gvt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gvt(e){var t=Hvt(e,"string");return pw(t)=="symbol"?t:t+""}function Hvt(e,t){if(pw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(pw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uie=function(t,n,i,o,u){var h=Math.min(Math.abs(i)/2,Math.abs(o)/2),p=o>=0?1:-1,g=i>=0?1:-1,v=o>=0&&i>=0||o<0&&i<0?1:0,b;if(h>0&&u instanceof Array){for(var E=[0,0,0,0],T=0,C=4;T<C;T++)E[T]=u[T]>h?h:u[T];b="M".concat(t,",").concat(n+p*E[0]),E[0]>0&&(b+="A ".concat(E[0],",").concat(E[0],",0,0,").concat(v,",").concat(t+g*E[0],",").concat(n)),b+="L ".concat(t+i-g*E[1],",").concat(n),E[1]>0&&(b+="A ".concat(E[1],",").concat(E[1],",0,0,").concat(v,`,
        `).concat(t+i,",").concat(n+p*E[1])),b+="L ".concat(t+i,",").concat(n+o-p*E[2]),E[2]>0&&(b+="A ".concat(E[2],",").concat(E[2],",0,0,").concat(v,`,
        `).concat(t+i-g*E[2],",").concat(n+o)),b+="L ".concat(t+g*E[3],",").concat(n+o),E[3]>0&&(b+="A ".concat(E[3],",").concat(E[3],",0,0,").concat(v,`,
        `).concat(t,",").concat(n+o-p*E[3])),b+="Z"}else if(h>0&&u===+u&&u>0){var R=Math.min(h,u);b="M ".concat(t,",").concat(n+p*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t+g*R,",").concat(n,`
            L `).concat(t+i-g*R,",").concat(n,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t+i,",").concat(n+p*R,`
            L `).concat(t+i,",").concat(n+o-p*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t+i-g*R,",").concat(n+o,`
            L `).concat(t+g*R,",").concat(n+o,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t,",").concat(n+o-p*R," Z")}else b="M ".concat(t,",").concat(n," h ").concat(i," v ").concat(o," h ").concat(-i," Z");return b},zvt=function(t,n){if(!t||!n)return!1;var i=t.x,o=t.y,u=n.x,h=n.y,p=n.width,g=n.height;if(Math.abs(p)>0&&Math.abs(g)>0){var v=Math.min(u,u+p),b=Math.max(u,u+p),E=Math.min(h,h+g),T=Math.max(h,h+g);return i>=v&&i<=b&&o>=E&&o<=T}return!1},Kvt={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$3=function(t){var n=lie(lie({},Kvt),t),i=S.useRef(),o=S.useState(-1),u=Uvt(o,2),h=u[0],p=u[1];S.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var M=i.current.getTotalLength();M&&p(M)}catch{}},[]);var g=n.x,v=n.y,b=n.width,E=n.height,T=n.radius,C=n.className,R=n.animationEasing,N=n.animationDuration,O=n.animationBegin,k=n.isAnimationActive,j=n.isUpdateAnimationActive;if(g!==+g||v!==+v||b!==+b||E!==+E||b===0||E===0)return null;var P=er("recharts-rectangle",C);return j?me.createElement(Rf,{canBegin:h>0,from:{width:b,height:E,x:g,y:v},to:{width:b,height:E,x:g,y:v},duration:N,animationEasing:R,isActive:j},function(M){var D=M.width,U=M.height,V=M.x,z=M.y;return me.createElement(Rf,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:O,duration:N,isActive:k,easing:R},me.createElement("path",kA({},Tr(n,!0),{className:P,d:uie(V,z,D,U,T),ref:i})))}):me.createElement("path",kA({},Tr(n,!0),{className:P,d:uie(g,v,b,E,T)}))};function XF(){return XF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},XF.apply(this,arguments)}var _ve=function(t){var n=t.cx,i=t.cy,o=t.r,u=t.className,h=er("recharts-dot",u);return n===+n&&i===+i&&o===+o?S.createElement("circle",XF({},Tr(t,!1),ZN(t),{className:h,cx:n,cy:i,r:o})):null};function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}var qvt=["x","y","top","left","width","height","className"];function JF(){return JF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},JF.apply(this,arguments)}function die(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Yvt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?die(Object(n),!0).forEach(function(i){Xvt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):die(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Xvt(e,t,n){return t=Jvt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jvt(e){var t=Zvt(e,"string");return mw(t)=="symbol"?t:t+""}function Zvt(e,t){if(mw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(mw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qvt(e,t){if(e==null)return{};var n=eyt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function eyt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var tyt=function(t,n,i,o,u,h){return"M".concat(t,",").concat(u,"v").concat(o,"M").concat(h,",").concat(n,"h").concat(i)},nyt=function(t){var n=t.x,i=n===void 0?0:n,o=t.y,u=o===void 0?0:o,h=t.top,p=h===void 0?0:h,g=t.left,v=g===void 0?0:g,b=t.width,E=b===void 0?0:b,T=t.height,C=T===void 0?0:T,R=t.className,N=Qvt(t,qvt),O=Yvt({x:i,y:u,top:p,left:v,width:E,height:C},N);return!xt(i)||!xt(u)||!xt(E)||!xt(C)||!xt(p)||!xt(v)?null:me.createElement("path",JF({},Tr(O,!0),{className:er("recharts-cross",R),d:tyt(i,u,E,C,p,v)}))},ryt=Pme,iyt=ryt(Object.getPrototypeOf,Object),ayt=iyt,syt=Jd,oyt=ayt,cyt=Zd,lyt="[object Object]",uyt=Function.prototype,dyt=Object.prototype,bve=uyt.toString,hyt=dyt.hasOwnProperty,fyt=bve.call(Object);function pyt(e){if(!cyt(e)||syt(e)!=lyt)return!1;var t=oyt(e);if(t===null)return!0;var n=hyt.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&bve.call(n)==fyt}var myt=pyt;const gyt=jr(myt);var vyt=Jd,yyt=Zd,_yt="[object Boolean]";function byt(e){return e===!0||e===!1||yyt(e)&&vyt(e)==_yt}var Eyt=byt;const wyt=jr(Eyt);function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function jA(){return jA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},jA.apply(this,arguments)}function Syt(e,t){return Ryt(e)||Cyt(e,t)||Tyt(e,t)||xyt()}function xyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tyt(e,t){if(e){if(typeof e=="string")return hie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hie(e,t)}}function hie(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Cyt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Ryt(e){if(Array.isArray(e))return e}function fie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function pie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fie(Object(n),!0).forEach(function(i){Nyt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Nyt(e,t,n){return t=Ayt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ayt(e){var t=Iyt(e,"string");return gw(t)=="symbol"?t:t+""}function Iyt(e,t){if(gw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(gw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mie=function(t,n,i,o,u){var h=i-o,p;return p="M ".concat(t,",").concat(n),p+="L ".concat(t+i,",").concat(n),p+="L ".concat(t+i-h/2,",").concat(n+u),p+="L ".concat(t+i-h/2-o,",").concat(n+u),p+="L ".concat(t,",").concat(n," Z"),p},Oyt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Pyt=function(t){var n=pie(pie({},Oyt),t),i=S.useRef(),o=S.useState(-1),u=Syt(o,2),h=u[0],p=u[1];S.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var P=i.current.getTotalLength();P&&p(P)}catch{}},[]);var g=n.x,v=n.y,b=n.upperWidth,E=n.lowerWidth,T=n.height,C=n.className,R=n.animationEasing,N=n.animationDuration,O=n.animationBegin,k=n.isUpdateAnimationActive;if(g!==+g||v!==+v||b!==+b||E!==+E||T!==+T||b===0&&E===0||T===0)return null;var j=er("recharts-trapezoid",C);return k?me.createElement(Rf,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:T,x:g,y:v},to:{upperWidth:b,lowerWidth:E,height:T,x:g,y:v},duration:N,animationEasing:R,isActive:k},function(P){var M=P.upperWidth,D=P.lowerWidth,U=P.height,V=P.x,z=P.y;return me.createElement(Rf,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:O,duration:N,easing:R},me.createElement("path",jA({},Tr(n,!0),{className:j,d:mie(V,z,M,D,U),ref:i})))}):me.createElement("g",null,me.createElement("path",jA({},Tr(n,!0),{className:j,d:mie(g,v,b,E,T)})))},kyt=["option","shapeType","propTransformer","activeClassName","isActive"];function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function jyt(e,t){if(e==null)return{};var n=Dyt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Dyt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function gie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function DA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gie(Object(n),!0).forEach(function(i){Lyt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Lyt(e,t,n){return t=Myt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Myt(e){var t=Uyt(e,"string");return vw(t)=="symbol"?t:t+""}function Uyt(e,t){if(vw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(vw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fyt(e,t){return DA(DA({},t),e)}function Vyt(e,t){return e==="symbols"}function vie(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return me.createElement($3,n);case"trapezoid":return me.createElement(Pyt,n);case"sector":return me.createElement(cve,n);case"symbols":if(Vyt(t))return me.createElement(a3,n);break;default:return null}}function Byt(e){return S.isValidElement(e)?e.props:e}function $yt(e){var t=e.option,n=e.shapeType,i=e.propTransformer,o=i===void 0?Fyt:i,u=e.activeClassName,h=u===void 0?"recharts-active-shape":u,p=e.isActive,g=jyt(e,kyt),v;if(S.isValidElement(t))v=S.cloneElement(t,DA(DA({},g),Byt(t)));else if(zn(t))v=t(g);else if(gyt(t)&&!wyt(t)){var b=o(t,g);v=me.createElement(vie,{shapeType:n,elementProps:b})}else{var E=g;v=me.createElement(vie,{shapeType:n,elementProps:E})}return p?me.createElement($a,{className:h},v):v}function nO(e,t){return t!=null&&"trapezoids"in e.props}function rO(e,t){return t!=null&&"sectors"in e.props}function yw(e,t){return t!=null&&"points"in e.props}function Wyt(e,t){var n,i,o=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,u=e.y===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.y)||e.y===t.y;return o&&u}function Gyt(e,t){var n=e.endAngle===t.endAngle,i=e.startAngle===t.startAngle;return n&&i}function Hyt(e,t){var n=e.x===t.x,i=e.y===t.y,o=e.z===t.z;return n&&i&&o}function zyt(e,t){var n;return nO(e,t)?n=Wyt:rO(e,t)?n=Gyt:yw(e,t)&&(n=Hyt),n}function Kyt(e,t){var n;return nO(e,t)?n="trapezoids":rO(e,t)?n="sectors":yw(e,t)&&(n="points"),n}function qyt(e,t){if(nO(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(rO(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return yw(e,t)?t.payload:{}}function Yyt(e){var t=e.activeTooltipItem,n=e.graphicalItem,i=e.itemData,o=Kyt(n,t),u=qyt(n,t),h=i.filter(function(g,v){var b=U3(u,g),E=n.props[o].filter(function(R){var N=zyt(n,t);return N(R,t)}),T=n.props[o].indexOf(E[E.length-1]),C=v===T;return b&&C}),p=i.indexOf(h[h.length-1]);return p}var Xyt=Math.ceil,Jyt=Math.max;function Zyt(e,t,n,i){for(var o=-1,u=Jyt(Xyt((t-e)/(n||1)),0),h=Array(u);u--;)h[i?u:++o]=e,e+=n;return h}var Qyt=Zyt,e_t=Jme,yie=1/0,t_t=17976931348623157e292;function n_t(e){if(!e)return e===0?e:0;if(e=e_t(e),e===yie||e===-yie){var t=e<0?-1:1;return t*t_t}return e===e?e:0}var Eve=n_t,r_t=Qyt,i_t=GI,qL=Eve;function a_t(e){return function(t,n,i){return i&&typeof i!="number"&&i_t(t,n,i)&&(n=i=void 0),t=qL(t),n===void 0?(n=t,t=0):n=qL(n),i=i===void 0?t<n?1:-1:qL(i),r_t(t,n,i,e)}}var s_t=a_t,o_t=s_t,c_t=o_t(),l_t=c_t;const LA=jr(l_t);function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function _ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function bie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_ie(Object(n),!0).forEach(function(i){wve(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_ie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function wve(e,t,n){return t=u_t(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u_t(e){var t=d_t(e,"string");return _w(t)=="symbol"?t:t+""}function d_t(e,t){if(_w(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(_w(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h_t=["Webkit","Moz","O","ms"],f_t=function(t,n){var i=t.replace(/(\w)/,function(u){return u.toUpperCase()}),o=h_t.reduce(function(u,h){return bie(bie({},u),{},wve({},h+i,n))},{});return o[t]=n,o};function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}function MA(){return MA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},MA.apply(this,arguments)}function Eie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function YL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Eie(Object(n),!0).forEach(function(i){Mo(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function p_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,xve(i.key),i)}}function m_t(e,t,n){return t&&wie(e.prototype,t),n&&wie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function g_t(e,t,n){return t=UA(t),v_t(e,Sve()?Reflect.construct(t,n||[],UA(e).constructor):t.apply(e,n))}function v_t(e,t){if(t&&(Oy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y_t(e)}function y_t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sve=function(){return!!e})()}function UA(e){return UA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},UA(e)}function __t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZF(e,t)}function ZF(e,t){return ZF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},ZF(e,t)}function Mo(e,t,n){return t=xve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xve(e){var t=b_t(e,"string");return Oy(t)=="symbol"?t:t+""}function b_t(e,t){if(Oy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Oy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var E_t=function(t){var n=t.data,i=t.startIndex,o=t.endIndex,u=t.x,h=t.width,p=t.travellerWidth;if(!n||!n.length)return{};var g=n.length,v=n0().domain(LA(0,g)).range([u,u+h-p]),b=v.domain().map(function(E){return v(E)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:v(i),endX:v(o),scale:v,scaleValues:b}},Sie=function(t){return t.changedTouches&&!!t.changedTouches.length},Py=function(e){function t(n){var i;return p_t(this,t),i=g_t(this,t,[n]),Mo(i,"handleDrag",function(o){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(o):i.state.isSlideMoving&&i.handleSlideDrag(o)}),Mo(i,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&i.handleDrag(o.changedTouches[0])}),Mo(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=i.props,u=o.endIndex,h=o.onDragEnd,p=o.startIndex;h==null||h({endIndex:u,startIndex:p})}),i.detachDragEndListener()}),Mo(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Mo(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Mo(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Mo(i,"handleSlideDragStart",function(o){var u=Sie(o)?o.changedTouches[0]:o;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:u.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return __t(t,e),m_t(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var o=i.startX,u=i.endX,h=this.state.scaleValues,p=this.props,g=p.gap,v=p.data,b=v.length-1,E=Math.min(o,u),T=Math.max(o,u),C=t.getIndexInRange(h,E),R=t.getIndexInRange(h,T);return{startIndex:C-C%g,endIndex:R===b?b:R-R%g}}},{key:"getTextOfTick",value:function(i){var o=this.props,u=o.data,h=o.tickFormatter,p=o.dataKey,g=Wu(u[i],p,i);return zn(h)?h(g,i):g}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var o=this.state,u=o.slideMoveStartX,h=o.startX,p=o.endX,g=this.props,v=g.x,b=g.width,E=g.travellerWidth,T=g.startIndex,C=g.endIndex,R=g.onChange,N=i.pageX-u;N>0?N=Math.min(N,v+b-E-p,v+b-E-h):N<0&&(N=Math.max(N,v-h,v-p));var O=this.getIndex({startX:h+N,endX:p+N});(O.startIndex!==T||O.endIndex!==C)&&R&&R(O),this.setState({startX:h+N,endX:p+N,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,o){var u=Sie(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:u.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var o=this.state,u=o.brushMoveStartX,h=o.movingTravellerId,p=o.endX,g=o.startX,v=this.state[h],b=this.props,E=b.x,T=b.width,C=b.travellerWidth,R=b.onChange,N=b.gap,O=b.data,k={startX:this.state.startX,endX:this.state.endX},j=i.pageX-u;j>0?j=Math.min(j,E+T-C-v):j<0&&(j=Math.max(j,E-v)),k[h]=v+j;var P=this.getIndex(k),M=P.startIndex,D=P.endIndex,U=function(){var z=O.length-1;return h==="startX"&&(p>g?M%N===0:D%N===0)||p<g&&D===z||h==="endX"&&(p>g?D%N===0:M%N===0)||p>g&&D===z};this.setState(Mo(Mo({},h,v+j),"brushMoveStartX",i.pageX),function(){R&&U()&&R(P)})}},{key:"handleTravellerMoveKeyboard",value:function(i,o){var u=this,h=this.state,p=h.scaleValues,g=h.startX,v=h.endX,b=this.state[o],E=p.indexOf(b);if(E!==-1){var T=E+i;if(!(T===-1||T>=p.length)){var C=p[T];o==="startX"&&C>=v||o==="endX"&&C<=g||this.setState(Mo({},o,C),function(){u.props.onChange(u.getIndex({startX:u.state.startX,endX:u.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,o=i.x,u=i.y,h=i.width,p=i.height,g=i.fill,v=i.stroke;return me.createElement("rect",{stroke:v,fill:g,x:o,y:u,width:h,height:p})}},{key:"renderPanorama",value:function(){var i=this.props,o=i.x,u=i.y,h=i.width,p=i.height,g=i.data,v=i.children,b=i.padding,E=S.Children.only(v);return E?me.cloneElement(E,{x:o,y:u,width:h,height:p,margin:b,compact:!0,data:g}):null}},{key:"renderTravellerLayer",value:function(i,o){var u,h,p=this,g=this.props,v=g.y,b=g.travellerWidth,E=g.height,T=g.traveller,C=g.ariaLabel,R=g.data,N=g.startIndex,O=g.endIndex,k=Math.max(i,this.props.x),j=YL(YL({},Tr(this.props,!1)),{},{x:k,y:v,width:b,height:E}),P=C||"Min value: ".concat((u=R[N])===null||u===void 0?void 0:u.name,", Max value: ").concat((h=R[O])===null||h===void 0?void 0:h.name);return me.createElement($a,{tabIndex:0,role:"slider","aria-label":P,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(D){["ArrowLeft","ArrowRight"].includes(D.key)&&(D.preventDefault(),D.stopPropagation(),p.handleTravellerMoveKeyboard(D.key==="ArrowRight"?1:-1,o))},onFocus:function(){p.setState({isTravellerFocused:!0})},onBlur:function(){p.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(T,j))}},{key:"renderSlide",value:function(i,o){var u=this.props,h=u.y,p=u.height,g=u.stroke,v=u.travellerWidth,b=Math.min(i,o)+v,E=Math.max(Math.abs(o-i)-v,0);return me.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:g,fillOpacity:.2,x:b,y:h,width:E,height:p})}},{key:"renderText",value:function(){var i=this.props,o=i.startIndex,u=i.endIndex,h=i.y,p=i.height,g=i.travellerWidth,v=i.stroke,b=this.state,E=b.startX,T=b.endX,C=5,R={pointerEvents:"none",fill:v};return me.createElement($a,{className:"recharts-brush-texts"},me.createElement(fA,MA({textAnchor:"end",verticalAnchor:"middle",x:Math.min(E,T)-C,y:h+p/2},R),this.getTextOfTick(o)),me.createElement(fA,MA({textAnchor:"start",verticalAnchor:"middle",x:Math.max(E,T)+g+C,y:h+p/2},R),this.getTextOfTick(u)))}},{key:"render",value:function(){var i=this.props,o=i.data,u=i.className,h=i.children,p=i.x,g=i.y,v=i.width,b=i.height,E=i.alwaysShowText,T=this.state,C=T.startX,R=T.endX,N=T.isTextActive,O=T.isSlideMoving,k=T.isTravellerMoving,j=T.isTravellerFocused;if(!o||!o.length||!xt(p)||!xt(g)||!xt(v)||!xt(b)||v<=0||b<=0)return null;var P=er("recharts-brush",u),M=me.Children.count(h)===1,D=f_t("userSelect","none");return me.createElement($a,{className:P,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:D},this.renderBackground(),M&&this.renderPanorama(),this.renderSlide(C,R),this.renderTravellerLayer(C,"startX"),this.renderTravellerLayer(R,"endX"),(N||O||k||j||E)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var o=i.x,u=i.y,h=i.width,p=i.height,g=i.stroke,v=Math.floor(u+p/2)-1;return me.createElement(me.Fragment,null,me.createElement("rect",{x:o,y:u,width:h,height:p,fill:g,stroke:"none"}),me.createElement("line",{x1:o+1,y1:v,x2:o+h-1,y2:v,fill:"none",stroke:"#fff"}),me.createElement("line",{x1:o+1,y1:v+2,x2:o+h-1,y2:v+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,o){var u;return me.isValidElement(i)?u=me.cloneElement(i,o):zn(i)?u=i(o):u=t.renderDefaultTraveller(o),u}},{key:"getDerivedStateFromProps",value:function(i,o){var u=i.data,h=i.width,p=i.x,g=i.travellerWidth,v=i.updateId,b=i.startIndex,E=i.endIndex;if(u!==o.prevData||v!==o.prevUpdateId)return YL({prevData:u,prevTravellerWidth:g,prevUpdateId:v,prevX:p,prevWidth:h},u&&u.length?E_t({data:u,width:h,x:p,travellerWidth:g,startIndex:b,endIndex:E}):{scale:null,scaleValues:null});if(o.scale&&(h!==o.prevWidth||p!==o.prevX||g!==o.prevTravellerWidth)){o.scale.range([p,p+h-g]);var T=o.scale.domain().map(function(C){return o.scale(C)});return{prevData:u,prevTravellerWidth:g,prevUpdateId:v,prevX:p,prevWidth:h,startX:o.scale(i.startIndex),endX:o.scale(i.endIndex),scaleValues:T}}return null}},{key:"getIndexInRange",value:function(i,o){for(var u=i.length,h=0,p=u-1;p-h>1;){var g=Math.floor((h+p)/2);i[g]>o?p=g:h=g}return o>=i[p]?p:h}}])}(S.PureComponent);Mo(Py,"displayName","Brush");Mo(Py,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var w_t=h3;function S_t(e,t){var n;return w_t(e,function(i,o,u){return n=t(i,o,u),!n}),!!n}var x_t=S_t,T_t=xme,C_t=Uf,R_t=x_t,N_t=_o,A_t=GI;function I_t(e,t,n){var i=N_t(e)?T_t:R_t;return n&&A_t(e,t,n)&&(t=void 0),i(e,C_t(t))}var O_t=I_t;const P_t=jr(O_t);var Uu=function(t,n){var i=t.alwaysShow,o=t.ifOverflow;return i&&(o="extendDomain"),o===n},xie=zme;function k_t(e,t,n){t=="__proto__"&&xie?xie(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var j_t=k_t,D_t=j_t,L_t=Gme,M_t=Uf;function U_t(e,t){var n={};return t=M_t(t),L_t(e,function(i,o,u){D_t(n,o,t(i,o,u))}),n}var F_t=U_t;const V_t=jr(F_t);function B_t(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}var $_t=B_t,W_t=h3;function G_t(e,t){var n=!0;return W_t(e,function(i,o,u){return n=!!t(i,o,u),n}),n}var H_t=G_t,z_t=$_t,K_t=H_t,q_t=Uf,Y_t=_o,X_t=GI;function J_t(e,t,n){var i=Y_t(e)?z_t:K_t;return n&&X_t(e,t,n)&&(t=void 0),i(e,q_t(t))}var Z_t=J_t;const Tve=jr(Z_t);var Q_t=["x","y"];function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function QF(){return QF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},QF.apply(this,arguments)}function Tie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function NE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tie(Object(n),!0).forEach(function(i){ebt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function ebt(e,t,n){return t=tbt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tbt(e){var t=nbt(e,"string");return bw(t)=="symbol"?t:t+""}function nbt(e,t){if(bw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(bw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rbt(e,t){if(e==null)return{};var n=ibt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function ibt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function abt(e,t){var n=e.x,i=e.y,o=rbt(e,Q_t),u="".concat(n),h=parseInt(u,10),p="".concat(i),g=parseInt(p,10),v="".concat(t.height||o.height),b=parseInt(v,10),E="".concat(t.width||o.width),T=parseInt(E,10);return NE(NE(NE(NE(NE({},t),o),h?{x:h}:{}),g?{y:g}:{}),{},{height:b,width:T,name:t.name,radius:t.radius})}function Cie(e){return me.createElement($yt,QF({shapeType:"rectangle",propTransformer:abt,activeClassName:"recharts-active-bar"},e))}var sbt=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,o){if(typeof t=="number")return t;var u=xt(i)||wQe(i);return u?t(i,o):(u||ym(),n)}},obt=["value","background"],Cve;function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function cbt(e,t){if(e==null)return{};var n=lbt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function lbt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function FA(){return FA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},FA.apply(this,arguments)}function Rie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rie(Object(n),!0).forEach(function(i){af(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function ubt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Nve(i.key),i)}}function dbt(e,t,n){return t&&Nie(e.prototype,t),n&&Nie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hbt(e,t,n){return t=VA(t),fbt(e,Rve()?Reflect.construct(t,n||[],VA(e).constructor):t.apply(e,n))}function fbt(e,t){if(t&&(ky(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pbt(e)}function pbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Rve=function(){return!!e})()}function VA(e){return VA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},VA(e)}function mbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eV(e,t)}function eV(e,t){return eV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},eV(e,t)}function af(e,t,n){return t=Nve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nve(e){var t=gbt(e,"string");return ky(t)=="symbol"?t:t+""}function gbt(e,t){if(ky(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(ky(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wo=function(e){function t(){var n;ubt(this,t);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return n=hbt(this,t,[].concat(o)),af(n,"state",{isAnimationFinished:!1}),af(n,"id",MI("recharts-bar-")),af(n,"handleAnimationEnd",function(){var h=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),h&&h()}),af(n,"handleAnimationStart",function(){var h=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),h&&h()}),n}return mbt(t,e),dbt(t,[{key:"renderRectanglesStatically",value:function(i){var o=this,u=this.props,h=u.shape,p=u.dataKey,g=u.activeIndex,v=u.activeBar,b=Tr(this.props,!1);return i&&i.map(function(E,T){var C=T===g,R=C?v:h,N=ua(ua(ua({},b),E),{},{isActive:C,option:R,index:T,dataKey:p,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return me.createElement($a,FA({className:"recharts-bar-rectangle"},QN(o.props,E,T),{key:"rectangle-".concat(E==null?void 0:E.x,"-").concat(E==null?void 0:E.y,"-").concat(E==null?void 0:E.value,"-").concat(T)}),me.createElement(Cie,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,o=this.props,u=o.data,h=o.layout,p=o.isAnimationActive,g=o.animationBegin,v=o.animationDuration,b=o.animationEasing,E=o.animationId,T=this.state.prevData;return me.createElement(Rf,{begin:g,duration:v,isActive:p,easing:b,from:{t:0},to:{t:1},key:"bar-".concat(E),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(C){var R=C.t,N=u.map(function(O,k){var j=T&&T[k];if(j){var P=uv(j.x,O.x),M=uv(j.y,O.y),D=uv(j.width,O.width),U=uv(j.height,O.height);return ua(ua({},O),{},{x:P(R),y:M(R),width:D(R),height:U(R)})}if(h==="horizontal"){var V=uv(0,O.height),z=V(R);return ua(ua({},O),{},{y:O.y+O.height-z,height:z})}var W=uv(0,O.width),Y=W(R);return ua(ua({},O),{},{width:Y})});return me.createElement($a,null,i.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var i=this.props,o=i.data,u=i.isAnimationActive,h=this.state.prevData;return u&&o&&o.length&&(!h||!U3(h,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var i=this,o=this.props,u=o.data,h=o.dataKey,p=o.activeIndex,g=Tr(this.props.background,!1);return u.map(function(v,b){v.value;var E=v.background,T=cbt(v,obt);if(!E)return null;var C=ua(ua(ua(ua(ua({},T),{},{fill:"#eee"},E),g),QN(i.props,v,b)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:h,index:b,className:"recharts-bar-background-rectangle"});return me.createElement(Cie,FA({key:"background-bar-".concat(b),option:i.props.background,isActive:b===p},C))})}},{key:"renderErrorBar",value:function(i,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,h=u.data,p=u.xAxis,g=u.yAxis,v=u.layout,b=u.children,E=Bl(b,tO);if(!E)return null;var T=v==="vertical"?h[0].height/2:h[0].width/2,C=function(O,k){var j=Array.isArray(O.value)?O.value[1]:O.value;return{x:O.x,y:O.y,value:j,errorVal:Wu(O,k)}},R={clipPath:i?"url(#clipPath-".concat(o,")"):null};return me.createElement($a,R,E.map(function(N){return me.cloneElement(N,{key:"error-bar-".concat(o,"-").concat(N.props.dataKey),data:h,xAxis:p,yAxis:g,layout:v,offset:T,dataPointFormatter:C})}))}},{key:"render",value:function(){var i=this.props,o=i.hide,u=i.data,h=i.className,p=i.xAxis,g=i.yAxis,v=i.left,b=i.top,E=i.width,T=i.height,C=i.isAnimationActive,R=i.background,N=i.id;if(o||!u||!u.length)return null;var O=this.state.isAnimationFinished,k=er("recharts-bar",h),j=p&&p.allowDataOverflow,P=g&&g.allowDataOverflow,M=j||P,D=Nr(N)?this.id:N;return me.createElement($a,{className:k},j||P?me.createElement("defs",null,me.createElement("clipPath",{id:"clipPath-".concat(D)},me.createElement("rect",{x:j?v:v-E/2,y:P?b:b-T/2,width:j?E:E*2,height:P?T:T*2}))):null,me.createElement($a,{className:"recharts-bar-rectangles",clipPath:M?"url(#clipPath-".concat(D,")"):null},R?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(M,D),(!C||O)&&tm.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(i,o){return i.animationId!==o.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:o.curData}:i.data!==o.curData?{curData:i.data}:null}}])}(S.PureComponent);Cve=Wo;af(Wo,"displayName","Bar");af(Wo,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!rS.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});af(Wo,"getComposedData",function(e){var t=e.props,n=e.item,i=e.barPosition,o=e.bandSize,u=e.xAxis,h=e.yAxis,p=e.xAxisTicks,g=e.yAxisTicks,v=e.stackedData,b=e.dataStartIndex,E=e.displayedData,T=e.offset,C=zpt(i,n);if(!C)return null;var R=t.layout,N=n.type.defaultProps,O=N!==void 0?ua(ua({},N),n.props):n.props,k=O.dataKey,j=O.children,P=O.minPointSize,M=R==="horizontal"?h:u,D=v?M.scale.domain():null,U=emt({numericAxis:M}),V=Bl(j,Qme),z=E.map(function(W,Y){var Q,K,q,ee,oe,ae;v?Q=Kpt(v[b+Y],D):(Q=Wu(W,k),Array.isArray(Q)||(Q=[U,Q]));var J=sbt(P,Cve.defaultProps.minPointSize)(Q[1],Y);if(R==="horizontal"){var re,X=[h.scale(Q[0]),h.scale(Q[1])],de=X[0],we=X[1];K=Cre({axis:u,ticks:p,bandSize:o,offset:C.offset,entry:W,index:Y}),q=(re=we??de)!==null&&re!==void 0?re:void 0,ee=C.size;var ge=de-we;if(oe=Number.isNaN(ge)?0:ge,ae={x:K,y:h.y,width:ee,height:h.height},Math.abs(J)>0&&Math.abs(oe)<Math.abs(J)){var Te=Ml(oe||J)*(Math.abs(J)-Math.abs(oe));q-=Te,oe+=Te}}else{var Pe=[u.scale(Q[0]),u.scale(Q[1])],rt=Pe[0],dt=Pe[1];if(K=rt,q=Cre({axis:h,ticks:g,bandSize:o,offset:C.offset,entry:W,index:Y}),ee=dt-rt,oe=C.size,ae={x:u.x,y:q,width:u.width,height:oe},Math.abs(J)>0&&Math.abs(ee)<Math.abs(J)){var ze=Ml(ee||J)*(Math.abs(J)-Math.abs(ee));ee+=ze}}return ua(ua(ua({},W),{},{x:K,y:q,width:ee,height:oe,value:v?Q:Q[1],payload:W,background:ae},V&&V[Y]&&V[Y].props),{},{tooltipPayload:[ave(n,W)],tooltipPosition:{x:K+ee/2,y:q+oe/2}})});return ua({data:z,layout:R},T)});function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function vbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ave(i.key),i)}}function ybt(e,t,n){return t&&Aie(e.prototype,t),n&&Aie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Pl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iie(Object(n),!0).forEach(function(i){iO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function iO(e,t,n){return t=Ave(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ave(e){var t=_bt(e,"string");return Ew(t)=="symbol"?t:t+""}function _bt(e,t){if(Ew(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ew(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bbt=function(t,n,i,o,u){var h=t.width,p=t.height,g=t.layout,v=t.children,b=Object.keys(n),E={left:i.left,leftMirror:i.left,right:h-i.right,rightMirror:h-i.right,top:i.top,topMirror:i.top,bottom:p-i.bottom,bottomMirror:p-i.bottom},T=!!Fo(v,Wo);return b.reduce(function(C,R){var N=n[R],O=N.orientation,k=N.domain,j=N.padding,P=j===void 0?{}:j,M=N.mirror,D=N.reversed,U="".concat(O).concat(M?"Mirror":""),V,z,W,Y,Q;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var K=k[1]-k[0],q=1/0,ee=N.categoricalDomain.sort(TQe);if(ee.forEach(function(Pe,rt){rt>0&&(q=Math.min((Pe||0)-(ee[rt-1]||0),q))}),Number.isFinite(q)){var oe=q/K,ae=N.layout==="vertical"?i.height:i.width;if(N.padding==="gap"&&(V=oe*ae/2),N.padding==="no-gap"){var J=gm(t.barCategoryGap,oe*ae),re=oe*ae/2;V=re-J-(re-J)/ae*J}}}o==="xAxis"?z=[i.left+(P.left||0)+(V||0),i.left+i.width-(P.right||0)-(V||0)]:o==="yAxis"?z=g==="horizontal"?[i.top+i.height-(P.bottom||0),i.top+(P.top||0)]:[i.top+(P.top||0)+(V||0),i.top+i.height-(P.bottom||0)-(V||0)]:z=N.range,D&&(z=[z[1],z[0]]);var X=Gpt(N,u,T),de=X.scale,we=X.realScaleType;de.domain(k).range(z),Hpt(de);var ge=Qpt(de,Pl(Pl({},N),{},{realScaleType:we}));o==="xAxis"?(Q=O==="top"&&!M||O==="bottom"&&M,W=i.left,Y=E[U]-Q*N.height):o==="yAxis"&&(Q=O==="left"&&!M||O==="right"&&M,W=E[U]-Q*N.width,Y=i.top);var Te=Pl(Pl(Pl({},N),ge),{},{realScaleType:we,x:W,y:Y,scale:de,width:o==="xAxis"?i.width:N.width,height:o==="yAxis"?i.height:N.height});return Te.bandSize=RA(Te,ge),!N.hide&&o==="xAxis"?E[U]+=(Q?-1:1)*Te.height:N.hide||(E[U]+=(Q?-1:1)*Te.width),Pl(Pl({},C),{},iO({},R,Te))},{})},Ive=function(t,n){var i=t.x,o=t.y,u=n.x,h=n.y;return{x:Math.min(i,u),y:Math.min(o,h),width:Math.abs(u-i),height:Math.abs(h-o)}},Ebt=function(t){var n=t.x1,i=t.y1,o=t.x2,u=t.y2;return Ive({x:n,y:i},{x:o,y:u})},Ove=function(){function e(t){vbt(this,e),this.scale=t}return ybt(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,u=i.position;if(n!==void 0){if(u)switch(u){case"start":return this.scale(n);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+h}case"end":{var p=this.bandwidth?this.bandwidth():0;return this.scale(n)+p}default:return this.scale(n)}if(o){var g=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+g}return this.scale(n)}}},{key:"isInRange",value:function(n){var i=this.range(),o=i[0],u=i[i.length-1];return o<=u?n>=o&&n<=u:n>=u&&n<=o}}],[{key:"create",value:function(n){return new e(n)}}])}();iO(Ove,"EPS",1e-4);var W3=function(t){var n=Object.keys(t).reduce(function(i,o){return Pl(Pl({},i),{},iO({},o,Ove.create(t[o])))},{});return Pl(Pl({},n),{},{apply:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=u.bandAware,p=u.position;return V_t(o,function(g,v){return n[v].apply(g,{bandAware:h,position:p})})},isInRange:function(o){return Tve(o,function(u,h){return n[h].isInRange(u)})}})};function wbt(e){return(e%180+180)%180}var Sbt=function(t){var n=t.width,i=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=wbt(o),h=u*Math.PI/180,p=Math.atan(i/n),g=h>p&&h<Math.PI-p?i/Math.sin(h):n/Math.cos(h);return Math.abs(g)},xbt=Uf,Tbt=nS,Cbt=$I;function Rbt(e){return function(t,n,i){var o=Object(t);if(!Tbt(t)){var u=xbt(n);t=Cbt(t),n=function(p){return u(o[p],p,o)}}var h=e(t,n,i);return h>-1?o[u?t[h]:h]:void 0}}var Nbt=Rbt,Abt=Eve;function Ibt(e){var t=Abt(e),n=t%1;return t===t?n?t-n:t:0}var Obt=Ibt,Pbt=Ume,kbt=Uf,jbt=Obt,Dbt=Math.max;function Lbt(e,t,n){var i=e==null?0:e.length;if(!i)return-1;var o=n==null?0:jbt(n);return o<0&&(o=Dbt(i+o,0)),Pbt(e,kbt(t),o)}var Mbt=Lbt,Ubt=Nbt,Fbt=Mbt,Vbt=Ubt(Fbt),Bbt=Vbt;const $bt=jr(Bbt);var Wbt=NZe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),G3=S.createContext(void 0),H3=S.createContext(void 0),Pve=S.createContext(void 0),kve=S.createContext({}),jve=S.createContext(void 0),Dve=S.createContext(0),Lve=S.createContext(0),Oie=function(t){var n=t.state,i=n.xAxisMap,o=n.yAxisMap,u=n.offset,h=t.clipPathId,p=t.children,g=t.width,v=t.height,b=Wbt(u);return me.createElement(G3.Provider,{value:i},me.createElement(H3.Provider,{value:o},me.createElement(kve.Provider,{value:u},me.createElement(Pve.Provider,{value:b},me.createElement(jve.Provider,{value:h},me.createElement(Dve.Provider,{value:v},me.createElement(Lve.Provider,{value:g},p)))))))},Gbt=function(){return S.useContext(jve)},Mve=function(t){var n=S.useContext(G3);n==null&&ym();var i=n[t];return i==null&&ym(),i},Hbt=function(){var t=S.useContext(G3);return zh(t)},zbt=function(){var t=S.useContext(H3),n=$bt(t,function(i){return Tve(i.domain,Number.isFinite)});return n||zh(t)},Uve=function(t){var n=S.useContext(H3);n==null&&ym();var i=n[t];return i==null&&ym(),i},Kbt=function(){var t=S.useContext(Pve);return t},qbt=function(){return S.useContext(kve)},z3=function(){return S.useContext(Lve)},K3=function(){return S.useContext(Dve)};function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function Ybt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xbt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Vve(i.key),i)}}function Jbt(e,t,n){return t&&Xbt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zbt(e,t,n){return t=BA(t),Qbt(e,Fve()?Reflect.construct(t,n||[],BA(e).constructor):t.apply(e,n))}function Qbt(e,t){if(t&&(jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eEt(e)}function eEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fve=function(){return!!e})()}function BA(e){return BA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},BA(e)}function tEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tV(e,t)}function tV(e,t){return tV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},tV(e,t)}function Pie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function kie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pie(Object(n),!0).forEach(function(i){q3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function q3(e,t,n){return t=Vve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vve(e){var t=nEt(e,"string");return jy(t)=="symbol"?t:t+""}function nEt(e,t){if(jy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(jy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function rEt(e,t){return oEt(e)||sEt(e,t)||aEt(e,t)||iEt()}function iEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aEt(e,t){if(e){if(typeof e=="string")return jie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jie(e,t)}}function jie(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function sEt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function oEt(e){if(Array.isArray(e))return e}function nV(){return nV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nV.apply(this,arguments)}var cEt=function(t,n){var i;return me.isValidElement(t)?i=me.cloneElement(t,n):zn(t)?i=t(n):i=me.createElement("line",nV({},n,{className:"recharts-reference-line-line"})),i},lEt=function(t,n,i,o,u,h,p,g,v){var b=u.x,E=u.y,T=u.width,C=u.height;if(i){var R=v.y,N=t.y.apply(R,{position:h});if(Uu(v,"discard")&&!t.y.isInRange(N))return null;var O=[{x:b+T,y:N},{x:b,y:N}];return g==="left"?O.reverse():O}if(n){var k=v.x,j=t.x.apply(k,{position:h});if(Uu(v,"discard")&&!t.x.isInRange(j))return null;var P=[{x:j,y:E+C},{x:j,y:E}];return p==="top"?P.reverse():P}if(o){var M=v.segment,D=M.map(function(U){return t.apply(U,{position:h})});return Uu(v,"discard")&&P_t(D,function(U){return!t.isInRange(U)})?null:D}return null};function uEt(e){var t=e.x,n=e.y,i=e.segment,o=e.xAxisId,u=e.yAxisId,h=e.shape,p=e.className,g=e.alwaysShow,v=Gbt(),b=Mve(o),E=Uve(u),T=Kbt();if(!v||!T)return null;kd(g===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=W3({x:b.scale,y:E.scale}),R=Oa(t),N=Oa(n),O=i&&i.length===2,k=lEt(C,R,N,O,T,e.position,b.orientation,E.orientation,e);if(!k)return null;var j=rEt(k,2),P=j[0],M=P.x,D=P.y,U=j[1],V=U.x,z=U.y,W=Uu(e,"hidden")?"url(#".concat(v,")"):void 0,Y=kie(kie({clipPath:W},Tr(e,!0)),{},{x1:M,y1:D,x2:V,y2:z});return me.createElement($a,{className:er("recharts-reference-line",p)},cEt(h,Y),bs.renderCallByParent(e,Ebt({x1:M,y1:D,x2:V,y2:z})))}var Y3=function(e){function t(){return Ybt(this,t),Zbt(this,t,arguments)}return tEt(t,e),Jbt(t,[{key:"render",value:function(){return me.createElement(uEt,this.props)}}])}(me.Component);q3(Y3,"displayName","ReferenceLine");q3(Y3,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function rV(){return rV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},rV.apply(this,arguments)}function Dy(e){"@babel/helpers - typeof";return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dy(e)}function Die(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Lie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Die(Object(n),!0).forEach(function(i){aO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Die(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function dEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hEt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,$ve(i.key),i)}}function fEt(e,t,n){return t&&hEt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pEt(e,t,n){return t=$A(t),mEt(e,Bve()?Reflect.construct(t,n||[],$A(e).constructor):t.apply(e,n))}function mEt(e,t){if(t&&(Dy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gEt(e)}function gEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bve=function(){return!!e})()}function $A(e){return $A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},$A(e)}function vEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iV(e,t)}function iV(e,t){return iV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},iV(e,t)}function aO(e,t,n){return t=$ve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $ve(e){var t=yEt(e,"string");return Dy(t)=="symbol"?t:t+""}function yEt(e,t){if(Dy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Dy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _Et=function(t){var n=t.x,i=t.y,o=t.xAxis,u=t.yAxis,h=W3({x:o.scale,y:u.scale}),p=h.apply({x:n,y:i},{bandAware:!0});return Uu(t,"discard")&&!h.isInRange(p)?null:p},sO=function(e){function t(){return dEt(this,t),pEt(this,t,arguments)}return vEt(t,e),fEt(t,[{key:"render",value:function(){var i=this.props,o=i.x,u=i.y,h=i.r,p=i.alwaysShow,g=i.clipPathId,v=Oa(o),b=Oa(u);if(kd(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!v||!b)return null;var E=_Et(this.props);if(!E)return null;var T=E.x,C=E.y,R=this.props,N=R.shape,O=R.className,k=Uu(this.props,"hidden")?"url(#".concat(g,")"):void 0,j=Lie(Lie({clipPath:k},Tr(this.props,!0)),{},{cx:T,cy:C});return me.createElement($a,{className:er("recharts-reference-dot",O)},t.renderDot(N,j),bs.renderCallByParent(this.props,{x:T-h,y:C-h,width:2*h,height:2*h}))}}])}(me.Component);aO(sO,"displayName","ReferenceDot");aO(sO,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});aO(sO,"renderDot",function(e,t){var n;return me.isValidElement(e)?n=me.cloneElement(e,t):zn(e)?n=e(t):n=me.createElement(_ve,rV({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function aV(){return aV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},aV.apply(this,arguments)}function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ly(e)}function Mie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Uie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mie(Object(n),!0).forEach(function(i){oO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function bEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EEt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Gve(i.key),i)}}function wEt(e,t,n){return t&&EEt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function SEt(e,t,n){return t=WA(t),xEt(e,Wve()?Reflect.construct(t,n||[],WA(e).constructor):t.apply(e,n))}function xEt(e,t){if(t&&(Ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TEt(e)}function TEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wve=function(){return!!e})()}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},WA(e)}function CEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sV(e,t)}function sV(e,t){return sV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},sV(e,t)}function oO(e,t,n){return t=Gve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gve(e){var t=REt(e,"string");return Ly(t)=="symbol"?t:t+""}function REt(e,t){if(Ly(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ly(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var NEt=function(t,n,i,o,u){var h=u.x1,p=u.x2,g=u.y1,v=u.y2,b=u.xAxis,E=u.yAxis;if(!b||!E)return null;var T=W3({x:b.scale,y:E.scale}),C={x:t?T.x.apply(h,{position:"start"}):T.x.rangeMin,y:i?T.y.apply(g,{position:"start"}):T.y.rangeMin},R={x:n?T.x.apply(p,{position:"end"}):T.x.rangeMax,y:o?T.y.apply(v,{position:"end"}):T.y.rangeMax};return Uu(u,"discard")&&(!T.isInRange(C)||!T.isInRange(R))?null:Ive(C,R)},cO=function(e){function t(){return bEt(this,t),SEt(this,t,arguments)}return CEt(t,e),wEt(t,[{key:"render",value:function(){var i=this.props,o=i.x1,u=i.x2,h=i.y1,p=i.y2,g=i.className,v=i.alwaysShow,b=i.clipPathId;kd(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var E=Oa(o),T=Oa(u),C=Oa(h),R=Oa(p),N=this.props.shape;if(!E&&!T&&!C&&!R&&!N)return null;var O=NEt(E,T,C,R,this.props);if(!O&&!N)return null;var k=Uu(this.props,"hidden")?"url(#".concat(b,")"):void 0;return me.createElement($a,{className:er("recharts-reference-area",g)},t.renderRect(N,Uie(Uie({clipPath:k},Tr(this.props,!0)),O)),bs.renderCallByParent(this.props,O))}}])}(me.Component);oO(cO,"displayName","ReferenceArea");oO(cO,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});oO(cO,"renderRect",function(e,t){var n;return me.isValidElement(e)?n=me.cloneElement(e,t):zn(e)?n=e(t):n=me.createElement($3,aV({},t,{className:"recharts-reference-area-rect"})),n});function Hve(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var i=[],o=0;o<e.length;o+=t)i.push(e[o]);return i}function AEt(e,t,n){var i={width:e.width+t.width,height:e.height+t.height};return Sbt(i,n)}function IEt(e,t,n){var i=n==="width",o=e.x,u=e.y,h=e.width,p=e.height;return t===1?{start:i?o:u,end:i?o+h:u+p}:{start:i?o+h:u+p,end:i?o:u}}function GA(e,t,n,i,o){if(e*t<e*i||e*t>e*o)return!1;var u=n();return e*(t-e*u/2-i)>=0&&e*(t+e*u/2-o)<=0}function OEt(e,t){return Hve(e,t+1)}function PEt(e,t,n,i,o){for(var u=(i||[]).slice(),h=t.start,p=t.end,g=0,v=1,b=h,E=function(){var R=i==null?void 0:i[g];if(R===void 0)return{v:Hve(i,v)};var N=g,O,k=function(){return O===void 0&&(O=n(R,N)),O},j=R.coordinate,P=g===0||GA(e,j,k,b,p);P||(g=0,b=h,v+=1),P&&(b=j+e*(k()/2+o),g+=v)},T;v<=u.length;)if(T=E(),T)return T.v;return[]}function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function Fie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fie(Object(n),!0).forEach(function(i){kEt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function kEt(e,t,n){return t=jEt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jEt(e){var t=DEt(e,"string");return ww(t)=="symbol"?t:t+""}function DEt(e,t){if(ww(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(ww(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LEt(e,t,n,i,o){for(var u=(i||[]).slice(),h=u.length,p=t.start,g=t.end,v=function(T){var C=u[T],R,N=function(){return R===void 0&&(R=n(C,T)),R};if(T===h-1){var O=e*(C.coordinate+e*N()/2-g);u[T]=C=ys(ys({},C),{},{tickCoord:O>0?C.coordinate-O*e:C.coordinate})}else u[T]=C=ys(ys({},C),{},{tickCoord:C.coordinate});var k=GA(e,C.tickCoord,N,p,g);k&&(g=C.tickCoord-e*(N()/2+o),u[T]=ys(ys({},C),{},{isShow:!0}))},b=h-1;b>=0;b--)v(b);return u}function MEt(e,t,n,i,o,u){var h=(i||[]).slice(),p=h.length,g=t.start,v=t.end;if(u){var b=i[p-1],E=n(b,p-1),T=e*(b.coordinate+e*E/2-v);h[p-1]=b=ys(ys({},b),{},{tickCoord:T>0?b.coordinate-T*e:b.coordinate});var C=GA(e,b.tickCoord,function(){return E},g,v);C&&(v=b.tickCoord-e*(E/2+o),h[p-1]=ys(ys({},b),{},{isShow:!0}))}for(var R=u?p-1:p,N=function(j){var P=h[j],M,D=function(){return M===void 0&&(M=n(P,j)),M};if(j===0){var U=e*(P.coordinate-e*D()/2-g);h[j]=P=ys(ys({},P),{},{tickCoord:U<0?P.coordinate-U*e:P.coordinate})}else h[j]=P=ys(ys({},P),{},{tickCoord:P.coordinate});var V=GA(e,P.tickCoord,D,g,v);V&&(g=P.tickCoord+e*(D()/2+o),h[j]=ys(ys({},P),{},{isShow:!0}))},O=0;O<R;O++)N(O);return h}function X3(e,t,n){var i=e.tick,o=e.ticks,u=e.viewBox,h=e.minTickGap,p=e.orientation,g=e.interval,v=e.tickFormatter,b=e.unit,E=e.angle;if(!o||!o.length||!i)return[];if(xt(g)||rS.isSsr)return OEt(o,typeof g=="number"&&xt(g)?g:0);var T=[],C=p==="top"||p==="bottom"?"width":"height",R=b&&C==="width"?t0(b,{fontSize:t,letterSpacing:n}):{width:0,height:0},N=function(P,M){var D=zn(v)?v(P.value,M):P.value;return C==="width"?AEt(t0(D,{fontSize:t,letterSpacing:n}),R,E):t0(D,{fontSize:t,letterSpacing:n})[C]},O=o.length>=2?Ml(o[1].coordinate-o[0].coordinate):1,k=IEt(u,O,C);return g==="equidistantPreserveStart"?PEt(O,k,N,o,h):(g==="preserveStart"||g==="preserveStartEnd"?T=MEt(O,k,N,o,h,g==="preserveStartEnd"):T=LEt(O,k,N,o,h),T.filter(function(j){return j.isShow}))}var UEt=["viewBox"],FEt=["viewBox"],VEt=["ticks"];function My(e){"@babel/helpers - typeof";return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},My(e)}function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Iv.apply(this,arguments)}function Vie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ta(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vie(Object(n),!0).forEach(function(i){J3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function XL(e,t){if(e==null)return{};var n=BEt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function BEt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function $Et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Kve(i.key),i)}}function WEt(e,t,n){return t&&Bie(e.prototype,t),n&&Bie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function GEt(e,t,n){return t=HA(t),HEt(e,zve()?Reflect.construct(t,n||[],HA(e).constructor):t.apply(e,n))}function HEt(e,t){if(t&&(My(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zEt(e)}function zEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zve=function(){return!!e})()}function HA(e){return HA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HA(e)}function KEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oV(e,t)}function oV(e,t){return oV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},oV(e,t)}function J3(e,t,n){return t=Kve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kve(e){var t=qEt(e,"string");return My(t)=="symbol"?t:t+""}function qEt(e,t){if(My(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(My(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var b_=function(e){function t(n){var i;return $Et(this,t),i=GEt(this,t,[n]),i.state={fontSize:"",letterSpacing:""},i}return KEt(t,e),WEt(t,[{key:"shouldComponentUpdate",value:function(i,o){var u=i.viewBox,h=XL(i,UEt),p=this.props,g=p.viewBox,v=XL(p,FEt);return!Wv(u,g)||!Wv(h,v)||!Wv(o,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var o=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var o=this.props,u=o.x,h=o.y,p=o.width,g=o.height,v=o.orientation,b=o.tickSize,E=o.mirror,T=o.tickMargin,C,R,N,O,k,j,P=E?-1:1,M=i.tickSize||b,D=xt(i.tickCoord)?i.tickCoord:i.coordinate;switch(v){case"top":C=R=i.coordinate,O=h+ +!E*g,N=O-P*M,j=N-P*T,k=D;break;case"left":N=O=i.coordinate,R=u+ +!E*p,C=R-P*M,k=C-P*T,j=D;break;case"right":N=O=i.coordinate,R=u+ +E*p,C=R+P*M,k=C+P*T,j=D;break;default:C=R=i.coordinate,O=h+ +E*g,N=O+P*M,j=N+P*T,k=D;break}return{line:{x1:C,y1:N,x2:R,y2:O},tick:{x:k,y:j}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,o=i.orientation,u=i.mirror,h;switch(o){case"left":h=u?"start":"end";break;case"right":h=u?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,o=i.orientation,u=i.mirror,h="end";switch(o){case"left":case"right":h="middle";break;case"top":h=u?"start":"end";break;default:h=u?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var i=this.props,o=i.x,u=i.y,h=i.width,p=i.height,g=i.orientation,v=i.mirror,b=i.axisLine,E=Ta(Ta(Ta({},Tr(this.props,!1)),Tr(b,!1)),{},{fill:"none"});if(g==="top"||g==="bottom"){var T=+(g==="top"&&!v||g==="bottom"&&v);E=Ta(Ta({},E),{},{x1:o,y1:u+T*p,x2:o+h,y2:u+T*p})}else{var C=+(g==="left"&&!v||g==="right"&&v);E=Ta(Ta({},E),{},{x1:o+C*h,y1:u,x2:o+C*h,y2:u+p})}return me.createElement("line",Iv({},E,{className:er("recharts-cartesian-axis-line",Vc(b,"className"))}))}},{key:"renderTicks",value:function(i,o,u){var h=this,p=this.props,g=p.tickLine,v=p.stroke,b=p.tick,E=p.tickFormatter,T=p.unit,C=X3(Ta(Ta({},this.props),{},{ticks:i}),o,u),R=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),O=Tr(this.props,!1),k=Tr(b,!1),j=Ta(Ta({},O),{},{fill:"none"},Tr(g,!1)),P=C.map(function(M,D){var U=h.getTickLineCoord(M),V=U.line,z=U.tick,W=Ta(Ta(Ta(Ta({textAnchor:R,verticalAnchor:N},O),{},{stroke:"none",fill:v},k),z),{},{index:D,payload:M,visibleTicksCount:C.length,tickFormatter:E});return me.createElement($a,Iv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(M.value,"-").concat(M.coordinate,"-").concat(M.tickCoord)},QN(h.props,M,D)),g&&me.createElement("line",Iv({},j,V,{className:er("recharts-cartesian-axis-tick-line",Vc(g,"className"))})),b&&t.renderTickItem(b,W,"".concat(zn(E)?E(M.value,D):M.value).concat(T||"")))});return me.createElement("g",{className:"recharts-cartesian-axis-ticks"},P)}},{key:"render",value:function(){var i=this,o=this.props,u=o.axisLine,h=o.width,p=o.height,g=o.ticksGenerator,v=o.className,b=o.hide;if(b)return null;var E=this.props,T=E.ticks,C=XL(E,VEt),R=T;return zn(g)&&(R=T&&T.length>0?g(this.props):g(C)),h<=0||p<=0||!R||!R.length?null:me.createElement($a,{className:er("recharts-cartesian-axis",v),ref:function(O){i.layerReference=O}},u&&this.renderAxisLine(),this.renderTicks(R,this.state.fontSize,this.state.letterSpacing),bs.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,o,u){var h,p=er(o.className,"recharts-cartesian-axis-tick-value");return me.isValidElement(i)?h=me.cloneElement(i,Ta(Ta({},o),{},{className:p})):zn(i)?h=i(Ta(Ta({},o),{},{className:p})):h=me.createElement(fA,Iv({},o,{className:"recharts-cartesian-axis-tick-value"}),u),h}}])}(S.Component);J3(b_,"displayName","CartesianAxis");J3(b_,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var YEt=["x1","y1","x2","y2","key"],XEt=["offset"];function _m(e){"@babel/helpers - typeof";return _m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_m(e)}function $ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Es(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$ie(Object(n),!0).forEach(function(i){JEt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$ie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function JEt(e,t,n){return t=ZEt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZEt(e){var t=QEt(e,"string");return _m(t)=="symbol"?t:t+""}function QEt(e,t){if(_m(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(_m(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Gp.apply(this,arguments)}function Wie(e,t){if(e==null)return{};var n=e0t(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function e0t(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var t0t=function(t){var n=t.fill;if(!n||n==="none")return null;var i=t.fillOpacity,o=t.x,u=t.y,h=t.width,p=t.height,g=t.ry;return me.createElement("rect",{x:o,y:u,ry:g,width:h,height:p,stroke:"none",fill:n,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function qve(e,t){var n;if(me.isValidElement(e))n=me.cloneElement(e,t);else if(zn(e))n=e(t);else{var i=t.x1,o=t.y1,u=t.x2,h=t.y2,p=t.key,g=Wie(t,YEt),v=Tr(g,!1);v.offset;var b=Wie(v,XEt);n=me.createElement("line",Gp({},b,{x1:i,y1:o,x2:u,y2:h,fill:"none",key:p}))}return n}function n0t(e){var t=e.x,n=e.width,i=e.horizontal,o=i===void 0?!0:i,u=e.horizontalPoints;if(!o||!u||!u.length)return null;var h=u.map(function(p,g){var v=Es(Es({},e),{},{x1:t,y1:p,x2:t+n,y2:p,key:"line-".concat(g),index:g});return qve(o,v)});return me.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function r0t(e){var t=e.y,n=e.height,i=e.vertical,o=i===void 0?!0:i,u=e.verticalPoints;if(!o||!u||!u.length)return null;var h=u.map(function(p,g){var v=Es(Es({},e),{},{x1:p,y1:t,x2:p,y2:t+n,key:"line-".concat(g),index:g});return qve(o,v)});return me.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function i0t(e){var t=e.horizontalFill,n=e.fillOpacity,i=e.x,o=e.y,u=e.width,h=e.height,p=e.horizontalPoints,g=e.horizontal,v=g===void 0?!0:g;if(!v||!t||!t.length)return null;var b=p.map(function(T){return Math.round(T+o-o)}).sort(function(T,C){return T-C});o!==b[0]&&b.unshift(0);var E=b.map(function(T,C){var R=!b[C+1],N=R?o+h-T:b[C+1]-T;if(N<=0)return null;var O=C%t.length;return me.createElement("rect",{key:"react-".concat(C),y:T,x:i,height:N,width:u,stroke:"none",fill:t[O],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},E)}function a0t(e){var t=e.vertical,n=t===void 0?!0:t,i=e.verticalFill,o=e.fillOpacity,u=e.x,h=e.y,p=e.width,g=e.height,v=e.verticalPoints;if(!n||!i||!i.length)return null;var b=v.map(function(T){return Math.round(T+u-u)}).sort(function(T,C){return T-C});u!==b[0]&&b.unshift(0);var E=b.map(function(T,C){var R=!b[C+1],N=R?u+p-T:b[C+1]-T;if(N<=0)return null;var O=C%i.length;return me.createElement("rect",{key:"react-".concat(C),x:T,y:h,width:N,height:g,stroke:"none",fill:i[O],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},E)}var s0t=function(t,n){var i=t.xAxis,o=t.width,u=t.height,h=t.offset;return rve(X3(Es(Es(Es({},b_.defaultProps),i),{},{ticks:Nd(i,!0),viewBox:{x:0,y:0,width:o,height:u}})),h.left,h.left+h.width,n)},o0t=function(t,n){var i=t.yAxis,o=t.width,u=t.height,h=t.offset;return rve(X3(Es(Es(Es({},b_.defaultProps),i),{},{ticks:Nd(i,!0),viewBox:{x:0,y:0,width:o,height:u}})),h.top,h.top+h.height,n)},fv={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function lO(e){var t,n,i,o,u,h,p=z3(),g=K3(),v=qbt(),b=Es(Es({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:fv.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:fv.fill,horizontal:(i=e.horizontal)!==null&&i!==void 0?i:fv.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:fv.horizontalFill,vertical:(u=e.vertical)!==null&&u!==void 0?u:fv.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:fv.verticalFill,x:xt(e.x)?e.x:v.left,y:xt(e.y)?e.y:v.top,width:xt(e.width)?e.width:v.width,height:xt(e.height)?e.height:v.height}),E=b.x,T=b.y,C=b.width,R=b.height,N=b.syncWithTicks,O=b.horizontalValues,k=b.verticalValues,j=Hbt(),P=zbt();if(!xt(C)||C<=0||!xt(R)||R<=0||!xt(E)||E!==+E||!xt(T)||T!==+T)return null;var M=b.verticalCoordinatesGenerator||s0t,D=b.horizontalCoordinatesGenerator||o0t,U=b.horizontalPoints,V=b.verticalPoints;if((!U||!U.length)&&zn(D)){var z=O&&O.length,W=D({yAxis:P?Es(Es({},P),{},{ticks:z?O:P.ticks}):void 0,width:p,height:g,offset:v},z?!0:N);kd(Array.isArray(W),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(_m(W),"]")),Array.isArray(W)&&(U=W)}if((!V||!V.length)&&zn(M)){var Y=k&&k.length,Q=M({xAxis:j?Es(Es({},j),{},{ticks:Y?k:j.ticks}):void 0,width:p,height:g,offset:v},Y?!0:N);kd(Array.isArray(Q),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(_m(Q),"]")),Array.isArray(Q)&&(V=Q)}return me.createElement("g",{className:"recharts-cartesian-grid"},me.createElement(t0t,{fill:b.fill,fillOpacity:b.fillOpacity,x:b.x,y:b.y,width:b.width,height:b.height,ry:b.ry}),me.createElement(n0t,Gp({},b,{offset:v,horizontalPoints:U,xAxis:j,yAxis:P})),me.createElement(r0t,Gp({},b,{offset:v,verticalPoints:V,xAxis:j,yAxis:P})),me.createElement(i0t,Gp({},b,{horizontalPoints:U})),me.createElement(a0t,Gp({},b,{verticalPoints:V})))}lO.displayName="CartesianGrid";function Uy(e){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}function c0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Jve(i.key),i)}}function u0t(e,t,n){return t&&l0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function d0t(e,t,n){return t=zA(t),h0t(e,Yve()?Reflect.construct(t,n||[],zA(e).constructor):t.apply(e,n))}function h0t(e,t){if(t&&(Uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f0t(e)}function f0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yve=function(){return!!e})()}function zA(e){return zA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zA(e)}function p0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cV(e,t)}function cV(e,t){return cV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},cV(e,t)}function Xve(e,t,n){return t=Jve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jve(e){var t=m0t(e,"string");return Uy(t)=="symbol"?t:t+""}function m0t(e,t){if(Uy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Uy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function lV(){return lV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},lV.apply(this,arguments)}function g0t(e){var t=e.xAxisId,n=z3(),i=K3(),o=Mve(t);return o==null?null:S.createElement(b_,lV({},o,{className:er("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(h){return Nd(h,!0)}}))}var E_=function(e){function t(){return c0t(this,t),d0t(this,t,arguments)}return p0t(t,e),u0t(t,[{key:"render",value:function(){return S.createElement(g0t,this.props)}}])}(S.Component);Xve(E_,"displayName","XAxis");Xve(E_,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Fy(e){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function v0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,eye(i.key),i)}}function _0t(e,t,n){return t&&y0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function b0t(e,t,n){return t=KA(t),E0t(e,Zve()?Reflect.construct(t,n||[],KA(e).constructor):t.apply(e,n))}function E0t(e,t){if(t&&(Fy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w0t(e)}function w0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zve=function(){return!!e})()}function KA(e){return KA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},KA(e)}function S0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uV(e,t)}function uV(e,t){return uV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},uV(e,t)}function Qve(e,t,n){return t=eye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eye(e){var t=x0t(e,"string");return Fy(t)=="symbol"?t:t+""}function x0t(e,t){if(Fy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Fy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function dV(){return dV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dV.apply(this,arguments)}var T0t=function(t){var n=t.yAxisId,i=z3(),o=K3(),u=Uve(n);return u==null?null:S.createElement(b_,dV({},u,{className:er("recharts-".concat(u.axisType," ").concat(u.axisType),u.className),viewBox:{x:0,y:0,width:i,height:o},ticksGenerator:function(p){return Nd(p,!0)}}))},w_=function(e){function t(){return v0t(this,t),b0t(this,t,arguments)}return S0t(t,e),_0t(t,[{key:"render",value:function(){return S.createElement(T0t,this.props)}}])}(S.Component);Qve(w_,"displayName","YAxis");Qve(w_,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Gie(e){return A0t(e)||N0t(e)||R0t(e)||C0t()}function C0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R0t(e,t){if(e){if(typeof e=="string")return hV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hV(e,t)}}function N0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function A0t(e){if(Array.isArray(e))return hV(e)}function hV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var fV=function(t,n,i,o,u){var h=Bl(t,Y3),p=Bl(t,sO),g=[].concat(Gie(h),Gie(p)),v=Bl(t,cO),b="".concat(o,"Id"),E=o[0],T=n;if(g.length&&(T=g.reduce(function(N,O){if(O.props[b]===i&&Uu(O.props,"extendDomain")&&xt(O.props[E])){var k=O.props[E];return[Math.min(N[0],k),Math.max(N[1],k)]}return N},T)),v.length){var C="".concat(E,"1"),R="".concat(E,"2");T=v.reduce(function(N,O){if(O.props[b]===i&&Uu(O.props,"extendDomain")&&xt(O.props[C])&&xt(O.props[R])){var k=O.props[C],j=O.props[R];return[Math.min(N[0],k,j),Math.max(N[1],k,j)]}return N},T)}return u&&u.length&&(T=u.reduce(function(N,O){return xt(O)?[Math.min(N[0],O),Math.max(N[1],O)]:N},T)),T},tye={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function o(g,v,b){this.fn=g,this.context=v,this.once=b||!1}function u(g,v,b,E,T){if(typeof b!="function")throw new TypeError("The listener must be a function");var C=new o(b,E||g,T),R=n?n+v:v;return g._events[R]?g._events[R].fn?g._events[R]=[g._events[R],C]:g._events[R].push(C):(g._events[R]=C,g._eventsCount++),g}function h(g,v){--g._eventsCount===0?g._events=new i:delete g._events[v]}function p(){this._events=new i,this._eventsCount=0}p.prototype.eventNames=function(){var v=[],b,E;if(this._eventsCount===0)return v;for(E in b=this._events)t.call(b,E)&&v.push(n?E.slice(1):E);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(b)):v},p.prototype.listeners=function(v){var b=n?n+v:v,E=this._events[b];if(!E)return[];if(E.fn)return[E.fn];for(var T=0,C=E.length,R=new Array(C);T<C;T++)R[T]=E[T].fn;return R},p.prototype.listenerCount=function(v){var b=n?n+v:v,E=this._events[b];return E?E.fn?1:E.length:0},p.prototype.emit=function(v,b,E,T,C,R){var N=n?n+v:v;if(!this._events[N])return!1;var O=this._events[N],k=arguments.length,j,P;if(O.fn){switch(O.once&&this.removeListener(v,O.fn,void 0,!0),k){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,b),!0;case 3:return O.fn.call(O.context,b,E),!0;case 4:return O.fn.call(O.context,b,E,T),!0;case 5:return O.fn.call(O.context,b,E,T,C),!0;case 6:return O.fn.call(O.context,b,E,T,C,R),!0}for(P=1,j=new Array(k-1);P<k;P++)j[P-1]=arguments[P];O.fn.apply(O.context,j)}else{var M=O.length,D;for(P=0;P<M;P++)switch(O[P].once&&this.removeListener(v,O[P].fn,void 0,!0),k){case 1:O[P].fn.call(O[P].context);break;case 2:O[P].fn.call(O[P].context,b);break;case 3:O[P].fn.call(O[P].context,b,E);break;case 4:O[P].fn.call(O[P].context,b,E,T);break;default:if(!j)for(D=1,j=new Array(k-1);D<k;D++)j[D-1]=arguments[D];O[P].fn.apply(O[P].context,j)}}return!0},p.prototype.on=function(v,b,E){return u(this,v,b,E,!1)},p.prototype.once=function(v,b,E){return u(this,v,b,E,!0)},p.prototype.removeListener=function(v,b,E,T){var C=n?n+v:v;if(!this._events[C])return this;if(!b)return h(this,C),this;var R=this._events[C];if(R.fn)R.fn===b&&(!T||R.once)&&(!E||R.context===E)&&h(this,C);else{for(var N=0,O=[],k=R.length;N<k;N++)(R[N].fn!==b||T&&!R[N].once||E&&R[N].context!==E)&&O.push(R[N]);O.length?this._events[C]=O.length===1?O[0]:O:h(this,C)}return this},p.prototype.removeAllListeners=function(v){var b;return v?(b=n?n+v:v,this._events[b]&&h(this,b)):(this._events=new i,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=n,p.EventEmitter=p,e.exports=p})(tye);var I0t=tye.exports;const O0t=jr(I0t);var JL=new O0t,ZL="recharts.syncMouseEvents";function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function P0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,nye(i.key),i)}}function j0t(e,t,n){return t&&k0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QL(e,t,n){return t=nye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nye(e){var t=D0t(e,"string");return Sw(t)=="symbol"?t:t+""}function D0t(e,t){if(Sw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Sw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var L0t=function(){function e(){P0t(this,e),QL(this,"activeIndex",0),QL(this,"coordinateList",[]),QL(this,"layout","horizontal")}return j0t(e,[{key:"setDetails",value:function(n){var i,o=n.coordinateList,u=o===void 0?null:o,h=n.container,p=h===void 0?null:h,g=n.layout,v=g===void 0?null:g,b=n.offset,E=b===void 0?null:b,T=n.mouseHandlerCallback,C=T===void 0?null:T;this.coordinateList=(i=u??this.coordinateList)!==null&&i!==void 0?i:[],this.container=p??this.container,this.layout=v??this.layout,this.offset=E??this.offset,this.mouseHandlerCallback=C??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),u=o.x,h=o.y,p=o.height,g=this.coordinateList[this.activeIndex].coordinate,v=((n=window)===null||n===void 0?void 0:n.scrollX)||0,b=((i=window)===null||i===void 0?void 0:i.scrollY)||0,E=u+g+v,T=h+this.offset.top+p/2+b;this.mouseHandlerCallback({pageX:E,pageY:T})}}}])}();function M0t(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var i=e==null?void 0:e[0],o=e==null?void 0:e[1];if(i&&o&&xt(i)&&xt(o))return!0}return!1}function U0t(e,t,n,i){var o=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-o,width:e==="horizontal"?i:n.width-1,height:e==="horizontal"?n.height-1:i}}function rye(e){var t=e.cx,n=e.cy,i=e.radius,o=e.startAngle,u=e.endAngle,h=ts(t,n,i,o),p=ts(t,n,i,u);return{points:[h,p],cx:t,cy:n,radius:i,startAngle:o,endAngle:u}}function F0t(e,t,n){var i,o,u,h;if(e==="horizontal")i=t.x,u=i,o=n.top,h=n.top+n.height;else if(e==="vertical")o=t.y,h=o,i=n.left,u=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var p=t.cx,g=t.cy,v=t.innerRadius,b=t.outerRadius,E=t.angle,T=ts(p,g,v,E),C=ts(p,g,b,E);i=T.x,o=T.y,u=C.x,h=C.y}else return rye(t);return[{x:i,y:o},{x:u,y:h}]}function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function Hie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function oR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Hie(Object(n),!0).forEach(function(i){V0t(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function V0t(e,t,n){return t=B0t(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B0t(e){var t=$0t(e,"string");return xw(t)=="symbol"?t:t+""}function $0t(e,t){if(xw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(xw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W0t(e){var t,n,i=e.element,o=e.tooltipEventType,u=e.isActive,h=e.activeCoordinate,p=e.activePayload,g=e.offset,v=e.activeTooltipIndex,b=e.tooltipAxisBandSize,E=e.layout,T=e.chartName,C=(t=i.props.cursor)!==null&&t!==void 0?t:(n=i.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!i||!C||!u||!h||T!=="ScatterChart"&&o!=="axis")return null;var R,N=$re;if(T==="ScatterChart")R=h,N=nyt;else if(T==="BarChart")R=U0t(E,h,g,b),N=$3;else if(E==="radial"){var O=rye(h),k=O.cx,j=O.cy,P=O.radius,M=O.startAngle,D=O.endAngle;R={cx:k,cy:j,startAngle:M,endAngle:D,innerRadius:P,outerRadius:P},N=cve}else R={points:F0t(E,h,g)},N=$re;var U=oR(oR(oR(oR({stroke:"#ccc",pointerEvents:"none"},g),R),Tr(C,!1)),{},{payload:p,payloadIndex:v,className:er("recharts-tooltip-cursor",C.className)});return S.isValidElement(C)?S.cloneElement(C,U):S.createElement(N,U)}var G0t=["item"],H0t=["children","className","width","height","style","compact","title","desc"];function Vy(e){"@babel/helpers - typeof";return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vy(e)}function Ov(){return Ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ov.apply(this,arguments)}function zie(e,t){return q0t(e)||K0t(e,t)||aye(e,t)||z0t()}function z0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K0t(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function q0t(e){if(Array.isArray(e))return e}function Kie(e,t){if(e==null)return{};var n=Y0t(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Y0t(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function X0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,sye(i.key),i)}}function Z0t(e,t,n){return t&&J0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q0t(e,t,n){return t=qA(t),ewt(e,iye()?Reflect.construct(t,n||[],qA(e).constructor):t.apply(e,n))}function ewt(e,t){if(t&&(Vy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return twt(e)}function twt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iye(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iye=function(){return!!e})()}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qA(e)}function nwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pV(e,t)}function pV(e,t){return pV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},pV(e,t)}function By(e){return awt(e)||iwt(e)||aye(e)||rwt()}function rwt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aye(e,t){if(e){if(typeof e=="string")return mV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mV(e,t)}}function iwt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function awt(e){if(Array.isArray(e))return mV(e)}function mV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qie(Object(n),!0).forEach(function(i){mn(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function mn(e,t,n){return t=sye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sye(e){var t=swt(e,"string");return Vy(t)=="symbol"?t:t+""}function swt(e,t){if(Vy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Vy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var owt={xAxis:["bottom","top"],yAxis:["left","right"]},cwt={width:"100%",height:"100%"},oye={x:0,y:0};function cR(e){return e}var lwt=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},uwt=function(t,n,i,o){var u=n.find(function(b){return b&&b.index===i});if(u){if(t==="horizontal")return{x:u.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:u.coordinate};if(t==="centric"){var h=u.coordinate,p=o.radius;return qe(qe(qe({},o),ts(o.cx,o.cy,p,h)),{},{angle:h,radius:p})}var g=u.coordinate,v=o.angle;return qe(qe(qe({},o),ts(o.cx,o.cy,g,v)),{},{angle:v,radius:g})}return oye},uO=function(t,n){var i=n.graphicalItems,o=n.dataStartIndex,u=n.dataEndIndex,h=(i??[]).reduce(function(p,g){var v=g.props.data;return v&&v.length?[].concat(By(p),By(v)):p},[]);return h.length>0?h:t&&t.length&&xt(o)&&xt(u)?t.slice(o,u+1):[]};function cye(e){return e==="number"?[0,"auto"]:void 0}var gV=function(t,n,i,o){var u=t.graphicalItems,h=t.tooltipAxis,p=uO(n,t);return i<0||!u||!u.length||i>=p.length?null:u.reduce(function(g,v){var b,E=(b=v.props.data)!==null&&b!==void 0?b:n;E&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=i&&(E=E.slice(t.dataStartIndex,t.dataEndIndex+1));var T;if(h.dataKey&&!h.allowDuplicatedCategory){var C=E===void 0?p:E;T=YU(C,h.dataKey,o)}else T=E&&E[i]||p[i];return T?[].concat(By(g),[ave(v,T)]):g},[])},Yie=function(t,n,i,o){var u=o||{x:t.chartX,y:t.chartY},h=lwt(u,i),p=t.orderedTooltipTicks,g=t.tooltipAxis,v=t.tooltipTicks,b=Upt(h,p,v,g);if(b>=0&&v){var E=v[b]&&v[b].value,T=gV(t,n,b,E),C=uwt(i,p,b,u);return{activeTooltipIndex:b,activeLabel:E,activePayload:T,activeCoordinate:C}}return null},dwt=function(t,n){var i=n.axes,o=n.graphicalItems,u=n.axisType,h=n.axisIdKey,p=n.stackGroups,g=n.dataStartIndex,v=n.dataEndIndex,b=t.layout,E=t.children,T=t.stackOffset,C=nve(b,u);return i.reduce(function(R,N){var O,k=N.type.defaultProps!==void 0?qe(qe({},N.type.defaultProps),N.props):N.props,j=k.type,P=k.dataKey,M=k.allowDataOverflow,D=k.allowDuplicatedCategory,U=k.scale,V=k.ticks,z=k.includeHidden,W=k[h];if(R[W])return R;var Y=uO(t.data,{graphicalItems:o.filter(function(ge){var Te,Pe=h in ge.props?ge.props[h]:(Te=ge.type.defaultProps)===null||Te===void 0?void 0:Te[h];return Pe===W}),dataStartIndex:g,dataEndIndex:v}),Q=Y.length,K,q,ee;M0t(k.domain,M,j)&&(K=LF(k.domain,null,M),C&&(j==="number"||U!=="auto")&&(ee=r0(Y,P,"category")));var oe=cye(j);if(!K||K.length===0){var ae,J=(ae=k.domain)!==null&&ae!==void 0?ae:oe;if(P){if(K=r0(Y,P,j),j==="category"&&C){var re=xQe(K);D&&re?(q=K,K=LA(0,Q)):D||(K=Are(J,K,N).reduce(function(ge,Te){return ge.indexOf(Te)>=0?ge:[].concat(By(ge),[Te])},[]))}else if(j==="category")D?K=K.filter(function(ge){return ge!==""&&!Nr(ge)}):K=Are(J,K,N).reduce(function(ge,Te){return ge.indexOf(Te)>=0||Te===""||Nr(Te)?ge:[].concat(By(ge),[Te])},[]);else if(j==="number"){var X=Wpt(Y,o.filter(function(ge){var Te,Pe,rt=h in ge.props?ge.props[h]:(Te=ge.type.defaultProps)===null||Te===void 0?void 0:Te[h],dt="hide"in ge.props?ge.props.hide:(Pe=ge.type.defaultProps)===null||Pe===void 0?void 0:Pe.hide;return rt===W&&(z||!dt)}),P,u,b);X&&(K=X)}C&&(j==="number"||U!=="auto")&&(ee=r0(Y,P,"category"))}else C?K=LA(0,Q):p&&p[W]&&p[W].hasStack&&j==="number"?K=T==="expand"?[0,1]:ive(p[W].stackGroups,g,v):K=tve(Y,o.filter(function(ge){var Te=h in ge.props?ge.props[h]:ge.type.defaultProps[h],Pe="hide"in ge.props?ge.props.hide:ge.type.defaultProps.hide;return Te===W&&(z||!Pe)}),j,b,!0);if(j==="number")K=fV(E,K,W,u,V),J&&(K=LF(J,K,M));else if(j==="category"&&J){var de=J,we=K.every(function(ge){return de.indexOf(ge)>=0});we&&(K=de)}}return qe(qe({},R),{},mn({},W,qe(qe({},k),{},{axisType:u,domain:K,categoricalDomain:ee,duplicateDomain:q,originalDomain:(O=k.domain)!==null&&O!==void 0?O:oe,isCategorical:C,layout:b})))},{})},hwt=function(t,n){var i=n.graphicalItems,o=n.Axis,u=n.axisType,h=n.axisIdKey,p=n.stackGroups,g=n.dataStartIndex,v=n.dataEndIndex,b=t.layout,E=t.children,T=uO(t.data,{graphicalItems:i,dataStartIndex:g,dataEndIndex:v}),C=T.length,R=nve(b,u),N=-1;return i.reduce(function(O,k){var j=k.type.defaultProps!==void 0?qe(qe({},k.type.defaultProps),k.props):k.props,P=j[h],M=cye("number");if(!O[P]){N++;var D;return R?D=LA(0,C):p&&p[P]&&p[P].hasStack?(D=ive(p[P].stackGroups,g,v),D=fV(E,D,P,u)):(D=LF(M,tve(T,i.filter(function(U){var V,z,W=h in U.props?U.props[h]:(V=U.type.defaultProps)===null||V===void 0?void 0:V[h],Y="hide"in U.props?U.props.hide:(z=U.type.defaultProps)===null||z===void 0?void 0:z.hide;return W===P&&!Y}),"number",b),o.defaultProps.allowDataOverflow),D=fV(E,D,P,u)),qe(qe({},O),{},mn({},P,qe(qe({axisType:u},o.defaultProps),{},{hide:!0,orientation:Vc(owt,"".concat(u,".").concat(N%2),null),domain:D,originalDomain:M,isCategorical:R,layout:b})))}return O},{})},fwt=function(t,n){var i=n.axisType,o=i===void 0?"xAxis":i,u=n.AxisComp,h=n.graphicalItems,p=n.stackGroups,g=n.dataStartIndex,v=n.dataEndIndex,b=t.children,E="".concat(o,"Id"),T=Bl(b,u),C={};return T&&T.length?C=dwt(t,{axes:T,graphicalItems:h,axisType:o,axisIdKey:E,stackGroups:p,dataStartIndex:g,dataEndIndex:v}):h&&h.length&&(C=hwt(t,{Axis:u,graphicalItems:h,axisType:o,axisIdKey:E,stackGroups:p,dataStartIndex:g,dataEndIndex:v})),C},pwt=function(t){var n=zh(t),i=Nd(n,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:f3(i,function(o){return o.coordinate}),tooltipAxis:n,tooltipAxisBandSize:RA(n,i)}},Xie=function(t){var n=t.children,i=t.defaultShowTooltip,o=Fo(n,Py),u=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(u=o.props.startIndex),o.props.endIndex>=0&&(h=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:u,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!i}},mwt=function(t){return!t||!t.length?!1:t.some(function(n){var i=Pd(n&&n.type);return i&&i.indexOf("Bar")>=0})},Jie=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},gwt=function(t,n){var i=t.props,o=t.graphicalItems,u=t.xAxisMap,h=u===void 0?{}:u,p=t.yAxisMap,g=p===void 0?{}:p,v=i.width,b=i.height,E=i.children,T=i.margin||{},C=Fo(E,Py),R=Fo(E,jd),N=Object.keys(g).reduce(function(D,U){var V=g[U],z=V.orientation;return!V.mirror&&!V.hide?qe(qe({},D),{},mn({},z,D[z]+V.width)):D},{left:T.left||0,right:T.right||0}),O=Object.keys(h).reduce(function(D,U){var V=h[U],z=V.orientation;return!V.mirror&&!V.hide?qe(qe({},D),{},mn({},z,Vc(D,"".concat(z))+V.height)):D},{top:T.top||0,bottom:T.bottom||0}),k=qe(qe({},O),N),j=k.bottom;C&&(k.bottom+=C.props.height||Py.defaultProps.height),R&&n&&(k=Bpt(k,o,i,n));var P=v-k.left-k.right,M=b-k.top-k.bottom;return qe(qe({brushBottom:j},k),{},{width:Math.max(P,0),height:Math.max(M,0)})},vwt=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},ywt=function(t){var n=t.chartName,i=t.GraphicalChild,o=t.defaultTooltipEventType,u=o===void 0?"axis":o,h=t.validateTooltipEventTypes,p=h===void 0?["axis"]:h,g=t.axisComponents,v=t.legendContent,b=t.formatAxisMap,E=t.defaultProps,T=function(k,j){var P=j.graphicalItems,M=j.stackGroups,D=j.offset,U=j.updateId,V=j.dataStartIndex,z=j.dataEndIndex,W=k.barSize,Y=k.layout,Q=k.barGap,K=k.barCategoryGap,q=k.maxBarSize,ee=Jie(Y),oe=ee.numericAxisName,ae=ee.cateAxisName,J=mwt(P),re=[];return P.forEach(function(X,de){var we=uO(k.data,{graphicalItems:[X],dataStartIndex:V,dataEndIndex:z}),ge=X.type.defaultProps!==void 0?qe(qe({},X.type.defaultProps),X.props):X.props,Te=ge.dataKey,Pe=ge.maxBarSize,rt=ge["".concat(oe,"Id")],dt=ge["".concat(ae,"Id")],ze={},vt=g.reduce(function(Ie,$e){var gt=j["".concat($e.axisType,"Map")],at=ge["".concat($e.axisType,"Id")];gt&&gt[at]||$e.axisType==="zAxis"||ym();var pt=gt[at];return qe(qe({},Ie),{},mn(mn({},$e.axisType,pt),"".concat($e.axisType,"Ticks"),Nd(pt)))},ze),Be=vt[ae],ot=vt["".concat(ae,"Ticks")],De=M&&M[rt]&&M[rt].hasStack&&tmt(X,M[rt].stackGroups),je=Pd(X.type).indexOf("Bar")>=0,Mt=RA(Be,ot),Ut=[],fn=J&&Fpt({barSize:W,stackGroups:M,totalSize:vwt(vt,ae)});if(je){var ht,St,At=Nr(Pe)?q:Pe,it=(ht=(St=RA(Be,ot,!0))!==null&&St!==void 0?St:At)!==null&&ht!==void 0?ht:0;Ut=Vpt({barGap:Q,barCategoryGap:K,bandSize:it!==Mt?it:Mt,sizeList:fn[dt],maxBarSize:At}),it!==Mt&&(Ut=Ut.map(function(Ie){return qe(qe({},Ie),{},{position:qe(qe({},Ie.position),{},{offset:Ie.position.offset-it/2})})}))}var ve=X&&X.type&&X.type.getComposedData;ve&&re.push({props:qe(qe({},ve(qe(qe({},vt),{},{displayedData:we,props:k,dataKey:Te,item:X,bandSize:Mt,barPosition:Ut,offset:D,stackedData:De,layout:Y,dataStartIndex:V,dataEndIndex:z}))),{},mn(mn(mn({key:X.key||"item-".concat(de)},oe,vt[oe]),ae,vt[ae]),"animationId",U)),childIndex:LQe(X,k.children),item:X})}),re},C=function(k,j){var P=k.props,M=k.dataStartIndex,D=k.dataEndIndex,U=k.updateId;if(!Ste({props:P}))return null;var V=P.children,z=P.layout,W=P.stackOffset,Y=P.data,Q=P.reverseStackOrder,K=Jie(z),q=K.numericAxisName,ee=K.cateAxisName,oe=Bl(V,i),ae=Zpt(Y,oe,"".concat(q,"Id"),"".concat(ee,"Id"),W,Q),J=g.reduce(function(ge,Te){var Pe="".concat(Te.axisType,"Map");return qe(qe({},ge),{},mn({},Pe,fwt(P,qe(qe({},Te),{},{graphicalItems:oe,stackGroups:Te.axisType===q&&ae,dataStartIndex:M,dataEndIndex:D}))))},{}),re=gwt(qe(qe({},J),{},{props:P,graphicalItems:oe}),j==null?void 0:j.legendBBox);Object.keys(J).forEach(function(ge){J[ge]=b(P,J[ge],re,ge.replace("Map",""),n)});var X=J["".concat(ee,"Map")],de=pwt(X),we=T(P,qe(qe({},J),{},{dataStartIndex:M,dataEndIndex:D,updateId:U,graphicalItems:oe,stackGroups:ae,offset:re}));return qe(qe({formattedGraphicalItems:we,graphicalItems:oe,offset:re,stackGroups:ae},de),J)},R=function(O){function k(j){var P,M,D;return X0t(this,k),D=Q0t(this,k,[j]),mn(D,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),mn(D,"accessibilityManager",new L0t),mn(D,"handleLegendBBoxUpdate",function(U){if(U){var V=D.state,z=V.dataStartIndex,W=V.dataEndIndex,Y=V.updateId;D.setState(qe({legendBBox:U},C({props:D.props,dataStartIndex:z,dataEndIndex:W,updateId:Y},qe(qe({},D.state),{},{legendBBox:U}))))}}),mn(D,"handleReceiveSyncEvent",function(U,V,z){if(D.props.syncId===U){if(z===D.eventEmitterSymbol&&typeof D.props.syncMethod!="function")return;D.applySyncEvent(V)}}),mn(D,"handleBrushChange",function(U){var V=U.startIndex,z=U.endIndex;if(V!==D.state.dataStartIndex||z!==D.state.dataEndIndex){var W=D.state.updateId;D.setState(function(){return qe({dataStartIndex:V,dataEndIndex:z},C({props:D.props,dataStartIndex:V,dataEndIndex:z,updateId:W},D.state))}),D.triggerSyncEvent({dataStartIndex:V,dataEndIndex:z})}}),mn(D,"handleMouseEnter",function(U){var V=D.getMouseInfo(U);if(V){var z=qe(qe({},V),{},{isTooltipActive:!0});D.setState(z),D.triggerSyncEvent(z);var W=D.props.onMouseEnter;zn(W)&&W(z,U)}}),mn(D,"triggeredAfterMouseMove",function(U){var V=D.getMouseInfo(U),z=V?qe(qe({},V),{},{isTooltipActive:!0}):{isTooltipActive:!1};D.setState(z),D.triggerSyncEvent(z);var W=D.props.onMouseMove;zn(W)&&W(z,U)}),mn(D,"handleItemMouseEnter",function(U){D.setState(function(){return{isTooltipActive:!0,activeItem:U,activePayload:U.tooltipPayload,activeCoordinate:U.tooltipPosition||{x:U.cx,y:U.cy}}})}),mn(D,"handleItemMouseLeave",function(){D.setState(function(){return{isTooltipActive:!1}})}),mn(D,"handleMouseMove",function(U){U.persist(),D.throttleTriggeredAfterMouseMove(U)}),mn(D,"handleMouseLeave",function(U){D.throttleTriggeredAfterMouseMove.cancel();var V={isTooltipActive:!1};D.setState(V),D.triggerSyncEvent(V);var z=D.props.onMouseLeave;zn(z)&&z(V,U)}),mn(D,"handleOuterEvent",function(U){var V=DQe(U),z=Vc(D.props,"".concat(V));if(V&&zn(z)){var W,Y;/.*touch.*/i.test(V)?Y=D.getMouseInfo(U.changedTouches[0]):Y=D.getMouseInfo(U),z((W=Y)!==null&&W!==void 0?W:{},U)}}),mn(D,"handleClick",function(U){var V=D.getMouseInfo(U);if(V){var z=qe(qe({},V),{},{isTooltipActive:!0});D.setState(z),D.triggerSyncEvent(z);var W=D.props.onClick;zn(W)&&W(z,U)}}),mn(D,"handleMouseDown",function(U){var V=D.props.onMouseDown;if(zn(V)){var z=D.getMouseInfo(U);V(z,U)}}),mn(D,"handleMouseUp",function(U){var V=D.props.onMouseUp;if(zn(V)){var z=D.getMouseInfo(U);V(z,U)}}),mn(D,"handleTouchMove",function(U){U.changedTouches!=null&&U.changedTouches.length>0&&D.throttleTriggeredAfterMouseMove(U.changedTouches[0])}),mn(D,"handleTouchStart",function(U){U.changedTouches!=null&&U.changedTouches.length>0&&D.handleMouseDown(U.changedTouches[0])}),mn(D,"handleTouchEnd",function(U){U.changedTouches!=null&&U.changedTouches.length>0&&D.handleMouseUp(U.changedTouches[0])}),mn(D,"handleDoubleClick",function(U){var V=D.props.onDoubleClick;if(zn(V)){var z=D.getMouseInfo(U);V(z,U)}}),mn(D,"handleContextMenu",function(U){var V=D.props.onContextMenu;if(zn(V)){var z=D.getMouseInfo(U);V(z,U)}}),mn(D,"triggerSyncEvent",function(U){D.props.syncId!==void 0&&JL.emit(ZL,D.props.syncId,U,D.eventEmitterSymbol)}),mn(D,"applySyncEvent",function(U){var V=D.props,z=V.layout,W=V.syncMethod,Y=D.state.updateId,Q=U.dataStartIndex,K=U.dataEndIndex;if(U.dataStartIndex!==void 0||U.dataEndIndex!==void 0)D.setState(qe({dataStartIndex:Q,dataEndIndex:K},C({props:D.props,dataStartIndex:Q,dataEndIndex:K,updateId:Y},D.state)));else if(U.activeTooltipIndex!==void 0){var q=U.chartX,ee=U.chartY,oe=U.activeTooltipIndex,ae=D.state,J=ae.offset,re=ae.tooltipTicks;if(!J)return;if(typeof W=="function")oe=W(re,U);else if(W==="value"){oe=-1;for(var X=0;X<re.length;X++)if(re[X].value===U.activeLabel){oe=X;break}}var de=qe(qe({},J),{},{x:J.left,y:J.top}),we=Math.min(q,de.x+de.width),ge=Math.min(ee,de.y+de.height),Te=re[oe]&&re[oe].value,Pe=gV(D.state,D.props.data,oe),rt=re[oe]?{x:z==="horizontal"?re[oe].coordinate:we,y:z==="horizontal"?ge:re[oe].coordinate}:oye;D.setState(qe(qe({},U),{},{activeLabel:Te,activeCoordinate:rt,activePayload:Pe,activeTooltipIndex:oe}))}else D.setState(U)}),mn(D,"renderCursor",function(U){var V,z=D.state,W=z.isTooltipActive,Y=z.activeCoordinate,Q=z.activePayload,K=z.offset,q=z.activeTooltipIndex,ee=z.tooltipAxisBandSize,oe=D.getTooltipEventType(),ae=(V=U.props.active)!==null&&V!==void 0?V:W,J=D.props.layout,re=U.key||"_recharts-cursor";return me.createElement(W0t,{key:re,activeCoordinate:Y,activePayload:Q,activeTooltipIndex:q,chartName:n,element:U,isActive:ae,layout:J,offset:K,tooltipAxisBandSize:ee,tooltipEventType:oe})}),mn(D,"renderPolarAxis",function(U,V,z){var W=Vc(U,"type.axisType"),Y=Vc(D.state,"".concat(W,"Map")),Q=U.type.defaultProps,K=Q!==void 0?qe(qe({},Q),U.props):U.props,q=Y&&Y[K["".concat(W,"Id")]];return S.cloneElement(U,qe(qe({},q),{},{className:er(W,q.className),key:U.key||"".concat(V,"-").concat(z),ticks:Nd(q,!0)}))}),mn(D,"renderPolarGrid",function(U){var V=U.props,z=V.radialLines,W=V.polarAngles,Y=V.polarRadius,Q=D.state,K=Q.radiusAxisMap,q=Q.angleAxisMap,ee=zh(K),oe=zh(q),ae=oe.cx,J=oe.cy,re=oe.innerRadius,X=oe.outerRadius;return S.cloneElement(U,{polarAngles:Array.isArray(W)?W:Nd(oe,!0).map(function(de){return de.coordinate}),polarRadius:Array.isArray(Y)?Y:Nd(ee,!0).map(function(de){return de.coordinate}),cx:ae,cy:J,innerRadius:re,outerRadius:X,key:U.key||"polar-grid",radialLines:z})}),mn(D,"renderLegend",function(){var U=D.state.formattedGraphicalItems,V=D.props,z=V.children,W=V.width,Y=V.height,Q=D.props.margin||{},K=W-(Q.left||0)-(Q.right||0),q=Qge({children:z,formattedGraphicalItems:U,legendWidth:K,legendContent:v});if(!q)return null;var ee=q.item,oe=Kie(q,G0t);return S.cloneElement(ee,qe(qe({},oe),{},{chartWidth:W,chartHeight:Y,margin:Q,onBBoxUpdate:D.handleLegendBBoxUpdate}))}),mn(D,"renderTooltip",function(){var U,V=D.props,z=V.children,W=V.accessibilityLayer,Y=Fo(z,Oc);if(!Y)return null;var Q=D.state,K=Q.isTooltipActive,q=Q.activeCoordinate,ee=Q.activePayload,oe=Q.activeLabel,ae=Q.offset,J=(U=Y.props.active)!==null&&U!==void 0?U:K;return S.cloneElement(Y,{viewBox:qe(qe({},ae),{},{x:ae.left,y:ae.top}),active:J,label:oe,payload:J?ee:[],coordinate:q,accessibilityLayer:W})}),mn(D,"renderBrush",function(U){var V=D.props,z=V.margin,W=V.data,Y=D.state,Q=Y.offset,K=Y.dataStartIndex,q=Y.dataEndIndex,ee=Y.updateId;return S.cloneElement(U,{key:U.key||"_recharts-brush",onChange:rR(D.handleBrushChange,U.props.onChange),data:W,x:xt(U.props.x)?U.props.x:Q.left,y:xt(U.props.y)?U.props.y:Q.top+Q.height+Q.brushBottom-(z.bottom||0),width:xt(U.props.width)?U.props.width:Q.width,startIndex:K,endIndex:q,updateId:"brush-".concat(ee)})}),mn(D,"renderReferenceElement",function(U,V,z){if(!U)return null;var W=D,Y=W.clipPathId,Q=D.state,K=Q.xAxisMap,q=Q.yAxisMap,ee=Q.offset,oe=U.type.defaultProps||{},ae=U.props,J=ae.xAxisId,re=J===void 0?oe.xAxisId:J,X=ae.yAxisId,de=X===void 0?oe.yAxisId:X;return S.cloneElement(U,{key:U.key||"".concat(V,"-").concat(z),xAxis:K[re],yAxis:q[de],viewBox:{x:ee.left,y:ee.top,width:ee.width,height:ee.height},clipPathId:Y})}),mn(D,"renderActivePoints",function(U){var V=U.item,z=U.activePoint,W=U.basePoint,Y=U.childIndex,Q=U.isRange,K=[],q=V.props.key,ee=V.item.type.defaultProps!==void 0?qe(qe({},V.item.type.defaultProps),V.item.props):V.item.props,oe=ee.activeDot,ae=ee.dataKey,J=qe(qe({index:Y,dataKey:ae,cx:z.x,cy:z.y,r:4,fill:B3(V.item),strokeWidth:2,stroke:"#fff",payload:z.payload,value:z.value},Tr(oe,!1)),ZN(oe));return K.push(k.renderActiveDot(oe,J,"".concat(q,"-activePoint-").concat(Y))),W?K.push(k.renderActiveDot(oe,qe(qe({},J),{},{cx:W.x,cy:W.y}),"".concat(q,"-basePoint-").concat(Y))):Q&&K.push(null),K}),mn(D,"renderGraphicChild",function(U,V,z){var W=D.filterFormatItem(U,V,z);if(!W)return null;var Y=D.getTooltipEventType(),Q=D.state,K=Q.isTooltipActive,q=Q.tooltipAxis,ee=Q.activeTooltipIndex,oe=Q.activeLabel,ae=D.props.children,J=Fo(ae,Oc),re=W.props,X=re.points,de=re.isRange,we=re.baseLine,ge=W.item.type.defaultProps!==void 0?qe(qe({},W.item.type.defaultProps),W.item.props):W.item.props,Te=ge.activeDot,Pe=ge.hide,rt=ge.activeBar,dt=ge.activeShape,ze=!!(!Pe&&K&&J&&(Te||rt||dt)),vt={};Y!=="axis"&&J&&J.props.trigger==="click"?vt={onClick:rR(D.handleItemMouseEnter,U.props.onClick)}:Y!=="axis"&&(vt={onMouseLeave:rR(D.handleItemMouseLeave,U.props.onMouseLeave),onMouseEnter:rR(D.handleItemMouseEnter,U.props.onMouseEnter)});var Be=S.cloneElement(U,qe(qe({},W.props),vt));function ot($e){return typeof q.dataKey=="function"?q.dataKey($e.payload):null}if(ze)if(ee>=0){var De,je;if(q.dataKey&&!q.allowDuplicatedCategory){var Mt=typeof q.dataKey=="function"?ot:"payload.".concat(q.dataKey.toString());De=YU(X,Mt,oe),je=de&&we&&YU(we,Mt,oe)}else De=X==null?void 0:X[ee],je=de&&we&&we[ee];if(dt||rt){var Ut=U.props.activeIndex!==void 0?U.props.activeIndex:ee;return[S.cloneElement(U,qe(qe(qe({},W.props),vt),{},{activeIndex:Ut})),null,null]}if(!Nr(De))return[Be].concat(By(D.renderActivePoints({item:W,activePoint:De,basePoint:je,childIndex:ee,isRange:de})))}else{var fn,ht=(fn=D.getItemByXY(D.state.activeCoordinate))!==null&&fn!==void 0?fn:{graphicalItem:Be},St=ht.graphicalItem,At=St.item,it=At===void 0?U:At,ve=St.childIndex,Ie=qe(qe(qe({},W.props),vt),{},{activeIndex:ve});return[S.cloneElement(it,Ie),null,null]}return de?[Be,null,null]:[Be,null]}),mn(D,"renderCustomized",function(U,V,z){return S.cloneElement(U,qe(qe({key:"recharts-customized-".concat(z)},D.props),D.state))}),mn(D,"renderMap",{CartesianGrid:{handler:cR,once:!0},ReferenceArea:{handler:D.renderReferenceElement},ReferenceLine:{handler:cR},ReferenceDot:{handler:D.renderReferenceElement},XAxis:{handler:cR},YAxis:{handler:cR},Brush:{handler:D.renderBrush,once:!0},Bar:{handler:D.renderGraphicChild},Line:{handler:D.renderGraphicChild},Area:{handler:D.renderGraphicChild},Radar:{handler:D.renderGraphicChild},RadialBar:{handler:D.renderGraphicChild},Scatter:{handler:D.renderGraphicChild},Pie:{handler:D.renderGraphicChild},Funnel:{handler:D.renderGraphicChild},Tooltip:{handler:D.renderCursor,once:!0},PolarGrid:{handler:D.renderPolarGrid,once:!0},PolarAngleAxis:{handler:D.renderPolarAxis},PolarRadiusAxis:{handler:D.renderPolarAxis},Customized:{handler:D.renderCustomized}}),D.clipPathId="".concat((P=j.id)!==null&&P!==void 0?P:MI("recharts"),"-clip"),D.throttleTriggeredAfterMouseMove=Zme(D.triggeredAfterMouseMove,(M=j.throttleDelay)!==null&&M!==void 0?M:1e3/60),D.state={},D}return nwt(k,O),Z0t(k,[{key:"componentDidMount",value:function(){var P,M;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(P=this.props.margin.left)!==null&&P!==void 0?P:0,top:(M=this.props.margin.top)!==null&&M!==void 0?M:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var P=this.props,M=P.children,D=P.data,U=P.height,V=P.layout,z=Fo(M,Oc);if(z){var W=z.props.defaultIndex;if(!(typeof W!="number"||W<0||W>this.state.tooltipTicks.length-1)){var Y=this.state.tooltipTicks[W]&&this.state.tooltipTicks[W].value,Q=gV(this.state,D,W,Y),K=this.state.tooltipTicks[W].coordinate,q=(this.state.offset.top+U)/2,ee=V==="horizontal",oe=ee?{x:K,y:q}:{y:K,x:q},ae=this.state.formattedGraphicalItems.find(function(re){var X=re.item;return X.type.name==="Scatter"});ae&&(oe=qe(qe({},oe),ae.props.points[W].tooltipPosition),Q=ae.props.points[W].tooltipPayload);var J={activeTooltipIndex:W,isTooltipActive:!0,activeLabel:Y,activePayload:Q,activeCoordinate:oe};this.setState(J),this.renderCursor(z),this.accessibilityManager.setIndex(W)}}}},{key:"getSnapshotBeforeUpdate",value:function(P,M){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==M.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==P.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==P.margin){var D,U;this.accessibilityManager.setDetails({offset:{left:(D=this.props.margin.left)!==null&&D!==void 0?D:0,top:(U=this.props.margin.top)!==null&&U!==void 0?U:0}})}return null}},{key:"componentDidUpdate",value:function(P){JU([Fo(P.children,Oc)],[Fo(this.props.children,Oc)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var P=Fo(this.props.children,Oc);if(P&&typeof P.props.shared=="boolean"){var M=P.props.shared?"axis":"item";return p.indexOf(M)>=0?M:u}return u}},{key:"getMouseInfo",value:function(P){if(!this.container)return null;var M=this.container,D=M.getBoundingClientRect(),U=uut(D),V={chartX:Math.round(P.pageX-U.left),chartY:Math.round(P.pageY-U.top)},z=D.width/M.offsetWidth||1,W=this.inRange(V.chartX,V.chartY,z);if(!W)return null;var Y=this.state,Q=Y.xAxisMap,K=Y.yAxisMap,q=this.getTooltipEventType(),ee=Yie(this.state,this.props.data,this.props.layout,W);if(q!=="axis"&&Q&&K){var oe=zh(Q).scale,ae=zh(K).scale,J=oe&&oe.invert?oe.invert(V.chartX):null,re=ae&&ae.invert?ae.invert(V.chartY):null;return qe(qe({},V),{},{xValue:J,yValue:re},ee)}return ee?qe(qe({},V),ee):null}},{key:"inRange",value:function(P,M){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,U=this.props.layout,V=P/D,z=M/D;if(U==="horizontal"||U==="vertical"){var W=this.state.offset,Y=V>=W.left&&V<=W.left+W.width&&z>=W.top&&z<=W.top+W.height;return Y?{x:V,y:z}:null}var Q=this.state,K=Q.angleAxisMap,q=Q.radiusAxisMap;if(K&&q){var ee=zh(K);return Pre({x:V,y:z},ee)}return null}},{key:"parseEventsOfWrapper",value:function(){var P=this.props.children,M=this.getTooltipEventType(),D=Fo(P,Oc),U={};D&&M==="axis"&&(D.props.trigger==="click"?U={onClick:this.handleClick}:U={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var V=ZN(this.props,this.handleOuterEvent);return qe(qe({},V),U)}},{key:"addListener",value:function(){JL.on(ZL,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){JL.removeListener(ZL,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(P,M,D){for(var U=this.state.formattedGraphicalItems,V=0,z=U.length;V<z;V++){var W=U[V];if(W.item===P||W.props.key===P.key||M===Pd(W.item.type)&&D===W.childIndex)return W}return null}},{key:"renderClipPath",value:function(){var P=this.clipPathId,M=this.state.offset,D=M.left,U=M.top,V=M.height,z=M.width;return me.createElement("defs",null,me.createElement("clipPath",{id:P},me.createElement("rect",{x:D,y:U,height:V,width:z})))}},{key:"getXScales",value:function(){var P=this.state.xAxisMap;return P?Object.entries(P).reduce(function(M,D){var U=zie(D,2),V=U[0],z=U[1];return qe(qe({},M),{},mn({},V,z.scale))},{}):null}},{key:"getYScales",value:function(){var P=this.state.yAxisMap;return P?Object.entries(P).reduce(function(M,D){var U=zie(D,2),V=U[0],z=U[1];return qe(qe({},M),{},mn({},V,z.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(P){var M;return(M=this.state.xAxisMap)===null||M===void 0||(M=M[P])===null||M===void 0?void 0:M.scale}},{key:"getYScaleByAxisId",value:function(P){var M;return(M=this.state.yAxisMap)===null||M===void 0||(M=M[P])===null||M===void 0?void 0:M.scale}},{key:"getItemByXY",value:function(P){var M=this.state,D=M.formattedGraphicalItems,U=M.activeItem;if(D&&D.length)for(var V=0,z=D.length;V<z;V++){var W=D[V],Y=W.props,Q=W.item,K=Q.type.defaultProps!==void 0?qe(qe({},Q.type.defaultProps),Q.props):Q.props,q=Pd(Q.type);if(q==="Bar"){var ee=(Y.data||[]).find(function(re){return zvt(P,re)});if(ee)return{graphicalItem:W,payload:ee}}else if(q==="RadialBar"){var oe=(Y.data||[]).find(function(re){return Pre(P,re)});if(oe)return{graphicalItem:W,payload:oe}}else if(nO(W,U)||rO(W,U)||yw(W,U)){var ae=Yyt({graphicalItem:W,activeTooltipItem:U,itemData:K.data}),J=K.activeIndex===void 0?ae:K.activeIndex;return{graphicalItem:qe(qe({},W),{},{childIndex:J}),payload:yw(W,U)?K.data[ae]:W.props.data[ae]}}}return null}},{key:"render",value:function(){var P=this;if(!Ste(this))return null;var M=this.props,D=M.children,U=M.className,V=M.width,z=M.height,W=M.style,Y=M.compact,Q=M.title,K=M.desc,q=Kie(M,H0t),ee=Tr(q,!1);if(Y)return me.createElement(Oie,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement(QU,Ov({},ee,{width:V,height:z,title:Q,desc:K}),this.renderClipPath(),Tte(D,this.renderMap)));if(this.props.accessibilityLayer){var oe,ae;ee.tabIndex=(oe=this.props.tabIndex)!==null&&oe!==void 0?oe:0,ee.role=(ae=this.props.role)!==null&&ae!==void 0?ae:"application",ee.onKeyDown=function(re){P.accessibilityManager.keyboardEvent(re)},ee.onFocus=function(){P.accessibilityManager.focus()}}var J=this.parseEventsOfWrapper();return me.createElement(Oie,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement("div",Ov({className:er("recharts-wrapper",U),style:qe({position:"relative",cursor:"default",width:V,height:z},W)},J,{ref:function(X){P.container=X}}),me.createElement(QU,Ov({},ee,{width:V,height:z,title:Q,desc:K,style:cwt}),this.renderClipPath(),Tte(D,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(S.Component);mn(R,"displayName",n),mn(R,"defaultProps",qe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},E)),mn(R,"getDerivedStateFromProps",function(O,k){var j=O.dataKey,P=O.data,M=O.children,D=O.width,U=O.height,V=O.layout,z=O.stackOffset,W=O.margin,Y=k.dataStartIndex,Q=k.dataEndIndex;if(k.updateId===void 0){var K=Xie(O);return qe(qe(qe({},K),{},{updateId:0},C(qe(qe({props:O},K),{},{updateId:0}),k)),{},{prevDataKey:j,prevData:P,prevWidth:D,prevHeight:U,prevLayout:V,prevStackOffset:z,prevMargin:W,prevChildren:M})}if(j!==k.prevDataKey||P!==k.prevData||D!==k.prevWidth||U!==k.prevHeight||V!==k.prevLayout||z!==k.prevStackOffset||!Wv(W,k.prevMargin)){var q=Xie(O),ee={chartX:k.chartX,chartY:k.chartY,isTooltipActive:k.isTooltipActive},oe=qe(qe({},Yie(k,P,V)),{},{updateId:k.updateId+1}),ae=qe(qe(qe({},q),ee),oe);return qe(qe(qe({},ae),C(qe({props:O},ae),k)),{},{prevDataKey:j,prevData:P,prevWidth:D,prevHeight:U,prevLayout:V,prevStackOffset:z,prevMargin:W,prevChildren:M})}if(!JU(M,k.prevChildren)){var J,re,X,de,we=Fo(M,Py),ge=we&&(J=(re=we.props)===null||re===void 0?void 0:re.startIndex)!==null&&J!==void 0?J:Y,Te=we&&(X=(de=we.props)===null||de===void 0?void 0:de.endIndex)!==null&&X!==void 0?X:Q,Pe=ge!==Y||Te!==Q,rt=!Nr(P),dt=rt&&!Pe?k.updateId:k.updateId+1;return qe(qe({updateId:dt},C(qe(qe({props:O},k),{},{updateId:dt,dataStartIndex:ge,dataEndIndex:Te}),k)),{},{prevChildren:M,dataStartIndex:ge,dataEndIndex:Te})}return null}),mn(R,"renderActiveDot",function(O,k,j){var P;return S.isValidElement(O)?P=S.cloneElement(O,k):zn(O)?P=O(k):P=me.createElement(_ve,k),me.createElement($a,{className:"recharts-active-dot",key:j},P)});var N=S.forwardRef(function(k,j){return me.createElement(R,Ov({},k,{ref:j}))});return N.displayName=R.displayName,N},Z3=ywt({chartName:"BarChart",GraphicalChild:Wo,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:E_},{axisType:"yAxis",AxisComp:w_}],formatAxisMap:bbt});const Zie="https://api.gada.chat",_wt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function AE({title:e,value:t,gradient:n,Icon:i}){return c.jsxs("div",{className:`relative overflow-hidden rounded-3xl px-6 py-7 text-white shadow-sm bg-gradient-to-tr ${n}`,children:[c.jsx("div",{className:"pointer-events-none absolute -right-10 -bottom-10 h-40 w-40 rounded-full bg-white/20"}),c.jsx("div",{className:"pointer-events-none absolute -right-16 bottom-0 h-28 w-28 rounded-full bg-white/10"}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-5xl font-extrabold leading-none",children:t}),c.jsx("div",{className:"mt-2 text-xl font-semibold opacity-95",children:e})]}),c.jsx("div",{className:"shrink-0",children:c.jsx("div",{className:"grid place-items-center h-14 w-14 rounded-2xl bg-white/15",children:c.jsx(i,{className:"h-7 w-7 text-white"})})})]})]})}function _u({title:e,value:t,gradient:n,Icon:i}){return c.jsxs("div",{className:`relative overflow-hidden rounded-3xl px-5 py-6 text-white shadow-sm bg-gradient-to-tr ${n}`,children:[c.jsx("div",{className:"pointer-events-none absolute -right-10 -bottom-10 h-32 w-32 rounded-full bg-white/15"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-extrabold leading-none",children:t}),c.jsx("div",{className:"mt-1 text-sm font-medium opacity-95",children:e})]}),c.jsx("div",{className:"h-10 w-10 grid place-items-center rounded-xl bg-white/15",children:c.jsx(i,{className:"h-5 w-5 text-white"})})]})]})}function bwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState(null),[u,h]=S.useState(new Date().getFullYear()),[p,g]=S.useState(null);S.useEffect(()=>{n&&fetch(`${Zie}/api/admin/stats`,{headers:t}).then(b=>{if(!b.ok)throw new Error("Failed to load stats");return b.json()}).then(o).catch(console.error)},[n]),S.useEffect(()=>{if(!n)return;(async()=>{try{const T=await fetch(`${Zie}/api/admin/stats/monthly?year=${u}`,{headers:t});if(T.ok){const C=await T.json();g(C);return}}catch{}const E=window;E&&E.__ADMIN_MONTHLY__&&g(E.__ADMIN_MONTHLY__)})()},[n,u,t]);const v=S.useMemo(()=>p?_wt.map((b,E)=>{var T,C,R,N,O;return{month:b,Users:((T=p.users)==null?void 0:T[E])??0,Pages:((C=p.pages)==null?void 0:C[E])??0,Groups:((R=p.groups)==null?void 0:R[E])??0,Events:((N=p.events)==null?void 0:N[E])??0,Posts:((O=p.posts)==null?void 0:O[E])??0}}):[],[p]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"rounded-2xl bg-white ring-1 ring-black/5 shadow-sm p-5 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(MVe,{className:"h-6 w-6 text-slate-700"}),c.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Dashboard"})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("select",{value:u,onChange:b=>h(Number(b.target.value)),className:"h-9 rounded-lg border border-slate-200 px-3 text-sm",children:[0,1,2,3,4].map(b=>{const E=new Date().getFullYear()-b;return c.jsx("option",{value:E,children:E},E)})})})]}),c.jsxs("div",{className:"rounded-2xl bg-white ring-1 ring-black/5 shadow-sm p-5",children:[c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(fU,{className:"h-5 w-5 text-slate-700"}),c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Monthly Average"})]})}),c.jsx("div",{className:"h-[340px]",children:c.jsx(m3,{width:"100%",height:"100%",children:c.jsxs(Z3,{data:v,children:[c.jsx(lO,{strokeDasharray:"3 3"}),c.jsx(E_,{dataKey:"month"}),c.jsx(w_,{}),c.jsx(Oc,{}),c.jsx(jd,{}),c.jsx(Wo,{dataKey:"Users",fill:"#3b82f6"}),c.jsx(Wo,{dataKey:"Pages",fill:"#22c55e"}),c.jsx(Wo,{dataKey:"Groups",fill:"#f59e0b"}),c.jsx(Wo,{dataKey:"Events",fill:"#ef4444"}),c.jsx(Wo,{dataKey:"Posts",fill:"#8b5cf6"})]})})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[c.jsx(AE,{title:"Users",value:(i==null?void 0:i.totalUsers)??"—",gradient:"from-indigo-500 to-blue-500",Icon:uy}),c.jsx(AE,{title:"Online",value:(i==null?void 0:i.online)??"—",gradient:"from-cyan-500 to-sky-500",Icon:c4e}),c.jsx(AE,{title:"Pending",value:(i==null?void 0:i.pendingUsers)??"—",gradient:"from-orange-400 to-amber-500",Icon:j4}),c.jsx(AE,{title:"Not Activated",value:(i==null?void 0:i.notActivated)??"—",gradient:"from-rose-500 to-pink-500",Icon:YVe})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[c.jsx(AE,{title:"Banned",value:(i==null?void 0:i.banned)??"—",gradient:"from-red-500 to-rose-700",Icon:FVe}),c.jsx(_u,{title:"Total Visits",value:(i==null?void 0:i.totalVisits)??"—",gradient:"from-slate-700 to-slate-900",Icon:X2}),c.jsx(_u,{title:"Today Visits",value:(i==null?void 0:i.todayVisits)??"—",gradient:"from-indigo-500 to-violet-500",Icon:X2}),c.jsx(_u,{title:"This Month Visits",value:(i==null?void 0:i.monthVisits)??"—",gradient:"from-cyan-500 to-teal-600",Icon:X2})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[c.jsx(_u,{title:"Posts",value:(i==null?void 0:i.posts)??"—",gradient:"from-violet-500 to-fuchsia-500",Icon:ly}),c.jsx(_u,{title:"Comments",value:(i==null?void 0:i.comments)??"—",gradient:"from-emerald-500 to-teal-600",Icon:Mw}),c.jsx(_u,{title:"Pages",value:(i==null?void 0:i.pages)??"—",gradient:"from-blue-500 to-indigo-600",Icon:SN}),c.jsx(_u,{title:"Groups",value:(i==null?void 0:i.groups)??"—",gradient:"from-sky-500 to-cyan-600",Icon:l4e}),c.jsx(_u,{title:"Events",value:(i==null?void 0:i.events)??"—",gradient:"from-amber-500 to-orange-600",Icon:O4}),c.jsx(_u,{title:"Messages",value:(i==null?void 0:i.messages)??"—",gradient:"from-pink-500 to-rose-600",Icon:JVe}),c.jsx(_u,{title:"Notifications",value:(i==null?void 0:i.notifications)??"—",gradient:"from-lime-500 to-emerald-600",Icon:kVe})]})]})}const $f="https://api.gada.chat";async function Ewt(e,t){const n=await fetch(`${$f}/api/admin/users/${t}`,{headers:e});if(!n.ok)throw new Error("Failed to load user");return(await n.json()).data}async function wwt(e,t,n){const i=await fetch(`${$f}/api/admin/users/${t}/profile`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(n)});if(!i.ok)throw new Error("Failed to update profile");return i.json()}async function Swt(e,t,n){const i=await fetch(`${$f}/api/admin/users/${t}/balances`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(n)});if(!i.ok)throw new Error("Failed to adjust balances");return i.json()}async function xwt(e,t){var i;const n=await fetch(`${$f}/api/admin/users/${t}/membership`,{headers:e});if(!n.ok)throw new Error("Failed to load membership");return((i=await n.json())==null?void 0:i.data)||[]}async function Twt(e,t){const n=await fetch(`${$f}/api/admin/users/${t}/membership`,{headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to fetch membership");return n.json()}async function Cwt(e){const t=await fetch(`${$f}/api/admin/users/packages/list`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch packages");return t.json()}async function Rwt(e,t,n){const i=await fetch(`${$f}/api/admin/users/${t}/membership/plan`,{method:"POST",headers:e,credentials:"include",body:JSON.stringify(n)});if(!i.ok)throw new Error("Failed to update membership plan");return i.json()}async function Nwt(e,t){const n=await fetch(`${$f}/api/admin/users/${t}/membership/unsubscribe`,{method:"POST",headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to unsubscribe");return n.json()}function lR(e){return`₦${Number(e??0).toLocaleString(void 0,{maximumFractionDigits:2})}`}function Qie(e){if(!e)return"-";try{return new Date(e).toLocaleDateString(void 0,{day:"numeric",month:"long",year:"numeric"})}catch{return e}}function Awt(e){if(!e)return null;const t=new Date(e).getTime()-Date.now();return Math.max(0,Math.ceil(t/(1e3*60*60*24)))}function Iwt({userId:e,open:t,onOpenChange:n,onSaved:i}){const{accessToken:o}=st(),u=wt(o),[h,p]=S.useState(!1),[g,v]=S.useState("profile"),[b,E]=S.useState(null),[T,C]=S.useState([]),[R,N]=S.useState({}),[O,k]=S.useState(null),[j,P]=S.useState([]),[M,D]=S.useState("");S.useEffect(()=>{!t||!e||U()},[t,e]);async function U(){try{p(!0);const X=await Ewt(u,e);E(X),N({username:X.username,email:X.email,phone:X.phone||"",firstName:X.firstName||"",lastName:X.lastName||"",gender:X.gender||"",birthdate:X.birthdate?String(X.birthdate).slice(0,10):"",bio:X.bio||"",website:X.website||""});const de=await xwt(u,e);C(de);const[we,ge]=await Promise.all([Twt(u,e),Cwt(u)]);console.log(we,ge),we.data&&(k(we.data),D(we!=null&&we.packageId?String(we.packageId):"")),ge&&P(ge.data||[])}catch(X){console.error(X),Ce.error(X.message||"Failed to load user"),n(!1)}finally{p(!1)}}async function V(){if(b)try{await wwt(u,b.id,R),Ce.success("Profile updated"),await U(),i==null||i()}catch(X){console.error(X),Ce.error(X.message||"Failed to update")}}const[z,W]=S.useState(""),[Y,Q]=S.useState(""),[K,q]=S.useState("");async function ee(){if(b){if(!z&&!Y)return Ce.message("Nothing to change");try{await Swt(u,b.id,{walletDelta:z?Number(z):0,pointsDelta:Y?Number(Y):0,reason:K||"admin adjustment"}),Ce.success("Balances updated"),W(""),Q(""),q(""),await U(),i==null||i()}catch(X){console.error(X),Ce.error(X.message||"Failed to update balances")}}}async function oe(){if(b)try{await Nwt(u,b.id),Ce.success("User unsubscribed"),await U(),i==null||i()}catch(X){console.error(X),Ce.error(X.message||"Failed to unsubscribe")}}async function ae(){if(!b)return;if(!M){Ce.message("Please select a package");return}const X=Number(M);if((O==null?void 0:O.packageId)===X){Ce.message("No changes to save");return}try{await Rwt(u,b.id,{packageId:X}),Ce.success("Membership updated"),await U(),i==null||i()}catch(de){console.error(de),Ce.error(de.message||"Failed to update membership")}}const J=S.useMemo(()=>{const X=(O==null?void 0:O.usage.boostedPostsUsed)??0,de=(O==null?void 0:O.limits.boostPostsLimit)??0;return de>0?Math.min(100,Math.round(X/de*100)):0},[O]),re=S.useMemo(()=>{const X=(O==null?void 0:O.usage.boostedPagesUsed)??0,de=(O==null?void 0:O.limits.boostPagesLimit)??0;return de>0?Math.min(100,Math.round(X/de*100)):0},[O]);return c.jsx(B1,{open:t,onOpenChange:n,children:c.jsxs(Gw,{className:"w-full sm:max-w-2xl overflow-hidden",children:[c.jsx(uB,{children:c.jsxs(dB,{children:["Edit User ",b?`#${b.id}`:""]})}),c.jsx("div",{className:"mt-4 flex flex-col gap-4 h-[85vh]",children:c.jsxs(Am,{value:g,onValueChange:X=>v(X),className:"flex-1 flex flex-col",children:[c.jsxs(jf,{className:"self-start",children:[c.jsx(Ia,{value:"profile",children:"Profile"}),c.jsx(Ia,{value:"balances",children:"Balances"}),c.jsx(Ia,{value:"membership",children:"Membership"})]}),c.jsxs(fi,{value:"profile",className:"flex-1 overflow-y-auto pr-1",children:[h&&c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"}),!h&&b&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Username"}),c.jsx(Ne,{value:R.username||"",onChange:X=>N({...R,username:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Email"}),c.jsx(Ne,{type:"email",value:R.email||"",onChange:X=>N({...R,email:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"First name"}),c.jsx(Ne,{value:R.firstName||"",onChange:X=>N({...R,firstName:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Last name"}),c.jsx(Ne,{value:R.lastName||"",onChange:X=>N({...R,lastName:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Phone"}),c.jsx(Ne,{value:R.phone||"",onChange:X=>N({...R,phone:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Gender"}),c.jsx(Ne,{value:R.gender||"",onChange:X=>N({...R,gender:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Birthdate"}),c.jsx(Ne,{type:"date",value:R.birthdate||"",onChange:X=>N({...R,birthdate:X.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Website"}),c.jsx(Ne,{value:R.website||"",onChange:X=>N({...R,website:X.target.value})})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Bio"}),c.jsx("textarea",{className:"w-full rounded-md border p-2 text-sm",rows:4,value:R.bio||"",onChange:X=>N({...R,bio:X.target.value})})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Wallet: ",c.jsx("b",{children:lR(b.wallet)})," · Points: ",c.jsx("b",{children:b.points.toFixed(0)})]}),c.jsx(be,{onClick:V,children:"Save profile"})]})]})]}),c.jsx(fi,{value:"balances",className:"flex-1 overflow-y-auto pr-1",children:b?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"rounded-lg border p-3 bg-white",children:[c.jsx("div",{className:"text-sm mb-2",children:"Current Balances"}),c.jsxs("div",{className:"flex gap-6 text-sm",children:[c.jsxs("div",{children:["Wallet: ",c.jsx("b",{children:lR(b.wallet)})]}),c.jsxs("div",{children:["Points: ",c.jsx("b",{children:b.points.toFixed(0)})]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Wallet Δ (±)"}),c.jsx(Ne,{type:"number",value:z,onChange:X=>W(X.target.value),placeholder:"e.g. 1000 or -500"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Points Δ (±)"}),c.jsx(Ne,{type:"number",value:Y,onChange:X=>Q(X.target.value),placeholder:"e.g. 50 or -20"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Reason"}),c.jsx(Ne,{value:K,onChange:X=>q(X.target.value),placeholder:"admin adjustment"})]})]}),c.jsx(be,{onClick:ee,children:"Apply"})]}):c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"})}),c.jsx(fi,{value:"membership",className:"flex-1 overflow-y-auto pr-1",children:c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[c.jsx("div",{className:"text-sm font-semibold mb-4",children:"PACKAGE DETAILS"}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-3",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Package"}),c.jsx("div",{className:"col-span-12 sm:col-span-9 text-[15px] font-medium",children:O!=null&&O.packageName?`${O.packageName} (${lR(O.price)} per ${(O==null?void 0:O.period_num)??0} ${(O==null?void 0:O.period)??""})`:"—"})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-3",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Subscription Date"}),c.jsx("div",{className:"col-span-12 sm:col-span-9",children:Qie(O==null?void 0:O.subscribedAt)})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-3",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Expiration Date"}),c.jsx("div",{className:"col-span-12 sm:col-span-9",children:O!=null&&O.expiresAt?c.jsxs(c.Fragment,{children:[Qie(O.expiresAt)," ",c.jsxs("span",{className:"text-gray-500",children:["(Remaining ",Awt(O.expiresAt)," Days)"]})]}):"—"})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-2",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Boosted Posts"}),c.jsxs("div",{className:"col-span-12 sm:col-span-9",children:[c.jsxs("div",{className:"text-sm mb-1",children:[(O==null?void 0:O.usage.boostedPostsUsed)??0,"/",(O==null?void 0:O.limits.boostPostsLimit)??0]}),c.jsx("div",{className:"h-3 w-full rounded-full bg-gray-200 overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full bg-[#8b5cf6]",style:{width:`${J}%`}})})]})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-4",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Boosted Pages"}),c.jsxs("div",{className:"col-span-12 sm:col-span-9",children:[c.jsxs("div",{className:"text-sm mb-1",children:[(O==null?void 0:O.usage.boostedPagesUsed)??0,"/",(O==null?void 0:O.limits.boostPagesLimit)??0]}),c.jsx("div",{className:"h-3 w-full rounded-full bg-gray-200 overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full bg-[#8b5cf6]",style:{width:`${re}%`}})})]})]}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsx(be,{variant:"destructive",onClick:oe,disabled:!(O!=null&&O.active),children:"Unsubscribe"})})]}),c.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[c.jsx("div",{className:"text-sm font-semibold mb-4",children:"UPGRADE PACKAGE"}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Select Package"}),c.jsx("div",{className:"col-span-12 sm:col-span-9",children:c.jsxs("select",{className:"w-full rounded-md border px-3 py-2 text-sm",value:M,onChange:X=>D(X.target.value),children:[c.jsx("option",{value:"",children:"— Select —"}),j.map(X=>c.jsxs("option",{value:X.package_id,children:[X.name," (",lR(X.price)," per ",X.period_num," ",X.period,")"]},X.package_id))]})})]}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(be,{onClick:ae,children:"Save Changes"})})]})]})})]})})]})})}const eM="https://api.gada.chat";function Owt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState([]),[o,u]=S.useState(0),[h,p]=S.useState(1),[g,v]=S.useState(10),[b,E]=S.useState(""),[T,C]=S.useState("createdAt"),[R,N]=S.useState("desc"),[O,k]=S.useState(!1),j=S.useMemo(()=>Math.max(1,Math.ceil(o/g)),[o,g]),[P,M]=S.useState(null),[D,U]=S.useState(!1);function V(K){M(K),U(!0)}async function z(){k(!0);try{const K=new URLSearchParams({page:String(h),limit:String(g),search:b,sort:T,dir:R}),q=await fetch(`${eM}/api/admin/users?${K.toString()}`,{headers:t});if(!q.ok)throw new Error("Failed to load users");const ee=await q.json();console.log(ee,"datadatadata"),i(ee.items??[]),u(ee.total??0)}catch(K){Ce.error(K.message||"Failed to load users")}finally{k(!1)}}S.useEffect(()=>{z()},[h,g,b,T,R,e]);function W(K){return(K==null?void 0:K.user_banned)===1||(K==null?void 0:K.user_banned)==="1"||(K==null?void 0:K.banned)===!0}async function Y(K,q,ee){const oe=await fetch(`${eM}/api/admin/users/${K}/suspend`,{method:"POST",headers:ee,body:JSON.stringify({banned:q})});if(!oe.ok){const ae=await oe.text().catch(()=>"");throw new Error(ae||"Suspend request failed")}return oe.json()}const Q=async K=>{try{const q=new URLSearchParams({search:b,sort:T,dir:R,format:K}),ee=await fetch(`${eM}/api/admin/users/export?${q.toString()}`,{headers:t});if(!ee.ok)throw new Error("Export failed");const oe=await ee.blob(),ae=URL.createObjectURL(oe),J=document.createElement("a");J.href=ae,J.download=K==="csv"?"users.csv":"users.json",document.body.appendChild(J),J.click(),J.remove(),URL.revokeObjectURL(ae),Ce.success("Export prepared")}catch(q){Ce.error(q.message||"Export failed")}};return c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx(Ne,{placeholder:"Search username or email…",value:b,onChange:K=>{p(1),E(K.target.value)},className:"w-full md:w-80"}),c.jsxs(Pr,{value:T,onValueChange:K=>C(K),children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{placeholder:"Sort by"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"createdAt",children:"Created"}),c.jsx(ft,{value:"email",children:"Email"}),c.jsx(ft,{value:"username",children:"Username"})]})]}),c.jsxs(Pr,{value:R,onValueChange:K=>N(K),children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Dir"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"desc",children:"Desc"}),c.jsx(ft,{value:"asc",children:"Asc"})]})]}),c.jsx(be,{onClick:()=>z(),disabled:O,children:"Search"}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsxs(Pr,{value:String(g),onValueChange:K=>{v(Number(K)),p(1)},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]}),c.jsx(be,{variant:"outline",onClick:()=>Q("csv"),children:"Export CSV"}),c.jsx(be,{variant:"outline",onClick:()=>Q("json"),children:"Export JSON"})]})]}),c.jsx("div",{className:"rounded-md border bg-white",children:c.jsxs(ya,{className:"table-fixed",children:[c.jsx(_a,{className:"sticky top-0 bg-white z-10",children:c.jsxs(nn,{children:[c.jsx(et,{className:"w-48",children:"User"}),c.jsx(et,{className:"w-72",children:"Email"}),c.jsx(et,{className:"w-48",children:"Created"}),c.jsx(et,{className:"w-32",children:"Role"}),c.jsx(et,{className:"w-28",children:"Status"}),c.jsx(et,{className:"w-48",children:"Actions"})]})}),c.jsxs(ba,{children:[n.map(K=>c.jsxs(nn,{children:[c.jsx(He,{className:"whitespace-nowrap truncate",children:K.username}),c.jsx(He,{className:"whitespace-nowrap truncate",children:K.email}),c.jsx(He,{className:"whitespace-nowrap",children:new Date(K.createdAt).toLocaleString()}),c.jsx(He,{className:"whitespace-nowrap",children:c.jsx("span",{className:"inline-flex items-center rounded-full border px-2 py-0.5 text-xs capitalize",children:K.role??"user"})}),c.jsx(He,{className:"whitespace-nowrap",children:W(K)?c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-red-50 text-red-700 border border-red-200",children:"Suspended"}):c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Active"})}),c.jsx(He,{className:"whitespace-nowrap",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>V(K.id),children:"Edit"}),c.jsx(be,{size:"sm",className:W(K)?"bg-slate-600 hover:bg-slate-700":"bg-red-500 hover:bg-red-600",onClick:async()=>{try{const q=!W(K),ee=await Y(K.id,q,t);console.log(ee,"respresp"),i(oe=>oe.map(ae=>ae.id===K.id?{...ae,user_banned:ee.banned?"1":"0",banned:ee.banned}:ae)),Ce.success(ee.banned?"User suspended":"User unsuspended")}catch(q){Ce.error((q==null?void 0:q.message)||"Failed to update user")}},children:W(K)?"Unsuspend":"Suspend"})]})})]},K.id)),!n.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:6,className:"text-center py-10 text-gray-500",children:"No users found"})})]})]})}),c.jsx(Iwt,{userId:P,open:D,onOpenChange:U,onSaved:()=>{}}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",h," of ",j," — ",o," users"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>p(K=>Math.max(1,K-1)),disabled:h<=1||O,children:"Prev"}),c.jsx(be,{variant:"outline",onClick:()=>p(K=>Math.min(j,K+1)),disabled:h>=j||O,children:"Next"})]})]})]})}const lye="https://api.gada.chat";async function Pwt(e){const t=await fetch(`${lye}/api/admin/settings`,{headers:e});if(!t.ok)throw new Error("Failed to load settings");return t.json()}async function kwt(e,t,n){const i=await fetch(`${lye}/api/admin/settings/${e}`,{method:"PUT",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const o=await i.json().catch(()=>({}));throw new Error(o.error||"Failed to update settings")}}function jwt(){var g,v,b,E,T,C,R,N,O,k,j,P,M,D,U;const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(null),[o,u]=S.useState("general"),h=S.useMemo(()=>"Authorization"in t,[t]);if(S.useEffect(()=>{h&&Pwt(t).then(i).catch(V=>Ce.error("Failed to load settings",{description:V.message}))},[h]),!n)return c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:"Loading settings…"});const p=async(V,z)=>{try{await kwt(V,z,t),i(W=>W&&{...W,[V]:{...z}}),Ce.success("Saved",{description:`Updated ${V} settings.`})}catch(W){Ce.error("Save failed",{description:W==null?void 0:W.message})}};return c.jsx("div",{className:"bg-white rounded-xl shadow-sm border h-full overflow-hidden flex flex-col",children:c.jsxs(Am,{value:o,onValueChange:V=>u(V),className:"flex h-full flex-col",children:[c.jsx("div",{className:"sticky top-0 z-10 bg-white/90 backdrop-blur border-b",children:c.jsx("div",{className:"px-3 sm:px-4 md:px-6",children:c.jsx(jf,{className:`
                !bg-transparent p-0 h-auto
                w-full md:w-auto
                flex flex-wrap md:flex-nowrap gap-2 items-end
                overflow-x-auto hide-scrollbar
                border-b-0
              `,children:["general","features","moderation","storage","email","security"].map(V=>c.jsx(Ia,{value:V,className:`
                    rounded-md
                    px-3 md:px-4 py-2
                    text-sm font-medium whitespace-nowrap
                    text-gray-600
                    data-[state=active]:text-gray-900
                    data-[state=active]:bg-white
                    data-[state=active]:border
                  `,children:V[0].toUpperCase()+V.slice(1)},V))})})}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 sm:p-4 md:p-6 pt-6",children:[c.jsxs(fi,{value:"general",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Site Name"}),c.jsx(Ne,{defaultValue:((g=n.general)==null?void 0:g.siteName)||"",id:"siteName"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Site URL"}),c.jsx(Ne,{defaultValue:((v=n.general)==null?void 0:v.siteUrl)||"",id:"siteUrl"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Zi,{defaultChecked:!!((b=n.general)!=null&&b.allowSignups),id:"allowSignups"}),c.jsx(Je,{htmlFor:"allowSignups",children:"Allow new signups"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var Y,Q,K;const V=(Y=document.getElementById("siteName"))==null?void 0:Y.value,z=(Q=document.getElementById("siteUrl"))==null?void 0:Q.value,W=(K=document.getElementById("allowSignups"))==null?void 0:K.checked;p("general",{siteName:V,siteUrl:z,allowSignups:W})},children:"Save"})})]}),c.jsxs(fi,{value:"features",className:"m-0",children:[c.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:[["stories","Stories"],["reels","Reels"],["groups","Groups"],["payments","Payments"]].map(([V,z])=>{var W;return c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Zi,{id:`f-${V}`,defaultChecked:!!((W=n.features)!=null&&W[V])}),c.jsx(Je,{htmlFor:`f-${V}`,children:z})]},V)})}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var Q,K,q,ee;const V=(Q=document.getElementById("f-stories"))==null?void 0:Q.checked,z=(K=document.getElementById("f-reels"))==null?void 0:K.checked,W=(q=document.getElementById("f-groups"))==null?void 0:q.checked,Y=(ee=document.getElementById("f-payments"))==null?void 0:ee.checked;p("features",{stories:V,reels:z,groups:W,payments:Y})},children:"Save"})})]}),c.jsxs(fi,{value:"moderation",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Max Post Length"}),c.jsx(Ne,{type:"number",defaultValue:((E=n.moderation)==null?void 0:E.maxPostLength)??5e3,id:"maxPostLength"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Bad Words (comma separated)"}),c.jsx(Ne,{defaultValue:(((T=n.moderation)==null?void 0:T.badWords)||[]).join(", "),id:"badWords"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var W,Y;const V=Number((W=document.getElementById("maxPostLength"))==null?void 0:W.value)||5e3,z=(Y=document.getElementById("badWords"))==null?void 0:Y.value.split(",").map(Q=>Q.trim()).filter(Boolean);p("moderation",{maxPostLength:V,badWords:z})},children:"Save"})})]}),c.jsxs(fi,{value:"storage",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Max upload (MB)"}),c.jsx(Ne,{type:"number",defaultValue:((C=n.storage)==null?void 0:C.maxUploadMB)??20,id:"maxUploadMB"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Allowed Image MIME (comma separated)"}),c.jsx(wi,{defaultValue:(((R=n.storage)==null?void 0:R.allowedImageMime)||[]).join(", "),id:"imgMime"})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Je,{children:"Allowed Video MIME (comma separated)"}),c.jsx(wi,{defaultValue:(((N=n.storage)==null?void 0:N.allowedVideoMime)||[]).join(", "),id:"vidMime"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var Y,Q,K;const V=Number((Y=document.getElementById("maxUploadMB"))==null?void 0:Y.value)||20,z=(Q=document.getElementById("imgMime"))==null?void 0:Q.value.split(",").map(q=>q.trim()).filter(Boolean),W=(K=document.getElementById("vidMime"))==null?void 0:K.value.split(",").map(q=>q.trim()).filter(Boolean);p("storage",{maxUploadMB:V,allowedImageMime:z,allowedVideoMime:W})},children:"Save"})})]}),c.jsxs(fi,{value:"email",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"From Name"}),c.jsx(Ne,{defaultValue:((O=n.email)==null?void 0:O.fromName)||"",id:"fromName"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"From Email"}),c.jsx(Ne,{defaultValue:((k=n.email)==null?void 0:k.fromEmail)||"",id:"fromEmail"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"SMTP Host"}),c.jsx(Ne,{defaultValue:((j=n.email)==null?void 0:j.smtpHost)||"",id:"smtpHost"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"SMTP Port"}),c.jsx(Ne,{type:"number",defaultValue:((P=n.email)==null?void 0:P.smtpPort)??587,id:"smtpPort"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"SMTP User"}),c.jsx(Ne,{defaultValue:((M=n.email)==null?void 0:M.smtpUser)||"",id:"smtpUser"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"SMTP Password"}),c.jsx(Ne,{type:"password",defaultValue:((D=n.email)==null?void 0:D.smtpPassword)||"",id:"smtpPassword"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"If you see ********, leaving it unchanged will keep the existing secret."})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var q,ee,oe,ae,J,re;const V=(q=document.getElementById("fromName"))==null?void 0:q.value,z=(ee=document.getElementById("fromEmail"))==null?void 0:ee.value,W=(oe=document.getElementById("smtpHost"))==null?void 0:oe.value,Y=Number((ae=document.getElementById("smtpPort"))==null?void 0:ae.value)||587,Q=(J=document.getElementById("smtpUser"))==null?void 0:J.value,K=(re=document.getElementById("smtpPassword"))==null?void 0:re.value;p("email",{fromName:V,fromEmail:z,smtpHost:W,smtpPort:Y,smtpUser:Q,smtpPassword:K})},children:"Save"})})]}),c.jsxs(fi,{value:"security",className:"m-0",children:[c.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Je,{children:"CORS Origins (one per line)"}),c.jsx(wi,{id:"corsOrigins",defaultValue:(((U=n.security)==null?void 0:U.corsOrigins)||[]).join(`
`),rows:5})]})}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var z;const V=(z=document.getElementById("corsOrigins"))==null?void 0:z.value.split(`
`).map(W=>W.trim()).filter(Boolean);p("security",{corsOrigins:V})},children:"Save"})})]})]})]})})}const S_="https://api.gada.chat";async function Dwt(e){const t=await fetch(`${S_}api/admin/profile/me`,{headers:e});if(!t.ok)throw new Error("Failed to fetch profile");return t.json()}async function Lwt(e,t){const n=await fetch(`${S_}api/admin/profile`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.error||"Failed to update profile")}}async function Mwt(e,t,n){const i=await fetch(`${S_}api/admin/profile/password`,{method:"PUT",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({oldPassword:e,newPassword:t})});if(!i.ok){const o=await i.json().catch(()=>({}));throw new Error(o.error||"Failed to change password")}}async function Uwt(e,t){const n=new FormData;n.append("avatar",e);const i=await fetch(`${S_}api/admin/profile/avatar`,{method:"PUT",headers:t,body:n});if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.error||"Upload failed")}const{avatarUrl:o}=await i.json();return o}async function Fwt(e){const t=await fetch(`${S_}api/admin/profile/sessions`,{headers:e});if(!t.ok)throw new Error("Failed to load sessions");return t.json()}async function Vwt(e,t){if(!(await fetch(`${S_}api/admin/profile/sessions/${e}`,{method:"DELETE",headers:t})).ok)throw new Error("Failed to revoke session")}function Bwt({me:e,onUpdated:t}){const{accessToken:n}=st(),i=Hl(n);console.log(i,"headersheaders");const[o,u]=S.useState({username:e.username||"",firstname:e.firstname||"",lastname:e.lastname||"",email:e.email||"",bio:e.bio||"",timezone:e.timezone||""}),[h,p]=S.useState(!1),g=b=>E=>u(T=>({...T,[b]:E.target.value})),v=async()=>{p(!0);try{await Lwt(o,i),t({...e,...o}),Ce.success("Profile updated")}catch(b){Ce.error("Update failed",{description:b==null?void 0:b.message})}finally{p(!1)}};return c.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Username"}),c.jsx(Ne,{value:o.username,onChange:g("username")})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Email"}),c.jsx(Ne,{value:o.email,onChange:g("email"),type:"email"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"First name"}),c.jsx(Ne,{value:o.firstname,onChange:g("firstname")})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Last name"}),c.jsx(Ne,{value:o.lastname,onChange:g("lastname")})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Je,{children:"Bio"}),c.jsx(wi,{value:o.bio,onChange:g("bio"),rows:3})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Je,{children:"Timezone"}),c.jsx(Ne,{value:o.timezone,onChange:g("timezone"),placeholder:"e.g. Asia/Kolkata"})]}),c.jsx("div",{className:"sm:col-span-2",children:c.jsx(be,{onClick:v,disabled:h,children:h?"Saving…":"Save"})})]})}function $wt(e){var n;if(!e)return"A";const t=e.split(" ");return(t[0][0]+(((n=t[1])==null?void 0:n[0])||"")).toUpperCase()}function Wwt({me:e,onUpdated:t}){const{accessToken:n}=st(),i=wt(n),o=S.useRef(null),[u,h]=S.useState(null),[p,g]=S.useState(!1),v=()=>{var C;return(C=o.current)==null?void 0:C.click()},b=C=>{var O;const R=(O=C.target.files)==null?void 0:O[0];if(!R)return;const N=URL.createObjectURL(R);h(N)},E=async()=>{var R,N;const C=(N=(R=o.current)==null?void 0:R.files)==null?void 0:N[0];if(!C)return Ce.error("Please choose an image first");g(!0);try{const O=await Uwt(C,i);t({...e,profileImage:O}),Ce.success("Avatar updated"),h(null),o.current&&(o.current.value="")}catch(O){Ce.error("Upload failed",{description:O==null?void 0:O.message})}finally{g(!1)}},T=u||e.profileImage||"";return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx($i,{className:"h-20 w-20",children:T?c.jsx(Oi,{src:T,alt:e.username}):c.jsx(Qi,{children:$wt(e.username)})}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(be,{variant:"outline",onClick:v,children:"Choose image"}),c.jsx(be,{onClick:E,disabled:!u||p,children:p?"Saving…":"Save"}),c.jsx("input",{ref:o,type:"file",accept:"image/*",className:"hidden",onChange:b})]})]}),u&&c.jsx("p",{className:"text-xs text-gray-500",children:"Preview shown. Click “Save” to upload."})]})}function Gwt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(""),[o,u]=S.useState(""),[h,p]=S.useState(!1),g=async()=>{if(o.length<8)return Ce.error("New password must be at least 8 characters");p(!0);try{await Mwt(n,o,t),Ce.success("Password changed"),i(""),u("")}catch(v){Ce.error("Failed",{description:v==null?void 0:v.message})}finally{p(!1)}};return c.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Old password"}),c.jsx(Ne,{type:"password",value:n,onChange:v=>i(v.target.value)})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"New password"}),c.jsx(Ne,{type:"password",value:o,onChange:v=>u(v.target.value)})]}),c.jsx("div",{className:"sm:col-span-2",children:c.jsx(be,{onClick:g,disabled:h,children:h?"Saving…":"Change password"})})]})}function Hwt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState([]),[o,u]=S.useState(!0),h=async()=>{u(!0);try{i(await Fwt(t))}catch(g){Ce.error("Failed to load sessions",{description:g==null?void 0:g.message})}finally{u(!1)}};S.useEffect(()=>{h()},[]);const p=async g=>{try{await Vwt(g,t),Ce.success("Session revoked"),i(v=>v.filter(b=>b.id!==g))}catch(v){Ce.error("Failed",{description:v==null?void 0:v.message})}};return o?c.jsx("div",{children:"Loading…"}):n.length?c.jsx("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Device"}),c.jsx(et,{children:"IP"}),c.jsx(et,{children:"Last Seen"}),c.jsx(et,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:n.map(g=>c.jsxs(nn,{children:[c.jsx(He,{className:"max-w-[320px] truncate",children:g.userAgent}),c.jsx(He,{children:g.ip}),c.jsx(He,{children:new Date(g.lastSeen||g.createdAt).toLocaleString()}),c.jsx(He,{className:"text-right",children:c.jsx(be,{variant:"destructive",size:"sm",onClick:()=>p(g.id),children:"Revoke"})})]},g.id))})]})}):c.jsx("div",{className:"text-gray-500",children:"No other active sessions."})}function zwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState(null),[u,h]=S.useState("profile");return S.useEffect(()=>{n&&Dwt(t).then(o).catch(p=>Ce.error("Failed to load admin profile",{description:p.message}))},[n]),i?c.jsx("div",{className:"bg-white rounded-xl shadow-sm border h-full overflow-hidden flex flex-col",children:c.jsxs(Am,{value:u,onValueChange:p=>h(p),className:"flex flex-col h-full",children:[c.jsx("div",{className:"sticky top-0 z-10 bg-white/90 backdrop-blur border-b",children:c.jsx("div",{className:"px-3 sm:px-4 md:px-6",children:c.jsxs(jf,{className:"!bg-transparent p-0 h-auto w-full flex flex-wrap gap-2 overflow-x-auto",children:[c.jsx(Ia,{value:"profile",children:"Profile"}),c.jsx(Ia,{value:"avatar",children:"Avatar"}),c.jsx(Ia,{value:"password",children:"Password"}),c.jsx(Ia,{value:"sessions",children:"Sessions"})]})})}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 sm:p-4 md:p-6",children:[c.jsx(fi,{value:"profile",className:"m-0",children:c.jsx(Bwt,{me:i,onUpdated:o})}),c.jsx(fi,{value:"avatar",className:"m-0",children:c.jsx(Wwt,{me:i,onUpdated:o})}),c.jsx(fi,{value:"password",className:"m-0",children:c.jsx(Gwt,{})}),c.jsx(fi,{value:"sessions",className:"m-0",children:c.jsx(Hwt,{})})]})]})}):c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:"Loading…"})}const Lm=({className:e,...t})=>c.jsx("nav",{role:"navigation","aria-label":"pagination",className:kt("mx-auto flex w-full justify-center",e),...t});Lm.displayName="Pagination";const Mm=S.forwardRef(({className:e,...t},n)=>c.jsx("ul",{ref:n,className:kt("flex flex-row items-center gap-1",e),...t}));Mm.displayName="PaginationContent";const Xn=S.forwardRef(({className:e,...t},n)=>c.jsx("li",{ref:n,className:kt("",e),...t}));Xn.displayName="PaginationItem";const na=({className:e,isActive:t,size:n="icon",...i})=>c.jsx("a",{"aria-current":t?"page":void 0,className:kt(sle({variant:t?"outline":"ghost",size:n}),e),...i});na.displayName="PaginationLink";const Um=({className:e,...t})=>c.jsxs(na,{"aria-label":"Go to previous page",size:"default",className:kt("gap-1 pl-2.5",e),...t,children:[c.jsx(P4,{className:"h-4 w-4"}),c.jsx("span",{children:"Previous"})]});Um.displayName="PaginationPrevious";const Fm=({className:e,...t})=>c.jsxs(na,{"aria-label":"Go to next page",size:"default",className:kt("gap-1 pr-2.5",e),...t,children:[c.jsx("span",{children:"Next"}),c.jsx(Lw,{className:"h-4 w-4"})]});Fm.displayName="PaginationNext";const tM="https://api.gada.chat";function nM({label:e,value:t,gradient:n}){return c.jsxs("div",{className:`rounded-3xl p-6 text-white shadow-sm bg-gradient-to-r ${n} relative overflow-hidden`,children:[c.jsx("div",{className:"text-4xl md:text-5xl font-extrabold tracking-tight",children:typeof t=="number"?t.toLocaleString():t}),c.jsx("div",{className:"mt-2 text-xl opacity-95",children:e}),c.jsx("div",{className:"absolute -right-10 -bottom-10 w-40 h-40 rounded-full bg-white/15 pointer-events-none"})]})}function Kwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState("all"),[p,g]=S.useState(""),[v,b]=S.useState(1),[E,T]=S.useState(10),[C,R]=S.useState(0),[N,O]=S.useState(1),[k,j]=S.useState(!1),[P,M]=S.useState(!1),[D,U]=S.useState({totalPosts:0,pendingPosts:0,totalComments:0,totalReactions:0}),V=async()=>{try{const q=await fetch(`${tM}/api/admin/posts/metrics`,{headers:t});if(!q.ok)throw new Error("Failed to load stats");const ee=await q.json();U({totalPosts:Number(ee.totalPosts||0),pendingPosts:Number(ee.pendingPosts||0),totalComments:Number(ee.totalComments||0),totalReactions:Number(ee.totalReactions||0)})}catch(q){console.warn("[admin posts] metrics load failed:",q==null?void 0:q.message)}},z=async()=>{try{const q=new URLSearchParams({status:u,search:p,page:String(v),limit:String(E)}),ee=await fetch(`${tM}/api/admin/posts?${q.toString()}`,{headers:t});if(!ee.ok)throw new Error("Failed to load posts");const oe=await ee.json();o(oe.items||[]),R(oe.total||0),O(oe.totalPages||1),j(!!oe.hasPrev),M(!!oe.hasNext)}catch(q){Ce.error("Load failed",{description:q==null?void 0:q.message})}};function W(q){if(!q)return"";const ee=new Date(q);return Number.isNaN(ee)?String(q):ee.toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}S.useEffect(()=>{n&&V()},[n]),S.useEffect(()=>{n&&z()},[n,u,v,E]);const Y=async(q,ee)=>{try{if(!(await fetch(`${tM}/api/admin/posts/${q}`,{method:"DELETE",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({action:ee})})).ok)throw new Error("Action failed");Ce.success("Post has been deleted"),z(),V()}catch(oe){Ce.error("Failed",{description:oe==null?void 0:oe.message})}};function Q(q,ee){const oe=[],ae=X=>oe.push(X);if(ee<=7){for(let X=1;X<=ee;X++)ae(X);return oe}ae(1),q>3&&ae("…");const J=Math.max(2,q-1),re=Math.min(ee-1,q+1);for(let X=J;X<=re;X++)ae(X);return q<ee-2&&ae("…"),ae(ee),oe}const K=Q(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[c.jsx(nM,{label:"Posts",value:D.totalPosts,gradient:"from-fuchsia-600 to-purple-500"}),c.jsx(nM,{label:"Comments",value:D.totalComments,gradient:"from-indigo-500 to-violet-500"}),c.jsx(nM,{label:"Reactions",value:D.totalReactions,gradient:"from-sky-500 to-blue-500"})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsx(Ne,{placeholder:"Search content/author",value:p,onChange:q=>g(q.target.value),onKeyDown:q=>q.key==="Enter"&&(b(1),z()),className:"w-full sm:w-64"}),c.jsx(be,{onClick:()=>{b(1),z()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:q=>{b(1),T(Number(q))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"ID"}),c.jsx(et,{children:"Author"}),c.jsx(et,{children:"Type"}),c.jsx(et,{children:"Likes"}),c.jsx(et,{children:"Comments"}),c.jsx(et,{children:"Link"}),c.jsx(et,{children:"Datetime"}),c.jsx(et,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.map(q=>c.jsxs(nn,{children:[c.jsx(He,{children:q.id}),c.jsx(He,{children:q.authorUsername}),c.jsx(He,{children:q.type}),c.jsx(He,{children:q.likeCount}),c.jsx(He,{children:q.commentCount}),c.jsx(He,{children:c.jsx(Nt,{target:"_blank",to:`/posts/${q.id}`,children:"View"})}),c.jsx(He,{children:W(q.createdAt)}),c.jsx(He,{className:"text-right space-x-2",children:c.jsx(be,{size:"sm",variant:"destructive",onClick:async()=>{window.confirm("Are you sure you want to Delete this?")&&await Y(q.id,"remove")},children:"Remove"})})]},q.id))})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(Lm,{children:c.jsxs(Mm,{children:[c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Xn,{children:c.jsx(Um,{onClick:()=>b(q=>Math.max(1,q-1)),className:k?"":"pointer-events-none opacity-50"})}),K.map((q,ee)=>q==="…"?c.jsx(Xn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${ee}`):c.jsx(Xn,{children:c.jsx(na,{isActive:q===v,onClick:()=>b(q),children:q})},q)),c.jsx(Xn,{children:c.jsx(Fm,{onClick:()=>b(q=>Math.min(N,q+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]})]})}const eae="https://api.gada.chat";function qwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),i=tr(),[o,u]=S.useState([]),[h,p]=S.useState(""),g=async()=>{const b=new URLSearchParams;h.trim()&&b.set("search",h.trim());const E=await fetch(`${eae}/api/admin/page-categories?`+b,{headers:t});if(!E.ok)return Ce.error("Failed to load categories");const T=await E.json();u(T||[])};S.useEffect(()=>{n&&g()},[n]);const v=async(b,E)=>{if(!confirm(`Delete category "${E}"?`))return;const T=await fetch(`${eae}/api/admin/page-categories/${b}`,{method:"DELETE",headers:t});if(!T.ok){const C=await T.json().catch(()=>({}));return Ce.error((C==null?void 0:C.error)||"Delete failed")}Ce.success("Deleted"),g()};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Pages › Categories"}),c.jsx(be,{onClick:()=>i("/admin/page-categories/new"),children:"+ Add New Category"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ne,{placeholder:"Search by name or description",value:h,onChange:b=>p(b.target.value),onKeyDown:b=>b.key==="Enter"&&g(),className:"w-full sm:w-96"}),c.jsx(be,{onClick:g,children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Title"}),c.jsx(et,{children:"Description"}),c.jsx(et,{className:"w-24",children:"Order"}),c.jsx(et,{className:"w-40",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(b=>c.jsxs(nn,{children:[c.jsxs(He,{className:"align-top",children:[c.jsx("div",{className:"font-medium",children:b.name}),b.parentId?c.jsxs("div",{className:"text-xs text-gray-500",children:["Child of #",b.parentId]}):c.jsx("div",{className:"text-xs text-gray-500",children:"Parent"})]}),c.jsx(He,{className:"align-top",children:b.description||c.jsx("span",{className:"text-gray-400",children:"—"})}),c.jsx(He,{className:"align-top",children:c.jsx("span",{className:"inline-flex items-center rounded-full bg-cyan-100 text-cyan-700 px-2 py-0.5 text-xs font-medium",children:b.order})}),c.jsxs(He,{className:"align-top space-x-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>i(`/admin/page-categories/${b.id}`),children:"Edit"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>v(b.id,b.name),children:"Delete"})]})]},b.id)),!o.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:4,className:"text-center text-gray-500",children:"No categories found"})})]})]})})]})}const uR="https://api.gada.chat";function tae(){const{id:e}=tc(),t=!!e,n=tr(),{accessToken:i}=st(),o=wt(i),u=S.useMemo(()=>"Authorization"in o,[o]),[h,p]=S.useState(""),[g,v]=S.useState(""),[b,E]=S.useState(0),[T,C]=S.useState(0),[R,N]=S.useState([]),O=async()=>{const M=await(await fetch(`${uR}/api/admin/page-categories/options`,{headers:o})).json();N(M||[])},k=async()=>{if(!t)return;const P=await fetch(`${uR}/api/admin/page-categories/${e}`,{headers:o});if(!P.ok){Ce.error("Category not found");return}const M=await P.json();p(M.name||""),v(M.description||""),E(Number(M.parentId||0)),C(Number(M.order||0))};S.useEffect(()=>{u&&(O(),k())},[u]);const j=async()=>{if(!h.trim())return Ce.error("Name is required");const P={name:h.trim(),description:g,parentId:b,order:T},M=t?`${uR}/api/admin/page-categories/${e}`:`${uR}/api/admin/page-categories`,U=await fetch(M,{method:t?"PUT":"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(P)});if(!U.ok){const V=await U.json().catch(()=>({}));return Ce.error((V==null?void 0:V.error)||"Save failed")}Ce.success("Saved"),n("/admin/page-categories")};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Pages › Categories › ",t?"Edit Category":"Add New Category"]}),c.jsx(be,{variant:"outline",onClick:()=>n("/admin/page-categories"),children:"Go Back"})]}),c.jsxs("div",{className:"space-y-6 max-w-3xl",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Name"}),c.jsx(Ne,{value:h,onChange:P=>p(P.target.value),placeholder:"Enter name"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(wi,{rows:4,value:g,onChange:P=>v(P.target.value),placeholder:"Optional description"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Parent Category"}),c.jsxs(Pr,{value:String(b),onValueChange:P=>E(Number(P)),children:[c.jsx(Cr,{className:"w-full sm:w-96",children:c.jsx(kr,{placeholder:"Set as a Parent Category"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"0",children:"Set as a Parent Category"}),R.map(P=>c.jsx(ft,{value:String(P.id),children:P.name},P.id))]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Order"}),c.jsx(Ne,{type:"number",value:T,onChange:P=>C(Number(P.target.value||0)),className:"w-40"})]}),c.jsx("div",{children:c.jsx(be,{onClick:j,children:"Save Changes"})})]})]})}const rM="https://api.gada.chat";function iM({label:e,value:t,gradient:n}){return c.jsxs("div",{className:`rounded-3xl p-6 text-white shadow-sm bg-gradient-to-r ${n} relative overflow-hidden`,children:[c.jsx("div",{className:"text-4xl md:text-5xl font-extrabold tracking-tight",children:typeof t=="number"?t.toLocaleString():t}),c.jsx("div",{className:"mt-2 text-xl opacity-95",children:e}),c.jsx("div",{className:"absolute -right-10 -bottom-10 w-40 h-40 rounded-full bg-white/15 pointer-events-none"})]})}function Ywt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState(""),[p,g]=S.useState("all"),[v,b]=S.useState(1),[E,T]=S.useState(10),[C,R]=S.useState(0),[N,O]=S.useState(1),[k,j]=S.useState(!1),[P,M]=S.useState(!1),[D,U]=S.useState({totalGroups:0,publicGroups:0,closedGroups:0,secretGroups:0,totalMembers:0}),V=async()=>{try{const q=await fetch(`${rM}/api/admin/groups/metrics`,{headers:t});if(!q.ok)throw new Error("Failed to load metrics");const ee=await q.json();U({totalGroups:Number(ee.totalGroups||0),publicGroups:Number(ee.publicGroups||0),closedGroups:Number(ee.closedGroups||0),secretGroups:Number(ee.secretGroups||0),totalMembers:Number(ee.totalMembers||0)})}catch(q){console.warn("[admin groups] metrics failed:",q==null?void 0:q.message)}},z=async()=>{try{const q=new URLSearchParams({search:u,privacy:p,page:String(v),limit:String(E)}),ee=await fetch(`${rM}/api/admin/groups?${q.toString()}`,{headers:t});if(!ee.ok)throw new Error("Failed to load groups");const oe=await ee.json();o(oe.items||[]),R(Number(oe.total||0)),O(Number(oe.totalPages||1)),j(!!oe.hasPrev),M(!!oe.hasNext)}catch(q){Ce.error("Load failed",{description:q==null?void 0:q.message})}};S.useEffect(()=>{n&&V()},[n]),S.useEffect(()=>{n&&z()},[n,p,v,E]);const W=async q=>{if(window.confirm("Delete this group permanently? This cannot be undone."))try{if(!(await fetch(`${rM}/api/admin/groups/${q}`,{method:"DELETE",headers:t})).ok)throw new Error("Delete failed");Ce.success("Group deleted"),z(),V()}catch(ee){Ce.error("Failed",{description:ee==null?void 0:ee.message})}},Y=q=>{if(!q)return"";const ee=new Date(q);return Number.isNaN(ee)?String(q):ee.toLocaleString()};function Q(q,ee){const oe=[],ae=X=>oe.push(X);if(ee<=7){for(let X=1;X<=ee;X++)ae(X);return oe}ae(1),q>3&&ae("…");const J=Math.max(2,q-1),re=Math.min(ee-1,q+1);for(let X=J;X<=re;X++)ae(X);return q<ee-2&&ae("…"),ae(ee),oe}const K=Q(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[c.jsx(iM,{label:"Groups",value:D.totalGroups,gradient:"from-fuchsia-600 to-purple-500"}),c.jsx(iM,{label:"Public Groups",value:D.publicGroups,gradient:"from-indigo-500 to-violet-500"}),c.jsx(iM,{label:"Total Members",value:D.totalMembers,gradient:"from-sky-500 to-blue-500"})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsxs(Pr,{value:p,onValueChange:q=>{b(1),g(q)},children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{placeholder:"Privacy"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"all",children:"All privacy"}),c.jsx(ft,{value:"public",children:"Public"}),c.jsx(ft,{value:"closed",children:"Closed"}),c.jsx(ft,{value:"secret",children:"Secret"})]})]}),c.jsx(Ne,{placeholder:"Search by title / web address",value:u,onChange:q=>h(q.target.value),onKeyDown:q=>q.key==="Enter"&&(b(1),z()),className:"w-full sm:w-72"}),c.jsx(be,{onClick:()=>{b(1),z()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:q=>{b(1),T(Number(q))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{className:"w-16",children:"ID"}),c.jsx(et,{children:"Group"}),c.jsx(et,{children:"Admin"}),c.jsx(et,{children:"Privacy"}),c.jsx(et,{children:"Members"}),c.jsx(et,{children:"Link"}),c.jsx(et,{children:"Created"}),c.jsx(et,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.map(q=>c.jsxs(nn,{children:[c.jsx(He,{children:q.id}),c.jsx(He,{className:"max-w-[360px] truncate",children:q.title}),c.jsx(He,{children:q.adminUsername||"-"}),c.jsx(He,{className:"capitalize",children:q.privacy||"public"}),c.jsx(He,{children:(q.membersCount??0).toLocaleString()}),c.jsx(He,{children:q.slug?c.jsx(Nt,{target:"_blank",to:`/groups/${q.slug}`,children:"View"}):c.jsx(Nt,{target:"_blank",to:`/groups/${q.id}`,children:"View"})}),c.jsx(He,{children:Y(q.createdAt)}),c.jsx(He,{className:"text-right space-x-2",children:c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>W(q.id),children:"Delete"})})]},q.id))})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(Lm,{children:c.jsxs(Mm,{children:[c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Xn,{children:c.jsx(Um,{onClick:()=>b(q=>Math.max(1,q-1)),className:k?"":"pointer-events-none opacity-50"})}),K.map((q,ee)=>q==="…"?c.jsx(Xn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${ee}`):c.jsx(Xn,{children:c.jsx(na,{isActive:q===v,onClick:()=>b(q),children:q})},q)),c.jsx(Xn,{children:c.jsx(Fm,{onClick:()=>b(q=>Math.min(N,q+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]})]})}const nae="https://api.gada.chat";function Xwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),i=tr(),[o,u]=S.useState([]),[h,p]=S.useState(""),g=async()=>{const b=new URLSearchParams;h.trim()&&b.set("search",h.trim());const E=await fetch(`${nae}/api/admin/group-categories?`+b,{headers:t});if(!E.ok)return Ce.error("Failed to load categories");const T=await E.json();u(T||[])};S.useEffect(()=>{n&&g()},[n]);const v=async(b,E)=>{if(!confirm(`Delete category "${E}"?`))return;const T=await fetch(`${nae}/api/admin/group-categories/${b}`,{method:"DELETE",headers:t});if(!T.ok){const C=await T.json().catch(()=>({}));return Ce.error((C==null?void 0:C.error)||"Delete failed")}Ce.success("Deleted"),g()};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Groups › Categories"}),c.jsx(be,{onClick:()=>i("/admin/group-categories/new"),children:"+ Add New Category"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ne,{placeholder:"Search by name or description",value:h,onChange:b=>p(b.target.value),onKeyDown:b=>b.key==="Enter"&&g(),className:"w-full sm:w-96"}),c.jsx(be,{onClick:g,children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Title"}),c.jsx(et,{children:"Description"}),c.jsx(et,{className:"w-24",children:"Order"}),c.jsx(et,{className:"w-40",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(b=>c.jsxs(nn,{children:[c.jsxs(He,{className:"align-top",children:[c.jsx("div",{className:"font-medium",children:b.name}),b.parentId?c.jsxs("div",{className:"text-xs text-gray-500",children:["Child of #",b.parentId]}):c.jsx("div",{className:"text-xs text-gray-500",children:"Parent"})]}),c.jsx(He,{className:"align-top",children:b.description||c.jsx("span",{className:"text-gray-400",children:"—"})}),c.jsx(He,{className:"align-top",children:c.jsx("span",{className:"inline-flex items-center rounded-full bg-cyan-100 text-cyan-700 px-2 py-0.5 text-xs font-medium",children:b.order})}),c.jsxs(He,{className:"align-top space-x-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>i(`/admin/group-categories/${b.id}`),children:"Edit"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>v(b.id,b.name),children:"Delete"})]})]},b.id)),!o.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:4,className:"text-center text-gray-500",children:"No categories found"})})]})]})})]})}const dR="https://api.gada.chat";function rae(){const{id:e}=tc(),t=!!e,n=tr(),{accessToken:i}=st(),o=wt(i),u=S.useMemo(()=>"Authorization"in o,[o]),[h,p]=S.useState(""),[g,v]=S.useState(""),[b,E]=S.useState(0),[T,C]=S.useState(0),[R,N]=S.useState([]),O=async()=>{const M=await(await fetch(`${dR}/api/admin/group-categories/options`,{headers:o})).json();N(M||[])},k=async()=>{if(!t)return;const P=await fetch(`${dR}/api/admin/group-categories/${e}`,{headers:o});if(!P.ok){Ce.error("Category not found");return}const M=await P.json();p(M.name||""),v(M.description||""),E(Number(M.parentId||0)),C(Number(M.order||0))};S.useEffect(()=>{u&&(O(),k())},[u]);const j=async()=>{if(!h.trim())return Ce.error("Name is required");const P={name:h.trim(),description:g,parentId:b,order:T},M=t?`${dR}/api/admin/group-categories/${e}`:`${dR}/api/admin/group-categories`,U=await fetch(M,{method:t?"PUT":"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(P)});if(!U.ok){const V=await U.json().catch(()=>({}));return Ce.error((V==null?void 0:V.error)||"Save failed")}Ce.success("Saved"),n("/admin/group-categories")};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Groups › Categories › ",t?"Edit Category":"Add New Category"]}),c.jsx(be,{variant:"outline",onClick:()=>n("/admin/group-categories"),children:"Go Back"})]}),c.jsxs("div",{className:"space-y-6 max-w-3xl",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Name"}),c.jsx(Ne,{value:h,onChange:P=>p(P.target.value),placeholder:"Enter name"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(wi,{rows:4,value:g,onChange:P=>v(P.target.value),placeholder:"Optional description"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Parent Category"}),c.jsxs(Pr,{value:String(b),onValueChange:P=>E(Number(P)),children:[c.jsx(Cr,{className:"w-full sm:w-96",children:c.jsx(kr,{placeholder:"Set as a Parent Category"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"0",children:"Set as a Parent Category"}),R.map(P=>c.jsx(ft,{value:String(P.id),children:P.name},P.id))]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Order"}),c.jsx(Ne,{type:"number",value:T,onChange:P=>C(Number(P.target.value||0)),className:"w-40"})]}),c.jsx("div",{children:c.jsx(be,{onClick:j,children:"Save Changes"})})]})]})}const aM="https://api.gada.chat";function Jwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),i=tr(),[o,u]=S.useState([]),[h,p]=S.useState(""),[g,v]=S.useState(1),[b,E]=S.useState(1),T=async(R=1)=>{const N=new URLSearchParams({page:String(R),limit:"20"});h.trim()&&N.set("search",h.trim());const O=await fetch(`${aM}/api/admin/events?${N}`,{headers:t});if(!O.ok)return Ce.error("Failed to load events");const k=await O.json();u(k.items||[]),v(k.page||1),E(k.totalPages||1)};S.useEffect(()=>{n&&T(1)},[n]);const C=async(R,N)=>{if(!confirm(`Delete event "${N}"?`))return;if(!(await fetch(`${aM}/api/admin/events/${R}`,{method:"DELETE",headers:t})).ok)return Ce.error("Delete failed");Ce.success("Deleted"),T(g)};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Events"}),c.jsx(be,{onClick:()=>i("/admin/events/new"),children:"+ Add Event"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ne,{placeholder:"Search by title or admin",value:h,onChange:R=>p(R.target.value),onKeyDown:R=>R.key==="Enter"&&T(1),className:"w-full sm:w-96"}),c.jsx(be,{onClick:()=>T(1),children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{className:"w-12",children:"ID"}),c.jsx(et,{children:"Event"}),c.jsx(et,{children:"Admin"}),c.jsx(et,{children:"Privacy"}),c.jsx(et,{className:"text-right",children:"Interested"}),c.jsx(et,{className:"text-right",children:"Going"}),c.jsx(et,{className:"text-right",children:"Invited"}),c.jsx(et,{className:"w-40 text-right",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(R=>c.jsxs(nn,{children:[c.jsx(He,{children:R.id}),c.jsxs(He,{children:[c.jsx("div",{className:"font-medium",children:R.title}),c.jsxs("div",{className:"text-xs text-gray-500",children:[R.startsAt?Id(new Date(R.startsAt),"PPp"):"",R.endsAt?` — ${Id(new Date(R.endsAt),"PPp")}`:"",R.location?` · ${R.location}`:""]})]}),c.jsx(He,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[R.adminAvatar?c.jsx("img",{src:`${aM}/uploads/${R.adminAvatar}`,alt:"",className:"h-6 w-6 rounded-full object-cover bg-gray-100"}):c.jsx("div",{className:"h-6 w-6 rounded-full bg-gray-200"}),c.jsx("span",{className:"text-sm",children:R.adminName})]})}),c.jsx(He,{className:"capitalize",children:R.privacy}),c.jsx(He,{className:"text-right",children:R.interestedCount}),c.jsx(He,{className:"text-right",children:R.goingCount}),c.jsx(He,{className:"text-right",children:R.invitedCount}),c.jsxs(He,{className:"text-right space-x-2",children:[c.jsx(Nt,{to:`/admin/events/${R.id}`,children:c.jsx(be,{size:"sm",variant:"outline",children:"Edit"})}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>C(R.id,R.title),children:"Delete"})]})]},R.id)),!o.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:8,className:"text-center text-gray-500",children:"No events found"})})]})]})}),c.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[c.jsx(be,{variant:"outline",disabled:g<=1,onClick:()=>T(g-1),children:"Prev"}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",g," / ",b]}),c.jsx(be,{variant:"outline",disabled:g>=b,onClick:()=>T(g+1),children:"Next"})]})]})}const hR="https://api.gada.chat";function iae(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const n=i=>String(i).padStart(2,"0");return`${t.getFullYear()}-${n(t.getMonth()+1)}-${n(t.getDate())}T${n(t.getHours())}:${n(t.getMinutes())}`}function aae(){const{id:e}=tc(),t=!!e,n=tr(),{accessToken:i,user:o}=st(),u=wt(i),h=S.useMemo(()=>"Authorization"in u,[u]),[p,g]=S.useState(""),[v,b]=S.useState(""),[E,T]=S.useState("public"),[C,R]=S.useState(""),[N,O]=S.useState(""),[k,j]=S.useState(""),[P,M]=S.useState(null),[D,U]=S.useState(""),[V,z]=S.useState([]),[W,Y]=S.useState(!1),Q=oe=>{if(console.log(oe.parentId,"c.parentId"),!oe.parentId)return oe.name;const ae=V.find(J=>J.id===oe.parentId);return ae?`${ae.name} / ${oe.name}`:oe.name},K=async()=>{Y(!0);try{const oe=await fetch(`${hR}/api/admin/events/categories`,{headers:u});if(!oe.ok)throw new Error("Failed");const ae=await oe.json();z(Array.isArray(ae)?ae:[])}catch{Ce.error("Failed to load categories")}finally{Y(!1)}},q=async()=>{if(!t)return;const oe=await fetch(`${hR}/api/admin/events/${e}`,{headers:u});if(!oe.ok)return Ce.error("Not found");const ae=await oe.json();g(ae.title||""),b(ae.description||""),T(ae.privacy||"public"),R(iae(ae.startsAt)),O(iae(ae.endsAt)),j(ae.location||""),M(ae.category_id||null),U(ae.cover||"")};S.useEffect(()=>{h&&(async()=>(await K(),await q()))()},[h]);const ee=async()=>{if(!p.trim())return Ce.error("Title is required");if(!C)return Ce.error("Start date/time is required");const oe={adminId:o==null?void 0:o.userId,title:p.trim(),description:v,privacy:E,startsAt:new Date(C).toISOString(),endsAt:N?new Date(N).toISOString():null,location:k,categoryId:P,cover:D},ae=t?`${hR}/api/admin/events/${e}`:`${hR}/api/admin/events`,re=await fetch(ae,{method:t?"PUT":"POST",headers:{...u,"Content-Type":"application/json"},body:JSON.stringify(oe)});if(!re.ok){const X=await re.json().catch(()=>({}));return Ce.error((X==null?void 0:X.error)||"Save failed")}Ce.success("Saved"),n("/admin/events")};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Events › ",t?"Edit":"Add New"]}),c.jsx(be,{variant:"outline",onClick:()=>n("/admin/events"),children:"Go Back"})]}),c.jsxs("div",{className:"space-y-6 max-w-3xl",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Title"}),c.jsx(Ne,{value:p,onChange:oe=>g(oe.target.value),placeholder:"Event title"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(wi,{rows:4,value:v,onChange:oe=>b(oe.target.value),placeholder:"Optional description"})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Privacy"}),c.jsxs(Pr,{value:E,onValueChange:T,children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:"public/private"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"public",children:"Public"}),c.jsx(ft,{value:"private",children:"Private"})]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Category (optional)"}),V?c.jsxs(Pr,{value:String(P??""),onValueChange:oe=>M(oe?Number(oe):null),disabled:W,children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:W?"Loading…":"Select a category"})}),c.jsx(Rr,{children:V.map(oe=>c.jsx(ft,{value:String(oe.id),children:Q(oe)},oe.id))})]}):""]})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Starts At"}),c.jsx(Ne,{type:"datetime-local",value:C,onChange:oe=>R(oe.target.value)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Ends At (optional)"}),c.jsx(Ne,{type:"datetime-local",value:N,onChange:oe=>O(oe.target.value)})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Location (optional)"}),c.jsx(Ne,{value:k,onChange:oe=>j(oe.target.value),placeholder:"City / Venue"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Cover (path/url – optional)"}),c.jsx(Ne,{value:D,onChange:oe=>U(oe.target.value),placeholder:"uploads/2025/08/cover.jpg"})]}),c.jsx("div",{children:c.jsx(be,{onClick:ee,children:"Save Changes"})})]})]})}const fR="https://api.gada.chat";function sae(){const{id:e}=tc(),t=!!e,n=tr(),{accessToken:i}=st(),o=wt(i),u=S.useMemo(()=>"Authorization"in o,[o]),[h,p]=S.useState(""),[g,v]=S.useState(""),[b,E]=S.useState("0"),[T,C]=S.useState(1),[R,N]=S.useState([]),O=async()=>{const P=await fetch(`${fR}/api/admin/events-categories/select`,{headers:o});P.ok&&N(await P.json())},k=async()=>{if(!t)return;const P=await fetch(`${fR}/api/admin/events-categories/${e}`,{headers:o});if(!P.ok)return Ce.error("Not found");const M=await P.json();p(M.name||""),v(M.description??""),E(String(M.parentId??0)),C(M.order??1)};S.useEffect(()=>{u&&(O(),k())},[u]);const j=async()=>{if(!h.trim())return Ce.error("Name is required");const P={name:h.trim(),description:g??"",parentId:Number(b||0),order:Number.isFinite(T)&&T>=1?T:1},M=t?`${fR}/api/admin/events-categories/${e}`:`${fR}/api/admin/events-categories`,U=await fetch(M,{method:t?"PUT":"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(P)});if(!U.ok){const V=await U.json().catch(()=>({}));return Ce.error((V==null?void 0:V.error)||"Save failed")}Ce.success("Saved"),n("/admin/events/categories")};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Events › Categories › ",t?"Edit":"Add New"]}),c.jsx(be,{asChild:!0,variant:"outline",children:c.jsx(Nt,{to:"/admin/events/categories",children:"Go Back"})})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 max-w-3xl space-y-5",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Name"}),c.jsx(Ne,{value:h,onChange:P=>p(P.target.value),placeholder:"e.g. Conferences"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(wi,{rows:3,value:g,onChange:P=>v(P.target.value),placeholder:"Optional (may be empty)"})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Parent Category"}),c.jsxs(Pr,{value:b,onValueChange:E,children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:"Set as a Parent Category"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"0",children:"— (Top Level)"}),R.filter(P=>String(P.id)!==String(e)).map(P=>c.jsx(ft,{value:String(P.id),children:P.name},P.id))]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Order"}),c.jsx(Ne,{type:"number",min:1,value:String(T),onChange:P=>C(Number(P.target.value||1))})]})]}),c.jsx("div",{children:c.jsx(be,{onClick:j,children:"Save Changes"})})]})]})}const oae="https://api.gada.chat";function Zwt(){var O,k;const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=Jy(),[u,h]=S.useState(i.get("q")||""),[p,g]=S.useState(Number(i.get("page")||1)),[v,b]=S.useState(null),[E,T]=S.useState(!1),C=async()=>{T(!0);try{const j=await fetch(`${oae}/api/admin/events-categories?search=${encodeURIComponent(u)}&page=${p}&limit=25`,{headers:t});if(!j.ok)throw new Error;b(await j.json())}catch{Ce.error("Failed to load categories")}finally{T(!1)}};S.useEffect(()=>{n&&C()},[n,p]);const R=j=>{j.preventDefault(),g(1),o(P=>(P.set("q",u),P.set("page","1"),P)),C()},N=async j=>{if(confirm("Delete this category? This cannot be undone."))try{const P=await fetch(`${oae}/api/admin/events-categories/${j}`,{method:"DELETE",headers:t});if(!P.ok){const M=await P.json().catch(()=>({}));return Ce.error((M==null?void 0:M.error)||"Delete failed")}Ce.success("Deleted"),C()}catch{Ce.error("Delete failed")}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-lg font-semibold",children:"Events › Categories"}),c.jsx(be,{asChild:!0,children:c.jsx(Nt,{to:"/admin/events-categories/new",children:"+ Add New Category"})})]}),c.jsxs("form",{onSubmit:R,className:"flex gap-2",children:[c.jsx(Ne,{value:u,onChange:j=>h(j.target.value),placeholder:"Search by name or description"}),c.jsx(be,{type:"submit",variant:"secondary",children:"Search"})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-left border-b",children:[c.jsx("th",{className:"p-3",children:"Title"}),c.jsx("th",{className:"p-3",children:"Parent"}),c.jsx("th",{className:"p-3",children:"Order"}),c.jsx("th",{className:"p-3",children:"Used"}),c.jsx("th",{className:"p-3",children:"Children"}),c.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),c.jsxs("tbody",{children:[E&&c.jsx("tr",{children:c.jsx("td",{className:"p-4",colSpan:6,children:"Loading…"})}),!E&&((O=v==null?void 0:v.items)==null?void 0:O.length)===0&&c.jsx("tr",{children:c.jsx("td",{className:"p-4",colSpan:6,children:"No categories"})}),!E&&((k=v==null?void 0:v.items)==null?void 0:k.map(j=>c.jsxs("tr",{className:"border-b",children:[c.jsxs("td",{className:"p-3",children:[c.jsx("div",{className:"font-medium",children:j.name}),j.description&&c.jsx("div",{className:"text-xs text-gray-500 line-clamp-2",children:j.description})]}),c.jsx("td",{className:"p-3",children:j.parentId===0?"—":j.parentName||"—"}),c.jsx("td",{className:"p-3",children:j.order}),c.jsx("td",{className:"p-3",children:j.usedCount}),c.jsx("td",{className:"p-3",children:j.childCount}),c.jsx("td",{className:"p-3 text-right",children:c.jsxs("div",{className:"inline-flex gap-2",children:[c.jsx(be,{asChild:!0,size:"sm",variant:"outline",children:c.jsx(Nt,{to:`/admin/events-categories/${j.id}`,children:"Edit"})}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>N(j.id),children:"Delete"})]})})]},j.id)))]})]})}),v&&v.totalPages>1&&c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:p<=1,onClick:()=>g(j=>j-1),children:"Prev"}),c.jsxs("div",{className:"text-sm",children:["Page ",p," / ",v.totalPages]}),c.jsx(be,{variant:"outline",size:"sm",disabled:p>=v.totalPages,onClick:()=>g(j=>j+1),children:"Next"})]})]})}const sM="https://api.gada.chat";function Qwt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState(0),[p,g]=S.useState(1),[v,b]=S.useState(1),[E,T]=S.useState(10),[C,R]=S.useState(!1),[N,O]=S.useState(!1),[k,j]=S.useState("0"),[P,M]=S.useState("all"),[D,U]=S.useState(""),[V,z]=S.useState(""),[W,Y]=S.useState(""),Q=J=>`₦${(J||0).toLocaleString()}`,K=async()=>{try{const J=new URLSearchParams({page:String(v),pageSize:String(E),status:k,method:P});D&&J.set("q",D),V&&J.set("startDate",V),W&&J.set("endDate",W);const re=await fetch(`${sM}/api/wallet/withdrawals/admin?${J.toString()}`,{headers:t});if(!re.ok)throw new Error(await re.text());const X=await re.json();o(X.items||[]),h(X.total||0),g(X.totalPages||1),R(!!X.hasPrev),O(!!X.hasNext)}catch(J){Ce.error("Failed to load withdrawal requests",{description:J==null?void 0:J.message})}};S.useEffect(()=>{n&&K()},[n,v,E,k,P]);const q=async J=>{try{const re=await fetch(`${sM}/api/wallet/withdrawals/${J}/approve`,{method:"POST",headers:t});if(!re.ok)throw new Error(await re.text());Ce.success("Request approved"),K()}catch(re){Ce.error("Approve failed",{description:re==null?void 0:re.message})}},ee=async J=>{try{const re=await fetch(`${sM}/api/wallet/withdrawals/${J}/decline`,{method:"POST",headers:t});if(!re.ok)throw new Error(await re.text());Ce.success("Request declined"),K()}catch(re){Ce.error("Decline failed",{description:re==null?void 0:re.message})}},oe=()=>{j("0"),M("all"),U(""),z(""),Y(""),b(1),K()};function ae(J,re){const X=[],de=Te=>X.push(Te);if(re<=7){for(let Te=1;Te<=re;Te++)de(Te);return X}de(1),J>3&&de("…");const we=Math.max(2,J-1),ge=Math.min(re-1,J+1);for(let Te=we;Te<=ge;Te++)de(Te);return J<re-2&&de("…"),de(re),X}return ae(v,p),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 lg:items-end justify-between mb-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 w-full",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Status"}),c.jsxs(Pr,{value:k,onValueChange:J=>{j(J),b(1)},children:[c.jsx(Cr,{className:"w-full",children:c.jsx(kr,{placeholder:"Status"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"0",children:"Pending"}),c.jsx(ft,{value:"1",children:"Approved"}),c.jsx(ft,{value:"-1",children:"Declined"}),c.jsx(ft,{value:"all",children:"All"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Method"}),c.jsxs(Pr,{value:P,onValueChange:J=>{M(J),b(1)},children:[c.jsx(Cr,{className:"w-full",children:c.jsx(kr,{placeholder:"Method"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"all",children:"All"}),c.jsx(ft,{value:"bank",children:"Bank"}),c.jsx(ft,{value:"gada_token",children:"gada token"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),c.jsx(Ne,{type:"date",value:V,onChange:J=>{z(J.target.value),b(1)}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"End Date"}),c.jsx(Ne,{type:"date",value:W,onChange:J=>{Y(J.target.value),b(1)}})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Search"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Ne,{placeholder:"User / handle / transfer to",value:D,onChange:J=>U(J.target.value),onKeyDown:J=>J.key==="Enter"&&(b(1),K())}),c.jsx(be,{onClick:()=>(b(1),K()),children:"Search"}),c.jsx(be,{variant:"secondary",onClick:oe,children:"Clear"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(Pr,{value:String(E),onValueChange:J=>{T(Number(J)),b(1)},children:[c.jsx(Cr,{className:"w-32",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]}),c.jsxs("div",{className:"text-sm text-gray-500 min-w-[140px] text-right",children:[u.toLocaleString()," total"]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"ID"}),c.jsx(et,{children:"User"}),c.jsx(et,{children:"Handle"}),c.jsx(et,{children:"Method"}),c.jsx(et,{children:"Amount"}),c.jsx(et,{children:"Transfer To"}),c.jsx(et,{children:"Time"}),c.jsx(et,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.length?i.map(J=>c.jsxs(nn,{children:[c.jsx(He,{children:J.id}),c.jsx(He,{children:J.user_name}),c.jsx(He,{children:J.handle}),c.jsx(He,{className:"capitalize",children:J.method}),c.jsx(He,{children:Q(Number(J.amount))}),c.jsx(He,{className:"truncate max-w-[260px]",title:J.transferTo,children:J.transferTo}),c.jsx(He,{children:new Date(J.time).toLocaleString()}),c.jsxs(He,{className:"text-right space-x-2",children:[c.jsx(be,{size:"sm",onClick:()=>q(J.id),children:"Approve"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>ee(J.id),children:"Reject"})]})]},J.id)):c.jsx(nn,{children:c.jsx(He,{colSpan:8,className:"text-center text-gray-500",children:"No requests found"})})})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",u]}),c.jsx(Lm,{children:c.jsxs(Mm,{children:[c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Xn,{children:c.jsx(Um,{onClick:()=>b(J=>Math.max(1,J-1)),className:C?"":"pointer-events-none opacity-50"})}),ae(v,p).map((J,re)=>J==="…"?c.jsx(Xn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${re}`):c.jsx(Xn,{children:c.jsx(na,{isActive:J===v,onClick:()=>b(J),children:J})},J)),c.jsx(Xn,{children:c.jsx(Fm,{onClick:()=>b(J=>Math.min(p,J+1)),className:N?"":"pointer-events-none opacity-50"})}),c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(p),"aria-disabled":v===p,className:v===p?"pointer-events-none opacity-50":"",children:"Last"})})]})})]})]})}const cS="https://api.gada.chat";async function eSt(e){const t=await fetch(`${cS}/api/admin/payment-settings`,{headers:e});if(!t.ok)throw new Error(await t.text());return(await t.json()).data}async function tSt(e,t){const n=await fetch(`${cS}/api/admin/payment-settings/fees`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function nSt(e,t){const n=await fetch(`${cS}/api/admin/payment-settings/vat`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function rSt(e,t){const n=await fetch(`${cS}/api/admin/payment-settings/bank`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function iSt(e,t){const n=await fetch(`${cS}/api/admin/payment-settings/paystack`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}function aSt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(!0),[o,u]=S.useState({}),[h,p]=S.useState(!1),[g,v]=S.useState(0),[b,E]=S.useState(!1),[T,C]=S.useState(!1),[R,N]=S.useState(0),[O,k]=S.useState(!1),[j,P]=S.useState(""),[M,D]=S.useState(""),[U,V]=S.useState(""),[z,W]=S.useState(""),[Y,Q]=S.useState(""),[K,q]=S.useState(!1),[ee,oe]=S.useState("");S.useEffect(()=>{(async()=>{try{const de=await eSt(t);u(de),p(!!de.payment_fees_enabled),v(Number(de.payment_fees_percentage||0)),E(!!de.payment_vat_enabled),C(!!de.payment_country_vat_enabled),N(Number(de.payment_vat_percentage||0)),k(!!de.bank_transfers_enabled),P(de.bank_name||""),D(de.bank_account_number||""),V(de.bank_account_name||""),W(de.bank_account_country||""),Q(de.bank_transfer_note||""),q(!!de.paystack_enabled),oe(de.paystack_secret||"")}catch(de){console.error(de),Ce.error("Failed to load payment settings")}finally{i(!1)}})()},[]);const ae=async()=>{try{await tSt(t,{payment_fees_enabled:h,payment_fees_percentage:Number(g||0)}),Ce.success("Fees settings saved")}catch(de){Ce.error("Failed to save fees",{description:de==null?void 0:de.message})}},J=async()=>{try{await nSt(t,{payment_vat_enabled:b,payment_country_vat_enabled:T,payment_vat_percentage:Number(R||0)}),Ce.success("VAT settings saved")}catch(de){Ce.error("Failed to save VAT",{description:de==null?void 0:de.message})}},re=async()=>{try{await rSt(t,{bank_transfers_enabled:O,bank_name:j,bank_account_number:M,bank_account_name:U,bank_account_country:z,bank_transfer_note:Y}),Ce.success("Bank transfer settings saved")}catch(de){Ce.error("Failed to save bank transfer settings",{description:de==null?void 0:de.message})}},X=async()=>{try{await iSt(t,{paystack_enabled:K,paystack_secret:ee}),Ce.success("Online payment settings saved")}catch(de){Ce.error("Failed to save online payment settings",{description:de==null?void 0:de.message})}};return n?c.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6 flex justify-center",children:c.jsxs("svg",{className:"animate-spin h-6 w-6 text-gray-500",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}):c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Settings › Payments"}),c.jsxs(Am,{defaultValue:"settings",className:"w-full",children:[c.jsxs(jf,{className:"grid grid-cols-3 max-w-[560px]",children:[c.jsx(Ia,{value:"settings",children:"Settings"}),c.jsx(Ia,{value:"online",children:"Online Payments"}),c.jsx(Ia,{value:"bank",children:"Bank Transfers"})]}),c.jsxs(fi,{value:"settings",className:"mt-6 space-y-8",children:[c.jsxs("section",{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"Payment Fees"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable/Disable Payment Fees"})]}),c.jsx(Zi,{checked:h,onCheckedChange:p})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Fees Percentage (%)"}),c.jsx(Ne,{type:"number",min:0,max:100,step:"0.1",value:g,onChange:de=>v(Number(de.target.value)),placeholder:"5"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Percentage of fees to be added to the payment amount"})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:ae,children:"Save Fees"})})]}),c.jsx("hr",{className:"my-6"}),c.jsxs("section",{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"VAT Enabled"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable/Disable VAT"})]}),c.jsx(Zi,{checked:b,onCheckedChange:E})]}),c.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"VAT By User Country"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable/Disable VAT by user country (Manage Countries VAT)"})]}),c.jsx(Zi,{checked:T,onCheckedChange:C})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Default VAT Percentage (%)"}),c.jsx(Ne,{type:"number",min:0,max:100,step:"0.1",value:R,onChange:de=>N(Number(de.target.value)),placeholder:"1"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used when country VAT is not set or user has no country."})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:J,children:"Save VAT"})})]})]}),c.jsx(fi,{value:"online",className:"mt-6 space-y-6",children:c.jsxs("section",{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"Paystack Enabled"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable payments via Paystack"})]}),c.jsx(Zi,{checked:K,onCheckedChange:q})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Secret Key"}),c.jsx(Ne,{type:"text",value:ee,onChange:de=>oe(de.target.value),placeholder:"sk_live_xxx"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Paystack secret key that starts with ",c.jsx("code",{children:"sk_"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:X,children:"Save Online Payments"})})]})}),c.jsx(fi,{value:"bank",className:"mt-6 space-y-6",children:c.jsxs("section",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"Bank Transfers Enabled"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable payments via Bank Transfers"})]}),c.jsx(Zi,{checked:O,onCheckedChange:k})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Name"}),c.jsx(Ne,{value:j,onChange:de=>P(de.target.value),placeholder:"Your Bank Name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Account Number"}),c.jsx(Ne,{value:M,onChange:de=>D(de.target.value),placeholder:"Your Bank Account Number"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Account Name"}),c.jsx(Ne,{value:U,onChange:de=>V(de.target.value),placeholder:"Your Bank Account Name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Account Country"}),c.jsx(Ne,{value:z,onChange:de=>W(de.target.value),placeholder:"Your Bank Account Country"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Transfer Note"}),c.jsx(wi,{rows:5,value:Y,onChange:de=>Q(de.target.value),placeholder:"In order to confirm the bank transfer, you will need to upload a receipt..."})]}),c.jsx("div",{className:"pt-2",children:c.jsx(be,{onClick:re,children:"Save Bank Transfers"})})]})})]})]})}const dO="https://api.gada.chat";async function sSt(e){const t=await fetch(`${dO}/api/admin/wallet-settings`,{headers:e});if(!t.ok)throw new Error(await t.text());return t.json()}async function oSt(e,t){const n=await fetch(`${dO}/api/admin/wallet-settings`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function cSt(e){const t=await fetch(`${dO}/api/admin/settings/points/fetch`,{headers:{"Content-Type":"application/json",...e}});if(!t.ok)throw new Error(await t.text());return await t.json()}async function lSt(e,t){const n=await fetch(`${dO}/api/admin/settings/points/update`,{method:"PUT",headers:{...e,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}function uSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState(!0),[u,h]=S.useState(!1),[p,g]=S.useState({wallet_min_withdrawal:null,wallet_max_transfer:null,wallet_withdrawal_enabled:!0}),[v,b]=S.useState(null);S.useEffect(()=>{n&&(o(!0),sSt(t).then(R=>{g(R),b(R)}).catch(R=>Ce.error("Failed to load wallet settings",{description:String(R)})).finally(()=>o(!1)))},[n]);const E=S.useMemo(()=>JSON.stringify(p)!==JSON.stringify(v),[p,v]),T=async()=>{h(!0);try{await oSt(t,p),Ce.success("Wallet settings saved"),b(p)}catch(R){Ce.error("Save failed",{description:R==null?void 0:R.message})}finally{h(!1)}},C=()=>{v&&g(v)};return c.jsx("div",{className:"max-w-5xl mx-auto",children:c.jsxs(Vr,{children:[c.jsxs(pa,{children:[c.jsx(Wa,{children:"Wallet Settings"}),c.jsx(Qy,{children:"Configure withdrawal and transfer limits."})]}),c.jsx(mi,{className:"space-y-6",children:i?c.jsx("div",{className:"py-8 text-center text-sm text-gray-500",children:"Loading…"}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Je,{htmlFor:"enabled",className:"text-base",children:"Enable Withdrawals"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Turn wallet withdrawals on/off for all users."})]}),c.jsx(Zi,{id:"enabled",checked:p.wallet_withdrawal_enabled,onCheckedChange:R=>g(N=>({...N,wallet_withdrawal_enabled:!!R}))})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{htmlFor:"min",className:"text-base",children:"Minimum Withdrawal (₦)"}),c.jsx(Ne,{id:"min",type:"number",min:0,placeholder:"e.g., 1000",value:p.wallet_min_withdrawal??"",onChange:R=>g(N=>({...N,wallet_min_withdrawal:R.target.value===""?null:Math.max(0,Number(R.target.value))})),className:"mt-2 h-11"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to use the app default."})]}),c.jsxs("div",{children:[c.jsx(Je,{htmlFor:"max",className:"text-base",children:"Max Transfer (₦)"}),c.jsx(Ne,{id:"max",type:"number",min:0,placeholder:"e.g., 500000",value:p.wallet_max_transfer??"",onChange:R=>g(N=>({...N,wallet_max_transfer:R.target.value===""?null:Math.max(0,Number(R.target.value))})),className:"mt-2 h-11"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to disable the limit."})]})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[c.jsx(be,{onClick:T,disabled:!E||u,className:"h-11",children:u?"Saving…":"Save changes"}),c.jsx(be,{type:"button",variant:"secondary",onClick:C,disabled:!E,className:"h-11",children:"Reset"})]})]})})]})})}const uye="https://api.gada.chat";async function dSt(e,t={}){const n=new URLSearchParams;t.year&&n.set("year",String(t.year)),t.month&&n.set("month",String(t.month));const i=await fetch(`${uye}/api/admin/earnings/packages/summary?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function hSt(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>{u!=null&&u!==""&&n.set(o,String(u))});const i=await fetch(`${uye}/api/admin/earnings/packages/table?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}const fSt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pR=e=>`₦${(e||0).toLocaleString()}`;function pSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState(new Date().getFullYear()),[u,h]=S.useState({totalAll:0,totalThisMonth:0,chart:[],seriesNames:[]}),[p,g]=S.useState([]),[v,b]=S.useState(1),[E,T]=S.useState(10),[C,R]=S.useState(0),[N,O]=S.useState(1),[k,j]=S.useState(""),[P,M]=S.useState(""),[D,U]=S.useState(""),[V,z]=S.useState("earnings"),[W,Y]=S.useState("desc"),Q=async()=>{try{const ee=await dSt(t,{year:i}),oe=ee.series.map(J=>J.package_name),ae=fSt.map((J,re)=>{const X={month:J};for(const de of ee.series)X[de.package_name]=de.data[re]||0;return X});h({totalAll:ee.totalAll,totalThisMonth:ee.totalThisMonth,chart:ae,seriesNames:oe})}catch(ee){Ce.error("Failed to load summary",{description:ee==null?void 0:ee.message})}},K=async()=>{try{const ee=await hSt(t,{search:k,page:v,pageSize:E,startDate:P,endDate:D,sort:V,order:W});g(ee.items),R(ee.total),O(ee.totalPages)}catch(ee){Ce.error("Failed to load table",{description:ee==null?void 0:ee.message})}};S.useEffect(()=>{n&&Q()},[n,i]),S.useEffect(()=>{n&&K()},[n,v,E,V,W,P,D]);const q=S.useMemo(()=>{const ee=[];if(N<=7){for(let J=1;J<=N;J++)ee.push(J);return ee}ee.push(1),v>3&&ee.push("…");const oe=Math.max(2,v-1),ae=Math.min(N-1,v+1);for(let J=oe;J<=ae;J++)ee.push(J);return v<N-2&&ee.push("…"),ee.push(N),ee},[v,N]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Vr,{children:[c.jsxs(pa,{className:"flex flex-row items-center justify-between",children:[c.jsx(Wa,{children:"Packages"}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Pr,{value:String(i),onValueChange:ee=>o(Number(ee)),children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Year"})}),c.jsx(Rr,{children:[0,1,2,3].map(ee=>{const oe=new Date().getFullYear()-ee;return c.jsx(ft,{value:String(oe),children:oe},oe)})})]})})]}),c.jsx(mi,{className:"h-[300px]",children:c.jsx(m3,{width:"100%",height:"100%",children:c.jsxs(Z3,{data:u.chart,children:[c.jsx(lO,{strokeDasharray:"3 3"}),c.jsx(E_,{dataKey:"month"}),c.jsx(w_,{}),c.jsx(Oc,{formatter:ee=>pR(ee)}),c.jsx(jd,{}),u.seriesNames.map(ee=>c.jsx(Wo,{dataKey:ee,stackId:void 0},ee))]})})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs(Vr,{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 text-white",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Total Earnings"})}),c.jsx(mi,{className:"text-3xl font-semibold",children:pR(u.totalAll)})]}),c.jsxs(Vr,{className:"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"This Month Earnings"})}),c.jsx(mi,{className:"text-3xl font-semibold",children:pR(u.totalThisMonth)})]})]}),c.jsxs(Vr,{children:[c.jsxs(pa,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[c.jsx(Wa,{children:"Packages"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Show"}),c.jsxs(Pr,{value:String(E),onValueChange:ee=>{b(1),T(Number(ee))},children:[c.jsx(Cr,{className:"w-20",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10"}),c.jsx(ft,{value:"25",children:"25"}),c.jsx(ft,{value:"50",children:"50"})]})]}),c.jsx("span",{className:"text-sm text-gray-500",children:"entries"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ne,{placeholder:"Search package…",value:k,onChange:ee=>j(ee.target.value),className:"h-10 w-56"}),c.jsx(be,{onClick:()=>{b(1),K()},children:"Search"})]})]})]}),c.jsxs(mi,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Start Date"}),c.jsx(Ne,{type:"date",value:P,onChange:ee=>{b(1),M(ee.target.value)},max:Id(new Date,"yyyy-MM-dd")})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"End Date"}),c.jsx(Ne,{type:"date",value:D,onChange:ee=>{b(1),U(ee.target.value)},max:Id(new Date,"yyyy-MM-dd")})]}),c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsxs(Pr,{value:`${V}:${W}`,onValueChange:ee=>{const[oe,ae]=ee.split(":");z(oe),Y(ae)},children:[c.jsx(Cr,{className:"w-full",children:c.jsx(kr,{placeholder:"Sort"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"earnings:desc",children:"Earnings ↓"}),c.jsx(ft,{value:"earnings:asc",children:"Earnings ↑"}),c.jsx(ft,{value:"sales:desc",children:"Sales ↓"}),c.jsx(ft,{value:"sales:asc",children:"Sales ↑"}),c.jsx(ft,{value:"name:asc",children:"Name A–Z"}),c.jsx(ft,{value:"name:desc",children:"Name Z–A"})]})]}),c.jsx(be,{variant:"secondary",onClick:()=>{j(""),M(""),U(""),z("earnings"),Y("desc"),b(1)},children:"Clear"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Package"}),c.jsx(et,{children:"Total Sales"}),c.jsx(et,{children:"Total Earnings"})]})}),c.jsx(ba,{children:p.length?p.map(ee=>c.jsxs(nn,{children:[c.jsx(He,{children:ee.package}),c.jsx(He,{children:ee.total_sales.toLocaleString()}),c.jsx(He,{children:pR(ee.total_earnings)})]},ee.package_id)):c.jsx(nn,{children:c.jsx(He,{colSpan:3,className:"text-center text-gray-500",children:"No data"})})})]})}),c.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[c.jsxs("div",{children:["Showing ",p.length?(v-1)*E+1:0," to ",(v-1)*E+p.length," of ",C]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:v===1,onClick:()=>b(1),children:"First"}),c.jsx(be,{variant:"outline",size:"sm",disabled:v===1,onClick:()=>b(ee=>Math.max(1,ee-1)),children:"Prev"}),q.map((ee,oe)=>ee==="…"?c.jsx("span",{className:"px-2",children:"…"},`e${oe}`):c.jsx(be,{variant:ee===v?"default":"outline",size:"sm",onClick:()=>b(ee),children:ee},ee)),c.jsx(be,{variant:"outline",size:"sm",disabled:v>=N,onClick:()=>b(ee=>Math.min(N,ee+1)),children:"Next"}),c.jsx(be,{variant:"outline",size:"sm",disabled:v>=N,onClick:()=>b(N),children:"Last"})]})]})]})]})]})}const lS="https://api.gada.chat";async function mSt(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>u!=null&&u!==""&&n.set(o,String(u)));const i=await fetch(`${lS}/api/admin/packages?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function gSt(e,t){const n=await fetch(`${lS}/api/admin/packages/${t}`,{headers:e});if(!n.ok)throw new Error(await n.text());return n.json()}async function vSt(e,t){const n=await fetch(`${lS}/api/admin/packages`,{method:"POST",headers:e,body:t});if(!n.ok)throw new Error(await n.text());return n.json()}async function ySt(e,t,n){const i=await fetch(`${lS}/api/admin/packages/${t}`,{method:"PUT",headers:e,body:n});if(!i.ok)throw new Error(await i.text());return i.json()}async function _St(e,t){const n=await fetch(`${lS}/api/admin/packages/${t}`,{method:"DELETE",headers:e});if(!n.ok)throw new Error(await n.text());return n.json()}const bSt="";function ESt(){const e=tr(),{accessToken:t}=st(),n=wt(t),i=S.useMemo(()=>"Authorization"in n,[n]),[o,u]=S.useState([]),[h,p]=S.useState(1),[g,v]=S.useState(10),[b,E]=S.useState(0),[T,C]=S.useState(1),[R,N]=S.useState(""),[O,k]=S.useState("package_order"),[j,P]=S.useState("asc"),[M,D]=S.useState(!0),U=async()=>{D(!0);try{const W=await mSt(n,{page:h,pageSize:g,search:R,sort:O,order:j});u(W.items),E(W.total),C(W.totalPages)}catch(W){Ce.error("Failed to load packages",{description:W==null?void 0:W.message})}finally{D(!1)}};S.useEffect(()=>{i&&U()},[i,h,g,O,j]);const V=async W=>{if(confirm("Delete this package? This cannot be undone."))try{await _St(n,W),Ce.success("Package deleted"),o.length===1&&h>1?p(Y=>Y-1):U()}catch(Y){Ce.error("Delete failed",{description:Y==null?void 0:Y.message})}},z=(W,Y)=>`${W} ${Y[0].toUpperCase()+Y.slice(1)}`;return S.useMemo(()=>{const W=[];if(T<=7){for(let K=1;K<=T;K++)W.push(K);return W}W.push(1),h>3&&W.push("…");const Y=Math.max(2,h-1),Q=Math.min(T-1,h+1);for(let K=Y;K<=Q;K++)W.push(K);return h<T-2&&W.push("…"),W.push(T),W},[h,T]),c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:[c.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4",children:[c.jsx("h1",{className:"text-[28px] leading-8 font-extrabold text-slate-900",children:"Pro System › Packages"}),c.jsxs("div",{className:"flex w-full md:w-auto items-center gap-2",children:[c.jsx(Ne,{placeholder:"Search…",value:R,onChange:W=>N(W.target.value),className:"h-11 md:w-[420px]"}),c.jsx(be,{className:"h-11",onClick:()=>{p(1),U()},children:"Search"}),c.jsxs(be,{className:"h-11 gap-2",onClick:()=>e("/admin/packages/new"),children:[c.jsx(M4,{className:"h-5 w-5"}),"Add New Package"]})]})]}),c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-sm text-slate-500",children:"Show"}),c.jsxs(Pr,{value:String(g),onValueChange:W=>{p(1),v(Number(W))},children:[c.jsx(Cr,{className:"w-24 h-10",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10"}),c.jsx(ft,{value:"25",children:"25"}),c.jsx(ft,{value:"50",children:"50"})]})]}),c.jsx("span",{className:"text-sm text-slate-500",children:"entries"})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Pr,{value:`${O}:${j}`,onValueChange:W=>{const[Y,Q]=W.split(":");k(Y),P(Q)},children:[c.jsx(Cr,{className:"w-44 h-10",children:c.jsx(kr,{placeholder:"Order"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"package_order:asc",children:"Order ↑"}),c.jsx(ft,{value:"package_order:desc",children:"Order ↓"}),c.jsx(ft,{value:"name:asc",children:"Name A–Z"}),c.jsx(ft,{value:"name:desc",children:"Name Z–A"}),c.jsx(ft,{value:"price:asc",children:"Price ↑"}),c.jsx(ft,{value:"price:desc",children:"Price ↓"}),c.jsx(ft,{value:"period_num:asc",children:"Period (num) ↑"}),c.jsx(ft,{value:"period_num:desc",children:"Period (num) ↓"})]})]})})]}),c.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{className:"bg-slate-50",children:[c.jsx(et,{className:"w-16",children:"ID"}),c.jsx(et,{className:"min-w-[280px]",children:"Name"}),c.jsx(et,{className:"min-w-[150px]",children:"Price (₦)"}),c.jsx(et,{className:"min-w-[140px]",children:"Period"}),c.jsx(et,{className:"min-w-[100px]",children:"Order"}),c.jsx(et,{className:"text-right min-w-[160px]",children:"Actions"})]})}),c.jsx(ba,{children:M?c.jsx(nn,{children:c.jsx(He,{colSpan:6,className:"py-12 text-center text-slate-500",children:"Loading…"})}):o.length?o.map((W,Y)=>c.jsxs(nn,{className:Y%2?"bg-white":"bg-slate-50/40",children:[c.jsx(He,{className:"font-medium",children:W.package_id}),c.jsx(He,{children:c.jsxs("div",{className:"flex items-center gap-3",children:[W.icon?c.jsx("img",{src:`${bSt}/${W.icon}`,alt:"",className:"h-8 w-8 rounded-lg object-cover ring-1 ring-slate-200"}):c.jsx("div",{className:"h-8 w-8 rounded-lg bg-slate-100 ring-1 ring-slate-200"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-semibold text-slate-900",children:W.name}),c.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full ring-1 ring-slate-300",style:{backgroundColor:W.color},title:W.color})]})]})}),c.jsx(He,{className:"font-semibold",children:W.price}),c.jsx(He,{children:z(W.period_num,W.period)}),c.jsx(He,{children:W.package_order}),c.jsx(He,{className:"text-right",children:c.jsxs("div",{className:"inline-flex gap-2",children:[c.jsx(be,{size:"sm",variant:"outline",className:"rounded-full",onClick:()=>e(`/admin/packages/${W.package_id}/edit`),title:"Edit",children:c.jsx(tle,{className:"h-4 w-4"})}),c.jsx(be,{size:"sm",variant:"destructive",className:"rounded-full",onClick:()=>V(W.package_id),title:"Delete",children:c.jsx(F4,{className:"h-4 w-4"})})]})})]},W.package_id)):c.jsx(nn,{children:c.jsx(He,{colSpan:6,className:"py-12 text-center text-slate-500",children:"No packages"})})})]})})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",o.length?(h-1)*g+1:0," to ",(h-1)*g+o.length," of ",b]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{variant:"secondary",size:"sm",disabled:h===1,onClick:()=>p(1),className:"rounded-xl",children:"First"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:h===1,onClick:()=>p(W=>Math.max(1,W-1)),className:"rounded-xl",children:"Prev"}),S.useMemo(()=>{const W=[];if(T<=7)for(let Y=1;Y<=T;Y++)W.push(Y);else{W.push(1),h>3&&W.push("…");const Y=Math.max(2,h-1),Q=Math.min(T-1,h+1);for(let K=Y;K<=Q;K++)W.push(K);h<T-2&&W.push("…"),W.push(T)}return W},[h,T]).map((W,Y)=>W==="…"?c.jsx("span",{className:"px-2 text-slate-500",children:"…"},`e${Y}`):c.jsx(be,{size:"sm",variant:W===h?"default":"secondary",onClick:()=>p(W),className:"rounded-xl ",children:W},W)),c.jsx(be,{variant:"secondary",size:"sm",disabled:h>=T,onClick:()=>p(W=>Math.min(T,W+1)),className:"rounded-xl",children:"Next"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:h>=T,onClick:()=>p(T),className:"rounded-xl",children:"Last"})]})]})]})})}function cae(){const{id:e}=tc(),t=!!e,n=tr(),{accessToken:i}=st(),o=Hl(i),u=S.useMemo(()=>"Authorization"in o,[o]),[h,p]=S.useState(t),[g,v]=S.useState(!1),[b,E]=S.useState({package_id:0,name:"",price:"",period_num:30,period:"day",color:"#000000",icon:"",package_permissions_group_id:0,allowed_blogs_categories:0,allowed_videos_categories:0,allowed_products:0,verification_badge_enabled:"0",boost_posts_enabled:"0",boost_posts:0,boost_pages_enabled:"0",boost_pages:0,custom_description:"",package_order:0,paypal_billing_plan:"",stripe_billing_plan:""}),[T,C]=S.useState(null),[R,N]=S.useState(!0),O=S.useRef(null);S.useEffect(()=>{!t||!u||(async()=>{try{const j=await gSt(o,Number(e));E({...j,verification_badge_enabled:j.verification_badge_enabled==="1"||j.verification_badge_enabled===!0,boost_posts_enabled:j.boost_posts_enabled==="1"||j.boost_posts_enabled===!0,boost_pages_enabled:j.boost_pages_enabled==="1"||j.boost_pages_enabled===!0})}catch(j){Ce.error("Failed to load package",{description:j==null?void 0:j.message})}finally{p(!1)}})()},[t,e,u]);const k=async j=>{j.preventDefault(),v(!0);try{const P=new FormData;if(Object.entries(b).forEach(([M,D])=>{M!=="package_id"&&M!=="icon"&&P.append(M,String(D??""))}),P.set("verification_badge_enabled",b.verification_badge_enabled?"true":"false"),P.set("boost_posts_enabled",b.boost_posts_enabled?"true":"false"),P.set("boost_pages_enabled",b.boost_pages_enabled?"true":"false"),t&&P.set("keep_icon",R?"true":"false"),T&&(!t||!R)&&P.append("icon",T),t)await ySt(o,Number(e),P),Ce.success("Package updated");else{const M=await vSt(o,P);Ce.success("Package created"),n(`/admin/packages/${M.id}/edit`,{replace:!0});return}n("/admin/packages")}catch(P){Ce.error("Save failed",{description:P==null?void 0:P.message})}finally{v(!1)}};return c.jsx("form",{onSubmit:k,className:"max-w-5xl",children:c.jsxs(Vr,{children:[c.jsxs(pa,{children:[c.jsx(Wa,{children:t?"Edit Package":"Add New Package"}),c.jsx(Qy,{children:"Configure a subscription package for the Pro System."})]}),c.jsx(mi,{className:"space-y-6",children:h?c.jsx("div",{className:"text-sm text-gray-500 py-12 text-center",children:"Loading…"}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Name"}),c.jsx(Ne,{value:b.name,onChange:j=>E({...b,name:j.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Price (NGN)"}),c.jsx(Ne,{type:"number",min:0,value:b.price,onChange:j=>E({...b,price:j.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Paid Every"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Ne,{type:"number",min:1,value:b.period_num,onChange:j=>E({...b,period_num:Number(j.target.value||1)}),className:"w-28"}),c.jsxs(Pr,{value:b.period,onValueChange:j=>E({...b,period:j}),children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"day",children:"Day"}),c.jsx(ft,{value:"month",children:"Month"}),c.jsx(ft,{value:"year",children:"Year"})]})]})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Color"}),c.jsx(Ne,{type:"color",value:b.color,onChange:j=>E({...b,color:j.target.value})})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx(Je,{children:"Icon"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ne,{type:"file",ref:O,accept:"image/*",onChange:j=>{var P;return C(((P=j.target.files)==null?void 0:P[0])||null)}}),t&&b.icon&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("img",{src:`/${b.icon}`,className:"h-12 w-12 rounded object-cover border"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Zi,{checked:R,onCheckedChange:N,id:"keepicon"}),c.jsx(Je,{htmlFor:"keepicon",children:"Keep current"})]})]})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Perfect size: 60×60 – 180×180px"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Permissions Group ID"}),c.jsx(Ne,{type:"number",min:0,value:b.package_permissions_group_id,onChange:j=>E({...b,package_permissions_group_id:Number(j.target.value||0)})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maps to your permissions groups table."})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Blogs Categories Allowed"}),c.jsx(Ne,{type:"number",min:0,value:b.allowed_blogs_categories,onChange:j=>E({...b,allowed_blogs_categories:Number(j.target.value||0)})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Videos Categories Allowed"}),c.jsx(Ne,{type:"number",min:0,value:b.allowed_videos_categories,onChange:j=>E({...b,allowed_videos_categories:Number(j.target.value||0)})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Market Products Allowed"}),c.jsx(Ne,{type:"number",min:0,value:b.allowed_products,onChange:j=>E({...b,allowed_products:Number(j.target.value||0)})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Verification Badge Enabled"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Enable verification badge with this package"})]}),c.jsx(Zi,{checked:!!b.verification_badge_enabled,onCheckedChange:j=>E({...b,verification_badge_enabled:j})})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Boost Posts Enabled"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Enable “boost posts” feature"})]}),c.jsx(Zi,{checked:!!b.boost_posts_enabled,onCheckedChange:j=>E({...b,boost_posts_enabled:j})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Posts Boosts (max)"}),c.jsx(Ne,{type:"number",min:0,value:b.boost_posts,onChange:j=>E({...b,boost_posts:Number(j.target.value||0)})})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Boost Pages Enabled"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Enable “boost pages” feature"})]}),c.jsx(Zi,{checked:!!b.boost_pages_enabled,onCheckedChange:j=>E({...b,boost_pages_enabled:j})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Pages Boosts (max)"}),c.jsx(Ne,{type:"number",min:0,value:b.boost_pages,onChange:j=>E({...b,boost_pages:Number(j.target.value||0)})})]})]})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Custom Description"}),c.jsx(wi,{rows:4,value:b.custom_description??"",onChange:j=>E({...b,custom_description:j.target.value})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Order"}),c.jsx(Ne,{type:"number",min:0,value:b.package_order,onChange:j=>E({...b,package_order:Number(j.target.value||0)})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"PayPal Billing Plan (optional)"}),c.jsx(Ne,{value:b.paypal_billing_plan??"",onChange:j=>E({...b,paypal_billing_plan:j.target.value})})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Stripe Billing Plan (optional)"}),c.jsx(Ne,{value:b.stripe_billing_plan??"",onChange:j=>E({...b,stripe_billing_plan:j.target.value})})]})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[c.jsx(be,{type:"submit",disabled:g,children:g?"Saving…":"Save Changes"}),c.jsx(be,{type:"button",variant:"secondary",onClick:()=>n("/admin/packages"),children:"Cancel"})]})]})})]})})}const dye="https://api.gada.chat";async function wSt(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>u!=null&&u!==""&&n.set(o,String(u)));const i=await fetch(`${dye}/api/admin/subscribers?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function SSt(e,t={}){const n=new URLSearchParams;Object.entries({...t,export:"csv"}).forEach(([h,p])=>p!=null&&p!==""&&n.set(h,String(p)));const i=`${dye}/api/admin/subscribers?${n}`,o=await fetch(i,{headers:e});if(!o.ok)throw new Error(await o.text());return{blob:await o.blob(),filename:`subscribers_${Date.now()}.csv`}}function lae(e){const t=e.replace(" ","T"),n=new Date(t);return isNaN(n.getTime())?e:n.toLocaleString()}function xSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState(1),[p,g]=S.useState(10),[v,b]=S.useState(0),[E,T]=S.useState(1),[C,R]=S.useState(""),[N,O]=S.useState("all"),[k,j]=S.useState(""),[P,M]=S.useState("newest"),[D,U]=S.useState(!1),V=async()=>{U(!0);try{const Y=await wSt(t,{page:u,pageSize:p,search:C,status:N,packageName:k,order:P});o(Y.items),b(Y.total),T(Y.totalPages)}catch(Y){Ce.error("Failed to load subscribers",{description:Y==null?void 0:Y.message})}finally{U(!1)}};S.useEffect(()=>{n&&V()},[n,u,p,N,k,P]);const z=async()=>{try{const{blob:Y,filename:Q}=await SSt(t,{page:u,pageSize:p,search:C,status:N,packageName:k,order:P}),K=URL.createObjectURL(Y),q=document.createElement("a");q.href=K,q.download=Q,q.click(),URL.revokeObjectURL(K)}catch(Y){Ce.error("Export failed",{description:Y==null?void 0:Y.message})}},W=S.useMemo(()=>{const Y=[];if(E<=7){for(let q=1;q<=E;q++)Y.push(q);return Y}Y.push(1),u>3&&Y.push("…");const Q=Math.max(2,u-1),K=Math.min(E-1,u+1);for(let q=Q;q<=K;q++)Y.push(q);return u<E-2&&Y.push("…"),Y.push(E),Y},[u,E]);return c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:[c.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[c.jsxs("div",{className:"flex-1 flex flex-wrap gap-2",children:[c.jsx(Ne,{placeholder:"Search by user / handle",value:C,onChange:Y=>R(Y.target.value),className:"h-11 w-full sm:w-[340px]"}),c.jsx(be,{className:"h-11",onClick:()=>{h(1),V()},children:"Search"}),c.jsxs(Pr,{value:String(p),onValueChange:Y=>{h(1),g(Number(Y))},children:[c.jsx(Cr,{className:"h-11 w-[120px]",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"25",children:"25 / page"}),c.jsx(ft,{value:"50",children:"50 / page"})]})]}),c.jsxs(Pr,{value:N,onValueChange:Y=>{h(1),O(Y)},children:[c.jsx(Cr,{className:"h-11 w-[140px]",children:c.jsx(kr,{placeholder:"Status"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"all",children:"All"}),c.jsx(ft,{value:"active",children:"Active"}),c.jsx(ft,{value:"expired",children:"Expired"})]})]}),c.jsxs(Pr,{value:k,onValueChange:Y=>{h(1),j(Y)},children:[c.jsx(Cr,{className:"h-11 w-[160px]",children:c.jsx(kr,{placeholder:"Package"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"All",children:"All Packages"}),c.jsx(ft,{value:"GADA VIP",children:"GADA VIP"}),c.jsx(ft,{value:"GADA VVIP",children:"GADA VVIP"})]})]}),c.jsxs(Pr,{value:P,onValueChange:Y=>{h(1),M(Y)},children:[c.jsx(Cr,{className:"h-11 w-[140px]",children:c.jsx(kr,{placeholder:"Order"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"newest",children:"Newest"}),c.jsx(ft,{value:"oldest",children:"Oldest"})]})]})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(be,{variant:"outline",className:"h-11 gap-2",onClick:z,children:[c.jsx(WVe,{className:"h-4 w-4"})," Export CSV"]})})]}),c.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{className:"bg-slate-50",children:[c.jsx(et,{className:"w-20",children:"ID"}),c.jsx(et,{className:"min-w-[220px]",children:"User"}),c.jsx(et,{className:"min-w-[160px]",children:"Handle"}),c.jsx(et,{className:"min-w-[160px]",children:"Package"}),c.jsx(et,{className:"min-w-[180px]",children:"Subscription"}),c.jsx(et,{className:"min-w-[260px]",children:"Expiration"}),c.jsx(et,{className:"min-w-[120px]",children:"Status"})]})}),c.jsx(ba,{children:D?c.jsx(nn,{children:c.jsx(He,{colSpan:7,className:"py-12 text-center text-slate-500",children:"Loading…"})}):i.length?i.map((Y,Q)=>{const K=Number(Y.remainingDays),q=Y.status==="Active",ee=q?`(Remaining ${K} ${Math.abs(K)===1?"Day":"Days"})`:"(Expired)";return c.jsxs(nn,{className:Q%2?"bg-white":"bg-slate-50/40",children:[c.jsx(He,{children:Y.userId}),c.jsx(He,{className:"font-medium text-slate-900",children:Y.user??"—"}),c.jsx(He,{className:"text-slate-600",children:Y.handle??"—"}),c.jsx(He,{className:"font-medium",children:Y.packageName}),c.jsx(He,{children:lae(Y.subscription)}),c.jsx(He,{children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{children:lae(Y.expiration)}),c.jsx("span",{className:`text-xs ${q?"text-emerald-600":"text-rose-600"}`,children:ee})]})}),c.jsx(He,{children:c.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ring-1
                            ${q?"bg-emerald-50 text-emerald-700 ring-emerald-200":"bg-rose-50 text-rose-700 ring-rose-200"}`,children:Y.status})})]},`${Y.userId}-${Y.time}`)}):c.jsx(nn,{children:c.jsx(He,{colSpan:7,className:"py-12 text-center text-slate-500",children:"No records"})})})]})})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",i.length?(u-1)*p+1:0," to ",(u-1)*p+i.length," of ",v]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{variant:"secondary",size:"sm",disabled:u===1,onClick:()=>h(1),className:"rounded-xl",children:"First"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:u===1,onClick:()=>h(Y=>Math.max(1,Y-1)),className:"rounded-xl",children:"Prev"}),W.map((Y,Q)=>Y==="…"?c.jsx("span",{className:"px-2 text-slate-500",children:"…"},`e${Q}`):c.jsx(be,{size:"sm",variant:Y===u?"default":"secondary",onClick:()=>h(Y),className:"rounded-xl",children:Y},Y)),c.jsx(be,{variant:"secondary",size:"sm",disabled:u>=E,onClick:()=>h(Y=>Math.min(E,Y+1)),className:"rounded-xl",children:"Next"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:u>=E,onClick:()=>h(E),className:"rounded-xl",children:"Last"})]})]})]})})}const _l=e=>e===""||e===null||e===void 0?0:Number(e);function TSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState(null),[u,h]=S.useState(!1),p=async()=>{try{const v=await cSt(t);o(v)}catch(v){Ce.error("Failed to load points settings",{description:v==null?void 0:v.message})}};S.useEffect(()=>{n&&p()},[n]);const g=async()=>{if(i){h(!0);try{await lSt(t,i),Ce.success("Points settings saved"),await p()}catch(v){Ce.error("Save failed",{description:v==null?void 0:v.message})}finally{h(!1)}}};return i?c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:[c.jsx("h1",{className:"text-[28px] leading-8 font-extrabold text-slate-900 mb-6",children:"Settings › Points System"}),c.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[c.jsxs(Vr,{className:"border-slate-200",children:[c.jsx(pa,{children:c.jsx(Wa,{className:"text-slate-800",children:"Enable & Transfers"})}),c.jsxs(mi,{className:"space-y-5",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Je,{className:"font-medium",children:"Points System Enabled"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Allow users to earn, hold, and use points."})]}),c.jsx(Zi,{checked:i.points_enabled,onCheckedChange:v=>o({...i,points_enabled:v})})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Je,{className:"font-medium",children:"Points Transfer Enabled"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Allow users to transfer points (P2P)."})]}),c.jsx(Zi,{checked:i.points_money_transfer_enabled,onCheckedChange:v=>o({...i,points_money_transfer_enabled:v})})]}),c.jsxs("div",{children:[c.jsx(Je,{className:"font-medium",children:"Minimum Withdrawal (points)"}),c.jsx(Ne,{type:"number",min:0,value:i.points_min_withdrawal,onChange:v=>o({...i,points_min_withdrawal:_l(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Minimum point balance required to request withdrawal."})]})]})]}),c.jsxs(Vr,{className:"border-slate-200",children:[c.jsx(pa,{children:c.jsx(Wa,{className:"text-slate-800",children:"Daily/Monthly Limits"})}),c.jsxs(mi,{className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx(Je,{className:"font-medium",children:"Limit (Pro users)"}),c.jsx(Ne,{type:"number",min:0,value:i.points_limit_pro,onChange:v=>o({...i,points_limit_pro:_l(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Max points a Pro user can earn/spend per period."})]}),c.jsxs("div",{children:[c.jsx(Je,{className:"font-medium",children:"Limit (Regular users)"}),c.jsx(Ne,{type:"number",min:0,value:i.points_limit_user,onChange:v=>o({...i,points_limit_user:_l(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Max points a regular user can earn/spend per period."})]}),c.jsxs("div",{children:[c.jsx(Je,{className:"font-medium",children:"Points per 1 Currency Unit"}),c.jsx(Ne,{type:"number",min:0,step:"0.01",value:i.points_per_currency,onChange:v=>o({...i,points_per_currency:_l(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Conversion rate (e.g., points per ₦1)."})]})]})]}),c.jsxs(Vr,{className:"border-slate-200",children:[c.jsx(pa,{children:c.jsx(Wa,{className:"text-slate-800",children:"Earning Rules"})}),c.jsxs(mi,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Je,{children:"Per Post"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_post,onChange:v=>o({...i,points_per_post:_l(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Per Post View"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_post_view,onChange:v=>o({...i,points_per_post_view:_l(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Per Post Reaction"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_post_reaction,onChange:v=>o({...i,points_per_post_reaction:_l(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Per Post Comment"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_post_comment,onChange:v=>o({...i,points_per_post_comment:_l(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Per Comment"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_comment,onChange:v=>o({...i,points_per_comment:_l(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Per Reaction"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_reaction,onChange:v=>o({...i,points_per_reaction:_l(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Je,{children:"Per Follow"}),c.jsx(Ne,{type:"number",min:0,value:i.points_per_follow,onChange:v=>o({...i,points_per_follow:_l(v.target.value)}),className:"mt-1"})]})]})]})]}),c.jsxs("div",{className:"mt-6 flex items-center gap-3",children:[c.jsx(be,{disabled:u,onClick:g,children:u?"Saving…":"Save Changes"}),c.jsx(be,{variant:"secondary",disabled:u,onClick:()=>p(),children:"Reset"})]})]})}):c.jsx("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:"Loading…"})}const IE="https://api.gada.chat",CSt=e=>(e||"?").split(" ").filter(Boolean).map(t=>t[0].toUpperCase()).slice(0,2).join("");function RSt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState(!1),[o,u]=S.useState([]),[h,p]=S.useState(1),[g,v]=S.useState(1),[b,E]=S.useState(0),[T,C]=S.useState(""),[R,N]=S.useState(10);async function O(D=h){i(!0);try{const U=new URL(`${IE}/api/admin/reports`);U.searchParams.set("page",String(D)),U.searchParams.set("limit",String(R)),T.trim()&&U.searchParams.set("q",T.trim());const z=await(await fetch(U.toString(),{headers:t})).json();if(!(z!=null&&z.ok))throw new Error("Failed");u(z.items||[]),p(z.page),v(z.pages),E(z.total)}catch(U){console.error(U)}finally{i(!1)}}S.useEffect(()=>{O(1)},[T,R]);async function k(D){if(!confirm("Mark this report as safe? This removes the report entry."))return;const V=await(await fetch(`${IE}/api/admin/reports/${D}/mark-safe`,{method:"POST",headers:t})).json();V!=null&&V.ok&&(u(z=>z.filter(W=>W.id!==D)),E(z=>Math.max(0,z-1)))}async function j(D){if(!confirm("Delete this report entry?"))return;const V=await(await fetch(`${IE}/api/admin/reports/${D}`,{method:"DELETE",headers:t})).json();V!=null&&V.ok&&(u(z=>z.filter(W=>W.id!==D)),E(z=>Math.max(0,z-1)))}async function P(){if(!confirm("Mark ALL reports as safe? This clears the table."))return;const U=await(await fetch(`${IE}/api/admin/reports/bulk/mark-safe`,{method:"POST",headers:t,body:JSON.stringify({ids:[]})})).json();U!=null&&U.ok&&(u([]),E(0),v(1),p(1))}const M=S.useMemo(()=>{if(b===0)return"Showing 0 of 0";const D=(h-1)*R+1,U=Math.min(b,h*R);return`Showing ${D}–${U} of ${b}`},[h,R,b]);return c.jsx("div",{className:"p-4 md:p-6",children:c.jsx("div",{className:"mx-auto max-w-[1400px]",children:c.jsxs("div",{className:"rounded-2xl bg-white border shadow-sm",children:[c.jsxs("div",{className:"p-4 md:p-6 border-b flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(NN,{className:"h-5 w-5 text-gray-700"}),c.jsx("h1",{className:"text-xl font-semibold",children:"Reports"})]}),c.jsx(be,{onClick:P,variant:"destructive",className:"bg-rose-600 hover:bg-rose-700",children:"Mark All As Safe"})]}),c.jsxs("div",{className:"px-4 md:px-6 py-3 border-b flex flex-wrap items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Show"}),c.jsx("select",{value:R,onChange:D=>N(Number(D.target.value)),className:"h-9 rounded-md border px-2 text-sm",children:[10,25,50,100].map(D=>c.jsx("option",{value:D,children:D},D))}),c.jsx("span",{className:"text-sm text-gray-500",children:"entries"})]}),c.jsxs("div",{className:"ml-auto relative",children:[c.jsx(Sf,{className:"h-4 w-4 text-gray-400 absolute left-3 top-2.5"}),c.jsx(Ne,{placeholder:"Search…",value:T,onChange:D=>C(D.target.value),className:"pl-9 w-[260px] bg-white"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50 text-gray-600",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left w-[60px]",children:"ID"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Node"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Type"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Reporter By"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Reporter For"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Time"}),c.jsx("th",{className:"px-3 py-2 text-left w-[140px]",children:"Actions"})]})}),c.jsxs("tbody",{children:[n&&c.jsx("tr",{children:c.jsxs("td",{colSpan:7,className:"px-3 py-8 text-center text-gray-500",children:[c.jsx(si,{className:"h-4 w-4 animate-spin inline mr-2"}),"Loading…"]})}),!n&&o.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-3 py-8 text-center text-gray-500",children:"No reports"})}),o.map(D=>{var U,V,z,W,Y,Q;return c.jsxs("tr",{className:"border-t",children:[c.jsx("td",{className:"px-3 py-2",children:D.id}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("a",{href:`/posts/${D.nodeId}`,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-[#1877F2] hover:underline",children:[c.jsx(Xce,{className:"h-3.5 w-3.5"})," View Post"]})}),c.jsx("td",{className:"px-3 py-2",children:c.jsx("span",{className:"inline-flex px-2 py-1 rounded-full bg-rose-50 text-rose-700 text-xs font-medium",children:((U=D.type)==null?void 0:U.toUpperCase())||"—"})}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs($i,{className:"h-7 w-7",children:[c.jsx(Oi,{src:(V=D.reporter)!=null&&V.avatar?`${IE}/uploads/${Kn(D.reporter.avatar)}`:""}),c.jsx(Qi,{children:CSt(((z=D.reporter)==null?void 0:z.fullName)||((W=D.reporter)==null?void 0:W.username))})]}),c.jsx("div",{className:"truncate max-w-[220px]",children:c.jsx("div",{className:"font-medium truncate",children:((Y=D.reporter)==null?void 0:Y.fullName)||((Q=D.reporter)==null?void 0:Q.username)})})]})}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("div",{className:"min-w-[120px]",children:[c.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-100 text-gray-800 text-xs font-medium",children:D.category||"—"}),D.reason?c.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-[220px]",children:D.reason}):null]})}),c.jsx("td",{className:"px-3 py-2",children:D.time?new Date(D.time).toLocaleString(void 0,{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(be,{size:"sm",onClick:()=>k(D.id),className:"bg-emerald-600 hover:bg-emerald-700",children:[c.jsx(Dw,{className:"h-4 w-4 mr-1"})," Safe"]}),c.jsxs(be,{size:"sm",variant:"destructive",onClick:()=>j(D.id),children:[c.jsx(F4,{className:"h-4 w-4 mr-1"})," Delete"]})]})})]},D.id)})]})]})}),c.jsxs("div",{className:"px-4 md:px-6 py-3 border-t flex flex-wrap items-center gap-3",children:[c.jsx("div",{className:"text-sm text-gray-500",children:M}),c.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:h<=1,onClick:()=>{const D=Math.max(1,h-1);p(D),O(D)},children:"Prev"}),c.jsx("div",{className:"px-3 py-1 border rounded",children:h}),c.jsx(be,{variant:"outline",size:"sm",disabled:h>=g,onClick:()=>{const D=Math.min(g,h+1);p(D),O(D)},children:"Next"})]})]})]})})})}const hye="https://api.gada.chat";async function NSt(e){return(await fetch(`${hye}/api/admin/adssettings`,{headers:e})).json()}async function ASt(e,t){return(await fetch(`${hye}/api/admin/adssettings`,{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)})).json()}function ISt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState({ads_enabled:"0",ads_approval_enabled:"0",ads_author_view_enabled:"0",ads_cost_view:"0",ads_cost_click:"0"}),[o,u]=S.useState(!1),[h,p]=S.useState(!1);S.useEffect(()=>{(async()=>{u(!0);try{const v=await NSt(t);v!=null&&v.ok?i(v.settings):Ce.error((v==null?void 0:v.error)||"Failed to load settings")}catch{Ce.error("Failed to load settings")}finally{u(!1)}})()},[e]);const g=async()=>{p(!0);try{const v=await ASt(n,t);v!=null&&v.ok?Ce.success("Settings saved"):Ce.error((v==null?void 0:v.error)||"Failed to save")}catch{Ce.error("Failed to save")}finally{p(!1)}};return c.jsxs("div",{className:"p-6 space-y-6 max-w-6xl",children:[c.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Ads Settings"}),c.jsxs("div",{className:"space-y-4 bg-white p-6 rounded-lg shadow",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Ads Campaigns"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Allow users to create ads (enabling will also enable wallet by default)."})]}),c.jsx(Zi,{checked:n.ads_enabled==="1",onCheckedChange:v=>i(b=>({...b,ads_enabled:v?"1":"0"}))})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Ads Campaigns Approval System"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Turn the approval system On and Off (if disabled all campaigns will be auto-approved)."})]}),c.jsx(Zi,{checked:n.ads_approval_enabled==="1",onCheckedChange:v=>i(b=>({...b,ads_approval_enabled:v?"1":"0"}))})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Ads Author Can See His Ads"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Allow the author of ads to see them (disable = author can’t see own ads)."})]}),c.jsx(Zi,{checked:n.ads_author_view_enabled==="1",onCheckedChange:v=>i(b=>({...b,ads_author_view_enabled:v?"1":"0"}))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block font-semibold mb-1",children:"Cost by View"}),c.jsx(Ne,{type:"number",value:n.ads_cost_view,onChange:v=>i(b=>({...b,ads_cost_view:v.target.value}))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block font-semibold mb-1",children:"Cost by Click"}),c.jsx(Ne,{type:"number",value:n.ads_cost_click,onChange:v=>i(b=>({...b,ads_cost_click:v.target.value}))})]}),c.jsx(be,{onClick:g,disabled:h,children:h?"Saving…":"Save Changes"})]})]})}const fye="https://api.gada.chat";async function pye(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error(t&&(t.error||t.message)||"Request failed");return t}async function OSt(e={}){const t=await fetch(`${fye}/api/packages`,{headers:e,credentials:"include"});return pye(t)}async function PSt(e,t,n,i){const o=await fetch(`${fye}/api/packages/buypackage`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},credentials:"include",body:JSON.stringify({package_id:t,package_name:n,package_price:i})});return pye(o)}function kSt(){const{accessToken:e}=st(),[t,n]=S.useState([]),[i,o]=S.useState(!0),[u,h]=S.useState(null),[p,g]=S.useState(0),[v,b]=S.useState(null),E=tr();S.useEffect(()=>{T()},[e]);const T=async()=>{e&&(o(!0),OSt({Authorization:`Bearer ${e}`}).then(R=>{console.log("Packages API response:",R),n((R==null?void 0:R.data)||[]),g((R==null?void 0:R.walletBalance)||0),b((R==null?void 0:R.activePlan)||null)}).catch(R=>{console.error("Error fetching packages:",R)}).finally(()=>{o(!1)}))},C=async R=>{if(!u){h(R.package_id);try{const N=await PSt(e,R.package_id,R.name,R.price);N.status?(console.log(N.message),Ce.success("Purchase successfull!"),T()):(Ce.error(N.message),E("/wallet"),console.log(N.message||"Purchase failed"))}catch{Ce.error("Something went wrong while purchasing."),console.log("Something went wrong while purchasing.")}finally{h(null)}}};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Pro Packages"}),c.jsxs("p",{className:"text-lg text-white/80",children:["Choose the Plan That's Right for You"," ",c.jsxs("strong",{children:["( Available Balance : ",p," )"]})]})]}),i?c.jsx("p",{className:"text-white text-center",children:"Loading..."}):c.jsx("div",{className:"flex flex-col md:flex-row gap-6 justify-center",children:t.map(R=>c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full md:w-1/2 border",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:R.color||"#000"},children:R.name}),c.jsxs("p",{className:"text-3xl font-bold",children:["N",R.price]}),c.jsxs("p",{className:"text-gray-500 mb-4",children:["for ",R.period_num," ",R.period,R.period_num>1?"s":""]}),c.jsxs("ul",{className:"space-y-2 mb-4",children:[R.verification_badge_enabled==="1"&&c.jsx("li",{children:"✅ Verified badge"}),R.boost_posts>0&&c.jsxs("li",{children:["✅ Boost up to ",R.boost_posts," Posts"]}),R.boost_pages>0&&c.jsxs("li",{children:["✅ Boost up to ",R.boost_pages," Pages"]}),c.jsx("li",{className:"font-semibold",children:"🛡 All Permissions"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",dangerouslySetInnerHTML:{__html:R.custom_description}}),c.jsx("button",{onClick:()=>C(R),disabled:u===R.package_id||(v==null?void 0:v.package_name)==="GADA VVIP"||(v==null?void 0:v.package_name)==="GADA VIP"&&R.name==="GADA VIP",className:`w-full rounded-full px-6 py-2 transition
    ${u===R.package_id||(v==null?void 0:v.package_name)==="GADA VVIP"||(v==null?void 0:v.package_name)==="GADA VIP"&&R.name==="GADA VIP"?"bg-gray-400 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-600"}`,children:u===R.package_id?"Processing...":(v==null?void 0:v.package_name)===R.name?"Purchased":(v==null?void 0:v.package_name)==="GADA VVIP"&&R.name==="GADA VIP"?"Unavailable":"Buy Now"})]},R.package_id))})]})]})})]})}const uae="https://api.gada.chat";function jSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState("all"),[p,g]=S.useState(""),[v,b]=S.useState(1),[E,T]=S.useState(10),[C,R]=S.useState(0),[N,O]=S.useState(1),[k,j]=S.useState(!1),[P,M]=S.useState(!1),[D,U]=S.useState(null),V=async()=>{try{const Q=new URLSearchParams({status:u,search:p,page:String(v),limit:String(E)}),K=await fetch(`${uae}/api/admin/representatives?${Q.toString()}`,{headers:t});if(!K.ok)throw new Error("Failed to load representatives");const q=await K.json();o(q.items||[]),R(q.total||0),O(q.totalPages||1),j(!!q.hasPrev),M(!!q.hasNext)}catch(Q){Ce.error("Load failed",{description:Q==null?void 0:Q.message})}};S.useEffect(()=>{n&&V()},[n,u,v,E]);const z=async(Q,K)=>{try{if(!(await fetch(`${uae}/api/admin/representatives/${Q}/status`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({action:K})})).ok)throw new Error("Action failed");Ce.success("Updated"),V()}catch(q){Ce.error("Failed",{description:q==null?void 0:q.message})}};function W(Q,K){const q=[],ee=J=>q.push(J);if(K<=7){for(let J=1;J<=K;J++)ee(J);return q}ee(1),Q>3&&ee("…");const oe=Math.max(2,Q-1),ae=Math.min(K-1,Q+1);for(let J=oe;J<=ae;J++)ee(J);return Q<K-2&&ee("…"),ee(K),q}const Y=W(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsxs(Pr,{value:u,onValueChange:Q=>{b(1),h(Q)},children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{placeholder:"Status"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"all",children:"All"}),c.jsx(ft,{value:"pending",children:"Pending"}),c.jsx(ft,{value:"approved",children:"Approved"}),c.jsx(ft,{value:"rejected",children:"Rejected"})]})]}),c.jsx(Ne,{placeholder:"Search name/email",value:p,onChange:Q=>g(Q.target.value),onKeyDown:Q=>Q.key==="Enter"&&(b(1),V()),className:"w-full sm:w-64"}),c.jsx(be,{onClick:()=>{b(1),V()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:Q=>{b(1),T(Number(Q))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Name"}),c.jsx(et,{children:"Username"}),c.jsx(et,{children:"Email"}),c.jsx(et,{children:"Phone"}),c.jsx(et,{children:"State"}),c.jsx(et,{children:"Proposed Location"}),c.jsx(et,{children:"Status"}),c.jsx(et,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.map(Q=>c.jsxs(nn,{children:[c.jsx(He,{children:Q.name}),c.jsx(He,{children:Q.username}),c.jsx(He,{children:Q.email}),c.jsx(He,{children:Q.phone}),c.jsx(He,{children:Q.state}),c.jsx(He,{children:Q.proposed_location}),c.jsx(He,{className:"capitalize",children:Q.status}),c.jsxs(He,{className:"text-right space-x-2",children:[Q.status==="pending"?c.jsxs(c.Fragment,{children:[c.jsx(be,{size:"sm",onClick:()=>z(Q.id,"accept"),children:"Approve"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>z(Q.id,"decline"),children:"Reject"})]}):"---",c.jsx(be,{size:"sm",variant:"outline",onClick:()=>U(Q),children:"View"})]})]},Q.id))})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(Lm,{children:c.jsxs(Mm,{children:[c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Xn,{children:c.jsx(Um,{onClick:()=>b(Q=>Math.max(1,Q-1)),className:k?"":"pointer-events-none opacity-50"})}),Y.map((Q,K)=>Q==="…"?c.jsx(Xn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${K}`):c.jsx(Xn,{children:c.jsx(na,{isActive:Q===v,onClick:()=>b(Q),children:Q})},Q)),c.jsx(Xn,{children:c.jsx(Fm,{onClick:()=>b(Q=>Math.min(N,Q+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]}),c.jsx(Yo,{open:!!D,onOpenChange:()=>U(null),children:c.jsxs(vo,{className:"max-w-lg",children:[c.jsxs(Xo,{children:[c.jsx(Jo,{children:"Representative Details"}),c.jsxs(t_,{children:["All details for ",D==null?void 0:D.name]})]}),D&&c.jsxs("div",{className:"space-y-3 text-md",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Name:"})," ",D.name]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Username:"})," ",D.username]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Email:"})," ",D.email]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Phone:"})," ",D.phone]}),c.jsxs("div",{children:[c.jsx("strong",{children:"State:"})," ",D.state]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Resident Address:"})," ",D.resident_address]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Residential State:"})," ",D.residential_state]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Proposed Location:"})," ",D.proposed_location]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Gada Chat Username:"})," ",D.gada_chat_username]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Note:"})," ",D.note]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",D.status]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Date:"})," ",new Date(D.created_at).toLocaleString()]})]})]})})]})}const mR="https://api.gada.chat";function DSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState("all"),[p,g]=S.useState(""),[v,b]=S.useState(1),[E,T]=S.useState(10),[C,R]=S.useState(0),[N,O]=S.useState(1),[k,j]=S.useState(!1),[P,M]=S.useState(!1),[D,U]=S.useState(null),V=async()=>{try{const Q=new URLSearchParams({status:u,search:p,page:String(v),limit:String(E)}),K=await fetch(`${mR}/api/admin/bank-transfers?${Q.toString()}`,{headers:t});if(!K.ok)throw new Error("Failed to load bank transfers");const q=await K.json();o(q.items||[]),R(q.total||0),O(q.totalPages||1),j(!!q.hasPrev),M(!!q.hasNext)}catch(Q){Ce.error("Load failed",{description:Q==null?void 0:Q.message})}};S.useEffect(()=>{n&&V()},[n,u,v,E]);const z=async(Q,K)=>{try{if(!(await fetch(`${mR}/api/admin/bank-transfers/${Q}/status`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({action:K})})).ok)throw new Error("Action failed");Ce.success("Updated"),V()}catch(q){Ce.error("Failed",{description:q==null?void 0:q.message})}};function W(Q,K){const q=[],ee=J=>q.push(J);if(K<=7){for(let J=1;J<=K;J++)ee(J);return q}ee(1),Q>3&&ee("…");const oe=Math.max(2,Q-1),ae=Math.min(K-1,Q+1);for(let J=oe;J<=ae;J++)ee(J);return Q<K-2&&ee("…"),ee(K),q}const Y=W(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsx(Ne,{placeholder:"Search by user / handle",value:p,onChange:Q=>g(Q.target.value),onKeyDown:Q=>Q.key==="Enter"&&(b(1),V()),className:"w-full sm:w-64"}),c.jsx(be,{onClick:()=>{b(1),V()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:Q=>{b(1),T(Number(Q))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"ID"}),c.jsx(et,{children:"User"}),c.jsx(et,{children:"Handle"}),c.jsx(et,{children:"Price"}),c.jsx(et,{children:"Receipt"}),c.jsx(et,{children:"Time"}),c.jsx(et,{children:"Status"}),c.jsx(et,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.length>0?i.map(Q=>c.jsxs(nn,{children:[c.jsx(He,{children:Q.transfer_id}),c.jsx(He,{children:Q.user_name}),c.jsx(He,{children:Q.handle}),c.jsx(He,{children:Q.price??"---"}),c.jsx(He,{children:Q.bank_receipt?c.jsx("a",{href:`${mR}/uploads/${Q.bank_receipt}`,target:"_blank",className:"text-blue-500 underline",children:"View"}):"-"}),c.jsx(He,{children:new Date(Q.time).toLocaleString()}),c.jsx(He,{children:Q.status===1?"Success":Q.status===-1?"Failed":"Pending"}),c.jsxs(He,{className:"text-right space-x-2",children:[c.jsx(be,{size:"sm",onClick:()=>z(Q.transfer_id,"accept"),children:"Approve"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>z(Q.transfer_id,"decline"),children:"Reject"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>U(Q),children:"View"})]})]},Q.transfer_id)):c.jsx(nn,{children:c.jsx(He,{colSpan:9,className:"text-center text-gray-500",children:"No data available"})})})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(Lm,{children:c.jsxs(Mm,{children:[c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Xn,{children:c.jsx(Um,{onClick:()=>b(Q=>Math.max(1,Q-1)),className:k?"":"pointer-events-none opacity-50"})}),Y.map((Q,K)=>Q==="…"?c.jsx(Xn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${K}`):c.jsx(Xn,{children:c.jsx(na,{isActive:Q===v,onClick:()=>b(Q),children:Q})},Q)),c.jsx(Xn,{children:c.jsx(Fm,{onClick:()=>b(Q=>Math.min(N,Q+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Xn,{children:c.jsx(na,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]}),c.jsx(Yo,{open:!!D,onOpenChange:()=>U(null),children:c.jsxs(vo,{className:"max-w-lg",children:[c.jsxs(Xo,{children:[c.jsx(Jo,{children:"Bank Transfer Details"}),c.jsxs(t_,{children:["Transfer #",D==null?void 0:D.transfer_id]})]}),D&&c.jsxs("div",{className:"space-y-3 text-md",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"User:"})," ",D.user_name]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Handle:"})," ",D.handle]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Price:"})," ",D.price??"---"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Receipt:"})," ",D.bank_receipt?c.jsx("a",{href:`${mR}/uploads/${D.bank_receipt}`,target:"_blank",className:"text-blue-500 underline",children:"View Receipt"}):"-"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Time:"})," ",new Date(D.time).toLocaleString()]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",D.status===1?"Success":D.status===-1?"Failed":"Pending"]})]})]})})]})}const oM="https://api.gada.chat",gR=25;function pv({title:e,value:t,gradient:n,Icon:i}){return c.jsxs("div",{className:`relative overflow-hidden rounded-3xl px-6 py-7 text-white shadow-sm bg-gradient-to-tr ${n}`,children:[c.jsx("div",{className:"pointer-events-none absolute -right-10 -bottom-10 h-40 w-40 rounded-full bg-white/20"}),c.jsx("div",{className:"pointer-events-none absolute -right-16 bottom-0 h-28 w-28 rounded-full bg-white/10"}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-extrabold leading-none",children:t}),c.jsx("div",{className:"mt-2 text-xl font-semibold opacity-95",children:e})]}),c.jsx("div",{className:"shrink-0",children:c.jsx("div",{className:"grid place-items-center h-12 w-12 rounded-2xl bg-white/15",children:c.jsx(i,{className:"h-6 w-6 text-white"})})})]})]})}function LSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState(1),[p,g]=S.useState(0),[v,b]=S.useState(1),[E,T]=S.useState(!1),[C,R]=S.useState(!1),[N,O]=S.useState(null),[k,j]=S.useState([]),[P,M]=S.useState([]),[D,U]=S.useState(null),V=async()=>{try{const K=new URLSearchParams({page:String(u),limit:String(gR)}),q=await fetch(`${oM}/api/admin/earning-payments?${K.toString()}`,{headers:t});if(!q.ok)throw new Error("Failed to load earning payments");const ee=await q.json();o(ee.items||[]),g(ee.total||0),b(ee.totalPages||1),T(!!ee.hasPrev),R(!!ee.hasNext)}catch(K){Ce.error("Load failed",{description:K==null?void 0:K.message})}},z=async()=>{try{const K=await fetch(`${oM}/api/admin/earning-payments/log-points-stats`,{headers:t});if(!K.ok)throw new Error("Failed to load stats");const q=await K.json();O(q)}catch(K){Ce.error("Stats load failed",{description:K==null?void 0:K.message})}},W=async()=>{try{const K=await fetch(`${oM}/api/admin/earning-payments/payin-methods`,{headers:t});if(!K.ok)throw new Error("Failed to load chart");const q=await K.json();j(q.data),M(q.methods)}catch(K){Ce.error("Chart load failed",{description:K==null?void 0:K.message})}};S.useEffect(()=>{n&&(V(),z(),W())},[n,u]);function Y(K,q){const ee=[],oe=re=>ee.push(re);if(q<=7){for(let re=1;re<=q;re++)oe(re);return ee}oe(1),K>3&&oe("…");const ae=Math.max(2,K-1),J=Math.min(q-1,K+1);for(let re=ae;re<=J;re++)oe(re);return K<q-2&&oe("…"),oe(q),ee}const Q=Y(u,v);return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Earnings - Payments"}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"PayIn Methods"}),c.jsx(m3,{width:"100%",height:300,children:c.jsxs(Z3,{data:k,children:[c.jsx(lO,{strokeDasharray:"3 3"}),c.jsx(E_,{dataKey:"month"}),c.jsx(w_,{}),c.jsx(Oc,{}),c.jsx(jd,{}),P.map((K,q)=>c.jsx(Wo,{dataKey:K,fill:q===0?"#3b82f6":"#8b5cf6"},K))]})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[c.jsx(pv,{title:"Total PayIn",value:N?N.totalPayIn.toFixed(2):"—",gradient:"from-indigo-500 to-blue-500",Icon:zZ}),c.jsx(pv,{title:"This Month PayIn",value:N?N.totalPayInMonth.toFixed(2):"—",gradient:"from-green-500 to-emerald-500",Icon:zZ}),c.jsx(pv,{title:"Total Pending PayOut",value:N?N.pendingPayOut.toFixed(2):"—",gradient:"from-purple-500 to-violet-500",Icon:KZ}),c.jsx(pv,{title:"This Month Pending PayOut",value:N?N.pendingPayOutMonth.toFixed(2):"—",gradient:"from-pink-500 to-rose-500",Icon:KZ}),c.jsx(pv,{title:"Total Approved PayOut",value:N?N.totalPayOut.toFixed(2):"—",gradient:"from-yellow-500 to-amber-500",Icon:WZ}),c.jsx(pv,{title:"This Month Approved PayOut",value:N?N.totalPayOutMonth.toFixed(2):"—",gradient:"from-red-500 to-orange-500",Icon:WZ})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsxs("div",{className:"text-sm text-gray-500",children:[p.toLocaleString()," total • Page ",u," of ",v," •"," ",gR," / page"]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Txn ID"}),c.jsx(et,{children:"User"}),c.jsx(et,{children:"Type"}),c.jsx(et,{children:"Node"}),c.jsx(et,{children:"Amount"}),c.jsx(et,{children:"Reference"}),c.jsx(et,{children:"Date"}),c.jsx(et,{className:"text-right",children:"Details"})]})}),c.jsx(ba,{children:i.length>0?i.map(K=>c.jsxs(nn,{children:[c.jsx(He,{children:K.transaction_id}),c.jsx(He,{children:K.user_name??K.user_id}),c.jsx(He,{className:"capitalize",children:K.type}),c.jsxs(He,{children:[K.node_type,K.node_id?` #${K.node_id}`:""]}),c.jsx(He,{children:K.amount}),c.jsx(He,{children:K.reference??"—"}),c.jsx(He,{children:new Date(K.date).toLocaleString()}),c.jsx(He,{className:"text-right",children:c.jsx("button",{className:"text-sm px-3 py-1 rounded border hover:bg-gray-50",onClick:()=>U(K),children:"View"})})]},K.transaction_id)):c.jsx(nn,{children:c.jsx(He,{colSpan:8,className:"text-center text-gray-500",children:"No data available"})})})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(u-1)*gR+1:0,"–",(u-1)*gR+i.length," of ",p]}),c.jsx(Lm,{children:c.jsxs(Mm,{children:[c.jsx(Xn,{children:c.jsx(na,{onClick:()=>h(1),"aria-disabled":u===1,className:u===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Xn,{children:c.jsx(Um,{onClick:()=>h(K=>Math.max(1,K-1)),className:E?"":"pointer-events-none opacity-50"})}),Q.map((K,q)=>K==="…"?c.jsx(Xn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${q}`):c.jsx(Xn,{children:c.jsx(na,{isActive:K===u,onClick:()=>h(K),children:K})},K)),c.jsx(Xn,{children:c.jsx(Fm,{onClick:()=>h(K=>Math.min(v,K+1)),className:C?"":"pointer-events-none opacity-50"})}),c.jsx(Xn,{children:c.jsx(na,{onClick:()=>h(v),"aria-disabled":u===v,className:u===v?"pointer-events-none opacity-50":"",children:"Last"})})]})})]}),c.jsx(Yo,{open:!!D,onOpenChange:()=>U(null),children:c.jsxs(vo,{className:"max-w-lg",children:[c.jsxs(Xo,{children:[c.jsx(Jo,{children:"Earning Payment Details"}),c.jsxs(t_,{children:["Transaction #",D==null?void 0:D.transaction_id]})]}),D&&c.jsxs("div",{className:"space-y-3 text-md",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"User:"})," ",D.user_name??D.user_id]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Type:"})," ",D.type]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Node:"})," ",D.node_type,D.node_id?` #${D.node_id}`:""]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Amount:"})," ",D.amount]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Reference:"})," ",D.reference??"—"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Date:"})," ",new Date(D.date).toLocaleString()]})]})]})})]})]})}const vR="https://api.gada.chat";function MSt(){const{accessToken:e}=st(),t=wt(e),n=S.useMemo(()=>"Authorization"in t,[t]),[i,o]=S.useState([]),[u,h]=S.useState(""),[p,g]=S.useState(!1),v={parentId:0,name:"",description:"",order:1},[b,E]=S.useState(v),[T,C]=S.useState(!1),R=async()=>{const M=new URLSearchParams;u.trim()&&M.set("search",u.trim());const D=await fetch(`${vR}/api/admin/report-categories?`+M,{headers:t});if(!D.ok)return Ce.error("Failed to load categories");const U=await D.json();o(Array.isArray(U)?U:[])};S.useEffect(()=>{n&&R()},[n]);const N=()=>{E(v),g(!0)},O=M=>{E({id:M.id,parentId:M.parentId??0,name:M.name??"",description:M.description??"",order:M.order??1}),g(!0)},k=async()=>{if(!b.name.trim())return Ce.error("Name is required");C(!0);try{const M=b.id?"PUT":"POST",D=b.id?`${vR}/api/admin/report-categories/${b.id}`:`${vR}/api/admin/report-categories`,U=await fetch(D,{method:M,headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({parentId:Number(b.parentId)||0,name:b.name.trim(),description:b.description??"",order:Number(b.order)||1})});if(!U.ok){const V=await U.json().catch(()=>({}));throw new Error((V==null?void 0:V.error)||"Save failed")}Ce.success(b.id?"Updated":"Created"),g(!1),await R()}catch(M){Ce.error(M.message||"Save failed")}finally{C(!1)}},j=async M=>{if(!confirm(`Delete category "${M.name}"?`))return;const D=await fetch(`${vR}/api/admin/report-categories/${M.id}`,{method:"DELETE",headers:t});if(!D.ok){const U=await D.json().catch(()=>({}));return Ce.error((U==null?void 0:U.error)||"Delete failed")}Ce.success("Deleted"),R()},P=S.useMemo(()=>[{id:0,name:"— Parent (no parent) —"},...i.filter(M=>!M.parentId).map(M=>({id:M.id,name:M.name}))],[i]);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Reports › Categories"}),c.jsx(be,{onClick:N,children:"+ Add New Category"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ne,{placeholder:"Search by name or description",value:u,onChange:M=>h(M.target.value),onKeyDown:M=>M.key==="Enter"&&R(),className:"w-full sm:w-96"}),c.jsx(be,{onClick:R,children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(nn,{children:[c.jsx(et,{children:"Title"}),c.jsx(et,{children:"Description"}),c.jsx(et,{className:"w-24",children:"Order"}),c.jsx(et,{className:"w-40",children:"Actions"})]})}),c.jsxs(ba,{children:[i.map(M=>c.jsxs(nn,{children:[c.jsxs(He,{className:"align-top",children:[c.jsx("div",{className:"font-medium",children:M.name}),M.parentId?c.jsxs("div",{className:"text-xs text-gray-500",children:["Child of #",M.parentId]}):c.jsx("div",{className:"text-xs text-gray-500",children:"Parent"})]}),c.jsx(He,{className:"align-top",children:M.description||c.jsx("span",{className:"text-gray-400",children:"—"})}),c.jsx(He,{className:"align-top",children:c.jsx("span",{className:"inline-flex items-center rounded-full bg-cyan-100 text-cyan-700 px-2 py-0.5 text-xs font-medium",children:M.order})}),c.jsxs(He,{className:"align-top space-x-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>O(M),children:"Edit"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>j(M),children:"Delete"})]})]},M.id)),!i.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:4,className:"text-center text-gray-500",children:"No categories found"})})]})]})}),c.jsx(Yo,{open:p,onOpenChange:g,children:c.jsxs(vo,{className:"sm:max-w-lg",children:[c.jsx(Xo,{children:c.jsx(Jo,{children:b.id?"Edit Category":"Create Category"})}),c.jsxs("div",{className:"space-y-4 py-2",children:[c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Je,{children:"Name *"}),c.jsx(Ne,{value:b.name,onChange:M=>E(D=>({...D,name:M.target.value})),placeholder:"e.g., Nudity"})]}),c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Je,{children:"Description"}),c.jsx(wi,{value:b.description,onChange:M=>E(D=>({...D,description:M.target.value})),placeholder:"Optional"})]}),c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Je,{children:"Parent"}),c.jsxs(Pr,{value:String(b.parentId),onValueChange:M=>E(D=>({...D,parentId:Number(M)})),children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:"Select parent"})}),c.jsx(Rr,{children:P.map(M=>c.jsx(ft,{value:String(M.id),children:M.name},M.id))})]})]}),c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Je,{children:"Order"}),c.jsx(Ne,{type:"number",min:1,value:b.order,onChange:M=>E(D=>({...D,order:Number(M.target.value||1)}))})]})]}),c.jsxs(lm,{className:"gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>g(!1),disabled:T,children:"Cancel"}),c.jsx(be,{onClick:k,disabled:T,children:T?"Saving…":"Save"})]})]})})]})}const x_="https://api.gada.chat";async function USt(e,t){const n=new URLSearchParams({status:e.status,page:String(e.page??1),limit:String(e.limit??10),search:e.search??""});return(await fetch(`${x_}/api/admin/ads?${n.toString()}`,{headers:t})).json()}async function FSt(e,t){return(await fetch(`${x_}/api/admin/ads/${e}/approve`,{method:"POST",headers:t})).json()}async function VSt(e,t){return(await fetch(`${x_}/api/admin/ads/${e}/decline`,{method:"POST",headers:t})).json()}async function BSt(e,t,n){return(await fetch(`${x_}/api/admin/ads/${e}/active`,{method:"POST",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({active:t})})).json()}async function $St(e,t){return(await fetch(`${x_}/api/admin/ads/${e}`,{method:"DELETE",headers:t})).json()}async function WSt(e,t){return(await fetch(`${x_}/api/admin/ads/${e}`,{headers:t})).json()}function GSt({open:e,onOpenChange:t,ad:n}){return e?c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>t(!1)}),c.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-full sm:w-[520px] bg-white shadow-xl p-4 overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Ad Details"}),c.jsx("button",{onClick:()=>t(!1),children:"✕"})]}),n?c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Title:"})," ",n.campaign_title]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"User:"})," ",n.user_name," (#",n.user_id,")"]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Budget:"})," ₦",Number(n.campaign_budget).toFixed(2)]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Spend:"})," ₦",Number(n.campaign_spend).toFixed(2)]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Bidding:"})," ",n.campaign_bidding]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Clicks / Views:"})," ",n.campaign_clicks," / ",n.campaign_views]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Placement:"})," ",n.ads_placement]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Start:"})," ",new Date(n.campaign_start_date).toLocaleString()]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"End:"})," ",new Date(n.campaign_end_date).toLocaleString()]}),n.ads_image&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium block mb-1",children:"Image"}),c.jsx("img",{src:n.ads_image,className:"rounded-md max-h-64"})]}),n.ads_url&&c.jsx("div",{className:"mt-2",children:c.jsx("a",{className:"text-indigo-600 underline",href:n.ads_url,target:"_blank",children:"Visit target URL"})})]}):c.jsx("div",{className:"text-sm text-gray-500",children:"No data"})]})]}):null}function HSt(){const{accessToken:e}=st(),t=wt(e),[n,i]=S.useState("pending"),[o,u]=S.useState([]),[h,p]=S.useState(0),[g,v]=S.useState(1),[b,E]=S.useState(10),[T,C]=S.useState(""),[R,N]=S.useState(!1),O=S.useMemo(()=>Math.max(1,Math.ceil(h/b)),[h,b]),[k,j]=S.useState(!1),[P,M]=S.useState(null);async function D(){N(!0);try{const U=await USt({status:n,page:g,limit:b,search:T},t);if(!(U!=null&&U.ok))throw new Error((U==null?void 0:U.error)||"Failed to load");u(U.items??[]),p(U.total??0)}catch(U){Ce.error(U.message||"Failed to load ads")}finally{N(!1)}}return S.useEffect(()=>{D()},[n,g,b,T,e]),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx(Am,{value:n,onValueChange:U=>{i(U),v(1)},children:c.jsxs(jf,{children:[c.jsx(Ia,{value:"pending",children:"Pending"}),c.jsx(Ia,{value:"approved",children:"Approved"})]})}),c.jsx(Ne,{placeholder:"Search title or user…",value:T,onChange:U=>{v(1),C(U.target.value)},className:"w-full md:w-80"}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsxs(Pr,{value:String(b),onValueChange:U=>{E(Number(U)),v(1)},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ft,{value:"10",children:"10 / page"}),c.jsx(ft,{value:"20",children:"20 / page"}),c.jsx(ft,{value:"50",children:"50 / page"}),c.jsx(ft,{value:"100",children:"100 / page"})]})]}),c.jsx(be,{onClick:()=>D(),disabled:R,children:"Refresh"})]})]}),c.jsx("div",{className:"rounded-md border bg-white",children:c.jsxs(ya,{className:"table-fixed",children:[c.jsx(_a,{className:"sticky top-0 bg-white z-10",children:c.jsxs(nn,{children:[c.jsx(et,{className:"w-16",children:"ID"}),c.jsx(et,{children:"Title"}),c.jsx(et,{className:"w-56",children:"By"}),c.jsx(et,{className:"w-32",children:"Budget"}),c.jsx(et,{className:"w-32",children:"Spend"}),c.jsx(et,{className:"w-40",children:"Clicks/Views"}),c.jsx(et,{className:"w-28",children:"Status"}),c.jsx(et,{className:"w-56",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(U=>{const V=U.campaign_is_active===1||U.campaign_is_active==="1",z=Number(U.campaign_clicks||0),W=Number(U.campaign_views||0);return c.jsxs(nn,{children:[c.jsx(He,{children:U.campaign_id}),c.jsx(He,{className:"whitespace-nowrap truncate",children:U.campaign_title}),c.jsx(He,{className:"whitespace-nowrap truncate",children:U.user_name}),c.jsxs(He,{children:["₦",Number(U.campaign_budget).toFixed(2)]}),c.jsxs(He,{children:["₦",Number(U.campaign_spend).toFixed(2)]}),c.jsx(He,{children:z>0?`${z} Clicks`:`${W} Views`}),c.jsx(He,{children:V?c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Active"}):c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-red-50 text-red-700 border border-red-200",children:"Not Active"})}),c.jsx(He,{className:"whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:async()=>{const Y=await WSt(U.campaign_id,t);Y!=null&&Y.ok?(M(Y.item),j(!0)):Ce.error((Y==null?void 0:Y.error)||"Failed to fetch")},title:"View",children:"👁"}),n==="pending"?c.jsxs(c.Fragment,{children:[c.jsx(be,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{const Y=await FSt(U.campaign_id,t);Y!=null&&Y.ok?(Ce.success("Approved"),D()):Ce.error((Y==null?void 0:Y.error)||"Approve failed")},title:"Approve",children:"✓"}),c.jsx(be,{size:"sm",className:"bg-yellow-500 hover:bg-yellow-600",onClick:async()=>{const Y=await VSt(U.campaign_id,t);Y!=null&&Y.ok?(Ce.success("Declined"),D()):Ce.error((Y==null?void 0:Y.error)||"Decline failed")},title:"Decline",children:"✕"})]}):c.jsxs(c.Fragment,{children:[c.jsx(be,{size:"sm",variant:"outline",onClick:async()=>{const Y=await BSt(U.campaign_id,!V,t);Y!=null&&Y.ok?(Ce.success(Y.active?"Activated":"Paused"),u(Q=>Q.map(K=>K.campaign_id===U.campaign_id?{...K,campaign_is_active:Y.active?"1":"0"}:K))):Ce.error((Y==null?void 0:Y.error)||"Status update failed")},title:V?"Pause":"Activate",children:V?"Pause":"Activate"}),c.jsx(be,{size:"sm",className:"bg-red-500 hover:bg-red-600",onClick:async()=>{if(!confirm(`Delete "${U.campaign_title}"?`))return;const Y=await $St(U.campaign_id,t);Y!=null&&Y.ok?(Ce.success("Deleted"),D()):Ce.error((Y==null?void 0:Y.error)||"Delete failed")},title:"Delete",children:"🗑"})]})]})})]},U.campaign_id)}),!o.length&&c.jsx(nn,{children:c.jsx(He,{colSpan:8,className:"text-center py-10 text-gray-500",children:"No ads found"})})]})]})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",g," of ",O," — ",h," ads"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>v(U=>Math.max(1,U-1)),disabled:g<=1||R,children:"Prev"}),c.jsx(be,{variant:"outline",onClick:()=>v(U=>Math.min(O,U+1)),disabled:g>=O||R,children:"Next"})]})]}),c.jsx(GSt,{open:k,onOpenChange:j,ad:P})]})}const zSt=new KUe,KSt=()=>c.jsx(YUe,{client:zSt,children:c.jsx(pVe,{children:c.jsx(K6e,{children:c.jsx(SVe,{children:c.jsx(SUe,{children:c.jsxs(v6e,{children:[c.jsx(L2e,{position:"top-right",richColors:!0,closeButton:!0,theme:"system"}),c.jsx(JFe,{children:c.jsxs(WFe,{children:[c.jsx(Lt,{path:"/",element:c.jsx(TVe,{children:c.jsx(j8e,{})})}),c.jsx(Lt,{path:"/login",element:c.jsx(U8e,{})}),c.jsx(Lt,{path:"/register",element:c.jsx(B8e,{})}),c.jsx(Lt,{path:"/forgot-password",element:c.jsx(G8e,{})}),c.jsx(Lt,{path:"/profile/:id",element:c.jsx(Z8e,{})}),c.jsx(Lt,{path:"*",element:c.jsx(uHe,{})}),c.jsx(Lt,{path:"activation/:token",element:c.jsx(eWe,{})}),c.jsx(Lt,{path:"friends",element:c.jsx(oWe,{})}),c.jsx(Lt,{path:"saved",element:c.jsx(cWe,{})}),c.jsx(Lt,{path:"/memories",element:c.jsx(hWe,{})}),c.jsx(Lt,{path:"/checkout",element:c.jsx(pWe,{})}),c.jsx(Lt,{path:"/wallet",element:c.jsx(TGe,{})}),c.jsx(Lt,{path:"/packages",element:c.jsx(kSt,{})}),c.jsx(Lt,{path:"/points",element:c.jsx(zze,{})}),c.jsx(Lt,{path:"/reels/create",element:c.jsx(OGe,{})}),c.jsx(Lt,{path:"/reels",element:c.jsx(UGe,{children:c.jsx(kGe,{})})}),c.jsx(Lt,{path:"/notifications",element:c.jsx(jGe,{})}),c.jsx(Lt,{path:"/posts/:postId",element:c.jsx(LGe,{})}),c.jsx(Lt,{path:"/settings",element:c.jsx(lHe,{})}),c.jsx(Lt,{path:"/representative",element:c.jsx(Ree,{})}),c.jsx(Lt,{path:"/hashtag/:tag",element:c.jsx(Jze,{})}),c.jsx(Lt,{path:"/messages",element:c.jsx(Qze,{})}),c.jsx(Lt,{path:"/pages",element:c.jsx(f9e,{})}),c.jsx(Lt,{path:"/pages/create",element:c.jsx(m9e,{})}),c.jsx(Lt,{path:"/pages/:handle",element:c.jsx(p9e,{})}),c.jsx(Lt,{path:"/pages/invites",element:c.jsx(v9e,{})}),c.jsx(Lt,{path:"/groups",element:c.jsx(O9e,{})}),c.jsx(Lt,{path:"/groups/invites",element:c.jsx(j9e,{})}),c.jsx(Lt,{path:"/groups/create",element:c.jsx(D9e,{})}),c.jsx(Lt,{path:"/groups/:handle",element:c.jsx(P9e,{})}),c.jsx(Lt,{path:"/events",element:c.jsx(W9e,{})}),c.jsx(Lt,{path:"/events/create",element:c.jsx(G9e,{})}),c.jsx(Lt,{path:"/events/invites",element:c.jsx(z9e,{})}),c.jsx(Lt,{path:"/events/:id",element:c.jsx(K9e,{})}),c.jsx(Lt,{path:"/watch",element:c.jsx(J9e,{})}),c.jsx(Lt,{path:"/affiliates",element:c.jsx(r7e,{})}),c.jsx(Lt,{path:"/ads",element:c.jsx(VYe,{})}),c.jsxs(Lt,{path:"/admin",element:c.jsx(BYe,{children:c.jsx(GYe,{roles:["admin"],children:c.jsx(HYe,{})})}),children:[c.jsx(Lt,{path:"representative",element:c.jsx(Ree,{})}),c.jsx(Lt,{index:!0,element:c.jsx(bwt,{})}),c.jsx(Lt,{path:"users",element:c.jsx(Owt,{})}),c.jsx(Lt,{path:"settings",element:c.jsx(jwt,{})}),c.jsx(Lt,{path:"profile",element:c.jsx(zwt,{})}),c.jsx(Lt,{path:"posts",element:c.jsx(Kwt,{})}),c.jsx(Lt,{path:"representatives",element:c.jsx(jSt,{})}),c.jsx(Lt,{path:"banktransfers",element:c.jsx(DSt,{})}),c.jsx(Lt,{path:"earningspayments",element:c.jsx(LSt,{})}),c.jsx(Lt,{path:"/admin/page-categories",element:c.jsx(qwt,{})}),c.jsx(Lt,{path:"/admin/page-categories/new",element:c.jsx(tae,{})}),c.jsx(Lt,{path:"/admin/page-categories/:id",element:c.jsx(tae,{})}),c.jsx(Lt,{path:"/admin/groups",element:c.jsx(Ywt,{})}),c.jsx(Lt,{path:"/admin/group-categories",element:c.jsx(Xwt,{})}),c.jsx(Lt,{path:"/admin/group-categories/new",element:c.jsx(rae,{})}),c.jsx(Lt,{path:"/admin/group-categories/:id",element:c.jsx(rae,{})}),c.jsx(Lt,{path:"/admin/events",element:c.jsx(Jwt,{})}),c.jsx(Lt,{path:"/admin/events/new",element:c.jsx(aae,{})}),c.jsx(Lt,{path:"/admin/events/:id",element:c.jsx(aae,{})}),c.jsx(Lt,{path:"/admin/events-categories",element:c.jsx(Zwt,{})}),c.jsx(Lt,{path:"/admin/events-categories/new",element:c.jsx(sae,{})}),c.jsx(Lt,{path:"/admin/events-categories/:id",element:c.jsx(sae,{})}),c.jsx(Lt,{path:"/admin/payment-requests",element:c.jsx(Qwt,{})}),c.jsx(Lt,{path:"/admin/settings/payments",element:c.jsx(aSt,{})}),c.jsx(Lt,{path:"/admin/wallet-settings",element:c.jsx(uSt,{})}),c.jsx(Lt,{path:"/admin/earnings/packages",element:c.jsx(pSt,{})}),c.jsx(Lt,{path:"/admin/packages",element:c.jsx(ESt,{})}),c.jsx(Lt,{path:"/admin/packages/new",element:c.jsx(cae,{})}),c.jsx(Lt,{path:"/admin/packages/:id/edit",element:c.jsx(cae,{})}),c.jsx(Lt,{path:"/admin/subscribers",element:c.jsx(xSt,{})}),c.jsx(Lt,{path:"/admin/settings/points",element:c.jsx(TSt,{})}),c.jsx(Lt,{path:"/admin/reports",element:c.jsx(RSt,{})}),c.jsx(Lt,{path:"/admin/reports/categories",element:c.jsx(MSt,{})}),c.jsx(Lt,{path:"/admin/ads",element:c.jsx(HSt,{})}),c.jsx(Lt,{path:"/admin/adssettings",element:c.jsx(ISt,{})})]})]})})]})})})})})});(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function e(P){try{return P.defaultView&&P.defaultView.frameElement||null}catch{return null}}var t=function(P){for(var M=P,D=e(M);D;)M=D.ownerDocument,D=e(M);return M}(window.document),n=[],i=null,o=null;function u(P){this.time=P.time,this.target=P.target,this.rootBounds=R(P.rootBounds),this.boundingClientRect=R(P.boundingClientRect),this.intersectionRect=R(P.intersectionRect||C()),this.isIntersecting=!!P.intersectionRect;var M=this.boundingClientRect,D=M.width*M.height,U=this.intersectionRect,V=U.width*U.height;D?this.intersectionRatio=Number((V/D).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function h(P,M){var D=M||{};if(typeof P!="function")throw new Error("callback must be a function");if(D.root&&D.root.nodeType!=1&&D.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=g(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=P,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(D.rootMargin),this.thresholds=this._initThresholds(D.threshold),this.root=D.root||null,this.rootMargin=this._rootMarginValues.map(function(U){return U.value+U.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}h.prototype.THROTTLE_TIMEOUT=100,h.prototype.POLL_INTERVAL=null,h.prototype.USE_MUTATION_OBSERVER=!0,h._setupCrossOriginUpdater=function(){return i||(i=function(P,M){!P||!M?o=C():o=N(P,M),n.forEach(function(D){D._checkForIntersections()})}),i},h._resetCrossOriginUpdater=function(){i=null,o=null},h.prototype.observe=function(P){var M=this._observationTargets.some(function(D){return D.element==P});if(!M){if(!(P&&P.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:P,entry:null}),this._monitorIntersections(P.ownerDocument),this._checkForIntersections()}},h.prototype.unobserve=function(P){this._observationTargets=this._observationTargets.filter(function(M){return M.element!=P}),this._unmonitorIntersections(P.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},h.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},h.prototype.takeRecords=function(){var P=this._queuedEntries.slice();return this._queuedEntries=[],P},h.prototype._initThresholds=function(P){var M=P||[0];return Array.isArray(M)||(M=[M]),M.sort().filter(function(D,U,V){if(typeof D!="number"||isNaN(D)||D<0||D>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return D!==V[U-1]})},h.prototype._parseRootMargin=function(P){var M=P||"0px",D=M.split(/\s+/).map(function(U){var V=/^(-?\d*\.?\d+)(px|%)$/.exec(U);if(!V)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(V[1]),unit:V[2]}});return D[1]=D[1]||D[0],D[2]=D[2]||D[0],D[3]=D[3]||D[1],D},h.prototype._monitorIntersections=function(P){var M=P.defaultView;if(M&&this._monitoringDocuments.indexOf(P)==-1){var D=this._checkForIntersections,U=null,V=null;this.POLL_INTERVAL?U=M.setInterval(D,this.POLL_INTERVAL):(v(M,"resize",D,!0),v(P,"scroll",D,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in M&&(V=new M.MutationObserver(D),V.observe(P,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(P),this._monitoringUnsubscribes.push(function(){var Y=P.defaultView;Y&&(U&&Y.clearInterval(U),b(Y,"resize",D,!0)),b(P,"scroll",D,!0),V&&V.disconnect()});var z=this.root&&(this.root.ownerDocument||this.root)||t;if(P!=z){var W=e(P);W&&this._monitorIntersections(W.ownerDocument)}}},h.prototype._unmonitorIntersections=function(P){var M=this._monitoringDocuments.indexOf(P);if(M!=-1){var D=this.root&&(this.root.ownerDocument||this.root)||t,U=this._observationTargets.some(function(W){var Y=W.element.ownerDocument;if(Y==P)return!0;for(;Y&&Y!=D;){var Q=e(Y);if(Y=Q&&Q.ownerDocument,Y==P)return!0}return!1});if(!U){var V=this._monitoringUnsubscribes[M];if(this._monitoringDocuments.splice(M,1),this._monitoringUnsubscribes.splice(M,1),V(),P!=D){var z=e(P);z&&this._unmonitorIntersections(z.ownerDocument)}}}},h.prototype._unmonitorAllIntersections=function(){var P=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var M=0;M<P.length;M++)P[M]()},h.prototype._checkForIntersections=function(){if(!(!this.root&&i&&!o)){var P=this._rootIsInDom(),M=P?this._getRootRect():C();this._observationTargets.forEach(function(D){var U=D.element,V=T(U),z=this._rootContainsTarget(U),W=D.entry,Y=P&&z&&this._computeTargetAndRootIntersection(U,V,M),Q=null;this._rootContainsTarget(U)?(!i||this.root)&&(Q=M):Q=C();var K=D.entry=new u({time:p(),target:U,boundingClientRect:V,rootBounds:Q,intersectionRect:Y});W?P&&z?this._hasCrossedThreshold(W,K)&&this._queuedEntries.push(K):W&&W.isIntersecting&&this._queuedEntries.push(K):this._queuedEntries.push(K)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},h.prototype._computeTargetAndRootIntersection=function(P,M,D){if(window.getComputedStyle(P).display!="none"){for(var U=M,V=k(P),z=!1;!z&&V;){var W=null,Y=V.nodeType==1?window.getComputedStyle(V):{};if(Y.display=="none")return null;if(V==this.root||V.nodeType==9)if(z=!0,V==this.root||V==t)i&&!this.root?!o||o.width==0&&o.height==0?(V=null,W=null,U=null):W=o:W=D;else{var Q=k(V),K=Q&&T(Q),q=Q&&this._computeTargetAndRootIntersection(Q,K,D);K&&q?(V=Q,W=N(K,q)):(V=null,U=null)}else{var ee=V.ownerDocument;V!=ee.body&&V!=ee.documentElement&&Y.overflow!="visible"&&(W=T(V))}if(W&&(U=E(W,U)),!U)break;V=V&&k(V)}return U}},h.prototype._getRootRect=function(){var P;if(this.root&&!j(this.root))P=T(this.root);else{var M=j(this.root)?this.root:t,D=M.documentElement,U=M.body;P={top:0,left:0,right:D.clientWidth||U.clientWidth,width:D.clientWidth||U.clientWidth,bottom:D.clientHeight||U.clientHeight,height:D.clientHeight||U.clientHeight}}return this._expandRectByRootMargin(P)},h.prototype._expandRectByRootMargin=function(P){var M=this._rootMarginValues.map(function(U,V){return U.unit=="px"?U.value:U.value*(V%2?P.width:P.height)/100}),D={top:P.top-M[0],right:P.right+M[1],bottom:P.bottom+M[2],left:P.left-M[3]};return D.width=D.right-D.left,D.height=D.bottom-D.top,D},h.prototype._hasCrossedThreshold=function(P,M){var D=P&&P.isIntersecting?P.intersectionRatio||0:-1,U=M.isIntersecting?M.intersectionRatio||0:-1;if(D!==U)for(var V=0;V<this.thresholds.length;V++){var z=this.thresholds[V];if(z==D||z==U||z<D!=z<U)return!0}},h.prototype._rootIsInDom=function(){return!this.root||O(t,this.root)},h.prototype._rootContainsTarget=function(P){var M=this.root&&(this.root.ownerDocument||this.root)||t;return O(M,P)&&(!this.root||M==P.ownerDocument)},h.prototype._registerInstance=function(){n.indexOf(this)<0&&n.push(this)},h.prototype._unregisterInstance=function(){var P=n.indexOf(this);P!=-1&&n.splice(P,1)};function p(){return window.performance&&performance.now&&performance.now()}function g(P,M){var D=null;return function(){D||(D=setTimeout(function(){P(),D=null},M))}}function v(P,M,D,U){typeof P.addEventListener=="function"?P.addEventListener(M,D,U):typeof P.attachEvent=="function"&&P.attachEvent("on"+M,D)}function b(P,M,D,U){typeof P.removeEventListener=="function"?P.removeEventListener(M,D,U):typeof P.detachEvent=="function"&&P.detachEvent("on"+M,D)}function E(P,M){var D=Math.max(P.top,M.top),U=Math.min(P.bottom,M.bottom),V=Math.max(P.left,M.left),z=Math.min(P.right,M.right),W=z-V,Y=U-D;return W>=0&&Y>=0&&{top:D,bottom:U,left:V,right:z,width:W,height:Y}||null}function T(P){var M;try{M=P.getBoundingClientRect()}catch{}return M?(M.width&&M.height||(M={top:M.top,right:M.right,bottom:M.bottom,left:M.left,width:M.right-M.left,height:M.bottom-M.top}),M):C()}function C(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function R(P){return!P||"x"in P?P:{top:P.top,y:P.top,bottom:P.bottom,left:P.left,x:P.left,right:P.right,width:P.width,height:P.height}}function N(P,M){var D=M.top-P.top,U=M.left-P.left;return{top:D,left:U,height:M.height,width:M.width,bottom:D+M.height,right:U+M.width}}function O(P,M){for(var D=M;D;){if(D==P)return!0;D=k(D)}return!1}function k(P){var M=P.parentNode;return P.nodeType==9&&P!=t?e(P):(M&&M.assignedSlot&&(M=M.assignedSlot.parentNode),M&&M.nodeType==11&&M.host?M.host:M)}function j(P){return P&&P.nodeType===9}window.IntersectionObserver=h,window.IntersectionObserverEntry=u})();Poe(document.getElementById("root")).render(c.jsx(KSt,{}));
