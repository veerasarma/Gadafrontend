var ZX=e=>{throw TypeError(e)};var b2=(e,t,n)=>t.has(e)||ZX("Cannot "+n);var tt=(e,t,n)=>(b2(e,t,"read from private field"),n?n.call(e):t.get(e)),yr=(e,t,n)=>t.has(e)?ZX("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),On=(e,t,n,i)=>(b2(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),hs=(e,t,n)=>(b2(e,t,"access private method"),n);var mC=(e,t,n,i)=>({set _(o){On(e,t,o,n)},get _(){return tt(e,t,i)}});function Uke(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const o in i)if(o!=="default"&&!(o in e)){const u=Object.getOwnPropertyDescriptor(i,o);u&&Object.defineProperty(e,o,u.get?u:{enumerable:!0,get:()=>i[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}})();var Xh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _ae={exports:{}},e1={},bae={exports:{}},Jn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ow=Symbol.for("react.element"),Fke=Symbol.for("react.portal"),Vke=Symbol.for("react.fragment"),Bke=Symbol.for("react.strict_mode"),$ke=Symbol.for("react.profiler"),Wke=Symbol.for("react.provider"),Gke=Symbol.for("react.context"),Hke=Symbol.for("react.forward_ref"),zke=Symbol.for("react.suspense"),Kke=Symbol.for("react.memo"),qke=Symbol.for("react.lazy"),QX=Symbol.iterator;function Yke(e){return e===null||typeof e!="object"?null:(e=QX&&e[QX]||e["@@iterator"],typeof e=="function"?e:null)}var Eae={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wae=Object.assign,Sae={};function By(e,t,n){this.props=e,this.context=t,this.refs=Sae,this.updater=n||Eae}By.prototype.isReactComponent={};By.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};By.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function xae(){}xae.prototype=By.prototype;function gV(e,t,n){this.props=e,this.context=t,this.refs=Sae,this.updater=n||Eae}var vV=gV.prototype=new xae;vV.constructor=gV;wae(vV,By.prototype);vV.isPureReactComponent=!0;var eJ=Array.isArray,Tae=Object.prototype.hasOwnProperty,yV={current:null},Cae={key:!0,ref:!0,__self:!0,__source:!0};function Rae(e,t,n){var i,o={},u=null,h=null;if(t!=null)for(i in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(u=""+t.key),t)Tae.call(t,i)&&!Cae.hasOwnProperty(i)&&(o[i]=t[i]);var p=arguments.length-2;if(p===1)o.children=n;else if(1<p){for(var g=Array(p),v=0;v<p;v++)g[v]=arguments[v+2];o.children=g}if(e&&e.defaultProps)for(i in p=e.defaultProps,p)o[i]===void 0&&(o[i]=p[i]);return{$$typeof:Ow,type:e,key:u,ref:h,props:o,_owner:yV.current}}function Xke(e,t){return{$$typeof:Ow,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function _V(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ow}function Jke(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var tJ=/\/+/g;function E2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Jke(""+e.key):t.toString(36)}function TR(e,t,n,i,o){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(u){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case Ow:case Fke:h=!0}}if(h)return h=e,o=o(h),e=i===""?"."+E2(h,0):i,eJ(o)?(n="",e!=null&&(n=e.replace(tJ,"$&/")+"/"),TR(o,t,n,"",function(v){return v})):o!=null&&(_V(o)&&(o=Xke(o,n+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(tJ,"$&/")+"/")+e)),t.push(o)),1;if(h=0,i=i===""?".":i+":",eJ(e))for(var p=0;p<e.length;p++){u=e[p];var g=i+E2(u,p);h+=TR(u,t,n,g,o)}else if(g=Yke(e),typeof g=="function")for(e=g.call(e),p=0;!(u=e.next()).done;)u=u.value,g=i+E2(u,p++),h+=TR(u,t,n,g,o);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function gC(e,t,n){if(e==null)return e;var i=[],o=0;return TR(e,i,"","",function(u){return t.call(n,u,o++)}),i}function Zke(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ms={current:null},CR={transition:null},Qke={ReactCurrentDispatcher:Ms,ReactCurrentBatchConfig:CR,ReactCurrentOwner:yV};function Nae(){throw Error("act(...) is not supported in production builds of React.")}Jn.Children={map:gC,forEach:function(e,t,n){gC(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return gC(e,function(){t++}),t},toArray:function(e){return gC(e,function(t){return t})||[]},only:function(e){if(!_V(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Jn.Component=By;Jn.Fragment=Vke;Jn.Profiler=$ke;Jn.PureComponent=gV;Jn.StrictMode=Bke;Jn.Suspense=zke;Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qke;Jn.act=Nae;Jn.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=wae({},e.props),o=e.key,u=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,h=yV.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var p=e.type.defaultProps;for(g in t)Tae.call(t,g)&&!Cae.hasOwnProperty(g)&&(i[g]=t[g]===void 0&&p!==void 0?p[g]:t[g])}var g=arguments.length-2;if(g===1)i.children=n;else if(1<g){p=Array(g);for(var v=0;v<g;v++)p[v]=arguments[v+2];i.children=p}return{$$typeof:Ow,type:e.type,key:o,ref:u,props:i,_owner:h}};Jn.createContext=function(e){return e={$$typeof:Gke,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Wke,_context:e},e.Consumer=e};Jn.createElement=Rae;Jn.createFactory=function(e){var t=Rae.bind(null,e);return t.type=e,t};Jn.createRef=function(){return{current:null}};Jn.forwardRef=function(e){return{$$typeof:Hke,render:e}};Jn.isValidElement=_V;Jn.lazy=function(e){return{$$typeof:qke,_payload:{_status:-1,_result:e},_init:Zke}};Jn.memo=function(e,t){return{$$typeof:Kke,type:e,compare:t===void 0?null:t}};Jn.startTransition=function(e){var t=CR.transition;CR.transition={};try{e()}finally{CR.transition=t}};Jn.unstable_act=Nae;Jn.useCallback=function(e,t){return Ms.current.useCallback(e,t)};Jn.useContext=function(e){return Ms.current.useContext(e)};Jn.useDebugValue=function(){};Jn.useDeferredValue=function(e){return Ms.current.useDeferredValue(e)};Jn.useEffect=function(e,t){return Ms.current.useEffect(e,t)};Jn.useId=function(){return Ms.current.useId()};Jn.useImperativeHandle=function(e,t,n){return Ms.current.useImperativeHandle(e,t,n)};Jn.useInsertionEffect=function(e,t){return Ms.current.useInsertionEffect(e,t)};Jn.useLayoutEffect=function(e,t){return Ms.current.useLayoutEffect(e,t)};Jn.useMemo=function(e,t){return Ms.current.useMemo(e,t)};Jn.useReducer=function(e,t,n){return Ms.current.useReducer(e,t,n)};Jn.useRef=function(e){return Ms.current.useRef(e)};Jn.useState=function(e){return Ms.current.useState(e)};Jn.useSyncExternalStore=function(e,t,n){return Ms.current.useSyncExternalStore(e,t,n)};Jn.useTransition=function(){return Ms.current.useTransition()};Jn.version="18.3.1";bae.exports=Jn;var w=bae.exports;const me=jr(w),s0=Uke({__proto__:null,default:me},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eje=w,tje=Symbol.for("react.element"),nje=Symbol.for("react.fragment"),rje=Object.prototype.hasOwnProperty,ije=eje.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,aje={key:!0,ref:!0,__self:!0,__source:!0};function Aae(e,t,n){var i,o={},u=null,h=null;n!==void 0&&(u=""+n),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(h=t.ref);for(i in t)rje.call(t,i)&&!aje.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)o[i]===void 0&&(o[i]=t[i]);return{$$typeof:tje,type:e,key:u,ref:h,props:o,_owner:ije.current}}e1.Fragment=nje;e1.jsx=Aae;e1.jsxs=Aae;_ae.exports=e1;var c=_ae.exports,Iae={exports:{}},Jo={},Oae={exports:{}},Pae={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,ee){var de=re.length;re.push(ee);e:for(;0<de;){var xe=de-1>>>1,ve=re[xe];if(0<o(ve,ee))re[xe]=ee,re[de]=ve,de=xe;else break e}}function n(re){return re.length===0?null:re[0]}function i(re){if(re.length===0)return null;var ee=re[0],de=re.pop();if(de!==ee){re[0]=de;e:for(var xe=0,ve=re.length,Te=ve>>>1;xe<Te;){var Pe=2*(xe+1)-1,qe=re[Pe],st=Pe+1,ze=re[st];if(0>o(qe,de))st<ve&&0>o(ze,qe)?(re[xe]=ze,re[st]=de,xe=st):(re[xe]=qe,re[Pe]=de,xe=Pe);else if(st<ve&&0>o(ze,de))re[xe]=ze,re[st]=de,xe=st;else break e}}return ee}function o(re,ee){var de=re.sortIndex-ee.sortIndex;return de!==0?de:re.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();e.unstable_now=function(){return h.now()-p}}var g=[],v=[],b=1,E=null,T=3,C=!1,R=!1,N=!1,O=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(re){for(var ee=n(v);ee!==null;){if(ee.callback===null)i(v);else if(ee.startTime<=re)i(v),ee.sortIndex=ee.expirationTime,t(g,ee);else break;ee=n(v)}}function M(re){if(N=!1,P(re),!R)if(n(g)!==null)R=!0,se(D);else{var ee=n(v);ee!==null&&J(M,ee.startTime-re)}}function D(re,ee){R=!1,N&&(N=!1,j(H),H=-1),C=!0;var de=T;try{for(P(ee),E=n(g);E!==null&&(!(E.expirationTime>ee)||re&&!Y());){var xe=E.callback;if(typeof xe=="function"){E.callback=null,T=E.priorityLevel;var ve=xe(E.expirationTime<=ee);ee=e.unstable_now(),typeof ve=="function"?E.callback=ve:E===n(g)&&i(g),P(ee)}else i(g);E=n(g)}if(E!==null)var Te=!0;else{var Pe=n(v);Pe!==null&&J(M,Pe.startTime-ee),Te=!1}return Te}finally{E=null,T=de,C=!1}}var U=!1,F=null,H=-1,W=5,q=-1;function Y(){return!(e.unstable_now()-q<W)}function z(){if(F!==null){var re=e.unstable_now();q=re;var ee=!0;try{ee=F(!0,re)}finally{ee?Z():(U=!1,F=null)}}else U=!1}var Z;if(typeof k=="function")Z=function(){k(z)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ae=X.port2;X.port1.onmessage=z,Z=function(){ae.postMessage(null)}}else Z=function(){O(z,0)};function se(re){F=re,U||(U=!0,Z())}function J(re,ee){H=O(function(){re(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){R||C||(R=!0,se(D))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return n(g)},e.unstable_next=function(re){switch(T){case 1:case 2:case 3:var ee=3;break;default:ee=T}var de=T;T=ee;try{return re()}finally{T=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,ee){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var de=T;T=re;try{return ee()}finally{T=de}},e.unstable_scheduleCallback=function(re,ee,de){var xe=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?xe+de:xe):de=xe,re){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=de+ve,re={id:b++,callback:ee,priorityLevel:re,startTime:de,expirationTime:ve,sortIndex:-1},de>xe?(re.sortIndex=de,t(v,re),n(g)===null&&re===n(v)&&(N?(j(H),H=-1):N=!0,J(M,de-xe))):(re.sortIndex=ve,t(g,re),R||C||(R=!0,se(D))),re},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(re){var ee=T;return function(){var de=T;T=ee;try{return re.apply(this,arguments)}finally{T=de}}}})(Pae);Oae.exports=Pae;var sje=Oae.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oje=w,zo=sje;function mt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kae=new Set,o0={};function bm(e,t){Qv(e,t),Qv(e+"Capture",t)}function Qv(e,t){for(o0[e]=t,e=0;e<t.length;e++)kae.add(t[e])}var Dd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lM=Object.prototype.hasOwnProperty,cje=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nJ={},rJ={};function lje(e){return lM.call(rJ,e)?!0:lM.call(nJ,e)?!1:cje.test(e)?rJ[e]=!0:(nJ[e]=!0,!1)}function uje(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function dje(e,t,n,i){if(t===null||typeof t>"u"||uje(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Us(e,t,n,i,o,u,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=h}var rs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rs[e]=new Us(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rs[t]=new Us(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rs[e]=new Us(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rs[e]=new Us(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rs[e]=new Us(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rs[e]=new Us(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rs[e]=new Us(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rs[e]=new Us(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rs[e]=new Us(e,5,!1,e.toLowerCase(),null,!1,!1)});var bV=/[\-:]([a-z])/g;function EV(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(bV,EV);rs[t]=new Us(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(bV,EV);rs[t]=new Us(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(bV,EV);rs[t]=new Us(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rs[e]=new Us(e,1,!1,e.toLowerCase(),null,!1,!1)});rs.xlinkHref=new Us("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rs[e]=new Us(e,1,!1,e.toLowerCase(),null,!0,!0)});function wV(e,t,n,i){var o=rs.hasOwnProperty(t)?rs[t]:null;(o!==null?o.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(dje(t,n,o,i)&&(n=null),i||o===null?lje(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,i=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Kd=oje.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vC=Symbol.for("react.element"),gv=Symbol.for("react.portal"),vv=Symbol.for("react.fragment"),SV=Symbol.for("react.strict_mode"),uM=Symbol.for("react.profiler"),jae=Symbol.for("react.provider"),Dae=Symbol.for("react.context"),xV=Symbol.for("react.forward_ref"),dM=Symbol.for("react.suspense"),hM=Symbol.for("react.suspense_list"),TV=Symbol.for("react.memo"),Uh=Symbol.for("react.lazy"),Lae=Symbol.for("react.offscreen"),iJ=Symbol.iterator;function Zb(e){return e===null||typeof e!="object"?null:(e=iJ&&e[iJ]||e["@@iterator"],typeof e=="function"?e:null)}var Pi=Object.assign,w2;function PE(e){if(w2===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);w2=t&&t[1]||""}return`
`+w2+e}var S2=!1;function x2(e,t){if(!e||S2)return"";S2=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(v){var i=v}Reflect.construct(e,[],t)}else{try{t.call()}catch(v){i=v}e.call(t.prototype)}else{try{throw Error()}catch(v){i=v}e()}}catch(v){if(v&&i&&typeof v.stack=="string"){for(var o=v.stack.split(`
`),u=i.stack.split(`
`),h=o.length-1,p=u.length-1;1<=h&&0<=p&&o[h]!==u[p];)p--;for(;1<=h&&0<=p;h--,p--)if(o[h]!==u[p]){if(h!==1||p!==1)do if(h--,p--,0>p||o[h]!==u[p]){var g=`
`+o[h].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=h&&0<=p);break}}}finally{S2=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?PE(e):""}function hje(e){switch(e.tag){case 5:return PE(e.type);case 16:return PE("Lazy");case 13:return PE("Suspense");case 19:return PE("SuspenseList");case 0:case 2:case 15:return e=x2(e.type,!1),e;case 11:return e=x2(e.type.render,!1),e;case 1:return e=x2(e.type,!0),e;default:return""}}function fM(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vv:return"Fragment";case gv:return"Portal";case uM:return"Profiler";case SV:return"StrictMode";case dM:return"Suspense";case hM:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Dae:return(e.displayName||"Context")+".Consumer";case jae:return(e._context.displayName||"Context")+".Provider";case xV:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case TV:return t=e.displayName||null,t!==null?t:fM(e.type)||"Memo";case Uh:t=e._payload,e=e._init;try{return fM(e(t))}catch{}}return null}function fje(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fM(t);case 8:return t===SV?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function gf(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mae(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pje(e){var t=Mae(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,u=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(h){i=""+h,u.call(this,h)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(h){i=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yC(e){e._valueTracker||(e._valueTracker=pje(e))}function Uae(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Mae(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function QR(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pM(e,t){var n=t.checked;return Pi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function aJ(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=gf(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fae(e,t){t=t.checked,t!=null&&wV(e,"checked",t,!1)}function mM(e,t){Fae(e,t);var n=gf(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?gM(e,t.type,n):t.hasOwnProperty("defaultValue")&&gM(e,t.type,gf(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function sJ(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function gM(e,t,n){(t!=="number"||QR(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var kE=Array.isArray;function Ov(e,t,n,i){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&i&&(e[n].defaultSelected=!0)}else{for(n=""+gf(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function vM(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(mt(91));return Pi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oJ(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(mt(92));if(kE(n)){if(1<n.length)throw Error(mt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:gf(n)}}function Vae(e,t){var n=gf(t.value),i=gf(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function cJ(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Bae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yM(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Bae(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _C,$ae=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_C=_C||document.createElement("div"),_C.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_C.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function c0(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var GE={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mje=["Webkit","ms","Moz","O"];Object.keys(GE).forEach(function(e){mje.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),GE[t]=GE[e]})});function Wae(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||GE.hasOwnProperty(e)&&GE[e]?(""+t).trim():t+"px"}function Gae(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,o=Wae(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,o):e[n]=o}}var gje=Pi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _M(e,t){if(t){if(gje[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(mt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(mt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(mt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(mt(62))}}function bM(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var EM=null;function CV(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wM=null,Pv=null,kv=null;function lJ(e){if(e=jw(e)){if(typeof wM!="function")throw Error(mt(280));var t=e.stateNode;t&&(t=a1(t),wM(e.stateNode,e.type,t))}}function Hae(e){Pv?kv?kv.push(e):kv=[e]:Pv=e}function zae(){if(Pv){var e=Pv,t=kv;if(kv=Pv=null,lJ(e),t)for(e=0;e<t.length;e++)lJ(t[e])}}function Kae(e,t){return e(t)}function qae(){}var T2=!1;function Yae(e,t,n){if(T2)return e(t,n);T2=!0;try{return Kae(e,t,n)}finally{T2=!1,(Pv!==null||kv!==null)&&(qae(),zae())}}function l0(e,t){var n=e.stateNode;if(n===null)return null;var i=a1(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(mt(231,t,typeof n));return n}var SM=!1;if(Dd)try{var Qb={};Object.defineProperty(Qb,"passive",{get:function(){SM=!0}}),window.addEventListener("test",Qb,Qb),window.removeEventListener("test",Qb,Qb)}catch{SM=!1}function vje(e,t,n,i,o,u,h,p,g){var v=Array.prototype.slice.call(arguments,3);try{t.apply(n,v)}catch(b){this.onError(b)}}var HE=!1,eN=null,tN=!1,xM=null,yje={onError:function(e){HE=!0,eN=e}};function _je(e,t,n,i,o,u,h,p,g){HE=!1,eN=null,vje.apply(yje,arguments)}function bje(e,t,n,i,o,u,h,p,g){if(_je.apply(this,arguments),HE){if(HE){var v=eN;HE=!1,eN=null}else throw Error(mt(198));tN||(tN=!0,xM=v)}}function Em(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Xae(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function uJ(e){if(Em(e)!==e)throw Error(mt(188))}function Eje(e){var t=e.alternate;if(!t){if(t=Em(e),t===null)throw Error(mt(188));return t!==e?null:e}for(var n=e,i=t;;){var o=n.return;if(o===null)break;var u=o.alternate;if(u===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===u.child){for(u=o.child;u;){if(u===n)return uJ(o),e;if(u===i)return uJ(o),t;u=u.sibling}throw Error(mt(188))}if(n.return!==i.return)n=o,i=u;else{for(var h=!1,p=o.child;p;){if(p===n){h=!0,n=o,i=u;break}if(p===i){h=!0,i=o,n=u;break}p=p.sibling}if(!h){for(p=u.child;p;){if(p===n){h=!0,n=u,i=o;break}if(p===i){h=!0,i=u,n=o;break}p=p.sibling}if(!h)throw Error(mt(189))}}if(n.alternate!==i)throw Error(mt(190))}if(n.tag!==3)throw Error(mt(188));return n.stateNode.current===n?e:t}function Jae(e){return e=Eje(e),e!==null?Zae(e):null}function Zae(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zae(e);if(t!==null)return t;e=e.sibling}return null}var Qae=zo.unstable_scheduleCallback,dJ=zo.unstable_cancelCallback,wje=zo.unstable_shouldYield,Sje=zo.unstable_requestPaint,Zi=zo.unstable_now,xje=zo.unstable_getCurrentPriorityLevel,RV=zo.unstable_ImmediatePriority,ese=zo.unstable_UserBlockingPriority,nN=zo.unstable_NormalPriority,Tje=zo.unstable_LowPriority,tse=zo.unstable_IdlePriority,t1=null,Ou=null;function Cje(e){if(Ou&&typeof Ou.onCommitFiberRoot=="function")try{Ou.onCommitFiberRoot(t1,e,void 0,(e.current.flags&128)===128)}catch{}}var jl=Math.clz32?Math.clz32:Aje,Rje=Math.log,Nje=Math.LN2;function Aje(e){return e>>>=0,e===0?32:31-(Rje(e)/Nje|0)|0}var bC=64,EC=4194304;function jE(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function rN(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,o=e.suspendedLanes,u=e.pingedLanes,h=n&268435455;if(h!==0){var p=h&~o;p!==0?i=jE(p):(u&=h,u!==0&&(i=jE(u)))}else h=n&~o,h!==0?i=jE(h):u!==0&&(i=jE(u));if(i===0)return 0;if(t!==0&&t!==i&&!(t&o)&&(o=i&-i,u=t&-t,o>=u||o===16&&(u&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-jl(t),o=1<<n,i|=e[n],t&=~o;return i}function Ije(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oje(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,u=e.pendingLanes;0<u;){var h=31-jl(u),p=1<<h,g=o[h];g===-1?(!(p&n)||p&i)&&(o[h]=Ije(p,t)):g<=t&&(e.expiredLanes|=p),u&=~p}}function TM(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function nse(){var e=bC;return bC<<=1,!(bC&4194240)&&(bC=64),e}function C2(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pw(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jl(t),e[t]=n}function Pje(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-jl(n),u=1<<o;t[o]=0,i[o]=-1,e[o]=-1,n&=~u}}function NV(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-jl(n),o=1<<i;o&t|e[i]&t&&(e[i]|=t),n&=~o}}var Br=0;function rse(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ise,AV,ase,sse,ose,CM=!1,wC=[],rf=null,af=null,sf=null,u0=new Map,d0=new Map,$h=[],kje="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hJ(e,t){switch(e){case"focusin":case"focusout":rf=null;break;case"dragenter":case"dragleave":af=null;break;case"mouseover":case"mouseout":sf=null;break;case"pointerover":case"pointerout":u0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":d0.delete(t.pointerId)}}function eE(e,t,n,i,o,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:u,targetContainers:[o]},t!==null&&(t=jw(t),t!==null&&AV(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function jje(e,t,n,i,o){switch(t){case"focusin":return rf=eE(rf,e,t,n,i,o),!0;case"dragenter":return af=eE(af,e,t,n,i,o),!0;case"mouseover":return sf=eE(sf,e,t,n,i,o),!0;case"pointerover":var u=o.pointerId;return u0.set(u,eE(u0.get(u)||null,e,t,n,i,o)),!0;case"gotpointercapture":return u=o.pointerId,d0.set(u,eE(d0.get(u)||null,e,t,n,i,o)),!0}return!1}function cse(e){var t=Mp(e.target);if(t!==null){var n=Em(t);if(n!==null){if(t=n.tag,t===13){if(t=Xae(n),t!==null){e.blockedOn=t,ose(e.priority,function(){ase(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function RR(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=RM(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);EM=i,n.target.dispatchEvent(i),EM=null}else return t=jw(n),t!==null&&AV(t),e.blockedOn=n,!1;t.shift()}return!0}function fJ(e,t,n){RR(e)&&n.delete(t)}function Dje(){CM=!1,rf!==null&&RR(rf)&&(rf=null),af!==null&&RR(af)&&(af=null),sf!==null&&RR(sf)&&(sf=null),u0.forEach(fJ),d0.forEach(fJ)}function tE(e,t){e.blockedOn===t&&(e.blockedOn=null,CM||(CM=!0,zo.unstable_scheduleCallback(zo.unstable_NormalPriority,Dje)))}function h0(e){function t(o){return tE(o,e)}if(0<wC.length){tE(wC[0],e);for(var n=1;n<wC.length;n++){var i=wC[n];i.blockedOn===e&&(i.blockedOn=null)}}for(rf!==null&&tE(rf,e),af!==null&&tE(af,e),sf!==null&&tE(sf,e),u0.forEach(t),d0.forEach(t),n=0;n<$h.length;n++)i=$h[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<$h.length&&(n=$h[0],n.blockedOn===null);)cse(n),n.blockedOn===null&&$h.shift()}var jv=Kd.ReactCurrentBatchConfig,iN=!0;function Lje(e,t,n,i){var o=Br,u=jv.transition;jv.transition=null;try{Br=1,IV(e,t,n,i)}finally{Br=o,jv.transition=u}}function Mje(e,t,n,i){var o=Br,u=jv.transition;jv.transition=null;try{Br=4,IV(e,t,n,i)}finally{Br=o,jv.transition=u}}function IV(e,t,n,i){if(iN){var o=RM(e,t,n,i);if(o===null)L2(e,t,i,aN,n),hJ(e,i);else if(jje(o,e,t,n,i))i.stopPropagation();else if(hJ(e,i),t&4&&-1<kje.indexOf(e)){for(;o!==null;){var u=jw(o);if(u!==null&&ise(u),u=RM(e,t,n,i),u===null&&L2(e,t,i,aN,n),u===o)break;o=u}o!==null&&i.stopPropagation()}else L2(e,t,i,null,n)}}var aN=null;function RM(e,t,n,i){if(aN=null,e=CV(i),e=Mp(e),e!==null)if(t=Em(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Xae(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return aN=e,null}function lse(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xje()){case RV:return 1;case ese:return 4;case nN:case Tje:return 16;case tse:return 536870912;default:return 16}default:return 16}}var Jh=null,OV=null,NR=null;function use(){if(NR)return NR;var e,t=OV,n=t.length,i,o="value"in Jh?Jh.value:Jh.textContent,u=o.length;for(e=0;e<n&&t[e]===o[e];e++);var h=n-e;for(i=1;i<=h&&t[n-i]===o[u-i];i++);return NR=o.slice(e,1<i?1-i:void 0)}function AR(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function SC(){return!0}function pJ(){return!1}function Zo(e){function t(n,i,o,u,h){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=u,this.target=h,this.currentTarget=null;for(var p in e)e.hasOwnProperty(p)&&(n=e[p],this[p]=n?n(u):u[p]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?SC:pJ,this.isPropagationStopped=pJ,this}return Pi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=SC)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=SC)},persist:function(){},isPersistent:SC}),t}var $y={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},PV=Zo($y),kw=Pi({},$y,{view:0,detail:0}),Uje=Zo(kw),R2,N2,nE,n1=Pi({},kw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kV,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nE&&(nE&&e.type==="mousemove"?(R2=e.screenX-nE.screenX,N2=e.screenY-nE.screenY):N2=R2=0,nE=e),R2)},movementY:function(e){return"movementY"in e?e.movementY:N2}}),mJ=Zo(n1),Fje=Pi({},n1,{dataTransfer:0}),Vje=Zo(Fje),Bje=Pi({},kw,{relatedTarget:0}),A2=Zo(Bje),$je=Pi({},$y,{animationName:0,elapsedTime:0,pseudoElement:0}),Wje=Zo($je),Gje=Pi({},$y,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hje=Zo(Gje),zje=Pi({},$y,{data:0}),gJ=Zo(zje),Kje={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qje={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yje={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xje(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Yje[e])?!!t[e]:!1}function kV(){return Xje}var Jje=Pi({},kw,{key:function(e){if(e.key){var t=Kje[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=AR(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qje[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kV,charCode:function(e){return e.type==="keypress"?AR(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?AR(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zje=Zo(Jje),Qje=Pi({},n1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vJ=Zo(Qje),eDe=Pi({},kw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kV}),tDe=Zo(eDe),nDe=Pi({},$y,{propertyName:0,elapsedTime:0,pseudoElement:0}),rDe=Zo(nDe),iDe=Pi({},n1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),aDe=Zo(iDe),sDe=[9,13,27,32],jV=Dd&&"CompositionEvent"in window,zE=null;Dd&&"documentMode"in document&&(zE=document.documentMode);var oDe=Dd&&"TextEvent"in window&&!zE,dse=Dd&&(!jV||zE&&8<zE&&11>=zE),yJ=" ",_J=!1;function hse(e,t){switch(e){case"keyup":return sDe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fse(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yv=!1;function cDe(e,t){switch(e){case"compositionend":return fse(t);case"keypress":return t.which!==32?null:(_J=!0,yJ);case"textInput":return e=t.data,e===yJ&&_J?null:e;default:return null}}function lDe(e,t){if(yv)return e==="compositionend"||!jV&&hse(e,t)?(e=use(),NR=OV=Jh=null,yv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dse&&t.locale!=="ko"?null:t.data;default:return null}}var uDe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bJ(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!uDe[e.type]:t==="textarea"}function pse(e,t,n,i){Hae(i),t=sN(t,"onChange"),0<t.length&&(n=new PV("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var KE=null,f0=null;function dDe(e){Tse(e,0)}function r1(e){var t=Ev(e);if(Uae(t))return e}function hDe(e,t){if(e==="change")return t}var mse=!1;if(Dd){var I2;if(Dd){var O2="oninput"in document;if(!O2){var EJ=document.createElement("div");EJ.setAttribute("oninput","return;"),O2=typeof EJ.oninput=="function"}I2=O2}else I2=!1;mse=I2&&(!document.documentMode||9<document.documentMode)}function wJ(){KE&&(KE.detachEvent("onpropertychange",gse),f0=KE=null)}function gse(e){if(e.propertyName==="value"&&r1(f0)){var t=[];pse(t,f0,e,CV(e)),Yae(dDe,t)}}function fDe(e,t,n){e==="focusin"?(wJ(),KE=t,f0=n,KE.attachEvent("onpropertychange",gse)):e==="focusout"&&wJ()}function pDe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return r1(f0)}function mDe(e,t){if(e==="click")return r1(t)}function gDe(e,t){if(e==="input"||e==="change")return r1(t)}function vDe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ul=typeof Object.is=="function"?Object.is:vDe;function p0(e,t){if(Ul(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!lM.call(t,o)||!Ul(e[o],t[o]))return!1}return!0}function SJ(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xJ(e,t){var n=SJ(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=SJ(n)}}function vse(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vse(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yse(){for(var e=window,t=QR();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=QR(e.document)}return t}function DV(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yDe(e){var t=yse(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vse(n.ownerDocument.documentElement,n)){if(i!==null&&DV(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,u=Math.min(i.start,o);i=i.end===void 0?u:Math.min(i.end,o),!e.extend&&u>i&&(o=i,i=u,u=o),o=xJ(n,u);var h=xJ(n,i);o&&h&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),u>i?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _De=Dd&&"documentMode"in document&&11>=document.documentMode,_v=null,NM=null,qE=null,AM=!1;function TJ(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;AM||_v==null||_v!==QR(i)||(i=_v,"selectionStart"in i&&DV(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),qE&&p0(qE,i)||(qE=i,i=sN(NM,"onSelect"),0<i.length&&(t=new PV("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=_v)))}function xC(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var bv={animationend:xC("Animation","AnimationEnd"),animationiteration:xC("Animation","AnimationIteration"),animationstart:xC("Animation","AnimationStart"),transitionend:xC("Transition","TransitionEnd")},P2={},_se={};Dd&&(_se=document.createElement("div").style,"AnimationEvent"in window||(delete bv.animationend.animation,delete bv.animationiteration.animation,delete bv.animationstart.animation),"TransitionEvent"in window||delete bv.transitionend.transition);function i1(e){if(P2[e])return P2[e];if(!bv[e])return e;var t=bv[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _se)return P2[e]=t[n];return e}var bse=i1("animationend"),Ese=i1("animationiteration"),wse=i1("animationstart"),Sse=i1("transitionend"),xse=new Map,CJ="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cf(e,t){xse.set(e,t),bm(t,[e])}for(var k2=0;k2<CJ.length;k2++){var j2=CJ[k2],bDe=j2.toLowerCase(),EDe=j2[0].toUpperCase()+j2.slice(1);Cf(bDe,"on"+EDe)}Cf(bse,"onAnimationEnd");Cf(Ese,"onAnimationIteration");Cf(wse,"onAnimationStart");Cf("dblclick","onDoubleClick");Cf("focusin","onFocus");Cf("focusout","onBlur");Cf(Sse,"onTransitionEnd");Qv("onMouseEnter",["mouseout","mouseover"]);Qv("onMouseLeave",["mouseout","mouseover"]);Qv("onPointerEnter",["pointerout","pointerover"]);Qv("onPointerLeave",["pointerout","pointerover"]);bm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bm("onBeforeInput",["compositionend","keypress","textInput","paste"]);bm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var DE="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wDe=new Set("cancel close invalid load scroll toggle".split(" ").concat(DE));function RJ(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,bje(i,t,void 0,e),e.currentTarget=null}function Tse(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],o=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var h=i.length-1;0<=h;h--){var p=i[h],g=p.instance,v=p.currentTarget;if(p=p.listener,g!==u&&o.isPropagationStopped())break e;RJ(o,p,v),u=g}else for(h=0;h<i.length;h++){if(p=i[h],g=p.instance,v=p.currentTarget,p=p.listener,g!==u&&o.isPropagationStopped())break e;RJ(o,p,v),u=g}}}if(tN)throw e=xM,tN=!1,xM=null,e}function ui(e,t){var n=t[jM];n===void 0&&(n=t[jM]=new Set);var i=e+"__bubble";n.has(i)||(Cse(t,e,2,!1),n.add(i))}function D2(e,t,n){var i=0;t&&(i|=4),Cse(n,e,i,t)}var TC="_reactListening"+Math.random().toString(36).slice(2);function m0(e){if(!e[TC]){e[TC]=!0,kae.forEach(function(n){n!=="selectionchange"&&(wDe.has(n)||D2(n,!1,e),D2(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[TC]||(t[TC]=!0,D2("selectionchange",!1,t))}}function Cse(e,t,n,i){switch(lse(t)){case 1:var o=Lje;break;case 4:o=Mje;break;default:o=IV}n=o.bind(null,t,n,e),o=void 0,!SM||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function L2(e,t,n,i,o){var u=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var h=i.tag;if(h===3||h===4){var p=i.stateNode.containerInfo;if(p===o||p.nodeType===8&&p.parentNode===o)break;if(h===4)for(h=i.return;h!==null;){var g=h.tag;if((g===3||g===4)&&(g=h.stateNode.containerInfo,g===o||g.nodeType===8&&g.parentNode===o))return;h=h.return}for(;p!==null;){if(h=Mp(p),h===null)return;if(g=h.tag,g===5||g===6){i=u=h;continue e}p=p.parentNode}}i=i.return}Yae(function(){var v=u,b=CV(n),E=[];e:{var T=xse.get(e);if(T!==void 0){var C=PV,R=e;switch(e){case"keypress":if(AR(n)===0)break e;case"keydown":case"keyup":C=Zje;break;case"focusin":R="focus",C=A2;break;case"focusout":R="blur",C=A2;break;case"beforeblur":case"afterblur":C=A2;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=mJ;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Vje;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=tDe;break;case bse:case Ese:case wse:C=Wje;break;case Sse:C=rDe;break;case"scroll":C=Uje;break;case"wheel":C=aDe;break;case"copy":case"cut":case"paste":C=Hje;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=vJ}var N=(t&4)!==0,O=!N&&e==="scroll",j=N?T!==null?T+"Capture":null:T;N=[];for(var k=v,P;k!==null;){P=k;var M=P.stateNode;if(P.tag===5&&M!==null&&(P=M,j!==null&&(M=l0(k,j),M!=null&&N.push(g0(k,M,P)))),O)break;k=k.return}0<N.length&&(T=new C(T,R,null,n,b),E.push({event:T,listeners:N}))}}if(!(t&7)){e:{if(T=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",T&&n!==EM&&(R=n.relatedTarget||n.fromElement)&&(Mp(R)||R[Ld]))break e;if((C||T)&&(T=b.window===b?b:(T=b.ownerDocument)?T.defaultView||T.parentWindow:window,C?(R=n.relatedTarget||n.toElement,C=v,R=R?Mp(R):null,R!==null&&(O=Em(R),R!==O||R.tag!==5&&R.tag!==6)&&(R=null)):(C=null,R=v),C!==R)){if(N=mJ,M="onMouseLeave",j="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(N=vJ,M="onPointerLeave",j="onPointerEnter",k="pointer"),O=C==null?T:Ev(C),P=R==null?T:Ev(R),T=new N(M,k+"leave",C,n,b),T.target=O,T.relatedTarget=P,M=null,Mp(b)===v&&(N=new N(j,k+"enter",R,n,b),N.target=P,N.relatedTarget=O,M=N),O=M,C&&R)t:{for(N=C,j=R,k=0,P=N;P;P=ev(P))k++;for(P=0,M=j;M;M=ev(M))P++;for(;0<k-P;)N=ev(N),k--;for(;0<P-k;)j=ev(j),P--;for(;k--;){if(N===j||j!==null&&N===j.alternate)break t;N=ev(N),j=ev(j)}N=null}else N=null;C!==null&&NJ(E,T,C,N,!1),R!==null&&O!==null&&NJ(E,O,R,N,!0)}}e:{if(T=v?Ev(v):window,C=T.nodeName&&T.nodeName.toLowerCase(),C==="select"||C==="input"&&T.type==="file")var D=hDe;else if(bJ(T))if(mse)D=gDe;else{D=pDe;var U=fDe}else(C=T.nodeName)&&C.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(D=mDe);if(D&&(D=D(e,v))){pse(E,D,n,b);break e}U&&U(e,T,v),e==="focusout"&&(U=T._wrapperState)&&U.controlled&&T.type==="number"&&gM(T,"number",T.value)}switch(U=v?Ev(v):window,e){case"focusin":(bJ(U)||U.contentEditable==="true")&&(_v=U,NM=v,qE=null);break;case"focusout":qE=NM=_v=null;break;case"mousedown":AM=!0;break;case"contextmenu":case"mouseup":case"dragend":AM=!1,TJ(E,n,b);break;case"selectionchange":if(_De)break;case"keydown":case"keyup":TJ(E,n,b)}var F;if(jV)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else yv?hse(e,n)&&(H="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(H="onCompositionStart");H&&(dse&&n.locale!=="ko"&&(yv||H!=="onCompositionStart"?H==="onCompositionEnd"&&yv&&(F=use()):(Jh=b,OV="value"in Jh?Jh.value:Jh.textContent,yv=!0)),U=sN(v,H),0<U.length&&(H=new gJ(H,e,null,n,b),E.push({event:H,listeners:U}),F?H.data=F:(F=fse(n),F!==null&&(H.data=F)))),(F=oDe?cDe(e,n):lDe(e,n))&&(v=sN(v,"onBeforeInput"),0<v.length&&(b=new gJ("onBeforeInput","beforeinput",null,n,b),E.push({event:b,listeners:v}),b.data=F))}Tse(E,t)})}function g0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function sN(e,t){for(var n=t+"Capture",i=[];e!==null;){var o=e,u=o.stateNode;o.tag===5&&u!==null&&(o=u,u=l0(e,n),u!=null&&i.unshift(g0(e,u,o)),u=l0(e,t),u!=null&&i.push(g0(e,u,o))),e=e.return}return i}function ev(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function NJ(e,t,n,i,o){for(var u=t._reactName,h=[];n!==null&&n!==i;){var p=n,g=p.alternate,v=p.stateNode;if(g!==null&&g===i)break;p.tag===5&&v!==null&&(p=v,o?(g=l0(n,u),g!=null&&h.unshift(g0(n,g,p))):o||(g=l0(n,u),g!=null&&h.push(g0(n,g,p)))),n=n.return}h.length!==0&&e.push({event:t,listeners:h})}var SDe=/\r\n?/g,xDe=/\u0000|\uFFFD/g;function AJ(e){return(typeof e=="string"?e:""+e).replace(SDe,`
`).replace(xDe,"")}function CC(e,t,n){if(t=AJ(t),AJ(e)!==t&&n)throw Error(mt(425))}function oN(){}var IM=null,OM=null;function PM(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var kM=typeof setTimeout=="function"?setTimeout:void 0,TDe=typeof clearTimeout=="function"?clearTimeout:void 0,IJ=typeof Promise=="function"?Promise:void 0,CDe=typeof queueMicrotask=="function"?queueMicrotask:typeof IJ<"u"?function(e){return IJ.resolve(null).then(e).catch(RDe)}:kM;function RDe(e){setTimeout(function(){throw e})}function M2(e,t){var n=t,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(i===0){e.removeChild(o),h0(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=o}while(n);h0(t)}function of(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function OJ(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Wy=Math.random().toString(36).slice(2),Cu="__reactFiber$"+Wy,v0="__reactProps$"+Wy,Ld="__reactContainer$"+Wy,jM="__reactEvents$"+Wy,NDe="__reactListeners$"+Wy,ADe="__reactHandles$"+Wy;function Mp(e){var t=e[Cu];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ld]||n[Cu]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=OJ(e);e!==null;){if(n=e[Cu])return n;e=OJ(e)}return t}e=n,n=e.parentNode}return null}function jw(e){return e=e[Cu]||e[Ld],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ev(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(mt(33))}function a1(e){return e[v0]||null}var DM=[],wv=-1;function Rf(e){return{current:e}}function pi(e){0>wv||(e.current=DM[wv],DM[wv]=null,wv--)}function si(e,t){wv++,DM[wv]=e.current,e.current=t}var vf={},ws=Rf(vf),uo=Rf(!1),nm=vf;function ey(e,t){var n=e.type.contextTypes;if(!n)return vf;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var o={},u;for(u in n)o[u]=t[u];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ho(e){return e=e.childContextTypes,e!=null}function cN(){pi(uo),pi(ws)}function PJ(e,t,n){if(ws.current!==vf)throw Error(mt(168));si(ws,t),si(uo,n)}function Rse(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var o in i)if(!(o in t))throw Error(mt(108,fje(e)||"Unknown",o));return Pi({},n,i)}function lN(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vf,nm=ws.current,si(ws,e),si(uo,uo.current),!0}function kJ(e,t,n){var i=e.stateNode;if(!i)throw Error(mt(169));n?(e=Rse(e,t,nm),i.__reactInternalMemoizedMergedChildContext=e,pi(uo),pi(ws),si(ws,e)):pi(uo),si(uo,n)}var bd=null,s1=!1,U2=!1;function Nse(e){bd===null?bd=[e]:bd.push(e)}function IDe(e){s1=!0,Nse(e)}function Nf(){if(!U2&&bd!==null){U2=!0;var e=0,t=Br;try{var n=bd;for(Br=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}bd=null,s1=!1}catch(o){throw bd!==null&&(bd=bd.slice(e+1)),Qae(RV,Nf),o}finally{Br=t,U2=!1}}return null}var Sv=[],xv=0,uN=null,dN=0,Ac=[],Ic=0,rm=null,Sd=1,xd="";function Ip(e,t){Sv[xv++]=dN,Sv[xv++]=uN,uN=e,dN=t}function Ase(e,t,n){Ac[Ic++]=Sd,Ac[Ic++]=xd,Ac[Ic++]=rm,rm=e;var i=Sd;e=xd;var o=32-jl(i)-1;i&=~(1<<o),n+=1;var u=32-jl(t)+o;if(30<u){var h=o-o%5;u=(i&(1<<h)-1).toString(32),i>>=h,o-=h,Sd=1<<32-jl(t)+o|n<<o|i,xd=u+e}else Sd=1<<u|n<<o|i,xd=e}function LV(e){e.return!==null&&(Ip(e,1),Ase(e,1,0))}function MV(e){for(;e===uN;)uN=Sv[--xv],Sv[xv]=null,dN=Sv[--xv],Sv[xv]=null;for(;e===rm;)rm=Ac[--Ic],Ac[Ic]=null,xd=Ac[--Ic],Ac[Ic]=null,Sd=Ac[--Ic],Ac[Ic]=null}var Wo=null,$o=null,_i=!1,Al=null;function Ise(e,t){var n=kc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function jJ(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Wo=e,$o=of(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Wo=e,$o=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=rm!==null?{id:Sd,overflow:xd}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=kc(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Wo=e,$o=null,!0):!1;default:return!1}}function LM(e){return(e.mode&1)!==0&&(e.flags&128)===0}function MM(e){if(_i){var t=$o;if(t){var n=t;if(!jJ(e,t)){if(LM(e))throw Error(mt(418));t=of(n.nextSibling);var i=Wo;t&&jJ(e,t)?Ise(i,n):(e.flags=e.flags&-4097|2,_i=!1,Wo=e)}}else{if(LM(e))throw Error(mt(418));e.flags=e.flags&-4097|2,_i=!1,Wo=e}}}function DJ(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Wo=e}function RC(e){if(e!==Wo)return!1;if(!_i)return DJ(e),_i=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!PM(e.type,e.memoizedProps)),t&&(t=$o)){if(LM(e))throw Ose(),Error(mt(418));for(;t;)Ise(e,t),t=of(t.nextSibling)}if(DJ(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(mt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){$o=of(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}$o=null}}else $o=Wo?of(e.stateNode.nextSibling):null;return!0}function Ose(){for(var e=$o;e;)e=of(e.nextSibling)}function ty(){$o=Wo=null,_i=!1}function UV(e){Al===null?Al=[e]:Al.push(e)}var ODe=Kd.ReactCurrentBatchConfig;function rE(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(mt(309));var i=n.stateNode}if(!i)throw Error(mt(147,e));var o=i,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(h){var p=o.refs;h===null?delete p[u]:p[u]=h},t._stringRef=u,t)}if(typeof e!="string")throw Error(mt(284));if(!n._owner)throw Error(mt(290,e))}return e}function NC(e,t){throw e=Object.prototype.toString.call(t),Error(mt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function LJ(e){var t=e._init;return t(e._payload)}function Pse(e){function t(j,k){if(e){var P=j.deletions;P===null?(j.deletions=[k],j.flags|=16):P.push(k)}}function n(j,k){if(!e)return null;for(;k!==null;)t(j,k),k=k.sibling;return null}function i(j,k){for(j=new Map;k!==null;)k.key!==null?j.set(k.key,k):j.set(k.index,k),k=k.sibling;return j}function o(j,k){return j=df(j,k),j.index=0,j.sibling=null,j}function u(j,k,P){return j.index=P,e?(P=j.alternate,P!==null?(P=P.index,P<k?(j.flags|=2,k):P):(j.flags|=2,k)):(j.flags|=1048576,k)}function h(j){return e&&j.alternate===null&&(j.flags|=2),j}function p(j,k,P,M){return k===null||k.tag!==6?(k=H2(P,j.mode,M),k.return=j,k):(k=o(k,P),k.return=j,k)}function g(j,k,P,M){var D=P.type;return D===vv?b(j,k,P.props.children,M,P.key):k!==null&&(k.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Uh&&LJ(D)===k.type)?(M=o(k,P.props),M.ref=rE(j,k,P),M.return=j,M):(M=LR(P.type,P.key,P.props,null,j.mode,M),M.ref=rE(j,k,P),M.return=j,M)}function v(j,k,P,M){return k===null||k.tag!==4||k.stateNode.containerInfo!==P.containerInfo||k.stateNode.implementation!==P.implementation?(k=z2(P,j.mode,M),k.return=j,k):(k=o(k,P.children||[]),k.return=j,k)}function b(j,k,P,M,D){return k===null||k.tag!==7?(k=Zp(P,j.mode,M,D),k.return=j,k):(k=o(k,P),k.return=j,k)}function E(j,k,P){if(typeof k=="string"&&k!==""||typeof k=="number")return k=H2(""+k,j.mode,P),k.return=j,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case vC:return P=LR(k.type,k.key,k.props,null,j.mode,P),P.ref=rE(j,null,k),P.return=j,P;case gv:return k=z2(k,j.mode,P),k.return=j,k;case Uh:var M=k._init;return E(j,M(k._payload),P)}if(kE(k)||Zb(k))return k=Zp(k,j.mode,P,null),k.return=j,k;NC(j,k)}return null}function T(j,k,P,M){var D=k!==null?k.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return D!==null?null:p(j,k,""+P,M);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case vC:return P.key===D?g(j,k,P,M):null;case gv:return P.key===D?v(j,k,P,M):null;case Uh:return D=P._init,T(j,k,D(P._payload),M)}if(kE(P)||Zb(P))return D!==null?null:b(j,k,P,M,null);NC(j,P)}return null}function C(j,k,P,M,D){if(typeof M=="string"&&M!==""||typeof M=="number")return j=j.get(P)||null,p(k,j,""+M,D);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case vC:return j=j.get(M.key===null?P:M.key)||null,g(k,j,M,D);case gv:return j=j.get(M.key===null?P:M.key)||null,v(k,j,M,D);case Uh:var U=M._init;return C(j,k,P,U(M._payload),D)}if(kE(M)||Zb(M))return j=j.get(P)||null,b(k,j,M,D,null);NC(k,M)}return null}function R(j,k,P,M){for(var D=null,U=null,F=k,H=k=0,W=null;F!==null&&H<P.length;H++){F.index>H?(W=F,F=null):W=F.sibling;var q=T(j,F,P[H],M);if(q===null){F===null&&(F=W);break}e&&F&&q.alternate===null&&t(j,F),k=u(q,k,H),U===null?D=q:U.sibling=q,U=q,F=W}if(H===P.length)return n(j,F),_i&&Ip(j,H),D;if(F===null){for(;H<P.length;H++)F=E(j,P[H],M),F!==null&&(k=u(F,k,H),U===null?D=F:U.sibling=F,U=F);return _i&&Ip(j,H),D}for(F=i(j,F);H<P.length;H++)W=C(F,j,H,P[H],M),W!==null&&(e&&W.alternate!==null&&F.delete(W.key===null?H:W.key),k=u(W,k,H),U===null?D=W:U.sibling=W,U=W);return e&&F.forEach(function(Y){return t(j,Y)}),_i&&Ip(j,H),D}function N(j,k,P,M){var D=Zb(P);if(typeof D!="function")throw Error(mt(150));if(P=D.call(P),P==null)throw Error(mt(151));for(var U=D=null,F=k,H=k=0,W=null,q=P.next();F!==null&&!q.done;H++,q=P.next()){F.index>H?(W=F,F=null):W=F.sibling;var Y=T(j,F,q.value,M);if(Y===null){F===null&&(F=W);break}e&&F&&Y.alternate===null&&t(j,F),k=u(Y,k,H),U===null?D=Y:U.sibling=Y,U=Y,F=W}if(q.done)return n(j,F),_i&&Ip(j,H),D;if(F===null){for(;!q.done;H++,q=P.next())q=E(j,q.value,M),q!==null&&(k=u(q,k,H),U===null?D=q:U.sibling=q,U=q);return _i&&Ip(j,H),D}for(F=i(j,F);!q.done;H++,q=P.next())q=C(F,j,H,q.value,M),q!==null&&(e&&q.alternate!==null&&F.delete(q.key===null?H:q.key),k=u(q,k,H),U===null?D=q:U.sibling=q,U=q);return e&&F.forEach(function(z){return t(j,z)}),_i&&Ip(j,H),D}function O(j,k,P,M){if(typeof P=="object"&&P!==null&&P.type===vv&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case vC:e:{for(var D=P.key,U=k;U!==null;){if(U.key===D){if(D=P.type,D===vv){if(U.tag===7){n(j,U.sibling),k=o(U,P.props.children),k.return=j,j=k;break e}}else if(U.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Uh&&LJ(D)===U.type){n(j,U.sibling),k=o(U,P.props),k.ref=rE(j,U,P),k.return=j,j=k;break e}n(j,U);break}else t(j,U);U=U.sibling}P.type===vv?(k=Zp(P.props.children,j.mode,M,P.key),k.return=j,j=k):(M=LR(P.type,P.key,P.props,null,j.mode,M),M.ref=rE(j,k,P),M.return=j,j=M)}return h(j);case gv:e:{for(U=P.key;k!==null;){if(k.key===U)if(k.tag===4&&k.stateNode.containerInfo===P.containerInfo&&k.stateNode.implementation===P.implementation){n(j,k.sibling),k=o(k,P.children||[]),k.return=j,j=k;break e}else{n(j,k);break}else t(j,k);k=k.sibling}k=z2(P,j.mode,M),k.return=j,j=k}return h(j);case Uh:return U=P._init,O(j,k,U(P._payload),M)}if(kE(P))return R(j,k,P,M);if(Zb(P))return N(j,k,P,M);NC(j,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,k!==null&&k.tag===6?(n(j,k.sibling),k=o(k,P),k.return=j,j=k):(n(j,k),k=H2(P,j.mode,M),k.return=j,j=k),h(j)):n(j,k)}return O}var ny=Pse(!0),kse=Pse(!1),hN=Rf(null),fN=null,Tv=null,FV=null;function VV(){FV=Tv=fN=null}function BV(e){var t=hN.current;pi(hN),e._currentValue=t}function UM(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Dv(e,t){fN=e,FV=Tv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(co=!0),e.firstContext=null)}function Uc(e){var t=e._currentValue;if(FV!==e)if(e={context:e,memoizedValue:t,next:null},Tv===null){if(fN===null)throw Error(mt(308));Tv=e,fN.dependencies={lanes:0,firstContext:e}}else Tv=Tv.next=e;return t}var Up=null;function $V(e){Up===null?Up=[e]:Up.push(e)}function jse(e,t,n,i){var o=t.interleaved;return o===null?(n.next=n,$V(t)):(n.next=o.next,o.next=n),t.interleaved=n,Md(e,i)}function Md(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Fh=!1;function WV(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dse(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nd(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function cf(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,pr&2){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,Md(e,n)}return o=i.interleaved,o===null?(t.next=t,$V(i)):(t.next=o.next,o.next=t),i.interleaved=t,Md(e,n)}function IR(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,NV(e,n)}}function MJ(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,u=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};u===null?o=u=h:u=u.next=h,n=n.next}while(n!==null);u===null?o=u=t:u=u.next=t}else o=u=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:u,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function pN(e,t,n,i){var o=e.updateQueue;Fh=!1;var u=o.firstBaseUpdate,h=o.lastBaseUpdate,p=o.shared.pending;if(p!==null){o.shared.pending=null;var g=p,v=g.next;g.next=null,h===null?u=v:h.next=v,h=g;var b=e.alternate;b!==null&&(b=b.updateQueue,p=b.lastBaseUpdate,p!==h&&(p===null?b.firstBaseUpdate=v:p.next=v,b.lastBaseUpdate=g))}if(u!==null){var E=o.baseState;h=0,b=v=g=null,p=u;do{var T=p.lane,C=p.eventTime;if((i&T)===T){b!==null&&(b=b.next={eventTime:C,lane:0,tag:p.tag,payload:p.payload,callback:p.callback,next:null});e:{var R=e,N=p;switch(T=t,C=n,N.tag){case 1:if(R=N.payload,typeof R=="function"){E=R.call(C,E,T);break e}E=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=N.payload,T=typeof R=="function"?R.call(C,E,T):R,T==null)break e;E=Pi({},E,T);break e;case 2:Fh=!0}}p.callback!==null&&p.lane!==0&&(e.flags|=64,T=o.effects,T===null?o.effects=[p]:T.push(p))}else C={eventTime:C,lane:T,tag:p.tag,payload:p.payload,callback:p.callback,next:null},b===null?(v=b=C,g=E):b=b.next=C,h|=T;if(p=p.next,p===null){if(p=o.shared.pending,p===null)break;T=p,p=T.next,T.next=null,o.lastBaseUpdate=T,o.shared.pending=null}}while(!0);if(b===null&&(g=E),o.baseState=g,o.firstBaseUpdate=v,o.lastBaseUpdate=b,t=o.shared.interleaved,t!==null){o=t;do h|=o.lane,o=o.next;while(o!==t)}else u===null&&(o.shared.lanes=0);am|=h,e.lanes=h,e.memoizedState=E}}function UJ(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(o!==null){if(i.callback=null,i=n,typeof o!="function")throw Error(mt(191,o));o.call(i)}}}var Dw={},Pu=Rf(Dw),y0=Rf(Dw),_0=Rf(Dw);function Fp(e){if(e===Dw)throw Error(mt(174));return e}function GV(e,t){switch(si(_0,t),si(y0,e),si(Pu,Dw),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:yM(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=yM(t,e)}pi(Pu),si(Pu,t)}function ry(){pi(Pu),pi(y0),pi(_0)}function Lse(e){Fp(_0.current);var t=Fp(Pu.current),n=yM(t,e.type);t!==n&&(si(y0,e),si(Pu,n))}function HV(e){y0.current===e&&(pi(Pu),pi(y0))}var Ai=Rf(0);function mN(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var F2=[];function zV(){for(var e=0;e<F2.length;e++)F2[e]._workInProgressVersionPrimary=null;F2.length=0}var OR=Kd.ReactCurrentDispatcher,V2=Kd.ReactCurrentBatchConfig,im=0,Oi=null,Na=null,Va=null,gN=!1,YE=!1,b0=0,PDe=0;function fs(){throw Error(mt(321))}function KV(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ul(e[n],t[n]))return!1;return!0}function qV(e,t,n,i,o,u){if(im=u,Oi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,OR.current=e===null||e.memoizedState===null?LDe:MDe,e=n(i,o),YE){u=0;do{if(YE=!1,b0=0,25<=u)throw Error(mt(301));u+=1,Va=Na=null,t.updateQueue=null,OR.current=UDe,e=n(i,o)}while(YE)}if(OR.current=vN,t=Na!==null&&Na.next!==null,im=0,Va=Na=Oi=null,gN=!1,t)throw Error(mt(300));return e}function YV(){var e=b0!==0;return b0=0,e}function _u(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Va===null?Oi.memoizedState=Va=e:Va=Va.next=e,Va}function Fc(){if(Na===null){var e=Oi.alternate;e=e!==null?e.memoizedState:null}else e=Na.next;var t=Va===null?Oi.memoizedState:Va.next;if(t!==null)Va=t,Na=e;else{if(e===null)throw Error(mt(310));Na=e,e={memoizedState:Na.memoizedState,baseState:Na.baseState,baseQueue:Na.baseQueue,queue:Na.queue,next:null},Va===null?Oi.memoizedState=Va=e:Va=Va.next=e}return Va}function E0(e,t){return typeof t=="function"?t(e):t}function B2(e){var t=Fc(),n=t.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=e;var i=Na,o=i.baseQueue,u=n.pending;if(u!==null){if(o!==null){var h=o.next;o.next=u.next,u.next=h}i.baseQueue=o=u,n.pending=null}if(o!==null){u=o.next,i=i.baseState;var p=h=null,g=null,v=u;do{var b=v.lane;if((im&b)===b)g!==null&&(g=g.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),i=v.hasEagerState?v.eagerState:e(i,v.action);else{var E={lane:b,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};g===null?(p=g=E,h=i):g=g.next=E,Oi.lanes|=b,am|=b}v=v.next}while(v!==null&&v!==u);g===null?h=i:g.next=p,Ul(i,t.memoizedState)||(co=!0),t.memoizedState=i,t.baseState=h,t.baseQueue=g,n.lastRenderedState=i}if(e=n.interleaved,e!==null){o=e;do u=o.lane,Oi.lanes|=u,am|=u,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function $2(e){var t=Fc(),n=t.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=e;var i=n.dispatch,o=n.pending,u=t.memoizedState;if(o!==null){n.pending=null;var h=o=o.next;do u=e(u,h.action),h=h.next;while(h!==o);Ul(u,t.memoizedState)||(co=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),n.lastRenderedState=u}return[u,i]}function Mse(){}function Use(e,t){var n=Oi,i=Fc(),o=t(),u=!Ul(i.memoizedState,o);if(u&&(i.memoizedState=o,co=!0),i=i.queue,XV(Bse.bind(null,n,i,e),[e]),i.getSnapshot!==t||u||Va!==null&&Va.memoizedState.tag&1){if(n.flags|=2048,w0(9,Vse.bind(null,n,i,o,t),void 0,null),Ga===null)throw Error(mt(349));im&30||Fse(n,t,o)}return o}function Fse(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Oi.updateQueue,t===null?(t={lastEffect:null,stores:null},Oi.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Vse(e,t,n,i){t.value=n,t.getSnapshot=i,$se(t)&&Wse(e)}function Bse(e,t,n){return n(function(){$se(t)&&Wse(e)})}function $se(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ul(e,n)}catch{return!0}}function Wse(e){var t=Md(e,1);t!==null&&Dl(t,e,1,-1)}function FJ(e){var t=_u();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:E0,lastRenderedState:e},t.queue=e,e=e.dispatch=DDe.bind(null,Oi,e),[t.memoizedState,e]}function w0(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Oi.updateQueue,t===null?(t={lastEffect:null,stores:null},Oi.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Gse(){return Fc().memoizedState}function PR(e,t,n,i){var o=_u();Oi.flags|=e,o.memoizedState=w0(1|t,n,void 0,i===void 0?null:i)}function o1(e,t,n,i){var o=Fc();i=i===void 0?null:i;var u=void 0;if(Na!==null){var h=Na.memoizedState;if(u=h.destroy,i!==null&&KV(i,h.deps)){o.memoizedState=w0(t,n,u,i);return}}Oi.flags|=e,o.memoizedState=w0(1|t,n,u,i)}function VJ(e,t){return PR(8390656,8,e,t)}function XV(e,t){return o1(2048,8,e,t)}function Hse(e,t){return o1(4,2,e,t)}function zse(e,t){return o1(4,4,e,t)}function Kse(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qse(e,t,n){return n=n!=null?n.concat([e]):null,o1(4,4,Kse.bind(null,t,e),n)}function JV(){}function Yse(e,t){var n=Fc();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&KV(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Xse(e,t){var n=Fc();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&KV(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Jse(e,t,n){return im&21?(Ul(n,t)||(n=nse(),Oi.lanes|=n,am|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,co=!0),e.memoizedState=n)}function kDe(e,t){var n=Br;Br=n!==0&&4>n?n:4,e(!0);var i=V2.transition;V2.transition={};try{e(!1),t()}finally{Br=n,V2.transition=i}}function Zse(){return Fc().memoizedState}function jDe(e,t,n){var i=uf(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qse(e))eoe(t,n);else if(n=jse(e,t,n,i),n!==null){var o=Ls();Dl(n,e,i,o),toe(n,t,i)}}function DDe(e,t,n){var i=uf(e),o={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qse(e))eoe(t,o);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var h=t.lastRenderedState,p=u(h,n);if(o.hasEagerState=!0,o.eagerState=p,Ul(p,h)){var g=t.interleaved;g===null?(o.next=o,$V(t)):(o.next=g.next,g.next=o),t.interleaved=o;return}}catch{}finally{}n=jse(e,t,o,i),n!==null&&(o=Ls(),Dl(n,e,i,o),toe(n,t,i))}}function Qse(e){var t=e.alternate;return e===Oi||t!==null&&t===Oi}function eoe(e,t){YE=gN=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function toe(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,NV(e,n)}}var vN={readContext:Uc,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},LDe={readContext:Uc,useCallback:function(e,t){return _u().memoizedState=[e,t===void 0?null:t],e},useContext:Uc,useEffect:VJ,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,PR(4194308,4,Kse.bind(null,t,e),n)},useLayoutEffect:function(e,t){return PR(4194308,4,e,t)},useInsertionEffect:function(e,t){return PR(4,2,e,t)},useMemo:function(e,t){var n=_u();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=_u();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=jDe.bind(null,Oi,e),[i.memoizedState,e]},useRef:function(e){var t=_u();return e={current:e},t.memoizedState=e},useState:FJ,useDebugValue:JV,useDeferredValue:function(e){return _u().memoizedState=e},useTransition:function(){var e=FJ(!1),t=e[0];return e=kDe.bind(null,e[1]),_u().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Oi,o=_u();if(_i){if(n===void 0)throw Error(mt(407));n=n()}else{if(n=t(),Ga===null)throw Error(mt(349));im&30||Fse(i,t,n)}o.memoizedState=n;var u={value:n,getSnapshot:t};return o.queue=u,VJ(Bse.bind(null,i,u,e),[e]),i.flags|=2048,w0(9,Vse.bind(null,i,u,n,t),void 0,null),n},useId:function(){var e=_u(),t=Ga.identifierPrefix;if(_i){var n=xd,i=Sd;n=(i&~(1<<32-jl(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=b0++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=PDe++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},MDe={readContext:Uc,useCallback:Yse,useContext:Uc,useEffect:XV,useImperativeHandle:qse,useInsertionEffect:Hse,useLayoutEffect:zse,useMemo:Xse,useReducer:B2,useRef:Gse,useState:function(){return B2(E0)},useDebugValue:JV,useDeferredValue:function(e){var t=Fc();return Jse(t,Na.memoizedState,e)},useTransition:function(){var e=B2(E0)[0],t=Fc().memoizedState;return[e,t]},useMutableSource:Mse,useSyncExternalStore:Use,useId:Zse,unstable_isNewReconciler:!1},UDe={readContext:Uc,useCallback:Yse,useContext:Uc,useEffect:XV,useImperativeHandle:qse,useInsertionEffect:Hse,useLayoutEffect:zse,useMemo:Xse,useReducer:$2,useRef:Gse,useState:function(){return $2(E0)},useDebugValue:JV,useDeferredValue:function(e){var t=Fc();return Na===null?t.memoizedState=e:Jse(t,Na.memoizedState,e)},useTransition:function(){var e=$2(E0)[0],t=Fc().memoizedState;return[e,t]},useMutableSource:Mse,useSyncExternalStore:Use,useId:Zse,unstable_isNewReconciler:!1};function wl(e,t){if(e&&e.defaultProps){t=Pi({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function FM(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:Pi({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var c1={isMounted:function(e){return(e=e._reactInternals)?Em(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Ls(),o=uf(e),u=Nd(i,o);u.payload=t,n!=null&&(u.callback=n),t=cf(e,u,o),t!==null&&(Dl(t,e,o,i),IR(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Ls(),o=uf(e),u=Nd(i,o);u.tag=1,u.payload=t,n!=null&&(u.callback=n),t=cf(e,u,o),t!==null&&(Dl(t,e,o,i),IR(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ls(),i=uf(e),o=Nd(n,i);o.tag=2,t!=null&&(o.callback=t),t=cf(e,o,i),t!==null&&(Dl(t,e,i,n),IR(t,e,i))}};function BJ(e,t,n,i,o,u,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,h):t.prototype&&t.prototype.isPureReactComponent?!p0(n,i)||!p0(o,u):!0}function noe(e,t,n){var i=!1,o=vf,u=t.contextType;return typeof u=="object"&&u!==null?u=Uc(u):(o=ho(t)?nm:ws.current,i=t.contextTypes,u=(i=i!=null)?ey(e,o):vf),t=new t(n,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=c1,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=u),t}function $J(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&c1.enqueueReplaceState(t,t.state,null)}function VM(e,t,n,i){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},WV(e);var u=t.contextType;typeof u=="object"&&u!==null?o.context=Uc(u):(u=ho(t)?nm:ws.current,o.context=ey(e,u)),o.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(FM(e,t,u,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&c1.enqueueReplaceState(o,o.state,null),pN(e,n,o,i),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function iy(e,t){try{var n="",i=t;do n+=hje(i),i=i.return;while(i);var o=n}catch(u){o=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:o,digest:null}}function W2(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function BM(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var FDe=typeof WeakMap=="function"?WeakMap:Map;function roe(e,t,n){n=Nd(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){_N||(_N=!0,JM=i),BM(e,t)},n}function ioe(e,t,n){n=Nd(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var o=t.value;n.payload=function(){return i(o)},n.callback=function(){BM(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(n.callback=function(){BM(e,t),typeof i!="function"&&(lf===null?lf=new Set([this]):lf.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),n}function WJ(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new FDe;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(o.add(n),e=QDe.bind(null,e,t,n),t.then(e,e))}function GJ(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function HJ(e,t,n,i,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Nd(-1,1),t.tag=2,cf(n,t,1))),n.lanes|=1),e)}var VDe=Kd.ReactCurrentOwner,co=!1;function Ps(e,t,n,i){t.child=e===null?kse(t,null,n,i):ny(t,e.child,n,i)}function zJ(e,t,n,i,o){n=n.render;var u=t.ref;return Dv(t,o),i=qV(e,t,n,i,u,o),n=YV(),e!==null&&!co?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ud(e,t,o)):(_i&&n&&LV(t),t.flags|=1,Ps(e,t,i,o),t.child)}function KJ(e,t,n,i,o){if(e===null){var u=n.type;return typeof u=="function"&&!a4(u)&&u.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=u,aoe(e,t,u,i,o)):(e=LR(n.type,null,i,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!(e.lanes&o)){var h=u.memoizedProps;if(n=n.compare,n=n!==null?n:p0,n(h,i)&&e.ref===t.ref)return Ud(e,t,o)}return t.flags|=1,e=df(u,i),e.ref=t.ref,e.return=t,t.child=e}function aoe(e,t,n,i,o){if(e!==null){var u=e.memoizedProps;if(p0(u,i)&&e.ref===t.ref)if(co=!1,t.pendingProps=i=u,(e.lanes&o)!==0)e.flags&131072&&(co=!0);else return t.lanes=e.lanes,Ud(e,t,o)}return $M(e,t,n,i,o)}function soe(e,t,n){var i=t.pendingProps,o=i.children,u=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},si(Rv,Lo),Lo|=n;else{if(!(n&1073741824))return e=u!==null?u.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,si(Rv,Lo),Lo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=u!==null?u.baseLanes:n,si(Rv,Lo),Lo|=i}else u!==null?(i=u.baseLanes|n,t.memoizedState=null):i=n,si(Rv,Lo),Lo|=i;return Ps(e,t,o,n),t.child}function ooe(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function $M(e,t,n,i,o){var u=ho(n)?nm:ws.current;return u=ey(t,u),Dv(t,o),n=qV(e,t,n,i,u,o),i=YV(),e!==null&&!co?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ud(e,t,o)):(_i&&i&&LV(t),t.flags|=1,Ps(e,t,n,o),t.child)}function qJ(e,t,n,i,o){if(ho(n)){var u=!0;lN(t)}else u=!1;if(Dv(t,o),t.stateNode===null)kR(e,t),noe(t,n,i),VM(t,n,i,o),i=!0;else if(e===null){var h=t.stateNode,p=t.memoizedProps;h.props=p;var g=h.context,v=n.contextType;typeof v=="object"&&v!==null?v=Uc(v):(v=ho(n)?nm:ws.current,v=ey(t,v));var b=n.getDerivedStateFromProps,E=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";E||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(p!==i||g!==v)&&$J(t,h,i,v),Fh=!1;var T=t.memoizedState;h.state=T,pN(t,i,h,o),g=t.memoizedState,p!==i||T!==g||uo.current||Fh?(typeof b=="function"&&(FM(t,n,b,i),g=t.memoizedState),(p=Fh||BJ(t,n,p,i,T,g,v))?(E||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=g),h.props=i,h.state=g,h.context=v,i=p):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,Dse(e,t),p=t.memoizedProps,v=t.type===t.elementType?p:wl(t.type,p),h.props=v,E=t.pendingProps,T=h.context,g=n.contextType,typeof g=="object"&&g!==null?g=Uc(g):(g=ho(n)?nm:ws.current,g=ey(t,g));var C=n.getDerivedStateFromProps;(b=typeof C=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(p!==E||T!==g)&&$J(t,h,i,g),Fh=!1,T=t.memoizedState,h.state=T,pN(t,i,h,o);var R=t.memoizedState;p!==E||T!==R||uo.current||Fh?(typeof C=="function"&&(FM(t,n,C,i),R=t.memoizedState),(v=Fh||BJ(t,n,v,i,T,R,g)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,R,g),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,R,g)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=R),h.props=i,h.state=R,h.context=g,i=v):(typeof h.componentDidUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),i=!1)}return WM(e,t,n,i,u,o)}function WM(e,t,n,i,o,u){ooe(e,t);var h=(t.flags&128)!==0;if(!i&&!h)return o&&kJ(t,n,!1),Ud(e,t,u);i=t.stateNode,VDe.current=t;var p=h&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&h?(t.child=ny(t,e.child,null,u),t.child=ny(t,null,p,u)):Ps(e,t,p,u),t.memoizedState=i.state,o&&kJ(t,n,!0),t.child}function coe(e){var t=e.stateNode;t.pendingContext?PJ(e,t.pendingContext,t.pendingContext!==t.context):t.context&&PJ(e,t.context,!1),GV(e,t.containerInfo)}function YJ(e,t,n,i,o){return ty(),UV(o),t.flags|=256,Ps(e,t,n,i),t.child}var GM={dehydrated:null,treeContext:null,retryLane:0};function HM(e){return{baseLanes:e,cachePool:null,transitions:null}}function loe(e,t,n){var i=t.pendingProps,o=Ai.current,u=!1,h=(t.flags&128)!==0,p;if((p=h)||(p=e!==null&&e.memoizedState===null?!1:(o&2)!==0),p?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),si(Ai,o&1),e===null)return MM(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=i.children,e=i.fallback,u?(i=t.mode,u=t.child,h={mode:"hidden",children:h},!(i&1)&&u!==null?(u.childLanes=0,u.pendingProps=h):u=d1(h,i,0,null),e=Zp(e,i,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=HM(n),t.memoizedState=GM,e):ZV(t,h));if(o=e.memoizedState,o!==null&&(p=o.dehydrated,p!==null))return BDe(e,t,h,i,p,o,n);if(u){u=i.fallback,h=t.mode,o=e.child,p=o.sibling;var g={mode:"hidden",children:i.children};return!(h&1)&&t.child!==o?(i=t.child,i.childLanes=0,i.pendingProps=g,t.deletions=null):(i=df(o,g),i.subtreeFlags=o.subtreeFlags&14680064),p!==null?u=df(p,u):(u=Zp(u,h,n,null),u.flags|=2),u.return=t,i.return=t,i.sibling=u,t.child=i,i=u,u=t.child,h=e.child.memoizedState,h=h===null?HM(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},u.memoizedState=h,u.childLanes=e.childLanes&~n,t.memoizedState=GM,i}return u=e.child,e=u.sibling,i=df(u,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function ZV(e,t){return t=d1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function AC(e,t,n,i){return i!==null&&UV(i),ny(t,e.child,null,n),e=ZV(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function BDe(e,t,n,i,o,u,h){if(n)return t.flags&256?(t.flags&=-257,i=W2(Error(mt(422))),AC(e,t,h,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=i.fallback,o=t.mode,i=d1({mode:"visible",children:i.children},o,0,null),u=Zp(u,o,h,null),u.flags|=2,i.return=t,u.return=t,i.sibling=u,t.child=i,t.mode&1&&ny(t,e.child,null,h),t.child.memoizedState=HM(h),t.memoizedState=GM,u);if(!(t.mode&1))return AC(e,t,h,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var p=i.dgst;return i=p,u=Error(mt(419)),i=W2(u,i,void 0),AC(e,t,h,i)}if(p=(h&e.childLanes)!==0,co||p){if(i=Ga,i!==null){switch(h&-h){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(i.suspendedLanes|h)?0:o,o!==0&&o!==u.retryLane&&(u.retryLane=o,Md(e,o),Dl(i,e,o,-1))}return i4(),i=W2(Error(mt(421))),AC(e,t,h,i)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=e2e.bind(null,e),o._reactRetry=t,null):(e=u.treeContext,$o=of(o.nextSibling),Wo=t,_i=!0,Al=null,e!==null&&(Ac[Ic++]=Sd,Ac[Ic++]=xd,Ac[Ic++]=rm,Sd=e.id,xd=e.overflow,rm=t),t=ZV(t,i.children),t.flags|=4096,t)}function XJ(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),UM(e.return,t,n)}function G2(e,t,n,i,o){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=i,u.tail=n,u.tailMode=o)}function uoe(e,t,n){var i=t.pendingProps,o=i.revealOrder,u=i.tail;if(Ps(e,t,i.children,n),i=Ai.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&XJ(e,n,t);else if(e.tag===19)XJ(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(si(Ai,i),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&mN(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),G2(t,!1,o,n,u);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&mN(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}G2(t,!0,n,null,u);break;case"together":G2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function kR(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ud(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),am|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(mt(153));if(t.child!==null){for(e=t.child,n=df(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=df(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function $De(e,t,n){switch(t.tag){case 3:coe(t),ty();break;case 5:Lse(t);break;case 1:ho(t.type)&&lN(t);break;case 4:GV(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,o=t.memoizedProps.value;si(hN,i._currentValue),i._currentValue=o;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(si(Ai,Ai.current&1),t.flags|=128,null):n&t.child.childLanes?loe(e,t,n):(si(Ai,Ai.current&1),e=Ud(e,t,n),e!==null?e.sibling:null);si(Ai,Ai.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return uoe(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),si(Ai,Ai.current),i)break;return null;case 22:case 23:return t.lanes=0,soe(e,t,n)}return Ud(e,t,n)}var doe,zM,hoe,foe;doe=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zM=function(){};hoe=function(e,t,n,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,Fp(Pu.current);var u=null;switch(n){case"input":o=pM(e,o),i=pM(e,i),u=[];break;case"select":o=Pi({},o,{value:void 0}),i=Pi({},i,{value:void 0}),u=[];break;case"textarea":o=vM(e,o),i=vM(e,i),u=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=oN)}_M(n,i);var h;n=null;for(v in o)if(!i.hasOwnProperty(v)&&o.hasOwnProperty(v)&&o[v]!=null)if(v==="style"){var p=o[v];for(h in p)p.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(o0.hasOwnProperty(v)?u||(u=[]):(u=u||[]).push(v,null));for(v in i){var g=i[v];if(p=o!=null?o[v]:void 0,i.hasOwnProperty(v)&&g!==p&&(g!=null||p!=null))if(v==="style")if(p){for(h in p)!p.hasOwnProperty(h)||g&&g.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in g)g.hasOwnProperty(h)&&p[h]!==g[h]&&(n||(n={}),n[h]=g[h])}else n||(u||(u=[]),u.push(v,n)),n=g;else v==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,p=p?p.__html:void 0,g!=null&&p!==g&&(u=u||[]).push(v,g)):v==="children"?typeof g!="string"&&typeof g!="number"||(u=u||[]).push(v,""+g):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(o0.hasOwnProperty(v)?(g!=null&&v==="onScroll"&&ui("scroll",e),u||p===g||(u=[])):(u=u||[]).push(v,g))}n&&(u=u||[]).push("style",n);var v=u;(t.updateQueue=v)&&(t.flags|=4)}};foe=function(e,t,n,i){n!==i&&(t.flags|=4)};function iE(e,t){if(!_i)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ps(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function WDe(e,t,n){var i=t.pendingProps;switch(MV(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ps(t),null;case 1:return ho(t.type)&&cN(),ps(t),null;case 3:return i=t.stateNode,ry(),pi(uo),pi(ws),zV(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(RC(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Al!==null&&(eU(Al),Al=null))),zM(e,t),ps(t),null;case 5:HV(t);var o=Fp(_0.current);if(n=t.type,e!==null&&t.stateNode!=null)hoe(e,t,n,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(mt(166));return ps(t),null}if(e=Fp(Pu.current),RC(t)){i=t.stateNode,n=t.type;var u=t.memoizedProps;switch(i[Cu]=t,i[v0]=u,e=(t.mode&1)!==0,n){case"dialog":ui("cancel",i),ui("close",i);break;case"iframe":case"object":case"embed":ui("load",i);break;case"video":case"audio":for(o=0;o<DE.length;o++)ui(DE[o],i);break;case"source":ui("error",i);break;case"img":case"image":case"link":ui("error",i),ui("load",i);break;case"details":ui("toggle",i);break;case"input":aJ(i,u),ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!u.multiple},ui("invalid",i);break;case"textarea":oJ(i,u),ui("invalid",i)}_M(n,u),o=null;for(var h in u)if(u.hasOwnProperty(h)){var p=u[h];h==="children"?typeof p=="string"?i.textContent!==p&&(u.suppressHydrationWarning!==!0&&CC(i.textContent,p,e),o=["children",p]):typeof p=="number"&&i.textContent!==""+p&&(u.suppressHydrationWarning!==!0&&CC(i.textContent,p,e),o=["children",""+p]):o0.hasOwnProperty(h)&&p!=null&&h==="onScroll"&&ui("scroll",i)}switch(n){case"input":yC(i),sJ(i,u,!0);break;case"textarea":yC(i),cJ(i);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(i.onclick=oN)}i=o,t.updateQueue=i,i!==null&&(t.flags|=4)}else{h=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Bae(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=h.createElement(n,{is:i.is}):(e=h.createElement(n),n==="select"&&(h=e,i.multiple?h.multiple=!0:i.size&&(h.size=i.size))):e=h.createElementNS(e,n),e[Cu]=t,e[v0]=i,doe(e,t,!1,!1),t.stateNode=e;e:{switch(h=bM(n,i),n){case"dialog":ui("cancel",e),ui("close",e),o=i;break;case"iframe":case"object":case"embed":ui("load",e),o=i;break;case"video":case"audio":for(o=0;o<DE.length;o++)ui(DE[o],e);o=i;break;case"source":ui("error",e),o=i;break;case"img":case"image":case"link":ui("error",e),ui("load",e),o=i;break;case"details":ui("toggle",e),o=i;break;case"input":aJ(e,i),o=pM(e,i),ui("invalid",e);break;case"option":o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=Pi({},i,{value:void 0}),ui("invalid",e);break;case"textarea":oJ(e,i),o=vM(e,i),ui("invalid",e);break;default:o=i}_M(n,o),p=o;for(u in p)if(p.hasOwnProperty(u)){var g=p[u];u==="style"?Gae(e,g):u==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&$ae(e,g)):u==="children"?typeof g=="string"?(n!=="textarea"||g!=="")&&c0(e,g):typeof g=="number"&&c0(e,""+g):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(o0.hasOwnProperty(u)?g!=null&&u==="onScroll"&&ui("scroll",e):g!=null&&wV(e,u,g,h))}switch(n){case"input":yC(e),sJ(e,i,!1);break;case"textarea":yC(e),cJ(e);break;case"option":i.value!=null&&e.setAttribute("value",""+gf(i.value));break;case"select":e.multiple=!!i.multiple,u=i.value,u!=null?Ov(e,!!i.multiple,u,!1):i.defaultValue!=null&&Ov(e,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=oN)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ps(t),null;case 6:if(e&&t.stateNode!=null)foe(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(mt(166));if(n=Fp(_0.current),Fp(Pu.current),RC(t)){if(i=t.stateNode,n=t.memoizedProps,i[Cu]=t,(u=i.nodeValue!==n)&&(e=Wo,e!==null))switch(e.tag){case 3:CC(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&CC(i.nodeValue,n,(e.mode&1)!==0)}u&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Cu]=t,t.stateNode=i}return ps(t),null;case 13:if(pi(Ai),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_i&&$o!==null&&t.mode&1&&!(t.flags&128))Ose(),ty(),t.flags|=98560,u=!1;else if(u=RC(t),i!==null&&i.dehydrated!==null){if(e===null){if(!u)throw Error(mt(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(mt(317));u[Cu]=t}else ty(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ps(t),u=!1}else Al!==null&&(eU(Al),Al=null),u=!0;if(!u)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Ai.current&1?Aa===0&&(Aa=3):i4())),t.updateQueue!==null&&(t.flags|=4),ps(t),null);case 4:return ry(),zM(e,t),e===null&&m0(t.stateNode.containerInfo),ps(t),null;case 10:return BV(t.type._context),ps(t),null;case 17:return ho(t.type)&&cN(),ps(t),null;case 19:if(pi(Ai),u=t.memoizedState,u===null)return ps(t),null;if(i=(t.flags&128)!==0,h=u.rendering,h===null)if(i)iE(u,!1);else{if(Aa!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=mN(e),h!==null){for(t.flags|=128,iE(u,!1),i=h.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)u=n,e=i,u.flags&=14680066,h=u.alternate,h===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=h.childLanes,u.lanes=h.lanes,u.child=h.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=h.memoizedProps,u.memoizedState=h.memoizedState,u.updateQueue=h.updateQueue,u.type=h.type,e=h.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return si(Ai,Ai.current&1|2),t.child}e=e.sibling}u.tail!==null&&Zi()>ay&&(t.flags|=128,i=!0,iE(u,!1),t.lanes=4194304)}else{if(!i)if(e=mN(h),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),iE(u,!0),u.tail===null&&u.tailMode==="hidden"&&!h.alternate&&!_i)return ps(t),null}else 2*Zi()-u.renderingStartTime>ay&&n!==1073741824&&(t.flags|=128,i=!0,iE(u,!1),t.lanes=4194304);u.isBackwards?(h.sibling=t.child,t.child=h):(n=u.last,n!==null?n.sibling=h:t.child=h,u.last=h)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=Zi(),t.sibling=null,n=Ai.current,si(Ai,i?n&1|2:n&1),t):(ps(t),null);case 22:case 23:return r4(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Lo&1073741824&&(ps(t),t.subtreeFlags&6&&(t.flags|=8192)):ps(t),null;case 24:return null;case 25:return null}throw Error(mt(156,t.tag))}function GDe(e,t){switch(MV(t),t.tag){case 1:return ho(t.type)&&cN(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ry(),pi(uo),pi(ws),zV(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return HV(t),null;case 13:if(pi(Ai),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(mt(340));ty()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pi(Ai),null;case 4:return ry(),null;case 10:return BV(t.type._context),null;case 22:case 23:return r4(),null;case 24:return null;default:return null}}var IC=!1,_s=!1,HDe=typeof WeakSet=="function"?WeakSet:Set,Ht=null;function Cv(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Vi(e,t,i)}else n.current=null}function KM(e,t,n){try{n()}catch(i){Vi(e,t,i)}}var JJ=!1;function zDe(e,t){if(IM=iN,e=yse(),DV(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{n.nodeType,u.nodeType}catch{n=null;break e}var h=0,p=-1,g=-1,v=0,b=0,E=e,T=null;t:for(;;){for(var C;E!==n||o!==0&&E.nodeType!==3||(p=h+o),E!==u||i!==0&&E.nodeType!==3||(g=h+i),E.nodeType===3&&(h+=E.nodeValue.length),(C=E.firstChild)!==null;)T=E,E=C;for(;;){if(E===e)break t;if(T===n&&++v===o&&(p=h),T===u&&++b===i&&(g=h),(C=E.nextSibling)!==null)break;E=T,T=E.parentNode}E=C}n=p===-1||g===-1?null:{start:p,end:g}}else n=null}n=n||{start:0,end:0}}else n=null;for(OM={focusedElem:e,selectionRange:n},iN=!1,Ht=t;Ht!==null;)if(t=Ht,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ht=e;else for(;Ht!==null;){t=Ht;try{var R=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var N=R.memoizedProps,O=R.memoizedState,j=t.stateNode,k=j.getSnapshotBeforeUpdate(t.elementType===t.type?N:wl(t.type,N),O);j.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var P=t.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mt(163))}}catch(M){Vi(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,Ht=e;break}Ht=t.return}return R=JJ,JJ=!1,R}function XE(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var u=o.destroy;o.destroy=void 0,u!==void 0&&KM(t,n,u)}o=o.next}while(o!==i)}}function l1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function qM(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function poe(e){var t=e.alternate;t!==null&&(e.alternate=null,poe(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cu],delete t[v0],delete t[jM],delete t[NDe],delete t[ADe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function moe(e){return e.tag===5||e.tag===3||e.tag===4}function ZJ(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||moe(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function YM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=oN));else if(i!==4&&(e=e.child,e!==null))for(YM(e,t,n),e=e.sibling;e!==null;)YM(e,t,n),e=e.sibling}function XM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(XM(e,t,n),e=e.sibling;e!==null;)XM(e,t,n),e=e.sibling}var Qa=null,Cl=!1;function Ph(e,t,n){for(n=n.child;n!==null;)goe(e,t,n),n=n.sibling}function goe(e,t,n){if(Ou&&typeof Ou.onCommitFiberUnmount=="function")try{Ou.onCommitFiberUnmount(t1,n)}catch{}switch(n.tag){case 5:_s||Cv(n,t);case 6:var i=Qa,o=Cl;Qa=null,Ph(e,t,n),Qa=i,Cl=o,Qa!==null&&(Cl?(e=Qa,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Qa.removeChild(n.stateNode));break;case 18:Qa!==null&&(Cl?(e=Qa,n=n.stateNode,e.nodeType===8?M2(e.parentNode,n):e.nodeType===1&&M2(e,n),h0(e)):M2(Qa,n.stateNode));break;case 4:i=Qa,o=Cl,Qa=n.stateNode.containerInfo,Cl=!0,Ph(e,t,n),Qa=i,Cl=o;break;case 0:case 11:case 14:case 15:if(!_s&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var u=o,h=u.destroy;u=u.tag,h!==void 0&&(u&2||u&4)&&KM(n,t,h),o=o.next}while(o!==i)}Ph(e,t,n);break;case 1:if(!_s&&(Cv(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(p){Vi(n,t,p)}Ph(e,t,n);break;case 21:Ph(e,t,n);break;case 22:n.mode&1?(_s=(i=_s)||n.memoizedState!==null,Ph(e,t,n),_s=i):Ph(e,t,n);break;default:Ph(e,t,n)}}function QJ(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new HDe),t.forEach(function(i){var o=t2e.bind(null,e,i);n.has(i)||(n.add(i),i.then(o,o))})}}function fl(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];try{var u=e,h=t,p=h;e:for(;p!==null;){switch(p.tag){case 5:Qa=p.stateNode,Cl=!1;break e;case 3:Qa=p.stateNode.containerInfo,Cl=!0;break e;case 4:Qa=p.stateNode.containerInfo,Cl=!0;break e}p=p.return}if(Qa===null)throw Error(mt(160));goe(u,h,o),Qa=null,Cl=!1;var g=o.alternate;g!==null&&(g.return=null),o.return=null}catch(v){Vi(o,t,v)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)voe(t,e),t=t.sibling}function voe(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),mu(e),i&4){try{XE(3,e,e.return),l1(3,e)}catch(N){Vi(e,e.return,N)}try{XE(5,e,e.return)}catch(N){Vi(e,e.return,N)}}break;case 1:fl(t,e),mu(e),i&512&&n!==null&&Cv(n,n.return);break;case 5:if(fl(t,e),mu(e),i&512&&n!==null&&Cv(n,n.return),e.flags&32){var o=e.stateNode;try{c0(o,"")}catch(N){Vi(e,e.return,N)}}if(i&4&&(o=e.stateNode,o!=null)){var u=e.memoizedProps,h=n!==null?n.memoizedProps:u,p=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{p==="input"&&u.type==="radio"&&u.name!=null&&Fae(o,u),bM(p,h);var v=bM(p,u);for(h=0;h<g.length;h+=2){var b=g[h],E=g[h+1];b==="style"?Gae(o,E):b==="dangerouslySetInnerHTML"?$ae(o,E):b==="children"?c0(o,E):wV(o,b,E,v)}switch(p){case"input":mM(o,u);break;case"textarea":Vae(o,u);break;case"select":var T=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!u.multiple;var C=u.value;C!=null?Ov(o,!!u.multiple,C,!1):T!==!!u.multiple&&(u.defaultValue!=null?Ov(o,!!u.multiple,u.defaultValue,!0):Ov(o,!!u.multiple,u.multiple?[]:"",!1))}o[v0]=u}catch(N){Vi(e,e.return,N)}}break;case 6:if(fl(t,e),mu(e),i&4){if(e.stateNode===null)throw Error(mt(162));o=e.stateNode,u=e.memoizedProps;try{o.nodeValue=u}catch(N){Vi(e,e.return,N)}}break;case 3:if(fl(t,e),mu(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{h0(t.containerInfo)}catch(N){Vi(e,e.return,N)}break;case 4:fl(t,e),mu(e);break;case 13:fl(t,e),mu(e),o=e.child,o.flags&8192&&(u=o.memoizedState!==null,o.stateNode.isHidden=u,!u||o.alternate!==null&&o.alternate.memoizedState!==null||(t4=Zi())),i&4&&QJ(e);break;case 22:if(b=n!==null&&n.memoizedState!==null,e.mode&1?(_s=(v=_s)||b,fl(t,e),_s=v):fl(t,e),mu(e),i&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!b&&e.mode&1)for(Ht=e,b=e.child;b!==null;){for(E=Ht=b;Ht!==null;){switch(T=Ht,C=T.child,T.tag){case 0:case 11:case 14:case 15:XE(4,T,T.return);break;case 1:Cv(T,T.return);var R=T.stateNode;if(typeof R.componentWillUnmount=="function"){i=T,n=T.return;try{t=i,R.props=t.memoizedProps,R.state=t.memoizedState,R.componentWillUnmount()}catch(N){Vi(i,n,N)}}break;case 5:Cv(T,T.return);break;case 22:if(T.memoizedState!==null){tZ(E);continue}}C!==null?(C.return=T,Ht=C):tZ(E)}b=b.sibling}e:for(b=null,E=e;;){if(E.tag===5){if(b===null){b=E;try{o=E.stateNode,v?(u=o.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(p=E.stateNode,g=E.memoizedProps.style,h=g!=null&&g.hasOwnProperty("display")?g.display:null,p.style.display=Wae("display",h))}catch(N){Vi(e,e.return,N)}}}else if(E.tag===6){if(b===null)try{E.stateNode.nodeValue=v?"":E.memoizedProps}catch(N){Vi(e,e.return,N)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;b===E&&(b=null),E=E.return}b===E&&(b=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:fl(t,e),mu(e),i&4&&QJ(e);break;case 21:break;default:fl(t,e),mu(e)}}function mu(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(moe(n)){var i=n;break e}n=n.return}throw Error(mt(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(c0(o,""),i.flags&=-33);var u=ZJ(e);XM(e,u,o);break;case 3:case 4:var h=i.stateNode.containerInfo,p=ZJ(e);YM(e,p,h);break;default:throw Error(mt(161))}}catch(g){Vi(e,e.return,g)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function KDe(e,t,n){Ht=e,yoe(e)}function yoe(e,t,n){for(var i=(e.mode&1)!==0;Ht!==null;){var o=Ht,u=o.child;if(o.tag===22&&i){var h=o.memoizedState!==null||IC;if(!h){var p=o.alternate,g=p!==null&&p.memoizedState!==null||_s;p=IC;var v=_s;if(IC=h,(_s=g)&&!v)for(Ht=o;Ht!==null;)h=Ht,g=h.child,h.tag===22&&h.memoizedState!==null?nZ(o):g!==null?(g.return=h,Ht=g):nZ(o);for(;u!==null;)Ht=u,yoe(u),u=u.sibling;Ht=o,IC=p,_s=v}eZ(e)}else o.subtreeFlags&8772&&u!==null?(u.return=o,Ht=u):eZ(e)}}function eZ(e){for(;Ht!==null;){var t=Ht;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_s||l1(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!_s)if(n===null)i.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:wl(t.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&UJ(t,u,i);break;case 3:var h=t.updateQueue;if(h!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}UJ(t,h,n)}break;case 5:var p=t.stateNode;if(n===null&&t.flags&4){n=p;var g=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&n.focus();break;case"img":g.src&&(n.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var v=t.alternate;if(v!==null){var b=v.memoizedState;if(b!==null){var E=b.dehydrated;E!==null&&h0(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mt(163))}_s||t.flags&512&&qM(t)}catch(T){Vi(t,t.return,T)}}if(t===e){Ht=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ht=n;break}Ht=t.return}}function tZ(e){for(;Ht!==null;){var t=Ht;if(t===e){Ht=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ht=n;break}Ht=t.return}}function nZ(e){for(;Ht!==null;){var t=Ht;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{l1(4,t)}catch(g){Vi(t,n,g)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var o=t.return;try{i.componentDidMount()}catch(g){Vi(t,o,g)}}var u=t.return;try{qM(t)}catch(g){Vi(t,u,g)}break;case 5:var h=t.return;try{qM(t)}catch(g){Vi(t,h,g)}}}catch(g){Vi(t,t.return,g)}if(t===e){Ht=null;break}var p=t.sibling;if(p!==null){p.return=t.return,Ht=p;break}Ht=t.return}}var qDe=Math.ceil,yN=Kd.ReactCurrentDispatcher,QV=Kd.ReactCurrentOwner,Dc=Kd.ReactCurrentBatchConfig,pr=0,Ga=null,fa=null,ns=0,Lo=0,Rv=Rf(0),Aa=0,S0=null,am=0,u1=0,e4=0,JE=null,oo=null,t4=0,ay=1/0,_d=null,_N=!1,JM=null,lf=null,OC=!1,Zh=null,bN=0,ZE=0,ZM=null,jR=-1,DR=0;function Ls(){return pr&6?Zi():jR!==-1?jR:jR=Zi()}function uf(e){return e.mode&1?pr&2&&ns!==0?ns&-ns:ODe.transition!==null?(DR===0&&(DR=nse()),DR):(e=Br,e!==0||(e=window.event,e=e===void 0?16:lse(e.type)),e):1}function Dl(e,t,n,i){if(50<ZE)throw ZE=0,ZM=null,Error(mt(185));Pw(e,n,i),(!(pr&2)||e!==Ga)&&(e===Ga&&(!(pr&2)&&(u1|=n),Aa===4&&Wh(e,ns)),fo(e,i),n===1&&pr===0&&!(t.mode&1)&&(ay=Zi()+500,s1&&Nf()))}function fo(e,t){var n=e.callbackNode;Oje(e,t);var i=rN(e,e===Ga?ns:0);if(i===0)n!==null&&dJ(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&dJ(n),t===1)e.tag===0?IDe(rZ.bind(null,e)):Nse(rZ.bind(null,e)),CDe(function(){!(pr&6)&&Nf()}),n=null;else{switch(rse(i)){case 1:n=RV;break;case 4:n=ese;break;case 16:n=nN;break;case 536870912:n=tse;break;default:n=nN}n=Coe(n,_oe.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function _oe(e,t){if(jR=-1,DR=0,pr&6)throw Error(mt(327));var n=e.callbackNode;if(Lv()&&e.callbackNode!==n)return null;var i=rN(e,e===Ga?ns:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=EN(e,i);else{t=i;var o=pr;pr|=2;var u=Eoe();(Ga!==e||ns!==t)&&(_d=null,ay=Zi()+500,Jp(e,t));do try{JDe();break}catch(p){boe(e,p)}while(!0);VV(),yN.current=u,pr=o,fa!==null?t=0:(Ga=null,ns=0,t=Aa)}if(t!==0){if(t===2&&(o=TM(e),o!==0&&(i=o,t=QM(e,o))),t===1)throw n=S0,Jp(e,0),Wh(e,i),fo(e,Zi()),n;if(t===6)Wh(e,i);else{if(o=e.current.alternate,!(i&30)&&!YDe(o)&&(t=EN(e,i),t===2&&(u=TM(e),u!==0&&(i=u,t=QM(e,u))),t===1))throw n=S0,Jp(e,0),Wh(e,i),fo(e,Zi()),n;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(mt(345));case 2:Op(e,oo,_d);break;case 3:if(Wh(e,i),(i&130023424)===i&&(t=t4+500-Zi(),10<t)){if(rN(e,0)!==0)break;if(o=e.suspendedLanes,(o&i)!==i){Ls(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=kM(Op.bind(null,e,oo,_d),t);break}Op(e,oo,_d);break;case 4:if(Wh(e,i),(i&4194240)===i)break;for(t=e.eventTimes,o=-1;0<i;){var h=31-jl(i);u=1<<h,h=t[h],h>o&&(o=h),i&=~u}if(i=o,i=Zi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*qDe(i/1960))-i,10<i){e.timeoutHandle=kM(Op.bind(null,e,oo,_d),i);break}Op(e,oo,_d);break;case 5:Op(e,oo,_d);break;default:throw Error(mt(329))}}}return fo(e,Zi()),e.callbackNode===n?_oe.bind(null,e):null}function QM(e,t){var n=JE;return e.current.memoizedState.isDehydrated&&(Jp(e,t).flags|=256),e=EN(e,t),e!==2&&(t=oo,oo=n,t!==null&&eU(t)),e}function eU(e){oo===null?oo=e:oo.push.apply(oo,e)}function YDe(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var o=n[i],u=o.getSnapshot;o=o.value;try{if(!Ul(u(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wh(e,t){for(t&=~e4,t&=~u1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jl(t),i=1<<n;e[n]=-1,t&=~i}}function rZ(e){if(pr&6)throw Error(mt(327));Lv();var t=rN(e,0);if(!(t&1))return fo(e,Zi()),null;var n=EN(e,t);if(e.tag!==0&&n===2){var i=TM(e);i!==0&&(t=i,n=QM(e,i))}if(n===1)throw n=S0,Jp(e,0),Wh(e,t),fo(e,Zi()),n;if(n===6)throw Error(mt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Op(e,oo,_d),fo(e,Zi()),null}function n4(e,t){var n=pr;pr|=1;try{return e(t)}finally{pr=n,pr===0&&(ay=Zi()+500,s1&&Nf())}}function sm(e){Zh!==null&&Zh.tag===0&&!(pr&6)&&Lv();var t=pr;pr|=1;var n=Dc.transition,i=Br;try{if(Dc.transition=null,Br=1,e)return e()}finally{Br=i,Dc.transition=n,pr=t,!(pr&6)&&Nf()}}function r4(){Lo=Rv.current,pi(Rv)}function Jp(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,TDe(n)),fa!==null)for(n=fa.return;n!==null;){var i=n;switch(MV(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&cN();break;case 3:ry(),pi(uo),pi(ws),zV();break;case 5:HV(i);break;case 4:ry();break;case 13:pi(Ai);break;case 19:pi(Ai);break;case 10:BV(i.type._context);break;case 22:case 23:r4()}n=n.return}if(Ga=e,fa=e=df(e.current,null),ns=Lo=t,Aa=0,S0=null,e4=u1=am=0,oo=JE=null,Up!==null){for(t=0;t<Up.length;t++)if(n=Up[t],i=n.interleaved,i!==null){n.interleaved=null;var o=i.next,u=n.pending;if(u!==null){var h=u.next;u.next=o,i.next=h}n.pending=i}Up=null}return e}function boe(e,t){do{var n=fa;try{if(VV(),OR.current=vN,gN){for(var i=Oi.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}gN=!1}if(im=0,Va=Na=Oi=null,YE=!1,b0=0,QV.current=null,n===null||n.return===null){Aa=1,S0=t,fa=null;break}e:{var u=e,h=n.return,p=n,g=t;if(t=ns,p.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var v=g,b=p,E=b.tag;if(!(b.mode&1)&&(E===0||E===11||E===15)){var T=b.alternate;T?(b.updateQueue=T.updateQueue,b.memoizedState=T.memoizedState,b.lanes=T.lanes):(b.updateQueue=null,b.memoizedState=null)}var C=GJ(h);if(C!==null){C.flags&=-257,HJ(C,h,p,u,t),C.mode&1&&WJ(u,v,t),t=C,g=v;var R=t.updateQueue;if(R===null){var N=new Set;N.add(g),t.updateQueue=N}else R.add(g);break e}else{if(!(t&1)){WJ(u,v,t),i4();break e}g=Error(mt(426))}}else if(_i&&p.mode&1){var O=GJ(h);if(O!==null){!(O.flags&65536)&&(O.flags|=256),HJ(O,h,p,u,t),UV(iy(g,p));break e}}u=g=iy(g,p),Aa!==4&&(Aa=2),JE===null?JE=[u]:JE.push(u),u=h;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var j=roe(u,g,t);MJ(u,j);break e;case 1:p=g;var k=u.type,P=u.stateNode;if(!(u.flags&128)&&(typeof k.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(lf===null||!lf.has(P)))){u.flags|=65536,t&=-t,u.lanes|=t;var M=ioe(u,p,t);MJ(u,M);break e}}u=u.return}while(u!==null)}Soe(n)}catch(D){t=D,fa===n&&n!==null&&(fa=n=n.return);continue}break}while(!0)}function Eoe(){var e=yN.current;return yN.current=vN,e===null?vN:e}function i4(){(Aa===0||Aa===3||Aa===2)&&(Aa=4),Ga===null||!(am&268435455)&&!(u1&268435455)||Wh(Ga,ns)}function EN(e,t){var n=pr;pr|=2;var i=Eoe();(Ga!==e||ns!==t)&&(_d=null,Jp(e,t));do try{XDe();break}catch(o){boe(e,o)}while(!0);if(VV(),pr=n,yN.current=i,fa!==null)throw Error(mt(261));return Ga=null,ns=0,Aa}function XDe(){for(;fa!==null;)woe(fa)}function JDe(){for(;fa!==null&&!wje();)woe(fa)}function woe(e){var t=Toe(e.alternate,e,Lo);e.memoizedProps=e.pendingProps,t===null?Soe(e):fa=t,QV.current=null}function Soe(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=GDe(n,t),n!==null){n.flags&=32767,fa=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Aa=6,fa=null;return}}else if(n=WDe(n,t,Lo),n!==null){fa=n;return}if(t=t.sibling,t!==null){fa=t;return}fa=t=e}while(t!==null);Aa===0&&(Aa=5)}function Op(e,t,n){var i=Br,o=Dc.transition;try{Dc.transition=null,Br=1,ZDe(e,t,n,i)}finally{Dc.transition=o,Br=i}return null}function ZDe(e,t,n,i){do Lv();while(Zh!==null);if(pr&6)throw Error(mt(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(mt(177));e.callbackNode=null,e.callbackPriority=0;var u=n.lanes|n.childLanes;if(Pje(e,u),e===Ga&&(fa=Ga=null,ns=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||OC||(OC=!0,Coe(nN,function(){return Lv(),null})),u=(n.flags&15990)!==0,n.subtreeFlags&15990||u){u=Dc.transition,Dc.transition=null;var h=Br;Br=1;var p=pr;pr|=4,QV.current=null,zDe(e,n),voe(n,e),yDe(OM),iN=!!IM,OM=IM=null,e.current=n,KDe(n),Sje(),pr=p,Br=h,Dc.transition=u}else e.current=n;if(OC&&(OC=!1,Zh=e,bN=o),u=e.pendingLanes,u===0&&(lf=null),Cje(n.stateNode),fo(e,Zi()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],i(o.value,{componentStack:o.stack,digest:o.digest});if(_N)throw _N=!1,e=JM,JM=null,e;return bN&1&&e.tag!==0&&Lv(),u=e.pendingLanes,u&1?e===ZM?ZE++:(ZE=0,ZM=e):ZE=0,Nf(),null}function Lv(){if(Zh!==null){var e=rse(bN),t=Dc.transition,n=Br;try{if(Dc.transition=null,Br=16>e?16:e,Zh===null)var i=!1;else{if(e=Zh,Zh=null,bN=0,pr&6)throw Error(mt(331));var o=pr;for(pr|=4,Ht=e.current;Ht!==null;){var u=Ht,h=u.child;if(Ht.flags&16){var p=u.deletions;if(p!==null){for(var g=0;g<p.length;g++){var v=p[g];for(Ht=v;Ht!==null;){var b=Ht;switch(b.tag){case 0:case 11:case 15:XE(8,b,u)}var E=b.child;if(E!==null)E.return=b,Ht=E;else for(;Ht!==null;){b=Ht;var T=b.sibling,C=b.return;if(poe(b),b===v){Ht=null;break}if(T!==null){T.return=C,Ht=T;break}Ht=C}}}var R=u.alternate;if(R!==null){var N=R.child;if(N!==null){R.child=null;do{var O=N.sibling;N.sibling=null,N=O}while(N!==null)}}Ht=u}}if(u.subtreeFlags&2064&&h!==null)h.return=u,Ht=h;else e:for(;Ht!==null;){if(u=Ht,u.flags&2048)switch(u.tag){case 0:case 11:case 15:XE(9,u,u.return)}var j=u.sibling;if(j!==null){j.return=u.return,Ht=j;break e}Ht=u.return}}var k=e.current;for(Ht=k;Ht!==null;){h=Ht;var P=h.child;if(h.subtreeFlags&2064&&P!==null)P.return=h,Ht=P;else e:for(h=k;Ht!==null;){if(p=Ht,p.flags&2048)try{switch(p.tag){case 0:case 11:case 15:l1(9,p)}}catch(D){Vi(p,p.return,D)}if(p===h){Ht=null;break e}var M=p.sibling;if(M!==null){M.return=p.return,Ht=M;break e}Ht=p.return}}if(pr=o,Nf(),Ou&&typeof Ou.onPostCommitFiberRoot=="function")try{Ou.onPostCommitFiberRoot(t1,e)}catch{}i=!0}return i}finally{Br=n,Dc.transition=t}}return!1}function iZ(e,t,n){t=iy(n,t),t=roe(e,t,1),e=cf(e,t,1),t=Ls(),e!==null&&(Pw(e,1,t),fo(e,t))}function Vi(e,t,n){if(e.tag===3)iZ(e,e,n);else for(;t!==null;){if(t.tag===3){iZ(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(lf===null||!lf.has(i))){e=iy(n,e),e=ioe(t,e,1),t=cf(t,e,1),e=Ls(),t!==null&&(Pw(t,1,e),fo(t,e));break}}t=t.return}}function QDe(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=Ls(),e.pingedLanes|=e.suspendedLanes&n,Ga===e&&(ns&n)===n&&(Aa===4||Aa===3&&(ns&130023424)===ns&&500>Zi()-t4?Jp(e,0):e4|=n),fo(e,t)}function xoe(e,t){t===0&&(e.mode&1?(t=EC,EC<<=1,!(EC&130023424)&&(EC=4194304)):t=1);var n=Ls();e=Md(e,t),e!==null&&(Pw(e,t,n),fo(e,n))}function e2e(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),xoe(e,n)}function t2e(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(mt(314))}i!==null&&i.delete(t),xoe(e,n)}var Toe;Toe=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||uo.current)co=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return co=!1,$De(e,t,n);co=!!(e.flags&131072)}else co=!1,_i&&t.flags&1048576&&Ase(t,dN,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;kR(e,t),e=t.pendingProps;var o=ey(t,ws.current);Dv(t,n),o=qV(null,t,i,e,o,n);var u=YV();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ho(i)?(u=!0,lN(t)):u=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,WV(t),o.updater=c1,t.stateNode=o,o._reactInternals=t,VM(t,i,e,n),t=WM(null,t,i,!0,u,n)):(t.tag=0,_i&&u&&LV(t),Ps(null,t,o,n),t=t.child),t;case 16:i=t.elementType;e:{switch(kR(e,t),e=t.pendingProps,o=i._init,i=o(i._payload),t.type=i,o=t.tag=r2e(i),e=wl(i,e),o){case 0:t=$M(null,t,i,e,n);break e;case 1:t=qJ(null,t,i,e,n);break e;case 11:t=zJ(null,t,i,e,n);break e;case 14:t=KJ(null,t,i,wl(i.type,e),n);break e}throw Error(mt(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:wl(i,o),$M(e,t,i,o,n);case 1:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:wl(i,o),qJ(e,t,i,o,n);case 3:e:{if(coe(t),e===null)throw Error(mt(387));i=t.pendingProps,u=t.memoizedState,o=u.element,Dse(e,t),pN(t,i,null,n);var h=t.memoizedState;if(i=h.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){o=iy(Error(mt(423)),t),t=YJ(e,t,i,n,o);break e}else if(i!==o){o=iy(Error(mt(424)),t),t=YJ(e,t,i,n,o);break e}else for($o=of(t.stateNode.containerInfo.firstChild),Wo=t,_i=!0,Al=null,n=kse(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ty(),i===o){t=Ud(e,t,n);break e}Ps(e,t,i,n)}t=t.child}return t;case 5:return Lse(t),e===null&&MM(t),i=t.type,o=t.pendingProps,u=e!==null?e.memoizedProps:null,h=o.children,PM(i,o)?h=null:u!==null&&PM(i,u)&&(t.flags|=32),ooe(e,t),Ps(e,t,h,n),t.child;case 6:return e===null&&MM(t),null;case 13:return loe(e,t,n);case 4:return GV(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=ny(t,null,i,n):Ps(e,t,i,n),t.child;case 11:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:wl(i,o),zJ(e,t,i,o,n);case 7:return Ps(e,t,t.pendingProps,n),t.child;case 8:return Ps(e,t,t.pendingProps.children,n),t.child;case 12:return Ps(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,u=t.memoizedProps,h=o.value,si(hN,i._currentValue),i._currentValue=h,u!==null)if(Ul(u.value,h)){if(u.children===o.children&&!uo.current){t=Ud(e,t,n);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var p=u.dependencies;if(p!==null){h=u.child;for(var g=p.firstContext;g!==null;){if(g.context===i){if(u.tag===1){g=Nd(-1,n&-n),g.tag=2;var v=u.updateQueue;if(v!==null){v=v.shared;var b=v.pending;b===null?g.next=g:(g.next=b.next,b.next=g),v.pending=g}}u.lanes|=n,g=u.alternate,g!==null&&(g.lanes|=n),UM(u.return,n,t),p.lanes|=n;break}g=g.next}}else if(u.tag===10)h=u.type===t.type?null:u.child;else if(u.tag===18){if(h=u.return,h===null)throw Error(mt(341));h.lanes|=n,p=h.alternate,p!==null&&(p.lanes|=n),UM(h,n,t),h=u.sibling}else h=u.child;if(h!==null)h.return=u;else for(h=u;h!==null;){if(h===t){h=null;break}if(u=h.sibling,u!==null){u.return=h.return,h=u;break}h=h.return}u=h}Ps(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,Dv(t,n),o=Uc(o),i=i(o),t.flags|=1,Ps(e,t,i,n),t.child;case 14:return i=t.type,o=wl(i,t.pendingProps),o=wl(i.type,o),KJ(e,t,i,o,n);case 15:return aoe(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:wl(i,o),kR(e,t),t.tag=1,ho(i)?(e=!0,lN(t)):e=!1,Dv(t,n),noe(t,i,o),VM(t,i,o,n),WM(null,t,i,!0,e,n);case 19:return uoe(e,t,n);case 22:return soe(e,t,n)}throw Error(mt(156,t.tag))};function Coe(e,t){return Qae(e,t)}function n2e(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kc(e,t,n,i){return new n2e(e,t,n,i)}function a4(e){return e=e.prototype,!(!e||!e.isReactComponent)}function r2e(e){if(typeof e=="function")return a4(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xV)return 11;if(e===TV)return 14}return 2}function df(e,t){var n=e.alternate;return n===null?(n=kc(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function LR(e,t,n,i,o,u){var h=2;if(i=e,typeof e=="function")a4(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case vv:return Zp(n.children,o,u,t);case SV:h=8,o|=8;break;case uM:return e=kc(12,n,t,o|2),e.elementType=uM,e.lanes=u,e;case dM:return e=kc(13,n,t,o),e.elementType=dM,e.lanes=u,e;case hM:return e=kc(19,n,t,o),e.elementType=hM,e.lanes=u,e;case Lae:return d1(n,o,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jae:h=10;break e;case Dae:h=9;break e;case xV:h=11;break e;case TV:h=14;break e;case Uh:h=16,i=null;break e}throw Error(mt(130,e==null?e:typeof e,""))}return t=kc(h,n,t,o),t.elementType=e,t.type=i,t.lanes=u,t}function Zp(e,t,n,i){return e=kc(7,e,i,t),e.lanes=n,e}function d1(e,t,n,i){return e=kc(22,e,i,t),e.elementType=Lae,e.lanes=n,e.stateNode={isHidden:!1},e}function H2(e,t,n){return e=kc(6,e,null,t),e.lanes=n,e}function z2(e,t,n){return t=kc(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function i2e(e,t,n,i,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=C2(0),this.expirationTimes=C2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=C2(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function s4(e,t,n,i,o,u,h,p,g){return e=new i2e(e,t,n,p,g),t===1?(t=1,u===!0&&(t|=8)):t=0,u=kc(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},WV(u),e}function a2e(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gv,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function Roe(e){if(!e)return vf;e=e._reactInternals;e:{if(Em(e)!==e||e.tag!==1)throw Error(mt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ho(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(mt(171))}if(e.tag===1){var n=e.type;if(ho(n))return Rse(e,n,t)}return t}function Noe(e,t,n,i,o,u,h,p,g){return e=s4(n,i,!0,e,o,u,h,p,g),e.context=Roe(null),n=e.current,i=Ls(),o=uf(n),u=Nd(i,o),u.callback=t??null,cf(n,u,o),e.current.lanes=o,Pw(e,o,i),fo(e,i),e}function h1(e,t,n,i){var o=t.current,u=Ls(),h=uf(o);return n=Roe(n),t.context===null?t.context=n:t.pendingContext=n,t=Nd(u,h),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=cf(o,t,h),e!==null&&(Dl(e,o,h,u),IR(e,o,h)),h}function wN(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function aZ(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function o4(e,t){aZ(e,t),(e=e.alternate)&&aZ(e,t)}function s2e(){return null}var Aoe=typeof reportError=="function"?reportError:function(e){console.error(e)};function c4(e){this._internalRoot=e}f1.prototype.render=c4.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(mt(409));h1(e,t,null,null)};f1.prototype.unmount=c4.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sm(function(){h1(null,e,null,null)}),t[Ld]=null}};function f1(e){this._internalRoot=e}f1.prototype.unstable_scheduleHydration=function(e){if(e){var t=sse();e={blockedOn:null,target:e,priority:t};for(var n=0;n<$h.length&&t!==0&&t<$h[n].priority;n++);$h.splice(n,0,e),n===0&&cse(e)}};function l4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function p1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function sZ(){}function o2e(e,t,n,i,o){if(o){if(typeof i=="function"){var u=i;i=function(){var v=wN(h);u.call(v)}}var h=Noe(t,i,e,0,null,!1,!1,"",sZ);return e._reactRootContainer=h,e[Ld]=h.current,m0(e.nodeType===8?e.parentNode:e),sm(),h}for(;o=e.lastChild;)e.removeChild(o);if(typeof i=="function"){var p=i;i=function(){var v=wN(g);p.call(v)}}var g=s4(e,0,!1,null,null,!1,!1,"",sZ);return e._reactRootContainer=g,e[Ld]=g.current,m0(e.nodeType===8?e.parentNode:e),sm(function(){h1(t,g,n,i)}),g}function m1(e,t,n,i,o){var u=n._reactRootContainer;if(u){var h=u;if(typeof o=="function"){var p=o;o=function(){var g=wN(h);p.call(g)}}h1(t,h,e,o)}else h=o2e(n,t,e,o,i);return wN(h)}ise=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=jE(t.pendingLanes);n!==0&&(NV(t,n|1),fo(t,Zi()),!(pr&6)&&(ay=Zi()+500,Nf()))}break;case 13:sm(function(){var i=Md(e,1);if(i!==null){var o=Ls();Dl(i,e,1,o)}}),o4(e,1)}};AV=function(e){if(e.tag===13){var t=Md(e,134217728);if(t!==null){var n=Ls();Dl(t,e,134217728,n)}o4(e,134217728)}};ase=function(e){if(e.tag===13){var t=uf(e),n=Md(e,t);if(n!==null){var i=Ls();Dl(n,e,t,i)}o4(e,t)}};sse=function(){return Br};ose=function(e,t){var n=Br;try{return Br=e,t()}finally{Br=n}};wM=function(e,t,n){switch(t){case"input":if(mM(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var o=a1(i);if(!o)throw Error(mt(90));Uae(i),mM(i,o)}}}break;case"textarea":Vae(e,n);break;case"select":t=n.value,t!=null&&Ov(e,!!n.multiple,t,!1)}};Kae=n4;qae=sm;var c2e={usingClientEntryPoint:!1,Events:[jw,Ev,a1,Hae,zae,n4]},aE={findFiberByHostInstance:Mp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},l2e={bundleType:aE.bundleType,version:aE.version,rendererPackageName:aE.rendererPackageName,rendererConfig:aE.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Jae(e),e===null?null:e.stateNode},findFiberByHostInstance:aE.findFiberByHostInstance||s2e,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var PC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!PC.isDisabled&&PC.supportsFiber)try{t1=PC.inject(l2e),Ou=PC}catch{}}Jo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c2e;Jo.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l4(t))throw Error(mt(200));return a2e(e,t,null,n)};Jo.createRoot=function(e,t){if(!l4(e))throw Error(mt(299));var n=!1,i="",o=Aoe;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=s4(e,1,!1,null,null,n,!1,i,o),e[Ld]=t.current,m0(e.nodeType===8?e.parentNode:e),new c4(t)};Jo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(mt(188)):(e=Object.keys(e).join(","),Error(mt(268,e)));return e=Jae(t),e=e===null?null:e.stateNode,e};Jo.flushSync=function(e){return sm(e)};Jo.hydrate=function(e,t,n){if(!p1(t))throw Error(mt(200));return m1(null,e,t,!0,n)};Jo.hydrateRoot=function(e,t,n){if(!l4(e))throw Error(mt(405));var i=n!=null&&n.hydratedSources||null,o=!1,u="",h=Aoe;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),t=Noe(t,null,e,1,n??null,o,!1,u,h),e[Ld]=t.current,m0(e),i)for(e=0;e<i.length;e++)n=i[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new f1(t)};Jo.render=function(e,t,n){if(!p1(t))throw Error(mt(200));return m1(null,e,t,!1,n)};Jo.unmountComponentAtNode=function(e){if(!p1(e))throw Error(mt(40));return e._reactRootContainer?(sm(function(){m1(null,null,e,!1,function(){e._reactRootContainer=null,e[Ld]=null})}),!0):!1};Jo.unstable_batchedUpdates=n4;Jo.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!p1(n))throw Error(mt(200));if(e==null||e._reactInternals===void 0)throw Error(mt(38));return m1(e,t,n,!1,i)};Jo.version="18.3.1-next-f1338f8080-20240426";function Ioe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ioe)}catch(e){console.error(e)}}Ioe(),Iae.exports=Jo;var Af=Iae.exports;const Ooe=jr(Af);var Poe,oZ=Af;Poe=oZ.createRoot,oZ.hydrateRoot;var u2e=e=>{switch(e){case"success":return f2e;case"info":return m2e;case"warning":return p2e;case"error":return g2e;default:return null}},d2e=Array(12).fill(0),h2e=({visible:e,className:t})=>me.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},me.createElement("div",{className:"sonner-spinner"},d2e.map((n,i)=>me.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),f2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),p2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),m2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),g2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),v2e=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},me.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),me.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),y2e=()=>{let[e,t]=me.useState(document.hidden);return me.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},tU=1,_2e=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...i}=e,o=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:tU++,u=this.toasts.find(p=>p.id===o),h=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),u?this.toasts=this.toasts.map(p=>p.id===o?(this.publish({...p,...e,id:o,title:n}),{...p,...e,id:o,dismissible:h,title:n}):p):this.addToast({title:n,...i,dismissible:h,id:o}),o},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let i=e instanceof Promise?e:e(),o=n!==void 0,u,h=i.then(async g=>{if(u=["resolve",g],me.isValidElement(g))o=!1,this.create({id:n,type:"default",message:g});else if(E2e(g)&&!g.ok){o=!1;let v=typeof t.error=="function"?await t.error(`HTTP error! status: ${g.status}`):t.error,b=typeof t.description=="function"?await t.description(`HTTP error! status: ${g.status}`):t.description;this.create({id:n,type:"error",message:v,description:b})}else if(t.success!==void 0){o=!1;let v=typeof t.success=="function"?await t.success(g):t.success,b=typeof t.description=="function"?await t.description(g):t.description;this.create({id:n,type:"success",message:v,description:b})}}).catch(async g=>{if(u=["reject",g],t.error!==void 0){o=!1;let v=typeof t.error=="function"?await t.error(g):t.error,b=typeof t.description=="function"?await t.description(g):t.description;this.create({id:n,type:"error",message:v,description:b})}}).finally(()=>{var g;o&&(this.dismiss(n),n=void 0),(g=t.finally)==null||g.call(t)}),p=()=>new Promise((g,v)=>h.then(()=>u[0]==="reject"?v(u[1]):g(u[1])).catch(v));return typeof n!="string"&&typeof n!="number"?{unwrap:p}:Object.assign(n,{unwrap:p})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||tU++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},so=new _2e,b2e=(e,t)=>{let n=(t==null?void 0:t.id)||tU++;return so.addToast({title:e,...t,id:n}),n},E2e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",w2e=b2e,S2e=()=>so.toasts,x2e=()=>so.getActiveToasts(),Ce=Object.assign(w2e,{success:so.success,info:so.info,warning:so.warning,error:so.error,custom:so.custom,message:so.message,promise:so.promise,dismiss:so.dismiss,loading:so.loading},{getHistory:S2e,getToasts:x2e});function T2e(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}T2e(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function kC(e){return e.label!==void 0}var C2e=3,R2e="32px",N2e="16px",cZ=4e3,A2e=356,I2e=14,O2e=20,P2e=200;function pl(...e){return e.filter(Boolean).join(" ")}function k2e(e){let[t,n]=e.split("-"),i=[];return t&&i.push(t),n&&i.push(n),i}var j2e=e=>{var t,n,i,o,u,h,p,g,v,b,E;let{invert:T,toast:C,unstyled:R,interacting:N,setHeights:O,visibleToasts:j,heights:k,index:P,toasts:M,expanded:D,removeToast:U,defaultRichColors:F,closeButton:H,style:W,cancelButtonStyle:q,actionButtonStyle:Y,className:z="",descriptionClassName:Z="",duration:X,position:ae,gap:se,loadingIcon:J,expandByDefault:re,classNames:ee,icons:de,closeButtonAriaLabel:xe="Close toast",pauseWhenPageIsHidden:ve}=e,[Te,Pe]=me.useState(null),[qe,st]=me.useState(null),[ze,ft]=me.useState(!1),[$e,at]=me.useState(!1),[ke,je]=me.useState(!1),[Pt,Dt]=me.useState(!1),[cn,ut]=me.useState(!1),[wt,Rt]=me.useState(0),[Le,ge]=me.useState(0),Ne=me.useRef(C.duration||X||cZ),We=me.useRef(null),gt=me.useRef(null),ot=P===0,pt=P+1<=j,Ft=C.type,gn=C.dismissible!==!1,ur=C.className||"",ia=C.descriptionClassName||"",Ws=me.useMemo(()=>k.findIndex(Sn=>Sn.toastId===C.id)||0,[k,C.id]),xs=me.useMemo(()=>{var Sn;return(Sn=C.closeButton)!=null?Sn:H},[C.closeButton,H]),Xu=me.useMemo(()=>C.duration||X||cZ,[C.duration,X]),Gs=me.useRef(0),Gi=me.useRef(0),zl=me.useRef(0),bt=me.useRef(null),[yn,Bn]=ae.split("-"),ki=me.useMemo(()=>k.reduce((Sn,nr,ni)=>ni>=Ws?Sn:Sn+nr.height,0),[k,Ws]),zc=y2e(),x_=C.invert||T,T_=Ft==="loading";Gi.current=me.useMemo(()=>Ws*se+ki,[Ws,ki]),me.useEffect(()=>{Ne.current=Xu},[Xu]),me.useEffect(()=>{ft(!0)},[]),me.useEffect(()=>{let Sn=gt.current;if(Sn){let nr=Sn.getBoundingClientRect().height;return ge(nr),O(ni=>[{toastId:C.id,height:nr,position:C.position},...ni]),()=>O(ni=>ni.filter(yo=>yo.toastId!==C.id))}},[O,C.id]),me.useLayoutEffect(()=>{if(!ze)return;let Sn=gt.current,nr=Sn.style.height;Sn.style.height="auto";let ni=Sn.getBoundingClientRect().height;Sn.style.height=nr,ge(ni),O(yo=>yo.find(_o=>_o.toastId===C.id)?yo.map(_o=>_o.toastId===C.id?{..._o,height:ni}:_o):[{toastId:C.id,height:ni,position:C.position},...yo])},[ze,C.title,C.description,O,C.id]);let Kl=me.useCallback(()=>{at(!0),Rt(Gi.current),O(Sn=>Sn.filter(nr=>nr.toastId!==C.id)),setTimeout(()=>{U(C)},P2e)},[C,U,O,Gi]);me.useEffect(()=>{if(C.promise&&Ft==="loading"||C.duration===1/0||C.type==="loading")return;let Sn;return D||N||ve&&zc?(()=>{if(zl.current<Gs.current){let nr=new Date().getTime()-Gs.current;Ne.current=Ne.current-nr}zl.current=new Date().getTime()})():Ne.current!==1/0&&(Gs.current=new Date().getTime(),Sn=setTimeout(()=>{var nr;(nr=C.onAutoClose)==null||nr.call(C,C),Kl()},Ne.current)),()=>clearTimeout(Sn)},[D,N,C,Ft,ve,zc,Kl]),me.useEffect(()=>{C.delete&&Kl()},[Kl,C.delete]);function Wf(){var Sn,nr,ni;return de!=null&&de.loading?me.createElement("div",{className:pl(ee==null?void 0:ee.loader,(Sn=C==null?void 0:C.classNames)==null?void 0:Sn.loader,"sonner-loader"),"data-visible":Ft==="loading"},de.loading):J?me.createElement("div",{className:pl(ee==null?void 0:ee.loader,(nr=C==null?void 0:C.classNames)==null?void 0:nr.loader,"sonner-loader"),"data-visible":Ft==="loading"},J):me.createElement(h2e,{className:pl(ee==null?void 0:ee.loader,(ni=C==null?void 0:C.classNames)==null?void 0:ni.loader),visible:Ft==="loading"})}return me.createElement("li",{tabIndex:0,ref:gt,className:pl(z,ur,ee==null?void 0:ee.toast,(t=C==null?void 0:C.classNames)==null?void 0:t.toast,ee==null?void 0:ee.default,ee==null?void 0:ee[Ft],(n=C==null?void 0:C.classNames)==null?void 0:n[Ft]),"data-sonner-toast":"","data-rich-colors":(i=C.richColors)!=null?i:F,"data-styled":!(C.jsx||C.unstyled||R),"data-mounted":ze,"data-promise":!!C.promise,"data-swiped":cn,"data-removed":$e,"data-visible":pt,"data-y-position":yn,"data-x-position":Bn,"data-index":P,"data-front":ot,"data-swiping":ke,"data-dismissible":gn,"data-type":Ft,"data-invert":x_,"data-swipe-out":Pt,"data-swipe-direction":qe,"data-expanded":!!(D||re&&ze),style:{"--index":P,"--toasts-before":P,"--z-index":M.length-P,"--offset":`${$e?wt:Gi.current}px`,"--initial-height":re?"auto":`${Le}px`,...W,...C.style},onDragEnd:()=>{je(!1),Pe(null),bt.current=null},onPointerDown:Sn=>{T_||!gn||(We.current=new Date,Rt(Gi.current),Sn.target.setPointerCapture(Sn.pointerId),Sn.target.tagName!=="BUTTON"&&(je(!0),bt.current={x:Sn.clientX,y:Sn.clientY}))},onPointerUp:()=>{var Sn,nr,ni,yo;if(Pt||!gn)return;bt.current=null;let _o=Number(((Sn=gt.current)==null?void 0:Sn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),wi=Number(((nr=gt.current)==null?void 0:nr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ju=new Date().getTime()-((ni=We.current)==null?void 0:ni.getTime()),bo=Te==="x"?_o:wi,Eo=Math.abs(bo)/Ju;if(Math.abs(bo)>=O2e||Eo>.11){Rt(Gi.current),(yo=C.onDismiss)==null||yo.call(C,C),st(Te==="x"?_o>0?"right":"left":wi>0?"down":"up"),Kl(),Dt(!0),ut(!1);return}je(!1),Pe(null)},onPointerMove:Sn=>{var nr,ni,yo,_o;if(!bt.current||!gn||((nr=window.getSelection())==null?void 0:nr.toString().length)>0)return;let wi=Sn.clientY-bt.current.y,Ju=Sn.clientX-bt.current.x,bo=(ni=e.swipeDirections)!=null?ni:k2e(ae);!Te&&(Math.abs(Ju)>1||Math.abs(wi)>1)&&Pe(Math.abs(Ju)>Math.abs(wi)?"x":"y");let Eo={x:0,y:0};Te==="y"?(bo.includes("top")||bo.includes("bottom"))&&(bo.includes("top")&&wi<0||bo.includes("bottom")&&wi>0)&&(Eo.y=wi):Te==="x"&&(bo.includes("left")||bo.includes("right"))&&(bo.includes("left")&&Ju<0||bo.includes("right")&&Ju>0)&&(Eo.x=Ju),(Math.abs(Eo.x)>0||Math.abs(Eo.y)>0)&&ut(!0),(yo=gt.current)==null||yo.style.setProperty("--swipe-amount-x",`${Eo.x}px`),(_o=gt.current)==null||_o.style.setProperty("--swipe-amount-y",`${Eo.y}px`)}},xs&&!C.jsx?me.createElement("button",{"aria-label":xe,"data-disabled":T_,"data-close-button":!0,onClick:T_||!gn?()=>{}:()=>{var Sn;Kl(),(Sn=C.onDismiss)==null||Sn.call(C,C)},className:pl(ee==null?void 0:ee.closeButton,(o=C==null?void 0:C.classNames)==null?void 0:o.closeButton)},(u=de==null?void 0:de.close)!=null?u:v2e):null,C.jsx||w.isValidElement(C.title)?C.jsx?C.jsx:typeof C.title=="function"?C.title():C.title:me.createElement(me.Fragment,null,Ft||C.icon||C.promise?me.createElement("div",{"data-icon":"",className:pl(ee==null?void 0:ee.icon,(h=C==null?void 0:C.classNames)==null?void 0:h.icon)},C.promise||C.type==="loading"&&!C.icon?C.icon||Wf():null,C.type!=="loading"?C.icon||(de==null?void 0:de[Ft])||u2e(Ft):null):null,me.createElement("div",{"data-content":"",className:pl(ee==null?void 0:ee.content,(p=C==null?void 0:C.classNames)==null?void 0:p.content)},me.createElement("div",{"data-title":"",className:pl(ee==null?void 0:ee.title,(g=C==null?void 0:C.classNames)==null?void 0:g.title)},typeof C.title=="function"?C.title():C.title),C.description?me.createElement("div",{"data-description":"",className:pl(Z,ia,ee==null?void 0:ee.description,(v=C==null?void 0:C.classNames)==null?void 0:v.description)},typeof C.description=="function"?C.description():C.description):null),w.isValidElement(C.cancel)?C.cancel:C.cancel&&kC(C.cancel)?me.createElement("button",{"data-button":!0,"data-cancel":!0,style:C.cancelButtonStyle||q,onClick:Sn=>{var nr,ni;kC(C.cancel)&&gn&&((ni=(nr=C.cancel).onClick)==null||ni.call(nr,Sn),Kl())},className:pl(ee==null?void 0:ee.cancelButton,(b=C==null?void 0:C.classNames)==null?void 0:b.cancelButton)},C.cancel.label):null,w.isValidElement(C.action)?C.action:C.action&&kC(C.action)?me.createElement("button",{"data-button":!0,"data-action":!0,style:C.actionButtonStyle||Y,onClick:Sn=>{var nr,ni;kC(C.action)&&((ni=(nr=C.action).onClick)==null||ni.call(nr,Sn),!Sn.defaultPrevented&&Kl())},className:pl(ee==null?void 0:ee.actionButton,(E=C==null?void 0:C.classNames)==null?void 0:E.actionButton)},C.action.label):null))};function lZ(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function D2e(e,t){let n={};return[e,t].forEach((i,o)=>{let u=o===1,h=u?"--mobile-offset":"--offset",p=u?N2e:R2e;function g(v){["top","right","bottom","left"].forEach(b=>{n[`${h}-${b}`]=typeof v=="number"?`${v}px`:v})}typeof i=="number"||typeof i=="string"?g(i):typeof i=="object"?["top","right","bottom","left"].forEach(v=>{i[v]===void 0?n[`${h}-${v}`]=p:n[`${h}-${v}`]=typeof i[v]=="number"?`${i[v]}px`:i[v]}):g(p)}),n}var L2e=w.forwardRef(function(e,t){let{invert:n,position:i="bottom-right",hotkey:o=["altKey","KeyT"],expand:u,closeButton:h,className:p,offset:g,mobileOffset:v,theme:b="light",richColors:E,duration:T,style:C,visibleToasts:R=C2e,toastOptions:N,dir:O=lZ(),gap:j=I2e,loadingIcon:k,icons:P,containerAriaLabel:M="Notifications",pauseWhenPageIsHidden:D}=e,[U,F]=me.useState([]),H=me.useMemo(()=>Array.from(new Set([i].concat(U.filter(ve=>ve.position).map(ve=>ve.position)))),[U,i]),[W,q]=me.useState([]),[Y,z]=me.useState(!1),[Z,X]=me.useState(!1),[ae,se]=me.useState(b!=="system"?b:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),J=me.useRef(null),re=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),ee=me.useRef(null),de=me.useRef(!1),xe=me.useCallback(ve=>{F(Te=>{var Pe;return(Pe=Te.find(qe=>qe.id===ve.id))!=null&&Pe.delete||so.dismiss(ve.id),Te.filter(({id:qe})=>qe!==ve.id)})},[]);return me.useEffect(()=>so.subscribe(ve=>{if(ve.dismiss){F(Te=>Te.map(Pe=>Pe.id===ve.id?{...Pe,delete:!0}:Pe));return}setTimeout(()=>{Ooe.flushSync(()=>{F(Te=>{let Pe=Te.findIndex(qe=>qe.id===ve.id);return Pe!==-1?[...Te.slice(0,Pe),{...Te[Pe],...ve},...Te.slice(Pe+1)]:[ve,...Te]})})})}),[]),me.useEffect(()=>{if(b!=="system"){se(b);return}if(b==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?se("dark"):se("light")),typeof window>"u")return;let ve=window.matchMedia("(prefers-color-scheme: dark)");try{ve.addEventListener("change",({matches:Te})=>{se(Te?"dark":"light")})}catch{ve.addListener(({matches:Pe})=>{try{se(Pe?"dark":"light")}catch(qe){console.error(qe)}})}},[b]),me.useEffect(()=>{U.length<=1&&z(!1)},[U]),me.useEffect(()=>{let ve=Te=>{var Pe,qe;o.every(st=>Te[st]||Te.code===st)&&(z(!0),(Pe=J.current)==null||Pe.focus()),Te.code==="Escape"&&(document.activeElement===J.current||(qe=J.current)!=null&&qe.contains(document.activeElement))&&z(!1)};return document.addEventListener("keydown",ve),()=>document.removeEventListener("keydown",ve)},[o]),me.useEffect(()=>{if(J.current)return()=>{ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null,de.current=!1)}},[J.current]),me.createElement("section",{ref:t,"aria-label":`${M} ${re}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},H.map((ve,Te)=>{var Pe;let[qe,st]=ve.split("-");return U.length?me.createElement("ol",{key:ve,dir:O==="auto"?lZ():O,tabIndex:-1,ref:J,className:p,"data-sonner-toaster":!0,"data-theme":ae,"data-y-position":qe,"data-lifted":Y&&U.length>1&&!u,"data-x-position":st,style:{"--front-toast-height":`${((Pe=W[0])==null?void 0:Pe.height)||0}px`,"--width":`${A2e}px`,"--gap":`${j}px`,...C,...D2e(g,v)},onBlur:ze=>{de.current&&!ze.currentTarget.contains(ze.relatedTarget)&&(de.current=!1,ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null))},onFocus:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||de.current||(de.current=!0,ee.current=ze.relatedTarget)},onMouseEnter:()=>z(!0),onMouseMove:()=>z(!0),onMouseLeave:()=>{Z||z(!1)},onDragEnd:()=>z(!1),onPointerDown:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||X(!0)},onPointerUp:()=>X(!1)},U.filter(ze=>!ze.position&&Te===0||ze.position===ve).map((ze,ft)=>{var $e,at;return me.createElement(j2e,{key:ze.id,icons:P,index:ft,toast:ze,defaultRichColors:E,duration:($e=N==null?void 0:N.duration)!=null?$e:T,className:N==null?void 0:N.className,descriptionClassName:N==null?void 0:N.descriptionClassName,invert:n,visibleToasts:R,closeButton:(at=N==null?void 0:N.closeButton)!=null?at:h,interacting:Z,position:ve,style:N==null?void 0:N.style,unstyled:N==null?void 0:N.unstyled,classNames:N==null?void 0:N.classNames,cancelButtonStyle:N==null?void 0:N.cancelButtonStyle,actionButtonStyle:N==null?void 0:N.actionButtonStyle,removeToast:xe,toasts:U.filter(ke=>ke.position==ze.position),heights:W.filter(ke=>ke.position==ze.position),setHeights:q,expandByDefault:u,gap:j,loadingIcon:k,expanded:Y,pauseWhenPageIsHidden:D,swipeDirections:e.swipeDirections})})):null}))});function Tt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function uZ(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function g1(...e){return t=>{let n=!1;const i=e.map(o=>{const u=uZ(o,t);return!n&&typeof u=="function"&&(n=!0),u});if(n)return()=>{for(let o=0;o<i.length;o++){const u=i[o];typeof u=="function"?u():uZ(e[o],null)}}}}function Dn(...e){return w.useCallback(g1(...e),e)}function M2e(e,t){const n=w.createContext(t),i=u=>{const{children:h,...p}=u,g=w.useMemo(()=>p,Object.values(p));return c.jsx(n.Provider,{value:g,children:h})};i.displayName=e+"Provider";function o(u){const h=w.useContext(n);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${u}\` must be used within \`${e}\``)}return[i,o]}function Fs(e,t=[]){let n=[];function i(u,h){const p=w.createContext(h),g=n.length;n=[...n,h];const v=E=>{var j;const{scope:T,children:C,...R}=E,N=((j=T==null?void 0:T[e])==null?void 0:j[g])||p,O=w.useMemo(()=>R,Object.values(R));return c.jsx(N.Provider,{value:O,children:C})};v.displayName=u+"Provider";function b(E,T){var N;const C=((N=T==null?void 0:T[e])==null?void 0:N[g])||p,R=w.useContext(C);if(R)return R;if(h!==void 0)return h;throw new Error(`\`${E}\` must be used within \`${u}\``)}return[v,b]}const o=()=>{const u=n.map(h=>w.createContext(h));return function(p){const g=(p==null?void 0:p[e])||u;return w.useMemo(()=>({[`__scope${e}`]:{...p,[e]:g}}),[p,g])}};return o.scopeName=e,[i,U2e(o,...t)]}function U2e(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(u){const h=i.reduce((p,{useScope:g,scopeName:v})=>{const E=g(u)[`__scope${v}`];return{...p,...E}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return n.scopeName=t.scopeName,n}function yf(e){const t=F2e(e),n=w.forwardRef((i,o)=>{const{children:u,...h}=i,p=w.Children.toArray(u),g=p.find(B2e);if(g){const v=g.props.children,b=p.map(E=>E===g?w.Children.count(v)>1?w.Children.only(null):w.isValidElement(v)?v.props.children:null:E);return c.jsx(t,{...h,ref:o,children:w.isValidElement(v)?w.cloneElement(v,void 0,b):null})}return c.jsx(t,{...h,ref:o,children:u})});return n.displayName=`${e}.Slot`,n}var koe=yf("Slot");function F2e(e){const t=w.forwardRef((n,i)=>{const{children:o,...u}=n;if(w.isValidElement(o)){const h=W2e(o),p=$2e(u,o.props);return o.type!==w.Fragment&&(p.ref=i?g1(i,h):h),w.cloneElement(o,p)}return w.Children.count(o)>1?w.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var joe=Symbol("radix.slottable");function V2e(e){const t=({children:n})=>c.jsx(c.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=joe,t}function B2e(e){return w.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===joe}function $2e(e,t){const n={...t};for(const i in t){const o=e[i],u=t[i];/^on[A-Z]/.test(i)?o&&u?n[i]=(...p)=>{const g=u(...p);return o(...p),g}:o&&(n[i]=o):i==="style"?n[i]={...o,...u}:i==="className"&&(n[i]=[o,u].filter(Boolean).join(" "))}return{...e,...n}}function W2e(e){var i,o;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var G2e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Qt=G2e.reduce((e,t)=>{const n=yf(`Primitive.${t}`),i=w.forwardRef((o,u)=>{const{asChild:h,...p}=o,g=h?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(g,{...p,ref:u})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function Doe(e,t){e&&Af.flushSync(()=>e.dispatchEvent(t))}function Ba(e){const t=w.useRef(e);return w.useEffect(()=>{t.current=e}),w.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function H2e(e,t=globalThis==null?void 0:globalThis.document){const n=Ba(e);w.useEffect(()=>{const i=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var z2e="DismissableLayer",nU="dismissableLayer.update",K2e="dismissableLayer.pointerDownOutside",q2e="dismissableLayer.focusOutside",dZ,Loe=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Gy=w.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:u,onInteractOutside:h,onDismiss:p,...g}=e,v=w.useContext(Loe),[b,E]=w.useState(null),T=(b==null?void 0:b.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,C]=w.useState({}),R=Dn(t,F=>E(F)),N=Array.from(v.layers),[O]=[...v.layersWithOutsidePointerEventsDisabled].slice(-1),j=N.indexOf(O),k=b?N.indexOf(b):-1,P=v.layersWithOutsidePointerEventsDisabled.size>0,M=k>=j,D=J2e(F=>{const H=F.target,W=[...v.branches].some(q=>q.contains(H));!M||W||(o==null||o(F),h==null||h(F),F.defaultPrevented||p==null||p())},T),U=Z2e(F=>{const H=F.target;[...v.branches].some(q=>q.contains(H))||(u==null||u(F),h==null||h(F),F.defaultPrevented||p==null||p())},T);return H2e(F=>{k===v.layers.size-1&&(i==null||i(F),!F.defaultPrevented&&p&&(F.preventDefault(),p()))},T),w.useEffect(()=>{if(b)return n&&(v.layersWithOutsidePointerEventsDisabled.size===0&&(dZ=T.body.style.pointerEvents,T.body.style.pointerEvents="none"),v.layersWithOutsidePointerEventsDisabled.add(b)),v.layers.add(b),hZ(),()=>{n&&v.layersWithOutsidePointerEventsDisabled.size===1&&(T.body.style.pointerEvents=dZ)}},[b,T,n,v]),w.useEffect(()=>()=>{b&&(v.layers.delete(b),v.layersWithOutsidePointerEventsDisabled.delete(b),hZ())},[b,v]),w.useEffect(()=>{const F=()=>C({});return document.addEventListener(nU,F),()=>document.removeEventListener(nU,F)},[]),c.jsx(Qt.div,{...g,ref:R,style:{pointerEvents:P?M?"auto":"none":void 0,...e.style},onFocusCapture:Tt(e.onFocusCapture,U.onFocusCapture),onBlurCapture:Tt(e.onBlurCapture,U.onBlurCapture),onPointerDownCapture:Tt(e.onPointerDownCapture,D.onPointerDownCapture)})});Gy.displayName=z2e;var Y2e="DismissableLayerBranch",X2e=w.forwardRef((e,t)=>{const n=w.useContext(Loe),i=w.useRef(null),o=Dn(t,i);return w.useEffect(()=>{const u=i.current;if(u)return n.branches.add(u),()=>{n.branches.delete(u)}},[n.branches]),c.jsx(Qt.div,{...e,ref:o})});X2e.displayName=Y2e;function J2e(e,t=globalThis==null?void 0:globalThis.document){const n=Ba(e),i=w.useRef(!1),o=w.useRef(()=>{});return w.useEffect(()=>{const u=p=>{if(p.target&&!i.current){let g=function(){Moe(K2e,n,v,{discrete:!0})};const v={originalEvent:p};p.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=g,t.addEventListener("click",o.current,{once:!0})):g()}else t.removeEventListener("click",o.current);i.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",u),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function Z2e(e,t=globalThis==null?void 0:globalThis.document){const n=Ba(e),i=w.useRef(!1);return w.useEffect(()=>{const o=u=>{u.target&&!i.current&&Moe(q2e,n,{originalEvent:u},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function hZ(){const e=new CustomEvent(nU);document.dispatchEvent(e)}function Moe(e,t,n,{discrete:i}){const o=n.originalEvent.target,u=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?Doe(o,u):o.dispatchEvent(u)}var va=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},Q2e=s0[" useId ".trim().toString()]||(()=>{}),eLe=0;function Ll(e){const[t,n]=w.useState(Q2e());return va(()=>{n(i=>i??String(eLe++))},[e]),t?`radix-${t}`:""}const tLe=["top","right","bottom","left"],_f=Math.min,Fo=Math.max,SN=Math.round,jC=Math.floor,ku=e=>({x:e,y:e}),nLe={left:"right",right:"left",bottom:"top",top:"bottom"},rLe={start:"end",end:"start"};function rU(e,t,n){return Fo(e,_f(t,n))}function Fd(e,t){return typeof e=="function"?e(t):e}function Vd(e){return e.split("-")[0]}function Hy(e){return e.split("-")[1]}function u4(e){return e==="x"?"y":"x"}function d4(e){return e==="y"?"height":"width"}const iLe=new Set(["top","bottom"]);function Nu(e){return iLe.has(Vd(e))?"y":"x"}function h4(e){return u4(Nu(e))}function aLe(e,t,n){n===void 0&&(n=!1);const i=Hy(e),o=h4(e),u=d4(o);let h=o==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[u]>t.floating[u]&&(h=xN(h)),[h,xN(h)]}function sLe(e){const t=xN(e);return[iU(e),t,iU(t)]}function iU(e){return e.replace(/start|end/g,t=>rLe[t])}const fZ=["left","right"],pZ=["right","left"],oLe=["top","bottom"],cLe=["bottom","top"];function lLe(e,t,n){switch(e){case"top":case"bottom":return n?t?pZ:fZ:t?fZ:pZ;case"left":case"right":return t?oLe:cLe;default:return[]}}function uLe(e,t,n,i){const o=Hy(e);let u=lLe(Vd(e),n==="start",i);return o&&(u=u.map(h=>h+"-"+o),t&&(u=u.concat(u.map(iU)))),u}function xN(e){return e.replace(/left|right|bottom|top/g,t=>nLe[t])}function dLe(e){return{top:0,right:0,bottom:0,left:0,...e}}function Uoe(e){return typeof e!="number"?dLe(e):{top:e,right:e,bottom:e,left:e}}function TN(e){const{x:t,y:n,width:i,height:o}=e;return{width:i,height:o,top:n,left:t,right:t+i,bottom:n+o,x:t,y:n}}function mZ(e,t,n){let{reference:i,floating:o}=e;const u=Nu(t),h=h4(t),p=d4(h),g=Vd(t),v=u==="y",b=i.x+i.width/2-o.width/2,E=i.y+i.height/2-o.height/2,T=i[p]/2-o[p]/2;let C;switch(g){case"top":C={x:b,y:i.y-o.height};break;case"bottom":C={x:b,y:i.y+i.height};break;case"right":C={x:i.x+i.width,y:E};break;case"left":C={x:i.x-o.width,y:E};break;default:C={x:i.x,y:i.y}}switch(Hy(t)){case"start":C[h]-=T*(n&&v?-1:1);break;case"end":C[h]+=T*(n&&v?-1:1);break}return C}const hLe=async(e,t,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:u=[],platform:h}=n,p=u.filter(Boolean),g=await(h.isRTL==null?void 0:h.isRTL(t));let v=await h.getElementRects({reference:e,floating:t,strategy:o}),{x:b,y:E}=mZ(v,i,g),T=i,C={},R=0;for(let N=0;N<p.length;N++){const{name:O,fn:j}=p[N],{x:k,y:P,data:M,reset:D}=await j({x:b,y:E,initialPlacement:i,placement:T,strategy:o,middlewareData:C,rects:v,platform:h,elements:{reference:e,floating:t}});b=k??b,E=P??E,C={...C,[O]:{...C[O],...M}},D&&R<=50&&(R++,typeof D=="object"&&(D.placement&&(T=D.placement),D.rects&&(v=D.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:o}):D.rects),{x:b,y:E}=mZ(v,T,g)),N=-1)}return{x:b,y:E,placement:T,strategy:o,middlewareData:C}};async function x0(e,t){var n;t===void 0&&(t={});const{x:i,y:o,platform:u,rects:h,elements:p,strategy:g}=e,{boundary:v="clippingAncestors",rootBoundary:b="viewport",elementContext:E="floating",altBoundary:T=!1,padding:C=0}=Fd(t,e),R=Uoe(C),O=p[T?E==="floating"?"reference":"floating":E],j=TN(await u.getClippingRect({element:(n=await(u.isElement==null?void 0:u.isElement(O)))==null||n?O:O.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(p.floating)),boundary:v,rootBoundary:b,strategy:g})),k=E==="floating"?{x:i,y:o,width:h.floating.width,height:h.floating.height}:h.reference,P=await(u.getOffsetParent==null?void 0:u.getOffsetParent(p.floating)),M=await(u.isElement==null?void 0:u.isElement(P))?await(u.getScale==null?void 0:u.getScale(P))||{x:1,y:1}:{x:1,y:1},D=TN(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:p,rect:k,offsetParent:P,strategy:g}):k);return{top:(j.top-D.top+R.top)/M.y,bottom:(D.bottom-j.bottom+R.bottom)/M.y,left:(j.left-D.left+R.left)/M.x,right:(D.right-j.right+R.right)/M.x}}const fLe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:o,rects:u,platform:h,elements:p,middlewareData:g}=t,{element:v,padding:b=0}=Fd(e,t)||{};if(v==null)return{};const E=Uoe(b),T={x:n,y:i},C=h4(o),R=d4(C),N=await h.getDimensions(v),O=C==="y",j=O?"top":"left",k=O?"bottom":"right",P=O?"clientHeight":"clientWidth",M=u.reference[R]+u.reference[C]-T[C]-u.floating[R],D=T[C]-u.reference[C],U=await(h.getOffsetParent==null?void 0:h.getOffsetParent(v));let F=U?U[P]:0;(!F||!await(h.isElement==null?void 0:h.isElement(U)))&&(F=p.floating[P]||u.floating[R]);const H=M/2-D/2,W=F/2-N[R]/2-1,q=_f(E[j],W),Y=_f(E[k],W),z=q,Z=F-N[R]-Y,X=F/2-N[R]/2+H,ae=rU(z,X,Z),se=!g.arrow&&Hy(o)!=null&&X!==ae&&u.reference[R]/2-(X<z?q:Y)-N[R]/2<0,J=se?X<z?X-z:X-Z:0;return{[C]:T[C]+J,data:{[C]:ae,centerOffset:X-ae-J,...se&&{alignmentOffset:J}},reset:se}}}),pLe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:o,middlewareData:u,rects:h,initialPlacement:p,platform:g,elements:v}=t,{mainAxis:b=!0,crossAxis:E=!0,fallbackPlacements:T,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:R="none",flipAlignment:N=!0,...O}=Fd(e,t);if((n=u.arrow)!=null&&n.alignmentOffset)return{};const j=Vd(o),k=Nu(p),P=Vd(p)===p,M=await(g.isRTL==null?void 0:g.isRTL(v.floating)),D=T||(P||!N?[xN(p)]:sLe(p)),U=R!=="none";!T&&U&&D.push(...uLe(p,N,R,M));const F=[p,...D],H=await x0(t,O),W=[];let q=((i=u.flip)==null?void 0:i.overflows)||[];if(b&&W.push(H[j]),E){const X=aLe(o,h,M);W.push(H[X[0]],H[X[1]])}if(q=[...q,{placement:o,overflows:W}],!W.every(X=>X<=0)){var Y,z;const X=(((Y=u.flip)==null?void 0:Y.index)||0)+1,ae=F[X];if(ae&&(!(E==="alignment"?k!==Nu(ae):!1)||q.every(re=>re.overflows[0]>0&&Nu(re.placement)===k)))return{data:{index:X,overflows:q},reset:{placement:ae}};let se=(z=q.filter(J=>J.overflows[0]<=0).sort((J,re)=>J.overflows[1]-re.overflows[1])[0])==null?void 0:z.placement;if(!se)switch(C){case"bestFit":{var Z;const J=(Z=q.filter(re=>{if(U){const ee=Nu(re.placement);return ee===k||ee==="y"}return!0}).map(re=>[re.placement,re.overflows.filter(ee=>ee>0).reduce((ee,de)=>ee+de,0)]).sort((re,ee)=>re[1]-ee[1])[0])==null?void 0:Z[0];J&&(se=J);break}case"initialPlacement":se=p;break}if(o!==se)return{reset:{placement:se}}}return{}}}};function gZ(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function vZ(e){return tLe.some(t=>e[t]>=0)}const mLe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...o}=Fd(e,t);switch(i){case"referenceHidden":{const u=await x0(t,{...o,elementContext:"reference"}),h=gZ(u,n.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:vZ(h)}}}case"escaped":{const u=await x0(t,{...o,altBoundary:!0}),h=gZ(u,n.floating);return{data:{escapedOffsets:h,escaped:vZ(h)}}}default:return{}}}}},Foe=new Set(["left","top"]);async function gLe(e,t){const{placement:n,platform:i,elements:o}=e,u=await(i.isRTL==null?void 0:i.isRTL(o.floating)),h=Vd(n),p=Hy(n),g=Nu(n)==="y",v=Foe.has(h)?-1:1,b=u&&g?-1:1,E=Fd(t,e);let{mainAxis:T,crossAxis:C,alignmentAxis:R}=typeof E=="number"?{mainAxis:E,crossAxis:0,alignmentAxis:null}:{mainAxis:E.mainAxis||0,crossAxis:E.crossAxis||0,alignmentAxis:E.alignmentAxis};return p&&typeof R=="number"&&(C=p==="end"?R*-1:R),g?{x:C*b,y:T*v}:{x:T*v,y:C*b}}const vLe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:o,y:u,placement:h,middlewareData:p}=t,g=await gLe(t,e);return h===((n=p.offset)==null?void 0:n.placement)&&(i=p.arrow)!=null&&i.alignmentOffset?{}:{x:o+g.x,y:u+g.y,data:{...g,placement:h}}}}},yLe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:o}=t,{mainAxis:u=!0,crossAxis:h=!1,limiter:p={fn:O=>{let{x:j,y:k}=O;return{x:j,y:k}}},...g}=Fd(e,t),v={x:n,y:i},b=await x0(t,g),E=Nu(Vd(o)),T=u4(E);let C=v[T],R=v[E];if(u){const O=T==="y"?"top":"left",j=T==="y"?"bottom":"right",k=C+b[O],P=C-b[j];C=rU(k,C,P)}if(h){const O=E==="y"?"top":"left",j=E==="y"?"bottom":"right",k=R+b[O],P=R-b[j];R=rU(k,R,P)}const N=p.fn({...t,[T]:C,[E]:R});return{...N,data:{x:N.x-n,y:N.y-i,enabled:{[T]:u,[E]:h}}}}}},_Le=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:o,rects:u,middlewareData:h}=t,{offset:p=0,mainAxis:g=!0,crossAxis:v=!0}=Fd(e,t),b={x:n,y:i},E=Nu(o),T=u4(E);let C=b[T],R=b[E];const N=Fd(p,t),O=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(g){const P=T==="y"?"height":"width",M=u.reference[T]-u.floating[P]+O.mainAxis,D=u.reference[T]+u.reference[P]-O.mainAxis;C<M?C=M:C>D&&(C=D)}if(v){var j,k;const P=T==="y"?"width":"height",M=Foe.has(Vd(o)),D=u.reference[E]-u.floating[P]+(M&&((j=h.offset)==null?void 0:j[E])||0)+(M?0:O.crossAxis),U=u.reference[E]+u.reference[P]+(M?0:((k=h.offset)==null?void 0:k[E])||0)-(M?O.crossAxis:0);R<D?R=D:R>U&&(R=U)}return{[T]:C,[E]:R}}}},bLe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:o,rects:u,platform:h,elements:p}=t,{apply:g=()=>{},...v}=Fd(e,t),b=await x0(t,v),E=Vd(o),T=Hy(o),C=Nu(o)==="y",{width:R,height:N}=u.floating;let O,j;E==="top"||E==="bottom"?(O=E,j=T===(await(h.isRTL==null?void 0:h.isRTL(p.floating))?"start":"end")?"left":"right"):(j=E,O=T==="end"?"top":"bottom");const k=N-b.top-b.bottom,P=R-b.left-b.right,M=_f(N-b[O],k),D=_f(R-b[j],P),U=!t.middlewareData.shift;let F=M,H=D;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(H=P),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(F=k),U&&!T){const q=Fo(b.left,0),Y=Fo(b.right,0),z=Fo(b.top,0),Z=Fo(b.bottom,0);C?H=R-2*(q!==0||Y!==0?q+Y:Fo(b.left,b.right)):F=N-2*(z!==0||Z!==0?z+Z:Fo(b.top,b.bottom))}await g({...t,availableWidth:H,availableHeight:F});const W=await h.getDimensions(p.floating);return R!==W.width||N!==W.height?{reset:{rects:!0}}:{}}}};function v1(){return typeof window<"u"}function zy(e){return Voe(e)?(e.nodeName||"").toLowerCase():"#document"}function Go(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Gu(e){var t;return(t=(Voe(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Voe(e){return v1()?e instanceof Node||e instanceof Go(e).Node:!1}function Fl(e){return v1()?e instanceof Element||e instanceof Go(e).Element:!1}function Fu(e){return v1()?e instanceof HTMLElement||e instanceof Go(e).HTMLElement:!1}function yZ(e){return!v1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Go(e).ShadowRoot}const ELe=new Set(["inline","contents"]);function Lw(e){const{overflow:t,overflowX:n,overflowY:i,display:o}=Vl(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!ELe.has(o)}const wLe=new Set(["table","td","th"]);function SLe(e){return wLe.has(zy(e))}const xLe=[":popover-open",":modal"];function y1(e){return xLe.some(t=>{try{return e.matches(t)}catch{return!1}})}const TLe=["transform","translate","scale","rotate","perspective"],CLe=["transform","translate","scale","rotate","perspective","filter"],RLe=["paint","layout","strict","content"];function f4(e){const t=p4(),n=Fl(e)?Vl(e):e;return TLe.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||CLe.some(i=>(n.willChange||"").includes(i))||RLe.some(i=>(n.contain||"").includes(i))}function NLe(e){let t=bf(e);for(;Fu(t)&&!sy(t);){if(f4(t))return t;if(y1(t))return null;t=bf(t)}return null}function p4(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const ALe=new Set(["html","body","#document"]);function sy(e){return ALe.has(zy(e))}function Vl(e){return Go(e).getComputedStyle(e)}function _1(e){return Fl(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function bf(e){if(zy(e)==="html")return e;const t=e.assignedSlot||e.parentNode||yZ(e)&&e.host||Gu(e);return yZ(t)?t.host:t}function Boe(e){const t=bf(e);return sy(t)?e.ownerDocument?e.ownerDocument.body:e.body:Fu(t)&&Lw(t)?t:Boe(t)}function T0(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=Boe(e),u=o===((i=e.ownerDocument)==null?void 0:i.body),h=Go(o);if(u){const p=aU(h);return t.concat(h,h.visualViewport||[],Lw(o)?o:[],p&&n?T0(p):[])}return t.concat(o,T0(o,[],n))}function aU(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function $oe(e){const t=Vl(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const o=Fu(e),u=o?e.offsetWidth:n,h=o?e.offsetHeight:i,p=SN(n)!==u||SN(i)!==h;return p&&(n=u,i=h),{width:n,height:i,$:p}}function m4(e){return Fl(e)?e:e.contextElement}function Mv(e){const t=m4(e);if(!Fu(t))return ku(1);const n=t.getBoundingClientRect(),{width:i,height:o,$:u}=$oe(t);let h=(u?SN(n.width):n.width)/i,p=(u?SN(n.height):n.height)/o;return(!h||!Number.isFinite(h))&&(h=1),(!p||!Number.isFinite(p))&&(p=1),{x:h,y:p}}const ILe=ku(0);function Woe(e){const t=Go(e);return!p4()||!t.visualViewport?ILe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function OLe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Go(e)?!1:t}function om(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),u=m4(e);let h=ku(1);t&&(i?Fl(i)&&(h=Mv(i)):h=Mv(e));const p=OLe(u,n,i)?Woe(u):ku(0);let g=(o.left+p.x)/h.x,v=(o.top+p.y)/h.y,b=o.width/h.x,E=o.height/h.y;if(u){const T=Go(u),C=i&&Fl(i)?Go(i):i;let R=T,N=aU(R);for(;N&&i&&C!==R;){const O=Mv(N),j=N.getBoundingClientRect(),k=Vl(N),P=j.left+(N.clientLeft+parseFloat(k.paddingLeft))*O.x,M=j.top+(N.clientTop+parseFloat(k.paddingTop))*O.y;g*=O.x,v*=O.y,b*=O.x,E*=O.y,g+=P,v+=M,R=Go(N),N=aU(R)}}return TN({width:b,height:E,x:g,y:v})}function g4(e,t){const n=_1(e).scrollLeft;return t?t.left+n:om(Gu(e)).left+n}function Goe(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),o=i.left+t.scrollLeft-(n?0:g4(e,i)),u=i.top+t.scrollTop;return{x:o,y:u}}function PLe(e){let{elements:t,rect:n,offsetParent:i,strategy:o}=e;const u=o==="fixed",h=Gu(i),p=t?y1(t.floating):!1;if(i===h||p&&u)return n;let g={scrollLeft:0,scrollTop:0},v=ku(1);const b=ku(0),E=Fu(i);if((E||!E&&!u)&&((zy(i)!=="body"||Lw(h))&&(g=_1(i)),Fu(i))){const C=om(i);v=Mv(i),b.x=C.x+i.clientLeft,b.y=C.y+i.clientTop}const T=h&&!E&&!u?Goe(h,g,!0):ku(0);return{width:n.width*v.x,height:n.height*v.y,x:n.x*v.x-g.scrollLeft*v.x+b.x+T.x,y:n.y*v.y-g.scrollTop*v.y+b.y+T.y}}function kLe(e){return Array.from(e.getClientRects())}function jLe(e){const t=Gu(e),n=_1(e),i=e.ownerDocument.body,o=Fo(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),u=Fo(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let h=-n.scrollLeft+g4(e);const p=-n.scrollTop;return Vl(i).direction==="rtl"&&(h+=Fo(t.clientWidth,i.clientWidth)-o),{width:o,height:u,x:h,y:p}}function DLe(e,t){const n=Go(e),i=Gu(e),o=n.visualViewport;let u=i.clientWidth,h=i.clientHeight,p=0,g=0;if(o){u=o.width,h=o.height;const v=p4();(!v||v&&t==="fixed")&&(p=o.offsetLeft,g=o.offsetTop)}return{width:u,height:h,x:p,y:g}}const LLe=new Set(["absolute","fixed"]);function MLe(e,t){const n=om(e,!0,t==="fixed"),i=n.top+e.clientTop,o=n.left+e.clientLeft,u=Fu(e)?Mv(e):ku(1),h=e.clientWidth*u.x,p=e.clientHeight*u.y,g=o*u.x,v=i*u.y;return{width:h,height:p,x:g,y:v}}function _Z(e,t,n){let i;if(t==="viewport")i=DLe(e,n);else if(t==="document")i=jLe(Gu(e));else if(Fl(t))i=MLe(t,n);else{const o=Woe(e);i={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return TN(i)}function Hoe(e,t){const n=bf(e);return n===t||!Fl(n)||sy(n)?!1:Vl(n).position==="fixed"||Hoe(n,t)}function ULe(e,t){const n=t.get(e);if(n)return n;let i=T0(e,[],!1).filter(p=>Fl(p)&&zy(p)!=="body"),o=null;const u=Vl(e).position==="fixed";let h=u?bf(e):e;for(;Fl(h)&&!sy(h);){const p=Vl(h),g=f4(h);!g&&p.position==="fixed"&&(o=null),(u?!g&&!o:!g&&p.position==="static"&&!!o&&LLe.has(o.position)||Lw(h)&&!g&&Hoe(e,h))?i=i.filter(b=>b!==h):o=p,h=bf(h)}return t.set(e,i),i}function FLe(e){let{element:t,boundary:n,rootBoundary:i,strategy:o}=e;const h=[...n==="clippingAncestors"?y1(t)?[]:ULe(t,this._c):[].concat(n),i],p=h[0],g=h.reduce((v,b)=>{const E=_Z(t,b,o);return v.top=Fo(E.top,v.top),v.right=_f(E.right,v.right),v.bottom=_f(E.bottom,v.bottom),v.left=Fo(E.left,v.left),v},_Z(t,p,o));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function VLe(e){const{width:t,height:n}=$oe(e);return{width:t,height:n}}function BLe(e,t,n){const i=Fu(t),o=Gu(t),u=n==="fixed",h=om(e,!0,u,t);let p={scrollLeft:0,scrollTop:0};const g=ku(0);function v(){g.x=g4(o)}if(i||!i&&!u)if((zy(t)!=="body"||Lw(o))&&(p=_1(t)),i){const C=om(t,!0,u,t);g.x=C.x+t.clientLeft,g.y=C.y+t.clientTop}else o&&v();u&&!i&&o&&v();const b=o&&!i&&!u?Goe(o,p):ku(0),E=h.left+p.scrollLeft-g.x-b.x,T=h.top+p.scrollTop-g.y-b.y;return{x:E,y:T,width:h.width,height:h.height}}function K2(e){return Vl(e).position==="static"}function bZ(e,t){if(!Fu(e)||Vl(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Gu(e)===n&&(n=n.ownerDocument.body),n}function zoe(e,t){const n=Go(e);if(y1(e))return n;if(!Fu(e)){let o=bf(e);for(;o&&!sy(o);){if(Fl(o)&&!K2(o))return o;o=bf(o)}return n}let i=bZ(e,t);for(;i&&SLe(i)&&K2(i);)i=bZ(i,t);return i&&sy(i)&&K2(i)&&!f4(i)?n:i||NLe(e)||n}const $Le=async function(e){const t=this.getOffsetParent||zoe,n=this.getDimensions,i=await n(e.floating);return{reference:BLe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function WLe(e){return Vl(e).direction==="rtl"}const GLe={convertOffsetParentRelativeRectToViewportRelativeRect:PLe,getDocumentElement:Gu,getClippingRect:FLe,getOffsetParent:zoe,getElementRects:$Le,getClientRects:kLe,getDimensions:VLe,getScale:Mv,isElement:Fl,isRTL:WLe};function Koe(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function HLe(e,t){let n=null,i;const o=Gu(e);function u(){var p;clearTimeout(i),(p=n)==null||p.disconnect(),n=null}function h(p,g){p===void 0&&(p=!1),g===void 0&&(g=1),u();const v=e.getBoundingClientRect(),{left:b,top:E,width:T,height:C}=v;if(p||t(),!T||!C)return;const R=jC(E),N=jC(o.clientWidth-(b+T)),O=jC(o.clientHeight-(E+C)),j=jC(b),P={rootMargin:-R+"px "+-N+"px "+-O+"px "+-j+"px",threshold:Fo(0,_f(1,g))||1};let M=!0;function D(U){const F=U[0].intersectionRatio;if(F!==g){if(!M)return h();F?h(!1,F):i=setTimeout(()=>{h(!1,1e-7)},1e3)}F===1&&!Koe(v,e.getBoundingClientRect())&&h(),M=!1}try{n=new IntersectionObserver(D,{...P,root:o.ownerDocument})}catch{n=new IntersectionObserver(D,P)}n.observe(e)}return h(!0),u}function qoe(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:o=!0,ancestorResize:u=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:p=typeof IntersectionObserver=="function",animationFrame:g=!1}=i,v=m4(e),b=o||u?[...v?T0(v):[],...T0(t)]:[];b.forEach(j=>{o&&j.addEventListener("scroll",n,{passive:!0}),u&&j.addEventListener("resize",n)});const E=v&&p?HLe(v,n):null;let T=-1,C=null;h&&(C=new ResizeObserver(j=>{let[k]=j;k&&k.target===v&&C&&(C.unobserve(t),cancelAnimationFrame(T),T=requestAnimationFrame(()=>{var P;(P=C)==null||P.observe(t)})),n()}),v&&!g&&C.observe(v),C.observe(t));let R,N=g?om(e):null;g&&O();function O(){const j=om(e);N&&!Koe(N,j)&&n(),N=j,R=requestAnimationFrame(O)}return n(),()=>{var j;b.forEach(k=>{o&&k.removeEventListener("scroll",n),u&&k.removeEventListener("resize",n)}),E==null||E(),(j=C)==null||j.disconnect(),C=null,g&&cancelAnimationFrame(R)}}const zLe=vLe,KLe=yLe,qLe=pLe,YLe=bLe,XLe=mLe,EZ=fLe,JLe=_Le,ZLe=(e,t,n)=>{const i=new Map,o={platform:GLe,...n},u={...o.platform,_c:i};return hLe(e,t,{...o,platform:u})};var QLe=typeof document<"u",eMe=function(){},MR=QLe?w.useLayoutEffect:eMe;function CN(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!CN(e[i],t[i]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,o[i]))return!1;for(i=n;i--!==0;){const u=o[i];if(!(u==="_owner"&&e.$$typeof)&&!CN(e[u],t[u]))return!1}return!0}return e!==e&&t!==t}function Yoe(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function wZ(e,t){const n=Yoe(e);return Math.round(t*n)/n}function q2(e){const t=w.useRef(e);return MR(()=>{t.current=e}),t}function tMe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:o,elements:{reference:u,floating:h}={},transform:p=!0,whileElementsMounted:g,open:v}=e,[b,E]=w.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[T,C]=w.useState(i);CN(T,i)||C(i);const[R,N]=w.useState(null),[O,j]=w.useState(null),k=w.useCallback(re=>{re!==U.current&&(U.current=re,N(re))},[]),P=w.useCallback(re=>{re!==F.current&&(F.current=re,j(re))},[]),M=u||R,D=h||O,U=w.useRef(null),F=w.useRef(null),H=w.useRef(b),W=g!=null,q=q2(g),Y=q2(o),z=q2(v),Z=w.useCallback(()=>{if(!U.current||!F.current)return;const re={placement:t,strategy:n,middleware:T};Y.current&&(re.platform=Y.current),ZLe(U.current,F.current,re).then(ee=>{const de={...ee,isPositioned:z.current!==!1};X.current&&!CN(H.current,de)&&(H.current=de,Af.flushSync(()=>{E(de)}))})},[T,t,n,Y,z]);MR(()=>{v===!1&&H.current.isPositioned&&(H.current.isPositioned=!1,E(re=>({...re,isPositioned:!1})))},[v]);const X=w.useRef(!1);MR(()=>(X.current=!0,()=>{X.current=!1}),[]),MR(()=>{if(M&&(U.current=M),D&&(F.current=D),M&&D){if(q.current)return q.current(M,D,Z);Z()}},[M,D,Z,q,W]);const ae=w.useMemo(()=>({reference:U,floating:F,setReference:k,setFloating:P}),[k,P]),se=w.useMemo(()=>({reference:M,floating:D}),[M,D]),J=w.useMemo(()=>{const re={position:n,left:0,top:0};if(!se.floating)return re;const ee=wZ(se.floating,b.x),de=wZ(se.floating,b.y);return p?{...re,transform:"translate("+ee+"px, "+de+"px)",...Yoe(se.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ee,top:de}},[n,p,se.floating,b.x,b.y]);return w.useMemo(()=>({...b,update:Z,refs:ae,elements:se,floatingStyles:J}),[b,Z,ae,se,J])}const nMe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:o}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?EZ({element:i.current,padding:o}).fn(n):{}:i?EZ({element:i,padding:o}).fn(n):{}}}},rMe=(e,t)=>({...zLe(e),options:[e,t]}),iMe=(e,t)=>({...KLe(e),options:[e,t]}),aMe=(e,t)=>({...JLe(e),options:[e,t]}),sMe=(e,t)=>({...qLe(e),options:[e,t]}),oMe=(e,t)=>({...YLe(e),options:[e,t]}),cMe=(e,t)=>({...XLe(e),options:[e,t]}),lMe=(e,t)=>({...nMe(e),options:[e,t]});var uMe="Arrow",Xoe=w.forwardRef((e,t)=>{const{children:n,width:i=10,height:o=5,...u}=e;return c.jsx(Qt.svg,{...u,ref:t,width:i,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});Xoe.displayName=uMe;var dMe=Xoe;function v4(e){const[t,n]=w.useState(void 0);return va(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const u=o[0];let h,p;if("borderBoxSize"in u){const g=u.borderBoxSize,v=Array.isArray(g)?g[0]:g;h=v.inlineSize,p=v.blockSize}else h=e.offsetWidth,p=e.offsetHeight;n({width:h,height:p})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var y4="Popper",[Joe,If]=Fs(y4),[hMe,Zoe]=Joe(y4),Qoe=e=>{const{__scopePopper:t,children:n}=e,[i,o]=w.useState(null);return c.jsx(hMe,{scope:t,anchor:i,onAnchorChange:o,children:n})};Qoe.displayName=y4;var ece="PopperAnchor",tce=w.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...o}=e,u=Zoe(ece,n),h=w.useRef(null),p=Dn(t,h);return w.useEffect(()=>{u.onAnchorChange((i==null?void 0:i.current)||h.current)}),i?null:c.jsx(Qt.div,{...o,ref:p})});tce.displayName=ece;var _4="PopperContent",[fMe,pMe]=Joe(_4),nce=w.forwardRef((e,t)=>{var ze,ft,$e,at,ke,je;const{__scopePopper:n,side:i="bottom",sideOffset:o=0,align:u="center",alignOffset:h=0,arrowPadding:p=0,avoidCollisions:g=!0,collisionBoundary:v=[],collisionPadding:b=0,sticky:E="partial",hideWhenDetached:T=!1,updatePositionStrategy:C="optimized",onPlaced:R,...N}=e,O=Zoe(_4,n),[j,k]=w.useState(null),P=Dn(t,Pt=>k(Pt)),[M,D]=w.useState(null),U=v4(M),F=(U==null?void 0:U.width)??0,H=(U==null?void 0:U.height)??0,W=i+(u!=="center"?"-"+u:""),q=typeof b=="number"?b:{top:0,right:0,bottom:0,left:0,...b},Y=Array.isArray(v)?v:[v],z=Y.length>0,Z={padding:q,boundary:Y.filter(gMe),altBoundary:z},{refs:X,floatingStyles:ae,placement:se,isPositioned:J,middlewareData:re}=tMe({strategy:"fixed",placement:W,whileElementsMounted:(...Pt)=>qoe(...Pt,{animationFrame:C==="always"}),elements:{reference:O.anchor},middleware:[rMe({mainAxis:o+H,alignmentAxis:h}),g&&iMe({mainAxis:!0,crossAxis:!1,limiter:E==="partial"?aMe():void 0,...Z}),g&&sMe({...Z}),oMe({...Z,apply:({elements:Pt,rects:Dt,availableWidth:cn,availableHeight:ut})=>{const{width:wt,height:Rt}=Dt.reference,Le=Pt.floating.style;Le.setProperty("--radix-popper-available-width",`${cn}px`),Le.setProperty("--radix-popper-available-height",`${ut}px`),Le.setProperty("--radix-popper-anchor-width",`${wt}px`),Le.setProperty("--radix-popper-anchor-height",`${Rt}px`)}}),M&&lMe({element:M,padding:p}),vMe({arrowWidth:F,arrowHeight:H}),T&&cMe({strategy:"referenceHidden",...Z})]}),[ee,de]=ace(se),xe=Ba(R);va(()=>{J&&(xe==null||xe())},[J,xe]);const ve=(ze=re.arrow)==null?void 0:ze.x,Te=(ft=re.arrow)==null?void 0:ft.y,Pe=(($e=re.arrow)==null?void 0:$e.centerOffset)!==0,[qe,st]=w.useState();return va(()=>{j&&st(window.getComputedStyle(j).zIndex)},[j]),c.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...ae,transform:J?ae.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:qe,"--radix-popper-transform-origin":[(at=re.transformOrigin)==null?void 0:at.x,(ke=re.transformOrigin)==null?void 0:ke.y].join(" "),...((je=re.hide)==null?void 0:je.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:c.jsx(fMe,{scope:n,placedSide:ee,onArrowChange:D,arrowX:ve,arrowY:Te,shouldHideArrow:Pe,children:c.jsx(Qt.div,{"data-side":ee,"data-align":de,...N,ref:P,style:{...N.style,animation:J?void 0:"none"}})})})});nce.displayName=_4;var rce="PopperArrow",mMe={top:"bottom",right:"left",bottom:"top",left:"right"},ice=w.forwardRef(function(t,n){const{__scopePopper:i,...o}=t,u=pMe(rce,i),h=mMe[u.placedSide];return c.jsx("span",{ref:u.onArrowChange,style:{position:"absolute",left:u.arrowX,top:u.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[u.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[u.placedSide],visibility:u.shouldHideArrow?"hidden":void 0},children:c.jsx(dMe,{...o,ref:n,style:{...o.style,display:"block"}})})});ice.displayName=rce;function gMe(e){return e!==null}var vMe=e=>({name:"transformOrigin",options:e,fn(t){var O,j,k;const{placement:n,rects:i,middlewareData:o}=t,h=((O=o.arrow)==null?void 0:O.centerOffset)!==0,p=h?0:e.arrowWidth,g=h?0:e.arrowHeight,[v,b]=ace(n),E={start:"0%",center:"50%",end:"100%"}[b],T=(((j=o.arrow)==null?void 0:j.x)??0)+p/2,C=(((k=o.arrow)==null?void 0:k.y)??0)+g/2;let R="",N="";return v==="bottom"?(R=h?E:`${T}px`,N=`${-g}px`):v==="top"?(R=h?E:`${T}px`,N=`${i.floating.height+g}px`):v==="right"?(R=`${-g}px`,N=h?E:`${C}px`):v==="left"&&(R=`${i.floating.width+g}px`,N=h?E:`${C}px`),{data:{x:R,y:N}}}});function ace(e){const[t,n="center"]=e.split("-");return[t,n]}var b4=Qoe,Mw=tce,b1=nce,E1=ice,yMe="Portal",Uw=w.forwardRef((e,t)=>{var p;const{container:n,...i}=e,[o,u]=w.useState(!1);va(()=>u(!0),[]);const h=n||o&&((p=globalThis==null?void 0:globalThis.document)==null?void 0:p.body);return h?Ooe.createPortal(c.jsx(Qt.div,{...i,ref:t}),h):null});Uw.displayName=yMe;function _Me(e,t){return w.useReducer((n,i)=>t[n][i]??n,e)}var is=e=>{const{present:t,children:n}=e,i=bMe(t),o=typeof n=="function"?n({present:i.isPresent}):w.Children.only(n),u=Dn(i.ref,EMe(o));return typeof n=="function"||i.isPresent?w.cloneElement(o,{ref:u}):null};is.displayName="Presence";function bMe(e){const[t,n]=w.useState(),i=w.useRef(null),o=w.useRef(e),u=w.useRef("none"),h=e?"mounted":"unmounted",[p,g]=_Me(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const v=DC(i.current);u.current=p==="mounted"?v:"none"},[p]),va(()=>{const v=i.current,b=o.current;if(b!==e){const T=u.current,C=DC(v);e?g("MOUNT"):C==="none"||(v==null?void 0:v.display)==="none"?g("UNMOUNT"):g(b&&T!==C?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,g]),va(()=>{if(t){let v;const b=t.ownerDocument.defaultView??window,E=C=>{const N=DC(i.current).includes(C.animationName);if(C.target===t&&N&&(g("ANIMATION_END"),!o.current)){const O=t.style.animationFillMode;t.style.animationFillMode="forwards",v=b.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=O)})}},T=C=>{C.target===t&&(u.current=DC(i.current))};return t.addEventListener("animationstart",T),t.addEventListener("animationcancel",E),t.addEventListener("animationend",E),()=>{b.clearTimeout(v),t.removeEventListener("animationstart",T),t.removeEventListener("animationcancel",E),t.removeEventListener("animationend",E)}}else g("ANIMATION_END")},[t,g]),{isPresent:["mounted","unmountSuspended"].includes(p),ref:w.useCallback(v=>{i.current=v?getComputedStyle(v):null,n(v)},[])}}function DC(e){return(e==null?void 0:e.animationName)||"none"}function EMe(e){var i,o;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var wMe=s0[" useInsertionEffect ".trim().toString()]||va;function Bd({prop:e,defaultProp:t,onChange:n=()=>{},caller:i}){const[o,u,h]=SMe({defaultProp:t,onChange:n}),p=e!==void 0,g=p?e:o;{const b=w.useRef(e!==void 0);w.useEffect(()=>{const E=b.current;E!==p&&console.warn(`${i} is changing from ${E?"controlled":"uncontrolled"} to ${p?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),b.current=p},[p,i])}const v=w.useCallback(b=>{var E;if(p){const T=xMe(b)?b(e):b;T!==e&&((E=h.current)==null||E.call(h,T))}else u(b)},[p,e,u,h]);return[g,v]}function SMe({defaultProp:e,onChange:t}){const[n,i]=w.useState(e),o=w.useRef(n),u=w.useRef(t);return wMe(()=>{u.current=t},[t]),w.useEffect(()=>{var h;o.current!==n&&((h=u.current)==null||h.call(u,n),o.current=n)},[n,o]),[n,i,u]}function xMe(e){return typeof e=="function"}var sce=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),TMe="VisuallyHidden",oce=w.forwardRef((e,t)=>c.jsx(Qt.span,{...e,ref:t,style:{...sce,...e.style}}));oce.displayName=TMe;var CMe=oce,[w1,JSt]=Fs("Tooltip",[If]),E4=If(),cce="TooltipProvider",RMe=700,SZ="tooltip.open",[NMe,lce]=w1(cce),uce=e=>{const{__scopeTooltip:t,delayDuration:n=RMe,skipDelayDuration:i=300,disableHoverableContent:o=!1,children:u}=e,h=w.useRef(!0),p=w.useRef(!1),g=w.useRef(0);return w.useEffect(()=>{const v=g.current;return()=>window.clearTimeout(v)},[]),c.jsx(NMe,{scope:t,isOpenDelayedRef:h,delayDuration:n,onOpen:w.useCallback(()=>{window.clearTimeout(g.current),h.current=!1},[]),onClose:w.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>h.current=!0,i)},[i]),isPointerInTransitRef:p,onPointerInTransitChange:w.useCallback(v=>{p.current=v},[]),disableHoverableContent:o,children:u})};uce.displayName=cce;var dce="Tooltip",[ZSt,S1]=w1(dce),sU="TooltipTrigger",AMe=w.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,o=S1(sU,n),u=lce(sU,n),h=E4(n),p=w.useRef(null),g=Dn(t,p,o.onTriggerChange),v=w.useRef(!1),b=w.useRef(!1),E=w.useCallback(()=>v.current=!1,[]);return w.useEffect(()=>()=>document.removeEventListener("pointerup",E),[E]),c.jsx(Mw,{asChild:!0,...h,children:c.jsx(Qt.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...i,ref:g,onPointerMove:Tt(e.onPointerMove,T=>{T.pointerType!=="touch"&&!b.current&&!u.isPointerInTransitRef.current&&(o.onTriggerEnter(),b.current=!0)}),onPointerLeave:Tt(e.onPointerLeave,()=>{o.onTriggerLeave(),b.current=!1}),onPointerDown:Tt(e.onPointerDown,()=>{o.open&&o.onClose(),v.current=!0,document.addEventListener("pointerup",E,{once:!0})}),onFocus:Tt(e.onFocus,()=>{v.current||o.onOpen()}),onBlur:Tt(e.onBlur,o.onClose),onClick:Tt(e.onClick,o.onClose)})})});AMe.displayName=sU;var IMe="TooltipPortal",[QSt,OMe]=w1(IMe,{forceMount:void 0}),oy="TooltipContent",hce=w.forwardRef((e,t)=>{const n=OMe(oy,e.__scopeTooltip),{forceMount:i=n.forceMount,side:o="top",...u}=e,h=S1(oy,e.__scopeTooltip);return c.jsx(is,{present:i||h.open,children:h.disableHoverableContent?c.jsx(fce,{side:o,...u,ref:t}):c.jsx(PMe,{side:o,...u,ref:t})})}),PMe=w.forwardRef((e,t)=>{const n=S1(oy,e.__scopeTooltip),i=lce(oy,e.__scopeTooltip),o=w.useRef(null),u=Dn(t,o),[h,p]=w.useState(null),{trigger:g,onClose:v}=n,b=o.current,{onPointerInTransitChange:E}=i,T=w.useCallback(()=>{p(null),E(!1)},[E]),C=w.useCallback((R,N)=>{const O=R.currentTarget,j={x:R.clientX,y:R.clientY},k=MMe(j,O.getBoundingClientRect()),P=UMe(j,k),M=FMe(N.getBoundingClientRect()),D=BMe([...P,...M]);p(D),E(!0)},[E]);return w.useEffect(()=>()=>T(),[T]),w.useEffect(()=>{if(g&&b){const R=O=>C(O,b),N=O=>C(O,g);return g.addEventListener("pointerleave",R),b.addEventListener("pointerleave",N),()=>{g.removeEventListener("pointerleave",R),b.removeEventListener("pointerleave",N)}}},[g,b,C,T]),w.useEffect(()=>{if(h){const R=N=>{const O=N.target,j={x:N.clientX,y:N.clientY},k=(g==null?void 0:g.contains(O))||(b==null?void 0:b.contains(O)),P=!VMe(j,h);k?T():P&&(T(),v())};return document.addEventListener("pointermove",R),()=>document.removeEventListener("pointermove",R)}},[g,b,h,v,T]),c.jsx(fce,{...e,ref:u})}),[kMe,jMe]=w1(dce,{isInside:!1}),DMe=V2e("TooltipContent"),fce=w.forwardRef((e,t)=>{const{__scopeTooltip:n,children:i,"aria-label":o,onEscapeKeyDown:u,onPointerDownOutside:h,...p}=e,g=S1(oy,n),v=E4(n),{onClose:b}=g;return w.useEffect(()=>(document.addEventListener(SZ,b),()=>document.removeEventListener(SZ,b)),[b]),w.useEffect(()=>{if(g.trigger){const E=T=>{const C=T.target;C!=null&&C.contains(g.trigger)&&b()};return window.addEventListener("scroll",E,{capture:!0}),()=>window.removeEventListener("scroll",E,{capture:!0})}},[g.trigger,b]),c.jsx(Gy,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:u,onPointerDownOutside:h,onFocusOutside:E=>E.preventDefault(),onDismiss:b,children:c.jsxs(b1,{"data-state":g.stateAttribute,...v,...p,ref:t,style:{...p.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(DMe,{children:i}),c.jsx(kMe,{scope:n,isInside:!0,children:c.jsx(CMe,{id:g.contentId,role:"tooltip",children:o||i})})]})})});hce.displayName=oy;var pce="TooltipArrow",LMe=w.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,o=E4(n);return jMe(pce,n).isInside?null:c.jsx(E1,{...o,...i,ref:t})});LMe.displayName=pce;function MMe(e,t){const n=Math.abs(t.top-e.y),i=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),u=Math.abs(t.left-e.x);switch(Math.min(n,i,o,u)){case u:return"left";case o:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function UMe(e,t,n=5){const i=[];switch(t){case"top":i.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":i.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":i.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":i.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return i}function FMe(e){const{top:t,right:n,bottom:i,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:i},{x:o,y:i}]}function VMe(e,t){const{x:n,y:i}=e;let o=!1;for(let u=0,h=t.length-1;u<t.length;h=u++){const p=t[u],g=t[h],v=p.x,b=p.y,E=g.x,T=g.y;b>i!=T>i&&n<(E-v)*(i-b)/(T-b)+v&&(o=!o)}return o}function BMe(e){const t=e.slice();return t.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),$Me(t)}function $Me(e){if(e.length<=1)return e.slice();const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(;t.length>=2;){const u=t[t.length-1],h=t[t.length-2];if((u.x-h.x)*(o.y-h.y)>=(u.y-h.y)*(o.x-h.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let i=e.length-1;i>=0;i--){const o=e[i];for(;n.length>=2;){const u=n[n.length-1],h=n[n.length-2];if((u.x-h.x)*(o.y-h.y)>=(u.y-h.y)*(o.x-h.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var WMe=uce,mce=hce;function gce(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=gce(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function er(){for(var e,t,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=gce(e))&&(i&&(i+=" "),i+=t);return i}const w4="-",GMe=e=>{const t=zMe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:h=>{const p=h.split(w4);return p[0]===""&&p.length!==1&&p.shift(),vce(p,t)||HMe(h)},getConflictingClassGroupIds:(h,p)=>{const g=n[h]||[];return p&&i[h]?[...g,...i[h]]:g}}},vce=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const n=e[0],i=t.nextPart.get(n),o=i?vce(e.slice(1),i):void 0;if(o)return o;if(t.validators.length===0)return;const u=e.join(w4);return(h=t.validators.find(({validator:p})=>p(u)))==null?void 0:h.classGroupId},xZ=/^\[(.+)\]$/,HMe=e=>{if(xZ.test(e)){const t=xZ.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},zMe=e=>{const{theme:t,prefix:n}=e,i={nextPart:new Map,validators:[]};return qMe(Object.entries(e.classGroups),n).forEach(([u,h])=>{oU(h,i,u,t)}),i},oU=(e,t,n,i)=>{e.forEach(o=>{if(typeof o=="string"){const u=o===""?t:TZ(t,o);u.classGroupId=n;return}if(typeof o=="function"){if(KMe(o)){oU(o(i),t,n,i);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([u,h])=>{oU(h,TZ(t,u),n,i)})})},TZ=(e,t)=>{let n=e;return t.split(w4).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},KMe=e=>e.isThemeGetter,qMe=(e,t)=>t?e.map(([n,i])=>{const o=i.map(u=>typeof u=="string"?t+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(([h,p])=>[t+h,p])):u);return[n,o]}):e,YMe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,i=new Map;const o=(u,h)=>{n.set(u,h),t++,t>e&&(t=0,i=n,n=new Map)};return{get(u){let h=n.get(u);if(h!==void 0)return h;if((h=i.get(u))!==void 0)return o(u,h),h},set(u,h){n.has(u)?n.set(u,h):o(u,h)}}},yce="!",XMe=e=>{const{separator:t,experimentalParseClassName:n}=e,i=t.length===1,o=t[0],u=t.length,h=p=>{const g=[];let v=0,b=0,E;for(let O=0;O<p.length;O++){let j=p[O];if(v===0){if(j===o&&(i||p.slice(O,O+u)===t)){g.push(p.slice(b,O)),b=O+u;continue}if(j==="/"){E=O;continue}}j==="["?v++:j==="]"&&v--}const T=g.length===0?p:p.substring(b),C=T.startsWith(yce),R=C?T.substring(1):T,N=E&&E>b?E-b:void 0;return{modifiers:g,hasImportantModifier:C,baseClassName:R,maybePostfixModifierPosition:N}};return n?p=>n({className:p,parseClassName:h}):h},JMe=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(i=>{i[0]==="["?(t.push(...n.sort(),i),n=[]):n.push(i)}),t.push(...n.sort()),t},ZMe=e=>({cache:YMe(e.cacheSize),parseClassName:XMe(e),...GMe(e)}),QMe=/\s+/,eUe=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:o}=t,u=[],h=e.trim().split(QMe);let p="";for(let g=h.length-1;g>=0;g-=1){const v=h[g],{modifiers:b,hasImportantModifier:E,baseClassName:T,maybePostfixModifierPosition:C}=n(v);let R=!!C,N=i(R?T.substring(0,C):T);if(!N){if(!R){p=v+(p.length>0?" "+p:p);continue}if(N=i(T),!N){p=v+(p.length>0?" "+p:p);continue}R=!1}const O=JMe(b).join(":"),j=E?O+yce:O,k=j+N;if(u.includes(k))continue;u.push(k);const P=o(N,R);for(let M=0;M<P.length;++M){const D=P[M];u.push(j+D)}p=v+(p.length>0?" "+p:p)}return p};function tUe(){let e=0,t,n,i="";for(;e<arguments.length;)(t=arguments[e++])&&(n=_ce(t))&&(i&&(i+=" "),i+=n);return i}const _ce=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=_ce(e[i]))&&(n&&(n+=" "),n+=t);return n};function nUe(e,...t){let n,i,o,u=h;function h(g){const v=t.reduce((b,E)=>E(b),e());return n=ZMe(v),i=n.cache.get,o=n.cache.set,u=p,p(g)}function p(g){const v=i(g);if(v)return v;const b=eUe(g,n);return o(g,b),b}return function(){return u(tUe.apply(null,arguments))}}const li=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},bce=/^\[(?:([a-z-]+):)?(.+)\]$/i,rUe=/^\d+\/\d+$/,iUe=new Set(["px","full","screen"]),aUe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sUe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,oUe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,cUe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,lUe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,md=e=>Uv(e)||iUe.has(e)||rUe.test(e),kh=e=>Ky(e,"length",vUe),Uv=e=>!!e&&!Number.isNaN(Number(e)),Y2=e=>Ky(e,"number",Uv),sE=e=>!!e&&Number.isInteger(Number(e)),uUe=e=>e.endsWith("%")&&Uv(e.slice(0,-1)),Fn=e=>bce.test(e),jh=e=>aUe.test(e),dUe=new Set(["length","size","percentage"]),hUe=e=>Ky(e,dUe,Ece),fUe=e=>Ky(e,"position",Ece),pUe=new Set(["image","url"]),mUe=e=>Ky(e,pUe,_Ue),gUe=e=>Ky(e,"",yUe),oE=()=>!0,Ky=(e,t,n)=>{const i=bce.exec(e);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):n(i[2]):!1},vUe=e=>sUe.test(e)&&!oUe.test(e),Ece=()=>!1,yUe=e=>cUe.test(e),_Ue=e=>lUe.test(e),bUe=()=>{const e=li("colors"),t=li("spacing"),n=li("blur"),i=li("brightness"),o=li("borderColor"),u=li("borderRadius"),h=li("borderSpacing"),p=li("borderWidth"),g=li("contrast"),v=li("grayscale"),b=li("hueRotate"),E=li("invert"),T=li("gap"),C=li("gradientColorStops"),R=li("gradientColorStopPositions"),N=li("inset"),O=li("margin"),j=li("opacity"),k=li("padding"),P=li("saturate"),M=li("scale"),D=li("sepia"),U=li("skew"),F=li("space"),H=li("translate"),W=()=>["auto","contain","none"],q=()=>["auto","hidden","clip","visible","scroll"],Y=()=>["auto",Fn,t],z=()=>[Fn,t],Z=()=>["",md,kh],X=()=>["auto",Uv,Fn],ae=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],se=()=>["solid","dashed","dotted","double","none"],J=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],re=()=>["start","end","center","between","around","evenly","stretch"],ee=()=>["","0",Fn],de=()=>["auto","avoid","all","avoid-page","page","left","right","column"],xe=()=>[Uv,Fn];return{cacheSize:500,separator:":",theme:{colors:[oE],spacing:[md,kh],blur:["none","",jh,Fn],brightness:xe(),borderColor:[e],borderRadius:["none","","full",jh,Fn],borderSpacing:z(),borderWidth:Z(),contrast:xe(),grayscale:ee(),hueRotate:xe(),invert:ee(),gap:z(),gradientColorStops:[e],gradientColorStopPositions:[uUe,kh],inset:Y(),margin:Y(),opacity:xe(),padding:z(),saturate:xe(),scale:xe(),sepia:ee(),skew:xe(),space:z(),translate:z()},classGroups:{aspect:[{aspect:["auto","square","video",Fn]}],container:["container"],columns:[{columns:[jh]}],"break-after":[{"break-after":de()}],"break-before":[{"break-before":de()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ae(),Fn]}],overflow:[{overflow:q()}],"overflow-x":[{"overflow-x":q()}],"overflow-y":[{"overflow-y":q()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",sE,Fn]}],basis:[{basis:Y()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Fn]}],grow:[{grow:ee()}],shrink:[{shrink:ee()}],order:[{order:["first","last","none",sE,Fn]}],"grid-cols":[{"grid-cols":[oE]}],"col-start-end":[{col:["auto",{span:["full",sE,Fn]},Fn]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[oE]}],"row-start-end":[{row:["auto",{span:[sE,Fn]},Fn]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Fn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Fn]}],gap:[{gap:[T]}],"gap-x":[{"gap-x":[T]}],"gap-y":[{"gap-y":[T]}],"justify-content":[{justify:["normal",...re()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...re(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...re(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[O]}],mx:[{mx:[O]}],my:[{my:[O]}],ms:[{ms:[O]}],me:[{me:[O]}],mt:[{mt:[O]}],mr:[{mr:[O]}],mb:[{mb:[O]}],ml:[{ml:[O]}],"space-x":[{"space-x":[F]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[F]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Fn,t]}],"min-w":[{"min-w":[Fn,t,"min","max","fit"]}],"max-w":[{"max-w":[Fn,t,"none","full","min","max","fit","prose",{screen:[jh]},jh]}],h:[{h:[Fn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Fn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Fn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Fn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",jh,kh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Y2]}],"font-family":[{font:[oE]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Fn]}],"line-clamp":[{"line-clamp":["none",Uv,Y2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",md,Fn]}],"list-image":[{"list-image":["none",Fn]}],"list-style-type":[{list:["none","disc","decimal",Fn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[j]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[j]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...se(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",md,kh]}],"underline-offset":[{"underline-offset":["auto",md,Fn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Fn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Fn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[j]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ae(),fUe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",hUe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mUe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[R]}],"gradient-via-pos":[{via:[R]}],"gradient-to-pos":[{to:[R]}],"gradient-from":[{from:[C]}],"gradient-via":[{via:[C]}],"gradient-to":[{to:[C]}],rounded:[{rounded:[u]}],"rounded-s":[{"rounded-s":[u]}],"rounded-e":[{"rounded-e":[u]}],"rounded-t":[{"rounded-t":[u]}],"rounded-r":[{"rounded-r":[u]}],"rounded-b":[{"rounded-b":[u]}],"rounded-l":[{"rounded-l":[u]}],"rounded-ss":[{"rounded-ss":[u]}],"rounded-se":[{"rounded-se":[u]}],"rounded-ee":[{"rounded-ee":[u]}],"rounded-es":[{"rounded-es":[u]}],"rounded-tl":[{"rounded-tl":[u]}],"rounded-tr":[{"rounded-tr":[u]}],"rounded-br":[{"rounded-br":[u]}],"rounded-bl":[{"rounded-bl":[u]}],"border-w":[{border:[p]}],"border-w-x":[{"border-x":[p]}],"border-w-y":[{"border-y":[p]}],"border-w-s":[{"border-s":[p]}],"border-w-e":[{"border-e":[p]}],"border-w-t":[{"border-t":[p]}],"border-w-r":[{"border-r":[p]}],"border-w-b":[{"border-b":[p]}],"border-w-l":[{"border-l":[p]}],"border-opacity":[{"border-opacity":[j]}],"border-style":[{border:[...se(),"hidden"]}],"divide-x":[{"divide-x":[p]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[p]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[j]}],"divide-style":[{divide:se()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...se()]}],"outline-offset":[{"outline-offset":[md,Fn]}],"outline-w":[{outline:[md,kh]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[j]}],"ring-offset-w":[{"ring-offset":[md,kh]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",jh,gUe]}],"shadow-color":[{shadow:[oE]}],opacity:[{opacity:[j]}],"mix-blend":[{"mix-blend":[...J(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":J()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[g]}],"drop-shadow":[{"drop-shadow":["","none",jh,Fn]}],grayscale:[{grayscale:[v]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[E]}],saturate:[{saturate:[P]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[g]}],"backdrop-grayscale":[{"backdrop-grayscale":[v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[E]}],"backdrop-opacity":[{"backdrop-opacity":[j]}],"backdrop-saturate":[{"backdrop-saturate":[P]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Fn]}],duration:[{duration:xe()}],ease:[{ease:["linear","in","out","in-out",Fn]}],delay:[{delay:xe()}],animate:[{animate:["none","spin","ping","pulse","bounce",Fn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[sE,Fn]}],"translate-x":[{"translate-x":[H]}],"translate-y":[{"translate-y":[H]}],"skew-x":[{"skew-x":[U]}],"skew-y":[{"skew-y":[U]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Fn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Fn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Fn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[md,kh,Y2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},EUe=nUe(bUe);function jt(...e){return EUe(er(e))}function RN(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}function wUe(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}const SUe=WMe,xUe=w.forwardRef(({className:e,sideOffset:t=4,...n},i)=>c.jsx(mce,{ref:i,sideOffset:t,className:jt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));xUe.displayName=mce.displayName;var x1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},T1=typeof window>"u"||"Deno"in globalThis;function Sl(){}function TUe(e,t){return typeof e=="function"?e(t):e}function CUe(e){return typeof e=="number"&&e>=0&&e!==1/0}function RUe(e,t){return Math.max(e+(t||0)-Date.now(),0)}function cU(e,t){return typeof e=="function"?e(t):e}function NUe(e,t){return typeof e=="function"?e(t):e}function CZ(e,t){const{type:n="all",exact:i,fetchStatus:o,predicate:u,queryKey:h,stale:p}=e;if(h){if(i){if(t.queryHash!==S4(h,t.options))return!1}else if(!R0(t.queryKey,h))return!1}if(n!=="all"){const g=t.isActive();if(n==="active"&&!g||n==="inactive"&&g)return!1}return!(typeof p=="boolean"&&t.isStale()!==p||o&&o!==t.state.fetchStatus||u&&!u(t))}function RZ(e,t){const{exact:n,status:i,predicate:o,mutationKey:u}=e;if(u){if(!t.options.mutationKey)return!1;if(n){if(C0(t.options.mutationKey)!==C0(u))return!1}else if(!R0(t.options.mutationKey,u))return!1}return!(i&&t.state.status!==i||o&&!o(t))}function S4(e,t){return((t==null?void 0:t.queryKeyHashFn)||C0)(e)}function C0(e){return JSON.stringify(e,(t,n)=>lU(n)?Object.keys(n).sort().reduce((i,o)=>(i[o]=n[o],i),{}):n)}function R0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>R0(e[n],t[n])):!1}function wce(e,t){if(e===t)return e;const n=NZ(e)&&NZ(t);if(n||lU(e)&&lU(t)){const i=n?e:Object.keys(e),o=i.length,u=n?t:Object.keys(t),h=u.length,p=n?[]:{},g=new Set(i);let v=0;for(let b=0;b<h;b++){const E=n?b:u[b];(!n&&g.has(E)||n)&&e[E]===void 0&&t[E]===void 0?(p[E]=void 0,v++):(p[E]=wce(e[E],t[E]),p[E]===e[E]&&e[E]!==void 0&&v++)}return o===h&&v===o?e:p}return t}function NZ(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function lU(e){if(!AZ(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!AZ(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function AZ(e){return Object.prototype.toString.call(e)==="[object Object]"}function AUe(e){return new Promise(t=>{setTimeout(t,e)})}function IUe(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?wce(e,t):t}function OUe(e,t,n=0){const i=[...e,t];return n&&i.length>n?i.slice(1):i}function PUe(e,t,n=0){const i=[t,...e];return n&&i.length>n?i.slice(0,-1):i}var x4=Symbol();function Sce(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===x4?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Hp,Hh,Hv,dae,kUe=(dae=class extends x1{constructor(){super();yr(this,Hp);yr(this,Hh);yr(this,Hv);On(this,Hv,t=>{if(!T1&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){tt(this,Hh)||this.setEventListener(tt(this,Hv))}onUnsubscribe(){var t;this.hasListeners()||((t=tt(this,Hh))==null||t.call(this),On(this,Hh,void 0))}setEventListener(t){var n;On(this,Hv,t),(n=tt(this,Hh))==null||n.call(this),On(this,Hh,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){tt(this,Hp)!==t&&(On(this,Hp,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof tt(this,Hp)=="boolean"?tt(this,Hp):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Hp=new WeakMap,Hh=new WeakMap,Hv=new WeakMap,dae),xce=new kUe,zv,zh,Kv,hae,jUe=(hae=class extends x1{constructor(){super();yr(this,zv,!0);yr(this,zh);yr(this,Kv);On(this,Kv,t=>{if(!T1&&window.addEventListener){const n=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)}}})}onSubscribe(){tt(this,zh)||this.setEventListener(tt(this,Kv))}onUnsubscribe(){var t;this.hasListeners()||((t=tt(this,zh))==null||t.call(this),On(this,zh,void 0))}setEventListener(t){var n;On(this,Kv,t),(n=tt(this,zh))==null||n.call(this),On(this,zh,t(this.setOnline.bind(this)))}setOnline(t){tt(this,zv)!==t&&(On(this,zv,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return tt(this,zv)}},zv=new WeakMap,zh=new WeakMap,Kv=new WeakMap,hae),NN=new jUe;function DUe(){let e,t;const n=new Promise((o,u)=>{e=o,t=u});n.status="pending",n.catch(()=>{});function i(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{i({status:"fulfilled",value:o}),e(o)},n.reject=o=>{i({status:"rejected",reason:o}),t(o)},n}function LUe(e){return Math.min(1e3*2**e,3e4)}function Tce(e){return(e??"online")==="online"?NN.isOnline():!0}var Cce=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function X2(e){return e instanceof Cce}function Rce(e){let t=!1,n=0,i=!1,o;const u=DUe(),h=N=>{var O;i||(T(new Cce(N)),(O=e.abort)==null||O.call(e))},p=()=>{t=!0},g=()=>{t=!1},v=()=>xce.isFocused()&&(e.networkMode==="always"||NN.isOnline())&&e.canRun(),b=()=>Tce(e.networkMode)&&e.canRun(),E=N=>{var O;i||(i=!0,(O=e.onSuccess)==null||O.call(e,N),o==null||o(),u.resolve(N))},T=N=>{var O;i||(i=!0,(O=e.onError)==null||O.call(e,N),o==null||o(),u.reject(N))},C=()=>new Promise(N=>{var O;o=j=>{(i||v())&&N(j)},(O=e.onPause)==null||O.call(e)}).then(()=>{var N;o=void 0,i||(N=e.onContinue)==null||N.call(e)}),R=()=>{if(i)return;let N;const O=n===0?e.initialPromise:void 0;try{N=O??e.fn()}catch(j){N=Promise.reject(j)}Promise.resolve(N).then(E).catch(j=>{var U;if(i)return;const k=e.retry??(T1?0:3),P=e.retryDelay??LUe,M=typeof P=="function"?P(n,j):P,D=k===!0||typeof k=="number"&&n<k||typeof k=="function"&&k(n,j);if(t||!D){T(j);return}n++,(U=e.onFail)==null||U.call(e,n,j),AUe(M).then(()=>v()?void 0:C()).then(()=>{t?T(j):R()})})};return{promise:u,cancel:h,continue:()=>(o==null||o(),u),cancelRetry:p,continueRetry:g,canStart:b,start:()=>(b()?R():C().then(R),u)}}var MUe=e=>setTimeout(e,0);function UUe(){let e=[],t=0,n=p=>{p()},i=p=>{p()},o=MUe;const u=p=>{t?e.push(p):o(()=>{n(p)})},h=()=>{const p=e;e=[],p.length&&o(()=>{i(()=>{p.forEach(g=>{n(g)})})})};return{batch:p=>{let g;t++;try{g=p()}finally{t--,t||h()}return g},batchCalls:p=>(...g)=>{u(()=>{p(...g)})},schedule:u,setNotifyFunction:p=>{n=p},setBatchNotifyFunction:p=>{i=p},setScheduler:p=>{o=p}}}var js=UUe(),zp,fae,Nce=(fae=class{constructor(){yr(this,zp)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),CUe(this.gcTime)&&On(this,zp,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(T1?1/0:5*60*1e3))}clearGcTimeout(){tt(this,zp)&&(clearTimeout(tt(this,zp)),On(this,zp,void 0))}},zp=new WeakMap,fae),qv,Kp,Rc,qp,vs,Aw,Yp,xl,yd,pae,FUe=(pae=class extends Nce{constructor(t){super();yr(this,xl);yr(this,qv);yr(this,Kp);yr(this,Rc);yr(this,qp);yr(this,vs);yr(this,Aw);yr(this,Yp);On(this,Yp,!1),On(this,Aw,t.defaultOptions),this.setOptions(t.options),this.observers=[],On(this,qp,t.client),On(this,Rc,tt(this,qp).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,On(this,qv,BUe(this.options)),this.state=t.state??tt(this,qv),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=tt(this,vs))==null?void 0:t.promise}setOptions(t){this.options={...tt(this,Aw),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&tt(this,Rc).remove(this)}setData(t,n){const i=IUe(this.state.data,t,this.options);return hs(this,xl,yd).call(this,{data:i,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),i}setState(t,n){hs(this,xl,yd).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var i,o;const n=(i=tt(this,vs))==null?void 0:i.promise;return(o=tt(this,vs))==null||o.cancel(t),n?n.then(Sl).catch(Sl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(tt(this,qv))}isActive(){return this.observers.some(t=>NUe(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===x4||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>cU(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!RUe(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=tt(this,vs))==null||n.continue()}onOnline(){var n;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=tt(this,vs))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),tt(this,Rc).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(tt(this,vs)&&(tt(this,Yp)?tt(this,vs).cancel({revert:!0}):tt(this,vs).cancelRetry()),this.scheduleGc()),tt(this,Rc).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||hs(this,xl,yd).call(this,{type:"invalidate"})}fetch(t,n){var v,b,E;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(tt(this,vs))return tt(this,vs).continueRetry(),tt(this,vs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const T=this.observers.find(C=>C.options.queryFn);T&&this.setOptions(T.options)}const i=new AbortController,o=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(On(this,Yp,!0),i.signal)})},u=()=>{const T=Sce(this.options,n),R=(()=>{const N={client:tt(this,qp),queryKey:this.queryKey,meta:this.meta};return o(N),N})();return On(this,Yp,!1),this.options.persister?this.options.persister(T,R,this):T(R)},p=(()=>{const T={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:tt(this,qp),state:this.state,fetchFn:u};return o(T),T})();(v=this.options.behavior)==null||v.onFetch(p,this),On(this,Kp,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((b=p.fetchOptions)==null?void 0:b.meta))&&hs(this,xl,yd).call(this,{type:"fetch",meta:(E=p.fetchOptions)==null?void 0:E.meta});const g=T=>{var C,R,N,O;X2(T)&&T.silent||hs(this,xl,yd).call(this,{type:"error",error:T}),X2(T)||((R=(C=tt(this,Rc).config).onError)==null||R.call(C,T,this),(O=(N=tt(this,Rc).config).onSettled)==null||O.call(N,this.state.data,T,this)),this.scheduleGc()};return On(this,vs,Rce({initialPromise:n==null?void 0:n.initialPromise,fn:p.fetchFn,abort:i.abort.bind(i),onSuccess:T=>{var C,R,N,O;if(T===void 0){g(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(T)}catch(j){g(j);return}(R=(C=tt(this,Rc).config).onSuccess)==null||R.call(C,T,this),(O=(N=tt(this,Rc).config).onSettled)==null||O.call(N,T,this.state.error,this),this.scheduleGc()},onError:g,onFail:(T,C)=>{hs(this,xl,yd).call(this,{type:"failed",failureCount:T,error:C})},onPause:()=>{hs(this,xl,yd).call(this,{type:"pause"})},onContinue:()=>{hs(this,xl,yd).call(this,{type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay,networkMode:p.options.networkMode,canRun:()=>!0})),tt(this,vs).start()}},qv=new WeakMap,Kp=new WeakMap,Rc=new WeakMap,qp=new WeakMap,vs=new WeakMap,Aw=new WeakMap,Yp=new WeakMap,xl=new WeakSet,yd=function(t){const n=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...VUe(i.data,this.options),fetchMeta:t.meta??null};case"success":return On(this,Kp,void 0),{...i,data:t.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return X2(o)&&o.revert&&tt(this,Kp)?{...tt(this,Kp),fetchStatus:"idle"}:{...i,error:o,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=n(this.state),js.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),tt(this,Rc).notify({query:this,type:"updated",action:t})})},pae);function VUe(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Tce(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function BUe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,i=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Eu,mae,$Ue=(mae=class extends x1{constructor(t={}){super();yr(this,Eu);this.config=t,On(this,Eu,new Map)}build(t,n,i){const o=n.queryKey,u=n.queryHash??S4(o,n);let h=this.get(u);return h||(h=new FUe({client:t,queryKey:o,queryHash:u,options:t.defaultQueryOptions(n),state:i,defaultOptions:t.getQueryDefaults(o)}),this.add(h)),h}add(t){tt(this,Eu).has(t.queryHash)||(tt(this,Eu).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=tt(this,Eu).get(t.queryHash);n&&(t.destroy(),n===t&&tt(this,Eu).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){js.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return tt(this,Eu).get(t)}getAll(){return[...tt(this,Eu).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(i=>CZ(n,i))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(i=>CZ(t,i)):n}notify(t){js.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){js.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){js.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Eu=new WeakMap,mae),wu,Os,Xp,Su,Lh,gae,WUe=(gae=class extends Nce{constructor(t){super();yr(this,Su);yr(this,wu);yr(this,Os);yr(this,Xp);this.mutationId=t.mutationId,On(this,Os,t.mutationCache),On(this,wu,[]),this.state=t.state||GUe(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){tt(this,wu).includes(t)||(tt(this,wu).push(t),this.clearGcTimeout(),tt(this,Os).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){On(this,wu,tt(this,wu).filter(n=>n!==t)),this.scheduleGc(),tt(this,Os).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){tt(this,wu).length||(this.state.status==="pending"?this.scheduleGc():tt(this,Os).remove(this))}continue(){var t;return((t=tt(this,Xp))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var u,h,p,g,v,b,E,T,C,R,N,O,j,k,P,M,D,U,F,H;const n=()=>{hs(this,Su,Lh).call(this,{type:"continue"})};On(this,Xp,Rce({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(W,q)=>{hs(this,Su,Lh).call(this,{type:"failed",failureCount:W,error:q})},onPause:()=>{hs(this,Su,Lh).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>tt(this,Os).canRun(this)}));const i=this.state.status==="pending",o=!tt(this,Xp).canStart();try{if(i)n();else{hs(this,Su,Lh).call(this,{type:"pending",variables:t,isPaused:o}),await((h=(u=tt(this,Os).config).onMutate)==null?void 0:h.call(u,t,this));const q=await((g=(p=this.options).onMutate)==null?void 0:g.call(p,t));q!==this.state.context&&hs(this,Su,Lh).call(this,{type:"pending",context:q,variables:t,isPaused:o})}const W=await tt(this,Xp).start();return await((b=(v=tt(this,Os).config).onSuccess)==null?void 0:b.call(v,W,t,this.state.context,this)),await((T=(E=this.options).onSuccess)==null?void 0:T.call(E,W,t,this.state.context)),await((R=(C=tt(this,Os).config).onSettled)==null?void 0:R.call(C,W,null,this.state.variables,this.state.context,this)),await((O=(N=this.options).onSettled)==null?void 0:O.call(N,W,null,t,this.state.context)),hs(this,Su,Lh).call(this,{type:"success",data:W}),W}catch(W){try{throw await((k=(j=tt(this,Os).config).onError)==null?void 0:k.call(j,W,t,this.state.context,this)),await((M=(P=this.options).onError)==null?void 0:M.call(P,W,t,this.state.context)),await((U=(D=tt(this,Os).config).onSettled)==null?void 0:U.call(D,void 0,W,this.state.variables,this.state.context,this)),await((H=(F=this.options).onSettled)==null?void 0:H.call(F,void 0,W,t,this.state.context)),W}finally{hs(this,Su,Lh).call(this,{type:"error",error:W})}}finally{tt(this,Os).runNext(this)}}},wu=new WeakMap,Os=new WeakMap,Xp=new WeakMap,Su=new WeakSet,Lh=function(t){const n=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),js.batch(()=>{tt(this,wu).forEach(i=>{i.onMutationUpdate(t)}),tt(this,Os).notify({mutation:this,type:"updated",action:t})})},gae);function GUe(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ed,Tl,Iw,vae,HUe=(vae=class extends x1{constructor(t={}){super();yr(this,Ed);yr(this,Tl);yr(this,Iw);this.config=t,On(this,Ed,new Set),On(this,Tl,new Map),On(this,Iw,0)}build(t,n,i){const o=new WUe({mutationCache:this,mutationId:++mC(this,Iw)._,options:t.defaultMutationOptions(n),state:i});return this.add(o),o}add(t){tt(this,Ed).add(t);const n=LC(t);if(typeof n=="string"){const i=tt(this,Tl).get(n);i?i.push(t):tt(this,Tl).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(tt(this,Ed).delete(t)){const n=LC(t);if(typeof n=="string"){const i=tt(this,Tl).get(n);if(i)if(i.length>1){const o=i.indexOf(t);o!==-1&&i.splice(o,1)}else i[0]===t&&tt(this,Tl).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=LC(t);if(typeof n=="string"){const i=tt(this,Tl).get(n),o=i==null?void 0:i.find(u=>u.state.status==="pending");return!o||o===t}else return!0}runNext(t){var i;const n=LC(t);if(typeof n=="string"){const o=(i=tt(this,Tl).get(n))==null?void 0:i.find(u=>u!==t&&u.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){js.batch(()=>{tt(this,Ed).forEach(t=>{this.notify({type:"removed",mutation:t})}),tt(this,Ed).clear(),tt(this,Tl).clear()})}getAll(){return Array.from(tt(this,Ed))}find(t){const n={exact:!0,...t};return this.getAll().find(i=>RZ(n,i))}findAll(t={}){return this.getAll().filter(n=>RZ(t,n))}notify(t){js.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return js.batch(()=>Promise.all(t.map(n=>n.continue().catch(Sl))))}},Ed=new WeakMap,Tl=new WeakMap,Iw=new WeakMap,vae);function LC(e){var t;return(t=e.options.scope)==null?void 0:t.id}function IZ(e){return{onFetch:(t,n)=>{var b,E,T,C,R;const i=t.options,o=(T=(E=(b=t.fetchOptions)==null?void 0:b.meta)==null?void 0:E.fetchMore)==null?void 0:T.direction,u=((C=t.state.data)==null?void 0:C.pages)||[],h=((R=t.state.data)==null?void 0:R.pageParams)||[];let p={pages:[],pageParams:[]},g=0;const v=async()=>{let N=!1;const O=P=>{Object.defineProperty(P,"signal",{enumerable:!0,get:()=>(t.signal.aborted?N=!0:t.signal.addEventListener("abort",()=>{N=!0}),t.signal)})},j=Sce(t.options,t.fetchOptions),k=async(P,M,D)=>{if(N)return Promise.reject();if(M==null&&P.pages.length)return Promise.resolve(P);const F=(()=>{const Y={client:t.client,queryKey:t.queryKey,pageParam:M,direction:D?"backward":"forward",meta:t.options.meta};return O(Y),Y})(),H=await j(F),{maxPages:W}=t.options,q=D?PUe:OUe;return{pages:q(P.pages,H,W),pageParams:q(P.pageParams,M,W)}};if(o&&u.length){const P=o==="backward",M=P?zUe:OZ,D={pages:u,pageParams:h},U=M(i,D);p=await k(D,U,P)}else{const P=e??u.length;do{const M=g===0?h[0]??i.initialPageParam:OZ(i,p);if(g>0&&M==null)break;p=await k(p,M),g++}while(g<P)}return p};t.options.persister?t.fetchFn=()=>{var N,O;return(O=(N=t.options).persister)==null?void 0:O.call(N,v,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=v}}}function OZ(e,{pages:t,pageParams:n}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,n[i],n):void 0}function zUe(e,{pages:t,pageParams:n}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,n[0],n):void 0}var Fi,Kh,qh,Yv,Xv,Yh,Jv,Zv,yae,KUe=(yae=class{constructor(e={}){yr(this,Fi);yr(this,Kh);yr(this,qh);yr(this,Yv);yr(this,Xv);yr(this,Yh);yr(this,Jv);yr(this,Zv);On(this,Fi,e.queryCache||new $Ue),On(this,Kh,e.mutationCache||new HUe),On(this,qh,e.defaultOptions||{}),On(this,Yv,new Map),On(this,Xv,new Map),On(this,Yh,0)}mount(){mC(this,Yh)._++,tt(this,Yh)===1&&(On(this,Jv,xce.subscribe(async e=>{e&&(await this.resumePausedMutations(),tt(this,Fi).onFocus())})),On(this,Zv,NN.subscribe(async e=>{e&&(await this.resumePausedMutations(),tt(this,Fi).onOnline())})))}unmount(){var e,t;mC(this,Yh)._--,tt(this,Yh)===0&&((e=tt(this,Jv))==null||e.call(this),On(this,Jv,void 0),(t=tt(this,Zv))==null||t.call(this),On(this,Zv,void 0))}isFetching(e){return tt(this,Fi).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return tt(this,Kh).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=tt(this,Fi).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=tt(this,Fi).build(this,t),i=n.state.data;return i===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(cU(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return tt(this,Fi).findAll(e).map(({queryKey:t,state:n})=>{const i=n.data;return[t,i]})}setQueryData(e,t,n){const i=this.defaultQueryOptions({queryKey:e}),o=tt(this,Fi).get(i.queryHash),u=o==null?void 0:o.state.data,h=TUe(t,u);if(h!==void 0)return tt(this,Fi).build(this,i).setData(h,{...n,manual:!0})}setQueriesData(e,t,n){return js.batch(()=>tt(this,Fi).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=tt(this,Fi).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=tt(this,Fi);js.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=tt(this,Fi);return js.batch(()=>(n.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},i=js.batch(()=>tt(this,Fi).findAll(e).map(o=>o.cancel(n)));return Promise.all(i).then(Sl).catch(Sl)}invalidateQueries(e,t={}){return js.batch(()=>(tt(this,Fi).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},i=js.batch(()=>tt(this,Fi).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let u=o.fetch(void 0,n);return n.throwOnError||(u=u.catch(Sl)),o.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(i).then(Sl)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=tt(this,Fi).build(this,t);return n.isStaleByTime(cU(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Sl).catch(Sl)}fetchInfiniteQuery(e){return e.behavior=IZ(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Sl).catch(Sl)}ensureInfiniteQueryData(e){return e.behavior=IZ(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return NN.isOnline()?tt(this,Kh).resumePausedMutations():Promise.resolve()}getQueryCache(){return tt(this,Fi)}getMutationCache(){return tt(this,Kh)}getDefaultOptions(){return tt(this,qh)}setDefaultOptions(e){On(this,qh,e)}setQueryDefaults(e,t){tt(this,Yv).set(C0(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...tt(this,Yv).values()],n={};return t.forEach(i=>{R0(e,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(e,t){tt(this,Xv).set(C0(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...tt(this,Xv).values()],n={};return t.forEach(i=>{R0(e,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...tt(this,qh).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=S4(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===x4&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...tt(this,qh).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){tt(this,Fi).clear(),tt(this,Kh).clear()}},Fi=new WeakMap,Kh=new WeakMap,qh=new WeakMap,Yv=new WeakMap,Xv=new WeakMap,Yh=new WeakMap,Jv=new WeakMap,Zv=new WeakMap,yae),qUe=w.createContext(void 0),YUe=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(qUe.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},N0.apply(this,arguments)}var Qh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Qh||(Qh={}));const PZ="popstate";function XUe(e){e===void 0&&(e={});function t(i,o){let{pathname:u,search:h,hash:p}=i.location;return uU("",{pathname:u,search:h,hash:p},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(i,o){return typeof o=="string"?o:AN(o)}return ZUe(t,n,null,e)}function ta(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ace(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function JUe(){return Math.random().toString(36).substr(2,8)}function kZ(e,t){return{usr:e.state,key:e.key,idx:t}}function uU(e,t,n,i){return n===void 0&&(n=null),N0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?qy(t):t,{state:n,key:t&&t.key||i||JUe()})}function AN(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function qy(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function ZUe(e,t,n,i){i===void 0&&(i={});let{window:o=document.defaultView,v5Compat:u=!1}=i,h=o.history,p=Qh.Pop,g=null,v=b();v==null&&(v=0,h.replaceState(N0({},h.state,{idx:v}),""));function b(){return(h.state||{idx:null}).idx}function E(){p=Qh.Pop;let O=b(),j=O==null?null:O-v;v=O,g&&g({action:p,location:N.location,delta:j})}function T(O,j){p=Qh.Push;let k=uU(N.location,O,j);v=b()+1;let P=kZ(k,v),M=N.createHref(k);try{h.pushState(P,"",M)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;o.location.assign(M)}u&&g&&g({action:p,location:N.location,delta:1})}function C(O,j){p=Qh.Replace;let k=uU(N.location,O,j);v=b();let P=kZ(k,v),M=N.createHref(k);h.replaceState(P,"",M),u&&g&&g({action:p,location:N.location,delta:0})}function R(O){let j=o.location.origin!=="null"?o.location.origin:o.location.href,k=typeof O=="string"?O:AN(O);return k=k.replace(/ $/,"%20"),ta(j,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,j)}let N={get action(){return p},get location(){return e(o,h)},listen(O){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(PZ,E),g=O,()=>{o.removeEventListener(PZ,E),g=null}},createHref(O){return t(o,O)},createURL:R,encodeLocation(O){let j=R(O);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:T,replace:C,go(O){return h.go(O)}};return N}var jZ;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(jZ||(jZ={}));function QUe(e,t,n){return n===void 0&&(n="/"),eFe(e,t,n)}function eFe(e,t,n,i){let o=typeof t=="string"?qy(t):t,u=T4(o.pathname||"/",n);if(u==null)return null;let h=Ice(e);tFe(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let v=fFe(u);p=uFe(h[g],v)}return p}function Ice(e,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let o=(u,h,p)=>{let g={relativePath:p===void 0?u.path||"":p,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};g.relativePath.startsWith("/")&&(ta(g.relativePath.startsWith(i),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(i.length));let v=hf([i,g.relativePath]),b=n.concat(g);u.children&&u.children.length>0&&(ta(u.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Ice(u.children,t,b,v)),!(u.path==null&&!u.index)&&t.push({path:v,score:cFe(v,u.index),routesMeta:b})};return e.forEach((u,h)=>{var p;if(u.path===""||!((p=u.path)!=null&&p.includes("?")))o(u,h);else for(let g of Oce(u.path))o(u,h,g)}),t}function Oce(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,o=n.endsWith("?"),u=n.replace(/\?$/,"");if(i.length===0)return o?[u,""]:[u];let h=Oce(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),o&&p.push(...h),p.map(g=>e.startsWith("/")&&g===""?"/":g)}function tFe(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:lFe(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const nFe=/^:[\w-]+$/,rFe=3,iFe=2,aFe=1,sFe=10,oFe=-2,DZ=e=>e==="*";function cFe(e,t){let n=e.split("/"),i=n.length;return n.some(DZ)&&(i+=oFe),t&&(i+=iFe),n.filter(o=>!DZ(o)).reduce((o,u)=>o+(nFe.test(u)?rFe:u===""?aFe:sFe),i)}function lFe(e,t){return e.length===t.length&&e.slice(0,-1).every((i,o)=>i===t[o])?e[e.length-1]-t[t.length-1]:0}function uFe(e,t,n){let{routesMeta:i}=e,o={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],v=p===i.length-1,b=u==="/"?t:t.slice(u.length)||"/",E=dFe({path:g.relativePath,caseSensitive:g.caseSensitive,end:v},b),T=g.route;if(!E)return null;Object.assign(o,E.params),h.push({params:o,pathname:hf([u,E.pathname]),pathnameBase:vFe(hf([u,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(u=hf([u,E.pathnameBase]))}return h}function dFe(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=hFe(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let u=o[0],h=u.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:i.reduce((v,b,E)=>{let{paramName:T,isOptional:C}=b;if(T==="*"){let N=p[E]||"";h=u.slice(0,u.length-N.length).replace(/(.)\/+$/,"$1")}const R=p[E];return C&&!R?v[T]=void 0:v[T]=(R||"").replace(/%2F/g,"/"),v},{}),pathname:u,pathnameBase:h,pattern:e}}function hFe(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Ace(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),i]}function fFe(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ace(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function T4(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function pFe(e,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:o=""}=typeof e=="string"?qy(e):e;return{pathname:n?n.startsWith("/")?n:mFe(n,t):t,search:yFe(i),hash:_Fe(o)}}function mFe(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function J2(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gFe(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function C4(e,t){let n=gFe(e);return t?n.map((i,o)=>o===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function R4(e,t,n,i){i===void 0&&(i=!1);let o;typeof e=="string"?o=qy(e):(o=N0({},e),ta(!o.pathname||!o.pathname.includes("?"),J2("?","pathname","search",o)),ta(!o.pathname||!o.pathname.includes("#"),J2("#","pathname","hash",o)),ta(!o.search||!o.search.includes("#"),J2("#","search","hash",o)));let u=e===""||o.pathname==="",h=u?"/":o.pathname,p;if(h==null)p=n;else{let E=t.length-1;if(!i&&h.startsWith("..")){let T=h.split("/");for(;T[0]==="..";)T.shift(),E-=1;o.pathname=T.join("/")}p=E>=0?t[E]:"/"}let g=pFe(o,p),v=h&&h!=="/"&&h.endsWith("/"),b=(u||h===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(v||b)&&(g.pathname+="/"),g}const hf=e=>e.join("/").replace(/\/\/+/g,"/"),vFe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),yFe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,_Fe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bFe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Pce=["post","put","patch","delete"];new Set(Pce);const EFe=["get",...Pce];new Set(EFe);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},A0.apply(this,arguments)}const N4=w.createContext(null),wFe=w.createContext(null),Of=w.createContext(null),C1=w.createContext(null),Hu=w.createContext({outlet:null,matches:[],isDataRoute:!1}),kce=w.createContext(null);function SFe(e,t){let{relative:n}=t===void 0?{}:t;Yy()||ta(!1);let{basename:i,navigator:o}=w.useContext(Of),{hash:u,pathname:h,search:p}=Dce(e,{relative:n}),g=h;return i!=="/"&&(g=h==="/"?i:hf([i,h])),o.createHref({pathname:g,search:p,hash:u})}function Yy(){return w.useContext(C1)!=null}function Bc(){return Yy()||ta(!1),w.useContext(C1).location}function jce(e){w.useContext(Of).static||w.useLayoutEffect(e)}function tr(){let{isDataRoute:e}=w.useContext(Hu);return e?UFe():xFe()}function xFe(){Yy()||ta(!1);let e=w.useContext(N4),{basename:t,future:n,navigator:i}=w.useContext(Of),{matches:o}=w.useContext(Hu),{pathname:u}=Bc(),h=JSON.stringify(C4(o,n.v7_relativeSplatPath)),p=w.useRef(!1);return jce(()=>{p.current=!0}),w.useCallback(function(v,b){if(b===void 0&&(b={}),!p.current)return;if(typeof v=="number"){i.go(v);return}let E=R4(v,JSON.parse(h),u,b.relative==="path");e==null&&t!=="/"&&(E.pathname=E.pathname==="/"?t:hf([t,E.pathname])),(b.replace?i.replace:i.push)(E,b.state,b)},[t,i,h,u,e])}const TFe=w.createContext(null);function CFe(e){let t=w.useContext(Hu).outlet;return t&&w.createElement(TFe.Provider,{value:e},t)}function Qo(){let{matches:e}=w.useContext(Hu),t=e[e.length-1];return t?t.params:{}}function Dce(e,t){let{relative:n}=t===void 0?{}:t,{future:i}=w.useContext(Of),{matches:o}=w.useContext(Hu),{pathname:u}=Bc(),h=JSON.stringify(C4(o,i.v7_relativeSplatPath));return w.useMemo(()=>R4(e,JSON.parse(h),u,n==="path"),[e,h,u,n])}function RFe(e,t){return NFe(e,t)}function NFe(e,t,n,i){Yy()||ta(!1);let{navigator:o}=w.useContext(Of),{matches:u}=w.useContext(Hu),h=u[u.length-1],p=h?h.params:{};h&&h.pathname;let g=h?h.pathnameBase:"/";h&&h.route;let v=Bc(),b;if(t){var E;let O=typeof t=="string"?qy(t):t;g==="/"||(E=O.pathname)!=null&&E.startsWith(g)||ta(!1),b=O}else b=v;let T=b.pathname||"/",C=T;if(g!=="/"){let O=g.replace(/^\//,"").split("/");C="/"+T.replace(/^\//,"").split("/").slice(O.length).join("/")}let R=QUe(e,{pathname:C}),N=kFe(R&&R.map(O=>Object.assign({},O,{params:Object.assign({},p,O.params),pathname:hf([g,o.encodeLocation?o.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?g:hf([g,o.encodeLocation?o.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),u,n,i);return t&&N?w.createElement(C1.Provider,{value:{location:A0({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Qh.Pop}},N):N}function AFe(){let e=MFe(),t=bFe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),n?w.createElement("pre",{style:o},n):null,null)}const IFe=w.createElement(AFe,null);class OFe extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?w.createElement(Hu.Provider,{value:this.props.routeContext},w.createElement(kce.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PFe(e){let{routeContext:t,match:n,children:i}=e,o=w.useContext(N4);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Hu.Provider,{value:t},i)}function kFe(e,t,n,i){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),e==null){var u;if(!n)return null;if(n.errors)e=n.matches;else if((u=i)!=null&&u.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let h=e,p=(o=n)==null?void 0:o.errors;if(p!=null){let b=h.findIndex(E=>E.route.id&&(p==null?void 0:p[E.route.id])!==void 0);b>=0||ta(!1),h=h.slice(0,Math.min(h.length,b+1))}let g=!1,v=-1;if(n&&i&&i.v7_partialHydration)for(let b=0;b<h.length;b++){let E=h[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(v=b),E.route.id){let{loaderData:T,errors:C}=n,R=E.route.loader&&T[E.route.id]===void 0&&(!C||C[E.route.id]===void 0);if(E.route.lazy||R){g=!0,v>=0?h=h.slice(0,v+1):h=[h[0]];break}}}return h.reduceRight((b,E,T)=>{let C,R=!1,N=null,O=null;n&&(C=p&&E.route.id?p[E.route.id]:void 0,N=E.route.errorElement||IFe,g&&(v<0&&T===0?(FFe("route-fallback"),R=!0,O=null):v===T&&(R=!0,O=E.route.hydrateFallbackElement||null)));let j=t.concat(h.slice(0,T+1)),k=()=>{let P;return C?P=N:R?P=O:E.route.Component?P=w.createElement(E.route.Component,null):E.route.element?P=E.route.element:P=b,w.createElement(PFe,{match:E,routeContext:{outlet:b,matches:j,isDataRoute:n!=null},children:P})};return n&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?w.createElement(OFe,{location:n.location,revalidation:n.revalidation,component:N,error:C,children:k(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):k()},null)}var Lce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Lce||{}),Mce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Mce||{});function jFe(e){let t=w.useContext(N4);return t||ta(!1),t}function DFe(e){let t=w.useContext(wFe);return t||ta(!1),t}function LFe(e){let t=w.useContext(Hu);return t||ta(!1),t}function Uce(e){let t=LFe(),n=t.matches[t.matches.length-1];return n.route.id||ta(!1),n.route.id}function MFe(){var e;let t=w.useContext(kce),n=DFe(),i=Uce();return t!==void 0?t:(e=n.errors)==null?void 0:e[i]}function UFe(){let{router:e}=jFe(Lce.UseNavigateStable),t=Uce(Mce.UseNavigateStable),n=w.useRef(!1);return jce(()=>{n.current=!0}),w.useCallback(function(o,u){u===void 0&&(u={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,A0({fromRouteId:t},u)))},[e,t])}const LZ={};function FFe(e,t,n){LZ[e]||(LZ[e]=!0)}function VFe(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Fce(e){let{to:t,replace:n,state:i,relative:o}=e;Yy()||ta(!1);let{future:u,static:h}=w.useContext(Of),{matches:p}=w.useContext(Hu),{pathname:g}=Bc(),v=tr(),b=R4(t,C4(p,u.v7_relativeSplatPath),g,o==="path"),E=JSON.stringify(b);return w.useEffect(()=>v(JSON.parse(E),{replace:n,state:i,relative:o}),[v,E,o,n,i]),null}function BFe(e){return CFe(e.context)}function Ut(e){ta(!1)}function $Fe(e){let{basename:t="/",children:n=null,location:i,navigationType:o=Qh.Pop,navigator:u,static:h=!1,future:p}=e;Yy()&&ta(!1);let g=t.replace(/^\/*/,"/"),v=w.useMemo(()=>({basename:g,navigator:u,static:h,future:A0({v7_relativeSplatPath:!1},p)}),[g,p,u,h]);typeof i=="string"&&(i=qy(i));let{pathname:b="/",search:E="",hash:T="",state:C=null,key:R="default"}=i,N=w.useMemo(()=>{let O=T4(b,g);return O==null?null:{location:{pathname:O,search:E,hash:T,state:C,key:R},navigationType:o}},[g,b,E,T,C,R,o]);return N==null?null:w.createElement(Of.Provider,{value:v},w.createElement(C1.Provider,{children:n,value:N}))}function WFe(e){let{children:t,location:n}=e;return RFe(dU(t),n)}new Promise(()=>{});function dU(e,t){t===void 0&&(t=[]);let n=[];return w.Children.forEach(e,(i,o)=>{if(!w.isValidElement(i))return;let u=[...t,o];if(i.type===w.Fragment){n.push.apply(n,dU(i.props.children,u));return}i.type!==Ut&&ta(!1),!i.props.index||!i.props.children||ta(!1);let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=dU(i.props.children,u)),n.push(h)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hU(){return hU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},hU.apply(this,arguments)}function GFe(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,u;for(u=0;u<i.length;u++)o=i[u],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function HFe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function zFe(e,t){return e.button===0&&(!t||t==="_self")&&!HFe(e)}function fU(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(o=>[n,o]):[[n,i]])},[]))}function KFe(e,t){let n=fU(e);return t&&t.forEach((i,o)=>{n.has(o)||t.getAll(o).forEach(u=>{n.append(o,u)})}),n}const qFe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],YFe="6";try{window.__reactRouterVersion=YFe}catch{}const XFe="startTransition",MZ=s0[XFe];function JFe(e){let{basename:t,children:n,future:i,window:o}=e,u=w.useRef();u.current==null&&(u.current=XUe({window:o,v5Compat:!0}));let h=u.current,[p,g]=w.useState({action:h.action,location:h.location}),{v7_startTransition:v}=i||{},b=w.useCallback(E=>{v&&MZ?MZ(()=>g(E)):g(E)},[g,v]);return w.useLayoutEffect(()=>h.listen(b),[h,b]),w.useEffect(()=>VFe(i),[i]),w.createElement($Fe,{basename:t,children:n,location:p.location,navigationType:p.action,navigator:h,future:i})}const ZFe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",QFe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,At=w.forwardRef(function(t,n){let{onClick:i,relative:o,reloadDocument:u,replace:h,state:p,target:g,to:v,preventScrollReset:b,viewTransition:E}=t,T=GFe(t,qFe),{basename:C}=w.useContext(Of),R,N=!1;if(typeof v=="string"&&QFe.test(v)&&(R=v,ZFe))try{let P=new URL(window.location.href),M=v.startsWith("//")?new URL(P.protocol+v):new URL(v),D=T4(M.pathname,C);M.origin===P.origin&&D!=null?v=D+M.search+M.hash:N=!0}catch{}let O=SFe(v,{relative:o}),j=eVe(v,{replace:h,state:p,target:g,preventScrollReset:b,relative:o,viewTransition:E});function k(P){i&&i(P),P.defaultPrevented||j(P)}return w.createElement("a",hU({},T,{href:R||O,onClick:N||u?i:k,ref:n,target:g}))});var UZ;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(UZ||(UZ={}));var FZ;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(FZ||(FZ={}));function eVe(e,t){let{target:n,replace:i,state:o,preventScrollReset:u,relative:h,viewTransition:p}=t===void 0?{}:t,g=tr(),v=Bc(),b=Dce(e,{relative:h});return w.useCallback(E=>{if(zFe(E,n)){E.preventDefault();let T=i!==void 0?i:AN(v)===AN(b);g(e,{replace:T,state:o,preventScrollReset:u,relative:h,viewTransition:p})}},[v,g,b,i,o,n,e,u,h,p])}function Xy(e){let t=w.useRef(fU(e)),n=w.useRef(!1),i=Bc(),o=w.useMemo(()=>KFe(i.search,n.current?null:t.current),[i.search]),u=tr(),h=w.useCallback((p,g)=>{const v=fU(typeof p=="function"?p(o):p);n.current=!0,u("?"+v,g)},[u,o]);return[o,h]}const Vce=[{id:"1",firstname:"John",lastname:"Doe",username:"John Doe",email:"john@example.com",password:"password123",profileImage:"https://i.pravatar.cc/150?img=1",coverImage:"https://images.unsplash.com/photo-1477346611705-65d1883cee1e",bio:"Software developer and technology enthusiast",friends:["2","3"],createdAt:new Date(2023,0,15).toISOString()},{id:"2",firstname:"Jane",lastname:"Smith",username:"Jane Smith",email:"jane@example.com",password:"password123",profileImage:"https://i.pravatar.cc/150?img=2",coverImage:"https://images.unsplash.com/photo-1498736297812-3a08021f206f",bio:"Digital marketing specialist | Coffee lover",friends:["1"],createdAt:new Date(2023,1,20).toISOString()},{id:"3",firstname:"Robert",lastname:"Johnson",username:"Robert Johnson",email:"robert@example.com",password:"password123",profileImage:"https://i.pravatar.cc/150?img=3",coverImage:"https://images.unsplash.com/photo-1477959858617-67f85cf4f1df",bio:"Photographer and travel enthusiast",friends:["1"],createdAt:new Date(2023,2,10).toISOString()}],tVe=[{id:"1",userId:"1",content:"Just finished working on a new project! Can't wait to share it with everyone.",images:["https://images.unsplash.com/photo-1519389950473-47ba0277781c"],videos:[],likes:["2","3"],comments:[{id:"1",userId:"2",content:"Looks amazing! Can't wait to see it.",createdAt:new Date(2023,3,5,9,30).toISOString()}],createdAt:new Date(2023,3,5,9,0).toISOString()},{id:"2",userId:"2",content:"Beautiful day at the beach! 🌊☀️",images:["https://images.unsplash.com/photo-1507525428034-b723cf961d3e"],videos:[],likes:["1"],comments:[{id:"2",userId:"1",content:"Wow! Looks incredible.",createdAt:new Date(2023,3,6,14,15).toISOString()},{id:"3",userId:"3",content:"I need a vacation like this!",createdAt:new Date(2023,3,6,15,0).toISOString()}],createdAt:new Date(2023,3,6,13,45).toISOString()},{id:"3",userId:"3",content:"Check out this amazing timelapse I shot yesterday!",images:[],videos:["https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4"],likes:["1","2"],comments:[],createdAt:new Date(2023,3,7,10,30).toISOString()}],nVe=()=>{const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null},rVe=()=>{const e=localStorage.getItem("users");return e?JSON.parse(e):Vce},iVe=e=>{localStorage.setItem("users",JSON.stringify(e))},aVe=()=>{localStorage.getItem("users")||localStorage.setItem("users",JSON.stringify(Vce)),localStorage.getItem("posts")||localStorage.setItem("posts",JSON.stringify(tVe))},$d="https://api.gada.chat";async function wm(e){const t=await e.json();if(!e.ok){const n=t.message??"Something went wrong";throw new Error(n)}return t}async function sVe(e,t){const n=await fetch(`${$d}/api/signin`,{method:"POST",headers:t,body:JSON.stringify(e)});return wm(n)}async function oVe(e){const t=await fetch(`${$d}/api/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return wm(t)}async function cVe(e){const t=await fetch(`${$d}/api/resend-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return wm(t)}async function lVe(e){const t=await fetch(`${$d}/api/sendForgotOtp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return wm(t)}async function uVe(e){const t=await fetch(`${$d}/api/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return wm(t)}async function dVe(e,t){const n=await fetch(`${$d}/api/activation`,{method:"POST",headers:t,body:JSON.stringify(e)});return wm(n)}async function hVe(e,t){const n=await fetch(`${$d}/api/signUp`,{method:"POST",headers:t,body:JSON.stringify(e)});return wm(n)}async function fVe(e,t,n,i){const o=new FormData;if(o.append("avatar",t),i=="cover"){const u=await fetch(`${$d}/api/users/${e}/cover`,{method:"PUT",credentials:"include",headers:n,body:o});if(!u.ok)throw new Error("Upload failed");const{avatarUrl:h}=await u.json();return h}else{const u=await fetch(`${$d}/api/users/${e}/avatar`,{method:"PUT",credentials:"include",headers:n,body:o});if(!u.ok)throw new Error("Upload failed");const{avatarUrl:h}=await u.json();return h}}function Bl(e){return e?{Authorization:`Bearer ${e}`}:{"Content-Type":"application/json"}}function St(e){return e?{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"}}function Xn(e){if(!e||/^data:/.test(e))return e;try{const t=new URL(e),n=t.pathname.split("/").filter(i=>i&&i!=="uploads").join("/");return t.pathname="/"+n,t.toString()}catch{const t=e.match(/^([^?#]*)([?#].*)?$/),n=(t==null?void 0:t[1])??e,i=(t==null?void 0:t[2])??"",o=n.startsWith("/"),u=n.split("/").filter(h=>h&&h!=="uploads").join("/");return(o?"/":"")+u+i}}const Bce=w.createContext(void 0);function pVe({children:e}){const[t,n]=w.useState(null),[i,o]=w.useState(!0),[u,h]=w.useState(null);w.useEffect(()=>{const O=localStorage.getItem("accessToken"),j=localStorage.getItem("UserData");O&&h(O),nVe(),j&&n(JSON.parse(j)),o(!1)},[]);const N={user:t,login:async(O,j)=>{let k={email:O,password:j},P=St(u);await new Promise(U=>setTimeout(U,500));const{token:M,user:D}=await sVe(k,P);if(M&&D){let U={id:D.user_id,firstname:D.user_firstname,lastname:D.user_firstname,username:D.user_name,email:D.user_email,profileImage:D.user_picture?"/uploads/"+Xn(D.user_picture):"/uploads//profile/defaultavatar.png",coverImage:D.user_coverImage,password:"",bio:"",createdAt:"",friends:[],walletBalance:D.user_wallet_balance,roles:D.role,packageactive:D.packageactive,packageName:D.packageName};return n(U),h(M),localStorage.setItem("accessToken",M),localStorage.setItem("UserData",JSON.stringify(U)),!0}return!1},register:async(O,j,k,P,M,D)=>{await new Promise(z=>setTimeout(z,500));const U=rVe(),F={id:wUe(),firstname:O,lastname:j,username:k,email:P,password:M,profileImage:`https://i.pravatar.cc/150?u=${P}`,coverImage:"https://images.unsplash.com/photo-1477346611705-65d1883cee1e",bio:"",friends:[],createdAt:new Date().toISOString(),referral:D};let H={"Content-Type":"application/json"};console.log(F,"newUsernewUsernewUser");const{token:W,user:q}=await hVe(F,H),Y=[...U,F];return iVe(Y),n(F),!0},forgotpassword:async(O,j)=>{console.log("flsnfjnsdijofn");let k={email:O,otp:j};await new Promise(M=>setTimeout(M,500));const P=await oVe(k);return P!=null&&P.status?(console.log("Password reset instructions sent to email."),!0):!1},resetpassword:async(O,j,k)=>{let P={email:O,otp:j,password:k};await new Promise(D=>setTimeout(D,500));const M=await uVe(P);return M!=null&&M.status?(console.log("Password updated successfully."),!0):!1},resendOtp:async O=>{let j={email:O};await new Promise(P=>setTimeout(P,500));const k=await cVe(j);return k!=null&&k.status?(console.log("OTP resend to email"),!0):!1},sendOtp:async O=>{let j={email:O};await new Promise(P=>setTimeout(P,500));const k=await lVe(j);return k!=null&&k.status?(console.log("OTP send to email"),!0):!1},updateProfile:O=>{if(!t)return;console.log(O,"updatesupdatesupdates");const j={profileImage:"/uploads/"+Xn(O.profileImage)},k={...t,...j};n(k)},logout:()=>{n(null),h(null),localStorage.clear()},isLoading:i,accessToken:u};return c.jsx(Bce.Provider,{value:N,children:e})}function ct(){const e=w.useContext(Bce);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const $l="https://api.gada.chat";async function Jy(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error(t&&(t.error||t.message)||"Request failed");return t}async function mVe(e,t){if(!e||e.length===0)return[];const n=new FormData;e.forEach(u=>n.append("files",u));const i=await fetch(`${$l}/api/media/upload`,{method:"POST",body:n,headers:t,credentials:"include"}),{urls:o}=await Jy(i);return o.map(u=>({url:u,type:u.match(/\/videos\//)?"video":"image"}))}async function tv(e,t=0,n=20){const i=new URL(`${$l}/api/posts?withPromoted=1`);return i.searchParams.set("offset",String(t)),i.searchParams.set("limit",String(n)),await(await fetch(i.toString(),{headers:e})).json()||[]}async function $ce(e,t){const n=await fetch(`${$l}/api/posts/${e}`,{headers:t,credentials:"include"});return Jy(n)}async function gVe(e,t,n,i){const o=await fetch(`${$l}/api/posts`,{method:"POST",headers:i,body:JSON.stringify({userId:Number(e),content:t,media:n})});return Jy(o)}async function vVe(e,t,n){const i=await fetch(`${$l}/api/posts/${e}/react`,{method:"POST",headers:{...n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({reaction:"like"})});return Jy(i)}async function yVe(e,t,n,i){const o=await fetch(`${$l}/api/posts/${e}/comment`,{method:"POST",headers:{...i,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:n})});return Jy(o)}async function _Ve(e,t,n){const i=await fetch(`${$l}/api/posts/${e}/share`,{method:"POST",headers:n,credentials:"include"});return Jy(i)}async function bVe(e,t){if(!(await fetch(`${$l}/api/saves`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({postId:e})})).ok)throw new Error("Save post failed")}async function EVe(e,t){if(!(await fetch(`${$l}/api/saves/${e}`,{method:"DELETE",credentials:"include",headers:t})).ok)throw new Error("Unsave post failed")}async function wVe(e){const t=await fetch(`${$l}/api/saves`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to load saved posts");return t.json()}async function SVe(e,t){const n=await fetch(`${$l}/api/posts/${encodeURIComponent(e)}`,{method:"DELETE",credentials:"include",headers:t});if(!n.ok){const i=await n.text().catch(()=>"");throw new Error(i||"Delete failed")}return n.json()}const Wce=w.createContext(void 0),xVe=({children:e})=>{const{accessToken:t,user:n}=ct(),i=St(t),o=Bl(t),[u,h]=w.useState([]),[p,g]=w.useState(0),[v,b]=w.useState(!1),[E,T]=w.useState(!0),C=20;w.useEffect(()=>{t&&(T(!0),tv(i,0,C).then(H=>{h(H),g(H.items.length)}).finally(()=>T(!1)))},[t,n]);const R=(H,W)=>{if(Array.isArray(H)){const Y=Array.isArray(W)?W:(W==null?void 0:W.items)??[];return[...H,...Y]}const q=Array.isArray(W)?W:(W==null?void 0:W.items)??[];return{...H,items:[...H.items??[],...q]}},N=async()=>{if(!v){b(!0);try{const H=await tv(i,p,C);(H==null?void 0:H.items.length)>0&&(h(W=>R(W,H)),g(W=>W+(H==null?void 0:H.items.length)))}finally{b(!1)}}};async function O(H,W,q){const Y=await mVe([...W,...q],o);await gVe(n.id,H,Y,i)&&(Ce.success("Post has been created successfully"),tv(i).then(h).catch(console.error))}const j=async H=>{await vVe(H,n.id,i),tv(i).then(h).catch(console.error)},k=async(H,W)=>{await yVe(H,n.id,W,i)&&tv(i).then(h).catch(console.error)},P=async(H,W)=>{await _Ve(H,W,i),Ce.success("Post has been shared successfully");try{const q=await tv(i);h(q)}catch(q){console.error(q)}};function M(H,W){if(Array.isArray(H))return H.filter(Y=>String(Y.id)!==W);const q={...H};return Array.isArray(q.items)&&(q.items=q.items.filter(Y=>String(Y.id)!==W)),q.promoted&&String(q.promoted.id)===W&&(q.promoted=null),q}function D(H){return H}const U=async H=>{if(!window.confirm("Are you sure you want to delete this post?"))return;const q=String(H),Y=u;h(z=>M(z,q));try{await SVe(q,i),Ce.success("Post deleted.")}catch(z){h(Y),Ce.error((z==null?void 0:z.message)||"Failed to delete post")}},F=async(H,W)=>{W?await EVe(H,i):await bVe(H,i),h(q=>q.map(Y=>Y.id===H?{...Y,hasSaved:!W}:Y))};return c.jsx(Wce.Provider,{value:{posts:u,busy:v,loading:E,loadMore:N,addPost:O,likePost:j,commentPost:k,sharePost:P,toggleSave:F,deletePost:U},children:e})},R1=()=>{const e=w.useContext(Wce);if(!e)throw new Error("usePost must be used within PostProvider");return e},Zy="https://api.gada.chat";async function TVe(e,t,n){const i=new FormData;i.append("file",e),i.append("meta",JSON.stringify(t));const o=await fetch(`${Zy}/api/stories`,{method:"POST",headers:n,body:i});if(!o.ok)throw new Error(`uploadStory failed: ${o.status}`);const u=await o.json();return{url:u.url,type:u.type,meta:u.meta||{}}}async function VZ(e){const t=await fetch(`${Zy}/api/stories`,{headers:e});if(!t.ok)throw new Error(`fetchStories failed: ${t.status}`);return await t.json()}async function CVe(e,t){return(await fetch(`${Zy}/api/stories/${e}/view`,{method:"POST",credentials:"include",headers:t})).json()}async function RVe(e,t=0,n=36,i){const o=new URL(`${Zy}/api/stories/${e}/viewers`);return o.searchParams.set("offset",String(t)),o.searchParams.set("limit",String(n)),(await fetch(o,{credentials:"include",headers:i})).json()}async function NVe(e,t){return(await fetch(`${Zy}/api/stories/${e}`,{method:"DELETE",credentials:"include",headers:t})).json()}async function AVe(e,t){const n=await fetch(`${Zy}/api/stories/text`,{method:"POST",credentials:"include",headers:t,body:JSON.stringify(e)});if(!n.ok){const i=await n.text().catch(()=>"");throw new Error(i||"Failed to create text story")}return n.json()}const Gce=w.createContext(null);function IVe({children:e}){const{user:t,accessToken:n}=ct(),[i,o]=w.useState([]),u=St(n),h=Bl(n);w.useEffect(()=>{if(!n)return;VZ(u).then(o).catch(console.error);const v=setInterval(()=>VZ(u).then(o).catch(()=>{}),6e4);return()=>clearInterval(v)},[n]);const p=async(v,b)=>{const{url:E,type:T,meta:C}=await TVe(v,b,h);o(R=>{const N=R.findIndex(j=>String(j.userId)===String(t.id??t.userId)),O={url:E,type:T,meta:C||b};if(N>=0){const j=[...R];return j[N]={...j[N],stories:[...j[N].stories,O]},j}return[...R,{userId:t.id??t.userId,username:t.name??t.username??"You",avatar:t.profileImage??"",stories:[O]}]}),Ce.success("Story published")};async function g(v){var O,j,k;const b={text:(v.text||"").trim(),bg:v.bg??"#111111",color:v.color??"#ffffff",overlays:v.overlays??null,music_url:v.musicUrl??null,music_volume:typeof v.musicVolume=="number"?v.musicVolume:null},E=await AVe(b,u);if(!(E!=null&&E.ok))throw new Error("Failed to create text story");const T={id:(O=E.item)==null?void 0:O.id,type:"text",url:"",meta:((j=E.item)==null?void 0:j.meta)||{text:b.text,bg:b.bg,color:b.color},created_at:(k=E.item)==null?void 0:k.created_at},C=Number((t==null?void 0:t.userId)??(t==null?void 0:t._id)),R=(t==null?void 0:t.user_name)||(t==null?void 0:t.username)||"You",N=(t==null?void 0:t.user_profile_picture)||(t==null?void 0:t.avatar)||"";o(P=>{const M=[...P],D=M.findIndex(U=>Number(U.userId)===C);if(D>=0){M[D]={...M[D],stories:[...M[D].stories,T]};const[U]=M.splice(D,1);return M.unshift(U),M}return[{userId:C,username:R,avatar:N,stories:[T]},...M]})}return c.jsx(Gce.Provider,{value:{stories:i,addStory:p,addTextStory:g},children:e})}const OVe=()=>w.useContext(Gce);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PVe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Hce=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kVe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jVe=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:h,...p},g)=>w.createElement("svg",{ref:g,...kVe,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:Hce("lucide",o),...p},[...h.map(([v,b])=>w.createElement(v,b)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=(e,t)=>{const n=w.forwardRef(({className:i,...o},u)=>w.createElement(jVe,{ref:u,iconNode:t,className:Hce(`lucide-${PVe(e)}`,i),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DVe=lt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LVe=lt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MVe=lt("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UVe=lt("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zce=lt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=lt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FVe=lt("BookmarkMinus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=lt("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VVe=lt("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BVe=lt("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=lt("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=lt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=lt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Ve=lt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pU=lt("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=lt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=lt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=lt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=lt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=lt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N1=lt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BZ=lt("CircleArrowOutDownRight",[["path",{d:"M12 22a10 10 0 1 1 10-10",key:"130bv5"}],["path",{d:"M22 22 12 12",key:"131aw7"}],["path",{d:"M22 16v6h-6",key:"1gvm70"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WVe=lt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=lt("CircleDollarSign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GVe=lt("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kce=lt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Z=lt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=lt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qce=lt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HVe=lt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=lt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zVe=lt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WZ=lt("Currency",[["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}],["line",{x1:"3",x2:"6",y1:"3",y2:"6",key:"1jkytn"}],["line",{x1:"21",x2:"18",y1:"3",y2:"6",key:"14zfjt"}],["line",{x1:"3",x2:"6",y1:"21",y2:"18",key:"iusuec"}],["line",{x1:"21",x2:"18",y1:"21",y2:"18",key:"yj2dd7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GZ=lt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yce=lt("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xce=lt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mU=lt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=lt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KVe=lt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=lt("FilePlus2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=lt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qVe=lt("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=lt("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YVe=lt("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=lt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gU=lt("Group",[["path",{d:"M3 7V5c0-1.1.9-2 2-2h2",key:"adw53z"}],["path",{d:"M17 3h2c1.1 0 2 .9 2 2v2",key:"an4l38"}],["path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2",key:"144t0e"}],["path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2",key:"rtnfgi"}],["rect",{width:"7",height:"5",x:"7",y:"7",rx:"1",key:"1eyiv7"}],["rect",{width:"7",height:"5",x:"10",y:"12",rx:"1",key:"1qlmkx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jce=lt("HandCoins",[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HZ=lt("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vU=lt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zce=lt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=lt("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XVe=lt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JVe=lt("LandPlot",[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=lt("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZVe=lt("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=lt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zZ=lt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QVe=lt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4e=lt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=lt("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qce=lt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=lt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=lt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4e=lt("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4e=lt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ele=lt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4e=lt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4e=lt("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KZ=lt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4e=lt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tle=lt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4e=lt("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4e=lt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=lt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nle=lt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4e=lt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=lt("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=lt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rle=lt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ile=lt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=lt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=lt("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4e=lt("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ale=lt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qZ=lt("Tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YZ=lt("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=lt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=lt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XZ=lt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4e=lt("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4e=lt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=lt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JZ=lt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4e=lt("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=lt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4e=lt("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=lt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4e=lt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4e=lt("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=lt("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=lt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ZZ=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,QZ=er,Gw=(e,t)=>n=>{var i;if((t==null?void 0:t.variants)==null)return QZ(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:u}=t,h=Object.keys(o).map(v=>{const b=n==null?void 0:n[v],E=u==null?void 0:u[v];if(b===null)return null;const T=ZZ(b)||ZZ(E);return o[v][T]}),p=n&&Object.entries(n).reduce((v,b)=>{let[E,T]=b;return T===void 0||(v[E]=T),v},{}),g=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((v,b)=>{let{class:E,className:T,...C}=b;return Object.entries(C).every(R=>{let[N,O]=R;return Array.isArray(O)?O.includes({...u,...p}[N]):{...u,...p}[N]===O})?[...v,E,T]:v},[]);return QZ(e,h,g,n==null?void 0:n.class,n==null?void 0:n.className)},sle=Gw("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),be=w.forwardRef(({className:e,variant:t,size:n,asChild:i=!1,...o},u)=>{const h=i?koe:"button";return c.jsx(h,{className:jt(sle({variant:t,size:n,className:e})),ref:u,...o})});be.displayName="Button";const Ei=w.forwardRef(({className:e,...t},n)=>c.jsx("textarea",{className:jt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));Ei.displayName="Textarea";var ole={exports:{}},cle={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dy=w;function g4e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var v4e=typeof Object.is=="function"?Object.is:g4e,y4e=dy.useState,_4e=dy.useEffect,b4e=dy.useLayoutEffect,E4e=dy.useDebugValue;function w4e(e,t){var n=t(),i=y4e({inst:{value:n,getSnapshot:t}}),o=i[0].inst,u=i[1];return b4e(function(){o.value=n,o.getSnapshot=t,eL(o)&&u({inst:o})},[e,n,t]),_4e(function(){return eL(o)&&u({inst:o}),e(function(){eL(o)&&u({inst:o})})},[e]),E4e(n),n}function eL(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!v4e(e,n)}catch{return!0}}function S4e(e,t){return t()}var x4e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?S4e:w4e;cle.useSyncExternalStore=dy.useSyncExternalStore!==void 0?dy.useSyncExternalStore:x4e;ole.exports=cle;var T4e=ole.exports;function C4e(){return T4e.useSyncExternalStore(R4e,()=>!0,()=>!1)}function R4e(){return()=>{}}var F4="Avatar",[N4e,ext]=Fs(F4),[A4e,lle]=N4e(F4),ule=w.forwardRef((e,t)=>{const{__scopeAvatar:n,...i}=e,[o,u]=w.useState("idle");return c.jsx(A4e,{scope:n,imageLoadingStatus:o,onImageLoadingStatusChange:u,children:c.jsx(Qt.span,{...i,ref:t})})});ule.displayName=F4;var dle="AvatarImage",hle=w.forwardRef((e,t)=>{const{__scopeAvatar:n,src:i,onLoadingStatusChange:o=()=>{},...u}=e,h=lle(dle,n),p=I4e(i,u),g=Ba(v=>{o(v),h.onImageLoadingStatusChange(v)});return va(()=>{p!=="idle"&&g(p)},[p,g]),p==="loaded"?c.jsx(Qt.img,{...u,ref:t,src:i}):null});hle.displayName=dle;var fle="AvatarFallback",ple=w.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:i,...o}=e,u=lle(fle,n),[h,p]=w.useState(i===void 0);return w.useEffect(()=>{if(i!==void 0){const g=window.setTimeout(()=>p(!0),i);return()=>window.clearTimeout(g)}},[i]),h&&u.imageLoadingStatus!=="loaded"?c.jsx(Qt.span,{...o,ref:t}):null});ple.displayName=fle;function eQ(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function I4e(e,{referrerPolicy:t,crossOrigin:n}){const i=C4e(),o=w.useRef(null),u=i?(o.current||(o.current=new window.Image),o.current):null,[h,p]=w.useState(()=>eQ(u,e));return va(()=>{p(eQ(u,e))},[u,e]),va(()=>{const g=E=>()=>{p(E)};if(!u)return;const v=g("loaded"),b=g("error");return u.addEventListener("load",v),u.addEventListener("error",b),t&&(u.referrerPolicy=t),typeof n=="string"&&(u.crossOrigin=n),()=>{u.removeEventListener("load",v),u.removeEventListener("error",b)}},[u,n,t]),h}var mle=ule,gle=hle,vle=ple;const $i=w.forwardRef(({className:e,...t},n)=>c.jsx(mle,{ref:n,className:jt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));$i.displayName=mle.displayName;const Ii=w.forwardRef(({className:e,...t},n)=>c.jsx(gle,{ref:n,className:jt("aspect-square h-full w-full",e),...t}));Ii.displayName=gle.displayName;const ea=w.forwardRef(({className:e,...t},n)=>c.jsx(vle,{ref:n,className:jt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));ea.displayName=vle.displayName;const Vr=w.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:jt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Vr.displayName="Card";const pa=w.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:jt("flex flex-col space-y-1.5 p-6",e),...t}));pa.displayName="CardHeader";const Wa=w.forwardRef(({className:e,...t},n)=>c.jsx("h3",{ref:n,className:jt("text-2xl font-semibold leading-none tracking-tight",e),...t}));Wa.displayName="CardTitle";const Qy=w.forwardRef(({className:e,...t},n)=>c.jsx("p",{ref:n,className:jt("text-sm text-muted-foreground",e),...t}));Qy.displayName="CardDescription";const mi=w.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:jt("p-6 pt-0",e),...t}));mi.displayName="CardContent";const e_=w.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:jt("flex items-center p-6 pt-0",e),...t}));e_.displayName="CardFooter";const Ae=w.forwardRef(({className:e,type:t,onInput:n,...i},o)=>{const u=h=>{const p=i.maxLength;t==="number"&&p&&(h.currentTarget.value=h.currentTarget.value.slice(0,p)),n&&n(h)};return c.jsx("input",{type:t,className:jt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:o,onInput:u,...i})});Ae.displayName="Input";var tL="focusScope.autoFocusOnMount",nL="focusScope.autoFocusOnUnmount",tQ={bubbles:!1,cancelable:!0},O4e="FocusScope",Hw=w.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:o,onUnmountAutoFocus:u,...h}=e,[p,g]=w.useState(null),v=Ba(o),b=Ba(u),E=w.useRef(null),T=Dn(t,N=>g(N)),C=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(i){let N=function(P){if(C.paused||!p)return;const M=P.target;p.contains(M)?E.current=M:Mh(E.current,{select:!0})},O=function(P){if(C.paused||!p)return;const M=P.relatedTarget;M!==null&&(p.contains(M)||Mh(E.current,{select:!0}))},j=function(P){if(document.activeElement===document.body)for(const D of P)D.removedNodes.length>0&&Mh(p)};document.addEventListener("focusin",N),document.addEventListener("focusout",O);const k=new MutationObserver(j);return p&&k.observe(p,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",O),k.disconnect()}}},[i,p,C.paused]),w.useEffect(()=>{if(p){rQ.add(C);const N=document.activeElement;if(!p.contains(N)){const j=new CustomEvent(tL,tQ);p.addEventListener(tL,v),p.dispatchEvent(j),j.defaultPrevented||(P4e(M4e(yle(p)),{select:!0}),document.activeElement===N&&Mh(p))}return()=>{p.removeEventListener(tL,v),setTimeout(()=>{const j=new CustomEvent(nL,tQ);p.addEventListener(nL,b),p.dispatchEvent(j),j.defaultPrevented||Mh(N??document.body,{select:!0}),p.removeEventListener(nL,b),rQ.remove(C)},0)}}},[p,v,b,C]);const R=w.useCallback(N=>{if(!n&&!i||C.paused)return;const O=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,j=document.activeElement;if(O&&j){const k=N.currentTarget,[P,M]=k4e(k);P&&M?!N.shiftKey&&j===M?(N.preventDefault(),n&&Mh(P,{select:!0})):N.shiftKey&&j===P&&(N.preventDefault(),n&&Mh(M,{select:!0})):j===k&&N.preventDefault()}},[n,i,C.paused]);return c.jsx(Qt.div,{tabIndex:-1,...h,ref:T,onKeyDown:R})});Hw.displayName=O4e;function P4e(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if(Mh(i,{select:t}),document.activeElement!==n)return}function k4e(e){const t=yle(e),n=nQ(t,e),i=nQ(t.reverse(),e);return[n,i]}function yle(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const o=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||o?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function nQ(e,t){for(const n of e)if(!j4e(n,{upTo:t}))return n}function j4e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function D4e(e){return e instanceof HTMLInputElement&&"select"in e}function Mh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&D4e(e)&&t&&e.select()}}var rQ=L4e();function L4e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=iQ(e,t),e.unshift(t)},remove(t){var n;e=iQ(e,t),(n=e[0])==null||n.resume()}}}function iQ(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function M4e(e){return e.filter(t=>t.tagName!=="A")}var rL=0;function I1(){w.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??aQ()),document.body.insertAdjacentElement("beforeend",e[1]??aQ()),rL++,()=>{rL===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),rL--}},[])}function aQ(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Ru=function(){return Ru=Object.assign||function(t){for(var n,i=1,o=arguments.length;i<o;i++){n=arguments[i];for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(t[u]=n[u])}return t},Ru.apply(this,arguments)};function _le(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]]);return n}function U4e(e,t,n){if(n||arguments.length===2)for(var i=0,o=t.length,u;i<o;i++)(u||!(i in t))&&(u||(u=Array.prototype.slice.call(t,0,i)),u[i]=t[i]);return e.concat(u||Array.prototype.slice.call(t))}var UR="right-scroll-bar-position",FR="width-before-scroll-bar",F4e="with-scroll-bars-hidden",V4e="--removed-body-scroll-bar-size";function iL(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function B4e(e,t){var n=w.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var o=n.value;o!==i&&(n.value=i,n.callback(i,o))}}}})[0];return n.callback=t,n.facade}var $4e=typeof window<"u"?w.useLayoutEffect:w.useEffect,sQ=new WeakMap;function W4e(e,t){var n=B4e(null,function(i){return e.forEach(function(o){return iL(o,i)})});return $4e(function(){var i=sQ.get(n);if(i){var o=new Set(i),u=new Set(e),h=n.current;o.forEach(function(p){u.has(p)||iL(p,null)}),u.forEach(function(p){o.has(p)||iL(p,h)})}sQ.set(n,e)},[e]),n}function G4e(e){return e}function H4e(e,t){t===void 0&&(t=G4e);var n=[],i=!1,o={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(u){var h=t(u,i);return n.push(h),function(){n=n.filter(function(p){return p!==h})}},assignSyncMedium:function(u){for(i=!0;n.length;){var h=n;n=[],h.forEach(u)}n={push:function(p){return u(p)},filter:function(){return n}}},assignMedium:function(u){i=!0;var h=[];if(n.length){var p=n;n=[],p.forEach(u),h=n}var g=function(){var b=h;h=[],b.forEach(u)},v=function(){return Promise.resolve().then(g)};v(),n={push:function(b){h.push(b),v()},filter:function(b){return h=h.filter(b),n}}}};return o}function z4e(e){e===void 0&&(e={});var t=H4e(null);return t.options=Ru({async:!0,ssr:!1},e),t}var ble=function(e){var t=e.sideCar,n=_le(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return w.createElement(i,Ru({},n))};ble.isSideCarExport=!0;function K4e(e,t){return e.useMedium(t),ble}var Ele=z4e(),aL=function(){},O1=w.forwardRef(function(e,t){var n=w.useRef(null),i=w.useState({onScrollCapture:aL,onWheelCapture:aL,onTouchMoveCapture:aL}),o=i[0],u=i[1],h=e.forwardProps,p=e.children,g=e.className,v=e.removeScrollBar,b=e.enabled,E=e.shards,T=e.sideCar,C=e.noRelative,R=e.noIsolation,N=e.inert,O=e.allowPinchZoom,j=e.as,k=j===void 0?"div":j,P=e.gapMode,M=_le(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=T,U=W4e([n,t]),F=Ru(Ru({},M),o);return w.createElement(w.Fragment,null,b&&w.createElement(D,{sideCar:Ele,removeScrollBar:v,shards:E,noRelative:C,noIsolation:R,inert:N,setCallbacks:u,allowPinchZoom:!!O,lockRef:n,gapMode:P}),h?w.cloneElement(w.Children.only(p),Ru(Ru({},F),{ref:U})):w.createElement(k,Ru({},F,{className:g,ref:U}),p))});O1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};O1.classNames={fullWidth:FR,zeroRight:UR};var q4e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Y4e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=q4e();return t&&e.setAttribute("nonce",t),e}function X4e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function J4e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Z4e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Y4e())&&(X4e(t,n),J4e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Q4e=function(){var e=Z4e();return function(t,n){w.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},wle=function(){var e=Q4e(),t=function(n){var i=n.styles,o=n.dynamic;return e(i,o),null};return t},eBe={left:0,top:0,right:0,gap:0},sL=function(e){return parseInt(e||"",10)||0},tBe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[sL(n),sL(i),sL(o)]},nBe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return eBe;var t=tBe(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},rBe=wle(),Fv="data-scroll-locked",iBe=function(e,t,n,i){var o=e.left,u=e.top,h=e.right,p=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(F4e,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(p,"px ").concat(i,`;
  }
  body[`).concat(Fv,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(u,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(p,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(p,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(UR,` {
    right: `).concat(p,"px ").concat(i,`;
  }
  
  .`).concat(FR,` {
    margin-right: `).concat(p,"px ").concat(i,`;
  }
  
  .`).concat(UR," .").concat(UR,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(FR," .").concat(FR,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Fv,`] {
    `).concat(V4e,": ").concat(p,`px;
  }
`)},oQ=function(){var e=parseInt(document.body.getAttribute(Fv)||"0",10);return isFinite(e)?e:0},aBe=function(){w.useEffect(function(){return document.body.setAttribute(Fv,(oQ()+1).toString()),function(){var e=oQ()-1;e<=0?document.body.removeAttribute(Fv):document.body.setAttribute(Fv,e.toString())}},[])},sBe=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,o=i===void 0?"margin":i;aBe();var u=w.useMemo(function(){return nBe(o)},[o]);return w.createElement(rBe,{styles:iBe(u,!t,o,n?"":"!important")})},yU=!1;if(typeof window<"u")try{var MC=Object.defineProperty({},"passive",{get:function(){return yU=!0,!0}});window.addEventListener("test",MC,MC),window.removeEventListener("test",MC,MC)}catch{yU=!1}var nv=yU?{passive:!1}:!1,oBe=function(e){return e.tagName==="TEXTAREA"},Sle=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!oBe(e)&&n[t]==="visible")},cBe=function(e){return Sle(e,"overflowY")},lBe=function(e){return Sle(e,"overflowX")},cQ=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var o=xle(e,i);if(o){var u=Tle(e,i),h=u[1],p=u[2];if(h>p)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},uBe=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},dBe=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},xle=function(e,t){return e==="v"?cBe(t):lBe(t)},Tle=function(e,t){return e==="v"?uBe(t):dBe(t)},hBe=function(e,t){return e==="h"&&t==="rtl"?-1:1},fBe=function(e,t,n,i,o){var u=hBe(e,window.getComputedStyle(t).direction),h=u*i,p=n.target,g=t.contains(p),v=!1,b=h>0,E=0,T=0;do{if(!p)break;var C=Tle(e,p),R=C[0],N=C[1],O=C[2],j=N-O-u*R;(R||j)&&xle(e,p)&&(E+=j,T+=R);var k=p.parentNode;p=k&&k.nodeType===Node.DOCUMENT_FRAGMENT_NODE?k.host:k}while(!g&&p!==document.body||g&&(t.contains(p)||t===p));return(b&&Math.abs(E)<1||!b&&Math.abs(T)<1)&&(v=!0),v},UC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},lQ=function(e){return[e.deltaX,e.deltaY]},uQ=function(e){return e&&"current"in e?e.current:e},pBe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},mBe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},gBe=0,rv=[];function vBe(e){var t=w.useRef([]),n=w.useRef([0,0]),i=w.useRef(),o=w.useState(gBe++)[0],u=w.useState(wle)[0],h=w.useRef(e);w.useEffect(function(){h.current=e},[e]),w.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var N=U4e([e.lockRef.current],(e.shards||[]).map(uQ),!0).filter(Boolean);return N.forEach(function(O){return O.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),N.forEach(function(O){return O.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var p=w.useCallback(function(N,O){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!h.current.allowPinchZoom;var j=UC(N),k=n.current,P="deltaX"in N?N.deltaX:k[0]-j[0],M="deltaY"in N?N.deltaY:k[1]-j[1],D,U=N.target,F=Math.abs(P)>Math.abs(M)?"h":"v";if("touches"in N&&F==="h"&&U.type==="range")return!1;var H=cQ(F,U);if(!H)return!0;if(H?D=F:(D=F==="v"?"h":"v",H=cQ(F,U)),!H)return!1;if(!i.current&&"changedTouches"in N&&(P||M)&&(i.current=D),!D)return!0;var W=i.current||D;return fBe(W,O,N,W==="h"?P:M)},[]),g=w.useCallback(function(N){var O=N;if(!(!rv.length||rv[rv.length-1]!==u)){var j="deltaY"in O?lQ(O):UC(O),k=t.current.filter(function(D){return D.name===O.type&&(D.target===O.target||O.target===D.shadowParent)&&pBe(D.delta,j)})[0];if(k&&k.should){O.cancelable&&O.preventDefault();return}if(!k){var P=(h.current.shards||[]).map(uQ).filter(Boolean).filter(function(D){return D.contains(O.target)}),M=P.length>0?p(O,P[0]):!h.current.noIsolation;M&&O.cancelable&&O.preventDefault()}}},[]),v=w.useCallback(function(N,O,j,k){var P={name:N,delta:O,target:j,should:k,shadowParent:yBe(j)};t.current.push(P),setTimeout(function(){t.current=t.current.filter(function(M){return M!==P})},1)},[]),b=w.useCallback(function(N){n.current=UC(N),i.current=void 0},[]),E=w.useCallback(function(N){v(N.type,lQ(N),N.target,p(N,e.lockRef.current))},[]),T=w.useCallback(function(N){v(N.type,UC(N),N.target,p(N,e.lockRef.current))},[]);w.useEffect(function(){return rv.push(u),e.setCallbacks({onScrollCapture:E,onWheelCapture:E,onTouchMoveCapture:T}),document.addEventListener("wheel",g,nv),document.addEventListener("touchmove",g,nv),document.addEventListener("touchstart",b,nv),function(){rv=rv.filter(function(N){return N!==u}),document.removeEventListener("wheel",g,nv),document.removeEventListener("touchmove",g,nv),document.removeEventListener("touchstart",b,nv)}},[]);var C=e.removeScrollBar,R=e.inert;return w.createElement(w.Fragment,null,R?w.createElement(u,{styles:mBe(o)}):null,C?w.createElement(sBe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function yBe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const _Be=K4e(Ele,vBe);var zw=w.forwardRef(function(e,t){return w.createElement(O1,Ru({},e,{ref:t,sideCar:_Be}))});zw.classNames=O1.classNames;var bBe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},iv=new WeakMap,FC=new WeakMap,VC={},oL=0,Cle=function(e){return e&&(e.host||Cle(e.parentNode))},EBe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=Cle(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},wBe=function(e,t,n,i){var o=EBe(t,Array.isArray(e)?e:[e]);VC[n]||(VC[n]=new WeakMap);var u=VC[n],h=[],p=new Set,g=new Set(o),v=function(E){!E||p.has(E)||(p.add(E),v(E.parentNode))};o.forEach(v);var b=function(E){!E||g.has(E)||Array.prototype.forEach.call(E.children,function(T){if(p.has(T))b(T);else try{var C=T.getAttribute(i),R=C!==null&&C!=="false",N=(iv.get(T)||0)+1,O=(u.get(T)||0)+1;iv.set(T,N),u.set(T,O),h.push(T),N===1&&R&&FC.set(T,!0),O===1&&T.setAttribute(n,"true"),R||T.setAttribute(i,"true")}catch(j){console.error("aria-hidden: cannot operate on ",T,j)}})};return b(t),p.clear(),oL++,function(){h.forEach(function(E){var T=iv.get(E)-1,C=u.get(E)-1;iv.set(E,T),u.set(E,C),T||(FC.has(E)||E.removeAttribute(i),FC.delete(E)),C||E.removeAttribute(n)}),oL--,oL||(iv=new WeakMap,iv=new WeakMap,FC=new WeakMap,VC={})}},P1=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),o=bBe(e);return o?(i.push.apply(i,Array.from(o.querySelectorAll("[aria-live], script"))),wBe(i,o,n,"aria-hidden")):function(){return null}},k1="Dialog",[Rle,txt]=Fs(k1),[SBe,Wl]=Rle(k1),Nle=e=>{const{__scopeDialog:t,children:n,open:i,defaultOpen:o,onOpenChange:u,modal:h=!0}=e,p=w.useRef(null),g=w.useRef(null),[v,b]=Bd({prop:i,defaultProp:o??!1,onChange:u,caller:k1});return c.jsx(SBe,{scope:t,triggerRef:p,contentRef:g,contentId:Ll(),titleId:Ll(),descriptionId:Ll(),open:v,onOpenChange:b,onOpenToggle:w.useCallback(()=>b(E=>!E),[b]),modal:h,children:n})};Nle.displayName=k1;var Ale="DialogTrigger",Ile=w.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=Wl(Ale,n),u=Dn(t,o.triggerRef);return c.jsx(Qt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":$4(o.open),...i,ref:u,onClick:Tt(e.onClick,o.onOpenToggle)})});Ile.displayName=Ale;var V4="DialogPortal",[xBe,Ole]=Rle(V4,{forceMount:void 0}),Ple=e=>{const{__scopeDialog:t,forceMount:n,children:i,container:o}=e,u=Wl(V4,t);return c.jsx(xBe,{scope:t,forceMount:n,children:w.Children.map(i,h=>c.jsx(is,{present:n||u.open,children:c.jsx(Uw,{asChild:!0,container:o,children:h})}))})};Ple.displayName=V4;var DN="DialogOverlay",kle=w.forwardRef((e,t)=>{const n=Ole(DN,e.__scopeDialog),{forceMount:i=n.forceMount,...o}=e,u=Wl(DN,e.__scopeDialog);return u.modal?c.jsx(is,{present:i||u.open,children:c.jsx(CBe,{...o,ref:t})}):null});kle.displayName=DN;var TBe=yf("DialogOverlay.RemoveScroll"),CBe=w.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=Wl(DN,n);return c.jsx(zw,{as:TBe,allowPinchZoom:!0,shards:[o.contentRef],children:c.jsx(Qt.div,{"data-state":$4(o.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),cm="DialogContent",jle=w.forwardRef((e,t)=>{const n=Ole(cm,e.__scopeDialog),{forceMount:i=n.forceMount,...o}=e,u=Wl(cm,e.__scopeDialog);return c.jsx(is,{present:i||u.open,children:u.modal?c.jsx(RBe,{...o,ref:t}):c.jsx(NBe,{...o,ref:t})})});jle.displayName=cm;var RBe=w.forwardRef((e,t)=>{const n=Wl(cm,e.__scopeDialog),i=w.useRef(null),o=Dn(t,n.contentRef,i);return w.useEffect(()=>{const u=i.current;if(u)return P1(u)},[]),c.jsx(Dle,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Tt(e.onCloseAutoFocus,u=>{var h;u.preventDefault(),(h=n.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Tt(e.onPointerDownOutside,u=>{const h=u.detail.originalEvent,p=h.button===0&&h.ctrlKey===!0;(h.button===2||p)&&u.preventDefault()}),onFocusOutside:Tt(e.onFocusOutside,u=>u.preventDefault())})}),NBe=w.forwardRef((e,t)=>{const n=Wl(cm,e.__scopeDialog),i=w.useRef(!1),o=w.useRef(!1);return c.jsx(Dle,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h,p;(h=e.onCloseAutoFocus)==null||h.call(e,u),u.defaultPrevented||(i.current||(p=n.triggerRef.current)==null||p.focus(),u.preventDefault()),i.current=!1,o.current=!1},onInteractOutside:u=>{var g,v;(g=e.onInteractOutside)==null||g.call(e,u),u.defaultPrevented||(i.current=!0,u.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const h=u.target;((v=n.triggerRef.current)==null?void 0:v.contains(h))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&o.current&&u.preventDefault()}})}),Dle=w.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:u,...h}=e,p=Wl(cm,n),g=w.useRef(null),v=Dn(t,g);return I1(),c.jsxs(c.Fragment,{children:[c.jsx(Hw,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:u,children:c.jsx(Gy,{role:"dialog",id:p.contentId,"aria-describedby":p.descriptionId,"aria-labelledby":p.titleId,"data-state":$4(p.open),...h,ref:v,onDismiss:()=>p.onOpenChange(!1)})}),c.jsxs(c.Fragment,{children:[c.jsx(ABe,{titleId:p.titleId}),c.jsx(OBe,{contentRef:g,descriptionId:p.descriptionId})]})]})}),B4="DialogTitle",Lle=w.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=Wl(B4,n);return c.jsx(Qt.h2,{id:o.titleId,...i,ref:t})});Lle.displayName=B4;var Mle="DialogDescription",Ule=w.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=Wl(Mle,n);return c.jsx(Qt.p,{id:o.descriptionId,...i,ref:t})});Ule.displayName=Mle;var Fle="DialogClose",Vle=w.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,o=Wl(Fle,n);return c.jsx(Qt.button,{type:"button",...i,ref:t,onClick:Tt(e.onClick,()=>o.onOpenChange(!1))})});Vle.displayName=Fle;function $4(e){return e?"open":"closed"}var Ble="DialogTitleWarning",[nxt,$le]=M2e(Ble,{contentName:cm,titleName:B4,docsSlug:"dialog"}),ABe=({titleId:e})=>{const t=$le(Ble),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return w.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},IBe="DialogDescriptionWarning",OBe=({contentRef:e,descriptionId:t})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${$le(IBe).contentName}}.`;return w.useEffect(()=>{var u;const o=(u=e.current)==null?void 0:u.getAttribute("aria-describedby");t&&o&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},Wle=Nle,PBe=Ile,Gle=Ple,j1=kle,D1=jle,L1=Lle,M1=Ule,Hle=Vle;const Ko=Wle,kBe=Gle,zle=w.forwardRef(({className:e,...t},n)=>c.jsx(j1,{ref:n,className:jt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));zle.displayName=j1.displayName;const mo=w.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(kBe,{children:[c.jsx(zle,{}),c.jsxs(D1,{ref:i,className:jt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,c.jsxs(Hle,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(po,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));mo.displayName=D1.displayName;const qo=({className:e,...t})=>c.jsx("div",{className:jt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});qo.displayName="DialogHeader";const lm=({className:e,...t})=>c.jsx("div",{className:jt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});lm.displayName="DialogFooter";const Yo=w.forwardRef(({className:e,...t},n)=>c.jsx(L1,{ref:n,className:jt("text-lg font-semibold leading-none tracking-tight",e),...t}));Yo.displayName=L1.displayName;const t_=w.forwardRef(({className:e,...t},n)=>c.jsx(M1,{ref:n,className:jt("text-sm text-muted-foreground",e),...t}));t_.displayName=M1.displayName;var jBe="Label",Kle=w.forwardRef((e,t)=>c.jsx(Qt.label,{...e,ref:t,onMouseDown:n=>{var o;n.target.closest("button, input, select, textarea")||((o=e.onMouseDown)==null||o.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Kle.displayName=jBe;var qle=Kle;const DBe=Gw("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Qe=w.forwardRef(({className:e,...t},n)=>c.jsx(qle,{ref:n,className:jt(DBe(),e),...t}));Qe.displayName=qle.displayName;async function LBe(e,t,n){const i=await fetch(`${LN}/api/live/stop`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({postId:e,thumbnailDataUrl:n})});if(!i.ok){const o=await W4(i);throw new Error(`Stop live failed (${i.status}) ${o}`)}return await i.json()}async function W4(e){try{return await e.text()}catch{return""}}const LN="https://api.gada.chat";async function MBe(e,t){var h,p;const n=JSON.stringify(e);try{const g=await fetch(`${LN}/api/posts/live`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:n});if(g.ok){const v=await g.json(),b=(v==null?void 0:v.id)??(v==null?void 0:v.postId)??((h=v==null?void 0:v.data)==null?void 0:h.id);if(b)return Number(b)}}catch{}const i=await fetch(`${LN}/api/posts`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:n});if(!i.ok){const g=await W4(i);throw new Error(`Create post failed (${i.status}) ${g}`)}const o=await i.json(),u=(o==null?void 0:o.id)??(o==null?void 0:o.postId)??((p=o==null?void 0:o.data)==null?void 0:p.id);if(!u)throw new Error("Create post: missing id in response");return Number(u)}async function UBe(e,t){const n=await fetch(`${LN}/api/live/start`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify(e)});if(!n.ok){const i=await W4(n);throw new Error(`Start live failed (${n.status}) ${i}`)}return await n.json()}var Yle={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(Xh,function(){function n(r,a){return a.forEach(function(s){s&&typeof s!="string"&&!Array.isArray(s)&&Object.keys(s).forEach(function(l){if(l!=="default"&&!(l in r)){var d=Object.getOwnPropertyDescriptor(s,l);Object.defineProperty(r,l,d.get?d:{enumerable:!0,get:function(){return s[l]}})}})}),Object.freeze(r)}var i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Xh<"u"?Xh:typeof self<"u"?self:{};function o(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var u=function(r){try{return!!r()}catch{return!0}},h=!u(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),p=h,g=Function.prototype,v=g.call,b=p&&g.bind.bind(v,v),E=p?b:function(r){return function(){return v.apply(r,arguments)}},T=E({}.isPrototypeOf),C=function(r){return r&&r.Math===Math&&r},R=C(typeof globalThis=="object"&&globalThis)||C(typeof window=="object"&&window)||C(typeof self=="object"&&self)||C(typeof i=="object"&&i)||C(typeof i=="object"&&i)||function(){return this}()||Function("return this")(),N=h,O=Function.prototype,j=O.apply,k=O.call,P=typeof Reflect=="object"&&Reflect.apply||(N?k.bind(j):function(){return k.apply(j,arguments)}),M=E,D=M({}.toString),U=M("".slice),F=function(r){return U(D(r),8,-1)},H=F,W=E,q=function(r){if(H(r)==="Function")return W(r)},Y=typeof document=="object"&&document.all,z=Y===void 0&&Y!==void 0?function(r){return typeof r=="function"||r===Y}:function(r){return typeof r=="function"},Z={},X=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ae=h,se=Function.prototype.call,J=ae?se.bind(se):function(){return se.apply(se,arguments)},re={},ee={}.propertyIsEnumerable,de=Object.getOwnPropertyDescriptor,xe=de&&!ee.call({1:2},1);re.f=xe?function(r){var a=de(this,r);return!!a&&a.enumerable}:ee;var ve,Te,Pe=function(r,a){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:a}},qe=u,st=F,ze=Object,ft=E("".split),$e=qe(function(){return!ze("z").propertyIsEnumerable(0)})?function(r){return st(r)==="String"?ft(r,""):ze(r)}:ze,at=function(r){return r==null},ke=at,je=TypeError,Pt=function(r){if(ke(r))throw new je("Can't call method on "+r);return r},Dt=$e,cn=Pt,ut=function(r){return Dt(cn(r))},wt=z,Rt=function(r){return typeof r=="object"?r!==null:wt(r)},Le={},ge=Le,Ne=R,We=z,gt=function(r){return We(r)?r:void 0},ot=function(r,a){return arguments.length<2?gt(ge[r])||gt(Ne[r]):ge[r]&&ge[r][a]||Ne[r]&&Ne[r][a]},pt=R.navigator,Ft=pt&&pt.userAgent,gn=Ft?String(Ft):"",ur=R,ia=gn,Ws=ur.process,xs=ur.Deno,Xu=Ws&&Ws.versions||xs&&xs.version,Gs=Xu&&Xu.v8;Gs&&(Te=(ve=Gs.split("."))[0]>0&&ve[0]<4?1:+(ve[0]+ve[1])),!Te&&ia&&(!(ve=ia.match(/Edge\/(\d+)/))||ve[1]>=74)&&(ve=ia.match(/Chrome\/(\d+)/))&&(Te=+ve[1]);var Gi=Te,zl=Gi,bt=u,yn=R.String,Bn=!!Object.getOwnPropertySymbols&&!bt(function(){var r=Symbol("symbol detection");return!yn(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&zl&&zl<41}),ki=Bn&&!Symbol.sham&&typeof Symbol.iterator=="symbol",zc=ot,x_=z,T_=T,Kl=Object,Wf=ki?function(r){return typeof r=="symbol"}:function(r){var a=zc("Symbol");return x_(a)&&T_(a.prototype,Kl(r))},Sn=String,nr=function(r){try{return Sn(r)}catch{return"Object"}},ni=z,yo=nr,_o=TypeError,wi=function(r){if(ni(r))return r;throw new _o(yo(r)+" is not a function")},Ju=wi,bo=at,Eo=function(r,a){var s=r[a];return bo(s)?void 0:Ju(s)},Z3=J,Q3=z,e5=Rt,mye=TypeError,t5={exports:{}},n5=R,gye=Object.defineProperty,vye=R,yye=function(r,a){try{gye(n5,r,{value:a,configurable:!0,writable:!0})}catch{n5[r]=a}return a},r5="__core-js_shared__",i5=t5.exports=vye[r5]||yye(r5,{});(i5.versions||(i5.versions=[])).push({version:"3.42.0",mode:"pure",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var mO=t5.exports,a5=mO,Um=function(r,a){return a5[r]||(a5[r]=a||{})},_ye=Pt,bye=Object,ql=function(r){return bye(_ye(r))},Eye=ql,wye=E({}.hasOwnProperty),aa=Object.hasOwn||function(r,a){return wye(Eye(r),a)},Sye=E,xye=0,Tye=Math.random(),Cye=Sye(1 .toString),gO=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Cye(++xye+Tye,36)},Rye=Um,s5=aa,Nye=gO,Aye=Bn,Iye=ki,Fm=R.Symbol,vO=Rye("wks"),Oye=Iye?Fm.for||Fm:Fm&&Fm.withoutSetter||Nye,qr=function(r){return s5(vO,r)||(vO[r]=Aye&&s5(Fm,r)?Fm[r]:Oye("Symbol."+r)),vO[r]},Pye=J,o5=Rt,c5=Wf,kye=Eo,jye=function(r,a){var s,l;if(Q3(s=r.toString)&&!e5(l=Z3(s,r))||Q3(s=r.valueOf)&&!e5(l=Z3(s,r)))return l;throw new mye("Can't convert object to primitive value")},Dye=TypeError,Lye=qr("toPrimitive"),Mye=function(r,a){if(!o5(r)||c5(r))return r;var s,l=kye(r,Lye);if(l){if(s=Pye(l,r,a),!o5(s)||c5(s))return s;throw new Dye("Can't convert object to primitive value")}return jye(r)},Uye=Wf,yO=function(r){var a=Mye(r,"string");return Uye(a)?a:a+""},l5=Rt,_O=R.document,Fye=l5(_O)&&l5(_O.createElement),bO=function(r){return Fye?_O.createElement(r):{}},Vye=bO,u5=!X&&!u(function(){return Object.defineProperty(Vye("div"),"a",{get:function(){return 7}}).a!==7}),Bye=X,$ye=J,Wye=re,Gye=Pe,Hye=ut,zye=yO,Kye=aa,qye=u5,d5=Object.getOwnPropertyDescriptor;Z.f=Bye?d5:function(r,a){if(r=Hye(r),a=zye(a),qye)try{return d5(r,a)}catch{}if(Kye(r,a))return Gye(!$ye(Wye.f,r,a),r[a])};var Yye=u,Xye=z,Jye=/#|\.prototype\./,C_=function(r,a){var s=Qye[Zye(r)];return s===t_e||s!==e_e&&(Xye(a)?Yye(a):!!a)},Zye=C_.normalize=function(r){return String(r).replace(Jye,".").toLowerCase()},Qye=C_.data={},e_e=C_.NATIVE="N",t_e=C_.POLYFILL="P",h5=C_,n_e=wi,r_e=h,i_e=q(q.bind),Qd=function(r,a){return n_e(r),a===void 0?r:r_e?i_e(r,a):function(){return r.apply(a,arguments)}},tc={},f5=X&&u(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),a_e=Rt,s_e=String,o_e=TypeError,Ts=function(r){if(a_e(r))return r;throw new o_e(s_e(r)+" is not an object")},c_e=X,l_e=u5,u_e=f5,gS=Ts,p5=yO,d_e=TypeError,EO=Object.defineProperty,h_e=Object.getOwnPropertyDescriptor,wO="enumerable",SO="configurable",xO="writable";tc.f=c_e?u_e?function(r,a,s){if(gS(r),a=p5(a),gS(s),typeof r=="function"&&a==="prototype"&&"value"in s&&xO in s&&!s[xO]){var l=h_e(r,a);l&&l[xO]&&(r[a]=s.value,s={configurable:SO in s?s[SO]:l[SO],enumerable:wO in s?s[wO]:l[wO],writable:!1})}return EO(r,a,s)}:EO:function(r,a,s){if(gS(r),a=p5(a),gS(s),l_e)try{return EO(r,a,s)}catch{}if("get"in s||"set"in s)throw new d_e("Accessors not supported");return"value"in s&&(r[a]=s.value),r};var f_e=tc,p_e=Pe,Gf=X?function(r,a,s){return f_e.f(r,a,p_e(1,s))}:function(r,a,s){return r[a]=s,r},R_=R,m_e=P,g_e=q,v_e=z,y_e=Z.f,__e=h5,Vm=Le,b_e=Qd,Bm=Gf,m5=aa,E_e=function(r){var a=function(s,l,d){if(this instanceof a){switch(arguments.length){case 0:return new r;case 1:return new r(s);case 2:return new r(s,l)}return new r(s,l,d)}return m_e(r,this,arguments)};return a.prototype=r.prototype,a},Tn=function(r,a){var s,l,d,f,m,y,_,S,x,A=r.target,I=r.global,L=r.stat,K=r.proto,$=I?R_:L?R_[A]:R_[A]&&R_[A].prototype,G=I?Vm:Vm[A]||Bm(Vm,A,{})[A],ne=G.prototype;for(f in a)l=!(s=__e(I?f:A+(L?".":"#")+f,r.forced))&&$&&m5($,f),y=G[f],l&&(_=r.dontCallGetSet?(x=y_e($,f))&&x.value:$[f]),m=l&&_?_:a[f],(s||K||typeof y!=typeof m)&&(S=r.bind&&l?b_e(m,R_):r.wrap&&l?E_e(m):K&&v_e(m)?g_e(m):m,(r.sham||m&&m.sham||y&&y.sham)&&Bm(S,"sham",!0),Bm(G,f,S),K&&(m5(Vm,d=A+"Prototype")||Bm(Vm,d,{}),Bm(Vm[d],f,m),r.real&&ne&&(s||!ne[f])&&Bm(ne,f,m)))},w_e=Math.ceil,S_e=Math.floor,x_e=Math.trunc||function(r){var a=+r;return(a>0?S_e:w_e)(a)},T_e=x_e,TO=function(r){var a=+r;return a!=a||a===0?0:T_e(a)},C_e=TO,R_e=Math.max,N_e=Math.min,CO=function(r,a){var s=C_e(r);return s<0?R_e(s+a,0):N_e(s,a)},A_e=TO,I_e=Math.min,g5=function(r){var a=A_e(r);return a>0?I_e(a,9007199254740991):0},O_e=g5,eh=function(r){return O_e(r.length)},P_e=ut,k_e=CO,j_e=eh,v5=function(r){return function(a,s,l){var d=P_e(a),f=j_e(d);if(f===0)return!r&&-1;var m,y=k_e(l,f);if(r&&s!=s){for(;f>y;)if((m=d[y++])!=m)return!0}else for(;f>y;y++)if((r||y in d)&&d[y]===s)return r||y||0;return!r&&-1}},RO={includes:v5(!0),indexOf:v5(!1)},D_e=RO.includes;Tn({target:"Array",proto:!0,forced:u(function(){return!Array(1).includes()})},{includes:function(r){return D_e(this,r,arguments.length>1?arguments[1]:void 0)}});var L_e=R,M_e=Le,nc=function(r,a){var s=M_e[r+"Prototype"],l=s&&s[a];if(l)return l;var d=L_e[r],f=d&&d.prototype;return f&&f[a]},U_e=nc("Array","includes"),F_e=Rt,V_e=F,B_e=qr("match"),y5=function(r){var a;return F_e(r)&&((a=r[B_e])!==void 0?!!a:V_e(r)==="RegExp")},$_e=y5,W_e=TypeError,_5={};_5[qr("toStringTag")]="z";var NO=String(_5)==="[object z]",G_e=NO,H_e=z,vS=F,z_e=qr("toStringTag"),K_e=Object,q_e=vS(function(){return arguments}())==="Arguments",th=G_e?vS:function(r){var a,s,l;return r===void 0?"Undefined":r===null?"Null":typeof(s=function(d,f){try{return d[f]}catch{}}(a=K_e(r),z_e))=="string"?s:q_e?vS(a):(l=vS(a))==="Object"&&H_e(a.callee)?"Arguments":l},Y_e=th,X_e=String,Hs=function(r){if(Y_e(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return X_e(r)},J_e=qr("match"),Z_e=Tn,Q_e=function(r){if($_e(r))throw new W_e("The method doesn't accept regular expressions");return r},ebe=Pt,b5=Hs,tbe=function(r){var a=/./;try{"/./"[r](a)}catch{try{return a[J_e]=!1,"/./"[r](a)}catch{}}return!1},nbe=E("".indexOf);Z_e({target:"String",proto:!0,forced:!tbe("includes")},{includes:function(r){return!!~nbe(b5(ebe(this)),b5(Q_e(r)),arguments.length>1?arguments[1]:void 0)}});var rbe=nc("String","includes"),E5=T,ibe=U_e,abe=rbe,AO=Array.prototype,IO=String.prototype,sbe=function(r){var a=r.includes;return r===AO||E5(AO,r)&&a===AO.includes?ibe:typeof r=="string"||r===IO||E5(IO,r)&&a===IO.includes?abe:a},Be=o(sbe),obe=wi,cbe=ql,lbe=$e,ube=eh,w5=TypeError,S5="Reduce of empty array with no initial value",dbe=function(r){return function(a,s,l,d){var f=cbe(a),m=lbe(f),y=ube(f);if(obe(s),y===0&&l<2)throw new w5(S5);var _=r?y-1:0,S=r?-1:1;if(l<2)for(;;){if(_ in m){d=m[_],_+=S;break}if(_+=S,r?_<0:y<=_)throw new w5(S5)}for(;r?_>=0:y>_;_+=S)_ in m&&(d=s(d,m[_],_,f));return d}},hbe={left:dbe(!1)},fbe=u,yS=function(r,a){var s=[][r];return!!s&&fbe(function(){s.call(null,a||function(){return 1},1)})},N_=R,pbe=gn,mbe=F,_S=function(r){return pbe.slice(0,r.length)===r},OO=_S("Bun/")?"BUN":_S("Cloudflare-Workers")?"CLOUDFLARE":_S("Deno/")?"DENO":_S("Node.js/")?"NODE":N_.Bun&&typeof Bun.version=="string"?"BUN":N_.Deno&&typeof Deno.version=="object"?"DENO":mbe(N_.process)==="process"?"NODE":N_.window&&N_.document?"BROWSER":"REST",bS=OO==="NODE",gbe=hbe.left;Tn({target:"Array",proto:!0,forced:!bS&&Gi>79&&Gi<83||!yS("reduce")},{reduce:function(r){var a=arguments.length;return gbe(this,r,a,a>1?arguments[1]:void 0)}});var vbe=nc("Array","reduce"),ybe=T,_be=vbe,PO=Array.prototype,bbe=function(r){var a=r.reduce;return r===PO||ybe(PO,r)&&a===PO.reduce?_be:a},x5=bbe,rc=o(x5),Ebe=F,A_=Array.isArray||function(r){return Ebe(r)==="Array"},wbe=Tn,Sbe=A_,xbe=E([].reverse),T5=[1,2];wbe({target:"Array",proto:!0,forced:String(T5)===String(T5.reverse())},{reverse:function(){return Sbe(this)&&(this.length=this.length),xbe(this)}});var Tbe=nc("Array","reverse"),Cbe=T,Rbe=Tbe,kO=Array.prototype,Nbe=function(r){var a=r.reverse;return r===kO||Cbe(kO,r)&&a===kO.reverse?Rbe:a},C5=Nbe,R5=o(C5),Abe=gO,N5=Um("keys"),ES=function(r){return N5[r]||(N5[r]=Abe(r))},Ibe=!u(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),Obe=aa,Pbe=z,kbe=ql,jbe=Ibe,A5=ES("IE_PROTO"),jO=Object,Dbe=jO.prototype,DO=jbe?jO.getPrototypeOf:function(r){var a=kbe(r);if(Obe(a,A5))return a[A5];var s=a.constructor;return Pbe(s)&&a instanceof s?s.prototype:a instanceof jO?Dbe:null},Lbe=E,Mbe=wi,Ube=Rt,Fbe=function(r){return Ube(r)||r===null},Vbe=String,Bbe=TypeError,$be=function(r,a,s){try{return Lbe(Mbe(Object.getOwnPropertyDescriptor(r,a)[s]))}catch{}},Wbe=Rt,Gbe=Pt,Hbe=function(r){if(Fbe(r))return r;throw new Bbe("Can't set "+Vbe(r)+" as a prototype")},zbe=Object.setPrototypeOf||("__proto__"in{}?function(){var r,a=!1,s={};try{(r=$be(Object.prototype,"__proto__","set"))(s,[]),a=s instanceof Array}catch{}return function(l,d){return Gbe(l),Hbe(d),Wbe(l)&&(a?r(l,d):l.__proto__=d),l}}():void 0),wS={},SS={},LO=aa,Kbe=ut,qbe=RO.indexOf,Ybe=SS,I5=E([].push),O5=function(r,a){var s,l=Kbe(r),d=0,f=[];for(s in l)!LO(Ybe,s)&&LO(l,s)&&I5(f,s);for(;a.length>d;)LO(l,s=a[d++])&&(~qbe(f,s)||I5(f,s));return f},MO=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xbe=O5,Jbe=MO.concat("length","prototype");wS.f=Object.getOwnPropertyNames||function(r){return Xbe(r,Jbe)};var I_={};I_.f=Object.getOwnPropertySymbols;var Zbe=ot,Qbe=wS,eEe=I_,tEe=Ts,nEe=E([].concat),rEe=Zbe("Reflect","ownKeys")||function(r){var a=Qbe.f(tEe(r)),s=eEe.f;return s?nEe(a,s(r)):a},P5=aa,iEe=rEe,aEe=Z,sEe=tc,UO={},oEe=O5,cEe=MO,xS=Object.keys||function(r){return oEe(r,cEe)},lEe=X,uEe=f5,dEe=tc,hEe=Ts,fEe=ut,pEe=xS;UO.f=lEe&&!uEe?Object.defineProperties:function(r,a){hEe(r);for(var s,l=fEe(a),d=pEe(a),f=d.length,m=0;f>m;)dEe.f(r,s=d[m++],l[s]);return r};var TS,k5=ot("document","documentElement"),mEe=Ts,gEe=UO,j5=MO,vEe=SS,yEe=k5,_Ee=bO,FO="prototype",VO="script",D5=ES("IE_PROTO"),BO=function(){},L5=function(r){return"<"+VO+">"+r+"</"+VO+">"},M5=function(r){r.write(L5("")),r.close();var a=r.parentWindow.Object;return r=null,a},CS=function(){try{TS=new ActiveXObject("htmlfile")}catch{}var r,a,s;CS=typeof document<"u"?document.domain&&TS?M5(TS):(a=_Ee("iframe"),s="java"+VO+":",a.style.display="none",yEe.appendChild(a),a.src=String(s),(r=a.contentWindow.document).open(),r.write(L5("document.F=Object")),r.close(),r.F):M5(TS);for(var l=j5.length;l--;)delete CS[FO][j5[l]];return CS()};vEe[D5]=!0;var O_=Object.create||function(r,a){var s;return r!==null?(BO[FO]=mEe(r),s=new BO,BO[FO]=null,s[D5]=r):s=CS(),a===void 0?s:gEe.f(s,a)},bEe=Rt,EEe=Gf,U5=Error,wEe=E("".replace),SEe=String(new U5("zxcasd").stack),F5=/\n\s*at [^:]*:[^\n]*/,xEe=F5.test(SEe),TEe=Pe,CEe=!u(function(){var r=new Error("a");return!("stack"in r)||(Object.defineProperty(r,"stack",TEe(1,7)),r.stack!==7)}),REe=Gf,NEe=function(r,a){if(xEe&&typeof r=="string"&&!U5.prepareStackTrace)for(;a--;)r=wEe(r,F5,"");return r},AEe=CEe,V5=Error.captureStackTrace,$m={},IEe=$m,OEe=qr("iterator"),PEe=Array.prototype,B5=function(r){return r!==void 0&&(IEe.Array===r||PEe[OEe]===r)},kEe=th,$5=Eo,jEe=at,DEe=$m,LEe=qr("iterator"),RS=function(r){if(!jEe(r))return $5(r,LEe)||$5(r,"@@iterator")||DEe[kEe(r)]},MEe=J,UEe=wi,FEe=Ts,VEe=nr,BEe=RS,$Ee=TypeError,$O=function(r,a){var s=arguments.length<2?BEe(r):a;if(UEe(s))return FEe(MEe(s,r));throw new $Ee(VEe(r)+" is not iterable")},WEe=J,W5=Ts,GEe=Eo,G5=function(r,a,s){var l,d;W5(r);try{if(!(l=GEe(r,"return"))){if(a==="throw")throw s;return s}l=WEe(l,r)}catch(f){d=!0,l=f}if(a==="throw")throw s;if(d)throw l;return W5(l),s},HEe=Qd,zEe=J,KEe=Ts,qEe=nr,YEe=B5,XEe=eh,H5=T,JEe=$O,ZEe=RS,z5=G5,QEe=TypeError,NS=function(r,a){this.stopped=r,this.result=a},K5=NS.prototype,P_=function(r,a,s){var l,d,f,m,y,_,S,x=s&&s.that,A=!(!s||!s.AS_ENTRIES),I=!(!s||!s.IS_RECORD),L=!(!s||!s.IS_ITERATOR),K=!(!s||!s.INTERRUPTED),$=HEe(a,x),G=function(te){return l&&z5(l,"normal",te),new NS(!0,te)},ne=function(te){return A?(KEe(te),K?$(te[0],te[1],G):$(te[0],te[1])):K?$(te,G):$(te)};if(I)l=r.iterator;else if(L)l=r;else{if(!(d=ZEe(r)))throw new QEe(qEe(r)+" is not iterable");if(YEe(d)){for(f=0,m=XEe(r);m>f;f++)if((y=ne(r[f]))&&H5(K5,y))return y;return new NS(!1)}l=JEe(r,d)}for(_=I?r.next:l.next;!(S=zEe(_,l)).done;){try{y=ne(S.value)}catch(te){z5(l,"throw",te)}if(typeof y=="object"&&y&&H5(K5,y))return y}return new NS(!1)},e0e=Hs,t0e=Tn,n0e=T,r0e=DO,AS=zbe,i0e=function(r,a,s){for(var l=iEe(a),d=sEe.f,f=aEe.f,m=0;m<l.length;m++){var y=l[m];P5(r,y)||s&&P5(s,y)||d(r,y,f(a,y))}},q5=O_,WO=Gf,GO=Pe,a0e=function(r,a){bEe(a)&&"cause"in a&&EEe(r,"cause",a.cause)},s0e=function(r,a,s,l){AEe&&(V5?V5(r,a):REe(r,"stack",NEe(s,l)))},o0e=P_,c0e=function(r,a){return r===void 0?arguments.length<2?"":a:e0e(r)},l0e=qr("toStringTag"),IS=Error,u0e=[].push,Wm=function(r,a){var s,l=n0e(HO,this);AS?s=AS(new IS,l?r0e(this):HO):(s=l?this:q5(HO),WO(s,l0e,"Error")),a!==void 0&&WO(s,"message",c0e(a)),s0e(s,Wm,s.stack,1),arguments.length>2&&a0e(s,arguments[2]);var d=[];return o0e(r,u0e,{that:d}),WO(s,"errors",d),s};AS?AS(Wm,IS):i0e(Wm,IS,{name:!0});var HO=Wm.prototype=q5(IS.prototype,{constructor:GO(1,Wm),message:GO(1,""),name:GO(1,"AggregateError")});t0e({global:!0},{AggregateError:Wm});var OS,k_,PS,d0e=z,Y5=R.WeakMap,h0e=d0e(Y5)&&/native code/.test(String(Y5)),X5=R,f0e=Rt,p0e=Gf,zO=aa,KO=mO,m0e=ES,g0e=SS,J5="Object already initialized",qO=X5.TypeError,v0e=X5.WeakMap;if(h0e||KO.state){var Yl=KO.state||(KO.state=new v0e);Yl.get=Yl.get,Yl.has=Yl.has,Yl.set=Yl.set,OS=function(r,a){if(Yl.has(r))throw new qO(J5);return a.facade=r,Yl.set(r,a),a},k_=function(r){return Yl.get(r)||{}},PS=function(r){return Yl.has(r)}}else{var Gm=m0e("state");g0e[Gm]=!0,OS=function(r,a){if(zO(r,Gm))throw new qO(J5);return a.facade=r,p0e(r,Gm,a),a},k_=function(r){return zO(r,Gm)?r[Gm]:{}},PS=function(r){return zO(r,Gm)}}var Hf,Z5,Q5,zf={set:OS,get:k_,has:PS,enforce:function(r){return PS(r)?k_(r):OS(r,{})},getterFor:function(r){return function(a){var s;if(!f0e(a)||(s=k_(a)).type!==r)throw new qO("Incompatible receiver, "+r+" required");return s}}},YO=X,y0e=aa,e$=Function.prototype,_0e=YO&&Object.getOwnPropertyDescriptor,t$=y0e(e$,"name"),n$={PROPER:t$&&(function(){}).name==="something",CONFIGURABLE:t$&&(!YO||YO&&_0e(e$,"name").configurable)},b0e=Gf,nh=function(r,a,s,l){return l&&l.enumerable?r[a]=s:b0e(r,a,s),r},E0e=u,w0e=z,S0e=Rt,x0e=O_,r$=DO,T0e=nh,XO=qr("iterator"),i$=!1;[].keys&&("next"in(Q5=[].keys())?(Z5=r$(r$(Q5)))!==Object.prototype&&(Hf=Z5):i$=!0);var C0e=!S0e(Hf)||E0e(function(){var r={};return Hf[XO].call(r)!==r});w0e((Hf=C0e?{}:x0e(Hf))[XO])||T0e(Hf,XO,function(){return this});var a$={IteratorPrototype:Hf,BUGGY_SAFARI_ITERATORS:i$},R0e=th,N0e=NO?{}.toString:function(){return"[object "+R0e(this)+"]"},A0e=NO,I0e=tc.f,O0e=Gf,P0e=aa,k0e=N0e,s$=qr("toStringTag"),Zu=function(r,a,s,l){var d=s?r:r&&r.prototype;d&&(P0e(d,s$)||I0e(d,s$,{configurable:!0,value:a}),l&&!A0e&&O0e(d,"toString",k0e))},j0e=a$.IteratorPrototype,D0e=O_,L0e=Pe,M0e=Zu,U0e=$m,F0e=function(){return this},JO=function(r,a,s,l){var d=a+" Iterator";return r.prototype=D0e(j0e,{next:L0e(+!l,s)}),M0e(r,d,!1,!0),U0e[d]=F0e,r},V0e=Tn,B0e=J,$0e=n$,W0e=JO,G0e=DO,H0e=Zu,o$=nh,c$=$m,z0e=a$,K0e=$0e.PROPER,kS=z0e.BUGGY_SAFARI_ITERATORS,ZO=qr("iterator"),l$="keys",jS="values",u$="entries",q0e=function(){return this},d$=function(r,a,s,l,d,f,m){W0e(s,a,l);var y,_,S,x=function(ne){if(ne===d&&$)return $;if(!kS&&ne&&ne in L)return L[ne];switch(ne){case l$:case jS:case u$:return function(){return new s(this,ne)}}return function(){return new s(this)}},A=a+" Iterator",I=!1,L=r.prototype,K=L[ZO]||L["@@iterator"]||d&&L[d],$=!kS&&K||x(d),G=a==="Array"&&L.entries||K;if(G&&(y=G0e(G.call(new r)))!==Object.prototype&&y.next&&(H0e(y,A,!0,!0),c$[A]=q0e),K0e&&d===jS&&K&&K.name!==jS&&(I=!0,$=function(){return B0e(K,this)}),d)if(_={values:x(jS),keys:f?$:x(l$),entries:x(u$)},m)for(S in _)(kS||I||!(S in L))&&o$(L,S,_[S]);else V0e({target:a,proto:!0,forced:kS||I},_);return m&&L[ZO]!==$&&o$(L,ZO,$,{}),c$[a]=$,_},DS=function(r,a){return{value:r,done:a}},Y0e=ut,h$=$m,f$=zf;tc.f;var X0e=d$,LS=DS,p$="Array Iterator",J0e=f$.set,Z0e=f$.getterFor(p$);X0e(Array,"Array",function(r,a){J0e(this,{type:p$,target:Y0e(r),index:0,kind:a})},function(){var r=Z0e(this),a=r.target,s=r.index++;if(!a||s>=a.length)return r.target=null,LS(void 0,!0);switch(r.kind){case"keys":return LS(s,!1);case"values":return LS(a[s],!1)}return LS([s,a[s]],!1)},"values"),h$.Arguments=h$.Array;var Q0e=tc,MS=function(r,a,s){return Q0e.f(r,a,s)},ewe=ot,twe=MS,nwe=X,m$=qr("species"),rwe=T,iwe=TypeError,QO=function(r,a){if(rwe(a,r))return r;throw new iwe("Incorrect invocation")},awe=z,eP=mO,swe=E(Function.toString);awe(eP.inspectSource)||(eP.inspectSource=function(r){return swe(r)});var g$=eP.inspectSource,owe=E,cwe=u,v$=z,lwe=th,uwe=g$,y$=function(){},_$=ot("Reflect","construct"),tP=/^\s*(?:class|function)\b/,dwe=owe(tP.exec),hwe=!tP.test(y$),j_=function(r){if(!v$(r))return!1;try{return _$(y$,[],r),!0}catch{return!1}},b$=function(r){if(!v$(r))return!1;switch(lwe(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return hwe||!!dwe(tP,uwe(r))}catch{return!0}};b$.sham=!0;var D_,Hm,E$,nP,US=!_$||cwe(function(){var r;return j_(j_.call)||!j_(Object)||!j_(function(){r=!0})||r})?b$:j_,fwe=US,pwe=nr,mwe=TypeError,w$=Ts,gwe=function(r){if(fwe(r))return r;throw new mwe(pwe(r)+" is not a constructor")},vwe=at,ywe=qr("species"),rP=function(r,a){var s,l=w$(r).constructor;return l===void 0||vwe(s=w$(l)[ywe])?a:gwe(s)},rh=E([].slice),_we=TypeError,Kf=function(r,a){if(r<a)throw new _we("Not enough arguments");return r},S$=/(?:ipad|iphone|ipod).*applewebkit/i.test(gn),wo=R,bwe=P,Ewe=Qd,x$=z,wwe=aa,T$=u,C$=k5,Swe=rh,R$=bO,xwe=Kf,Twe=S$,Cwe=bS,iP=wo.setImmediate,aP=wo.clearImmediate,Rwe=wo.process,sP=wo.Dispatch,Nwe=wo.Function,N$=wo.MessageChannel,Awe=wo.String,oP=0,L_={},A$="onreadystatechange";T$(function(){D_=wo.location});var cP=function(r){if(wwe(L_,r)){var a=L_[r];delete L_[r],a()}},lP=function(r){return function(){cP(r)}},I$=function(r){cP(r.data)},O$=function(r){wo.postMessage(Awe(r),D_.protocol+"//"+D_.host)};iP&&aP||(iP=function(r){xwe(arguments.length,1);var a=x$(r)?r:Nwe(r),s=Swe(arguments,1);return L_[++oP]=function(){bwe(a,void 0,s)},Hm(oP),oP},aP=function(r){delete L_[r]},Cwe?Hm=function(r){Rwe.nextTick(lP(r))}:sP&&sP.now?Hm=function(r){sP.now(lP(r))}:N$&&!Twe?(nP=(E$=new N$).port2,E$.port1.onmessage=I$,Hm=Ewe(nP.postMessage,nP)):wo.addEventListener&&x$(wo.postMessage)&&!wo.importScripts&&D_&&D_.protocol!=="file:"&&!T$(O$)?(Hm=O$,wo.addEventListener("message",I$,!1)):Hm=A$ in R$("script")?function(r){C$.appendChild(R$("script"))[A$]=function(){C$.removeChild(this),cP(r)}}:function(r){setTimeout(lP(r),0)});var FS={set:iP,clear:aP},P$=R,Iwe=X,Owe=Object.getOwnPropertyDescriptor,k$=function(r){if(!Iwe)return P$[r];var a=Owe(P$,r);return a&&a.value},j$=function(){this.head=null,this.tail=null};j$.prototype={add:function(r){var a={item:r,next:null},s=this.tail;s?s.next=a:this.head=a,this.tail=a},get:function(){var r=this.head;if(r)return(this.head=r.next)===null&&(this.tail=null),r.item}};var zm,uP,dP,hP,D$,L$=j$,Pwe=/ipad|iphone|ipod/i.test(gn)&&typeof Pebble<"u",kwe=/web0s(?!.*chrome)/i.test(gn),Km=R,jwe=k$,M$=Qd,fP=FS.set,Dwe=L$,Lwe=S$,Mwe=Pwe,Uwe=kwe,pP=bS,U$=Km.MutationObserver||Km.WebKitMutationObserver,F$=Km.document,V$=Km.process,VS=Km.Promise,mP=jwe("queueMicrotask");if(!mP){var BS=new Dwe,$S=function(){var r,a;for(pP&&(r=V$.domain)&&r.exit();a=BS.get();)try{a()}catch(s){throw BS.head&&zm(),s}r&&r.enter()};Lwe||pP||Uwe||!U$||!F$?!Mwe&&VS&&VS.resolve?((hP=VS.resolve(void 0)).constructor=VS,D$=M$(hP.then,hP),zm=function(){D$($S)}):pP?zm=function(){V$.nextTick($S)}:(fP=M$(fP,Km),zm=function(){fP($S)}):(uP=!0,dP=F$.createTextNode(""),new U$($S).observe(dP,{characterData:!0}),zm=function(){dP.data=uP=!uP}),mP=function(r){BS.head||zm(),BS.add(r)}}var B$=mP,qm=function(r){try{return{error:!1,value:r()}}catch(a){return{error:!0,value:a}}},qf=R.Promise,Fwe=R,M_=qf,Vwe=z,Bwe=h5,$we=g$,Wwe=qr,$$=OO,gP=Gi,W$=M_&&M_.prototype,Gwe=Wwe("species"),G$=Vwe(Fwe.PromiseRejectionEvent),Hwe=Bwe("Promise",function(){var r=$we(M_),a=r!==String(M_);if(!a&&gP===66||!W$.catch||!W$.finally)return!0;if(!gP||gP<51||!/native code/.test(r)){var s=new M_(function(d){d(1)}),l=function(d){d(function(){},function(){})};if((s.constructor={})[Gwe]=l,!(s.then(function(){})instanceof l))return!0}return!(a||$$!=="BROWSER"&&$$!=="DENO"||G$)}),U_={CONSTRUCTOR:Hwe,REJECTION_EVENT:G$},Xl={},H$=wi,zwe=TypeError,Kwe=function(r){var a,s;this.promise=new r(function(l,d){if(a!==void 0||s!==void 0)throw new zwe("Bad Promise constructor");a=l,s=d}),this.resolve=H$(a),this.reject=H$(s)};Xl.f=function(r){return new Kwe(r)};var vP,z$,qwe=Tn,WS=bS,ih=R,F_=J,Ywe=nh,Xwe=Zu,Jwe=function(r){var a=ewe(r);nwe&&a&&!a[m$]&&twe(a,m$,{configurable:!0,get:function(){return this}})},Zwe=wi,yP=z,Qwe=Rt,eSe=QO,tSe=rP,K$=FS.set,_P=B$,nSe=function(r,a){try{arguments.length===1?console.error(r):console.error(r,a)}catch{}},rSe=qm,iSe=L$,q$=zf,bP=qf,Y$=U_,X$=Xl,GS="Promise",J$=Y$.CONSTRUCTOR,aSe=Y$.REJECTION_EVENT,EP=q$.getterFor(GS),sSe=q$.set,oSe=bP&&bP.prototype,V_=bP,wP=oSe,Z$=ih.TypeError,SP=ih.document,xP=ih.process,TP=X$.f,cSe=TP,lSe=!!(SP&&SP.createEvent&&ih.dispatchEvent),Q$="unhandledrejection",e6=function(r){var a;return!(!Qwe(r)||!yP(a=r.then))&&a},t6=function(r,a){var s,l,d,f=a.value,m=a.state===1,y=m?r.ok:r.fail,_=r.resolve,S=r.reject,x=r.domain;try{y?(m||(a.rejection===2&&dSe(a),a.rejection=1),y===!0?s=f:(x&&x.enter(),s=y(f),x&&(x.exit(),d=!0)),s===r.promise?S(new Z$("Promise-chain cycle")):(l=e6(s))?F_(l,s,_,S):_(s)):S(f)}catch(A){x&&!d&&x.exit(),S(A)}},n6=function(r,a){r.notified||(r.notified=!0,_P(function(){for(var s,l=r.reactions;s=l.get();)t6(s,r);r.notified=!1,a&&!r.rejection&&uSe(r)}))},r6=function(r,a,s){var l,d;lSe?((l=SP.createEvent("Event")).promise=a,l.reason=s,l.initEvent(r,!1,!0),ih.dispatchEvent(l)):l={promise:a,reason:s},!aSe&&(d=ih["on"+r])?d(l):r===Q$&&nSe("Unhandled promise rejection",s)},uSe=function(r){F_(K$,ih,function(){var a,s=r.facade,l=r.value;if(i6(r)&&(a=rSe(function(){WS?xP.emit("unhandledRejection",l,s):r6(Q$,s,l)}),r.rejection=WS||i6(r)?2:1,a.error))throw a.value})},i6=function(r){return r.rejection!==1&&!r.parent},dSe=function(r){F_(K$,ih,function(){var a=r.facade;WS?xP.emit("rejectionHandled",a):r6("rejectionhandled",a,r.value)})},Ym=function(r,a,s){return function(l){r(a,l,s)}},Xm=function(r,a,s){r.done||(r.done=!0,s&&(r=s),r.value=a,r.state=2,n6(r,!0))},CP=function(r,a,s){if(!r.done){r.done=!0,s&&(r=s);try{if(r.facade===a)throw new Z$("Promise can't be resolved itself");var l=e6(a);l?_P(function(){var d={done:!1};try{F_(l,a,Ym(CP,d,r),Ym(Xm,d,r))}catch(f){Xm(d,f,r)}}):(r.value=a,r.state=1,n6(r,!1))}catch(d){Xm({done:!1},d,r)}}};J$&&(wP=(V_=function(r){eSe(this,wP),Zwe(r),F_(vP,this);var a=EP(this);try{r(Ym(CP,a),Ym(Xm,a))}catch(s){Xm(a,s)}}).prototype,(vP=function(r){sSe(this,{type:GS,done:!1,notified:!1,parent:!1,reactions:new iSe,rejection:!1,state:0,value:null})}).prototype=Ywe(wP,"then",function(r,a){var s=EP(this),l=TP(tSe(this,V_));return s.parent=!0,l.ok=!yP(r)||r,l.fail=yP(a)&&a,l.domain=WS?xP.domain:void 0,s.state===0?s.reactions.add(l):_P(function(){t6(l,s)}),l.promise}),z$=function(){var r=new vP,a=EP(r);this.promise=r,this.resolve=Ym(CP,a),this.reject=Ym(Xm,a)},X$.f=TP=function(r){return r===V_||r===void 0?new z$(r):cSe(r)}),qwe({global:!0,wrap:!0,forced:J$},{Promise:V_}),Xwe(V_,GS,!1,!0),Jwe(GS);var a6=qr("iterator"),s6=!1;try{var hSe=0,o6={next:function(){return{done:!!hSe++}},return:function(){s6=!0}};o6[a6]=function(){return this},Array.from(o6,function(){throw 2})}catch{}var fSe=qf,pSe=function(r,a){try{if(!a&&!s6)return!1}catch{return!1}var s=!1;try{var l={};l[a6]=function(){return{next:function(){return{done:s=!0}}}},r(l)}catch{}return s},HS=U_.CONSTRUCTOR||!pSe(function(r){fSe.all(r).then(void 0,function(){})}),mSe=J,gSe=wi,vSe=Xl,ySe=qm,_Se=P_;Tn({target:"Promise",stat:!0,forced:HS},{all:function(r){var a=this,s=vSe.f(a),l=s.resolve,d=s.reject,f=ySe(function(){var m=gSe(a.resolve),y=[],_=0,S=1;_Se(r,function(x){var A=_++,I=!1;S++,mSe(m,a,x).then(function(L){I||(I=!0,y[A]=L,--S||l(y))},d)}),--S||l(y)});return f.error&&d(f.value),s.promise}});var bSe=Tn,ESe=U_.CONSTRUCTOR;qf&&qf.prototype,bSe({target:"Promise",proto:!0,forced:ESe,real:!0},{catch:function(r){return this.then(void 0,r)}});var wSe=J,SSe=wi,xSe=Xl,TSe=qm,CSe=P_;Tn({target:"Promise",stat:!0,forced:HS},{race:function(r){var a=this,s=xSe.f(a),l=s.reject,d=TSe(function(){var f=SSe(a.resolve);CSe(r,function(m){wSe(f,a,m).then(s.resolve,l)})});return d.error&&l(d.value),s.promise}});var RSe=Xl;Tn({target:"Promise",stat:!0,forced:U_.CONSTRUCTOR},{reject:function(r){var a=RSe.f(this);return(0,a.reject)(r),a.promise}});var NSe=Ts,ASe=Rt,ISe=Xl,c6=function(r,a){if(NSe(r),ASe(a)&&a.constructor===r)return a;var s=ISe.f(r);return(0,s.resolve)(a),s.promise},OSe=Tn,PSe=qf,kSe=U_.CONSTRUCTOR,jSe=c6,DSe=ot("Promise"),LSe=!kSe;OSe({target:"Promise",stat:!0,forced:!0},{resolve:function(r){return jSe(LSe&&this===DSe?PSe:this,r)}});var MSe=J,USe=wi,FSe=Xl,VSe=qm,BSe=P_;Tn({target:"Promise",stat:!0,forced:HS},{allSettled:function(r){var a=this,s=FSe.f(a),l=s.resolve,d=s.reject,f=VSe(function(){var m=USe(a.resolve),y=[],_=0,S=1;BSe(r,function(x){var A=_++,I=!1;S++,MSe(m,a,x).then(function(L){I||(I=!0,y[A]={status:"fulfilled",value:L},--S||l(y))},function(L){I||(I=!0,y[A]={status:"rejected",reason:L},--S||l(y))})}),--S||l(y)});return f.error&&d(f.value),s.promise}});var $Se=J,WSe=wi,GSe=ot,HSe=Xl,zSe=qm,KSe=P_,l6="No one promise resolved";Tn({target:"Promise",stat:!0,forced:HS},{any:function(r){var a=this,s=GSe("AggregateError"),l=HSe.f(a),d=l.resolve,f=l.reject,m=zSe(function(){var y=WSe(a.resolve),_=[],S=0,x=1,A=!1;KSe(r,function(I){var L=S++,K=!1;x++,$Se(y,a,I).then(function($){K||A||(A=!0,d($))},function($){K||A||(K=!0,_[L]=$,--x||f(new s(_,l6)))})}),--x||f(new s(_,l6))});return m.error&&f(m.value),l.promise}});var qSe=Tn,YSe=P,XSe=rh,JSe=Xl,ZSe=wi,u6=qm,RP=R.Promise,d6=!1;qSe({target:"Promise",stat:!0,forced:!RP||!RP.try||u6(function(){RP.try(function(r){d6=r===8},8)}).error||!d6},{try:function(r){var a=arguments.length>1?XSe(arguments,1):[],s=JSe.f(this),l=u6(function(){return YSe(ZSe(r),void 0,a)});return(l.error?s.reject:s.resolve)(l.value),s.promise}});var QSe=Xl;Tn({target:"Promise",stat:!0},{withResolvers:function(){var r=QSe.f(this);return{promise:r.promise,resolve:r.resolve,reject:r.reject}}});var exe=Tn,NP=qf,txe=u,nxe=ot,rxe=z,ixe=rP,h6=c6,axe=NP&&NP.prototype;exe({target:"Promise",proto:!0,real:!0,forced:!!NP&&txe(function(){axe.finally.call({then:function(){}},function(){})})},{finally:function(r){var a=ixe(this,nxe("Promise")),s=rxe(r);return this.then(s?function(l){return h6(a,r()).then(function(){return l})}:r,s?function(l){return h6(a,r()).then(function(){throw l})}:r)}});var AP=E,sxe=TO,oxe=Hs,cxe=Pt,lxe=AP("".charAt),f6=AP("".charCodeAt),uxe=AP("".slice),p6=function(r){return function(a,s){var l,d,f=oxe(cxe(a)),m=sxe(s),y=f.length;return m<0||m>=y?r?"":void 0:(l=f6(f,m))<55296||l>56319||m+1===y||(d=f6(f,m+1))<56320||d>57343?r?lxe(f,m):l:r?uxe(f,m,m+2):d-56320+(l-55296<<10)+65536}},IP={codeAt:p6(!1),charAt:p6(!0)},dxe=IP.charAt,hxe=Hs,m6=zf,fxe=d$,g6=DS,v6="String Iterator",pxe=m6.set,mxe=m6.getterFor(v6);fxe(String,"String",function(r){pxe(this,{type:v6,string:hxe(r),index:0})},function(){var r,a=mxe(this),s=a.string,l=a.index;return l>=s.length?g6(void 0,!0):(r=dxe(s,l),a.index+=r.length,g6(r,!1))});var gxe=Le.Promise,vxe={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},yxe=R,_xe=Zu,y6=$m;for(var OP in vxe)_xe(yxe[OP],OP),y6[OP]=y6.Array;var _6=gxe,He=o(_6),bxe=nc("Array","values"),Exe=th,wxe=aa,Sxe=T,xxe=bxe,PP=Array.prototype,Txe={DOMTokenList:!0,NodeList:!0},Cxe=function(r){var a=r.values;return r===PP||Sxe(PP,r)&&a===PP.values||wxe(Txe,Exe(r))?xxe:a},Cs=o(Cxe),b6=nr,Rxe=TypeError,E6=rh,Nxe=Math.floor,kP=function(r,a){var s=r.length;if(s<8)for(var l,d,f=1;f<s;){for(d=f,l=r[f];d&&a(r[d-1],l)>0;)r[d]=r[--d];d!==f++&&(r[d]=l)}else for(var m=Nxe(s/2),y=kP(E6(r,0,m),a),_=kP(E6(r,m),a),S=y.length,x=_.length,A=0,I=0;A<S||I<x;)r[A+I]=A<S&&I<x?a(y[A],_[I])<=0?y[A++]:_[I++]:A<S?y[A++]:_[I++];return r},w6=kP,S6=gn.match(/firefox\/(\d+)/i),Axe=!!S6&&+S6[1],Ixe=/MSIE|Trident/.test(gn),x6=gn.match(/AppleWebKit\/(\d+)\./),Oxe=!!x6&&+x6[1],Pxe=Tn,T6=E,kxe=wi,jxe=ql,C6=eh,Dxe=function(r,a){if(!delete r[a])throw new Rxe("Cannot delete property "+b6(a)+" of "+b6(r))},R6=Hs,jP=u,Lxe=w6,Mxe=yS,N6=Axe,Uxe=Ixe,A6=Gi,I6=Oxe,ah=[],O6=T6(ah.sort),Fxe=T6(ah.push),Vxe=jP(function(){ah.sort(void 0)}),Bxe=jP(function(){ah.sort(null)}),$xe=Mxe("sort"),P6=!jP(function(){if(A6)return A6<70;if(!(N6&&N6>3)){if(Uxe)return!0;if(I6)return I6<603;var r,a,s,l,d="";for(r=65;r<76;r++){switch(a=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(l=0;l<47;l++)ah.push({k:a+l,v:s})}for(ah.sort(function(f,m){return m.v-f.v}),l=0;l<ah.length;l++)a=ah[l].k.charAt(0),d.charAt(d.length-1)!==a&&(d+=a);return d!=="DGBEFHACIJK"}});Pxe({target:"Array",proto:!0,forced:Vxe||!Bxe||!$xe||!P6},{sort:function(r){r!==void 0&&kxe(r);var a=jxe(this);if(P6)return r===void 0?O6(a):O6(a,r);var s,l,d=[],f=C6(a);for(l=0;l<f;l++)l in a&&Fxe(d,a[l]);for(Lxe(d,function(m){return function(y,_){return _===void 0?-1:y===void 0?1:m!==void 0?+m(y,_)||0:R6(y)>R6(_)?1:-1}}(r)),s=C6(d),l=0;l<s;)a[l]=d[l++];for(;l<f;)Dxe(a,l++);return a}});var Wxe=nc("Array","sort"),Gxe=T,Hxe=Wxe,DP=Array.prototype,zxe=function(r){var a=r.sort;return r===DP||Gxe(DP,r)&&a===DP.sort?Hxe:a},Yf=o(zxe),Kxe=Tn,qxe=E,Yxe=CO,Xxe=RangeError,k6=String.fromCharCode,j6=String.fromCodePoint,Jxe=qxe([].join);Kxe({target:"String",stat:!0,forced:!!j6&&j6.length!==1},{fromCodePoint:function(r){for(var a,s=[],l=arguments.length,d=0;l>d;){if(a=+arguments[d++],Yxe(a,1114111)!==a)throw new Xxe(a+" is not a valid code point");s[d]=a<65536?k6(a):k6(55296+((a-=65536)>>10),a%1024+56320)}return Jxe(s,"")}});var Zxe=u,Qxe=qr("iterator"),zS=!Zxe(function(){var r=new URL("b?a=1&b=2&c=3","https://a"),a=r.searchParams,s=new URLSearchParams("a=1&a=2&b=3"),l="";return r.pathname="c%20d",a.forEach(function(d,f){a.delete("b"),l+=f+d}),s.delete("a",2),s.delete("b",void 0),!r.toJSON||!s.has("a",1)||s.has("a",2)||!s.has("a",void 0)||s.has("b")||!a.size&&!0||!a.sort||r.href!=="https://a/c%20d?a=1&c=3"||a.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!a[Qxe]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||l!=="a1c3"||new URL("https://x",void 0).host!=="x"}),eTe=nh,LP=Tn,D6=R,MP=k$,tTe=ot,KS=J,Kc=E,B_=X,L6=zS,M6=nh,nTe=MS,rTe=function(r,a,s){for(var l in a)s&&s.unsafe&&r[l]?r[l]=a[l]:eTe(r,l,a[l],s);return r},iTe=Zu,aTe=JO,UP=zf,U6=QO,FP=z,sTe=aa,oTe=Qd,cTe=th,lTe=Ts,F6=Rt,Rs=Hs,uTe=O_,V6=Pe,B6=$O,dTe=RS,qS=DS,Jm=Kf,hTe=w6,fTe=qr("iterator"),Zm="URLSearchParams",$6=Zm+"Iterator",W6=UP.set,ic=UP.getterFor(Zm),pTe=UP.getterFor($6),G6=MP("fetch"),YS=MP("Request"),$_=MP("Headers"),VP=YS&&YS.prototype,H6=$_&&$_.prototype,mTe=D6.TypeError,gTe=D6.encodeURIComponent,vTe=String.fromCharCode,yTe=tTe("String","fromCodePoint"),_Te=parseInt,XS=Kc("".charAt),z6=Kc([].join),sh=Kc([].push),K6=Kc("".replace),bTe=Kc([].shift),q6=Kc([].splice),Y6=Kc("".split),X6=Kc("".slice),ETe=Kc(/./.exec),wTe=/\+/g,STe=/^[0-9a-f]+$/i,J6=function(r,a){var s=X6(r,a,a+2);return ETe(STe,s)?_Te(s,16):NaN},xTe=function(r){for(var a=0,s=128;s>0&&r&s;s>>=1)a++;return a},TTe=function(r){var a=null;switch(r.length){case 1:a=r[0];break;case 2:a=(31&r[0])<<6|63&r[1];break;case 3:a=(15&r[0])<<12|(63&r[1])<<6|63&r[2];break;case 4:a=(7&r[0])<<18|(63&r[1])<<12|(63&r[2])<<6|63&r[3]}return a>1114111?null:a},Z6=function(r){for(var a=(r=K6(r,wTe," ")).length,s="",l=0;l<a;){var d=XS(r,l);if(d==="%"){if(XS(r,l+1)==="%"||l+3>a){s+="%",l++;continue}var f=J6(r,l+1);if(f!=f){s+=d,l++;continue}l+=2;var m=xTe(f);if(m===0)d=vTe(f);else{if(m===1||m>4){s+="�",l++;continue}for(var y=[f],_=1;_<m&&!(++l+3>a||XS(r,l)!=="%");){var S=J6(r,l+1);if(S!=S){l+=3;break}if(S>191||S<128)break;sh(y,S),l+=2,_++}if(y.length!==m){s+="�";continue}var x=TTe(y);x===null?s+="�":d=yTe(x)}}s+=d,l++}return s},CTe=/[!'()~]|%20/g,RTe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},NTe=function(r){return RTe[r]},Q6=function(r){return K6(gTe(r),CTe,NTe)},BP=aTe(function(r,a){W6(this,{type:$6,target:ic(r).entries,index:0,kind:a})},Zm,function(){var r=pTe(this),a=r.target,s=r.index++;if(!a||s>=a.length)return r.target=null,qS(void 0,!0);var l=a[s];switch(r.kind){case"keys":return qS(l.key,!1);case"values":return qS(l.value,!1)}return qS([l.key,l.value],!1)},!0),e8=function(r){this.entries=[],this.url=null,r!==void 0&&(F6(r)?this.parseObject(r):this.parseQuery(typeof r=="string"?XS(r,0)==="?"?X6(r,1):r:Rs(r)))};e8.prototype={type:Zm,bindURL:function(r){this.url=r,this.update()},parseObject:function(r){var a,s,l,d,f,m,y,_=this.entries,S=dTe(r);if(S)for(s=(a=B6(r,S)).next;!(l=KS(s,a)).done;){if(f=(d=B6(lTe(l.value))).next,(m=KS(f,d)).done||(y=KS(f,d)).done||!KS(f,d).done)throw new mTe("Expected sequence with length 2");sh(_,{key:Rs(m.value),value:Rs(y.value)})}else for(var x in r)sTe(r,x)&&sh(_,{key:x,value:Rs(r[x])})},parseQuery:function(r){if(r)for(var a,s,l=this.entries,d=Y6(r,"&"),f=0;f<d.length;)(a=d[f++]).length&&(s=Y6(a,"="),sh(l,{key:Z6(bTe(s)),value:Z6(z6(s,"="))}))},serialize:function(){for(var r,a=this.entries,s=[],l=0;l<a.length;)r=a[l++],sh(s,Q6(r.key)+"="+Q6(r.value));return z6(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var JS=function(){U6(this,Qm);var r=W6(this,new e8(arguments.length>0?arguments[0]:void 0));B_||(this.size=r.entries.length)},Qm=JS.prototype;if(rTe(Qm,{append:function(r,a){var s=ic(this);Jm(arguments.length,2),sh(s.entries,{key:Rs(r),value:Rs(a)}),B_||this.length++,s.updateURL()},delete:function(r){for(var a=ic(this),s=Jm(arguments.length,1),l=a.entries,d=Rs(r),f=s<2?void 0:arguments[1],m=f===void 0?f:Rs(f),y=0;y<l.length;){var _=l[y];if(_.key!==d||m!==void 0&&_.value!==m)y++;else if(q6(l,y,1),m!==void 0)break}B_||(this.size=l.length),a.updateURL()},get:function(r){var a=ic(this).entries;Jm(arguments.length,1);for(var s=Rs(r),l=0;l<a.length;l++)if(a[l].key===s)return a[l].value;return null},getAll:function(r){var a=ic(this).entries;Jm(arguments.length,1);for(var s=Rs(r),l=[],d=0;d<a.length;d++)a[d].key===s&&sh(l,a[d].value);return l},has:function(r){for(var a=ic(this).entries,s=Jm(arguments.length,1),l=Rs(r),d=s<2?void 0:arguments[1],f=d===void 0?d:Rs(d),m=0;m<a.length;){var y=a[m++];if(y.key===l&&(f===void 0||y.value===f))return!0}return!1},set:function(r,a){var s=ic(this);Jm(arguments.length,1);for(var l,d=s.entries,f=!1,m=Rs(r),y=Rs(a),_=0;_<d.length;_++)(l=d[_]).key===m&&(f?q6(d,_--,1):(f=!0,l.value=y));f||sh(d,{key:m,value:y}),B_||(this.size=d.length),s.updateURL()},sort:function(){var r=ic(this);hTe(r.entries,function(a,s){return a.key>s.key?1:-1}),r.updateURL()},forEach:function(r){for(var a,s=ic(this).entries,l=oTe(r,arguments.length>1?arguments[1]:void 0),d=0;d<s.length;)l((a=s[d++]).value,a.key,this)},keys:function(){return new BP(this,"keys")},values:function(){return new BP(this,"values")},entries:function(){return new BP(this,"entries")}},{enumerable:!0}),M6(Qm,fTe,Qm.entries,{}),M6(Qm,"toString",function(){return ic(this).serialize()},{enumerable:!0}),B_&&nTe(Qm,"size",{get:function(){return ic(this).entries.length},configurable:!0,enumerable:!0}),iTe(JS,Zm),LP({global:!0,forced:!L6},{URLSearchParams:JS}),!L6&&FP($_)){var ATe=Kc(H6.has),ITe=Kc(H6.set),t8=function(r){if(F6(r)){var a,s=r.body;if(cTe(s)===Zm)return a=r.headers?new $_(r.headers):new $_,ATe(a,"content-type")||ITe(a,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),uTe(r,{body:V6(0,Rs(s)),headers:V6(0,a)})}return r};if(FP(G6)&&LP({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(r){return G6(r,arguments.length>1?t8(arguments[1]):{})}}),FP(YS)){var $P=function(r){return U6(this,VP),new YS(r,arguments.length>1?t8(arguments[1]):{})};VP.constructor=$P,$P.prototype=VP,LP({global:!0,dontCallGetSet:!0,forced:!0},{Request:$P})}}var ac,OTe={URLSearchParams:JS,getState:ic},PTe=Le.URLSearchParams,n8=X,kTe=E,jTe=J,DTe=u,WP=xS,LTe=I_,MTe=re,UTe=ql,FTe=$e,eg=Object.assign,r8=Object.defineProperty,VTe=kTe([].concat),BTe=!eg||DTe(function(){if(n8&&eg({b:1},eg(r8({},"a",{enumerable:!0,get:function(){r8(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},a={},s=Symbol("assign detection"),l="abcdefghijklmnopqrst";return r[s]=7,l.split("").forEach(function(d){a[d]=d}),eg({},r)[s]!==7||WP(eg({},a)).join("")!==l})?function(r,a){for(var s=UTe(r),l=arguments.length,d=1,f=LTe.f,m=MTe.f;l>d;)for(var y,_=FTe(arguments[d++]),S=f?VTe(WP(_),f(_)):WP(_),x=S.length,A=0;x>A;)y=S[A++],n8&&!jTe(m,_,y)||(s[y]=_[y]);return s}:eg,$Te=Ts,WTe=G5,GTe=X,HTe=tc,zTe=Pe,GP=function(r,a,s){GTe?HTe.f(r,a,zTe(0,s)):r[a]=s},KTe=Qd,qTe=J,YTe=ql,XTe=function(r,a,s,l){try{return l?a($Te(s)[0],s[1]):a(s)}catch(d){WTe(r,"throw",d)}},JTe=B5,ZTe=US,QTe=eh,i8=GP,eCe=$O,tCe=RS,a8=Array,Xf=E,HP=2147483647,nCe=/[^\0-\u007E]/,s8=/[.\u3002\uFF0E\uFF61]/g,o8="Overflow: input needs wider integers to process",c8=RangeError,rCe=Xf(s8.exec),tg=Math.floor,zP=String.fromCharCode,l8=Xf("".charCodeAt),u8=Xf([].join),oh=Xf([].push),iCe=Xf("".replace),aCe=Xf("".split),sCe=Xf("".toLowerCase),d8=function(r){return r+22+75*(r<26)},oCe=function(r,a,s){var l=0;for(r=s?tg(r/700):r>>1,r+=tg(r/a);r>455;)r=tg(r/35),l+=36;return tg(l+36*r/(r+38))},cCe=function(r){var a=[];r=function(ne){for(var te=[],ce=0,pe=ne.length;ce<pe;){var fe=l8(ne,ce++);if(fe>=55296&&fe<=56319&&ce<pe){var ue=l8(ne,ce++);(64512&ue)==56320?oh(te,((1023&fe)<<10)+(1023&ue)+65536):(oh(te,fe),ce--)}else oh(te,fe)}return te}(r);var s,l,d=r.length,f=128,m=0,y=72;for(s=0;s<r.length;s++)(l=r[s])<128&&oh(a,zP(l));var _=a.length,S=_;for(_&&oh(a,"-");S<d;){var x=HP;for(s=0;s<r.length;s++)(l=r[s])>=f&&l<x&&(x=l);var A=S+1;if(x-f>tg((HP-m)/A))throw new c8(o8);for(m+=(x-f)*A,f=x,s=0;s<r.length;s++){if((l=r[s])<f&&++m>HP)throw new c8(o8);if(l===f){for(var I=m,L=36;;){var K=L<=y?1:L>=y+26?26:L-y;if(I<K)break;var $=I-K,G=36-K;oh(a,zP(d8(K+$%G))),I=tg($/G),L+=36}oh(a,zP(d8(I))),y=oCe(m,A,S===_),m=0,S++}}m++,f++}return u8(a,"")},lCe=Tn,KP=X,uCe=zS,qP=R,h8=Qd,sc=E,ZS=nh,oc=MS,dCe=QO,YP=aa,XP=BTe,ng=function(r){var a=YTe(r),s=ZTe(this),l=arguments.length,d=l>1?arguments[1]:void 0,f=d!==void 0;f&&(d=KTe(d,l>2?arguments[2]:void 0));var m,y,_,S,x,A,I=tCe(a),L=0;if(!I||this===a8&&JTe(I))for(m=QTe(a),y=s?new this(m):a8(m);m>L;L++)A=f?d(a[L],L):a[L],i8(y,L,A);else for(y=s?new this:[],x=(S=eCe(a,I)).next;!(_=qTe(x,S)).done;L++)A=f?XTe(S,d,[_.value,L],!0):_.value,i8(y,L,A);return y.length=L,y},qc=rh,hCe=IP.codeAt,fCe=function(r){var a,s,l=[],d=aCe(iCe(sCe(r),s8,"."),".");for(a=0;a<d.length;a++)s=d[a],oh(l,rCe(nCe,s)?"xn--"+cCe(s):s);return u8(l,".")},Qu=Hs,pCe=Zu,mCe=Kf,f8=OTe,p8=zf,gCe=p8.set,QS=p8.getterFor("URL"),vCe=f8.URLSearchParams,yCe=f8.getState,W_=qP.URL,JP=qP.TypeError,ex=qP.parseInt,_Ce=Math.floor,m8=Math.pow,cc=sc("".charAt),Yc=sc(/./.exec),G_=sc([].join),bCe=sc(1 .toString),ECe=sc([].pop),rg=sc([].push),ZP=sc("".replace),wCe=sc([].shift),SCe=sc("".split),H_=sc("".slice),tx=sc("".toLowerCase),xCe=sc([].unshift),QP="Invalid scheme",Jf="Invalid host",g8="Invalid port",v8=/[a-z]/i,TCe=/[\d+-.a-z]/i,ek=/\d/,CCe=/^0x/i,RCe=/^[0-7]+$/,NCe=/^\d+$/,y8=/^[\da-f]+$/i,ACe=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ICe=/[\0\t\n\r #/:<>?@[\\\]^|]/,OCe=/^[\u0000-\u0020]+/,PCe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,kCe=/[\t\n\r]/g,z_=function(r){var a,s,l,d;if(typeof r=="number"){for(a=[],s=0;s<4;s++)xCe(a,r%256),r=_Ce(r/256);return G_(a,".")}if(typeof r=="object"){for(a="",l=function(f){for(var m=null,y=1,_=null,S=0,x=0;x<8;x++)f[x]!==0?(S>y&&(m=_,y=S),_=null,S=0):(_===null&&(_=x),++S);return S>y?_:m}(r),s=0;s<8;s++)d&&r[s]===0||(d&&(d=!1),l===s?(a+=s?":":"::",d=!0):(a+=bCe(r[s],16),s<7&&(a+=":")));return"["+a+"]"}return r},nx={},_8=XP({},nx,{" ":1,'"':1,"<":1,">":1,"`":1}),b8=XP({},_8,{"#":1,"?":1,"{":1,"}":1}),tk=XP({},b8,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ch=function(r,a){var s=hCe(r,0);return s>32&&s<127&&!YP(a,r)?r:encodeURIComponent(r)},rx={ftp:21,file:null,http:80,https:443,ws:80,wss:443},K_=function(r,a){var s;return r.length===2&&Yc(v8,cc(r,0))&&((s=cc(r,1))===":"||!a&&s==="|")},E8=function(r){var a;return r.length>1&&K_(H_(r,0,2))&&(r.length===2||(a=cc(r,2))==="/"||a==="\\"||a==="?"||a==="#")},jCe=function(r){return r==="."||tx(r)==="%2e"},nk={},w8={},rk={},S8={},x8={},ik={},T8={},C8={},ix={},ax={},ak={},sk={},ok={},ck={},R8={},lk={},ig={},Jl={},N8={},Zf={},ed={},uk=function(r,a,s){var l,d,f,m=Qu(r);if(a){if(d=this.parse(m))throw new JP(d);this.searchParams=null}else{if(s!==void 0&&(l=new uk(s,!0)),d=this.parse(m,null,l))throw new JP(d);(f=yCe(new vCe)).bindURL(this),this.searchParams=f}};uk.prototype={type:"URL",parse:function(r,a,s){var l,d,f,m,y,_=this,S=a||nk,x=0,A="",I=!1,L=!1,K=!1;for(r=Qu(r),a||(_.scheme="",_.username="",_.password="",_.host=null,_.port=null,_.path=[],_.query=null,_.fragment=null,_.cannotBeABaseURL=!1,r=ZP(r,OCe,""),r=ZP(r,PCe,"$1")),r=ZP(r,kCe,""),l=ng(r);x<=l.length;){switch(d=l[x],S){case nk:if(!d||!Yc(v8,d)){if(a)return QP;S=rk;continue}A+=tx(d),S=w8;break;case w8:if(d&&(Yc(TCe,d)||d==="+"||d==="-"||d==="."))A+=tx(d);else{if(d!==":"){if(a)return QP;A="",S=rk,x=0;continue}if(a&&(_.isSpecial()!==YP(rx,A)||A==="file"&&(_.includesCredentials()||_.port!==null)||_.scheme==="file"&&!_.host))return;if(_.scheme=A,a)return void(_.isSpecial()&&rx[_.scheme]===_.port&&(_.port=null));A="",_.scheme==="file"?S=ck:_.isSpecial()&&s&&s.scheme===_.scheme?S=S8:_.isSpecial()?S=C8:l[x+1]==="/"?(S=x8,x++):(_.cannotBeABaseURL=!0,rg(_.path,""),S=N8)}break;case rk:if(!s||s.cannotBeABaseURL&&d!=="#")return QP;if(s.cannotBeABaseURL&&d==="#"){_.scheme=s.scheme,_.path=qc(s.path),_.query=s.query,_.fragment="",_.cannotBeABaseURL=!0,S=ed;break}S=s.scheme==="file"?ck:ik;continue;case S8:if(d!=="/"||l[x+1]!=="/"){S=ik;continue}S=ix,x++;break;case x8:if(d==="/"){S=ax;break}S=Jl;continue;case ik:if(_.scheme=s.scheme,d===ac)_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=qc(s.path),_.query=s.query;else if(d==="/"||d==="\\"&&_.isSpecial())S=T8;else if(d==="?")_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=qc(s.path),_.query="",S=Zf;else{if(d!=="#"){_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=qc(s.path),_.path.length--,S=Jl;continue}_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,_.path=qc(s.path),_.query=s.query,_.fragment="",S=ed}break;case T8:if(!_.isSpecial()||d!=="/"&&d!=="\\"){if(d!=="/"){_.username=s.username,_.password=s.password,_.host=s.host,_.port=s.port,S=Jl;continue}S=ax}else S=ix;break;case C8:if(S=ix,d!=="/"||cc(A,x+1)!=="/")continue;x++;break;case ix:if(d!=="/"&&d!=="\\"){S=ax;continue}break;case ax:if(d==="@"){I&&(A="%40"+A),I=!0,f=ng(A);for(var $=0;$<f.length;$++){var G=f[$];if(G!==":"||K){var ne=ch(G,tk);K?_.password+=ne:_.username+=ne}else K=!0}A=""}else if(d===ac||d==="/"||d==="?"||d==="#"||d==="\\"&&_.isSpecial()){if(I&&A==="")return"Invalid authority";x-=ng(A).length+1,A="",S=ak}else A+=d;break;case ak:case sk:if(a&&_.scheme==="file"){S=lk;continue}if(d!==":"||L){if(d===ac||d==="/"||d==="?"||d==="#"||d==="\\"&&_.isSpecial()){if(_.isSpecial()&&A==="")return Jf;if(a&&A===""&&(_.includesCredentials()||_.port!==null))return;if(m=_.parseHost(A))return m;if(A="",S=ig,a)return;continue}d==="["?L=!0:d==="]"&&(L=!1),A+=d}else{if(A==="")return Jf;if(m=_.parseHost(A))return m;if(A="",S=ok,a===sk)return}break;case ok:if(!Yc(ek,d)){if(d===ac||d==="/"||d==="?"||d==="#"||d==="\\"&&_.isSpecial()||a){if(A!==""){var te=ex(A,10);if(te>65535)return g8;_.port=_.isSpecial()&&te===rx[_.scheme]?null:te,A=""}if(a)return;S=ig;continue}return g8}A+=d;break;case ck:if(_.scheme="file",d==="/"||d==="\\")S=R8;else{if(!s||s.scheme!=="file"){S=Jl;continue}switch(d){case ac:_.host=s.host,_.path=qc(s.path),_.query=s.query;break;case"?":_.host=s.host,_.path=qc(s.path),_.query="",S=Zf;break;case"#":_.host=s.host,_.path=qc(s.path),_.query=s.query,_.fragment="",S=ed;break;default:E8(G_(qc(l,x),""))||(_.host=s.host,_.path=qc(s.path),_.shortenPath()),S=Jl;continue}}break;case R8:if(d==="/"||d==="\\"){S=lk;break}s&&s.scheme==="file"&&!E8(G_(qc(l,x),""))&&(K_(s.path[0],!0)?rg(_.path,s.path[0]):_.host=s.host),S=Jl;continue;case lk:if(d===ac||d==="/"||d==="\\"||d==="?"||d==="#"){if(!a&&K_(A))S=Jl;else if(A===""){if(_.host="",a)return;S=ig}else{if(m=_.parseHost(A))return m;if(_.host==="localhost"&&(_.host=""),a)return;A="",S=ig}continue}A+=d;break;case ig:if(_.isSpecial()){if(S=Jl,d!=="/"&&d!=="\\")continue}else if(a||d!=="?")if(a||d!=="#"){if(d!==ac&&(S=Jl,d!=="/"))continue}else _.fragment="",S=ed;else _.query="",S=Zf;break;case Jl:if(d===ac||d==="/"||d==="\\"&&_.isSpecial()||!a&&(d==="?"||d==="#")){if((y=tx(y=A))===".."||y==="%2e."||y===".%2e"||y==="%2e%2e"?(_.shortenPath(),d==="/"||d==="\\"&&_.isSpecial()||rg(_.path,"")):jCe(A)?d==="/"||d==="\\"&&_.isSpecial()||rg(_.path,""):(_.scheme==="file"&&!_.path.length&&K_(A)&&(_.host&&(_.host=""),A=cc(A,0)+":"),rg(_.path,A)),A="",_.scheme==="file"&&(d===ac||d==="?"||d==="#"))for(;_.path.length>1&&_.path[0]==="";)wCe(_.path);d==="?"?(_.query="",S=Zf):d==="#"&&(_.fragment="",S=ed)}else A+=ch(d,b8);break;case N8:d==="?"?(_.query="",S=Zf):d==="#"?(_.fragment="",S=ed):d!==ac&&(_.path[0]+=ch(d,nx));break;case Zf:a||d!=="#"?d!==ac&&(d==="'"&&_.isSpecial()?_.query+="%27":_.query+=d==="#"?"%23":ch(d,nx)):(_.fragment="",S=ed);break;case ed:d!==ac&&(_.fragment+=ch(d,_8))}x++}},parseHost:function(r){var a,s,l;if(cc(r,0)==="["){if(cc(r,r.length-1)!=="]"||(a=function(d){var f,m,y,_,S,x,A,I=[0,0,0,0,0,0,0,0],L=0,K=null,$=0,G=function(){return cc(d,$)};if(G()===":"){if(cc(d,1)!==":")return;$+=2,K=++L}for(;G();){if(L===8)return;if(G()!==":"){for(f=m=0;m<4&&Yc(y8,G());)f=16*f+ex(G(),16),$++,m++;if(G()==="."){if(m===0||($-=m,L>6))return;for(y=0;G();){if(_=null,y>0){if(!(G()==="."&&y<4))return;$++}if(!Yc(ek,G()))return;for(;Yc(ek,G());){if(S=ex(G(),10),_===null)_=S;else{if(_===0)return;_=10*_+S}if(_>255)return;$++}I[L]=256*I[L]+_,++y!=2&&y!==4||L++}if(y!==4)return;break}if(G()===":"){if($++,!G())return}else if(G())return;I[L++]=f}else{if(K!==null)return;$++,K=++L}}if(K!==null)for(x=L-K,L=7;L!==0&&x>0;)A=I[L],I[L--]=I[K+x-1],I[K+--x]=A;else if(L!==8)return;return I}(H_(r,1,-1)),!a))return Jf;this.host=a}else if(this.isSpecial()){if(r=fCe(r),Yc(ACe,r)||(a=function(d){var f,m,y,_,S,x,A,I=SCe(d,".");if(I.length&&I[I.length-1]===""&&I.length--,(f=I.length)>4)return d;for(m=[],y=0;y<f;y++){if((_=I[y])==="")return d;if(S=10,_.length>1&&cc(_,0)==="0"&&(S=Yc(CCe,_)?16:8,_=H_(_,S===8?1:2)),_==="")x=0;else{if(!Yc(S===10?NCe:S===8?RCe:y8,_))return d;x=ex(_,S)}rg(m,x)}for(y=0;y<f;y++)if(x=m[y],y===f-1){if(x>=m8(256,5-f))return null}else if(x>255)return null;for(A=ECe(m),y=0;y<m.length;y++)A+=m[y]*m8(256,3-y);return A}(r),a===null))return Jf;this.host=a}else{if(Yc(ICe,r))return Jf;for(a="",s=ng(r),l=0;l<s.length;l++)a+=ch(s[l],nx);this.host=a}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return YP(rx,this.scheme)},shortenPath:function(){var r=this.path,a=r.length;!a||this.scheme==="file"&&a===1&&K_(r[0],!0)||r.length--},serialize:function(){var r=this,a=r.scheme,s=r.username,l=r.password,d=r.host,f=r.port,m=r.path,y=r.query,_=r.fragment,S=a+":";return d!==null?(S+="//",r.includesCredentials()&&(S+=s+(l?":"+l:"")+"@"),S+=z_(d),f!==null&&(S+=":"+f)):a==="file"&&(S+="//"),S+=r.cannotBeABaseURL?m[0]:m.length?"/"+G_(m,"/"):"",y!==null&&(S+="?"+y),_!==null&&(S+="#"+_),S},setHref:function(r){var a=this.parse(r);if(a)throw new JP(a);this.searchParams.update()},getOrigin:function(){var r=this.scheme,a=this.port;if(r==="blob")try{return new ag(r.path[0]).origin}catch{return"null"}return r!=="file"&&this.isSpecial()?r+"://"+z_(this.host)+(a!==null?":"+a:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(r){this.parse(Qu(r)+":",nk)},getUsername:function(){return this.username},setUsername:function(r){var a=ng(Qu(r));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var s=0;s<a.length;s++)this.username+=ch(a[s],tk)}},getPassword:function(){return this.password},setPassword:function(r){var a=ng(Qu(r));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var s=0;s<a.length;s++)this.password+=ch(a[s],tk)}},getHost:function(){var r=this.host,a=this.port;return r===null?"":a===null?z_(r):z_(r)+":"+a},setHost:function(r){this.cannotBeABaseURL||this.parse(r,ak)},getHostname:function(){var r=this.host;return r===null?"":z_(r)},setHostname:function(r){this.cannotBeABaseURL||this.parse(r,sk)},getPort:function(){var r=this.port;return r===null?"":Qu(r)},setPort:function(r){this.cannotHaveUsernamePasswordPort()||((r=Qu(r))===""?this.port=null:this.parse(r,ok))},getPathname:function(){var r=this.path;return this.cannotBeABaseURL?r[0]:r.length?"/"+G_(r,"/"):""},setPathname:function(r){this.cannotBeABaseURL||(this.path=[],this.parse(r,ig))},getSearch:function(){var r=this.query;return r?"?"+r:""},setSearch:function(r){(r=Qu(r))===""?this.query=null:(cc(r,0)==="?"&&(r=H_(r,1)),this.query="",this.parse(r,Zf)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var r=this.fragment;return r?"#"+r:""},setHash:function(r){(r=Qu(r))!==""?(cc(r,0)==="#"&&(r=H_(r,1)),this.fragment="",this.parse(r,ed)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ag=function(r){var a=dCe(this,Ns),s=mCe(arguments.length,1)>1?arguments[1]:void 0,l=gCe(a,new uk(r,!1,s));KP||(a.href=l.serialize(),a.origin=l.getOrigin(),a.protocol=l.getProtocol(),a.username=l.getUsername(),a.password=l.getPassword(),a.host=l.getHost(),a.hostname=l.getHostname(),a.port=l.getPort(),a.pathname=l.getPathname(),a.search=l.getSearch(),a.searchParams=l.getSearchParams(),a.hash=l.getHash())},Ns=ag.prototype,lc=function(r,a){return{get:function(){return QS(this)[r]()},set:a&&function(s){return QS(this)[a](s)},configurable:!0,enumerable:!0}};if(KP&&(oc(Ns,"href",lc("serialize","setHref")),oc(Ns,"origin",lc("getOrigin")),oc(Ns,"protocol",lc("getProtocol","setProtocol")),oc(Ns,"username",lc("getUsername","setUsername")),oc(Ns,"password",lc("getPassword","setPassword")),oc(Ns,"host",lc("getHost","setHost")),oc(Ns,"hostname",lc("getHostname","setHostname")),oc(Ns,"port",lc("getPort","setPort")),oc(Ns,"pathname",lc("getPathname","setPathname")),oc(Ns,"search",lc("getSearch","setSearch")),oc(Ns,"searchParams",lc("getSearchParams")),oc(Ns,"hash",lc("getHash","setHash"))),ZS(Ns,"toJSON",function(){return QS(this).serialize()},{enumerable:!0}),ZS(Ns,"toString",function(){return QS(this).serialize()},{enumerable:!0}),W_){var A8=W_.createObjectURL,I8=W_.revokeObjectURL;A8&&ZS(ag,"createObjectURL",h8(A8,W_)),I8&&ZS(ag,"revokeObjectURL",h8(I8,W_))}pCe(ag,"URL"),lCe({global:!0,forced:!uCe,sham:!KP},{URL:ag});var DCe=Tn,O8=u,LCe=Kf,P8=Hs,MCe=zS,dk=ot("URL"),UCe=MCe&&O8(function(){dk.canParse()}),FCe=O8(function(){return dk.canParse.length!==1});DCe({target:"URL",stat:!0,forced:!UCe||FCe},{canParse:function(r){var a=LCe(arguments.length,1),s=P8(r),l=a<2||arguments[1]===void 0?void 0:P8(arguments[1]);try{return!!new dk(s,l)}catch{return!1}}});var VCe=Tn,BCe=Kf,k8=Hs,$Ce=zS,WCe=ot("URL");VCe({target:"URL",stat:!0,forced:!$Ce},{parse:function(r){var a=BCe(arguments.length,1),s=k8(r),l=a<2||arguments[1]===void 0?void 0:k8(arguments[1]);try{return new WCe(s,l)}catch{return null}}});var sx=o(Le.URL);let j8=!0,D8=!0;function ox(r,a,s){const l=r.match(a);return l&&l.length>=s&&parseInt(l[s],10)}function Qf(r,a,s){if(!r.RTCPeerConnection)return;const l=r.RTCPeerConnection.prototype,d=l.addEventListener;l.addEventListener=function(m,y){if(m!==a)return d.apply(this,arguments);const _=S=>{const x=s(S);x&&(y.handleEvent?y.handleEvent(x):y(x))};return this._eventMap=this._eventMap||{},this._eventMap[a]||(this._eventMap[a]=new Map),this._eventMap[a].set(y,_),d.apply(this,[m,_])};const f=l.removeEventListener;l.removeEventListener=function(m,y){if(m!==a||!this._eventMap||!this._eventMap[a])return f.apply(this,arguments);if(!this._eventMap[a].has(y))return f.apply(this,arguments);const _=this._eventMap[a].get(y);return this._eventMap[a].delete(y),this._eventMap[a].size===0&&delete this._eventMap[a],Object.keys(this._eventMap).length===0&&delete this._eventMap,f.apply(this,[m,_])},Object.defineProperty(l,"on"+a,{get(){return this["_on"+a]},set(m){this["_on"+a]&&(this.removeEventListener(a,this["_on"+a]),delete this["_on"+a]),m&&this.addEventListener(a,this["_on"+a]=m)},enumerable:!0,configurable:!0})}function GCe(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(j8=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function HCe(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(D8=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function L8(){if(typeof window=="object"){if(j8)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function hk(r,a){D8&&console.warn(r+" is deprecated, please use "+a+" instead.")}function M8(r){return Object.prototype.toString.call(r)==="[object Object]"}function U8(r){var a;return M8(r)?rc(a=Object.keys(r)).call(a,function(s,l){const d=M8(r[l]),f=d?U8(r[l]):r[l],m=d&&!Object.keys(f).length;return f===void 0||m?s:Object.assign(s,{[l]:f})},{}):r}function fk(r,a,s){a&&!s.has(a.id)&&(s.set(a.id,a),Object.keys(a).forEach(l=>{l.endsWith("Id")?fk(r,r.get(a[l]),s):l.endsWith("Ids")&&a[l].forEach(d=>{fk(r,r.get(d),s)})}))}function F8(r,a,s){const l=s?"outbound-rtp":"inbound-rtp",d=new Map;if(a===null)return d;const f=[];return r.forEach(m=>{m.type==="track"&&m.trackIdentifier===a.id&&f.push(m)}),f.forEach(m=>{r.forEach(y=>{y.type===l&&y.trackId===m.id&&fk(r,y,d)})}),d}const V8=L8;function B8(r,a){const s=r&&r.navigator;if(!s.mediaDevices)return;const l=function(m){if(typeof m!="object"||m.mandatory||m.optional)return m;const y={};return Object.keys(m).forEach(_=>{if(_==="require"||_==="advanced"||_==="mediaSource")return;const S=typeof m[_]=="object"?m[_]:{ideal:m[_]};S.exact!==void 0&&typeof S.exact=="number"&&(S.min=S.max=S.exact);const x=function(A,I){return A?A+I.charAt(0).toUpperCase()+I.slice(1):I==="deviceId"?"sourceId":I};if(S.ideal!==void 0){y.optional=y.optional||[];let A={};typeof S.ideal=="number"?(A[x("min",_)]=S.ideal,y.optional.push(A),A={},A[x("max",_)]=S.ideal,y.optional.push(A)):(A[x("",_)]=S.ideal,y.optional.push(A))}S.exact!==void 0&&typeof S.exact!="number"?(y.mandatory=y.mandatory||{},y.mandatory[x("",_)]=S.exact):["min","max"].forEach(A=>{S[A]!==void 0&&(y.mandatory=y.mandatory||{},y.mandatory[x(A,_)]=S[A])})}),m.advanced&&(y.optional=(y.optional||[]).concat(m.advanced)),y},d=function(m,y){if(a.version>=61)return y(m);if((m=JSON.parse(JSON.stringify(m)))&&typeof m.audio=="object"){const _=function(S,x,A){x in S&&!(A in S)&&(S[A]=S[x],delete S[x])};_((m=JSON.parse(JSON.stringify(m))).audio,"autoGainControl","googAutoGainControl"),_(m.audio,"noiseSuppression","googNoiseSuppression"),m.audio=l(m.audio)}if(m&&typeof m.video=="object"){let _=m.video.facingMode;_=_&&(typeof _=="object"?_:{ideal:_});const S=a.version<66;if(_&&(_.exact==="user"||_.exact==="environment"||_.ideal==="user"||_.ideal==="environment")&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||S)){let x;if(delete m.video.facingMode,_.exact==="environment"||_.ideal==="environment"?x=["back","rear"]:_.exact!=="user"&&_.ideal!=="user"||(x=["front"]),x)return s.mediaDevices.enumerateDevices().then(A=>{A=A.filter(L=>L.kind==="videoinput");let I=A.find(L=>x.some(K=>{var $;return Be($=L.label.toLowerCase()).call($,K)}));return!I&&A.length&&Be(x).call(x,"back")&&(I=A[A.length-1]),I&&(m.video.deviceId=_.exact?{exact:I.deviceId}:{ideal:I.deviceId}),m.video=l(m.video),V8("chrome: "+JSON.stringify(m)),y(m)})}m.video=l(m.video)}return V8("chrome: "+JSON.stringify(m)),y(m)},f=function(m){return a.version>=64?m:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[m.name]||m.name,message:m.message,constraint:m.constraint||m.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(s.getUserMedia=(function(m,y,_){d(m,S=>{s.webkitGetUserMedia(S,y,x=>{_&&_(f(x))})})}).bind(s),s.mediaDevices.getUserMedia){const m=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(y){return d(y,_=>m(_).then(S=>{if(_.audio&&!S.getAudioTracks().length||_.video&&!S.getVideoTracks().length)throw S.getTracks().forEach(x=>{x.stop()}),new DOMException("","NotFoundError");return S},S=>He.reject(f(S))))}}}function $8(r){r.MediaStream=r.MediaStream||r.webkitMediaStream}function W8(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("ontrack"in r.RTCPeerConnection.prototype)){Object.defineProperty(r.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(s){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=s)},enumerable:!0,configurable:!0});const a=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",l=>{let d;d=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(m=>m.track&&m.track.id===l.track.id):{track:l.track};const f=new Event("track");f.track=l.track,f.receiver=d,f.transceiver={receiver:d},f.streams=[s.stream],this.dispatchEvent(f)}),s.stream.getTracks().forEach(l=>{let d;d=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(m=>m.track&&m.track.id===l.id):{track:l};const f=new Event("track");f.track=l,f.receiver=d,f.transceiver={receiver:d},f.streams=[s.stream],this.dispatchEvent(f)})},this.addEventListener("addstream",this._ontrackpoly)),a.apply(this,arguments)}}else Qf(r,"track",a=>(a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}}),a))}function G8(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("getSenders"in r.RTCPeerConnection.prototype)&&"createDTMFSender"in r.RTCPeerConnection.prototype){const a=function(d,f){return{track:f,get dtmf(){return this._dtmf===void 0&&(f.kind==="audio"?this._dtmf=d.createDTMFSender(f):this._dtmf=null),this._dtmf},_pc:d}};if(!r.RTCPeerConnection.prototype.getSenders){r.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const d=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(m,y){let _=d.apply(this,arguments);return _||(_=a(this,m),this._senders.push(_)),_};const f=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(m){f.apply(this,arguments);const y=this._senders.indexOf(m);y!==-1&&this._senders.splice(y,1)}}const s=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(d){this._senders=this._senders||[],s.apply(this,[d]),d.getTracks().forEach(f=>{this._senders.push(a(this,f))})};const l=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(d){this._senders=this._senders||[],l.apply(this,[d]),d.getTracks().forEach(f=>{const m=this._senders.find(y=>y.track===f);m&&this._senders.splice(this._senders.indexOf(m),1)})}}else if(typeof r=="object"&&r.RTCPeerConnection&&"getSenders"in r.RTCPeerConnection.prototype&&"createDTMFSender"in r.RTCPeerConnection.prototype&&r.RTCRtpSender&&!("dtmf"in r.RTCRtpSender.prototype)){const a=r.RTCPeerConnection.prototype.getSenders;r.RTCPeerConnection.prototype.getSenders=function(){const s=a.apply(this,[]);return s.forEach(l=>l._pc=this),s},Object.defineProperty(r.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function H8(r){if(!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[s,l,d]=arguments;if(arguments.length>0&&typeof s=="function")return a.apply(this,arguments);if(a.length===0&&(arguments.length===0||typeof s!="function"))return a.apply(this,[]);const f=function(y){const _={};return y.result().forEach(S=>{const x={id:S.id,timestamp:S.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[S.type]||S.type};S.names().forEach(A=>{x[A]=S.stat(A)}),_[x.id]=x}),_},m=function(y){return new Map(Object.keys(y).map(_=>[_,y[_]]))};if(arguments.length>=2){const y=function(_){l(m(f(_)))};return a.apply(this,[y,s])}return new He((y,_)=>{a.apply(this,[function(S){y(m(f(S)))},_])}).then(l,d)}}function z8(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender&&r.RTCRtpReceiver))return;if(!("getStats"in r.RTCRtpSender.prototype)){const s=r.RTCPeerConnection.prototype.getSenders;s&&(r.RTCPeerConnection.prototype.getSenders=function(){const d=s.apply(this,[]);return d.forEach(f=>f._pc=this),d});const l=r.RTCPeerConnection.prototype.addTrack;l&&(r.RTCPeerConnection.prototype.addTrack=function(){const d=l.apply(this,arguments);return d._pc=this,d}),r.RTCRtpSender.prototype.getStats=function(){const d=this;return this._pc.getStats().then(f=>F8(f,d.track,!0))}}if(!("getStats"in r.RTCRtpReceiver.prototype)){const s=r.RTCPeerConnection.prototype.getReceivers;s&&(r.RTCPeerConnection.prototype.getReceivers=function(){const l=s.apply(this,[]);return l.forEach(d=>d._pc=this),l}),Qf(r,"track",l=>(l.receiver._pc=l.srcElement,l)),r.RTCRtpReceiver.prototype.getStats=function(){const l=this;return this._pc.getStats().then(d=>F8(d,l.track,!1))}}if(!("getStats"in r.RTCRtpSender.prototype)||!("getStats"in r.RTCRtpReceiver.prototype))return;const a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof r.MediaStreamTrack){const s=arguments[0];let l,d,f;return this.getSenders().forEach(m=>{m.track===s&&(l?f=!0:l=m)}),this.getReceivers().forEach(m=>(m.track===s&&(d?f=!0:d=m),m.track===s)),f||l&&d?He.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():d?d.getStats():He.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}function K8(r){r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(f=>this._shimmedLocalStreams[f][0])};const a=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(f,m){if(!m)return a.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const y=a.apply(this,arguments);return this._shimmedLocalStreams[m.id]?this._shimmedLocalStreams[m.id].indexOf(y)===-1&&this._shimmedLocalStreams[m.id].push(y):this._shimmedLocalStreams[m.id]=[m,y],y};const s=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(f){this._shimmedLocalStreams=this._shimmedLocalStreams||{},f.getTracks().forEach(_=>{if(this.getSenders().find(x=>x.track===_))throw new DOMException("Track already exists.","InvalidAccessError")});const m=this.getSenders();s.apply(this,arguments);const y=this.getSenders().filter(_=>m.indexOf(_)===-1);this._shimmedLocalStreams[f.id]=[f].concat(y)};const l=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(f){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[f.id],l.apply(this,arguments)};const d=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(f){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},f&&Object.keys(this._shimmedLocalStreams).forEach(m=>{const y=this._shimmedLocalStreams[m].indexOf(f);y!==-1&&this._shimmedLocalStreams[m].splice(y,1),this._shimmedLocalStreams[m].length===1&&delete this._shimmedLocalStreams[m]}),d.apply(this,arguments)}}function q8(r,a){if(!r.RTCPeerConnection)return;if(r.RTCPeerConnection.prototype.addTrack&&a.version>=65)return K8(r);const s=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){const _=s.apply(this);return this._reverseStreams=this._reverseStreams||{},_.map(S=>this._reverseStreams[S.id])};const l=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(_){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_.getTracks().forEach(S=>{if(this.getSenders().find(A=>A.track===S))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_.id]){const S=new r.MediaStream(_.getTracks());this._streams[_.id]=S,this._reverseStreams[S.id]=_,_=S}l.apply(this,[_])};const d=r.RTCPeerConnection.prototype.removeStream;function f(_,S){let x=S.sdp;return Object.keys(_._reverseStreams||[]).forEach(A=>{const I=_._reverseStreams[A],L=_._streams[I.id];x=x.replace(new RegExp(L.id,"g"),I.id)}),new RTCSessionDescription({type:S.type,sdp:x})}r.RTCPeerConnection.prototype.removeStream=function(_){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.apply(this,[this._streams[_.id]||_]),delete this._reverseStreams[this._streams[_.id]?this._streams[_.id].id:_.id],delete this._streams[_.id]},r.RTCPeerConnection.prototype.addTrack=function(_,S){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const x=[].slice.call(arguments,1);if(x.length!==1||!x[0].getTracks().find(L=>L===_))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(L=>L.track===_))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const I=this._streams[S.id];if(I)I.addTrack(_),He.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const L=new r.MediaStream([_]);this._streams[S.id]=L,this._reverseStreams[L.id]=S,this.addStream(L)}return this.getSenders().find(L=>L.track===_)},["createOffer","createAnswer"].forEach(function(_){const S=r.RTCPeerConnection.prototype[_],x={[_](){const A=arguments;return arguments.length&&typeof arguments[0]=="function"?S.apply(this,[I=>{const L=f(this,I);A[0].apply(null,[L])},I=>{A[1]&&A[1].apply(null,I)},arguments[2]]):S.apply(this,arguments).then(I=>f(this,I))}};r.RTCPeerConnection.prototype[_]=x[_]});const m=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(_,S){let x=S.sdp;return Object.keys(_._reverseStreams||[]).forEach(A=>{const I=_._reverseStreams[A],L=_._streams[I.id];x=x.replace(new RegExp(I.id,"g"),L.id)}),new RTCSessionDescription({type:S.type,sdp:x})}(this,arguments[0]),m.apply(this,arguments)):m.apply(this,arguments)};const y=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get(){const _=y.get.apply(this);return _.type===""?_:f(this,_)}}),r.RTCPeerConnection.prototype.removeTrack=function(_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let S;this._streams=this._streams||{},Object.keys(this._streams).forEach(x=>{this._streams[x].getTracks().find(A=>_.track===A)&&(S=this._streams[x])}),S&&(S.getTracks().length===1?this.removeStream(this._reverseStreams[S.id]):S.removeTrack(_.track),this.dispatchEvent(new Event("negotiationneeded")))}}function pk(r,a){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const l=r.RTCPeerConnection.prototype[s],d={[s](){return arguments[0]=new(s==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};r.RTCPeerConnection.prototype[s]=d[s]})}function Y8(r,a){Qf(r,"negotiationneeded",s=>{const l=s.target;if(!(a.version<72||l.getConfiguration&&l.getConfiguration().sdpSemantics==="plan-b")||l.signalingState==="stable")return s})}var X8=Object.freeze({__proto__:null,fixNegotiationNeeded:Y8,shimAddTrackRemoveTrack:q8,shimAddTrackRemoveTrackWithNative:K8,shimGetDisplayMedia:function(r,a){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(typeof a=="function"?r.navigator.mediaDevices.getDisplayMedia=function(s){return a(s).then(l=>{const d=s.video&&s.video.width,f=s.video&&s.video.height,m=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l,maxFrameRate:m||3}},d&&(s.video.mandatory.maxWidth=d),f&&(s.video.mandatory.maxHeight=f),r.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:G8,shimGetStats:H8,shimGetUserMedia:B8,shimMediaStream:$8,shimOnTrack:W8,shimPeerConnection:pk,shimSenderReceiverGetStats:z8});function J8(r,a){const s=r&&r.navigator,l=r&&r.MediaStreamTrack;if(s.getUserMedia=function(d,f,m){hk("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),s.mediaDevices.getUserMedia(d).then(f,m)},!(a.version>55&&"autoGainControl"in s.mediaDevices.getSupportedConstraints())){const d=function(m,y,_){y in m&&!(_ in m)&&(m[_]=m[y],delete m[y])},f=s.mediaDevices.getUserMedia.bind(s.mediaDevices);if(s.mediaDevices.getUserMedia=function(m){return typeof m=="object"&&typeof m.audio=="object"&&(m=JSON.parse(JSON.stringify(m)),d(m.audio,"autoGainControl","mozAutoGainControl"),d(m.audio,"noiseSuppression","mozNoiseSuppression")),f(m)},l&&l.prototype.getSettings){const m=l.prototype.getSettings;l.prototype.getSettings=function(){const y=m.apply(this,arguments);return d(y,"mozAutoGainControl","autoGainControl"),d(y,"mozNoiseSuppression","noiseSuppression"),y}}if(l&&l.prototype.applyConstraints){const m=l.prototype.applyConstraints;l.prototype.applyConstraints=function(y){return this.kind==="audio"&&typeof y=="object"&&(y=JSON.parse(JSON.stringify(y)),d(y,"autoGainControl","mozAutoGainControl"),d(y,"noiseSuppression","mozNoiseSuppression")),m.apply(this,[y])}}}}function Z8(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mk(r,a){if(typeof r!="object"||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(d){const f=r.RTCPeerConnection.prototype[d],m={[d](){return arguments[0]=new(d==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),f.apply(this,arguments)}};r.RTCPeerConnection.prototype[d]=m[d]});const s={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},l=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[d,f,m]=arguments;return l.apply(this,[d||null]).then(y=>{if(a.version<53&&!f)try{y.forEach(_=>{_.type=s[_.type]||_.type})}catch(_){if(_.name!=="TypeError")throw _;y.forEach((S,x)=>{y.set(x,Object.assign({},S,{type:s[S.type]||S.type}))})}return y}).then(f,m)}}function Q8(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpSender.prototype)return;const a=r.RTCPeerConnection.prototype.getSenders;a&&(r.RTCPeerConnection.prototype.getSenders=function(){const l=a.apply(this,[]);return l.forEach(d=>d._pc=this),l});const s=r.RTCPeerConnection.prototype.addTrack;s&&(r.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),r.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):He.resolve(new Map)}}function eW(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpReceiver.prototype)return;const a=r.RTCPeerConnection.prototype.getReceivers;a&&(r.RTCPeerConnection.prototype.getReceivers=function(){const s=a.apply(this,[]);return s.forEach(l=>l._pc=this),s}),Qf(r,"track",s=>(s.receiver._pc=s.srcElement,s)),r.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function tW(r){r.RTCPeerConnection&&!("removeStream"in r.RTCPeerConnection.prototype)&&(r.RTCPeerConnection.prototype.removeStream=function(a){hk("removeStream","removeTrack"),this.getSenders().forEach(s=>{var l;s.track&&Be(l=a.getTracks()).call(l,s.track)&&this.removeTrack(s)})})}function nW(r){r.DataChannel&&!r.RTCDataChannel&&(r.RTCDataChannel=r.DataChannel)}function rW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.addTransceiver;a&&(r.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const l=s.length>0;l&&s.forEach(f=>{if("rid"in f&&!/^[a-z0-9]{0,16}$/i.test(f.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in f&&!(parseFloat(f.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in f&&!(parseFloat(f.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const d=a.apply(this,arguments);if(l){const{sender:f}=d,m=f.getParameters();(!("encodings"in m)||m.encodings.length===1&&Object.keys(m.encodings[0]).length===0)&&(m.encodings=s,f.sendEncodings=s,this.setParametersPromises.push(f.setParameters(m).then(()=>{delete f.sendEncodings}).catch(()=>{delete f.sendEncodings})))}return d})}function iW(r){if(typeof r!="object"||!r.RTCRtpSender)return;const a=r.RTCRtpSender.prototype.getParameters;a&&(r.RTCRtpSender.prototype.getParameters=function(){const s=a.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function aW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?He.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}function sW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype.createAnswer;r.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?He.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}var oW=Object.freeze({__proto__:null,shimAddTransceiver:rW,shimCreateAnswer:sW,shimCreateOffer:aW,shimGetDisplayMedia:function(r,a){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(r.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){const l=new DOMException("getDisplayMedia without video constraints is undefined");return l.name="NotFoundError",l.code=8,He.reject(l)}return s.video===!0?s.video={mediaSource:a}:s.video.mediaSource=a,r.navigator.mediaDevices.getUserMedia(s)})},shimGetParameters:iW,shimGetUserMedia:J8,shimOnTrack:Z8,shimPeerConnection:mk,shimRTCDataChannel:nW,shimReceiverGetStats:eW,shimRemoveStream:tW,shimSenderGetStats:Q8});function cW(r){if(typeof r=="object"&&r.RTCPeerConnection){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){const a=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(s){var l;this._localStreams||(this._localStreams=[]),Be(l=this._localStreams).call(l,s)||this._localStreams.push(s),s.getAudioTracks().forEach(d=>a.call(this,d,s)),s.getVideoTracks().forEach(d=>a.call(this,d,s))},r.RTCPeerConnection.prototype.addTrack=function(s){for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];return d&&d.forEach(m=>{var y;this._localStreams?Be(y=this._localStreams).call(y,m)||this._localStreams.push(m):this._localStreams=[m]}),a.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(a);if(s===-1)return;this._localStreams.splice(s,1);const l=a.getTracks();this.getSenders().forEach(d=>{Be(l).call(l,d.track)&&this.removeTrack(d)})})}}function lW(r){if(typeof r=="object"&&r.RTCPeerConnection&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(s){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=s),this.addEventListener("track",this._onaddstreampoly=l=>{l.streams.forEach(d=>{var f;if(this._remoteStreams||(this._remoteStreams=[]),Be(f=this._remoteStreams).call(f,d))return;this._remoteStreams.push(d);const m=new Event("addstream");m.stream=d,this.dispatchEvent(m)})})}});const a=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(d=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(d)>=0)return;s._remoteStreams.push(d);const f=new Event("addstream");f.stream=d,s.dispatchEvent(f)})}),a.apply(s,arguments)}}}function uW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const a=r.RTCPeerConnection.prototype,s=a.createOffer,l=a.createAnswer,d=a.setLocalDescription,f=a.setRemoteDescription,m=a.addIceCandidate;a.createOffer=function(_,S){const x=arguments.length>=2?arguments[2]:arguments[0],A=s.apply(this,[x]);return S?(A.then(_,S),He.resolve()):A},a.createAnswer=function(_,S){const x=arguments.length>=2?arguments[2]:arguments[0],A=l.apply(this,[x]);return S?(A.then(_,S),He.resolve()):A};let y=function(_,S,x){const A=d.apply(this,[_]);return x?(A.then(S,x),He.resolve()):A};a.setLocalDescription=y,y=function(_,S,x){const A=f.apply(this,[_]);return x?(A.then(S,x),He.resolve()):A},a.setRemoteDescription=y,y=function(_,S,x){const A=m.apply(this,[_]);return x?(A.then(S,x),He.resolve()):A},a.addIceCandidate=y}function dW(r){const a=r&&r.navigator;if(a.mediaDevices&&a.mediaDevices.getUserMedia){const s=a.mediaDevices,l=s.getUserMedia.bind(s);a.mediaDevices.getUserMedia=d=>l(hW(d))}!a.getUserMedia&&a.mediaDevices&&a.mediaDevices.getUserMedia&&(a.getUserMedia=(function(s,l,d){a.mediaDevices.getUserMedia(s).then(l,d)}).bind(a))}function hW(r){return r&&r.video!==void 0?Object.assign({},r,{video:U8(r.video)}):r}function fW(r){if(!r.RTCPeerConnection)return;const a=r.RTCPeerConnection;r.RTCPeerConnection=function(s,l){if(s&&s.iceServers){const d=[];for(let f=0;f<s.iceServers.length;f++){let m=s.iceServers[f];!m.hasOwnProperty("urls")&&m.hasOwnProperty("url")?(hk("RTCIceServer.url","RTCIceServer.urls"),m=JSON.parse(JSON.stringify(m)),m.urls=m.url,delete m.url,d.push(m)):d.push(s.iceServers[f])}s.iceServers=d}return new a(s,l)},r.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in a&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:()=>a.generateCertificate})}function pW(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mW(r){const a=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(s){if(s){s.offerToReceiveAudio!==void 0&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const l=this.getTransceivers().find(f=>f.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveAudio!==!0||l||this.addTransceiver("audio",{direction:"recvonly"}),s.offerToReceiveVideo!==void 0&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const d=this.getTransceivers().find(f=>f.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&d?d.direction==="sendrecv"?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":d.direction==="recvonly"&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):s.offerToReceiveVideo!==!0||d||this.addTransceiver("video",{direction:"recvonly"})}return a.apply(this,arguments)}}function gW(r){typeof r!="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}var vW=Object.freeze({__proto__:null,shimAudioContext:gW,shimCallbacksAPI:uW,shimConstraints:hW,shimCreateOfferLegacy:mW,shimGetUserMedia:dW,shimLocalStreamsAPI:cW,shimRTCIceServerUrls:fW,shimRemoteStreamsAPI:lW,shimTrackEventTransceiver:pW}),yW=`	
\v\f\r                　\u2028\u2029\uFEFF`,zCe=Pt,KCe=Hs,gk=yW,_W=E("".replace),qCe=RegExp("^["+gk+"]+"),YCe=RegExp("(^|[^"+gk+"])["+gk+"]+$"),XCe=function(r){return function(a){var s=KCe(zCe(a));return 1&r&&(s=_W(s,qCe,"")),2&r&&(s=_W(s,YCe,"$1")),s}},JCe={trim:XCe(3)},ZCe=n$.PROPER,QCe=u,bW=yW,eRe=JCe.trim;Tn({target:"String",proto:!0,forced:function(r){return QCe(function(){return!!bW[r]()||"​᠎"[r]()!=="​᠎"||ZCe&&bW[r].name!==r})}("trim")},{trim:function(){return eRe(this)}});var tRe=nc("String","trim"),nRe=T,rRe=tRe,vk=String.prototype,iRe=function(r){var a=r.trim;return typeof r=="string"||r===vk||nRe(vk,r)&&a===vk.trim?rRe:a},Ea=o(iRe),EW={exports:{}};(function(r){const a={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};a.localCName=a.generateIdentifier(),a.splitLines=function(s){return s.trim().split(`
`).map(l=>l.trim())},a.splitSections=function(s){return s.split(`
m=`).map((l,d)=>(d>0?"m="+l:l).trim()+`\r
`)},a.getDescription=function(s){const l=a.splitSections(s);return l&&l[0]},a.getMediaSections=function(s){const l=a.splitSections(s);return l.shift(),l},a.matchPrefix=function(s,l){return a.splitLines(s).filter(d=>d.indexOf(l)===0)},a.parseCandidate=function(s){let l;l=s.indexOf("a=candidate:")===0?s.substring(12).split(" "):s.substring(10).split(" ");const d={foundation:l[0],component:{1:"rtp",2:"rtcp"}[l[1]]||l[1],protocol:l[2].toLowerCase(),priority:parseInt(l[3],10),ip:l[4],address:l[4],port:parseInt(l[5],10),type:l[7]};for(let f=8;f<l.length;f+=2)switch(l[f]){case"raddr":d.relatedAddress=l[f+1];break;case"rport":d.relatedPort=parseInt(l[f+1],10);break;case"tcptype":d.tcpType=l[f+1];break;case"ufrag":d.ufrag=l[f+1],d.usernameFragment=l[f+1];break;default:d[l[f]]===void 0&&(d[l[f]]=l[f+1])}return d},a.writeCandidate=function(s){const l=[];l.push(s.foundation);const d=s.component;d==="rtp"?l.push(1):d==="rtcp"?l.push(2):l.push(d),l.push(s.protocol.toUpperCase()),l.push(s.priority),l.push(s.address||s.ip),l.push(s.port);const f=s.type;return l.push("typ"),l.push(f),f!=="host"&&s.relatedAddress&&s.relatedPort&&(l.push("raddr"),l.push(s.relatedAddress),l.push("rport"),l.push(s.relatedPort)),s.tcpType&&s.protocol.toLowerCase()==="tcp"&&(l.push("tcptype"),l.push(s.tcpType)),(s.usernameFragment||s.ufrag)&&(l.push("ufrag"),l.push(s.usernameFragment||s.ufrag)),"candidate:"+l.join(" ")},a.parseIceOptions=function(s){return s.substring(14).split(" ")},a.parseRtpMap=function(s){let l=s.substring(9).split(" ");const d={payloadType:parseInt(l.shift(),10)};return l=l[0].split("/"),d.name=l[0],d.clockRate=parseInt(l[1],10),d.channels=l.length===3?parseInt(l[2],10):1,d.numChannels=d.channels,d},a.writeRtpMap=function(s){let l=s.payloadType;s.preferredPayloadType!==void 0&&(l=s.preferredPayloadType);const d=s.channels||s.numChannels||1;return"a=rtpmap:"+l+" "+s.name+"/"+s.clockRate+(d!==1?"/"+d:"")+`\r
`},a.parseExtmap=function(s){const l=s.substring(9).split(" ");return{id:parseInt(l[0],10),direction:l[0].indexOf("/")>0?l[0].split("/")[1]:"sendrecv",uri:l[1],attributes:l.slice(2).join(" ")}},a.writeExtmap=function(s){return"a=extmap:"+(s.id||s.preferredId)+(s.direction&&s.direction!=="sendrecv"?"/"+s.direction:"")+" "+s.uri+(s.attributes?" "+s.attributes:"")+`\r
`},a.parseFmtp=function(s){const l={};let d;const f=s.substring(s.indexOf(" ")+1).split(";");for(let m=0;m<f.length;m++)d=f[m].trim().split("="),l[d[0].trim()]=d[1];return l},a.writeFmtp=function(s){let l="",d=s.payloadType;if(s.preferredPayloadType!==void 0&&(d=s.preferredPayloadType),s.parameters&&Object.keys(s.parameters).length){const f=[];Object.keys(s.parameters).forEach(m=>{s.parameters[m]!==void 0?f.push(m+"="+s.parameters[m]):f.push(m)}),l+="a=fmtp:"+d+" "+f.join(";")+`\r
`}return l},a.parseRtcpFb=function(s){const l=s.substring(s.indexOf(" ")+1).split(" ");return{type:l.shift(),parameter:l.join(" ")}},a.writeRtcpFb=function(s){let l="",d=s.payloadType;return s.preferredPayloadType!==void 0&&(d=s.preferredPayloadType),s.rtcpFeedback&&s.rtcpFeedback.length&&s.rtcpFeedback.forEach(f=>{l+="a=rtcp-fb:"+d+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`}),l},a.parseSsrcMedia=function(s){const l=s.indexOf(" "),d={ssrc:parseInt(s.substring(7,l),10)},f=s.indexOf(":",l);return f>-1?(d.attribute=s.substring(l+1,f),d.value=s.substring(f+1)):d.attribute=s.substring(l+1),d},a.parseSsrcGroup=function(s){const l=s.substring(13).split(" ");return{semantics:l.shift(),ssrcs:l.map(d=>parseInt(d,10))}},a.getMid=function(s){const l=a.matchPrefix(s,"a=mid:")[0];if(l)return l.substring(6)},a.parseFingerprint=function(s){const l=s.substring(14).split(" ");return{algorithm:l[0].toLowerCase(),value:l[1].toUpperCase()}},a.getDtlsParameters=function(s,l){return{role:"auto",fingerprints:a.matchPrefix(s+l,"a=fingerprint:").map(a.parseFingerprint)}},a.writeDtlsParameters=function(s,l){let d="a=setup:"+l+`\r
`;return s.fingerprints.forEach(f=>{d+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`}),d},a.parseCryptoLine=function(s){const l=s.substring(9).split(" ");return{tag:parseInt(l[0],10),cryptoSuite:l[1],keyParams:l[2],sessionParams:l.slice(3)}},a.writeCryptoLine=function(s){return"a=crypto:"+s.tag+" "+s.cryptoSuite+" "+(typeof s.keyParams=="object"?a.writeCryptoKeyParams(s.keyParams):s.keyParams)+(s.sessionParams?" "+s.sessionParams.join(" "):"")+`\r
`},a.parseCryptoKeyParams=function(s){if(s.indexOf("inline:")!==0)return null;const l=s.substring(7).split("|");return{keyMethod:"inline",keySalt:l[0],lifeTime:l[1],mkiValue:l[2]?l[2].split(":")[0]:void 0,mkiLength:l[2]?l[2].split(":")[1]:void 0}},a.writeCryptoKeyParams=function(s){return s.keyMethod+":"+s.keySalt+(s.lifeTime?"|"+s.lifeTime:"")+(s.mkiValue&&s.mkiLength?"|"+s.mkiValue+":"+s.mkiLength:"")},a.getCryptoParameters=function(s,l){return a.matchPrefix(s+l,"a=crypto:").map(a.parseCryptoLine)},a.getIceParameters=function(s,l){const d=a.matchPrefix(s+l,"a=ice-ufrag:")[0],f=a.matchPrefix(s+l,"a=ice-pwd:")[0];return d&&f?{usernameFragment:d.substring(12),password:f.substring(10)}:null},a.writeIceParameters=function(s){let l="a=ice-ufrag:"+s.usernameFragment+`\r
a=ice-pwd:`+s.password+`\r
`;return s.iceLite&&(l+=`a=ice-lite\r
`),l},a.parseRtpParameters=function(s){const l={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},d=a.splitLines(s)[0].split(" ");l.profile=d[2];for(let m=3;m<d.length;m++){const y=d[m],_=a.matchPrefix(s,"a=rtpmap:"+y+" ")[0];if(_){const S=a.parseRtpMap(_),x=a.matchPrefix(s,"a=fmtp:"+y+" ");switch(S.parameters=x.length?a.parseFmtp(x[0]):{},S.rtcpFeedback=a.matchPrefix(s,"a=rtcp-fb:"+y+" ").map(a.parseRtcpFb),l.codecs.push(S),S.name.toUpperCase()){case"RED":case"ULPFEC":l.fecMechanisms.push(S.name.toUpperCase())}}}a.matchPrefix(s,"a=extmap:").forEach(m=>{l.headerExtensions.push(a.parseExtmap(m))});const f=a.matchPrefix(s,"a=rtcp-fb:* ").map(a.parseRtcpFb);return l.codecs.forEach(m=>{f.forEach(y=>{m.rtcpFeedback.find(_=>_.type===y.type&&_.parameter===y.parameter)||m.rtcpFeedback.push(y)})}),l},a.writeRtpDescription=function(s,l){let d="";d+="m="+s+" ",d+=l.codecs.length>0?"9":"0",d+=" "+(l.profile||"UDP/TLS/RTP/SAVPF")+" ",d+=l.codecs.map(m=>m.preferredPayloadType!==void 0?m.preferredPayloadType:m.payloadType).join(" ")+`\r
`,d+=`c=IN IP4 0.0.0.0\r
`,d+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,l.codecs.forEach(m=>{d+=a.writeRtpMap(m),d+=a.writeFmtp(m),d+=a.writeRtcpFb(m)});let f=0;return l.codecs.forEach(m=>{m.maxptime>f&&(f=m.maxptime)}),f>0&&(d+="a=maxptime:"+f+`\r
`),l.headerExtensions&&l.headerExtensions.forEach(m=>{d+=a.writeExtmap(m)}),d},a.parseRtpEncodingParameters=function(s){const l=[],d=a.parseRtpParameters(s),f=d.fecMechanisms.indexOf("RED")!==-1,m=d.fecMechanisms.indexOf("ULPFEC")!==-1,y=a.matchPrefix(s,"a=ssrc:").map(I=>a.parseSsrcMedia(I)).filter(I=>I.attribute==="cname"),_=y.length>0&&y[0].ssrc;let S;const x=a.matchPrefix(s,"a=ssrc-group:FID").map(I=>I.substring(17).split(" ").map(L=>parseInt(L,10)));x.length>0&&x[0].length>1&&x[0][0]===_&&(S=x[0][1]),d.codecs.forEach(I=>{if(I.name.toUpperCase()==="RTX"&&I.parameters.apt){let L={ssrc:_,codecPayloadType:parseInt(I.parameters.apt,10)};_&&S&&(L.rtx={ssrc:S}),l.push(L),f&&(L=JSON.parse(JSON.stringify(L)),L.fec={ssrc:_,mechanism:m?"red+ulpfec":"red"},l.push(L))}}),l.length===0&&_&&l.push({ssrc:_});let A=a.matchPrefix(s,"b=");return A.length&&(A=A[0].indexOf("b=TIAS:")===0?parseInt(A[0].substring(7),10):A[0].indexOf("b=AS:")===0?1e3*parseInt(A[0].substring(5),10)*.95-16e3:void 0,l.forEach(I=>{I.maxBitrate=A})),l},a.parseRtcpParameters=function(s){const l={},d=a.matchPrefix(s,"a=ssrc:").map(y=>a.parseSsrcMedia(y)).filter(y=>y.attribute==="cname")[0];d&&(l.cname=d.value,l.ssrc=d.ssrc);const f=a.matchPrefix(s,"a=rtcp-rsize");l.reducedSize=f.length>0,l.compound=f.length===0;const m=a.matchPrefix(s,"a=rtcp-mux");return l.mux=m.length>0,l},a.writeRtcpParameters=function(s){let l="";return s.reducedSize&&(l+=`a=rtcp-rsize\r
`),s.mux&&(l+=`a=rtcp-mux\r
`),s.ssrc!==void 0&&s.cname&&(l+="a=ssrc:"+s.ssrc+" cname:"+s.cname+`\r
`),l},a.parseMsid=function(s){let l;const d=a.matchPrefix(s,"a=msid:");if(d.length===1)return l=d[0].substring(7).split(" "),{stream:l[0],track:l[1]};const f=a.matchPrefix(s,"a=ssrc:").map(m=>a.parseSsrcMedia(m)).filter(m=>m.attribute==="msid");return f.length>0?(l=f[0].value.split(" "),{stream:l[0],track:l[1]}):void 0},a.parseSctpDescription=function(s){const l=a.parseMLine(s),d=a.matchPrefix(s,"a=max-message-size:");let f;d.length>0&&(f=parseInt(d[0].substring(19),10)),isNaN(f)&&(f=65536);const m=a.matchPrefix(s,"a=sctp-port:");if(m.length>0)return{port:parseInt(m[0].substring(12),10),protocol:l.fmt,maxMessageSize:f};const y=a.matchPrefix(s,"a=sctpmap:");if(y.length>0){const _=y[0].substring(10).split(" ");return{port:parseInt(_[0],10),protocol:_[1],maxMessageSize:f}}},a.writeSctpDescription=function(s,l){let d=[];return d=s.protocol!=="DTLS/SCTP"?["m="+s.kind+" 9 "+s.protocol+" "+l.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+l.port+`\r
`]:["m="+s.kind+" 9 "+s.protocol+" "+l.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+l.port+" "+l.protocol+` 65535\r
`],l.maxMessageSize!==void 0&&d.push("a=max-message-size:"+l.maxMessageSize+`\r
`),d.join("")},a.generateSessionId=function(){return Math.random().toString().substr(2,22)},a.writeSessionBoilerplate=function(s,l,d){let f;const m=l!==void 0?l:2;return f=s||a.generateSessionId(),`v=0\r
o=`+(d||"thisisadapterortc")+" "+f+" "+m+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},a.getDirection=function(s,l){const d=a.splitLines(s);for(let f=0;f<d.length;f++)switch(d[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return d[f].substring(2)}return l?a.getDirection(l):"sendrecv"},a.getKind=function(s){return a.splitLines(s)[0].split(" ")[0].substring(2)},a.isRejected=function(s){return s.split(" ",2)[1]==="0"},a.parseMLine=function(s){const l=a.splitLines(s)[0].substring(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},a.parseOLine=function(s){const l=a.matchPrefix(s,"o=")[0].substring(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},a.isValidSDP=function(s){if(typeof s!="string"||s.length===0)return!1;const l=a.splitLines(s);for(let d=0;d<l.length;d++)if(l[d].length<2||l[d].charAt(1)!=="=")return!1;return!0},r.exports=a})(EW);var wW=EW.exports,sg=o(wW),aRe=n({__proto__:null,default:sg},[wW]);function cx(r){if(!r.RTCIceCandidate||r.RTCIceCandidate&&"foundation"in r.RTCIceCandidate.prototype)return;const a=r.RTCIceCandidate;r.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&((s=JSON.parse(JSON.stringify(s))).candidate=s.candidate.substr(2)),s.candidate&&s.candidate.length){const l=new a(s),d=sg.parseCandidate(s.candidate),f=Object.assign(l,d);return f.toJSON=function(){return{candidate:f.candidate,sdpMid:f.sdpMid,sdpMLineIndex:f.sdpMLineIndex,usernameFragment:f.usernameFragment}},f}return new a(s)},r.RTCIceCandidate.prototype=a.prototype,Qf(r,"icecandidate",s=>(s.candidate&&Object.defineProperty(s,"candidate",{value:new r.RTCIceCandidate(s.candidate),writable:"false"}),s))}function yk(r){!r.RTCIceCandidate||r.RTCIceCandidate&&"relayProtocol"in r.RTCIceCandidate.prototype||Qf(r,"icecandidate",a=>{if(a.candidate){const s=sg.parseCandidate(a.candidate.candidate);s.type==="relay"&&(a.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[s.priority>>24])}return a})}function lx(r,a){if(!r.RTCPeerConnection)return;"sctp"in r.RTCPeerConnection.prototype||Object.defineProperty(r.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const s=function(y){if(!y||!y.sdp)return!1;const _=sg.splitSections(y.sdp);return _.shift(),_.some(S=>{const x=sg.parseMLine(S);return x&&x.kind==="application"&&x.protocol.indexOf("SCTP")!==-1})},l=function(y){const _=y.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const S=parseInt(_[1],10);return S!=S?-1:S},d=function(y){let _=65536;return a.browser==="firefox"&&(_=a.version<57?y===-1?16384:2147483637:a.version<60?a.version===57?65535:65536:2147483637),_},f=function(y,_){let S=65536;a.browser==="firefox"&&a.version===57&&(S=65535);const x=sg.matchPrefix(y.sdp,"a=max-message-size:");return x.length>0?S=parseInt(x[0].substr(19),10):a.browser==="firefox"&&_!==-1&&(S=2147483637),S},m=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,a.browser==="chrome"&&a.version>=76){const{sdpSemantics:y}=this.getConfiguration();y==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(s(arguments[0])){const y=l(arguments[0]),_=d(y),S=f(arguments[0],y);let x;x=_===0&&S===0?Number.POSITIVE_INFINITY:_===0||S===0?Math.max(_,S):Math.min(_,S);const A={};Object.defineProperty(A,"maxMessageSize",{get:()=>x}),this._sctp=A}return m.apply(this,arguments)}}function ux(r){if(!r.RTCPeerConnection||!("createDataChannel"in r.RTCPeerConnection.prototype))return;function a(l,d){const f=l.send;l.send=function(){const m=arguments[0],y=m.length||m.size||m.byteLength;if(l.readyState==="open"&&d.sctp&&y>d.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+d.sctp.maxMessageSize+" bytes)");return f.apply(l,arguments)}}const s=r.RTCPeerConnection.prototype.createDataChannel;r.RTCPeerConnection.prototype.createDataChannel=function(){const l=s.apply(this,arguments);return a(l,this),l},Qf(r,"datachannel",l=>(a(l.channel,l.target),l))}function _k(r){if(!r.RTCPeerConnection||"connectionState"in r.RTCPeerConnection.prototype)return;const a=r.RTCPeerConnection.prototype;Object.defineProperty(a,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(a,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(s){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),s&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=s)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(s=>{const l=a[s];a[s]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=d=>{const f=d.target;if(f._lastConnectionState!==f.connectionState){f._lastConnectionState=f.connectionState;const m=new Event("connectionstatechange",d);f.dispatchEvent(m)}return d},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),l.apply(this,arguments)}})}function bk(r,a){if(!r.RTCPeerConnection||a.browser==="chrome"&&a.version>=71||a.browser==="safari"&&a.version>=605)return;const s=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(l){if(l&&l.sdp&&l.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const d=l.sdp.split(`
`).filter(f=>Ea(f).call(f)!=="a=extmap-allow-mixed").join(`
`);r.RTCSessionDescription&&l instanceof r.RTCSessionDescription?arguments[0]=new r.RTCSessionDescription({type:l.type,sdp:d}):l.sdp=d}return s.apply(this,arguments)}}function dx(r,a){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const s=r.RTCPeerConnection.prototype.addIceCandidate;s&&s.length!==0&&(r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(a.browser==="chrome"&&a.version<78||a.browser==="firefox"&&a.version<68||a.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?He.resolve():s.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),He.resolve())})}function hx(r,a){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const s=r.RTCPeerConnection.prototype.setLocalDescription;s&&s.length!==0&&(r.RTCPeerConnection.prototype.setLocalDescription=function(){let l=arguments[0]||{};if(typeof l!="object"||l.type&&l.sdp)return s.apply(this,arguments);if(l={type:l.type,sdp:l.sdp},!l.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":l.type="offer";break;default:l.type="answer"}return l.sdp||l.type!=="offer"&&l.type!=="answer"?s.apply(this,[l]):(l.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(d=>s.apply(this,[d]))})}var sRe=Object.freeze({__proto__:null,removeExtmapAllowMixed:bk,shimAddIceCandidateNullOrEmpty:dx,shimConnectionState:_k,shimMaxMessageSize:lx,shimParameterlessSetLocalDescription:hx,shimRTCIceCandidate:cx,shimRTCIceCandidateRelayProtocol:yk,shimSendThrowTypeError:ux});(function(){let{window:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const s=L8,l=function(f){const m={browser:null,version:null};if(f===void 0||!f.navigator)return m.browser="Not a browser.",m;const{navigator:y}=f;if(y.mozGetUserMedia)m.browser="firefox",m.version=ox(y.userAgent,/Firefox\/(\d+)\./,1);else if(y.webkitGetUserMedia||f.isSecureContext===!1&&f.webkitRTCPeerConnection)m.browser="chrome",m.version=ox(y.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!f.RTCPeerConnection||!y.userAgent.match(/AppleWebKit\/(\d+)\./))return m.browser="Not a supported browser.",m;m.browser="safari",m.version=ox(y.userAgent,/AppleWebKit\/(\d+)\./,1),m.supportsUnifiedPlan=f.RTCRtpTransceiver&&"currentDirection"in f.RTCRtpTransceiver.prototype}return m}(r),d={browserDetails:l,commonShim:sRe,extractVersion:ox,disableLog:GCe,disableWarnings:HCe,sdp:aRe};switch(l.browser){case"chrome":if(!X8||!pk||!a.shimChrome)return s("Chrome shim is not included in this adapter release."),d;if(l.version===null)return s("Chrome shim can not determine version, not shimming."),d;s("adapter.js shimming chrome."),d.browserShim=X8,dx(r,l),hx(r),B8(r,l),$8(r),pk(r,l),W8(r),q8(r,l),G8(r),H8(r),z8(r),Y8(r,l),cx(r),yk(r),_k(r),lx(r,l),ux(r),bk(r,l);break;case"firefox":if(!oW||!mk||!a.shimFirefox)return s("Firefox shim is not included in this adapter release."),d;s("adapter.js shimming firefox."),d.browserShim=oW,dx(r,l),hx(r),J8(r,l),mk(r,l),Z8(r),tW(r),Q8(r),eW(r),nW(r),rW(r),iW(r),aW(r),sW(r),cx(r),_k(r),lx(r,l),ux(r);break;case"safari":if(!vW||!a.shimSafari)return s("Safari shim is not included in this adapter release."),d;s("adapter.js shimming safari."),d.browserShim=vW,dx(r,l),hx(r),fW(r),mW(r),uW(r),cW(r),lW(r),pW(r),dW(r),gW(r),cx(r),yk(r),lx(r,l),ux(r),bk(r,l);break;default:s("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Ek=R;Tn({global:!0,forced:Ek.globalThis!==Ek},{globalThis:Ek});var SW=o(R),wk={exports:{}};(function(r,a){(function(s,l){var d="function",f="undefined",m="object",y="string",_="major",S="model",x="name",A="type",I="vendor",L="version",K="architecture",$="console",G="mobile",ne="tablet",te="smarttv",ce="wearable",pe="embedded",fe="Amazon",ue="Apple",ye="ASUS",Se="BlackBerry",Ie="Browser",Me="Chrome",Gt="Firefox",Kt="Google",Nt="Huawei",bn="LG",vn="Microsoft",Xi="Motorola",Re="Opera",Ve="Samsung",Ze="Sharp",Oe="Sony",B="Xiaomi",le="Zebra",he="Facebook",Fe="Chromium OS",Vt="Mac OS",Vn=" Browser",Jr=function(zr){for(var Zr={},zn=0;zn<zr.length;zn++)Zr[zr[zn].toUpperCase()]=zr[zn];return Zr},ko=function(zr,Zr){return typeof zr===y&&Sc(Zr).indexOf(Sc(zr))!==-1},Sc=function(zr){return zr.toLowerCase()},Jb=function(zr,Zr){if(typeof zr===y)return zr=zr.replace(/^\s\s*/,""),typeof Zr===f?zr:zr.substring(0,500)},Rp=function(zr,Zr){for(var zn,ds,dl,Ir,pd,on,hl=0;hl<Zr.length&&!pd;){var Np=Zr[hl],pu=Zr[hl+1];for(zn=ds=0;zn<Np.length&&!pd&&Np[zn];)if(pd=Np[zn++].exec(zr))for(dl=0;dl<pu.length;dl++)on=pd[++ds],typeof(Ir=pu[dl])===m&&Ir.length>0?Ir.length===2?typeof Ir[1]==d?this[Ir[0]]=Ir[1].call(this,on):this[Ir[0]]=Ir[1]:Ir.length===3?typeof Ir[1]!==d||Ir[1].exec&&Ir[1].test?this[Ir[0]]=on?on.replace(Ir[1],Ir[2]):l:this[Ir[0]]=on?Ir[1].call(this,on,Ir[2]):l:Ir.length===4&&(this[Ir[0]]=on?Ir[3].call(this,on.replace(Ir[1],Ir[2])):l):this[Ir]=on||l;hl+=2}},Qg=function(zr,Zr){for(var zn in Zr)if(typeof Zr[zn]===m&&Zr[zn].length>0){for(var ds=0;ds<Zr[zn].length;ds++)if(ko(Zr[zn][ds],zr))return zn==="?"?l:zn}else if(ko(Zr[zn],zr))return zn==="?"?l:zn;return Zr.hasOwnProperty("*")?Zr["*"]:zr},hC={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},fC={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[L,[x,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[L,[x,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[x,L],[/opios[\/ ]+([\w\.]+)/i],[L,[x,Re+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[L,[x,Re+" GX"]],[/\bopr\/([\w\.]+)/i],[L,[x,Re]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[L,[x,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[L,[x,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[x,L],[/quark(?:pc)?\/([-\w\.]+)/i],[L,[x,"Quark"]],[/\bddg\/([\w\.]+)/i],[L,[x,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[L,[x,"UC"+Ie]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[L,[x,"WeChat"]],[/konqueror\/([\w\.]+)/i],[L,[x,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[L,[x,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[L,[x,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[L,[x,"Smart Lenovo "+Ie]],[/(avast|avg)\/([\w\.]+)/i],[[x,/(.+)/,"$1 Secure "+Ie],L],[/\bfocus\/([\w\.]+)/i],[L,[x,Gt+" Focus"]],[/\bopt\/([\w\.]+)/i],[L,[x,Re+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[L,[x,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[L,[x,"Dolphin"]],[/coast\/([\w\.]+)/i],[L,[x,Re+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[L,[x,"MIUI"+Vn]],[/fxios\/([\w\.-]+)/i],[L,[x,Gt]],[/\bqihoobrowser\/?([\w\.]*)/i],[L,[x,"360"]],[/\b(qq)\/([\w\.]+)/i],[[x,/(.+)/,"$1Browser"],L],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[x,/(.+)/,"$1"+Vn],L],[/samsungbrowser\/([\w\.]+)/i],[L,[x,Ve+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[L,[x,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[x,"Sogou Mobile"],L],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[x,L],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[x],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[L,x],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[x,he],L],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[x,L],[/\bgsa\/([\w\.]+) .*safari\//i],[L,[x,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[L,[x,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[L,[x,Me+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[x,Me+" WebView"],L],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[L,[x,"Android "+Ie]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[x,L],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[L,[x,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[L,x],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[x,[L,Qg,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[x,L],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[x,"Netscape"],L],[/(wolvic|librewolf)\/([\w\.]+)/i],[x,L],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[L,[x,Gt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[x,[L,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[x,[L,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[K,"amd64"]],[/(ia32(?=;))/i],[[K,Sc]],[/((?:i[346]|x)86)[;\)]/i],[[K,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[K,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[K,"armhf"]],[/windows (ce|mobile); ppc;/i],[[K,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[K,/ower/,"",Sc]],[/(sun4\w)[;\)]/i],[[K,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[K,Sc]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[S,[I,Ve],[A,ne]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[S,[I,Ve],[A,G]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[S,[I,ue],[A,G]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[S,[I,ue],[A,ne]],[/(macintosh);/i],[S,[I,ue]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[S,[I,Ze],[A,G]],[/(?:honor)([-\w ]+)[;\)]/i],[S,[I,"Honor"],[A,G]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[S,[I,Nt],[A,ne]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[S,[I,Nt],[A,G]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[S,/_/g," "],[I,B],[A,G]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[S,/_/g," "],[I,B],[A,ne]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[S,[I,"OPPO"],[A,G]],[/\b(opd2\d{3}a?) bui/i],[S,[I,"OPPO"],[A,ne]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[S,[I,"Vivo"],[A,G]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[S,[I,"Realme"],[A,G]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[S,[I,Xi],[A,G]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[S,[I,Xi],[A,ne]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[S,[I,bn],[A,ne]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[S,[I,bn],[A,G]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[S,[I,"Lenovo"],[A,ne]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[S,/_/g," "],[I,"Nokia"],[A,G]],[/(pixel c)\b/i],[S,[I,Kt],[A,ne]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[S,[I,Kt],[A,G]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[S,[I,Oe],[A,G]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[S,"Xperia Tablet"],[I,Oe],[A,ne]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[S,[I,"OnePlus"],[A,G]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[S,[I,fe],[A,ne]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[S,/(.+)/g,"Fire Phone $1"],[I,fe],[A,G]],[/(playbook);[-\w\),; ]+(rim)/i],[S,I,[A,ne]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[S,[I,Se],[A,G]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[S,[I,ye],[A,ne]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[S,[I,ye],[A,G]],[/(nexus 9)/i],[S,[I,"HTC"],[A,ne]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[I,[S,/_/g," "],[A,G]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[S,[I,"TCL"],[A,ne]],[/(itel) ((\w+))/i],[[I,Sc],S,[A,Qg,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[S,[I,"Acer"],[A,ne]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[S,[I,"Meizu"],[A,G]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[S,[I,"Ulefone"],[A,G]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[S,[I,"Energizer"],[A,G]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[S,[I,"Cat"],[A,G]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[S,[I,"Smartfren"],[A,G]],[/droid.+; (a(?:015|06[35]|142p?))/i],[S,[I,"Nothing"],[A,G]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,S,[A,G]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,S,[A,ne]],[/(surface duo)/i],[S,[I,vn],[A,ne]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[S,[I,"Fairphone"],[A,G]],[/(u304aa)/i],[S,[I,"AT&T"],[A,G]],[/\bsie-(\w*)/i],[S,[I,"Siemens"],[A,G]],[/\b(rct\w+) b/i],[S,[I,"RCA"],[A,ne]],[/\b(venue[\d ]{2,7}) b/i],[S,[I,"Dell"],[A,ne]],[/\b(q(?:mv|ta)\w+) b/i],[S,[I,"Verizon"],[A,ne]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[S,[I,"Barnes & Noble"],[A,ne]],[/\b(tm\d{3}\w+) b/i],[S,[I,"NuVision"],[A,ne]],[/\b(k88) b/i],[S,[I,"ZTE"],[A,ne]],[/\b(nx\d{3}j) b/i],[S,[I,"ZTE"],[A,G]],[/\b(gen\d{3}) b.+49h/i],[S,[I,"Swiss"],[A,G]],[/\b(zur\d{3}) b/i],[S,[I,"Swiss"],[A,ne]],[/\b((zeki)?tb.*\b) b/i],[S,[I,"Zeki"],[A,ne]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],S,[A,ne]],[/\b(ns-?\w{0,9}) b/i],[S,[I,"Insignia"],[A,ne]],[/\b((nxa|next)-?\w{0,9}) b/i],[S,[I,"NextBook"],[A,ne]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],S,[A,G]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],S,[A,G]],[/\b(ph-1) /i],[S,[I,"Essential"],[A,G]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[S,[I,"Envizen"],[A,ne]],[/\b(trio[-\w\. ]+) b/i],[S,[I,"MachSpeed"],[A,ne]],[/\btu_(1491) b/i],[S,[I,"Rotor"],[A,ne]],[/(shield[\w ]+) b/i],[S,[I,"Nvidia"],[A,ne]],[/(sprint) (\w+)/i],[I,S,[A,G]],[/(kin\.[onetw]{3})/i],[[S,/\./g," "],[I,vn],[A,G]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[S,[I,le],[A,ne]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[S,[I,le],[A,G]],[/smart-tv.+(samsung)/i],[I,[A,te]],[/hbbtv.+maple;(\d+)/i],[[S,/^/,"SmartTV"],[I,Ve],[A,te]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,bn],[A,te]],[/(apple) ?tv/i],[I,[S,ue+" TV"],[A,te]],[/crkey/i],[[S,Me+"cast"],[I,Kt],[A,te]],[/droid.+aft(\w+)( bui|\))/i],[S,[I,fe],[A,te]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[S,[I,Ze],[A,te]],[/(bravia[\w ]+)( bui|\))/i],[S,[I,Oe],[A,te]],[/(mitv-\w{5}) bui/i],[S,[I,B],[A,te]],[/Hbbtv.*(technisat) (.*);/i],[I,S,[A,te]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[I,Jb],[S,Jb],[A,te]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[A,te]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,S,[A,$]],[/droid.+; (shield) bui/i],[S,[I,"Nvidia"],[A,$]],[/(playstation [345portablevi]+)/i],[S,[I,Oe],[A,$]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[S,[I,vn],[A,$]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[S,[I,Ve],[A,ce]],[/((pebble))app/i],[I,S,[A,ce]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[S,[I,ue],[A,ce]],[/droid.+; (glass) \d/i],[S,[I,Kt],[A,ce]],[/droid.+; (wt63?0{2,3})\)/i],[S,[I,le],[A,ce]],[/droid.+; (glass) \d/i],[S,[I,Kt],[A,ce]],[/(pico) (4|neo3(?: link|pro)?)/i],[I,S,[A,ce]],[/; (quest( \d| pro)?)/i],[S,[I,he],[A,ce]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[A,pe]],[/(aeobc)\b/i],[S,[I,fe],[A,pe]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[S,[A,G]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[S,[A,ne]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[A,ne]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[A,G]],[/(android[-\w\. ]{0,9});.+buil/i],[S,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[L,[x,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[x,L],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[L,[x,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[x,L],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[L,x]],os:[[/microsoft (windows) (vista|xp)/i],[x,L],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[x,[L,Qg,hC]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[L,Qg,hC],[x,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[L,/_/g,"."],[x,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[x,Vt],[L,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[L,x],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[x,L],[/\(bb(10);/i],[L,[x,Se]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[L,[x,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[L,[x,Gt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[L,[x,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[L,[x,"watchOS"]],[/crkey\/([\d\.]+)/i],[L,[x,Me+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[x,Fe],L],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[x,L],[/(sunos) ?([\w\.\d]*)/i],[[x,"Solaris"],L],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[x,L]]},jo=function(zr,Zr){if(typeof zr===m&&(Zr=zr,zr=l),!(this instanceof jo))return new jo(zr,Zr).getResult();var zn=typeof s!==f&&s.navigator?s.navigator:l,ds=zr||(zn&&zn.userAgent?zn.userAgent:""),dl=zn&&zn.userAgentData?zn.userAgentData:l,Ir=Zr?function(on,hl){var Np={};for(var pu in on)hl[pu]&&hl[pu].length%2==0?Np[pu]=hl[pu].concat(on[pu]):Np[pu]=on[pu];return Np}(fC,Zr):fC,pd=zn&&zn.userAgent==ds;return this.getBrowser=function(){var on={};return on[x]=l,on[L]=l,Rp.call(on,ds,Ir.browser),on[_]=function(hl){return typeof hl===y?hl.replace(/[^\d\.]/g,"").split(".")[0]:l}(on[L]),pd&&zn&&zn.brave&&typeof zn.brave.isBrave==d&&(on[x]="Brave"),on},this.getCPU=function(){var on={};return on[K]=l,Rp.call(on,ds,Ir.cpu),on},this.getDevice=function(){var on={};return on[I]=l,on[S]=l,on[A]=l,Rp.call(on,ds,Ir.device),pd&&!on[A]&&dl&&dl.mobile&&(on[A]=G),pd&&on[S]=="Macintosh"&&zn&&typeof zn.standalone!==f&&zn.maxTouchPoints&&zn.maxTouchPoints>2&&(on[S]="iPad",on[A]=ne),on},this.getEngine=function(){var on={};return on[x]=l,on[L]=l,Rp.call(on,ds,Ir.engine),on},this.getOS=function(){var on={};return on[x]=l,on[L]=l,Rp.call(on,ds,Ir.os),pd&&!on[x]&&dl&&dl.platform&&dl.platform!="Unknown"&&(on[x]=dl.platform.replace(/chrome os/i,Fe).replace(/macos/i,Vt)),on},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ds},this.setUA=function(on){return ds=typeof on===y&&on.length>500?Jb(on,500):on,this},this.setUA(ds),this};jo.VERSION="0.7.40",jo.BROWSER=Jr([x,L,_]),jo.CPU=Jr([K]),jo.DEVICE=Jr([S,I,A,$,G,te,ne,ce,pe]),jo.ENGINE=jo.OS=Jr([x,L]),r.exports&&(a=r.exports=jo),a.UAParser=jo;var fd=typeof s!==f&&(s.jQuery||s.Zepto);if(fd&&!fd.ua){var pC=new jo;fd.ua=pC.getResult(),fd.ua.get=function(){return pC.getUA()},fd.ua.set=function(zr){pC.setUA(zr);var Zr=pC.getResult();for(var zn in Zr)fd.ua[zn]=Zr[zn]}}})(typeof window=="object"?window:i)})(wk,wk.exports);var oRe=o(wk.exports),xW=FS.clear;Tn({global:!0,bind:!0,forced:R.clearImmediate!==xW},{clearImmediate:xW});var TW=R,cRe=P,lRe=z,uRe=OO,dRe=gn,hRe=rh,fRe=Kf,pRe=TW.Function,mRe=/MSIE .\./.test(dRe)||uRe==="BUN"&&function(){var r=TW.Bun.version.split(".");return r.length<3||r[0]==="0"&&(r[1]<3||r[1]==="3"&&r[2]==="0")}(),gRe=Tn,CW=R,RW=FS.set,vRe=function(r,a){var s=1;return mRe?function(l,d){var f=fRe(arguments.length,1)>s,m=lRe(l)?l:pRe(l),y=f?hRe(arguments,s):[],_=f?function(){cRe(m,this,y)}:m;return r(_)}:r},NW=CW.setImmediate?vRe(RW):RW;gRe({global:!0,bind:!0,forced:CW.setImmediate!==NW},{setImmediate:NW});var AW=o(Le.setImmediate),yRe=R,_Re=B$,bRe=wi,ERe=Kf,wRe=X;Tn({global:!0,dontCallGetSet:!0,forced:u(function(){return wRe&&Object.getOwnPropertyDescriptor(yRe,"queueMicrotask").value.length!==1})},{queueMicrotask:function(r){ERe(arguments.length,1),_Re(bRe(r))}});var IW=o(Le.queueMicrotask);function OW(r,a){return function(){return r.apply(a,arguments)}}const{toString:SRe}=Object.prototype,{getPrototypeOf:Sk}=Object,{iterator:fx,toStringTag:PW}=Symbol,px=(xk=Object.create(null),r=>{const a=SRe.call(r);return xk[a]||(xk[a]=a.slice(8,-1).toLowerCase())});var xk;const Xc=r=>(r=r.toLowerCase(),a=>px(a)===r),mx=r=>a=>typeof a===r,{isArray:og}=Array,q_=mx("undefined"),kW=Xc("ArrayBuffer"),xRe=mx("string"),zs=mx("function"),jW=mx("number"),gx=r=>r!==null&&typeof r=="object",vx=r=>{if(px(r)!=="object")return!1;const a=Sk(r);return!(a!==null&&a!==Object.prototype&&Object.getPrototypeOf(a)!==null||PW in r||fx in r)},TRe=Xc("Date"),CRe=Xc("File"),RRe=Xc("Blob"),NRe=Xc("FileList"),ARe=Xc("URLSearchParams"),[IRe,ORe,PRe,kRe]=["ReadableStream","Request","Response","Headers"].map(Xc);function Y_(r,a){let s,l,{allOwnKeys:d=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r!=null)if(typeof r!="object"&&(r=[r]),og(r))for(s=0,l=r.length;s<l;s++)a.call(null,r[s],s,r);else{const f=d?Object.getOwnPropertyNames(r):Object.keys(r),m=f.length;let y;for(s=0;s<m;s++)y=f[s],a.call(null,r[y],y,r)}}function DW(r,a){a=a.toLowerCase();const s=Object.keys(r);let l,d=s.length;for(;d-- >0;)if(l=s[d],a===l.toLowerCase())return l;return null}const ep=SW!==void 0?SW:typeof self<"u"?self:typeof window<"u"?window:Xh,LW=r=>!q_(r)&&r!==ep,jRe=(Tk=typeof Uint8Array<"u"&&Sk(Uint8Array),r=>Tk&&r instanceof Tk);var Tk;const DRe=Xc("HTMLFormElement"),MW=(r=>{let{hasOwnProperty:a}=r;return(s,l)=>a.call(s,l)})(Object.prototype),LRe=Xc("RegExp"),UW=(r,a)=>{const s=Object.getOwnPropertyDescriptors(r),l={};Y_(s,(d,f)=>{let m;(m=a(d,f,r))!==!1&&(l[f]=m||d)}),Object.defineProperties(r,l)},MRe=Xc("AsyncFunction"),FW=(VW=typeof AW=="function",BW=zs(ep.postMessage),VW?AW:BW?(Ck="axios@".concat(Math.random()),yx=[],ep.addEventListener("message",r=>{let{source:a,data:s}=r;a===ep&&s===Ck&&yx.length&&yx.shift()()},!1),r=>{yx.push(r),ep.postMessage(Ck,"*")}):r=>setTimeout(r));var VW,BW,Ck,yx;const URe=IW!==void 0?IW.bind(ep):typeof process<"u"&&process.nextTick||FW;var Ge={isArray:og,isArrayBuffer:kW,isBuffer:function(r){return r!==null&&!q_(r)&&r.constructor!==null&&!q_(r.constructor)&&zs(r.constructor.isBuffer)&&r.constructor.isBuffer(r)},isFormData:r=>{let a;return r&&(typeof FormData=="function"&&r instanceof FormData||zs(r.append)&&((a=px(r))==="formdata"||a==="object"&&zs(r.toString)&&r.toString()==="[object FormData]"))},isArrayBufferView:function(r){let a;return a=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer&&kW(r.buffer),a},isString:xRe,isNumber:jW,isBoolean:r=>r===!0||r===!1,isObject:gx,isPlainObject:vx,isReadableStream:IRe,isRequest:ORe,isResponse:PRe,isHeaders:kRe,isUndefined:q_,isDate:TRe,isFile:CRe,isBlob:RRe,isRegExp:LRe,isFunction:zs,isStream:r=>gx(r)&&zs(r.pipe),isURLSearchParams:ARe,isTypedArray:jRe,isFileList:NRe,forEach:Y_,merge:function r(){const{caseless:a}=LW(this)&&this||{},s={},l=(d,f)=>{const m=a&&DW(s,f)||f;vx(s[m])&&vx(d)?s[m]=r(s[m],d):vx(d)?s[m]=r({},d):og(d)?s[m]=d.slice():s[m]=d};for(let d=0,f=arguments.length;d<f;d++)arguments[d]&&Y_(arguments[d],l);return s},extend:function(r,a,s){let{allOwnKeys:l}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Y_(a,(d,f)=>{s&&zs(d)?r[f]=OW(d,s):r[f]=d},{allOwnKeys:l}),r},trim:r=>Ea(r)?Ea(r).call(r):r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),inherits:(r,a,s,l)=>{r.prototype=Object.create(a.prototype,l),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:a.prototype}),s&&Object.assign(r.prototype,s)},toFlatObject:(r,a,s,l)=>{let d,f,m;const y={};if(a=a||{},r==null)return a;do{for(d=Object.getOwnPropertyNames(r),f=d.length;f-- >0;)m=d[f],l&&!l(m,r,a)||y[m]||(a[m]=r[m],y[m]=!0);r=s!==!1&&Sk(r)}while(r&&(!s||s(r,a))&&r!==Object.prototype);return a},kindOf:px,kindOfTest:Xc,endsWith:(r,a,s)=>{r=String(r),(s===void 0||s>r.length)&&(s=r.length),s-=a.length;const l=r.indexOf(a,s);return l!==-1&&l===s},toArray:r=>{if(!r)return null;if(og(r))return r;let a=r.length;if(!jW(a))return null;const s=new Array(a);for(;a-- >0;)s[a]=r[a];return s},forEachEntry:(r,a)=>{const s=(r&&r[fx]).call(r);let l;for(;(l=s.next())&&!l.done;){const d=l.value;a.call(r,d[0],d[1])}},matchAll:(r,a)=>{let s;const l=[];for(;(s=r.exec(a))!==null;)l.push(s);return l},isHTMLForm:DRe,hasOwnProperty:MW,hasOwnProp:MW,reduceDescriptors:UW,freezeMethods:r=>{UW(r,(a,s)=>{if(zs(r)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const l=r[s];zs(l)&&(a.enumerable=!1,"writable"in a?a.writable=!1:a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))})},toObjectSet:(r,a)=>{const s={},l=d=>{d.forEach(f=>{s[f]=!0})};return og(r)?l(r):l(String(r).split(a)),s},toCamelCase:r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,s,l){return s.toUpperCase()+l}),noop:()=>{},toFiniteNumber:(r,a)=>r!=null&&Number.isFinite(r=+r)?r:a,findKey:DW,global:ep,isContextDefined:LW,isSpecCompliantForm:function(r){return!!(r&&zs(r.append)&&r[PW]==="FormData"&&r[fx])},toJSONObject:r=>{const a=new Array(10),s=(l,d)=>{if(gx(l)){if(a.indexOf(l)>=0)return;if(!("toJSON"in l)){a[d]=l;const f=og(l)?[]:{};return Y_(l,(m,y)=>{const _=s(m,d+1);!q_(_)&&(f[y]=_)}),a[d]=void 0,f}}return l};return s(r,0)},isAsyncFn:MRe,isThenable:r=>r&&(gx(r)||zs(r))&&zs(r.then)&&zs(r.catch),setImmediate:FW,asap:URe,isIterable:r=>r!=null&&zs(r[fx])};function Pn(r,a,s,l,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",a&&(this.code=a),s&&(this.config=s),l&&(this.request=l),d&&(this.response=d,this.status=d.status?d.status:null)}Ge.inherits(Pn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ge.toJSONObject(this.config),code:this.code,status:this.status}}});const $W=Pn.prototype,WW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{WW[r]={value:r}}),Object.defineProperties(Pn,WW),Object.defineProperty($W,"isAxiosError",{value:!0}),Pn.from=(r,a,s,l,d,f)=>{const m=Object.create($W);return Ge.toFlatObject(r,m,function(y){return y!==Error.prototype},y=>y!=="isAxiosError"),Pn.call(m,r.message,a,s,l,d),m.cause=r,m.name=r.name,f&&Object.assign(m,f),m};function Rk(r){return Ge.isPlainObject(r)||Ge.isArray(r)}function GW(r){return Ge.endsWith(r,"[]")?r.slice(0,-2):r}function HW(r,a,s){return r?r.concat(a).map(function(l,d){return l=GW(l),!s&&d?"["+l+"]":l}).join(s?".":""):a}const FRe=Ge.toFlatObject(Ge,{},null,function(r){return/^is[A-Z]/.test(r)});function _x(r,a,s){if(!Ge.isObject(r))throw new TypeError("target must be an object");a=a||new FormData;const l=(s=Ge.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,L){return!Ge.isUndefined(L[I])})).metaTokens,d=s.visitor||S,f=s.dots,m=s.indexes,y=(s.Blob||typeof Blob<"u"&&Blob)&&Ge.isSpecCompliantForm(a);if(!Ge.isFunction(d))throw new TypeError("visitor must be a function");function _(I){if(I===null)return"";if(Ge.isDate(I))return I.toISOString();if(!y&&Ge.isBlob(I))throw new Pn("Blob is not supported. Use a Buffer instead.");return Ge.isArrayBuffer(I)||Ge.isTypedArray(I)?y&&typeof Blob=="function"?new Blob([I]):Buffer.from(I):I}function S(I,L,K){let $=I;if(I&&!K&&typeof I=="object"){if(Ge.endsWith(L,"{}"))L=l?L:L.slice(0,-2),I=JSON.stringify(I);else if(Ge.isArray(I)&&function(G){return Ge.isArray(G)&&!G.some(Rk)}(I)||(Ge.isFileList(I)||Ge.endsWith(L,"[]"))&&($=Ge.toArray(I)))return L=GW(L),$.forEach(function(G,ne){!Ge.isUndefined(G)&&G!==null&&a.append(m===!0?HW([L],ne,f):m===null?L:L+"[]",_(G))}),!1}return!!Rk(I)||(a.append(HW(K,L,f),_(I)),!1)}const x=[],A=Object.assign(FRe,{defaultVisitor:S,convertValue:_,isVisitable:Rk});if(!Ge.isObject(r))throw new TypeError("data must be an object");return function I(L,K){if(!Ge.isUndefined(L)){if(x.indexOf(L)!==-1)throw Error("Circular reference detected in "+K.join("."));x.push(L),Ge.forEach(L,function($,G){(!(Ge.isUndefined($)||$===null)&&d.call(a,$,Ge.isString(G)?Ea(G).call(G):G,K,A))===!0&&I($,K?K.concat(G):[G])}),x.pop()}}(r),a}function zW(r){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return a[s]})}function Nk(r,a){this._pairs=[],r&&_x(r,this,a)}const KW=Nk.prototype;function VRe(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function qW(r,a,s){if(!a)return r;const l=s&&s.encode||VRe;Ge.isFunction(s)&&(s={serialize:s});const d=s&&s.serialize;let f;if(f=d?d(a,s):Ge.isURLSearchParams(a)?a.toString():new Nk(a,s).toString(l),f){const m=r.indexOf("#");m!==-1&&(r=r.slice(0,m)),r+=(r.indexOf("?")===-1?"?":"&")+f}return r}KW.append=function(r,a){this._pairs.push([r,a])},KW.toString=function(r){const a=r?function(s){return r.call(this,s,zW)}:zW;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};var YW=class{constructor(){this.handlers=[]}use(r,a,s){return this.handlers.push({fulfilled:r,rejected:a,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Ge.forEach(this.handlers,function(a){a!==null&&r(a)})}},XW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},JW={exports:{}},BRe=Tn,$Re=X,ZW=tc.f;BRe({target:"Object",stat:!0,forced:Object.defineProperty!==ZW,sham:!$Re},{defineProperty:ZW});var QW=Le.Object,WRe=JW.exports=function(r,a,s){return QW.defineProperty(r,a,s)};QW.defineProperty.sham&&(WRe.sham=!0);var eG=o(JW.exports),GRe=TypeError,tG=A_,HRe=US,zRe=Rt,KRe=qr("species"),nG=Array,qRe=function(r){var a;return tG(r)&&(a=r.constructor,(HRe(a)&&(a===nG||tG(a.prototype))||zRe(a)&&(a=a[KRe])===null)&&(a=void 0)),a===void 0?nG:a},rG=function(r,a){return new(qRe(r))(a===0?0:a)},YRe=u,XRe=Gi,JRe=qr("species"),iG=function(r){return XRe>=51||!YRe(function(){var a=[];return(a.constructor={})[JRe]=function(){return{foo:1}},a[r](Boolean).foo!==1})},ZRe=Tn,QRe=u,eNe=A_,tNe=Rt,nNe=ql,rNe=eh,aG=function(r){if(r>9007199254740991)throw GRe("Maximum allowed index exceeded");return r},sG=GP,iNe=rG,aNe=iG,sNe=Gi,oG=qr("isConcatSpreadable"),oNe=sNe>=51||!QRe(function(){var r=[];return r[oG]=!1,r.concat()[0]!==r}),cNe=function(r){if(!tNe(r))return!1;var a=r[oG];return a!==void 0?!!a:eNe(r)};ZRe({target:"Array",proto:!0,forced:!oNe||!aNe("concat")},{concat:function(r){var a,s,l,d,f,m=nNe(this),y=iNe(m,0),_=0;for(a=-1,l=arguments.length;a<l;a++)if(cNe(f=a===-1?m:arguments[a]))for(d=rNe(f),aG(_+d),s=0;s<d;s++,_++)s in f&&sG(y,_,f[s]);else aG(_+1),sG(y,_++,f);return y.length=_,y}});var cG={},lNe=F,uNe=ut,lG=wS.f,dNe=rh,uG=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];cG.f=function(r){return uG&&lNe(r)==="Window"?function(a){try{return lG(a)}catch{return dNe(uG)}}(r):lG(uNe(r))};var cg={},hNe=qr;cg.f=hNe;var dG=Le,fNe=aa,pNe=cg,mNe=tc.f,Si=function(r){var a=dG.Symbol||(dG.Symbol={});fNe(a,r)||mNe(a,r,{value:pNe.f(r)})},gNe=J,vNe=ot,yNe=qr,_Ne=nh,hG=function(){var r=vNe("Symbol"),a=r&&r.prototype,s=a&&a.valueOf,l=yNe("toPrimitive");a&&!a[l]&&_Ne(a,l,function(d){return gNe(s,this)},{})},bNe=Qd,ENe=$e,wNe=ql,SNe=eh,xNe=rG,fG=E([].push),TNe=function(r){var a=r===1,s=r===2,l=r===3,d=r===4,f=r===6,m=r===7,y=r===5||f;return function(_,S,x,A){for(var I,L,K=wNe(_),$=ENe(K),G=SNe($),ne=bNe(S,x),te=0,ce=A||xNe,pe=a?ce(_,G):s||m?ce(_,0):void 0;G>te;te++)if((y||te in $)&&(L=ne(I=$[te],te,K),r))if(a)pe[te]=L;else if(L)switch(r){case 3:return!0;case 5:return I;case 6:return te;case 2:fG(pe,I)}else switch(r){case 4:return!1;case 7:fG(pe,I)}return f?-1:l||d?d:pe}},pG={forEach:TNe(0)},bx=Tn,X_=R,Ak=J,CNe=E,lg=X,ug=Bn,RNe=u,ka=aa,NNe=T,Ik=Ts,Ex=ut,Ok=yO,ANe=Hs,Pk=Pe,dg=O_,mG=xS,INe=wS,gG=cG,ONe=I_,vG=Z,yG=tc,PNe=UO,_G=re,bG=nh,kNe=MS,kk=Um,EG=SS,wG=gO,jNe=qr,DNe=cg,LNe=Si,MNe=hG,UNe=Zu,SG=zf,wx=pG.forEach,Ks=ES("hidden"),Sx="Symbol",J_="prototype",FNe=SG.set,xG=SG.getterFor(Sx),Jc=Object[J_],tp=X_.Symbol,xx=tp&&tp[J_],VNe=X_.RangeError,BNe=X_.TypeError,jk=X_.QObject,TG=vG.f,np=yG.f,CG=gG.f,$Ne=_G.f,RG=CNe([].push),td=kk("symbols"),Z_=kk("op-symbols"),WNe=kk("wks"),Dk=!jk||!jk[J_]||!jk[J_].findChild,NG=function(r,a,s){var l=TG(Jc,a);l&&delete Jc[a],np(r,a,s),l&&r!==Jc&&np(Jc,a,l)},Lk=lg&&RNe(function(){return dg(np({},"a",{get:function(){return np(this,"a",{value:7}).a}})).a!==7})?NG:np,Mk=function(r,a){var s=td[r]=dg(xx);return FNe(s,{type:Sx,tag:r,description:a}),lg||(s.description=a),s},Tx=function(r,a,s){r===Jc&&Tx(Z_,a,s),Ik(r);var l=Ok(a);return Ik(s),ka(td,l)?(s.enumerable?(ka(r,Ks)&&r[Ks][l]&&(r[Ks][l]=!1),s=dg(s,{enumerable:Pk(0,!1)})):(ka(r,Ks)||np(r,Ks,Pk(1,dg(null))),r[Ks][l]=!0),Lk(r,l,s)):np(r,l,s)},Uk=function(r,a){Ik(r);var s=Ex(a),l=mG(s).concat(PG(s));return wx(l,function(d){lg&&!Ak(AG,s,d)||Tx(r,d,s[d])}),r},AG=function(r){var a=Ok(r),s=Ak($Ne,this,a);return!(this===Jc&&ka(td,a)&&!ka(Z_,a))&&(!(s||!ka(this,a)||!ka(td,a)||ka(this,Ks)&&this[Ks][a])||s)},IG=function(r,a){var s=Ex(r),l=Ok(a);if(s!==Jc||!ka(td,l)||ka(Z_,l)){var d=TG(s,l);return!d||!ka(td,l)||ka(s,Ks)&&s[Ks][l]||(d.enumerable=!0),d}},OG=function(r){var a=CG(Ex(r)),s=[];return wx(a,function(l){ka(td,l)||ka(EG,l)||RG(s,l)}),s},PG=function(r){var a=r===Jc,s=CG(a?Z_:Ex(r)),l=[];return wx(s,function(d){!ka(td,d)||a&&!ka(Jc,d)||RG(l,td[d])}),l};ug||(tp=function(){if(NNe(xx,this))throw new BNe("Symbol is not a constructor");var r=arguments.length&&arguments[0]!==void 0?ANe(arguments[0]):void 0,a=wG(r),s=function(l){var d=this===void 0?X_:this;d===Jc&&Ak(s,Z_,l),ka(d,Ks)&&ka(d[Ks],a)&&(d[Ks][a]=!1);var f=Pk(1,l);try{Lk(d,a,f)}catch(m){if(!(m instanceof VNe))throw m;NG(d,a,f)}};return lg&&Dk&&Lk(Jc,a,{configurable:!0,set:s}),Mk(a,r)},bG(xx=tp[J_],"toString",function(){return xG(this).tag}),bG(tp,"withoutSetter",function(r){return Mk(wG(r),r)}),_G.f=AG,yG.f=Tx,PNe.f=Uk,vG.f=IG,INe.f=gG.f=OG,ONe.f=PG,DNe.f=function(r){return Mk(jNe(r),r)},lg&&kNe(xx,"description",{configurable:!0,get:function(){return xG(this).description}})),bx({global:!0,wrap:!0,forced:!ug,sham:!ug},{Symbol:tp}),wx(mG(WNe),function(r){LNe(r)}),bx({target:Sx,stat:!0,forced:!ug},{useSetter:function(){Dk=!0},useSimple:function(){Dk=!1}}),bx({target:"Object",stat:!0,forced:!ug,sham:!lg},{create:function(r,a){return a===void 0?dg(r):Uk(dg(r),a)},defineProperty:Tx,defineProperties:Uk,getOwnPropertyDescriptor:IG}),bx({target:"Object",stat:!0,forced:!ug},{getOwnPropertyNames:OG}),MNe(),UNe(tp,Sx),EG[Ks]=!0;var kG=Bn&&!!Symbol.for&&!!Symbol.keyFor,GNe=Tn,HNe=ot,zNe=aa,KNe=Hs,jG=Um,qNe=kG,Fk=jG("string-to-symbol-registry"),YNe=jG("symbol-to-string-registry");GNe({target:"Symbol",stat:!0,forced:!qNe},{for:function(r){var a=KNe(r);if(zNe(Fk,a))return Fk[a];var s=HNe("Symbol")(a);return Fk[a]=s,YNe[s]=a,s}});var XNe=Tn,JNe=aa,ZNe=Wf,QNe=nr,eAe=kG,DG=Um("symbol-to-string-registry");XNe({target:"Symbol",stat:!0,forced:!eAe},{keyFor:function(r){if(!ZNe(r))throw new TypeError(QNe(r)+" is not a symbol");if(JNe(DG,r))return DG[r]}});var LG=A_,tAe=z,MG=F,nAe=Hs,UG=E([].push),rAe=Tn,FG=ot,VG=P,iAe=J,Q_=E,BG=u,$G=z,WG=Wf,GG=rh,aAe=function(r){if(tAe(r))return r;if(LG(r)){for(var a=r.length,s=[],l=0;l<a;l++){var d=r[l];typeof d=="string"?UG(s,d):typeof d!="number"&&MG(d)!=="Number"&&MG(d)!=="String"||UG(s,nAe(d))}var f=s.length,m=!0;return function(y,_){if(m)return m=!1,_;if(LG(this))return _;for(var S=0;S<f;S++)if(s[S]===y)return _}}},sAe=Bn,oAe=String,lh=FG("JSON","stringify"),Cx=Q_(/./.exec),HG=Q_("".charAt),cAe=Q_("".charCodeAt),lAe=Q_("".replace),uAe=Q_(1 .toString),dAe=/[\uD800-\uDFFF]/g,zG=/^[\uD800-\uDBFF]$/,KG=/^[\uDC00-\uDFFF]$/,qG=!sAe||BG(function(){var r=FG("Symbol")("stringify detection");return lh([r])!=="[null]"||lh({a:r})!=="{}"||lh(Object(r))!=="{}"}),YG=BG(function(){return lh("\uDF06\uD834")!=='"\\udf06\\ud834"'||lh("\uDEAD")!=='"\\udead"'}),hAe=function(r,a){var s=GG(arguments),l=aAe(a);if($G(l)||r!==void 0&&!WG(r))return s[1]=function(d,f){if($G(l)&&(f=iAe(l,this,oAe(d),f)),!WG(f))return f},VG(lh,null,s)},fAe=function(r,a,s){var l=HG(s,a-1),d=HG(s,a+1);return Cx(zG,r)&&!Cx(KG,d)||Cx(KG,r)&&!Cx(zG,l)?"\\u"+uAe(cAe(r,0),16):r};lh&&rAe({target:"JSON",stat:!0,forced:qG||YG},{stringify:function(r,a,s){var l=GG(arguments),d=VG(qG?hAe:lh,null,l);return YG&&typeof d=="string"?lAe(d,dAe,fAe):d}});var XG=I_,pAe=ql;Tn({target:"Object",stat:!0,forced:!Bn||u(function(){XG.f(1)})},{getOwnPropertySymbols:function(r){var a=XG.f;return a?a(pAe(r)):[]}}),Si("asyncIterator"),Si("hasInstance"),Si("isConcatSpreadable"),Si("iterator"),Si("match"),Si("matchAll"),Si("replace"),Si("search"),Si("species"),Si("split");var mAe=hG;Si("toPrimitive"),mAe();var gAe=ot,vAe=Zu;Si("toStringTag"),vAe(gAe("Symbol"),"Symbol"),Si("unscopables"),Zu(R.JSON,"JSON",!0);var yAe=Le.Symbol,_Ae=qr,bAe=tc.f,JG=_Ae("metadata"),ZG=Function.prototype;ZG[JG]===void 0&&bAe(ZG,JG,{value:null}),Si("asyncDispose"),Si("dispose"),Si("metadata");var EAe=yAe,wAe=E,Vk=ot("Symbol"),SAe=Vk.keyFor,xAe=wAe(Vk.prototype.valueOf),QG=Vk.isRegisteredSymbol||function(r){try{return SAe(xAe(r))!==void 0}catch{return!1}};Tn({target:"Symbol",stat:!0},{isRegisteredSymbol:QG});for(var TAe=Um,eH=ot,CAe=E,RAe=Wf,NAe=qr,Rx=eH("Symbol"),tH=Rx.isWellKnownSymbol,nH=eH("Object","getOwnPropertyNames"),AAe=CAe(Rx.prototype.valueOf),rH=TAe("wks"),Bk=0,iH=nH(Rx),IAe=iH.length;Bk<IAe;Bk++)try{var aH=iH[Bk];RAe(Rx[aH])&&NAe(aH)}catch{}var sH=function(r){if(tH&&tH(r))return!0;try{for(var a=AAe(r),s=0,l=nH(rH),d=l.length;s<d;s++)if(rH[l[s]]==a)return!0}catch{}return!1};Tn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:sH}),Si("customMatcher"),Si("observable"),Tn({target:"Symbol",stat:!0},{isRegistered:QG}),Tn({target:"Symbol",stat:!0,forced:!0},{isWellKnown:sH}),Si("matcher"),Si("metadataKey"),Si("patternMatch"),Si("replaceAll");var hg=o(EAe),oH=o(cg.f("iterator"));function eb(r){return eb=typeof hg=="function"&&typeof oH=="symbol"?function(a){return typeof a}:function(a){return a&&typeof hg=="function"&&a.constructor===hg&&a!==hg.prototype?"symbol":typeof a},eb(r)}var OAe=o(cg.f("toPrimitive"));function PAe(r){var a=function(s,l){if(eb(s)!="object"||!s)return s;var d=s[OAe];if(d!==void 0){var f=d.call(s,l);if(eb(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return eb(a)=="symbol"?a:a+""}function Q(r,a,s){return(a=PAe(a))in r?eG(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}var cH=o(PTe),kAe={isBrowser:!0,classes:{URLSearchParams:cH!==void 0?cH:Nk,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const $k=typeof window<"u"&&typeof document<"u",Wk=typeof navigator=="object"&&navigator||void 0,jAe=$k&&(!Wk||["ReactNative","NativeScript","NS"].indexOf(Wk.product)<0),DAe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",LAe=$k&&window.location.href||"http://localhost";function lH(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function uH(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?lH(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):lH(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}var as=uH(uH({},Object.freeze({__proto__:null,hasBrowserEnv:$k,hasStandardBrowserEnv:jAe,hasStandardBrowserWebWorkerEnv:DAe,navigator:Wk,origin:LAe})),kAe),MAe=Ts,UAe=J,FAe=aa,VAe=T,BAe=function(){var r=MAe(this),a="";return r.hasIndices&&(a+="d"),r.global&&(a+="g"),r.ignoreCase&&(a+="i"),r.multiline&&(a+="m"),r.dotAll&&(a+="s"),r.unicode&&(a+="u"),r.unicodeSets&&(a+="v"),r.sticky&&(a+="y"),a},dH=RegExp.prototype,hH=function(r){var a=r.flags;return a!==void 0||"flags"in dH||FAe(r,"flags")||!VAe(dH,r)?a:UAe(BAe,r)},$Ae=IP.charAt,fH=J,WAe=Ts,GAe=z,HAe=F,zAe=/./.exec,KAe=TypeError,qAe=Tn,pH=J,mH=q,YAe=JO,Nx=DS,gH=Pt,vH=g5,tb=Hs,XAe=Ts,JAe=Rt,ZAe=F,QAe=y5,yH=hH,e1e=Eo,t1e=u,n1e=rP,r1e=function(r,a,s){return a+(s?$Ae(r,a).length:1)},i1e=function(r,a){var s=r.exec;if(GAe(s)){var l=fH(s,r,a);return l!==null&&WAe(l),l}if(HAe(r)==="RegExp")return fH(zAe,r,a);throw new KAe("RegExp#exec called on incompatible receiver")},_H=zf,a1e=qr("matchAll"),bH="RegExp String",EH=bH+" Iterator",s1e=_H.set,o1e=_H.getterFor(EH),c1e=TypeError,Gk=mH("".indexOf),Ax=mH("".matchAll),Hk=!!Ax&&!t1e(function(){Ax("a",/./)}),l1e=YAe(function(r,a,s,l){s1e(this,{type:EH,regexp:r,string:a,global:s,unicode:l,done:!1})},bH,function(){var r=o1e(this);if(r.done)return Nx(void 0,!0);var a=r.regexp,s=r.string,l=i1e(a,s);return l===null?(r.done=!0,Nx(void 0,!0)):r.global?(tb(l[0])===""&&(a.lastIndex=r1e(s,vH(a.lastIndex),r.unicode)),Nx(l,!1)):(r.done=!0,Nx(l,!1))}),wH=function(r){var a,s,l,d=XAe(this),f=tb(r),m=n1e(d,RegExp),y=tb(yH(d));return a=new m(m===RegExp?d.source:d,y),s=!!~Gk(y,"g"),l=!!~Gk(y,"u"),a.lastIndex=vH(d.lastIndex),new l1e(a,f,s,l)};qAe({target:"String",proto:!0,forced:Hk},{matchAll:function(r){var a,s,l,d,f=gH(this);if(JAe(r)){if(QAe(r)&&(a=tb(gH(yH(r))),!~Gk(a,"g")))throw new c1e("`.matchAll` does not allow non-global regexes");if(Hk)return Ax(f,r);if((l=e1e(r,a1e))===void 0&&ZAe(r)==="RegExp"&&(l=wH),l)return pH(l,r,f)}else if(Hk)return Ax(f,r);return s=tb(f),d=new RegExp(r,"g"),pH(wH,d,s)}});var u1e=nc("String","matchAll"),d1e=T,h1e=u1e,zk=String.prototype,f1e=function(r){var a=r.matchAll;return typeof r=="string"||r===zk||d1e(zk,r)&&a===zk.matchAll?h1e:a},p1e=o(f1e);function SH(r){function a(s,l,d,f){let m=s[f++];if(m==="__proto__")return!0;const y=Number.isFinite(+m),_=f>=s.length;return m=!m&&Ge.isArray(d)?d.length:m,_?(Ge.hasOwnProp(d,m)?d[m]=[d[m],l]:d[m]=l,!y):(d[m]&&Ge.isObject(d[m])||(d[m]=[]),a(s,l,d[m],f)&&Ge.isArray(d[m])&&(d[m]=function(S){const x={},A=Object.keys(S);let I;const L=A.length;let K;for(I=0;I<L;I++)K=A[I],x[K]=S[K];return x}(d[m])),!y)}if(Ge.isFormData(r)&&Ge.isFunction(r.entries)){const s={};return Ge.forEachEntry(r,(l,d)=>{a(function(f){return p1e(Ge).call(Ge,/\w+|\[(\w*)]/g,f).map(m=>m[0]==="[]"?"":m[1]||m[0])}(l),d,s,0)}),s}return null}const Kk={transitional:XW,adapter:["xhr","http","fetch"],transformRequest:[function(r,a){const s=a.getContentType()||"",l=s.indexOf("application/json")>-1,d=Ge.isObject(r);if(d&&Ge.isHTMLForm(r)&&(r=new FormData(r)),Ge.isFormData(r))return l?JSON.stringify(SH(r)):r;if(Ge.isArrayBuffer(r)||Ge.isBuffer(r)||Ge.isStream(r)||Ge.isFile(r)||Ge.isBlob(r)||Ge.isReadableStream(r))return r;if(Ge.isArrayBufferView(r))return r.buffer;if(Ge.isURLSearchParams(r))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let f;if(d){if(s.indexOf("application/x-www-form-urlencoded")>-1)return function(m,y){return _x(m,new as.classes.URLSearchParams,Object.assign({visitor:function(_,S,x,A){return as.isNode&&Ge.isBuffer(_)?(this.append(S,_.toString("base64")),!1):A.defaultVisitor.apply(this,arguments)}},y))}(r,this.formSerializer).toString();if((f=Ge.isFileList(r))||s.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return _x(f?{"files[]":r}:r,m&&new m,this.formSerializer)}}return d||l?(a.setContentType("application/json",!1),function(m,y,_){if(Ge.isString(m))try{return(y||JSON.parse)(m),Ea(Ge).call(Ge,m)}catch(S){if(S.name!=="SyntaxError")throw S}return(_||JSON.stringify)(m)}(r)):r}],transformResponse:[function(r){const a=this.transitional||Kk.transitional,s=a&&a.forcedJSONParsing,l=this.responseType==="json";if(Ge.isResponse(r)||Ge.isReadableStream(r))return r;if(r&&Ge.isString(r)&&(s&&!this.responseType||l)){const d=!(a&&a.silentJSONParsing)&&l;try{return JSON.parse(r)}catch(f){if(d)throw f.name==="SyntaxError"?Pn.from(f,Pn.ERR_BAD_RESPONSE,this,null,this.response):f}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:as.classes.FormData,Blob:as.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ge.forEach(["delete","get","head","post","put","patch"],r=>{Kk.headers[r]={}});var qk=Kk;const m1e=Ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xH=Symbol("internals");function nb(r){var a;return r&&Ea(a=String(r)).call(a).toLowerCase()}function Ix(r){return r===!1||r==null?r:Ge.isArray(r)?r.map(Ix):String(r)}function Yk(r,a,s,l,d){return Ge.isFunction(l)?l.call(this,a,s):(d&&(a=s),Ge.isString(a)?Ge.isString(l)?a.indexOf(l)!==-1:Ge.isRegExp(l)?l.test(a):void 0:void 0)}class Ox{constructor(a){a&&this.set(a)}set(a,s,l){const d=this;function f(_,S,x){const A=nb(S);if(!A)throw new Error("header name must be a non-empty string");const I=Ge.findKey(d,A);(!I||d[I]===void 0||x===!0||x===void 0&&d[I]!==!1)&&(d[I||S]=Ix(_))}const m=(_,S)=>Ge.forEach(_,(x,A)=>f(x,A,S));if(Ge.isPlainObject(a)||a instanceof this.constructor)m(a,s);else if(Ge.isString(a)&&(a=Ea(a).call(a))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Ea(y=a).call(y)))m((_=>{const S={};let x,A,I;return _&&_.split(`
`).forEach(function(L){var K,$;I=L.indexOf(":"),x=Ea(K=L.substring(0,I)).call(K).toLowerCase(),A=Ea($=L.substring(I+1)).call($),!x||S[x]&&m1e[x]||(x==="set-cookie"?S[x]?S[x].push(A):S[x]=[A]:S[x]=S[x]?S[x]+", "+A:A)}),S})(a),s);else if(Ge.isObject(a)&&Ge.isIterable(a)){let _,S,x={};for(const A of a){if(!Ge.isArray(A))throw TypeError("Object iterator must return a key-value pair");x[S=A[0]]=(_=x[S])?Ge.isArray(_)?[..._,A[1]]:[_,A[1]]:A[1]}m(x,s)}else a!=null&&f(s,a,l);var y;return this}get(a,s){if(a=nb(a)){const l=Ge.findKey(this,a);if(l){const d=this[l];if(!s)return d;if(s===!0)return function(f){const m=Object.create(null),y=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _;for(;_=y.exec(f);)m[_[1]]=_[2];return m}(d);if(Ge.isFunction(s))return s.call(this,d,l);if(Ge.isRegExp(s))return s.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,s){if(a=nb(a)){const l=Ge.findKey(this,a);return!(!l||this[l]===void 0||s&&!Yk(0,this[l],l,s))}return!1}delete(a,s){const l=this;let d=!1;function f(m){if(m=nb(m)){const y=Ge.findKey(l,m);!y||s&&!Yk(0,l[y],y,s)||(delete l[y],d=!0)}}return Ge.isArray(a)?a.forEach(f):f(a),d}clear(a){const s=Object.keys(this);let l=s.length,d=!1;for(;l--;){const f=s[l];a&&!Yk(0,this[f],f,a,!0)||(delete this[f],d=!0)}return d}normalize(a){const s=this,l={};return Ge.forEach(this,(d,f)=>{var m;const y=Ge.findKey(l,f);if(y)return s[y]=Ix(d),void delete s[f];const _=a?function(S){return Ea(S).call(S).toLowerCase().replace(/([a-z\d])(\w*)/g,(x,A,I)=>A.toUpperCase()+I)}(f):Ea(m=String(f)).call(m);_!==f&&delete s[f],s[_]=Ix(d),l[_]=!0}),this}concat(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return this.constructor.concat(this,...s)}toJSON(a){const s=Object.create(null);return Ge.forEach(this,(l,d)=>{l!=null&&l!==!1&&(s[d]=a&&Ge.isArray(l)?l.join(", "):l)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(a=>{let[s,l]=a;return s+": "+l}).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a){const s=new this(a);for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];return d.forEach(m=>s.set(m)),s}static accessor(a){const s=(this[xH]=this[xH]={accessors:{}}).accessors,l=this.prototype;function d(f){const m=nb(f);s[m]||(function(y,_){const S=Ge.toCamelCase(" "+_);["get","set","has"].forEach(x=>{Object.defineProperty(y,x+S,{value:function(A,I,L){return this[x].call(this,_,A,I,L)},configurable:!0})})}(l,f),s[m]=!0)}return Ge.isArray(a)?a.forEach(d):d(a),this}}Ox.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ge.reduceDescriptors(Ox.prototype,(r,a)=>{let{value:s}=r,l=a[0].toUpperCase()+a.slice(1);return{get:()=>s,set(d){this[l]=d}}}),Ge.freezeMethods(Ox);var Zc=Ox;function Xk(r,a){const s=this||qk,l=a||s,d=Zc.from(l.headers);let f=l.data;return Ge.forEach(r,function(m){f=m.call(s,f,d.normalize(),a?a.status:void 0)}),d.normalize(),f}function TH(r){return!(!r||!r.__CANCEL__)}function fg(r,a,s){Pn.call(this,r??"canceled",Pn.ERR_CANCELED,a,s),this.name="CanceledError"}function CH(r,a,s){const l=s.config.validateStatus;s.status&&l&&!l(s.status)?a(new Pn("Request failed with status code "+s.status,[Pn.ERR_BAD_REQUEST,Pn.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):r(s)}Ge.inherits(fg,Pn,{__CANCEL__:!0});const Px=function(r,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,l=0;const d=function(f,m){f=f||10;const y=new Array(f),_=new Array(f);let S,x=0,A=0;return m=m!==void 0?m:1e3,function(I){const L=Date.now(),K=_[A];S||(S=L),y[x]=I,_[x]=L;let $=A,G=0;for(;$!==x;)G+=y[$++],$%=f;if(x=(x+1)%f,x===A&&(A=(A+1)%f),L-S<m)return;const ne=K&&L-K;return ne?Math.round(1e3*G/ne):void 0}}(50,250);return function(f,m){let y,_,S=0,x=1e3/m;const A=function(I){S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),y=null,_&&(clearTimeout(_),_=null),f.apply(null,I)};return[function(){const I=Date.now(),L=I-S;for(var K=arguments.length,$=new Array(K),G=0;G<K;G++)$[G]=arguments[G];L>=x?A($,I):(y=$,_||(_=setTimeout(()=>{_=null,A(y)},x-L)))},()=>y&&A(y)]}(f=>{const m=f.loaded,y=f.lengthComputable?f.total:void 0,_=m-l,S=d(_);l=m,r({loaded:m,total:y,progress:y?m/y:void 0,bytes:_,rate:S||void 0,estimated:S&&y&&m<=y?(y-m)/S:void 0,event:f,lengthComputable:y!=null,[a?"download":"upload"]:!0})},s)},RH=(r,a)=>{const s=r!=null;return[l=>a[0]({lengthComputable:s,total:r,loaded:l}),a[1]]},NH=r=>function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return Ge.asap(()=>r(...s))};var g1e=as.hasStandardBrowserEnv?((r,a)=>s=>(s=new sx(s,as.origin),r.protocol===s.protocol&&r.host===s.host&&(a||r.port===s.port)))(new sx(as.origin),as.navigator&&/(msie|trident)/i.test(as.navigator.userAgent)):()=>!0,v1e=as.hasStandardBrowserEnv?{write(r,a,s,l,d,f){const m=[r+"="+encodeURIComponent(a)];Ge.isNumber(s)&&m.push("expires="+new Date(s).toGMTString()),Ge.isString(l)&&m.push("path="+l),Ge.isString(d)&&m.push("domain="+d),f===!0&&m.push("secure"),document.cookie=m.join("; ")},read(r){const a=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function AH(r,a,s){let l=!function(d){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(d)}(a);return r&&(l||s==0)?function(d,f){return f?d.replace(/\/?\/$/,"")+"/"+f.replace(/^\/+/,""):d}(r,a):a}function IH(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}const OH=r=>r instanceof Zc?function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?IH(Object(l),!0).forEach(function(d){Q(a,d,l[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(l)):IH(Object(l)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(l,d))})}return a}({},r):r;function rp(r,a){a=a||{};const s={};function l(S,x,A,I){return Ge.isPlainObject(S)&&Ge.isPlainObject(x)?Ge.merge.call({caseless:I},S,x):Ge.isPlainObject(x)?Ge.merge({},x):Ge.isArray(x)?x.slice():x}function d(S,x,A,I){return Ge.isUndefined(x)?Ge.isUndefined(S)?void 0:l(void 0,S,0,I):l(S,x,0,I)}function f(S,x){if(!Ge.isUndefined(x))return l(void 0,x)}function m(S,x){return Ge.isUndefined(x)?Ge.isUndefined(S)?void 0:l(void 0,S):l(void 0,x)}function y(S,x,A){return A in a?l(S,x):A in r?l(void 0,S):void 0}const _={url:f,method:f,data:f,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:y,headers:(S,x,A)=>d(OH(S),OH(x),0,!0)};return Ge.forEach(Object.keys(Object.assign({},r,a)),function(S){const x=_[S]||d,A=x(r[S],a[S],S);Ge.isUndefined(A)&&x!==y||(s[S]=A)}),s}var PH=r=>{const a=rp({},r);let s,{data:l,withXSRFToken:d,xsrfHeaderName:f,xsrfCookieName:m,headers:y,auth:_}=a;if(a.headers=y=Zc.from(y),a.url=qW(AH(a.baseURL,a.url,a.allowAbsoluteUrls),r.params,r.paramsSerializer),_&&y.set("Authorization","Basic "+btoa((_.username||"")+":"+(_.password?unescape(encodeURIComponent(_.password)):""))),Ge.isFormData(l)){if(as.hasStandardBrowserEnv||as.hasStandardBrowserWebWorkerEnv)y.setContentType(void 0);else if((s=y.getContentType())!==!1){const[S,...x]=s?s.split(";").map(A=>Ea(A).call(A)).filter(Boolean):[];y.setContentType([S||"multipart/form-data",...x].join("; "))}}if(as.hasStandardBrowserEnv&&(d&&Ge.isFunction(d)&&(d=d(a)),d||d!==!1&&g1e(a.url))){const S=f&&m&&v1e.read(m);S&&y.set(f,S)}return a},y1e=typeof XMLHttpRequest<"u"&&function(r){return new He(function(a,s){const l=PH(r);let d=l.data;const f=Zc.from(l.headers).normalize();let m,y,_,S,x,{responseType:A,onUploadProgress:I,onDownloadProgress:L}=l;function K(){S&&S(),x&&x(),l.cancelToken&&l.cancelToken.unsubscribe(m),l.signal&&l.signal.removeEventListener("abort",m)}let $=new XMLHttpRequest;function G(){if(!$)return;const te=Zc.from("getAllResponseHeaders"in $&&$.getAllResponseHeaders());CH(function(ce){a(ce),K()},function(ce){s(ce),K()},{data:A&&A!=="text"&&A!=="json"?$.response:$.responseText,status:$.status,statusText:$.statusText,headers:te,config:r,request:$}),$=null}$.open(l.method.toUpperCase(),l.url,!0),$.timeout=l.timeout,"onloadend"in $?$.onloadend=G:$.onreadystatechange=function(){$&&$.readyState===4&&($.status!==0||$.responseURL&&$.responseURL.indexOf("file:")===0)&&setTimeout(G)},$.onabort=function(){$&&(s(new Pn("Request aborted",Pn.ECONNABORTED,r,$)),$=null)},$.onerror=function(){s(new Pn("Network Error",Pn.ERR_NETWORK,r,$)),$=null},$.ontimeout=function(){let te=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const ce=l.transitional||XW;l.timeoutErrorMessage&&(te=l.timeoutErrorMessage),s(new Pn(te,ce.clarifyTimeoutError?Pn.ETIMEDOUT:Pn.ECONNABORTED,r,$)),$=null},d===void 0&&f.setContentType(null),"setRequestHeader"in $&&Ge.forEach(f.toJSON(),function(te,ce){$.setRequestHeader(ce,te)}),Ge.isUndefined(l.withCredentials)||($.withCredentials=!!l.withCredentials),A&&A!=="json"&&($.responseType=l.responseType),L&&([_,x]=Px(L,!0),$.addEventListener("progress",_)),I&&$.upload&&([y,S]=Px(I),$.upload.addEventListener("progress",y),$.upload.addEventListener("loadend",S)),(l.cancelToken||l.signal)&&(m=te=>{$&&(s(!te||te.type?new fg(null,r,$):te),$.abort(),$=null)},l.cancelToken&&l.cancelToken.subscribe(m),l.signal&&(l.signal.aborted?m():l.signal.addEventListener("abort",m)));const ne=function(te){const ce=/^([-+\w]{1,25})(:?\/\/|:)/.exec(te);return ce&&ce[1]||""}(l.url);ne&&as.protocols.indexOf(ne)===-1?s(new Pn("Unsupported protocol "+ne+":",Pn.ERR_BAD_REQUEST,r)):$.send(d||null)})},_1e=(r,a)=>{const{length:s}=r=r?r.filter(Boolean):[];if(a||s){let l,d=new AbortController;const f=function(S){if(!l){l=!0,y();const x=S instanceof Error?S:this.reason;d.abort(x instanceof Pn?x:new fg(x instanceof Error?x.message:x))}};let m=a&&setTimeout(()=>{m=null,f(new Pn("timeout ".concat(a," of ms exceeded"),Pn.ETIMEDOUT))},a);const y=()=>{r&&(m&&clearTimeout(m),m=null,r.forEach(S=>{S.unsubscribe?S.unsubscribe(f):S.removeEventListener("abort",f)}),r=null)};r.forEach(S=>S.addEventListener("abort",f));const{signal:_}=d;return _.unsubscribe=()=>Ge.asap(y),_}},Jk=o(_6),kH=cg.f("asyncIterator"),b1e=o(kH);function Zk(r,a){this.v=r,this.k=a}function So(r){return function(){return new rb(r.apply(this,arguments))}}function rb(r){var a,s;function l(f,m){try{var y=r[f](m),_=y.value,S=_ instanceof Zk;Jk.resolve(S?_.v:_).then(function(x){if(S){var A=f==="return"?"return":"next";if(!_.k||x.done)return l(A,x);x=r[A](x).value}d(y.done?"return":"normal",x)},function(x){l("throw",x)})}catch(x){d("throw",x)}}function d(f,m){switch(f){case"return":a.resolve({value:m,done:!0});break;case"throw":a.reject(m);break;default:a.resolve({value:m,done:!1})}(a=a.next)?l(a.key,a.arg):s=null}this._invoke=function(f,m){return new Jk(function(y,_){var S={key:f,arg:m,resolve:y,reject:_,next:null};s?s=s.next=S:(a=s=S,l(f,m))})},typeof r.return!="function"&&(this.return=void 0)}function ln(r){return new Zk(r,0)}function kx(r){var a={},s=!1;function l(d,f){return s=!0,f=new Jk(function(m){m(r[d](f))}),{done:!1,value:new Zk(f,1)}}return a[hg!==void 0&&oH||"@@iterator"]=function(){return this},a.next=function(d){return s?(s=!1,d):l("next",d)},typeof r.throw=="function"&&(a.throw=function(d){if(s)throw s=!1,d;return l("throw",d)}),typeof r.return=="function"&&(a.return=function(d){return s?(s=!1,d):l("return",d)}),a}rb.prototype[typeof hg=="function"&&b1e||"@@asyncIterator"]=function(){return this},rb.prototype.next=function(r){return this._invoke("next",r)},rb.prototype.throw=function(r){return this._invoke("throw",r)},rb.prototype.return=function(r){return this._invoke("return",r)};var Qk=o(kH);function ej(r){var a,s,l,d=2;for(typeof Symbol<"u"&&(s=Qk,l=Symbol.iterator);d--;){if(s&&(a=r[s])!=null)return a.call(r);if(l&&(a=r[l])!=null)return new jx(a.call(r));s="@@asyncIterator",l="@@iterator"}throw new TypeError("Object is not async iterable")}function jx(r){function a(s){if(Object(s)!==s)return He.reject(new TypeError(s+" is not an object."));var l=s.done;return He.resolve(s.value).then(function(d){return{value:d,done:l}})}return jx=function(s){this.s=s,this.n=s.next},jx.prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(s){var l=this.s.return;return l===void 0?He.resolve({value:s,done:!0}):a(l.apply(this.s,arguments))},throw:function(s){var l=this.s.return;return l===void 0?He.reject(s):a(l.apply(this.s,arguments))}},new jx(r)}const E1e=function*(r,a){let s=r.byteLength;if(!a||s<a)return void(yield r);let l,d=0;for(;d<s;)l=d+a,yield r.slice(d,l),d=l},w1e=function(){var r=So(function*(a,s){var l,d=!1,f=!1;try{for(var m,y=ej(S1e(a));d=!(m=yield ln(y.next())).done;d=!1){const _=m.value;yield*kx(ej(E1e(_,s)))}}catch(_){f=!0,l=_}finally{try{d&&y.return!=null&&(yield ln(y.return()))}finally{if(f)throw l}}});return function(a,s){return r.apply(this,arguments)}}(),S1e=function(){var r=So(function*(a){if(a[Qk])return void(yield*kx(ej(a)));const s=a.getReader();try{for(;;){const{done:l,value:d}=yield ln(s.read());if(l)break;yield d}}finally{yield ln(s.cancel())}});return function(a){return r.apply(this,arguments)}}(),jH=(r,a,s,l)=>{const d=w1e(r,a);let f,m=0,y=_=>{f||(f=!0,l&&l(_))};return new ReadableStream({async pull(_){try{const{done:S,value:x}=await d.next();if(S)return y(),void _.close();let A=x.byteLength;if(s){let I=m+=A;s(I)}_.enqueue(new Uint8Array(x))}catch(S){throw y(S),S}},cancel:_=>(y(_),d.return())},{highWaterMark:2})};function DH(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function LH(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?DH(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):DH(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const Dx=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",MH=Dx&&typeof ReadableStream=="function",x1e=Dx&&(typeof TextEncoder=="function"?(UH=new TextEncoder,r=>UH.encode(r)):async r=>new Uint8Array(await new Response(r).arrayBuffer()));var UH;const FH=function(r){try{for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return!!r(...s)}catch{return!1}},T1e=MH&&FH(()=>{let r=!1;const a=new Request(as.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!a}),tj=MH&&FH(()=>Ge.isReadableStream(new Response("").body)),Lx={stream:tj&&(r=>r.body)};var VH;Dx&&(VH=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(r=>{!Lx[r]&&(Lx[r]=Ge.isFunction(VH[r])?a=>a[r]():(a,s)=>{throw new Pn("Response type '".concat(r,"' is not supported"),Pn.ERR_NOT_SUPPORT,s)})}));const C1e=async(r,a)=>{const s=Ge.toFiniteNumber(r.getContentLength());return s??(async l=>l==null?0:Ge.isBlob(l)?l.size:Ge.isSpecCompliantForm(l)?(await new Request(as.origin,{method:"POST",body:l}).arrayBuffer()).byteLength:Ge.isArrayBufferView(l)||Ge.isArrayBuffer(l)?l.byteLength:(Ge.isURLSearchParams(l)&&(l+=""),Ge.isString(l)?(await x1e(l)).byteLength:void 0))(a)};var R1e=Dx&&(async r=>{let{url:a,method:s,data:l,signal:d,cancelToken:f,timeout:m,onDownloadProgress:y,onUploadProgress:_,responseType:S,headers:x,withCredentials:A="same-origin",fetchOptions:I}=PH(r);S=S?(S+"").toLowerCase():"text";let L,K=_1e([d,f&&f.toAbortSignal()],m);const $=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let G;try{if(_&&T1e&&s!=="get"&&s!=="head"&&(G=await C1e(x,l))!==0){let fe,ue=new Request(a,{method:"POST",body:l,duplex:"half"});if(Ge.isFormData(l)&&(fe=ue.headers.get("content-type"))&&x.setContentType(fe),ue.body){const[ye,Se]=RH(G,Px(NH(_)));l=jH(ue.body,65536,ye,Se)}}Ge.isString(A)||(A=A?"include":"omit");const ne="credentials"in Request.prototype;L=new Request(a,LH(LH({},I),{},{signal:K,method:s.toUpperCase(),headers:x.normalize().toJSON(),body:l,duplex:"half",credentials:ne?A:void 0}));let te=await fetch(L);const ce=tj&&(S==="stream"||S==="response");if(tj&&(y||ce&&$)){const fe={};["status","statusText","headers"].forEach(Ie=>{fe[Ie]=te[Ie]});const ue=Ge.toFiniteNumber(te.headers.get("content-length")),[ye,Se]=y&&RH(ue,Px(NH(y),!0))||[];te=new Response(jH(te.body,65536,ye,()=>{Se&&Se(),$&&$()}),fe)}S=S||"text";let pe=await Lx[Ge.findKey(Lx,S)||"text"](te,r);return!ce&&$&&$(),await new He((fe,ue)=>{CH(fe,ue,{data:pe,headers:Zc.from(te.headers),status:te.status,statusText:te.statusText,config:r,request:L})})}catch(ne){throw $&&$(),ne&&ne.name==="TypeError"&&/Load failed|fetch/i.test(ne.message)?Object.assign(new Pn("Network Error",Pn.ERR_NETWORK,r,L),{cause:ne.cause||ne}):Pn.from(ne,ne&&ne.code,r,L)}});const nj={http:null,xhr:y1e,fetch:R1e};Ge.forEach(nj,(r,a)=>{if(r){try{Object.defineProperty(r,"name",{value:a})}catch{}Object.defineProperty(r,"adapterName",{value:a})}});const BH=r=>"- ".concat(r),N1e=r=>Ge.isFunction(r)||r===null||r===!1;var $H={getAdapter:r=>{r=Ge.isArray(r)?r:[r];const{length:a}=r;let s,l;const d={};for(let f=0;f<a;f++){let m;if(s=r[f],l=s,!N1e(s)&&(l=nj[(m=String(s)).toLowerCase()],l===void 0))throw new Pn("Unknown adapter '".concat(m,"'"));if(l)break;d[m||"#"+f]=l}if(!l){const f=Object.entries(d).map(m=>{let[y,_]=m;return"adapter ".concat(y," ")+(_===!1?"is not supported by the environment":"is not available in the build")});throw new Pn("There is no suitable adapter to dispatch the request "+(a?f.length>1?`since :
`+f.map(BH).join(`
`):" "+BH(f[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return l},adapters:nj};function rj(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new fg(null,r)}function WH(r){return rj(r),r.headers=Zc.from(r.headers),r.data=Xk.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),$H.getAdapter(r.adapter||qk.adapter)(r).then(function(a){return rj(r),a.data=Xk.call(r,r.transformResponse,a),a.headers=Zc.from(a.headers),a},function(a){return TH(a)||(rj(r),a&&a.response&&(a.response.data=Xk.call(r,r.transformResponse,a.response),a.response.headers=Zc.from(a.response.headers))),He.reject(a)})}const GH="1.9.0",Mx={};["object","boolean","number","function","string","symbol"].forEach((r,a)=>{Mx[r]=function(s){return typeof s===r||"a"+(a<1?"n ":" ")+r}});const HH={};Mx.transitional=function(r,a,s){function l(d,f){return"[Axios v"+GH+"] Transitional option '"+d+"'"+f+(s?". "+s:"")}return(d,f,m)=>{if(r===!1)throw new Pn(l(f," has been removed"+(a?" in "+a:"")),Pn.ERR_DEPRECATED);return a&&!HH[f]&&(HH[f]=!0,console.warn(l(f," has been deprecated since v"+a+" and will be removed in the near future"))),!r||r(d,f,m)}},Mx.spelling=function(r){return(a,s)=>(console.warn("".concat(s," is likely a misspelling of ").concat(r)),!0)};var Ux={assertOptions:function(r,a,s){if(typeof r!="object")throw new Pn("options must be an object",Pn.ERR_BAD_OPTION_VALUE);const l=Object.keys(r);let d=l.length;for(;d-- >0;){const f=l[d],m=a[f];if(m){const y=r[f],_=y===void 0||m(y,f,r);if(_!==!0)throw new Pn("option "+f+" must be "+_,Pn.ERR_BAD_OPTION_VALUE)}else if(s!==!0)throw new Pn("Unknown option "+f,Pn.ERR_BAD_OPTION)}},validators:Mx};const Zl=Ux.validators;let Fx=class{constructor(r){this.defaults=r||{},this.interceptors={request:new YW,response:new YW}}async request(r,a){try{return await this._request(r,a)}catch(s){if(s instanceof Error){let l={};Error.captureStackTrace?Error.captureStackTrace(l):l=new Error;const d=l.stack?l.stack.replace(/^.+\n/,""):"";try{s.stack?d&&!String(s.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+d):s.stack=d}catch{}}throw s}}_request(r,a){typeof r=="string"?(a=a||{}).url=r:a=r||{},a=rp(this.defaults,a);const{transitional:s,paramsSerializer:l,headers:d}=a;s!==void 0&&Ux.assertOptions(s,{silentJSONParsing:Zl.transitional(Zl.boolean),forcedJSONParsing:Zl.transitional(Zl.boolean),clarifyTimeoutError:Zl.transitional(Zl.boolean)},!1),l!=null&&(Ge.isFunction(l)?a.paramsSerializer={serialize:l}:Ux.assertOptions(l,{encode:Zl.function,serialize:Zl.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),Ux.assertOptions(a,{baseUrl:Zl.spelling("baseURL"),withXsrfToken:Zl.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let f=d&&Ge.merge(d.common,d[a.method]);d&&Ge.forEach(["delete","get","head","post","put","patch","common"],L=>{delete d[L]}),a.headers=Zc.concat(f,d);const m=[];let y=!0;this.interceptors.request.forEach(function(L){typeof L.runWhen=="function"&&L.runWhen(a)===!1||(y=y&&L.synchronous,m.unshift(L.fulfilled,L.rejected))});const _=[];let S;this.interceptors.response.forEach(function(L){_.push(L.fulfilled,L.rejected)});let x,A=0;if(!y){const L=[WH.bind(this),void 0];for(L.unshift.apply(L,m),L.push.apply(L,_),x=L.length,S=He.resolve(a);A<x;)S=S.then(L[A++],L[A++]);return S}x=m.length;let I=a;for(A=0;A<x;){const L=m[A++],K=m[A++];try{I=L(I)}catch($){K.call(this,$);break}}try{S=WH.call(this,I)}catch(L){return He.reject(L)}for(A=0,x=_.length;A<x;)S=S.then(_[A++],_[A++]);return S}getUri(r){return qW(AH((r=rp(this.defaults,r)).baseURL,r.url,r.allowAbsoluteUrls),r.params,r.paramsSerializer)}};Ge.forEach(["delete","get","head","options"],function(r){Fx.prototype[r]=function(a,s){return this.request(rp(s||{},{method:r,url:a,data:(s||{}).data}))}}),Ge.forEach(["post","put","patch"],function(r){function a(s){return function(l,d,f){return this.request(rp(f||{},{method:r,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:d}))}}Fx.prototype[r]=a(),Fx.prototype[r+"Form"]=a(!0)});var Vx=Fx;class ij{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let s;this.promise=new He(function(d){s=d});const l=this;this.promise.then(d=>{if(!l._listeners)return;let f=l._listeners.length;for(;f-- >0;)l._listeners[f](d);l._listeners=null}),this.promise.then=d=>{let f;const m=new He(y=>{l.subscribe(y),f=y}).then(d);return m.cancel=function(){l.unsubscribe(f)},m},a(function(d,f,m){l.reason||(l.reason=new fg(d,f,m),s(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){this.reason?a(this.reason):this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const s=this._listeners.indexOf(a);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const a=new AbortController,s=l=>{a.abort(l)};return this.subscribe(s),a.signal.unsubscribe=()=>this.unsubscribe(s),a.signal}static source(){let a;return{token:new ij(function(l){a=l}),cancel:a}}}var A1e=ij;const aj={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(aj).forEach(r=>{let[a,s]=r;aj[s]=a});var I1e=aj;const sa=function r(a){const s=new Vx(a),l=OW(Vx.prototype.request,s);return Ge.extend(l,Vx.prototype,s,{allOwnKeys:!0}),Ge.extend(l,s,null,{allOwnKeys:!0}),l.create=function(d){return r(rp(a,d))},l}(qk);sa.Axios=Vx,sa.CanceledError=fg,sa.CancelToken=A1e,sa.isCancel=TH,sa.VERSION=GH,sa.toFormData=_x,sa.AxiosError=Pn,sa.Cancel=sa.CanceledError,sa.all=function(r){return He.all(r)},sa.spread=function(r){return function(a){return r.apply(null,a)}},sa.isAxiosError=function(r){return Ge.isObject(r)&&r.isAxiosError===!0},sa.mergeConfig=rp,sa.AxiosHeaders=Zc,sa.formToJSON=r=>SH(Ge.isHTMLForm(r)?new FormData(r):r),sa.getAdapter=$H.getAdapter,sa.HttpStatusCode=I1e,sa.default=sa;var Ka=sa;const O1e=()=>{};function ib(){const r={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:O1e};return r.promise=new He((a,s)=>{r.resolve=l=>{r.isFinished||(r.isResolved=!0,r.isFinished=!0,a(l),r.value=l)},r.reject=l=>{r.isFinished||(r.isRejected=!0,r.isFinished=!0,s(l))}}),r}const Bx=new Map,$x=new Map,Ql=new Map;let oi=function(r){return r.WIN_10="Windows 10",r.WIN_81="Windows 8.1",r.WIN_8="Windows 8",r.WIN_7="Windows 7",r.WIN_VISTA="Windows Vista",r.WIN_SERVER_2003="Windows Server 2003",r.WIN_XP="Windows XP",r.WIN_2000="Windows 2000",r.ANDROID="Android",r.HARMONY_OS="HarmonyOS",r.OPEN_BSD="Open BSD",r.SUN_OS="Sun OS",r.LINUX="Linux",r.IOS="iOS",r.MAC_OS="Mac OS",r.CHROMIUM_OS="Chromium OS",r.QNX="QNX",r.UNIX="UNIX",r.BEOS="BeOS",r.OS_2="OS/2",r.SEARCH_BOT="Search Bot",r}({}),fn=function(r){return r.CHROME="Chrome",r.SAFARI="Safari",r.EDGE="Edge",r.FIREFOX="Firefox",r.OPERA="OPR",r.QQ="QQBrowser",r.WECHAT="MicroMessenger",r}({});const zH=new oRe;let Qc=zH.getResult(),sj=null;function an(r){if(!sj){Qc=zH.getResult();const a=function(y){if(y.engine.name==="Blink"&&y.browser.name!=="WeChat")return fn.CHROME;switch(y.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return fn.CHROME;case"Safari":case"Mobile Safari":return fn.SAFARI;case"Edge":return fn.EDGE;case"Firefox":return fn.FIREFOX;case"QQ":case"QQBrowser":return fn.QQ;case"Opera":return fn.OPERA;case"WeChat":return fn.WECHAT;default:return y.browser.name||""}}(Qc),s=KH(Qc),l=function(y){return y.os.name==="Windows"?y.os.version?y.os.name+" "+y.os.version:y.os.name:y.os.name||""}(Qc),d=Qc.os.version,f=KH(Qc,!1),m=Qc.device.type;if(!(a&&s&&l&&d))return{name:a,version:s,os:l,osVersion:d,browserVersion:f,deviceType:m};sj={name:a,version:s,os:l,osVersion:d,browserVersion:f,deviceType:m}}return sj}function KH(r){let a,s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return a=r.engine.name==="Blink"?r.engine.version||"":r.browser.version||"",s?a.split(".")[0]:a}function Wx(){return an().os}function qH(){const r=an();return"".concat(r.os," ").concat(r.osVersion)}function Gx(){const r=an();return!!(Qc.engine.name==="WebKit"&&r.os===oi.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&r.name!==fn.SAFARI||oa()&&r.name!==fn.SAFARI)}function nd(){return an().name===fn.CHROME}function ji(){return an().name===fn.SAFARI}function YH(){const r=an();if(r.name!==fn.SAFARI||!r.browserVersion)return!1;const a=r.browserVersion.split(".");return Number(a[0])>15||Number(a[0])===15&&Number(a[1])>=4}function XH(){return an().name===fn.EDGE}function dr(){return an().name===fn.FIREFOX}function oa(){return an().os===oi.IOS}function pg(r){const a=an();return!(a.name!==fn.CHROME||!a.osVersion)&&Number(a.version)>=r}function JH(r){const a=an();return!(a.name!==fn.CHROME||!a.osVersion)&&Number(a.version)<r}function oj(r,a,s){const l=an();return!(l.name!==r||!l.osVersion)&&(s?Number(l.version)>=a&&Number(l.version)<=s:Number(l.version)===a)}function cj(r){const a=an();return!(a.name!==fn.EDGE||!a.osVersion)&&Number(a.version)>=r}function lj(r){const a=an();return!(a.name!==fn.FIREFOX||!a.osVersion)&&Number(a.version)>=r}function ZH(r){const a=an();return!(a.name!==fn.SAFARI||!a.osVersion)&&Number(a.version)>=r}function QH(r,a,s){const l=an();if(l.os!==oi.IOS||!l.osVersion)return!1;const d=l.osVersion.split(".");return s?a&&Number(d[0])===r&&Number(d[1])>a||Number(d[0])>r:a?Number(d[0])===r&&Number(d[1])>=a||Number(d[0])>r:Number(d[0])>=r}function ez(r,a,s){const l=an();if(l.os!==oi.IOS||!l.osVersion)return!1;const d=l.osVersion.split(".");return a&&Number(d[0])===r&&Number(d[1])<a||Number(d[0])<r}function uj(r,a,s){const l=an();if(l.name!==fn.SAFARI||!l.osVersion||!l.browserVersion)return!1;const d=l.browserVersion.split(".");return s?a&&Number(d[0])===r&&Number(d[1])<a||Number(d[0])<r:a?Number(d[0])===r&&Number(d[1])<=a||Number(d[0])<r:Number(d[0])<=r}function dj(r){const a=an();return!(a.name!==fn.OPERA||!a.osVersion)&&Number(a.version)>=r}function tz(){const r=an();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])<14||Number(a[0])===14&&Number(a[1])<=6}function mg(){const r=an();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])===15}function hj(){const r=an();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])===16}function nz(){const r=an();if(r.os!==oi.IOS||!r.osVersion)return!1;const a=r.osVersion.split(".");return Number(a[0])===15&&Number(a[1])>=1}function uc(){return ji()&&navigator.maxTouchPoints>0}function rz(){return an().name===fn.WECHAT}function iz(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function fj(){const r=Wx();return function(){const{deviceType:a}=an();return a==="mobile"||a==="tablet"}()||r===oi.ANDROID||r===oi.IOS||r===oi.HARMONY_OS}function rd(){const r=an();return r.name!==fn.EDGE&&r.name!==fn.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Hx(){return Wx()===oi.ANDROID}function ab(){const r=an();return Hx()&&(r.name===fn.CHROME||r.name===fn.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function kt(r,a,s){return(a=function(l){var d=function(f,m){if(typeof f!="object"||!f)return f;var y=f[Symbol.toPrimitive];if(y!==void 0){var _=y.call(f,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(l);return typeof d=="symbol"?d:d+""}(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}function az(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Ue(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?az(Object(s),!0).forEach(function(l){kt(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):az(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let ie=function(r){return r.UNEXPECTED_ERROR="UNEXPECTED_ERROR",r.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",r.TIMEOUT="TIMEOUT",r.INVALID_PARAMS="INVALID_PARAMS",r.NOT_READABLE="NOT_READABLE",r.NOT_SUPPORTED="NOT_SUPPORTED",r.INVALID_OPERATION="INVALID_OPERATION",r.OPERATION_ABORTED="OPERATION_ABORTED",r.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",r.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",r.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",r.DATACHANNEL_FAILED="DATACHANNEL_FAILED",r.NETWORK_ERROR="NETWORK_ERROR",r.NETWORK_TIMEOUT="NETWORK_TIMEOUT",r.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",r.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",r.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",r.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",r.ELECTRON_IS_NULL="ELECTRON_IS_NULL",r.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",r.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",r.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",r.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",r.PERMISSION_DENIED="PERMISSION_DENIED",r.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",r.TRACK_IS_DISABLED="TRACK_IS_DISABLED",r.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",r.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",r.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",r.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",r.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",r.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",r.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",r.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",r.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",r.UID_CONFLICT="UID_CONFLICT",r.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",r.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",r.TOKEN_EXPIRE="TOKEN_EXPIRE",r.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",r.INVALID_TRACK="INVALID_TRACK",r.SENDER_NOT_FOUND="SENDER_NOT_FOUND",r.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",r.SET_ANSWER_FAILED="SET_ANSWER_FAILED",r.ICE_FAILED="ICE_FAILED",r.PC_CLOSED="PC_CLOSED",r.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",r.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",r.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",r.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",r.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",r.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",r.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",r.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",r.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",r.INVALID_REMOTE_USER="INVALID_REMOTE_USER",r.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",r.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",r.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",r.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",r.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",r.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",r.WS_ABORT="WS_ABORT",r.WS_DISCONNECT="WS_DISCONNECT",r.WS_ERR="WS_ERR",r.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",r.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",r.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",r.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",r.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",r.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",r.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",r.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",r.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",r.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",r.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",r.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",r.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",r.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",r.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",r.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",r.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",r.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",r.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",r.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",r.INVALID_PLUGIN="INVALID_PLUGIN",r.DISCONNECT_P2P="DISCONNECT_P2P",r.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",r.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",r.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",r.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",r.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",r.PROHIBITED_OPERATION="PROHIBITED_OPERATION",r.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",r.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",r}({}),we=class extends Error{constructor(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;super(a),kt(this,"code",void 0),kt(this,"message",void 0),kt(this,"data",void 0),kt(this,"name","AgoraRTCException"),this.code=r,this.message="AgoraRTCError ".concat(this.code,": ").concat(a),this.data=s}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",a=arguments.length>1?arguments[1]:void 0;return r==="error"&&(a||console).error(this.toString()),r==="warning"&&(a||console).warn(this.toString()),this}throw(r){throw this.print("error",r),this}};function el(r,a){if(typeof r!="boolean")throw new we(ie.INVALID_PARAMS,"Invalid ".concat(a,": The value is of the boolean type."))}function ri(r,a,s){if(!Be(s).call(s,r))throw new we(ie.INVALID_PARAMS,"".concat(a," can only be set as ").concat(JSON.stringify(s)))}function kn(r,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(r<s||r>l||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(d){return typeof d=="number"&&d%1==0}(r))throw new we(ie.INVALID_PARAMS,"invalid ".concat(a,": the value range is [").concat(s,", ").concat(l,"]. integer only"))}function pj(r,a){if(typeof r!="number"){if(!(r.min||r.max||r.ideal||r.exact))throw new we(ie.INVALID_PARAMS,"".concat(a," is not a valid ConstrainLong"));r.min!==void 0&&kn(r.min,"".concat(a,".min"),0,1/0),r.max!==void 0&&kn(r.max,"".concat(a,".max"),1,1/0),r.exact!==void 0&&kn(r.exact,"".concat(a,".exact"),1,1/0),r.ideal!==void 0&&kn(r.ideal,"".concat(a,".ideal"),1,1/0)}else kn(r,a,1,1/0)}function xi(r,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,d=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(r==null)throw new we(ie.INVALID_PARAMS,"".concat(a||"param"," cannot be empty"));if(!sz(r,s,l,d))throw new we(ie.INVALID_PARAMS,"Invalid ".concat(a||"string param",": Length of the string: [").concat(s,",").concat(l,"].").concat(d?" ASCII characters only.":""))}function id(r,a){if(!Array.isArray(r))throw new we(ie.INVALID_PARAMS,"".concat(a," should be an array"))}function hr(r){return r==null}function sz(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,l=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof r=="string"&&r.length<=s&&r.length>=a&&(!l||function(d){if(typeof d!="string")return!1;for(let f=0;f<d.length;f+=1){const m=d.charCodeAt(f);if(m<0||m>255)return!1}return!0}(r))}var sb=function(r){return r.COVERED="COVERED",r.POSITION="POSITION",r.SIZE="SIZE",r.STYLE="STYLE",r}(sb||{}),mj=function(r){return r.UNMOUNTED="UNMOUNTED",r.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",r}(mj||{});const oz=new class{constructor(){kt(this,"_clientSize",null),kt(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),kt(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),kt(this,"getStyle",r=>window.getComputedStyle(r,null)),kt(this,"checkCssVisibleProperty",r=>{var a;let s=!0;const l=this.getStyle(r),{display:d,visibility:f,opacity:m,filter:y}=l;return(d==="none"||Be(a=["hidden","collapse"]).call(a,f)||Number(m)<.1)&&(s=!1),!!s&&(y&&y.split(" ").filter(_=>{var S;const x=_.split("(")[0];return Be(S=["brightness","blur","opacity"]).call(S,x)}).map(_=>{const[S,x]=_.split(/\(|\)/);return[S,Number(x.match(/^[0-9\.]+/))]}).forEach(_=>{const[S,x]=_;switch(S){case"brightness":(x<.1||x>3)&&(s=!1);break;case"blur":x>3&&(s=!1);break;case"opacity":x<.1&&(s=!1)}}),s)}),kt(this,"checkPropertyUpToAllParentNodes",(r,a)=>{let s=!0,l=!0;const d=m=>a(m);let f=r;for(;f&&l;)d(f)||(s=!1,l=!1),f=f.parentElement,f||(l=!1);return s}),kt(this,"checkActualCssVisibleIncludeInherit",r=>this.checkPropertyUpToAllParentNodes(r,this.checkCssVisibleProperty)),kt(this,"getSizeAboutClient",r=>{const{width:a,height:s,left:l,right:d,top:f,bottom:m}=r.getBoundingClientRect(),y=this.getClientWidth(),_=this.getClientHeight();return{width:a,height:s,left:l,right:d,top:f,bottom:m,clientWidth:y,clientHeight:_,clientMin:Math.min(y,_)}}),kt(this,"checkActualSize",()=>{const{width:r,height:a,clientMin:s}=this._clientSize;return this.checkSizeIsVisible(r,a,s)}),kt(this,"elementFromPoint",(r,a)=>document.elementFromPoint?document.elementFromPoint(r,a):null),kt(this,"checkCoverForAPoint",(r,a,s)=>{const l=this.elementFromPoint(r,a);return l!==null&&l!==s}),kt(this,"getPointPositionList",()=>{const{width:r,height:a,left:s,top:l}=this._clientSize,d=r/6,f=a/6,m=[],y=10**6;for(let _=0;_<5;_++)for(let S=0;S<5;S++){const x=(s*y+(_===0?.1:_===4?(d*_*y-1e5)/y:d*_)*y)/y,A=(l*y+(S===0?.1:S===4?(f*S*y-1e5)/y:f*S)*y)/y;m.push({x,y:A})}return[...m]}),kt(this,"checkElementCover",r=>this.getPointPositionList().map(a=>this.checkCoverForAPoint(a.x,a.y,r)).filter(a=>!!a).length>6),kt(this,"checkSizeIsVisible",(r,a,s)=>(r>50||s/r<=10)&&(a>50||s/a<=10)),kt(this,"checkSizeOfPartInClient",()=>{const{left:r,right:a,top:s,bottom:l,clientHeight:d,clientWidth:f,clientMin:m}=this._clientSize;let y,_,S,x;if(r<0)y=0;else{if(!(r<f))return!1;y=r}if(a<0)return!1;if(_=a<f?a:f,s<0)S=0;else{if(!(s<d))return!1;S=s}if(l<0)return!1;x=l<d?l:d;const A=_-y,I=x-S;return this.checkSizeIsVisible(A,I,m)}),kt(this,"returnHiddenResult",r=>(this._clientSize=null,{visible:!1,reason:r})),kt(this,"checkOneElementVisible",r=>{if(r instanceof HTMLElement){if(this.checkElementIsMountedOnDom(r)){if(this.checkActualCssVisibleIncludeInherit(r)){if(this._clientSize=this.getSizeAboutClient(r),this.checkElementCover(r))return this.returnHiddenResult(sb.COVERED);{const a=this.checkActualSize(),s=this.checkSizeOfPartInClient();return a&&!s?this.returnHiddenResult(sb.POSITION):a?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(sb.SIZE)}}return this.returnHiddenResult(sb.STYLE)}return this.returnHiddenResult(mj.UNMOUNTED)}return this.returnHiddenResult(mj.INVALID_HTML_ELEMENT)}),kt(this,"checkElementIsMountedOnDom",r=>this.checkPropertyUpToAllParentNodes(r,a=>a.nodeName.toUpperCase()!=="HTML"?a.parentElement!==null:!!document.documentElement))}};function gj(r){return new TextEncoder().encode(r)}const cz=function(r,a){const s=new Uint8Array(r.byteLength+a.byteLength);return s.set(new Uint8Array(r),0),s.set(new Uint8Array(a),r.byteLength),s},vj=async r=>function(a,s){let l="";return new Uint8Array(a).forEach(d=>{l+=d.toString(s).padStart(2,"0")}),l}(await crypto.subtle.digest("SHA-256",gj(r)),16);class cr{constructor(){kt(this,"_events",{}),kt(this,"addListener",this.on)}getListeners(a){return this._events[a]?this._events[a].map(s=>s.listener):[]}on(a,s){this._events[a]||(this._events[a]=[]);const l=this._events[a];this._indexOfListener(l,s)===-1&&l.push({listener:s,once:!1})}once(a,s){this._events[a]||(this._events[a]=[]);const l=this._events[a];this._indexOfListener(l,s)===-1&&l.push({listener:s,once:!0})}off(a,s){if(!this._events[a])return;const l=this._events[a],d=this._indexOfListener(l,s);d!==-1&&l.splice(d,1),this._events[a].length===0&&delete this._events[a]}removeAllListeners(a){a?delete this._events[a]:this._events={}}emit(a){this._events[a]||(this._events[a]=[]);const s=this._events[a].map(m=>m);for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];for(let m=0;m<s.length;m+=1){const y=s[m];y.once&&this.off(a,y.listener),y.listener.apply(this,d||[])}}safeEmit(a){for(var s=arguments.length,l=new Array(s>1?s-1:0),d=1;d<s;d++)l[d-1]=arguments[d];[...this._events[a]||[]].forEach(f=>{f.once&&this.off(a,f.listener);try{f.listener.apply(this,l)}catch(m){console.error("safeEmit event:".concat(a," error ").concat(m==null?void 0:m.toString()))}})}_indexOfListener(a,s){let l=a.length;for(;l--;)if(a[l].listener===s)return l;return-1}}let ob=null;function lz(){if(ob)return ob;if(window.electron)return ob=window.electron;if(!window.require)return null;try{return ob=window.require("electron"),ob}catch{return null}}let Er=function(r){return r.CREATE_CLIENT="createClient",r.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",r.SET_AREA="setArea",r.PRELOAD="PRELOAD",r.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",r.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",r.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",r.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",r.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",r.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",r.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",r.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",r.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",r.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",r.START_PROXY_SERVER="Client.startProxyServer",r.STOP_PROXY_SERVER="Client.stopProxyServer",r.SET_PROXY_SERVER="Client.setProxyServer",r.SET_TURN_SERVER="Client.setTurnServer",r.SET_CLIENT_ROLE="Client.setClientRole",r.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",r.ENABLE_DUAL_STREAM="Client.enableDualStream",r.DISABLE_DUAL_STREAM="Client.disableDualStream",r.JOIN="Client.join",r.LEAVE="Client.leave",r.PUBLISH="Client.publish",r.UNPUBLISH="Client.unpublish",r.SUBSCRIBE="Client.subscribe",r.MASS_SUBSCRIBE="Client.massSubscribe",r.MASS_UNSUBSCRIBE="Client.massUnsubscribe",r.UNSUBSCRIBE="Client.unsubscribe",r.RENEW_TOKEN="Client.renewToken",r.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",r.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",r.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",r.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",r.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",r.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",r.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",r.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",r.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",r.START_LIVE_STREAMING="Client.startLiveStreaming",r.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",r.STOP_LIVE_STREAMING="Client.stopLiveStreaming",r.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",r.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",r.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",r.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",r.SET_CONFIG_DISTRIBUTE="_configDistribute",r.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",r.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",r.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",r.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",r.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",r.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",r.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",r.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",r.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",r.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",r.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",r.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",r.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",r.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",r.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",r.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",r.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",r.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",r.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",r.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",r.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",r.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",r.STREAM_TYPE_CHANGE="streamTypeChange",r.CONNECTION_STATE_CHANGE="connectionStateChange",r.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",r.IMAGE_MODERATION_UPLOAD="imageModerationUpload",r.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",r.PRELOAD_MEDIA_FAILED="preloadMediaFailed",r.MISMATCH_DTLS_PARAMETERS="mismatchDtlsParameters",r}({}),rr=function(r){return r.TRACER="tracer",r}({});function uz(r){return kn(r.timeout,"config.timeout",0,1e5),kn(r.timeoutFactor,"config.timeoutFactor",0,100,!1),kn(r.maxRetryCount,"config.maxRetryConfig",0,1/0),kn(r.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let P1e=function(r){return r[r.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",r[r.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",r[r.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",r}({}),En=function(r){return r.LEAVE="LEAVE",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.UID_BANNED="UID_BANNED",r.FALLBACK="FALLBACK",r.IP_BANNED="IP_BANNED",r.CHANNEL_BANNED="CHANNEL_BANNED",r.LICENSE_MISSING="LICENSE_MISSING",r.LICENSE_EXPIRED="LICENSE_EXPIRED",r.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",r.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",r.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",r.LICENSE_ILLEGAL="LICENSE_ILLEGAL",r.TOKEN_EXPIRE="TOKEN_EXPIRE",r}({});function cb(r){if(!Array.isArray(r)||r.length<1)return!1;try{r.forEach(a=>{if(!a.urls)throw Error()})}catch{return!1}return!0}function dz(r){return xi(r.turnServerURL,"turnServerURL"),xi(r.username,"username"),xi(r.password,"password"),r.udpport&&kn(r.udpport,"udpport",1,99999,!0),r.forceturn&&el(r.forceturn,"forceturn"),r.security&&el(r.security,"security"),r.tcpport&&kn(r.tcpport,"tcpport",1,99999,!0),!0}function yj(r){return r.level!==void 0&&ri(r.level,"level",[1,2,3]),r.delay!==void 0&&kn(r.delay,"delay",0,3e3,!0),!0}let Zt=function(r){return r.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",r.AUDIO_METADATA="audio-metadata",r.AUDIO_PTS="audio-pts",r.CONNECTION_STATE_CHANGE="connection-state-change",r.MEDIA_RECONNECT_START="media-reconnect-start",r.MEDIA_RECONNECT_END="media-reconnect-end",r.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",r.USER_JOINED="user-joined",r.USER_LEAVED="user-left",r.USER_PUBLISHED="user-published",r.USER_UNPUBLISHED="user-unpublished",r.USER_INFO_UPDATED="user-info-updated",r.CLIENT_BANNED="client-banned",r.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",r.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",r.VOLUME_INDICATOR="volume-indicator",r.CRYPT_ERROR="crypt-error",r.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",r.NETWORK_QUALITY="network-quality",r.STREAM_TYPE_CHANGED="stream-type-changed",r.STREAM_FALLBACK="stream-fallback",r.RECEIVE_METADATA="receive-metadata",r.STREAM_MESSAGE="stream-message",r.LIVE_STREAMING_ERROR="live-streaming-error",r.LIVE_STREAMING_WARNING="live-streaming-warning",r.EXCEPTION="exception",r.ERROR="error",r.P2P_LOST="p2p_lost",r.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",r.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",r.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",r.PUBLISHED_USER_LIST="published-user-list",r.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",r.CONTENT_INSPECT_ERROR="content-inspect-error",r.CONTENT_INSPECT_RESULT="content-inspect-result",r.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",r}({}),Di=function(r){return r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.MULTI_IP="MULTI_IP",r.TIMEOUT="TIMEOUT",r.OFFLINE="OFFLINE",r.LEAVE="LEAVE",r.P2P_FAILED="P2P_FAILED",r.FALLBACK="FALLBACK",r.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",r}({}),As=function(r){return r.ONLINE="ONLINE",r.OFFLINE="OFFLINE",r}({}),gg=function(r){return r.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",r.ONLINE="ONLINE",r.OFFLINE="OFFLINE",r}({});function Li(r,a){for(var s=arguments.length,l=new Array(s>2?s-2:0),d=2;d<s;d++)l[d-2]=arguments[d];return r.getListeners(a).length===0?He.reject(new we(ie.UNEXPECTED_ERROR,"can not emit promise")):new He((f,m)=>{r.emit(a,...l,f,m)})}function Ln(r,a){if(r.getListeners(a).length===0)return He.resolve();for(var s=arguments.length,l=new Array(s>2?s-2:0),d=2;d<s;d++)l[d-2]=arguments[d];return Li(r,a,...l)}function qs(r,a){if(r.getListeners(a).length===0)return null;for(var s=arguments.length,l=new Array(s>2?s-2:0),d=2;d<s;d++)l[d-2]=arguments[d];return lb(r,a,...l)}function lb(r,a){let s=null,l=null;for(var d=arguments.length,f=new Array(d>2?d-2:0),m=2;m<d;m++)f[m-2]=arguments[m];if(r.emit(a,...f,y=>{s=y},y=>{l=y}),l!==null)throw l;if(s===null)throw new we(ie.UNEXPECTED_ERROR,"handler is not sync");return s}const Dr=new class extends cr{set networkState(r){this.emit(gg.NETWORK_STATE_CHANGE,r,this._networkState),r===As.ONLINE?this.emit(gg.ONLINE):r===As.OFFLINE&&(this.onlineWaiter=new He(a=>{this.once(gg.ONLINE,()=>{this.onlineWaiter=void 0,a(As.ONLINE)})}),this.emit(gg.OFFLINE)),this._networkState=r}get networkState(){return this._networkState}get isOnline(){return this._networkState===As.ONLINE}constructor(){super(),kt(this,"_moduleName","network-indicator"),kt(this,"_networkState",As.ONLINE),kt(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=As.ONLINE}),window.addEventListener("offline",()=>{this.networkState=As.OFFLINE})}};function zx(r,a){const s=r.indexOf(a);s!==-1&&r.splice(s,1)}function vg(r){const a=[];return r.forEach(s=>{a.indexOf(s)===-1&&a.push(s)}),a}function Kx(r){He!==void 0?He.resolve().then(r):setTimeout(r,0)}function ir(r){return JSON.parse(JSON.stringify(r))}function ip(r){try{return ir(r)}catch{return r}}const hz={};function uh(r,a){hz[a]||(hz[a]=!0,r())}function ap(r){const a=window.atob(r),s=new Uint8Array(new ArrayBuffer(a.length));for(let l=0;l<a.length;l+=1)s[l]=a.charCodeAt(l);return s}function dh(r){let a="";for(let s=0;s<r.length;s+=1)a+=String.fromCharCode(r[s]);return window.btoa(a)}function fz(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,s=new TextEncoder().encode(r);if(s.length>a)s=s.slice(0,a);else if(s.length<a){const l=new Uint8Array(a);l.set(s),s=l}return s}function pz(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=rc(a).call(a,(m,y)=>m+y.length,0),d=new Uint8Array(new ArrayBuffer(l));let f=0;return a.forEach(m=>{d.set(m,f),f+=m.length}),d}function eu(r){return window.TextEncoder?new TextEncoder().encode(r).length:r.length}function mz(r){let a=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&r.realFormData&&(r=r.realFormData),r.forEach(s=>{a+=typeof s=="string"?eu(s):s.size}),a+138}function k1e(r){const a=new we(ie.TIMEOUT,"timeout");return new He((s,l)=>{window.setTimeout(()=>l(a),r)})}function Ti(r){return new He(a=>{window.setTimeout(a,r)})}function Mn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,a=arguments.length>1?arguments[1]:void 0;const s=Math.random().toString(16).substr(2,r).toLowerCase();return s.length===r?"".concat(a).concat(s):"".concat(a).concat(s)+Mn(r-s.length,"")}function sp(){return Mn(32,"").toUpperCase()}const qx=()=>{},gz=new class{constructor(){kt(this,"fnMap",new Map)}throttleByKey(r,a,s,l){for(var d=arguments.length,f=new Array(d>4?d-4:0),m=4;m<d;m++)f[m-4]=arguments[m];if(this.fnMap.has(a)){const y=this.fnMap.get(a);if(y.threshold!==s){y.fn(...y.args),clearTimeout(y.timer);const _=window.setTimeout(()=>{const S=this.fnMap.get(a);S&&S.fn(...S.args),this.fnMap.delete(a)},s);this.fnMap.set(a,{fn:r,threshold:s,timer:_,args:f,skipFn:l})}else y.skipFn&&y.skipFn(...y.args),this.fnMap.set(a,Ue(Ue({},y),{},{fn:r,args:f,skipFn:l}))}else{const y=window.setTimeout(()=>{const _=this.fnMap.get(a);_&&_.fn(..._.args),this.fnMap.delete(a)},s);this.fnMap.set(a,{fn:r,threshold:s,timer:y,args:f,skipFn:l})}}},vz=gz.throttleByKey.bind(gz);function yz(r){return typeof r=="object"&&r!==null&&!(r instanceof RegExp)}function _j(r,a){if(!yz(r)||!yz(a)||Array.isArray(r)&&!Array.isArray(a)||!Array.isArray(r)&&Array.isArray(a))return a;if(Array.isArray(a)&&Array.isArray(r)){const s=[...r];for(let l=0;l<a.length;l++)s[l]=_j(r[l],a[l]);return s}{const s=Ue({},r);for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&(Object.prototype.hasOwnProperty.call(r,l)?s[l]=_j(r[l],a[l]):s[l]=a[l]);return s}}function _z(r,a){let s=[0];if(s=new Array(a).fill(0),r===0)return s;let l=0;for(;r>0&&(s[l]=255&r,r>>=8,l++,l!==a););return s}function yg(r){return typeof r=="number"?r:r.exact||r.ideal||r.max||r.min||0}function bj(r){return rc(r).call(r,(a,s)=>a+s,0)}function bz(r){const a="0123456789abcdef";function s(ce){let pe,fe="";for(pe=0;pe<=3;pe++)fe+=a.charAt(ce>>8*pe+4&15)+a.charAt(ce>>8*pe&15);return fe}function l(ce,pe){const fe=(65535&ce)+(65535&pe);return(ce>>16)+(pe>>16)+(fe>>16)<<16|65535&fe}function d(ce,pe,fe,ue,ye,Se){return l(function(Ie,Me){return Ie<<Me|Ie>>>32-Me}(l(l(pe,ce),l(ue,Se)),ye),fe)}function f(ce,pe,fe,ue,ye,Se,Ie){return d(pe&fe|~pe&ue,ce,pe,ye,Se,Ie)}function m(ce,pe,fe,ue,ye,Se,Ie){return d(pe&ue|fe&~ue,ce,pe,ye,Se,Ie)}function y(ce,pe,fe,ue,ye,Se,Ie){return d(pe^fe^ue,ce,pe,ye,Se,Ie)}function _(ce,pe,fe,ue,ye,Se,Ie){return d(fe^(pe|~ue),ce,pe,ye,Se,Ie)}const S=function(ce){let pe;const fe=1+(ce.length+8>>6),ue=new Array(16*fe);for(pe=0;pe<16*fe;pe++)ue[pe]=0;for(pe=0;pe<ce.length;pe++)ue[pe>>2]|=ce.charCodeAt(pe)<<pe%4*8;return ue[pe>>2]|=128<<pe%4*8,ue[16*fe-2]=8*ce.length,ue}(r);let x,A,I,L,K,$=1732584193,G=-271733879,ne=-1732584194,te=271733878;for(x=0;x<S.length;x+=16)A=$,I=G,L=ne,K=te,$=f($,G,ne,te,S[x+0],7,-680876936),te=f(te,$,G,ne,S[x+1],12,-389564586),ne=f(ne,te,$,G,S[x+2],17,606105819),G=f(G,ne,te,$,S[x+3],22,-1044525330),$=f($,G,ne,te,S[x+4],7,-176418897),te=f(te,$,G,ne,S[x+5],12,1200080426),ne=f(ne,te,$,G,S[x+6],17,-1473231341),G=f(G,ne,te,$,S[x+7],22,-45705983),$=f($,G,ne,te,S[x+8],7,1770035416),te=f(te,$,G,ne,S[x+9],12,-1958414417),ne=f(ne,te,$,G,S[x+10],17,-42063),G=f(G,ne,te,$,S[x+11],22,-1990404162),$=f($,G,ne,te,S[x+12],7,1804603682),te=f(te,$,G,ne,S[x+13],12,-40341101),ne=f(ne,te,$,G,S[x+14],17,-1502002290),G=f(G,ne,te,$,S[x+15],22,1236535329),$=m($,G,ne,te,S[x+1],5,-165796510),te=m(te,$,G,ne,S[x+6],9,-1069501632),ne=m(ne,te,$,G,S[x+11],14,643717713),G=m(G,ne,te,$,S[x+0],20,-373897302),$=m($,G,ne,te,S[x+5],5,-701558691),te=m(te,$,G,ne,S[x+10],9,38016083),ne=m(ne,te,$,G,S[x+15],14,-660478335),G=m(G,ne,te,$,S[x+4],20,-405537848),$=m($,G,ne,te,S[x+9],5,568446438),te=m(te,$,G,ne,S[x+14],9,-1019803690),ne=m(ne,te,$,G,S[x+3],14,-187363961),G=m(G,ne,te,$,S[x+8],20,1163531501),$=m($,G,ne,te,S[x+13],5,-1444681467),te=m(te,$,G,ne,S[x+2],9,-51403784),ne=m(ne,te,$,G,S[x+7],14,1735328473),G=m(G,ne,te,$,S[x+12],20,-1926607734),$=y($,G,ne,te,S[x+5],4,-378558),te=y(te,$,G,ne,S[x+8],11,-2022574463),ne=y(ne,te,$,G,S[x+11],16,1839030562),G=y(G,ne,te,$,S[x+14],23,-35309556),$=y($,G,ne,te,S[x+1],4,-1530992060),te=y(te,$,G,ne,S[x+4],11,1272893353),ne=y(ne,te,$,G,S[x+7],16,-155497632),G=y(G,ne,te,$,S[x+10],23,-1094730640),$=y($,G,ne,te,S[x+13],4,681279174),te=y(te,$,G,ne,S[x+0],11,-358537222),ne=y(ne,te,$,G,S[x+3],16,-722521979),G=y(G,ne,te,$,S[x+6],23,76029189),$=y($,G,ne,te,S[x+9],4,-640364487),te=y(te,$,G,ne,S[x+12],11,-421815835),ne=y(ne,te,$,G,S[x+15],16,530742520),G=y(G,ne,te,$,S[x+2],23,-995338651),$=_($,G,ne,te,S[x+0],6,-198630844),te=_(te,$,G,ne,S[x+7],10,1126891415),ne=_(ne,te,$,G,S[x+14],15,-1416354905),G=_(G,ne,te,$,S[x+5],21,-57434055),$=_($,G,ne,te,S[x+12],6,1700485571),te=_(te,$,G,ne,S[x+3],10,-1894986606),ne=_(ne,te,$,G,S[x+10],15,-1051523),G=_(G,ne,te,$,S[x+1],21,-2054922799),$=_($,G,ne,te,S[x+8],6,1873313359),te=_(te,$,G,ne,S[x+15],10,-30611744),ne=_(ne,te,$,G,S[x+6],15,-1560198380),G=_(G,ne,te,$,S[x+13],21,1309151649),$=_($,G,ne,te,S[x+4],6,-145523070),te=_(te,$,G,ne,S[x+11],10,-1120210379),ne=_(ne,te,$,G,S[x+2],15,718787259),G=_(G,ne,te,$,S[x+9],21,-343485551),$=l($,A),G=l(G,I),ne=l(ne,L),te=l(te,K);return s($)+s(G)+s(ne)+s(te)}let j1e=1,Ez=console,Hi=class{static setLogger(r){Ez=r}constructor(r,a){kt(this,"id",void 0),kt(this,"lockingPromise",He.resolve()),kt(this,"locks",0),kt(this,"name",""),kt(this,"lockId",void 0),this.lockId=j1e++,r&&(this.name=r),a&&(this.id=a),this.logger("created")}logger(r,a){const s=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),l=r==="created"?"is ".concat(r,"."):"is ".concat(r,", current queue ").concat(this.locks,". ").concat(a??"");Ez.debug("".concat(s," ").concat(l))}setId(r){this.id=r}get isLocked(){return this.locks>0}lock(r){let a;this.locks+=1,this.logger("locked",r);const s=new He(d=>{a=()=>{this.locks-=1,this.logger("unlocked",r),d()}}),l=this.lockingPromise.then(()=>a);return this.lockingPromise=this.lockingPromise.then(()=>s),l}};function _g(r,a){return function(s,l,d){const f=d.value;if(typeof f!="function")throw new Error("Cannot use mutex on object property.");return d.value=async function(){const m=this[a];if(!m)throw new Error("mutex property key ".concat(a," doesn't exist on ").concat(r));const y=await m.lock("From ".concat(r,".").concat(l));try{for(var _=arguments.length,S=new Array(_),x=0;x<_;x++)S[x]=arguments[x];return await f.apply(this,S)}finally{y()}},d}}const Gr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Ej(r,a){const s=Math.floor(a.timeout*Math.pow(a.timeoutFactor,r));return Math.min(a.maxRetryTimeout,s)}function tl(r,a,s,l){const d=Object.assign({},Gr,l);let f=d.timeout;const m=async()=>{await function(S){return new He(x=>{window.setTimeout(x,S)})}(f),f*=d.timeoutFactor,f=Math.min(d.maxRetryTimeout,f)};let y=!1;const _=new He(async(S,x)=>{a=a||(()=>!1),s=s||(()=>!0);for(let A=0;A<d.maxRetryCount;A+=1){if(y)return x(new we(ie.OPERATION_ABORTED));try{const I=await r();if(!a(I,A)||A+1===d.maxRetryCount)return S(I);await m()}catch(I){if(!s(I,A)||A+1===d.maxRetryCount)return x(I);await m()}}});return _.cancel=()=>y=!0,_}let Yx,wz=class{constructor(r){kt(this,"input",[]),kt(this,"size",void 0),this.size=r}add(r){this.input.push(r),this.input.length>this.size&&this.input.splice(0,1)}mean(){var r;return this.input.length===0?0:rc(r=this.input).call(r,(a,s)=>a+s)/this.input.length}},Xx=0,wj=0;function Sj(r,a,s,l){return new He((d,f)=>{a.responseType=a.responseType||"json",a.data&&!s?(a.data=JSON.stringify(a.data),Xx+=eu(a.data)):s&&(a.data.size?Xx+=a.data.size:a.data instanceof FormData?Xx+=mz(a.data):Xx+=eu(JSON.stringify(a.data))),a.headers=a.headers||{},a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.method="POST",a.url=r,Ka.request(a).then(m=>{typeof m.data=="string"?wj+=eu(m.data):m.data instanceof ArrayBuffer||m.data instanceof Uint8Array?wj+=m.data.byteLength:wj+=eu(JSON.stringify(m.data)),d(m.data)}).catch(m=>{Ka.isCancel(m)?f(new we(ie.OPERATION_ABORTED,"cancel token canceled")):m.code==="ECONNABORTED"?f(new we(ie.NETWORK_TIMEOUT,m.message)):m.response?f(new we(ie.NETWORK_RESPONSE_ERROR,m.response.status)):f(new we(ie.NETWORK_ERROR,m.message))})})}async function D1e(r,a){const s=new Blob([a.data],{type:"buffer"});return await Sj(r,Ue(Ue({},a),{},{data:s,headers:{"Content-Type":"application/octet-stream"}}),!0)}const Sz=()=>window.isSecureContext!==void 0;function dc(r){if(Array.isArray(r))return r.map(s=>s);if(!xz(r))return r;const a={};for(const s in r){const l=r[s];xz(l)||Array.isArray(l)?a[s]=dc(l):a[s]=l}return a}function xz(r){return!(typeof r!="object"||Array.isArray(r)||!r)}let xj=class{constructor(r){kt(this,"input",[]),kt(this,"size",void 0),this.size=r}add(r){this.input.push(r),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const tu={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},ub={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:tu,remoteCandidate:tu},updateInterval:0},Tz={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},Cz={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},Rz={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},Nz={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let Tj=class{constructor(r,a){kt(this,"onFirstVideoReceived",void 0),kt(this,"onFirstVideoDecoded",void 0),kt(this,"onFirstAudioReceived",void 0),kt(this,"onFirstVideoDecodedTimeout",void 0),kt(this,"onFirstAudioDecoded",void 0),kt(this,"onSelectedLocalCandidateChanged",void 0),kt(this,"onSelectedRemoteCandidateChanged",void 0),kt(this,"videoIsReady",!1),kt(this,"videoIsReady2",{}),kt(this,"pc",void 0),kt(this,"options",void 0),kt(this,"intervalTimer",void 0),kt(this,"stats",dc(ub)),kt(this,"isFirstVideoReceived",{}),kt(this,"isFirstVideoDecoded",{}),kt(this,"isFirstAudioReceived",{}),kt(this,"isFirstAudioDecoded",{}),kt(this,"isFirstVideoDecodedTimeout",{}),kt(this,"lossRateWindowStats",[]),this.pc=r,this.options=a,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new He(r=>{r({local:Ue({},tu),remote:Ue({},tu)})})}setVideoIsReady(r){this.videoIsReady=r}setVideoIsReady2(r,a){this.videoIsReady2[r]=a}getVideoIsReady(r){return this.videoIsReady2[r]||!1}setIsFirstAudioDecoded(r){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(r){this.lossRateWindowStats.push(r),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const a=this.lossRateWindowStats.length,s=["videoSend","audioSend","videoRecv","audioRecv"];let l=0,d=0,f=0,m=0;for(const y of s)r[y].forEach((_,S)=>{if(!this.lossRateWindowStats[a-1][y][S]||!this.lossRateWindowStats[0][y][S])return;const x=this.lossRateWindowStats[a-1][y][S].packets-this.lossRateWindowStats[0][y][S].packets,A=this.lossRateWindowStats[a-1][y][S].packetsLost-this.lossRateWindowStats[0][y][S].packetsLost;y==="videoSend"||y==="audioSend"?(l+=x,f+=A):(d+=x,m+=A),Number.isNaN(x)||Number.isNaN(x)?_.packetLostRate=0:_.packetLostRate=x<=0||A<=0?0:A/(x+A)});r.sendPacketLossRate=l<=0||f<=0?0:f/(l+f),r.recvPacketLossRate=d<=0||m<=0?0:m/(d+m)}},L1e=class extends Tj{constructor(){super(...arguments),kt(this,"_stats",ub),kt(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const r=await this._getStats(),a=this.statsResponsesToObjects(r);this._stats=dc(ub);const s=a.filter(d=>d.type==="ssrc");this.processSSRCStats(s);const l=a.find(d=>d.type==="VideoBwe");l&&this.processBandwidthStats(l),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(r){this._stats.bitrate={actualEncoded:Number(r.googActualEncBitrate),targetEncoded:Number(r.googTargetEncBitrate),retransmit:Number(r.googRetransmitBitrate),transmit:Number(r.googTransmitBitrate)},this._stats.sendBandwidth=Number(r.googAvailableSendBandwidth)}processSSRCStats(r){r.forEach(a=>{var s;const l=Be(s=a.id).call(s,"send");switch("".concat(a.mediaType,"_").concat(l?"send":"recv")){case"video_send":{const d=dc(Cz);d.codec=a.googCodecName,d.adaptionChangeReason="none",a.googCpuLimitedResolution&&(d.adaptionChangeReason="cpu"),a.googBandwidthLimitedResolution&&(d.adaptionChangeReason="bandwidth"),d.avgEncodeMs=Number(a.googAvgEncodeMs),d.inputFrame={width:Number(a.googFrameWidthInput)||Number(a.googFrameWidthSent),height:Number(a.googFrameHeightInput)||Number(a.googFrameHeightSent),frameRate:Number(a.googFrameRateInput)},d.sentFrame={width:Number(a.googFrameWidthSent),height:Number(a.googFrameHeightSent),frameRate:Number(a.googFrameRateInput)},d.firsCount=Number(a.googFirReceived),d.nacksCount=Number(a.googNacksReceived),d.plisCount=Number(a.googPlisReceived),d.frameCount=Number(a.framesEncoded),d.bytes=Number(a.bytesSent),d.packets=Number(a.packetsSent),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.rttMs=Number(a.googRtt||0),this._stats.videoSend.push(d),this._stats.rtt=d.rttMs;break}case"video_recv":{const d=dc(Tz),f=this.lastDecodeVideoReceiverStats.get(Number(a.ssrc));if(d.codec=a.googCodecName,d.targetDelayMs=Number(a.googTargetDelayMs),d.renderDelayMs=Number(a.googRenderDelayMs),d.currentDelayMs=Number(a.googCurrentDelayMs),d.minPlayoutDelayMs=Number(a.googMinPlayoutDelayMs),d.decodeMs=Number(a.googDecodeMs),d.maxDecodeMs=Number(a.googMaxDecodeMs),d.receivedFrame={width:Number(a.googFrameWidthReceived),height:Number(a.googFrameHeightReceived),frameRate:Number(a.googFrameRateReceived)},d.decodedFrame={width:Number(a.googFrameWidthReceived),height:Number(a.googFrameHeightReceived),frameRate:Number(a.googFrameRateDecoded)},d.decodeFrameRate=Number(a.googFrameRateDecoded),d.outputFrame={width:Number(a.googFrameWidthReceived),height:Number(a.googFrameHeightReceived),frameRate:Number(a.googFrameRateOutput)},d.jitterBufferMs=Number(a.googJitterBufferMs),d.firsCount=Number(a.googFirsSent),d.nacksCount=Number(a.googNacksSent),d.plisCount=Number(a.googPlisSent),d.framesDecodeCount=Number(a.framesDecoded),d.bytes=Number(a.bytesReceived),d.packets=Number(a.packetsReceived),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.packets>0&&!this.isFirstVideoReceived[d.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(d.ssrc),this.isFirstVideoReceived[d.ssrc]=!0),d.framesDecodeCount>0&&!this.isFirstVideoDecoded[d.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(d.ssrc,d.decodedFrame.width,d.decodedFrame.height),this.isFirstVideoDecoded[d.ssrc]=!0),f){const m=f.stats,y=Date.now()-f.lts;d.framesDecodeFreezeTime=m.framesDecodeFreezeTime,d.framesDecodeInterval=m.framesDecodeInterval,d.framesDecodeCount>m.framesDecodeCount&&this.isFirstVideoDecoded[d.ssrc]?(f.lts=Date.now(),d.framesDecodeInterval=y,d.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(a.ssrc,10))?d.framesDecodeFreezeTime+=d.framesDecodeInterval:this.setVideoIsReady2(parseInt(a.ssrc,10),!0))):d.framesDecodeCount<f.stats.framesDecodeCount&&(d.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(d.ssrc,{stats:Ue({},d),lts:Date.now()}),this._stats.videoRecv.push(d);break}case"audio_recv":{const d=dc(Nz);d.codec=a.googCodecName,d.outputLevel=Math.abs(Number(a.audioOutputLevel))/32767,d.decodingCNG=Number(a.googDecodingCNG),d.decodingCTN=Number(a.googDecodingCTN),d.decodingCTSG=Number(a.googDecodingCTSG),d.decodingNormal=Number(a.googDecodingNormal),d.decodingPLC=Number(a.googDecodingPLC),d.decodingPLCCNG=Number(a.googDecodingPLCCNG),d.expandRate=Number(a.googExpandRate),d.accelerateRate=Number(a.googAccelerateRate),d.preemptiveExpandRate=Number(a.googPreemptiveExpandRate),d.secondaryDecodedRate=Number(a.googSecondaryDecodedRate),d.speechExpandRate=Number(a.googSpeechExpandRate),d.preferredJitterBufferMs=Number(a.googPreferredJitterBufferMs),d.jitterBufferMs=Number(a.googJitterBufferMs),d.jitterMs=Number(a.googJitterReceived),d.bytes=Number(a.bytesReceived),d.packets=Number(a.packetsReceived),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.receivedFrames=Number(a.googDecodingCTN)||Number(a.packetsReceived),d.droppedFrames=Number(a.googDecodingPLC)+Number(a.googDecodingPLCCNG)||Number(a.packetsLost),d.receivedFrames>0&&!this.isFirstAudioReceived[d.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(d.ssrc),this.isFirstAudioReceived[d.ssrc]=!0),d.decodingNormal>0&&!this.isFirstAudioDecoded[d.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(d.ssrc),this.isFirstAudioDecoded[d.ssrc]=!0),this._stats.audioRecv.push(d);break}case"audio_send":{const d=dc(Rz);d.codec=a.googCodecName,d.inputLevel=Math.abs(Number(a.audioInputLevel))/32767,d.aecReturnLoss=Number(a.googEchoCancellationReturnLoss||0),d.aecReturnLossEnhancement=Number(a.googEchoCancellationReturnLossEnhancement||0),d.residualEchoLikelihood=Number(a.googResidualEchoLikelihood||0),d.residualEchoLikelihoodRecentMax=Number(a.googResidualEchoLikelihoodRecentMax||0),d.bytes=Number(a.bytesSent),d.packets=Number(a.packetsSent),d.packetsLost=Number(a.packetsLost),d.ssrc=Number(a.ssrc),d.rttMs=Number(a.googRtt||0),this._stats.rtt=d.rttMs,this._stats.audioSend.push(d);break}}})}_getStats(){return new He((r,a)=>{this.pc.getStats(r,a)})}statsResponsesToObjects(r){const a=[];return r.result().forEach(s=>{const l={id:s.id,timestamp:s.timestamp.valueOf().toString(),type:s.type};s.names().forEach(d=>{l[d]=s.stat(d)}),a.push(l)}),a}},db=function(r){return r.BANDWIDTH="bandwidth",r.CPU="cpu",r.NONE="none",r.OTHER="other",r}({}),Jx=function(r){return r.L1T1="L1T1",r.L1T2="L1T2",r.L1T3="L1T3",r.L1T3_KEY="L1T3_KEY",r.L2T1_KEY="L2T1_KEY",r.L2T2_KEY="L2T2_KEY",r.L2T3_KEY="L2T3_KEY",r.L3T1_KEY="L3T1_KEY",r.L3T2_KEY="L3T2_KEY",r.L3T3_KEY="L3T3_KEY",r}({}),Cj=function(r){return r[r.new=0]="new",r[r.connecting=1]="connecting",r[r.connected=2]="connected",r[r.disconnected=3]="disconnected",r[r.failed=4]="failed",r[r.closed=5]="closed",r}({}),Ys=function(r){return r.CERTIFICATE="certificate",r.CODEC="codec",r.CANDIDATE_PAIR="candidate-pair",r.LOCAL_CANDIDATE="local-candidate",r.REMOTE_CANDIDATE="remote-candidate",r.INBOUND="inbound-rtp",r.TRACK="track",r.OUTBOUND="outbound-rtp",r.PC="peer-connection",r.REMOTE_INBOUND="remote-inbound-rtp",r.REMOTE_OUTBOUND="remote-outbound-rtp",r.TRANSPORT="transport",r.CSRC="csrc",r.DATA_CHANNEL="data-channel",r.STREAM="stream",r.SENDER="sender",r.RECEIVER="receiver",r}({});var bg=function(r){return r[r.kNone=1]="kNone",r[r.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",r[r.kBytesToBits=8]="kBytesToBits",r}(bg||{});function hb(r,a,s,l){let d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:bg.kNone;if(!a)return;const f=Number(a[s]);if(typeof f!="number")return;const m=Number(a[l]);if(typeof m!="number")return;if(!r)return m?f/m*d:void 0;const y=Number(r[s]);if(typeof y!="number")return;const _=Number(r[l]);if(typeof _!="number")return;const S=m-_;return S?(f-y)/S*d:void 0}let Az=class extends Tj{constructor(){super(...arguments),kt(this,"_stats",ub),kt(this,"report",void 0),kt(this,"lastDecodeVideoReceiverStats",new Map),kt(this,"lastVideoFramesRecv",new Map),kt(this,"lastVideoFramesSent",new Map),kt(this,"lastVideoFramesDecode",new Map),kt(this,"lastVideoFramesOutput",new Map),kt(this,"lastVideoJBDelay",new Map),kt(this,"lastAudioJBDelay",new Map),kt(this,"mediaBytesSent",new Map),kt(this,"mediaBytesRetransmit",new Map),kt(this,"mediaBytesTargetEncode",new Map),kt(this,"lastDecodeAudioReceiverStats",new Map),kt(this,"lastAudioConcealment",new Map),kt(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=dc(ub),this.report.forEach(r=>{switch(r.type){case Ys.OUTBOUND:case Ys.INBOUND:{const a=r.mediaType||r.kind,s=!a&&"frameWidth"in r,l=!a&&!("frameWidth"in r);r.type===Ys.OUTBOUND?a==="audio"||l?this.processAudioOutboundStats(r):(a==="video"||s)&&this.processVideoOutboundStats(r):r.type===Ys.INBOUND&&(a==="audio"||l?this.processAudioInboundStats(r):(a==="video"||s)&&this.processVideoInboundStats(r));break}case Ys.TRANSPORT:{const a=this.report.get(r.selectedCandidatePairId);a&&this.processCandidatePairStats(a);break}case Ys.CANDIDATE_PAIR:r.selected&&this.processCandidatePairStats(r)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const r=await this.pc.getStats(),a={local:Ue({},tu),remote:Ue({},tu)};return r.forEach(s=>{let l;if(s.type===Ys.TRANSPORT&&(l=r.get(s.selectedCandidatePairId)),s.type===Ys.CANDIDATE_PAIR&&s.selected&&(l=s),l){const d=(f,m)=>{f.type=m.type,f.id=m.id,m.address&&(f.address=m.address),m.candidateType&&(f.candidateType=m.candidateType),m.port&&(f.port=m.port),m.priority&&(f.priority=m.priority),m.protocol&&(f.protocol=m.protocol),m.relayProtocol&&(f.relayProtocol=m.relayProtocol)};if(l.localCandidateId){const f=r.get(l.localCandidateId);f&&d(a.local,f)}if(l.remoteCandidateId){const f=r.get(l.remoteCandidateId);f&&d(a.remote,f)}}}),a}processCandidatePairStats(r){if(this._stats.sendBandwidth=r.availableOutgoingBitrate||0,r.currentRoundTripTime&&(this._stats.rtt=1e3*r.currentRoundTripTime),this._stats.videoSend.forEach(a=>{r.currentRoundTripTime&&(a.rttMs=1e3*r.currentRoundTripTime)}),this._stats.audioSend.forEach(a=>{r.currentRoundTripTime&&(a.rttMs=1e3*r.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=r.id,r.localCandidateId){const a=this.report.get(r.localCandidateId);a&&this.processCandidateStats(a)}if(r.remoteCandidateId){const a=this.report.get(r.remoteCandidateId);a&&this.processCandidateStats(a)}}processCandidateStats(r){let a;r.type===Ys.LOCAL_CANDIDATE&&(a=this._stats.selectedCandidatePair.localCandidate),r.type===Ys.REMOTE_CANDIDATE&&(a=this._stats.selectedCandidatePair.remoteCandidate),a&&(a.type=r.type,a.id=r.id,r.address&&(a.address=r.address),r.candidateType&&(a.candidateType=r.candidateType),r.port&&(a.port=r.port),r.priority&&(a.priority=r.priority),r.protocol&&(a.protocol=r.protocol),r.relayProtocol&&(a.relayProtocol=r.relayProtocol),r.type===Ys.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==a.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Ue({},a),Ue({},this.stats.selectedCandidatePair.localCandidate)),r.type===Ys.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==a.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Ue({},a),Ue({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(r){let a=this._stats.audioRecv.find(l=>l.ssrc===r.ssrc);a||(a=dc(Nz),this._stats.audioRecv.push(a)),a.ssrc=r.ssrc,a.packets=r.packetsReceived,a.packetsLost=r.packetsLost,a.packetsDiscarded=r.packetsDiscarded,a.bytes=r.bytesReceived,a.jitterMs=1e3*r.jitter,a.retransmittedBytesReceived=r.retransmittedBytesReceived,a.retransmittedPacketsReceived=r.retransmittedPacketsReceived,a.totalProcessingDelay=r.totalProcessingDelay,a.jitterBufferEmittedCount=r.jitterBufferEmittedCount;const s=this.lastDecodeAudioReceiverStats.get(a.ssrc);a.avgProcessingDelayMs=hb(s,a,"totalProcessingDelay","jitterBufferEmittedCount",bg.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(r,r.trackId,a),this.calculateAudioFreeze(a,s,r),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),a.receivedFrames||(a.receivedFrames=r.packetsReceived),a.droppedFrames||(a.droppedFrames=r.packetsLost),a.receivedFrames>0&&!this.isFirstAudioReceived[a.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(a.ssrc),this.isFirstAudioReceived[a.ssrc]=!0),a.outputLevel&&a.outputLevel>0&&!this.isFirstAudioDecoded[a.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(a.ssrc),this.isFirstAudioDecoded[a.ssrc]=!0),typeof r.concealedSamples=="number"&&(a.concealedSamples=r.concealedSamples),this.lastDecodeAudioReceiverStats.set(a.ssrc,Ue({},a))}calculateAudioFreeze(r,a,s){const l=this.lastAudioConcealment.get(r.ssrc);if(a!=null&&l!=null){const d=l.lts,f=s.timestamp,m=f-d;if(m<=0)return;const y=r.concealedSamples-a.concealedSamples-0,_=l.nonSilent+y,S=r.totalSamplesReceived-a.totalSamplesReceived;if(S<=0)return;const x=80*S/m,A=200*S/m,I=m/S;let L=0;r.freezeSamples80=a.freezeSamples80,r.freezeMs80=a.freezeMs80,_>x&&(l.plc80>0?(r.freezeSamples80+=y,r.freezeMs80+=Math.round(y*I)):(r.freezeSamples80+=_,r.freezeMs80+=Math.round(_*I)),L=l.plc80+1);let K=0;r.freezeSamples200=a.freezeSamples200,r.freezeMs200=a.freezeMs200,_>A&&(l.plc200>0?(r.freezeSamples200+=y,r.freezeMs200+=Math.round(y*I)):(r.freezeSamples200+=_,r.freezeMs200+=Math.round(_*I)),K=l.plc200+1),this.lastAudioConcealment.set(r.ssrc,{nonSilent:y,lts:f,plc80:L,plc200:K})}else r.freezeSamples80=0,r.freezeSamples200=0,r.freezeMs80=0,r.freezeMs200=0,this.lastAudioConcealment.set(r.ssrc,{nonSilent:0,lts:s.timestamp,plc80:0,plc200:0})}processVideoInboundStats(r){let a=this._stats.videoRecv.find(m=>m.ssrc===r.ssrc);a||(a=dc(Tz),this._stats.videoRecv.push(a)),a.ssrc=r.ssrc,a.packets=r.packetsReceived,a.packetsLost=r.packetsLost,a.bytes=r.bytesReceived,a.firsCount=r.firCount,a.nacksCount=r.nackCount,a.plisCount=r.pliCount,a.framesDecodeCount=r.framesDecoded,a.framesDroppedCount=r.framesDropped,a.totalInterFrameDelay=r.totalInterFrameDelay,a.totalSquaredInterFrameDelay=r.totalSquaredInterFrameDelay,a.totalFreezesDuration=r.totalFreezesDuration,a.totalProcessingDelay=r.totalProcessingDelay,a.packetsDiscarded=r.packetsDiscarded,a.framesAssembledFromMultiplePackets=r.framesAssembledFromMultiplePackets,a.totalAssemblyTime=r.totalAssemblyTime,a.keyFramesDecoded=r.keyFramesDecoded,a.retransmittedBytesReceived=r.retransmittedBytesReceived,a.retransmittedPacketsReceived=r.retransmittedPacketsReceived;const s=this.lastDecodeVideoReceiverStats.get(a.ssrc),l=this.lastVideoFramesDecode.get(a.ssrc),d=this.lastVideoFramesOutput.get(a.ssrc),f=Date.now();if(a.framesDecodeCount>0&&!this.isFirstVideoDecoded[a.ssrc]){const m=a.decodedFrame?a.decodedFrame.width:0,y=a.decodedFrame?a.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(a.ssrc,m,y),this.isFirstVideoDecoded[a.ssrc]=!0}if(s){const m=s.stats,y=f-s.lts;a.framesDecodeFreezeTime=m.framesDecodeFreezeTime,a.framesDecodeInterval=m.framesDecodeInterval,!this.isFirstVideoDecoded[a.ssrc]&&y>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[a.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(a.ssrc),this.isFirstVideoDecodedTimeout[a.ssrc]=!0),a.framesDecodeCount>m.framesDecodeCount&&this.isFirstVideoDecoded[a.ssrc]?(s.lts=Date.now(),a.framesDecodeInterval=y,a.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc))?a.framesDecodeFreezeTime+=a.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):a.framesDecodeCount<m.framesDecodeCount&&(a.framesDecodeInterval=0),r.framesDecoded&&r.qpSum&&(s.stats.framesDecodeCount>r.framesDecoded?a.qpSumPerFrame=r.qpSum/r.framesDecoded:a.qpSumPerFrame=(r.qpSum-s.qpSum)/(r.framesDecoded-s.stats.framesDecodeCount))}r.totalDecodeTime&&(a.decodeMs=1e3*r.totalDecodeTime,a.avgDecodeMs=hb(s==null?void 0:s.stats,a,"decodeMs","framesDecodeCount")),a.avgProcessingDelayMs=hb(s==null?void 0:s.stats,a,"totalProcessingDelay","framesDecodeCount",bg.kMillisecondsFromSeconds),a.avgFramesAssembledFromMultiplePacketsMs=hb(s==null?void 0:s.stats,a,"totalAssemblyTime","framesAssembledFromMultiplePackets",bg.kMillisecondsFromSeconds),a.avgInterFrameDelayMs=hb(s==null?void 0:s.stats,a,"totalInterFrameDelay","framesDecodeCount",bg.kMillisecondsFromSeconds),l&&f-l.lts>=800?(a.decodeFrameRate=Math.round((a.framesDecodeCount-l.count)/((f-l.lts)/1e3)),this.lastVideoFramesDecode.set(a.ssrc,{count:a.framesDecodeCount,lts:f,rate:a.decodeFrameRate})):l?a.decodeFrameRate=l.rate:this.lastVideoFramesDecode.set(a.ssrc,{count:a.framesDecodeCount,lts:f,rate:0}),a.framesDroppedCount&&r.framesReceived&&(d&&f-d.lts>=800?(a.outputFrameRate=Math.round((r.framesReceived-a.framesDroppedCount-d.count)/((f-d.lts)/1e3)),this.lastVideoFramesOutput.set(a.ssrc,{count:r.framesReceived-a.framesDroppedCount,lts:f,rate:Math.max(a.outputFrameRate,0)})):d?a.outputFrameRate=d.rate:this.lastVideoFramesOutput.set(a.ssrc,{count:r.framesReceived-a.framesDroppedCount,lts:f,rate:0})),this.processVideoTrackReceiverStats(r,r.trackId,a),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),r.framerateMean&&(a.framesRateFirefox=r.framerateMean),a.packets>0&&!this.isFirstVideoReceived[a.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(a.ssrc),this.isFirstVideoReceived[a.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(a.ssrc,{stats:Ue({},a),lts:s?s.lts:Date.now(),qpSum:r.qpSum})}processVideoOutboundStats(r){let a=this._stats.videoSend.find(l=>l.ssrc===r.ssrc);a||(a=dc(Cz),this._stats.videoSend.push(a));const s=this.mediaBytesSent.get(r.ssrc);if(s)s.add(r.bytesSent);else{const l=new xj(10);l.add(r.bytesSent),this.mediaBytesSent.set(r.ssrc,l)}if(r.retransmittedBytesSent!==void 0){const l=this.mediaBytesRetransmit.get(r.ssrc);if(l)l.add(r.retransmittedBytesSent);else{const d=new xj(10);d.add(r.retransmittedBytesSent),this.mediaBytesRetransmit.set(r.ssrc,d)}}if(r.totalEncodedBytesTarget){const l=this.mediaBytesTargetEncode.get(r.ssrc);if(l)l.add(r.totalEncodedBytesTarget);else{const d=new xj(10);d.add(r.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(r.ssrc,d)}}if(a.ssrc=r.ssrc,a.bytes=r.bytesSent,a.packets=r.packetsSent,a.firsCount=r.firCount,a.nacksCount=r.nackCount,a.plisCount=r.pliCount,a.frameCount=r.framesEncoded,a.adaptionChangeReason=r.qualityLimitationReason,a.scalabilityMode=r.scalabilityMode,a.retransmittedBytesSent=r.retransmittedBytesSent,a.retransmittedPacketsSent=r.retransmittedPacketsSent,a.hugeFramesSent=r.hugeFramesSent,a.keyFramesEncoded=r.keyFramesEncoded,a.targetBitrate=r.targetBitrate,r.totalEncodeTime&&r.framesEncoded){const l=this.lastEncoderMs.get(r.ssrc);if(!l||l.lastFrameCount>r.framesEncoded)a.avgEncodeMs=1e3*r.totalEncodeTime/r.framesEncoded;else{const d=r.framesEncoded-l.lastFrameCount,f=r.totalEncodeTime-l.lastEncoderTime;a.avgEncodeMs=1e3*f/d}}if(r.framesEncoded&&r.qpSum){const l=this.lastEncoderMs.get(r.ssrc);!l||l.lastFrameCount>r.framesEncoded?a.qpSumPerFrame=r.qpSum/r.framesEncoded:a.qpSumPerFrame=(r.qpSum-l.lastQpSum)/(r.framesEncoded-l.lastFrameCount)}if(this.lastEncoderMs.set(r.ssrc,{lastFrameCount:r.framesEncoded,lastEncoderTime:r.totalEncodeTime,lastQpSum:r.qpSum,lts:Date.now()}),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),r.mediaSourceId&&this.processVideoMediaSource(r.mediaSourceId,a),this.processVideoTrackSenderStats(r,r.trackId,a),r.remoteId)this.processRemoteInboundStats(r.remoteId,a);else{const l=this.findRemoteStatsId(r.ssrc,Ys.REMOTE_INBOUND);l&&this.processRemoteInboundStats(l,a)}}processAudioOutboundStats(r){let a=this._stats.audioSend.find(s=>s.ssrc===r.ssrc);if(a||(a=dc(Rz),this._stats.audioSend.push(a)),a.ssrc=r.ssrc,a.packets=r.packetsSent,a.bytes=r.bytesSent,a.retransmittedBytesSent=r.retransmittedBytesSent,a.retransmittedPacketsSent=r.retransmittedPacketsSent,r.mediaSourceId&&this.processAudioMediaSource(r.mediaSourceId,a),r.codecId&&(a.codec=this.getCodecFromCodecStats(r.codecId)),this.processAudioTrackSenderStats(r,r.trackId,a),r.remoteId)this.processRemoteInboundStats(r.remoteId,a);else{const s=this.findRemoteStatsId(r.ssrc,Ys.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,a)}}findRemoteStatsId(r,a){var s;const l=Array.from(Cs(s=this.report).call(s)).find(d=>d.type===a&&d.ssrc===r);return l?l.id:null}processVideoMediaSource(r,a){const s=this.report.get(r);s&&s.width&&s.height&&s.framesPerSecond&&(a.inputFrame={width:s.width,height:s.height,frameRate:s.framesPerSecond})}processAudioMediaSource(r,a){const s=this.report.get(r);s&&(a.inputLevel=s.audioLevel)}processVideoTrackSenderStats(r,a,s){var l,d,f,m;const y=a?this.report.get(a):void 0,_=(l=y==null?void 0:y.framesSent)!==null&&l!==void 0?l:r.framesSent;if(typeof _!="number")return;let S=(d=y==null?void 0:y.frameWidth)!==null&&d!==void 0?d:r.frameWidth,x=(f=y==null?void 0:y.frameHeight)!==null&&f!==void 0?f:r.frameHeight,A=(m=y==null?void 0:y.framesPerSecond)!==null&&m!==void 0?m:r.framesPerSecond;if(typeof S=="number"&&typeof x=="number"||(S=0,x=0),A==null){const I=Date.now(),L=this.lastVideoFramesSent.get(s.ssrc);L&&I-L.lts>=800?(A=Math.round((_-L.count)/((I-L.lts)/1e3)),this.lastVideoFramesSent.set(s.ssrc,{count:_,lts:I,rate:A})):L?A=L.rate:this.lastVideoFramesSent.set(s.ssrc,{count:_,lts:I,rate:0})}s.sentFrame={width:S,height:x,frameRate:Math.max(0,A)}}processVideoTrackReceiverStats(r,a,s){var l,d,f,m,y;const _=a?this.report.get(a):void 0,S=(l=_==null?void 0:_.framesReceived)!==null&&l!==void 0?l:r.framesReceived,x=(d=_==null?void 0:_.frameWidth)!==null&&d!==void 0?d:r.frameWidth,A=(f=_==null?void 0:_.frameHeight)!==null&&f!==void 0?f:r.frameHeight,I=(m=_==null?void 0:_.jitterBufferDelay)!==null&&m!==void 0?m:r.jitterBufferDelay,L=(y=_==null?void 0:_.jitterBufferEmittedCount)!==null&&y!==void 0?y:r.jitterBufferEmittedCount;if(typeof S=="number"){const K=this.lastVideoFramesRecv.get(s.ssrc),$=Date.now();s.framesReceivedCount=S;let G=0;K&&$-K.lts>=800?(G=Math.round((S-K.count)/(($-K.lts)/1e3)),this.lastVideoFramesRecv.set(s.ssrc,{count:S,lts:$,rate:G})):K?G=K.rate:this.lastVideoFramesRecv.set(s.ssrc,{count:S,lts:$,rate:0}),s.receivedFrame={width:x||0,height:A||0,frameRate:G||0},s.decodedFrame={width:x||0,height:A||0,frameRate:s.decodeFrameRate||0},s.outputFrame={width:x||0,height:A||0,frameRate:s.outputFrameRate||s.decodeFrameRate||0}}if(I&&L){const K=this.lastVideoJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let $=K.jitterBufferMs;const G=L-K.jitterBufferEmittedCount;G>0&&($=1e3*(I-K.jitterBufferDelay)/G),s.jitterBufferMs=$,s.currentDelayMs=Math.round($),this.lastVideoJBDelay.set(s.ssrc,{jitterBufferDelay:I,jitterBufferEmittedCount:L,jitterBufferMs:s.currentDelayMs})}}processAudioTrackSenderStats(r,a,s){var l,d,f,m;const y=a?this.report.get(a):void 0,_=(l=(d=y==null?void 0:y.echoReturnLoss)!==null&&d!==void 0?d:r.echoReturnLoss)!==null&&l!==void 0?l:0,S=(f=(m=y==null?void 0:y.echoReturnLossEnhancement)!==null&&m!==void 0?m:r.echoReturnLossEnhancement)!==null&&f!==void 0?f:0;s.aecReturnLoss=_,s.aecReturnLossEnhancement=S}processAudioTrackReceiverStats(r,a,s){var l,d,f,m,y,_,S,x,A;const I=a?this.report.get(a):void 0,L=(l=I==null?void 0:I.removedSamplesForAcceleration)!==null&&l!==void 0?l:r.removedSamplesForAcceleration,K=(d=I==null?void 0:I.totalSamplesReceived)!==null&&d!==void 0?d:r.totalSamplesReceived,$=(f=I==null?void 0:I.jitterBufferDelay)!==null&&f!==void 0?f:r.jitterBufferDelay,G=(m=I==null?void 0:I.jitterBufferEmittedCount)!==null&&m!==void 0?m:r.jitterBufferEmittedCount,ne=(y=I==null?void 0:I.audioLevel)!==null&&y!==void 0?y:r==null?void 0:r.audioLevel,te=(_=I==null?void 0:I.totalSamplesDuration)!==null&&_!==void 0?_:r==null?void 0:r.totalSamplesDuration,ce=(S=I==null?void 0:I.concealedSamples)!==null&&S!==void 0?S:r.concealedSamples,pe=(x=I==null?void 0:I.silentConcealedSamples)!==null&&x!==void 0?x:r.silentConcealedSamples,fe=(A=I==null?void 0:I.concealmentEvents)!==null&&A!==void 0?A:r.concealmentEvents;if(typeof K=="number"&&(s.totalSamplesReceived=K),typeof pe=="number"&&(s.silentConcealedSamples=pe),typeof fe=="number"&&(s.concealmentEvents=fe),typeof ce=="number"&&(s.concealedSamples=ce),L&&K&&(s.accelerateRate=L/K),$&&G){const ye=this.lastAudioJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let Se=ye.jitterBufferMs;const Ie=G-ye.jitterBufferEmittedCount;Ie>0&&(Se=1e3*($-ye.jitterBufferDelay)/Ie),s.jitterBufferMs=Math.round(Se),this.lastAudioJBDelay.set(s.ssrc,{jitterBufferDelay:$,jitterBufferEmittedCount:G,jitterBufferMs:s.jitterBufferMs})}s.outputLevel=ne;let ue=1920;te&&K&&(ue=K/te/50,s.receivedFrames=Math.round(K/ue)),ce&&(s.droppedFrames=Math.round(ce/ue))}processRemoteInboundStats(r,a){const s=this.report.get(r);s&&(a.packetsLost=s.packetsLost,s.roundTripTime&&(a.rttMs=1e3*s.roundTripTime),s.jitter&&(a.jitterMs=1e3*s.jitter),s.timestamp&&(a.timestamp=s.timestamp))}getCodecFromCodecStats(r){const a=this.report.get(r);if(!a)return"";const s=a.mimeType.match(/\/(.*)$/);return s&&s[1]?s[1]:""}updateSendBitrate(){let r=0,a=null,s=null;this.mediaBytesSent.forEach(d=>{r+=d.diffMean()}),this.mediaBytesRetransmit.forEach(d=>{a=a===null?d.diffMean():a+d.diffMean()}),this.mediaBytesTargetEncode.forEach(d=>{s=s===null?d.diffMean():s+d.diffMean()});const l=a!==null?r-a:r;this._stats.bitrate={actualEncoded:8*l/(this.options.updateInterval/1e3),transmit:8*r/(this.options.updateInterval/1e3)},a!==null&&(this._stats.bitrate.retransmit=8*a/(this.options.updateInterval/1e3)),s!==null&&(this._stats.bitrate.targetEncoded=8*s/(this.options.updateInterval/1e3))}},M1e=class extends Tj{updateStats(){return He.resolve()}};function Rj(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const f=function(){const m=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return m&&m[0]?Number(m[0].split("/")[1]):null}();return f?f<76?new L1e(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d}):new Az(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d}):function(m){if(!window.RTCStatsReport)return!1;const y=m.getStats();return!!(y instanceof He||function(_){return!!_&&(typeof _=="object"||typeof _=="function")&&typeof _.then=="function"}(y))}(r)?new Az(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d}):new M1e(r,{updateInterval:a,lossRateInterval:s,freezeRateLimit:l,firstVideoDecodedTimeout:d})}const Iz="websdk_ng_install_id";function Nj(){try{if(oe("INSTALL_ID"))return oe("INSTALL_ID");let r=window.localStorage.getItem(Iz);return r||(r=sp(),window.localStorage.setItem(Iz,r)),An("INSTALL_ID",r),r}catch{return}}const xo=function(r){if(r.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return r;const a=r.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(a&&a[1]&&a[2]){const s=a[1],l=a[2];return"".concat(s,".").concat(l)}return"4.0.0.999"}("4.24.0"),Aj=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let op=function(r){return r.Default="default",r.Auto="auto",r.Relay="relay",r.SdRtn="sd-rtn",r}({});const Mi=function(){const r="us".concat("erna","me"),a="pa".concat("sswo","rd"),s=["t","s","t"];s.splice(1,0,"e");const l=s.join(""),d=[];for(let y=0;y<6;y++)d.push("1");const f=d.join(""),m={};return m[r]=l,m[a]=f,Object.assign(m,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Mi;const Zx={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!0,FORCE_ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:1,ENABLE_AUT_FEEDBACK:!0,SVC_EXTENDED:["VP9"]},Ij={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},Oj="v4.24.0-0-gf2267710-dirty(7/31/2025, 7:00:42 PM)",Pj={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!0,NEW_TURN_MODE:4,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1,ENCODE_EXCEPTION_TIMES:5,ENABLE_ENCODE_EXCEPTION:!0,ENCODE_EXCEPTION_VALIDATE_CODEC:["h264"],VIDEO_ENCODER_CONFIG_LIST:[{width:240,height:180},{width:320,height:240},{width:400,height:300},{width:480,height:360},{width:560,height:420},{width:640,height:480}],DELETE_NEQ_AFTER_USER_LEAVE:!0},Zn=Ue(Ue(Ue(Ue({},Pj),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ENABLE_ABSSENDTIME_AS_SENTTS:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],UNSUPPORTED_VIDEO_UPLINK_CODEC:[],UNSUPPORTED_VIDEO_DOWNLINK_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:Ij,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},Zx),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1,ENABLE_PRE_RENDER:!1,FORCE_DISABLE_AUTO_SUB:!1,ENABLE_PRE_SUB_WITH_PRE_PC:!1,PRE_USE_LOCAL_CODECS:!0},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:2,BASELINE_MORE_H264_BITRATE_RATIO:1.1});function An(r,a,s){var l,d,f;Be(l=Object.keys(Zn)).call(l,r)&&(!s&&Be(d=Object.keys(nl)).call(d,r)||(Zn[r]=a,r!=="ENABLE_VIDEO_SEI"&&r!=="ENABLE_AUDIO_TOPN"&&r!=="ENABLE_AUDIO_METADATA"&&r!=="ENABLE_AUDIO_PTS"||a!==!0||(Zn.ENABLE_ENCODED_TRANSFORM=!0),r==="USE_NEW_NETWORK_CONFIG"&&a&&(f=!!a,Zn.USE_NEW_NETWORK_CONFIG=f,f&&(Zn.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],Zn.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],Zn.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],Zn.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],Zn.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",Zn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",Zn.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),r==="ENABLE_PRE_SUB"&&a&&(Zn.ENABLE_INSTANT_VIDEO=!0,Zn.ENABLE_PREALLOC_PC=!0),r==="ENABLE_SVC"&&a&&(Zn.ENABLE_AUT_CC=!0),r==="NEW_FORCE_TURN"&&a&&(Zn.NEW_TURN_MODE||(Zn.NEW_TURN_MODE=4))))}function oe(r){return Zn[r]}Aj||(Zn.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Zn.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Zn.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Zn.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Zn.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Zn.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Zn.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Zn.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Zn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Zn.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Zn.AREAS=["NORTH_AMERICA","OVERSEA"]);let Oz=function(r){return r[r.REALTIME=1]="REALTIME",r}({});const nl={};var Lt=function(r){return r.SET_SESSION_ID="SET_SESSION_ID",r.SET_P2P_ID="SET_P2P_id",r.SET_DC_ID="SET_DC_id",r.SET_UID="SET_UID",r.SET_INT_UID="SET_INT_UID",r.SET_PUB_ID="SET_PUB_ID",r.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",r.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",r.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",r.KEY_METRIC_PRELOAD_START="KEY_METRIC_PRELOAD_START",r.KEY_METRIC_PRELOAD_END="KEY_METRIC_PRELOAD_END",r.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",r.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",r.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",r.KEY_METRIC_REQUEST_SUA_END="KEY_METRIC_REQUEST_SUA_END",r.KEY_METRIC_BEFORE_CONNECT="KEY_METRIC_BEFORE_CONNECT",r.KEY_METRIC_PEER_RECEIVER="KEY_METRIC_PEER_RECEIVER",r.KEY_METRIC_SIGNAL_CONNECTED="KEY_METRIC_SIGNAL_CONNECTED",r.KEY_METRIC_JOIN_REQ="KEY_METRIC_JOIN_REQ",r.KEY_METRIC_JOIN_REP="KEY_METRIC_JOIN_REP",r.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",r.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",r.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",r.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",r.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED="KEY_METRIC_FIRST_VIDEO_FRAME_DECODED",r.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",r.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",r.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",r.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",r.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",r.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",r.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",r.RESET_KEY_METRICS="RESET_KEY_METRICS",r.RESET_FIRST_VIDEO_FRAME_DECODED="RESET_FIRST_VIDEO_FRAME_DECODED",r.SET_USE_P2P="SET_USE_P2P",r.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",r}(Lt||{});let fb=function(r){return r.h264="h264",r.h265="h265",r.vp8="vp8",r.vp9="vp9",r.av1="av1",r}({});(function(r){r.opus="opus",r.pcma="pcma",r.pcmu="pcmu",r.g722="g722"})({});const Pz=128,U1e=96,kz=1e3,Eg=10;let F1e=0;var jz=(()=>{var r={8:(l,d,f)=>{f.r(d),f.d(d,{Parser:()=>Ie,Printer:()=>bn,parse:()=>Ve,print:()=>Ze});const m=`
`,y="".concat("\r").concat(m),_=" ";let S;function x(Oe){return Oe>="0"&&Oe<="9"}function A(Oe){return Oe>="!"&&Oe<="~"}function I(Oe){return A(Oe)||Oe>=""&&Oe<="ÿ"}function L(Oe){return Oe==="!"||Oe>="#"&&Oe<="'"||Oe>="*"&&Oe<="+"||Oe>="-"&&Oe<="."||Oe>="0"&&Oe<="9"||Oe>="A"&&Oe<="Z"||Oe>="^"&&Oe<="~"}function K(Oe){return Oe>="1"&&Oe<="9"}function $(Oe){return Oe>="A"&&Oe<="Z"||Oe>="a"&&Oe<="z"}function G(Oe){return Oe==="d"||Oe==="h"||Oe==="m"||Oe==="s"}function ne(Oe){return Oe>""&&Oe<"	"||Oe>"\v"&&Oe<"\f"||Oe>""&&Oe<"ÿ"}function te(Oe){return $(Oe)||x(Oe)||Oe==="+"||Oe==="/"}function ce(Oe){return x(Oe)||$(Oe)||Oe==="+"||Oe==="/"||Oe==="-"||Oe==="_"}function pe(Oe){return $(Oe)||x(Oe)||Oe==="+"||Oe==="/"}function fe(Oe,B){var le=Object.keys(Oe);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols(Oe);B&&(he=he.filter(function(Fe){return Object.getOwnPropertyDescriptor(Oe,Fe).enumerable})),le.push.apply(le,he)}return le}function ue(Oe){for(var B=1;B<arguments.length;B++){var le=arguments[B]!=null?arguments[B]:{};B%2?fe(Object(le),!0).forEach(function(he){ye(Oe,he,le[he])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Oe,Object.getOwnPropertyDescriptors(le)):fe(Object(le)).forEach(function(he){Object.defineProperty(Oe,he,Object.getOwnPropertyDescriptor(le,he))})}return Oe}function ye(Oe,B,le){return B in Oe?Object.defineProperty(Oe,B,{value:le,enumerable:!0,configurable:!0,writable:!0}):Oe[B]=le,Oe}(function(Oe){Oe.VERSION="v",Oe.ORIGIN="o",Oe.SESSION_NAME="s",Oe.INFORMATION="i",Oe.URI="u",Oe.EMAIL="e",Oe.PHONE="p",Oe.CONNECTION="c",Oe.BANDWIDTH="b",Oe.TIME="t",Oe.REPEAT="r",Oe.ZONE_ADJUSTMENTS="z",Oe.KEY="k",Oe.ATTRIBUTE="a",Oe.MEDIA="m"})(S||(S={}));class Se{consumeText(B,le){let he=le;for(;he<B.length;){const Fe=B[he];if(Fe==="\0"||Fe==="\r"||Fe===m)break;he+=1}if(he-le==0)throw new Error("Invalid text, at ".concat(B));return he}consumeUnicastAddress(B,le,he){return this.consumeTill(B,le,_)}consumeOneOrMore(B,le,he){let Fe=le;for(;he(B[Fe]);)Fe++;if(Fe-le==0)throw new Error("Invalid rule at ".concat(le,"."));return Fe}consumeSpace(B,le){if(B[le]===_)return le+1;throw new Error("Invalid space at ".concat(le,"."))}consumeIP4Address(B,le){let he=le;for(let Fe=0;Fe<4;Fe++)if(he=this.consumeDecimalUChar(B,he),Fe!==3){if(B[he]!==".")throw new Error("Invalid IP4 address.");he++}return he}consumeDecimalUChar(B,le){let he=le;for(let Vt=0;Vt<3&&x(B[he]);Vt++,he++);if(he-le==0)throw new Error("Invalid decimal uchar.");const Fe=parseInt(B.slice(le,he));if(Fe>=0&&Fe<=255)return he;throw new Error("Invalid decimal uchar")}consumeIP6Address(B,le){let he=this.consumeHexpart(B,le);return B[he]===":"&&(he+=1,he=this.consumeIP4Address(B,he)),he}consumeHexpart(B,le){let he=le;if(B[he]===":"&&B[he+1]===":"){he+=2;try{he=this.consumeHexseq(B,he)}catch{}return he}if(he=this.consumeHexseq(B,he),B[he]===":"&&B[he+1]===":"){he+=2;try{he=this.consumeHexseq(B,he)}catch{}return he}return he}consumeHexseq(B,le){let he=le;for(;he=this.consumeHex4(B,he),B[he]===":"&&B[he+1]!==":";)he+=1;return he}consumeHex4(B,le){let he=0;for(;he<4;he++)if(!((Fe=B[le+he])>="0"&&Fe<="9"||Fe>="a"&&Fe<="f"||Fe>="A"&&Fe<="F")){if(he===0)throw new Error("Invalid hex 4");break}var Fe;return le+he}consumeFQDN(B,le){let he=le;for(;x(B[he])||$(B[he])||B[he]==="-"||B[he]===".";)he+=1;if(he-le<4)throw new Error("Invalid FQDN");return he}consumeExtnAddr(B,le){return this.consumeOneOrMore(B,le,I)}consumeMulticastAddress(B,le,he){switch(he){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(B,le);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(B,le);default:try{return this.consumeFQDN(B,le)}catch{return this.consumeExtnAddr(B,le)}}}consumeIP6MulticastAddress(B,le){const he=this.consumeHexpart(B,le);return B[he]==="/"?this.consumeInteger(B,he+1):he}consumeIP4MulticastAddress(B,le){let he=le+3;const Fe=B.slice(le,he),Vt=parseInt(Fe);if(Vt<224||Vt>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Vn=0;Vn<3;Vn++){if(B[he]!==".")throw new Error("Invalid IP4 multicast address.");he+=1,he=this.consumeDecimalUChar(B,he)}return B[he]==="/"&&(he+=1),he=this.consumeTTL(B,he),B[he]==="/"&&(he=this.consumeInteger(B,he)),he}consumeInteger(B,le){if(!K(B[le]))throw new Error("Invalid integer.");for(le+=1;x(B[le]);)le+=1;return le}consumeTTL(B,le){if(B[le]==="0")return le+1;if(!K(B[le]))throw new Error("Invalid TTL.");le+=1;for(let he=0;he<2&&x(B[le]);he++)le+=1;return le}consumeToken(B,le){return this.consumeOneOrMore(B,le,L)}consumeTime(B,le){let he=le;if(B[he]==="0")return he+1;for(K(B[he])&&(he+=1);x(B[he]);)he++;if(he-le<10)throw new Error("Invalid time");return he}consumeAddress(B,le){return this.consumeTill(B,le,_)}consumeTypedTime(B,le){let he=le;return he=this.consumeOneOrMore(B,he,x),G(B[he])?he+1:he}consumeRepeatInterval(B,le){if(!K(B[le]))throw new Error("Invalid repeat interval");for(le+=1;x(B[le]);)le+=1;return G(B[le])&&(le+=1),le}consumePort(B,le){return this.consumeOneOrMore(B,le,x)}consume(B,le,he){for(let Fe=0;Fe<he.length;Fe++){if(le+Fe>=B.length)throw new Error("consume exceeding value length");if(B[le+Fe]!==he[Fe])throw new Error("consume ".concat(he," failed at ").concat(Fe))}return le+he.length}consumeTill(B,le,he){let Fe=le;for(;Fe<B.length&&(typeof he!="string"||B[Fe]!==he)&&(typeof he!="function"||!he(B[Fe]));)Fe++;return Fe}}class Ie extends Se{constructor(){super(),ye(this,"records",[]),ye(this,"currentLine",0)}parse(B){const le=this.probeEOL(B);this.records=B.split(le).filter(fd=>!!Ea(fd).call(fd)).map(this.parseLine),this.currentLine=0;const he=this.parseVersion(),Fe=this.parseOrigin(),Vt=this.parseSessionName(),Vn=this.parseInformation(),Jr=this.parseUri(),ko=this.parseEmail(),Sc=this.parsePhone(),Jb=this.parseConnection(),Rp=this.parseBandWidth(),Qg=this.parseTimeFields(),hC=this.parseKey(),fC=this.parseSessionAttribute(),jo=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:he,origin:Fe,sessionName:Vt,information:Vn,uri:Jr,emails:ko,phones:Sc,connection:Jb,bandwidths:Rp,timeFields:Qg,key:hC,attributes:fC,mediaDescriptions:jo}}getCurrentRecord(){const B=this.records[this.currentLine];if(!B)throw new Error("Record doesn't exit.");return B}probeEOL(B){for(let le=0;le<B.length;le++)if(B[le]===m)return B[le-1]==="\r"?y:m;throw new Error("Invalid newline character.")}parseLine(B,le){if(B.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const he=B[0];if(B[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:he,value:B.slice(2),line:le,cur:0}}parseSessionAttribute(){const B=new Gt;for(;this.currentLine<this.records.length;){const le=this.getCurrentRecord();if(le.type!==S.ATTRIBUTE)break;const he={attField:this.extractOneOrMore(le,Fe=>L(Fe)&&Fe!==":"),_cur:0};le.value[le.cur]===":"&&(le.cur+=1,he.attValue=this.extractOneOrMore(le,ne)),B.parse(he),this.currentLine++}return B.digest()}parseMediaAttributes(B){const le=new Kt(B);for(;this.currentLine<this.records.length;){const he=this.getCurrentRecord();if(he.type!==S.ATTRIBUTE)break;const Fe={attField:this.extractOneOrMore(he,Vt=>L(Vt)&&Vt!==":"),_cur:0};he.value[he.cur]===":"&&(he.cur+=1,Fe.attValue=this.extractOneOrMore(he,ne)),le.parse(Fe),this.currentLine++}return le.digest()}parseKey(){const B=this.getCurrentRecord();if(B.type===S.KEY){if(B.value==="prompt"||B.value==="clear:"||B.value==="base64:"||B.value==="uri:")return B.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const B=this.getCurrentRecord();if(B.type===S.ZONE_ADJUSTMENTS){const le=[];for(;;)try{const he=this.extract(B,this.consumeTime);this.consumeSpaceForRecord(B);let Fe=!1;B.value[B.cur]==="-"&&(Fe=!0,B.cur+=1);const Vt=this.extract(B,this.consumeTypedTime);le.push({time:he,typedTime:Vt,back:Fe})}catch{break}if(le.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,le}return[]}parseRepeat(){const B=[];for(;;){const le=this.getCurrentRecord();if(le.type!==S.REPEAT)break;{const he=this.extract(le,this.consumeRepeatInterval),Fe=this.parseTypedTime(le);B.push({repeatInterval:he,typedTimes:Fe}),this.currentLine++}}return B}parseTypedTime(B){const le=[];for(;;)try{this.consumeSpaceForRecord(B),le.push(this.extract(B,this.consumeTypedTime))}catch{break}if(le.length===0)throw new Error("Invalid typed time.");return le}parseTime(){const B=this.getCurrentRecord(),le=this.extract(B,this.consumeTime);this.consumeSpaceForRecord(B);const he=this.extract(B,this.consumeTime);return this.currentLine++,{startTime:le,stopTime:he}}parseBandWidth(){const B=[];for(;this.currentLine<this.records.length;){const le=this.getCurrentRecord();if(le.type!==S.BANDWIDTH)break;{const he=this.extractOneOrMore(le,L);if(le.value[le.cur]!==":")throw new Error("Invalid bandwidth field.");le.cur++;const Fe=this.extractOneOrMore(le,x);B.push({bwtype:he,bandwidth:Fe}),this.currentLine++}}return B}parseVersion(){const B=this.getCurrentRecord();if(B.type!==S.VERSION)throw new Error("first sdp record must be version");const le=B.value.slice(0,this.consumeOneOrMore(B.value,0,x));if(le.length!==B.value.length)throw new Error('invalid proto version, "v='.concat(B.value,'"'));return this.currentLine++,le}parseOrigin(){const B=this.getCurrentRecord();if(B.type!==S.ORIGIN)throw new Error("second line of sdp must be origin");const le=this.extractOneOrMore(B,I);this.consumeSpaceForRecord(B);const he=this.extractOneOrMore(B,x);this.consumeSpaceForRecord(B);const Fe=this.extractOneOrMore(B,x);this.consumeSpaceForRecord(B);const Vt=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const Vn=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const Jr=this.extract(B,this.consumeUnicastAddress);return this.currentLine++,{username:le,sessId:he,sessVersion:Fe,nettype:Vt,addrtype:Vn,unicastAddress:Jr}}parseSessionName(){const B=this.getCurrentRecord();if(B.type===S.SESSION_NAME){const le=this.extract(B,this.consumeText);return this.currentLine++,le}}parseInformation(){const B=this.getCurrentRecord();if(B.type!==S.INFORMATION)return;const le=this.extract(B,this.consumeText);return this.currentLine++,le}parseUri(){const B=this.getCurrentRecord();if(B.type===S.URI)return this.currentLine++,B.value}parseEmail(){const B=[];for(;;){const le=this.getCurrentRecord();if(le.type!==S.EMAIL)break;B.push(le.value),this.currentLine++}return B}parsePhone(){const B=[];for(;;){const le=this.getCurrentRecord();if(le.type!==S.PHONE)break;B.push(le.value),this.currentLine++}return B}parseConnection(){const B=this.getCurrentRecord();if(B.type===S.CONNECTION){const le=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const he=this.extractOneOrMore(B,L);this.consumeSpaceForRecord(B);const Fe=this.extract(B,this.consumeAddress);return this.currentLine++,{nettype:le,addrtype:he,address:Fe}}}parseMedia(){const B=this.getCurrentRecord(),le=this.extract(B,this.consumeToken);this.consumeSpaceForRecord(B);let he=this.extract(B,this.consumePort);B.value[B.cur]==="/"&&(B.cur+=1,he+=this.extract(B,this.consumeInteger)),this.consumeSpaceForRecord(B);const Fe=[];for(Fe.push(this.extract(B,this.consumeToken));B.value[B.cur]==="/";)B.cur+=1,Fe.push(this.extract(B,this.consumeToken));if(Fe.length===0)throw new Error("Invalid proto");const Vt=this.parseFmt(B);return this.currentLine++,{mediaType:le,port:he,protos:Fe,fmts:Vt}}parseTimeFields(){const B=[];for(;this.getCurrentRecord().type===S.TIME;){const le=this.parseTime(),he=this.parseRepeat(),Fe=this.parseZone();B.push({time:le,repeats:he,zones:Fe})}return B}parseMediaDescription(){const B=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===S.MEDIA;){const le=this.parseMedia(),he=this.parseInformation(),Fe=this.parseConnections(),Vt=this.parseBandWidth(),Vn=this.parseKey(),Jr=this.parseMediaAttributes(le);B.push({media:le,information:he,connections:Fe,bandwidths:Vt,key:Vn,attributes:Jr})}return B}parseConnections(){const B=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===S.CONNECTION;)B.push(this.parseConnection());return B}parseFmt(B){const le=[];for(;;)try{this.consumeSpaceForRecord(B),le.push(this.extract(B,this.consumeToken))}catch{break}if(le.length===0)throw new Error("Invalid fmts");return le}extract(B,le){for(var he=arguments.length,Fe=new Array(he>2?he-2:0),Vt=2;Vt<he;Vt++)Fe[Vt-2]=arguments[Vt];const Vn=le.call(this,B.value,B.cur,...Fe),Jr=B.value.slice(B.cur,Vn);return B.cur=Vn,Jr}extractOneOrMore(B,le){const he=this.consumeOneOrMore(B.value,B.cur,le),Fe=B.value.slice(B.cur,he);return B.cur=he,Fe}consumeSpaceForRecord(B){if(B.value[B.cur]!==_)throw new Error("Invalid space at ".concat(B.cur,"."));B.cur+=1}}class Me extends Se{constructor(){super(...arguments),ye(this,"attributes",void 0),ye(this,"digested",!1)}extractOneOrMore(B,le,he){const Fe=this.consumeOneOrMore(B.attValue,B._cur,le),Vt=B.attValue.slice(B._cur,Fe),[Vn,Jr]=he||[];if(typeof Vn=="number"&&Vt.length<Vn)throw new Error("error in length, should be more or equal than ".concat(Vn," characters."));if(typeof Jr=="number"&&Vt.length>Jr)throw new Error("error in length, should be less or equal than ".concat(Jr," characters."));return B._cur=Fe,Vt}consumeAttributeSpace(B){if(B.attValue[B._cur]!==_)throw new Error("Invalid space at ".concat(B._cur,"."));B._cur+=1}extract(B,le){if(!B.attValue)throw new Error("Nothing to extract from attValue.");for(var he=arguments.length,Fe=new Array(he>2?he-2:0),Vt=2;Vt<he;Vt++)Fe[Vt-2]=arguments[Vt];const Vn=le.call(this,B.attValue,B._cur,...Fe),Jr=B.attValue.slice(B._cur,Vn);return B._cur=Vn,Jr}atEnd(B){if(!B.attValue)throw new Error;return B._cur>=B.attValue.length}peekChar(B){if(!B.attValue)throw new Error;return B.attValue[B._cur]}peek(B,le){if(!B.attValue)throw new Error;for(let he=0;he<le.length;he++)if(le[he]!==B.attValue[B._cur+he])return!1;return!0}parseIceUfrag(B){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(B,te,[4,256])}parseIcePwd(B){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(B,te,[22,256])}parseIceOptions(B){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const le=[];for(;!this.atEnd(B);){le.push(this.extractOneOrMore(B,te));try{this.consumeAttributeSpace(B)}catch(he){if(this.atEnd(B))break;throw he}}this.attributes.iceOptions=le}parseFingerprint(B){const le=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill);this.attributes.fingerprints.push({hashFunction:le,fingerprint:he})}parseExtmap(B){const le=this.extractOneOrMore(B,x);let he;this.peekChar(B)==="/"&&(this.extract(B,this.consume,"/"),he=this.extract(B,this.consumeToken)),this.consumeAttributeSpace(B);const Fe=this.extract(B,this.consumeTill,_),Vt=ue(ue({entry:parseInt(le,10)},he&&{direction:he}),{},{extensionName:Fe});this.peekChar(B)===_&&(this.consumeAttributeSpace(B),Vt.extensionAttributes=this.extract(B,this.consumeTill)),this.attributes.extmaps.push(Vt)}parseSetup(B){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const le=this.extract(B,this.consumeTill);if(le!=="active"&&le!=="passive"&&le!=="actpass"&&le!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=le}}class Gt extends Me{constructor(){super(...arguments),ye(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(B){if(this.digested)throw new Error("already digested");try{switch(B.attField){case"group":this.parseGroup(B);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(B);break;case"ice-pwd":this.parseIcePwd(B);break;case"ice-options":this.parseIceOptions(B);break;case"fingerprint":this.parseFingerprint(B);break;case"setup":this.parseSetup(B);break;case"tls-id":this.parseTlsId(B);break;case"identity":this.parseIdentity(B);break;case"extmap":this.parseExtmap(B);break;case"msid-semantic":this.parseMsidSemantic(B);break;default:B.ignored=!0,this.attributes.unrecognized.push(B)}}catch(le){throw console.error("parsing session attribute ".concat(B.attField,' error, "a=').concat(B.attField,":").concat(B.attValue,'"')),le}if(!B.ignored&&B.attValue&&!this.atEnd(B))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(B){const le=this.extract(B,this.consumeToken),he=[];for(;!this.atEnd(B)&&this.peekChar(B)===_;)this.consumeAttributeSpace(B),he.push(this.extract(B,this.consumeToken));this.attributes.groups.push({semantic:le,identificationTag:he})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(B){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(B,ce)}parseIdentity(B){const le=this.extractOneOrMore(B,pe),he=[];for(;!this.atEnd(B)&&this.peekChar(B)===_;){this.consumeAttributeSpace(B);const Fe=this.extract(B,this.consumeToken);this.extract(B,this.consume,"=");const Vt=this.extractOneOrMore(B,Vn=>Vn!==_&&ne(Vn));he.push({name:Fe,value:Vt})}this.attributes.identities.push({assertionValue:le,extensions:he})}parseMsidSemantic(B){this.peekChar(B)===_&&this.consumeAttributeSpace(B);const le={semantic:this.extract(B,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(B)}catch{break}if(this.peekChar(B)==="*"){this.extract(B,this.consume,"*"),le.applyForAll=!0;break}{const he=this.extract(B,this.consumeTill,_);le.identifierList.push(he)}}this.attributes.msidSemantic=le}}class Kt extends Me{constructor(B){super(),ye(this,"attributes",void 0),B.protos.indexOf("RTP")!==-1||B.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(B){if(this.digested)throw new Error("already digested");try{switch(B.attField){case"extmap":this.parseExtmap(B);break;case"setup":this.parseSetup(B);break;case"ice-ufrag":this.parseIceUfrag(B);break;case"ice-pwd":this.parseIcePwd(B);break;case"ice-options":this.parseIceOptions(B);break;case"candidate":this.parseCandidate(B);break;case"remote-candidate":this.parseRemoteCandidate(B);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(B);break;case"rtpmap":this.parseRtpmap(B);break;case"ptime":this.parsePtime(B);break;case"maxptime":this.parseMaxPtime(B);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(B);break;case"ssrc":this.parseSSRC(B);break;case"fmtp":this.parseFmtp(B);break;case"rtcp-fb":this.parseRtcpFb(B);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(B);break;case"mid":this.parseMid(B);break;case"msid":this.parseMsid(B);break;case"imageattr":this.parseImageAttr(B);break;case"rid":this.parseRid(B);break;case"simulcast":this.parseSimulcast(B);break;case"sctp-port":this.parseSctpPort(B);break;case"max-message-size":this.parseMaxMessageSize(B);break;case"ssrc-group":this.parseSSRCGroup(B);break;default:B.ignored=!0,this.attributes.unrecognized.push(B)}}catch(le){throw console.error("parsing media attribute ".concat(B.attField,' error, "a=').concat(B.attField,":").concat(B.attValue,'"')),le}if(!B.ignored&&B.attValue&&!this.atEnd(B))throw new Error("attribute parsing error")}parseCandidate(B){const le=this.extractOneOrMore(B,te,[1,32]);this.consumeAttributeSpace(B);const he=this.extractOneOrMore(B,x,[1,5]);this.consumeAttributeSpace(B);const Fe=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const Vt=this.extractOneOrMore(B,x,[1,10]);this.consumeAttributeSpace(B);const Vn=this.extract(B,this.consumeAddress);this.consumeAttributeSpace(B);const Jr=this.extract(B,this.consumePort);this.consumeAttributeSpace(B),this.extract(B,this.consume,"typ"),this.consumeAttributeSpace(B);const ko={foundation:le,componentId:he,transport:Fe,priority:Vt,connectionAddress:Vn,port:Jr,type:this.extract(B,this.consumeToken),extension:{}};for(this.peek(B," raddr")&&(this.extract(B,this.consume," raddr"),this.consumeAttributeSpace(B),ko.relAddr=this.extract(B,this.consumeAddress)),this.peek(B," rport")&&(this.extract(B,this.consume," rport"),this.consumeAttributeSpace(B),ko.relPort=this.extract(B,this.consumePort));this.peekChar(B)===_;){this.consumeAttributeSpace(B);const Sc=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B),ko.extension[Sc]=this.extractOneOrMore(B,A)}this.attributes.candidates.push(ko)}parseRemoteCandidate(B){const le=[];for(;;){const he=this.extractOneOrMore(B,x,[1,5]);this.consumeAttributeSpace(B);const Fe=this.extract(B,this.consumeAddress);this.consumeAttributeSpace(B);const Vt=this.extract(B,this.consumePort);le.push({componentId:he,connectionAddress:Fe,port:Vt});try{this.consumeAttributeSpace(B)}catch{break}}this.attributes.remoteCandidatesList.push(le)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(B){const le=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill,"/");this.extract(B,this.consume,"/");const Fe={encodingName:he,clockRate:this.extractOneOrMore(B,x)};this.atEnd(B)||this.peekChar(B)!=="/"||(this.extract(B,this.consume,"/"),Fe.encodingParameters=parseInt(this.extract(B,this.consumeTill),10));const Vt=this.attributes.payloads.find(Vn=>Vn.payloadType===parseInt(le,10));Vt?Vt.rtpMap=Fe:this.attributes.payloads.push({payloadType:parseInt(le,10),rtpMap:Fe,rtcpFeedbacks:[]})}parsePtime(B){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(B,this.consumeTill)}parseMaxPtime(B){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(B,this.consumeTill)}parseDirection(B){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=B.attField}parseSSRC(B){const le=this.extractOneOrMore(B,x);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill,":");let Fe;this.peekChar(B)===":"&&(this.extract(B,this.consume,":"),Fe=this.extract(B,this.consumeTill));const Vt=this.attributes.ssrcs.find(Vn=>Vn.ssrcId===parseInt(le,10));Vt?Vt.attributes[he]=Fe:this.attributes.ssrcs.push({ssrcId:parseInt(le,10),attributes:{[he]:Fe}})}parseFmtp(B){const le=this.extract(B,this.consumeTill,_);this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill),Fe={};he.split(";").forEach(Vn=>{let[Jr,ko]=Vn.split("=");Jr=Ea(Jr).call(Jr);const Sc=typeof ko=="string"?Ea(ko).call(ko):null;typeof Jr=="string"&&Jr.length>0&&(Fe[Jr]=Sc)});const Vt=this.attributes.payloads.find(Vn=>Vn.payloadType===parseInt(le,10));Vt?Vt.fmtp={parameters:Fe}:this.attributes.payloads.push({payloadType:parseInt(le,10),rtcpFeedbacks:[],fmtp:{parameters:Fe}})}parseFmtParameters(B){const le={},he=this.extract(B,this.consumeTill,"=");B._cur++;const Fe=this.extract(B,this.consumeTill,";");for(le[he]=Fe;B.attValue[B._cur]===";";){const Vt=this.extract(B,this.consumeTill,"=");B._cur++;const Vn=this.extract(B,this.consumeTill,";");le[Vt]=Vn}return le}parseRtcpFb(B){let le="";le=this.peekChar(B)==="*"?this.extract(B,this.consume,"*"):this.extract(B,this.consumeTill,_),this.consumeAttributeSpace(B);const he=this.extract(B,this.consumeTill,_);let Fe;if(he==="trr-int")Fe={type:he,interval:this.extract(B,this.consumeTill)};else{const Vt={type:he};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),Vt.parameter=this.extract(B,this.consumeToken),this.peekChar(B)===_&&(Vt.additional=this.extract(B,this.consumeTill))),Fe=Vt}if(le==="*")this.attributes.rtcpFeedbackWildcards.push(Fe);else{const Vt=this.attributes.payloads.find(Vn=>Vn.payloadType===parseInt(le,10));Vt?Vt.rtcpFeedbacks.push(Fe):this.attributes.payloads.push({payloadType:parseInt(le,10),rtcpFeedbacks:[Fe]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(B){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const le={port:this.extract(B,this.consumePort)};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),le.netType=this.extractOneOrMore(B,L),this.consumeAttributeSpace(B),le.addressType=this.extractOneOrMore(B,L),this.consumeAttributeSpace(B),le.address=this.extract(B,this.consumeAddress)),this.attributes.rtcp=le}parseMsid(B){const le={id:this.extractOneOrMore(B,L,[1,64])};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),le.appdata=this.extractOneOrMore(B,L,[1,64])),this.attributes.msids.push(le)}parseImageAttr(B){this.attributes.imageattr.push(B.attValue)}parseRid(B){const le=this.extractOneOrMore(B,Fe=>$(Fe)||x(Fe)||Fe==="_"||Fe==="-");this.consumeAttributeSpace(B);const he={id:le,direction:this.extract(B,this.consumeToken),params:[]};if(this.peekChar(B)===_){if(this.consumeAttributeSpace(B),this.peek(B,"pt=")){this.extract(B,this.consume,"pt=");const Fe=[];for(;;){const Vt=this.extract(B,this.consumeToken);Fe.push(Vt);try{this.extract(B,this.consume,",")}catch{break}}he.payloads=Fe,this.peekChar(B)===_&&this.extract(B,this.consume,_)}for(;;){const Fe=this.extract(B,this.consumeToken);switch(Fe){case"depend":{const Vt={type:Fe,rids:this.extract(B,this.consume,"=").split(",")};he.params.push(Vt);break}default:{const Vt={type:Fe};this.peekChar(B)==="="&&(this.extract(B,this.consume,"="),Vt.val=this.extract(B,this.consumeTill,";")),he.params.push(Vt)}}try{this.extract(B,this.consume,";")}catch{break}}}this.attributes.rids.push(he)}parseSimulcast(B){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=B.attValue,this.extract(B,this.consumeTill)}parseSctpPort(B){this.attributes.sctpPort=this.extractOneOrMore(B,x,[1,5])}parseMaxMessageSize(B){this.attributes.maxMessageSize=this.extractOneOrMore(B,x,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(B){this.attributes.mid=this.extract(B,this.consumeToken)}parseSSRCGroup(B){const le=this.extract(B,this.consumeToken),he=[];for(;;)try{this.consumeAttributeSpace(B);const Fe=this.extract(B,this.consumeInteger);he.push(parseInt(Fe,10))}catch{break}this.attributes.ssrcGroups.push({semantic:le,ssrcIds:he})}}function Nt(Oe,B,le){return B in Oe?Object.defineProperty(Oe,B,{value:le,enumerable:!0,configurable:!0,writable:!0}):Oe[B]=le,Oe}class bn{constructor(){Nt(this,"eol",y)}print(B,le){let he="";return le&&(this.eol=le),he+=this.printVersion(B.version),he+=this.printOrigin(B.origin),he+=this.printSessionName(B.sessionName),he+=this.printInformation(B.information),he+=this.printUri(B.uri),he+=this.printEmail(B.emails),he+=this.printPhone(B.phones),he+=this.printConnection(B.connection),he+=this.printBandwidth(B.bandwidths),he+=this.printTimeFields(B.timeFields),he+=this.printKey(B.key),he+=this.printSessionAttributes(B.attributes),he+=this.printMediaDescription(B.mediaDescriptions),he}printVersion(B){return"v=".concat(B).concat(this.eol)}printOrigin(B){return"o=".concat(B.username," ").concat(B.sessId," ").concat(B.sessVersion," ").concat(B.nettype," ").concat(B.addrtype," ").concat(B.unicastAddress).concat(this.eol)}printSessionName(B){return B?"s=".concat(B).concat(this.eol):""}printInformation(B){return B?"i=".concat(B).concat(this.eol):""}printUri(B){return B?"u=".concat(B).concat(this.eol):""}printEmail(B){let le="";for(const he of B)le+="e=".concat(he).concat(this.eol);return le}printPhone(B){let le="";for(const he of B)le+="e=".concat(he).concat(this.eol);return le}printConnection(B){return B?"c=".concat(B.nettype," ").concat(B.addrtype," ").concat(B.address).concat(this.eol):""}printBandwidth(B){let le="";for(const he of B)le+="b=".concat(he.bwtype,":").concat(he.bandwidth).concat(this.eol);return le}printTimeFields(B){let le="";for(const he of B){le+="t=".concat(he.time.startTime," ").concat(he.time.startTime).concat(this.eol);for(const Fe of he.repeats)le+="r=".concat(Fe.repeatInterval," ").concat(Fe.typedTimes.join(" ")).concat(this.eol);he.zoneAdjustments&&(le+="z=",le+="z=".concat(he.zoneAdjustments.map(Fe=>"".concat(Fe.time," ").concat(Fe.back?"-":""," ").concat(Fe.typedTime)).join(" ")).concat(this.eol),le+=this.eol)}return le}printKey(B){return B?"k=".concat(B).concat(this.eol):""}printAttributes(B){let le="";for(const he of B)le+="a=".concat(he.attField).concat(he.attValue?":".concat(he.attValue):"").concat(this.eol);return le}printMediaDescription(B){let le="";for(const he of B)le+=this.printMedia(he.media),le+=this.printInformation(he.information),le+=this.printConnections(he.connections),le+=this.printBandwidth(he.bandwidths),le+=this.printKey(he.key),le+=this.printMediaAttributes(he);return le}printConnections(B){let le="";for(const he of B)le+=this.printConnection(he);return le}printMedia(B){return"m=".concat(B.mediaType," ").concat(B.port," ").concat(B.protos.join("/")," ").concat(B.fmts.join(" ")).concat(this.eol)}printSessionAttributes(B){return new Xi(this.eol).print(B)}printMediaAttributes(B){return new Re(this.eol).print(B)}}class vn{constructor(B){Nt(this,"eol",void 0),this.eol=B}printIceUfrag(B){return B===void 0?"":"a=ice-ufrag:".concat(B).concat(this.eol)}printIcePwd(B){return B===void 0?"":"a=ice-pwd:".concat(B).concat(this.eol)}printIceOptions(B){return B===void 0?"":"a=ice-options:".concat(B.join(_)).concat(this.eol)}printFingerprints(B){return B.length>0?B.map(le=>"a=fingerprint:".concat(le.hashFunction).concat(_).concat(le.fingerprint)).join(this.eol)+this.eol:""}printExtmap(B){return B.map(le=>"a=extmap:".concat(le.entry).concat(le.direction?"/".concat(le.direction):"").concat(_).concat(le.extensionName).concat(le.extensionAttributes?"".concat(_).concat(le.extensionAttributes):"").concat(this.eol)).join("")}printSetup(B){return B===void 0?"":"a=setup:".concat(B).concat(this.eol)}printUnrecognized(B){return B.map(le=>"a=".concat(le.attField).concat(le.attValue?":".concat(le.attValue):"").concat(this.eol)).join("")}}class Xi extends vn{print(B){let le="";return le+=this.printGroups(B.groups),le+=this.printMsidSemantic(B.msidSemantic),le+=this.printIceLite(B.iceLite),le+=this.printIceUfrag(B.iceUfrag),le+=this.printIcePwd(B.icePwd),le+=this.printIceOptions(B.iceOptions),le+=this.printFingerprints(B.fingerprints),le+=this.printSetup(B.setup),le+=this.printTlsId(B.tlsId),le+=this.printIdentity(B.identities),le+=this.printExtmap(B.extmaps),le+=this.printUnrecognized(B.unrecognized),le}printGroups(B){let le="";return B.length>0&&(le+=B.map(he=>"a=group:".concat(he.semantic).concat(he.identificationTag.map(Fe=>"".concat(_).concat(Fe)).join("")).concat(this.eol)).join("")),le}printIceLite(B){return B===void 0?"":"a=ice-lite"+this.eol}printTlsId(B){return B?"a=tls-id:".concat(B).concat(this.eol):""}printIdentity(B){return B.length===0?"":B.map(le=>"a=identity:".concat(le.assertionValue).concat(le.extensions.map(he=>"".concat(_).concat(he.name).concat(he.value?"=".concat(he.value):"")))).join(this.eol)+this.eol}printMsidSemantic(B){if(!B)return"";let le="a=msid-semantic:".concat(B.semantic);return B.applyForAll?le+="".concat(_,"*"):B.identifierList.length>0&&(le+=B.identifierList.map(he=>"".concat(_).concat(he))),le+this.eol}}class Re extends vn{print(B){const le=B.attributes;let he="";return he+=this.printRTCP(le.rtcp),he+=this.printIceUfrag(le.iceUfrag),he+=this.printIcePwd(le.icePwd),he+=this.printIceOptions(le.iceOptions),he+=this.printCandidates(le.candidates),he+=this.printRemoteCandidatesList(le.remoteCandidatesList),he+=this.printEndOfCandidates(le.endOfCandidates),he+=this.printFingerprints(le.fingerprints),he+=this.printSetup(le.setup),he+=this.printMid(le.mid),he+=this.printExtmap(le.extmaps),he+=this.printRTPRelated(le),he+=this.printPtime(le.ptime),he+=this.printMaxPtime(le.maxPtime),he+=this.printDirection(le.direction),he+=this.printSSRCGroups(le.ssrcGroups),he+=this.printSSRC(le.ssrcs),he+=this.printRTCPMux(le.rtcpMux),he+=this.printRTCPMuxOnly(le.rtcpMuxOnly),he+=this.printRTCPRsize(le.rtcpRsize),he+=this.printMSId(le.msids),he+=this.printImageattr(le.imageattr),he+=this.printRid(le.rids),he+=this.printSimulcast(le.simulcast),he+=this.printSCTPPort(le.sctpPort),he+=this.printMaxMessageSize(le.maxMessageSize),he+=this.printUnrecognized(le.unrecognized),he}printCandidates(B){return B.map(le=>"a=candidate:".concat(le.foundation).concat(_).concat(le.componentId).concat(_).concat(le.transport).concat(_).concat(le.priority).concat(_).concat(le.connectionAddress).concat(_).concat(le.port).concat(_,"typ").concat(_).concat(le.type).concat(le.relAddr?"".concat(_,"raddr").concat(_).concat(le.relAddr):"").concat(le.relPort?"".concat(_,"rport").concat(_).concat(le.relPort):"").concat(Object.keys(le.extension).map(he=>"".concat(_).concat(he).concat(_).concat(le.extension[he])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(B){return B.map(le=>"a=remote-candidates:".concat(le.join(_)).concat(this.eol)).join("")}printEndOfCandidates(B){return B===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(B){if(!B.payloads)return"";const le=B.payloads;let he="";he+=B.rtcpFeedbackWildcards.map(Fe=>this.printRTCPFeedback("*",Fe)).join("");for(const Fe of le)he+=this.printRtpMap(Fe.payloadType,Fe.rtpMap),he+=this.printFmtp(Fe.payloadType,Fe.fmtp),he+=Fe.rtcpFeedbacks.map(Vt=>this.printRTCPFeedback(Fe.payloadType,Vt)).join("");return he}printFmtp(B,le){if(!le)return"";const he=Object.keys(le.parameters);return he.length===1&&le.parameters[he[0]]===null?"a=fmtp:".concat(B).concat(_).concat(he[0]).concat(this.eol):"a=fmtp:".concat(B).concat(_).concat(Object.keys(le.parameters).map(Fe=>"".concat(Fe,"=").concat(le.parameters[Fe])).join(";")).concat(this.eol)}printRtpMap(B,le){return le?"a=rtpmap:".concat(B).concat(_).concat(le.encodingName,"/").concat(le.clockRate).concat(le.encodingParameters?"/".concat(le.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(B,le){let he="a=rtcp-fb:".concat(B).concat(_),Fe=le;return Fe.type==="trr-int"?he+="ttr-int".concat(_).concat(Fe.interval):(he+="".concat(Fe.type),Fe.parameter&&(he+="".concat(_).concat(Fe.parameter),Fe.additional&&(he+="".concat(_).concat(Fe.additional)))),he+this.eol}printPtime(B){return B===void 0?"":"a=ptime:".concat(B).concat(this.eol)}printMaxPtime(B){return B===void 0?"":"a=maxptime:".concat(B).concat(this.eol)}printDirection(B){return B===void 0?"":"a=".concat(B).concat(this.eol)}printSSRC(B){return B.map(le=>Object.keys(le.attributes).map(he=>"a=ssrc:".concat(le.ssrcId.toString(10)).concat(_).concat(he).concat(le.attributes[he]?":".concat(le.attributes[he]):"").concat(this.eol)).join("")).join("")}printRTCPMux(B){return B===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(B){return B===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(B){return B===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(B){if(B===void 0)return"";let le="a=rtcp:".concat(B.port);return B.netType&&(le+="".concat(_).concat(B.netType)),B.addressType&&(le+="".concat(_).concat(B.addressType)),B.address&&(le+="".concat(_).concat(B.address)),le+this.eol}printMSId(B){return B.map(le=>"a=msid:".concat(le.id).concat(le.appdata?"".concat(_).concat(le.appdata):"").concat(this.eol)).join("")}printImageattr(B){return B.map(le=>"a=imageattr:".concat(le).concat(this.eol)).join("")}printRid(B){return B.map(le=>{let he="a=rid:".concat(le.id).concat(_).concat(le.direction);return le.payloads&&(he+="".concat(_,"pt=").concat(le.payloads.join(","))),le.params.length>0&&(he+="".concat(_).concat(le.params.map(Fe=>Fe.type==="depend"?"depend=".concat(Fe.rids.join(",")):"".concat(Fe.type,"=").concat(Fe.val)).join(";"))),he+this.eol}).join("")}printSimulcast(B){return B===void 0?"":"a=simulcast:".concat(B).concat(this.eol)}printSCTPPort(B){return B===void 0?"":"a=sctp-port:".concat(B).concat(this.eol)}printMaxMessageSize(B){return B===void 0?"":"a=max-message-size:".concat(B).concat(this.eol)}printMid(B){return B===void 0?"":"a=mid:".concat(B).concat(this.eol)}printSSRCGroups(B){return B.map(le=>"a=ssrc-group:".concat(le.semantic).concat(le.ssrcIds.map(he=>"".concat(_).concat(he.toString(10))).join("")).concat(this.eol)).join("")}}function Ve(Oe){return new Ie().parse(Oe)}function Ze(Oe,B){return new bn().print(Oe,B)}}},a={};function s(l){if(a[l])return a[l].exports;var d=a[l]={exports:{}};return r[l](d,d.exports,s),d.exports}return s.d=(l,d)=>{for(var f in d)s.o(d,f)&&!s.o(l,f)&&Object.defineProperty(l,f,{enumerable:!0,get:d[f]})},s.o=(l,d)=>Object.prototype.hasOwnProperty.call(l,d),s.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},s(8)})();function ss(r){return jz.parse(r)}function hh(r,a){return jz.print(r,a)}var V1e=nc("Array","keys"),B1e=th,$1e=aa,W1e=T,G1e=V1e,kj=Array.prototype,H1e={DOMTokenList:!0,NodeList:!0},z1e=function(r){var a=r.keys;return r===kj||W1e(kj,r)&&a===kj.keys||$1e(H1e,B1e(r))?G1e:a},os=o(z1e);function fr(r,a,s){return(a=function(l){var d=function(f,m){if(typeof f!="object"||!f)return f;var y=f[Symbol.toPrimitive];if(y!==void 0){var _=y.call(f,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(l);return typeof d=="symbol"?d:d+""}(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}function Dz(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Wt(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Dz(Object(s),!0).forEach(function(l){fr(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Dz(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const Lz=new class extends cr{constructor(){super(...arguments),fr(this,"currentUploadLogID",0)}reportLogUploadError(r){const{errorRange:a}=r;a[a.length-1]&&a[a.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=a[a.length-1],this.emit("REPORT_LOG_UPLOAD",r))}};class K1e{constructor(a){fr(this,"logger",void 0),fr(this,"prefixLists",[]),this.logger=a}debug(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.debug(...this.prefixLists,...s)}info(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.info(...this.prefixLists,...s)}warning(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.warning(...this.prefixLists,...s)}error(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];this.logger.error(...this.prefixLists,...s)}prefix(a){return this.prefixLists.push(a),this}popPrefix(){return this.prefixLists.pop(),this}}function jj(){const r=new Date;return r.toTimeString().split(" ")[0]+":"+r.getMilliseconds()}function Mz(){const r=new Date,a=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return a?(a==null?void 0:a[0])+":"+r.getUTCMilliseconds():r.toTimeString().split(" ")[0]+":"+r.getMilliseconds()}const To={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Qx=Date.now(),pb=r=>{for(const a in To)if(Object.prototype.hasOwnProperty.call(To,a)&&To[a]===r)return a;return"DEFAULT"},V=new class{constructor(){fr(this,"proxyServerURL",void 0),fr(this,"logLevel",To.DEBUG),fr(this,"uploadState","collecting"),fr(this,"uploadLogWaitingList",[]),fr(this,"uploadLogUploadingList",[]),fr(this,"uploadErrorCount",0),fr(this,"currentLogID",0),fr(this,"url",void 0),fr(this,"extLog",(r,a)=>{this.appendLogToWaitingList(r,...a)})}debug(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[To.DEBUG].concat(a);this.log.apply(this,l)}info(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[To.INFO].concat(a);this.log.apply(this,l)}warning(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[To.WARNING].concat(a);this.log.apply(this,l)}warn(){this.warning(...arguments)}error(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[To.ERROR].concat(a);this.log.apply(this,l)}upload(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];const l=[To.DEBUG].concat(a);this.uploadLog.apply(this,l)}setLogLevel(r){r=Math.min(Math.max(0,r),4),this.logLevel=r}enableLogUpload(){An("UPLOAD_LOG",!0)}disableLogUpload(){An("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(r){this.proxyServerURL=r}prefix(r){return new K1e(this).prefix(r)}log(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];if(Date.now()-Qx<100)return void setTimeout(()=>{this.log(...a)},Date.now()-Qx);const l=Math.max(0,Math.min(4,a[0]));if(a[0]=jj()+" Agora-SDK [".concat(pb(l),"]:"),this.appendLogToWaitingList(l,...a),l<this.logLevel)return;const d=jj()+" %cAgora-SDK [".concat(pb(l),"]:");let f=[];if(!oe("USE_NEW_LOG"))switch(l){case To.DEBUG:f=[d,"color: #64B5F6;"].concat(a.slice(1)),console.log.apply(console,f);break;case To.INFO:f=[d,"color: #1E88E5; font-weight: bold;"].concat(a.slice(1)),console.log.apply(console,f);break;case To.WARNING:f=[d,"color: #FB8C00; font-weight: bold;"].concat(a.slice(1)),console.warn.apply(console,f);break;case To.ERROR:f=[d,"color: #B00020; font-weight: bold;"].concat(a.slice(1)),console.error.apply(console,f)}}uploadLog(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];if(Date.now()-Qx<100)return void setTimeout(()=>{this.uploadLog(...a)},Date.now()-Qx);const l=Math.max(0,Math.min(4,a[0]));a[0]=jj()+" Agora-SDK [".concat(pb(l),"]:"),this.appendLogToWaitingList(l,...a)}appendLogToWaitingList(r){if(!oe("UPLOAD_LOG"))return;for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];Array.isArray(s[0])?s[0][0]=Mz()+" Agora-SDK [".concat(pb(r),"]:"):s[0]=Mz()+" Agora-SDK [".concat(pb(r),"]:");let d="";s.forEach(f=>{typeof f=="object"&&(f=JSON.stringify(f)),d+="".concat(f," ")}),this.uploadLogWaitingList.push({payload_str:d,log_level:r,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const r=this.uploadLogUploadingList,a={sdk_version:xo,process_id:oe("PROCESS_ID"),payload:JSON.stringify(r)};return tl(async()=>{const s=await Ka.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(oe("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(oe("LOG_UPLOAD_SERVER"),"/upload/v1")),a,{responseType:"text"});if(s.data!=="OK"){const l=new Error("unexpected upload log response");throw l.response=s,l}},()=>(this.uploadLogUploadingList=[],!1),s=>{const l={status:-1,message:s.message,errorRange:r.map(d=>d.log_item_id)};return s.response?(l.status=s.response.status,l.data=s.response.data,l.headers=s.response.headers):s.request&&(l.status=s.request.status),Lz.reportLogUploadError(l),!0},{timeout:oe("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:oe("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,oe("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),oe("UPLOAD_LOG_INTERVAL"))}).catch(r=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),oe("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),oe("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var Uz;function q1e(r){return xi(r.reportId,"params.reportId",0,100,!1),xi(r.category,"params.category",0,100,!1),xi(r.event,"params.event",0,100,!1),xi(r.label,"params.label",0,100,!1),kn(r.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(Uz={}).FREE="free",Uz.UPLOADING="uploading",function(r){r[r.MISC=0]="MISC",r[r.INTERNAL_EVENT=1]="INTERNAL_EVENT",r[r.PUBLIC_EVENT=2]="PUBLIC_EVENT",r[r.WEB_EVENT=3]="WEB_EVENT",r[r.INTERNAL_API=4]="INTERNAL_API",r[r.WEB_API=5]="WEB_API",r[r.PUBLIC_API=6]="PUBLIC_API"}({});const Y1e={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let ii=function(r){return r.PUBLISH="publish",r.SUBSCRIBE="subscribe",r.WS_COMPRESSOR_INIT="ws_compressor_init",r.SESSION_INIT="session_init",r.JOIN_CHOOSE_SERVER="join_choose_server",r.REQ_USER_ACCOUNT="req_user_account",r.JOIN_GATEWAY="join_gateway",r.REJOIN_GATEWAY="rejoin_gateway",r.STREAM_SWITCH="stream_switch",r.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",r.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",r.FIRST_VIDEO_RECEIVED="first_video_received",r.FIRST_AUDIO_RECEIVED="first_audio_received",r.FIRST_VIDEO_DECODE="first_video_decode",r.FIRST_AUDIO_DECODE="first_audio_decode",r.XLA_PEER_FIRST_VIDEO_FRAME="xla_peer_first_video_frame",r.ON_ADD_AUDIO_STREAM="on_add_audio_stream",r.ON_ADD_VIDEO_STREAM="on_add_video_stream",r.ON_UPDATE_STREAM="on_update_stream",r.ON_REMOVE_STREAM="on_remove_stream",r.USER_ANALYTICS="req_user_analytics",r.PC_STATS="pc_stats",r.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",r.AB_TEST="ab_test",r}({}),Qn=function(r){return r.SESSION="io.agora.pb.Wrtc.Session",r.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",r.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",r.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",r.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",r.PUBLISH="io.agora.pb.Wrtc.Publish",r.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",r.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",r.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",r.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",r.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",r.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",r.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",r.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",r.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",r.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",r.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",r.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",r.XLA_PEER_FIRST_VIDEO_FRAME="io.agora.pb.Wrtc.XLAPeerFirstVideoFrame",r.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",r.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",r.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",r.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",r.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",r.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",r.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",r.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",r.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",r.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",r.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",r.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",r.PC_STATS="io.agora.pb.Wrtc.PCStats",r.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",r.AB_TEST="io.agora.pb.Wrtc.ABTest",r}({});(function(r){r[r.WORKER_EVENT=156]="WORKER_EVENT",r[r.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let X1e=function(r){return r[r.SESSION=26]="SESSION",r[r.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",r[r.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",r[r.JOIN_GATEWAY=28]="JOIN_GATEWAY",r[r.PUBLISH=30]="PUBLISH",r[r.SUBSCRIBE=29]="SUBSCRIBE",r[r.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",r[r.STREAM_SWITCH=32]="STREAM_SWITCH",r[r.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",r[r.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",r[r.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",r[r.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",r[r.API_INVOKE=41]="API_INVOKE",r[r.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",r[r.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",r[r.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",r[r.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",r[r.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",r[r.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",r[r.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",r[r.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",r[r.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",r[r.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",r[r.WORKER_EVENT=156]="WORKER_EVENT",r[r.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",r[r.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",r[r.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",r[r.USER_ANALYTICS=1e4]="USER_ANALYTICS",r[r.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",r}({});function Et(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(a,s,l){const d=l.value;if(typeof d=="function"){const f=r.className||a.__className__||(a.constructor.name==="AgoraRTCClient"?"Client":a.constructor.name);l.value=function(){for(var m,y=arguments.length,_=new Array(y),S=0;S<y;S++)_[S]=arguments[S];let x=_;if(r.argsMap)try{x=r.argsMap(this,..._)}catch(I){V.warning(I),x=[]}try{JSON.stringify(x)}catch{V.warning("arguments for method ".concat(f,".").concat(String(s)," not serializable for apiInvoke.")),x=[]}const A=(r.report||it).reportApiInvoke(this._sessionId||null,{id:this._clientId||((m=this.store)===null||m===void 0?void 0:m.clientId)||this._ID,name:"".concat(f,".").concat(String(s)),options:x,tag:rr.TRACER,reportResult:r.reportResult},r.throttleTime);try{const I=d.apply(this,_);return I instanceof He?I.then(L=>(A.onSuccess(r.reportResult&&L),L)).catch(L=>{throw A.onError(L),L}):(A.onSuccess(r.reportResult&&I),I)}catch(I){throw A.onError(I),I}}}return l}}const it=new class{constructor(){fr(this,"baseInfoMap",new Map),fr(this,"proxyServer",void 0),fr(this,"eventUploadTimer",void 0),fr(this,"setSessionIdTimer",void 0),fr(this,"url",void 0),fr(this,"sids",new Set),fr(this,"backupUrl",void 0),fr(this,"_appId",void 0),fr(this,"_aid",0),fr(this,"keyEventUploadPendingItems",[]),fr(this,"normalEventUploadPendingItems",[]),fr(this,"apiInvokeUploadPendingItems",[]),fr(this,"apiInvokeCount",0),fr(this,"apiInvokeLoggedCount",0),fr(this,"ltsList",[]),fr(this,"lastSendNormalEventTime",Date.now()),fr(this,"customReportCounterTimer",void 0),fr(this,"customReportCount",0),fr(this,"extApiInvoke",async r=>{for(const a of r){const s=Wt(Wt({},a),{},{sid:null,invokeId:++this.apiInvokeCount,tag:rr.TRACER});this.sendApiInvoke(s)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),oe("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),oe("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(r){return this.baseInfoMap.get(r)}setAppId(r){this._appId=r,this._aid=parseInt(r.replace(/[a-fA-F0-9]{8}/g,a=>{let[s,l]=a;return s+l}),16)||0}reportApiInvoke(r,a,s){a.timeout=a.timeout||6e4,a.reportResult=a.reportResult===void 0||a.reportResult;const l=Date.now();this.apiInvokeCount+=1;const d=this.apiInvokeCount,f=!!oe("SHOW_REPORT_INVOKER_LOG"),m=!!oe("SHOW_REPORT_USER_INVOKER_LOG"),y=f||m&&a.id;y&&(this.apiInvokeLoggedCount+=1);const _=this.apiInvokeLoggedCount;function S(L,K){if(y){let $="[apiInvoke-".concat(_,"]");if(a.id&&($+="[".concat(a.id,"]")),a.name&&($+="[".concat(a.name,"]"),a.name===Er.JOIN))return V.info("".concat($," ").concat(L));V.info("".concat($," ").concat(L),L==="start"?a.options:K||"")}}const x=()=>({tag:a.tag,invokeId:d,sid:r,name:a.name,apiInvokeTime:l,options:a.options,states:a.states||null});S("start");let A=!1;Ti(a.timeout).then(()=>{A||(this.sendApiInvoke(Wt(Wt({},x()),{},{error:ie.API_INVOKE_TIMEOUT,success:!1})),S("timeout"))});const I=new we(ie.UNEXPECTED_ERROR,"".concat(a.name,": this api invoke is end"));return{onSuccess:L=>{const K=()=>{if(A)throw I;return A=!0,this.sendApiInvoke(Wt(Wt({},x()),{},{success:!0},a.reportResult&&{result:L})),S("onSuccess"),L};return s?vz(K,a.name+"Success",s,()=>A=!0):K()},onError:L=>{const K=()=>{if(A)throw L;A=!0,this.sendApiInvoke(Wt(Wt({},x()),{},{success:!1,error:L})),S("onFailure",L.toString())};return s?vz(K,a.name+"Error",s,()=>A=!0):K()}}}sessionInit(r,a){if(this.baseInfoMap.has(r))return;const s=Date.now(),l=this.createBaseInfo(r,s);l.cname=a.cname;const d=Object.assign({},{willUploadConsoleLog:oe("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Aj?"global":"oversea",areas:oe("AREAS")&&oe("AREAS").join(",")},a.extend),{stringUid:f,channelProfile:m,channelMode:y,isABTestSuccess:_,lsid:S,clientRole:x}=a,A=Date.now(),I=Wt(Wt({},l),{},{eventType:ii.SESSION_INIT,appid:a.appid,browser:navigator.userAgent,buildFormat:a.buildFormat,build:Oj,lts:A,elapse:A-s,extend:JSON.stringify(d),mode:a.mode,process:oe("PROCESS_ID"),appType:oe("APP_TYPE"),success:!0,version:xo,stringUid:f,channelProfile:m,channelMode:y,isABTestSuccess:_,lsid:S,clientType:Be(L=window.navigator.userAgent).call(L,"AgoraWebView")?42:20,clientRole:x,serviceId:oe("PROCESS_ID"),extensionID:oe("PLUGIN_INFO").join(",")||""});var L;this.send({type:Qn.SESSION,data:I},!0)}joinChooseServer(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{role:a.role,eventType:ii.JOIN_CHOOSE_SERVER,lts:d,eventElapse:a.elapse||d-a.lts,chooseServerAddr:a.csAddr,errorCode:a.ec,elapse:d-s.startTime,success:a.succ,chooseServerAddrList:JSON.stringify(a.serverList),uid:a.uid?parseInt(a.uid):null,cid:a.cid?parseInt(a.cid):null,chooseServerIp:a.csIp||"",opid:a.opid,unilbsServerIds:a.unilbsServerIds,extend:a.extend||void 0,isHttp3:a.isHttp3,corssRegionTagReq:a.corssRegionTagReq||void 0,corssRegionTagRes:a.corssRegionTagRes||void 0,resourceTimingInfo:a.resourceTimingInfo||void 0});this.send({type:Qn.JOIN_CHOOSE_SERVER,data:f},!0)}reqUserAccount(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ii.REQ_USER_ACCOUNT,lts:d,success:a.success,serverAddress:a.serverAddr,stringUid:a.stringUid,uid:a.uid,errorCode:a.errorCode,elapse:a.elapse||d-s.startTime,eventElapse:d-a.lts,extend:JSON.stringify(a.extend)});this.send({type:Qn.REQ_USER_ACCOUNT,data:f},!0)}joinGateway(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info;a.vid&&(l.vid=a.vid),l.uid=a.uid,l.cid=a.cid;const d=Date.now(),{firstSuccess:f,addr:m,isProxy:y}=a,_=d-s.startTime,S=Wt(Wt({},l),{},{eventType:ii.JOIN_GATEWAY,lts:d,gatewayAddr:a.addr,success:a.succ,errorCode:a.ec,errorMsg:a.errorMsg||"",elapse:_,eventElapse:d-a.lts,firstSuccess:f,signalChannel:a.signalChannel,preload:a.preload?1:0,installId:Nj(),isABTestSuccess:a.isABTestSuccess?1:0}),x=S.success?1:0;if(a.succ&&(s.lastJoinSuccessTime=d),f)this.send({type:Qn.JOIN_GATEWAY,data:S},!0);else{let A;if(m)if(y){const L=m.match(/h=(\d{1,3}-){3}\d{1,3}/g),K=m.match(/p=[0-9]{1,6}/g);A={isSuccess:x,gatewayIp:L&&L.length?L[0].split("=")[1].replace(/-/g,"."):"",port:K&&K.length?K[0].split("=")[1]:"",isProxy:y?1:0}}else{const L=m.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),K=m.match(/(:|p=)[0-9]{1,6}/g);A={isSuccess:x,gatewayIp:L&&L.length?L[0].split("//")[1].replace(/-/g,"."):"",port:K&&K.length?K[0].split(/:|p=/g)[1]:"",isProxy:y?1:0}}else A={isSuccess:x,gatewayIp:"",port:"",isProxy:y?1:0};delete S.success,delete S.eventType,delete S.firstSuccess,S.vid=Number(S.vid);const I=Object.assign({},S,A,{eventType:ii.REJOIN_GATEWAY});this.send({type:Qn.RE_JOIN_GATEWAY,data:I},!0)}}joinChannelTimeout(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=Date.now(),d=Wt(Wt({},s.info),{},{lts:l,timeout:a,elapse:l-s.startTime});this.send({type:Qn.JOIN_CHANNEL_TIMEOUT,data:d},!0)}publish(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ii.PUBLISH,lts:d,eventElapse:a.eventElapse,elapse:d-s.startTime,success:a.succ,errorCode:a.ec,videoName:a.videoName,audioName:a.audioName,screenName:a.screenName,screenshare:a.screenshare,audio:a.audio,video:a.video,p2pid:a.p2pid,publishRequestid:a.publishRequestid});this.send({type:Qn.PUBLISH,data:f},!0)}subscribe(r,a,s){const l=this.baseInfoMap.get(r);if(!l)return;const d=l.info,f=Date.now(),m=Wt(Wt({},d),{},{eventType:ii.SUBSCRIBE,lts:f,eventElapse:a.eventElapse,elapse:f-l.startTime,success:a.succ,errorCode:a.ec,video:a.video,audio:a.audio,subscribeRequestid:a.subscribeRequestid,p2pid:a.p2pid,preSsrc:a.preSsrc?1:0},s&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof a.peerid=="string"?m.peerSuid=a.peerid:m.peer=a.peerid,this.send({type:Qn.SUBSCRIBE,data:m},!0)}wsCompressorInit(r){var a;const s=[...os(a=this.baseInfoMap).call(a)],l=s.length?s[0]:"UnableToGetSid",d=this.baseInfoMap.get(l);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt({},f),{},{eventType:ii.WS_COMPRESSOR_INIT,lts:m,eventElapse:r.eventElapse,elapse:m-d.startTime,status:r.status?1:2});this.send({type:Qn.WS_COMPRESSOR_INIT,data:y},!0)}firstXLAPeerFirstVideoFrame(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=a.peerPubStatusMs-(s.lastJoinSuccessTime||d),m=Wt(Wt({},l),{},{elapse:d-s.startTime,eventType:ii.XLA_PEER_FIRST_VIDEO_FRAME,lts:d,peer:a.peer,width:a.width,height:a.height,ssrc:a.ssrc,p2pid:a.p2pid,peerPublishDuration:a.peerPublishDuration,joinChannelSuccessElapse:f,peerPubStatusMs:a.peerPubStatusMs-a.joinChannelStart,availablePublish:a.peerPublishDuration>f?1:0,preloadStart:Math.max(a.preloadStart-a.joinChannelStart,0),preloadEnd:Math.max(a.preloadEnd-a.joinChannelStart,0),encrypt:Math.max(a.apStart-a.joinChannelStart,0),ap:Math.max(a.apEnd-a.joinChannelStart,0),sua:Math.max(a.suaEnd-a.joinChannelStart,0),beforeConnect:Math.max(a.beforeConnect-a.joinChannelStart,0),peerRecevier:Math.max(a.peerReceiver-a.joinChannelStart,0),ice:Math.max(a.ice-a.joinChannelStart,0),pc:Math.max(a.pc-a.joinChannelStart,0),signalConnected:Math.max(a.signalConnected-a.joinChannelStart,0),joinReq:Math.max(a.joinReq-a.joinChannelStart,0),joinRes:Math.max(a.joinRes-a.joinChannelStart,0),userJoinNotify:Math.max(a.userJoinNotify-a.joinChannelStart,0),videoSsrcNotify:Math.max(a.videoAddNotify-a.joinChannelStart,0),subscribeDelayMs:Math.max(a.subscribeStart-a.videoAddNotify,0),subscribeStart:Math.max(a.subscribeStart-a.joinChannelStart,0),subscribeEnd:Math.max(a.subscribeEnd-a.joinChannelStart,0),firstReceived:Math.max(a.firstReceived-a.joinChannelStart,0),firstDecoded:Math.max(a.firstDecoded-a.joinChannelStart,0),firstPreRender:Math.max(a.firstPreRender-a.joinChannelStart,0),firstRender:Math.max(a.firstRender-a.joinChannelStart,0),playDelayMs:Math.max(a.playStart-a.subscribeEnd,0),playStart:Math.max(a.playStart-a.joinChannelStart,0),playEnd:Math.max(a.playEnd-a.joinChannelStart,0),isPreSub:a.isPreSub?1:0,isPrePc:a.isPrePc?1:0,isPreInstantVideo:a.isPreInstantVideo?1:0});this.send({type:Qn.XLA_PEER_FIRST_VIDEO_FRAME,data:m},!0)}firstRemoteVideoDecode(r,a,s,l){const d=this.baseInfoMap.get(r);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt(Wt({},f),l),{},{elapse:m-d.startTime,eventType:a,lts:m,firstDecodeFrame:Math.max((l.firstFrame||m)-d.startTime,0),apEnd:Math.max(l.apEnd-d.startTime,0),apStart:Math.max(l.apStart-d.startTime,0),joinGwEnd:Math.max(l.joinGwEnd-d.startTime,0),joinGwStart:Math.max(l.joinGwStart-d.startTime,0),pcEnd:Math.max(l.pcEnd-d.startTime,0),pcStart:Math.max(l.pcStart-d.startTime,0),subscriberEnd:Math.max(l.subscriberEnd-d.startTime,0),subscriberStart:Math.max(l.subscriberStart-d.startTime,0),videoAddNotify:Math.max(l.videoAddNotify-d.startTime,0)});this.send({type:s,data:y},!0)}firstRemoteFrame(r,a,s,l){const d=this.baseInfoMap.get(r);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt(Wt({},f),l),{},{elapse:m-d.startTime,eventType:a,lts:m});this.send({type:s,data:y},!0)}abTest(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{vid:l.vid===void 0?0:Number(l.vid),elapse:d-s.startTime,eventType:ii.AB_TEST,lts:d});this.send({type:Qn.AB_TEST,data:f},!0)}pcStats(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{vid:l.vid===void 0?0:Number(l.vid),elapse:d-s.startTime,eventType:ii.PC_STATS,lts:d,preallocation:a.preallocation?1:0});this.send({type:Qn.PC_STATS,data:f},!0)}updateRemoteRTPCapabilities(r,a){if(r){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{vid:l.vid===void 0?0:Number(l.vid),eventType:ii.UPDATE_REMOTE_RTPCAPABILITIES,lts:d});this.send({type:Qn.UPDATE_REMOTE_RTPCAPABILITIES,data:f},!0)}}onGatewayStream(r,a,s,l){const d=this.baseInfoMap.get(r);if(!d)return;const f=d.info,m=Date.now(),y=Wt(Wt(Wt({},f),l),{},{eventType:a,lts:m});this.send({type:s,data:y},!0)}streamSwitch(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ii.STREAM_SWITCH,lts:d,isDual:a.isdual,elapse:d-s.startTime,success:a.succ});this.send({type:Qn.STREAM_SWITCH,data:f},!0)}requestProxyAppCenter(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ii.REQUEST_PROXY_APPCENTER,lts:d,eventElapse:d-a.lts,elapse:d-s.startTime,APAddr:a.APAddr,workerManagerList:a.workerManagerList,response:a.response,errorCode:a.ec,success:a.succ});this.send({type:Qn.REQUEST_PROXY_APPCENTER,data:f},!0)}requestProxyWorkerManager(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{eventType:ii.REQUEST_PROXY_WORKER_MANAGER,lts:d,eventElapse:d-a.lts,elapse:d-s.startTime,workerManagerAddr:a.workerManagerAddr,response:a.response,errorCode:a.ec,success:a.succ});this.send({type:Qn.REQUEST_PROXY_WORKER_MANAGER,data:f},!0)}setProxyServer(r){this.proxyServer=r,r?V.debug("reportProxyServerurl: ".concat(r)):V.debug("disable reportProxyServerurl: ".concat(r))}peerPublishStatus(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt({},l),{},{subscribeElapse:a.subscribeElapse,peer:a.peer,peerPublishDuration:Math.max(a.audioPublishDuration,a.videoPublishDuration),audiotag:a.audioPublishDuration>0?1:-1,videotag:a.videoPublishDuration>0?1:-1,lts:d,elapse:d-s.startTime,joinChannelSuccessElapse:d-(s.lastJoinSuccessTime||d),peerPublishDurationVideo:a.videoPublishDuration,peerPublishDurationAudio:a.audioPublishDuration});this.send({type:Qn.PEER_PUBLISH_STATUS,data:f},!0)}workerEvent(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now();(function(f,m,y){const _=f[m];if(!_||typeof _!="string")return[f];f[m]="";const S=eu(JSON.stringify(f));let x=0;const A=[];let I=0;for(let L=0;L<_.length;L++)I+=_.charCodeAt(L)<=127?1:3,I<=y-S||(A[A.length]=Ue(Ue({},f),{},{[m]:_.substring(x,L)}),x=L,I=_.charCodeAt(L)<=127?1:3);return x!==_.length-1&&(A[A.length]=Ue(Ue({},f),{},{[m]:_.substring(x)})),A})(Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d,productType:"WebRTC"}),"payload",1300).forEach(f=>this.send({type:Qn.WORKER_EVENT,data:f},!0))}apworkerEvent(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d});this.send({type:Qn.AP_WORKER_EVENT,data:f},!0)}joinWebProxyAP(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d,extend:a.extend||void 0});this.send({type:Qn.JOIN_WEB_PROXY_AP,data:f},!0)}WebSocketQuit(r,a){const s=this.baseInfoMap.get(r);if(!s)return;const l=s.info,d=Date.now(),f=Wt(Wt(Wt({},l),a),{},{elapse:d-s.startTime,lts:d});this.send({type:Qn.WEBSOCKET_QUIT,data:f},!0)}async sendCustomReportMessage(r,a){if(this.customReportCount+=a.length,this.customReportCount>oe("CUSTOM_REPORT_LIMIT"))throw new we(ie.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const s=Date.now(),l=a.map(d=>({type:Qn.USER_ANALYTICS,data:Wt(Wt({sid:r},d),{},{lts:s})}));try{oe("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(l):await this.postDataToStatsCollector(l)}catch(d){throw V.error("send custom report message failed",d.toString()),new we(ie.CUSTOM_REPORT_SEND_FAILED,d.message)}}sendApiInvoke(r){const a=oe("NOT_REPORT_EVENT");if(r.tag&&Be(a)&&Be(a).call(a,r.tag))return!1;if(r.sid===null)return this.apiInvokeUploadPendingItems.push(r),!1;const s=this.baseInfoMap.get(r.sid);if(!s)return this.apiInvokeUploadPendingItems.push(r),!1;const{cname:l,uid:d,cid:f}=s.info;let m;if(r.lts=r.lts||Date.now(),r.error)if(r.error instanceof we){const{code:_,message:S}=r.error;m=_||S||r.error.toString()}else m=r.error.toString();const y={invokeId:r.invokeId,sid:r.sid,cname:l,cid:f,uid:d,lts:r.lts,success:r.success,elapse:r.lts-s.startTime,execElapse:r.lts-r.apiInvokeTime,apiName:r.name,options:r.options?JSON.stringify(r.options):void 0,execStates:r.states?JSON.stringify(r.states):void 0,execResult:r.result?JSON.stringify(r.result):void 0,errorCode:r.error?m:void 0,errorMsg:r.error?JSON.stringify(r.error):void 0};return this.send({type:Qn.API_INVOKE,data:y},!1),!0}addSid(r){this.sids.add(r)}removeSid(r){this.sids.delete(r)}appendSessionId(){const r=this.apiInvokeUploadPendingItems;if(r.length===0)return;const a=Array.from(this.sids).find(s=>s!==null);a&&r.forEach(s=>{s&&(s.sid=a,this.sendApiInvoke(Object.assign({},s)))}),r.length=0}send(r,a){if(a)return this.keyEventUploadPendingItems.push(r),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(r),this.normalEventUploadPendingItems.length>oe("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(r,a){const s=[],l=[];for(;r.length;){const f=r.shift();s.length<20?s.push(f):l.push(f)}r.push(...l);for(const f of[...s]){var d;this.ltsList.indexOf(f.data.lts)!==-1?(f.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(f.data.lts)):(this.ltsList.push(f.data.lts),Yf(d=this.ltsList).call(d,(m,y)=>m-y))}return a||(this.lastSendNormalEventTime=Date.now()),oe("ENABLE_EVENT_REPORT")&&s.length&&(oe("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(s):this.postDataToStatsCollector(s)).catch((f=>m=>{oe("EVENT_REPORT_RETRY")&&(a?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(f):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(f),this.normalEventUploadPendingItems.length>oe("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-oe("NORMAL_EVENT_QUEUE_CAPACITY")),V.warning("report: drop normal events"))))})(s)),r}async postDataToStatsCollector2(r){Dr.networkState===As.OFFLINE&&await He.race([Dr.onlineWaiter,Ti(2*Gr.maxRetryTimeout)]);const a=d=>{let f=new Uint8Array;return d.forEach(m=>{const y=gj(JSON.stringify(m.data)),_=new ArrayBuffer(5),S=(A=>{let I=0;return Object.entries(Qn).forEach(L=>{let[K,$]=L;$===A.type&&(I=X1e[K])}),I})(m),x=new DataView(_);x.setUint16(0,y.byteLength,!0),x.setUint8(2,255&S),x.setUint8(3,S>>>8&255),x.setUint8(4,S>>>16&255),f=cz(f,new Uint8Array(_)),f=cz(f,y)}),f},s="event";let l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(oe("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(s):"https://".concat(oe("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(s);for(let d=0;d<2;d+=1){d===1&&(l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(oe("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(s):"https://".concat(oe("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(s));try{await Sj(l,{timeout:1e4,data:a(r),headers:Wt(Wt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(f){if(d===1)throw f;continue}return}}async postDataToStatsCollector(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=(y=>{const _=y&&y.data.sid&&this.baseInfoMap.get(y.data.sid);return _&&_.info.vid&&+_.info.vid||0})(r[0]),l=s?void 0:this._aid,d={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:r.map(y=>JSON.stringify(y)),vid:s,aid:l};Dr.networkState===As.OFFLINE&&await He.race([Dr.onlineWaiter,Ti(2*Gr.maxRetryTimeout)]);const f=a?"/events/proto-raws":"/events/messages";let m=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(oe("EVENT_REPORT_DOMAIN"),"&p=").concat(oe("STATS_COLLECTOR_PORT"),"&d=").concat(f):"https://".concat(oe("EVENT_REPORT_DOMAIN"),":").concat(oe("STATS_COLLECTOR_PORT")).concat(f));for(let y=0;y<2;y+=1){y===1&&(m=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(oe("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(oe("STATS_COLLECTOR_PORT"),"&d=").concat(f):"https://".concat(oe("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(oe("STATS_COLLECTOR_PORT")).concat(f)));try{a?await D1e(m,{timeout:1e4,data:d}):await Sj(m,{timeout:1e4,data:d})}catch(_){if(y===1)throw _;continue}return}}createBaseInfo(r,a){const s=Object.assign({},Y1e);return s.sid=r,this.baseInfoMap.set(r,{info:s,startTime:a}),s}reportResourceTiming(r,a){const s=performance.getEntriesByName(r),l=s[s.length-1];l&&this.reportApiInvoke(a,{name:"Client.resourceTiming",options:l,tag:rr.TRACER}).onSuccess()}};Lz.on("REPORT_LOG_UPLOAD",r=>{r.networkState=Dr.networkState,it.reportApiInvoke(null,{name:"logUploadError",options:r,tag:rr.TRACER}).onSuccess("logUploadError")});class Ee extends we{constructor(a){super(a,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),fr(this,"name","AgoraRTCException")}print(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(a,V)}throw(){super.throw(V)}}const Ci={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function un(){return Ci}function Fz(){return"setSinkId"in HTMLAudioElement.prototype&&(!oe("RESTRICTION_SET_PLAYBACK_DEVICE")||(nd()||XH())&&!fj())}function eT(){return!Ci.supportUnifiedPlan||oe("CHROME_FORCE_PLAN_B")&&rd()}function Dj(r){return!(dr()||JH(87)||eT()||!oe("ENABLE_PRE_SUB")&&(r==null||!r.autoSubscribe||oe("FORCE_DISABLE_AUTO_SUB")))}function Vz(r){return!!oe("ENABLE_INSTANT_VIDEO")||!(r==null||!r.autoSubscribe||oe("FORCE_DISABLE_AUTO_SUB"))}let Ri=function(r){return r.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",r.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",r.IOS_INTERRUPTION_START="ios-interruption-start",r.IOS_INTERRUPTION_END="ios-interruption-end",r.STATE_CHANGE="state-change",r}({});function wg(r,a,s){return{sampleRate:r,stereo:a,bitrate:s}}function dn(r,a,s,l,d){return{width:r,height:a,frameRate:s,bitrateMin:l,bitrateMax:d}}function hc(r,a,s,l,d){return{width:{max:r},height:{max:a},frameRate:s,bitrateMin:l,bitrateMax:d}}function Lj(r,a){return{numSpatialLayers:r,numTemporalLayers:a}}const J1e={"90p":dn(160,90),"90p_1":dn(160,90),"120p":dn(160,120,15,30,65),"120p_1":dn(160,120,15,30,65),"120p_3":dn(120,120,15,30,50),"120p_4":dn(212,120),"180p":dn(320,180,15,30,140),"180p_1":dn(320,180,15,30,140),"180p_3":dn(180,180,15,30,100),"180p_4":dn(240,180,15,30,120),"240p":dn(320,240,15,40,200),"240p_1":dn(320,240,15,40,200),"240p_3":dn(240,240,15,40,140),"240p_4":dn(424,240,15,40,220),"360p":dn(640,360,15,80,400),"360p_1":dn(640,360,15,80,400),"360p_3":dn(360,360,15,80,260),"360p_4":dn(640,360,30,80,600),"360p_6":dn(360,360,30,80,400),"360p_7":dn(480,360,15,80,320),"360p_8":dn(480,360,30,80,490),"360p_9":dn(640,360,15,80,800),"360p_10":dn(640,360,24,80,800),"360p_11":dn(640,360,24,80,1e3),"480p":dn(640,480,15,100,500),"480p_1":dn(640,480,15,100,500),"480p_2":dn(640,480,30,100,1e3),"480p_3":dn(480,480,15,100,400),"480p_4":dn(640,480,30,100,750),"480p_6":dn(480,480,30,100,600),"480p_8":dn(848,480,15,100,610),"480p_9":dn(848,480,30,100,930),"480p_10":dn(640,480,10,100,400),"720p":dn(1280,720,15,120,1130),"720p_auto":dn(1280,720,30,900,3e3),"720p_1":dn(1280,720,15,120,1130),"720p_2":dn(1280,720,30,120,2e3),"720p_3":dn(1280,720,30,120,1710),"720p_5":dn(960,720,15,120,910),"720p_6":dn(960,720,30,120,1380),"1080p":dn(1920,1080,15,120,2080),"1080p_1":dn(1920,1080,15,120,2080),"1080p_2":dn(1920,1080,30,120,3e3),"1080p_3":dn(1920,1080,30,120,3150),"1080p_5":dn(1920,1080,60,120,4780),"1440p":dn(2560,1440,30,120,4850),"1440p_1":dn(2560,1440,30,120,4850),"1440p_2":dn(2560,1440,60,120,7350),"4k":dn(3840,2160,30,120,8910),"4k_1":dn(3840,2160,30,120,8910),"4k_3":dn(3840,2160,60,120,13500)},Z1e={"480p":hc(640,480,5),"480p_1":hc(640,480,5),"480p_2":hc(640,480,30),"480p_3":hc(640,480,15),"720p":hc(1280,720,5),"720p_auto":dn(1280,720,30,900,3e3),"720p_1":hc(1280,720,5),"720p_2":hc(1280,720,30),"720p_3":hc(1280,720,15),"1080p":hc(1920,1080,5),"1080p_1":hc(1920,1080,5),"1080p_2":hc(1920,1080,30),"1080p_3":hc(1920,1080,15)},Q1e={"1SL1TL":Lj(1,1),"3SL3TL":Lj(3,3),"2SL3TL":Lj(2,3)};function fc(r){return r||(r="480p_1"),typeof r=="string"?Object.assign({},J1e[r]):r}function Mj(r){return typeof r=="string"?Object.assign({},Z1e[r]):r}function tT(r){return typeof r=="string"?Object.assign({},Q1e[r]):r}const eIe={speech_low_quality:wg(16e3,!1),speech_standard:wg(32e3,!1,18),music_standard:wg(48e3,!1),standard_stereo:wg(48e3,!0,56),high_quality:wg(48e3,!1,128),high_quality_stereo:wg(48e3,!0,192)};function nT(r){return typeof r=="string"?Object.assign({},eIe[r]):r}const Sg=[];function Bz(r){return ri(r,"mediaSource",["screen","window","application"]),!0}let et=function(r){return r.NEED_RENEGOTIATE="@need_renegotiate",r.NEED_REPLACE_TRACK="@need_replace_track",r.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",r.NEED_CLOSE="@need_close",r.NEED_ENABLE_TRACK="@need_enable_track",r.NEED_DISABLE_TRACK="@need_disable_track",r.NEED_SESSION_ID="@need_sid",r.SET_OPTIMIZATION_MODE="@set_optimization_mode",r.GET_STATS="@get_stats",r.GET_RTC_STATS="@get_rtc_stats",r.GET_LOW_VIDEO_TRACK="@get_low_video_track",r.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",r.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",r.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",r.NEED_MUTE_TRACK="@need_mute_track",r.NEED_UNMUTE_TRACK="@need_unmute_track",r}({}),jn=function(r){return r.SCREEN_TRACK="screen_track",r.CUSTOM_TRACK="custome_track",r.LOW_STREAM="low_stream",r.SCREEN_LOW_TRACK="screen_low_track",r}({}),xg=function(r){return r[r.HIGH_STREAM=0]="HIGH_STREAM",r[r.LOW_STREAM=1]="LOW_STREAM",r}({}),tIe=function(r){return r[r.HIGH_STREAM=0]="HIGH_STREAM",r[r.LOW_STREAM=1]="LOW_STREAM",r[r.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",r[r.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",r[r.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",r[r.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",r[r.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",r[r.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",r}({}),nIe=function(r){return r[r.DISABLE=0]="DISABLE",r[r.LOW_STREAM=1]="LOW_STREAM",r[r.AUDIO_ONLY=2]="AUDIO_ONLY",r[r.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",r[r.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",r[r.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",r[r.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",r[r.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",r[r.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",r}({}),cp=function(r){return r.TRANSCEIVER_UPDATED="transceiver-updated",r.SEI_TO_SEND="sei-to-send",r.SEI_RECEIVED="sei-received",r.TRACK_UPDATED="track-updated",r}({}),Tg=function(r){return r.SOURCE_STATE_CHANGE="source-state-change",r.TRACK_ENDED="track-ended",r.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",r.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",r.CLOSED="closed",r}({}),Co=function(r){return r.FIRST_FRAME_DECODED="first-frame-decoded",r.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",r.VIDEO_STATE_CHANGED="video-state-changed",r.PLAY_START="play-start",r.PLAY_END="play-end",r.FIRST_FRAME_RENDER="first-frame-render",r}({}),Cg=function(r){return r.AUDIO="audio",r.VIDEO="video",r.DATA="data",r}({}),Xs=function(r){return r.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",r.RECEIVE_TRACK_BUFFER="receive_track_buffer",r.ON_AUDIO_BUFFER="on_audio_buffer",r.UPDATE_SOURCE="update_source",r}({});(function(r){r.UPDATE_TRACK_SOURCE="update-track-source"})({});const Uj={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},Fj={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},$z={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},rIe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},Wz={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let ja=function(r){return r.ON_TRACK="on_track",r.ON_NODE="on_node",r}({}),Js=function(r){return r.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",r.REQUEST_CONSTRAINTS="request_constraints",r}({}),mb=function(r){return r.IDLE="IDLE",r.INITING="INITING",r.INITEND="INITEND",r}({}),lp=function(r){return r.STATE_CHANGE="state_change",r.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",r.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",r.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",r}({}),zi=function(r){return r.NONE="none",r.INIT="init",r.CANPLAY="canplay",r.PLAYING="playing",r.PAUSED="paused",r.SUSPEND="suspend",r.STALLED="stalled",r.WAITING="waiting",r.ERROR="error",r.DESTROYED="destroyed",r.ABORT="abort",r.ENDED="ended",r.EMPTIED="emptied",r.LOADEDDATA="loadeddata",r}({}),nu=function(r){return r[r.VideoStateStopped=0]="VideoStateStopped",r[r.VideoStateStarting=1]="VideoStateStarting",r[r.VideoStateDecoding=2]="VideoStateDecoding",r[r.VideoStateFrozen=3]="VideoStateFrozen",r}({});const Vj={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let rT=function(r){return r.OPEN="open",r.MESSAGE="message",r.CLOSE="close",r.CLOSING="closing",r.ERROR="error",r}({});function rn(r,a,s,l,d){var f,m,y={};return Object.keys(l).forEach(function(_){y[_]=l[_]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=rc(f=R5(m=s.slice()).call(m)).call(f,function(_,S){return S(r,a,_)||_},y),d&&y.initializer!==void 0&&(y.value=y.initializer?y.initializer.call(d):void 0,y.initializer=void 0),y.initializer===void 0?(Object.defineProperty(r,a,y),null):y}function _e(r,a,s){return(a=function(l){var d=function(f,m){if(typeof f!="object"||!f)return f;var y=f[Symbol.toPrimitive];if(y!==void 0){var _=y.call(f,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(l);return typeof d=="symbol"?d:d+""}(a))in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}function Gz(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function $n(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Gz(Object(s),!0).forEach(function(l){_e(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Gz(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class Hz extends cr{set _mediaStreamTrack(a){a!==this.mediaStreamTrack&&(this.safeEmit(cp.TRACK_UPDATED,a),this.mediaStreamTrack=a)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(a,s){super(),_e(this,"trackMediaType",void 0),_e(this,"_ID",void 0),_e(this,"_rtpTransceiver",void 0),_e(this,"_lowRtpTransceiver",void 0),_e(this,"_hints",[]),_e(this,"_isClosed",!1),_e(this,"_originMediaStreamTrack",void 0),_e(this,"mediaStreamTrack",void 0),_e(this,"_external",{}),this._ID=s||Mn(8,"track-"),this._originMediaStreamTrack=a,this.mediaStreamTrack=a,function(l){Be(Sg).call(Sg,l)||Sg.push(l)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(a){return a||uh(()=>{var s;it.reportApiInvoke(null,{name:Er.GET_MEDIA_STREAM_TRACK,options:[],tag:rr.TRACER}).onSuccess(((s=this._mediaStreamTrack)===null||s===void 0?void 0:s.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(a){return a===xg.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(a){const s=Sg.indexOf(a);s!==-1&&Sg.splice(s,1)}(this),this.emit(Tg.CLOSED),this.removeAllListeners(cp.SEI_RECEIVED)}_updateRtpTransceiver(a,s){if(s===xg.LOW_STREAM){if(this._lowRtpTransceiver===a)return;this._lowRtpTransceiver=a}else{if(this._rtpTransceiver===a)return;this._rtpTransceiver=a}this.emit(cp.TRANSCEIVER_UPDATED,a,s)}}class Rg extends Hz{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(a,s){super(a,s),_e(this,"_enabled",!0),_e(this,"_muted",!1),_e(this,"_isExternalTrack",!1),_e(this,"_isClosed",!1),_e(this,"_enabledMutex",void 0),_e(this,"processor",void 0),_e(this,"_processorContext",void 0),_e(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Hi("".concat(this.getTrackId())),a.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var a,s;return(a=(s=this._originMediaStreamTrack)===null||s===void 0?void 0:s.label)!==null&&a!==void 0?a:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,V.debug("[".concat(this.getTrackId(),"] close")),this.emit(et.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(a,s){let l=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=l,a!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),s&&this._originMediaStreamTrack.stop()),a.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=a,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,et.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){V.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Tg.TRACK_ENDED)}stateCheck(a,s){if(V.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(a,": ").concat(s,"]")),el(s,a),this._enabled&&this._muted&&a==="enabled"&&s===!1)throw new we(ie.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",V);if(!this._enabled&&!this._muted&&a==="muted"&&s===!0)throw new we(ie.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",V)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():He.resolve([])}}const zz=window.AudioContext||window.webkitAudioContext;let Zs=null;const In=new class extends cr{constructor(){super(...arguments),_e(this,"prevState",void 0),_e(this,"curState",void 0),_e(this,"currentTime",void 0),_e(this,"currentTimeStuckAt",void 0),_e(this,"interruptDetectorTrack",void 0),_e(this,"onLocalAudioTrackMute",()=>{V.info("ios15-interruption-start"),this.emit(Ri.IOS_15_16_INTERRUPTION_START)}),_e(this,"onLocalAudioTrackUnmute",async()=>{V.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?V.info("ios15-interruption-end-canceled"):(Zs&&await Zs.suspend(),this.emit(Ri.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(r){V.debug("webaudio bindInterruptDetectorTrack ".concat(r.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=r,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(r){V.debug("webaudio unbindInterruptDetectorTrack ".concat(r.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===r&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Ng(){if(!Zs){if(function(){if(!zz)return void V.error("your browser is not support web audio");V.info("create audio context");const r=$n({},oe("WEBAUDIO_INIT_OPTIONS"));V.debug("audio context init option:",JSON.stringify(r)),Zs=new zz(r),In.curState=Zs.state,Zs.onstatechange=()=>{In.prevState=In.curState,In.curState=Zs?Zs.state:void 0;const{prevState:a,curState:s}=In,l=s==="running",d=s==="interrupted",f=a==="running",m=a==="suspended",y=a==="interrupted",_=an().osVersion;(oa()||uc())&&f&&d&&(V.info("ios".concat(_,"-interruption-start")),In.emit(Ri.IOS_INTERRUPTION_START)),(oa()||uc())&&(m||y)&&l&&(V.info("ios".concat(_,"-interruption-end")),In.emit(Ri.IOS_INTERRUPTION_END)),a!==s&&In.emit(Ri.STATE_CHANGE,s,a)},setInterval(()=>{var a;const s=(a=Zs)===null||a===void 0?void 0:a.currentTime;In.currentTime!==s?(In.currentTimeStuckAt&&(V.debug("AudioContext current time resume at ".concat(s)),In.currentTimeStuckAt=void 0),In.currentTime=s):(s!==In.currentTimeStuckAt&&(it.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:s},tag:rr.TRACER}).onSuccess(),V.warning("AudioContext current time stuck at ".concat(s))),In.currentTimeStuckAt=s)},5e3),async function(a){const s=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let l,d=!1,f=!1,m=!1;function y($){a.state==="running"?_(!1):oa()||uc()?a.state==="suspended"&&(_(!0),$&&a.resume().then(S,S)):a.state!=="closed"&&(_(!0),$&&a.resume().then(S,S))}function _($){if(d!==$){d=$;for(let G=0,ne=s;G<ne.length;G+=1){const te=ne[G];$?window.addEventListener(te,x,{capture:!0,passive:!0}):window.removeEventListener(te,x,{capture:!0,passive:!0})}}}function S(){y(!1)}function x(){y(!0)}function A($){if(!m)if(l.paused)if($){let G;I(!1),m=!0;try{G=l.play(),G?G.then(L,L):(l.addEventListener("playing",L),l.addEventListener("abort",L),l.addEventListener("error",L))}catch{L()}}else I(!0);else I(!1)}function I($){if(f!==$){f=$;for(let G=0,ne=s;G<ne.length;G++){const te=ne[G];$?window.addEventListener(te,K,{capture:!0,passive:!0}):window.removeEventListener(te,K,{capture:!0,passive:!0})}}}function L(){l.removeEventListener("playing",L),l.removeEventListener("abort",L),l.removeEventListener("error",L),m=!1,A(!1)}function K(){A(!0)}if(oa()){const $=a.createMediaStreamDestination(),G=document.createElement("div");G.innerHTML="<audio x-webkit-airplay='deny'></audio>",l=G.children.item(0),l.controls=!1,l.disableRemotePlayback=!0,l.preload="auto",l.srcObject=$.stream,A(!0)}In.on(Ri.STATE_CHANGE,function(){y(!0)}),y(!1)}(Zs)}(),!Zs)throw new we(ie.NOT_SUPPORTED,"can not create audio context");return Zs}return Zs}function up(r){if(function(){if(Bj!==null)return Bj;const l=Ng(),d=l.createBufferSource(),f=l.createGain(),m=l.createGain();d.connect(f),d.connect(m),d.disconnect(f);let y=!1;try{d.disconnect(f)}catch{y=!0}return d.disconnect(),Bj=y,y}())return;const a=r.connect,s=r.disconnect;r.connect=(l,d,f)=>{var m;return r._inputNodes||(r._inputNodes=[]),Be(m=r._inputNodes).call(m,l)||(l instanceof AudioNode?(r._inputNodes.push(l),a.call(r,l,d,f)):a.call(r,l,d)),r},r.disconnect=(l,d,f)=>{s.call(r),l?zx(r._inputNodes,l):r._inputNodes=[];for(const m of r._inputNodes)a.call(r,m)}}let Bj=null;function $j(r,a){let s=!1;const l=1/a;if(oe("DISABLE_WEBAUDIO")){const d=window.setInterval(()=>{s?window.clearInterval(d):r(performance.now()/1e3)},1e3*l)}else{const d=Ng();let f=d.createGain();f.gain.value=0,f.connect(d.destination);const m=()=>{if(s)return void(f=null);const y=d.createOscillator();y.onended=m,y.connect(f),y.start(0),y.stop(d.currentTime+l),r(d.currentTime)};m()}return()=>{s=!0}}class Kz{constructor(){_e(this,"context",void 0),_e(this,"analyserNode",void 0),_e(this,"sourceNode",void 0),this.context=Ng(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(a){if(a!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=a,a==null||a.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||oa()||uc()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const a=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(a);else{const l=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(l);for(let d=0;d<a.length;++d)a[d]=l[d]/128-1}const s=rc(a).call(a,(l,d)=>l+d*d,0)/a.length;return Math.max(10*Math.log10(s)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var a,s;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(s=this.sourceNode)===null||s===void 0||s.connect(this.analyserNode)}catch{V.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class qz extends cr{get processSourceNode(){return this.sourceNode}set processedNode(a){var s;if(!this.isDestroyed&&this._processedNode!==a){try{var l;(l=this.sourceNode)===null||l===void 0||l.disconnect(this.outputNode)}catch{}(s=this._processedNode)===null||s===void 0||s.disconnect(),this._processedNode=a,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),_e(this,"outputNode",void 0),_e(this,"outputTrack",void 0),_e(this,"isPlayed",!1),_e(this,"sourceNode",void 0),_e(this,"context",void 0),_e(this,"audioBufferNode",void 0),_e(this,"destNode",void 0),_e(this,"audioOutputLevel",0),_e(this,"volumeLevelAnalyser",void 0),_e(this,"_processedNode",void 0),_e(this,"playNode",void 0),_e(this,"isDestroyed",!1),_e(this,"onNoAudioInput",void 0),_e(this,"isNoAudioInput",!1),_e(this,"_noAudioInputCount",0),this.context=Ng(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),up(this.outputNode),this.volumeLevelAnalyser=new Kz}startGetAudioBuffer(a){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(a),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=s=>{this.emit(Xs.ON_AUDIO_BUFFER,function(l){for(let d=0;d<l.outputBuffer.numberOfChannels;d+=1){const f=l.outputBuffer.getChannelData(d);for(let m=0;m<f.length;m+=1)f[m]=0}return l.inputBuffer}(s))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!un().webAudioMediaStreamDest)throw new we(ie.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(a){this.context.state!=="running"&&Kx(()=>{In.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=a||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(a>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;oa()||uc()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const s=this.volumeLevelAnalyser.getAnalyserNode();let l;s.getFloatTimeDomainData?(l=new Float32Array(s.fftSize),s.getFloatTimeDomainData(l)):(l=new Uint8Array(s.fftSize),s.getByteTimeDomainData(l));let d=!1;for(let f=0;f<l.length;f++)l[f]!==0&&(d=!0);return d?(this.isNoAudioInput=!1,!0):(await Ti(200),await this.checkHasAudioInput(a?a+1:1)&&d)}getAudioVolume(){return this.outputNode.gain.value}setVolume(a){this.outputNode.gain.setValueAtTime(a,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var a,s;(a=this.processedNode)===null||a===void 0||a.disconnect(),(s=this.sourceNode)===null||s===void 0||s.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var a;this.processedNode?(a=this.processedNode)===null||a===void 0||a.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class Yz extends qz{get isFreeze(){return!1}constructor(a,s,l){var d;if(super(),_e(this,"sourceNode",void 0),_e(this,"track",void 0),_e(this,"clonedTrack",void 0),_e(this,"audioElement",void 0),_e(this,"isCurrentTrackCloned",!1),_e(this,"isRemoteTrack",!1),_e(this,"originVolumeLevelAnalyser",void 0),_e(this,"rebuildWebAudio",async()=>{if(V.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void V.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>V.info("resume success")),V.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const y=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?y.stop():this.isCurrentTrackCloned=!0;const _=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(_),up(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const S=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(S,this.context.currentTime),up(this.outputNode),this.emit(Xs.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=_,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),a.kind!=="audio")throw new we(ie.UNEXPECTED_ERROR);this.track=a;const f=new MediaStream([this.track]);if(this.isRemoteTrack=!!s,this.sourceNode=this.context.createMediaStreamSource(f),up(this.sourceNode),l){const y=l.clone();y.enabled=!0,this.clonedTrack=y,V.debug("create an unmuted track ".concat(y.id," from the original track ").concat(l.id," to get the volume"));const _=this.context.createMediaStreamSource(new MediaStream([y]));up(_),this.originVolumeLevelAnalyser=new Kz,this.originVolumeLevelAnalyser.updateSource(_)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=f;const m=an();s&&m.os===oi.IOS&&Number((d=m.osVersion)===null||d===void 0?void 0:d.split(".")[0])<15&&(In.on(Ri.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(y=>{y||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(a){this.sourceNode.disconnect(),this.track=a,this.isCurrentTrackCloned=!1;const s=new MediaStream([a]);this.sourceNode=this.context.createMediaStreamSource(s),up(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Xs.UPDATE_SOURCE),this.audioElement.srcObject=s}destroy(){var a;this.audioElement.srcObject=null,this.audioElement.remove(),In.off("state-change",this.rebuildWebAudio),(a=this.originVolumeLevelAnalyser)===null||a===void 0||a.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(a){return this.context.createMediaStreamSource(new MediaStream([a]))}updateOriginTrack(a){const s=a.clone();s.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=s),V.debug("create an unmuted track ".concat(s.id," from the original track ").concat(a.id," to get the volume"));const l=this.context.createMediaStreamSource(new MediaStream([s]));up(l),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(l)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function Xz(r,a,s){const l=(f,m)=>f?typeof f!="number"?f.max||f.exact||f.ideal||f.min||m:f:m,d={audio:!!s&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxHeight:l(a.height,1080),maxWidth:l(a.width,1920)}}};return a.frameRate&&typeof a.frameRate!="number"?(d.video.mandatory.maxFrameRate=a.frameRate.max,d.video.mandatory.minFrameRate=a.frameRate.min):typeof a.frameRate=="number"&&(d.video.mandatory.maxFrameRate=a.frameRate),await navigator.mediaDevices.getUserMedia(d)}async function iIe(r,a){const s=await Jz(r.mediaSource),{sourceId:l,audio:d}=await function(f){let m=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new He((y,_)=>{const S=document.createElement("div");S.innerText="share screen",S.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const x=document.createElement("div");x.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const A=document.createElement("div");A.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",A.setAttribute("style","height: 12%;");const I=document.createElement("div");I.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const L=document.createElement("div");L.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const K=document.createElement("button");K.innerHTML="cancel",K.setAttribute("style","width: 85px;"),K.onclick=()=>{document.body.removeChild(ne);const te=new Error("NotAllowedError");te.name="NotAllowedError",_(te)};let $=m;const G=document.createElement("div");if(m){const te=document.createElement("input");te.setAttribute("type","checkbox");const ce=document.createElement("span");te.setAttribute("style","margin-right: 6px;"),ce.innerText="Share audio",te.checked=$,te.onchange=()=>{$=te.checked},G.appendChild(te),G.appendChild(ce)}L.appendChild(G),L.appendChild(K),x.appendChild(A),x.appendChild(I),x.appendChild(L);const ne=document.createElement("div");ne.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),ne.appendChild(S),ne.appendChild(x),document.body.appendChild(ne),f.map(te=>{if(te.id){const ce=document.createElement("div");ce.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let pe=te.thumbnail;try{const{width:fe}=pe.getSize();fe>1920&&(pe=pe.resize({width:1920}))}catch(fe){throw fe&&fe.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),fe}ce.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+pe.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+te.name.replace(/[\u00A0-\u9999<>\&]/g,function(fe){return"&#"+fe.charCodeAt(0)+";"})+"</span>",ce.onclick=()=>{document.body.removeChild(ne),y({sourceId:te.id,audio:$})},I.appendChild(ce)}})})}(s,a);return await Xz(l,r,d)}async function Jz(r){let a=["window","screen"];r!=="application"&&r!=="window"||(a=["window"]),r==="screen"&&(a=["screen"]);const s=lz();if(!s)throw console.error("failed to fetch electron, please mount it to window"),new we(ie.ELECTRON_IS_NULL);let l=null;try{var d;l=((d=s.desktopCapturer)===null||d===void 0?void 0:d.getSources({types:a}))||s.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:a})}catch{l=null}l&&l.then||(l=new He((f,m)=>{s.desktopCapturer.getSources({types:a},(y,_)=>{y?m(y):f(_)})}));try{return await l}catch(f){throw new we(ie.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,f.toString())}}const Wj=new Hi("safari");let Zz=!1,Qz=!1;async function Qs(r,a){let s=0,l=null;for(;s<2;)try{l=await aIe(r,a,s>0);break}catch(d){if(d instanceof we)throw V.error("[".concat(a,"] ").concat(d.toString())),d;const f=iT(d.name||d.code||d,d.message);if(f.code===ie.MEDIA_OPTION_INVALID){V.debug("[".concat(a,"] detect media option invalid, retry")),s+=1,await Ti(500);continue}throw V.error("[".concat(a,"] ").concat(f.toString())),f}if(!l)throw new we(ie.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return l}async function aIe(r,a,s){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new we(ie.NOT_SUPPORTED,"can not find getUserMedia");s&&(r.video&&(delete r.video.width,delete r.video.height),r.screen&&(delete r.screen.width,delete r.screen.height));const l=un(),d=new MediaStream;if(r.audioSource&&d.addTrack(r.audioSource),r.videoSource&&d.addTrack(r.videoSource),!r.audio&&!r.video&&!r.screen)return V.debug("Using Video Source/ Audio Source"),d;if(r.screen)if(lz())r.screen.sourceId?Ag(d,await Xz(r.screen.sourceId,r.screen,!!r.screenAudio)):Ag(d,await iIe(r.screen,!!r.screenAudio));else if(nd()&&r.screen.extensionId&&r.screen.mandatory){if(!l.getStreamFromExtension)throw new we(ie.NOT_SUPPORTED,"This browser does not support screen sharing");V.debug("[".concat(a,'] Screen access on chrome stable, looking for extension"'));const I=await(m=r.screen.extensionId,y=a,new He((L,K)=>{try{chrome.runtime.sendMessage(m,{getStream:!0},$=>{if(!$||!$.streamId)return V.error("[".concat(y,"] No response from Chrome Plugin. Plugin not installed properly"),$),void K(new we(ie.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));L($.streamId)})}catch($){V.error("[".concat(y,"] AgoraRTC screensharing plugin is not accessible(").concat(m,")"),$.toString()),K(new we(ie.CHROME_PLUGIN_NOT_INSTALL))}}));r.screen.mandatory.chromeMediaSourceId=I,Ag(d,await navigator.mediaDevices.getUserMedia({video:{mandatory:r.screen.mandatory}}))}else if(l.getDisplayMedia){var f;r.screen.mediaSource&&Bz(r.screen.mediaSource);const I={width:r.screen.width,height:r.screen.height,frameRate:r.screen.frameRate,displaySurface:(f=r.screen.displaySurface)!==null&&f!==void 0?f:r.screen.mediaSource==="screen"?"monitor":r.screen.mediaSource},{selfBrowserSurface:L,surfaceSwitching:K,systemAudio:$,preferCurrentTab:G}=r.screen,ne={selfBrowserSurface:L,surfaceSwitching:K,systemAudio:$,preferCurrentTab:G};!L&&delete ne.selfBrowserSurface,!K&&delete ne.surfaceSwitching,!$&&delete ne.systemAudio,!G&&delete ne.preferCurrentTab,V.debug("[".concat(a,"] getDisplayMedia:"),JSON.stringify({video:I,audio:r.screenAudio,controls:ne})),Ag(d,await navigator.mediaDevices.getDisplayMedia($n({video:I,audio:r.screenAudio},ne)))}else{if(!dr())throw V.error("[".concat(a,"] This browser does not support screenSharing")),new we(ie.NOT_SUPPORTED,"This browser does not support screen sharing");{r.screen.mediaSource&&Bz(r.screen.mediaSource);const I={video:{mediaSource:r.screen.mediaSource,width:r.screen.width,height:r.screen.height,frameRate:r.screen.frameRate}};V.debug("[".concat(a,"] getUserMedia: ").concat(JSON.stringify(I))),Ag(d,await navigator.mediaDevices.getUserMedia(I))}}var m,y;if(!r.video&&!r.audio)return d;let _={video:r.video,audio:r.audio},S=oe("MEDIA_DEVICE_CONSTRAINTS");if(S)try{typeof S=="string"&&(S=JSON.parse(S)),_=_j(_,S)}catch{}V.debug("[".concat(a,"] GetUserMedia"),JSON.stringify(_)),an();let x,A=null;(ji()||oa()||Gx())&&(A=await Wj.lock());try{x=await navigator.mediaDevices.getUserMedia(_)}catch(I){throw A&&A(),I}return _.audio&&(Zz=!0),_.video&&(Qz=!0),Ag(d,x),A&&A(),d}function iT(r,a){switch(r){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new we(ie.MEDIA_OPTION_INVALID,"".concat(r,": ").concat(a));case"NotFoundError":case"DevicesNotFoundError":return new we(ie.DEVICE_NOT_FOUND,"".concat(r,": ").concat(a));case"NotSupportedError":return new we(ie.NOT_SUPPORTED,"".concat(r,": ").concat(a));case"NotReadableError":return new we(ie.NOT_READABLE,"".concat(r,": ").concat(a));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new we(ie.PERMISSION_DENIED,"".concat(r,": ").concat(a));case"ConstraintNotSatisfiedError":return new we(ie.CONSTRAINT_NOT_SATISFIED,"".concat(r,": ").concat(a));default:return V.error("getUserMedia unexpected error",r),new we(ie.UNEXPECTED_ERROR,"".concat(r,": ").concat(a))}}function Ag(r,a){const s=r.getVideoTracks()[0],l=r.getAudioTracks()[0],d=a.getVideoTracks()[0],f=a.getAudioTracks()[0];f&&(l&&r.removeTrack(l),r.addTrack(f)),d&&(s&&r.removeTrack(s),r.addTrack(d))}const eo=new class extends cr{get state(){return this._state}set state(r){r!==this._state&&(this.emit(lp.STATE_CHANGE,r),this._state=r)}constructor(){super(),_e(this,"_state",mb.IDLE),_e(this,"isAccessMicrophonePermission",!1),_e(this,"isAccessCameraPermission",!1),_e(this,"lastAccessMicrophonePermission",!1),_e(this,"lastAccessCameraPermission",!1),_e(this,"checkdeviceMatched",!1),_e(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(oe("ENUMERATE_DEVICES_INTERVAL")||(Hx()||Wx()===oi.HARMONY_OS)&&rd())&&this.updateDevicesInfo()},oe("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(r=>V.error(r.toString()))}async enumerateDevices(r,a){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new we(ie.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const l=await navigator.mediaDevices.enumerateDevices(),d=this.checkMediaDeviceInfoIsOk(l);let f=!this.isAccessMicrophonePermission&&r,m=!this.isAccessCameraPermission&&a;d.audio&&(f=!1),d.video&&(m=!1);let y=null,_=null,S=null;if(!s&&(f||m)){if(Wj.isLocked&&(V.debug("[device manager] wait GUM lock"),(await Wj.lock())(),V.debug("[device manager] GUM unlock")),Zz&&(f=!1,this.isAccessMicrophonePermission=!0),Qz&&(m=!1,this.isAccessCameraPermission=!0),V.debug("[device manager] check media device permissions",r,a,f,m),f&&m){try{S=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(x){const A=iT(x.name||x.code||x,x.message);if(A.code===ie.PERMISSION_DENIED)throw A;V.warning("getUserMedia failed in getDevices",A)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(f){try{y=await navigator.mediaDevices.getUserMedia({audio:r})}catch(x){const A=iT(x.name||x.code||x,x.message);if(A.code===ie.PERMISSION_DENIED)throw A;V.warning("getUserMedia failed in getDevices",A)}this.isAccessMicrophonePermission=!0}else if(m){try{_=await navigator.mediaDevices.getUserMedia({video:a})}catch(x){const A=iT(x.name||x.code||x,x.message);if(A.code===ie.PERMISSION_DENIED)throw A;V.warning("getUserMedia failed in getDevices",A)}this.isAccessCameraPermission=!0}V.debug("[device manager] mic permission",r,"cam permission",a)}try{const x=await navigator.mediaDevices.enumerateDevices();return y&&y.getTracks().forEach(A=>A.stop()),_&&_.getTracks().forEach(A=>A.stop()),S&&S.getTracks().forEach(A=>A.stop()),y=null,_=null,S=null,x}catch(x){return y&&y.getTracks().forEach(A=>A.stop()),_&&_.getTracks().forEach(A=>A.stop()),S&&S.getTracks().forEach(A=>A.stop()),y=null,_=null,S=null,new we(ie.ENUMERATE_DEVICES_FAILED,x.toString()).throw()}}async getRecordingDevices(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,r)).filter(a=>a.kind==="audioinput")}async getCamerasDevices(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,r)).filter(a=>a.kind==="videoinput")}async getSpeakers(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,r)).filter(a=>a.kind==="audiooutput")}searchDeviceIdByName(r){let a=null;return this.deviceInfoMap.forEach(s=>{s.device.label===r&&(a=s.device.deviceId)}),a}async getDeviceById(r){const a=(await this.enumerateDevices(!0,!0,!0)).find(s=>s.deviceId===r);if(!a)throw new we(ie.DEVICE_NOT_FOUND,"deviceId: ".concat(r));return a}async init(){this.state=mb.INITING;try{await this.updateDevicesInfo(),this.state=mb.INITEND}catch(r){throw V.warning("Device Detection functionality cannot start properly.",r.toString()),this.state=mb.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new we(ie.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),r}}async updateDevicesInfo(){const r=await this.enumerateDevices(!0,!0,!0),a=Date.now(),s=[];if(r[0]&&r[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const d=r.find(m=>m.kind==="audioinput"&&m.deviceId==="default"),f=r.find(m=>m.kind==="audiooutput"&&m.deviceId==="default");d&&f?f.groupId===d.groupId?V.debug("[device-check] default input ".concat(d.label," and output ").concat(f.label," is the same group")):V.debug("[device-check] default input ".concat(d.label," and output ").concat(f.label," is not the same group")):V.debug("[device-check] default input or output not found")}const l=this.checkMediaDeviceInfoIsOk(r);if(r.forEach(d=>{if(!d.deviceId)return;const f=this.deviceInfoMap.get("".concat(d.kind,"_").concat(d.deviceId));if((f?f.state:"INACTIVE")!=="ACTIVE"){const m={initAt:a,updateAt:a,device:d,state:"ACTIVE"};this.deviceInfoMap.set("".concat(d.kind,"_").concat(d.deviceId),m),s.push(m)}f&&(f.updateAt=a)}),this.deviceInfoMap.forEach((d,f)=>{d.state==="ACTIVE"&&d.updateAt!==a&&(d.state="INACTIVE",s.push(d))}),this.state!==mb.INITEND)return l.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(l.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));s.forEach(d=>{switch(d.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lp.RECORDING_DEVICE_CHANGED,d);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(lp.CAMERA_DEVICE_CHANGED,d);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lp.PLAYOUT_DEVICE_CHANGED,d)}}),l.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),l.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(r){const a=r.filter(d=>d.kind==="audioinput"),s=r.filter(d=>d.kind==="videoinput"),l={audio:!1,video:!1};for(const d of a)if(d.label&&d.deviceId){l.audio=!0;break}for(const d of s)if(d.label&&d.deviceId){l.video=!0;break}return l}};let Gj=!1;const to=new class extends cr{constructor(){super(...arguments),_e(this,"onAutoplayFailed",void 0),_e(this,"onAudioAutoplayFailed",void 0)}};function e9(){if(an(),!Gj){const r=a=>{a.preventDefault(),Gj=!1,ab()?document.body.removeEventListener("click",r,!0):(document.body.removeEventListener("touchstart",r,!0),document.body.removeEventListener("mousedown",r,!0))};Gj=!0,ab()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0)),V.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),to.onAutoplayFailed?to.onAutoplayFailed():to.onAudioAutoplayFailed?V.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):V.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),to.emit("autoplay-failed")}}function t9(r,a,s,l){if(!r)return;const d=it.getBaseInfoBySessionId(r);if(!d)return;const f=d.info,m=Date.now(),y=$n($n({},f),{},{vid:f.vid===void 0?0:Number(f.vid),lts:m,elapse:m-d.startTime,cbRegistered:to.onAutoplayFailed||to.onAudioAutoplayFailed?1:-1,errorMsg:s,mediaType:a,trackId:l,extend:void 0});it.send({type:Qn.AUTOPLAY_FAILED,data:y},!0)}const sIe=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],qa=new class{constructor(){_e(this,"onAutoplayFailed",void 0),_e(this,"elementMap",new Map),_e(this,"elementStateMap",new Map),_e(this,"elementsNeedToResume",[]),_e(this,"sinkIdMap",new Map),_e(this,"autoResumeAfterInterruption",r=>{Array.from(this.elementMap.entries()).forEach(a=>{let[s,l]=a;const d=this.elementStateMap.get(s),f=l.srcObject.getAudioTracks()[0],m=f&&f.readyState;if(V.debug("resume after interrupted, ele: ".concat(d," audio: ").concat(m," ").concat(r)),m==="live"){if(r)return l.pause(),void l.play();if(In.curState==="running")return mg()?(l.pause(),void l.play()):void(d&&d==="paused"&&l.play())}})}),_e(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(r=>{let[a,s]=r;const l=s.srcObject.getAudioTracks()[0];l&&l.readyState==="live"&&(V.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),s.pause(),s.play())})}),this.autoResumeAudioElement(),In.on(Ri.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),In.on(Ri.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),In.on(Ri.STATE_CHANGE,()=>{oa()&&In.prevState==="suspended"&&In.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(r,a){const s=this.elementMap.get(r);if(this.sinkIdMap.set(r,a),s)try{await s.setSinkId(a)}catch(l){throw new we(ie.PERMISSION_DENIED,"can not set sink id: "+l.toString())}}play(r,a,s,l){if(this.elementMap.has(a))return;const d=document.createElement("audio");d.autoplay=!0,d.srcObject=new MediaStream([r]),this.bindAudioElementEvents(a,d),this.elementMap.set(a,d),this.elementStateMap.set(a,zi.INIT),this.setVolume(a,s);const f=this.sinkIdMap.get(a);if(f)try{d.setSinkId(f).catch(y=>{V.warning("[".concat(a,"] set sink id failed"),y.toString())})}catch(y){V.warning("[".concat(a,"] set sink id failed"),y.toString())}const m=d.play();m&&m.then&&m.catch(y=>{l&&t9(l,"audio",y.message,a),V.warning("audio element play warning",y.toString()),this.elementMap.has(a)&&y.name==="NotAllowedError"&&(V.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(d),Kx(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),e9()}))})}updateTrack(r,a){const s=this.elementMap.get(r);s&&(s.srcObject=new MediaStream([a]))}isPlaying(r){return this.elementMap.has(r)&&this.elementStateMap.get(r)==="playing"}setVolume(r,a){const s=this.elementMap.get(r);s&&(a=Math.max(0,Math.min(100,a)),s.volume=a/100)}stop(r){const a=this.elementMap.get(r);if(this.sinkIdMap.delete(r),!a)return;const s=this.elementsNeedToResume.indexOf(a);this.elementsNeedToResume.splice(s,1),a.srcObject=null,a.remove(),this.elementMap.delete(r),this.elementStateMap.delete(r)}bindAudioElementEvents(r,a){sIe.forEach(s=>{a.addEventListener(s,l=>{const d=this.elementStateMap.get(r),f=l.type==="pause"?"paused":l.type;if(V.debug("[".concat(r,"] audio-element-status change ").concat(d," => ").concat(f)),l.type==="error"){const m=a==null?void 0:a.error;m&&V.error("[".concat(r,"] media error, code: ").concat(m.code,", message: ").concat(m.message))}this.elementStateMap.set(r,f)})})}getPlayerState(r){return this.elementStateMap.get(r)||"uninit"}autoResumeAudioElement(){const r=()=>{this.elementsNeedToResume.forEach(a=>{a.play().then(s=>{V.debug("Auto resume audio element success")}).catch(s=>{V.warning("Auto resume audio element failed!",s)})}),this.elementsNeedToResume=[]};new He(a=>{document.body?a():window.addEventListener("load",()=>a())}).then(()=>{ab()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0))})}};function gr(){return function(r,a,s){const l=s.value;return typeof l=="function"&&(s.value=function(){this._isClosed&&new we(ie.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",V);for(var d=arguments.length,f=new Array(d),m=0;m<d;m++)f[m]=arguments[m];const y=l.apply(this,f);return y instanceof He?new He((_,S)=>{y.then(_).catch(S)}):y}),s}}class n9 extends cr{constructor(a){super(),_e(this,"name","VideoProcessorDestination"),_e(this,"ID","0"),_e(this,"_source",void 0),_e(this,"videoContext",void 0),_e(this,"inputTrack",void 0),this.videoContext=a}get kind(){return"video"}get enabled(){return!0}pipe(){throw new we(ie.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new we(ie.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(a){if(a.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);a.track&&a.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=a.track,this.emit(ja.ON_TRACK,a.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(ja.ON_TRACK,void 0)}}class r9 extends cr{set chained(a){this._chained=a}get chained(){return this._chained}constructor(a,s){super(),_e(this,"constraintsMap",new Map),_e(this,"statsRegistry",[]),_e(this,"usageRegistry",[]),_e(this,"trackId",void 0),_e(this,"direction",void 0),_e(this,"_chained",!1),this.trackId=a,this.direction=s}async getConstraints(){return await Li(this,Js.REQUEST_CONSTRAINTS)}async requestApplyConstraints(a,s){var l;return V.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),a&&this.constraintsMap.set(s,a),Ln(this,Js.REQUEST_UPDATE_CONSTRAINTS,Array.from(Cs(l=this.constraintsMap).call(l)))}async requestRevertConstraints(a){var s;if(this.constraintsMap.has(a))return V.info("processor ".concat(a.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(a),Ln(this,Js.REQUEST_UPDATE_CONSTRAINTS,Array.from(Cs(s=this.constraintsMap).call(s)))}registerStats(a,s,l){this.statsRegistry.find(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s)||this.statsRegistry.push({processorName:a.name,processorID:a.ID,type:s,cb:l})}unregisterStats(a,s){const l=this.statsRegistry.findIndex(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s);l!==-1&&this.statsRegistry.splice(l,1)}gatherStats(){const a=[];for(const{processorID:s,processorName:l,type:d,cb:f}of this.statsRegistry)try{const m=f();a.push({processorID:s,processorName:l,type:d,stats:m})}catch(m){V.error(new we(ie.UNEXPECTED_ERROR,m.message))}return a}registerUsage(a,s){this.usageRegistry.find(l=>l.processorID===a.ID&&l.processorName===a.name)||this.usageRegistry.push({processorID:a.ID,processorName:a.name,cb:s})}unregisterUsage(a){const s=this.usageRegistry.findIndex(l=>l.processorID===a.ID&&l.processorName===a.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const a=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let l=s();l instanceof He&&(l=await l),a.push($n($n({},l),{},{direction:this.direction}))}catch(l){V.error("gather extension usage error",l)}return a}getDirection(){return this.direction}}class i9 extends cr{constructor(a){super(),_e(this,"name","AudioProcessorDestination"),_e(this,"ID","0"),_e(this,"inputTrack",void 0),_e(this,"inputNode",void 0),_e(this,"audioProcessorContext",void 0),_e(this,"_source",void 0),this.audioProcessorContext=a}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new we(ie.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new we(ie.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(ja.ON_TRACK,void 0),this.emit(ja.ON_NODE,void 0)}updateInput(a){if(a.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);a.track&&this.inputTrack!==a.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=a.track,this.emit(ja.ON_TRACK,this.inputTrack)),a.node&&this.inputNode!==a.node&&(this.audioProcessorContext.chained=!0,this.inputNode=a.node,this.emit(ja.ON_NODE,this.inputNode))}}class a9 extends cr{set chained(a){this._chained=a}get chained(){return this._chained}constructor(a,s,l){super(),_e(this,"constraintsMap",new Map),_e(this,"statsRegistry",[]),_e(this,"audioContext",void 0),_e(this,"trackId",void 0),_e(this,"direction",void 0),_e(this,"usageRegistry",[]),_e(this,"_chained",!1),this.audioContext=a,this.trackId=s,this.direction=l}async getConstraints(){return Li(this,Js.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(a,s){var l;return V.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),a&&this.constraintsMap.set(s,a),Ln(this,Js.REQUEST_UPDATE_CONSTRAINTS,Array.from(Cs(l=this.constraintsMap).call(l)))}async requestRevertConstraints(a){var s;if(this.constraintsMap.has(a))return this.constraintsMap.delete(a),Ln(this,Js.REQUEST_UPDATE_CONSTRAINTS,Array.from(Cs(s=this.constraintsMap).call(s)))}registerStats(a,s,l){this.statsRegistry.find(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s)||this.statsRegistry.push({processorName:a.name,processorID:a.ID,type:s,cb:l})}unregisterStats(a,s){const l=this.statsRegistry.findIndex(d=>d.processorID===a.ID&&d.processorName===a.name&&d.type===s);l!==-1&&this.statsRegistry.splice(l,1)}gatherStats(){const a=[];for(const{processorID:s,processorName:l,type:d,cb:f}of this.statsRegistry)try{const m=f();a.push({processorID:s,processorName:l,type:d,stats:m})}catch(m){V.error(new we(ie.UNEXPECTED_ERROR,m.message))}return a}registerUsage(a,s){this.usageRegistry.find(l=>l.processorID===a.ID&&l.processorName===a.name)||this.usageRegistry.push({processorID:a.ID,processorName:a.name,cb:s})}unregisterUsage(a){const s=this.usageRegistry.findIndex(l=>l.processorID===a.ID&&l.processorName===a.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const a=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let l=s();l instanceof He&&(l=await l),a.push($n($n({},l),{},{direction:this.direction}))}catch(l){V.error("gather extension usage error",l)}return a}getDirection(){return this.direction}}class Hj extends cr{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),_e(this,"context",void 0),_e(this,"processSourceNode",void 0),_e(this,"outputTrack",void 0),_e(this,"processedNode",void 0),_e(this,"clonedTrack",void 0),_e(this,"outputNode",void 0),this.outputNode=new oIe}setVolume(){}createOutputTrack(){throw new we(ie.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class oIe{disconnect(){}connect(){}}function s9(r){return new He((a,s)=>{let l=!1;const d=document.createElement("video");d.setAttribute("autoplay",""),d.setAttribute("muted",""),d.muted=!0,d.autoplay=!0,d.setAttribute("playsinline",""),d.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(d);const f=oa()?"canplay":"playing";d.addEventListener(f,()=>{const m=d.videoWidth,y=d.videoHeight;!m&&dr()||(l=!0,d.srcObject=null,d.remove(),a([m,y]))}),d.srcObject=new MediaStream([r]),d.play().catch(qx),setTimeout(()=>{l||(d.srcObject=null,d.remove(),a([d.videoWidth,d.videoHeight]))},4e3)})}function aT(r){const a={};r.facingMode&&(a.facingMode=r.facingMode),r.cameraId&&(a.deviceId={exact:r.cameraId});const s=fc(r.encoderConfig);return s.width!=null&&(a.width=s.width),s.height!=null&&(a.height=s.height),!iz()&&s.frameRate&&(a.frameRate=s.frameRate),XH()&&typeof a.frameRate=="object"&&(a.frameRate.max=60),dr()&&(a.frameRate={ideal:30,max:30}),a}function o9(r){const a={};return iz()||(r.AGC!==void 0&&(a.autoGainControl=r.AGC),r.AEC!==void 0&&(a.echoCancellation=r.AEC),r.ANS!==void 0&&(a.noiseSuppression=r.ANS,nd()&&r.ANS&&(a.googHighpassFilter=r.ANS))),a}function c9(r){const a=o9(r);if(r.encoderConfig){const s=nT(r.encoderConfig);a.channelCount=s.stereo?2:1,a.sampleRate=s.sampleRate,a.sampleSize=s.sampleSize}return r.microphoneId&&(a.deviceId={exact:r.microphoneId}),Hx()&&(a.sampleRate=void 0),a}const cIe=r=>{const a=r._encoderConfig;if(!a)return;const{frameRate:s,width:l,height:d}=r.getMediaStreamTrackSettings();let{frameRate:f=s,width:m=l,height:y=d}=a;if(!f||!m||!y)return;m=yg(m),y=yg(y),f=yg(f);const{max:_,min:S}=function(L,K,$){const G=200*Math.pow($/15,.6)*Math.pow(L*K/640/360,.75);return{min:Math.floor(G),max:Math.floor(4*G)}}(m,y,f),{bitrateMax:x,bitrateMin:A}=a||{};x||V.debug("calculate bitrate: [w: ".concat(m,", h: ").concat(y,", fps: ").concat(f,"] => [brMax: ").concat(x,", brMin: ").concat(A,"]"));const{maxFramerate:I}=oe("ENCODER_CONFIG_LIMIT");return I&&typeof I=="number"&&(f=Math.min(f,I)),{frameRate:f,bitrateMax:x||_,bitrateMin:A||S,scaleResolutionDownBy:1,scale:0}},l9=async(r,a,s)=>await(async(l,d,f)=>{const m=function(S){const x=[];for(let A=0;A<S.length;A+=2)x.push(parseInt(S.slice(A,A+2),16));return Uint8Array.from(x)}(bz(""+d+f)).slice(0,16),y=m.slice(0,12),_=await window.crypto.subtle.importKey("raw",m,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:y},_,l))})(r.buffer,a,s),zj=r=>{const a=document.createElement("canvas");return a.width=2,a.height=2,new He((s,l)=>{a.toBlob(async d=>{if(a.remove(),d){const f=await u9(d);s({buffer:f,width:a.width,height:a.height})}else l(new we(ie.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},r,1)})},u9=async r=>{const a=await r.arrayBuffer();return new Uint8Array(a)};var d9,h9,f9,p9,m9,g9,v9,y9,_9,b9,E9,w9,S9,x9,T9,C9,R9,N9,lr,A9,I9,O9,P9,k9,j9,ru,D9,L9,M9,U9,F9,V9,B9,$9,W9,G9,H9,z9,K9,Ui;let vr=(d9=Et({argsMap:(r,a)=>[r.getTrackId(),a],throttleTime:300}),h9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),f9=gr(),p9=_g("LocalAudioTrack","_enabledMutex"),m9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),g9=gr(),v9=_g("LocalAudioTrack","_enabledMutex"),y9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),_9=gr(),b9=gr(),E9=gr(),w9=Et({argsMap:r=>[r.getTrackId()]}),S9=gr(),x9=Et({argsMap:r=>[r.getTrackId()]}),T9=gr(),C9=Et({argsMap:r=>[r.getTrackId()]}),R9=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),N9=Et({argsMap:r=>[r.getTrackId()]}),rn((lr=class extends Rg{get _source(){return this.initWebAudio()}set _source(r){this._trackSource=r}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?qa.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(r,a,s,l){super(r,s),_e(this,"trackMediaType",Cg.AUDIO),_e(this,"_encoderConfig",void 0),_e(this,"_trackSource",void 0),_e(this,"metadata",[]),_e(this,"_enabled",!0),_e(this,"_volume",100),_e(this,"_useAudioElement",!0),_e(this,"_bypassWebAudio",!1),_e(this,"processor",void 0),_e(this,"_processorContext",void 0),_e(this,"_processorDestination",void 0),_e(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=a,this._getOriginVolumeLevel=!!l,this._trackSource=new Hj,oe("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),oe("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),ji()&&!Zs?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(r){kn(r,"volume",0,1e3),this._volume=r,this._source.setVolume(r/100),this._useAudioElement&&qa.setVolume(this.getTrackId(),r);try{if(this._bypassWebAudio)return void V.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const a=this._source.createOutputTrack();this._mediaStreamTrack!==a&&(this._mediaStreamTrack=a,Ln(this,et.NEED_REPLACE_TRACK,this).then(()=>{V.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(s=>{V.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),s)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(r){if(!this._useAudioElement||!Fz())throw new we(ie.NOT_SUPPORTED,"your browser does not support setting the audio output device");await qa.setSinkID(this.getTrackId(),r)}async setEnabled(r,a,s){return this._setEnabled(r,a,s)}async _setEnabled(r,a,s){if(!s){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(V.info("[".concat(this.getTrackId(),"] start setEnabled"),r),r){this._originMediaStreamTrack.enabled=!0;try{s||(this._enabled=!0),await Ln(this,et.NEED_ENABLE_TRACK,this),V.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(r," success"))}catch(l){throw s||(this._enabled=!1),V.error("[".concat(this.getTrackId(),"] setEnabled to true error"),l.toString()),l}}else{this._originMediaStreamTrack.enabled=!1,s||(this._enabled=!1);try{await Ln(this,et.NEED_DISABLE_TRACK,this)}catch(l){throw s||(this._enabled=!0),V.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}}}async setMuted(r){r!==this._muted&&(this.stateCheck("muted",r),this._muted=r,this._originMediaStreamTrack.enabled=!r,V.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(r)),r?await Ln(this,et.NEED_MUTE_TRACK,this):await Ln(this,et.NEED_UNMUTE_TRACK,this))}getStats(){return uh(()=>{V.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),qs(this,et.GET_STATS)||$n({},Uj)}setAudioFrameCallback(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!r)return this._source.removeAllListeners(Xs.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(a),this._source.removeAllListeners(Xs.ON_AUDIO_BUFFER),this._source.on(Xs.ON_AUDIO_BUFFER,s=>r(s))}play(){V.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(V.debug("[".concat(this.getTrackId(),"] start audio playback in element")),qa.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){V.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?qa.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];V.debug("[".concat(this.getTrackId(),"] update player source track")),r&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&qa.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(r,a){this._originMediaStreamTrack!==r&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),a&&this._originMediaStreamTrack.stop()),r.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=r,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:r,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,et.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(r))}renewMediaStreamTrack(r){return He.resolve(void 0)}pipe(r){if(this._bypassWebAudio)throw new we(ie.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===r)return r;if(r._source)throw new we(ie.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),r}unpipe(){var r;if(!this.processor)return;const a=this.processor;(r=this._source.processSourceNode)===null||r===void 0||r.disconnect(),this.processor._source=!1,this.processor=void 0,a.reset()}bindProcessorDestinationEvents(r){r.on(ja.ON_TRACK,async a=>{a?a!==this._mediaStreamTrack&&(this._mediaStreamTrack=a,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(a),await Ln(this,et.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,et.NEED_REPLACE_TRACK,this))}),r.on(ja.ON_NODE,a=>{this._source.processedNode=a})}unbindProcessorDestinationEvents(r){r.removeAllListeners(ja.ON_TRACK),r.removeAllListeners(ja.ON_NODE)}bindProcessorContextEvents(r){r.on(Js.REQUEST_CONSTRAINTS,async a=>{a(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(r){r.removeAllListeners(Js.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof Hj&&(this._trackSource=new Yz(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const r=new a9(this._source.context,this.getTrackId(),"local"),a=new i9(r);return this._processorContext=r,this._processorDestination=a,this.bindProcessorContextEvents(r),this.bindProcessorDestinationEvents(a),this._source.on(Xs.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:r})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(qa.stop(this.getTrackId()),this._source.play()),Ln(this,et.NEED_REPLACE_MIXING_TRACK,this).then(()=>{V.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(s=>{V.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),s)})),{processorContext:r,processorDestination:a}}}).prototype,"setVolume",[d9],Object.getOwnPropertyDescriptor(lr.prototype,"setVolume"),lr.prototype),rn(lr.prototype,"setPlaybackDevice",[h9,f9],Object.getOwnPropertyDescriptor(lr.prototype,"setPlaybackDevice"),lr.prototype),rn(lr.prototype,"setEnabled",[p9,m9,g9],Object.getOwnPropertyDescriptor(lr.prototype,"setEnabled"),lr.prototype),rn(lr.prototype,"setMuted",[v9,y9,_9],Object.getOwnPropertyDescriptor(lr.prototype,"setMuted"),lr.prototype),rn(lr.prototype,"getStats",[b9],Object.getOwnPropertyDescriptor(lr.prototype,"getStats"),lr.prototype),rn(lr.prototype,"setAudioFrameCallback",[E9],Object.getOwnPropertyDescriptor(lr.prototype,"setAudioFrameCallback"),lr.prototype),rn(lr.prototype,"play",[w9,S9],Object.getOwnPropertyDescriptor(lr.prototype,"play"),lr.prototype),rn(lr.prototype,"stop",[x9,T9],Object.getOwnPropertyDescriptor(lr.prototype,"stop"),lr.prototype),rn(lr.prototype,"close",[C9],Object.getOwnPropertyDescriptor(lr.prototype,"close"),lr.prototype),rn(lr.prototype,"pipe",[R9],Object.getOwnPropertyDescriptor(lr.prototype,"pipe"),lr.prototype),rn(lr.prototype,"unpipe",[N9],Object.getOwnPropertyDescriptor(lr.prototype,"unpipe"),lr.prototype),lr),gb=(A9=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),I9=gr(),O9=_g("MicrophoneAudioTrack","_enabledMutex"),P9=Et({argsMap:(r,a,s)=>[r.getTrackId(),a,s]}),k9=gr(),j9=Et({argsMap:r=>[r.getTrackId()]}),rn((ru=class extends vr{get __className__(){return"MicrophoneAudioTrack"}constructor(r,a,s,l){super(r,a.encoderConfig?nT(a.encoderConfig):{},l,oe("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),_e(this,"_config",void 0),_e(this,"_deviceName","default"),_e(this,"_constraints",void 0),_e(this,"_originalConstraints",void 0),_e(this,"_enabled",!0),this._config=a,this._constraints=s,this._originalConstraints=s,this._deviceName=r.label,typeof a.bypassWebAudio=="boolean"&&(this._bypassWebAudio=a.bypassWebAudio),(mg()||hj())&&In.bindInterruptDetectorTrack(this)}async setDevice(r){if(V.info("[".concat(this.getTrackId(),"] start set device to ").concat(r)),this._enabled)try{const a=await eo.getDeviceById(r),s={};s.audio=$n({},this._constraints),s.audio.deviceId={exact:r},this._originMediaStreamTrack.stop();let l=null;try{l=await Qs(s,this.getTrackId())}catch(d){throw V.error("[".concat(this.getTrackId(),"] setDevice failed"),d.toString()),l=await Qs({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),d}await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),this._deviceName=a.label,this._config.microphoneId=r,this._constraints.deviceId={exact:r}}catch(a){throw V.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}else try{const a=await eo.getDeviceById(r);this._deviceName=a.label,this._config.microphoneId=r,this._constraints.deviceId={exact:r}}catch(a){throw V.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}V.info("[".concat(this.getTrackId(),"] set device to ").concat(r," success"))}async setEnabled(r,a,s){if(a)return V.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(r);if(!s){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(V.info("[".concat(this.getTrackId(),"] start setEnabled"),r),oe("AUTO_RESET_AUDIO_ROUTE")&&(oa()||uc())){const m=navigator.audioSession;m&&(r||(m.type="playback"),m.type="auto")}if(!r){var l;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(l=this._source.clonedTrack)===null||l===void 0||l.stop(),s||(this._enabled=!1);try{await Ln(this,et.NEED_DISABLE_TRACK,this)}catch(m){throw V.error("[".concat(this.getTrackId(),"] setEnabled false failed"),m.toString()),m}return}const d=$n({},this._constraints),f=eo.searchDeviceIdByName(this._deviceName);f&&!d.deviceId&&(d.deviceId=f);try{s||(this._enabled=!0);const m=await Qs({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(m.getAudioTracks()[0],!1),await Ln(this,et.NEED_ENABLE_TRACK,this)}catch(m){throw s||(this._enabled=!1),V.error("[".concat(this.getTrackId(),"] setEnabled true failed"),m.toString()),m}V.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(mg()||hj())&&In.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((oa()||uc())&&this._enabled&&!this._isClosed&&In.duringInterruption){const r=async()=>{In.off(Ri.IOS_INTERRUPTION_END,r),this._enabled&&!this._isClosed&&(V.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};In.on(Ri.IOS_INTERRUPTION_END,r)}else V.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Tg.TRACK_ENDED)}async renewMediaStreamTrack(r){const a=r||this._constraints,s=eo.searchDeviceIdByName(this._deviceName);if(s&&!a.deviceId&&(a.deviceId=s),this._constraints=a,this._enabled){this._originMediaStreamTrack.stop();const l=await Qs({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!0)}}bindProcessorContextEvents(r){super.bindProcessorContextEvents(r),r.on(Js.REQUEST_UPDATE_CONSTRAINTS,async(a,s,l)=>{try{const d=Object.assign({},this._originalConstraints,...a);await this.renewMediaStreamTrack(d),s()}catch(d){l(d)}})}unbindProcessorContextEvents(r){super.unbindProcessorContextEvents(r),r.removeAllListeners(Js.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[A9,I9],Object.getOwnPropertyDescriptor(ru.prototype,"setDevice"),ru.prototype),rn(ru.prototype,"setEnabled",[O9,P9,k9],Object.getOwnPropertyDescriptor(ru.prototype,"setEnabled"),ru.prototype),rn(ru.prototype,"close",[j9],Object.getOwnPropertyDescriptor(ru.prototype,"close"),ru.prototype),ru),lIe=(D9=Et({argsMap:(r,a)=>[r.getTrackId(),a,r.duration]}),L9=gr(),M9=Et({argsMap:r=>[r.getTrackId()]}),U9=gr(),F9=Et({argsMap:r=>[r.getTrackId()]}),V9=gr(),B9=Et({argsMap:r=>[r.getTrackId()]}),$9=gr(),W9=Et({argsMap:r=>[r.getTrackId()]}),G9=gr(),H9=Et({argsMap:r=>[r.getTrackId()]}),z9=Et({argsMap:r=>[r.getTrackId()]}),K9=gr(),rn((Ui=class extends vr{get __className__(){return"BufferSourceAudioTrack"}constructor(r,a,s,l){super(a.createOutputTrack(),s,l),_e(this,"source",void 0),_e(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=r,this._bufferSource=a,this._bufferSource.on(Xs.AUDIO_SOURCE_STATE_CHANGE,d=>{this.safeEmit(Tg.SOURCE_STATE_CHANGE,d)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(r){r&&this._bufferSource.updateOptions(r),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(r){this._bufferSource.seekAudioBuffer(r)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(r){kn(r,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(r)}}).prototype,"startProcessAudioBuffer",[D9,L9],Object.getOwnPropertyDescriptor(Ui.prototype,"startProcessAudioBuffer"),Ui.prototype),rn(Ui.prototype,"pauseProcessAudioBuffer",[M9,U9],Object.getOwnPropertyDescriptor(Ui.prototype,"pauseProcessAudioBuffer"),Ui.prototype),rn(Ui.prototype,"seekAudioBuffer",[F9,V9],Object.getOwnPropertyDescriptor(Ui.prototype,"seekAudioBuffer"),Ui.prototype),rn(Ui.prototype,"resumeProcessAudioBuffer",[B9,$9],Object.getOwnPropertyDescriptor(Ui.prototype,"resumeProcessAudioBuffer"),Ui.prototype),rn(Ui.prototype,"stopProcessAudioBuffer",[W9,G9],Object.getOwnPropertyDescriptor(Ui.prototype,"stopProcessAudioBuffer"),Ui.prototype),rn(Ui.prototype,"close",[H9],Object.getOwnPropertyDescriptor(Ui.prototype,"close"),Ui.prototype),rn(Ui.prototype,"setAudioBufferPlaybackSpeed",[z9,K9],Object.getOwnPropertyDescriptor(Ui.prototype,"setAudioBufferPlaybackSpeed"),Ui.prototype),Ui);class Yr extends vr{get __className__(){return"MixingAudioTrack"}get isActive(){for(const a of this.trackList)if(a._enabled&&!a._isClosed&&!a.muted)return!0;return!1}constructor(){const a=Ng().createMediaStreamDestination();super(a.stream.getAudioTracks()[0],void 0,Mn(8,"track-mix-")),_e(this,"trackList",void 0),_e(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=a,this.trackList=[]}hasAudioTrack(a){return this.trackList.indexOf(a)!==-1}addAudioTrack(a){this.trackList.indexOf(a)===-1?(V.debug("add ".concat(a.getTrackId()," to mixing track")),a._source.outputNode.connect(this.destNode),this.trackList.push(a),this.updateEncoderConfig()):V.debug("track ".concat(a.getTrackId()," is already added"))}removeAudioTrack(a){if(this.trackList.indexOf(a)!==-1){V.debug("remove ".concat(a.getTrackId()," from mixing track"));try{a._source.outputNode.disconnect(this.destNode)}catch{}zx(this.trackList,a),this.updateEncoderConfig()}}updateEncoderConfig(){const a={};this.trackList.forEach(s=>{s._encoderConfig&&((s._encoderConfig.bitrate||0)>(a.bitrate||0)&&(a.bitrate=s._encoderConfig.bitrate),(s._encoderConfig.sampleRate||0)>(a.sampleRate||0)&&(a.sampleRate=s._encoderConfig.sampleRate),(s._encoderConfig.sampleSize||0)>(a.sampleSize||0)&&(a.sampleSize=s._encoderConfig.sampleSize),s._encoderConfig.stereo&&(a.stereo=!0))}),this._encoderConfig=a}_updateRtpTransceiver(a){this._rtpTransceiver!==a&&(this._rtpTransceiver=a,this.trackList.forEach(s=>{s instanceof Yr?s.emit(cp.TRANSCEIVER_UPDATED,a):s._updateRtpTransceiver(a)}))}}class uIe extends qz{set currentState(a){a!==this._currentState&&(this._currentState=a,this.safeEmit(Xs.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),_e(this,"audioBuffer",void 0),_e(this,"sourceNode",void 0),_e(this,"startPlayTime",0),_e(this,"startPlayOffset",0),_e(this,"pausePlayTime",0),_e(this,"options",void 0),_e(this,"currentLoopCount",0),_e(this,"currentPlaybackSpeed",100),_e(this,"_currentState","stopped"),this.audioBuffer=a,this.options=s,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(a){this.currentState==="stopped"?(this.options=a,this.startPlayOffset=this.options.startPlayTime||0):V.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(a){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=a,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=a))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(a){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=a/100),this.currentPlaybackSpeed=a}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const a=this.context.createBufferSource();return a.buffer=this.audioBuffer,a.loop=!!this.options.loop,a.connect(this.outputNode),a.playbackRate.value=this.currentPlaybackSpeed/100,a}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const q9=new Map;function Y9(r,a){if(r.length===0||a.length===0)return 1/0;const s=bj(r),l=bj(a);return Math.floor(l/s)}class Kj{get rendFrameRate(){const a=Math.max(1,Y9(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/a)}get videoElementStatus(){return this._isInPage?this._videoElementStatus:zi.DESTROYED}set videoElementStatus(a){a!==this._videoElementStatus&&(V.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(a)),this._videoElementStatus=a)}get videoState(){return this._videoState}set videoState(a){var s;a!==this._videoState&&(this._videoState=a,(s=this.onVideoStateChanged)===null||s===void 0||s.call(this,this.videoState))}constructor(a){_e(this,"trackId",void 0),_e(this,"config",void 0),_e(this,"onFirstVideoFrameDecoded",void 0),_e(this,"onFirstVideoFrameRender",void 0),_e(this,"onVideoStateChanged",void 0),_e(this,"freezeTimeCounterList",[]),_e(this,"renderFreezeAccTime",0),_e(this,"renderFreezeAccTime2",0),_e(this,"isKeepLastFrame",!1),_e(this,"isDestroyed",!1),_e(this,"timeUpdatedCount",0),_e(this,"freezeTime",0),_e(this,"playbackTime",0),_e(this,"lastTimeUpdatedTime",0),_e(this,"autoplayFailed",!1),_e(this,"videoTrack",void 0),_e(this,"videoElement",void 0),_e(this,"cacheVideoElement",void 0),_e(this,"internal",!1),_e(this,"_render_interframe_delays",[]),_e(this,"_render_interframe_delays_sizes",[]),_e(this,"_videoState",nu.VideoStateStopped),_e(this,"videoElementCheckInterval",void 0),_e(this,"videoElementFreezeTimeout",void 0),_e(this,"_videoElementStatus",zi.NONE),_e(this,"_isInPage",!0),_e(this,"isGettingVideoDimensions",!1),_e(this,"startGetVideoDimensions",()=>{const s=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return V.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(s,500)};!this.isGettingVideoDimensions&&s()}),_e(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&In.curState==="running"&&(V.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(qH())),nz()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),_e(this,"handleVideoEvents",s=>{switch(s.type){case"play":case"playing":s.type==="play"&&V.debug("[".concat(this.trackId,"] video element status: play")),this.startGetVideoDimensions(),this.videoElementStatus=zi.PLAYING;break;case"loadeddata":if(this.videoState=nu.VideoStateStarting,this.onFirstVideoFrameRender&&this.onFirstVideoFrameRender(),this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=zi.CANPLAY;break;case"stalled":this.videoElementStatus=zi.STALLED;break;case"suspend":this.videoElementStatus=zi.SUSPEND;break;case"pause":this.videoElementStatus=zi.PAUSED,oa()||uc()||ji()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(V.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=zi.WAITING;break;case"abort":this.videoElementStatus=zi.ABORT;break;case"ended":this.videoElementStatus=zi.ENDED;break;case"emptied":this.videoElementStatus=zi.EMPTIED;break;case"error":{const l=this.videoElement.error;l&&(this.videoElementStatus=zi.ERROR,V.error("[".concat(this.trackId,"] media error: ").concat(l.message," (").concat(l.code,")")));break}case"timeupdate":{const l=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=l);const d=l-this.lastTimeUpdatedTime,f=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=l,iu.lastVisibleTime<iu.lastHiddenTime||f<iu.lastHiddenTime||f<iu.lastVisibleTime||this.isSkipCalcRenderFreezeTime())return;for(d>oe("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=d),this.playbackTime+=d;this.playbackTime>=6e3;){this.playbackTime-=6e3;const m=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(m),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),_e(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(V.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(qH())),nz()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=a.trackId,this.config=a,a.element instanceof HTMLVideoElement?this.videoElement=a.element:this.videoElement=document.createElement("video"),In.on(Ri.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),In.on(Ri.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var a;return(a=this.videoElement.parentElement)!==null&&a!==void 0?a:void 0}updateConfig(a){this.config=a,this.trackId=a.trackId,a.element!==this.videoElement&&(this.destroy(),this.videoElement=a.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(a){this.videoTrack!==a&&(this.videoTrack=a,this.initVideoElement())}play(a){const s=this.videoElement.play();s&&s.catch&&s.catch(d=>{a&&t9(a,"video",d.message,this.trackId),d.name==="NotAllowedError"?(V.warning("detected video element autoplay failed",d),this.autoplayFailed=!0,this.handleAutoPlayFailed()):V.warning("[".concat(this.trackId,"] play warning: "),d)});const l=an();if((l.name==="Safari"&&Number(l.version)===15||mg())&&s&&s.then){const d=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};s.then(d).catch(d)}}getCurrentFrame(){const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const s=a.getContext("2d");if(!s)return V.error("create canvas context failed!"),new ImageData(2,2);s.drawImage(this.videoElement,0,0,a.width,a.height);const l=s.getImageData(0,0,a.width,a.height);return a.remove(),l}async getCurrentFrameToUint8Array(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=document.createElement("canvas");l.width=this.videoElement.videoWidth,l.height=this.videoElement.videoHeight;const d=l.getContext("2d");return d?(d.drawImage(this.videoElement,0,0,l.width,l.height),new He((f,m)=>{l.toBlob(async y=>{if(l.remove(),y){const _=await u9(y);f({buffer:_,width:l.width,height:l.height})}else m(new we(ie.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},a,s<0?.1:s>1?1:s)})):await zj(a)}destroy(){this.isDestroyed=!0,In.off(Ri.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),In.off(Ri.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=nu.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=zi.INIT,!this.videoElementCheckInterval&&(X9.forEach(f=>{this.videoElement.addEventListener(f,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{this._isInPage=function(f){return f!==document.body&&document.body.contains(f)}(this.videoElement)},1e3),oe("ENABLE_VIDEO_FRAME_CALLBACK"))){var a,s;let f;const m=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",m),this.videoElementFreezeTimeout=window.setTimeout(y,oe("VIDEO_FREEZE_DURATION")))},y=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===nu.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=nu.VideoStateFrozen:document.addEventListener("visibilitychange",m))},_=(S,x)=>{if(this.videoElementStatus===zi.PLAYING){if(f){const L=x.presentationTime-f.presentationTime,K=x.presentedFrames-f.presentedFrames;this._render_interframe_delays_sizes.push(K),this._render_interframe_delays.push(L);const $=bj(this._render_interframe_delays_sizes),G=$-this._render_interframe_delays_sizes[0];if($>30&&G>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===nu.VideoStateStarting&&(this.videoState=nu.VideoStateDecoding),this.videoState===nu.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(y,oe("VIDEO_FREEZE_DURATION"))),L<oe("VIDEO_FREEZE_DURATION")&&this.videoState===nu.VideoStateFrozen&&(this.videoState=nu.VideoStateDecoding),L>oe("VIDEO_FREEZE_DURATION")&&iu.lastVisibleTime>=iu.lastHiddenTime&&f.timestamp>iu.lastVisibleTime&&f.timestamp>iu.lastHiddenTime){const ne=Math.min(66,Y9(this._render_interframe_delays_sizes,this._render_interframe_delays)),te=Math.max(0,L-(K-1)*ne);this.renderFreezeAccTime2+=te>ne?te:0,this.renderFreezeAccTime+=L}}f=$n($n({},x),{},{timestamp:S})}else this.isSkipCalcRenderFreezeTime()&&(f=$n($n({},x),{},{timestamp:S}));var A,I;oe("ENABLE_VIDEO_FRAME_CALLBACK")&&((A=(I=this.videoElement).requestVideoFrameCallback)===null||A===void 0||A.call(I,_))};(a=(s=this.videoElement).requestVideoFrameCallback)===null||a===void 0||a.call(s,_)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Hx()&&!oe("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const l=an();l.name==="Safari"&&Number(l.version)===15||mg()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,dr()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,dr()&&this.videoElement.load());const d=this.videoElement.play();d!==void 0&&d.catch(f=>{V.debug("[".concat(this.trackId,"] playback interrupted"),f.toString())})}resetVideoElement(){X9.forEach(a=>{this.videoElement&&this.videoElement.removeEventListener(a,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=zi.NONE}isSkipCalcRenderFreezeTime(){return this.videoElementStatus===zi.DESTROYED||this.internal}handleAutoPlayFailed(){const a=s=>{s.preventDefault(),this.videoElement.play().then(()=>{V.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(l=>{V.error(l)}),this.autoplayFailed=!1,ab()?document.body.removeEventListener("click",a,!0):(document.body.removeEventListener("touchstart",a,!0),document.body.removeEventListener("mousedown",a,!0))};ab()?document.body.addEventListener("click",a,!0):(document.body.addEventListener("touchstart",a,!0),document.body.addEventListener("mousedown",a,!0)),e9()}}const X9=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class qj extends Kj{constructor(a){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];super(a),_e(this,"container",void 0),_e(this,"slot",void 0),this.slot=a.element,this.internal=s,this.updateConfig(a)}updateConfig(a){this.config=a,this.trackId=a.trackId;const s=a.element;var l;!this.internal||this.slot?(s!==this.slot&&(this.destroy(),this.slot=s),this.createElements()):(this.slot=s,s&&this.container?(this.internal=!1,this.container.id="agora-video-player-".concat(this.trackId),this.videoElement.id="video_".concat(this.trackId),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",(l=this.slot)===null||l===void 0||l.appendChild(this.container)):this.createElements())}updateVideoTrack(a){this.videoTrack!==a&&(this.videoTrack=a,this.createElements())}play(a){var s;(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)&&super.play(a)}getCurrentFrame(){var a;return(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(a){var s;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(a,l):await zj(a)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{var a;this.container.remove(),(a=this.slot)===null||a===void 0||a.removeChild(this.container)}catch{}this.container=void 0}}createElements(){var a;this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",oe("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),(a=this.slot)===null||a===void 0||a.appendChild(this.container)}mountedVideoElement(){var a;!this.container||(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var a;if((a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var a;(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var J9,Z9,Q9,e7,t7,n7,r7,i7,a7,s7,o7,c7,l7,u7,d7,h7,f7,p7,m7,g7,v7,y7,_7,b7,E7,w7,S7,x7,Xt,T7,C7,R7,N7,A7,I7,O7,P7,no;let Gn=(J9=Et({argsMap:(r,a,s)=>[r.getTrackId(),typeof a=="string"?a:a instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),Z9=gr(),Q9=Et({argsMap:r=>[r.getTrackId()]}),e7=_g("LocalVideoTrack","_enabledMutex"),t7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),n7=gr(),r7=_g("LocalVideoTrack","_enabledMutex"),i7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),a7=gr(),s7=Et({argsMap:(r,a)=>[r.getTrackId(),a,r._saveEncodeBitrateRatio]}),o7=gr(),c7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),l7=gr(),u7=gr(),d7=Et({argsMap:(r,a,s)=>[r.getTrackId(),a,s]}),h7=gr(),f7=gr(),p7=gr(),m7=Et({argsMap:r=>[r.getTrackId()]}),g7=gr(),v7=gr(),y7=gr(),_7=gr(),b7=gr(),E7=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),w7=Et({argsMap:r=>[r.getTrackId()]}),S7=Et({argsMap:r=>[r.getTrackId()]}),x7=Et({argsMap:(r,a,s)=>[r.getTrackId(),a.label,s]}),Xt=class Xle extends Rg{get videoHeight(){if(ji()){const{height:a}=this._mediaStreamTrack.getSettings();return this._videoHeight=a,this._videoHeight}return this._videoHeight}get videoWidth(){if(ji()){const{width:a}=this._mediaStreamTrack.getSettings();return this._videoWidth=a,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==zi.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(a){this._processorContext=a}get __className__(){return"LocalVideoTrack"}constructor(a,s,l,d,f,m){if(super(a,f),_e(this,"trackMediaType",Cg.VIDEO),_e(this,"_player",void 0),_e(this,"isUseScaleResolutionDownBy",!1),_e(this,"_videoVisibleTimer",null),_e(this,"_previousVideoVisibleStatus",void 0),_e(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_e(this,"_encoderConfig",void 0),_e(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),_e(this,"_optimizationMode",void 0),_e(this,"_saveEncodeBitrateRatio",1),_e(this,"_videoHeight",void 0),_e(this,"_videoWidth",void 0),_e(this,"_forceBitrateLimit",void 0),_e(this,"_enabled",!0),_e(this,"_processorDestination",void 0),_e(this,"_processorContext",void 0),ji()){const{width:y,height:_}=a.getSettings();this._videoWidth=y,this._videoHeight=_}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=l,this._optimizationMode=d,this._hints=m||[],s&&this._hints.indexOf(jn.CUSTOM_TRACK)!==-1?this._encoderConfig=ir(s):this._encoderConfig=s,this._hints.indexOf(jn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(oj(fn.CHROME,115)&&Wx().indexOf("Windows")!==-1){const y=function(_,S){if("VideoFrame"in window&&"TransformStream"in window&&un().supportWebRTCInsertableStream){const x=new MediaStreamTrackProcessor(_),A=new MediaStreamTrackGenerator({kind:"video"});let I,L,K=Date.now();const $=()=>{G&&(clearInterval(G),G=void 0),I&&(I.close(),I=void 0),_.stop(),L=void 0,A.removeEventListener("ended",$)};let G=window.setInterval(()=>{if(L&&I&&Date.now()-K>1e3)try{A.readyState==="live"?L.enqueue(I.clone()):$()}catch{$()}},1e3);const ne=new TransformStream({transform:(te,ce)=>{A.readyState==="live"?(L=ce,K=Date.now(),I===void 0?(I=te,ce.enqueue(te.clone())):(ce.enqueue(I),I=te)):te.close()}});return A.addEventListener("ended",$),x.readable.pipeThrough(ne).pipeTo(A.writable),A}}(a);y&&(V.info("local screen video track begin to inject frame"),this._mediaStreamTrack=y)}s&&this._hints.indexOf(jn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(s),this._processorContext=new r9(this.getTrackId(),"local"),this._processorDestination=new n9(this.processorContext),this.bindProcessorDestinationEvents()}play(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof a=="string"){const d=document.getElementById(a);d?a=d:(V.warning("[".concat(this.getTrackId(),'] can not find "#').concat(a,'" element, use document.body')),a=document.body)}V.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(a instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(s));const l=$n($n($n({},this._getDefaultPlayerConfig()),s),{},{trackId:this.getTrackId(),element:a});this._player?this._player.updateConfig(l):(a instanceof HTMLVideoElement?this._player=new Kj(l):this._player=new qj(l),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const d=this.getVideoElementVisibleStatus();this.safeEmit(Tg.VIDEO_ELEMENT_VISIBLE_STATUS,d)}catch{}},oe("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,V.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(a,s){if(!s){if(a===this._enabled)return;this.stateCheck("enabled",a)}if(V.info("[".concat(this.getTrackId(),"] start setEnabled"),a),!a){this._originMediaStreamTrack.enabled=!1;try{await Ln(this,et.NEED_DISABLE_TRACK,this)}catch(l){throw V.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}return s||(this._enabled=!1),void V.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Ln(this,et.NEED_ENABLE_TRACK,this)}catch(l){throw V.error("[".concat(this.getTrackId(),"] setEnabled to true error"),l.toString()),l}V.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}async setMuted(a){a!==this._muted&&(this.stateCheck("muted",a),this._muted=a,this._originMediaStreamTrack.enabled=!a,V.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(a)),a?await Ln(this,et.NEED_MUTE_TRACK,this):await Ln(this,et.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._saveEncodeBitrateRatio;if(this._saveEncodeBitrateRatio!==1&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*a),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*a),V.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(a)),this._saveEncodeBitrateRatio=1;try{await Ln(this,et.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(V)}}}async setEncoderConfiguration(a,s){if(!this._enabled)throw new we(ie.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(a=fc(a),oe("USE_STANDARD_BITRATE_DEFAULT")&&(delete a.bitrateMax,delete a.bitrateMin),this._forceBitrateLimit&&(a.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:a.bitrateMax,a.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:a.bitrateMin),a.width||a.height||a.frameRate){const l=aT({encoderConfig:a});(ji()||oa()||uc())&&(l.deviceId=void 0),V.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(a),JSON.stringify(l));try{await this._originMediaStreamTrack.applyConstraints(l),this.updateMediaStreamTrackResolution()}catch(d){const f=new we(ie.UNEXPECTED_ERROR,d.toString());throw V.error("[".concat(this.getTrackId(),"] applyConstraints error"),f.toString()),f}}this._encoderConfig=a,this._hints.indexOf(jn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Ln(this,et.NEED_UPDATE_VIDEO_ENCODER,this)}catch(l){return l.throw(V)}}getStats(){return uh(()=>{V.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),qs(this,et.GET_STATS)||$n({},Fj)}async setBeautyEffect(a){V.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(a,s):await zj(a)}async findClosestProfile(){const{width:a,height:s,frameRate:l}=this.getMediaStreamTrackSettings(),{width:d,height:f,frameRate:m}=this._encoderConfig||{},y=yg(this._videoWidth||a||d||0),_=yg(this._videoHeight||s||f||0),S=function(x,A,I){if(!Array.isArray(oe("VIDEO_ENCODER_CONFIG_LIST"))||oe("VIDEO_ENCODER_CONFIG_LIST").length===0)return!1;const L=Math.min(x,A);return!(L>=480)&&$n($n({},oe("VIDEO_ENCODER_CONFIG_LIST").find(K=>K.height>L)),{},{frameRate:I})}(y,_,yg(l||m||15));if(S)return V.debug("[".concat(this.getTrackId(),"] find closest profile, ").concat(y,"x").concat(_," => ").concat(JSON.stringify(S))),this.setEncoderConfiguration(S)}async setBitrateLimit(a){V.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(a))),a&&(this._forceBitrateLimit=a,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<a.max_bitrate?this._encoderConfig.bitrateMax:a.max_bitrate:this._encoderConfig.bitrateMax=a.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=a.min_bitrate))}async setOptimizationMode(a){if(a!=="motion"&&a!=="detail"&&a!=="balanced")return void V.error(ie.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const s=this._optimizationMode;try{this._optimizationMode=a,await Ln(this,et.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(l){throw this._optimizationMode=s,V.error("[".concat(this.getTrackId(),"] set optimization mode failed"),l.toString()),l}V.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(a,")"))}setScalabiltyMode(a){if(a.numSpatialLayers===1&&a.numTemporalLayers!==1)return V.error(ie.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=a,V.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(a,")"))}updateMediaStreamTrackResolution(){s9(this._originMediaStreamTrack).then(a=>{let[s,l]=a;this._videoHeight=l,this._videoWidth=s}).catch(qx)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(a){if(!this._enabled)throw new we(ie.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");V.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(a)),a=fc(a),this._forceBitrateLimit&&(a.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:a.bitrateMax,a.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:a.bitrateMin),this._encoderConfig=a,this._hints.indexOf(jn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Ln(this,et.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(V)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:a,height:s,frameRate:l}=this.getMediaStreamTrackSettings();if(!a||!s||!l)return;const{bitrateMax:d,bitrateMin:f}=this._encoderConfig;if(f==null||d==null){const{max:m,min:y}=function(_,S,x,A,I){const L=oe("BITRATE_ADAPTER_TYPE");if(L==="DEFAULT_BITRATE")return{min:A,max:I};if(I===void 0){const K=Math.floor(200*Math.pow(x/15,.6)*Math.pow(_*S/640/360,.75));I=L==="STANDARD_BITRATE"?4*K:2*K,A=A??K}else A=A??Math.floor(I/10);return{min:A,max:I}}(a,s,l,f,d);if(this._encoderConfig.bitrateMin=y,this._encoderConfig.bitrateMax=m,oe("VIDEO_STANDARD_BITRATE_VERSION")&&f==null&&d==null){const[_,S]=function(x,A,I){const L=4*Math.floor(2e5*Math.pow(I/15,.6)*Math.pow(x*A/230400,.75)),K=x*A,$=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),G=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let ne=Cs($).call($).next().value,te=1;if($.has(K))ne=$.get(K);else{var ce;const Me=Yf(ce=Array.from($.entries())).call(ce,(Kt,Nt)=>{let[bn]=Kt,[vn]=Nt;return bn-vn}),Gt=Me.find(Kt=>{let[Nt]=Kt;return Nt>K});if(Gt){const Kt=Me.indexOf(Gt);if(Kt>0){const Nt=Me[Kt-1],bn=(K-Nt[0])/(Gt[0]-Nt[0]);ne=Nt[1]+bn*(Gt[1]-Nt[1])}else ne=Gt[1]}else ne=Me[Me.length-1][1]}if(G.has(K))te=G.get(K);else{var pe;const Me=Yf(pe=Array.from(G.entries())).call(pe,(Kt,Nt)=>{let[bn]=Kt,[vn]=Nt;return bn-vn}),Gt=Me.find(Kt=>{let[Nt]=Kt;return Nt>K});if(Gt){const Kt=Me.indexOf(Gt);if(Kt>0){const Nt=Me[Kt-1],bn=(K-Nt[0])/(Gt[0]-Nt[0]);te=Nt[1]+bn*(Gt[1]-Nt[1])}else te=Gt[1]}else te=Me[Me.length-1][1]}const fe=oe("VIDEO_NEW_BITRATE_RATIO");fe&&fe>0&&(ne=fe/100);const ue=Math.floor(L*ne),ye=Math.floor(65e4*Math.pow(x*A/230400,.5)*Math.pow(I/15,.69));let Se=ue;const Ie=oe("VIDEO_STANDARD_BITRATE_VERSION");return Ie&&Ie>0&&(Ie===1?Se=L:Ie===2?Se=ue:Ie===3&&(Se=ye)),[Math.floor(Se/1e3),te]}(a,s,l);this._encoderConfig.bitrateMax=_,this._encoderConfig.bitrateMin=y?Math.min(y,_):_,this._saveEncodeBitrateRatio=S,V.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(a,", h: ").concat(s,", fps: ").concat(l,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else V.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(a,", h: ").concat(s,", fps: ").concat(l,"] => [brMax: ").concat(m,", brMin: ").concat(y,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var a,s;const l=this==null||(a=this._player)===null||a===void 0?void 0:a.getContainerElement(),d={track:this,element:this==null||(s=this._player)===null||s===void 0?void 0:s.getVideoElement(),slot:l==null?void 0:l.parentElement},{element:f,slot:m}=d;if(this.isPlaying&&f instanceof HTMLVideoElement&&m instanceof HTMLElement){const y=oz.checkOneElementVisible(f),_=Object.assign({},y);if(_.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_.visible;const S=it.reportApiInvoke(null,{tag:rr.TRACER,name:Er.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_.visible?S.onSuccess("Video is visible"):S.onSuccess("Invisible because of ".concat(_.reason))}return _}return}catch(l){throw new we(ie.GET_VIDEO_ELEMENT_VISIBLE_ERROR,l.message)}}async renewMediaStreamTrack(a){}pipe(a){if(this.processor===a)return a;if(a._source)throw new we(ie.INVALID_OPERATION,"Processor ".concat(a.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=a,this.processor._source=this,a.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),a}unpipe(){if(!this.processor)return;const a=this.processor;this.processor._source=void 0,this.processor=void 0,a.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(a){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],l=this._encoderConfig;a&&(l=$n($n({},l),fc(a))),l=ip(l);const d=Mn(8,"track-video-cloned-"),f=new Xle(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,l,ip(this._scalabilityMode),this._optimizationMode,d,ip(this._hints));return a&&l&&f.setEncoderConfiguration(l),V.debug("clone video track from ".concat(this.getTrackId()," to ").concat(d,", clone ").concat(s)),f}async replaceTrack(a,s){if(!(a instanceof MediaStreamTrack))throw new we(ie.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(a.kind!=="video")throw new we(ie.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(a,s,!0),this.updateMediaStreamTrackResolution()}sendSeiData(a){if(uh(()=>{it.reportApiInvoke(null,{name:Er.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:rr.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!oe("ENABLE_VIDEO_SEI")||!oe("ENABLE_ENCODED_TRANSFORM"))return void V.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(a instanceof Uint8Array==0)return new we(ie.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const s=this.getRTCRtpTransceiver();if(!s)return void V.warning("Video track is not published, SEI can not be send");const l=s.sender.getParameters();if(l.codecs.length===0)return;const d=l.codecs[0].mimeType.toLocaleLowerCase();d==="video/h264"||d==="video/h265"?this.safeEmit("sei-to-send",a):V.warning("SEI is not supported by ".concat(d))}bindProcessorDestinationEvents(){this.processorDestination.on(ja.ON_TRACK,async a=>{a?a!==this._mediaStreamTrack&&(this._mediaStreamTrack=a,this._updatePlayerSource(),await Ln(this,et.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Ln(this,et.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ja.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Js.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Js.REQUEST_CONSTRAINTS)}},rn(Xt.prototype,"play",[J9,Z9],Object.getOwnPropertyDescriptor(Xt.prototype,"play"),Xt.prototype),rn(Xt.prototype,"stop",[Q9],Object.getOwnPropertyDescriptor(Xt.prototype,"stop"),Xt.prototype),rn(Xt.prototype,"setEnabled",[e7,t7,n7],Object.getOwnPropertyDescriptor(Xt.prototype,"setEnabled"),Xt.prototype),rn(Xt.prototype,"setMuted",[r7,i7,a7],Object.getOwnPropertyDescriptor(Xt.prototype,"setMuted"),Xt.prototype),rn(Xt.prototype,"setSaveEncodeBitrateRatio",[s7,o7],Object.getOwnPropertyDescriptor(Xt.prototype,"setSaveEncodeBitrateRatio"),Xt.prototype),rn(Xt.prototype,"setEncoderConfiguration",[c7,l7],Object.getOwnPropertyDescriptor(Xt.prototype,"setEncoderConfiguration"),Xt.prototype),rn(Xt.prototype,"getStats",[u7],Object.getOwnPropertyDescriptor(Xt.prototype,"getStats"),Xt.prototype),rn(Xt.prototype,"setBeautyEffect",[d7,h7],Object.getOwnPropertyDescriptor(Xt.prototype,"setBeautyEffect"),Xt.prototype),rn(Xt.prototype,"getCurrentFrameData",[f7],Object.getOwnPropertyDescriptor(Xt.prototype,"getCurrentFrameData"),Xt.prototype),rn(Xt.prototype,"getCurrentFrameImage",[p7],Object.getOwnPropertyDescriptor(Xt.prototype,"getCurrentFrameImage"),Xt.prototype),rn(Xt.prototype,"findClosestProfile",[m7,g7],Object.getOwnPropertyDescriptor(Xt.prototype,"findClosestProfile"),Xt.prototype),rn(Xt.prototype,"setBitrateLimit",[v7],Object.getOwnPropertyDescriptor(Xt.prototype,"setBitrateLimit"),Xt.prototype),rn(Xt.prototype,"setOptimizationMode",[y7],Object.getOwnPropertyDescriptor(Xt.prototype,"setOptimizationMode"),Xt.prototype),rn(Xt.prototype,"setScalabiltyMode",[_7],Object.getOwnPropertyDescriptor(Xt.prototype,"setScalabiltyMode"),Xt.prototype),rn(Xt.prototype,"updateMediaStreamTrackResolution",[b7],Object.getOwnPropertyDescriptor(Xt.prototype,"updateMediaStreamTrackResolution"),Xt.prototype),rn(Xt.prototype,"pipe",[E7],Object.getOwnPropertyDescriptor(Xt.prototype,"pipe"),Xt.prototype),rn(Xt.prototype,"unpipe",[w7],Object.getOwnPropertyDescriptor(Xt.prototype,"unpipe"),Xt.prototype),rn(Xt.prototype,"close",[S7],Object.getOwnPropertyDescriptor(Xt.prototype,"close"),Xt.prototype),rn(Xt.prototype,"replaceTrack",[x7],Object.getOwnPropertyDescriptor(Xt.prototype,"replaceTrack"),Xt.prototype),Xt),sT=(T7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),C7=gr(),R7=_g("CameraVideoTrack","_enabledMutex"),N7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),A7=gr(),I7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),O7=gr(),P7=Et({argsMap:r=>[r.getTrackId()]}),no=class Jle extends Gn{get __className__(){return"CameraVideoTrack"}constructor(a,s,l,d,f,m){super(a,fc(s.encoderConfig),d,f,m),_e(this,"_config",void 0),_e(this,"_originalConstraints",void 0),_e(this,"_constraints",void 0),_e(this,"_enabled",!0),_e(this,"_deviceName","default"),_e(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(mg()||hj())&&!function(){const y=an();if(y.os!==oi.IOS||!y.osVersion)return!1;const _=y.osVersion.split(".");return Number(_[0])===15&&Number(_[1])>=2}()&&rz()&&this._enabled&&!this._isClosed&&(V.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=s,this._originalConstraints=l,this._constraints=l,this._deviceName=a.label,this._encoderConfig=fc(this._config.encoderConfig),In.on(Ri.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),In.on(Ri.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(a){return typeof a=="string"?this._setDeviceById(a):a.deviceId?this._setDeviceById(a.deviceId):a.facingMode?this._setDeviceByFacingModel(a.facingMode):void 0}async _setDeviceById(a){if(V.info("[".concat(this.getTrackId(),"] set device to ").concat(a)),this._enabled)try{const s=await eo.getDeviceById(a),l={};l.video=$n({},this._constraints),l.video.deviceId={exact:a},l.video.facingMode=void 0,this._originMediaStreamTrack.stop();let d=null;try{d=await Qs(l,this.getTrackId())}catch(f){throw V.error("[".concat(this.getTrackId(),"] setDevice failed"),f.toString()),d=await Qs({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(d.getVideoTracks()[0],!1),f}await this._updateOriginMediaStreamTrack(d.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=s.label,this._config.cameraId=a,this._constraints.deviceId={exact:a}}catch(s){throw V.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}else try{const s=await eo.getDeviceById(a);this._deviceName=s.label,this._config.cameraId=a,this._constraints.deviceId={exact:a}}catch(s){throw V.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}V.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(a){V.info("[".concat(this.getTrackId(),"] set facingMode ").concat(a));const s={video:$n($n({},this._constraints),{},{deviceId:void 0,facingMode:{exact:a}})};if(this._enabled){this._originMediaStreamTrack.stop();let l=null;try{l=await Qs(s,this.getTrackId())}catch(d){throw V.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),d.toString()),l=await Qs({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),d}await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=a,this._config.cameraId=void 0,this._constraints=$n({},s.video),V.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(a,s){if(!s){if(a===this._enabled)return;this.stateCheck("enabled",a)}if(V.info("[".concat(this.getTrackId(),"] start setEnabled"),a),a){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const l=await Qs({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1)}await Ln(this,et.NEED_ENABLE_TRACK,this)}catch(l){throw V.error("[".concat(this.getTrackId(),"] setEnabled true error"),l.toString()),l}this.updateMediaStreamTrackResolution(),V.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),s||(this._enabled=!1);try{await Ln(this,et.NEED_DISABLE_TRACK,this)}catch(l){throw V.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}V.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(a,s){if(!this._enabled)throw new we(ie.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");a=fc(a),oe("USE_STANDARD_BITRATE_DEFAULT")&&(delete a.bitrateMax,delete a.bitrateMin),this._forceBitrateLimit&&(a.bitrateMax=this._forceBitrateLimit.max_bitrate||a.bitrateMax,a.bitrateMin=this._forceBitrateLimit.min_bitrate||a.bitrateMin);const l=ir(this._config);l.encoderConfig=a;const d=aT(l);(ji()||oa()||uc())&&(d.deviceId=void 0),V.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(a),JSON.stringify(d));try{await this._originMediaStreamTrack.applyConstraints(d),this.updateMediaStreamTrackResolution()}catch(f){const m=new we(ie.UNEXPECTED_ERROR,f.toString());throw V.error("[".concat(this.getTrackId(),"] applyConstraints error"),m.toString()),m}this._config=l,this._constraints=d,this._originalConstraints=d,this._encoderConfig=a,this._hints.indexOf(jn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Ln(this,et.NEED_UPDATE_VIDEO_ENCODER,this)}catch(f){return f.throw(V)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((oa()||uc())&&this._enabled&&!this._isClosed&&In.duringInterruption){const a=async()=>{In.off(Ri.IOS_INTERRUPTION_END,a),this._enabled&&!this._isClosed&&(V.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};In.on(Ri.IOS_INTERRUPTION_END,a)}else V.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Tg.TRACK_ENDED)}async renewMediaStreamTrack(a){const s=a||this._constraints,l=eo.searchDeviceIdByName(this._deviceName);if(l&&!s.deviceId&&(s.deviceId={exact:l}),this._enabled){const d=await Qs({video:s},this.getTrackId());this._constraints=s,await this._updateOriginMediaStreamTrack(d.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),In.off(Ri.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),In.off(Ri.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(a){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],l=this._encoderConfig;a&&(l=$n($n({},l),fc(a))),l=ip(l);const d=Mn(8,"track-cam-cloned-"),f=new Jle(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,ip($n($n({},this._config),{},{encoderConfig:l})),ip(this._constraints),ip(this._scalabilityMode),this._optimizationMode,d);return a&&l&&f.setEncoderConfiguration(l),V.debug("clone track from ".concat(this.getTrackId()," to ").concat(d,", clone ").concat(s)),f}bindProcessorContextEvents(){this.processorContext.on(Js.REQUEST_UPDATE_CONSTRAINTS,async(a,s,l)=>{try{const d=Object.assign({},this._originalConstraints,...a);await this.renewMediaStreamTrack(d),s()}catch(d){l(d)}}),this.processorContext.on(Js.REQUEST_CONSTRAINTS,async a=>{a(this._originMediaStreamTrack.getSettings())})}},rn(no.prototype,"setDevice",[T7,C7],Object.getOwnPropertyDescriptor(no.prototype,"setDevice"),no.prototype),rn(no.prototype,"setEnabled",[R7,N7,A7],Object.getOwnPropertyDescriptor(no.prototype,"setEnabled"),no.prototype),rn(no.prototype,"setEncoderConfiguration",[I7,O7],Object.getOwnPropertyDescriptor(no.prototype,"setEncoderConfiguration"),no.prototype),rn(no.prototype,"close",[P7],Object.getOwnPropertyDescriptor(no.prototype,"close"),no.prototype),no);function Yj(r,a,s,l){s.optimizationMode&&(l&&l.width&&l.height?(s.encoderConfig=$n($n({},l),{},{bitrateMin:l.bitrateMin,bitrateMax:l.bitrateMax}),s.optimizationMode!=="motion"&&s.optimizationMode!=="detail"||(a.contentHint=s.optimizationMode,a.contentHint===s.optimizationMode?V.debug("[".concat(r,"] set content hint to"),s.optimizationMode):V.debug("[".concat(r,"] set content hint failed")))):V.warning("[".concat(r,"] can not apply optimization mode bitrate config, no encoderConfig")))}var k7,j7,D7,L7,Ro,M7,U7,F7,V7,B7,$7,wa;class W7 extends Hz{getUserId(){return this._userId}constructor(a,s,l,d){super(a,"track-".concat(a.kind,"-").concat(s,"-").concat(d.clientId,"_").concat(Mn(5,""))),_e(this,"_userId",void 0),_e(this,"_uintId",void 0),_e(this,"_isDestroyed",!1),_e(this,"store",void 0),_e(this,"processor",void 0),_e(this,"processorContext",void 0),this._userId=s,this._uintId=l,this.store=d}_updateOriginMediaStreamTrack(a){this._originMediaStreamTrack=a,this._mediaStreamTrack=a,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,V.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let Ig=(k7=Et({argsMap:(r,a,s)=>[r.getTrackId(),typeof a=="string"?a:a instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),j7=Et({argsMap:r=>[r.getTrackId()]}),D7=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),L7=Et({argsMap:r=>[r.getTrackId()]}),rn((Ro=class extends W7{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==zi.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(r,a,s,l,d){super(r,a,s,l),_e(this,"_videoVisibleTimer",null),_e(this,"_previousVideoVisibleStatus",void 0),_e(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_e(this,"trackMediaType",Cg.VIDEO),_e(this,"_videoWidth",void 0),_e(this,"_videoHeight",void 0),_e(this,"_player",void 0),_e(this,"_prePlayer",void 0),_e(this,"processorDestination",void 0),_e(this,"processorContext",void 0),this._prePlayer=d,this.updateMediaStreamTrackResolution(),this.processorContext=new r9(this.getTrackId(),"remote"),this.processorDestination=new n9(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return uh(()=>{V.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),qs(this,et.GET_STATS)||$n({},Wz)}play(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.safeEmit(Co.PLAY_START),typeof r=="string"){const l=document.getElementById(r);l?r=l:(V.warning("[".concat(this.getTrackId(),'] can not find "#').concat(r,'" element, use document.body')),r=document.body)}V.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(a));const s=$n($n({fit:"cover"},a),{},{trackId:this.getTrackId(),element:r});if(this._player)this._player.updateConfig(s);else{let l=!1,d=!1;r instanceof HTMLVideoElement?(this._player=new Kj(s),this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0,d=!0)):this._prePlayer&&!this._prePlayer.isDestroyed?(this._player=this._prePlayer,this._prePlayer=void 0,l=this._player.videoState>0,this._player.updateConfig(s)):this._player=new qj(s),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Co.FIRST_FRAME_DECODED),d&&this.safeEmit(Co.FIRST_FRAME_RENDER)},this._player.onVideoStateChanged=f=>{this.safeEmit(Co.VIDEO_STATE_CHANGED,f)},l&&(this._player.onFirstVideoFrameDecoded(),this._player.onVideoStateChanged(this._player.videoState))}this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(Co.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},oe("CHECK_VIDEO_VISIBLE_INTERVAL")),this.safeEmit(Co.PLAY_END)}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,V.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){s9(this._originMediaStreamTrack).then(r=>{let[a,s]=r;this._videoHeight=s,this._videoWidth=a}).catch(qx)}_updatePlayerSource(){V.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var r,a;const s=this==null||(r=this._player)===null||r===void 0?void 0:r.getContainerElement(),l={track:this,element:this==null||(a=this._player)===null||a===void 0?void 0:a.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:d,slot:f}=l;if(this.isPlaying&&d instanceof HTMLVideoElement&&f instanceof HTMLElement){const m=oz.checkOneElementVisible(d),y=Object.assign({},m);if(y.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=y.visible;const _=it.reportApiInvoke(null,{tag:rr.TRACER,name:Er.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});y.visible?_.onSuccess("Video is visible"):_.onSuccess("Invisible because of ".concat(y.reason))}return y}return}catch(s){throw new we(ie.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}pipe(r){if(this.processor===r)return r;if(r._source)throw new we(ie.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),r}unpipe(){if(!this.processor)return;const r=this.processor;this.processor._source=void 0,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ja.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ja.ON_TRACK)}_destroy(){this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0),super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(r){this.emit(cp.SEI_RECEIVED,r)}}).prototype,"play",[k7],Object.getOwnPropertyDescriptor(Ro.prototype,"play"),Ro.prototype),rn(Ro.prototype,"stop",[j7],Object.getOwnPropertyDescriptor(Ro.prototype,"stop"),Ro.prototype),rn(Ro.prototype,"pipe",[D7],Object.getOwnPropertyDescriptor(Ro.prototype,"pipe"),Ro.prototype),rn(Ro.prototype,"unpipe",[L7],Object.getOwnPropertyDescriptor(Ro.prototype,"unpipe"),Ro.prototype),Ro),Og=(M7=Et({argsMap:(r,a)=>[r.getTrackId(),a],throttleTime:300}),U7=Et({argsMap:(r,a)=>[r.getTrackId(),a]}),F7=Et({argsMap:r=>[r.getTrackId()]}),V7=Et({argsMap:r=>[r.getTrackId()]}),B7=Et({argsMap:(r,a)=>[r.getTrackId(),a.name]}),$7=Et({argsMap:r=>[r.getTrackId()]}),rn((wa=class extends W7{get isPlaying(){return this._useAudioElement?qa.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(r,a,s,l){super(r,a,s,l),_e(this,"trackMediaType",Cg.AUDIO),_e(this,"_source",void 0),_e(this,"_useAudioElement",!0),_e(this,"_volume",100),_e(this,"processorContext",void 0),_e(this,"processorDestination",void 0),_e(this,"_played",!1),_e(this,"_bypassWebAudio",!1),oe("DISABLE_WEBAUDIO")?(this._source=new Hj,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new Yz(r,!0),oe("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Xs.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Co.FIRST_FRAME_DECODED)}),this.processorContext=new a9(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new i9(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Xs.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!r)return this._source.removeAllListeners(Xs.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(a),this._source.removeAllListeners(Xs.ON_AUDIO_BUFFER),this._source.on(Xs.ON_AUDIO_BUFFER,s=>r(s))}setVolume(r){this._volume=r,this._useAudioElement?qa.setVolume(this.getTrackId(),r):this._source.setVolume(r/100)}async setPlaybackDevice(r){if(!this._useAudioElement||!Fz())throw new we(ie.NOT_SUPPORTED,"your browser does not support setting the audio output device");await qa.setSinkID(this.getTrackId(),r)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return uh(()=>{V.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),qs(this,et.GET_STATS)||$n({},$z)}play(){V.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(V.debug("[".concat(this.getTrackId(),"] use audio element to play")),qa.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){V.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?qa.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];V.debug("[".concat(this.getTrackId(),"] update player source track")),r&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&qa.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(r){if(this._bypassWebAudio)throw new we(ie.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===r)return r;if(r._source)throw new we(ie.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),r}unpipe(){var r;if(this._bypassWebAudio)throw new we(ie.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const a=this.processor;(r=this._source.processSourceNode)===null||r===void 0||r.disconnect(),this.processor._source=!1,this.processor=void 0,a.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ja.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(r)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(ja.ON_NODE,r=>{this._source.processedNode=r;const a=!r;this._useAudioElement!==a&&(this._played?(this.stop(),this._useAudioElement=a,this.play()):this._useAudioElement=a)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ja.ON_TRACK),this.processorDestination.removeAllListeners(ja.ON_NODE)}}).prototype,"setVolume",[M7],Object.getOwnPropertyDescriptor(wa.prototype,"setVolume"),wa.prototype),rn(wa.prototype,"setPlaybackDevice",[U7],Object.getOwnPropertyDescriptor(wa.prototype,"setPlaybackDevice"),wa.prototype),rn(wa.prototype,"play",[F7],Object.getOwnPropertyDescriptor(wa.prototype,"play"),wa.prototype),rn(wa.prototype,"stop",[V7],Object.getOwnPropertyDescriptor(wa.prototype,"stop"),wa.prototype),rn(wa.prototype,"pipe",[B7],Object.getOwnPropertyDescriptor(wa.prototype,"pipe"),wa.prototype),rn(wa.prototype,"unpipe",[$7],Object.getOwnPropertyDescriptor(wa.prototype,"unpipe"),wa.prototype),wa);const iu=new class extends cr{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),_e(this,"_lastHiddenTime",0),_e(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),V.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class G7 extends cr{constructor(a,s){super(),_e(this,"trackMediaType",Cg.DATA),_e(this,"_version",1),_e(this,"_type",3),_e(this,"_config",void 0),_e(this,"_originDataChannel",void 0),_e(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),_e(this,"_dataStreamPacketHandler",{serialize:l=>l,deserialize:l=>l}),_e(this,"_datachannelEventMap",new Map),this._config=a,s&&(this._originDataChannel=s,this._bandDataChannelEvents(s)),this._initPacketHeader()}useDataStream(a){this._dataStreamPacketHandler=a}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return oe("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var a,s;return(a=(s=this._originDataChannel)===null||s===void 0?void 0:s.readyState)!==null&&a!==void 0?a:"connecting"}get _originDataChannelId(){var a,s;return(a=(s=this._originDataChannel)===null||s===void 0?void 0:s.id)!==null&&a!==void 0?a:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new He((a,s)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&a();const l=setTimeout(()=>{var d;s(new we(ie.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((d=this._originDataChannel)===null||d===void 0?void 0:d.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(l),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),a()},this._originDataChannel.onerror=()=>{throw clearTimeout(l),new we(ie.DATACHANNEL_CONNECTION_TIMEOUT)}}else s(new we(ie.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(a){this._originDataChannel=a,this._bandDataChannelEvents(a)}_initPacketHeader(){const a=new DataView(this._dataStreamPacketHeader);a.setUint16(0,this._version),a.setUint8(2,this._type),a.setUint8(3,this._config.id)}_bandDataChannelEvents(a){this._unbindDataChannelEvents(a),[rT.OPEN,rT.CLOSE,rT.ERROR].forEach(s=>{const l=()=>{this.emit(s)};this._datachannelEventMap.set(s,l),a.addEventListener(s,l)})}_unbindDataChannelEvents(a){Array.from(this._datachannelEventMap.entries()).forEach(s=>{let[l,d]=s;a.removeEventListener(l,d)}),this._datachannelEventMap.clear()}}class dIe extends G7{constructor(a){super(a),_e(this,"_messageListener",void 0),this._messageListener=s=>{if(s.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const l=s.data.slice(0,this._dataStreamPacketHeader.byteLength),d=new DataView(l).getUint8(3);if(d!==this.id)return void(oe("SHOW_DATASTREAM2_LOG")&&V.debug("invalid datachannel id: ".concat(d," !== ").concat(this.id)));let f=s.data.slice(this._dataStreamPacketHeader.byteLength);f=this._dataStreamPacketHandler.deserialize(f),this.emit(rT.MESSAGE,f)}}_updateOriginDataChannel(a){super._updateOriginDataChannel(a),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class hIe extends G7{send(a){if(this._originDataChannel){let s=a;s=this._dataStreamPacketHandler.serialize(a);const l=new Uint8Array(this._dataStreamPacketHeader.byteLength+s.byteLength);l.set(new Uint8Array(this._dataStreamPacketHeader),0),l.set(new Uint8Array(s),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(l.buffer)}}}function oT(){const r=new Blob([atob("Y29uc3QgdD0idmlkZW8vaDI2NCIsZT0idmlkZW8vaDI2NSI7ZnVuY3Rpb24gbih0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLHI9W10sbz0wO2Zvcig7ci5sZW5ndGg8bjspbyszPG4mJjA9PT1hW29dJiYwPT09YVtvKzFdJiYzPT09YVtvKzJdJiYoMD09PWFbbyszXXx8MT09PWFbbyszXXx8Mj09PWFbbyszXXx8Mz09PWFbbyszXSk/KHIucHVzaChhW29dLGFbbysxXSxhW28rM10pLG8rPTQpOihyLnB1c2goYVtvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkocil9ZnVuY3Rpb24gYShhLHIpe3N3aXRjaChyKXtjYXNlIHQ6cmV0dXJuIGZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IERhdGFWaWV3KHQuZGF0YSk7bGV0IGE9MDtmb3IoO2ErNDx0LmRhdGEuYnl0ZUxlbmd0aDspe2lmKDA9PT1lLmdldFVpbnQ4KGErMCkmJjA9PT1lLmdldFVpbnQ4KGErMSkmJjA9PT1lLmdldFVpbnQ4KGErMikmJjE9PT1lLmdldFVpbnQ4KGErMykmJjY9PT1lLmdldFVpbnQ4KGErNCkpe2xldCByPWErNixvPTAsaT0wO2Zvcig7MjU1PT09KGk9ZS5nZXRVaW50OChyKyspKTspbys9MjU1O28rPWk7Y29uc3Qgcz1uKHQuZGF0YSxyLG8pO3JldHVybiBuZXcgVWludDhBcnJheShzKX1hKyt9cmV0dXJuIG51bGx9KGEpO2Nhc2UgZTpyZXR1cm4gZnVuY3Rpb24odCl7Y29uc3QgZT1uZXcgRGF0YVZpZXcodC5kYXRhKTtsZXQgYT0wO2Zvcig7YSs1PHQuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PWUuZ2V0VWludDgoYSswKSYmMD09PWUuZ2V0VWludDgoYSsxKSYmMD09PWUuZ2V0VWludDgoYSsyKSYmMT09PWUuZ2V0VWludDgoYSszKSYmNzg9PT1lLmdldFVpbnQ4KGErNCkmJjE9PT1lLmdldFVpbnQ4KGErNSkmJjEwMT09PWUuZ2V0VWludDgoYSs2KSl7bGV0IHI9YSs3LG89MCxpPTA7Zm9yKDsyNTU9PT0oaT1lLmdldFVpbnQ4KHIrKykpOylvKz0yNTU7bys9aTtjb25zdCBzPW4odC5kYXRhLHIsbyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KHMpfWErK31yZXR1cm4gbnVsbH0oYSk7ZGVmYXVsdDpyZXR1cm4gbnVsbH19ZnVuY3Rpb24gcih0KXtjb25zdCBlPXQubGVuZ3RoO2xldCBuPVtdLGE9MDtmb3IoO2E8ZTspYSsyPGUmJjA9PT10W2FdJiYwPT09dFthKzFdJiYoMD09PXRbYSsyXXx8MT09PXRbYSsyXXx8Mj09PXRbYSsyXXx8Mz09PXRbYSsyXSk/KG4ucHVzaCh0W2FdLHRbYSsxXSwzLHRbYSsyXSksYSs9Myk6KG4ucHVzaCh0W2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShuKX1mdW5jdGlvbiBvKG4sYSxvKXtzd2l0Y2gobyl7Y2FzZSB0OnJldHVybiBmdW5jdGlvbih0LGUpe2NvbnN0IG49cihlKSxhPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihhLzI1NSksaT1hJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK2ErdC5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNitmXT0yNTUsZisrO3JldHVybiBzWzYrZl09aSxmKysscy5zZXQobiw2K2YpLHMuc2V0KG5ldyBVaW50OEFycmF5KHQpLDYrZithKSxzLmJ1ZmZlcn0obixhKTtjYXNlIGU6cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3Qgbj1yKGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxpPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNytvKzErYSsxK3QuYnl0ZUxlbmd0aCk7c1swXT0wLHNbMV09MCxzWzJdPTAsc1szXT0xLHNbNF09Nzgsc1s1XT0xLHNbNl09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNytmXT0yNTUsZisrO3JldHVybiBzWzcrZl09aSxmKysscy5zZXQobiw3K2YpLGYrPWEsc1s3K2ZdPTEyOCxmKysscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNytmKSxzLmJ1ZmZlcn0obixhKTtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBpKG4pe2lmKG4ubGVuZ3RoPDUpcmV0dXJuIiI7bGV0IGE9LTE7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aC0zO3QrKyl7aWYoMD09PW5bdF0mJjA9PT1uW3QrMV0mJjE9PT1uW3QrMl0pe2E9dDticmVha31pZih0PG4ubGVuZ3RoLTQmJjA9PT1uW3RdJiYwPT09blt0KzFdJiYwPT09blt0KzJdJiYxPT09blt0KzNdKXthPXQ7YnJlYWt9fWlmKC0xPT09YSlyZXR1cm4iIjtjb25zdCByPWErKDA9PT1uW2ErMl0/NDozKTtpZihyPj1uLmxlbmd0aClyZXR1cm4iIjtjb25zdCBvPW5bcl07aWYoMTI4Jm8pcmV0dXJuIiI7aWYoKG8+PjEmNjMpPj0zMilyZXR1cm4gZTtpZihyKzE8bi5sZW5ndGgpe2lmKDA9PSgyNDgmbltyKzFdKSlyZXR1cm4gZX1yZXR1cm4oMzEmbyk8PTMxP3Q6IiJ9Y29uc3Qgcz03MSxmPTEsbD0yLHU9MSxnPTI7dmFyIGM7ZnVuY3Rpb24gZCh0LGU9ITEpe2NvbnN0IG49dC5nZXRVaW50OCgwKTtpZihuIT09cylyZXR1cm47Y29uc3QgYT10LmdldFVpbnQxNigxKSxyPWYrbCthLG89bmV3IFVpbnQ4QXJyYXkodC5ieXRlTGVuZ3RoLXIpO28uc2V0KG5ldyBVaW50OEFycmF5KHQuYnVmZmVyLHIsdC5ieXRlTGVuZ3RoLXIpKTtjb25zdCBpPXttOm4sdGx2TGVuOmEsdGx2OltdLGZyYW1lOm99O2xldCBkPWYrbDtmb3IoO2Q8cjspe2NvbnN0IG49dC5nZXRVaW50OChkKSxhPXQuZ2V0VWludDE2KGQrdSkscj11K2c7aWYobj09PWMuQVVESU9fTEVWRUwpe2xldCBvPXQuZ2V0VWludDgoZCtyKTtmb3IobGV0IGU9MTtlPGE7ZSsrKW89bzw8OHx0LmdldFVpbnQ4KGQrcitlKTtpLnRsdi5wdXNoKHt0YWc6bixsZW5ndGg6YSx2YWx1ZTplPzEyN15vPj4xOjEyNyZvfSl9ZWxzZSBpZihuPT09Yy5NRVRBREFUQXx8bj09PWMuQVVESU9fNjRfQklUX1BUUyl7Y29uc3QgZT1uZXcgVWludDhBcnJheShhKTtmb3IobGV0IG49MDtuPGE7bisrKWVbbl09dC5nZXRVaW50OChkK3Irbik7aS50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZX0pfWQrPXIrYX1yZXR1cm4gaX0hZnVuY3Rpb24odCl7dFt0LkFVRElPX0xFVkVMPTFdPSJBVURJT19MRVZFTCIsdFt0Lk1FVEFEQVRBPTJdPSJNRVRBREFUQSIsdFt0LkFVRElPXzY0X0JJVF9QVFM9M109IkFVRElPXzY0X0JJVF9QVFMifShjfHwoYz17fSkpLHNlbGYub25ydGN0cmFuc2Zvcm09dD0+e2NvbnN0IGU9dC50cmFuc2Zvcm1lcjtsZXQgbj1bXSxyPVtdO2Uub3B0aW9ucy5wb3J0Lm9ubWVzc2FnZT10PT57dC5kYXRhLnNlaSYmbi5wdXNoKHQuZGF0YS5zZWkpLHQuZGF0YS5tZXRhZGF0YSYmci5wdXNoKHQuZGF0YS5tZXRhZGF0YSl9LHNlbGYucG9zdE1lc3NhZ2UoInN0YXJ0ZWQiKTtjb25zdCBoPWUucmVhZGFibGUuZ2V0UmVhZGVyKCksVT1lLndyaXRhYmxlLmdldFdyaXRlcigpOyJzZWktcngiPT09ZS5vcHRpb25zLm5hbWU/ZnVuY3Rpb24gdChlKXtoLnJlYWQoKS50aGVuKChuPT57aWYoIW4uZG9uZSl7aWYobi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRWaWRlb0ZyYW1lKXtjb25zdCB0PWkobmV3IFVpbnQ4QXJyYXkobi52YWx1ZS5kYXRhKSkscj1hKG4udmFsdWUsdCk7ciYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTpyfSl9VS53cml0ZShuLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSk6InNlaS10eCI9PT1lLm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2gucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9aShuZXcgVWludDhBcnJheShhLnZhbHVlLmRhdGEpKSxlPW4uc2hpZnQoKTtpZihlKXtjb25zdCBuPW8oYS52YWx1ZS5kYXRhLGUsdCk7biYmKGEudmFsdWUuZGF0YT1uKX19VS53cml0ZShhLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSk6ImF1ZGlvLW1ldGFkYXRhLXJ4Ij09PWUub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQoZSl7aC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkQXVkaW9GcmFtZSl7Y29uc3QgdD1uZXcgRGF0YVZpZXcobi52YWx1ZS5kYXRhKSxhPXQuZ2V0VWludDgoMCk7bGV0IHI7aWYoMCE9KDEyOCZhKSYmNzEhPT1hKXtsZXQgZT1mdW5jdGlvbih0KXtpZih0LmJ5dGVMZW5ndGg8PTApcmV0dXJuW107Y29uc3QgZT1bXTtsZXQgbj0wO2Zvcig7bjx0LmJ5dGVMZW5ndGg7KXtjb25zdCBhPSgxMjgmdC5nZXRVaW50OChuKSk+Pjcscj0xMjcmdC5nZXRVaW50OChuKTtpZighKGEmJm4rNDw9dC5ieXRlTGVuZ3RoKSl7bisrO2JyZWFrfXtjb25zdCBhPXQuZ2V0VWludDMyKG4sITEpLG89KDE2Nzc2MTkyJmEpPj4xMCxpPTEwMjMmYTtlLnB1c2goe3B0OnIsdHNfb2Zmc2V0Om8sbGVuZ3RoOmksZGF0YTpuZXcgVWludDhBcnJheX0pLG4rPTR9fWxldCBhPXQuYnl0ZUxlbmd0aC1uO2Zvcihjb25zdCByIG9mIGUpe2lmKHIubGVuZ3RoPmEpcmV0dXJuIGNvbnNvbGUud2FybigiQnJva2VuIHJlZCBwYXlsb2FkIiksW107ci5sZW5ndGg+MCYmKHIuZGF0YT1uZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbixyLmxlbmd0aCksbis9ci5sZW5ndGgsYS09ci5sZW5ndGgpfWlmKGE+MCl7Y29uc3Qgcj17cHQ6ZS5sZW5ndGg+MD9lW2UubGVuZ3RoLTFdLnB0OjAsdHNfb2Zmc2V0OjAsbGVuZ3RoOmEsZGF0YTpuZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbixhKX07ZS5wdXNoKHIpfXJldHVybiBlfSh0KTtpZihlLmxlbmd0aD4wKXtjb25zdCB0PWZ1bmN0aW9uKHQpe2xldCBlPTA7Zm9yKGxldCBuPTA7bjx0Lmxlbmd0aDtuKyspZSs9bjx0Lmxlbmd0aC0xPzQ6MSxlKz10W25dLmxlbmd0aDtjb25zdCBuPW5ldyBVaW50OEFycmF5KGUpO2xldCBhPTA7Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDtlKyspaWYoZTx0Lmxlbmd0aC0xKXtjb25zdCByPSgyMTQ3NDgzNjQ4fCgxMjcmdFtlXS5wdCk8PDI0fCgyNjIxNDMmdFtlXS50c19vZmZzZXQpPDwxMHwxMDIzJnRbZV0ubGVuZ3RoKT4+PjA7blthKytdPXI+PjI0JjI1NSxuW2ErK109cj4+MTYmMjU1LG5bYSsrXT1yPj44JjI1NSxuW2ErK109MjU1JnJ9ZWxzZSBuW2ErK109MTI3JnRbZV0ucHQ7Zm9yKGNvbnN0IGUgb2YgdCluLnNldChlLmRhdGEsYSksYSs9ZS5sZW5ndGg7cmV0dXJuIG59KGUubWFwKCh0PT57bGV0IGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpO2Uuc2V0KHQuZGF0YSk7Y29uc3Qgbj1kKG5ldyBEYXRhVmlldyhlLmJ1ZmZlcikpO3JldHVybiBuPy5mcmFtZSYmKHQuZGF0YT1uPy5mcmFtZSkscj1uLHR9KSkpO24udmFsdWUuZGF0YT10LmJ1ZmZlcn19ZWxzZSByPWQodCksciYmKG4udmFsdWUuZGF0YT1yLmZyYW1lLmJ1ZmZlcik7aWYocil7bGV0IHQ9ci50bHYuZmluZCgodD0+dC50YWc9PT1jLk1FVEFEQVRBKSk7aWYodCYmdC52YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJmUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHttZXRhZGF0YTp0LnZhbHVlfSksdD1yLnRsdi5maW5kKCh0PT50LnRhZz09PWMuQVVESU9fNjRfQklUX1BUUykpLHQmJnQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5JiY4PT10LnZhbHVlLmxlbmd0aCl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcodC52YWx1ZS5idWZmZXIpLmdldEJpZ1VpbnQ2NCgwLCEwKTt0JiZ0LnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3B0czpufSl9fX1VLndyaXRlKG4udmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToiYXVkaW8tbWV0YWRhdGEtdHgiPT09ZS5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIHQoZSl7aC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHtnZXRNZXRhZGF0YTohMH0pLG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkQXVkaW9GcmFtZSl7Y29uc3QgdD1yLnNoaWZ0KCk7dCYmKG4udmFsdWUuZGF0YT1mdW5jdGlvbih0LGUsbil7Y29uc3QgYT1uLmJ5dGVMZW5ndGgscj1hK3UrZyxvPWYrbCtyLGk9bmV3IEFycmF5QnVmZmVyKHQuYnl0ZUxlbmd0aCtvKSxjPW5ldyBEYXRhVmlldyhpKTtjLnNldFVpbnQ4KDAscyksYy5zZXRVaW50MTYoMSxyKSxjLnNldFVpbnQ4KDMsZSksYy5zZXRVaW50MTYoNCxhKTtmb3IobGV0IHQ9MDt0PGE7dCsrKWMuc2V0VWludDgoNit0LG5bdF0pO2NvbnN0IGQ9bmV3IFVpbnQ4QXJyYXkoYy5idWZmZXIpO3JldHVybiBkLnNldChuZXcgVWludDhBcnJheSh0KSxvKSxkLmJ1ZmZlcn0obi52YWx1ZS5kYXRhLGMuQVVESU9fNjRfQklUX1BUUyx0KSl9VS53cml0ZShuLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSl9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKTsK")],{type:"text/javascript"});return setTimeout(()=>sx.revokeObjectURL(r),0),new Worker(sx.createObjectURL(r))}const H7=71,Xj=1,Jj=2,Zj=1,z7=2;var fh=function(r){return r[r.AUDIO_LEVEL=1]="AUDIO_LEVEL",r[r.METADATA=2]="METADATA",r[r.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",r}(fh||{});function Qj(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=r.getUint8(0);if(s!==H7)return;const l=r.getUint16(1),d=Xj+Jj+l,f=new Uint8Array(r.byteLength-d);f.set(new Uint8Array(r.buffer,d,r.byteLength-d));const m={m:s,tlvLen:l,tlv:[],frame:f};let y=Xj+Jj;for(;y<d;){const _=r.getUint8(y),S=r.getUint16(y+Zj),x=Zj+z7;if(_===fh.AUDIO_LEVEL){let A=r.getUint8(y+x);for(let I=1;I<S;I++)A=A<<8|r.getUint8(y+x+I);m.tlv.push({tag:_,length:S,value:a?127^A>>1:127&A})}else if(_===fh.METADATA||_===fh.AUDIO_64_BIT_PTS){const A=new Uint8Array(S);for(let I=0;I<S;I++)A[I]=r.getUint8(y+x+I);m.tlv.push({tag:_,length:S,value:A})}y+=x+S}return m}const cT=new Map,lT=127,dp=1e-10,eD=139/13,uT=new Map;function tD(r,a,s){const l="".concat(r,"-").concat(a,"-").concat(s);let d=0;return uT.has(l)?d=uT.get(l):(d=Math.log(function(m,y){const _=m-y;y<_&&(y=_);let S=1;for(let x=m,A=1;x>y;x--,A++)S=S*x/A;return S}(a,r))+r*Math.log(.5)+(a-r)*Math.log(1-.5)-Math.log(s)+s*r,uT.set(l,d)),d<dp&&(d=dp),d}function K7(r,a,s){const l=a.length,d=r.length/l;let f=!1;for(let m=0,y=0;m<l;m++){let _=0;for(let S=y+d;y<S;y++)r[y]>s&&_++;a[m]!==_&&(a[m]=_,f=!0)}return f}window.cache=uT;let fIe=0;class q7{constructor(a){_e(this,"id",void 0),_e(this,"immediates",[]),_e(this,"lastNonSilence",-1),_e(this,"immediateSpeechActivityScore",dp),_e(this,"lastLevelChangedTime",Date.now()),_e(this,"levels",[]),_e(this,"longs",[]),_e(this,"longSpeechActivityScore",dp),_e(this,"mediums",[]),_e(this,"mediumSpeechActivityScore",dp),_e(this,"minLevel",0),_e(this,"nextMinLevel",0),_e(this,"nextMinLevelWindowLength",0),_e(this,"energyScore",0),this.id=a||"".concat(fIe++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const a=this.immediates,s=this.levels,l=this.minLevel+eD;let d=!1;for(let f=0;f<a.length;++f){let m=s[f];m<l&&(m=0);const y=Math.floor(m/eD);a[f]!==y&&(a[f]=y,d=!0)}return d}computeLongs(){return K7(this.mediums,this.longs,4)}computeMediums(){return K7(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=tD(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(a){this.longSpeechActivityScore=tD(this.longs[0],10,47),this.longSpeechActivityScore>dp&&(this.lastNonSilence=a)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=tD(this.mediums[0],5,24)}evaluateSpeechActivityScores(a){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(a)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var a;return"[".concat(R5(a=[...this.levels]).call(a).join(),"]")}getSpeechActivityScore(a){switch(a){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+a)}}levelChanged(a,s){if(this.lastLevelChangedTime<=s){this.lastLevelChangedTime=s;let l=a;return a<0&&(l=0),a>lT&&(l=lT),this.levels.unshift(l),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(l),l>=this.minLevel+eD?l:l/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(a){if(a!==0){if(this.minLevel===0||this.minLevel>a)return this.minLevel=a,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=a,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>a&&(this.nextMinLevel=a),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let s=Math.sqrt(this.minLevel*this.nextMinLevel);s<0?s=0:s>lT&&(s=lT),this.minLevel=s,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class pIe{constructor(a){_e(this,"algorithm",void 0),this.algorithm=a}execute(){let a=!this.algorithm;if(!a)try{const s=this.algorithm.runInDecisionMaker(this);s<=0?a=!0:setTimeout(this.execute.bind(this),s)}catch{a=!0}a&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class nD{constructor(a,s,l){_e(this,"isDominant",void 0),_e(this,"energyRanking",void 0),_e(this,"energyScore",void 0),this.isDominant=a,this.energyRanking=s,this.energyScore=l}}class mIe extends cr{constructor(a){super(),_e(this,"dominantId",null),_e(this,"lastDecisionTime",0),_e(this,"lastLevelChangedTime",0),_e(this,"lastLevelIdleTime",0),_e(this,"relativeSpeechActivities",[]),_e(this,"speakers",new Map),_e(this,"enableSilence",!1),_e(this,"timeoutToSilenceInterval",0),_e(this,"decisionMaker",null),_e(this,"loudest",[]),_e(this,"numLoudestToTrack",3),_e(this,"energyExpireTimeMs",250),_e(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=a,this.enableSilence=a>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,s=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=a,s!=null&&(this.energyExpireTimeMs=s),l!=null&&(this.energyAlphaPct=l),this.loudest.length>a&&this.loudest.splice(a)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(a){return this.loudest.some(s=>s.id===a)}levelChanged(a,s){const l=Date.now(),d=this.getOrCreateSpeaker(a);this.lastLevelChangedTime<l&&(this.lastLevelChangedTime=l,this.maybeStartDecisionMaker());const f=d.levelChanged(s,l);return this.updateLoudestList(d,f,l)}runInDecisionMaker(a){return this.decisionMaker!==a||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(a){this.decisionMaker===a&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(a){a.forEach(s=>{this.speakers.has(s.id)||this.speakers.set(s.id,s)})}removeSpeakers(a){a.forEach(s=>{this.speakers.delete(s.id)})}getOrCreateSpeaker(a){let s=this.speakers.get(a);return s||(s=new q7(a),this.speakers.set(a,s),this.maybeStartDecisionMaker()),s}updateLoudestList(a,s,l){const d=a.id===this.dominantId;if(s<0){let _=0;for(;_<this.loudest.length&&this.loudest[_]!==a;)++_;return new nD(d,_,a.energyScore)}if(a.energyScore=Math.floor((this.energyAlphaPct*s+(100-this.energyAlphaPct)*a.energyScore+50)/100),this.numLoudestToTrack===0)return new nD(d,0,a.energyScore);const f=l-this.energyExpireTimeMs;let m=0;for(;m<this.loudest.length;){const _=this.loudest[m];if(_.getLastLevelChangedTime()<f&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(m,1);else if(_.id!==a.id)++m;else if(this.loudest.splice(m,1),this.loudest.length<this.numLoudestToTrack)break}let y=0;for(;y<this.loudest.length&&!(this.loudest[y].energyScore<a.energyScore);)++y;return y<this.numLoudestToTrack&&(this.loudest.splice(y,0,a),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new nD(d,y,a.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new pIe(this),this.decisionMaker.execute())}makeDecision(a){let s=null,l=null;const d=this.speakers.size;let f=null;if(d===0)f=null;else if(d===1){var m;const y=Cs(m=this.speakers).call(m).next().value;this.enableSilence&&y&&(f=y.id,y.evaluateSpeechActivityScores(a),a-y.lastNonSilence>this.timeoutToSilenceInterval&&(f=null))}else{let y=this.dominantId==null?null:this.speakers.get(this.dominantId);if(y==null){const x=this.speakers.entries().next();x.value&&(f=x.value[0],y=x.value[1])}else f=y.id;y!=null&&y.evaluateSpeechActivityScores(a);const _=this.relativeSpeechActivities;let S=2;for(const x of this.speakers.entries()){const[A,I]=x;if(I===y)continue;I.evaluateSpeechActivityScores(a);for(let G=0;G<_.length;++G){const ne=y==null?dp:y.getSpeechActivityScore(G);_[G]=Math.log(I.getSpeechActivityScore(G)/ne)}const L=_[0],K=_[1],$=_[2];L>3&&K>2&&$>0&&K>S&&(S=K,f=A)}this.enableSilence&&y!=null&&f===y.id&&a-y.lastNonSilence>this.timeoutToSilenceInterval&&(f=null)}f==null&&!this.enableSilence||f===this.dominantId||(s=this.dominantId,this.dominantId=f,l=this.dominantId),l==null&&!this.enableSilence||l===s||this.emit("ActiveSpeakerChanged",l)}_runInDecisionMaker(){const a=Date.now(),s=300-(a-this.lastLevelIdleTime);let l=0;s<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(a),this.lastLevelIdleTime=a):l=s;let d=300-(a-this.lastDecisionTime);return d<=0&&(this.lastDecisionTime=a,this.makeDecision(a),d=300-(Date.now()-a)),d>0&&l>d&&(l=d),l}timeoutIdleLevels(a){const s=[];for(const d of Cs(l=this.speakers).call(l)){var l;const f=a-d.getLastLevelChangedTime();36e5<f&&(this.dominantId==null||d.id!==this.dominantId)?s.push(d.id):300<f&&d.levelTimedOut()}s.forEach(d=>this.speakers.delete(d))}}const Pg=new Map;let rl=null,dT=null;const Y7=3;let hp=[];const il=new Map,hT=new Map;class gIe{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(a,s){_e(this,"id",void 0),_e(this,"track",void 0),_e(this,"score",0),_e(this,"active",!0),_e(this,"muted",!1),_e(this,"timer",0),_e(this,"actives",0),_e(this,"inactives",0),this.id=a,this.track=s,this.setActive(il.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const a=this.active;this.active=this.activeRate>=.8;const{actives:s,inactives:l}=function(){const d=[],f=[];return Array.from(Cs(il).call(il)).forEach(m=>{m.active?d.push(m):f.push(m)}),{actives:d,inactives:f}}();if(s.length>3){let d;s.forEach(f=>{(!d||d.score>f.score)&&(d=f)}),d&&d.setActive(!1)}if(s.length<3&&l.length>0){let d;l.forEach(f=>{(!d||d.score<f.score)&&f.id!==this.id&&(d=f)}),d&&a&&!this.active&&(d.samples>40&&d.activeRate-this.activeRate>.4?d.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(a){this.active=a,this.resetTimer(),this.setMuted(!a)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const a=function(s){let l;return Array.from(Cs(il).call(il)).forEach(d=>{!d.active||d.id===s||d.samples<40||(!l||d.score<l.score)&&(l=d)}),l}(this.id);a&&this.activeRate-a.activeRate>.4&&(a.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const a=function(s){let l;return Array.from(Cs(il).call(il)).forEach(d=>{d.active||d.id===s||d.samples<40||(!l||d.score>l.score)&&(l=d)}),l}(this.id);a&&a.activeRate-this.activeRate>.4&&(a.setActive(!0),this.setActive(!1))}addSample(a){a?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(a){this.track&&(this.track.enabled=!a,this.muted=a)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let fT;function X7(r){const a=il.get(r);a&&(il.delete(r),a.clearTimer())}const pT=new Map,vIe=new Map,rD="video/h264",iD="video/h265";function J7(r,a,s){let l=new Uint8Array(r,a,s),d=[],f=0;for(;d.length<s;)f+3<s&&l[f]===0&&l[f+1]===0&&l[f+2]===3&&(l[f+3]===0||l[f+3]===1||l[f+3]===2||l[f+3]===3)?(d.push(l[f],l[f+1],l[f+3]),f+=4):(d.push(l[f]),f++);return new Uint8Array(d)}function Z7(r){const a=r.length;let s=[],l=0;for(;l<a;)l+2<a&&r[l]===0&&r[l+1]===0&&(r[l+2]===0||r[l+2]===1||r[l+2]===2||r[l+2]===3)?(s.push(r[l],r[l+1],3,r[l+2]),l+=3):(s.push(r[l]),l++);return new Uint8Array(s)}function Q7(r){if(r.length<5)return"";let a=-1;for(let d=0;d<r.length-3;d++){if(r[d]===0&&r[d+1]===0&&r[d+2]===1){a=d;break}if(d<r.length-4&&r[d]===0&&r[d+1]===0&&r[d+2]===0&&r[d+3]===1){a=d;break}}if(a===-1)return"";const s=a+(r[a+2]===0?4:3);if(s>=r.length)return"";const l=r[s];return 128&l?"":(l>>1&63)>=32||s+1<r.length&&!(248&r[s+1])?iD:(31&l)<=31?rD:""}const mT=new Map,vb=new Map;(function(){const r=an();Ci.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Ci.getStreamFromExtension=r.name===fn.CHROME&&Number(r.version)>34,Ci.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const a=new RTCPeerConnection;let s=!1;try{a.addTransceiver("audio"),s=!0}catch{}return a.close(),s}(),Ci.supportMinBitrate=r.name===fn.CHROME||r.name===fn.EDGE,Ci.supportSetRtpSenderParameters=function(){const a=an();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!rd()||!(!ji()&&!Gx())||a.name===fn.FIREFOX&&Number(a.version)>=64)}(),r.name===fn.SAFARI&&(Number(r.version)>=14?Ci.supportDualStream=!0:Ci.supportDualStream=!1),Ci.webAudioMediaStreamDest=function(){const a=an();return!(a.name===fn.SAFARI&&Number(a.version)<12)}(),Ci.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",Ci.supportWebGL=typeof WebGLRenderingContext<"u",Ci.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,rd()||(Ci.webAudioWithAEC=!0),Ci.supportShareAudio=function(){const a=an();return(a.os===oi.WIN_10||a.os===oi.WIN_81||a.os===oi.WIN_7||a.os===oi.LINUX||a.os===oi.MAC_OS||a.os===oi.CHROMIUM_OS)&&a.name===fn.CHROME&&Number(a.version)>=74}(),Ci.supportDataChannel=!!(pg(76)||lj(68)||ZH(14)),Ci.supportPCSetConfiguration=function(){const a=window.RTCPeerConnection;return!dr()&&!!a&&a.prototype.setConfiguration instanceof Function}(),Ci.supportWebRTCEncodedTransform=pg(87)||YH()||lj(117),Ci.supportWebRTCInsertableStream=function(){const a=an();return(a.name===fn.CHROME||a.name===fn.EDGE)&&Number(a.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Ci.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,Ci.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,Kx(()=>{Ci.supportDualStreamEncoding=function(){const a=an();return!!oe("DISABLE_WEBAUDIO")||a.name==="Safari"&&Number(a.version)>=14||!!(a.name==="Chrome"&&/Windows/i.test(a.os||"")&&Number(a.version)>=100&&oe("CHROME_DUAL_STREAM_USE_ENCODING"))}(),V.debug("browser ua: ",navigator.userAgent),V.info("browser info: ",r),V.info("browser compatibility: ",Ci)})})();const yIe=["CHINA","GLOBAL"],eK=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],fp=[],kg=[];function pp(r,a){return!!a&&fp.some(s=>s.uid===r&&s.channelName===a)}function aD(){return kg.length>0}var _Ie=pG.forEach,tK=yS("forEach")?[].forEach:function(r){return _Ie(this,r,arguments.length>1?arguments[1]:void 0)};Tn({target:"Array",proto:!0,forced:[].forEach!==tK},{forEach:tK});var bIe=nc("Array","forEach"),EIe=th,wIe=aa,SIe=T,xIe=bIe,sD=Array.prototype,TIe={DOMTokenList:!0,NodeList:!0},CIe=function(r){var a=r.forEach;return r===sD||SIe(sD,r)&&a===sD.forEach||wIe(TIe,EIe(r))?xIe:a},RIe=o(CIe),NIe=ql,nK=xS;Tn({target:"Object",stat:!0,forced:u(function(){nK(1)})},{keys:function(r){return nK(NIe(r))}});var AIe=o(Le.Object.keys),IIe=o(x5),OIe=o(C5),PIe=Tn,rK=A_,kIe=US,jIe=Rt,iK=CO,DIe=eh,LIe=ut,MIe=GP,UIe=qr,FIe=rh,VIe=iG("slice"),BIe=UIe("species"),oD=Array,$Ie=Math.max;PIe({target:"Array",proto:!0,forced:!VIe},{slice:function(r,a){var s,l,d,f=LIe(this),m=DIe(f),y=iK(r,m),_=iK(a===void 0?m:a,m);if(rK(f)&&(s=f.constructor,(kIe(s)&&(s===oD||rK(s.prototype))||jIe(s)&&(s=s[BIe])===null)&&(s=void 0),s===oD||s===void 0))return FIe(f,y,_);for(l=new(s===void 0?oD:s)($Ie(_-y,0)),d=0;y<_;y++,d++)y in f&&MIe(l,d,f[y]);return l.length=d,l}});var WIe=nc("Array","slice"),GIe=T,HIe=WIe,cD=Array.prototype,zIe=function(r){var a=r.slice;return r===cD||GIe(cD,r)&&a===cD.slice?HIe:a},KIe=o(zIe);function rt(r,a,s,l,d){var f,m,y,_={};return RIe(f=AIe(l)).call(f,function(S){_[S]=l[S]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=IIe(m=OIe(y=KIe(s).call(s)).call(y)).call(m,function(S,x){return x(r,a,S)||S},_),d&&_.initializer!==void 0&&(_.value=_.initializer?_.initializer.call(d):void 0,_.initializer=void 0),_.initializer===void 0?(eG(r,a,_),null):_}let gT=function(r){return r[r.ACCESS_POINT=101]="ACCESS_POINT",r[r.UNILBS=201]="UNILBS",r[r.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",r}({}),lD=function(r){return r[r.IIIEGAL_APPID=1]="IIIEGAL_APPID",r[r.IIIEGAL_UID=2]="IIIEGAL_UID",r[r.INTERNAL_ERROR=3]="INTERNAL_ERROR",r}({}),pc=function(r){return r[r.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",r[r.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",r[r.INTERNAL_ERROR=8]="INTERNAL_ERROR",r[r.NO_AUTHORIZED=9]="NO_AUTHORIZED",r[r.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",r[r.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",r[r.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",r[r.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",r[r.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",r[r.USER_OVERLOAD=16]="USER_OVERLOAD",r[r.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",r[r.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",r}({}),Da=function(r){return r[r.NO_FLAG_SET=100]="NO_FLAG_SET",r[r.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",r[r.INVALID_FALG_SET=102]="INVALID_FALG_SET",r[r.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",r[r.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",r[r.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",r[r.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",r[r.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",r[r.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",r[r.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",r[r.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",r[r.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",r[r.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",r[r.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",r[r.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",r[r.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",r[r.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",r[r.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",r[r.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",r}({}),vt=function(r){return r[r.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",r[r.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",r[r.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",r[r.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",r[r.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",r[r.K_TICKET_INVALID=7]="K_TICKET_INVALID",r[r.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",r[r.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",r[r.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",r[r.K_UID_BANNED=14]="K_UID_BANNED",r[r.K_IP_BANNED=15]="K_IP_BANNED",r[r.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",r[r.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",r[r.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",r[r.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",r[r.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",r[r.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",r[r.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",r[r.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",r[r.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",r[r.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",r[r.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",r[r.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",r[r.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",r[r.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",r[r.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",r[r.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",r[r.ERR_INVALID_UID=117]="ERR_INVALID_UID",r[r.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",r[r.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",r[r.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",r[r.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",r[r.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",r[r.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",r[r.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",r[r.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",r[r.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",r[r.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",r[r.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",r[r.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",r[r.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",r[r.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",r[r.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",r[r.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",r[r.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",r[r.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",r[r.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",r[r.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",r[r.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",r[r.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",r[r.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",r[r.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",r[r.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",r[r.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",r[r.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",r[r.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",r[r.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",r[r.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",r[r.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",r[r.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",r[r.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",r[r.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",r[r.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",r[r.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",r[r.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",r}({}),Wn=function(r){return r.CONNECTING="connecting",r.CONNECTED="connected",r.RECONNECTING="reconnecting",r.CLOSED="closed",r}({}),It=function(r){return r.WS_CONNECTED="ws_connected",r.WS_RECONNECTING="ws_reconnecting",r.WS_CLOSED="ws_closed",r.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",r.ON_BINARY_DATA="on_binary_data",r.REQUEST_RECOVER="request_recover",r.REQUEST_JOIN_INFO="request_join_info",r.REQUEST_REJOIN_INFO="req_rejoin_info",r.IS_P2P_DISCONNECTED="is_p2p_dis",r.DISCONNECT_P2P="dis_p2p",r.ABORT_P2P_EXECUTION="abort_p2p_execution",r.NEED_RENEW_SESSION="need-sid",r.REPORT_JOIN_GATEWAY="report_join_gateway",r.REQUEST_TIMEOUT="request_timeout",r.REQUEST_SUCCESS="request_success",r.JOIN_RESPONSE="join_response",r.PRE_CONNECT_PC="pre_connect_pc",r.P2P_CONNECTION="p2p_connection",r.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",r.P2P_SUBSCRIBE="p2p_subscribe",r.P2P_UNSUBSCRIBE="p2p_unsubscribe",r.P2P_EXCHANGE_SDP="p2p_exchange_sdp",r.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",r.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",r.RECOVER_NOTIFICATION="recover_notification",r}({}),Ct=function(r){return r.PING="ping",r.PING_BACK="ping_back",r.JOIN="join_v3",r.REJOIN="rejoin_v3",r.LEAVE="leave",r.SET_CLIENT_ROLE="set_client_role",r.PUBLISH="publish",r.PUBLISH_DATASTREAM="publish_datastream",r.UNPUBLISH="unpublish",r.UNPUBLISH_DATASTREAM="unpublish_datastream",r.SUBSCRIBE="subscribe",r.PRE_SUBSCRIBE="pre_subscribe",r.SUBSCRIBE_DATASTREAM="subscribe_datastream",r.SUBSCRIBE_STREAMS="subscribe_streams",r.UNSUBSCRIBE="unsubscribe",r.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",r.UNSUBSCRIBE_STREAMS="unsubscribe_streams",r.SUBSCRIBE_CHANGE="subscribe_change",r.TRAFFIC_STATS="traffic_stats",r.RENEW_TOKEN="renew_token",r.SWITCH_VIDEO_STREAM="switch_video_stream",r.DEFAULT_VIDEO_STREAM="default_video_stream",r.SET_FALLBACK_OPTION="set_fallback_option",r.GATEWAY_INFO="gateway_info",r.CONTROL="control",r.SEND_METADATA="send_metadata",r.DATA_STREAM="data_stream",r.PICK_SVC_LAYER="pick_svc_layer",r.RESTART_ICE="restart_ice",r.CONNECT_PC="connect_pc",r.SET_VIDEO_PROFILE="set_video_profile",r.SET_PARAMETER="set_parameter",r.SET_RTM2_FLAG="set_rtm2_flag",r.DOWNGRADE_CODEC="downgrade_codec",r}({}),yb=function(r){return r.WRTC_STATS="wrtc_stats",r.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",r.DENOISER_STATS="denoiser_stats",r.EXTENSION_USAGE_STATS="extension_usage_stats",r}({}),en=function(r){return r.ON_USER_ONLINE="on_user_online",r.ON_USER_OFFLINE="on_user_offline",r.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",r.ON_PUBLISH_STREAM="on_publish_stream",r.ON_UPLINK_STATS="on_uplink_stats",r.ON_P2P_LOST="on_p2p_lost",r.ON_REMOVE_STREAM="on_remove_stream",r.ON_ADD_AUDIO_STREAM="on_add_audio_stream",r.ON_ADD_VIDEO_STREAM="on_add_video_stream",r.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",r.ON_USER_BANNED="on_user_banned",r.ON_USER_LICENSE_BANNED="on_user_license_banned",r.ON_NOTIFICATION="on_notification",r.ON_CRYPT_ERROR="on_crypt_error",r.MUTE_AUDIO="mute_audio",r.MUTE_VIDEO="mute_video",r.UNMUTE_AUDIO="unmute_audio",r.UNMUTE_VIDEO="unmute_video",r.ON_P2P_OK="on_p2p_ok",r.RECEIVE_METADATA="receive_metadata",r.ON_DATA_STREAM="on_data_stream",r.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",r.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",r.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",r.ENABLE_LOCAL_VIDEO="enable_local_video",r.DISABLE_LOCAL_VIDEO="disable_local_video",r.ENABLE_LOCAL_AUDIO="enable_local_audio",r.DISABLE_LOCAL_AUDIO="disable_local_audio",r.ON_PUBLISHED_USER_LIST="on_published_user_list",r}({}),La=function(r){return r.SEND_ONLY="SEND_ONLY",r.RECEIVE_ONLY="RECEIVE_ONLY",r}({}),Bt=function(r){return r.CONNECTED="websocket:connected",r.RECONNECTING="websocket:reconnecting",r.WILL_RECONNECT="websocket:will_reconnect",r.CLOSED="websocket:closed",r.FAILED="websocket:failed",r.ON_MESSAGE="websocket:on_message",r.REQUEST_NEW_URLS="websocket:request_new_urls",r.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",r}({});function vT(r){if(typeof r!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(r))throw V.error("Invalid Channel Name ".concat(r)),new Ee(ie.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function yT(r){if(a=r,!(typeof a=="number"&&Math.floor(a)===a&&0<=a&&a<=4294967295||sz(r,1,255)))throw new Ee(ie.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var a;typeof r=="string"&&V.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let ad=function(r){return r.TRANSCODE="mix_streaming",r.RAW="raw_streaming",r}({});const qIe={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},uD={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function dD(r,a){xi(r.url,"".concat(a,".url"),1,1e3,!1),hr(r.x)||kn(r.x,"".concat(a,".x"),0,1e4),hr(r.y)||kn(r.y,"".concat(a,".y"),0,1e4),hr(r.width)||kn(r.width,"".concat(a,".width"),0,1e4),hr(r.height)||kn(r.height,"".concat(a,".height"),0,1e4),hr(r.zOrder)||kn(r.zOrder,"".concat(a,".zOrder"),0,255),hr(r.alpha)||kn(r.alpha,"".concat(a,".alpha"),0,1,!1)}const YIe={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let ph=function(r){return r.WARNING="@live_uap-warning",r.ERROR="@line_uap-error",r.PUBLISH_STREAM_STATUS="@live_uap-publish-status",r.WORKER_STATUS="@live_uap-worker-status",r.REQUEST_NEW_ADDRESS="@live_uap-request-address",r}({}),hD=function(r){return r.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",r}({}),Xr=function(r){return r[r.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",r[r.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",r[r.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",r[r.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",r[r.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",r[r.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",r[r.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",r[r.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",r[r.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",r[r.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",r[r.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",r[r.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",r[r.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",r[r.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",r[r.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",r[r.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",r[r.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",r[r.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",r}({});function aK(r){if(!r.channelName)throw new Ee(ie.INVALID_PARAMS,"invalid channelName in info");if(typeof r.uid!="number")throw new Ee(ie.INVALID_PARAMS,"invalid uid in info, uid must be a number");return r.token&&xi(r.token,"info.token",1,2047),yT(r.uid),vT(r.channelName),!0}let Ma=function(r){return r[r.SetSdkProfile=0]="SetSdkProfile",r[r.SetSourceChannel=1]="SetSourceChannel",r[r.SetSourceUserId=2]="SetSourceUserId",r[r.SetDestChannel=3]="SetDestChannel",r[r.StartPacketTransfer=4]="StartPacketTransfer",r[r.StopPacketTransfer=5]="StopPacketTransfer",r[r.UpdateDestChannel=6]="UpdateDestChannel",r[r.Reconnect=7]="Reconnect",r[r.SetVideoProfile=8]="SetVideoProfile",r}({}),sd=function(r){return r.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",r.NETWORK_CONNECTED="NETWORK_CONNECTED",r.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",r.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",r.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",r.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",r.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",r.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",r.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",r.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",r}({}),cs=function(r){return r.RELAY_STATE_IDLE="RELAY_STATE_IDLE",r.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",r.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",r.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",r}({}),jg=function(r){return r.RELAY_OK="RELAY_OK",r.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",r.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",r.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",r}({}),xn=function(r){return r.High="high",r.Low="low",r.Audio="audio",r.Screen="screen",r.ScreenLow="screen_low",r}({}),gi=function(r){return r.DISCONNECT="disconnect",r.CONNECTION_STATE_CHANGE="connection-state-change",r.NETWORK_QUALITY="network-quality",r.STREAM_TYPE_CHANGE="stream-type-change",r.IS_P2P_DISCONNECTED="is-p2p-dis",r.DISCONNECT_P2P="dis-p2p",r.REQUEST_NEW_GATEWAY_LIST="req-gate-url",r.NEED_RENEW_SESSION="need-sid",r.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",r.JOIN_RESPONSE="join-response",r.RESET_CONNECTION_EVENTS="reset-connection-events",r.PRE_CONNECT_PC="pre-connect_pc",r.UPDATE_GATEWAY_CONFIG="update-gateway-config",r}({}),_T=function(r){return r.P2P_DISCONNECTED="P2P_DISCONNECTED",r.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",r.TIMEOUT="TIMEOUT",r.UNKNOWN_REASON="UNKNOWN_REASON",r}({}),ci=function(r){return r[r.Nothing=0]="Nothing",r[r.Audio=1]="Audio",r[r.LwoVideo=2]="LwoVideo",r[r.Video=4]="Video",r[r.Data=8]="Data",r[r.DataStream0=256]="DataStream0",r[r.DataStream1=512]="DataStream1",r[r.DataStream2=1024]="DataStream2",r[r.DataStream3=2048]="DataStream3",r[r.DataStream4=4096]="DataStream4",r[r.DataStream5=8192]="DataStream5",r[r.DataStream6=16384]="DataStream6",r[r.DataStream7=32768]="DataStream7",r}({}),_n=function(r){return r.CHINA="CHINA",r.ASIA="ASIA",r.NORTH_AMERICA="NORTH_AMERICA",r.EUROPE="EUROPE",r.JAPAN="JAPAN",r.INDIA="INDIA",r.KOREA="KOREA",r.HKMC="HKMC",r.US="US",r.OCEANIA="OCEANIA",r.SOUTH_AMERICA="SOUTH_AMERICA",r.AFRICA="AFRICA",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL",r.EXTENSIONS="EXTENSIONS",r}({});const sK=[_n.AFRICA,_n.ASIA,_n.CHINA,_n.EUROPE,_n.GLOBAL,_n.INDIA,_n.JAPAN,_n.NORTH_AMERICA,_n.OCEANIA,_n.OVERSEA,_n.SOUTH_AMERICA];let Ki=function(r){return r.CHINA="CN",r.ASIA="AS",r.NORTH_AMERICA="NA",r.EUROPE="EU",r.JAPAN="JP",r.INDIA="IN",r.KOREA="KR",r.HKMC="HK",r.US="US",r.OCEANIA="OC",r.SOUTH_AMERICA="SA",r.AFRICA="AF",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL",r.EXTENSIONS="GLOBAL",r}({});const bT={CHINA:{},ASIA:{CODE:Ki.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Ki.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Ki.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Ki.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Ki.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Ki.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Ki.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Ki.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Ki.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Ki.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Ki.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Ki.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Ki.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};Aj&&(bT.CHINA={CODE:Ki.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let _b=function(r){return r.UPDATE_BITRATE_LIMIT="update_bitrate_limit",r.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",r}({});function oK(r){return!!r&&!(!r.uplink||!r.id)&&r.uplink.max_bitrate!==void 0&&r.uplink.min_bitrate!==void 0}class cK extends cr{constructor(a,s){super(),Q(this,"onICEConnectionStateChange",void 0),Q(this,"onConnectionStateChange",void 0),Q(this,"onDTLSTransportStateChange",void 0),Q(this,"onDTLSTransportError",void 0),Q(this,"onICETransportStateChange",void 0),Q(this,"onFirstAudioReceived",void 0),Q(this,"onFirstVideoReceived",void 0),Q(this,"onFirstAudioDecoded",void 0),Q(this,"onFirstVideoDecoded",void 0),Q(this,"onFirstVideoRender",void 0),Q(this,"onFirstVideoDecodedTimeout",void 0),Q(this,"onSelectedLocalCandidateChanged",void 0),Q(this,"onSelectedRemoteCandidateChanged",void 0),Q(this,"onICECandidateError",void 0),Q(this,"getLocalVideoStats",void 0)}}class lK extends cK{constructor(a,s){super(a,s),Q(this,"establishPromise",void 0)}}let Je=function(r){return r.VIDEO="video",r.AUDIO="audio",r}({}),qi=function(r){return r.UDP_RELAY="udp_relay",r.UDP_TCP_RELAY="udp_tcp_relay",r.TCP_RELAY="tcp_relay",r.RELAY="relay",r}({}),od=function(r){return r[r.FIRST_CONNECTION=0]="FIRST_CONNECTION",r[r.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",r[r.RELAY_RESTART=2]="RELAY_RESTART",r[r.TCP_RESTART=3]="TCP_RESTART",r[r.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",r[r.OLD_RESTART=11]="OLD_RESTART",r[r.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",r}({});const uK=["disconnected","failed"];let De=function(r){return r.LocalVideoTrack="videoTrack",r.LocalAudioTrack="audioTrack",r.LocalVideoLowTrack="videoLowTrack",r}({}),wn=function(r){return r.New="new",r.Connected="connected",r.Reconnecting="reconnecting",r.Disconnected="disconnected",r}({}),dt=function(r){return r.AudioMetadata="audioMetadata",r.AudioPts="audioPts",r.StateChange="stateChange",r.IceConnectionStateChange="iceConnectionStateChange",r.RequestMuteLocal="requestMuteLocal",r.RequestUnmuteLocal="requestUnmuteLocal",r.RequestRePublish="requestRePublish",r.RequestRePublishDataChannel="requestRePublishDataChannel",r.RequestReSubscribe="requestReSubscribe",r.RequestUploadStats="requestUploadStats",r.RequestUpload="requestUpload",r.MediaReconnectStart="MediaReconnectStart",r.MediaReconnectEnd="MediaReconnectEnd",r.NeedSignalRTT="NeedSignalRTT",r.RequestRestartICE="RequestRestartIce",r.PeerConnectionStateChange="PeerConnectionStateChange",r.RequestReconnect="RequestReconnect",r.RequestReconnectPC="RequestReconnectPC",r.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",r.P2PLost="P2PLost",r.UpdateVideoEncoder="UpdateVideoEncoder",r.ConnectionTypeChange="ConnectionTypeChange",r.RequestLowStreamParameter="RequestLowStreamParameter",r.QueryClientConnectionState="QueryClientConnectionState",r.LocalCandidate="LocalCandidate",r.RequestP2PMuteLocal="requestP2PMuteLocal",r.RequestP2PUnPublish="RequestP2PUnPublish",r.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",r.RequestP2PMuteRemote="RequestP2PMuteRemote",r.RequestP2PRestartICE="RequestP2PRestartICE",r}({}),mc=function(r){return r.CONNECTING="CONNECTING",r.RECONNECTING="RECONNECTING",r.CONNECTED="CONNECTED",r.CLOSED="CLOSED",r}({}),gc=function(r){return r[r.CONNECT_AP=0]="CONNECT_AP",r[r.AP_CONNECTED=1]="AP_CONNECTED",r[r.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",r[r.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",r[r.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",r[r.CONNECT_WORKER=5]="CONNECT_WORKER",r[r.WORKER_CONNECTED=6]="WORKER_CONNECTED",r[r.CLOSED=7]="CLOSED",r}({}),vi=function(r){return r.CONNECTION_STATE_CHANGE="connection-state-change",r.STATE_CHANGE="state-change",r.INSPECT_RESULT="inspect-result",r.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",r.REQUEST_NEW_WORKER_URL="request-new-worker-url",r}({}),dK=function(r){return r.CONNECTED="transmitter:connected",r.RECONNECTING="transmitter:reconnecting",r.WILL_RECONNECT="transmitter:will_reconnect",r.CLOSED="transmitter:closed",r.FAILED="transmitter:failed",r.ON_MESSAGE="transmitter:on_message",r.REQUEST_NEW_URLS="transmitter:request_new_urls",r.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",r.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",r.FAILBACK="transmitter:failback",r.PRE_CONNECT_PC="transmitter:pre_connect_pc",r}({}),au=function(r){return r.CAMERA_CHANGED="camera-changed",r.MICROPHONE_CHANGED="microphone-changed",r.PLAYBACK_DEVICE_CHANGED="playback-device-changed",r.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",r.AUTOPLAY_FAILED="autoplay-failed",r.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",r.SECURITY_POLICY_VIOLATION="security-policy-violation",r}({}),No=function(r){return r.CONNECTING="CONNECTING",r.RECONNECTING="RECONNECTING",r.CONNECTED="CONNECTED",r.CLOSED="CLOSED",r}({}),al=function(r){return r.CONNECTION_STATE_CHANGE="connection-state-change",r.STATE_CHANGE="state-change",r.INSPECT_RESULT="inspect-result",r.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",r.REQUEST_NEW_WORKER_URL="request-new-worker-url",r}({}),Dg=function(r){return r[r.CONNECT_AP=0]="CONNECT_AP",r[r.AP_CONNECTED=1]="AP_CONNECTED",r[r.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",r[r.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",r[r.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",r[r.CONNECT_WORKER=5]="CONNECT_WORKER",r[r.WORKER_CONNECTED=6]="WORKER_CONNECTED",r[r.CLOSED=7]="CLOSED",r}({}),Ar=function(r){return r.CALL="call",r.CANDIDATE="candidate",r.PUBLISH="publish",r.UNPUBLISH="unpublish",r.CONTROL="control",r.RESTART_ICE="restart_ice",r.ACK="ack",r.RESPONSE="response",r.JOIN="join",r.CHECK="check",r}({}),Lg=function(r){return r.ABORT="abort",r}({}),mh=function(r){return r.MUTE_LOCAL_AUDIO="mute_local_audio",r.MUTE_LOCAL_VIDEO="mute_local_video",r.UNMUTE_LOCAL_AUDIO="unmute_local_audio",r.UNMUTE_LOCAL_VIDEO="unmute_local_video",r}({}),XIe=function(r){return r.P2P_TOKEN_TIMEOUT="p2p_token_timeout",r.P2P_TOKEN_CHANGED="p2p_token_changed",r}({});const JIe={[gT.ACCESS_POINT]:{[Da.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Da.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Da.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Da.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Da.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Da.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Da.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[gT.UNILBS]:{[pc.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[pc.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[pc.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[pc.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[pc.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[pc.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[pc.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[pc.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[pc.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[pc.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[pc.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[pc.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[gT.STRING_UID_ALLOCATOR]:{[lD.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[lD.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[lD.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Mg(r){const a=JIe[Math.floor(r/1e4)];if(!a)return{desc:"unknown error",retry:!1};const s=a[r%1e4];if(!s){if(Math.floor(r/1e4)===gT.ACCESS_POINT){const l=r%1e4;if(l.toString()[0]==="1")return{desc:r.toString(),retry:!1};if(l.toString()[0]==="2")return{desc:r.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return s}const ZIe={[vt.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[vt.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[vt.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[vt.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[vt.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[vt.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[vt.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[vt.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[vt.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[vt.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[vt.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[vt.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[vt.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[vt.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[vt.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[vt.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[vt.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[vt.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[vt.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[vt.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[vt.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[vt.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[vt.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[vt.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[vt.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[vt.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[vt.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[vt.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[vt.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[vt.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[vt.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[vt.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[vt.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[vt.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[vt.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[vt.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[vt.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[vt.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[vt.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[vt.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[vt.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[vt.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[vt.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[vt.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[vt.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[vt.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[vt.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[vt.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[vt.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[vt.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[vt.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[vt.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[vt.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[vt.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[vt.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[vt.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[vt.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[vt.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[vt.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[vt.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[vt.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[vt.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[vt.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[vt.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function bb(r){return ZIe[r]||{desc:"UNKNOWN_ERROR_".concat(r),action:"failed"}}function hK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function fD(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?hK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):hK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function pD(r,a){if(typeof r=="string")return r;const{proxy:s,host:l,port:d}=r;if(a){const f=oe("JOIN_GATEWAY_FALLBACK_PORT")||443;return f===443?"wss://".concat(l,"/ws/?p=").concat(Number(d)+150):"wss://".concat(l,":").concat(f,"/ws/?p=").concat(Number(d)+150)}return s?"wss://".concat(s,"/ws/?h=").concat(l,"&p=").concat(d):"wss://".concat(l,":").concat(d)}const QIe=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,eOe=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,tOe=/wss:\/\/(.+):([0-9]+)\/?/,nOe=/wss:\/\/(.[^\/]+)\/?/;let rOe=0;class iOe{constructor(a,s){Q(this,"id",0),Q(this,"store",void 0),Q(this,"recordIndex",void 0),Q(this,"websockets",[]),Q(this,"try443PortDuration",2e3),Q(this,"forceCloseWSDuration",5e3),Q(this,"try443PortTimeout",null),Q(this,"forceCloseTimeout",null),Q(this,"isTry443PortFailed",!1),Q(this,"isNormalPortFailed",!1),Q(this,"useDoubleDomain",!1),Q(this,"useProxy",!1),Q(this,"startTime",Date.now()),this.id=++rOe,this.try443PortDuration=oe("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=a||5e3,this.store=s}closeAllWebsockets(){this.websockets.forEach(a=>{a.onopen=null,a.onclose=null,a.onmessage=null,a.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var a;const s=Date.now()-this.startTime;for(var l=arguments.length,d=new Array(l),f=0;f<l;f++)d[f]=arguments[f];V.debug("[choose-best-ws ".concat((a=this.store)===null||a===void 0?void 0:a.clientId," ").concat(this.id,"] ").concat(s,"ms:"),...d)}createWebSocket(a,s,l){this.logger("createWebSocket:",a,{isTry443Port:s,hasTimeoutDetection:l});const d=oe("GATEWAY_DOMAINS"),f=Date.now(),m=[],y=d.find(I=>{var L;return Be(L=a.host).call(L,I)});y||(this.useDoubleDomain=!1);const _=[];if(this.useDoubleDomain)d.forEach(I=>{_.push(pD(fD(fD({},a),{},{host:a.host.replace(y,I)}),s))});else{const I=fD({},a);if(s&&y){const L=d.find(K=>K!==y);L&&(I.host=I.host.replace(y,L))}_.push(pD(I,s))}try{_.forEach(I=>{const L=new WebSocket(I);L.binaryType="arraybuffer",m.push(L),this.logger("ws is connecting:",L.url)})}catch(I){if(this.logger("ws create failed"),m.forEach(L=>L.close()),m.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(a,s,l);if(!s&&Number(a.port)!==443)return this.createWebSocket(a,!0,l);throw new Ee(ie.WS_ERR,"init websocket failed! Error: ".concat(I.toString()))}const S=ib();this.store&&this.store.recordJoinChannelService({urls:m.map(I=>I.url),service:"gateway"},this.recordIndex),m.forEach(I=>{I.onopen=()=>{this.logger("onopen: ws ".concat(I.url," open cost ").concat(Date.now()-f,"ms")),this.websockets.forEach(L=>{L!==I&&(L.onopen=null,L.onclose=null,L.onmessage=null,L.close(),this.logger("close backup websocket: ".concat(L.url)))}),this.websockets.length=0,S.resolve(I)},I.onclose=L=>{this.logger("onclose: ws ".concat(I.url," closed cost ").concat(Date.now()-f,"ms state: ").concat(I.readyState));const K=m.every($=>$.readyState===WebSocket.CLOSED||$.readyState===WebSocket.CLOSING);this.logger("".concat(s?"443":"47xx"," websocket closed, all failed: ").concat(K)),K&&(s||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(L.reason)),S.reject({code:L.code,reason:_T.A_ROUND_WS_FAILED})):!s&&K&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),A()),s?this.isTry443PortFailed=K:this.isNormalPortFailed=K},I.onmessage=L=>this.logger("".concat(I.url," onmessage: ").concat(L.data))}),this.websockets.push(...m);const x=()=>{this.websockets.forEach(I=>I.readyState!==WebSocket.OPEN&&I.close())},A=()=>{if(S.isResolved)return x();an().os===oi.MAC_OS&&dr()&&x(),this.createWebSocket(a,!0,!0).then(I=>{S.resolve(I)}).catch(I=>{this.isNormalPortFailed&&S.reject(I),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",S.isResolved),this.forceCloseTimeout=null,x()},this.forceCloseWSDuration)};return l||(()=>{if(s||this.useProxy)return this.logger("add 5s timeout at ".concat(s?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,x()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",S.isResolved),this.try443PortTimeout=null,A()},this.try443PortDuration)})(),S.promise}chooseBestWebsocket(a,s,l,d){return this.useDoubleDomain=!!s,typeof a=="string"&&(a=function(f){let m,y,_;return[,m,y,_]=f.match(QIe)||[],m||([,y,_]=f.match(eOe)||[]),y&&_||([,y,_]=f.match(tOe)||[]),y&&_||([,y]=f.match(nOe)||[]),y||V.warning("un-destructible url: ",f),{proxy:m,host:y,port:_||"443"}}(a)),this.recordIndex=d,this.useProxy=!!a.proxy,l&&this.useProxy&&(V.warn("cannot use 443 only when use proxy"),l=!1),this.createWebSocket(a,!!l,!1).finally(()=>this.clearTimeout())}}function fK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}class pK extends cr{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(a){var s;Be(s=["tryNext","recover"]).call(s,a)&&this.resetReconnectCount(a),this._reconnectMode=a}get state(){return this._state}set state(a){a!==this._state&&(this._state=a,this._state==="reconnecting"?this.emit(Bt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(Bt.CONNECTED):this._state==="closed"?this.emit(Bt.CLOSED):this._state==="failed"&&this.emit(Bt.FAILED))}resetReconnectCount(a){V.debug("websocket reset reconnect count, reason: "+a),this.reconnectCount=0}constructor(a,s){let l=arguments.length>2&&arguments[2]!==void 0&&arguments[2],d=arguments.length>3&&arguments[3]!==void 0&&arguments[3],f=arguments.length>4&&arguments[4]!==void 0&&arguments[4],m=arguments.length>5?arguments[5]:void 0;super(),Q(this,"_websocketUrl",null),Q(this,"connectionID",0),Q(this,"currentURLIndex",0),Q(this,"urls",[]),Q(this,"_reconnectMode","tryNext"),Q(this,"reconnectReason",void 0),Q(this,"_initMutex",void 0),Q(this,"name",void 0),Q(this,"_state","closed"),Q(this,"reconnectInterrupter",void 0),Q(this,"websocket",void 0),Q(this,"retryConfig",void 0),Q(this,"reconnectCount",0),Q(this,"forceCloseTimeout",5e3),Q(this,"onlineReconnectListener",void 0),Q(this,"useCompress",void 0),Q(this,"tryDoubleDomain",!1),Q(this,"use443PortOnly",!1),Q(this,"wsInflateLength",0),Q(this,"wsDeflateLength",0),Q(this,"closeEstablishingWs",()=>{}),Q(this,"store",void 0),Q(this,"joinGatewayRecordIndex",void 0),this.store=m,this.name=a,this.retryConfig=function(A){for(var I=1;I<arguments.length;I++){var L=arguments[I]!=null?arguments[I]:{};I%2?fK(Object(L),!0).forEach(function(K){Q(A,K,L[K])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(L)):fK(Object(L)).forEach(function(K){Object.defineProperty(A,K,Object.getOwnPropertyDescriptor(L,K))})}return A}({},s),this.useCompress=l,this.tryDoubleDomain=d,this.use443PortOnly=f,this._initMutex=new Hi("websocket",m?m.clientId:void 0);const{timeout:y,timeoutFactor:_}=s,S=Math.max(300,Math.floor(3*y/5)),x=Math.max(1.2,Math.floor(8*_)/10);As.ONLINE&&(this.retryConfig.timeout=S,this.retryConfig.timeoutFactor=x),Dr.on(gg.NETWORK_STATE_CHANGE,(A,I)=>{A!==I&&(this.resetReconnectCount("network state change: ".concat(I," -> ").concat(A)),A===As.ONLINE?(this.retryConfig.timeout=S,this.retryConfig.timeoutFactor=x):(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=_))})}getConnection(){return this.websocket||void 0}async init(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const l=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=s,this.urls=a,this.state="connecting";try{var d;const f=ib(),m=this.urls[this.currentURLIndex];(d=this.store)===null||d===void 0||d.beforeConnect(),function(y){return!(eT()||oe("USE_NEW_TOKEN")||!oe("ENABLE_PREALLOC_PC")&&(y==null||!y.autoSubscribe||oe("FORCE_DISABLE_AUTO_SUB")))}(this.store)&&this.emit(dK.PRE_CONNECT_PC),this.createWebSocketConnection(m).then(f.resolve).catch(f.reject),this.once(Bt.CLOSED,()=>{f.reject(new we(ie.WS_DISCONNECT))}),this.once(Bt.CONNECTED,f.resolve),await f.promise}catch{}finally{l()}}close(a,s){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const l=this.websocket;s?setTimeout(()=>l.close(),500):l.close(),this.websocket=void 0,this._websocketUrl=null}this.state=a?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(a,s){if(!this.websocket)return void V.warning("[".concat(this.name,"] can not reconnect, no websocket"));a!==void 0&&(this.reconnectMode=a),V.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(s)]},this.joinGatewayRecordIndex);const l=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),l&&l.bind(this.websocket)({code:9999,reason:s})}sendMessage(a){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new we(ie.WS_ABORT,"websocket is not ready");try{s||(a=JSON.stringify(a)),this.websocket.send(a)}catch(l){throw new we(ie.WS_ERR,"send websocket message error"+l.toString())}}setWsInflateData(a){this.wsDeflateLength=this.wsDeflateLength+a.originLength,this.wsInflateLength=this.wsInflateLength+a.compressedLength}getWsInflateData(){const a=this.wsInflateLength,s=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:a,wsDeflateLength:s}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(a){var s;const l=ib();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const d=x=>{var A;(A=this.store)===null||A===void 0||A.signalChannelOpen(),V.debug("[".concat(this.name,"] websocket opened:"),x),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),l.resolve()},f=async x=>{var A;if(V.debug("[".concat(this.name,"] websocket close ").concat((A=this.websocket)===null||A===void 0?void 0:A.url,", code: ").concat(x.code,", reason: ").concat(x.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)l.reject(new we(ie.WS_DISCONNECT,"websocket close: ".concat(x.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=x.reason,this.state="reconnecting");const I=qs(this,Bt.WILL_RECONNECT,this.reconnectMode,x.reason)||this.reconnectMode,L=await this.reconnectWithAction(I);if(this.state==="closed")return void V.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!L)return l.reject(new we(ie.WS_DISCONNECT,"websocket reconnect failed: ".concat(x.code))),this.close(!0);l.resolve()}},m=x=>{this.emit(Bt.ON_MESSAGE,x)},y=x=>{V.warn("[".concat(this.connectionID,"] ws open error ").concat(x))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),oe("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(a=oe("GATEWAY_WSS_ADDRESS")),V.debug("[".concat(this.name,"] start connect, url:"),a);const _=(s=this.store)===null||s===void 0?void 0:s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var S;this._websocketUrl=pD(a);const x=await this.chooseBestWebsocketConnection(a);this.websocket=x,d&&d(this.websocket.url),this.websocket.onclose=f,this.websocket.onmessage=m,this.websocket.onerror=y,(S=this.store)===null||S===void 0||S.recordJoinChannelService({endTs:Date.now(),status:"success"},_),this.joinGatewayRecordIndex=_}catch(x){const A=this.state==="closed",I=x instanceof we,L=I&&x.code===ie.WS_ABORT,K=I&&x.code===ie.WS_ERR,$=I?x.message:x&&(x.reason||x.toString());V.warning("[choose-best-ws] chooseBestWebsocket error: ".concat($)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:L?"aborted":"error",errors:[x]},_),A||K?(l.reject(A?new we(ie.WS_DISCONNECT,"websocket is closed: ".concat($)):new we(ie.WS_ERR,"init websocket failed: ".concat($))),K&&V.error("[".concat(this.name,"] init websocket failed: ").concat($))):f&&f(x)}return l.promise}async reconnectWithAction(a){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;V.warning("[choose-best-ws] action: =>",a),this.onlineReconnectListener||Dr.isOnline||!Dr.onlineWaiter||(this.onlineReconnectListener=Dr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let l=!0;if(this.reconnectInterrupter=()=>l=!1,s){const m=Ej(this.reconnectCount,this.retryConfig);V.debug("[".concat(this.name,"] wait ").concat(m,"ms to reconnect websocket, mode: ").concat(a)),await He.race([Ti(m),this.onlineReconnectListener||new He(()=>{})])}if(this._state==="closed"||!l)return!1;this.reconnectCount+=1;const d=async(m,y)=>{this.emit(Bt.RECONNECT_CREATE_CONNECTION,y),await this.createWebSocketConnection(m)};try{if(a==="retry")await d(this.urls[this.currentURLIndex],a);else if(a==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);V.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await d(this.urls[this.currentURLIndex],a)}else a==="recover"&&(V.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await Li(this,Bt.REQUEST_NEW_URLS),this.currentURLIndex=0,await d(this.urls[this.currentURLIndex],a))}catch(m){var f;V.error("[".concat(this.name,"] reconnect failed ").concat(m&&m.toString()));const y=m==null||(f=m.data)===null||f===void 0?void 0:f.desc;return Array.isArray(y)&&Be(y).call(y,"dynamic key expired")?(this.emit(Bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(a,s)}return!0}}class mD extends pK{constructor(a,s){super(a,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(a,s){const l=ib(),d=function(m,y){return new iOe(m,y)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{V.debug("[choose-best-ws] close establishing websockets"),d.closeAllWebsockets(),l.reject(new we(ie.WS_ABORT,"choose best websocket aborted"))};const f=oe("GATEWAY_DOMAINS");return V.debug("[choose-best-ws] currentDomain: ",a,", domains: ",f,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),d.chooseBestWebsocket(a,this.tryDoubleDomain,this.use443PortOnly,s).then(l.resolve).catch(l.reject),l.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class Eb extends pK{constructor(a,s){super(a,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(a,s){return new He((l,d)=>{let f=!1;const m=[];this.closeEstablishingWs=()=>{V.debug("[choose-best-ws] close establishing websockets"),m.forEach(K=>{K.onclose=null,K.onopen=null,K.onmessage=null,K.close()}),d(new we(ie.WS_ABORT,"choose best websocket aborted"))};const y=oe("GATEWAY_DOMAINS");let _;const S=a.indexOf("?h="),x=y.find(K=>S!==-1?Be(a).call(a,K,S):Be(a).call(a,K));V.debug("[choose-best-ws] currentDomain: ",x,", domains: ",y);let A=!this.tryDoubleDomain||!x;if(!A&&x){var I;const K=Date.now();try{y.forEach($=>{const G=S===-1?a.replace(x,$):a.substr(0,S)+a.substr(S).replace(x,$),ne=new WebSocket(G);ne.binaryType="arraybuffer",m.push(ne),V.debug("[choose-best-ws] ws is connecting:",ne.url)})}catch{for(V.debug("[choose-best-ws] ws create failed, fallback to single url"),m.forEach(G=>G.close());m.length;)m.pop();A=!0}(I=this.store)===null||I===void 0||I.recordJoinChannelService({urls:m.map($=>$.url),service:"gateway"},s),m.forEach($=>{$.onopen=()=>{if(f)return;const G=Date.now()-K;V.debug("[choose-best-ws] ws open cost ".concat(G,"ms")),m.filter(ne=>ne!==$).forEach(ne=>{V.debug("[choose-best-ws]close backup websocket: ".concat(ne.url)),ne.close()}),f=!0,l($)},$.onclose=G=>{_=G,!f&&(m.find(ne=>!(ne.readyState===WebSocket.CLOSED||ne.readyState===WebSocket.CLOSING))||(V.debug("[choose-best-ws] all websocket is closed"),f=!0,d(_)))},$.onmessage=G=>{V.debug("[choose-best-ws]".concat($.url," onmessage: ").concat(G.data))}}),Ti(this.forceCloseTimeout).then(()=>{m.forEach($=>{$.readyState!==WebSocket.OPEN&&$.close()})})}if(A){var L;let K;V.debug("[choose-best-ws] use single url: ",a),(L=this.store)===null||L===void 0||L.recordJoinChannelService({urls:[a],service:"gateway"},s);try{K=new WebSocket(a),m.push(K),K.binaryType="arraybuffer"}catch($){const G=new we(ie.WS_ERR,"init websocket failed! Error: ".concat($.toString()));return V.error("[".concat(this.name,"]").concat(G)),void d(G)}K.onopen=()=>{l(K)},K.onclose=$=>{d($)},K.onmessage=$=>{V.debug("[choose-best-ws]".concat(K.url," onmessage: ").concat($.data))},Ti(this.forceCloseTimeout).then(()=>{K&&K.readyState!==WebSocket.OPEN&&K.close()})}}).then(l=>(this.closeEstablishingWs=void 0,l)).catch(l=>{throw this.closeEstablishingWs=void 0,l})}}class aOe extends cr{get connectionState(){return this._connectionState}set connectionState(a){a!==this._connectionState&&(this._connectionState=a,a===Wn.CONNECTED?this.emit(It.WS_CONNECTED):a===Wn.RECONNECTING?this.emit(It.WS_RECONNECTING,this._websocketReconnectReason):a===Wn.CLOSED&&this.emit(It.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(a,s){super(),Q(this,"_disconnectedReason",void 0),Q(this,"_websocketReconnectReason",void 0),Q(this,"_connectionState",Wn.CLOSED),Q(this,"reconnectToken",void 0),Q(this,"websocket",void 0),Q(this,"openConnectionTime",void 0),Q(this,"clientId",void 0),Q(this,"lastMsgTime",Date.now()),Q(this,"uploadCache",[]),Q(this,"uploadCacheInterval",void 0),Q(this,"rttRolling",new wz(5)),Q(this,"pingpongTimer",void 0),Q(this,"wsInflateDataTimer",void 0),Q(this,"pingpongTimeoutCount",0),Q(this,"ortc",void 0),Q(this,"joinResponse",void 0),Q(this,"multiIpOption",void 0),Q(this,"initError",void 0),Q(this,"spec",void 0),Q(this,"store",void 0),Q(this,"onWebsocketMessage",l=>{if(l.data instanceof ArrayBuffer)return void this.emit(It.ON_BINARY_DATA,l.data);const d=JSON.parse(l.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(d,"_id")){const f="res-@".concat(d._id);this.emit(f,d._result,d._message)}else if(Object.prototype.hasOwnProperty.call(d,"_type")){if(this.emit(d._type,d._message),d._type===en.ON_NOTIFICATION&&this.handleNotification(d._message),d._type===en.ON_USER_BANNED)switch(d._message.error_code){case 14:this.close(En.UID_BANNED);break;case 15:this.close(En.IP_BANNED);break;case 16:this.close(En.CHANNEL_BANNED)}if(d._type===en.ON_USER_LICENSE_BANNED)switch(d._message.error_code){case vt.ERR_LICENSE_MISSING:this.close(En.LICENSE_MISSING);break;case vt.ERR_LICENSE_EXPIRED:this.close(En.LICENSE_EXPIRED);break;case vt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(En.LICENSE_MINUTES_EXCEEDED);break;case vt.ERR_LICENSE_PERIOD_INVALID:this.close(En.LICENSE_PERIOD_INVALID);break;case vt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(En.LICENSE_MULTIPLE_SDK_SERVICE);break;case vt.ERR_LICENSE_ILLEGAL:this.close(En.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=a.clientId,this.spec=a,this.store=s,this.websocket=new mD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,oe("JOIN_GATEWAY_USE_DUAL_DOMAIN"),oe("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Wn.CONNECTED&&this.reconnect("retry",Di.OFFLINE)})}async request(a,s,l,d){const f=Mn(6,""),m={_id:f,_type:a,_message:s},y=this.websocket.connectionID,_=()=>new He((K,$)=>{if(this.connectionState===Wn.CONNECTED)return K();const G=()=>{this.off(It.WS_CLOSED,ne),K()},ne=()=>{this.off(It.WS_CONNECTED,G),$(new Ee(ie.WS_ABORT))};this.once(It.WS_CONNECTED,G),this.once(It.WS_CLOSED,ne),a!==Ct.PUBLISH&&a!==Ct.PUBLISH_DATASTREAM&&a!==Ct.SUBSCRIBE&&a!==Ct.SUBSCRIBE_DATASTREAM&&a!==Ct.UNSUBSCRIBE&&a!==Ct.UNSUBSCRIBE_DATASTREAM&&a!==Ct.UNPUBLISH&&a!==Ct.UNPUBLISH_DATASTREAM&&a!==Ct.CONTROL&&a!==Ct.RESTART_ICE||this.once(It.DISCONNECT_P2P,()=>{$(new Ee(ie.DISCONNECT_P2P))}),a!==Ct.PUBLISH&&a!==Ct.RESTART_ICE||this.once(It.ABORT_P2P_EXECUTION,()=>{$(new Ee(ie.DISCONNECT_P2P))})});if(this.connectionState!==Wn.CONNECTING&&this.connectionState!==Wn.RECONNECTING||a===Ct.JOIN||a===Ct.REJOIN||await _(),this.websocket.sendMessage(m,!0),d)return;const S=new He((K,$)=>{let G=!1;const ne=(ce,pe)=>{G=!0,K({isSuccess:ce==="success",message:pe||{}}),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.emit(It.REQUEST_SUCCESS,a,s)};this.once("res-@".concat(f),ne);const te=()=>{$(new Ee(ie.WS_ABORT,"type: ".concat(a))),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.off("res-@".concat(f),ne)};this.once(It.WS_CLOSED,te),this.once(It.WS_RECONNECTING,te),Ti(oe("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==y||G||(V.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(a)),this.emit(It.REQUEST_TIMEOUT,a,s))})});let x=null;try{x=await S}catch(K){if(this.connectionState===Wn.CLOSED||a===Ct.LEAVE)throw new Ee(ie.WS_ABORT);return!this.spec.forceWaitGatewayResponse||l?K.throw():a===Ct.JOIN||a===Ct.REJOIN?null:(await _(),await this.request(a,s))}if(x.isSuccess)return x.message;const A=Number(x.message.error_code||x.message.code),I=bb(A),L=new Ee(ie.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(x.message.error_str),{code:A,data:x.message,desc:I.desc});return I.action==="success"?x.message:(V.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(a,", error_code: ").concat(A,", message: ").concat(I.desc,", action: ").concat(I.action)),A===vt.ERR_TOO_MANY_BROADCASTERS?((a===Ct.JOIN||a===Ct.REJOIN)&&(this.initError=L,this.close()),L.throw()):I.action==="failed"?L.throw():I.action==="quit"?(this.initError=L,this.close(),L.throw()):(A===vt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,V.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Di.MULTI_IP)):this.reconnect(I.action,Di.SERVER_ERROR),a===Ct.JOIN||a===Ct.REJOIN?null:await this.request(a,s)))}waitMessage(a,s){return new He(l=>{const d=f=>{(!s||s(f))&&(this.off(a,d),l(f))};this.on(a,d)})}uploadWRTCStats(a){if(!this.store.sessionId)return void V.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const s={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:a};this.upload(yb.WRTC_STATS,s)}upload(a,s){const l={_type:a,_message:s};try{this.websocket.sendMessage(l)}catch{const f=oe("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(l),this.uploadCache.length>f&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Wn.CONNECTED)return;const m=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(m._type,m._message)},oe("UPLOAD_CACHE_INTERVAL")||2e3))}}send(a,s){const l={_type:a,_message:s};this.websocket.sendMessage(l)}init(a){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new He((s,l)=>{this.once(It.WS_CONNECTED,()=>s(this.joinResponse)),this.once(It.WS_CLOSED,d=>l(this.initError||new Ee(ie.WS_ABORT,d))),this.connectionState=Wn.CONNECTING,this.websocket.init(a).catch(l),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=a||En.LEAVE,this.connectionState=Wn.CLOSED,V.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(It.ABORT_P2P_EXECUTION),this.store.signalConnected();const a=await Li(this,It.REQUEST_JOIN_INFO);this.store.joinReq();const s=await this.request(Ct.JOIN,a);if(this.ortc=a==null?void 0:a.ortc,this.store.joinRep(),!s)return this.emit(It.REPORT_JOIN_GATEWAY,_T.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(It.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Wn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Ee(ie.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const a=lb(this,It.REQUEST_REJOIN_INFO);a.token=this.reconnectToken;const s=await this.request(Ct.REJOIN,a);return!!s&&(this.connectionState=Wn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),s.peers&&s.peers.forEach(l=>{this.emit(en.ON_USER_ONLINE,{uid:l.uid}),l.audio&&this.emit(en.ON_ADD_AUDIO_STREAM,{uid:l.uid,uint_id:l.uint_id,audio:!0,ssrcId:l.audio_ssrc}),l.video&&this.emit(en.ON_ADD_VIDEO_STREAM,{uid:l.uid,uint_id:l.uint_id,video:!0,ssrcId:l.video_ssrc}),l.audio_mute?this.emit(en.MUTE_AUDIO,{uid:l.uid}):this.emit(en.UNMUTE_AUDIO,{uid:l.uid}),l.video_mute?this.emit(en.MUTE_VIDEO,{uid:l.uid}):this.emit(en.UNMUTE_VIDEO,{uid:l.uid}),l.audio_enable_local?this.emit(en.ENABLE_LOCAL_AUDIO,{uid:l.uid}):this.emit(en.DISABLE_LOCAL_AUDIO,{uid:l.uid}),l.video_enable_local?this.emit(en.ENABLE_LOCAL_VIDEO,{uid:l.uid}):this.emit(en.DISABLE_LOCAL_VIDEO,{uid:l.uid}),l.audio||l.video||this.emit(en.ON_REMOVE_STREAM,{uid:l.uid,uint_id:l.uint_id})}),!0)}reconnect(a,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(a,s)}async downgradeCodec(a){if(!this.ortc)return!1;const s={downgrade_codec:a,ortc:this.ortc};return!!await this.request(Ct.DOWNGRADE_CODEC,s)}handleNotification(a){V.debug("[".concat(this.clientId,"] receive notification: "),a);const s=bb(a.code);if(a.code===28&&"detail"in a&&(V.info("[".concat(this.clientId,"] receive recover notification: "),a.detail),this.emit(It.RECOVER_NOTIFICATION,a.detail)),s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(En.UID_BANNED),void this.close()):void this.reconnect(s.action,Di.SERVER_ERROR);V.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const a=oe("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=a&&(V.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>oe("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Di.TIMEOUT):this.request(Ct.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const l=Date.now()-s;this.rttRolling.add(l),oe("REPORT_STATS")&&this.send(Ct.PING_BACK,{pingpongElapse:l})}).catch(l=>{})}handleWsInflateData(){const{wsInflateLength:a,wsDeflateLength:s}=this.websocket.getWsInflateData();a!==0&&s!==0&&this.upload(yb.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:a})}handleWebsocketEvents(){this.websocket.on(Bt.RECONNECT_CREATE_CONNECTION,a=>{this.emit(It.WS_RECONNECT_CREATE_CONNECTION,a)}),this.websocket.on(Bt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Bt.CLOSED,()=>{this.connectionState=Wn.CLOSED}),this.websocket.on(Bt.FAILED,()=>{this._disconnectedReason=En.NETWORK_ERROR,this.connectionState=Wn.CLOSED}),this.websocket.on(Bt.RECONNECTING,a=>{this._websocketReconnectReason=a,this.joinResponse=void 0,this.connectionState===Wn.CONNECTED?this.connectionState=Wn.RECONNECTING:this.connectionState=Wn.CONNECTING}),this.websocket.on(Bt.WILL_RECONNECT,(a,s,l)=>{const d=lb(this,It.IS_P2P_DISCONNECTED),f=d||a!=="retry";d&&a==="retry"&&(V.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),a="tryNext",s=_T.P2P_DISCONNECTED),f&&(V.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(a)),this.emit(It.REPORT_JOIN_GATEWAY,s||_T.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(It.DISCONNECT_P2P)),l(a)}),this.websocket.on(Bt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(a=>{V.warning("[".concat(this.clientId,"] rejoin failed ").concat(a)),this.reconnect("tryNext",Di.SERVER_ERROR)}):this.join().catch(a=>{if(this.emit(It.REPORT_JOIN_GATEWAY,a,this.url||""),a instanceof Ee){if(a.code===ie.UNEXPECTED_RESPONSE&&a.data.code===vt.ERR_NO_AUTHORIZED)return this.initError=new Ee(ie.TOKEN_EXPIRE,"dynamic key expired"),void this.close(En.TOKEN_EXPIRE);V.error("[".concat(this.clientId,"] join gateway request failed"),a.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Di.SERVER_ERROR):(this.initError=a,this.close())}})}),this.websocket.on(Bt.REQUEST_NEW_URLS,(a,s)=>{Li(this,It.REQUEST_RECOVER,this.multiIpOption).then(a).catch(s)}),this.websocket.on(Bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(en.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(dK.PRE_CONNECT_PC,()=>{this.emit(It.PRE_CONNECT_PC)})}}let sOe=function(r){return r.NATIVE_RTC="native_rtc",r.NATIVE_RTM="native_rtm",r.WEB_RTC="web_rtc",r.WEB_RTM="web_rtm",r}({}),Lr=function(r){return r[r.CHOOSE_SERVER=11]="CHOOSE_SERVER",r[r.CLOUD_PROXY=18]="CLOUD_PROXY",r[r.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",r[r.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",r}({});function mK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ET(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?mK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):mK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function gh(r){return r.match(/^[\.\:\d]+$/)?"".concat(r.replace(/[^\d]/g,"-"),".").concat(oe("TURN_DOMAIN")):(V.debug("Cannot recognized as ip address: ".concat(r,", use as host2")),r)}function wT(r){try{const a=oe("GATEWAY_DOMAINS").concat(oe("TURN_DOMAIN")).find(s=>Be(r).call(r,s));return a?r.split(".".concat(a))[0].replace(/-/g,"."):r}catch{return V.debug("serverUrlToIp error, fallback to url",r),r}}function gD(r,a){r.addresses||(r.addresses=[]);const s=function(y,_){if(oe("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return y.map(A=>{let{ip:I,port:L}=A;return{address:"".concat(I,":").concat(L)}});const S=oe("GATEWAY_DOMAINS");let x=S[1]&&Be(_).call(_,S[1])?1:0;return y.map(A=>{let{domain_prefix:I,port:L,ip:K}=A;if(I)return{address:"".concat(I,".").concat(S[x++%S.length],":").concat(L)};const $=/^[\.\:\d]+$/.test(K),G=$?"".concat(K.replace(/[^\d]/g,"-"),".").concat(S[x++%S.length],":").concat(L):"".concat(K,":").concat(L);return $||V.debug("Cannot recognized as ip address: ".concat(K,", use as host3")),{ip:K,port:L,address:G}})}(r.addresses,a),l=Array.isArray(r.detail)&&r.detail[18];if(l&&typeof l=="string"){const y=l.split(";");for(let _=0;_<y.length;_++){var d;const S=Ea(d=y[_]).call(d);s[_]&&S&&(s[_].ip6=S)}}const f=r.detail&&r.detail.candidate;let m;if(f){const[y,_]=f.split(":");y&&_&&(m={port:Number(_),ip:y,address:"".concat(y,":").concat(_)})}return{gatewayAddrs:s,apGatewayAddress:m,uid:r.uid,cid:r.cid,cert:r.cert,vid:r.detail&&r.detail[8],uni_lbs_ip:r.detail&&r.detail[1],res:r,csIp:r.detail&&r.detail[502]}}function Is(r){return typeof r=="number"?r:r.exact||r.ideal||r.max||r.min||0}function gK(r){const a=r._encoderConfig;if(!a)return{};const s={resolution:a.width&&a.height?"".concat(Is(a.width),"x").concat(Is(a.height)):void 0,maxVideoBW:a.bitrateMax,minVideoBW:a.bitrateMin};return typeof a.frameRate=="number"?(s.maxFrameRate=a.frameRate,s.minFrameRate=a.frameRate):a.frameRate&&(s.maxFrameRate=a.frameRate.max||a.frameRate.ideal||a.frameRate.exact||a.frameRate.min,s.minFrameRate=a.frameRate.min||a.frameRate.ideal||a.frameRate.exact||a.frameRate.max),s}function vK(r){return r>=0&&r<.17?1:r>=.17&&r<.36?2:r>=.36&&r<.59?3:r>=.59&&r<=1?4:r>1?5:0}function wb(r,a){let s,l,d;switch(a){case Lr.CHOOSE_SERVER:l=4096,d="choose server";break;case Lr.CLOUD_PROXY:l=1048576,d="proxy";break;case Lr.CLOUD_PROXY_5:l=4194304,d="proxy5";break;case Lr.CLOUD_PROXY_FALLBACK:l=4194310,d="proxy fallback";break;default:throw new Ee(ie.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:r.detail&&r.detail[502],retry:!1})}if(r.response_body.forEach(f=>{f.buffer&&f.buffer.flag===l&&(s={code:f.buffer.code,addresses:(f.buffer.edges_services||[]).map(m=>ET(ET({},m),{},{ticket:f.buffer.cert})),server_ts:r.enter_ts,uid:f.buffer.uid,cid:f.buffer.cid,cname:f.buffer.cname,detail:ET(ET({},f.buffer.detail),r.detail),flag:f.buffer.flag,opid:r.opid,cert:f.buffer.cert})}),!s)throw new Ee(ie.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(d," from multi unilbs response"),{csIp:r.detail&&r.detail[502]});return s}async function yK(r,a){return await He.all(r.addresses.map(async s=>({address:gh(s.ip),tcpport:s.port,udpport:s.port,username:a&&oe("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?a.toString():Mi.username,password:a&&oe("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await vj(a.toString()):Mi.password})))}function vD(r,a){const s=a.getMediaStreamTrack(!0).getSettings(),l=a.videoHeight||s.height,d=a.videoWidth||s.width;return l&&d?Math.max(Math.min(l,d)/Math.min(Is(r.height),Is(r.width)),1):(V.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function vh(r){let{candidateType:a,relayProtocol:s,type:l,address:d,port:f,protocol:m}=r;const y={candidateType:a,relayProtocol:s,protocol:m};if(l!=="local-candidate"){const _=d.split(".");_.length>=4&&(_[1]="*",_[2]="*"),y.address=_.join("."),y.port=f}return y}function mp(r){const a=r.split(":"),s=r.split(/[-.]/),l=Be(r).call(r,"-")?"-":".";let d=r;return a.length>1?s.length>1?(s[1]="**",d=s[0]+l+"**:"+a[a.length-1]):d=a.length>2?a[0]+l+"**:"+a[a.length-1]:"**:"+a[a.length-1]:s.length>1&&(d=s[0]+l+"**"),d}function ST(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oe("SVC_MODE");if(oe("ENABLE_SVC"))return function(a){return a in Jx}(r)?r:Jx.L1T3}const _K={[Je.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[Je.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function xT(r,a,s){a.forEach(l=>{var d;const f=_K[r].find(y=>{var _;let{key:S}=y;return Be(_=l.extensionName).call(_,S)});if(!f)return;const m=s.find(y=>{let{extensionName:_}=y;return Be(_).call(_,f.key)});m&&Be(d=m.extensionName).call(d,"gdpr_forbidden")&&(l.extensionName=m.extensionName)})}function Ug(r,a){a.forEach(s=>{var l;const d=_K[r].find(f=>{var m;let{key:y}=f;return Be(m=s.extensionName).call(m,y)});Be(l=s.extensionName).call(l,"gdpr_forbidden")&&d&&(s.extensionName=d.extensionName)})}function bK(r){return r==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||Be(r).call(r,"abs-send-time")}function TT(r){return r==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||Be(r).call(r,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function EK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function wK(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?EK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):EK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function Sb(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0;const{filterRTX:d,filterVideoFec:f,filterAudioFec:m,filterAudioCodec:y,filterVideoCodec:_,unsupportedVideoUplinkCodec:S,unsupportedVideoDownlinkCodec:x}=a,{useXR:A}=s;let I=[],L=[],K=[],$=[],G=!1,ne=!1;if(ss(r).mediaDescriptions.forEach(ce=>{l&&l!==ce.attributes.direction||(ce.media.mediaType!=="video"||G||(L=ce.attributes.payloads,$=ce.attributes.extmaps,G=!0),ce.media.mediaType!=="audio"||ne||(I=ce.attributes.payloads,K=ce.attributes.extmaps,ne=!0))}),!$||L.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!K||I.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(L.forEach(ce=>{var pe;(pe=ce.rtpMap)!==null&&pe!==void 0&&pe.clockRate&&(ce.rtpMap.clockRate=parseInt(ce.rtpMap.clockRate)),A&&ce.rtcpFeedbacks.push({type:"rrtr"})}),I.forEach(ce=>{var pe;(pe=ce.rtpMap)!==null&&pe!==void 0&&pe.clockRate&&(ce.rtpMap.clockRate=parseInt(ce.rtpMap.clockRate)),A&&ce.rtcpFeedbacks.push({type:"rrtr"})}),d&&(I=I.filter(ce=>{var pe;return((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLowerCase())!=="rtx"}),L=L.filter(ce=>{var pe;return((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLowerCase())!=="rtx"})),f){const ce=L.filter(ue=>{var ye;return/(red)|(ulpfec)|(flexfec)/i.test(((ye=ue.rtpMap)===null||ye===void 0?void 0:ye.encodingName)||"")}),pe=_h(ce,L).map(ue=>ue.payloadType),fe=[...ce.map(ue=>ue.payloadType),...pe];L=L.filter(ue=>!Be(fe).call(fe,ue.payloadType))}if(m&&(I=I.filter(ce=>{var pe;return!/(red)|(ulpfec)|(flexfec)/i.test(((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName)||"")})),y&&(y==null?void 0:y.length)>0&&(I=I.filter(ce=>{var pe;return Be(y).call(y,((pe=ce.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLowerCase())||"")})),_&&(_==null?void 0:_.length)>0){const ce=L.filter(pe=>{var fe;return Be(_).call(_,((fe=pe.rtpMap)===null||fe===void 0?void 0:fe.encodingName.toLowerCase())||"")});L=ce.concat(d?[]:_h(ce,L))}const te=oe("UNSUPPORTED_VIDEO_CODEC");if(te&&te.length>0){const ce=L.filter(ue=>ue.rtpMap&&Be(te).call(te,ue.rtpMap.encodingName.toLowerCase())),pe=_h(ce,L),fe=ce.concat(pe).map(ue=>ue.payloadType);L=L.filter(ue=>!Be(fe).call(fe,ue.payloadType)),V.debug("unsupportedVideoCodec: ".concat(te,", toBeRemoved: ").concat(fe))}if(S&&S.length>0&&l==="sendonly"){const ce=L.filter(ue=>ue.rtpMap&&Be(S).call(S,ue.rtpMap.encodingName.toLowerCase())),pe=_h(ce,L),fe=ce.concat(pe).map(ue=>ue.payloadType);L=L.filter(ue=>!Be(fe).call(fe,ue.payloadType)),V.debug("unsupportedVideoUplinkCodec: ".concat(S,", toBeRemoved: ").concat(fe))}if(x&&x.length>0&&l==="recvonly"){const ce=L.filter(ue=>ue.rtpMap&&Be(x).call(x,ue.rtpMap.encodingName.toLowerCase())),pe=_h(ce,L),fe=ce.concat(pe).map(ue=>ue.payloadType);L=L.filter(ue=>!Be(fe).call(fe,ue.payloadType)),V.debug("unsupportedVideoDownlinkCodec: ".concat(x,", toBeRemoved: ").concat(fe))}return{audioCodecs:I,videoCodecs:L,audioExtensions:K,videoExtensions:$}}function yh(r){const a=ss(r);let s,l;for(const d of a.mediaDescriptions){if(!s){const f=d.attributes.iceUfrag,m=d.attributes.icePwd;if(!f||!m)throw new Error("Cannot get iceUfrag or icePwd from SDP.");s={iceUfrag:f,icePwd:m}}if(!l){const f=d.attributes.fingerprints;f.length>0&&(l={fingerprints:f})}}if(!l&&a.attributes.fingerprints.length>0&&(l={fingerprints:a.attributes.fingerprints}),!l||!s)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:s,dtlsParameters:l}}function SK(r,a){const s=[],l=r.attributes.ssrcGroups.filter(m=>m.semantic==="FID"),d=r.attributes.ssrcGroups.find(m=>m.semantic==="SIM"),f=r.attributes.ssrcs;if(d)d.ssrcIds.forEach(m=>{var y;const _=(y=l.find(S=>S.ssrcIds[0]===m))===null||y===void 0?void 0:y.ssrcIds[1];s.push({ssrcId:m,rtx:a?_:void 0})});else if(l.length>0){const m=l[0].ssrcIds[0],y=l[0].ssrcIds[1];s.push({ssrcId:m,rtx:a?y:void 0})}else{if(f.length===0)throw new Error("No ssrcs found on local media description.");s.push({ssrcId:f[0].ssrcId})}return s}function xK(r,a,s){const{cname:l}=r;let d=[];a&&(d=TK(a)),d.length===0&&(d=r.iceParameters.candidates.map(x=>({foundation:x.foundation,componentId:"1",transport:x.protocol,priority:x.priority.toString(),connectionAddress:x.ip,port:x.port.toString(),type:x.type,extension:{}})),V.debug("Using candidates from gateway."));const f={fingerprints:r.dtlsParameters.fingerprints.map(x=>({hashFunction:x.algorithm,fingerprint:x.fingerprint}))},m={iceUfrag:r.iceParameters.iceUfrag,icePwd:r.iceParameters.icePwd};let y;switch(r.dtlsParameters.role){case"server":y="passive";break;case"client":y="active";break;case"auto":y="actpass"}const _=RT(r.rtpCapabilities),S=[];return Array.isArray(s)&&s.length>0&&s.forEach(x=>{S.push({kind:Je.VIDEO,ssrcMsg:[{ssrcId:x.v,rtx:x.v_rtx}],mslabel:"".concat(x.v,"_").concat(x.a)},{kind:Je.AUDIO,ssrcMsg:[{ssrcId:x.a}],mslabel:"".concat(x.v,"_").concat(x.a)})}),{dtlsParameters:f,iceParameters:m,candidates:d,rtpCapabilities:_,setup:y,cname:l,preSSRCs:S}}function TK(r){let a=[];return r.ip&&typeof r.port=="number"&&(a=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:r.ip,port:r.port.toString(),type:"host",extension:{}}],V.debug("Using remote candidate from AP ".concat(mp(r.ip),":").concat(r.port)),r.ip6&&(a.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:r.ip6,port:r.port.toString(),type:"host",extension:{}}),V.debug("Using IPV6 remote candidate from AP ".concat(mp(r.ip6),":").concat(r.port)))),a}function xb(r,a,s){const l=[],d=[];return r.forEach(f=>{let{ssrcId:m,rtx:y}=f;const _=Mn(8,"track-"),S={ssrcId:m,attributes:wK({label:_,mslabel:s=s||Mn(10,""),msid:"".concat(s," ").concat(_)},a&&{cname:a})};if(l.push(S),y!==void 0){const x={ssrcId:y,attributes:wK({label:_,mslabel:s,msid:"".concat(s," ").concat(_)},a&&{cname:a})};l.push(x),d.push({semantic:"FID",ssrcIds:[m,y]})}}),r.length>1&&d.push({semantic:"SIM",ssrcIds:r.map(f=>{let{ssrcId:m}=f;return m})}),{ssrcs:l,ssrcGroups:d}}function Fg(r,a){a instanceof vr&&r.attributes.payloads.forEach(s=>{var l;const d=(l=s.rtpMap)===null||l===void 0?void 0:l.encodingName.toLowerCase();if(!d||["opus","pcmu","pcma","g722"].indexOf(d)===-1)return;s.fmtp||(s.fmtp={parameters:{}}),d==="opus"&&typeof oe("OPUS_PTIME")=="number"?s.fmtp.parameters.ptime=oe("OPUS_PTIME"):s.fmtp.parameters.minptime="10",s.fmtp.parameters.useinbandfec="1";const f=a._encoderConfig;f&&(d!=="pcmu"&&d!=="pcma"&&d!=="g722"&&(f.bitrate&&!dr()&&(s.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*f.bitrate))),f.sampleRate&&(s.fmtp.parameters.maxplaybackrate="".concat(f.sampleRate),s.fmtp.parameters["sprop-maxcapturerate"]="".concat(f.sampleRate)),f.stereo&&(s.fmtp.parameters.stereo="1",s.fmtp.parameters["sprop-stereo"]="1")),a instanceof gb&&d==="opus"&&a._config.DTX&&(s.fmtp.parameters.usedtx="1"))})}function yD(r){const a=r.attributes.unrecognized.findIndex(s=>s.attField==="x-google-flag"&&s.attValue==="conference");a!==-1&&r.attributes.unrecognized.splice(a,1)}function _D(r,a){var s;if(!(a instanceof Gn&&a._encoderConfig&&a._hints.indexOf(jn.SCREEN_TRACK)===-1))return;const l=a._encoderConfig;un().supportMinBitrate&&l.bitrateMin&&r.attributes.payloads.forEach(d=>{var f,m;Be(f=["h264","h265","vp8","vp9","av1"]).call(f,((m=d.rtpMap)===null||m===void 0?void 0:m.encodingName.toLowerCase())||"")&&(d.fmtp||(d.fmtp={parameters:{}}),d.fmtp.parameters["x-google-min-bitrate"]="".concat(l.bitrateMin))}),un().supportMinBitrate&&!Be(s=a._hints).call(s,jn.LOW_STREAM)&&l.bitrateMax&&r.attributes.payloads.forEach(d=>{var f,m;Be(f=["h264","h265","vp8","vp9","av1"]).call(f,((m=d.rtpMap)===null||m===void 0?void 0:m.encodingName.toLowerCase())||"")&&(d.fmtp||(d.fmtp={parameters:{}}),d.fmtp.parameters["x-google-start-bitrate"]="".concat(oe("X_GOOGLE_START_BITRATE")||Math.floor(l.bitrateMax)))})}function CK(r){if(r.media.mediaType!=="video")return;const a=an();if(a.name!==fn.SAFARI&&a.os!==oi.IOS)return;const s=r.attributes.extmaps.findIndex(l=>/video-orientation/g.test(l.extensionName));s!==-1&&r.attributes.extmaps.splice(s,1)}function CT(r,a,s){if(!a)return;let l,d;if(r.media.mediaType==="video"?(l=s.videoExtensions,d=s.videoCodecs):(l=s.audioExtensions,d=s.audioCodecs),a.twcc===!0){const f=l.find(m=>TT(m.extensionName));if(f){const m=f.extensionName;r.attributes.extmaps.find(_=>TT(_.extensionName))||r.attributes.extmaps.push({entry:f.entry,extensionName:m}),function(_,S){return S.filter(x=>!!_.find(A=>A.payloadType===x.payloadType&&!!A.rtcpFeedbacks.find(I=>I.type==="transport-cc")))}(d,r.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(S=>S.type==="transport-cc")||_.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(a.twcc===!1){const f=r.attributes.extmaps.findIndex(m=>TT(m.extensionName));f!==-1&&r.attributes.extmaps.splice(f,1),r.attributes.payloads.forEach(m=>{const y=m.rtcpFeedbacks.findIndex(_=>_.type==="transport-cc");y!==-1&&m.rtcpFeedbacks.splice(y,1)})}if(a.remb===!0){const f=l.find(m=>bK(m.extensionName));if(f){const m=f.extensionName;r.attributes.extmaps.find(_=>_.extensionName===m)||r.attributes.extmaps.push({entry:f.entry,extensionName:m}),function(_,S){return S.filter(x=>!!_.find(A=>A.payloadType===x.payloadType&&!!A.rtcpFeedbacks.find(I=>I.type==="goog-remb")))}(d,r.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(S=>S.type==="goog-remb")||_.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(a.remb===!1){const f=r.attributes.extmaps.findIndex(m=>bK(m.extensionName));f!==-1&&r.attributes.extmaps.splice(f,1),r.attributes.payloads.forEach(m=>{const y=m.rtcpFeedbacks.findIndex(_=>_.type==="goog-remb");y!==-1&&m.rtcpFeedbacks.splice(y,1)})}}function RK(r,a,s){if(dr()||r.media.mediaType!=="video"||!(a instanceof Gn)||s!=="vp9"&&s!=="vp8"||s==="vp8"&&!oe("SIMULCAST")||s==="vp9"&&oe("ENABLE_SVC")||a._scalabilityMode===void 0||a._scalabilityMode.numSpatialLayers<=1)return;const l=s==="vp8"?2:a._scalabilityMode.numSpatialLayers,d=r.attributes.ssrcs[0],f=r.attributes.ssrcGroups.find(y=>y.semantic==="FID"&&y.ssrcIds[0]===d.ssrcId),m={semantic:"SIM",ssrcIds:[d.ssrcId]};for(let y=1;y<l;y++)r.attributes.ssrcs.push({ssrcId:d.ssrcId+y,attributes:ir(d.attributes)}),m.ssrcIds.push(d.ssrcId+y),f&&(r.attributes.ssrcs.push({ssrcId:f.ssrcIds[1]+y,attributes:ir(d.attributes)}),r.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[d.ssrcId+y,f.ssrcIds[1]+y]}));r.attributes.ssrcGroups.unshift(m)}async function NK(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new RTCPeerConnection;s.addTransceiver("video",{direction:"sendonly"}),s.addTransceiver("audio",{direction:"sendonly"}),s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"});const l=(await s.createOffer()).sdp,{send:d,recv:f,sendrecv:m}=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=arguments.length>2?arguments[2]:void 0;const x=Sb(S,y,_,"sendonly"),A=Sb(S,y,_,"recvonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},L={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},K={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(vc(x,A,"videoExtensions",I,L,K),vc(x,A,"videoCodecs",I,L,K),vc(x,A,"audioExtensions",I,L,K),vc(x,A,"audioCodecs",I,L,K),oe("RAISE_H264_BASELINE_PRIORITY")){const $=[],G=[];if(K.videoCodecs.forEach((ne,te)=>{var ce;if(((ce=ne.rtpMap)===null||ce===void 0?void 0:ce.encodingName.toLocaleLowerCase())==="h264"){var pe,fe;const ue=K.videoCodecs[te+1],ye=ue&&kK(ne,ue),Se=(pe=ne.fmtp)===null||pe===void 0?void 0:pe.parameters["profile-level-id"],Ie=(fe=ne.fmtp)===null||fe===void 0?void 0:fe.parameters["packetization-mode"];!Se||Se!==oe("FIRST_H264_PROFILE_LEVEL_ID")||oe("FIRST_PACKETIZATION_MODE")&&Ie!==oe("FIRST_PACKETIZATION_MODE")?ye?G.push([ne,ue]):G.push([ne]):ye?$.push([ne,ue]):$.push([ne])}}),$.length>0&&G.length>0){V.debug("raising H264 baseline profile priority"),K.videoCodecs.forEach((te,ce)=>{var pe;if(((pe=te.rtpMap)===null||pe===void 0?void 0:pe.encodingName.toLocaleLowerCase())==="h264"){const fe=kK(te,K.videoCodecs[ce+1]),ue=$.shift()||G.shift()||[];ue.length>0&&(fe?K.videoCodecs.splice(ce,2,...ue):K.videoCodecs.splice(ce,1,...ue))}});const ne=L.videoCodecs.filter(te=>{var ce,pe;return((ce=te.rtpMap)===null||ce===void 0?void 0:ce.encodingName.toLocaleLowerCase())==="h264"&&((pe=te.fmtp)===null||pe===void 0?void 0:pe.parameters["profile-level-id"])!==oe("FIRST_H264_PROFILE_LEVEL_ID")});if(ne.length>0){const te=_h(ne,L.videoCodecs).map(pe=>pe.payloadType),ce=[...ne.map(pe=>pe.payloadType),...te];L.videoCodecs=L.videoCodecs.filter(pe=>!Be(ce).call(ce,pe.payloadType))}oe("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(te=>{var ce,pe;return!(((ce=te.rtpMap)===null||ce===void 0?void 0:ce.encodingName.toLocaleLowerCase())==="h264"&&((pe=te.fmtp)===null||pe===void 0?void 0:pe.parameters["profile-level-id"])!==oe("FIRST_H264_PROFILE_LEVEL_ID"))}))}return{send:I,recv:L,sendrecv:K}}return{send:I,recv:L,sendrecv:K}}(r,a,l);try{s.close()}catch{}return{send:d,recv:f,sendrecv:m}}function AK(){const r={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},a=Sb(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},d={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(vc(r,a,"videoExtensions",s,l,d),vc(r,a,"videoCodecs",s,l,d),vc(r,a,"audioExtensions",s,l,d),vc(r,a,"audioCodecs",s,l,d),oe("RAISE_H264_BASELINE_PRIORITY")){const f=d.videoCodecs.findIndex(m=>m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&m.fmtp&&m.fmtp.parameters["profile-level-id"]==="42001f");if(f!==-1){const m=d.videoCodecs.findIndex(y=>y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(m<f){V.debug("raising H264 baseline profile priority");const y=d.videoCodecs[f];d.videoCodecs.splice(f,1),d.videoCodecs.splice(m,0,y)}m!==-1&&(l.videoCodecs=l.videoCodecs.filter(y=>!(y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&y.fmtp&&y.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:s,recv:l,sendrecv:d}}function vc(r,a,s,l,d,f){if(s==="videoExtensions"||s==="audioExtensions"){const m=[];return r[s].forEach(y=>{a[s].some((_,S)=>{if(y.entry===_.entry&&y.extensionName===_.extensionName)return m.push(S),!0})?f[s].push(y):l[s].push(y)}),void a[s].forEach((y,_)=>{m.indexOf(_)===-1&&d[s].push(y)})}if(s==="videoCodecs"||s==="audioCodecs"){const m=[];return r[s].forEach(y=>{a[s].some((_,S)=>{if(y.payloadType===_.payloadType&&JSON.stringify(y)===JSON.stringify(_))return m.push(S),!0})?f[s].push(y):l[s].push(y)}),void a[s].forEach((y,_)=>{m.indexOf(_)===-1&&d[s].push(y)})}}function RT(r){const{send:a,recv:s,sendrecv:l}=r;if(!l){if(!a||!s)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:a,recv:s}}let d,f;return a?(d={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},d.audioCodecs=[...a.audioCodecs,...l.audioCodecs],d.videoCodecs=[...a.videoCodecs,...l.videoCodecs],d.audioExtensions=[...a.audioExtensions,...l.audioExtensions],d.videoExtensions=[...a.videoExtensions,...l.videoExtensions]):d=l,s?(f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f.audioCodecs=[...s.audioCodecs,...l.audioCodecs],f.videoCodecs=[...s.videoCodecs,...l.videoCodecs],f.audioExtensions=[...s.audioExtensions,...l.audioExtensions],f.videoExtensions=[...s.videoExtensions,...l.videoExtensions]):f=l,{send:d,recv:f}}function Vg(r){r.media.mediaType==="audio"&&r.attributes.payloads.filter(a=>{var s;return((s=a.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase())==="opus"}).forEach(a=>{a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters.stereo="1",a.fmtp.parameters["sprop-stereo"]="1"})}function Tb(r,a,s,l){let d=[];if(r===Je.VIDEO){if(oe("H264_PROFILE_LEVEL_ID")&&l==="h264"&&(d=a.videoCodecs.filter(f=>{var m;return Be(m=f.rtpMap&&f.rtpMap.encodingName.toLowerCase()||"").call(m,l)&&f&&f.fmtp&&f.fmtp.parameters["profile-level-id"]===oe("H264_PROFILE_LEVEL_ID")})),!Array.isArray(d)||d.length===0){let f=[];const m=[],y=[],_=[];if(s.videoCodecs.forEach(S=>{const x=S.rtpMap&&S.rtpMap.encodingName.toLowerCase()||"";Be(x).call(x,l)?f.push(S):Be(x).call(x,"vp9")?m.push(S):Be(x).call(x,"vp8")?y.push(S):Be(x).call(x,"h264")&&_.push(S)}),f.length===0){let S="";m.length!==0?(f=m,S="vp9"):y.length!==0?(f=y,S="vp8"):_.length!==0&&(f=_,S="h264"),V.warning("codec ".concat(l," not included in rtpCapabilities, fallback to default payloads: ").concat(S))}f.length!==0&&(d=a.videoCodecs.filter(S=>f.some(x=>x.payloadType===S.payloadType)))}if(d.length===0&&(V.warning("codec ".concat(l," not included in rtpCapabilities, fallback to default payloads: ").concat(a.videoCodecs[0].rtpMap&&a.videoCodecs[0].rtpMap.encodingName)),d=a.videoCodecs),oe("USE_PUB_RTX")||oe("USE_SUB_RTX")){const f=_h(d,a.videoCodecs);d=[...d,...f]}}else{d=a.audioCodecs.filter(m=>{var y;return Be(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,l)});const f=a.audioCodecs.filter(m=>{var y;return Be(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,"red")});d.length===0&&(V.warning("codec ".concat(l," not included in rtpCapabilities, fallback to opus")),d=a.audioCodecs.filter(m=>{var y;return Be(y=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(y,"opus")})),oe("ENABLE_AUDIO_RED")&&f.length!==0&&(d=[...f,...d])}return d}function _h(r,a){const s=r.map(l=>l.payloadType.toString());return a.filter(l=>l.rtpMap&&l.rtpMap.encodingName==="rtx"&&l.fmtp&&l.fmtp.parameters.apt&&Be(s).call(s,l.fmtp&&l.fmtp.parameters.apt))}async function bh(r,a,s){const l=a.toString(),d=OK(l,"offer","remote","exchangeSDP");await r.setRemoteDescription({type:"offer",sdp:l});const f=await r.createAnswer();if(!f.sdp)throw new Error("cannot get answer sdp");let m=f.sdp;m=IK(m,s||{}),d==null||d(m||""),await r.setLocalDescription({type:"answer",sdp:m})}function IK(r,a,s){const l=ss(r),{useXR:d}=a;return l.mediaDescriptions.forEach(f=>{var m;f.attributes.mid&&(Array.isArray(s)&&!Be(s).call(s,f.attributes.mid)||(f.media.mediaType==="audio"&&Vg(f),d&&Be(m=["audio","video"]).call(m,f.media.mediaType)&&f.attributes.payloads.forEach(y=>{y.rtcpFeedbacks.findIndex(_=>_.type==="rrtr")===-1&&y.rtcpFeedbacks.push({type:"rrtr"})})))}),hh(l)}function OK(r,a,s,l){if(oe("SDP_LOGGING"))return V.upload("exchanging ".concat(s," ").concat(a," SDP during P2PConnection.").concat(l,`
`),r),a==="offer"?d=>{OK(d,"answer",s==="local"?"remote":"local",l)}:void 0}function PK(r){const a=oe("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(a)&&a.length>0)&&a.some(s=>Be(r).call(r,s))}function kK(r,a){try{var s;return((s=r.fmtp)===null||s===void 0?void 0:s.parameters.apt)===a.payloadType.toString()}catch{return!1}}function jK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ro(r,a){return typeof oe(r)===a?oe(r):void 0}function oOe(){try{const r=oe("EXPERIMENTS")||{};return typeof r=="string"||Array.isArray(r)?{}:function(a){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?jK(Object(l),!0).forEach(function(d){Q(a,d,l[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(l)):jK(Object(l)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(l,d))})}return a}({},r)}catch(r){return V.debug("handle gateway attributes failed: ",r),{}}}const DK={};function Eh(r){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&V.debug("install service ".concat(r.name)),DK[r.name]=r}function cd(r){const a=DK[r];if(!a)throw new we(ie.INVALID_OPERATION,"".concat(r," not found, please use AgoraRTC.use(").concat(r,"Service) to load it first"));return a}function LK(r,a){return cd("DataStream").create(r,a)}function NT(){return cd("InterceptFrame").create()}function MK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ca(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?MK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):MK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const bD=new Map;class cOe extends cr{get state(){return this._state}set state(a){if(a===this._state)return;const s=this._state;this._state=a,a==="DISCONNECTED"&&this._disconnectedReason?this.emit(gi.CONNECTION_STATE_CHANGE,a,s,this._disconnectedReason):this.emit(gi.CONNECTION_STATE_CHANGE,a,s)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(a){V.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(a)),this._joinGatewayStartTime=a}constructor(a,s){var l,d,f;super(),Q(this,"store",void 0),Q(this,"joinInfo",void 0),Q(this,"key",void 0),Q(this,"ntpOffset",0),Q(this,"signal",void 0),Q(this,"role",void 0),Q(this,"isPreallocation",void 0),Q(this,"isPreSub",void 0),Q(this,"inChannelInfo",{joinAt:null,duration:0}),Q(this,"spec",void 0),Q(this,"_state","DISCONNECTED"),Q(this,"_statsCollector",void 0),Q(this,"_disconnectedReason",void 0),Q(this,"isSignalRecover",!1),Q(this,"hasChangeBGPAddress",!1),Q(this,"trafficStatsInterval",void 0),Q(this,"networkQualityInterval",void 0),Q(this,"_joinGatewayStartTime",0),Q(this,"_signalTimeout",!1),Q(this,"_clientRoleOptions",void 0),Q(this,"_isProactiveJoin",!1),this.store=a,this.spec=s,this.signal=this.store.useP2P?(l={spec:ca(ca({},s),{},{retryConfig:s.websocketRetryConfig}),store:a},(d=(f=cd("P2PChannel")).createSubmodule)===null||d===void 0?void 0:d.call(f,l)):new aOe(ca(ca({},s),{},{retryConfig:s.websocketRetryConfig}),a),this._statsCollector=s.statsCollector,this.role=s.role||"audience",this._clientRoleOptions=s.clientRoleOptions,this.handleSignalEvents()}async join(a,s,l){this.store.joinGatewayStart(),a.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const d=Date.now();let f=bD.get(a.cname);if(f||(f=new Map,bD.set(a.cname,f)),this._isProactiveJoin=!0,f.has(a.uid)){const S=new Ee(ie.UID_CONFLICT);throw it.joinGateway(a.sid,{lts:d,succ:!1,ec:S.code,addr:null,uid:a.uid,cid:a.cid,firstSuccess:this._isProactiveJoin,isProxy:!!a.proxyServer,signalChannel:"0",preload:a.preload}),S}f.set(a.uid,!0),this.joinInfo=a,this.key=s;let m=0;this.joinGatewayStartTime=d;const y=a.proxyServer;try{V.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(m));const S=a.gatewayAddrs.map(x=>{let{address:A}=x;const[I,L]=A.split(":"),K={host:I,port:L};return a.proxyServer&&(K.proxy=a.proxyServer),K});m=(await this.signal.init(S)).uid,V.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(m," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(S){var _;throw V.error("[".concat(this.store.clientId,"] User join failed"),S.toString()),it.joinGateway(a.sid,{lts:d,succ:!1,ec:((_=S.data)===null||_===void 0?void 0:_.desc)||S.code,errorMsg:S.message,addr:this.signal.url,uid:a.uid,cid:a.cid,firstSuccess:this._isProactiveJoin,isProxy:!!y,signalChannel:"0",preload:a.preload}),f.delete(a.uid),this.signal.close(),S}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),V.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(S=>{V.warning("[".concat(this.store.clientId,"] get traffic stats error"),S.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(gi.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(gi.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(gi.NETWORK_QUALITY,{uplinkNetworkQuality:vK(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:vK(this._statsCollector.trafficStats.B_dnq)}):this.emit(gi.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),m}async leave(){let a=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){s!==En.FALLBACK&&(this.state="DISCONNECTING");try{a||this.signal.connectionState!==Wn.CONNECTED||await function(l,d){return d===1/0?l:He.race([l,k1e(d)])}(this.signal.request(Ct.LEAVE,void 0,!0),3e3)}catch(l){V.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),l)}this.signal.close(s),s!==En.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const d={state:"offer",p2p_id:this.store.p2pId,ortc:s,mode:this.spec.mode,extend:oe("PUB_EXTEND"),twcc:!!oe("PUBLISH_TWCC"),rtx:!!oe("USE_PUB_RTX")};try{return(await this.signal.request(Ct.PUBLISH,d,!0))._message}catch(f){if(l&&f.data&&f.data.code===vt.ERR_PUBLISH_REQUEST_INVALID)return V.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),f.toString()),await this.tryUnpubBeforeRepub(a,s),this.publish(a,s,!1);throw f}}async publishDataChannel(a,s,l){var d;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const f={stream_id:s.streamId,ordered:s.ordered?1:0,max_retrans_times:(d=s.maxRetransmits)!==null&&d!==void 0?d:10,channel_id:s.channelId,metadata:s.metadata};try{await this.signal.request(Ct.PUBLISH_DATASTREAM,f,!0)}catch(m){if(l&&m.data&&m.data.code===vt.ERR_PUBLISH_REQUEST_INVALID)return V.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),m.toString()),await this.tryUnpubDataChannelBeforeRepub(a,s),this.publishDataChannel(a,s,!1);throw m}}async unpublish(a,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Ct.UNPUBLISH,{stream_id:s,ortc:a},!0)}catch(l){V.warning("[".concat(this.store.clientId,"] unpublish warning: "),l)}}async unpublishDataChannel(a){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await He.all(a.map(s=>this.signal.request(Ct.UNPUBLISH_DATASTREAM,{channel_id:s},!0)))}catch(s){V.warning("unpublish datachannels warning: ",s)}}async presubscribe(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const d={stream_id:a,stream_type:s,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!oe("SUBSCRIBE_TWCC"),rtx:!!oe("USE_SUB_RTX")||void 0,extend:oe("SUB_EXTEND"),svc:Array.isArray(oe("SVC"))&&oe("SVC").length!==0?oe("SVC"):void 0};try{return await this.signal.request(Ct.PRE_SUBSCRIBE,d,!0)}catch(f){if(l&&f.data&&f.data.code===vt.ERR_SUBSCRIBE_REQUEST_INVALID)return V.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),f.toString()),this.presubscribe(a,s,!1);throw f}}async subscribe(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const d={stream_id:a,stream_type:s.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!oe("SUBSCRIBE_TWCC"),rtx:!!oe("USE_SUB_RTX"),extend:oe("SUB_EXTEND"),ssrcId:s.ssrcId,svc:Array.isArray(oe("SVC"))&&oe("SVC").length!==0?oe("SVC"):void 0};try{return(await this.signal.request(Ct.SUBSCRIBE,d,!0))._message}catch(f){if(l&&f.data&&f.data.code===vt.ERR_SUBSCRIBE_REQUEST_INVALID)return V.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),f.toString()),await this.tryUnsubBeforeResub(a,s),await this.subscribe(a,s,!1);throw f}}async subscribeDataChannel(a,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const d={uid:a,stream_id:s.id,channel_id:s.datachannelId};try{return void await this.signal.request(Ct.SUBSCRIBE_DATASTREAM,d,!0)}catch(f){if(l&&f.data&&f.data.code===vt.ERR_SUBSCRIBE_REQUEST_INVALID)return V.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),f.toString()),await this.tryUnsubDataChannelBeforeResub(a,s),await this.subscribeDataChannel(a,s,!1);throw f}}async subscribeAll(a,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const l={p2p_id:this.store.p2pId,users:a,dtx:!1,rtx:!!oe("USE_SUB_RTX"),twcc:!!oe("SUBSCRIBE_TWCC"),svc:Array.isArray(oe("SVC"))&&oe("SVC").length!==0?oe("SVC"):void 0};try{return await this.signal.request(Ct.SUBSCRIBE_STREAMS,l,!0)}catch(d){if(s&&d.data&&d.data.code===vt.ERR_SUBSCRIBE_REQUEST_INVALID)return V.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),d.toString()),await this.tryMassUnsubBeforeResub(a),await this.subscribeAll(a,!1);throw d}}async setVideoProfile(a){const s=function(l){if(!(l.bitrateMax&&l.bitrateMin&&l.frameRate&&l.height&&l.width))return;let d=l.frameRate,f=l.width,m=l.height,y=!0;return typeof d!="number"&&(d=d.exact||d.ideal||d.max||d.min||0,d||(y=!1)),typeof f!="number"&&(f=f.exact||f.ideal||f.max||f.min||0,f||(y=!1)),typeof m!="number"&&(m=m.exact||m.ideal||m.max||m.min||0,d||(y=!1)),y?{stream_type:0,width:f,height:m,fps:d,start_bps:1e3*l.bitrateMax,min_bps:1e3*l.bitrateMin,target_bps:1e3*l.bitrateMax}:void 0}(a);if(s)return this.signal.request(Ct.SET_VIDEO_PROFILE,s);V.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(a,s){try{await this.signal.request(Ct.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:a,stream_id:s},!0)}catch(l){V.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),l)}}async unsubscribeDataChannel(a,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await He.all(a.map(l=>this.signal.request(Ct.UNSUBSCRIBE_DATASTREAM,{stream_id:l,uid:s},!0)))}catch(l){V.warning("unsubscribeDataChannel warning: ",l)}}async massUnsubscribe(a){try{await this.signal.request(Ct.UNSUBSCRIBE_STREAMS,a,!0)}catch(s){V.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),s)}}async reconnectPC(a){const{iceParameters:s,dtlsParameters:l,rtpCapabilities:d}=a;return{gatewayEstablishParams:await this.signal.request(Ct.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:s,dtlsParameters:l,rtpCapabilities:d}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(Ct.GATEWAY_INFO)}async renewToken(a){await this.signal.request(Ct.RENEW_TOKEN,a),this.key=a.token}updateClientRole(a,s){s&&(this._clientRoleOptions=Object.assign({},s)),oe("CLIENT_ROLE_OPTIONS")&&(V.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(oe("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},oe("CLIENT_ROLE_OPTIONS"))),this.role=a}async setClientRole(a,s){if(s&&(this._clientRoleOptions=Object.assign({},s)),oe("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},oe("CLIENT_ROLE_OPTIONS")),V.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(oe("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=a);let l,d=0;a==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(l=this._clientRoleOptions.delay,d=1):d=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:d=0;const f=Object.assign({},s);delete f.delay,delete f.level,await this.signal.request(Ct.SET_CLIENT_ROLE,ca(ca({role:a,level:d,delay:l},f),{},{client_ts:Date.now()})),this.role=a}async setRemoteVideoStreamType(a,s){await this.signal.request(Ct.SWITCH_VIDEO_STREAM,{stream_id:a,stream_type:s})}async setDefaultRemoteVideoStreamType(a){await this.signal.request(Ct.DEFAULT_VIDEO_STREAM,{stream_type:a})}async setStreamFallbackOption(a,s){await this.signal.request(Ct.SET_FALLBACK_OPTION,{stream_id:a,fallback_type:s})}async pickSVCLayer(a,s){await this.signal.request(Ct.PICK_SVC_LAYER,{stream_id:a,spatial_layer:s.spatialLayer,temporal_layer:s.temporalLayer})}async setRTM2Flag(a){await this.signal.request(Ct.SET_RTM2_FLAG,{rtm2_flag:a})}async sendExtensionMessage(a,s,l){if(this.store.useP2P)return this.signal.sendExtensionMessage(a,s,l)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),ca({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Ct.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const a=bD.get(this.joinInfo.cname);a&&a.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const a=function(s){let l;return l=s.startsWith("dc")?s.match(/(dc\:\/\/)?([^:]+):(\d+)/):s.match(/(wss\:\/\/)?([^:]+):(\d+)/),l?{username:Mi.username,password:Mi.password,turnServerURL:l[2],tcpport:parseInt(l[3])+30,udpport:parseInt(l[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],a&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(ca(ca({},Mi),{},{turnServerURL:a.turnServerURL,tcpport:a.tcpport,udpport:a.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const a=await this.signal.request(Ct.TRAFFIC_STATS,void 0,!0);a.timestamp=Date.now(),a.ntp_offset!=null&&(this.ntpOffset=a.ntp_offset),a.peer_delay.forEach(s=>{const l=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(d=>d.peer_uid===s.peer_uid);l&&l.B_st!==s.B_st&&Kx(()=>{this.emit(gi.STREAM_TYPE_CHANGE,s.peer_uid,s.B_st)})}),this._statsCollector.updateTrafficStats(a)}getJoinMessage(a){var s,l;if(!this.joinInfo||!this.key)throw new Ee(ie.UNEXPECTED_ERROR,"can not generate join message, no join info");const d=Object.assign({},this.joinInfo.apResponse);let f=oe("REPORT_APP_SCENARIO");if(typeof f!="string")try{f=JSON.stringify(f)}catch{f=void 0}var m;f&&f.length>128&&(f=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(gi.UPDATE_GATEWAY_CONFIG),m=this.store.clientId,Be(kg).call(kg,m)||kg.push(m);const y=Dj(this.store),_=!((s=this.isPreallocation)===null||s===void 0||!s.call(this)),S=Vz(this.store),x=oOe(),A=pg(87)||YH()||lj(117),I=(function(){const K=an();if(K.name!==fn.SAFARI||!K.browserVersion)return!1;const $=K.browserVersion.split(".");return Number($[0])>18||Number($[0])===18&&Number($[1])>=4}()||QH(18,4,!1))&&uj(18,6,!0)&&this.spec.codec==="h264"&&oe("ENABLE_ABSSENDTIME_AS_SENTTS"),L=ca({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:xo,browser:navigator.userAgent,process_id:oe("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:d,extend:oe("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:f,attributes:{userAttributes:ca(ca({enableEncodedTransform:(!!oe("ENABLE_AUDIO_METADATA")||!!oe("ENABLE_AUDIO_PTS"))&&A||!!oe("ENABLE_AUDIO_TOPN")&&oj(fn.CHROME,87,116)||void 0,enableAudioMetadata:!!oe("ENABLE_AUDIO_METADATA")&&A,enableAudioPts:!!oe("ENABLE_AUDIO_PTS")&&A,topnSmoothLevel:oe("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:oe("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:oe("TOPN_SWITCH_HOLD_MS"),topnAudioGain:oe("TOPN_AUDIO_GAIN"),enablePublishedUserList:oe("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:oe("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:ro("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:ro("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:ro("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:oe("USE_PUB_RTX")===!0||oe("USE_SUB_RTX")===!0||void 0,disableFEC:oe("DISABLE_FEC"),enableNTPReport:!!oe("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:S,enableFulllinkAvSync:!!oe("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:ro("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!oe("FORCE_ENABLE_AUT_CC")||!eT()&&(!!oe("ENABLE_AUT_FEEDBACK")||void 0),rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!oe("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:ro("USE_XR","boolean"),enableLossbasedBwe:ro("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!oe("FORCE_ENABLE_AUT_CC")||!eT()&&(!!oe("ENABLE_AUT_CC")||void 0),enableCCFallback:ro("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:_,preSubNum:y?ro("PRE_SUB_NUM","number"):void 0,enablePubTWCC:ro("PUBLISH_TWCC","boolean"),enableSubTWCC:ro("SUBSCRIBE_TWCC","boolean"),enablePubRTX:ro("USE_PUB_RTX","boolean"),enableSubRTX:ro("USE_SUB_RTX","boolean"),enableSubSVC:oe("ENABLE_SVC")?oe("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(oe("SVC"))&&oe("SVC").length!==0?oe("SVC"):void 0,enableSvcExtended:oe("ENABLE_SVC")&&Array.isArray(oe("SVC_EXTENDED"))&&oe("SVC_EXTENDED").length!==0?oe("SVC_EXTENDED"):void 0},x),{},{audioDuplicate:ro("ENABLE_AUDIO_RED","boolean")?(l=ro("AUDIO_DUPLICATE_NUM","number"))!==null&&l!==void 0?l:2:void 0,senttsUsesAbsSendTime:!!I||void 0})},join_ts:this.joinGatewayStartTime},a);return this.joinInfo.stringUid&&(L.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(L.aes_mode=this.joinInfo.aesmode,oe("ENCRYPT_AES")?(L.aes_secret=this.joinInfo.aespassword,L.aes_encrypt=!0):L.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(L.aes_salt=this.joinInfo.aessalt)),d.addresses[this.signal.websocket.currentURLIndex]&&(L.ap_response.ticket=d.addresses[this.signal.websocket.currentURLIndex].ticket,delete d.addresses),this.joinInfo.defaultVideoStream!==void 0&&(L.default_video_stream=this.joinInfo.defaultVideoStream),L}getRejoinMessage(){if(!this.joinInfo)throw new Ee(ie.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(It.WS_RECONNECT_CREATE_CONNECTION,a=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(It.WS_RECONNECTING,a=>{this.joinInfo&&it.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:a||Di.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",it.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(It.WS_CLOSED,a=>{let s;switch(a){case En.LEAVE:s=Di.LEAVE;break;case En.UID_BANNED:case En.IP_BANNED:case En.CHANNEL_BANNED:case En.SERVER_ERROR:s=Di.SERVER_ERROR;break;case En.FALLBACK:s=Di.FALLBACK;break;case En.LICENSE_MISSING:case En.LICENSE_EXPIRED:case En.LICENSE_MINUTES_EXCEEDED:case En.LICENSE_PERIOD_INVALID:case En.LICENSE_MULTIPLE_SDK_SERVICE:case En.LICENSE_ILLEGAL:case En.TOKEN_EXPIRE:s=a;break;default:s=Di.NETWORK_ERROR}V.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(s||"undefined -> "+Di.NETWORK_ERROR)),this.joinInfo&&it.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:a===En.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:s}),this._disconnectedReason=a,a!==En.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(It.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const a=oe("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;a&&(a.level||a.delay)&&(V.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(a.level,", delay: ").concat(a.delay)),this.setClientRole(this.role,a))}if(it.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const a=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!a)return void V.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(a));An("EVENT_REPORT_DOMAIN",a[1]),An("EVENT_REPORT_BACKUP_DOMAIN",a[1]),An("LOG_UPLOAD_SERVER","".concat(a[1],":6444"))}}}),this.signal.on(en.ON_UPLINK_STATS,a=>{this._statsCollector.updateUplinkStats(a)}),this.signal.on(It.REQUEST_RECOVER,(a,s,l)=>{if(!this.joinInfo)return l(new Ee(ie.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));a&&(this.joinInfo.multiIP=a,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Li(this,gi.REQUEST_NEW_GATEWAY_LIST).then(s).catch(l)}),this.signal.on(It.REQUEST_JOIN_INFO,async(a,s,l)=>{var d,f,m;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void a(this.getJoinMessage({ortc:{}}));const y=ir((d=this.joinInfo)===null||d===void 0?void 0:d.turnServer);if(oe("NEW_TURN_MODE")&&y&&((f=this.joinInfo)===null||f===void 0?void 0:f.cloudProxyServer)==="disabled"){var _;let I=y.servers.map($=>"turnServerURL"in $&&oe("USE_TURN_IP")?ca(ca({},$),{},{turnServerURL:wT($.turnServerURL)}):$),L=(_=y.serversFromGateway)===null||_===void 0?void 0:_.map($=>oe("USE_TURN_IP")?ca(ca({},$),{},{turnServerURL:wT($.turnServerURL)}):$);const K=this.signal.currentURLIndex;I.length>0&&(I=[I[K%I.length]],y.servers=I),Array.isArray(L)&&L.length>0&&(L=[L[0]],y.serversFromGateway=L),V.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(K))}const{iceParameters:S,dtlsParameters:x,rtpCapabilities:A}=await Li(this,gi.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:y,cloudProxyServer:(m=this.joinInfo)===null||m===void 0?void 0:m.cloudProxyServer});try{a(this.getJoinMessage({ortc:{iceParameters:S,dtlsParameters:x,rtpCapabilities:A,version:"2"}}))}catch(I){s(I)}}),this.signal.on(It.REQUEST_REJOIN_INFO,a=>{a(this.getRejoinMessage())}),this.signal.on(It.REPORT_JOIN_GATEWAY,(a,s)=>{if(!this.joinInfo)return;let l,d="";var f;a instanceof Ee?(l=((f=a.data)===null||f===void 0?void 0:f.desc)||a.code,d=a.message):l=a,it.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:l,errorMsg:d,addr:s,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(It.IS_P2P_DISCONNECTED,a=>{a(lb(this,gi.IS_P2P_DISCONNECTED))}),this.signal.on(It.DISCONNECT_P2P,()=>{this.emit(gi.DISCONNECT_P2P)}),this.signal.on(It.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(It.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(It.JOIN_RESPONSE,a=>{const s=this.getCurrentGatewayAddress();this.emit(gi.JOIN_RESPONSE,a,s)}),this.signal.on(It.PRE_CONNECT_PC,async()=>{if(this.joinInfo){var a,s;this.updateTurnConfigFromSignal();const d=this.getCurrentGatewayAddress(),f=ir((a=this.joinInfo)===null||a===void 0?void 0:a.turnServer);if(oe("NEW_TURN_MODE")&&f&&((s=this.joinInfo)===null||s===void 0?void 0:s.cloudProxyServer)==="disabled"){var l;let y=f.servers.map(x=>"turnServerURL"in x&&oe("USE_TURN_IP")?ca(ca({},x),{},{turnServerURL:wT(x.turnServerURL)}):x),_=(l=f.serversFromGateway)===null||l===void 0?void 0:l.map(x=>oe("USE_TURN_IP")?ca(ca({},x),{},{turnServerURL:wT(x.turnServerURL)}):x);const S=this.signal.currentURLIndex;y.length>0&&(y=[y[S%y.length]],f.servers=y),Array.isArray(_)&&_.length>0&&(_=[_[0]],f.serversFromGateway=_),V.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(S,",in pre pc"))}const m=oe("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(d&&m){const y=TK(d);this.emit(gi.PRE_CONNECT_PC,{candidates:y,fingerprint:m,turnServer:f})}}}),this.signal.on(It.RECOVER_NOTIFICATION,a=>{this.joinInfo&&typeof oe("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(oe("AP_REQUEST_DETAIL"),";").concat(a))})}async tryUnsubBeforeResub(a,s){try{await this.signal.request(Ct.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:a,ortc:[s]},!0)}catch(l){throw V.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),l),l}}async tryUnsubDataChannelBeforeResub(a,s){try{await this.signal.request(Ct.UNSUBSCRIBE,{stream_id:s.id},!0)}catch(l){throw V.warning("unsubscribe datachannel warning",l),l}}async tryUnpubBeforeRepub(a,s){try{await this.signal.request(Ct.UNPUBLISH,{stream_id:a,ortc:s},!0)}catch(l){throw V.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),l),l}}async tryUnpubDataChannelBeforeRepub(a,s){try{await this.signal.request(Ct.UNPUBLISH_DATASTREAM,{channnel_id:s.channelId},!0)}catch(l){throw V.warning("unpublish datastream warning: ",l),l}}async tryMassUnsubBeforeResub(a){const s={users:a.map(l=>({stream_id:l.stream_id,stream_type:l.stream_type}))};try{await this.signal.request(Ct.UNSUBSCRIBE_STREAMS,s,!0)}catch(l){throw V.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),l),l}}async muteLocal(a,s){const l={action:a.find(d=>d.stream_type===xn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:a,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw V.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),d),d}}async unmuteLocal(a,s){const l={action:a.find(d=>d.stream_type===xn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:a,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw V.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),d),d}}async muteRemote(a,s){const l={action:a===Je.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw V.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),d),d}}async unmuteRemote(a,s){const l={action:a===Je.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(Ct.CONTROL,l,!0,!0)}catch(d){throw V.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),d),d}}uploadWRTCStats(a){this.signal.uploadWRTCStats(a)}upload(a,s){this.signal.upload(a,s)}getSignalRTT(){return this.signal.rtt}async restartICE(a){const s={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:a};try{return await this.signal.request(Ct.RESTART_ICE,s,!0)}catch(l){throw V.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),l),l}}reconnect(a,s){this.state==="CONNECTED"&&this.signal.reconnect(a||void 0,s||Di.P2P_FAILED)}getCurrentGatewayAddress(){var a,s;if(!oe("GATEWAY_WSS_ADDRESS"))return oe("USE_CANDIDATE_FROM_AP_DETAIL")&&(a=this.joinInfo)!==null&&a!==void 0&&a.apGatewayAddress?(V.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(s=this.joinInfo)!==null&&s!==void 0&&s.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(a){await this.signal.request(Ct.SET_PARAMETER,{enablePublishAudioFilter:a})}downgradeCodec(a){this.signal.downgradeCodec(a)}}let AT=0,ED=0;function sl(r,a,s,l){return new He((d,f)=>{a.timeout=a.timeout||oe("HTTP_CONNECT_TIMEOUT"),a.responseType=a.responseType||"json",a.data&&!s?(a.data=JSON.stringify(a.data),AT+=eu(a.data)):s&&(a.data.size?AT+=a.data.size:a.data instanceof FormData?AT+=mz(a.data):AT+=eu(JSON.stringify(a.data))),a.headers=a.headers||{},a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.method="POST",a.url=r,Ka.request(a).then(m=>{typeof m.data=="string"?ED+=eu(m.data):m.data instanceof ArrayBuffer||m.data instanceof Uint8Array?ED+=m.data.byteLength:ED+=eu(JSON.stringify(m.data)),l&&d({data:m.data,headers:m.headers}),d(m.data)}).catch(m=>{Ka.isCancel(m)?f(new Ee(ie.OPERATION_ABORTED,"cancel token canceled")):m.code==="ECONNABORTED"?f(new Ee(ie.NETWORK_TIMEOUT,m.message)):m.response?f(new Ee(ie.NETWORK_RESPONSE_ERROR,m.response.status)):f(new Ee(ie.NETWORK_ERROR,m.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var r;function a(Re){var Ve=0;return function(){return Ve<Re.length?{done:!1,value:Re[Ve++]}:{done:!0}}}var s=typeof Object.defineProperties=="function"?Object.defineProperty:function(Re,Ve,Ze){return Re==Array.prototype||Re==Object.prototype||(Re[Ve]=Ze.value),Re},l,d=function(Re){Re=[typeof globalThis=="object"&&globalThis,Re,typeof window=="object"&&window,typeof self=="object"&&self,typeof i=="object"&&i];for(var Ve=0;Ve<Re.length;++Ve){var Ze=Re[Ve];if(Ze&&Ze.Math==Math)return Ze}throw Error("Cannot find global object")}(this);function f(Re,Ve){if(Ve)e:{var Ze=d;Re=Re.split(".");for(var Oe=0;Oe<Re.length-1;Oe++){var B=Re[Oe];if(!(B in Ze))break e;Ze=Ze[B]}(Ve=Ve(Oe=Ze[Re=Re[Re.length-1]]))!=Oe&&Ve!=null&&s(Ze,Re,{configurable:!0,writable:!0,value:Ve})}}function m(Re){return(Re={next:Re})[Symbol.iterator]=function(){return this},Re}function y(Re){var Ve=typeof Symbol<"u"&&Symbol.iterator&&Re[Symbol.iterator];return Ve?Ve.call(Re):{next:a(Re)}}if(f("Symbol",function(Re){function Ve(B,le){this.A=B,s(this,"description",{configurable:!0,writable:!0,value:le})}if(Re)return Re;Ve.prototype.toString=function(){return this.A};var Ze="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Oe=0;return function B(le){if(this instanceof B)throw new TypeError("Symbol is not a constructor");return new Ve(Ze+(le||"")+"_"+Oe++,le)}}),f("Symbol.iterator",function(Re){if(Re)return Re;Re=Symbol("Symbol.iterator");for(var Ve="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ze=0;Ze<Ve.length;Ze++){var Oe=d[Ve[Ze]];typeof Oe=="function"&&typeof Oe.prototype[Re]!="function"&&s(Oe.prototype,Re,{configurable:!0,writable:!0,value:function(){return m(a(this))}})}return Re}),typeof Object.setPrototypeOf=="function")l=Object.setPrototypeOf;else{var _;e:{var S={};try{S.__proto__={a:!0},_=S.a;break e}catch{}_=!1}l=_?function(Re,Ve){if(Re.__proto__=Ve,Re.__proto__!==Ve)throw new TypeError(Re+" is not extensible");return Re}:null}var x=l;function A(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function I(Re){if(Re.m)throw new TypeError("Generator is already running");Re.m=!0}function L(Re,Ve){return Re.h=3,{value:Ve}}function K(Re){this.g=new A,this.G=Re}function $(Re,Ve,Ze,Oe){try{var B=Ve.call(Re.g.j,Ze);if(!(B instanceof Object))throw new TypeError("Iterator result "+B+" is not an object");if(!B.done)return Re.g.m=!1,B;var le=B.value}catch(he){return Re.g.j=null,Re.g.s(he),G(Re)}return Re.g.j=null,Oe.call(Re.g,le),G(Re)}function G(Re){for(;Re.g.h;)try{var Ve=Re.G(Re.g);if(Ve)return Re.g.m=!1,{value:Ve.value,done:!1}}catch(Ze){Re.g.v=void 0,Re.g.s(Ze)}if(Re.g.m=!1,Re.g.l){if(Ve=Re.g.l,Re.g.l=null,Ve.F)throw Ve.D;return{value:Ve.return,done:!0}}return{value:void 0,done:!0}}function ne(Re){this.next=function(Ve){return Re.o(Ve)},this.throw=function(Ve){return Re.s(Ve)},this.return=function(Ve){return function(Ze,Oe){I(Ze.g);var B=Ze.g.j;return B?$(Ze,"return"in B?B.return:function(le){return{value:le,done:!0}},Oe,Ze.g.return):(Ze.g.return(Oe),G(Ze))}(Re,Ve)},this[Symbol.iterator]=function(){return this}}function te(Re,Ve){return Ve=new ne(new K(Ve)),x&&Re.prototype&&x(Ve,Re.prototype),Ve}if(A.prototype.o=function(Re){this.v=Re},A.prototype.s=function(Re){this.l={D:Re,F:!0},this.h=this.C||this.u},A.prototype.return=function(Re){this.l={return:Re},this.h=this.u},K.prototype.o=function(Re){return I(this.g),this.g.j?$(this,this.g.j.next,Re,this.g.o):(this.g.o(Re),G(this))},K.prototype.s=function(Re){return I(this.g),this.g.j?$(this,this.g.j.throw,Re,this.g.o):(this.g.s(Re),G(this))},f("Array.prototype.entries",function(Re){return Re||function(){return function(Ve,Ze){Ve instanceof String&&(Ve+="");var Oe=0,B=!1,le={next:function(){if(!B&&Oe<Ve.length){var he=Oe++;return{value:Ze(he,Ve[he]),done:!1}}return B=!0,{done:!0,value:void 0}}};return le[Symbol.iterator]=function(){return le},le}(this,function(Ve,Ze){return[Ve,Ze]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var ce=function(Re,Ve){for(var Ze=0;Ze<Re.length;Ze++)Ve(Re[Ze])},pe=function(Re){return Re.replace(/\r?\n|\r/g,`\r
`)},fe=function(Re,Ve,Ze){return Ve instanceof Blob?(Ze=Ze!==void 0?Ze+"":typeof Ve.name=="string"?Ve.name:"blob",Ve.name===Ze&&Object.prototype.toString.call(Ve)!=="[object Blob]"||(Ve=new File([Ve],Ze)),[String(Re),Ve]):[String(Re),String(Ve)]},ue=function(Re,Ve){if(Re.length<Ve)throw new TypeError(Ve+" argument required, but only "+Re.length+" present.")},ye=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,Se=ye.FormData,Ie=ye.XMLHttpRequest&&ye.XMLHttpRequest.prototype.send,Me=ye.Request&&ye.fetch,Gt=ye.navigator&&ye.navigator.sendBeacon,Kt=ye.Element&&ye.Element.prototype,Nt=ye.Symbol&&Symbol.toStringTag;Nt&&(Blob.prototype[Nt]||(Blob.prototype[Nt]="Blob"),"File"in ye&&!File.prototype[Nt]&&(File.prototype[Nt]="File"));try{new File([],"")}catch{ye.File=function(Ve,Ze,Oe){return Ve=new Blob(Ve,Oe||{}),Object.defineProperties(Ve,{name:{value:Ze},lastModified:{value:+(Oe&&Oe.lastModified!==void 0?new Date(Oe.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Nt&&Object.defineProperty(Ve,Nt,{value:"File"}),Ve}}var bn=function(Re){return Re.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},vn=function(Re){this.i=[];var Ve=this;Re&&ce(Re.elements,function(Ze){if(Ze.name&&!Ze.disabled&&Ze.type!=="submit"&&Ze.type!=="button"&&!Ze.matches("form fieldset[disabled] *"))if(Ze.type==="file"){var Oe=Ze.files&&Ze.files.length?Ze.files:[new File([],"",{type:"application/octet-stream"})];ce(Oe,function(B){Ve.append(Ze.name,B)})}else Ze.type==="select-multiple"||Ze.type==="select-one"?ce(Ze.options,function(B){!B.disabled&&B.selected&&Ve.append(Ze.name,B.value)}):Ze.type==="checkbox"||Ze.type==="radio"?Ze.checked&&Ve.append(Ze.name,Ze.value):(Oe=Ze.type==="textarea"?pe(Ze.value):Ze.value,Ve.append(Ze.name,Oe))})};if((r=vn.prototype).append=function(Re,Ve,Ze){ue(arguments,2),this.i.push(fe(Re,Ve,Ze))},r.delete=function(Re){ue(arguments,1);var Ve=[];Re=String(Re),ce(this.i,function(Ze){Ze[0]!==Re&&Ve.push(Ze)}),this.i=Ve},r.entries=function Re(){var Ve,Ze=this;return te(Re,function(Oe){if(Oe.h==1&&(Ve=0),Oe.h!=3)return Ve<Ze.i.length?Oe=L(Oe,Ze.i[Ve]):(Oe.h=0,Oe=void 0),Oe;Ve++,Oe.h=2})},r.forEach=function(Re,Ve){ue(arguments,1);for(var Ze=y(this),Oe=Ze.next();!Oe.done;Oe=Ze.next()){var B=y(Oe.value);Oe=B.next().value,B=B.next().value,Re.call(Ve,B,Oe,this)}},r.get=function(Re){ue(arguments,1);var Ve=this.i;Re=String(Re);for(var Ze=0;Ze<Ve.length;Ze++)if(Ve[Ze][0]===Re)return Ve[Ze][1];return null},r.getAll=function(Re){ue(arguments,1);var Ve=[];return Re=String(Re),ce(this.i,function(Ze){Ze[0]===Re&&Ve.push(Ze[1])}),Ve},r.has=function(Re){ue(arguments,1),Re=String(Re);for(var Ve=0;Ve<this.i.length;Ve++)if(this.i[Ve][0]===Re)return!0;return!1},r.keys=function Re(){var Ve,Ze,Oe,B,le=this;return te(Re,function(he){if(he.h==1&&(Ve=y(le),Ze=Ve.next()),he.h!=3)return Ze.done?void(he.h=0):(Oe=Ze.value,B=y(Oe),L(he,B.next().value));Ze=Ve.next(),he.h=2})},r.set=function(Re,Ve,Ze){ue(arguments,2),Re=String(Re);var Oe=[],B=fe(Re,Ve,Ze),le=!0;ce(this.i,function(he){he[0]===Re?le&&(le=!Oe.push(B)):Oe.push(he)}),le&&Oe.push(B),this.i=Oe},r.values=function Re(){var Ve,Ze,Oe,B,le=this;return te(Re,function(he){if(he.h==1&&(Ve=y(le),Ze=Ve.next()),he.h!=3)return Ze.done?void(he.h=0):(Oe=Ze.value,(B=y(Oe)).next(),L(he,B.next().value));Ze=Ve.next(),he.h=2})},vn.prototype._asNative=function(){for(var Re=new Se,Ve=y(this),Ze=Ve.next();!Ze.done;Ze=Ve.next()){var Oe=y(Ze.value);Ze=Oe.next().value,Oe=Oe.next().value,Re.append(Ze,Oe)}return Re},vn.prototype._blob=function(){var Re="----formdata-polyfill-"+Math.random(),Ve=[],Ze="--"+Re+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(Oe,B){return typeof Oe=="string"?Ve.push(Ze+bn(pe(B))+`"\r
\r
`+pe(Oe)+`\r
`):Ve.push(Ze+bn(pe(B))+'"; filename="'+bn(Oe.name)+`"\r
Content-Type: `+(Oe.type||"application/octet-stream")+`\r
\r
`,Oe,`\r
`)}),Ve.push("--"+Re+"--"),new Blob(Ve,{type:"multipart/form-data; boundary="+Re})},vn.prototype[Symbol.iterator]=function(){return this.entries()},vn.prototype.toString=function(){return"[object FormData]"},Kt&&!Kt.matches&&(Kt.matches=Kt.matchesSelector||Kt.mozMatchesSelector||Kt.msMatchesSelector||Kt.oMatchesSelector||Kt.webkitMatchesSelector||function(Re){for(var Ve=(Re=(this.document||this.ownerDocument).querySelectorAll(Re)).length;0<=--Ve&&Re.item(Ve)!==this;);return-1<Ve}),Nt&&(vn.prototype[Nt]="FormData"),Ie){var Xi=ye.XMLHttpRequest.prototype.setRequestHeader;ye.XMLHttpRequest.prototype.setRequestHeader=function(Re,Ve){Xi.call(this,Re,Ve),Re.toLowerCase()==="content-type"&&(this.B=!0)},ye.XMLHttpRequest.prototype.send=function(Re){Re instanceof vn?(Re=Re._blob(),this.B||this.setRequestHeader("Content-Type",Re.type),Ie.call(this,Re)):Ie.call(this,Re)}}Me&&(ye.fetch=function(Re,Ve){return Ve&&Ve.body&&Ve.body instanceof vn&&(Ve.body=Ve.body._blob()),Me.call(this,Re,Ve)}),Gt&&(ye.navigator.sendBeacon=function(Re,Ve){return Ve instanceof vn&&(Ve=Ve._asNative()),Gt.call(this,Re,Ve)}),ye.FormData=vn}})();const Cb=()=>{const r=oe("AREAS");return r.length===0&&r.push(_n.GLOBAL),rc(r).call(r,(a,s,l)=>{const d=UK(s);return d?l===0?d:"".concat(a,",").concat(d):a},"")},UK=r=>r===_n.OVERSEA?"".concat(Ki.ASIA,",").concat(Ki.EUROPE,",").concat(Ki.AFRICA,",").concat(Ki.NORTH_AMERICA,",").concat(Ki.SOUTH_AMERICA,",").concat(Ki.OCEANIA):Ki[r],lOe=r=>{const a={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return r.map(s=>{const l=bT[s],d=Object.keys(l);d&&d.map(f=>{f!=="CODE"&&(a[f]=a[f].concat(l[f]))})}),a},IT={GLOBAL:{ASIA:[_n.CHINA,_n.JAPAN,_n.INDIA,_n.KOREA,_n.HKMC],EUROPE:[],NORTH_AMERICA:[_n.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},OT=Object.keys(IT[_n.GLOBAL]),wD=[_n.CHINA,_n.NORTH_AMERICA,_n.EUROPE,_n.ASIA,_n.JAPAN,_n.INDIA,_n.OCEANIA,_n.SOUTH_AMERICA,_n.AFRICA,_n.KOREA,_n.HKMC,_n.US],uOe=function(r,a){let s=[];if(Be(r).call(r,_n.GLOBAL)){const f=[_n.GLOBAL,_n.OVERSEA],m=Object.keys(bT);if(a===_n.GLOBAL)throw new Ee(ie.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(a===_n.CHINA)s=[_n.OVERSEA];else if(d=a,Be(OT).call(OT,d)){const y=(l=a,IT[_n.GLOBAL][l]||[]),_=[...f,a,...y];s=m.filter(S=>!Be(_).call(_,S))}else if(function(y){let _=!1;return OT.forEach(S=>{var x;Be(x=IT[_n.GLOBAL][S]).call(x,y)&&(_=!0)}),_}(a)){const y=function(S){let x;return OT.forEach(A=>{var I;Be(I=IT[_n.GLOBAL][A]).call(I,S)&&(x=A)}),x}(a),_=[...f,y,a];s=m.filter(S=>!Be(_).call(_,S))}else s=r;s=function(y){const _=[];return wD.forEach(S=>{Be(y).call(y,S)&&_.push(S)}),_.concat(y.filter(S=>!Be(wD).call(wD,S)))}(s)}else s=r;var l,d;return s};function FK(r){var a,s;if(!r&&Be(a=oe("AREAS")).call(a,_n.EXTENSIONS))return V.debug("update area from ap : reset"),void SD(yIe,!0);if(!Be(s=oe("AREAS")).call(s,_n.GLOBAL)||!r)return;let l=bT.EXTENSIONS;l&&(l={CODE:UK(_n.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(r,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(r,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(r,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(r,".agora.io"),"cds-ap-web-2-".concat(r,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(r,".agora.io"),"sua-ap-web-2-".concat(r,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(r,".agora.io"),"uap-ap-web-2-".concat(r,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(r,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(r,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(r,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(r,".agora.io")]},V.debug("update area from ap success: ".concat(r,",config is "),l),An("AREAS",[_n.EXTENSIONS],!0),Object.keys(l).map(d=>{d==="LOG_UPLOAD_SERVER"||d==="EVENT_REPORT_DOMAIN"||d==="EVENT_REPORT_BACKUP_DOMAIN"||d==="PROXY_SERVER_TYPE3"?An(d,l[d][0]):An(d,l[d])}))}function SD(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=it.reportApiInvoke(null,{name:Er.SET_AREA,options:r,tag:rr.TRACER});try{let l=[];if(typeof r=="string"&&(l=[r]),Array.isArray(r)&&(r.forEach(f=>{if(!Be(sK).call(sK,f))throw new Ee(ie.INVALID_PARAMS,"invalid area code")}),l=r),Object.prototype.toString.call(r)==="[object Object]"){const{areaCode:f,excludedArea:m}=r;if(!f)throw new Ee(ie.INVALID_PARAMS,"area code is needed");let y=f;typeof f=="string"&&(y=[f]),l=m?uOe(y,m):y}if(!a){if(nl.AREAS){const f=new Ee(ie.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return s.onError(f),void V.warning("setArea is prohibited because of config-distribute")}if(Be(l).call(l,_n.GLOBAL)&&oe("AREAS")===_n.EXTENSIONS){const f=new Ee(ie.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return s.onError(f),void V.warning("setArea is prohibited because of ap extensions")}}An("AREAS",l,a);const d=lOe(l);Object.keys(d).map(f=>{f==="LOG_UPLOAD_SERVER"||f==="EVENT_REPORT_DOMAIN"||f==="EVENT_REPORT_BACKUP_DOMAIN"||f==="PROXY_SERVER_TYPE3"?An(f,d[f][0]):An(f,d[f])}),V.debug("set area success:",l.join(","))}catch(l){throw s.onError(l),l}s.onSuccess()}function VK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function su(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?VK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):VK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let xD=1;function dOe(r,a,s,l,d){xD+=1;const f={sid:s.sid,command:"convergeAllocateEdge",uid:"666",appId:s.appId,ts:Math.floor(Date.now()/1e3),seq:xD,requestId:xD,version:xo,cname:s.cname},m={service_name:a,json_body:JSON.stringify(f)};let y,_,S=r[0];return tl(async()=>{y=Date.now();const x=await sl(S,{data:m,cancelToken:l,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_=Date.now()-y,x.code!==0){const L=new Ee(ie.UNEXPECTED_RESPONSE,"live streaming ap error, code"+x.code,{retry:!0,responseTime:_});throw V.error(L.toString()),L}const A=JSON.parse(x.json_body);if(A.code!==200){const L=new Ee(ie.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(A.code,", reason: ").concat(A.reason),{code:A.code,responseTime:_});throw V.error(L.toString()),L}if(!A.servers||A.servers.length===0){const L=new Ee(ie.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:A.code,responseTime:_});throw V.error(L.toString()),L}const I=function(L,K){return{addressList:L.servers.map($=>"wss://".concat($.address.replace(/\./g,"-"),".").concat(oe("WORKER_DOMAIN"),":").concat($.wss,"?serviceName=").concat(encodeURIComponent(K))),workerToken:L.workerToken,vid:L.vid}}(A,a);return oe("LIVE_STREAMING_ADDRESS")&&(I.addressList=oe("LIVE_STREAMING_ADDRESS")instanceof Array?oe("LIVE_STREAMING_ADDRESS"):[oe("LIVE_STREAMING_ADDRESS")]),su(su({},I),{},{responseTime:_})},(x,A)=>(it.apworkerEvent(s.sid,{success:!0,sc:200,serviceName:a,responseDetail:JSON.stringify(x.addressList),firstSuccess:A===0,responseTime:_,serverIp:r[A%r.length]}),!1),(x,A)=>(it.apworkerEvent(s.sid,{success:!1,sc:x.data&&x.data.code||200,serviceName:a,responseTime:_,serverIp:r[A%r.length]}),!!(x.code!==ie.OPERATION_ABORTED&&x.code!==ie.UNEXPECTED_RESPONSE||x.data&&x.data.retry)&&(S=r[(A+1)%r.length],!0)),d)}let TD=1;function BK(r,a,s,l){let{url:d,areaCode:f}=r;const{clientId:m,sid:y}=a,_=Date.now();let S;const x=a.role,[A,I]=RD(a,f,[Lr.CHOOSE_SERVER]);let L=Dr.networkState;return tl(async()=>{L&&Dr.networkState===As.OFFLINE&&Dr.onlineWaiter&&await He.race([Dr.onlineWaiter,Ti(l&&l.maxRetryTimeout||Gr.maxRetryTimeout)]),L=Dr.networkState;const{data:K,headers:$}=await sl(d,{data:A,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);S=$.http3==="1"?1:-1,it.reportResourceTiming(d,y),WK(K,d,a,_,[Lr.CHOOSE_SERVER],S);const G=wb(K,Lr.CHOOSE_SERVER);return CD(G),gD(G,d)},K=>(K&&it.joinChooseServer(y,{role:x,lts:_,succ:!0,csAddr:d,opid:I,serverList:K.gatewayAddrs.map($=>$.address),ec:null,cid:K.cid.toString(),uid:K.uid.toString(),csIp:K.csIp,unilbsServerIds:[Lr.CHOOSE_SERVER].toString(),isHttp3:S,corssRegionTagReq:a.apRequestDetail,corssRegionTagRes:K.res.detail&&K.res.detail[38]}),!1),K=>K.code!==ie.OPERATION_ABORTED&&(K.code===ie.CAN_NOT_GET_GATEWAY_SERVER?K.data.retry:(it.joinChooseServer(y,{role:x,lts:_,succ:!1,csAddr:d,serverList:null,opid:I,ec:K.code,csIp:K.data&&K.data.csIp,unilbsServerIds:[Lr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:L}),isHttp3:S,corssRegionTagReq:a.apRequestDetail}),V.warning("[".concat(m||"sid-".concat(y.slice(0,6)),"] Choose server network error, retry"),K),!0)),l)}function $K(r,a,s,l){let d,{url:f,areaCode:m,serviceIds:y}=r;const _=Date.now(),S=a.role,[x,A]=RD(a,m,y);let I;return tl(async()=>{I&&Dr.networkState===As.OFFLINE&&Dr.onlineWaiter&&await He.race([Dr.onlineWaiter,Ti(l&&l.maxRetryTimeout||Gr.maxRetryTimeout)]),I=Dr.networkState;const{data:L,headers:K}=await sl(f,{data:x,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);d=K.http3==="1"?1:-1,it.reportResourceTiming(f,a.sid),WK(L,f,a,_,y,d);const $=wb(L,Lr.CHOOSE_SERVER),G=wb(L,a.cloudProxyServer==="proxy5"?Lr.CLOUD_PROXY_5:a.cloudProxyServer==="proxy3"||a.cloudProxyServer==="proxy4"?Lr.CLOUD_PROXY:Lr.CLOUD_PROXY_FALLBACK),ne=performance.getEntriesByName(f),te=ne[ne.length-1];let ce;return te&&(ce={name:te.name,protocol:"nextHopProtocol"in te?te.nextHopProtocol:"",dnscost:"domainLookupEnd"in te&&"domainLookupStart"in te&&typeof te.domainLookupEnd=="number"&&typeof te.domainLookupStart=="number"?te.domainLookupEnd-te.domainLookupStart:-1,tcpTlsCost:"connectEnd"in te&&"connectStart"in te&&typeof te.connectEnd=="number"&&typeof te.connectStart=="number"?te.connectEnd-te.connectStart:-1,reqCost:"requestStart"in te&&typeof te.requestStart=="number"&&"responseEnd"in te&&typeof te.responseEnd=="number"?te.responseEnd-te.requestStart:-1,handleCost:"leave_ts"in L&&"enter_ts"in L&&typeof L.leave_ts=="number"&&typeof L.enter_ts=="number"?L.leave_ts-L.enter_ts:-1}),CD($),{gatewayInfo:gD($,f),proxyInfo:G,url:f,resourceTimingInfo:ce}},L=>(L.gatewayInfo&&it.joinChooseServer(a.sid,{role:S,lts:_,succ:!0,csAddr:f,serverList:L.gatewayInfo.gatewayAddrs.map(K=>K.address),ec:null,opid:A,cid:L.gatewayInfo.cid.toString(),uid:L.gatewayInfo.uid.toString(),csIp:L.gatewayInfo.csIp,unilbsServerIds:y.toString(),isHttp3:d,corssRegionTagReq:a.apRequestDetail,corssRegionTagRes:L.gatewayInfo.res.detail&&L.gatewayInfo.res.detail[38],resourceTimingInfo:L.resourceTimingInfo?JSON.stringify(L.resourceTimingInfo):void 0}),L.proxyInfo&&it.joinWebProxyAP(a.sid,{lts:_,sucess:1,apServerAddr:f,turnServerAddrList:L.proxyInfo.addresses.map(K=>K.ip).join(","),errorCode:null,eventType:a.cloudProxyServer,unilbsServerIds:y.toString()}),!1),L=>L.code!==ie.OPERATION_ABORTED&&(L.code===ie.CAN_NOT_GET_GATEWAY_SERVER?L.data.retry:(it.joinWebProxyAP(a.sid,{lts:_,sucess:0,apServerAddr:f,turnServerAddrList:null,errorCode:L.code,eventType:a.cloudProxyServer,unilbsServerIds:y.toString(),extend:JSON.stringify({networkState:I})}),V.warning("[".concat(a.clientId,"] multi unilbs network error, retry"),L),!0)),l)}const WK=(r,a,s,l,d,f)=>{const{sid:m,clientId:y,cloudProxyServer:_}=s,S=[],x=A=>{A.flag===4096?it.joinChooseServer(m,{role:s.role,lts:l,succ:!1,csAddr:a,opid:r.opid,serverList:null,ec:A.error.message,csIp:A.error.data&&A.error.data.csIp,unilbsServerIds:d.toString(),isHttp3:f,corssRegionTagReq:s.apRequestDetail}):A.flag!==1048576&&A.flag!==4194304&&A.flag!==4194310||it.joinWebProxyAP(m,{lts:l,sucess:0,apServerAddr:a,turnServerAddrList:null,errorCode:A.error.code,eventType:_,unilbsServerIds:d.toString()})};if(r.response_body.forEach(A=>{const I=A.buffer.code;if(A.uri===23&&I===0&&!A.buffer.edges_services)if(A.buffer.flag===4194310)V.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),A.buffer.edges_services=[];else{const L={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:r.detail[502]}),flag:A.buffer.flag};S.push(L),x(L)}if(I!==0){const L=Mg(I),K={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,L.desc,{desc:L.desc,retry:L.retry,csIp:r.detail[502]}),flag:A.buffer.flag};A.buffer.flag===4194310?V.warning(K.error.toString()):S.push(K),x(K)}}),S.length)throw V.warning("[".concat(y||"sid-".concat(m.slice(0,6)),"] multi unilbs ").concat(a," failed, ").concat(S.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message,", retry: ").concat(A.error.data.retry)).join(" | "))),new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,S.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message)).join(" | "),{retry:!!S.find(A=>A.error.data.retry),csIp:r.detail[502],desc:[...new Set(S.map(A=>{var I;return A==null||(I=A.error)===null||I===void 0||(I=I.data)===null||I===void 0?void 0:I.desc}).filter(A=>!!A))]})},CD=r=>{var a,s,l,d;if(r.addresses&&r.addresses.length===0&&r.code===0)throw new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:r.detail&&r.detail[502]});if(oe("AP_AREA")&&((l=r.detail)!==null&&l!==void 0&&l[23]&&typeof((d=r.detail)===null||d===void 0?void 0:d[23])=="string"?FK(r.detail[23].toLowerCase()):FK()),(a=r.detail)!==null&&a!==void 0&&a[19]&&typeof((s=r.detail)===null||s===void 0?void 0:s[19])=="string"){const m=r.detail[19],y=m==null?void 0:m.split(";");for(let _=0;_<y.length;_++){var f;const S=Ea(f=y[_]).call(f);r.addresses[_]&&y&&(r.addresses[_].fingerprint=S)}}if(oe("GATEWAY_ADDRESS")&&oe("GATEWAY_ADDRESS").length>0){V.debug("assign gateway address to",oe("GATEWAY_ADDRESS"));const m=oe("GATEWAY_ADDRESS").map(y=>{var _,S;const x=(_=(S=r.addresses.find(A=>A.ip===y.ip&&A.port===y.port))===null||S===void 0?void 0:S.fingerprint)!==null&&_!==void 0?_:"";return{ip:y.ip,port:y.port,ticket:r.addresses[0]&&r.addresses[0].ticket,fingerprint:x}});r.addresses=m}},hOe=(r,a)=>{if(r.response_body&&r.response_body.length){const s=r.response_body[0];if(s.buffer.code!==0){const l=Mg(s.buffer.code);throw new Ee(ie.UPDATE_TICKET_FAILED,"[".concat(s.buffer.code,"]: ").concat(l.desc),{retry:l.retry})}return s.buffer.ticket}throw V.debug("update ticket request received ap response without response body:",a),new Ee(ie.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},RD=(r,a,s)=>{const l=Math.floor(Math.random()*1e12),d=r.role==="host"?"1":r.role==="audience"?"2":void 0,f={appid:r.appId,client_ts:Date.now(),opid:l,sid:r.sid,request_bodies:[{uri:22,buffer:{cname:r.cname,detail:su(su(su({6:r.stringUid,11:a,12:oe("USE_NEW_TOKEN")?"1":void 0},d?{17:d}:{}),{},{22:a},r.apRequestDetail?{33:r.apRequestDetail}:{}),r.apRTM?{26:"RTM2"}:{}),key:r.token,service_ids:s,uid:r.uid||0}}]};f.request_bodies.forEach(y=>{r.multiIP&&r.multiIP.gateway_ip&&(y.buffer.detail[5]=JSON.stringify({vocs_ip:[r.multiIP.uni_lbs_ip],vos_ip:[r.multiIP.gateway_ip]}))});const m=new FormData;return m.append("request",JSON.stringify(f)),[m,l]},fOe=(r,a)=>{const s=Math.floor(Math.random()*1e12),l={appid:r.appId,client_ts:Date.now(),opid:s,sid:r.sid,request_bodies:[{uri:28,buffer:{cname:r.cname,detail:{1:"",6:r.stringUid,12:"1"},token:r.token,service_ids:a,uid:r.uid||0,edges_services:r.apResponse.addresses.map(f=>({ip:f.ip,port:f.port}))}}]},d=new FormData;return d.append("request",JSON.stringify(l)),[d,s]};let Bg=0;function $g(r){return He.all(r.map(a=>a.then(s=>{throw s},s=>s))).then(a=>{throw a},a=>a)}const Rb=async r=>{let{fragementLength:a,referenceList:s,asyncMapHandler:l,allFailedhandler:d,promisesCollector:f}=r,m=0;const y=a;let _,S=0;const x=async()=>{const A=(()=>{const I=m*y,L=I+y;return s.slice(I,L).map(l)})();f&&f.push(...A);try{_=await $g(A)}catch(I){if(S+=y,m++,!(S>=s.length))return void await x();d(I)}A.forEach(I=>I.cancel())};return await x(),_},GK=async r=>{let{referenceList:a,asyncMapHandler:s,closeFn:l}=r;const d=a.length;let f=0;const m=async()=>{const y=s(a.shift());try{return await y}catch(_){if(f++,f>=d||l!=null&&l(_))throw _;return m()}};return m()};async function pOe(){if(typeof VideoDecoder>"u")return!0;let r;const a=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,85,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,149,160,133,4,144,43,122,168,159,120,159,205,39,82,131,57,52,87,187,68,23,248,134,204,226,97,17,49,183,55,236,219,249,221,98,208,215,190,59,179,167,213,47,1,246,150,14,194,245,159,83,35,64,103,218,38,21,82,3,135,21,185,84,248,134],s=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,148,62,134,140,92,172,141,77,35,94,181,164,65,169,65,156,154,43,221,162,11,252,67,102,113,48,136,137,219,62,43,113,239,23,126,250,186,252,10,138,218,25,193,244,74,68,194,209,107,23,52,206,199,78,72,98,103,151,71,96,62,51,210,158,72,231,158],l=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,143,233,163,51,196,98,95,151,224,22,134,33,240,150,248,67,18,34,196,142,81,238,173,140,80,205,232,132,144,67,12,131,157,4,171,243,86,122,35,6,166,184,243,85,126,13,206,103,152,62,168,160,187,2,241,138,52,211,72,121,128,151,63,147,128,19,42],d=[18,0,50,138,1,48,192,64,253,248,65,17,67,192,32,0,16,0,0,0,0,0,0,0,195,12,48,144,64,32,0,209,75,61,9,204,25,115,79,226,115,63,63,208,70,210,220,153,126,241,237,37,107,195,153,1,99,112,230,189,209,169,130,10,11,22,167,215,159,205,197,7,183,162,26,48,254,141,134,103,32,16,235,45,1,15,18,119,169,110,206,251,51,115,202,60,148,1,46,39,109,25,28,86,168,15,77,211,239,2,58,43,146,26,230,184,81,48,140,226,226,250,222,146,171,133,164,13,188,180,64,122,142,146,32,208,238,170,193,35,53,44,225],f=[18,0,50,107,48,0,133,125,248,65,26,195,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,204,24,122,65,56,165,18,52,206,218,4,187,51,97,9,29,191,90,253,106,185,31,197,155,52,205,245,185,203,131,20,226,25,124,95,113,220,113,141,15,15,104,211,144,152,237,150,157,127,51,143,24,231,218,171,255,176,241,128,229,149,150,148,66,245,228,91,27,182,228,136,61,182,237,133,45,220,24,103,214,152],m=[18,0,50,122,48,1,9,253,248,65,26,67,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,198,182,231,242,220,235,163,140,12,36,36,166,46,132,210,4,71,23,218,132,27,30,17,45,244,79,31,243,195,136,100,169,76,88,142,85,204,217,121,168,29,163,198,17,251,223,73,12,212,244,139,123,151,179,75,216,96,208,136,40,229,42,59,149,10,116,228,85,99,93,221,108,255,140,248,20,30,167,122,109,206,164,108,197,110,251,23,243,133,160,63,13,207,177,12,128];return await new He((_,S)=>{let x;(async function(){r&&r.state!=="closed"||await async function(){r=new VideoDecoder({output:I=>{I.close(),clearTimeout(x),_(!0)},error:I=>{clearTimeout(x),_(!1)}}),await r.configure({codec:"av01.0.05M.08",width:160,height:90})}();const A=[a,s,l,d,f,m];for(let I=0;I<A.length;I++){const L=new EncodedVideoChunk({type:I==0?"key":"delta",timestamp:33333*I,duration:33333,data:new Uint8Array(A[I])});try{await r.decode(L)}catch{return void _(!1)}}})(),x=setTimeout(()=>{_(!1)},5e3)})}async function ND(r,a,s,l){return{gatewayInfo:await async function(f,m,y,_){let S=null;const x=[],A=async()=>{const L=oe("WEBCS_DOMAIN").slice(0,oe("AJAX_REQUEST_CONCURRENT")).map(G=>({url:f.proxyServer?"https://".concat(f.proxyServer,"/ap/?url=").concat(G+"/api/v2/transpond/webrtc?v=2"):"https://".concat(G,"/api/v2/transpond/webrtc?v=2"),areaCode:Cb()})),K=_.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Rb({fragementLength:oe("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(V.debug("[".concat(f.clientId,"] Connect to choose_server:"),G.url),BK(G,f,m,y)),allFailedhandler:G=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},K),G[0]},promisesCollector:x});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},K),$},I=async()=>{if(await Ti(1e3),S!==null)return S;const L=oe("WEBCS_DOMAIN_BACKUP_LIST").map(G=>({url:f.proxyServer?"https://".concat(f.proxyServer,"/ap/?url=").concat(G+"/api/v2/transpond/webrtc?v=2"):"https://".concat(G,"/api/v2/transpond/webrtc?v=2"),areaCode:Cb()})),K=_.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Rb({fragementLength:oe("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(V.debug("[".concat(f.clientId,"] Connect to backup choose_server:"),G.url),BK(G,f,m,y)),allFailedhandler:G=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},K),G[0]},promisesCollector:x});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},K),$};try{return S=await $g([A(),I()]),x.length&&x.forEach(L=>L.cancel&&typeof L.cancel=="function"&&L.cancel()),S}catch(L){throw L[0]}}(r,a,s,l)}}async function HK(r,a,s,l,d){const f=r.cloudProxyServer;if(f==="disabled"){if(r.useLocalAccessPoint)return await ND(r,a,s,d);if(oe("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:I,proxyInfo:L}=await qK(r,a,s,d);if(r.turnServer&&r.turnServer.mode!=="auto")return{gatewayInfo:I};const K=L.map($=>({turnServerURL:$.address,tcpport:$.tcpport||Mi.tcpport,udpport:$.udpport||Mi.udpport,username:$.username||Mi.username,password:$.password||Mi.password,forceturn:!1,security:!0}));if(d.useP2P){var m;const $=(m=r.uid)!==null&&m!==void 0?m:I.uid,G="glb:".concat($.toString()),ne=await vj(G),te=L.map(ce=>({turnServerURL:ce.address,tcpport:ce.tcpport||Mi.tcpport,udpport:ce.udpport||Mi.udpport,username:G,password:ne,forceturn:!1,security:!0}));K.push(...te)}return r.turnServer={mode:"manual",servers:K},{gatewayInfo:I}}return await ND(r,a,s,d)}const{proxyInfo:y,gatewayInfo:_}=await qK(r,a,s,d),S={gatewayInfo:_},x=y.map(I=>({turnServerURL:I.address,tcpport:f==="proxy3"?void 0:I.tcpport?I.tcpport:Mi.tcpport,udpport:f==="proxy4"?void 0:I.udpport?I.udpport:Mi.udpport,username:I.username||Mi.username,password:I.password||Mi.password,forceturn:f!=="proxy4",security:f==="proxy5"}));if(d.useP2P){var A;const I=(A=r.uid)!==null&&A!==void 0?A:_.uid,L="glb:".concat(I.toString()),K=await vj(L),$=y.map(G=>({turnServerURL:G.address,tcpport:f==="proxy3"?void 0:G.tcpport||Mi.tcpport,udpport:f==="proxy4"?void 0:G.udpport||Mi.udpport,username:L,password:K,forceturn:f!=="proxy4",security:f==="proxy5"}));x.push(...$)}return r.turnServer={mode:"manual",servers:x},V.debug("[".concat(r.clientId,"] set proxy server: ").concat(r.proxyServer,", mode: ").concat(f)),S}async function zK(r,a,s,l,d){const f=oe("ACCOUNT_REGISTER").slice(0,oe("AJAX_REQUEST_CONCURRENT"));let m=[];m=a.proxyServer?f.map(_=>"https://".concat(a.proxyServer,"/ap/?url=").concat(_+"/api/v1")):f.map(_=>"https://".concat(_,"/api/v1"));const y=d==null?void 0:d.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:m});try{const _=await async function(S,x,A,I,L){const K=Date.now(),$={sid:A.sid,opid:10,appid:A.appId,string_uid:x};let G=S[0];const ne=await tl(()=>sl(G+"".concat(G.indexOf("?")===-1?"?":"&","action=stringuid"),{data:$,cancelToken:I,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(te,ce)=>{if(te.code===0){if(te.uid<=0||te.uid>=Math.pow(2,32))throw V.error("Invalid Uint Uid ".concat(x," => ").concat(te.uid),te),it.reqUserAccount($.sid,{lts:K,success:!1,serverAddr:G,stringUid:$.string_uid,uid:te.uid,errorCode:ie.INVALID_UINT_UID_FROM_STRING_UID,extend:$}),new Ee(ie.INVALID_UINT_UID_FROM_STRING_UID);return it.reqUserAccount($.sid,{lts:K,success:!0,serverAddr:G,stringUid:$.string_uid,uid:te.uid,errorCode:null,extend:$}),!1}const pe=Mg(te.code);return pe.retry&&(G=S[(ce+1)%S.length]),it.reqUserAccount($.sid,{lts:K,success:!1,serverAddr:G,stringUid:$.string_uid,uid:te.uid,errorCode:pe.desc,extend:$}),pe.retry},(te,ce)=>te.code!==ie.OPERATION_ABORTED&&(it.reqUserAccount($.sid,{lts:K,success:!1,serverAddr:G,stringUid:$.string_uid,uid:null,errorCode:te.code,extend:$}),G=S[(ce+1)%S.length],!0),L);if(ne.code!==0){const te=Mg(ne.code);throw new Ee(ie.UNEXPECTED_RESPONSE,te.desc)}return ne}(m,r,a,s,l);return d==null||d.recordJoinChannelService({status:"success",endTs:Date.now()},y),_.uid}catch(_){throw d==null||d.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_]},y),_}}async function mOe(r,a,s){const l=oe("ACCOUNT_REGISTER");let d=[];d=a.proxyServer?l.map(f=>"https://".concat(a.proxyServer,"/ap/?url=").concat(f+"/api/v1")):l.map(f=>"https://".concat(f,"/api/v1"));try{return await GK({referenceList:d,asyncMapHandler:m=>async function(y,_,S,x){const A=Date.now(),I={sid:S.sid,opid:10,appid:S.appId,string_uid:_};try{const L=await sl(y+"".concat(y.indexOf("?")===-1?"?":"&","action=stringuid"),{data:I,cancelToken:x,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(L.code!==0){const K=Mg(L.code);throw new Ee(ie.UNEXPECTED_RESPONSE,"preload sua error:".concat(K.desc),K)}if(L.uid<=0||L.uid>=Math.pow(2,32))throw new Ee(ie.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:A,url:y,req:I,uid:L.uid,elapse:Date.now()-A}}catch(L){throw L}}(m,r,a,s),closeFn:m=>m.code===ie.OPERATION_ABORTED||m.code===ie.UNEXPECTED_RESPONSE&&!m.data.retry})}catch(f){throw f}}async function gOe(r,a,s){const l=oe("CDS_AP").slice(0,oe("AJAX_REQUEST_CONCURRENT")).map(_=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(_+"/api/v1"):"https://".concat(_,"/api/v1?action=config")),d=l.map(_=>function(S,x,A,I){const L=an(),K={flag:64,cipher_method:0,features:su(su(su(su(su({install_id:Nj(),device:L.name,system:L.os,system_general:navigator.userAgent,vendor:x.appId,version:xo,cname:x.cname,session_id:x.sid,proxyServer:x.proxyServer,sdk_type:sOe.WEB_RTC,browser_name:L.name,browser_version:L.version,user_agent:navigator.userAgent,channel_name:x.cname},x.stringUid&&{string_uid:x.stringUid}),x.uid&&{uid:x.uid+""}),L.os&&{os_name:L.os}),L.osVersion&&{os_version:L.osVersion}),{},{detail:""})};return tl(()=>sl(S,{data:K,timeout:1e3,cancelToken:A,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,$=>$.code!==ie.OPERATION_ABORTED,I)}(_,r,a,s));let f=null,m=null,y={};try{f=await $g(d)}catch(_){if(_.code===ie.OPERATION_ABORTED)throw _;m=_}if(d.forEach(_=>_.cancel()),it.reportApiInvoke(r.sid,{name:Er.REQUEST_CONFIG_DISTRIBUTE,options:{error:m,res:f}}).onSuccess(),f&&f.test_tags)try{y=function(_){if(!_.test_tags)return{};const S=_.test_tags,x=Object.keys(S),A={};return x.forEach(I=>{var L;const K=Ea(L=I.slice(4)).call(L),$=JSON.parse(S[I]),G=$[1];A[K]={tag:$[0]||"",value:G}}),A}(f)}catch{}return y}async function KK(r,a){const s=oe("WEBCS_DOMAIN").concat(oe("WEBCS_DOMAIN_BACKUP_LIST")).map(l=>({url:"https://".concat(l,"/api/v2/transpond/webrtc?v=2"),areaCode:Cb(),serviceIds:[Lr.CHOOSE_SERVER,Lr.CLOUD_PROXY_FALLBACK]}));try{return await GK({referenceList:s,asyncMapHandler:d=>async function(f,m,y){let _,{url:S,areaCode:x,serviceIds:A}=f;const I=Date.now(),[L,K]=RD(m,x,A);let $=Dr.networkState;try{$&&Dr.networkState===As.OFFLINE&&Dr.onlineWaiter&&await He.race([Dr.onlineWaiter,Ti(Gr.maxRetryTimeout)]),$=Dr.networkState;const{data:G,headers:ne}=await sl(S,{data:L,cancelToken:y,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_=ne.http3==="1"?1:-1,(fe=>{const ue=[];if(fe.response_body.forEach(ye=>{const Se=ye.buffer.code;if(ye.uri===23&&Se===0&&!ye.buffer.edges_services)if(ye.buffer.flag===4194310)ye.buffer.edges_services=[];else{const Ie={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:fe.detail[502]}),flag:ye.buffer.flag};ue.push(Ie)}if(Se!==0){const Ie=Mg(Se),Me={error:new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,Ie.desc,{desc:Ie.desc,retry:Ie.retry,csIp:fe.detail[502]}),flag:ye.buffer.flag};ye.buffer.flag===4194310?V.warning(Me.error.toString()):ue.push(Me)}}),ue.length)throw new Ee(ie.CAN_NOT_GET_GATEWAY_SERVER,ue.map(ye=>"flag: ".concat(ye.flag,", message: ").concat(ye.error.message)).join(" | "),{retry:!!ue.find(ye=>ye.error.data.retry),csIp:fe.detail[502],desc:[...new Set(ue.map(ye=>{var Se;return ye==null||(Se=ye.error)===null||Se===void 0||(Se=Se.data)===null||Se===void 0?void 0:Se.desc}).filter(ye=>!!ye))]})})(G);const ce=wb(G,Lr.CHOOSE_SERVER),pe=wb(G,Lr.CLOUD_PROXY_FALLBACK);return CD(ce),{gatewayInfo:gD(ce,S),proxyInfo:pe,opid:K,requestTime:I,url:S,isHttp3:_,elapse:Date.now()-I}}catch(G){throw G}}(d,r,a),closeFn:d=>d.code===ie.OPERATION_ABORTED||d.code===ie.CAN_NOT_GET_GATEWAY_SERVER&&!d.data.retry})}catch(l){throw l}}async function qK(r,a,s,l){const d=oe("PROXY_SERVER_TYPE3"),f=(L,K,$)=>{let G=$||d;return Array.isArray(G)&&(G=K%2==0&&d[1]||d[0]),"https://".concat(G,"/ap/?url=").concat(L)};let m=null;const y=[],_=async()=>{const L=oe("WEBCS_DOMAIN").slice(0,oe("AJAX_REQUEST_CONCURRENT")).map((G,ne)=>{let te;return te=r.cloudProxyServer==="disabled"&&r.proxyServer?f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne,r.proxyServer):r.cloudProxyServer==="disabled"||r.cloudProxyServer==="fallback"?"https://".concat(G,"/api/v2/transpond/webrtc?v=2"):f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne),{url:te,areaCode:Cb(),serviceIds:[Lr.CHOOSE_SERVER,r.cloudProxyServer==="proxy5"?Lr.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Lr.CLOUD_PROXY:Lr.CLOUD_PROXY_FALLBACK]}}),K=l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Rb({fragementLength:oe("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(V.debug("[".concat(r.clientId,"] Connect to choose_server:"),G.url),$K(G,r,a,s)),allFailedhandler:G=>{throw l.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},K),G[0]},promisesCollector:y});return l.recordJoinChannelService({endTs:Date.now(),status:"success"},K),$},S=async()=>{if(await Ti(1e3),m!==null)return m;const L=oe("WEBCS_DOMAIN_BACKUP_LIST").map((G,ne)=>{let te;return te=r.cloudProxyServer==="disabled"&&r.proxyServer?f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne,r.proxyServer):r.cloudProxyServer==="disabled"||r.cloudProxyServer==="fallback"?"https://".concat(G,"/api/v2/transpond/webrtc?v=2"):f("".concat(G,"/api/v2/transpond/webrtc?v=2"),ne),{url:te,areaCode:Cb(),serviceIds:[Lr.CHOOSE_SERVER,r.cloudProxyServer==="proxy5"?Lr.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Lr.CLOUD_PROXY:Lr.CLOUD_PROXY_FALLBACK]}}),K=l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:L.map(G=>G.url)}),$=await Rb({fragementLength:oe("FRAGEMENT_LENGTH"),referenceList:L,asyncMapHandler:G=>(V.debug("[".concat(r.clientId,"] Connect to backup choose_server:"),G.url),$K(G,r,a,s)),allFailedhandler:G=>{throw l.recordJoinChannelService({endTs:Date.now(),status:"error",errors:G},K),G[0]},promisesCollector:y});return l.recordJoinChannelService({endTs:Date.now(),status:"success"},K),$};let x,A,I;try{({gatewayInfo:x,proxyInfo:A,url:I}=await $g([_(),S()]))}catch(L){throw L[0]}if(y.length&&y.forEach(L=>L.cancel&&typeof L.cancel=="function"&&L.cancel()),!x||!A)throw new Ee(ie.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(r.apUrl=I,r.cloudProxyServer!=="disabled"&&Array.isArray(d)&&I){const L=/^https?:\/\/(.+?)(\/.*)?$/.exec(I)[1];Be(d).call(d,L)&&(r.proxyServer=L,V.setProxyServer(L),it.setProxyServer(L))}return m={gatewayInfo:x,proxyInfo:await yK(A,x.uid)},m}async function vOe(r,a,s){const l=oe("UAP_AP").slice(0,oe("AJAX_REQUEST_CONCURRENT")).map(f=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(f+"/api/v1?action=uap"):"https://".concat(f,"/api/v1?action=uap")),d=l.map(f=>function(m,y,_,S){const x={command:"convergeAllocateEdge",sid:y.sid,appId:y.appId,token:y.token,ts:Date.now(),version:xo,cname:y.cname,uid:y.uid.toString(),requestId:TD,seq:TD};TD+=1;const A={service_name:"tele_channel",json_body:JSON.stringify(x)};return tl(async()=>{const I=await sl(m,{data:A,cancelToken:_,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(I.code!==0){const K=new Ee(ie.UNEXPECTED_RESPONSE,"cross channel ap error, code"+I.code,{retry:!0});throw V.error(K.toString()),K}const L=JSON.parse(I.json_body);if(L.code!==200){const K=new Ee(ie.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(L.code,", reason: ").concat(L.reason));throw V.error(K.toString()),K}if(!L.servers||L.servers.length===0){const K=new Ee(ie.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw V.error(K.toString()),K}return{vid:L.vid,workerToken:L.workerToken,addressList:(oe("CHANNEL_MEDIA_RELAY_SERVERS")||L.servers).map(K=>"wss://".concat(K.address.replace(/\./g,"-"),".").concat(oe("WORKER_DOMAIN"),":").concat(K.wss))}},void 0,I=>!!(I.code!==ie.OPERATION_ABORTED&&I.code!==ie.UNEXPECTED_RESPONSE||I.data&&I.data.retry),S)}(f,r,a,s));try{const f=await $g(d);return d.forEach(m=>m.cancel()),f}catch(f){throw f[0]}}async function yOe(r,a,s){let l=null;const d=[],f=async m=>{const y=oe(m?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(_+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_,"/api/v2/transpond/webrtc?v=2"));return m&&(await Ti(1e3),l!==null)?l:await Rb({fragementLength:oe("FRAGEMENT_LENGTH"),referenceList:y,asyncMapHandler:_=>(V.debug("[".concat(r.clientId,"] update ticket, Connect to ").concat(m?"backup":""," choose_server:"),_),function(S,x,A,I){const[L]=fOe(x,[Lr.CHOOSE_SERVER]);let K=Dr.networkState;return tl(async()=>{K&&Dr.networkState===As.OFFLINE&&Dr.onlineWaiter&&await He.race([Dr.onlineWaiter,Ti(I&&I.maxRetryTimeout||Gr.maxRetryTimeout)]),K=Dr.networkState;const $=await sl(S,{data:L,cancelToken:A,headers:{"Content-Type":"multipart/form-data;"}},!0);return hOe($,S)},()=>!1,$=>$.code!==ie.OPERATION_ABORTED&&($.code===ie.UPDATE_TICKET_FAILED?$.data.retry:(V.warning("[".concat(x.clientId,"] update ticket network error, retry"),$),!0)),I)}(_,r,a,s)),allFailedhandler:_=>{throw _[0]},promisesCollector:d})};try{return l=await $g([f(!1),f(!0)]),d.length&&d.forEach(m=>m.cancel&&typeof m.cancel=="function"&&m.cancel()),l}catch(m){throw m[0]}}function YK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function AD(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?YK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):YK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class _Oe extends cr{get isSuccess(){return!!this.configs}constructor(a,s){super(),Q(this,"configs",void 0),Q(this,"store",void 0),Q(this,"joinInfo",void 0),Q(this,"cancelToken",void 0),Q(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),Q(this,"interval",void 0),Q(this,"mutex",void 0),Q(this,"mutableParamsRead",!1),Q(this,"configCache",{}),Q(this,"limit_bitrate",void 0),this.mutex=new Hi("config-distribute",a),this.store=s}startGetConfigDistribute(a,s){this.joinInfo=a,this.cancelToken=s,this.interval&&this.stopGetConfigDistribute(),oe("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},oe("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,it.reportApiInvoke(null,{options:void 0,name:Er.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:rr.TRACER}).onSuccess(JSON.stringify(nl))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void V.debug("[config-distribute] get config distribute interrupted have no joininfo");let a;const s=await this.mutex.lock();try{a=await gOe(this.joinInfo,this.cancelToken,this.retryConfig),V.debug("[config-distribute] get config distribute",JSON.stringify(a));const l=function(d){var f;const m=Yf(f=Object.keys(d).filter(S=>/^webrtc_ng_global_parameter/.test(S))).call(f);for(let S=0;S<m.length;S++)for(let x=m.length-1;x>S;x--){const A=m[x],I=d[A].value;if(typeof I.__priority=="number"){const L=I.__priority,K=m[x-1],$=d[K].value;if(typeof $.__priority=="number"){if(!(L>$.__priority))continue;{const G=A;m[x]=m[x-1],m[x-1]=G}}else{const G=A;m[x]=m[x-1],m[x-1]=G}}}const y=Date.now();let _={};return m.forEach(S=>{const x=d[S].value.__expires;x&&x<=y||(_[S]=d[S])}),_}(a);this.cacheGlobalParameterConfig(l),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=l}catch(l){const d=new Ee(ie.NETWORK_RESPONSE_ERROR,l);V.warning("[config-distribute] ".concat(d.toString()))}finally{s()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(a){oK(a)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==a.id&&this.emit(_b.UPDATE_BITRATE_LIMIT,a):this.emit(_b.UPDATE_BITRATE_LIMIT,a))}getLowStreamConfigDistribute(){return this.limit_bitrate&&AD({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(a){try{const s={},l=Object.keys(a),d=[];l.forEach(f=>{const m=a[f].value;s[f]=m;const y=m.__id;if(y&&this.configCache[f]&&this.configCache[f].__id===y)return;const _=m.__type,S=a[f].value,x=a[f].tag;let A=0;_?_===Oz.REALTIME&&(A=1):Object.keys(S).some(I=>Object.prototype.hasOwnProperty.call(Pj,I)||!aD()&&Object.prototype.hasOwnProperty.call(Zx,I)?(A=1,!0):void 0),d.push({tag:x,isApplied:A,feature:f,params:JSON.stringify(m)})}),d.forEach(f=>{let{tag:m,feature:y,params:_,isApplied:S}=f;this.store.sessionId&&it.abTest(this.store.sessionId,{intSucc:1,isApplied:S,tag:m,feature:y,params:_,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=s}catch(s){V.debug("handleABTestConfigDistribute error",s)}}cacheGlobalParameterConfig(a){const s=function(d){const f={};return Object.keys(d).forEach(m=>{const y=d[m].value,_=y.__expires,S=y.__type;Object.keys(y).forEach(x=>{x==="__id"||x==="__type"||x==="__priority"||x==="__expires"||Object.prototype.hasOwnProperty.call(f,x)||(f[x]=AD(AD({value:y[x]},_&&{expires:_}),S&&{type:S}))})}),f}(a);try{var l;const d=(l=s.LIMIT_BITRATE)===null||l===void 0?void 0:l.value;delete s.LIMIT_BITRATE,d&&oK(d)&&this.handleBitrateLimit(d),this.limit_bitrate=d,this.handleGlobalParameterConfig(s),this.handleABTestConfigDistribute(a),function(y){try{const _=Date.now();Object.keys(y).forEach(S=>{const{value:x,type:A,expires:I}=y[S];I&&I<=_||((A===Oz.REALTIME||Object.prototype.hasOwnProperty.call(Pj,S))&&(nl[S]=x,Zn[S]=x,V.debug("Update realtime parameters from config distribute",S,x)),A||aD()||!Object.prototype.hasOwnProperty.call(Zx,S)||(nl[S]=x,Zn[S]=x,V.debug("Update gateway parameters from config distribute",S,x)))})}catch(_){V.error("Error update config immediately: ".concat(y),_.message)}}(s);const f=JSON.stringify(s),m=window.btoa(f);window.localStorage.setItem("websdk_ng_global_parameter",m),V.debug("Caching global parameters ".concat(f))}catch(d){V.error("Error caching global parameters:",d.message)}}handleGlobalParameterConfig(a){try{const s=Date.now();Object.keys(a).forEach(l=>{if(l==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(Zn,l)){const{value:d,expires:f}=a[l];if(f&&f<=s)return;(function(m,y){try{return typeof m=="object"&&typeof y=="object"&&JSON.stringify(m)===JSON.stringify(y)}catch{return!1}})(Zn[l],d)||(nl[l]=d,Zn[l]=d,this.emit(_b.UPDATE_CLIENT_ROLE_OPTIONS,d),V.debug("Updating client role options: ".concat(JSON.stringify(d))))}})}catch(s){V.error("Error handling global parameter config:",s.message)}}}class bOe extends cr{constructor(){super(...arguments),Q(this,"resultStorage",new Map)}setLocalAudioStats(a,s,l){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",a,this.checkAudioInputLevel(l,s)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",a,this.checkSendAudioBitrate(l,s))}setLocalVideoStats(a,s,l){this.record("SEND_VIDEO_BITRATE_TOO_LOW",a,this.checkSendVideoBitrate(l,s)),this.record("FRAMERATE_INPUT_TOO_LOW",a,this.checkFramerateInput(l,s)),this.record("FRAMERATE_SENT_TOO_LOW",a,this.checkFramerateSent(l)),!s.muted&&this.record("VIDEO_ENCODE_FAILED",a,this.checResolutionSent(l))}setRemoteAudioStats(a,s){const l=a.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",l,this.checkAudioOutputLevel(s))}setRemoteVideoStats(a,s){const l=a.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",l,this.checkVideoDecode(s))}record(a,s,l){if(oe("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(a)||this.resultStorage.set(a,{result:[],isPrevNormal:!0});const d=this.resultStorage.get(a);if(!d)return;d.result.push(l);const f=a==="VIDEO_ENCODE_FAILED"?oe("ENCODE_EXCEPTION_TIMES"):5;if(d.result.length>=f){var m;const y=Be(m=d.result).call(m,!0);d.isPrevNormal&&!y&&this.emit("exception",ID[a],a,s),!d.isPrevNormal&&y&&this.emit("exception",ID[a]+2e3,a+"_RECOVER",s),d.isPrevNormal=y,d.result=[]}}checkAudioOutputLevel(a){return!(a.receiveBitrate>0&&a.receiveLevel===0)}checkAudioInputLevel(a,s){return s instanceof Yr&&!s.isActive||!!s.muted||a.sendVolumeLevel!==0}checkFramerateInput(a,s){let l=null;s._encoderConfig&&s._encoderConfig.frameRate&&(l=Is(s._encoderConfig.frameRate));const d=a.captureFrameRate;return!l||!d||!(l>10&&d<5||l<10&&l>=5&&d<=1)}checkFramerateSent(a){return!(a.captureFrameRate&&a.sendFrameRate&&a.captureFrameRate>5&&a.sendFrameRate<=1)}checResolutionSent(a){var s;return!(!a.codecType||Be(s=oe("ENCODE_EXCEPTION_VALIDATE_CODEC")).call(s,a.codecType.toLocaleLowerCase()))||!a.captureFrameRate||a.sendFrameRate!==0||a.sendResolutionWidth!==0||a.sendResolutionHeight!==0}checkSendVideoBitrate(a,s){return!!s.muted||a.sendBitrate!==0}checkSendAudioBitrate(a,s){return s instanceof Yr&&!s.isActive||!!s.muted||a.sendBitrate!==0}checkVideoDecode(a){return a.receiveBitrate===0||a.decodeFrameRate!==0}}const ID={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003,VIDEO_ENCODE_FAILED:2004},Yi=new class{markSubscribeStart(r,a){performance.mark("agora-web-sdk/".concat(r,"/subscribe-").concat(a))}markPublishStart(r,a){performance.mark("agora-web-sdk/".concat(r,"/publish-").concat(a))}measureFromSubscribeStart(r,a){const s=performance.getEntriesByName("agora-web-sdk/".concat(r,"/subscribe-").concat(a));if(s.length>0){const l=s[s.length-1];return Math.round(performance.now()-l.startTime)}return 0}measureFromPublishStart(r,a){const s=performance.getEntriesByName("agora-web-sdk/".concat(r,"/publish-").concat(a));if(s.length>0){const l=s[s.length-1];return Math.round(performance.now()-l.startTime)}return 0}};function XK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function gp(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?XK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):XK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class Nb{constructor(a){Q(this,"store",void 0),Q(this,"onStatsException",void 0),Q(this,"onUploadPublishDuration",void 0),Q(this,"onStatsChanged",void 0),Q(this,"onVideoCodecChanged",void 0),Q(this,"localStats",new Map),Q(this,"remoteStats",new Map),Q(this,"updateStatsInterval",void 0),Q(this,"trafficStats",void 0),Q(this,"trafficStatsPeerList",[]),Q(this,"uplinkStats",void 0),Q(this,"exceptionMonitor",void 0),Q(this,"p2pChannel",void 0),Q(this,"scalabilityMode",Jx.L1T1),Q(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=a,this.exceptionMonitor=new bOe,this.exceptionMonitor.on("exception",(s,l,d)=>{this.onStatsException&&this.onStatsException(s,l,d)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(De.LocalAudioTrack)||gp({},Uj)}getLocalVideoTrackStats(){return this.localStats.get(De.LocalVideoTrack)||gp({},Fj)}getRemoteAudioTrackStats(a){const s=(f,m)=>{if(!this.trafficStats)return m;const y=this.trafficStats.peer_delay.find(_=>_.peer_uid===f);return y&&(m.publishDuration=y.B_ppad+(Date.now()-this.trafficStats.timestamp)),m},l={};if(a){var d;const f=(d=this.remoteStats.get(a))===null||d===void 0?void 0:d.audioStats;f&&(l[a]=s(a,f))}else Array.from(this.remoteStats.entries()).forEach(f=>{let[m,{audioStats:y}]=f;y&&(l[m]=s(m,y))});return l}getRemoteNetworkQualityStats(a){const s={};if(a){var l;const d=(l=this.remoteStats.get(a))===null||l===void 0?void 0:l.networkStats;d&&(s[a]=d)}else Array.from(this.remoteStats.entries()).forEach(d=>{let[f,{networkStats:m}]=d;m&&(s[f]=m)});return s}getRemoteVideoTrackStats(a){const s=(f,m)=>{if(!this.trafficStats)return m;const y=this.trafficStats.peer_delay.find(_=>_.peer_uid===f);return y&&(m.publishDuration=y.B_ppvd+(Date.now()-this.trafficStats.timestamp)),m},l={};if(a){var d;const f=(d=this.remoteStats.get(a))===null||d===void 0?void 0:d.videoStats;f&&(l[a]=s(a,f))}else Array.from(this.remoteStats.entries()).forEach(f=>{let[m,{videoStats:y}]=f;y&&(l[m]=s(m,y))});return l}getRTCStats(){let a=0,s=0,l=0,d=0;const f=this.localStats.get(De.LocalAudioTrack);f&&(a+=f.sendBytes,s+=f.sendBitrate);const m=this.localStats.get(De.LocalVideoTrack);m&&(a+=m.sendBytes,s+=m.sendBitrate);const y=this.localStats.get(De.LocalVideoLowTrack);y&&(a+=y.sendBytes,s+=y.sendBitrate),this.remoteStats.forEach(S=>{let{audioStats:x,videoStats:A}=S;x&&(l+=x.receiveBytes,d+=x.receiveBitrate),A&&(l+=A.receiveBytes,d+=A.receiveBitrate)});let _=1;return this.trafficStats&&(_+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_,SendBitrate:s,SendBytes:a,RecvBytes:l,RecvBitrate:d,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(a){this.localStats.set(a,void 0)}removeLocalStats(a){a?this.localStats.delete(a):this.localStats.clear()}addRemoteStats(a){this.remoteStats.set(a,{})}removeRemoteStats(a){a?this.remoteStats.delete(a):this.remoteStats.clear()}addP2PChannel(a){this.p2pChannel=a}updateTrafficStats(a){a.peer_delay=a.peer_delay.filter(s=>s.B_ppad!==void 0||s.B_ppvd!==void 0),a.peer_delay.filter(s=>this.trafficStatsPeerList.indexOf(s.peer_uid)===-1).forEach(s=>{var l;const d=(l=this.p2pChannel)===null||l===void 0?void 0:l.getRemoteMedia(s.peer_uid),f=d!=null&&d.videoSSRC?Yi.measureFromSubscribeStart(this.store.clientId,d.videoSSRC):0,m=d!=null&&d.audioSSRC?Yi.measureFromSubscribeStart(this.store.clientId,d.audioSSRC):0;s.B_ppad!==void 0&&s.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(s.peer_uid,s.B_ppad,s.B_ppvd,f>m?f:m),this.trafficStatsPeerList.push(s.peer_uid))}),this.trafficStats=a}updateUplinkStats(a){this.uplinkStats&&this.uplinkStats.B_fir!==a.B_fir&&V.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(a.B_fir)),this.uplinkStats=a}static isRemoteVideoFreeze(a,s,l){if(!a)return!1;const d=!!l&&s.framesDecodeFreezeTime>l.framesDecodeFreezeTime,f=!l||s.framesDecodeCount>l.framesDecodeCount;return d||!f}static isRemoteAudioFreeze(a){return!!a&&a._isFreeze()}isLocalVideoFreeze(a){return!(!a.inputFrame||!a.sentFrame)&&a.inputFrame.frameRate>5&&a.sentFrame.frameRate<3}updateLocalStats(a){Array.from(this.localStats.entries()).forEach(s=>{let[l,d]=s;switch(l){case De.LocalVideoTrack:case De.LocalVideoLowTrack:{const y=d,_=gp({},Fj),S=a.getStats(),x=a.getLocalMedia(l);if(S){const A=S.videoSend.find(I=>I.ssrc===(x==null?void 0:x.ssrcs[0].ssrcId));if(A){const I=a.getLocalVideoSize(),L=a.getEncoderConfig(De.LocalVideoTrack);var f;(A.codec==="H264"||A.codec==="H265"||A.codec==="VP8"||A.codec==="VP9"||A.codec==="AV1X"||A.codec==="AV1")&&(_.codecType=A.codec,(y==null?void 0:y.codecType)!==A.codec&&((f=this.onVideoCodecChanged)===null||f===void 0||f.call(this,A.codec.toLocaleLowerCase()))),_.sendBytes=A.bytes,_.sendBitrate=y?8*Math.max(0,_.sendBytes-y.sendBytes):0,A.inputFrame?(_.captureFrameRate=A.inputFrame.frameRate,_.captureResolutionHeight=A.inputFrame.height,_.captureResolutionWidth=A.inputFrame.width):I&&(_.captureResolutionWidth=I.width,_.captureResolutionHeight=I.height),A.sentFrame?(_.sendFrameRate=A.sentFrame.frameRate,_.sendResolutionHeight=A.sentFrame.height,_.sendResolutionWidth=A.sentFrame.width):I&&(_.sendResolutionWidth=I.width,_.sendResolutionHeight=I.height),A.avgEncodeMs&&(_.encodeDelay=A.avgEncodeMs),L&&L.bitrateMax?_.targetSendBitrate=1e3*L.bitrateMax:A.targetBitrate&&(_.targetSendBitrate=A.targetBitrate),_.sendPackets=A.packets,_.sendPacketsLost=A.packetsLost,_.sendJitterMs=A.jitterMs,_.sendRttMs=A.rttMs,_.totalDuration=y?y.totalDuration+1:1,_.totalFreezeTime=y?y.totalFreezeTime:0,this.isLocalVideoFreeze(A)&&(_.totalFreezeTime+=1),A.scalabilityMode&&this.scalabilityMode!==A.scalabilityMode&&(V.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(A.scalabilityMode)),this.scalabilityMode=A.scalabilityMode)}this.trafficStats&&(_.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var m;this.localStats.set(l,_),((y==null?void 0:y.sendResolutionWidth)!==_.sendResolutionWidth||(y==null?void 0:y.sendResolutionHeight)!==_.sendResolutionHeight)&&((m=this.onStatsChanged)===null||m===void 0||m.call(this,"resolution",{width:_.sendResolutionWidth,height:_.sendResolutionHeight})),_&&x&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,x.track,_);break}case De.LocalAudioTrack:{const y=d,_=gp({},Uj),S=a.getStats(),x=a.getLocalMedia(l);if(S){const A=S.audioSend.find(I=>I.ssrc===(x==null?void 0:x.ssrcs[0].ssrcId));if(A){if(A.codec!=="opus"&&A.codec!=="aac"&&A.codec!=="PCMU"&&A.codec!=="PCMA"&&A.codec!=="G722"||(_.codecType=A.codec),A.inputLevel)_.sendVolumeLevel=Math.round(32767*A.inputLevel);else{const I=a.getLocalAudioVolume();I&&(_.sendVolumeLevel=Math.round(32767*I))}_.sendBytes=A.bytes,_.sendPackets=A.packets,_.sendPacketsLost=A.packetsLost,_.sendJitterMs=A.jitterMs,_.sendRttMs=A.rttMs,_.sendBitrate=y?8*Math.max(0,_.sendBytes-y.sendBytes):0}}this.trafficStats&&(_.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(De.LocalAudioTrack,_),_&&x&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,x.track,_);break}}})}updateRemoteStats(a){Array.from(this.remoteStats.entries()).forEach(s=>{var l,d;let[f,{videoStats:m,audioStats:y,videoPcStats:_}]=s;const S=y,x=m,A=_,I=gp({},$z),L=gp({},Wz),K=gp({},rIe),{audioTrack:$,videoTrack:G,audioSSRC:ne,videoSSRC:te}=a.getRemoteMedia(f);let ce;ce=this.store.useP2P?a.getStats(!0):a.getStats();const pe=(l=ce)===null||l===void 0?void 0:l.audioRecv.find(Se=>Se.ssrc===ne),fe=(d=ce)===null||d===void 0?void 0:d.videoRecv.find(Se=>Se.ssrc===te),ue=this.trafficStats&&this.trafficStats.peer_delay.find(Se=>Se.peer_uid===f);if(pe&&(pe.codec!=="opus"&&pe.codec!=="aac"&&pe.codec!=="PCMU"&&pe.codec!=="PCMA"&&pe.codec!=="G722"||(I.codecType=pe.codec),pe.outputLevel?I.receiveLevel=Math.round(32767*pe.outputLevel):$&&(I.receiveLevel=Math.round(32767*$.getVolumeLevel())),I.receiveBytes=pe.bytes,I.receivePackets=pe.packets,I.receivePacketsLost=pe.packetsLost,I.receivePacketsDiscarded=pe.packetsDiscarded,I.packetLossRate=I.receivePacketsLost/(I.receivePackets+I.receivePacketsLost),I.receiveBitrate=S?8*Math.max(0,I.receiveBytes-S.receiveBytes):0,I.totalDuration=S?S.totalDuration+1:1,I.totalFreezeTime=S?S.totalFreezeTime:0,I.freezeRate=I.totalFreezeTime/I.totalDuration,I.receiveDelay=pe.jitterBufferMs,I.totalDuration>10&&Nb.isRemoteAudioFreeze($)&&(I.totalFreezeTime+=1)),fe){var ye;fe.codec!=="H264"&&fe.codec!=="H265"&&fe.codec!=="VP8"&&fe.codec!=="VP9"&&fe.codec!=="AV1X"&&fe.codec!=="AV1"||(L.codecType=fe.codec),L.receiveBytes=fe.bytes,L.receiveBitrate=x?8*Math.max(0,L.receiveBytes-x.receiveBytes):0,L.decodeFrameRate=fe.decodeFrameRate<0?0:fe.decodeFrameRate,L.renderFrameRate=fe.decodeFrameRate<0?0:fe.decodeFrameRate,fe.outputFrame&&(L.renderFrameRate=fe.outputFrame.frameRate),fe.receivedFrame?(L.receiveFrameRate=fe.receivedFrame.frameRate,L.receiveResolutionHeight=fe.receivedFrame.height,L.receiveResolutionWidth=fe.receivedFrame.width):G&&(L.receiveResolutionHeight=G._videoHeight||0,L.receiveResolutionWidth=G._videoWidth||0),fe.framesRateFirefox!==void 0&&(L.receiveFrameRate=Math.round(fe.framesRateFirefox)),L.receivePackets=fe.packets,L.receivePacketsLost=fe.packetsLost,L.packetLossRate=L.receivePacketsLost/(L.receivePackets+L.receivePacketsLost);const Se=x?x.totalFreezeTime:0,Ie=x?x.totalDuration:0;L.totalDuration=x?x.totalDuration+1:1,L.totalFreezeTime=(ye=fe.totalFreezesDuration)!==null&&ye!==void 0?ye:Se||0,L.receiveDelay=fe.jitterBufferMs||0;const Me=!!te&&a.getRemoteVideoIsReady(te);fe.totalFreezesDuration===void 0&&G&&Me&&Nb.isRemoteVideoFreeze(G,fe,A)&&(L.totalFreezeTime+=1),L.freezeRate=Math.max(0,Math.min((L.totalFreezeTime-Se)/(L.totalDuration-Ie),1))}ue&&(I.end2EndDelay=ue.B_ad,L.end2EndDelay=ue.B_vd,I.transportDelay=ue.B_ed,L.transportDelay=ue.B_ed,I.currentPacketLossRate=ue.B_ealr4/100,L.currentPacketLossRate=ue.B_evlr4/100,K.uplinkNetworkQuality=ue.B_punq?ue.B_punq:0,K.downlinkNetworkQuality=ue.B_pdnq?ue.B_pdnq:0),this.remoteStats.set(f,{audioStats:I,videoStats:L,videoPcStats:fe,networkStats:K}),$&&this.exceptionMonitor.setRemoteAudioStats($,I),G&&this.exceptionMonitor.setRemoteVideoStats(G,L)})}}class JK{constructor(){Q(this,"destChannelMediaInfos",new Map),Q(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(a){aK(a),this.srcChannelMediaInfo=a}addDestChannelInfo(a){aK(a),this.destChannelMediaInfos.set(a.channelName,a)}removeDestChannelInfo(a){vT(a),this.destChannelMediaInfos.delete(a)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function ZK(r){if(!(r instanceof JK))return new Ee(ie.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const a=r.getSrcChannelMediaInfo(),s=r.getDestChannelMediaInfo();if(!a)return new Ee(ie.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(s.size===0)return new Ee(ie.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class wh{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(a,s){Q(this,"uid",void 0),Q(this,"_uintid",void 0),Q(this,"_trust_in_room_",!0),Q(this,"_trust_audio_enabled_state_",!0),Q(this,"_trust_video_enabled_state_",!0),Q(this,"_trust_audio_mute_state_",!0),Q(this,"_trust_video_mute_state_",!0),Q(this,"_audio_muted_",!1),Q(this,"_video_muted_",!1),Q(this,"_audio_enabled_",!0),Q(this,"_video_enabled_",!0),Q(this,"_audio_added_",!1),Q(this,"_video_added_",!1),Q(this,"_is_pre_created",!1),Q(this,"_video_pre_subscribed",!1),Q(this,"_audio_pre_subscribed",!1),Q(this,"_trust_video_stream_added_state_",!0),Q(this,"_trust_audio_stream_added_state_",!0),Q(this,"_audioTrack",void 0),Q(this,"_videoTrack",void 0),Q(this,"_dataChannels",[]),Q(this,"_audioSSRC",void 0),Q(this,"_videoSSRC",void 0),Q(this,"_audioOrtc",void 0),Q(this,"_videoOrtc",void 0),Q(this,"_cname",void 0),Q(this,"_rtxSsrcId",void 0),Q(this,"_videoMid",void 0),Q(this,"_audioMid",void 0),this.uid=a,this._uintid=s}}function QK(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function OD(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?QK(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):QK(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const PT="9",PD=2e4,kT=4e4;function eq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ld(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?eq(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):eq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}var Wg=function(r){return r[r.DOWN=0]="DOWN",r[r.UP=1]="UP",r}(Wg||{});const jT=new Map;function tq(r,a,s,l){let{scale:d}=r;if(d===0&&l===Wg.UP||d>=a.length-1&&l===Wg.DOWN)return r;let f=ld(ld({},r),{},{scale:l===Wg.DOWN?++d:--d});switch(s){case"maintain-framerate":f=ld(ld({},f),a[d].motion);break;case"maintain-resolution":f=ld(ld({},f),a[d].detail);break;case"balanced":f=ld(ld({},f),a[d].balanced)}return f}function nq(r,a){if(a){const s={overUse:0,underUse:0,adaptationList:rq(a)};jT.set(r,s)}else jT.delete(r)}function rq(r){const a=ld({},r),{bitrateMax:s,frameRate:l,scaleResolutionDownBy:d,bitrateMin:f}=a,{MIN_FRAME_RATE:m,MAX_THRESHOLD_FRAMERATE:y,MAX_SCALE:_,BITRATE_MIN_THRESHOLD:S,BITRATE_MAX_THRESHOLD:x,BWE_SCALE_UP_THRESHOLD:A,BWE_SCALE_DOWN_THRESHOLD:I,PERF_SCALE_DOWN_THRESHOLD:L,PERF_SCALE_UP_THRESHOLD:K,BALANCE_BITRATE_FACTOR:$,BALANCE_FRAMERATE_FACTOR:G,BALANCE_RESOLUTION_FACTOR:ne,MOTION_RESOLUTION_FACTOR:te,MOTION_BITRATE_FACTOR:ce,DETAIL_FRAMERATE_FACTOR:pe,DETAIL_BITRATE_FACTOR:fe}=Ij,ue=Math.min(a.frameRate,y),ye=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(I,1)*s),bwe_up:s,fps_down:Math.round(Math.pow(L,1)*ue),fps_up:l},balanced:{scaleResolutionDownBy:1,frameRate:l,bitrateMax:s,bitrateMin:f},motion:{scaleResolutionDownBy:1,frameRate:l,bitrateMax:s,bitrateMin:f},detail:{scaleResolutionDownBy:1,frameRate:l,bitrateMax:s,bitrateMin:f}}];for(let Se=1;Se<=_;Se++){const Ie={bwe_up:Math.round(Math.pow(A,Se)*s),bwe_down:Math.round(Math.pow(I,Se+1)*s),fps_up:Math.round(Math.pow(K,Se)*ue),fps_down:Math.round(Math.pow(L,Se+1)*ue)},Me={scaleResolutionDownBy:d/Math.pow(ne,Se),frameRate:Math.max(Math.round(Math.pow(G,Se)*l),m),bitrateMax:Math.max(Math.round(Math.pow($,Se)*s),x),bitrateMin:Math.max(Math.round(Math.pow($,Se)*f),S)},Gt={scaleResolutionDownBy:d/Math.pow(te,Se),frameRate:l,bitrateMax:Math.max(Math.round(Math.pow(ce,Se)*s),x),bitrateMin:Math.max(Math.round(Math.pow(ce,Se)*f),S)},Kt={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(pe,Se)*l),m),bitrateMax:Math.max(Math.round(Math.pow(fe,Se)*s),x),bitrateMin:Math.max(Math.round(Math.pow(fe,Se)*f),S)};ye.push({scale:Se,threshold:Ie,balanced:Me,motion:Gt,detail:Kt})}return ye}function EOe(r,a,s,l,d,f){const m=jT.get(r)||{overUse:0,underUse:0,adaptationList:rq(d)},{adaptationList:y}=m;jT.set(r,m);const{OVERUSE_TIMES_THRESHOLD:_,UNDERUSE_TIMES_THRESHOLD:S}=Ij,{scale:x}=l;let A,I;return typeof a=="number"&&a>0&&function(L,K,$,G){if(K>=$.length)return!1;let{threshold:{fps_down:ne}}=$[K];return oe("FORCE_AG_HIGH_FRAMERATE")&&G==="maintain-framerate"&&(ne=$[0].threshold.fps_down),L<ne}(a,x,y,f)&&(m.overUse++,I=db.CPU,m.overUse>_)||typeof s=="number"&&s>0&&function(L,K,$){if(K>=$.length)return!1;const{threshold:{bwe_down:G}}=$[K];return L<G}(s,x,y)&&(m.overUse++,I=db.BANDWIDTH,m.overUse>_)?(m.overUse=0,m.underUse=0,A=tq(l,y,f,Wg.DOWN),[A,I]):(typeof a=="number"&&a>0&&typeof s=="number"&&s>0&&function(L,K,$,G){if(K===0)return;let{threshold:{fps_up:ne}}=$[K];return oe("FORCE_AG_HIGH_FRAMERATE")&&G==="maintain-framerate"&&(ne=$[1].threshold.fps_up),L>ne}(a,x,y,f)&&function(L,K,$){if(K===0)return;const{threshold:{bwe_up:G}}=$[K];return L>G}(s,x,y)&&(m.underUse++,m.underUse>S&&(m.overUse=0,m.underUse=0,A=tq(l,y,f,Wg.UP),A.scale===0&&(I=db.NONE))),[A,I])}function iq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function kD(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?iq(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):iq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const DT=new Map;function LT(r,a){const s=DT.get(r);if(s){const{timer:l}=s;window.clearTimeout(l),DT.delete(r)}a.qualityLimitationReason=db.NONE,nq(r)}function wOe(r,a){var s;let l;switch(a){case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoTrack:l=Be(s=r._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalVideoLowTrack:l=xn.Low}return l}function jD(r){const a=un();if(r.some(s=>s._bypassWebAudio))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!a.webAudioMediaStreamDest)throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function DD(r,a){jD(r);const s=new Yr;return r.forEach(l=>s.addAudioTrack(l)),s}const SOe=!un().supportUnifiedPlan||oe("CHROME_FORCE_PLAN_B")&&rd();function MT(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;return SOe?(s={spec:a,store:r},cd("PlanBConnection").create(s)):new Ao(a,r)}function LD(r){return r&&(r.iceConnectionState==="disconnected"||r.iceConnectionState==="checking"||r.iceConnectionState==="failed")}function aq(r){try{if(r.iceServers)return!1;if(r.turnServer&&r.turnServer.mode!=="off"){if(cb(r.turnServer.servers))return!1;if(oe("FORCE_TURN_TCP")||r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).some(a=>a.forceturn))return!0}return!1}catch{return!1}}var sn;function sq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ol(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?sq(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):sq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let Ao=(sn=class Pp extends lK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var a,s;return(a=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&a!==void 0?a:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(a=>a.rtpMap&&a.rtpMap.encodingName.toLowerCase()||"").filter(a=>{var s;return Be(s=Object.keys(fb)).call(s,a)}))]}constructor(a,s){super(a,s),Q(this,"id",Mn(5,"connection-")),Q(this,"store",void 0),Q(this,"peerConnection",void 0),Q(this,"forceTurn",!1),Q(this,"remoteSDP",void 0),Q(this,"initialOffer",void 0),Q(this,"transportEventReceiver",void 0),Q(this,"statsFilter",void 0),Q(this,"extension",{useXR:oe("USE_XR")}),Q(this,"localCapabilities",void 0),Q(this,"remoteCodecs",void 0),Q(this,"localCandidateCount",0),Q(this,"allCandidatesReceived",!1),Q(this,"isPreallocation",!1),Q(this,"preMediaMap",new Map),Q(this,"dataStreamChannelMap",new Map),Q(this,"establishPromise",void 0),Q(this,"recoveredDataChannelIds",[]),Q(this,"currentDataChannelId",1),Q(this,"supportAV1RtpSpec",!1),Q(this,"mutex",void 0),Q(this,"qualityLimitationReason",db.NONE),Q(this,"isFirstConnected",!1),this.store=s,this.forceTurn=aq(a),this.mutex=new Hi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(Pp.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=Rj(this.peerConnection,oe("STATS_UPDATE_INTERVAL"),void 0,dr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,a.isPreallocation&&(this.isPreallocation=!0),this.establishPromise=this.establish()}getPreMedia(a){return this.preMediaMap.get(a)}isPreSub(){return this.preMediaMap.size>0}async updateRemoteRTPCapabilities(a,s){if(this.remoteCodecs=s,!this.remoteSDP)return void V.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(s));if(this.remoteSDP.updateRemoteCodec(a,s,this.store.codec)){const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l);const f=this.remoteSDP.toString();d==null||d(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}else V.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const l=await this.peerConnection.createOffer();if(!l.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const d=yh(l.sdp),f=await NK({filterRTX:!oe("USE_PUB_RTX")&&!oe("USE_SUB_RTX"),filterVideoFec:oe("FILTER_VIDEO_FEC"),filterAudioFec:oe("FILTER_AUDIO_FEC"),filterVideoCodec:oe("FILTER_VIDEO_CODEC"),unsupportedVideoUplinkCodec:oe("UNSUPPORTED_VIDEO_UPLINK_CODEC"),unsupportedVideoDownlinkCodec:oe("UNSUPPORTED_VIDEO_DOWNLINK_CODEC")},this.extension);if(this.localCapabilities=RT(f),this.initialOffer=l,oe("ENABLE_SVC")&&this.store.codec=="av1"){const y=await async function(){try{const _=new RTCPeerConnection;_.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:Jx.L1T3}]});const S=await _.createOffer();if(!S.sdp)return void _.close();const x=ss(S.sdp).mediaDescriptions[0];if(!x)return;const A=x.attributes.extmaps.find(I=>I.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return _.close(),A}catch{return}}();var a;y&&(this.supportAV1RtpSpec=!0,(a=f.send)===null||a===void 0||a.videoExtensions.push(y))}let m;return l.sdp&&PK(l.sdp)&&(m=ir(f),(s=m).send&&(Ug(Je.VIDEO,s.send.videoExtensions),Ug(Je.AUDIO,s.send.audioExtensions)),s.recv&&(Ug(Je.VIDEO,s.recv.videoExtensions),Ug(Je.AUDIO,s.recv.audioExtensions)),s.sendrecv&&(Ug(Je.VIDEO,s.sendrecv.videoExtensions),Ug(Je.AUDIO,s.sendrecv.audioExtensions))),ol(ol({},d),{},{rtpCapabilities:m||f,offerSDP:l.sdp})}catch(l){throw new we(ie.GET_LOCAL_CONNECTION_PARAMS_FAILED,l.toString())}var s}async connect(a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&PK(this.initialOffer.sdp)&&(s=a.rtpCapabilities,l=this.localCapabilities,s.send&&(xT(Je.VIDEO,s.send.videoExtensions,l.send.videoExtensions),xT(Je.AUDIO,s.send.audioExtensions,l.send.audioExtensions)),s.recv&&(xT(Je.VIDEO,s.recv.videoExtensions,l.recv.videoExtensions),xT(Je.AUDIO,s.recv.audioExtensions,l.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return ir(this._localCapabilities)}get rtpCapabilities(){return ir(this._rtpCapabilities)}get candidates(){return ir(this._candidates)}get iceParameters(){return ir(this._iceParameters)}get dtlsParameters(){return ir(this._dtlsParameters)}constructor(_){let S=arguments.length>1&&arguments[1]!==void 0&&arguments[1],x=arguments.length>2&&arguments[2]!==void 0&&arguments[2];Q(this,"sessionDesc",void 0),Q(this,"_localCapabilities",void 0),Q(this,"_rtpCapabilities",void 0),Q(this,"_candidates",void 0),Q(this,"_originCandidates",void 0),Q(this,"_iceParameters",void 0),Q(this,"_isUseExtmapAllowMixed",void 0),Q(this,"_isUseLocalCodecs",void 0),Q(this,"_dtlsParameters",void 0),Q(this,"setup",void 0),Q(this,"currentMidIndex",void 0),Q(this,"cname",void 0),Q(this,"useLocalCodecsMids",[]),Q(this,"preloadSsrcs",[]),Q(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=S,this._isUseLocalCodecs=x,_=ir(_);const{iceParameters:A,dtlsParameters:I,candidates:L,rtpCapabilities:K,setup:$,localCapabilities:G,cname:ne}=_;this._rtpCapabilities=K,this._candidates=L,this._originCandidates=ir(L),this._iceParameters=A,this._dtlsParameters=I,this._localCapabilities=G,this.setup=$,this.cname=ne,[this.sessionDesc]=this.updateRemoteRTPCapabilities(K),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}checkPreloadSsrcs(_){return _.length===this.preloadSsrcs.length&&_.every(S=>{var x;return Be(x=this.preloadSsrcs).call(x,S)})}preloadRemoteMedia(_){let S=0;const x=[],A=[];for(;_>0;){const I=[OD({ssrcId:kT+S},oe("USE_SUB_RTX")?{rtx:kT+S+1}:{})],L="".concat(kT+S,"_").concat(PD+S),{ssrcs:K,ssrcGroups:$}=xb(I,this.cname,oe("SYNC_GROUP")?L:void 0),G=this.preCreateOrRecycleSendMedia("video",K,$,void 0),ne=[{ssrcId:PD+S}],te="".concat(kT+S,"_").concat(PD+S),{ssrcs:ce,ssrcGroups:pe}=xb(ne,this.cname,oe("SYNC_GROUP")?te:void 0),fe=this.preCreateOrRecycleSendMedia("audio",ce,pe,void 0);_--,S+=2,x.push(G,fe),A.push(K[0].ssrcId,ce[0].ssrcId)}return this.useLocalCodecsMids.push(...x),this.preloadSsrcs=A,{mids:x,preSSRCs:A,isAvailable:!0}}preCreateOrRecycleSendMedia(_,S,x,A){const I=this.rtpCapabilities.send.videoCodecs,L=this._isUseLocalCodecs||I.length===0?this.localCapabilities.recv:this.rtpCapabilities.send;V.debug("create or recycle send media without remote rtp capabilities, ssrcs ",S[0].ssrcId);const K=_===Je.VIDEO?L.videoCodecs:L.audioCodecs,$=_===Je.VIDEO?L.videoExtensions:L.audioExtensions;this.currentMidIndex+=1;const G="".concat(this.currentMidIndex);let ne={media:{mediaType:_,port:PT,protos:["UDP","TLS","RTP","SAVPF"],fmts:K.map(te=>te.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:$,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:S,ssrcGroups:x,rtcpFeedbackWildcards:[],payloads:K,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(G)}};return ne=this.mungSendMediaDesc(ne,A),this.sessionDesc.mediaDescriptions.push(ne),this.updateBundleMids(),G}toString(){return hh(this.sessionDesc)}send(_,S,x,A){const{ssrcs:I,ssrcGroups:L}=xb(S,this.cname,oe("SYNC_GROUP")?x:void 0),K=this.findPreloadMediaDesc(I);if(K){if(dr()&&this.firefoxSsrcMidMap.set(I[0].ssrcId,K.attributes.mid),A&&(A.twcc||A.remb)){const $=this.sessionDesc.mediaDescriptions.indexOf(K);return this.sessionDesc.mediaDescriptions[$]=this.mungSendMediaDesc(K,A),{mid:K.attributes.mid,needExchangeSDP:!0}}return{mid:K.attributes.mid,needExchangeSDP:!1}}{const $=this.findAvailableMediaIndex(_,I);let G;return $===-1||$===1&&(ji()||function(){const ne=an();return!(ne.name!==fn.CHROME||!ne.osVersion)&&Number(ne.version)<=90}()||oe("ENABLE_ENCODED_TRANSFORM")&&nd())||$===0&&!function(ne){const te=an();return!(te.name!==fn.FIREFOX||!te.osVersion)&&Number(te.version)===ne}(138)&&oe("USE_SUB_RTX")||tz()?(G=this.createOrRecycleSendMedia(_,I,L,"sendonly",A),this.updateBundleMids()):(G=ir(this.sessionDesc.mediaDescriptions[$]),G.attributes.direction="sendonly",G.attributes.ssrcs=I,G.attributes.ssrcGroups=L,this.sessionDesc.mediaDescriptions[$]=this.mungSendMediaDesc(G,A)),dr()&&this.firefoxSsrcMidMap.set(I[0].ssrcId,G.attributes.mid),{mid:G.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:_,needExchangeSDP:S}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:_.attributes.mid,needExchangeSDP:S}}batchSend(_){const S=_.map(I=>{let{kind:L,ssrcMsg:K,mslabel:$}=I;return this.send(L,K,$)}),x=[];let A=!1;return S.forEach(I=>{let{mid:L,needExchangeSDP:K}=I;K&&(A=!0),x.push(L)}),{mids:x,needExchangeSDP:A}}stopSending(_){const S=this.sessionDesc.mediaDescriptions.filter(x=>x.attributes.mid&&_.indexOf(x.attributes.mid)!==-1);if(S.length!==_.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");S.forEach(x=>{x.attributes.mid==="0"||dr()||tz()?x.attributes.ssrcs=[]:(x.attributes.ssrcs=[],x.attributes.direction="inactive",x.media.port="0")}),this.updateBundleMids()}mute(_){const S=this.sessionDesc.mediaDescriptions.find(x=>x.attributes.mid===_);if(!S)throw new Error("mediaDescription not found with ".concat(_," in remote SDP when calling RemoteSDP.mute."));S.attributes.direction="inactive"}unmute(_){const S=this.sessionDesc.mediaDescriptions.find(x=>x.attributes.mid===_);if(!S)throw new Error("mediaDescription not found with ".concat(_," in remote SDP when calling RemoteSDP.unmute."));S.attributes.direction="sendonly"}muteRemote(_){const S=this.sessionDesc.mediaDescriptions.filter(x=>Be(_).call(_,x.attributes.mid||""));if(S.length!==_.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");S.forEach(x=>{x.attributes.direction="inactive"})}unmuteRemote(_){const S=this.sessionDesc.mediaDescriptions.filter(x=>Be(_).call(_,x.attributes.mid||""));if(S.length!==_.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");S.forEach(x=>{x.attributes.direction="recvonly"})}receive(_,S,x,A){_.forEach((I,L)=>{this.createOrRecycleRecvMedia(I,[],"recvonly",S,x,A[L])}),this.updateBundleMids()}stopReceiving(_){const S=this.sessionDesc.mediaDescriptions.filter(x=>_.indexOf(x.attributes.mid)!==-1);if(S.length!==_.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");S.forEach(x=>{x.media.port="0",x.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(_){const S=this.sessionDesc||ss((x=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(x?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var x;this._rtpCapabilities=_;let A=!1;const I=this.rtpCapabilities.send,L=this.localCapabilities.send,K=this.localCapabilities.recv,$=K.videoCodecs,G=K.audioCodecs,ne=K.videoExtensions,te=K.audioExtensions;for(const ue of S.mediaDescriptions){var ce;if(ue.attributes.direction!=="sendonly"||typeof ue.attributes.mid!="string"||!Be(ce=this.useLocalCodecsMids).call(ce,ue.attributes.mid)){if(A=!0,ue.attributes.iceUfrag=this._iceParameters.iceUfrag,ue.attributes.icePwd=this._iceParameters.icePwd,ue.attributes.fingerprints=this._dtlsParameters.fingerprints,ue.attributes.candidates=this._candidates,ue.attributes.setup=this.setup,ue.media.mediaType==="application"&&(ue.attributes.sctpPort="5000"),ue.media.mediaType==="video")if(this._isUseLocalCodecs&&ue.attributes.direction==="sendonly"){var pe;ue.media.fmts=$.map(Se=>Se.payloadType.toString(10)),ue.attributes.payloads=$,ue.attributes.extmaps=ne;const ye=ue.attributes.mid;typeof ye!="string"||Be(pe=this.useLocalCodecsMids).call(pe,ye)||this.useLocalCodecsMids.push(ye)}else if(I.videoCodecs.length===0){const ye=L.videoCodecs.filter(Se=>{var Ie,Me;return(Ie=Se.rtpMap)===null||Ie===void 0?void 0:Be(Me=Ie.encodingName.toLowerCase()).call(Me,"vp8")})||[L.videoCodecs[0]];ue.media.fmts=ye.map(Se=>Se.payloadType.toString(10)),ue.attributes.payloads=ye,ue.attributes.extmaps=[]}else ue.media.fmts=I.videoCodecs.map(ye=>ye.payloadType.toString(10)),ue.attributes.payloads=I.videoCodecs,ue.attributes.extmaps=I.videoExtensions;if(ue.media.mediaType==="audio")if(this._isUseLocalCodecs&&ue.attributes.direction==="sendonly"){var fe;ue.media.fmts=G.map(Se=>Se.payloadType.toString(10)),ue.attributes.payloads=G,ue.attributes.extmaps=te;const ye=ue.attributes.mid;typeof ye!="string"||Be(fe=this.useLocalCodecsMids).call(fe,ye)||this.useLocalCodecsMids.push(ye)}else if(I.audioCodecs.length===0){const ye=L.audioCodecs.filter(Se=>{var Ie,Me;return(Ie=Se.rtpMap)===null||Ie===void 0?void 0:Be(Me=Ie.encodingName.toLowerCase()).call(Me,"opus")})||[L.audioCodecs[0]];ue.media.fmts=ye.map(Se=>Se.payloadType.toString(10)),ue.attributes.payloads=ye,ue.attributes.extmaps=[]}else ue.media.fmts=I.audioCodecs.map(ye=>ye.payloadType.toString(10)),ue.attributes.payloads=I.audioCodecs,ue.attributes.extmaps=I.audioExtensions,Vg(ue)}}return this.sessionDesc=S,this.currentMidIndex=S.mediaDescriptions.length-1,[this.sessionDesc,A]}updateCandidates(_){const S=this._originCandidates.filter(A=>A.transport==="udp"),x=[];if(S.forEach(A=>{x.push(OD(OD({},A),{},{foundation:"tcpcandidate",priority:Number(A.priority)-1+"",transport:"tcp",port:Number(A.port)+90+""}))}),S.length!==0){switch(_){case qi.TCP_RELAY:this._candidates=x;break;case qi.UDP_TCP_RELAY:case qi.RELAY:this._candidates=[...S,...x];break;default:this._candidates=S}for(const A of this.sessionDesc.mediaDescriptions)A.attributes.candidates=this.candidates}}restartICE(_){_=ir(_),this._iceParameters=_,this.sessionDesc.mediaDescriptions.forEach(S=>{S.attributes.iceUfrag=_.iceUfrag,S.attributes.icePwd=_.icePwd})}predictReceivingMids(_){const S=[];for(let x=0;x<_;x++)S.push((this.currentMidIndex+x+1).toString(10));return S}findAvailableMediaIndex(_,S){return this.sessionDesc.mediaDescriptions.findIndex(x=>{const A=x.media.mediaType===_&&x.media.port!=="0"&&(x.attributes.direction==="sendonly"||x.attributes.direction==="sendrecv")&&x.attributes.ssrcs.length===0;if(dr()){if(A){const I=this.firefoxSsrcMidMap.get(S[0].ssrcId);return!(I||x.attributes.mid!=="0"&&x.attributes.mid!=="1")||!(!I||I!==x.attributes.mid)}return!1}return A})}createOrRecycleDataChannel(){for(const x of this.sessionDesc.mediaDescriptions)if(x.media.mediaType==="application")return{mediaDesc:x,needExchangeSDP:!1};this.currentMidIndex+=1;const _="".concat(this.currentMidIndex),S={media:{mediaType:"application",port:PT,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(_),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(S),{mediaDesc:S,needExchangeSDP:!0}}createOrRecycleRecvMedia(_,S,x,A,I,L){const K=_._mediaStreamTrack.kind,$=this.rtpCapabilities.recv,G=Tb(K,$,this.localCapabilities.send,K===Je.VIDEO?A:I),ne=K===Je.VIDEO?$.videoExtensions:$.audioExtensions;this.currentMidIndex+=1;const te="".concat(this.currentMidIndex);let ce={media:{mediaType:K,port:PT,protos:["UDP","TLS","RTP","SAVPF"],fmts:G.map(fe=>fe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ne,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:S,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:G,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:x,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(te)}};ce=this.mungRecvMediaDsec(ce,_,L);const pe=this.findFirstClosedMedia(K);if(pe){const fe=this.sessionDesc.mediaDescriptions.indexOf(pe);this.sessionDesc.mediaDescriptions[fe]=ce}else this.sessionDesc.mediaDescriptions.push(ce);return ce}updateRemoteDtlsParameters(_){const S=new Set(this._dtlsParameters.fingerprints.map(I=>I.fingerprint)),x=new Set(_.map(I=>I.fingerprint));let A=!1;S.size!==x.size&&(A=!0);for(const I of S)x.has(I)||(A=!0);return A}updateRemoteCodec(_,S,x){const A=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(ce=>ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||"").filter(ce=>{var pe;return Be(pe=Object.keys(fb)).call(pe,ce)}))],I=new Set(S);if(A.every(ce=>I.has(ce)))return V.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(S)),!1;const L=this._rtpCapabilities.recv.videoCodecs.filter(ce=>S.some(pe=>{var fe;return Be(fe=ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||"").call(fe,pe)}));if(L.length===0)return V.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(A," codecs: ").concat(S)),!1;const K=[...new Set(L.map(ce=>ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||""))];let $;if(V.debug("updateRemoteCodec, from ".concat(A," to ").concat(K)),_.length===0)$=this.sessionDesc.mediaDescriptions.filter(ce=>ce.media.mediaType==="video"&&ce.attributes.direction==="recvonly");else if($=this.sessionDesc.mediaDescriptions.filter(ce=>ce.attributes.mid&&ce.media.mediaType==="video"&&Be(_).call(_,ce.attributes.mid)&&ce.attributes.direction==="recvonly"),$.length!==_.length)return V.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(_,", codecs: ").concat(S)),!1;if(oe("USE_PUB_RTX")||oe("USE_SUB_RTX")){const ce=_h(L,this.rtpCapabilities.recv.videoCodecs);L.push(...ce)}this._rtpCapabilities.recv.videoCodecs=L;const G=this.localCapabilities.send,ne=this.rtpCapabilities.recv,te=Tb(Je.VIDEO,ne,G,x);return $.forEach(ce=>{const pe=te.map(fe=>fe.payloadType.toString(10));V.debug("updateRemoteCodec mid: ".concat(ce.attributes.mid,", from"),ce.attributes.payloads,"to",te),ce.attributes.payloads=te,ce.media.fmts=pe}),!0}createOrRecycleSendMedia(_,S,x,A,I){const L=this.rtpCapabilities.send.videoCodecs,K=this._isUseLocalCodecs||L.length===0?this.localCapabilities.recv:this.rtpCapabilities.send,$=_===Je.VIDEO?K.videoCodecs:K.audioCodecs,G=_===Je.VIDEO?K.videoExtensions:K.audioExtensions;this.currentMidIndex+=1;const ne="".concat(this.currentMidIndex);let te={media:{mediaType:_,port:PT,protos:["UDP","TLS","RTP","SAVPF"],fmts:$.map(pe=>pe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:G,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:S,ssrcGroups:x,rtcpFeedbackWildcards:[],payloads:$,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:A,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ne)}};te=this.mungSendMediaDesc(te,I);const ce=this.findFirstClosedMedia(_);if(ce){const pe=this.sessionDesc.mediaDescriptions.indexOf(ce);this.sessionDesc.mediaDescriptions[pe]=te}else this.sessionDesc.mediaDescriptions.push(te);return te}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(_=>_.media.port!=="0").map(_=>_.attributes.mid)}mungRecvMediaDsec(_,S,x){const A=ir(_);return yD(A),Fg(A,S),_D(A,S),CK(A),CT(A,x,this.localCapabilities.send),A}mungSendMediaDesc(_,S){const x=ir(_);return CT(x,S,this.localCapabilities.recv),Vg(x),x}updateRecvMedia(_,S){const x=this.sessionDesc.mediaDescriptions.findIndex(A=>A.attributes.mid===_);if(x!==-1){const A=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[x],S);this.sessionDesc.mediaDescriptions[x]=A}}bumpMid(_){this.currentMidIndex+=_}findFirstClosedMedia(_){return this.sessionDesc.mediaDescriptions.find(S=>dr()?S.media.port==="0"&&S.media.mediaType===_:S.media.port==="0")}findPreloadMediaDesc(_){return this.sessionDesc.mediaDescriptions.find(S=>{var x;return((x=S.attributes)===null||x===void 0||(x=x.ssrcs[0])===null||x===void 0?void 0:x.ssrcId)===_[0].ssrcId})}getSSRC(_){var S;return(S=this.sessionDesc.mediaDescriptions.find(x=>x.attributes.mid===_))===null||S===void 0?void 0:S.attributes.ssrcs}}(ol(ol({},a),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec,!(!oe("ENABLE_PRE_SUB_WITH_PRE_PC")||!oe("PRE_USE_LOCAL_CODECS"))&&Dj(this.store)),a.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const d=this.remoteSDP.toString(),f=IK(this.initialOffer.sdp,this.extension),m=this.logSDPExchange(f||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:f}),m==null||m(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d});const y=this.peerConnection.getTransceivers()[0];if(y!=null&&y.receiver&&this.tryBindTransportEvents(y.receiver),Dj(this.store))if(a.preallocation&&oe("ENABLE_PRE_SUB_WITH_PRE_PC")){const _=oe("PRE_SUB_NUM"),{mids:S,preSSRCs:x}=this.remoteSDP.preloadRemoteMedia(_);await bh(this.peerConnection,this.remoteSDP,this.extension),V.debug("[".concat(this.store.clientId,"] [P2PConnection] preload media, in pre pc,add preload ssrcs ").concat(x)),this.presetMedia(S,x)}else{const{preSSRCs:_=[]}=a,S=_.map(A=>A.ssrcMsg[0].ssrcId);if(_.length===0)return;const{mids:x}=this.remoteSDP.batchSend(_.map(A=>Object.assign({},A)));await bh(this.peerConnection,this.remoteSDP,this.extension),V.debug("[P2PConnection.connect] preload media, after join, add preload ssrcs ".concat(S)),this.presetMedia(x,S)}}catch(d){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(d.toString()))}var s,l}presetMedia(a,s){a.forEach((l,d)=>{this.peerConnection.getTransceivers().forEach(f=>{if(f.mid!=null&&l===f.mid&&f.receiver.track){const m=f.receiver.track;let y;m.kind==="video"&&oe("ENABLE_PRE_RENDER")&&(y=new qj({trackId:"track-".concat(m.kind,"-unknown-").concat(this.store.clientId,"_").concat(Mn(5,""))},!0),y.updateVideoTrack(m),y.onFirstVideoFrameRender=()=>{var _;const S=this.preMediaMap.get(s[d]);S&&(S.firstVideoRender=Date.now()),(_=this.onFirstVideoRender)===null||_===void 0||_.call(this,s[d])},y.play(this.store.sessionId||void 0)),this.preMediaMap.set(s[d],{mid:l,track:m,player:y,transceiver:f})}}),this.store.peerReceiver()})}checkDtlsParameters(a){return!!this.remoteSDP&&a.length>0&&this.remoteSDP.updateRemoteDtlsParameters(a)}async updateRemoteConnect(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");let s=!1;const{rtpCapabilities:l}=a;if([,s]=this.remoteSDP.updateRemoteRTPCapabilities(l),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0){const m=this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);s=s||m}const{preSSRCs:d=[]}=a,f=d.map(m=>m.ssrcMsg[0].ssrcId);if(!this.remoteSDP.checkPreloadSsrcs(f)){const m=[],y=[];if(Array.from(this.preMediaMap.entries()).every(_=>{let[S,{mid:x,player:A,track:I}]=_;return m.push(x),y.push(S),this.preMediaMap.delete(S),A&&A.destroy(),!0}),m.length>0&&(this.remoteSDP.stopSending(m),await bh(this.peerConnection,this.remoteSDP,this.extension),V.warn("[P2PConnection.updateRemoteConnect] preload media, failed, del preload ssrcs ".concat(y)),it.reportApiInvoke(this.store.sessionId,{name:Er.PRELOAD_MEDIA_FAILED,options:[d,y],tag:rr.TRACER}).onSuccess()),d.length>0){const{mids:_}=this.remoteSDP.batchSend(d.map(S=>Object.assign({},S)));await bh(this.peerConnection,this.remoteSDP,this.extension),V.debug("[P2PConnection.updateRemoteConnect] preload media, after join, add preload ssrcs ".concat(f)),this.presetMedia(_,f)}}s?(await bh(this.peerConnection,this.remoteSDP,this.extension),V.debug("[P2PConnection] updateRemoteConnect by exchanging SDP.")):V.debug("[P2PConnection] updateRemoteConnect no need to exchange SDP, because no need to update remote codecs (use local codecs)")}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(s.toString()))}}send(a,s,l){var d=this;return So(function*(){const f=yield ln(d.mutex.lock("From P2PConnection.send"));try{if(!d.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const m=[],y=ST();a.forEach(G=>{const ne=d.peerConnection.addTransceiver(G._mediaStreamTrack,ol({direction:"sendonly"},G.trackMediaType==="video"&&d.supportAV1RtpSpec&&y?{sendEncodings:[{scalabilityMode:y}]}:{}));m.push(ne),G._updateRtpTransceiver(ne)}),dr()&&oe("SIMULCAST")===!0&&(yield ln(d.applySimulcastForFirefox(m,a)));const _=yield ln(d.peerConnection.createOffer()),S=d.remoteSDP.predictReceivingMids(a.length),x=d.mungSendOfferSDP(_.sdp,a,S),A=ss(x),I=S.map(G=>{const ne=A.mediaDescriptions.find(te=>te.attributes.mid===G);if(!ne)throw new Error("Cannot extract ssrc from mediaDescription.");return SK(ne,oe("USE_PUB_RTX"))});let L;try{L=yield I}catch(G){L=[],d.remoteSDP.receive(a,s,l,L);const ne=d.remoteSDP.toString();throw yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(d.peerConnection.setRemoteDescription({type:"answer",sdp:ne})),yield ln(d.stopSending(S,!0)),G}d.remoteSDP.receive(a,s,l,L);const K=d.remoteSDP.toString(),$=d.logSDPExchange(x,"offer","local","send");return yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(d.applySimulcastEncodings(m,a)),yield ln(d.applySendEncodings(m,a)),$==null||$(K),yield ln(d.peerConnection.setRemoteDescription({type:"answer",sdp:K})),m.map((G,ne)=>{const te=S[ne];return{localSSRC:I[ne],id:te,transceiver:G}})}catch(m){throw m instanceof we?m:new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(m.toString()))}finally{f()}})()}async createDataChannels(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let l=this.dataStreamChannelMap.get(a);if(l&&l.readyState==="open")V.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const f=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof f!="number")throw new Error("create DataChannel error, because cannot get dc id");l=this.peerConnection.createDataChannel("datastream-channel",{id:f,negotiated:!0,ordered:!1,maxRetransmits:oe("DATASTREAM_MAX_RETRANSMITS")}),l.binaryType="arraybuffer",this.dataStreamChannelMap.set(a,l)}s.forEach(f=>{f._updateOriginDataChannel(l)});const{needExchangeSDP:d}=this.remoteSDP.sendDataChannel();if(d){const f=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:f});const m=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(m),V.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else V.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(l){throw l instanceof we?l:new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(l.toString()))}}async stopDataChannels(a){try{const s=this.dataStreamChannelMap.get(a);return s&&(s.id&&this.recoveredDataChannelIds.push(s.id),s.close()),void this.dataStreamChannelMap.delete(a)}catch(s){throw s instanceof we?s:new we(ie.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(s.toString()))}}async stopSending(a,s){const l=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const d=this.peerConnection.getTransceivers().filter(_=>a.indexOf(_.mid)!==-1);if(d.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");d.map(_=>{var S;LT(this.id+_.mid,this),_.direction="inactive",(S=_.stop)===null||S===void 0||S.call(_)});const f=await this.peerConnection.createOffer(),m=this.logSDPExchange(f.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(a);const y=this.remoteSDP.toString();m==null||m(y),await this.peerConnection.setRemoteDescription({type:"answer",sdp:y})}catch(d){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(d.toString()))}finally{l&&l()}}async receive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(a,s,l,d);m&&(await bh(this.peerConnection,this.remoteSDP,this.extension),V.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," by exchanging SDP.")));const y=this.peerConnection.getTransceivers().find(_=>_.mid===f);if(!y)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:y.receiver.track,id:f,transceiver:y}}catch(f){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:l}=this.remoteSDP.batchSend(a);return l&&(await bh(this.peerConnection,this.remoteSDP,this.extension),V.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),s.map(d=>{const f=this.peerConnection.getTransceivers().find(m=>m.mid===d);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:d,transceiver:f}})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");a.forEach(f=>{Array.from(this.preMediaMap.entries()).some(m=>{let[y,{mid:_,player:S}]=m;if(_===f)return this.preMediaMap.delete(y),S&&S.destroy(),!0})}),this.remoteSDP.stopSending(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.mute(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(s.toString()))}}async unmuteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.unmute(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(s.toString()))}}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(m=>{m.direction="inactive"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.muteRemote(a);const f=this.remoteSDP.toString();d==null||d(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async(m,y)=>{m.direction="sendonly"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.unmuteRemote(a),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(a,this.remoteCodecs,this.store.codec);const f=this.remoteSDP.toString();d==null||d(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(a){var s=this;return So(function*(){const l=yield ln(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const d=un().supportPCSetConfiguration,f=oe("FORCE_TURN_TCP")||s.forceTurn;if(a===qi.RELAY&&!d)return;if(d&&!f){const A=a===qi.RELAY?"relay":"all",I=s.peerConnection.getConfiguration();I.iceTransportPolicy!==A&&(V.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(I.iceTransportPolicy,"] to [").concat(A,"]")),I.iceTransportPolicy=A,s.peerConnection.setConfiguration(I))}s.remoteSDP.updateCandidates(a);const m=yield ln(s.peerConnection.createOffer({iceRestart:!0}));if(!m.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const y=yh(m.sdp),{remoteIceParameters:_}=yield y.iceParameters;s.remoteSDP.restartICE(_);const S=s.remoteSDP.toString(),x=s.logSDPExchange(m.sdp||"","offer","local","restartICE");s.store.descriptionStart(),yield ln(s.peerConnection.setLocalDescription(m)),x==null||x(S),yield ln(s.peerConnection.setRemoteDescription({type:"answer",sdp:S}))}catch(d){V.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),d)}finally{l()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const a=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(qi.TCP_RELAY),await bh(this.peerConnection,this.remoteSDP,this.extension)}catch(s){V.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),s)}finally{a()}}close(){var a;this.peerConnection.getTransceivers().forEach(s=>{LT(this.id+s.mid,this)}),this.preMediaMap.forEach(s=>{let{player:l}=s;l&&l.destroy()}),this.preMediaMap.clear(),this.peerConnection.close(),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return ol(ol({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const l=await this.peerConnection.createOffer(),d=this.mungSendOfferSDP(l.sdp,[s],[a]);this.remoteSDP.updateRecvMedia(a,s);const f=this.remoteSDP.toString(),m=this.logSDPExchange(d,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:d}),m==null||m(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new we(ie.EXCHANGE_SDP_FAILED,l.toString())}}async updateSendParameters(a,s){const l=this.peerConnection.getTransceivers().filter(d=>d.mid===a);l.length===1&&(this.isVP8Simulcast(s)?dr()||await this.applySimulcastEncodings(l,[s]):await this.applySendEncodings(l,[s]))}setStatsRemoteVideoIsReady(a,s){this.statsFilter.setVideoIsReady2(a,s)}async replaceTrack(a,s){const l=this.peerConnection.getTransceivers().find(d=>d.mid===s);l&&await l.sender.replaceTrack(a._mediaStreamTrack)}async getSelectedCandidatePair(){const a=this.peerConnection.getReceivers();if(a.length>0&&a[0].transport&&a[0].transport.iceTransport&&a[0].transport.iceTransport.getSelectedCandidatePair&&a[0].transport.iceTransport.getSelectedCandidatePair()){const s=a[0].transport.iceTransport,{local:l,remote:d}=s.getSelectedCandidatePair();return{local:ol(ol({},tu),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port}),remote:ol(ol({},tu),{},{candidateType:d.type,protocol:d.protocol,address:d.address,port:d.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=a=>{if(a&&(a.errorCode||a.errorText)){var s;const l="code: ".concat(a.errorCode,", message: ").concat(a.errorText),d=a.port?"local: ".concat(a.port):"",f=mp(a.url||"");V.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(l,"), url: ").concat(f||"",", host_candidate:").concat(d)),(s=this.onICECandidateError)===null||s===void 0||s.call(this,l)}},this.peerConnection.onicegatheringstatechange=a=>{a&&a.target&&"iceGatheringState"in a.target&&V.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(a.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,V.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,V.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},oe("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const s={iceServers:[]},l=a.cloudProxyServer||"disabled";return a.iceServers?s.iceServers=a.iceServers:a.turnServer&&(cb(a.turnServer.servers)?s.iceServers=a.turnServer.servers:oe("NEW_TURN_MODE")&&s.iceServers&&l==="disabled"?(oe("USE_TURN_SERVER_OF_GATEWAY")?a.turnServer.serversFromGateway&&s.iceServers.push(...Pp.newTurnServerConfigToIceServers(a.turnServer.serversFromGateway)):s.iceServers.push(...Pp.newTurnServerConfigToIceServers(a.turnServer.servers)),oe("NEW_FORCE_TURN")&&(s.iceTransportPolicy="relay")):a.turnServer.mode!=="off"&&(s.iceServers&&s.iceServers.push(...Pp.turnServerConfigToIceServers(a.turnServer.servers)),oe("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&a.turnServer.serversFromGateway&&s.iceServers.push(...Pp.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),oe("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(d=>{d.forceturn&&(s.iceTransportPolicy="relay")}))),oe("ENABLE_ENCODED_TRANSFORM")&&un().supportWebRTCEncodedTransform&&(s.encodedInsertableStreams=!0),s}static turnServerConfigToIceServers(a){const s=[];return a.forEach(l=>{l.security?l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(gh(l.turnServerURL),":").concat(l.tcpport,"?transport=tcp")}):(l.udpport&&!oe("FORCE_TURN_TCP")&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.udpport,"?transport=udp")}),l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.tcpport,"?transport=tcp")}))}),s}static newTurnServerConfigToIceServers(a){const s=[];return a.forEach(l=>{const d=oe("NEW_TURN_MODE");d===1?s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=udp")}):d===2?s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=tcp")}):d===3?s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(gh(l.turnServerURL),":443?transport=tcp")}):d===4&&(s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=udp")}),s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":3478?transport=tcp")}),s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(gh(l.turnServerURL),":443?transport=tcp")}))}),s}tryBindTransportEvents(a){const s=a.transport;if(s){this.transportEventReceiver=a,s.onstatechange=()=>{var d;s!=null&&s.state&&((d=this.onDTLSTransportStateChange)===null||d===void 0||d.call(this,s.state))},s.onerror=d=>{var f;(f=this.onDTLSTransportError)===null||f===void 0||f.call(this,"error"in d?d.error:d)};const l=s.iceTransport;l&&(l.onstatechange=()=>{const d=s==null?void 0:s.iceTransport.state;var f;d&&((f=this.onICETransportStateChange)===null||f===void 0||f.call(this,d))},l.getSelectedCandidatePair&&(l.onselectedcandidatepairchange=()=>{if(l.getSelectedCandidatePair()){const{local:d,remote:f}=l.getSelectedCandidatePair()||{};if(d&&f){const m=d.address+":"+d.port,y=f.address+":"+f.port;V.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(mp(m)),", remote ").concat(JSON.stringify(mp(y))))}}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(a,s){var l,d;if(s||(s=this.peerConnection.getSenders().find(G=>G.track===a._mediaStreamTrack)),!s)return V.warn("[".concat(a.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(a))return V.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!un().supportSetRtpSenderParameters)return V.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const f={},m={};switch(a._optimizationMode){case"motion":f.degradationPreference="maintain-framerate";break;case"detail":f.degradationPreference="maintain-resolution";break;case"balanced":f.degradationPreference="balanced"}const y=function($,G){return $.getTransceivers().find(ne=>ne.sender.track===G||ne.receiver.track===G)}(this.peerConnection,a._mediaStreamTrack),_=cIe(a);if(function($){var G;return!(!oe("ENABLE_AG_ADAPTATION")||!($ instanceof sT||Be(G=$._hints).call(G,jn.CUSTOM_TRACK))||!oe("FORCE_SUPPORT_AG_ADAPTATION")&&!(QH(14,0,!1)&&ez(17,4)||ZH(14)&&uj(17,4,!0)))}(a)&&y&&s&&_&&this.getLocalVideoStats&&Be(l=["vp8","vp9"]).call(l,this.store.codec)){var S;const $=f.degradationPreference||(Be(S=a._hints).call(S,jn.CUSTOM_TRACK)?oe("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(G,ne,te,ce,pe,fe){if(LT(G,te),pe(ne),ce!=="balanced"&&ce!=="maintain-framerate"&&ce!=="maintain-resolution")return;let ue=-1;nq(G,ne);const ye=window.setInterval(()=>{const Ie=DT.get(G);if(!oe("ENABLE_AG_ADAPTATION")||!Ie)return LT(G,te),void pe(ne);const Me=fe();if(Me.sendPackets>0&&Me.OutgoingAvailableBandwidth>0){if(ue===-1)return void(ue=Date.now());if(Date.now()-ue<1e3)return;const Gt=Me.sendFrameRate,Kt=Me.OutgoingAvailableBandwidth,[Nt,bn]=EOe(G,Gt,Kt,Ie.adaptationConfig,ne,ce);bn&&(te.qualityLimitationReason=bn),Nt&&Ie.adaptationConfig.scale!==Nt.scale&&(V.debug("[".concat(G,"] applyAdaptation: ").concat(te.qualityLimitationReason,`
           sendFps `).concat(Gt,", bwe ").concat(Kt,", switch from ").concat(Ie.adaptationConfig.scale," to ").concat(Nt.scale," ")),Ie.adaptationConfig=kD(kD({},Ie.adaptationConfig),Nt),pe(Nt))}},oe("CHECK_LOCAL_STATS_INTERVAL")),Se=kD({},ne);DT.set(G,{timer:ye,adaptationConfig:Se,originConfig:ne,adaptationFunc:pe}),V.debug("[".concat(G,"] start adaptation, originConfig: ").concat(JSON.stringify(ne),", degradationPreference: ").concat(ce))})(this.id+y.mid,_,this,$,G=>{s&&this.updateAdaptation(s,G)},this.getLocalVideoStats.bind(this))}if(a._encoderConfig){var x;const{bitrateMax:$,frameRate:G,scaleResolutionDownBy:ne}=a._encoderConfig;$&&(m.maxBitrate=1e3*$),(Be(x=a._hints).call(x,jn.LOW_STREAM)||a.isUseScaleResolutionDownBy)&&(G&&(m.maxFramerate=Is(G)),ne&&ne>=1&&(m.scaleResolutionDownBy=ne))}const{maxFramerate:A}=oe("ENCODER_CONFIG_LIMIT");if(A&&typeof A=="number"&&(m.maxFramerate=m.maxFramerate?Math.min(m.maxFramerate,A):A),oe("DSCP_TYPE")&&rd()){var I;const $=oe("DSCP_TYPE");Be(I=["very-low","low","medium","high"]).call(I,$)&&(m.networkPriority=$)}const L=s.getParameters(),K=(d=L.encodings)===null||d===void 0?void 0:d[0];dr()&&!K&&(f.encodings=[m]),K&&Object.assign(K,m),Object.assign(L,f),V.debug("[".concat(a.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(L.encodings))),await s.setParameters(L),await async function($,G,ne){try{var te;if(!un().supportSetRtpSenderParameters||!function(ye){return ye==="vp9"||ye==="av1"}($)||!oe("ENABLE_SVC"))return;const ce={},pe={},fe=G.getParameters(),ue=(te=fe.encodings)===null||te===void 0?void 0:te[0];pe.scalabilityMode=ST(ne),ue&&Object.assign(ue,pe),Object.assign(fe,ce),await G.setParameters(fe),V.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(fe.encodings)))}catch(ce){V.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",ce)}}(this.store.codec,s,oe("SVC_MODE"))}async updateAdaptation(a,s){var l,d;if(!a)return V.debug("[updateAdaptation] no rtpSender found");if(!un().supportSetRtpSenderParameters)return V.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const f={},{bitrateMax:m,frameRate:y,scaleResolutionDownBy:_}=s;m&&(f.maxBitrate=1e3*m),y&&(f.maxFramerate=Is(y)),_&&_>=1&&Be(l=["vp8","vp9"]).call(l,this.store.codec)&&(f.scaleResolutionDownBy=_);const S=a.getParameters(),x=(d=S.encodings)===null||d===void 0?void 0:d[0];x&&Object.assign(x,f),Object.assign(S,{});try{await a.setParameters(S),V.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(S.encodings)))}catch(A){!("transport"in a)||a.transport&&a.transport.state==="connected"?this.peerConnectionState!=="connected"?V.debug("[updateAdaptation] peerConnection not connected}"):V.debug("[updateAdaptation] updateRtpSenderEncodings failed",A):V.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(a,s){try{if(!un().supportSetRtpSenderParameters||a.length!==s.length)return;for(let l=0;l<a.length;l++){const d=a[l],f=s[l];f instanceof Gn&&!this.isVP8Simulcast(f)&&await this.updateRtpSenderEncodings(f,d.sender)}}catch{V.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(a,s,l){const d=ss(a);return s.forEach((f,m)=>{const y=l[m],_=d.mediaDescriptions.find(S=>S.attributes.mid===y);_&&(Fg(_,f),RK(_,f,this.store.codec))}),hh(d)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,s,l)=>{var d;(d=this.onFirstVideoDecoded)===null||d===void 0||d.call(this,a,s,l)},this.statsFilter.onSelectedLocalCandidateChanged=(a,s)=>{var l;(l=this.onSelectedLocalCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,s)=>{var l;(l=this.onSelectedRemoteCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onFirstVideoDecodedTimeout=a=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(a,s){if(a.length===s.length)for(let _=0;_<a.length;_++){var l,d,f,m,y;const S=a[_],x=s[_];if(x instanceof Gn&&!Be(l=x._hints).call(l,jn.LOW_STREAM)&&(d=x._encoderConfig)!==null&&d!==void 0&&d.bitrateMax&&((f=x._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(m=x._scalabilityMode)!==null&&m!==void 0&&m.numSpatialLayers&&((y=x._scalabilityMode)===null||y===void 0?void 0:y.numSpatialLayers)>1&&this.store.codec==="vp8"){const A={},I={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};A.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const L=S.sender.getParameters();await S.sender.setParameters(Object.assign(L,A))}}}async applySimulcastEncodings(a,s){if(!dr()&&a.length===s.length)for(let l=0;l<a.length;l++){const d=s[l];if(d instanceof Gn&&this.isVP8Simulcast(d)){const f=a[l],m={},y={high:1e3*(d._encoderConfig.bitrateMax-50),medium:5e4};m.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:y.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:y.medium,scaleResolutionDownBy:4}];const _=f.sender.getParameters();await f.sender.setParameters(Object.assign(_,m))}}}isVP8Simulcast(a){var s,l,d,f,m;return!!(a instanceof Gn&&oe("SIMULCAST")&&this.store.codec==="vp8"&&!Be(s=a._hints).call(s,jn.LOW_STREAM)&&(l=a._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((d=a._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(f=a._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=a._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1)}logSDPExchange(a,s,l,d){if(oe("SDP_LOGGING"))return V.upload("[".concat(this.store.clientId,"] exchanging ").concat(l," ").concat(s," SDP during P2PConnection.").concat(d,`
`),a),s==="offer"?f=>{this.logSDPExchange(f,"answer",l==="local"?"remote":"local",d)}:void 0}async getRemoteSSRC(a){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(a);return s&&s.length!==0?s[0].ssrcId:void 0}setConfiguration(a){if(un().supportPCSetConfiguration){const s=Pp.resolvePCConfiguration(a);this.peerConnection.setConfiguration(s)}a.isPreallocation&&(this.isPreallocation=!0)}},rt(sn.prototype,"updateRemoteRTPCapabilities",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"updateRemoteRTPCapabilities"),sn.prototype),rt(sn.prototype,"connect",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"connect"),sn.prototype),rt(sn.prototype,"updateRemoteConnect",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"updateRemoteConnect"),sn.prototype),rt(sn.prototype,"createDataChannels",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"createDataChannels"),sn.prototype),rt(sn.prototype,"receive",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"receive"),sn.prototype),rt(sn.prototype,"batchReceive",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"batchReceive"),sn.prototype),rt(sn.prototype,"stopReceiving",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"stopReceiving"),sn.prototype),rt(sn.prototype,"muteRemote",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"muteRemote"),sn.prototype),rt(sn.prototype,"unmuteRemote",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"unmuteRemote"),sn.prototype),rt(sn.prototype,"muteLocal",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"muteLocal"),sn.prototype),rt(sn.prototype,"unmuteLocal",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"unmuteLocal"),sn.prototype),rt(sn.prototype,"close",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"close"),sn.prototype),rt(sn.prototype,"updateEncoderConfig",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"updateEncoderConfig"),sn.prototype),rt(sn.prototype,"updateSendParameters",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"updateSendParameters"),sn.prototype),rt(sn.prototype,"replaceTrack",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"replaceTrack"),sn.prototype),rt(sn.prototype,"updateAdaptation",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"updateAdaptation"),sn.prototype),rt(sn.prototype,"getRemoteSSRC",[Ya],Object.getOwnPropertyDescriptor(sn.prototype,"getRemoteSSRC"),sn.prototype),sn);function Ya(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("From P2PConnection.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}function MD(r,a){let s=document.createElement("video"),l=document.createElement("canvas");s.setAttribute("style","display:none"),l.setAttribute("style","display:none"),s.setAttribute("muted",""),s.muted=!0,s.setAttribute("autoplay",""),s.autoplay=!0,s.setAttribute("playsinline",""),l.width=Is(a.width),l.height=Is(a.height);const d=Is(a.framerate||15);document.body.append(s),document.body.append(l);let f=r._mediaStreamTrack;s.srcObject=new MediaStream([f]),s.play();const m=l.getContext("2d");if(!m)throw new Ee(ie.UNEXPECTED_ERROR,"can not get canvas context");const y=un(),_=l.captureStream(y.supportRequestFrame?0:d).getVideoTracks()[0];_.canvas||(_.canvas=l),l.startCapture=()=>{if(!s)return l.stopCapture&&l.stopCapture();if(s.paused&&s.play(),s.videoHeight>2&&s.videoWidth>2){const x=s.videoWidth,A=s.videoHeight/x,I=l.width*A;Math.abs(I-l.height)>=2&&(V.debug("adjust low stream resolution","".concat(l.width,"x").concat(l.height," -> ").concat(l.width,"x").concat(I)),l.height=I)}m.drawImage(s,0,0,l.width,l.height),_.requestFrame&&_.requestFrame(),f!==r._mediaStreamTrack&&(f=r._mediaStreamTrack,s.srcObject=new MediaStream([f]))},l.stopCapture=$j(()=>l.startCapture&&l.startCapture(),d);const S=_.stop;return _.stop=()=>{S.call(_),s&&(s.remove(),s.srcObject=null,s=null),l&&(l.width=0,l.remove(),l.stopCapture&&l.stopCapture(),l.startCapture=void 0,l.stopCapture=void 0,l=null),V.debug("clean low stream renderer")},_}var oq=function(r){return r[r.Video_Send_Type=190]="Video_Send_Type",r}(oq||{}),cl=function(r){return r[r.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",r[r.Video_Send_Freeze=2082]="Video_Send_Freeze",r[r.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",r[r.Video_Recv_Freeze=2084]="Video_Recv_Freeze",r[r.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",r[r.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",r[r.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",r[r.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",r}(cl||{}),Mt=function(r){return r[r.Video_Send_Retransmit=2062]="Video_Send_Retransmit",r[r.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",r[r.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",r[r.Video_Send_Transmit=2066]="Video_Send_Transmit",r[r.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",r[r.Video_Capture_Height=2033]="Video_Capture_Height",r[r.Video_Capture_Width=2035]="Video_Capture_Width",r[r.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",r[r.Video_Send_Low_Height=2073]="Video_Send_Low_Height",r[r.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",r[r.Video_Send_Low_Width=2077]="Video_Send_Low_Width",r[r.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",r[r.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",r[r.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",r[r.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",r[r.Video_Send_Width=2003]="Video_Send_Width",r[r.Video_Send_Height=2004]="Video_Send_Height",r[r.Video_Send_Disabled=2095]="Video_Send_Disabled",r[r.Video_Send_Adaptation=2032]="Video_Send_Adaptation",r[r.Video_Send_Player_Status=2128]="Video_Send_Player_Status",r[r.Video_Send_Nacks=2009]="Video_Send_Nacks",r[r.Video_Send_Plis=2010]="Video_Send_Plis",r[r.Video_Send_Firs=2011]="Video_Send_Firs",r[r.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",r[r.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",r[r.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",r[r.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",r[r.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",r[r.Video_Send_Bitrate=2012]="Video_Send_Bitrate",r[r.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",r[r.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",r[r.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",r[r.Audio_Send_Level=2038]="Audio_Send_Level",r[r.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",r[r.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",r[r.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",r[r.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",r[r.Audio_Send_Freeze=2081]="Audio_Send_Freeze",r[r.Audio_Send_Disabled=2096]="Audio_Send_Disabled",r[r.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",r[r.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",r[r.Video_Recv_Height=2019]="Video_Recv_Height",r[r.Video_Recv_Width=2018]="Video_Recv_Width",r[r.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",r[r.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",r[r.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",r[r.Video_Recv_Nacks=2026]="Video_Recv_Nacks",r[r.Video_Recv_Plis=2027]="Video_Recv_Plis",r[r.Video_Recv_Firs=2028]="Video_Recv_Firs",r[r.Video_Recv_Disabled=2101]="Video_Recv_Disabled",r[r.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",r[r.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",r[r.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",r[r.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",r[r.Audio_Render_Level=2043]="Audio_Render_Level",r[r.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",r[r.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",r[r.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",r[r.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",r[r.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",r[r.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",r[r.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",r[r.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",r[r.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",r[r.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",r[r.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",r[r.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",r}(Mt||{}),Ni=function(r){return r[r.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",r[r.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",r[r.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",r[r.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",r[r.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",r[r.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",r[r.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",r[r.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",r[r.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",r[r.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",r[r.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",r[r.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",r[r.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",r[r.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",r[r.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",r[r.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",r[r.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",r[r.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",r[r.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",r[r.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",r[r.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",r}(Ni||{}),Xa=function(r){return r[r.RTT=2006]="RTT",r[r.CONN_TYPE=801]="CONN_TYPE",r[r.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",r}(Xa||{}),UT=function(r){return r[r.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",r}(UT||{});const vp=1e3,FT=6,Ab=3,xOe=Math.max(FT,Ab,60);function yt(r,a,s){s!=null&&Number.isFinite(s)&&(r[a]=Math.round(Math.max(0,s)))}function cq(r){const a={[Xa.CONN_TYPE]:0,[Xa.RTT]:r.rtt,[Xa.STATS_UPDATE_INTERVAL]:r.updateInterval?Math.round(Math.max(0,r.updateInterval)):void 0};switch(r.selectedCandidatePair.localCandidate.candidateType){case"relay":{const s=r.selectedCandidatePair.localCandidate.relayProtocol;s==="udp"&&(a[Xa.CONN_TYPE]=1),s==="tcp"&&(a[Xa.CONN_TYPE]=3),s==="tls"&&(a[Xa.CONN_TYPE]=4);break}case"srflx":a[Xa.CONN_TYPE]=2;break;case"unknown":a[Xa.CONN_TYPE]=5;break;default:a[Xa.CONN_TYPE]=0}return a}function lq(r){let a=0;switch(r){case"none":a=0;break;case"cpu":a=1;break;case"bandwidth":a=2;break;case"other":a=3}return a}class uq extends cr{constructor(a){super(),Q(this,"store",void 0),Q(this,"uploadWRTCStatsTimer",void 0),Q(this,"uploadOutboundDenoiserStatsTimer",void 0),Q(this,"uploadExtStatsTimer",void 0),Q(this,"uploadExtUsageStatsTimer",void 0),Q(this,"uploadInboundExtStatsTimer",void 0),Q(this,"requestStats",void 0),Q(this,"requestTransportStats",void 0),Q(this,"requestLocalMedia",void 0),Q(this,"requestRemoteMedia",void 0),Q(this,"requestAllTracks",void 0),Q(this,"requestVideoIsReady",void 0),Q(this,"requestUploadStats",void 0),Q(this,"requestUpload",void 0),Q(this,"uploadOutboundStarted",!1),Q(this,"uploadInboundStarted",!1),Q(this,"uploadTransportStarted",!1),Q(this,"uploadBaseStatsStarted",!1),Q(this,"uploadExtensionUsageStarted",!1),Q(this,"lastRecvStats",void 0),Q(this,"lastSendStats",void 0),Q(this,"lastRefRecvStats",void 0),Q(this,"lastRefSendStats",void 0),Q(this,"lastNormalRecvStats",void 0),Q(this,"lastNormalSendStats",void 0),Q(this,"lastExtendStats",{}),Q(this,"needUploadStats",{}),Q(this,"needUploadRenderFreezeTime",!0),Q(this,"lastUploadCompensateTime",-1),Q(this,"uploadCompensateDeltaTime",0),this.store=a}uploadWRTCStats(a){if(!this.requestStats||!this.requestUploadStats)return;const s=a%Ab==0,l=a%FT==0,d=a%60==0;let f,m;if(this.uploadTransportStarted&&(f=this.requestStats(),this.store.useP2P&&(m=this.requestStats(!0))),!f&&this.uploadOutboundStarted&&(f=this.requestStats()),!m&&this.uploadInboundStarted&&(m=this.requestStats(!0)),f||m){var y;const _={};if(this.uploadTransportStarted&&f){const x=this.getTransportStats(f,m,s);x&&(_.misc=[x])}if(this.uploadOutboundStarted&&f){const x=this.getOutboundStats(f,l?this.lastNormalSendStats:void 0,s?this.lastRefSendStats:void 0,this.lastSendStats,d);x&&(_.outbound=[x])}if(this.uploadInboundStarted&&m){this.uploadCompensateStats(a);const x=this.getInboundStats(m,l?this.lastNormalRecvStats:void 0,s?this.lastRefRecvStats:void 0,this.lastRecvStats);x&&(_.inbound=x)}const S=(y=this.requestTransportStats)===null||y===void 0?void 0:y.call(this).connectState;S&&(Array.isArray(_.misc)?_.misc[0]&&_.misc[0].addition&&(_.misc[0].addition[UT.RTC_PEER_CONNECTION_STATE]=Cj[S]):_.misc=[{addition:{[UT.RTC_PEER_CONNECTION_STATE]:Cj[S]}}]),this.needUploadStats.sendType&&(Array.isArray(_.outbound)&&_.outbound[0]&&_.outbound[0].high&&(_.outbound[0].high[oq.Video_Send_Type]=this.needUploadStats.sendType),this.needUploadStats.sendType=void 0),this.requestUploadStats(_)}this.lastRecvStats=m,this.lastSendStats=f,l&&(this.lastNormalRecvStats=m,this.lastNormalSendStats=f),s&&(this.lastRefRecvStats=m,this.lastRefSendStats=f)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let a=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var s,l;const d=(s=this.requestTransportStats)===null||s===void 0?void 0:s.call(this);return void(d&&((l=this.requestUploadStats)===null||l===void 0||l.call(this,{misc:[{addition:{[UT.RTC_PEER_CONNECTION_STATE]:Cj[d.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(a),++a===xOe+1&&(a=1)},vp)}uploadCompensateStats(a){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const s=a%Ab==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!s)return;if(this.lastUploadCompensateTime===-1)return void(this.lastUploadCompensateTime=Date.now());const l=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=l,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const d=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*d;const f=this.requestStats(!0);new Array(d).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const m={};if(this.uploadInboundStarted&&f){const y=this.requestRemoteMedia()||[],_=[];y.forEach(S=>{let[x,A]=S;const I={peer:x.uid};if(x._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(x._videoSSRC)&&A.has(Je.VIDEO)&&x.videoTrack){const L=function(K,$,G){if(!$.videoRecv.find(te=>te.ssrc===K))return;const ne={};if(G&&G._player){const te=G._player,{renderFreezeAccTime2:ce,videoElementStatus:pe}=te;if(iu.visibility==="visible"&&pe===zi.PLAYING&&un().supportRequestVideoFrameCallback){const fe=Math.min(6e3,ce);te.renderFreezeAccTime2=Math.max(0,ce-fe),yt(ne,cl.Video_Render_Freeze_Time_Render2,fe),oe("USE_NEW_RENDER_FREEZE_TIME")&&yt(ne,cl.Video_Render_Freeze_Time_Render,fe)}}return ne}(x._videoSSRC,f,x.videoTrack);L&&(I.video=L)}I.video&&_.push(I)}),_.length>0&&(m.inbound=_,this.requestUploadStats(m))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(a,s,l){if(!this.requestStats)return;if(!l)return a.rtt==null?void 0:{addition:{[Xa.RTT]:a.rtt,[Xa.CONN_TYPE]:void 0,[Xa.STATS_UPDATE_INTERVAL]:a.updateInterval||void 0}};const d=cq(a);if(this.store.useP2P){if(s){const f=cq(s);d[Xa.CONN_TYPE]+=f[Xa.CONN_TYPE]<<3}d[Xa.CONN_TYPE]+=110}else d[Xa.CONN_TYPE]+=100;return{addition:d}}getOutboundStats(a,s,l,d,f){if(!this.requestUploadStats||!this.requestLocalMedia)return;const m=this.requestLocalMedia();if(!m||m.length===0)return;let y,_,S;return m.forEach(x=>{let[A,{track:I,ssrcs:L}]=x;switch(A){case De.LocalVideoLowTrack:case De.LocalVideoTrack:if(A===De.LocalVideoTrack){var K;const $=function(ce,pe,fe,ue,ye,Se){const Ie=pe.videoSend.find(Nt=>Nt.ssrc===ce);if(!Ie)return;const Me={},{sentFrame:Gt,inputFrame:Kt}=Ie;if(ue&&(yt(Me,cl.Video_Send_Qp_Sum,Ie.qpSumPerFrame),Kt&&Gt)){const Nt=Kt.frameRate,bn=Gt.frameRate;Me[cl.Video_Send_Freeze]=function(vn,Xi){let Re=!0;return Re=!(vn<=5)&&(vn<=10?Xi<3:vn<=20?Xi<4:Xi<5),Re}(Nt,bn)?1:0}if(ye){switch(Gt&&(yt(Me,Mt.Video_Send_Height,Gt.height),yt(Me,Mt.Video_Send_Width,Gt.width),yt(Me,Mt.Video_Send_Frame_Rate,Gt.frameRate)),Me[Mt.Video_Send_Disabled]=fe._originMediaStreamTrack&&!fe._originMediaStreamTrack.enabled||fe._mediaStreamTrack&&!fe._mediaStreamTrack.enabled?1:0,Ie.adaptionChangeReason){case"none":Me[Mt.Video_Send_Adaptation]=0;break;case"cpu":Me[Mt.Video_Send_Adaptation]=1;break;case"bandwidth":Me[Mt.Video_Send_Adaptation]=2;break;case"other":Me[Mt.Video_Send_Adaptation]=3}let Nt=0;Ie.adaptionChangeReason&&(Nt+=lq(Ie.adaptionChangeReason)),pe.qualityLimitationReason&&(Nt+=lq(pe.qualityLimitationReason)<<3),Me[Mt.Video_Send_Adaptation]=Nt,Me[Mt.Video_Send_Player_Status]=Vj[fe._player?fe._player.videoElementStatus:"uninit"],yt(Me,Mt.Video_Send_Nacks,Ie.nacksCount),yt(Me,Mt.Video_Send_Plis,Ie.plisCount),yt(Me,Mt.Video_Send_Firs,Ie.firsCount),yt(Me,Mt.Video_Send_Avg_Encode,Ie.avgEncodeMs),yt(Me,Mt.Video_Send_Huge_Frame_Sent,Ie.hugeFramesSent),yt(Me,Mt.Video_Send_Bytes_Retransmit,Ie.retransmittedBytesSent),yt(Me,Mt.Video_Send_Packages_Retransmit,Ie.retransmittedPacketsSent),yt(Me,Mt.Video_Send_Key_Frames_Encoded,Ie.keyFramesEncoded);const bn=ye.videoSend.find(vn=>vn.ssrc===ce);if(bn){let vn=vp*Ab;bn.timestamp&&Ie.timestamp&&(vn=Ie.timestamp-bn.timestamp),bn.packets!=null&&Ie.packets!=null&&yt(Me,Mt.Video_Send_Package_Rate,1e3*(Ie.packets-bn.packets)/vn),Ie.packetsLost!=null&&bn.packetsLost!=null&&yt(Me,Mt.Video_Send_Package_Lost,Ie.packetsLost-bn.packetsLost),bn.bytes!=null&&Ie.bytes!=null&&yt(Me,Mt.Video_Send_Bitrate,8*(Ie.bytes-bn.bytes)/vn)}}return Me}(L[0].ssrcId,a,I,s,l),G=I.__className__==="CameraVideoTrack"?3:Be(K=I._hints).call(K,jn.SCREEN_TRACK)?7:10;(this.lastExtendStats.sendType!==G||f)&&(this.needUploadStats={sendType:G},this.lastExtendStats.sendType=G);const ne=I&&function(ce,pe,fe,ue){const ye=pe.videoSend.find(Ie=>Ie.ssrc===ce);if(!ye)return null;const Se={};if(ue){const Ie=ye.inputFrame,Me=Ie&&Ie.height||fe.videoHeight||0,Gt=Ie&&Ie.width||fe.videoWidth||0,Kt=Ie&&Ie.frameRate||0;yt(Se,Mt.Video_Capture_Height,Me),yt(Se,Mt.Video_Capture_Width,Gt),yt(Se,Mt.Video_Capture_Frame_Rate,Kt)}return Se}(L[0].ssrcId,a,I,!!l),te=function(ce,pe){const fe={};return pe&&(yt(fe,Mt.Video_Send_Retransmit,ce.bitrate.retransmit),yt(fe,Mt.Video_Send_Target_Encoded,ce.bitrate.targetEncoded),yt(fe,Mt.Video_Send_Actual_Encoded,ce.bitrate.actualEncoded),yt(fe,Mt.Video_Send_Transmit,ce.bitrate.transmit),yt(fe,Mt.Video_Send_Bandwidth,ce.sendBandwidth)),fe}(a,!!l);_=Object.assign({},$,ne,te)}else S=function($,G,ne,te,ce){const pe=G.videoSend.find(ue=>ue.ssrc===$);if(!pe)return;const fe={};if(te){const ue=pe.sentFrame;ue&&(yt(fe,Mt.Video_Send_Low_Height,ue.height),yt(fe,Mt.Video_Send_Low_Width,ue.width),yt(fe,Mt.Video_Send_Low_Frame_Rate,ue.frameRate));const ye=te.videoSend.find(Se=>Se.ssrc===$);if(ye){let Se=vp*FT;ye.timestamp&&pe.timestamp&&(Se=pe.timestamp-ye.timestamp),ye.packets!=null&&pe.packets!=null&&yt(fe,Mt.Video_Send_Low_Package_Rate,1e3*(pe.packets-ye.packets)/Se),pe.packetsLost!=null&&ye.packetsLost!=null&&yt(fe,Mt.Video_Send_Low_Package_Lost,pe.packetsLost-ye.packetsLost),ye.bytes!=null&&pe.bytes!=null&&yt(fe,Mt.Video_Send_Low_Bitrate,8*(pe.bytes-ye.bytes)/Se)}}return fe}(L[0].ssrcId,a,0,l);break;case De.LocalAudioTrack:y=I&&function($,G,ne,te,ce,pe){const fe=G.audioSend.find(ye=>ye.ssrc===$);if(!fe)return;const ue={};if(ce){ue[Mt.Audio_Send_Disabled]=ne._originMediaStreamTrack&&!ne._originMediaStreamTrack.enabled||ne._mediaStreamTrack&&!ne._mediaStreamTrack.enabled?1:0;const ye=100*ne._source.getAccurateVolumeLevel(),Se=fe.inputLevel;if(Se!=null){const Me=Math.ceil(50*Math.log10(100*Se+1));yt(ue,Mt.Audio_Send_Level,Me)}yt(ue,Mt.Audio_Capture_PCM_Level,ye),yt(ue,Mt.Audio_Send_AEC_Return_Loss,fe.aecReturnLoss),yt(ue,Mt.Audio_Send_AEC_Return_Loss_Enhancement,fe.aecReturnLossEnhancement),yt(ue,Mt.Audio_Send_Bytes_Retransmit,fe.retransmittedBytesSent),yt(ue,Mt.Audio_Send_Packages_Retransmit,fe.retransmittedPacketsSent),ue[Mt.Audio_Send_Freeze]=0;const Ie=ce.audioSend.find(Me=>Me.ssrc===$);if(Ie){let Me=vp*FT;Ie.timestamp&&fe.timestamp&&(Me=fe.timestamp-Ie.timestamp),Ie.bytes!=null&&fe.bytes!=null&&yt(ue,Mt.Audio_Send_Bitrate,8*(fe.bytes-Ie.bytes)/Me),Ie.packets!=null&&fe.packets!=null&&yt(ue,Mt.Audio_Send_Package_Rate,1e3*(fe.packets-Ie.packets)/Me)}}return ue}(L[0].ssrcId,a,I,0,l)}}),{high:_,low:S,audio:y}}getInboundStats(a,s,l,d){if(!this.requestRemoteMedia)return;const f=this.requestRemoteMedia()||[],m=[];return f.forEach(y=>{let[_,S]=y;const x={peer:_.uid};if(S.has(Je.VIDEO)&&_.videoTrack){const A=_._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(_._videoSSRC)||!1,I=_.videoTrack?function(L,K,$,G,ne,te,ce,pe){const fe=K.videoRecv.find(Nt=>Nt.ssrc===L);if(!fe)return;const ue={},{receivedFrame:ye,outputFrame:Se,decodeFrameRate:Ie}=fe;yt(ue,Ni.Video_Render_Frame_Rate_Decode,Ie),fe.framesRateFirefox&&yt(ue,Ni.Video_Recv_Frame_Rate,fe.framesRateFirefox),ye&&yt(ue,Ni.Video_Recv_Frame_Rate,ye.frameRate),yt(ue,Ni.Video_Recv_Frame_Dropped,fe.framesDroppedCount),yt(ue,Ni.Video_Recv_Bytes_Retransmit,fe.retransmittedBytesReceived),yt(ue,Ni.Video_Recv_Packages_Retransmit,fe.retransmittedPacketsReceived),yt(ue,Ni.Video_Recv_Packages_Discarded,fe.packetsDiscarded),yt(ue,Ni.Video_Recv_Avg_Decode,fe.avgDecodeMs),yt(ue,Ni.Video_Recv_Avg_Processing_Delay,fe.avgProcessingDelayMs),yt(ue,Ni.Video_Recv_Avg_Assembly_Time,fe.avgFramesAssembledFromMultiplePacketsMs),yt(ue,Ni.Video_Recv_Avg_Inter_Frame_Delay,fe.avgInterFrameDelayMs),yt(ue,Ni.Video_Recv_Key_Frames_Decoded,fe.keyFramesDecoded);const Me=pe&&pe.videoRecv.find(Nt=>Nt.ssrc===L);if(Me){const Nt=K.timestamp-pe.timestamp||vp;fe.packetsLost!=null&&Me.packetsLost!=null&&yt(ue,Ni.Video_Recv_Package_Lost,fe.packetsLost-Me.packetsLost),Me.bytes!=null&&fe.bytes!=null&&yt(ue,Ni.Video_Recv_Bitrate,8*(fe.bytes-Me.bytes)/Nt),Me.packets!=null&&fe.packets!=null&&yt(ue,Ni.Video_Recv_Package_Rate,1e3*(fe.packets-Me.packets)/Nt)}const Gt=te&&te.videoRecv.find(Nt=>Nt.ssrc===L);if(Gt&&(yt(ue,cl.Video_Recv_Qp_Sum,fe.qpSumPerFrame),ue[cl.Video_Recv_Freeze]=G&&Nb.isRemoteVideoFreeze($,fe,Gt)?1:0),ce){var Kt;const Nt=ce.videoRecv.find(vn=>vn.ssrc===L);ye?(yt(ue,Mt.Video_Recv_Height,ye.height),yt(ue,Mt.Video_Recv_Width,ye.width)):$&&(yt(ue,Mt.Video_Recv_Height,$._videoHeight||0),yt(ue,Mt.Video_Recv_Width,$._videoWidth||0)),Se&&yt(ue,Mt.Video_Recv_Frame_Rate_Output,Se.frameRate);const bn=(Kt=$._player)===null||Kt===void 0?void 0:Kt.rendFrameRate.toFixed(0);if(bn&&yt(ue,Mt.Video_Render_Frame_Rate_Render,+bn),yt(ue,Mt.Video_Recv_Jitter_Buffer,fe.jitterBufferMs),yt(ue,Mt.Video_Recv_Current_Delay,fe.currentDelayMs),yt(ue,Mt.Video_Recv_Firs,fe.firsCount),yt(ue,Mt.Video_Recv_Nacks,fe.nacksCount),yt(ue,Mt.Video_Recv_Plis,fe.plisCount),$){ue[Mt.Video_Recv_Disabled]=$._originMediaStreamTrack.enabled&&$._mediaStreamTrack.enabled?0:1;const vn=$._player;if(vn){const{freezeTimeCounterList:Xi,renderFreezeAccTime:Re,renderFreezeAccTime2:Ve,videoElementStatus:Ze}=vn;if(Xi&&Xi.length>0&&yt(ue,cl.Video_Render_Freeze_Time,Xi.splice(0,1)[0]),ne&&iu.visibility==="visible"&&Ze===zi.PLAYING&&un().supportRequestVideoFrameCallback){const Oe=Math.min(6e3,Ve);vn.renderFreezeAccTime2=Math.max(0,Ve-Oe),yt(ue,cl.Video_Render_Freeze_Time_Render2,Oe);const B=Math.min(6e3,Re);vn.renderFreezeAccTime=Math.max(0,Re-B),yt(ue,cl.Video_Render_Freeze_Time_Render,oe("USE_NEW_RENDER_FREEZE_TIME")?Oe:B)}if(typeof fe.totalFreezesDuration=="number"){const Oe=Nt&&Nt.totalFreezesDuration?fe.totalFreezesDuration-Nt.totalFreezesDuration:fe.totalFreezesDuration;yt(ue,Mt.Video_Render_Freeze_Duration,1e3*Oe)}}}if(ue[Mt.Video_Recv_Player_Status]=Vj[$._player?$._player.videoElementStatus:"uninit"],Nt&&fe.totalInterFrameDelay!==void 0&&fe.totalSquaredInterFrameDelay!==void 0&&Nt.totalInterFrameDelay!==void 0&&Nt.totalSquaredInterFrameDelay!==void 0){const vn=fe.totalInterFrameDelay-Nt.totalInterFrameDelay,Xi=fe.totalSquaredInterFrameDelay-Nt.totalSquaredInterFrameDelay,Re=fe.framesDecodeCount-Nt.framesDecodeCount,Ve=vn/Re*1e3,Ze=Math.round(1e3*Math.sqrt((Xi-Math.pow(vn,2)/Re)/Re));!isNaN(Ze)&&Ve+Ze>Math.max(3*Ve,Ve+150)&&(ue[Mt.Video_Recv_I_Frame_Delay]=Ze)}}return ue}(_._videoSSRC,a,_.videoTrack,A===!0,this.needUploadRenderFreezeTime,s,l,d):void 0;I&&(x.video=I)}if(S.has(Je.AUDIO)&&_.audioTrack){const A=_.audioTrack?function(I,L,K,$,G,ne){const te=L.audioRecv.find(ue=>ue.ssrc===I);if(!te)return;const ce={};yt(ce,Ni.Audio_Recv_Jitter,te.jitterMs),yt(ce,Ni.Audio_Recv_Bytes_Retransmit,te.retransmittedBytesReceived),yt(ce,Ni.Audio_Recv_Packages_Retransmit,te.retransmittedPacketsReceived),yt(ce,Ni.Audio_Recv_Packages_Discarded,te.packetsDiscarded),yt(ce,Ni.Audio_Recv_Avg_Processing_Delay,te.avgProcessingDelayMs);const pe=ne&&ne.audioRecv.find(ue=>ue.ssrc===I);if(pe){const ue=vp;te.packets!=null&&pe.packets!=null&&yt(ce,Ni.Audio_Recv_Package_Rate,1e3*(te.packets-pe.packets)/ue),te.packetsLost!=null&&pe.packetsLost!=null&&yt(ce,Ni.Audio_Recv_Package_Lost,te.packetsLost-pe.packetsLost)}if($){const{receivedFrames:ue,droppedFrames:ye}=te;ue!=null&&ye!=null&&(ce[cl.Audio_Recv_Freeze]=(fe=ue)===0||100*ye/fe>20?1:0)}var fe;if(G){const ue=100*K._source.getAccurateVolumeLevel(),ye=te.outputLevel;if(ye!=null){const Ie=Math.ceil(50*Math.log10(100*ye+1));yt(ce,Mt.Audio_Render_Level,Ie)}yt(ce,Mt.Audio_Recv_PCM_Level,ue),K&&(ce[Mt.Audio_Recv_Disabled]=K._originMediaStreamTrack.enabled&&K._mediaStreamTrack.enabled?0:1),yt(ce,Mt.Audio_Recv_Jitter_Buffer,te.jitterBufferMs),yt(ce,Mt.Audio_Recv_Current_Delay,te.jitterBufferMs),ce[Mt.Audio_Recv_Player_Status]=Vj[qa.getPlayerState(K.getTrackId())];const Se=G.audioRecv.find(Ie=>Ie.ssrc===I);if(Se){Se.bytes!=null&&te.bytes!=null&&yt(ce,Mt.Audio_Recv_Bitrate,8*(te.bytes-Se.bytes)/(vp*Ab));const Ie=te.concealedSamples-Se.concealedSamples;Ie>0&&yt(ce,Mt.Audio_Recv_Concealed_Samples,Ie);const Me=te.totalSamplesReceived-Se.totalSamplesReceived;Me>0&&yt(ce,Mt.Audio_Recv_Total_Samples_Received,Me);const Gt=te.freezeSamples80-Se.freezeSamples80;Gt>0&&yt(ce,Mt.Audio_Render_Freeze_Samples_80ms,Gt);const Kt=te.freezeSamples200-Se.freezeSamples200;Kt>0&&yt(ce,Mt.Audio_Render_Freeze_Samples_200ms,Kt);const Nt=te.freezeMs80-Se.freezeMs80;yt(ce,Mt.Audio_Render_Freeze_Time_80ms,Nt<0?0:Nt);const bn=te.freezeMs200-Se.freezeMs200;yt(ce,Mt.Audio_Render_Freeze_Time_200ms,bn<0?0:bn)}}return ce}(_._audioSSRC,a,_.audioTrack,s,l,d):void 0;A&&(x.audio=A)}(x.video||x.audio)&&m.push(x)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,m}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const a=(this.requestAllTracks()||[]).find(s=>s instanceof gb);if(a&&a._external.getDenoiserStats){const s=a._external.getDenoiserStats();s&&this.requestUpload(yb.DENOISER_STATS,s)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(a=>{a.getProcessorStats().forEach(s=>{this.requestUpload&&this.requestUpload(s.type,s.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(a=>{let[s,l]=a;l.has(Je.VIDEO)&&s.videoTrack&&s.videoTrack.getProcessorStats().forEach(d=>{this.requestUpload&&this.requestUpload(d.type,d.stats)}),l.has(Je.AUDIO)&&s.audioTrack&&s.audioTrack.getProcessorStats().forEach(d=>{this.requestUpload&&this.requestUpload(d.type,d.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const a=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const s=Date.now(),l={connectionInterval:oe("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:s};let d=[];const f=this.requestAllTracks&&this.requestAllTracks()||[];for(const S of f)!S.muted&&S.enabled&&(d=d.concat(await S.getProcessorUsage()));const m=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[S,x]of m)x.has(Je.VIDEO)&&S.videoTrack&&(d=d.concat(await S.videoTrack.getProcessorUsage())),x.has(Je.AUDIO)&&S.audioTrack&&(d=d.concat(await S.audioTrack.getProcessorUsage()));if(d.length===0)return;l.details=function(S,x){const A={};for(const{id:$,value:G,level:ne,direction:te}of S){var I;const ce=(I=x.get($))!==null&&I!==void 0?I:0,pe=G===2?ce+oe("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:ce;var L,K;x.set($,pe),A[$]?(G===2&&(A[$].value=G),ne>A[$].level&&(A[$].level=ne),te==="remote"&&(A[$].remoteUidCount+=1),A[$].totalTs=(L=x.get($))!==null&&L!==void 0?L:0):A[$]={value:G,level:ne,remoteUidCount:te==="local"?0:1,totalTs:(K=x.get($))!==null&&K!==void 0?K:0}}return Object.keys(A).map($=>{const{level:G,value:ne,totalTs:te}=A[$];return{id:$,level:G,value:ne,totalTs:te}})}(d,a);const y=Date.now(),_=y>s?y:s+1;this.requestUpload&&this.requestUpload(yb.EXTENSION_USAGE_STATS,{usageStats:l,sendTs:_})},oe("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const TOe=oe("ICE_RESTART_INTERVAL");let VT=new Map,Gg=new Map,Sh=[qi.UDP_TCP_RELAY,qi.TCP_RELAY,qi.RELAY],UD=oe("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&un().supportPCSetConfiguration;function dq(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=VT.get(r.id);s&&(window.clearTimeout(s),VT.delete(r.id));const l=Gg.get(r.id);a&&l&&l.index===Sh.length-1&&(V.debug("[".concat(r.id,"] reset ICE restart policy")),Gg.delete(r.id))}function hq(r,a,s){if(VT.size===0&&Gg.size===0&&(Array.isArray(oe("RESTART_SEQUENCE"))&&oe("RESTART_SEQUENCE").length>0&&!function(y,_){if(y.length!==_.length)return!1;for(let S=0;S<y.length;S+=1){const x=y[S];if(y.filter(A=>A===x).length!==_.filter(A=>A===x).length)return!1}return!0}(Sh,oe("RESTART_SEQUENCE"))&&(Sh=oe("RESTART_SEQUENCE").filter(y=>{var _;if(Be(_=Object.values(qi)).call(_,y))return!0}),V.debug("use reconnection policy from config distribution, queues: ".concat(Sh.join(" => ")))),UD=oe("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&un().supportPCSetConfiguration),Sh.length===0)return void s();let l,{index:d=0,type:f}=Gg.get(r.id)||{};if(UD&&f===qi.RELAY)return void s();let m=f&&d>=Sh.length-1;if(UD)f=qi.RELAY;else{if(m)return void s();f?(d++,f=Sh[d]):(f=Sh[0],d=0)}V.debug("[".concat(r.id,"] choose ICE restart policy: ").concat(f,", index: ").concat(d)),a(f),Gg.set(r.id,{index:d,type:f}),l=window.setTimeout(()=>hq(r,a,s),TOe),VT.set(r.id,l)}var Jt;function fq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ou(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?fq(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):fq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function pq(r){var a,s,l,d=2;for(typeof Symbol<"u"&&(s=Qk,l=Symbol.iterator);d--;){if(s&&(a=r[s])!=null)return a.call(r);if(l&&(a=r[l])!=null)return new BT(a.call(r));s="@@asyncIterator",l="@@iterator"}throw new TypeError("Object is not async iterable")}function BT(r){function a(s){if(Object(s)!==s)return He.reject(new TypeError(s+" is not an object."));var l=s.done;return He.resolve(s.value).then(function(d){return{value:d,done:l}})}return BT=function(s){this.s=s,this.n=s.next},BT.prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(s){var l=this.s.return;return l===void 0?He.resolve({value:s,done:!0}):a(l.apply(this.s,arguments))},throw:function(s){var l=this.s.return;return l===void 0?He.reject(s):a(l.apply(this.s,arguments))}},new BT(r)}let Ib=(Jt=class extends cr{get state(){return this._state}set state(r){const a=this._state;this._state=r,this.emit(dt.StateChange,a,this._state)}constructor(r,a){super(),Q(this,"isPlanB",void 0),Q(this,"store",void 0),Q(this,"statsUploader",void 0),Q(this,"connection",void 0),Q(this,"localTrackMap",new Map),Q(this,"remoteUserMap",new Map),Q(this,"localDataChannels",[]),Q(this,"remoteDataChannelMap",new Map),Q(this,"pendingLocalTracks",[]),Q(this,"pendingRemoteTracks",[]),Q(this,"pendingLocalDataChannels",[]),Q(this,"pendingRemoteDataChannels",[]),Q(this,"statsCollector",void 0),Q(this,"shouldForwardP2PCreation",void 0),Q(this,"iceFailedCount",0),Q(this,"dtlsFailedCount",0),Q(this,"mutex",void 0),Q(this,"_state",wn.Disconnected),Q(this,"_pcStatsUploadType",oe("NEW_ICE_RESTART")?od.FIRST_CONNECTION:od.OLD_FIRST_CONNECTION),Q(this,"_isStartRestartIce",!1),Q(this,"_restartTimer",void 0),Q(this,"_isTryConnecting",!1),Q(this,"_iceError",null),Q(this,"_forceTurn",!1),Q(this,"_isWaitPcToRePub",!1),Q(this,"handleMuteLocalTrack",async(s,l,d)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==wn.Connected)return void d(new we(ie.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const m=this.filterTobeMutedTracks(s);if(m.length===0)return void l();const y=m.find(S=>S[0]==="videoLowTrack");if(y){const S=y[1];this.store.enableInstantMuteRestore?(S.track._originMediaStreamTrack.enabled=!1,V.info("[".concat(this.store.clientId,"] P2PChannel muteLocalLowTrack without close sender because enableInstantMuteRestore is true"))):S.track._originMediaStreamTrack.stop()}this.store.enableInstantMuteRestore?V.info("[".concat(this.store.clientId,"] P2PChannel muteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.muteLocal(m.map(S=>{let[,{id:x}]=S;return x}));const _=this.createMuteMessage(m);await Ln(this,dt.RequestMuteLocal,_),l()}catch(m){d(m)}finally{f()}}),Q(this,"handleUnmuteLocalTrack",async(s,l,d)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==wn.Connected)return void d(new we(ie.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const m=this.filterTobeUnmutedTracks(s);if(m.length===0)return void l();const y=m.find(S=>S[0]==="videoLowTrack");if(y){const S=y[1];if(this.store.enableInstantMuteRestore)S.track._originMediaStreamTrack.enabled=!0,V.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalLowTrack without close sender because enableInstantMuteRestore is true"));else{if(S.track._originMediaStreamTrack.stop(),!oe("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding){const x=s._mediaStreamTrack.clone();S.track._mediaStreamTrack=x,S.track._originMediaStreamTrack=x}else{const x=MD(s,lb(this,dt.RequestLowStreamParameter));S.track._mediaStreamTrack=x,S.track._originMediaStreamTrack=x}await new He((x,A)=>{this.handleReplaceTrack(S.track,x,A,!0)})}}this.store.enableInstantMuteRestore?V.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.unmuteLocal(m.map(S=>{let[,{id:x}]=S;return x}));const _=this.createUnmuteMessage(m);await Ln(this,dt.RequestUnmuteLocal,_),l()}catch(m){d(m)}finally{f()}}),Q(this,"handleUpdateVideoEncoder",async(s,l,d,f)=>{let m;f||(m=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const _=this.localTrackMap.get(De.LocalVideoTrack);if(!this.connection||!_||_.track!==s||this.state!==wn.Connected)return void l();const{id:S,track:x}=_;await this.connection.updateSendParameters(S,x),await this.connection.updateEncoderConfig(S,x),this.emit(dt.UpdateVideoEncoder,x),l()}catch(_){d(_)}finally{var y;(y=m)===null||y===void 0||y()}}),Q(this,"handleUpdateVideoSendParameters",async(s,l,d)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const m=this.localTrackMap.get(De.LocalVideoTrack);if(!this.connection||!m||m.track!==s||this.state!==wn.Connected)return void l();const{id:y,track:_}=m;await this.connection.updateSendParameters(y,_),l()}catch(m){d(m)}finally{f()}}),Q(this,"handleReplaceMixingTrack",async(s,l,d,f)=>{if(!this.connection||this.state!==wn.Connected)return void l();const m=DD([s]);let y;V.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(m.getTrackId(),"]")),typeof f=="boolean"&&f||(y=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(s,m),l()}catch(S){d(S)}finally{var _;(_=y)===null||_===void 0||_()}}),Q(this,"handleReplaceTrack",async(s,l,d,f)=>{let m;V.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof f=="boolean"&&f||(m=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var y;const S=Array.from(this.localTrackMap.entries()).find(x=>{let[,{track:A}]=x;return s===A});if(!this.connection||!S||this.state!==wn.Connected)return void l();if(await((y=this.connection)===null||y===void 0?void 0:y.replaceTrack(s,S[1].id)),this.isPlanB){const x=S[1];x.id=s._mediaStreamTrack.id,this.localTrackMap.set(S[0],x)}if(S[0]===De.LocalVideoTrack&&!oe("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding){const x=this.localTrackMap.get(De.LocalVideoLowTrack);if(x){const A=s._mediaStreamTrack.clone();x.track._originMediaStreamTrack.stop(),x.track._mediaStreamTrack=A,x.track._originMediaStreamTrack=A,await new He((I,L)=>{this.handleReplaceTrack(x.track,I,L,!0)})}}l()}catch(S){d(S)}finally{var _;(_=m)===null||_===void 0||_()}}),Q(this,"handleGetRTCStats",s=>{s(this.statsCollector.getRTCStats())}),Q(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),Q(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),Q(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),Q(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=r,this.statsCollector=a,this.statsCollector.addP2PChannel(this),this.statsUploader=new uq(this.store),this.bindStatsUploaderEvents(),this.mutex=new Hi("P2PChannel-mutex",this.store.clientId),this.isPlanB=!un().supportUnifiedPlan||oe("CHROME_FORCE_PLAN_B")&&rd(),this.shouldForwardP2PCreation=oe("FORWARD_P2P_CREATION")&&un().supportPCSetConfiguration&&fj(),this.shouldForwardP2PCreation&&(this.connection=MT(this.store),this.emit(dt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(r,a){var s;this.state=wn.New,this._forceTurn=aq(r),V.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const l=this.shouldForwardP2PCreation&&((s=this.connection)===null||s===void 0?void 0:s.peerConnectionState)==="closed";if((!this.shouldForwardP2PCreation||l||a)&&((l||a)&&this.connection&&(V.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=MT(this.store,r),this.emit(dt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new we(ie.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=oe("NEW_ICE_RESTART")?od.FIRST_CONNECTION:od.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(r),this.connection.establishPromise}async connect(r){if(!this.connection)throw new we(ie.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");if(this.isPreallocation()&&this.state===wn.Connected){if(this.connection instanceof Ao&&this.connection.checkDtlsParameters(r.dtlsParameters.fingerprints))return V.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] dtls parameters mismatch, try next.")),it.reportApiInvoke(this.store.sessionId,{name:Er.MISMATCH_DTLS_PARAMETERS,options:[r.dtlsParameters.fingerprints],tag:rr.TRACER}).onSuccess(),void setTimeout(()=>{this.emit(dt.RequestReconnect)});await this.connection.updateRemoteConnect(r)}else this.store.peerConnectionStart(),await this.connection.connect(r),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=wn.Connected}updateRemoteRTPCapabilities(r){const a=Array.from(this.localTrackMap.entries()).filter(d=>{var f;let[m]=d;return Be(f=[De.LocalVideoLowTrack,De.LocalVideoTrack]).call(f,m)}),s=a.map(d=>{let[,{id:f}]=d;return f}),l=a.map(d=>{let[f]=d;return f});if(this.connection instanceof Ao){if(it.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(l),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(r)}),!Be(r).call(r,this.store.codec)){const d=["vp9","vp8","h264"].find(f=>Be(r).call(r,f));d&&(this.store.codec=d,V.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(d,".")))}this.connection.updateRemoteRTPCapabilities(s,r)}}async getEstablishParams(){var r;if(this.connection instanceof Ao&&this.connection.peerConnectionState!=="closed"&&Be(r=[wn.New,wn.Connected]).call(r,this.state))return this.connection.establishPromise}async publishDataChannel(r){if(!this.connection||this.state!==wn.Connected){if(this.state===wn.Disconnected)throw new we(ie.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return r.forEach(s=>{var l;Be(l=this.pendingLocalDataChannels).call(l,s)||this.pendingLocalDataChannels.push(s)}),[]}const a=this.filterTobePublishedDataChannels(r);return a.length===0?[]:(a.forEach(s=>{const l=Date.now();this.store.publish(s.id.toString(),"datachannel",l)}),await this.connection.createDataChannels(this.store.uid,a),a.forEach(s=>{this.localDataChannels.push(s);const l=Date.now();this.store.publish(s.id+"","datachannel",void 0,l)}),r.map(s=>({streamId:s.id,ordered:s.ordered,maxRetransmits:s.maxRetransmits,metadata:s.metadata,channelId:s._originDataChannelId})))}publish(r,a,s){var l=this;return So(function*(){const d=yield ln(l.mutex.lock("From P2PChannel.publish"));try{var f;const m=l.connection&&Be(f=["disconnected","failed"]).call(f,l.connection.peerConnectionState);if(!l.connection||l.state!==wn.Connected||m){if(l.state===wn.Disconnected)throw new we(ie.UNEXPECTED_ERROR,"PeerConnection already disconnected.");l.throwIfTrackTypeNotMatch(r);const _=r.filter(S=>l.pendingLocalTracks.indexOf(S)===-1);return l.pendingLocalTracks=l.pendingLocalTracks.concat(_),void(m&&(l._isWaitPcToRePub=!0))}l.store.pubId=l.store.pubId+1,Yi.markPublishStart(l.store.clientId,l.store.pubId);const y=l.filterTobePublishedTracks(r,a,s);if(y.length===0)return void(yield ln(l.tryToUnmuteAudio(r)));yield*kx(pq(l.doPublish(l.connection,y)))}finally{d()}})()}doPublish(r,a){var s=this;return So(function*(){a.forEach(I=>{let{track:L,type:K}=I;const $=Date.now();s.store.publish(L.getTrackId(),K===De.LocalAudioTrack?"audio":"video",$)}),s.bindLocalTrackEvents(a);const l=a.map(I=>{let{track:L}=I;return L}),d=yield ln(r.send(l,s.store.codec,s.store.audioCodec)),f=(yield ln(d.next())).value,m=s.createGatewayPublishMessage(a,f);let y;try{y=yield m}catch(I){throw d.throw(I),(I==null?void 0:I.code)===ie.WS_ABORT&&a.forEach(L=>{let{track:K}=L;s.pendingLocalTracks.indexOf(K)===-1&&s.pendingLocalTracks.push(K)}),s.unbindLocalTrackEvents(a),I}const _=s.mapPubResToRemoteConfig(m,y,l),S=(yield ln(d.next(_))).value;if(s.state===wn.Disconnected)throw new we(ie.UNEXPECTED_ERROR,"PeerConnection already disconnected.");oe("ENABLE_VIDEO_SEI");const x=oe("ENABLE_ENCODED_TRANSFORM"),A=oe("ENABLE_AUDIO_METADATA");l.forEach(async I=>{const L=I.getRTCRtpTransceiver();if(!L||!x)return;const{interceptLocalVideoFrame:K,interceptLocalAudioFrame:$}=NT();I.trackMediaType===Je.VIDEO?await K(L.sender,I):I.trackMediaType===Je.AUDIO&&await $(L.sender,{metadata:A?()=>{const G=I.metadata.shift();return G&&G.value}:void 0})}),a.forEach(I=>{let{type:L}=I;s.statsCollector.addLocalStats(L)}),s.assignLocalTracks(a,S),s.statsUploader.startUploadOutboundStats(),a.forEach(I=>{let{track:L,type:K}=I;const $=Date.now();s.store.publish(L.getTrackId(),K===De.LocalAudioTrack?"audio":"video",void 0,$)})})()}async updateVideoStreamParameter(r,a){const s=this.localTrackMap.get(a);if(!s||!this.connection)return;if(!(s.track instanceof Gn))return V.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:l}=s,d=function(f,m){const y={};return f.height&&f.width&&(y.scaleResolutionDownBy=vD(f,m)),y.maxFramerate=f.framerate?Is(f.framerate):void 0,y.maxBitrate=f.bitrate?1e3*f.bitrate:void 0,y}(r,l);if(l._encoderConfig||(l._encoderConfig={}),a!==De.LocalVideoLowTrack||!oe("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding)d.scaleResolutionDownBy!=null&&(l._encoderConfig.scaleResolutionDownBy=d.scaleResolutionDownBy);else{const f=l._originMediaStreamTrack;if(!f.canvas)return V.warn("[".concat(l.getTrackId(),"] no canvas on track"));(function(m,y){const _=m.canvas;y.width&&(_.width=Is(y.width)),y.height&&(_.height=Is(y.height)),y.framerate&&(_.stopCapture&&_.stopCapture(),_.stopCapture=$j(()=>{!_.startCapture&&_.stopCapture&&_.stopCapture(),_.startCapture&&_.startCapture()},Is(y.framerate)))})(f,r)}d.maxBitrate!=null&&(l._encoderConfig.bitrateMax=d.maxBitrate/1e3),d.maxFramerate!=null&&(l._encoderConfig.frameRate&&typeof l._encoderConfig.frameRate=="object"?l._encoderConfig.frameRate.max=d.maxFramerate:l._encoderConfig.frameRate={max:d.maxFramerate}),V.debug("[".concat(l.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(l._encoderConfig))),await this.connection.updateRtpSenderEncodings(l)}publishLowStream(r){var a=this;return So(function*(){if(!a.connection||a.state!==wn.Connected)return;const s=yield ln(a.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const d=a.localTrackMap.get(De.LocalVideoTrack);if(!d)throw new we(ie.UNEXPECTED_ERROR,"Could not find high stream");if(a.localTrackMap.has(De.LocalVideoLowTrack))throw new we(ie.UNEXPECTED_ERROR,"[".concat(a.store.clientId,"] Can't publish low stream when stream already publish"));const f=[{track:a.getLowVideoTrack(d.track,r),type:De.LocalVideoLowTrack}];if(yield*kx(pq(a.doPublish(a.connection,f))),d.track.muted||!d.track.enabled){var l;const m=(l=a.localTrackMap.get(De.LocalVideoLowTrack))===null||l===void 0?void 0:l.id;m!==void 0&&(yield ln(a.connection.muteLocal([m])))}}finally{s()}})()}async republish(){this.pendingLocalTracks.length>0&&(V.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Li(this,dt.RequestRePublish,this.pendingLocalTracks),this.emit(dt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(V.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Li(this,dt.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(r){for(let a=this.pendingRemoteTracks.length-1;a>=0;a--){const{user:s,kind:l}=this.pendingRemoteTracks[a];(l!==Je.AUDIO||s._audio_added_&&s._audioSSRC)&&(l!==Je.VIDEO||s._video_added_&&s._videoSSRC)||this.pendingRemoteTracks.splice(a,1)}if(r)await Li(this,dt.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:a,kind:s}of this.pendingRemoteTracks)await this.subscribe(a,s,s===Je.VIDEO?a._videoSSRC:a._audioSSRC);this.pendingRemoteTracks.forEach(a=>{let{user:s}=a;this.emit(dt.MediaReconnectEnd,s.uid)}),this.pendingRemoteTracks=[]}async unpublish(r){if(!this.connection||this.state!==wn.Connected)return void r.forEach(l=>{const d=this.pendingLocalTracks.indexOf(l);d!==-1&&this.pendingLocalTracks.splice(d,1)});const a=this.filterTobeUnpublishedTracks(r);if(a.length===0)return;const s=a.find(l=>l[0]==="videoLowTrack");return s&&s[1].track.close(),this.doUnpublish(this.connection,a)}async unpublishDataChannel(r){if(!this.connection||this.state!==wn.Connected)return void r.forEach(s=>{const l=this.pendingLocalDataChannels.indexOf(s);l!==-1&&this.pendingLocalDataChannels.splice(l,1)});const a=this.filterTobeUnpublishedDataChannels(r);return a.length!==0?(a.forEach(s=>{const l=this.localDataChannels.indexOf(s);l!==-1&&this.localDataChannels.splice(l,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),a.map(s=>s.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==wn.Connected)return;const r=this.localTrackMap.get(De.LocalVideoLowTrack);if(!r)return;r.track.close();const a=[[De.LocalVideoLowTrack,r]];return this.doUnpublish(this.connection,a)}async doUnpublish(r,a){const s=this.createGatewayUnpublishMessage(a);return await r.stopSending(a.map(l=>{let[,{id:d}]=l;return d})),this.withdrawLocalTracks(a),this.unbindLocalTrackEvents(a.map(l=>{let[d,{track:f}]=l;return{type:d,track:f}})),a.forEach(l=>{let[d]=l;this.statsCollector.removeLocalStats(d)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),s}async subscribeDataChannel(r,a){if(!this.connection||this.state!==wn.Connected)throw new we(ie.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const s=a.filter(l=>{var d;return!((d=this.remoteDataChannelMap.get(r))!==null&&d!==void 0&&d.get(l.id))});if(s.length!==0)return await this.connection.createDataChannels(r.uid,s),s.forEach(l=>{var d;this.remoteDataChannelMap.has(r)?(d=this.remoteDataChannelMap.get(r))===null||d===void 0||d.set(l.id,l):this.remoteDataChannelMap.set(r,new Map([[l.id,l]]));const f=this.pendingRemoteDataChannels.findIndex(m=>{let{user:y,id:_}=m;return y.uid===r.uid&&_===l.id});f!==-1&&this.pendingRemoteDataChannels.splice(f,1)}),s.map(l=>l.id)}async subscribe(r,a,s,l,d){var f;if(!this.connection||this.state!==wn.Connected)throw new we(ie.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((f=this.remoteUserMap.get(r))!==null&&f!==void 0&&f.has(a))return;let m,y,_,S;const x=this.connection.getPreMedia(s);if(x)V.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(s,", no need to send sub to gateway.")),_=x.transceiver,m=x.track,y=x.mid,S=x.player,x.firstVideoRender&&this.store.firstVideoFrameDecoded(r.uid,{firstPreRender:x.firstVideoRender});else if(d){const L=d.find($=>{let{stream_type:G}=$;return G===a});if(!L)throw new we(ie.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(a," for user: ").concat(r.uid," because subscribe answer from gateway does not contain stream_type: ").concat(a,"."));const K=await this.connection.receive(a,L.ssrcs,String(r._uintid),L.attributes);this.connection instanceof Ao&&(_=K.transceiver),m=K.track,y=K.id}else{const L=await this.connection.receive(a,[{ssrcId:s,rtx:l}],String(r._uintid),void 0);this.connection instanceof Ao&&(_=L.transceiver),m=L.track,y=L.id}if(a===Je.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(m):(r._audioTrack=new Og(m,r.uid,r._uintid,this.store),V.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),_&&r._audioTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(m):(r._videoTrack=new Ig(m,r.uid,r._uintid,this.store,S),V.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId())),r._videoTrack.once(Co.PLAY_START,()=>{this.store.firstVideoFrameDecoded(r.uid,{playStart:Date.now()})}),r._videoTrack.once(Co.PLAY_END,()=>{this.store.firstVideoFrameDecoded(r.uid,{playEnd:Date.now()}),this.reportVideoFirstFrameRender(r)}),S?r._videoTrack.once(Co.FIRST_FRAME_RENDER,()=>{this.store.firstVideoFrameDecoded(r.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(r)}):r._videoTrack.once(Co.FIRST_FRAME_DECODED,()=>{this.store.firstVideoFrameDecoded(r.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(r)})),_&&r._videoTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(r,r._videoTrack)),_&&oe("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:L,interceptRemoteAudioFrame:K}=NT();a==Je.VIDEO?await L(_.receiver,{onSei:oe("ENABLE_VIDEO_SEI")&&($=>{var G;return(G=r._videoTrack)===null||G===void 0?void 0:G._onSei($)})}):a==Je.AUDIO&&await K(_.receiver,{enableTopn:!!oe("ENABLE_AUDIO_TOPN"),enableMetadata:!!oe("ENABLE_AUDIO_METADATA"),enablePts:!!oe("ENABLE_AUDIO_PTS"),onMetadata:$=>{this.safeEmit(dt.AudioMetadata,$)},onPts:$=>{this.safeEmit(dt.AudioPts,$)}})}const A=this.remoteUserMap.get(r);A?A.set(a,y):this.remoteUserMap.set(r,new Map([[a,y]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadInboundStats();const I=this.pendingRemoteTracks.findIndex(L=>{let{user:K,kind:$}=L;return K.uid===r.uid&&a===$});I!==-1&&(this.pendingRemoteTracks.splice(I,1),this.emit(dt.MediaReconnectEnd,r.uid))}async massSubscribe(r){return this.massSubscribeNoLock(r)}async massSubscribeNoLock(r){if(!this.connection||this.state!==wn.Connected)throw new we(ie.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");r=r.filter(d=>{var f;let{user:m,mediaType:y}=d;return!((f=this.remoteUserMap.get(m))!==null&&f!==void 0&&f.has(y))});const a=[],s=new Map;r.forEach(d=>{if(!this.connection)return;const f=this.connection.getPreMedia(d.ssrcId);if(f){const{track:m,mid:y,transceiver:_,player:S}=f;s.set(d.ssrcId,{track:m,id:y,transceiver:_,player:S})}else a.push(d)});const l=await this.connection.batchReceive(a.map(d=>{let{user:f,mediaType:m,ssrcId:y,rtxSsrcId:_}=d;return{kind:m,ssrcMsg:[{ssrcId:y,rtx:_}],mslabel:String(f._uintid)}}));a.forEach((d,f)=>{s.set(d.ssrcId,l[f])});for(const{user:d,mediaType:f,ssrcId:m}of r){const y=s.get(m);if(!y)return void V.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(d.uid," subscribe data,").concat(f,", ").concat(m));const{track:_,id:S,transceiver:x,player:A}=y;if(x&&oe("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:K,interceptRemoteAudioFrame:$}=NT();f==Je.VIDEO?await K(x.receiver,{onSei:oe("ENABLE_VIDEO_SEI")&&(G=>{var ne;return(ne=d._videoTrack)===null||ne===void 0?void 0:ne._onSei(G)})}):f==Je.AUDIO&&await $(x.receiver,{enableTopn:!!oe("ENABLE_AUDIO_TOPN"),enableMetadata:!!oe("ENABLE_AUDIO_METADATA"),enablePts:!!oe("ENABLE_AUDIO_PTS"),onMetadata:G=>{this.safeEmit(dt.AudioMetadata,G)},onPts:G=>{this.safeEmit(dt.AudioPts,G)}})}if(f===Je.AUDIO?(d._audioTrack?d._audioTrack._updateOriginMediaStreamTrack(_):(d._audioTrack=new Og(_,d.uid,d._uintid,this.store),V.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(d._audioTrack.getTrackId()))),x&&d._audioTrack._updateRtpTransceiver(x),this.bindRemoteTrackEvents(d,d._audioTrack)):(d._videoTrack?d._videoTrack._updateOriginMediaStreamTrack(_):(d._videoTrack=new Ig(_,d.uid,d._uintid,this.store,A),V.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(d._videoTrack.getTrackId()))),x&&d._videoTrack._updateRtpTransceiver(x),this.bindRemoteTrackEvents(d,d._videoTrack)),oe("ENABLE_VIDEO_SEI")&&x){const{interceptRemoteVideoFrame:K,interceptRemoteAudioFrame:$}=NT();f==Je.VIDEO?await K(x.receiver,{onSei:G=>{var ne;(ne=d._videoTrack)===null||ne===void 0||ne._onSei(G)}}):f==Je.AUDIO&&await $(x.receiver)}const I=this.remoteUserMap.get(d);I?I.set(f,S):this.remoteUserMap.set(d,new Map([[f,S]])),this.statsCollector.addRemoteStats(d.uid),this.statsUploader.startUploadInboundStats();const L=this.pendingRemoteTracks.findIndex(K=>{let{user:$,kind:G}=K;return $.uid===d.uid&&f===G});L!==-1&&(this.pendingRemoteTracks.splice(L,1),this.emit(dt.MediaReconnectEnd,d.uid))}}async unsubscribe(r,a,s){const l=this.pendingRemoteTracks.filter(m=>{let{user:y,kind:_}=m;return a!==void 0?y.uid===r.uid&&a===_:y.uid===r.uid});if(l.forEach(m=>{const y=this.pendingRemoteTracks.indexOf(m);this.pendingRemoteTracks.splice(y,1)}),this.connection&&this.state===wn.Connected||s||l.forEach(m=>{let{kind:y}=m;var _;if(y===Je.AUDIO)(_=r._audioTrack)===null||_===void 0||_._destroy(),r._audioTrack=void 0;else if(y===Je.VIDEO){var S;(S=r._videoTrack)===null||S===void 0||S._destroy(),r._videoTrack=void 0}}),!this.connection||this.state!==wn.Connected)return;const d=this.filterTobeUnSubscribedTracks(r,a);if(d.length===0)return;await this.connection.stopReceiving(d.map(m=>{let[,{id:y}]=m;return y}));const f=this.createUnsubscribeMessage(d);return this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),d.forEach(m=>{let[y,{kind:_}]=m;var S,x;if(_===Je.VIDEO&&y._videoSSRC&&((S=this.connection)===null||S===void 0||S.setStatsRemoteVideoIsReady(y._videoSSRC,!1)),_===Je.VIDEO)this.unbindRemoteTrackEvents(y._videoTrack),s||((x=y._videoTrack)===null||x===void 0||x._destroy(),y._videoTrack=void 0);else if(_===Je.AUDIO){var A;this.unbindRemoteTrackEvents(y._audioTrack),!s&&((A=y._audioTrack)===null||A===void 0||A._destroy(),y._audioTrack=void 0)}}),f}async unsubscribeDataChannel(r,a){if(a.forEach(d=>{const f=this.pendingRemoteDataChannels.findIndex(m=>m.id===d.id);f!==-1&&this.pendingRemoteDataChannels.splice(f,1)}),!this.connection)return;const s=this.filterTobeUnSubscribedDataChannels(r,a);if(s.length===0)return;a.forEach(d=>{d._close()});const l=this.remoteDataChannelMap.get(r);return s.forEach(d=>{l&&l.delete(d.id)}),l&&l.size===0&&(this.remoteDataChannelMap.delete(r),await this.connection.stopDataChannels(r.uid)),s.map(d=>d.id)}async massUnsubscribe(r){return this.massUnsubscribeNoLock(r)}async massUnsubscribeNoLock(r){let a=[];for(const{user:d,mediaType:f}of r){const m=this.pendingRemoteTracks.filter(y=>{let{user:_,kind:S}=y;return f!==void 0?_.uid===d.uid&&f===S:_.uid===d.uid});m.forEach(y=>{const _=this.pendingRemoteTracks.indexOf(y);this.pendingRemoteTracks.splice(_,1)}),a=a.concat(m)}if(!this.connection||this.state!==wn.Connected)return void a.forEach(d=>{let{user:f,kind:m}=d;var y;if(m===Je.AUDIO)(y=f._audioTrack)===null||y===void 0||y._destroy(),f._audioTrack=void 0;else if(m===Je.VIDEO){var _;(_=f._videoTrack)===null||_===void 0||_._destroy(),f._videoTrack=void 0}});const s=rc(r).call(r,(d,f)=>{let{user:m,mediaType:y}=f;const _=this.filterTobeUnSubscribedTracks(m,y);return d.concat(_)},[]);if(s.length===0)return;await this.connection.stopReceiving(s.map(d=>{let[,{id:f}]=d;return f}));const l=this.createUnsubscribeAllMessage(s);return this.withdrawRemoteTracks(s),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),s.forEach(d=>{let[f,{kind:m}]=d;var y,_;if(m===Je.VIDEO&&f._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(f._videoSSRC,!1)),m===Je.VIDEO)this.unbindRemoteTrackEvents(f._videoTrack),(_=f._videoTrack)===null||_===void 0||_._destroy(),f._videoTrack=void 0;else if(m===Je.AUDIO){var S;this.unbindRemoteTrackEvents(f._audioTrack),(S=f._audioTrack)===null||S===void 0||S._destroy(),f._audioTrack=void 0}}),l}isPreSubScribe(r){return!this.connection||this.state!==wn.Connected?!1:!!this.connection.getPreMedia(r)}async muteRemote(r,a){if(!this.connection)return;const s=this.remoteUserMap.get(r);if(!s)return void V.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(r.uid,"."));if(!s.get(a))return void V.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."));const l=a===Je.VIDEO?r._videoSSRC:r._audioSSRC;l!==void 0&&this.connection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(r,a){return this.unmuteRemoteNoLock(r,a)}async unmuteRemoteNoLock(r,a){if(!this.connection)return;const s=this.remoteUserMap.get(r);if(!s)return void V.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(r.uid,"."));s.get(a)||V.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."))}addAudioMetadata(r){const a=this.localTrackMap.get(De.LocalAudioTrack),s=a&&a.track;s&&s.metadata.push(r)}getAllTracks(r){const a=this.localTrackMap.get(De.LocalAudioTrack);if((a==null?void 0:a.track)instanceof Yr){const s=a.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[d]=l;return d!==De.LocalAudioTrack}).filter(l=>{let[d]=l;return!(r&&d===De.LocalVideoLowTrack)}).map(l=>{let[,{track:d}]=l;return d}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[l]=s;return!(r&&l===De.LocalVideoLowTrack)}).map(s=>{let[,{track:l}]=s;return l})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(r,a,s,l,d){if(r){const m=this.localTrackMap.get(De.LocalAudioTrack),y=l?this.localTrackMap.get(De.LocalVideoLowTrack):this.localTrackMap.get(De.LocalVideoTrack);it.publish(this.store.sessionId,{eventElapse:Yi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.track.getTrackLabel(),videoName:y==null?void 0:y.track.getTrackLabel(),screenshare:(y==null?void 0:y.track._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}else{var f;s||(s=[]);const m=s.find(_=>_ instanceof vr),y=l?(f=this.localTrackMap.get(De.LocalVideoTrack))===null||f===void 0?void 0:f.track:s.find(_=>_ instanceof Gn);it.publish(this.store.sessionId,{eventElapse:Yi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.getTrackLabel(),videoName:y==null?void 0:y.getTrackLabel(),screenshare:(y==null?void 0:y._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}}reportSubscribeEvent(r,a,s,l){const d=l===Je.VIDEO?s._videoSSRC:s._audioSSRC;d&&it.subscribe(this.store.sessionId,{succ:r,ec:a,video:l===Je.VIDEO,audio:l===Je.AUDIO,peerid:s.uid,subscribeRequestid:d,p2pid:this.store.p2pId,eventElapse:Yi.measureFromSubscribeStart(this.store.clientId,d),preSsrc:this.isPreSubScribe(d)})}reset(){V.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Hi("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=MT(this.store),this.emit(dt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const r=this.localTrackMap.get(De.LocalAudioTrack);if((r==null?void 0:r.track)instanceof Yr){if(r.track.trackList.length>0){const a=r.track;r.track.trackList.forEach(s=>{a.removeAudioTrack(s)})}r.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=wn.Disconnected}getStats(){var r;return(r=this.connection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(r){var a;return((a=this.connection)===null||a===void 0?void 0:a.getRemoteVideoIsReady(r))||!1}getLocalAudioVolume(){const r=this.localTrackMap.get(De.LocalAudioTrack);if(r)return r.track.getVolumeLevel()}getLocalVideoSize(){const r=this.localTrackMap.get(De.LocalVideoTrack);if(r)return{width:r.track.videoWidth||0,height:r.track.videoHeight||0}}getEncoderConfig(r){const a=this.localTrackMap.get(r);return a&&a.track instanceof Gn||a&&a.track instanceof vr?a.track._encoderConfig:void 0}getLocalMedia(r){return this.localTrackMap.get(r)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}async hasRemoteMediaWithLock(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}getRemoteMedia(r){var a;const s=Array.from(os(a=this.remoteUserMap).call(a)).find(l=>l.uid===r);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let r=Array.from(this.remoteUserMap.entries()).map(s=>{let[l]=s;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const a=this.localTrackMap.get(De.LocalAudioTrack);return a&&r.push({level:100*a.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=Yf(r).call(r,(s,l)=>s.level-l.level),r}async disconnectForReconnect(){this.connection&&(V.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=wn.Reconnecting,oe("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a]=r;var s;a._videoTrack&&a._videoTrack._player&&((s=a._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),a._videoTrack._player.isKeepLastFrame=!0,a._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=MT(this.store),this.emit(dt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(r=>{var a;let[s,{track:l}]=r;switch(s){case De.LocalVideoTrack:Be(a=l._hints).call(a,jn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case De.LocalAudioTrack:l instanceof Yr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case De.LocalVideoLowTrack:}}),this.emit(dt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;Array.from(os(s).call(s)).forEach(l=>{this.setPendingRemoteMedia(a,l)}),this.emit(dt.MediaReconnectStart,a.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(r=>{this.pendingLocalDataChannels.push(r)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(r=>{let[a,s]=r;Array.from(os(s).call(s)).forEach(l=>{this.setPendingRemoteDataChannel(a,l)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),V.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(r,a){for(const s of this.pendingRemoteDataChannels){const{user:l,id:d}=s;if((r instanceof wh?r.uid:r)===l.uid&&d===a)return!0}return!1}setPendingRemoteDataChannel(r,a){this.hasPendingRemoteDataChannel(r,a)||this.pendingRemoteDataChannels.push({user:r,id:a})}hasPendingRemoteMedia(r,a){for(const s of this.pendingRemoteTracks){const{user:l,kind:d}=s;if((r instanceof wh?r.uid:r)===l.uid&&a===d)return!0}return!1}setPendingRemoteMedia(r,a){this.hasPendingRemoteMedia(r,a)||this.pendingRemoteTracks.push({user:r,kind:a})}restartICE(r){var a=this;return So(function*(){if(!a.connection||a.state!==wn.Connected)return;const s=yield ln(a.mutex.lock("From P2PChannel.restartICE"));let l;try{l=yield ln(a.connection.restartICE(r));const f=yield ln(l.next());if(f.done)return;const m=f.value,y=yield m;switch(LD(a.connection)&&a.reportPCStats(Date.now(),!1,a._pcStatsUploadType),r){case qi.UDP_TCP_RELAY:a._pcStatsUploadType=od.UDP_TCP_RESTART;break;case qi.TCP_RELAY:a._pcStatsUploadType=od.TCP_RESTART;break;case qi.RELAY:a._pcStatsUploadType=od.RELAY_RESTART;break;default:a._pcStatsUploadType=od.OLD_RESTART}a._isTryConnecting=!0,l.next(y)}catch(f){var d;(d=l)===null||d===void 0||d.throw(f)}finally{s()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const r=this.connection.getStats(),a=this.localTrackMap.get(De.LocalVideoTrack),s=this.localTrackMap.get(De.LocalAudioTrack),l=r.videoSend.find(L=>L.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId)),d=r.audioSend.find(L=>L.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId));if(!l||!d)return 1;const f=qs(this,dt.NeedSignalRTT),m=l?l.rttMs:void 0,y=d?d.rttMs:void 0,_=m&&y?(m+y)/2:m||y,S=(_&&f?(_+f)/2:_||f)||0,x=100*r.sendPacketLossRate*.7/50+.3*S/1500,A=x<.17?1:x<.36?2:x<.59?3:x<.1?4:5,I=a==null?void 0:a.track;if(I&&I._encoderConfig&&I._hints.indexOf(jn.SCREEN_TRACK)===-1){const L=I._encoderConfig.bitrateMax,K=r.bitrate.actualEncoded;if(L&&K){const $=(1e3*L-K)/(1e3*L);return eK[$<.15?0:$<.3?1:$<.45?2:$<.6?3:4][A]}}return A}getDownlinkNetworkQuality(){if(!this.connection)return 0;const r=this.connection.getStats();let a=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[l]=s;const d=l._audioSSRC,f=l._videoSSRC,m=r.audioRecv.find(K=>K.ssrc===d),y=r.videoRecv.find(K=>K.ssrc===f);if(!m&&!y)return void(a+=1);const _=qs(this,dt.NeedSignalRTT),S=r.rtt,x=(S&&_?(S+_)/2:S||_)||0,A=m?m.jitterMs:void 0,I=r.recvPacketLossRate;let L=.7*I*100/50+.3*x/1500;A&&(L=.6*I*100/50+.2*x/1500+.2*A/400),a+=L<.1?1:L<.17?2:L<.36?3:L<.59?4:5}),this.remoteUserMap.size>0?Math.round(a/this.remoteUserMap.size):a}async muteLocalTrack(r){return new He((a,s)=>{this.handleMuteLocalTrack(r,a,s)})}async replaceTrack(r,a){var s;if(V.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(r.getTrackId(),"] to [").concat(a.getTrackId(),"]")),!this.connection||this.state!==wn.Connected)return;const l=Array.from(this.localTrackMap.entries()).find(f=>{let[,{track:m}]=f;return r===m});if(!l)return;const d=l[0];if(r!==a&&(this.unbindLocalTrackEvents([{track:r,type:d}]),this.bindLocalTrackEvents([{track:a,type:d}]),l[1].track=a),await((s=this.connection)===null||s===void 0?void 0:s.replaceTrack(a,l[1].id)),this.isPlanB){const f=l[1];f.id=a._mediaStreamTrack.id,this.localTrackMap.set(d,f)}if(d===De.LocalVideoTrack&&!oe("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding){const f=this.localTrackMap.get(De.LocalVideoLowTrack);if(f){const m=r._mediaStreamTrack.clone();f.track._originMediaStreamTrack.stop(),f.track._mediaStreamTrack=m,f.track._originMediaStreamTrack=m,await new He((y,_)=>{this.handleReplaceTrack(f.track,y,_,!0)})}}}filterTobePublishedTracks(r,a,s){const l=[],d=this.getAllTracks();r=vg(r=r.filter(_=>d.indexOf(_)===-1));let f,m=!1;const y=this.localTrackMap.get(De.LocalAudioTrack);for(const _ of r){if(_ instanceof Gn&&(this.localTrackMap.has(De.LocalVideoTrack)||m?new we(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:_,type:De.LocalVideoTrack}),m=!0),a)){const S=this.getLowVideoTrack(_,s);l.push({track:S,type:De.LocalVideoLowTrack})}if(_ instanceof vr)if(y){const S=y.track;if(S instanceof Yr)jD([_]),S.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0);else{const x=DD([S,_]);V.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(x.getTrackId(),"]")),this.replaceTrack(S,x)}}else f instanceof Yr?(jD([_]),f.addAudioTrack(_)):f||!_._useAudioElement&&un().webAudioMediaStreamDest&&!_._bypassWebAudio?f=DD(f?[_,f]:[_]):f=_}return f&&(V.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(f.getTrackId(),"]")),l.push({track:f,type:De.LocalAudioTrack})),l}filterTobeUnpublishedTracks(r){const a=[],s=this.getAllTracks();r=vg(r=r.filter(l=>s.indexOf(l)!==-1));for(const l of r){if(l instanceof vr){const d=this.localTrackMap.get(De.LocalAudioTrack);if(!d)continue;d.track instanceof Yr?(d.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),d.track.trackList.length===0&&(a.push([De.LocalAudioTrack,d]),d.track.close())):a.push([De.LocalAudioTrack,d])}if(l instanceof Gn){const d=this.localTrackMap.get(De.LocalVideoTrack);if(!d)continue;a.push([De.LocalVideoTrack,d]);const f=this.localTrackMap.get(De.LocalVideoLowTrack);f&&a.push([De.LocalVideoLowTrack,f])}}return a}filterTobePublishedDataChannels(r){return r=(r=vg(r)).filter(a=>this.localDataChannels.findIndex(s=>s.id===a.id)===-1)}filterTobeUnpublishedDataChannels(r){return r=(r=(r=vg(r)).filter(a=>this.localDataChannels.indexOf(a)!==-1)).filter(a=>a._originDataChannel)}bindLocalTrackEvents(r){r.forEach(a=>{let{track:s,type:l}=a;switch(l){case De.LocalVideoTrack:s.addListener(et.GET_STATS,this.handleGetLocalVideoStats),s.addListener(et.GET_RTC_STATS,this.handleGetRTCStats),s.addListener(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(et.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(et.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.addListener(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case De.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case De.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(r,a){r instanceof Yr?r.trackList.forEach(s=>{s.addListener(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(et.GET_STATS,this.handleGetLocalAudioStats),s.addListener(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.addListener(et.GET_STATS,this.handleGetLocalAudioStats),r.addListener(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),a||(r.addListener(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(et.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(r){r||(r=Array.from(this.localTrackMap.entries()).map(a=>{let[s,{track:l}]=a;return{track:l,type:s}})),r.forEach(a=>{let{track:s,type:l}=a;switch(l){case De.LocalVideoTrack:s.off(et.GET_STATS,this.handleGetLocalVideoStats),s.off(et.GET_RTC_STATS,this.handleGetRTCStats),s.off(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(et.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(et.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.off(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case De.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case De.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(r){r instanceof Yr?r.trackList.forEach(a=>{a.off(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(et.GET_STATS,this.handleGetLocalAudioStats),a.off(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.off(et.GET_STATS,this.handleGetLocalAudioStats),r.off(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(et.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),r.off(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(r,a){a instanceof Ig&&a.addListener(et.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(r))}),a instanceof Og&&a.addListener(et.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(r))})}unbindRemoteTrackEvents(r){r&&r.removeAllListeners(et.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;s.has(Je.AUDIO)&&this.unbindRemoteTrackEvents(a._audioTrack),s.has(Je.VIDEO)&&this.unbindRemoteTrackEvents(a._videoTrack)})}createGatewayPublishMessage(r,a){return r.map((s,l)=>{var d;let f,m,{track:y,type:_}=s;switch(_){case De.LocalAudioTrack:f=xn.Audio,m={dtx:y instanceof gb&&y._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case De.LocalVideoTrack:f=Be(d=y._hints).call(d,jn.SCREEN_TRACK)?xn.Screen:xn.High,m=ou(ou({},gK(y)),{},{codec:this.store.codec,svc_mode:ST()});break;case De.LocalVideoLowTrack:f=xn.Low,m=ou(ou({},gK(y)),{},{codec:this.store.codec,svc_mode:ST()})}return{stream_type:f,attributes:m,ssrcs:a[l]}})}createGatewayUnpublishMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case De.LocalVideoTrack:l=Be(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}assignLocalTracks(r,a){r.forEach((s,l)=>{let{track:d,type:f}=s;this.localTrackMap.set(f,{track:d,id:a[l].id,ssrcs:a[l].localSSRC})})}withdrawLocalTracks(r){r.forEach(a=>{let[s]=a;this.localTrackMap.delete(s)})}bindConnectionEvents(r){r.onConnectionStateChange=async a=>{if(V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(a,")")),this.emit(dt.PeerConnectionStateChange,a),a==="connecting"&&r instanceof Ao&&!dr()&&oe("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{a==="connecting"&&r.extendCandidate()},oe("FIRST_TCP_CANDIDATE_INTERVAL")),a!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),a==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),r instanceof Ao&&dq(r,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=od.DISCONNECTED_OR_FAILED,qs(this,dt.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const s=this.pendingLocalTracks.map(d=>d.getTrackId()),l=this.pendingLocalDataChannels.map(d=>"dc_".concat(d.id));it.reportApiInvoke(this.store.sessionId,{name:Er.REPUB_AFTER_PC_CONNECTED,options:s.concat(l),tag:rr.TRACER}).onSuccess(),this.republish()}if(oe("NEW_ICE_RESTART")&&r instanceof Ao&&!dr()&&!this._forceTurn){if(Be(uK).call(uK,a)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const s=d=>{LD(r)&&(V.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(d)),qs(this,dt.QueryClientConnectionState)==="CONNECTED"&&this.emit(dt.RequestRestartICE,d))},l=()=>{LD(r)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),V.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(dt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{hq(r,s,l)},800))}}else{if(a==="disconnected"&&r.iceConnectionState==="disconnected")return setTimeout(()=>{r.iceConnectionState==="disconnected"&&oe("ICE_RESTART")&&qs(this,dt.QueryClientConnectionState)==="CONNECTED"&&this.emit(dt.RequestRestartICE)},800),void setTimeout(()=>{r.peerConnectionState==="disconnected"&&(V.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(dt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);a==="failed"&&(V.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(dt.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},r.onICEConnectionStateChange=a=>{a!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(a,")")),it.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:a,tag:rr.TRACER}).onSuccess(),this.emit(dt.IceConnectionStateChange,a)},r.onICETransportStateChange=a=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(a,")"))},r.onDTLSTransportStateChange=a=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(a,")"))},r.onDTLSTransportError=a=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(a,")"))},r.onFirstAudioDecoded=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(f=>f._audioSSRC===a);var d;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(d=l.audioTrack)===null||d===void 0||d.emit(Co.FIRST_FRAME_DECODED),it.firstRemoteFrame(this.store.sessionId,ii.FIRST_AUDIO_DECODE,Qn.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},r.onFirstAudioReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._audioSSRC===a);l&&it.firstRemoteFrame(this.store.sessionId,ii.FIRST_AUDIO_RECEIVED,Qn.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},r.onFirstVideoDecoded=(a,s,l)=>{var d;const f=Array.from(os(d=this.remoteUserMap).call(d)).find(m=>m._videoSSRC===a);f&&this.store.firstVideoFrameDecoded(f.uid,{firstDecoded:Date.now()}),this.reportVideoFirstFrameDecoded(a,s,l)},r.onFirstVideoRender=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===a);l&&(this.store.firstVideoFrameDecoded(l.uid,{firstPreRender:Date.now()}),this.reportVideoFirstFrameRender(l))},r.onFirstVideoReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===a);l&&(this.store.firstVideoFrameDecoded(l.uid,{firstReceived:Date.now()}),it.firstRemoteFrame(this.store.sessionId,ii.FIRST_VIDEO_RECEIVED,Qn.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},r.onSelectedLocalCandidateChanged=(a,s)=>{const l=a.candidateType==="relay",d=s.candidateType==="relay";s.candidateType!=="unknown"&&l===d||this.emit(dt.ConnectionTypeChange,l),V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(vh(s))," -> ").concat(JSON.stringify(vh(a)),")"))},r.onSelectedRemoteCandidateChanged=(a,s)=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(vh(s))," -> ").concat(JSON.stringify(vh(a)),")"))},r.onFirstVideoDecodedTimeout=a=>{this.reportVideoFirstFrameDecoded(a,void 0,void 0,!0)},r.getLocalVideoStats=()=>{const a=this.statsCollector.getLocalVideoTrackStats(),s=this.statsCollector.getRTCStats();return ou(ou({},a),s)},r.onICECandidateError=a=>{this._iceError=a}}resetConnection(r){r instanceof Ao&&function(a){Gg.delete(a.id),dq(a)}(r),r.close(),this.emit(dt.PeerConnectionStateChange,"closed"),function(a){a.onConnectionStateChange=void 0,a.onICEConnectionStateChange=void 0,a.onICETransportStateChange=void 0,a.onDTLSTransportStateChange=void 0,a.onDTLSTransportError=void 0,a.onFirstAudioDecoded=void 0,a.onFirstAudioReceived=void 0,a.onFirstVideoDecoded=void 0,a.onFirstVideoReceived=void 0,a.onSelectedLocalCandidateChanged=void 0,a.onSelectedRemoteCandidateChanged=void 0,a.onFirstVideoDecodedTimeout=void 0,a.getLocalVideoStats=void 0}(r),this._isWaitPcToRePub=!1}filterTobeMutedTracks(r){const a=[];if(this.getAllTracks().indexOf(r)===-1)return a;const s=this.localTrackMap.get(De.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive||a.push([De.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l&&(a.push(l),l[0]===De.LocalVideoTrack)){const d=this.localTrackMap.get(De.LocalVideoLowTrack);d&&a.push([De.LocalVideoLowTrack,d])}return a}filterTobeUnmutedTracks(r){const a=[],s=this.localTrackMap.get(De.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive&&a.push([De.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l)if(l[0]===De.LocalVideoTrack){a.push(l);const d=this.localTrackMap.get(De.LocalVideoLowTrack);d&&a.push([De.LocalVideoLowTrack,d])}else a.push(l);return a}createMuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoTrack:l=Be(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}createUnmuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoTrack:l=Be(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}filterTobeUnSubscribedTracks(r,a){const s=[],l=this.remoteUserMap.get(r);if(!l)return s;if(a){const d=l.get(a);if(!d)return s;s.push([r,{kind:a,id:d}])}else Array.from(l.entries()).forEach(d=>{let[f,m]=d;s.push([r,{kind:f,id:m}])});return s}filterTobeUnSubscribedDataChannels(r,a){const s=[];return a.forEach(l=>{var d;(d=this.remoteDataChannelMap.get(r))!==null&&d!==void 0&&d.has(l.id)&&s.push(l)}),s}createUnsubscribeMessage(r){const a=[];return r.forEach(s=>{let[l,{kind:d,id:f}]=s;switch(d){case Je.VIDEO:return void(l._videoSSRC&&a.push({stream_type:Je.VIDEO,ssrcId:l._videoSSRC}));case Je.AUDIO:return void(l._audioSSRC&&a.push({stream_type:Je.AUDIO,ssrcId:l._audioSSRC}))}}),a}createUnsubscribeAllMessage(r){const a=new Map;return r.forEach(s=>{let[l,{kind:d}]=s;if(a.has(l)){let f=a.get(l);d===Je.VIDEO?f|=ci.Video:f|=ci.Audio,a.set(l,f)}else d===Je.VIDEO?a.set(l,ci.Video):a.set(l,ci.Audio)}),{users:Array.from(a.entries()).map(s=>{let[l,d]=s;return{stream_id:l.uid,stream_type:d}})}}withdrawRemoteTracks(r){r.forEach(a=>{let[s,{kind:l}]=a;const d=this.remoteUserMap.get(s);d&&(d.delete(l),Array.from(d.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(r){const a=this.localTrackMap.get(De.LocalVideoTrack),s=this.localTrackMap.get(De.LocalVideoLowTrack);a&&(await a.track.setBitrateLimit(r.uplink),await new He((l,d)=>{this.handleUpdateVideoEncoder(a.track,l,d,!0)})),s&&r.low_stream_uplink&&(await s.track.setBitrateLimit({max_bitrate:r.low_stream_uplink.bitrate,min_bitrate:r.low_stream_uplink.bitrate||0}),await new He((l,d)=>{this.handleUpdateVideoEncoder(s.track,l,d,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}isPreallocation(){return this.connection instanceof Ao&&this.connection.isPreallocation}isPreSub(){return this.connection instanceof Ao&&this.connection.isPreSub()}mapPubResToRemoteConfig(r,a,s){return r.map((l,d)=>{var f;let{stream_type:m}=l;const y=(f=a.find(_=>{let{stream_type:S}=_;return m===S}))===null||f===void 0?void 0:f.attributes;if(y&&oe("DISABLE_SCREEN_SHARE_REMB")){const _=s[d]._hints;(Be(_).call(_,jn.SCREEN_TRACK)||Be(_).call(_,jn.SCREEN_LOW_TRACK))&&(y.remb=!1,V.debug("disable remb for screen share, hints:",_))}return y})}async tryToUnmuteAudio(r){for(let s=0;s<r.length;s++)if(r[s]instanceof vr){var a;const l=this.filterTobeUnmutedTracks(r[s]);if(l.length===0)continue;await((a=this.connection)===null||a===void 0?void 0:a.unmuteLocal(l.map(f=>{let[,{id:m}]=f;return m})));const d=this.createUnmuteMessage(l);return void await Ln(this,dt.RequestUnmuteLocal,d)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=r=>{var a;return!((a=this.connection)===null||a===void 0||!a.getRemoteVideoIsReady(r))},this.statsUploader.requestUpload=(r,a)=>this.emit(dt.RequestUpload,r,a),this.statsUploader.requestUploadStats=r=>this.emit(dt.RequestUploadStats,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var r;return{connectState:((r=this.connection)===null||r===void 0?void 0:r.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Ti(Ej(this.dtlsFailedCount,Gr)),this.emit(dt.RequestReconnect)}async reconnectP2P(){const r=Array.from(this.localTrackMap.entries()),a=this.createGatewayUnpublishMessage(r);Array.from(this.remoteUserMap.entries()),a.length>0&&await Li(this,dt.RequestUnpublishForReconnectPC,a),this.disconnectForReconnect(),this.emit(dt.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(De.LocalVideoTrack)||this.pendingLocalTracks.some(r=>r instanceof Gn)}throwIfTrackTypeNotMatch(r){if(r.filter(a=>a instanceof Gn).length>1)throw new we(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r.filter(a=>a instanceof vr).length>1&&(r.some(a=>a instanceof vr&&a._bypassWebAudio)||!un().webAudioMediaStreamDest))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const a of r){if(a instanceof Gn&&this.pendingLocalTracks.some(s=>s instanceof Gn))throw new we(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(a instanceof vr&&this.pendingLocalTracks.some(s=>s instanceof vr)&&(!un().webAudioMediaStreamDest||a._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof vr&&s._bypassWebAudio)))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(r,a){var s;const l=!oe("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding,d=ou(ou({},{width:160,height:120,framerate:15,bitrate:50}),a);let f;f=l?r._mediaStreamTrack.clone():MD(r,d);const m=Mn(8,"track-low-"),y=new Gn(f,ou(ou({},l&&{scaleResolutionDownBy:vD(d,r)}),{},{frameRate:d.framerate,bitrateMax:d.bitrate,bitrateMin:d.bitrate}),void 0,void 0,m);return y.on(cp.TRANSCEIVER_UPDATED,_=>{r._updateRtpTransceiver(_,xg.LOW_STREAM)}),y._hints.push(jn.LOW_STREAM),Be(s=r._hints).call(s,jn.SCREEN_TRACK)&&y._hints.push(jn.SCREEN_LOW_TRACK),r.on("sei-to-send",_=>{y.emit("sei-to-send",_)}),r.addListener(et.NEED_CLOSE,()=>{y.close()}),y}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(r,a,s){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Ao){var d,f,m,y;const _=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:S,dtlsTransportState:x,peerConnectionState:A}=this.connection,{local:I,remote:L}=await this.connection.getSelectedCandidatePair();it.pcStats(this.store.sessionId,{startTime:_,eventElapse:r-_||0,iceconnectionsate:S,dtlsstate:x,connectionstate:A,intSucc:a?1:2,error:this._iceError||l||"",selectedLocalCandidateProtocol:(d=I==null?void 0:I.protocol)!==null&&d!==void 0?d:"",selectedLocalCandidateType:(f=I.candidateType)!==null&&f!==void 0?f:"",selectedLocalCandidateAddress:"".concat(I.address,":").concat(I.port),selectedRemoteCandidateProtocol:(m=L.protocol)!==null&&m!==void 0?m:"",selectedRemoteCandidateType:(y=L.candidateType)!==null&&y!==void 0?y:"",selectedRemoteCandidateAddress:"".concat(L.address,":").concat(L.port),restartCnt:s,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameRender(r){const a=this.store.keyMetrics,s=a.firstVideoFrameDecoded.find(x=>x.userId===r.uid);if(!s)return;const{isInternalUpload:l,isExternalUpload:d}=s;if(l&&d)return;const{subscribeEnd:f,firstPreRender:m,peerPublishDuration:y,peerPubStatusMs:_}=s;let{firstRender:S=0}=s;if(f&&(S||m)&&y&&_){s.isInternalUpload=!0;const{playEnd:x}=s;x&&(s.isExternalUpload=!0);const{firstPreRender:A=0}=s;S=A||S;const I=r.videoTrack,L={peer:r._uintid,width:(I==null?void 0:I._videoWidth)||0,height:(I==null?void 0:I._videoHeight)||0,ssrc:r._videoSSRC||0,p2pid:this.store.p2pId,peerPublishDuration:y,peerPubStatusMs:_,joinChannelStart:a.joinStart||0,preloadStart:a.preloadStart||0,preloadEnd:a.preloadEnd||0,apStart:a.requestAPStart||0,apEnd:a.requestAPEnd||0,suaEnd:a.requestSUAEnd||0,beforeConnect:a.beforeConnect||0,peerReceiver:a.peerReceiver||0,ice:a.iceConnectionEnd||0,pc:a.peerConnectionEnd||0,signalConnected:a.signalConnected||0,joinReq:a.joinReq||0,joinRes:a.joinRep||0,userJoinNotify:s.userJoinNotify||0,videoAddNotify:s.videoAddNotify||0,subscribeStart:s.subscribeStart||0,subscribeEnd:s.subscribeEnd||0,firstReceived:s.firstReceived||0,firstDecoded:s.firstDecoded||0,firstPreRender:A||0,firstRender:x?Math.max(S,x):Math.max(S,f),playStart:s.playStart||0,playEnd:s.playEnd||0,isPreSub:!(!r._videoSSRC||!this.isPreSubScribe(r._videoSSRC)),isPrePc:this.isPreallocation(),isPreInstantVideo:Vz(this.store)};it.firstXLAPeerFirstVideoFrame(this.store.sessionId,L)}}reportVideoFirstFrameDecoded(r,a,s,l){var d;const f=Array.from(os(d=this.remoteUserMap).call(d)).find(m=>m._videoSSRC===r);if(f){l||this.store.subscribe(f.uid,"video",void 0,void 0,void 0,void 0,Date.now());const m=this.store.keyMetrics,y=m.subscribe.find(_=>_.userId===f.uid&&_.type==="video");it.firstRemoteVideoDecode(this.store.sessionId,ii.FIRST_VIDEO_DECODE,Qn.FIRST_VIDEO_DECODE,{peer:f._uintid,videowidth:a,videoheight:s,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId,apEnd:m.requestAPEnd||0,apStart:m.requestAPStart||0,joinGwEnd:m.joinGatewayEnd||0,joinGwStart:m.joinGatewayStart||0,pcEnd:m.peerConnectionEnd||0,pcStart:m.peerConnectionStart||0,subscriberEnd:(y==null?void 0:y.subscribeEnd)||0,subscriberStart:(y==null?void 0:y.subscribeStart)||0,videoAddNotify:(y==null?void 0:y.streamAdded)||0,state:l?1:0,firstFrame:(y==null?void 0:y.firstFrame)||0})}}async remoteMediaSsrcChanged(r,a,s){if(!this.connection)return!1;const l=this.remoteUserMap.get(r);if(!l)return!1;const d=l.get(a);if(!d)return!1;const f=await this.connection.getRemoteSSRC(d);return f!==void 0&&f!==s}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(r=>{let[a,{track:s}]=r;a===De.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,xg.LOW_STREAM):s._updateRtpTransceiver(void 0)})}},rt(Jt.prototype,"startP2PConnection",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"startP2PConnection"),Jt.prototype),rt(Jt.prototype,"connect",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"connect"),Jt.prototype),rt(Jt.prototype,"updateRemoteRTPCapabilities",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"updateRemoteRTPCapabilities"),Jt.prototype),rt(Jt.prototype,"publishDataChannel",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"publishDataChannel"),Jt.prototype),rt(Jt.prototype,"unpublish",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"unpublish"),Jt.prototype),rt(Jt.prototype,"unpublishDataChannel",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"unpublishDataChannel"),Jt.prototype),rt(Jt.prototype,"unpublishLowStream",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"unpublishLowStream"),Jt.prototype),rt(Jt.prototype,"subscribeDataChannel",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"subscribeDataChannel"),Jt.prototype),rt(Jt.prototype,"subscribe",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"subscribe"),Jt.prototype),rt(Jt.prototype,"massSubscribe",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"massSubscribe"),Jt.prototype),rt(Jt.prototype,"unsubscribe",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"unsubscribe"),Jt.prototype),rt(Jt.prototype,"unsubscribeDataChannel",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"unsubscribeDataChannel"),Jt.prototype),rt(Jt.prototype,"massUnsubscribe",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"massUnsubscribe"),Jt.prototype),rt(Jt.prototype,"muteRemote",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"muteRemote"),Jt.prototype),rt(Jt.prototype,"unmuteRemote",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"unmuteRemote"),Jt.prototype),rt(Jt.prototype,"hasRemoteMediaWithLock",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"hasRemoteMediaWithLock"),Jt.prototype),rt(Jt.prototype,"disconnectForReconnect",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"disconnectForReconnect"),Jt.prototype),rt(Jt.prototype,"updateBitrateLimit",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"updateBitrateLimit"),Jt.prototype),rt(Jt.prototype,"remoteMediaSsrcChanged",[Sa],Object.getOwnPropertyDescriptor(Jt.prototype,"remoteMediaSsrcChanged"),Jt.prototype),Jt);function Sa(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("From P2PChannel.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}function mq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function gq(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?mq(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):mq(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const COe=Date.now(),ROe=20,FD=new Map,$T=new Map;async function vq(r){const a=FD.get(r),s=Array.isArray(a)&&a[a.length-1],l=$T.get(r);if(!s)return void(l.isSyncing=!1);const d={uid:s.uid,payload:s.payload};l.firstRecvTs===0&&(l.firstRecvTs=s.recvTs,l.firstSendTs=s.sendTs);const f=s.sendTs-l.firstSendTs,m=f-(Date.now()-l.firstRecvTs);m>0&&(l.firstRecvTs=Date.now()-f);let y=s.mediaDelay+m;y<=0?(a.pop(),yq(s.context,d),y=0):y=Math.min(y,ROe),setTimeout(()=>a.length&&vq(r),y)}function yq(r,a){r.safeEmit(Zt.STREAM_MESSAGE,a.uid,a.payload),r.onStreamMessage&&r.onStreamMessage(a)}function NOe(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;if(!r.syncWithAudio)return yq(s,{uid:r.uid,payload:r.payload});const l="".concat(s.id,"-").concat(r.uid),d=FD.get(l)||[],f=d.findIndex(S=>r.sendTs>=S.sendTs),m=gq(gq({},r),{},{context:s,mediaDelay:a,recvTs:Date.now()});f===-1?d.push(m):d.splice(f,0,m),FD.set(l,d);let y=!1;var _;$T.has(l)?y=!((_=$T.get(l))===null||_===void 0||!_.isSyncing):$T.set(l,{isSyncing:y,firstRecvTs:0,firstSendTs:0}),y||vq(l)}const AOe=an().name;function _q(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function bq(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?_q(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):_q(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const Hg="websdk_ng_cache_parameter",IOe=oe("MAX_PRELOAD_ASYNC_LENGTH"),OOe=1e4,yp=new Map,_p=[];let VD=null,BD=0,$D=0;const WT=new Map,POe=function(r,a){const s=[];let l=0;const d=async()=>{const f=s.shift();f&&await f(),s.length>0&&l<a?d():l--};return async function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];return new He(async(_,S)=>{s.push(async()=>{try{const x=await r(...m);_(x)}catch(x){S(x)}}),l<a&&(l++,d())})}}(Eq,IOe),WD=Ka.CancelToken.source();async function Eq(r,a,s,l,d,f){try{if(!oe("ENABLE_PRELOAD"))return;if(!un().supportWebCrypto)return void uh(()=>{V.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!s&&s!==null)throw new we(ie.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));s&&xi(s,"token",1,2047),xi(r,"appid",1,2047),vT(a),l&&yT(l);const m=sp();V.debug("preload channel ".concat(a,", uid is ").concat(l));const y={appId:r,cname:a,token:s||r,uid:typeof l!="string"?l:null,sid:m,proxyServer:d};let _,S;typeof l=="string"?(y.stringUid=l,[S,_]=await He.all([mOe(l,{sid:m,appId:r},WD.token),KK(bq(bq({},y),{},{token:s||r,uid:0}),WD.token)]),y.uid=S.uid,_.gatewayInfo.uid=y.uid,_.gatewayInfo.res.uid=y.uid):(f&&(y.stringUid=f),_=await KK(y,WD.token));const x={sid:m,appId:r,cname:a,token:s||r,uid:y.stringUid||l,intUid:y.uid||_.gatewayInfo.uid,stringUid:y.stringUid,ts:Date.now(),sua:S,ap:_};await async function(A){let I;try{A.uid&&Sq({appId:A.appId,cname:A.cname,token:A.token,uid:A.uid,stringUid:A.stringUid});const L=Rq(A),K=await async function(G,ne){try{const te=await window.crypto.subtle.importKey("raw",fz(ne),"AES-GCM",!1,["encrypt"]),ce=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},te,ap(window.btoa(JSON.stringify(G))));return dh(new Uint8Array(ce))}catch{return}}(A,A.token||A.appId);if(!K)return;I=Cq(Hg);const $=I?JSON.parse(I):[];$.push({[L]:K}),$.length>oe("AP_CACHE_NUM")&&$.shift(),GT(Hg,JSON.stringify($))}catch(L){V.warn("Error caching server parameters:",L.message),GT(Hg,"")}}(x),BD++}catch(m){throw $D++,function(y){VD||(VD=window.setTimeout(()=>{let S="";WT.forEach((x,A)=>{S+="".concat(A,": ").concat(x," ;")}),it.reportApiInvoke(null,{name:Er.PRELOAD,options:{success:BD,failed:$D,err:S}}).onError(y),BD=0,$D=0,WT.clear(),VD=null},OOe));const _=WT.get(y.code)||0;WT.set(y.code,_+1)}(m),m}}async function wq(r){try{if(oe("AP_REQUEST_DETAIL")||oe("ENABLE_ROLE_SELECT_EDGE"))return;const a=Sq(r);if(!a||r.cloudProxyServer!=="disabled")return;const s=await async function(l,d){try{const f=await window.crypto.subtle.importKey("raw",fz(d),"AES-GCM",!1,["decrypt"]),m=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},f,ap(l));return JSON.parse(window.atob(dh(new Uint8Array(m))))}catch{return}}(a,r.token||r.appId);if(!s||!function(l,d){return l.cname===d.cname&&l.appId===d.appId&&l.token===d.token?d.stringUid?l.stringUid===d.stringUid:typeof d.uid=="number"?l.uid===d.uid:l.uid==d.uid:!1}(s,r))return;if(s&&Date.now()-s.ts<oe("AP_CACHE_LIFETIME"))return s}catch(a){V.warn("Error get preloadInfo",a.message)}}function Sq(r){let a;try{if(a=Cq(Hg),!a)return;const s=JSON.parse(a),l=Rq(r),d=function(m,y){for(let _=m.length-1;_>=0;_--)if(y(m[_]))return _;return-1}(s,m=>l in m);if(d===-1)return;const f=s.splice(d,1)[0];return GT(Hg,JSON.stringify(s)),f[l]}catch(s){V.warn("Error delete preload info: ".concat(a),s.message),GT(Hg,"")}}function GD(r){if(r){let a=yp.get(r);a&&(window.clearTimeout(a),a=null,yp.delete(r)),Be(_p).call(_p,r)||r.cloudProxyServer!=="disabled"||_p.push(r)}if(yp.size<oe("AP_CACHE_NUM")&&_p.length>0){const a=_p.shift();yp.set(a,window.setTimeout(async()=>{const{appId:s,cname:l,token:d,stringUid:f,uid:m,proxyServer:y}=a;try{await POe(s,l,d,m,y,f),yp.has(a)&&GD(a)}catch(_){V.warn("update preload failed",_.message),xq(a)}},oe("AP_UPDATE_INTERVAL")))}}function xq(r){const a=_p.indexOf(r);a!==-1&&_p.splice(a,1);let s=yp.get(r);s&&(window.clearTimeout(s),s=null,yp.delete(r),GD())}function Tq(r,a){const s=r.sua,l=r.ap;a&&s&&it.reqUserAccount(r.sid,{lts:s.requestTime,elapse:s.elapse,success:!0,serverAddr:s.url,stringUid:a,uid:r.intUid,errorCode:null,extend:s.req}),it.reportResourceTiming(r.ap.url,r.sid),it.joinWebProxyAP(r.sid,{lts:l.requestTime,elapse:l.elapse,sucess:1,apServerAddr:l.url,turnServerAddrList:l.proxyInfo.addresses.map(d=>d.ip).join(","),eventType:"disabled",unilbsServerIds:[Lr.CHOOSE_SERVER,Lr.CLOUD_PROXY_FALLBACK].toString()}),it.joinChooseServer(r.sid,{lts:l.requestTime,elapse:l.elapse,succ:!0,csAddr:l.url,opid:l.opid,serverList:l.gatewayInfo.gatewayAddrs.map(d=>d.address),ec:null,cid:l.gatewayInfo.cid.toString(),uid:l.gatewayInfo.uid.toString(),csIp:l.gatewayInfo.csIp,unilbsServerIds:[Lr.CHOOSE_SERVER].toString(),isHttp3:l.isHttp3})}function Cq(r){return window.atob(window.localStorage.getItem(r)||"")}function GT(r,a){window.localStorage.setItem(r,window.btoa(a))}function Rq(r){let a="".concat(r.appId,"_").concat(r.cname);return typeof r.uid=="string"&&(a+="_s_".concat(r.uid)),typeof r.uid=="number"&&(a+="_".concat(r.uid)),r.token&&(a+="_".concat(r.token)),bz(a)}function kOe(r){let a=function(){const s=LOe.pop();return s?(s.offset=s.limit=0,s):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(s,l){let d=s.appId;d!==void 0&&(Mr(l,10),xh(l,d));let f=s.cid;f!==void 0&&(Mr(l,16),Mr(l,f));let m=s.cname;m!==void 0&&(Mr(l,26),xh(l,m));let y=s.deviceId;y!==void 0&&(Mr(l,34),xh(l,y));let _=s.elapse;_!==void 0&&(Mr(l,40),Th(l,_));let S=s.fileSize;S!==void 0&&(Mr(l,48),Th(l,zg(S)));let x=s.height;x!==void 0&&(Mr(l,56),Th(l,zg(x)));let A=s.jpg;A!==void 0&&(Mr(l,66),Mr(l,A.length),Aq(l,A));let I=s.networkType;I!==void 0&&(Mr(l,72),Th(l,zg(I)));let L=s.osType;L!==void 0&&(Mr(l,80),Th(l,zg(L)));let K=s.requestId;K!==void 0&&(Mr(l,90),xh(l,K));let $=s.sdkVersion;$!==void 0&&(Mr(l,98),xh(l,$));let G=s.sequence;G!==void 0&&(Mr(l,104),Th(l,zg(G)));let ne=s.sid;ne!==void 0&&(Mr(l,114),xh(l,ne));let te=s.timestamp;te!==void 0&&(Mr(l,120),Th(l,te));let ce=s.uid;ce!==void 0&&(Mr(l,128),Mr(l,ce));let pe=s.vid;pe!==void 0&&(Mr(l,136),Mr(l,pe));let fe=s.width;fe!==void 0&&(Mr(l,144),Th(l,zg(fe)));let ue=s.service;ue!==void 0&&(Mr(l,152),Mr(l,ue));let ye=s.callbackData;ye!==void 0&&(Mr(l,162),Mr(l,ye.length),Aq(l,ye));let Se=s.ticket;Se!==void 0&&(Mr(l,170),xh(l,Se));let Ie=s.vendorConfigs;Ie!==void 0&&(Mr(l,178),xh(l,Ie))}(r,a),function(s){let l=s.bytes,d=s.limit;return l.length===d?l:l.subarray(0,d)}(a)}function jOe(r){return function(s){let l={};e:for(;!MOe(s);){let d=Ob(s);switch(d>>>3){case 0:break e;case 1:l.code=Ob(s);break;case 2:l.msg=Iq(s,Ob(s));break;case 3:l.requestId=Iq(s,Ob(s));break;case 4:l.timestamp=UOe(s,!1);break;default:DOe(s,7&d)}}return l}({bytes:a=r,offset:0,limit:a.length});var a}function DOe(r,a){switch(a){case 0:for(;128&yc(r););break;case 2:HD(r,Ob(r));break;case 5:HD(r,4);break;case 1:HD(r,8);break;default:throw new Error("Unimplemented type: "+a)}}function zg(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}let LOe=[];function HD(r,a){if(r.offset+a>r.limit)throw new Error("Skip past limit");r.offset+=a}function MOe(r){return r.offset>=r.limit}function HT(r,a){let s=r.bytes,l=r.offset,d=r.limit,f=l+a;if(f>s.length){let m=new Uint8Array(2*f);m.set(s),r.bytes=m}return r.offset=f,f>d&&(r.limit=f),l}function Nq(r,a){let s=r.offset;if(s+a>r.limit)throw new Error("Read past limit");return r.offset+=a,s}function Aq(r,a){let s=HT(r,a.length);r.bytes.set(a,s)}function Iq(r,a){let s=Nq(r,a),l=String.fromCharCode,d=r.bytes,f="�",m="";for(let y=0;y<a;y++){let _,S,x,A,I=d[y+s];128&I?(224&I)==192?y+1>=a?m+=f:(_=d[y+s+1],(192&_)!=128?m+=f:(A=(31&I)<<6|63&_,A<128?m+=f:(m+=l(A),y++))):(240&I)==224?y+2>=a?m+=f:(_=d[y+s+1],S=d[y+s+2],(49344&(_|S<<8))!=32896?m+=f:(A=(15&I)<<12|(63&_)<<6|63&S,A<2048||A>=55296&&A<=57343?m+=f:(m+=l(A),y+=2))):(248&I)==240?y+3>=a?m+=f:(_=d[y+s+1],S=d[y+s+2],x=d[y+s+3],(12632256&(_|S<<8|x<<16))!=8421504?m+=f:(A=(7&I)<<18|(63&_)<<12|(63&S)<<6|63&x,A<65536||A>1114111?m+=f:(A-=65536,m+=l(55296+(A>>10),56320+(1023&A)),y+=3))):m+=f:m+=l(I)}return m}function xh(r,a){let s=a.length,l=0;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),l+=y<128?1:y<2048?2:y<65536?3:4}Mr(r,l);let d=HT(r,l),f=r.bytes;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),y<128?f[d++]=y:(y<2048?f[d++]=y>>6&31|192:(y<65536?f[d++]=y>>12&15|224:(f[d++]=y>>18&7|240,f[d++]=y>>12&63|128),f[d++]=y>>6&63|128),f[d++]=63&y|128)}}function yc(r){return r.bytes[Nq(r,1)]}function Oq(r,a){let s=HT(r,1);r.bytes[s]=a}function Ob(r){let a,s=0,l=0;do a=yc(r),s<32&&(l|=(127&a)<<s),s+=7;while(128&a);return l}function Mr(r,a){for(a>>>=0;a>=128;)Oq(r,127&a|128),a>>>=7;Oq(r,a)}function UOe(r,a){let s,l=0,d=0,f=0;return s=yc(r),l=127&s,128&s&&(s=yc(r),l|=(127&s)<<7,128&s&&(s=yc(r),l|=(127&s)<<14,128&s&&(s=yc(r),l|=(127&s)<<21,128&s&&(s=yc(r),d=127&s,128&s&&(s=yc(r),d|=(127&s)<<7,128&s&&(s=yc(r),d|=(127&s)<<14,128&s&&(s=yc(r),d|=(127&s)<<21,128&s&&(s=yc(r),f=127&s,128&s&&(s=yc(r),f|=(127&s)<<7))))))))),{low:l|d<<28,high:d>>>4|f<<24,unsigned:a}}function Th(r,a){let s=a.low>>>0,l=(a.low>>>28|a.high<<4)>>>0,d=a.high>>>24,f=d===0?l===0?s<16384?s<128?1:2:s<1<<21?3:4:l<16384?l<128?5:6:l<1<<21?7:8:d<128?9:10,m=HT(r,f),y=r.bytes;switch(f){case 10:y[m+9]=d>>>7&1;case 9:y[m+8]=f!==9?128|d:127&d;case 8:y[m+7]=f!==8?l>>>21|128:l>>>21&127;case 7:y[m+6]=f!==7?l>>>14|128:l>>>14&127;case 6:y[m+5]=f!==6?l>>>7|128:l>>>7&127;case 5:y[m+4]=f!==5?128|l:127&l;case 4:y[m+3]=f!==4?s>>>21|128:s>>>21&127;case 3:y[m+2]=f!==3?s>>>14|128:s>>>14&127;case 2:y[m+1]=f!==2?s>>>7|128:s>>>7&127;case 1:y[m]=f!==1?128|s:127&s}}const Pq={},kq={},zT=4294967296,FOe=zT*zT,jq=FOe/2;Lq(0,!0);const Dq=Lq(0),VOe=Pb(0,-2147483648,!1),BOe=Pb(-1,2147483647,!1);function Lq(r,a){let s,l,d;return a?(d=0<=(r>>>=0)&&r<256)&&(l=kq[r],l)?l:(s=Pb(r,0,!0),d&&(kq[r]=s),s):(d=-128<=(r|=0)&&r<128)&&(l=Pq[r],l)?l:(s=Pb(r,r<0?-1:0,!1),d&&(Pq[r]=s),s)}function Pb(r,a,s){return{low:0|r,high:0|a,unsigned:!!s}}function Mq(r,a){if(isNaN(r))return Dq;{if(r<=-jq)return VOe;if(r+1>=jq)return BOe}return r<0?Dq:Pb(r%zT|0,r/zT|0,a)}function Uq(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}class zD extends cr{get connectionState(){return this._connectionState}set connectionState(a){if(this._connectionState===a)return;const s=this._connectionState;this._connectionState=a,this.emit(al.CONNECTION_STATE_CHANGE,a,s)}get quality(){return this._quality}set quality(a){this._quality=a>1?1:a<.1?.1:a,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(a){var s;super(),Q(this,"name","AgoraRTCImageModeration"),Q(this,"_connectionState",No.CONNECTING),Q(this,"_sequence",0),Q(this,"_moderationStartTime",void 0),Q(this,"_workerConnection",void 0),Q(this,"_workerMessageLengthLimit",void 0),Q(this,"_qualityRatio",void 0),Q(this,"_connectInfo",void 0),Q(this,"_cancelTokenSource",Ka.CancelToken.source()),Q(this,"_retryConfig",void 0),Q(this,"_moderationInterval",void 0),Q(this,"_moderationTimer",null),Q(this,"_moderationMode",1),Q(this,"_quality",1),Q(this,"_qualityTimer",null),Q(this,"_ticket",void 0),Q(this,"_moderationIntervalMinimum",void 0),Q(this,"_uploadFailedNum",0),Q(this,"_uploadNum",0),Q(this,"_uploadTimer",null),Q(this,"_extraInfo",void 0),Q(this,"_vendor",""),Q(this,"_encoder",new TextEncoder),Q(this,"_moderationId",void 0),Q(this,"inspectImage",()=>{if(this.connectionState!==No.CONNECTED)throw new Ee(ie.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===No.CONNECTED?this.requestToInspectImage():V.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=Mn(5,"image-moderation-"),this._workerMessageLengthLimit=oe("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=oe("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(s=a.interval)!==null&&s!==void 0?s:1e3,a.extraInfo&&(this._extraInfo=this._encoder.encode(a.extraInfo)),a.vendor&&(this._vendor=a.vendor),this._qualityRatio=oe("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new Eb("worker-"+this._moderationId,Gr),this.on(al.STATE_CHANGE,(l,d)=>{V.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Dg[l]," ").concat(d||""))}),this.handleWorkerEvents()}async init(a,s){this.emit(al.STATE_CHANGE,Dg.CONNECT_AP),this._connectInfo=a;const l=this._cancelTokenSource.token;return this._retryConfig=s,new He((d,f)=>{this.on(al.CONNECTION_STATE_CHANGE,(m,y)=>{m===No.CONNECTED&&d()}),this.requestAP(a,l,s).then(m=>{this.connectWorker(m)}).catch(m=>{f(m)})})}updateConfig(a){var s;this._moderationInterval=(s=a.interval)!==null&&s!==void 0?s:1e3,a.extraInfo&&(this._extraInfo=this._encoder.encode(a.extraInfo)),a.vendor&&(this._vendor=a.vendor),V.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(a))),this.connectionState===No.CONNECTED&&this.inspectImage()}async requestAP(a,s,l){const d=oe("WEBCS_DOMAIN").map(_=>"https://".concat(_,"/api/v1")),f=await function(_,S,x,A){let{appId:I,areaCode:L,cname:K,sid:$,token:G,uid:ne}=S;Bg++;const te="moderation_plugin",ce={service_name:te,json_body:JSON.stringify({appId:I,areaCode:L,cname:K,command:"allocateEdge",requestId:Bg,seq:Bg,sid:$,appToken:G,ts:Date.now(),uid:ne+""})};let pe,fe,ue=_[0];return tl(async()=>{pe=Date.now();const ye=await sl(ue,{data:ce,cancelToken:x,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(fe=Date.now()-pe,ye.code!==0){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+ye.code,{retry:!0,responseTime:fe});throw V.error(Me.toString()),Me}const Se=JSON.parse(ye.json_body);if(Se.code!==200){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(Se.code,", reason: ").concat(Se.reason),{code:Se.code,responseTime:fe});throw V.error(Me.toString()),Me}if(!Se.servers||!Array.isArray(Se.servers)||Se.servers.length===0){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:Se.code,responseTime:fe});throw V.error(Me.toString()),Me}if(!Se.servers.some(Me=>!!Me.wss)){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:Se.code,responseTime:fe});throw V.error(Me.toString()),Me}const Ie=oe("IMAGE_MODERATION_WORKER_HOST");return{addressList:Se.servers.map(Me=>{let{address:Gt,wss:Kt}=Me;if(Gt&&Kt)return"wss://".concat(Gt.replace(/\./g,"-"),".").concat(Ie,":").concat(Kt,"/moderation")}).filter(Me=>!!Me),workerToken:Se.workerToken,vid:Se.vid,ticket:Se.appTicket,responseTime:fe}},(ye,Se)=>(it.apworkerEvent($,{success:!0,sc:200,serviceName:te,responseDetail:JSON.stringify(ye.addressList),firstSuccess:Se===0,responseTime:fe,serverIp:_[Se%_.length]}),!1),(ye,Se)=>(it.apworkerEvent($,{success:!1,sc:ye.data&&ye.data.code||200,serviceName:te,responseTime:fe,serverIp:_[Se%_.length]}),!!(ye.code!==ie.OPERATION_ABORTED&&ye.code!==ie.UNEXPECTED_RESPONSE||ye.data&&ye.data.retry)&&(ue=_[(Se+1)%_.length],!0)),A)}(d,a,s,l);this.emit(al.STATE_CHANGE,Dg.AP_CONNECTED);const{addressList:m,ticket:y}=f;return this._ticket=y,m}async connectWorker(a){this.emit(al.STATE_CHANGE,Dg.CONNECT_WORKER),await this._workerConnection.init(a,1e4)}handleWorkerEvents(){this._workerConnection.on(Bt.CONNECTED,async()=>{this.emit(al.STATE_CHANGE,Dg.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=No.CONNECTED}),this._workerConnection.on(Bt.CLOSED,()=>{this.connectionState=No.CLOSED}),this._workerConnection.on(Bt.FAILED,()=>{this.connectionState=No.CLOSED}),this._workerConnection.on(Bt.RECONNECTING,()=>{this.connectionState=this.connectionState===No.CONNECTED?No.RECONNECTING:No.CONNECTING}),this._workerConnection.on(Bt.ON_MESSAGE,async a=>{if(a.data instanceof ArrayBuffer){const s=jOe(new Uint8Array(a.data));oe("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&V.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(s)),this._uploadNum++,s.code===void 0||s.code===0||(this._uploadFailedNum++,V.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(s.code,", msg is ").concat(s.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{it.reportApiInvoke(this._connectInfo.sid||null,{name:Er.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,s.code],tag:rr.TRACER}).onError(new Ee(ie.IMAGE_MODERATION_UPLOAD_FAILED,s.msg)),this._uploadTimer=null},oe("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else V.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(Bt.WILL_RECONNECT,(a,s,l)=>{a==="recover"&&l(a),l("tryNext")}),this._workerConnection.on(Bt.REQUEST_NEW_URLS,(a,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a).catch(s)})}static intToLong(a){return{low:a|=0,high:a>>31,unsigned:a>=0}}async requestToInspectImage(){const a=qs(this,al.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(a){if(!a.isPlaying)return void(oe("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&V.debug("Only the track being played can be inspected"));this._sequence++;const l=await this.generateRequestData(a,s);this._workerConnection.sendMessage(l,!0,!0)}else oe("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&V.debug("Only the track being published can be inspected")}async generateRequestData(a,s){let{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_}=s;const S=Date.now(),x=await a.getCurrentFrameImage("image/jpeg",this.quality),A=await l9(x,l,d),I=this._sequence+"-"+f+"-"+_+"-"+S+"-"+Mn(12,""),L={appId:l,cid:f,cname:d,deviceId:"",elapse:zD.intToLong(Number(S-this._moderationStartTime)),fileSize:x.buffer.byteLength,height:x.height,width:x.width,jpg:A,networkType:6,osType:7,requestId:I,sdkVersion:"4.24.0",sequence:this._sequence,sid:y,timestamp:Mq(S),uid:_,vid:m,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete L.callbackData;const K=kOe(L);if(K.byteLength<this._workerMessageLengthLimit){if(oe("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const $=function(G){for(var ne=1;ne<arguments.length;ne++){var te=arguments[ne]!=null?arguments[ne]:{};ne%2?Uq(Object(te),!0).forEach(function(ce){Q(G,ce,te[ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(te)):Uq(Object(te)).forEach(function(ce){Object.defineProperty(G,ce,Object.getOwnPropertyDescriptor(te,ce))})}return G}({},L);delete $.jpg,V.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify($))}return K}{const $=this.quality*this._qualityRatio;return this.quality=$,await this.generateRequestData(a,{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Ka.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=No.CLOSED,this.emit(al.STATE_CHANGE,Dg.CLOSED)}}function Fq(r){if(kn(r.interval,"interval",1e3,1/0),r&&r.extraInfo&&r.extraInfo.length>1024)throw new Ee(ie.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(r&&r.vendor&&r.vendor.length>1024)throw new Ee(ie.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const $Oe={name:"ImageModeration",create:function(r){let{config:a}=r;return Fq(a),new zD(a)}};var Vq,Bq,$q,Wq,Gq,Hq,zq,Kq,qq,Yq,Xq,Jq,Zq,Qq,eY,tY,nY,rY,iY,aY,sY,oY,cY,lY,uY,dY,hY,fY,pY,mY,gY,vY,yY,_Y,bY,EY,wY,SY,xY,TY,CY,Ye;function RY(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function _c(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?RY(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):RY(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}Hi.setLogger(V);let WOe=(Vq=Et(),Bq=Et({argsMap:(r,a)=>{if(!Array.isArray(a)){if(!(a instanceof Rg))return[a];a=[a]}return a.map(s=>s?Object(s).toString():"null")}}),$q=Et({argsMap:(r,a)=>(a||(a=[]),Array.isArray(a)||a.trackMediaType!==Cg.DATA?(Array.isArray(a)||(a=[a]),a.map(s=>s.getTrackId())):[a.getChannelId()])}),Wq=Et({argsMap:(r,a,s,l)=>[typeof a=="object"?a.uid:a,s,l]}),Gq=Et({argsMap:(r,a,s)=>[a,s]}),Hq=Et({argsMap:(r,a)=>a.map(s=>{let{user:l,mediaType:d}=s;return[l==null?void 0:l.uid,d]})}),zq=Et({argsMap:(r,a,s,l)=>[typeof a=="object"?a.uid:a,s,l]}),Kq=Et({argsMap:(r,a)=>a.map(s=>{let{user:l,mediaType:d}=s;return{uid:l==null?void 0:l.uid,mediaType:d}})}),qq=Et(),Yq=Et(),Xq=Et(),Jq=Et(),Zq=Et(),Qq=Et(),eY=Et(),tY=Et(),nY=Et(),rY=Et(),iY=Et(),aY=Et(),sY=Et(),oY=Et(),cY=Et(),lY=Et({argsMap:(r,a)=>[a]}),uY=Et(),dY=Et(),hY=Et(),fY=Et(),pY=Et(),mY=Et(),gY=Et(),vY=Et(),yY=Et({argsMap:(r,a)=>(Array.isArray(a)||(a=[a]),[JSON.stringify(a)])}),_Y=Et(),bY=Et(),EY=Et(),wY=Et(),SY=Et(),xY=Et(),TY=Et({reportResult:!0}),CY=Et(),Ye=class extends cr{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var r;return((r=this._config)===null||r===void 0?void 0:r.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(r,a){let s;if(super(),Q(this,"store",void 0),Q(this,"_uid",void 0),Q(this,"_channelName",void 0),Q(this,"_uintUid",void 0),Q(this,"_users",[]),Q(this,"_config",void 0),Q(this,"_clientId",void 0),Q(this,"_appId",void 0),Q(this,"_sessionId",null),Q(this,"_key",void 0),Q(this,"_rtmConfig",{}),Q(this,"_joinInfo",void 0),Q(this,"_gateway",void 0),Q(this,"_statsCollector",void 0),Q(this,"_configDistribute",void 0),Q(this,"_leaveMutex",void 0),Q(this,"_publishMutex",void 0),Q(this,"_renewTokenMutex",void 0),Q(this,"_subscribeMutex",void 0),Q(this,"_encryptionMode","none"),Q(this,"_encryptionSecret",null),Q(this,"_encryptionSalt",null),Q(this,"_encryptDataStream",!1),Q(this,"_encryptDataStreamKey",null),Q(this,"_encryptDataStreamIv",null),Q(this,"_proxyServer",void 0),Q(this,"_turnServer",{servers:[],mode:"auto"}),Q(this,"_cloudProxyServerMode","disabled"),Q(this,"_isDualStreamEnabled",!1),Q(this,"_defaultStreamFallbackType",void 0),Q(this,"_lowStreamParameter",void 0),Q(this,"_streamFallbackTypeCacheMap",new Map),Q(this,"_remoteStreamTypeCacheMap",new Map),Q(this,"_axiosCancelSource",Ka.CancelToken.source()),Q(this,"_audioVolumeIndicationInterval",void 0),Q(this,"_networkQualityInterval",void 0),Q(this,"_userOfflineTimeout",void 0),Q(this,"_streamRemovedTimeout",void 0),Q(this,"_liveTranscodeStreamingClient",void 0),Q(this,"_liveRawStreamingClient",void 0),Q(this,"_channelMediaRelayClient",void 0),Q(this,"_networkQualitySensitivity","normal"),Q(this,"_p2pChannel",void 0),Q(this,"_useLocalAccessPoint",!1),Q(this,"_setLocalAPVersion",void 0),Q(this,"_joinAndNotLeaveYet",!1),Q(this,"_numberOfJoinCount",0),Q(this,"_joinResponse",null),Q(this,"_remoteDefaultVideoStreamType",void 0),Q(this,"_inspect",void 0),Q(this,"_moderation",void 0),Q(this,"_license",void 0),Q(this,"_pendingPublishedUsers",[]),Q(this,"ntpAlignErrorCount",0),Q(this,"remoteInboundOffset",0),Q(this,"_peerConnectionState",void 0),Q(this,"_handleLocalTrackEnable",(d,f,m)=>{this.publish(d,!1).then(f).catch(m)}),Q(this,"_handleLocalTrackDisable",(d,f,m)=>{this.unpublish(d).then(f).catch(m)}),Q(this,"_handleUserOnline",d=>{if(oe("BLOCK_LOCAL_CLIENT")&&pp(d.uid,this.channelName))return void V.debug("[".concat(d.uid,"] will be ignored in local"));this.isStringUID&&typeof d.uid!="string"&&V.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const f=this._users.find(m=>m.uid===d.uid);if(f)f._trust_in_room_=!0,f._is_pre_created&&(f._is_pre_created=!1,this.safeEmit(Zt.USER_JOINED,f));else{const m=new wh(d.uid,d.uint_id||d.uid);this._users.push(m),V.debug("[".concat(this._clientId,"] user online"),d.uid),this.store.firstVideoFrameDecoded(m.uid,{userJoinNotify:Date.now()}),this.safeEmit(Zt.USER_JOINED,m)}}),Q(this,"_handleUserOffline",d=>{if(oe("BLOCK_LOCAL_CLIENT")&&pp(d.uid,this.channelName))return;const f=this._users.find(m=>m.uid===d.uid);f&&(this._handleRemoveStream(d),this._handleRemoveDataChannels(d),f._audio_pre_subscribed||f._video_pre_subscribed?f._is_pre_created=!0:zx(this._users,f),this._remoteStreamTypeCacheMap.delete(f.uid),this._streamFallbackTypeCacheMap.delete(f.uid),V.debug("[".concat(this._clientId,"] user offline"),d.uid,"reason:",d.reason),this.safeEmit(Zt.USER_LEAVED,f,d.reason))}),Q(this,"_handleAddAudioOrVideoStream",(d,f,m,y,_,S,x,A)=>{if(oe("BLOCK_LOCAL_CLIENT")&&pp(f,this.channelName))return;const I=this._users.find(K=>K.uid===f);if(!I)return void V.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));V.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(d)),this.store.subscribe(I.uid,d,void 0,void 0,void 0,Date.now()),d==="video"&&this.store.firstVideoFrameDecoded(I.uid,{videoAddNotify:Date.now()});const L=d==="audio"?I.hasAudio:I.hasVideo;if(I._uintid||(I._uintid=S||f),d==="audio"?I._trust_audio_stream_added_state_=!0:I._trust_video_stream_added_state_=!0,d==="audio"?(I._audio_added_=!0,m!==void 0&&(I._audioSSRC=m),y!==void 0&&(I._cname=y),x&&(I._audioOrtc=x)):(I._video_added_=!0,m!==void 0&&(I._videoSSRC=m),y!==void 0&&(I._cname=y),A!==void 0&&(I._rtxSsrcId=A),x&&(I._videoOrtc=x)),(d==="audio"?I.hasAudio:I.hasVideo)&&!L&&(V.info("[".concat(this._clientId,"] remote user ").concat(I.uid," published ").concat(d)),this.safeEmit(Zt.USER_PUBLISHED,I,d)),d==="video"?it.onGatewayStream(this._sessionId,ii.ON_ADD_VIDEO_STREAM,Qn.ON_ADD_VIDEO_STREAM,{peer:S||f,ssrc:I._videoSSRC}):it.onGatewayStream(this._sessionId,ii.ON_ADD_AUDIO_STREAM,Qn.ON_ADD_AUDIO_STREAM,{peer:S||f,ssrc:I._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(I,d,m).then(K=>{if(K&&(V.debug("[".concat(this._clientId,"] resubscribe ").concat(d," for user ").concat(I.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Ib))return this._p2pChannel.unsubscribe(I,d,!0).then(()=>this._subscribe(I,d,!0).catch($=>{V.error("[".concat(this._clientId,"] resubscribe error"),$.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(I,d)&&(V.debug("[".concat(this._clientId,"] resubscribe ").concat(d," for user ").concat(I.uid," after reconnect.")),this._subscribe(I,d,!0).catch(K=>{V.error("[".concat(this._clientId,"] resubscribe error"),K.toString())})),d==="video"&&!ji()&&!oa()){const K=this._getEncodingName(_);(K==null?void 0:K.toLocaleLowerCase())==fb.av1&&pOe().then($=>{$||this._gateway.downgradeCodec(K)})}}),Q(this,"_handleRemoveStream",d=>{if(oe("BLOCK_LOCAL_CLIENT")&&pp(d.uid,this.channelName))return;const f=this._users.find(y=>y.uid===d.uid);if(!f)return void V.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));V.debug("[".concat(this._clientId,"] stream removed with uid ").concat(d.uid));let m=()=>{};f.hasAudio&&f.hasVideo?m=()=>{V.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),this.safeEmit(Zt.USER_UNPUBLISHED,f,"audio"),V.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),this.safeEmit(Zt.USER_UNPUBLISHED,f,"video")}:f.hasVideo?m=()=>{V.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),this.safeEmit(Zt.USER_UNPUBLISHED,f,"video")}:f.hasAudio&&(m=()=>{V.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),this.safeEmit(Zt.USER_UNPUBLISHED,f,"audio")}),f._video_pre_subscribed||f._audio_pre_subscribed||(f._trust_audio_stream_added_state_=!0,f._trust_video_stream_added_state_=!0,f._audio_added_=!1,f._video_added_=!1,this._p2pChannel instanceof Ib&&this._p2pChannel.unsubscribe(f).then(y=>{if(y)return this._gateway.unsubscribe(y,f.uid)}),f._audioSSRC=void 0,f._videoSSRC=void 0,f._audioOrtc=void 0,f._videoOrtc=void 0,f._rtxSsrcId=void 0),it.onGatewayStream(this._sessionId,ii.ON_REMOVE_STREAM,Qn.ON_REMOVE_STREAM,{peer:d.uint_id||d.uid}),m()}),Q(this,"_handleSetStreamLocalEnable",(d,f,m)=>{if(oe("BLOCK_LOCAL_CLIENT")&&pp(f,this.channelName))return;const y=this._users.find(x=>x.uid===f);if(!y)return void V.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));V.debug("[".concat(this._clientId,"] local ").concat(d," ").concat(m?"enabled":"disabled"," with uid ").concat(f));const _=d==="audio"?y.hasAudio:y.hasVideo;if(d==="audio"){y._trust_audio_enabled_state_=!0;const x=y._audio_enabled_;if(y._audio_enabled_=m,y._audio_enabled_===x)return;{const A=y._audio_enabled_?"enable-local-audio":"disable-local-audio";V.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(f,", msg: ").concat(A)),this.safeEmit(Zt.USER_INFO_UPDATED,f,A)}}else{y._trust_video_enabled_state_=!0;const x=y._video_enabled_;if(y._video_enabled_=m,y._video_enabled_===x)return;{const A=y._video_enabled_?"enable-local-video":"disable-local-video";V.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(f,", msg: ").concat(A)),this.safeEmit(Zt.USER_INFO_UPDATED,f,A)}}const S=d==="audio"?y.hasAudio:y.hasVideo;return _!==S?!_&&S?(V.info("[".concat(this._clientId,"] remote user ").concat(f," published ").concat(d)),void this.safeEmit(Zt.USER_PUBLISHED,y,d)):(d==="video"&&y._videoTrack&&y._videoTrack._destroy(),d==="audio"&&y._audioTrack,this._p2pChannel.muteRemote(y,d),V.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished ").concat(d)),void this.safeEmit(Zt.USER_UNPUBLISHED,y,d)):void 0}),Q(this,"_handleMuteStream",(d,f,m)=>{if(oe("BLOCK_LOCAL_CLIENT")&&pp(d,this.channelName))return;V.debug("[".concat(this._clientId,"] receive mute message"),d,f,m);const y=this._users.find(x=>x.uid===d);if(!y)return void V.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(d));const _=f==="audio"?y.hasAudio:y.hasVideo;if(f==="audio"){y._trust_audio_mute_state_=!0;const x=y._audio_muted_;if(y._audio_muted_=m,y._audio_muted_===x)return;{const A=y._audio_muted_?"mute-audio":"unmute-audio";V.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(d,", msg: ").concat(A)),this.safeEmit(Zt.USER_INFO_UPDATED,d,A)}}else{y._trust_video_mute_state_=!0;const x=y._video_muted_;if(y._video_muted_=m,y._video_muted_===x)return;{const A=y._video_muted_?"mute-video":"unmute-video";V.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(d,", msg: ").concat(A)),this.safeEmit(Zt.USER_INFO_UPDATED,d,A)}}const S=f==="audio"?y.hasAudio:y.hasVideo;if(_!==S){if(!_&&S)return(f==="audio"?y._audioSSRC:y._videoSSRC)?(V.info("[".concat(this._clientId,"] remote user ").concat(d," published ").concat(f)),void this.safeEmit(Zt.USER_PUBLISHED,y,f)):void V.warning("[".concat(this._clientId,"] remote user ").concat(d," receive ").concat(f," unmute message  before add stream message, ").concat(f," SSRC doesn't exist yet."));f==="video"&&y._videoTrack&&!y._video_pre_subscribed&&y._videoTrack._destroy(),f==="audio"&&y._audioTrack,this._p2pChannel.muteRemote(y,f),V.info("[".concat(this._clientId,"] remote user ").concat(d," unpublished ").concat(f)),this.safeEmit(Zt.USER_UNPUBLISHED,y,f)}}),Q(this,"_handleP2PLost",async d=>{V.debug("[".concat(this._clientId,"] receive p2p lost"),d),parseInt(d.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():V.warning("[".concat(this._clientId,"] P2PLost stream not found"),d)}),Q(this,"_handleTokenWillExpire",()=>{V.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Zt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),Q(this,"_handleBeforeUnload",d=>{d.type==="beforeunload"&&d.returnValue!==void 0&&d.returnValue!==""||(this.leave(),V.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),Q(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Zt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const d={downlinkNetworkQuality:0,uplinkNetworkQuality:0};d.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),d.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Zt.NETWORK_QUALITY,d)}),Q(this,"_handleP2PAddAudioOrVideoStream",(d,f,m,y)=>{const _=this._users.find(x=>x.uid===f);if(!_)return void V.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));V.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(d)),this.store.subscribe(_.uid,d,void 0,void 0,void 0,Date.now());const S=d==="audio"?_.hasAudio:_.hasVideo;d==="audio"?_._trust_audio_stream_added_state_=!0:_._trust_video_stream_added_state_=!0,d==="audio"?(_._audio_added_=!0,m!==void 0&&(_._audioSSRC=m),y!==void 0&&(_._audioMid=y)):(_._video_added_=!0,m!==void 0&&(_._videoSSRC=m),y!==void 0&&(_._videoMid=y)),(d==="audio"?_.hasAudio:_.hasVideo)&&!S&&(V.info("[".concat(this._clientId,"] remote user ").concat(_.uid," published ").concat(d)),this.safeEmit(Zt.USER_PUBLISHED,_,d)),this._p2pChannel.hasPendingRemoteMedia(_,d)&&(V.debug("[".concat(this._clientId,"] resubscribe ").concat(d," for user ").concat(_.uid," after reconnect.")),this._subscribe(_,d,!0).catch(x=>{V.error("[".concat(this._clientId,"] resubscribe error"),x.toString())}))}),this._config=r,this._clientId=a||Mn(5,"client-"),this.store=new class{constructor(d,f,m,y){kt(this,"state",void 0),this.state={codec:d,audioCodec:f,mode:m,clientId:y,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[],firstVideoFrameDecoded:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:op.Default,hasStartJoinChannel:!1,isABTestSuccess:!1,autoSubscribe:!1,enableInstantMuteRestore:!1}}dispatch(d){this.state=function(f,m){switch(m.type){case Lt.SET_SESSION_ID:return Ue(Ue({},f),{},{sessionId:m.sessionId});case Lt.SET_P2P_ID:return Ue(Ue({},f),{},{p2pId:m.p2pId});case Lt.SET_UID:return Ue(Ue({},f),{},{uid:m.uid});case Lt.SET_INT_UID:return Ue(Ue({},f),{},{intUid:m.intUid});case Lt.SET_PUB_ID:return Ue(Ue({},f),{},{pubId:m.pubId});case Lt.KEY_METRIC_CLIENT_CREATED:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{clientCreated:m.metric})});case Lt.KEY_METRIC_JOIN_START:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{joinStart:m.metric})});case Lt.KEY_METRIC_PRELOAD_START:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{preloadStart:m.metric})});case Lt.KEY_METRIC_PRELOAD_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{preloadEnd:m.metric})});case Lt.KEY_METRIC_JOIN_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{joinEnd:m.metric})});case Lt.KEY_METRIC_REQUEST_AP_START:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{requestAPStart:m.metric})});case Lt.KEY_METRIC_REQUEST_AP_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{requestAPEnd:m.metric})});case Lt.KEY_METRIC_REQUEST_SUA_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{requestSUAEnd:m.metric})});case Lt.KEY_METRIC_BEFORE_CONNECT:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{beforeConnect:m.metric})});case Lt.KEY_METRIC_PEER_RECEIVER:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{peerReceiver:m.metric})});case Lt.KEY_METRIC_SIGNAL_CONNECTED:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{signalConnected:m.metric})});case Lt.KEY_METRIC_JOIN_REQ:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{joinReq:m.metric})});case Lt.KEY_METRIC_JOIN_REP:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{joinRep:m.metric})});case Lt.KEY_METRIC_JOIN_GATEWAY_START:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{joinGatewayStart:m.metric})});case Lt.KEY_METRIC_JOIN_GATEWAY_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{joinGatewayEnd:m.metric})});case Lt.KEY_METRIC_PEER_CONNECTION_START:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{peerConnectionStart:m.metric})});case Lt.KEY_METRIC_PEER_CONNECTION_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{peerConnectionEnd:m.metric})});case Lt.KEY_METRIC_DESCRIPTION_START:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{descriptionStart:m.metric})});case Lt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{signalChannelOpen:m.metric})});case Lt.KEY_METRIC_ICE_CONNECTION_END:return Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{iceConnectionEnd:m.metric})});case Lt.KEY_METRIC_PUBLISH:{const y=f.keyMetrics.publish,_=y.findIndex(S=>S.trackId===m.metric.trackId);return _!==-1?(y[_]=Ue(Ue({},y[_]),m.metric),Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{publish:[...y]})})):Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{publish:[...f.keyMetrics.publish,m.metric]})})}case Lt.KEY_METRIC_SUBSCRIBE:{const y=f.keyMetrics.subscribe,_=y.findIndex(S=>S.userId===m.metric.userId&&S.type===m.metric.type);return _!==-1?(y[_]=Ue(Ue({},y[_]),m.metric),Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{subscribe:[...y]})})):Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{subscribe:[...f.keyMetrics.subscribe,m.metric]})})}case Lt.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED:{const y=f.keyMetrics.firstVideoFrameDecoded,_=y.findIndex(S=>S.userId===m.metric.userId);return _!==-1?(y[_]=Ue(Ue({},y[_]),m.metric),Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{firstVideoFrameDecoded:[...y]})})):Ue(Ue({},f),{},{keyMetrics:Ue(Ue({},f.keyMetrics),{},{firstVideoFrameDecoded:[...f.keyMetrics.firstVideoFrameDecoded,m.metric]})})}case Lt.RESET_FIRST_VIDEO_FRAME_DECODED:return f.keyMetrics.firstVideoFrameDecoded=[],f;case Lt.SET_CLOUD_PROXY_SERVER_MODE:return f.cloudProxyServerMode=m.mode,f;case Lt.RECORD_JOIN_CHANNEL_SERVICE:return typeof m.index!="number"?f.joinChannelServiceRecords=[...f.joinChannelServiceRecords,m.record]:(f.joinChannelServiceRecords[m.index]=Ue(Ue({},f.joinChannelServiceRecords[m.index]),m.record),f.joinChannelServiceRecords=[...f.joinChannelServiceRecords]),f;case Lt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return f.joinChannelServiceRecords=[],f;case Lt.RESET_KEY_METRICS:return f.keyMetrics={publish:[],subscribe:[],firstVideoFrameDecoded:[]},f;case Lt.SET_USE_P2P:return Ue(Ue({},f),{},{useP2P:m.val});case Lt.SET_TRANSPORT_TYPE:return Ue(Ue({},f),{},{p2pTransport:m.val});default:return f}}(this.state,d)}set autoSubscribe(d){this.state.autoSubscribe=d}get autoSubscribe(){return this.state.autoSubscribe}set enableInstantMuteRestore(d){this.state.enableInstantMuteRestore=d}get enableInstantMuteRestore(){return this.state.enableInstantMuteRestore}set sessionId(d){this.dispatch({type:Lt.SET_SESSION_ID,sessionId:d})}get sessionId(){return this.state.sessionId}set cid(d){this.state.cid=d}get cid(){return this.state.cid}set codec(d){this.state.codec=d}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(d){this.dispatch({type:Lt.SET_P2P_ID,p2pId:d})}get p2pId(){return this.state.p2pId}set dcId(d){this.dispatch({type:Lt.SET_DC_ID,dcId:d})}get dcId(){return this.state.dcId}set uid(d){this.dispatch({type:Lt.SET_UID,uid:d})}get uid(){return this.state.uid}set intUid(d){this.dispatch({type:Lt.SET_INT_UID,intUid:d})}get intUid(){return this.state.intUid}set pubId(d){this.dispatch({type:Lt.SET_PUB_ID,pubId:d})}get pubId(){return this.state.pubId}set cloudProxyServerMode(d){this.dispatch({type:Lt.SET_CLOUD_PROXY_SERVER_MODE,mode:d})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(d){this.dispatch({type:Lt.SET_USE_P2P,val:d})}get useP2P(){return this.state.useP2P}set p2pTransport(d){this.dispatch({type:Lt.SET_TRANSPORT_TYPE,val:d})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(d){this.state.hasStartJoinChannel=d}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(d){this.state.isABTestSuccess=d}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:Lt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:Lt.KEY_METRIC_JOIN_START,metric:Date.now()})}preloadStart(){this.dispatch({type:Lt.KEY_METRIC_PRELOAD_START,metric:Date.now()})}preloadEnd(){this.dispatch({type:Lt.KEY_METRIC_PRELOAD_END,metric:Date.now()})}joinEnd(){this.dispatch({type:Lt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:Lt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:Lt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}requestSUAEnd(){this.dispatch({type:Lt.KEY_METRIC_REQUEST_SUA_END,metric:Date.now()})}beforeConnect(){this.dispatch({type:Lt.KEY_METRIC_BEFORE_CONNECT,metric:Date.now()})}peerReceiver(){this.dispatch({type:Lt.KEY_METRIC_PEER_RECEIVER,metric:Date.now()})}signalConnected(){this.dispatch({type:Lt.KEY_METRIC_SIGNAL_CONNECTED,metric:Date.now()})}joinReq(){this.dispatch({type:Lt.KEY_METRIC_JOIN_REQ,metric:Date.now()})}joinRep(){this.dispatch({type:Lt.KEY_METRIC_JOIN_REP,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:Lt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:Lt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:Lt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:Lt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}firstVideoFrameDecoded(d,f){this.dispatch({type:Lt.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED,metric:Ue({userId:d},f)})}descriptionStart(){this.dispatch({type:Lt.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:Lt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:Lt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(d,f,m,y){this.dispatch({type:Lt.KEY_METRIC_PUBLISH,metric:Ue(Ue({trackId:d,type:f},m&&{publishStart:m}),y&&{publishEnd:y})})}subscribe(d,f,m,y,_,S,x){this.dispatch({type:Lt.KEY_METRIC_SUBSCRIBE,metric:Ue(Ue(Ue(Ue(Ue({userId:d,type:f},m&&{subscribeStart:m}),y&&{subscribeEnd:y}),_&&{firstFrame:_}),S&&{streamAdded:S}),x&&{firstDecoded:x})})}massSubscribe(d,f,m,y){d.forEach(_=>{this.dispatch({type:Lt.KEY_METRIC_SUBSCRIBE,metric:Ue(Ue(Ue({userId:_.userId,type:_.type},f&&{subscribeStart:f}),m&&{subscribeEnd:m}),y&&{firstFrame:y})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(d,f){d.service==="gateway"&&Array.isArray(d.urls)&&(d.urls=d.urls.map(m=>m.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof f!="number"?(this.dispatch({type:Lt.RECORD_JOIN_CHANNEL_SERVICE,record:Ue(Ue({},d),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(f<0||f>=this.state.joinChannelServiceRecords.length||this.dispatch({type:Lt.RECORD_JOIN_CHANNEL_SERVICE,record:d,index:f}),f)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:Lt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:Lt.RESET_KEY_METRICS})}resetFirstVideoFrameDecoded(){this.dispatch({type:Lt.RESET_FIRST_VIDEO_FRAME_DECODED})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}}(r.codec,r.audioCodec,r.mode,this._clientId),this._leaveMutex=new Hi("client-leave",this._clientId),this._publishMutex=new Hi("client-publish",this._clientId),this._renewTokenMutex=new Hi("client-renewtoken",this._clientId),this._subscribeMutex=new Hi("client-subscribe",this._clientId),this.store.clientCreated(),r.proxyServer&&this.setProxyServer(r.proxyServer,!0),r.turnServer&&this.setTurnServer(r.turnServer,!0),V.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(xo," build: ").concat(Oj,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),r.clientRoleOptions)try{yj(r.clientRoleOptions),s=Object.assign({},r.clientRoleOptions)}catch(d){V.warning("[".concat(this._clientId,"] ").concat(d.toString()))}var l;this._statsCollector=new Nb(this.store),this._statsCollector.onStatsException=(d,f,m)=>{V.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(d,", msg: ").concat(f,", uid: ").concat(m)),d===ID.VIDEO_ENCODE_FAILED&&this.localTracks.forEach(y=>{y instanceof sT&&oe("ENABLE_ENCODE_EXCEPTION")&&y.findClosestProfile()}),this.safeEmit(Zt.EXCEPTION,{code:d,msg:f,uid:m})},this._statsCollector.onUploadPublishDuration=(d,f,m,y)=>{const _=this._users.find(S=>S.uid===d);_&&(this.store.keyMetrics&&(this.store.firstVideoFrameDecoded(_._uintid,{peerPublishDuration:m,peerPubStatusMs:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(_)),it.peerPublishStatus(this._sessionId,{subscribeElapse:y,audioPublishDuration:f,videoPublishDuration:m,peer:_._uintid}))},this._statsCollector.onVideoCodecChanged=d=>{if(oe("VIDEO_STANDARD_BITRATE_VERSION")&&(d==="av1"||d==="h265"||d==="h264")){const f=this.localTracks.find(m=>m instanceof Gn);f&&f._saveEncodeBitrateRatio!==1&&f.setSaveEncodeBitrateRatio(d==="h264"?oe("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P=r.mode==="p2p",this._gateway=new cOe(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:r.websocketRetryConfig||Gr,httpRetryConfig:r.httpRetryConfig||Gr,forceWaitGatewayResponse:r.forceWaitGatewayResponse===void 0||r.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:r.role,clientRoleOptions:s}),this._configDistribute=new _Oe(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(l={store:this.store,statsCollector:this._statsCollector},cd("P2PChannel").create(l)),this._handleP2PEvents()):this._p2pChannel=new Ib(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(r,a,s,l,d){let f=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],m=arguments.length>6&&arguments[6]!==void 0&&arguments[6];An("JOIN_GATEWAY_USE_443PORT_ONLY",f),An("JOIN_GATEWAY_USE_DUAL_DOMAIN",m);const y=this._gateway.signal.websocket;return y instanceof mD&&(y.use443PortOnly=f,y.tryDoubleDomain=m),async function(_,S,x){Bx.get(_)||Bx.set(_,[]),$x.get(_)||$x.set(_,S),Ql.get(_)||Ql.set(_,0);const A=Bx.get(_),I=$x.get(_);if(!A||!I)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Ql.get(_)===I){const ne=ib();A.push(ne),await ne.promise}Ql.set(_,Ql.get(_)+1);for(var L=arguments.length,K=new Array(L>3?L-3:0),$=3;$<L;$++)K[$-3]=arguments[$];const G=await x(...K);return Ql.set(_,Ql.get(_)-1),Ql.get(_)===I-1&&A.length>0&&(A[0].resolve(),A.shift()),Ql.get(_)===0&&(Bx.set(_,[]),$x.set(_,0),Ql.set(_,0)),G}("client.join",oe("JOIN_MAX_CONCURRENCY"),this.join.bind(this),r,a,s,l,d)}async join(r,a,s,l,d){const f=++this._numberOfJoinCount;this.store.joinStart(),l&&(this.store.uid=l);const m=(Yx||Yx||(Yx=(window.location.protocol.split(":")[0]||"").toUpperCase(),Yx))==="HTTPS",y=Sz()?window.isSecureContext:"Browser Not Support";(!Sz()&&!m||!window.isSecureContext)&&V.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser");let _;it.setAppId(r);try{if(!s&&s!==null)throw new Ee(ie.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));if(s&&xi(s,"token",1,2047),xi(r,"appid",1,2047),vT(a),l&&yT(l),d)if(typeof d=="string")xi(d,"optionalInfo",1,256),_=d;else{if(typeof d!="object")throw new Ee(ie.INVALID_PARAMS,"Invalid options: options is not a string or object");{const{autoSubscribe:G,enableInstantMuteRestore:ne}=d;G&&(el(G,"autoSubscribe"),V.info("[".concat(this._clientId,"] join: autoSubscribe: ").concat(G)),this.store.autoSubscribe=G),ne&&(el(ne,"enableInstantMuteRestore"),V.info("[".concat(this._clientId,"] join: enableInstantMuteRestore: ").concat(ne)),this.store.enableInstantMuteRestore=ne)}}}catch(G){throw it.reportApiInvoke(sp(),{name:Er.JOIN,options:[r,a,s,l],states:{isHttps:m,isSecureContext:y},tag:rr.TRACER}).onError(G),G}if(this._leaveMutex.isLocked&&(V.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),V.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const G=new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw it.reportApiInvoke(sp(),{name:Er.JOIN,options:[r,a,s,l],states:{isHttps:m,isSecureContext:y},tag:rr.TRACER}).onError(G),G}this._gateway.state="CONNECTING",this.store.preloadStart();const S=await wq({appId:r,cname:a,uid:l,stringUid:typeof l=="string"?l:void 0,token:s||r,cloudProxyServer:this._cloudProxyServerMode});if(this.store.preloadEnd(),!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const x=(S==null?void 0:S.sid)||sp();V.info("[".concat(this._clientId,"] start join channel ").concat(a,", join number: ").concat(f)),this._sessionId||(this._sessionId=x,this.store.sessionId=this._sessionId);const A=it.reportApiInvoke(x,{id:this._clientId,name:Er.JOIN,options:[r,a,s,l],states:{isHttps:m,isSecureContext:y},tag:rr.TRACER}),I=_c(_c(_c({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:r,sid:this._sessionId,cname:a,uid:typeof l!="string"?l:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:s||r,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:_,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!S},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:oe("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(I.setLocalAPVersion=this._setLocalAPVersion),typeof l=="string"&&(I.stringUid=l,this._uintUid?(I.uid=this._uintUid,this._uintUid=void 0):I.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(I.aesmode=this._encryptionMode,I.aespassword=await(async G=>{const ne=function(fe){const ue=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),ye=new Uint8Array(new ArrayBuffer(ue.length));for(let Se=0;Se<ue.length;Se+=1)ye[Se]=ue.charCodeAt(Se);return ye}(),te=await window.crypto.subtle.importKey("spki",ne,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),ce=gj(G),pe=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},te,ce);return function(fe){let ue="";for(let ye=0;ye<fe.length;ye+=1)ue+=String.fromCharCode(fe[ye]);return window.btoa(ue)}(new Uint8Array(pe))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(I.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const G=new TextEncoder,ne=oe("USE_PURE_ENCRYPTION_MASTER_KEY")?G.encode(I.appId+this._encryptionSecret+this._encryptionSecret):G.encode(I.appId+I.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(te,ce,pe){const fe=await window.crypto.subtle.importKey("raw",ce,"PBKDF2",!1,["deriveBits","deriveKey"]),ue=te==="aes-128-gcm2"?128:256,ye=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:kz,hash:"SHA-256",salt:pe},fe,ue+U1e);return new Uint8Array(ye).subarray(ue/8)}(this._encryptionMode,ne,ap(this._encryptionSalt)),this._encryptDataStreamKey=await async function(te,ce,pe){const fe=await window.crypto.subtle.importKey("raw",ce,"PBKDF2",!1,["deriveBits","deriveKey"]),ue=te==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:kz,hash:"SHA-256",salt:pe},fe,{name:"AES-GCM",length:ue},!0,["encrypt","decrypt"])}(this._encryptionMode,ne,ap(this._encryptionSalt))}else y?V.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):V.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,V.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:a,appId:r,stringUid:I.stringUid});const L=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&L===this._sessionId&&it.joinChannelTimeout(this._sessionId,5)},5e3);try{var K;let G;const ne=I.cloudProxyServer;if(Be(K=["proxy3","proxy4","proxy5"]).call(K,ne)){const ue=oe("PROXY_SERVER_TYPE3");Array.isArray(ue)?I.proxyServer=ue[0]:I.proxyServer=ue}if(it.setProxyServer(I.proxyServer),V.setProxyServer(I.proxyServer),this.store.requestAPStart(),S){if(V.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(I.stringUid?", ".concat(I.stringUid," => ").concat(S.intUid):""," ")),I.stringUid&&!I.uid&&(I.uid=S.intUid),G={gatewayInfo:S.ap.gatewayInfo},oe("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&I.turnServer.mode==="auto")if(S.ap.proxyInfo.addresses.length===0)V.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const ue=(await yK(S.ap.proxyInfo,S.ap.gatewayInfo.uid)).map(ye=>({turnServerURL:ye.address,tcpport:ye.tcpport||Mi.tcpport,udpport:ye.udpport||Mi.udpport,username:ye.username||Mi.username,password:ye.password||Mi.password,forceturn:!1,security:!0}));I.turnServer={mode:"manual",servers:ue}}Tq(S,I.stringUid)}else{if(I.stringUid&&!I.uid){let ue;[ue,G]=await He.all([zK(I.stringUid,I,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,this.store).finally(()=>{this.store.requestSUAEnd()}),HK(I,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,!0,this.store).finally(()=>{this.store.requestAPEnd()})]),V.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(I.stringUid," => ").concat(ue)),I.uid=ue,G.gatewayInfo.uid=ue,G.gatewayInfo.res.uid=ue}else G=await HK(I,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(I,this._axiosCancelSource.token),this._configDistribute.on(_b.UPDATE_BITRATE_LIMIT,ue=>{this._p2pChannel.updateBitrateLimit(ue)}),this._configDistribute.on(_b.UPDATE_CLIENT_ROLE_OPTIONS,ue=>{this._setClientRoleOptions(ue)})},0),this._key=s||r;const te=G.gatewayInfo,ce=I.uid?I.uid:te.uid;this._joinInfo=_c(_c({},I),{},{cid:te.cid,uid:ce,vid:te.vid,apResponse:te.res,apGatewayAddress:te.apGatewayAddress,uni_lbs_ip:te.uni_lbs_ip,gatewayAddrs:te.gatewayAddrs}),this.store.intUid=ce,this.store.cid=te.cid;const pe=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));A.onSuccess(pe),this._appId=r,this._channelName=I.cname,this._uid=pe,this.store.uid=pe,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(ji()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const fe=I.stringUid?"string uid: ".concat(I.stringUid,",uid: ").concat(I.uid):"uid: ".concat(this._uid);return V.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(a,",").concat(fe)),setTimeout(()=>{V.startUpload()},5e3),this.store.joinEnd(),$=this,Be(fp).call(fp,$)||fp.push($),this._cloudProxyServerMode==="disabled"&&un().supportWebCrypto&&oe("ENABLE_PRELOAD")&&GD(this._joinInfo),pe}catch(G){const ne=Array.isArray(G)?G[0]:G;throw ne&&ne.code===ie.OPERATION_ABORTED?V.warning("[".concat(this._clientId,"] join number: ").concat(f,", Joining channel failed, rollback"),ne):V.error("[".concat(this._clientId,"] join number: ").concat(f,", Joining channel failed, rollback"),ne),ne.code!==ie.OPERATION_ABORTED&&this._numberOfJoinCount===f&&(this._gateway.state="DISCONNECTED",this._reset()),A.onError(ne),ne}var $}_joinGateway(){if(!this._joinInfo||!this._key)throw new Ee(ie.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!oe("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){V.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(ji()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(a){const s=fp.indexOf(a);s!==-1&&fp.splice(s,1)}(this),this._statsCollector.stopUpdateStats();const r=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return V.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void r();await this._gateway.leave(this.connectionState!=="CONNECTED",En.LEAVE),V.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),r()}async publish(r){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(r)){if(!(r instanceof Rg))return this._publishDataChannel(r);r=[r]}if(r.length===0)throw new Ee(ie.INVALID_PARAMS,"param list is empty");const s=r;if(this._gateway.role==="audience")throw new Ee(ie.INVALID_OPERATION,"audience can not publish stream");for(const d of s){if(!(d instanceof Rg))throw new Ee(ie.INVALID_PARAMS,"parameter is not local track");if(!d._enabled&&a)throw new Ee(ie.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(d.getTrackId()))}V.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(s.map(d=>"".concat(d.getTrackId()," "))));const l=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),a&&s.forEach(d=>{const f=this._configDistribute.getBitrateLimit();d instanceof Gn&&f&&d.setBitrateLimit(f.uplink)});try{await this._publishHighStream(s),V.info("[".concat(this._clientId,"] Publish success, id ").concat(s.map(d=>"".concat(d.getTrackId()," "))))}catch(d){throw V.error("[".concat(this._clientId,"] publish error"),d.toString()),d}finally{l()}}async _publishDataChannel(r){if(r==null)throw new Ee(ie.INVALID_PARAMS,"parameter is not local track or datachannel config, config is ".concat(JSON.stringify(r)));kn(r.id,"id",0,65535,!0),el(r.ordered,"ordered"),xi(r.metadata,"metadata",0,512),V.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(r.id));const a=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(d=>d.id===r.id)!==-1)throw new Ee(ie.INVALID_PARAMS,"Invalid id: ".concat(r.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&oe("FORCE_TURN")&&!oe("TURN_ENABLE_TCP")&&!oe("TURN_ENABLE_UDP"))throw new Ee(ie.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const s=function(d){return LK(d,!1)}(r),l=await this._p2pChannel.publishDataChannel([s]);if(l.length>0){if(typeof s._originDataChannelId!="number")throw V.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new Ee(ie.CREATE_DATACHANNEL_ERROR);try{await He.all(l.map(d=>this._uid&&this._gateway.publishDataChannel(this._uid,d,!0))),await s._waitTillOpen()}catch(d){if(d.code!==ie.DISCONNECT_P2P)throw d}}return V.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(s.id)),s}catch(s){throw V.error("[".concat(this._clientId,"] publish datachannels error"),s.toString()),s}finally{a()}}async unpublish(r){if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let a=[];if(r)if(Array.isArray(r))a=r;else{if(!(r instanceof Rg))return this._unpublishDataChannel([r]);a=[r]}else this.store.useP2P||await this._unpublishDataChannel(),a=this._p2pChannel.getAllTracks(!0);V.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(a.map(l=>"".concat(l.getTrackId()," "))," "));const s=await this._publishMutex.lock();try{if(this.store.useP2P){const l=await this._p2pChannel.unpublish(a);l&&await this._gateway.sendExtensionMessage(Ar.UNPUBLISH,{unpubMsg:l},!0)}else{const l=await this._p2pChannel.unpublish(a);l&&await this._gateway.unpublish(l,this._uid),V.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(a.map(d=>"".concat(d.getTrackId()))))}}catch(l){throw V.error("[".concat(this._clientId,"] unpublish error"),l.toString()),l}finally{s&&s()}}async _unpublishDataChannel(r){r!==void 0&&r.length!==0||(r=this._p2pChannel.getAllDataChannels()),V.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(r.map(s=>"".concat(s.id," "))," "));const a=await this._publishMutex.lock();try{const s=await this._p2pChannel.unpublishDataChannel(r);s&&await this._gateway.unpublishDataChannel(s),V.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(r.map(l=>"".concat(l.id))))}catch(s){throw V.error("[".concat(this._clientId,"] unpublish dataChannel error"),s.toString()),s}finally{a&&a()}}async subscribe(r,a,s){if(!(r instanceof wh)){const l=this.remoteUsers.find(d=>d.uid===r);if(!l)throw new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");r=l}return a==="datachannel"?this._subscribeDataChannel(r,s):this._subscribe(r,a)}async presubscribe(r,a){if(ri(a,"mediaType",["audio","video"]),this.store.useP2P)throw new Ee(ie.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const s=a===Je.AUDIO,l=a===Je.VIDEO,d=await this._subscribeMutex.lock();try{const{ssrcId:f,ortc:m,rtxSsrcId:y,cname:_,uint_id:S}=await this._gateway.presubscribe(r,a,!0);if(f==null)throw new Ee(ie.UNEXPECTED_RESPONSE,"no ssrc id");let x=this._users.find(I=>I.uid===r);x||(x=new wh(r,S||r),x._is_pre_created=!0,this._users.push(x)),_&&(x._cname=_),x._uintid||(x._uintid=S||r),s&&(x._audioSSRC=f,x._audio_pre_subscribed=!0,m&&(x._audioOrtc=m)),l&&(x._videoSSRC=f,x._video_pre_subscribed=!0,m&&(x._videoOrtc=m),y!=null&&(x._rtxSsrcId=y)),V.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(f)),await this._p2pChannel.subscribe(x,a,f,y,m);const A=s?x._audioTrack:x._videoTrack;if(!A)throw new Ee(ie.UNEXPECTED_ERROR,"can not find remote track in user");return s&&(x._trust_audio_stream_added_state_=!0,x._audio_added_=!0),l&&(x._trust_video_stream_added_state_=!0,x._video_added_=!0),A}catch(f){throw V.error("[".concat(this._clientId,"] presub user ").concat(r," error"),f),f}finally{d()}}async _subscribeDataChannel(r,a){var s;if(kn(a,"channelId",0,65535,!0),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(y=>y===r))throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");if(!r.hasAudio&&!r.hasVideo&&r._dataChannels.length===0)throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),new Ee(ie.INVALID_REMOTE_USER,"user is not published");const d=(s=r._dataChannels)===null||s===void 0?void 0:s.find(y=>y.id===a);if(!d)throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType datachannel, remote datachannel is not published")),new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);const f=await this._subscribeMutex.lock();V.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: datachannel"));try{const y=await this._p2pChannel.subscribeDataChannel(r,[d]);if(y&&Be(y).call(y,d.id))try{var m;if(typeof d._originDataChannelId!="number")throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType datachannel, cannot get RTCDatachannel")),new Ee(ie.CREATE_DATACHANNEL_ERROR);const _={id:d.id,datachannelId:d._originDataChannelId,ordered:d.ordered,maxRetransmits:d.maxRetransmits,metadata:(m=d.metadata)!==null&&m!==void 0?m:""};await this._gateway.subscribeDataChannel(r.uid,_,!0),await d._waitTillOpen()}catch(_){if((_==null?void 0:_.code)!==ie.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(r,[d]),_;await this._p2pChannel.unsubscribeDataChannel(r,[d]),this._p2pChannel.setPendingRemoteDataChannel(r,d.id)}return V.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: datachannel")),d}finally{f()}}async _p2pSubscribe(r,a,s){if(ri(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(f=>f===r)){const f=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),f}if(!r.hasAudio&&!r.hasVideo){const f=new Ee(ie.INVALID_REMOTE_USER,"user is not published");throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),f}if(!s&&(a==="audio"&&!r.hasAudio||a==="video"&&!r.hasVideo)){const f=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType ").concat(a,", remote track is not published")),f}const d=await this._subscribeMutex.lock();V.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: ").concat(a));try{if(await this._p2pChannel.hasRemoteMediaWithLock(r,a))await this._p2pChannel.unmuteRemote(r,a);else try{const m=a==="audio"?r._audioSSRC:r._videoSSRC,y=a==="audio"?r._audioMid:r._videoMid;this.store.subscribe(r.uid,a,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(r,a,m,y)}catch(m){throw m}V.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: ").concat(a)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(r.uid,this._defaultStreamFallbackType).catch(m=>{V.warning("[".concat(this._clientId,"] auto set fallback failed"),m)});const f=a==="audio"?r._audioTrack:r._videoTrack;if(!f)throw new Ee(ie.UNEXPECTED_ERROR,"can not find remote track in user object");return f}catch(f){throw V.error("[".concat(this._clientId,"] subscribe user ").concat(r.uid," error"),f),f}finally{d()}}async _subscribe(r,a,s){if(this.store.useP2P)return this._p2pSubscribe(r,a);if(ri(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(S=>S===r)){const S=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),S}if(!r.hasAudio&&!r.hasVideo){const S=new Ee(ie.INVALID_REMOTE_USER,"user is not published");throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),S}if(!(s||(a!=="audio"||r.hasAudio&&r._audioSSRC!==void 0)&&(a!=="video"||r.hasVideo&&r._videoSSRC!==void 0))){const S=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);throw V.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType ").concat(a,", remote track is not published")),S}let d=a==="audio"?r._audioSSRC:r._videoSSRC,f=a==="audio"?r._audioOrtc:r._videoOrtc,m=a==="video"?r._rtxSsrcId:void 0,y={stream_type:a==="audio"?Je.AUDIO:Je.VIDEO,ssrcId:d};a==="video"&&this.store.firstVideoFrameDecoded(r.uid,{subscribeStart:Date.now()});const _=await this._subscribeMutex.lock();V.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: ").concat(a));try{if(await this._p2pChannel.hasRemoteMediaWithLock(r,a))await this._p2pChannel.unmuteRemote(r,a);else try{const x=a==="audio"?r._audioSSRC:r._videoSSRC;x!==void 0&&x!==d&&(d=x,f=a==="audio"?r._audioOrtc:r._videoOrtc,m=a==="video"?r._rtxSsrcId:void 0,y={stream_type:a==="audio"?Je.AUDIO:Je.VIDEO,ssrcId:d}),Yi.markSubscribeStart(this.store.clientId,d),this.store.subscribe(r.uid,a,Date.now()),await this._p2pChannel.subscribe(r,a,d,m,f);try{this._p2pChannel.isPreSubScribe(d)||await this._gateway.subscribe(r.uid,y,!0)}catch(A){if((A==null?void 0:A.code)!==ie.WS_ABORT)throw await this._p2pChannel.unsubscribe(r,a),A;await this._p2pChannel.unsubscribe(r,a,!0),this._p2pChannel.setPendingRemoteMedia(r,a)}this.store.subscribe(r.uid,a,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,r,a)}catch(x){throw this._p2pChannel.reportSubscribeEvent(!1,x==null?void 0:x.code,r,a),x}V.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: ").concat(a)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(r.uid,this._defaultStreamFallbackType).catch(x=>{V.warning("[".concat(this._clientId,"] auto set fallback failed"),x)});const S=a==="audio"?r._audioTrack:r._videoTrack;if(!S)throw new Ee(ie.UNEXPECTED_ERROR,"can not find remote track in user object");return a==="video"&&(this.store.firstVideoFrameDecoded(r.uid,{subscribeEnd:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(r)),S}catch(S){throw V.error("[".concat(this._clientId,"] subscribe user ").concat(r.uid," error"),S),S}finally{_()}}async massSubscribe(r){if(id(r,"subscribeList"),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const a=Date.now(),s=new Map,l=await this._subscribeMutex.lock();V.info("[".concat(this._clientId,"]start massSubscribe user ").concat(r.map(y=>{let{user:_,mediaType:S}=y;return"user: ".concat(_==null?void 0:_.uid,", mediaType: ").concat(S)}).join("; ")));const d=(r=[...r]).map(y=>{let{user:_,mediaType:S}=y;return{user:_,mediaType:S}}),f=await this._p2pChannel.globalLock();try{var m;for(let _=r.length-1;_>=0;_--){const S=r[_],{user:x,mediaType:A}=S;if(ri(A,"mediaType",["audio","video"]),!x){const $=new Ee(ie.INVALID_PARAMS,"user property does not exist in subscribeList item");throw V.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),$}if(!this._users.find($=>$===x)){const $=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");V.error("[".concat(this._clientId,"] can not massSubscribe ").concat(x.uid,", this user is not in the channel")),d[_].error=$,r.splice(_,1);continue}if(A==="audio"&&(!x.hasAudio||x._audioSSRC===void 0)||A==="video"&&(!x.hasVideo||x._videoSSRC===void 0)){const $=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);V.error("[".concat(this._clientId,"] can not subscribe ").concat(x.uid," with mediaType ").concat(A,", remote user is not published")),d[_].error=$,r.splice(_,1);continue}const L=ci.Video|ci.LwoVideo,K=s.get(x);if(K){if(A==="video"?K&L:K&ci.Audio){r.splice(_,1),V.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(x.uid,", mediaType:").concat(A," twice"));continue}s.set(x,K|(A==="video"?L:ci.Audio))}else s.set(x,A==="video"?L:ci.Audio)}for(let _=r.length-1;_>=0;_--){const S=r[_],{user:x,mediaType:A}=S,I=ci.Video|ci.LwoVideo;if(this._p2pChannel.hasRemoteMedia(x,A)){await this._p2pChannel.unmuteRemoteNoLock(x,A);const L=s.get(x);s.set(x,A==="video"?L^I:L^ci.Audio),r.splice(_,1)}}this.store.massSubscribe(r.map(_=>({userId:_.user.uid,type:_.mediaType})),a);let y=rc(m=Array.from(s.entries())).call(m,(_,S)=>{let[x,A]=S;if(A===0)return _;const I={stream_id:x.uid,stream_type:A};return A&ci.Audio&&(I.audio_ssrc=x._audioSSRC),A&ci.Video&&(I.video_ssrc=x._videoSSRC),_.push(I),_},[]);try{r.length>0&&await this._p2pChannel.massSubscribeNoLock(r.map(S=>{let{user:x,mediaType:A}=S;return{user:x,mediaType:A,ssrcId:A===Je.VIDEO?x._videoSSRC:x._audioSSRC,rtxSsrcId:A===Je.VIDEO?x._rtxSsrcId:void 0}}));const _=new Map;if(y=y.filter(S=>S.video_ssrc&&!this._p2pChannel.isPreSubScribe(S.video_ssrc)||S.audio_ssrc&&!this._p2pChannel.isPreSubScribe(S.audio_ssrc)||!S.video_ssrc&&!S.audio_ssrc),y.length>0){const S=await this._gateway.subscribeAll(y,!0);((S==null?void 0:S.users)||[]).forEach(x=>{let{stream_id:A,video_error_code:I,audio_error_code:L,error_code:K}=x;(I||L||K)&&_.set(A,{video_error_code:I,audio_error_code:L,error_code:K})})}if(Array.from(_.entries()).length>0){const S=[];Array.from(_.entries()).forEach(x=>{let[A,I]=x;const L=this.remoteUsers.find(K=>K.uid===A);if(L){let K;I.error_code||I.video_error_code&&I.audio_error_code?K=void 0:I.video_error_code?K=Je.VIDEO:I.audio_error_code&&(K=Je.AUDIO),S.push({user:L,mediaType:K})}}),S.length>0&&await this._p2pChannel.massUnsubscribeNoLock(S)}for(const S of d){const x=_.get(S.user.uid);if(x){const A=x.error_code||S.mediaType==="audio"&&x.audio_error_code||S.mediaType==="video"&&x.video_error_code;if(A){const I=bb(A);V.error("user:".concat(S.user.uid," mediaType:").concat(S.mediaType," has massSubscribe error ").concat(I.desc)),S.error=new Ee(ie.SUBSCRIBE_FAILED,"code ".concat(A,": ").concat(I.desc))}}S.error||(S.mediaType==="video"?S.track=S.user.videoTrack:S.track=S.user.audioTrack)}return this.store.massSubscribe(d.filter(S=>!S.error).map(S=>({userId:S.user.uid,type:S.mediaType})),void 0,Date.now()),d.forEach(S=>{var x;it.subscribe(this.store.sessionId,{succ:!!S.error,ec:((x=S.error)===null||x===void 0?void 0:x.code)||null,video:S.mediaType===Je.VIDEO,audio:S.mediaType===Je.AUDIO,peerid:S.user.uid,subscribeRequestid:S.mediaType===Je.VIDEO?S.user._videoSSRC:S.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-a),preSsrc:this._p2pChannel.isPreSubScribe(S.user._videoSSRC)},!0)}),V.info("[".concat(this._clientId,"] massSubscribe success ").concat(r.map(S=>{let{user:x,mediaType:A}=S;return"user: ".concat(x==null?void 0:x.uid,", mediaType: ").concat(A)}).join("; "))),d}catch(_){throw await this._p2pChannel.massUnsubscribeNoLock(r),_}}finally{f(),l()}}async unsubscribe(r,a,s){if(!(r instanceof wh)){const f=this.remoteUsers.find(m=>m.uid===r);if(!f)throw new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");r=f}if(a||this.store.useP2P){if(a==="datachannel")return this._unsubscribeDataChannel(r,s)}else await this._unsubscribeDataChannel(r,s);if(a&&ri(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(f=>f===r)){const f=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw V.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),f}V.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(r.uid,", mediaType: ").concat(a));const d=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(r,a);else{const f=await this._p2pChannel.unsubscribe(r,a);f&&await this._gateway.unsubscribe(f,r.uid),a&&a!=="audio"||(r._audio_pre_subscribed=!1),a&&a!=="video"||(r._video_pre_subscribed=!1),r._is_pre_created&&zx(this._users,r),V.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(r.uid,", mediaType: ").concat(a))}}catch(f){if(f.code===ie.DISCONNECT_P2P)return void V.warning("disconnecting p2p, abort unsubscribe request.");throw V.error("[".concat(this._clientId,"] unsubscribe user ").concat(r.uid," error"),f.toString()),f}finally{d()}}async _unsubscribeDataChannel(r,a){if(a&&kn(a,"id",0,65535,!0),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(d=>d===r)){const d=new Ee(ie.INVALID_REMOTE_USER,"user is not in the channel");throw V.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),d}let l;if(typeof a=="number"){const d=r._dataChannels.find(f=>f.id===a);d&&(l=[d])}else l=r._dataChannels;if(l===void 0){const d=new Ee(ie.REMOTE_USER_IS_NOT_PUBLISHED);throw V.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid," with channelId ").concat(a,", remote datachannel is not published")),d}V.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(r.uid,", mediaType: datachannel, ids: ").concat(l.map(d=>d.id)));try{const d=await this._p2pChannel.unsubscribeDataChannel(r,l);d&&await this._gateway.unsubscribeDataChannel(d,r.uid),V.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(r.uid,", mediaType: datachannel, ids: ").concat(d))}catch(d){if(d.code===ie.DISCONNECT_P2P)return void V.warning("disconnecting p2p, abort unsubscribe request.");throw V.error("[".concat(this._clientId,"] unsubscribe user ").concat(r.uid," error"),d.toString()),d}}async massUnsubscribe(r){if(id(r,"unsubscribeList"),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");V.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(r.map(s=>{let{user:l,mediaType:d}=s;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(d,";")}).join())),r=[...r];const a=new Map;for(let s=r.length-1;s>=0;s--){const{user:l,mediaType:d}=r[s];if(!l){const y=new Ee(ie.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw V.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),y}if(ri(d,"mediaType",["video","audio",void 0]),!this._users.find(y=>y===l)){V.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(l.uid,", user is not in the channel")),r.splice(s,1);continue}const m=ci.Video|ci.LwoVideo;if(a.has(l)){const y=a.get(l);let _;switch(d){case"video":_=y&m;break;case"audio":_=y&ci.Audio;break;default:_=y&(ci.Audio|m)}if(_){V.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(l.uid,",mediaType:").concat(d," twice.")),r.splice(s,1);continue}d?d==="audio"?a.set(l,y|ci.Audio):d==="video"&&a.set(l,y|m):a.set(l,y|ci.Audio|m)}else d?d==="audio"?a.set(l,ci.Audio):d==="video"&&a.set(l,m):a.set(l,ci.Audio|m)}try{const s=await this._p2pChannel.massUnsubscribe(r);s&&await this._gateway.massUnsubscribe(s),V.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(r.map(l=>{let{user:d,mediaType:f}=l;return"user: ".concat(d==null?void 0:d.uid,", mediaType: ").concat(f,";")}).join()))}catch(s){if(s.code===ie.DISCONNECT_P2P)return void V.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw V.error("[".concat(this._clientId,"] massUnsubscribe error"),s.toString()),s}}async setLowStreamParameter(r){(function(s){if(!s)throw new we(ie.INVALID_PARAMS);hr(s.width)||pj(s.width,"streamParameter.width"),hr(s.height)||pj(s.height,"streamParameter.height"),hr(s.framerate)||pj(s.framerate,"streamParameter.framerate"),hr(s.bitrate)||kn(s.bitrate,"streamParameter.bitrate")})(r),(!r.width&&r.height||r.width&&!r.height)&&V.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),V.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(r));const a=this._configDistribute.getLowStreamConfigDistribute();if(a&&a.bitrate&&r.bitrate&&a.bitrate<r.bitrate&&(r.bitrate=a.bitrate),this._lowStreamParameter=r,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(r,De.LocalVideoLowTrack)}async enableDualStream(){if(!un().supportDualStream)throw it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new Ee(ie.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new Ee(ie.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(r){throw it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),r}this._isDualStreamEnabled=!0,it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),V.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(De.LocalVideoLowTrack))try{const r=await this._p2pChannel.unpublishLowStream();r&&await this._gateway.unpublish(r,this._joinInfo.stringUid||this._joinInfo.uid)}catch(r){throw it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),r}this._isDualStreamEnabled=!1,it.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),V.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(r,a){if(function(l){ri(l,"role",["audience","host"])}(r),a&&yj(a),this.mode==="rtc"||this.mode==="p2p")throw V.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new Ee(ie.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(a&&a.level&&r==="host")throw new Ee(ie.INVALID_OPERATION,"host mode can not set audience latency level");if(r==="audience"&&this._p2pChannel.hasLocalMedia())throw new Ee(ie.INVALID_OPERATION,"can not set client role to audience when publishing stream");const s=this._config.role;this._joinInfo&&(this._joinInfo.role=r),r!==s&&oe("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(r,a),this._config.role=r,this._gateway.reconnect("recover",Di.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(r,a),this._config.role=r),V.info("[".concat(this._clientId,"] set client role to ").concat(r,", level: ").concat(a&&a.level))}async _setClientRoleOptions(r){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let a=!1;try{r&&yj(r),await this._gateway.setClientRole(this._config.role,r),a=!0}catch{}finally{V.info("[".concat(this._clientId,"] set client role options ").concat(a?"succeed":"failed",", options is ").concat(r))}}getRemoteInboundOffset(){var r;const a=(r=this._p2pChannel.getStats())===null||r===void 0?void 0:r.audioSend[0];if(!a||!a.timestamp)return 0;const s=a.timestamp-Date.now();return Math.abs(s)>1e3+a.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?s:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(r,a){if(xi(r,"proxyServer"),!a){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ee(ie.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=r,it.setProxyServer(this._proxyServer),V.setProxyServer(this._proxyServer),V.info("[".concat(this._clientId,"] Set proxy server ").concat(a?"by initialize call":""," success."))}setTurnServer(r,a){if(Array.isArray(r)||(r=[r]),!a){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ee(ie.INVALID_OPERATION,"You have already set the proxy")}if(cb(r))return this._turnServer={servers:r,mode:"original-manual"},void V.info("[".concat(this._clientId,"] Set original turnserver ").concat(a?"by initialize call":""," success: ").concat(r.map(s=>s.urls).join(","),"."));r.forEach(s=>dz(s)),this._turnServer={servers:r,mode:"manual"},V.info("[".concat(this._clientId,"] Set turnserver ").concat(a?"by initialize call":""," success."))}setLicense(r){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"you should set license before join channel");if(xi(r,"license",32,32),!/^[A-Za-z\d]+$/.test(r))throw new Ee(ie.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=r,V.info("[".concat(this._clientId,"] set license success"),r)}startProxyServer(r){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new Ee(ie.INVALID_OPERATION,"You have already set the proxy");const a=[3,4,5];let s;switch(r===void 0&&(r=3),r){case 1:case 2:throw new Ee(ie.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:s="proxy3";break;case 4:s="proxy4";break;case 5:s="proxy5";break;default:throw new Ee(ie.INVALID_PARAMS,"proxy server mode must be ".concat(a.join("|")))}this._cloudProxyServerMode=s,this.store.cloudProxyServerMode=s,V.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new Ee(ie.INVALID_OPERATION,"Stop proxy server after leave channel");it.setProxyServer(),V.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",V.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(r){if(!r.accessPoints)throw new Ee(ie.INVALID_PARAMS,"accessPoints is required.");id(r.accessPoints.serverList,"accessPoints.serverList"),xi(r.accessPoints.domain,"accessPoints.domain");const a=(I,L)=>{kn(I,L,0,65535,!0)};let s=443;if(r.accessPoints.port&&(a(r.accessPoints.port,"accessPoints.port"),s=r.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ee(ie.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");oe("CLOSE_AFB_FOR_LOCAL_AP")&&(An("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),An("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const l=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,d=r.accessPoints.domain,f=r.accessPoints.serverList.map(I=>l.test(I)?"".concat(I.replace(/\./g,"-"),".").concat(d):I),m=f.map(I=>"".concat(I,":").concat(s));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,An("WEBCS_DOMAIN",m),An("WEBCS_DOMAIN_BACKUP_LIST",m),An("GATEWAY_DOMAINS",[d]),r.report&&r.report.hostname&&Array.isArray(r.report.hostname)&&r.report.hostname.length?(id(r.report.hostname,"report.hostname"),An("EVENT_REPORT_DOMAIN",r.report.hostname[0]),An("EVENT_REPORT_BACKUP_DOMAIN",r.report.hostname[1]||r.report.hostname[0])):(An("EVENT_REPORT_DOMAIN",f[0]),An("EVENT_REPORT_BACKUP_DOMAIN",f[1]||f[0]));let y=6443;r.report&&r.report.port&&(a(r.report.port,"report.port"),y=r.report.port),An("STATS_COLLECTOR_PORT",y),r.report?An("ENABLE_EVENT_REPORT",!0):An("ENABLE_EVENT_REPORT",!1);let _="";r.log&&r.log.hostname&&Array.isArray(r.log.hostname)&&r.log.hostname.length?(id(r.log.hostname,"log.hostname"),_=r.log.hostname[0]):_=f[0];let S=6444;r.log&&r.log.port&&(a(r.log.port,"log.port"),S=r.log.port),An("LOG_UPLOAD_SERVER","".concat(_,":").concat(S));let x=[];r.cds&&r.cds.hostname&&Array.isArray(r.cds.hostname)&&r.cds.hostname.length?(id(r.cds.hostname,"cds.hostname"),x=r.cds.hostname):x=f;let A=443;r.cds&&r.cds.port&&(a(r.cds.port,"cds.port"),A=r.cds.port),An("CDS_AP",x.map(I=>"".concat(I,":").concat(A))),r.cds?An("ENABLE_CONFIG_DISTRIBUTE",!0):An("ENABLE_CONFIG_DISTRIBUTE",!1),V.info("set local access point v2 success")}setLocalAccessPoints(r,a){if(id(r,"serverList"),xi(a,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ee(ie.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;r=r.map(l=>s.test(l)?"".concat(l.replace(/\./g,"-"),".").concat(a):l),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,An("WEBCS_DOMAIN",r),An("WEBCS_DOMAIN_BACKUP_LIST",r),An("GATEWAY_DOMAINS",[a]),An("EVENT_REPORT_DOMAIN",r[0]),An("EVENT_REPORT_BACKUP_DOMAIN",r[1]||r[0]),An("LOG_UPLOAD_SERVER","".concat(r[0],":6444")),V.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(r){if(ri(r,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=r,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(r),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(a){throw V.error("[".concat(this._clientId,"] set default remote video stream type error"),a.toString()),a}else V.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(r))}async setRemoteVideoStreamType(r,a){ri(a,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(r,a),setTimeout(()=>{const s=this._users.find(l=>l.uid===r);s&&s.videoTrack&&s.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(s){throw V.error("[".concat(this._clientId,"] set remote video stream type error"),s.toString()),s}V.info("[".concat(this._clientId,"] set remote ").concat(r," video stream type to ").concat(a)),this._remoteStreamTypeCacheMap.set(r,a)}async setStreamFallbackOption(r,a){ri(a,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(r,a)}catch(s){throw V.error("[".concat(this._clientId,"] set stream fallback option"),s.toString()),s}V.info("[".concat(this._clientId,"] set remote ").concat(r," stream fallback type to ").concat(a)),this._streamFallbackTypeCacheMap.set(r,a)}setEncryptionConfig(r,a,s,l){(function(f){ri(f,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(r),xi(a,"secret");const d=["aes-128-gcm2","aes-256-gcm2"];if(Be(d).call(d,r)){if(!s||!(s instanceof Uint8Array&&s.length===32))throw new Ee(ie.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(s)throw new Ee(ie.INVALID_PARAMS,"current encrypt mode does not need salt");if(l){if(el(l,"encryptDataStream"),!Be(d).call(d,r))throw new Ee(ie.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(a)||V.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=r,this._encryptionSecret=a,s&&(this._encryptionSalt=dh(s))}async renewToken(r){if(xi(r,"token",1,2047),!this._key||!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"renewToken should not be called before user join");const a=this._key;this._key=r,this._joinInfo&&(this._joinInfo.token=r);const s=await this._renewTokenMutex.lock();try{if(oe("USE_NEW_TOKEN")){V.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const l=await yOe(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr);V.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:r,ticket:l})}else V.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:r});V.debug("[".concat(this._clientId,"] renewToken success"))}catch(l){throw this._key=a,this._joinInfo.token=a,V.error("[".concat(this._clientId,"] renewToken failed"),l.toString()),l}finally{s()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?V.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const r=this._p2pChannel.getAudioLevels();this.safeEmit(Zt.VOLUME_INDICATOR,r)},oe("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const r=this._statsCollector.getRTCStats(),a=this._gateway.getInChannelInfo();return r.Duration=Math.round(a.duration/1e3),r}async startLiveStreaming(r,a){if(!a){if(this.codec!=="h264")throw new Ee(ie.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new Ee(ie.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(r)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(r))throw new Ee(ie.LIVE_STREAMING_TASK_CONFLICT);const s=a?ad.TRANSCODE:ad.RAW;return this._createLiveStreamingClient(s).startLiveStreamingTask(r,s)}setLiveTranscoding(r){return this._createLiveStreamingClient(ad.TRANSCODE).setTranscodingConfig(r)}async stopLiveStreaming(r){const a=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(s=>s&&s.hasUrl(r));if(!a.length)throw new Ee(ie.INVALID_PARAMS,"can not find live streaming url to stop");await He.all(a.map(s=>s&&s.stopLiveStreamingTask(r)))}async startChannelMediaRelay(r){ZK(r),await this._createChannelMediaRelayClient().startChannelMediaRelay(r)}async updateChannelMediaRelay(r){ZK(r),await this._createChannelMediaRelayClient().updateChannelMediaRelay(r)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(r){this._p2pChannel instanceof Ib&&this._p2pChannel.addAudioMetadata(r)}async sendStreamMessage(r){var a;let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not send data stream, not joined");if((typeof r=="string"||r instanceof Uint8Array)&&(r={payload:r}),typeof r.payload=="string"){const d=new TextEncoder;r.payload=d.encode(r.payload)}let l=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Be(a=["aes-128-gcm2","aes-256-gcm2"]).call(a,this._encryptionMode)&&(l=!0,r.payload=await async function(d,f,m){var y;const _=rc(y=Array.from(m)).call(y,($,G)=>$+G,0),S={serverTs:0,seq:F1e++,length:m.length,checkSum:_},x=new Uint8Array(_z(_,2)),A=new ArrayBuffer(Eg),I=new DataView(A);I.setUint32(0,S.serverTs),I.setUint16(4,S.seq),I.setUint16(6,S.length),I.setUint16(8,S.checkSum);const L=16-m.length%16;m=pz(m,new Uint8Array(L));const K=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:d,tagLength:Pz,additionalData:x},f,m);return pz(new Uint8Array(A),new Uint8Array(K))}(this._encryptDataStreamIv,this._encryptDataStreamKey,r.payload)),new Blob([r.payload]).size>1024)throw new Ee(ie.INVALID_PARAMS,l?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(Ct.DATA_STREAM,{payload:dh(r.payload),syncWithAudio:r.syncWithAudio,sendTs:Date.now()-COe},!s)}sendMetadata(r){if(!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([r]).size>1024)throw new Ee(ie.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Ct.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:dh(r)})}async sendCustomReportMessage(r){if(Array.isArray(r)||(r=[r]),r.forEach(q1e),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not send custom report, not joined");await it.sendCustomReportMessage(this._joinInfo.sid,r)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){const r=this._statsCollector.getRemoteNetworkQualityStats();if(oe("DELETE_NEQ_AFTER_USER_LEAVE")){const a=this._users.map(s=>s.uid+"");Object.keys(r).forEach(s=>{Be(a).call(a,s)||delete r[s]})}return r}async pickSVCLayer(r,a){ri(a.spatialLayer,"spatialLayer",[0,1,2,3]),ri(a.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(r,a)}catch(s){throw V.error("[".concat(this._clientId,"] pick SVC layer failed"),s.toString()),s}}async setRTMConfig(r){const{apRTM:a=!1,rtmFlag:s}=r;if(el(a,"apRTM"),kn(s,"rtmFlag",0),this._rtmConfig.apRTM=a,this._rtmConfig.rtmFlag=s,V.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(r)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=a,this._joinInfo.rtmFlag=s,this._gateway.setRTM2Flag(s)}_reset(){if(V.debug("[".concat(this._clientId,"] reset client")),function(r){const a=kg.indexOf(r);a!==-1&&kg.splice(a,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this.store.autoSubscribe=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=Ka.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&xq(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&it.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this.store.resetFirstVideoFrameDecoded(),this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(r=>{r._audioTrack&&r._audioTrack._destroy(),r._videoTrack&&r._videoTrack._destroy(),r._dataChannels&&(r._dataChannels.forEach(a=>a._close()),r._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Hi("client-publish",this._clientId),this._subscribeMutex=new Hi("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(r,a){var s;const l=r||sp();r?V.debug("[".concat(this._clientId,"] new Session ").concat(l)):V.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(l));const d=r?"":this._sessionId||"";this._sessionId=l,this.store.sessionId=l,it.addSid(l);const f={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(a==null?void 0:a.stringUid)||((s=this._joinInfo)===null||s===void 0?void 0:s.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:d,clientRole:this.role==="audience"?2:1};it.sessionInit(this._sessionId,_c({cname:a.channel,appid:a.appId},f)),this._joinInfo&&(this._joinInfo.sid=l),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=l)}async _publishHighStream(r){if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&oe("FORCE_TURN")&&!oe("TURN_ENABLE_TCP")&&!oe("TURN_ENABLE_UDP"))throw new Ee(ie.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");V.debug("[".concat(this._clientId,"] publish high stream"));try{const s=await this._p2pChannel.publish(r,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const l=(await s.next()).value;if(l){try{await this._gateway.sendExtensionMessage(Ar.PUBLISH,l,!0)}catch(d){throw s.throw(d),d}await s.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const l=(await s.next()).value;if(l){var a;let d;try{d=await this._gateway.publish(this._uid,l,!0)}catch(f){if(f.code!==ie.DISCONNECT_P2P)throw s.throw(f),f}await s.next(((a=d)===null||a===void 0?void 0:a.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const d of r)d instanceof Gn&&d._encoderConfig&&this._gateway.setVideoProfile(d._encoderConfig).catch(f=>{V.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!d.muted&&d.enabled||await this._p2pChannel.muteLocalTrack(d)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,r),(s==null?void 0:s.code)===ie.WS_ABORT)return;throw s}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new Ee(ie.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ee(ie.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));V.debug("[".concat(this._clientId,"] publish low stream"));const r=this._configDistribute.getLowStreamConfigDistribute();r&&r.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&r.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=r.bitrate));try{const s=await this._p2pChannel.publishLowStream(this._lowStreamParameter),l=(await s.next()).value;if(l){var a;let d;try{d=await this._gateway.publish(this._uid,l,!0)}catch(f){if(f.code!==ie.DISCONNECT_P2P)throw s.throw(f),f}s.next(((a=d)===null||a===void 0?void 0:a.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,void 0,!0),(s==null?void 0:s.code)===ie.WS_ABORT)return;throw s}}_createLiveStreamingClient(r){const a=()=>{if(!this._joinInfo||!this._appId)return new Ee(ie.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const s=(l={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},cd("LiveStreaming").create(l));var l;return s.onLiveStreamError=(d,f)=>{it.reportApiInvoke(this._sessionId,{name:Er.ON_LIVE_STREAM_ERROR,options:[d,f],tag:rr.TRACER}).onSuccess(),this.safeEmit(Zt.LIVE_STREAMING_ERROR,d,f)},s.onLiveStreamWarning=(d,f)=>{it.reportApiInvoke(this._sessionId,{name:Er.ON_LIVE_STREAM_WARNING,options:[d,f],tag:rr.TRACER}).onSuccess(),this.safeEmit(Zt.LIVE_STREAMING_WARNING,d,f)},s.on(hD.REQUEST_WORKER_MANAGER_LIST,(d,f,m)=>{if(!this._joinInfo)return m(new Ee(ie.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(y,_,S,x){const A=oe("UAP_AP").slice(0,oe("AJAX_REQUEST_CONCURRENT")).map(I=>_.proxyServer?"https://".concat(_.proxyServer,"/ap/?url=").concat(I+"/api/v1?action=uap"):"https://".concat(I,"/api/v1?action=uap"));return await dOe(A,y,_,S,x)})(d,this._joinInfo,this._axiosCancelSource.token,Gr).then(f).catch(m)}),s};return r===ad.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||a(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||a(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new Ee(ie.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:a,sendResolutionHeight:s}=this.getLocalVideoStats(),l=(r={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:a,height:s}},cd("ChannelMediaRelay").create(r));l.on("state",d=>{d===cs.RELAY_STATE_FAILURE&&l&&l.dispose(),this.safeEmit(Zt.CHANNEL_MEDIA_RELAY_STATE,d)}),l.on("event",d=>{this.safeEmit(Zt.CHANNEL_MEDIA_RELAY_EVENT,d)}),this._channelMediaRelayClient=l,this._statsCollector.onStatsChanged=(d,f)=>{var m;d==="resolution"&&((m=this._channelMediaRelayClient)===null||m===void 0||m.setVideoProfile(f))}}var r;return this._channelMediaRelayClient}_handleUpdateDataChannel(r,a){const{added:s,deleted:l}=r,d=[];if(a){const f=[];this._users.forEach(m=>{m._dataChannels.forEach(y=>{s.every(_=>_.uid!==m._uintid||_.stream_id!==y.id)&&f.push({uid:m._uintid,stream_id:y.id,ordered:y.ordered,max_retrans_times:y.maxRetransmits,metadata:y.metadata})})}),f.length>0&&this._handleUpdateDataChannel({added:[],deleted:f})}Array.isArray(s)&&s.length>0&&s.forEach(f=>{const{uid:m,stream_id:y,ordered:_,max_retrans_times:S,metadata:x}=f,A=this._users.find(I=>I._uintid===m);if(!A)return void V.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(V.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(m)),Be(d).call(d,A)||d.push(A),A._uintid||(A._uintid=m),A._dataChannels.findIndex(I=>I.id===f.stream_id)===-1){const I={id:y,ordered:!!_,maxRetransmits:S,metadata:x},L=function(K){return LK(K,!0)}(I);A._dataChannels.push(L),V.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published datachannel")),a||this.safeEmit(Zt.USER_PUBLISHED,A,"datachannel",I)}this._p2pChannel.hasPendingRemoteDataChannel(A,f.stream_id)&&(V.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(A.uid," after reconnect.")),this._subscribeDataChannel(A,f.stream_id).catch(I=>{V.error("[".concat(this._clientId,"] resubscribe datachannel error"),I.toString())}))}),a&&(this.safeEmit(Zt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(l)&&l.length>0&&l.forEach(f=>{const{uid:m,stream_id:y}=f,_=this._users.find(x=>x._uintid===m);if(!_)return void V.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const S=_._dataChannels.find(x=>x.id===f.stream_id);S&&(V.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(m)),this._p2pChannel.unsubscribeDataChannel(_,[S]).then(x=>{if(_._dataChannels=_._dataChannels.filter(A=>A!==S),x)return this._gateway.unsubscribeDataChannel(x,_.uid)}),V.info("[".concat(this._clientId,"] remote user ").concat(m," unpublished datachannel ,id:").concat(S.id)),this.safeEmit(Zt.USER_UNPUBLISHED,_,"datachannel",S._config))})}_getEncodingName(r){var a;if(!this._joinResponse)return;const s=(a=this._joinResponse.ortc.rtpCapabilities.sendrecv)===null||a===void 0?void 0:a.videoCodecs;if(s)for(const d of s){var l;if(d.payloadType===r)return d==null||(l=d.rtpMap)===null||l===void 0?void 0:l.encodingName}}_handleRemoveDataChannels(r){const a=this._users.find(s=>s.uid===r.uid);if(a){if(a._dataChannels!==void 0&&a._dataChannels.length>0){V.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(r.uid));const s=()=>{V.info("[".concat(this._clientId,"] remote user ").concat(a.uid," unpublished datachannel")),a._dataChannels.forEach(l=>{this.safeEmit(Zt.USER_UNPUBLISHED,a,"datachannel",l._config)})};this._p2pChannel.unsubscribeDataChannel(a,a._dataChannels).then(l=>{if(l)return this._gateway.unsubscribeDataChannel(l,a.uid)}),s()}}else V.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(gi.UPDATE_GATEWAY_CONFIG,()=>{(function(){let r;try{r=window.localStorage.getItem("websdk_ng_global_parameter")}catch(a){return void V.error("Error loading sdk config",a.message)}if(r)try{const a=JSON.parse(window.atob(r)),s=Date.now();Object.keys(a).forEach(l=>{const{value:d,type:f,expires:m}=a[l];m&&m<=s||f||aD()||!Object.prototype.hasOwnProperty.call(Zx,l)||(nl[l]=d,Zn[l]=d,V.debug("Update gateway parameters from config distribute",l,d))})}catch(a){V.error("Error update config from local cache",a.message)}})()}),this._gateway.on(gi.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(gi.CONNECTION_STATE_CHANGE,(r,a,s)=>{var l;if(s===En.FALLBACK)return;const d=()=>{this.safeEmit(Zt.CONNECTION_STATE_CHANGE,r,a,s)};if(it.reportApiInvoke(this._sessionId||((l=this._gateway.joinInfo)===null||l===void 0?void 0:l.sid)||null,{name:Er.CONNECTION_STATE_CHANGE,options:[r,a,s],tag:rr.TRACER}).onSuccess(JSON.stringify({cur:r,prev:a,reason:s})),V.info("[".concat(this._clientId,"] signal connection state change: ").concat(a," -> ").concat(r)),r==="DISCONNECTED")return this._reset(),void d();if(r==="RECONNECTING")this._users.forEach(m=>{m._trust_in_room_=!1,m._trust_audio_enabled_state_=!1,m._trust_video_enabled_state_=!1,m._trust_audio_mute_state_=!1,m._trust_video_mute_state_=!1,m._trust_audio_stream_added_state_=!1,m._trust_video_stream_added_state_=!1,m._is_pre_created||(m._audio_pre_subscribed||(m._audioSSRC=void 0,m._audioOrtc=void 0),m._video_pre_subscribed||(m._videoSSRC=void 0,m._videoOrtc=void 0,m._rtxSsrcId=void 0),m._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(r==="CONNECTED"){var f;this._streamFallbackTypeCacheMap.forEach((m,y)=>{this._gateway.setStreamFallbackOption(y,m).catch(_=>{V.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_)})}),this._remoteStreamTypeCacheMap.forEach((m,y)=>{this._gateway.setRemoteVideoStreamType(y,m).catch(_=>{V.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_)})}),this._remoteDefaultVideoStreamType!==void 0&&((f=this._joinInfo)===null||f===void 0?void 0:f.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{V.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(m=>{V.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(m))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(m=>!m._trust_in_room_).forEach(m=>{V.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(m.uid)),this._handleUserOffline({uid:m.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(m=>{m._trust_audio_mute_state_||(V.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(m.uid)),this._handleMuteStream(m.uid,Je.AUDIO,!1)),m._trust_video_mute_state_||(V.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(m.uid)),this._handleMuteStream(m.uid,Je.VIDEO,!1)),m._trust_audio_enabled_state_||(V.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(m.uid)),this._handleSetStreamLocalEnable("audio",m.uid,!0)),m._trust_video_enabled_state_||(V.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(m.uid)),this._handleSetStreamLocalEnable("video",m.uid,!0)),m._trust_video_stream_added_state_||(V.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(m.uid)),this._handleResetAddStream(m,"video")),m._trust_audio_stream_added_state_||(V.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(m.uid)),this._handleResetAddStream(m,"audio")),m._video_added_||m._audio_added_||(V.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(m.uid)),this._handleRemoveStream({uid:m.uid,uint_id:m._uintid}))}))},1e3))}d()}),this._gateway.on(gi.REQUEST_NEW_GATEWAY_LIST,async(r,a)=>{if(!this._joinInfo)return a(new Ee(ie.UNEXPECTED_ERROR,"can not recover, no join info"));try{let s;const l=await wq(_c(_c({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));l?(s=l.ap,Tq(l),this._joinInfo.preload=!0):(s=await ND(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Gr,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=s.gatewayInfo.res,this._joinInfo.gatewayAddrs=s.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=s.gatewayInfo.uni_lbs_ip);const d=[];s.gatewayInfo.gatewayAddrs.forEach(f=>{let{address:m}=f;const[y,_]=m.split(":");this._joinInfo&&this._joinInfo.proxyServer?d.push({proxy:this._joinInfo.proxyServer,host:y,port:_}):d.push({host:y,port:_})}),r(d)}catch(s){a(s)}}),this._gateway.on(gi.NETWORK_QUALITY,r=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Zt.NETWORK_QUALITY,r)}),this._gateway.on(gi.STREAM_TYPE_CHANGE,(r,a)=>{this.safeEmit(Zt.STREAM_TYPE_CHANGED,r,a),it.reportApiInvoke(this._sessionId,{name:Er.STREAM_TYPE_CHANGE,options:[r,a],tag:rr.TRACER}).onSuccess(JSON.stringify({uid:r,streamType:a}))}),this._gateway.isPreSub=()=>"isPreSub"in this._p2pChannel&&this._p2pChannel.isPreSub(),this._gateway.isPreallocation=()=>"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation(),this._gateway.on(gi.IS_P2P_DISCONNECTED,r=>{this._p2pChannel.isP2PDisconnected()?r(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?r(!1):r(!0)}),this._gateway.on(gi.REQUEST_P2P_CONNECTION_PARAMS,async(r,a,s)=>{try{let l=await this._p2pChannel.getEstablishParams();l&&"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation()||(l=await this._p2pChannel.startP2PConnection(r)),a(l)}catch(l){s(l)}}),this._gateway.on(gi.JOIN_RESPONSE,(r,a)=>{if(this.store.useP2P)return;let s;this._joinResponse=r,r.attributes?s=r.attributes.userAttributes.preSubSsrcs:V.debug("no attributes in joinResponse");const l=xK(r.ortc,a,s);this._p2pChannel.connect(l)}),this._gateway.on(gi.PRE_CONNECT_PC,async r=>{const{candidates:a,fingerprint:s,turnServer:l}=r;if(this._joinInfo&&a.length>0&&!this._p2pChannel.isPlanB){const{cert:f,cid:m}=this._joinInfo.apResponse,y="".concat(m,"_").concat(f);if(y.length<4||y.length>256)return;await this._p2pChannel.startP2PConnection({turnServer:l,cloudProxyServer:this._joinInfo.cloudProxyServer,isPreallocation:!0});try{var d;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(m,"_").concat(f),icePwd:"".concat(m,"_").concat(f)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(d=oe("FINGERPRINT"))!==null&&d!==void 0?d:s}]},candidates:a,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}catch(_){_.code&&_.code===ie.EXCHANGE_SDP_FAILED&&await this._p2pChannel.startP2PConnection({turnServer:l,cloudProxyServer:this._joinInfo.cloudProxyServer},!0)}}})}_handleGatewaySignalEvents(){this._gateway.signal.on(en.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(en.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(en.ON_ADD_AUDIO_STREAM,r=>this._handleAddAudioOrVideoStream("audio",r.uid,r.ssrcId,r.cname,r.pt,r.uint_id,r.ortc)),this._gateway.signal.on(en.ON_ADD_VIDEO_STREAM,r=>this._handleAddAudioOrVideoStream("video",r.uid,r.ssrcId,r.cname,r.pt,r.uint_id,r.ortc,r.rtxSsrcId)),this._gateway.signal.on(en.ON_REMOTE_DATASTREAM_UPDATE,r=>{this._handleUpdateDataChannel(r)}),this._gateway.signal.on(en.ON_REMOTE_FULL_DATASTREAM_INFO,r=>{this._handleUpdateDataChannel({added:r.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(en.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(en.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(en.MUTE_AUDIO,r=>this._handleMuteStream(r.uid,Je.AUDIO,!0)),this._gateway.signal.on(en.UNMUTE_AUDIO,r=>this._handleMuteStream(r.uid,Je.AUDIO,!1)),this._gateway.signal.on(en.MUTE_VIDEO,r=>this._handleMuteStream(r.uid,Je.VIDEO,!0)),this._gateway.signal.on(en.UNMUTE_VIDEO,r=>this._handleMuteStream(r.uid,Je.VIDEO,!1)),this._gateway.signal.on(en.RECEIVE_METADATA,r=>{const a=ap(r.metadata);this.safeEmit(Zt.RECEIVE_METADATA,r.uid,a)}),this._gateway.signal.on(en.ON_DATA_STREAM,async r=>{var a;if(!r)return;let s=ap(r.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Be(a=["aes-128-gcm2","aes-256-gcm2"]).call(a,this._encryptionMode)){if(r.payload.length<Eg)throw new Ee(ie.UNEXPECTED_RESPONSE,"payload length ".concat(r.payload.length," is less than header length ").concat(Eg));s=await async function(f,m,y){const _=y.subarray(0,Eg),S=_.slice(8,Eg),x=(S[0]<<8)+S[1],A=(_[6]<<8)+_[7],I=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:f,tagLength:Pz,additionalData:new Uint8Array(_z(x,2))},m,y.subarray(Eg));return new Uint8Array(I).subarray(0,A)}(this._encryptDataStreamIv,this._encryptDataStreamKey,s)}let l=0;if(r.ordered||r.syncWithAudio){const d=this._p2pChannel.getStats(),f=this.remoteUsers.find(y=>y.uid===r.uid),m=d==null?void 0:d.audioRecv.find(y=>y.ssrc===(f==null?void 0:f._audioSSRC));l=m==null?void 0:m.jitterBufferMs}(l==null||Number.isNaN(l))&&(l=0),NOe(_c(_c({},r),{},{payload:s}),l,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(en.ON_CRYPT_ERROR,()=>{uh(()=>{V.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Zt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(en.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(en.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{V.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,En.TOKEN_EXPIRE),this.safeEmit(Zt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(en.ON_STREAM_FALLBACK_UPDATE,r=>{V.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(r.stream_id,", attr: ").concat(r.stream_type)),this.safeEmit(Zt.STREAM_FALLBACK,r.stream_id,r.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(en.ON_PUBLISH_STREAM,r=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:r.proxy})),V.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(r))))}),this._gateway.signal.on(en.ENABLE_LOCAL_VIDEO,r=>{this._handleSetStreamLocalEnable("video",r.uid,!0)}),this._gateway.signal.on(en.DISABLE_LOCAL_VIDEO,r=>{this._handleSetStreamLocalEnable("video",r.uid,!1)}),this._gateway.signal.on(It.REQUEST_TIMEOUT,(r,a)=>{if(this._joinInfo)switch(r){case Ct.PUBLISH:{if(!a)return;const d=a.ortc;if(d){var s,l;const f=d.some(_=>{let{stream_type:S}=_;return S===xn.Audio}),m=d.some(_=>{let{stream_type:S}=_;return S!==xn.Audio}),y=d.some(_=>{let{stream_type:S}=_;return S===xn.Screen||S===xn.ScreenLow});a.state==="offer"&&it.publish(this._joinInfo.sid,{eventElapse:Yi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:ie.TIMEOUT,audio:f,video:m,p2pid:a.p2p_id,publishRequestid:this.store.pubId,screenshare:y,audioName:f?(s=d.find(_=>{let{stream_type:S}=_;return S===xn.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0,videoName:m?(l=d.find(_=>{let{stream_type:S}=_;return S!==xn.Audio}))===null||l===void 0||(l=l.ssrcs[0])===null||l===void 0?void 0:l.ssrcId.toString():void 0})}break}case Ct.SUBSCRIBE:a&&it.subscribe(this._joinInfo.sid,{succ:!1,ec:ie.TIMEOUT,audio:a.stream_type===Je.AUDIO,video:a.stream_type===Je.VIDEO,peerid:a.stream_id,subscribeRequestid:a.ssrcId,p2pid:this.store.p2pId,eventElapse:Yi.measureFromSubscribeStart(this.store.clientId,a.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(a.ssrcId)})}}),this._gateway.signal.on(en.ON_P2P_OK,r=>{this.uid,this._uid}),this._gateway.signal.on(en.ON_PUBLISHED_USER_LIST,r=>{if(r==null||!r.users)return;oe("BLOCK_LOCAL_CLIENT")&&(r.users=r.users.filter(l=>!pp(l.string_id||l.stream_id,this.channelName)));const a=[],s=[];for(const l of r.users){let d=this._users.find(x=>x._uintid===l.stream_id);d?d._trust_in_room_=!0:(d=new wh(l.string_id||l.stream_id,l.stream_id),this._users.push(d),this.store.firstVideoFrameDecoded(d.uid,{userJoinNotify:Date.now()}),this.getListeners(Zt.PUBLISHED_USER_LIST).length===0&&(V.debug("[".concat(this._clientId,"] user online"),l.stream_id),this.safeEmit(Zt.USER_JOINED,d)));const f=ci.Audio&l.stream_type,m=(ci.Video|ci.LwoVideo)&l.stream_type,y=(65280&l.stream_type)!=0,_=f&&d.hasAudio,S=m&&d.hasVideo;m&&(d._trust_video_stream_added_state_=!0,d._video_added_=!0,d._videoSSRC=l.video_ssrc,d._rtxSsrcId=l.video_rtx),f&&(d._trust_audio_stream_added_state_=!0,d._audio_added_=!0,d._audioSSRC=l.audio_ssrc),f&&!_&&this.getListeners(Zt.PUBLISHED_USER_LIST).length===0&&(V.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published audio")),this.safeEmit(Zt.USER_PUBLISHED,d,"audio")),m&&!S&&this.getListeners(Zt.PUBLISHED_USER_LIST).length===0&&(V.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published video")),this.safeEmit(Zt.USER_PUBLISHED,d,"video")),(f&&!_||m&&!S||y)&&a.push(d),m&&this._p2pChannel.hasPendingRemoteMedia(d,"video")&&s.push({user:d,mediaType:"video"}),f&&this._p2pChannel.hasPendingRemoteMedia(d,"audio")&&s.push({user:d,mediaType:"audio"})}s.length>0&&(V.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(s.map(l=>"user: ".concat(l.user.uid,", mediaType: ").concat(l.mediaType)).join("; ")," ")),this.massSubscribe(s).catch(l=>{V.error("[".concat(this._clientId,"] mass resubscribe error"),l.toString())})),this.getListeners(Zt.PUBLISHED_USER_LIST).length>0?oe("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=a:(V.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(a.map(l=>l.uid).join(", "))),this.safeEmit(Zt.PUBLISHED_USER_LIST,a)):V.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(a.map(l=>l.uid).join(", ")))}),this._gateway.signal.on(en.ON_RTP_CAPABILITY_CHANGE,r=>{const{video_codec:a}=r;this._p2pChannel instanceof Ib&&this._p2pChannel.updateRemoteRTPCapabilities(a.map(s=>s.toLowerCase()).filter(s=>{var l;return Be(l=Object.keys(fb)).call(l,s)}))})}_handleP2PEvents(){this._gateway.signal.on(en.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Ar.PUBLISH,(r,a,s)=>{const{uid:l}=r;r.forEach(d=>{const{kind:f,ssrcs:m,mid:y,isMuted:_}=d;this._handleP2PAddAudioOrVideoStream(f,l,m[0].ssrcId,y);const S=this._users.find(x=>x.uid===l);return S&&this.store.useP2P?this._p2pChannel.mockSubscribe(S,f,m[0].ssrcId,y).then(()=>{a()}).catch(s):a(),this._handleMuteStream(l,f,!!_)})}),this._gateway.signal.on(Ar.CALL,async(r,a,s)=>{if(this.store.useP2P)try{var l;a(await this._p2pChannel.startP2P({turnServer:(l=this._joinInfo)===null||l===void 0?void 0:l.turnServer},r))}catch(d){s(d)}}),this._gateway.signal.on(It.P2P_CONNECTION,async r=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(r)}),this._gateway.signal.on(Ar.UNPUBLISH,async(r,a,s)=>{if(this.store.useP2P){const{unpubMsg:l,uid:d}=r,f=this._users.find(m=>m.uid===d);if(!f)return V.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(d)),void a();try{l.forEach(async m=>{let{stream_type:y}=m;const _=y===xn.Audio?Je.AUDIO:Je.VIDEO;await this._p2pChannel.unsubscribe(f,_),this._handleMuteStream(d,_,!0)}),a()}catch(m){s(m)}}}),this._gateway.signal.on(Ar.CONTROL,async(r,a)=>{const{action:s}=r;switch(s){case mh.MUTE_LOCAL_VIDEO:this._handleMuteStream(a,Je.VIDEO,!0);break;case mh.MUTE_LOCAL_AUDIO:this._handleMuteStream(a,Je.AUDIO,!0);break;case mh.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",a),this._handleMuteStream(a,Je.VIDEO,!1);break;case mh.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",a),this._handleMuteStream(a,Je.AUDIO,!1)}}),this._gateway.signal.on(Ar.RESTART_ICE,async(r,a,s)=>{if(this.store.useP2P)try{const{direction:l,iceParameter:d}=r;l!==La.SEND_ONLY||d?a(await this._p2pChannel.restartICE(l,d)):(this._p2pChannel.handleDisconnect(l),a())}catch(l){s(l)}}),this._gateway.signal.on(Ar.CANDIDATE,r=>{if(this.store.useP2P){const{candidate:a,direction:s}=r;this._p2pChannel.addRemoteCandidate(a,s)}}),this._p2pChannel.on(dt.RequestP2PRestartICE,async(r,a,s)=>{try{const{direction:l}=r;a(await this._gateway.sendExtensionMessage(Ar.RESTART_ICE,r,l===La.SEND_ONLY))}catch(l){s(l)}}),this._p2pChannel.on(dt.LocalCandidate,r=>{this._gateway.sendExtensionMessage(Ar.CANDIDATE,JSON.stringify(r),!0)}),this._p2pChannel.on(dt.RequestP2PMuteLocal,async(r,a,s)=>{try{await this._gateway.sendExtensionMessage(Ar.CONTROL,r,!0),a()}catch(l){s(l)}}),this._p2pChannel.on(dt.RequestP2PUnmuteRemote,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(dt.RequestP2PMuteRemote,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.muteRemote(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(dt.StateChange,(r,a)=>{a===wn.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(dt.PeerConnectionStateChange,r=>{const a=this._peerConnectionState;r!==a&&(this.safeEmit(Zt.PEERCONNECTION_STATE_CHANGE,r,a),this._peerConnectionState=r)}),this._p2pChannel.on(dt.RequestMuteLocal,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.muteLocal(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(dt.RequestUnmuteLocal,async(r,a,s)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(r,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(l){l.code===ie.DISCONNECT_P2P?a():s(l)}else a()}),this._p2pChannel.on(dt.RequestRePublish,(r,a,s)=>{this.publish(r,!1).then(a).catch(s)}),this._p2pChannel.on(dt.RequestRePublishDataChannel,(r,a,s)=>{He.all(r.map(async l=>{const d=await this._p2pChannel.publishDataChannel([l]);try{d.forEach(f=>{this._uid&&this._gateway.publishDataChannel(this._uid,f,!0)})}catch(f){if(f.code!==ie.DISCONNECT_P2P)throw f}})).then(a).catch(s)}),this._p2pChannel.on(dt.RequestReSubscribe,async(r,a,s)=>{try{for(const{user:l,kind:d}of r)d===Je.VIDEO?await this.subscribe(l,"video"):await this.subscribe(l,"audio");a()}catch(l){s(l)}}),this._p2pChannel.on(dt.RequestUpload,(r,a)=>{this._gateway.upload(r,a)}),this._p2pChannel.on(dt.RequestUploadStats,r=>{this._gateway.uploadWRTCStats(r)}),this._p2pChannel.on(dt.MediaReconnectStart,r=>{this.safeEmit(Zt.MEDIA_RECONNECT_START,r)}),this._p2pChannel.on(dt.MediaReconnectEnd,r=>{this.safeEmit(Zt.MEDIA_RECONNECT_END,r)}),this._p2pChannel.on(dt.NeedSignalRTT,r=>{r(this._gateway.getSignalRTT())}),this._p2pChannel.on(dt.RequestRestartICE,async r=>{if(this.store.useP2P)return;const a=await this._p2pChannel.restartICE(r),s=await a.next();if(s.done)return;const l=s.value;let d;try{d=await this._gateway.restartICE({iceParameters:l})}catch(m){return void a.throw(m)}const{iceParameters:f}=function(m){const y=m.iceParameters;return{iceParameters:{iceUfrag:y.iceUfrag,icePwd:y.icePwd}}}(d);await a.next({remoteIceParameters:f})}),this._p2pChannel.on(dt.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(dt.RequestReconnectPC,async()=>{var r;const{iceParameters:a,dtlsParameters:s,rtpCapabilities:l}=await this._p2pChannel.startP2PConnection({turnServer:(r=this._joinInfo)===null||r===void 0?void 0:r.turnServer}),{gatewayEstablishParams:d,gatewayAddress:f}=await this._gateway.reconnectPC({iceParameters:a,dtlsParameters:s,rtpCapabilities:l}),m=xK(d,f);await this._p2pChannel.connect(m),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(dt.RequestUnpublishForReconnectPC,async(r,a,s)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(r,this._uid),a()):s()}),this._p2pChannel.on(dt.P2PLost,()=>{this.safeEmit(Zt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(dt.UpdateVideoEncoder,r=>{r._encoderConfig&&this._gateway.setVideoProfile(r._encoderConfig)}),this._p2pChannel.on(dt.ConnectionTypeChange,r=>{this.safeEmit(Zt.IS_USING_CLOUD_PROXY,r)}),this._p2pChannel.on(dt.RequestLowStreamParameter,r=>{r(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(dt.QueryClientConnectionState,r=>{r(this.connectionState)}),this._p2pChannel.on(dt.AudioMetadata,r=>{this.safeEmit(Zt.AUDIO_METADATA,r)}),this._p2pChannel.on(dt.AudioPts,r=>{this.safeEmit(Zt.AUDIO_PTS,Number(r))})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(r){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const s=(a={config:r},cd("ContentInspect").create(a));this._inspect=s,this.handleVideoInspectEvents(s);const{appId:l,cname:d,sid:f,token:m,uid:y,cid:_,vid:S}=this._joinInfo;await s.init({appId:l,areaCode:"",cname:d,sid:f,token:m,uid:y,cid:_,vid:S?Number(S):0},Gr)}catch(s){throw Array.isArray(s)?s[0]:s}var a}handleVideoInspectEvents(r){r.on(vi.CONNECTION_STATE_CHANGE,(a,s)=>{if(this.safeEmit(Zt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,a,s),s===mc.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Zt.CONTENT_INSPECT_ERROR,new Ee(ie.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));r.inspectImage()}}),r.on(vi.INSPECT_RESULT,(a,s)=>{var l;if((s==null?void 0:s.code)===ie.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return V.debug("Stop inspect content because that has left channel"),this==null||(l=this._inspect)===null||l===void 0||l.close(),void(this._inspect=void 0);this.safeEmit(Zt.CONTENT_INSPECT_RESULT,a,s)}),r.on(vi.CLIENT_LOCAL_VIDEO_TRACK,a=>{a(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(r){throw Array.isArray(r)?r[0]:r}}async setImageModeration(r,a){if(el(r,"enabled"),r){if(!a)throw new Ee(ie.INVALID_PARAMS,"config is required");if(Fq(a),!this._joinInfo)throw new Ee(ie.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(a);else{const l=(s={config:a},cd("ImageModeration").create(s));this._moderation=l,this.handleImageModerationEvents(l);const{appId:d,cname:f,sid:m,token:y,uid:_,cid:S,vid:x}=this._joinInfo;await l.init({appId:d,areaCode:"",cname:f,sid:m,token:y,uid:_,cid:S,vid:x?Number(x):0},Gr)}}catch(l){throw Array.isArray(l)?l[0]:l}}else{var s;if(!this._moderation)throw new Ee(ie.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(l){throw Array.isArray(l)?l[0]:l}}}handleImageModerationEvents(r){r.on(al.CONNECTION_STATE_CHANGE,(a,s)=>{if(this.safeEmit(Zt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,a,s),a===No.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new Ee(ie.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");r.inspectImage()}}),r.on(al.CLIENT_LOCAL_VIDEO_TRACK,a=>{a(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}setP2PTransport(r){if(function(a){ri(a,"transport",["default","auto","relay","sd-rtn"])}(r),this.mode!=="p2p")throw new Ee(ie.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=r,V.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(r))}getJoinChannelServiceRecords(){return V.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(r){el(r,"enabled"),An("ENABLE_PUBLISH_AUDIO_FILTER",r),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(r)}_handleResetAddStream(r,a){switch(a){case"audio":r._audio_added_=!1,r._trust_audio_stream_added_state_=!0;break;case"video":r._video_added_=!1,r._trust_video_stream_added_state_=!0}}},rt(Ye.prototype,"leave",[Vq],Object.getOwnPropertyDescriptor(Ye.prototype,"leave"),Ye.prototype),rt(Ye.prototype,"publish",[Bq],Object.getOwnPropertyDescriptor(Ye.prototype,"publish"),Ye.prototype),rt(Ye.prototype,"unpublish",[$q],Object.getOwnPropertyDescriptor(Ye.prototype,"unpublish"),Ye.prototype),rt(Ye.prototype,"subscribe",[Wq],Object.getOwnPropertyDescriptor(Ye.prototype,"subscribe"),Ye.prototype),rt(Ye.prototype,"presubscribe",[Gq],Object.getOwnPropertyDescriptor(Ye.prototype,"presubscribe"),Ye.prototype),rt(Ye.prototype,"massSubscribe",[Hq],Object.getOwnPropertyDescriptor(Ye.prototype,"massSubscribe"),Ye.prototype),rt(Ye.prototype,"unsubscribe",[zq],Object.getOwnPropertyDescriptor(Ye.prototype,"unsubscribe"),Ye.prototype),rt(Ye.prototype,"massUnsubscribe",[Kq],Object.getOwnPropertyDescriptor(Ye.prototype,"massUnsubscribe"),Ye.prototype),rt(Ye.prototype,"setLowStreamParameter",[qq],Object.getOwnPropertyDescriptor(Ye.prototype,"setLowStreamParameter"),Ye.prototype),rt(Ye.prototype,"enableDualStream",[Yq],Object.getOwnPropertyDescriptor(Ye.prototype,"enableDualStream"),Ye.prototype),rt(Ye.prototype,"disableDualStream",[Xq],Object.getOwnPropertyDescriptor(Ye.prototype,"disableDualStream"),Ye.prototype),rt(Ye.prototype,"setClientRole",[Jq],Object.getOwnPropertyDescriptor(Ye.prototype,"setClientRole"),Ye.prototype),rt(Ye.prototype,"_setClientRoleOptions",[Zq],Object.getOwnPropertyDescriptor(Ye.prototype,"_setClientRoleOptions"),Ye.prototype),rt(Ye.prototype,"setProxyServer",[Qq],Object.getOwnPropertyDescriptor(Ye.prototype,"setProxyServer"),Ye.prototype),rt(Ye.prototype,"setTurnServer",[eY],Object.getOwnPropertyDescriptor(Ye.prototype,"setTurnServer"),Ye.prototype),rt(Ye.prototype,"setLicense",[tY],Object.getOwnPropertyDescriptor(Ye.prototype,"setLicense"),Ye.prototype),rt(Ye.prototype,"startProxyServer",[nY],Object.getOwnPropertyDescriptor(Ye.prototype,"startProxyServer"),Ye.prototype),rt(Ye.prototype,"stopProxyServer",[rY],Object.getOwnPropertyDescriptor(Ye.prototype,"stopProxyServer"),Ye.prototype),rt(Ye.prototype,"setLocalAccessPointsV2",[iY],Object.getOwnPropertyDescriptor(Ye.prototype,"setLocalAccessPointsV2"),Ye.prototype),rt(Ye.prototype,"setLocalAccessPoints",[aY],Object.getOwnPropertyDescriptor(Ye.prototype,"setLocalAccessPoints"),Ye.prototype),rt(Ye.prototype,"setRemoteDefaultVideoStreamType",[sY],Object.getOwnPropertyDescriptor(Ye.prototype,"setRemoteDefaultVideoStreamType"),Ye.prototype),rt(Ye.prototype,"setRemoteVideoStreamType",[oY],Object.getOwnPropertyDescriptor(Ye.prototype,"setRemoteVideoStreamType"),Ye.prototype),rt(Ye.prototype,"setStreamFallbackOption",[cY],Object.getOwnPropertyDescriptor(Ye.prototype,"setStreamFallbackOption"),Ye.prototype),rt(Ye.prototype,"setEncryptionConfig",[lY],Object.getOwnPropertyDescriptor(Ye.prototype,"setEncryptionConfig"),Ye.prototype),rt(Ye.prototype,"renewToken",[uY],Object.getOwnPropertyDescriptor(Ye.prototype,"renewToken"),Ye.prototype),rt(Ye.prototype,"enableAudioVolumeIndicator",[dY],Object.getOwnPropertyDescriptor(Ye.prototype,"enableAudioVolumeIndicator"),Ye.prototype),rt(Ye.prototype,"startLiveStreaming",[hY],Object.getOwnPropertyDescriptor(Ye.prototype,"startLiveStreaming"),Ye.prototype),rt(Ye.prototype,"setLiveTranscoding",[fY],Object.getOwnPropertyDescriptor(Ye.prototype,"setLiveTranscoding"),Ye.prototype),rt(Ye.prototype,"stopLiveStreaming",[pY],Object.getOwnPropertyDescriptor(Ye.prototype,"stopLiveStreaming"),Ye.prototype),rt(Ye.prototype,"startChannelMediaRelay",[mY],Object.getOwnPropertyDescriptor(Ye.prototype,"startChannelMediaRelay"),Ye.prototype),rt(Ye.prototype,"updateChannelMediaRelay",[gY],Object.getOwnPropertyDescriptor(Ye.prototype,"updateChannelMediaRelay"),Ye.prototype),rt(Ye.prototype,"stopChannelMediaRelay",[vY],Object.getOwnPropertyDescriptor(Ye.prototype,"stopChannelMediaRelay"),Ye.prototype),rt(Ye.prototype,"sendCustomReportMessage",[yY],Object.getOwnPropertyDescriptor(Ye.prototype,"sendCustomReportMessage"),Ye.prototype),rt(Ye.prototype,"pickSVCLayer",[_Y],Object.getOwnPropertyDescriptor(Ye.prototype,"pickSVCLayer"),Ye.prototype),rt(Ye.prototype,"setRTMConfig",[bY],Object.getOwnPropertyDescriptor(Ye.prototype,"setRTMConfig"),Ye.prototype),rt(Ye.prototype,"enableContentInspect",[EY],Object.getOwnPropertyDescriptor(Ye.prototype,"enableContentInspect"),Ye.prototype),rt(Ye.prototype,"disableContentInspect",[wY],Object.getOwnPropertyDescriptor(Ye.prototype,"disableContentInspect"),Ye.prototype),rt(Ye.prototype,"setImageModeration",[SY],Object.getOwnPropertyDescriptor(Ye.prototype,"setImageModeration"),Ye.prototype),rt(Ye.prototype,"setP2PTransport",[xY],Object.getOwnPropertyDescriptor(Ye.prototype,"setP2PTransport"),Ye.prototype),rt(Ye.prototype,"getJoinChannelServiceRecords",[TY],Object.getOwnPropertyDescriptor(Ye.prototype,"getJoinChannelServiceRecords"),Ye.prototype),rt(Ye.prototype,"setPublishAudioFilterEnabled",[CY],Object.getOwnPropertyDescriptor(Ye.prototype,"setPublishAudioFilterEnabled"),Ye.prototype),Ye);class kb{constructor(a,s){Q(this,"id",0),Q(this,"element",void 0),Q(this,"peerPair",void 0),Q(this,"context",void 0),Q(this,"audioPlayerElement",void 0),Q(this,"audioTrack",void 0),kb.count+=1,this.id=kb.count,this.element=a,this.context=s}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=a=>{const s=document.createElement("audio");s.srcObject=new MediaStream([a.track]),s.play(),this.audioPlayerElement=s}}async switchSdp(){if(!this.peerPair)return;const a=async(l,d)=>{const f=d==="offer"?await l.createOffer():await l.createAnswer();return await l.setLocalDescription(f),l.iceGatheringState==="complete"?l.localDescription:new He(m=>{l.onicegatheringstatechange=()=>{l.iceGatheringState==="complete"&&m(l.localDescription)}})},s=async(l,d)=>await l.setRemoteDescription(d);try{const l=await a(this.peerPair[0],"offer");await s(this.peerPair[1],l);const d=await a(this.peerPair[1],"answer");await s(this.peerPair[0],d)}catch(l){throw new Ee(ie.LOCAL_AEC_ERROR,l.toString()).print()}}async getTracksFromMediaElement(a){if(this.audioTrack)return this.audioTrack;let s;try{a instanceof HTMLVideoElement&&(a.captureStream?a.captureStream():a.mozCaptureStream()),s=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(a).connect(s)}catch(d){throw new Ee(ie.LOCAL_AEC_ERROR,d.toString()).print()}if(!s)throw new Ee(ie.LOCAL_AEC_ERROR,"no dest node when local aec").print();const l=s.stream.getAudioTracks()[0];return this.audioTrack=l,l}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const a=this.element,s=await this.getTracksFromMediaElement(a);this.peerPair&&this.peerPair[0].addTrack(s),await this.switchSdp()}close(){V.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(a=>{a.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var NY,KT;Q(kb,"count",0);const GOe=window.AudioContext||window.webkitAudioContext,HOe=new(NY=Et({report:it}),rt((KT=class{constructor(){Q(this,"units",[]),Q(this,"context",void 0)}processExternalMediaAEC(r){if(!this._doesEnvironmentNeedAEC())return V.debug("the system does not need to process local aec"),-1;this.context||(this.context=new GOe);let a=this.units.find(s=>s&&s.getElement()===r);return a||(a=new kb(r,this.context),this.units.push(a)),a.startEchoCancellation(),V.debug("start processing local audio echo cancellation, id is",a.id),a.id}_doesEnvironmentNeedAEC(){return an().name!==fn.SAFARI}}).prototype,"processExternalMediaAEC",[NY],Object.getOwnPropertyDescriptor(KT.prototype,"processExternalMediaAEC"),KT.prototype),KT);function AY(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function IY(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?AY(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):AY(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}const KD=window||document;function OY(r){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!KD)return;const s=Hr._cspEventHandlerPointer;if(s&&a)return void console.error(s,a);const l=d=>{if(!(d&&d.blockedURI&&(Hr.onSecurityPolicyViolation||Hr.getListeners(au.SECURITY_POLICY_VIOLATION).length>0)))return;const f=d.blockedURI;oe("CSP_DETECTED_HOSTNAME_LIST").some(m=>Be(f).call(f,m))&&(Hr.onSecurityPolicyViolation&&typeof Hr.onSecurityPolicyViolation=="function"&&Hr.onSecurityPolicyViolation(d),Hr.getListeners(au.SECURITY_POLICY_VIOLATION).length>0&&Hr.safeEmit(au.SECURITY_POLICY_VIOLATION,d))};s&&KD.removeEventListener("securitypolicyviolation",s),(a||r&&typeof r=="function"||Hr.getListeners(au.SECURITY_POLICY_VIOLATION).length>0)&&KD.addEventListener("securitypolicyviolation",l),Hr._cspEventHandlerPointer=l}var zOe=T,KOe=hH,PY=RegExp.prototype,qOe=function(r){return r===PY||zOe(PY,r)?KOe(r):r.flags},xa=o(qOe);function Kg(r){let a=r.length;for(;--a>=0;)r[a]=0}const qD=256,kY=286,jb=30,Db=15,YD=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),qT=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),YOe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),jY=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ud=new Array(576);Kg(ud);const Lb=new Array(60);Kg(Lb);const Mb=new Array(512);Kg(Mb);const Ub=new Array(256);Kg(Ub);const XD=new Array(29);Kg(XD);const YT=new Array(jb);function JD(r,a,s,l,d){this.static_tree=r,this.extra_bits=a,this.extra_base=s,this.elems=l,this.max_length=d,this.has_stree=r&&r.length}let DY,LY,MY;function ZD(r,a){this.dyn_tree=r,this.max_code=0,this.stat_desc=a}Kg(YT);const UY=r=>r<256?Mb[r]:Mb[256+(r>>>7)],Fb=(r,a)=>{r.pending_buf[r.pending++]=255&a,r.pending_buf[r.pending++]=a>>>8&255},io=(r,a,s)=>{r.bi_valid>16-s?(r.bi_buf|=a<<r.bi_valid&65535,Fb(r,r.bi_buf),r.bi_buf=a>>16-r.bi_valid,r.bi_valid+=s-16):(r.bi_buf|=a<<r.bi_valid&65535,r.bi_valid+=s)},cu=(r,a,s)=>{io(r,s[2*a],s[2*a+1])},FY=(r,a)=>{let s=0;do s|=1&r,r>>>=1,s<<=1;while(--a>0);return s>>>1},VY=(r,a,s)=>{const l=new Array(16);let d,f,m=0;for(d=1;d<=Db;d++)m=m+s[d-1]<<1,l[d]=m;for(f=0;f<=a;f++){let y=r[2*f+1];y!==0&&(r[2*f]=FY(l[y]++,y))}},BY=r=>{let a;for(a=0;a<kY;a++)r.dyn_ltree[2*a]=0;for(a=0;a<jb;a++)r.dyn_dtree[2*a]=0;for(a=0;a<19;a++)r.bl_tree[2*a]=0;r.dyn_ltree[512]=1,r.opt_len=r.static_len=0,r.sym_next=r.matches=0},$Y=r=>{r.bi_valid>8?Fb(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},WY=(r,a,s,l)=>{const d=2*a,f=2*s;return r[d]<r[f]||r[d]===r[f]&&l[a]<=l[s]},QD=(r,a,s)=>{const l=r.heap[s];let d=s<<1;for(;d<=r.heap_len&&(d<r.heap_len&&WY(a,r.heap[d+1],r.heap[d],r.depth)&&d++,!WY(a,l,r.heap[d],r.depth));)r.heap[s]=r.heap[d],s=d,d<<=1;r.heap[s]=l},GY=(r,a,s)=>{let l,d,f,m,y=0;if(r.sym_next!==0)do l=255&r.pending_buf[r.sym_buf+y++],l+=(255&r.pending_buf[r.sym_buf+y++])<<8,d=r.pending_buf[r.sym_buf+y++],l===0?cu(r,d,a):(f=Ub[d],cu(r,f+qD+1,a),m=YD[f],m!==0&&(d-=XD[f],io(r,d,m)),l--,f=UY(l),cu(r,f,s),m=qT[f],m!==0&&(l-=YT[f],io(r,l,m)));while(y<r.sym_next);cu(r,256,a)},e2=(r,a)=>{const s=a.dyn_tree,l=a.stat_desc.static_tree,d=a.stat_desc.has_stree,f=a.stat_desc.elems;let m,y,_,S=-1;for(r.heap_len=0,r.heap_max=573,m=0;m<f;m++)s[2*m]!==0?(r.heap[++r.heap_len]=S=m,r.depth[m]=0):s[2*m+1]=0;for(;r.heap_len<2;)_=r.heap[++r.heap_len]=S<2?++S:0,s[2*_]=1,r.depth[_]=0,r.opt_len--,d&&(r.static_len-=l[2*_+1]);for(a.max_code=S,m=r.heap_len>>1;m>=1;m--)QD(r,s,m);_=f;do m=r.heap[1],r.heap[1]=r.heap[r.heap_len--],QD(r,s,1),y=r.heap[1],r.heap[--r.heap_max]=m,r.heap[--r.heap_max]=y,s[2*_]=s[2*m]+s[2*y],r.depth[_]=(r.depth[m]>=r.depth[y]?r.depth[m]:r.depth[y])+1,s[2*m+1]=s[2*y+1]=_,r.heap[1]=_++,QD(r,s,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],((x,A)=>{const I=A.dyn_tree,L=A.max_code,K=A.stat_desc.static_tree,$=A.stat_desc.has_stree,G=A.stat_desc.extra_bits,ne=A.stat_desc.extra_base,te=A.stat_desc.max_length;let ce,pe,fe,ue,ye,Se,Ie=0;for(ue=0;ue<=Db;ue++)x.bl_count[ue]=0;for(I[2*x.heap[x.heap_max]+1]=0,ce=x.heap_max+1;ce<573;ce++)pe=x.heap[ce],ue=I[2*I[2*pe+1]+1]+1,ue>te&&(ue=te,Ie++),I[2*pe+1]=ue,pe>L||(x.bl_count[ue]++,ye=0,pe>=ne&&(ye=G[pe-ne]),Se=I[2*pe],x.opt_len+=Se*(ue+ye),$&&(x.static_len+=Se*(K[2*pe+1]+ye)));if(Ie!==0){do{for(ue=te-1;x.bl_count[ue]===0;)ue--;x.bl_count[ue]--,x.bl_count[ue+1]+=2,x.bl_count[te]--,Ie-=2}while(Ie>0);for(ue=te;ue!==0;ue--)for(pe=x.bl_count[ue];pe!==0;)fe=x.heap[--ce],fe>L||(I[2*fe+1]!==ue&&(x.opt_len+=(ue-I[2*fe+1])*I[2*fe],I[2*fe+1]=ue),pe--)}})(r,a),VY(s,S,r.bl_count)},HY=(r,a,s)=>{let l,d,f=-1,m=a[1],y=0,_=7,S=4;for(m===0&&(_=138,S=3),a[2*(s+1)+1]=65535,l=0;l<=s;l++)d=m,m=a[2*(l+1)+1],++y<_&&d===m||(y<S?r.bl_tree[2*d]+=y:d!==0?(d!==f&&r.bl_tree[2*d]++,r.bl_tree[32]++):y<=10?r.bl_tree[34]++:r.bl_tree[36]++,y=0,f=d,m===0?(_=138,S=3):d===m?(_=6,S=3):(_=7,S=4))},zY=(r,a,s)=>{let l,d,f=-1,m=a[1],y=0,_=7,S=4;for(m===0&&(_=138,S=3),l=0;l<=s;l++)if(d=m,m=a[2*(l+1)+1],!(++y<_&&d===m)){if(y<S)do cu(r,d,r.bl_tree);while(--y!=0);else d!==0?(d!==f&&(cu(r,d,r.bl_tree),y--),cu(r,16,r.bl_tree),io(r,y-3,2)):y<=10?(cu(r,17,r.bl_tree),io(r,y-3,3)):(cu(r,18,r.bl_tree),io(r,y-11,7));y=0,f=d,m===0?(_=138,S=3):d===m?(_=6,S=3):(_=7,S=4)}};let KY=!1;const qY=(r,a,s,l)=>{io(r,0+(l?1:0),3),$Y(r),Fb(r,s),Fb(r,~s),s&&r.pending_buf.set(r.window.subarray(a,a+s),r.pending),r.pending+=s};var XOe=r=>{KY||((()=>{let a,s,l,d,f;const m=new Array(16);for(l=0,d=0;d<28;d++)for(XD[d]=l,a=0;a<1<<YD[d];a++)Ub[l++]=d;for(Ub[l-1]=d,f=0,d=0;d<16;d++)for(YT[d]=f,a=0;a<1<<qT[d];a++)Mb[f++]=d;for(f>>=7;d<jb;d++)for(YT[d]=f<<7,a=0;a<1<<qT[d]-7;a++)Mb[256+f++]=d;for(s=0;s<=Db;s++)m[s]=0;for(a=0;a<=143;)ud[2*a+1]=8,a++,m[8]++;for(;a<=255;)ud[2*a+1]=9,a++,m[9]++;for(;a<=279;)ud[2*a+1]=7,a++,m[7]++;for(;a<=287;)ud[2*a+1]=8,a++,m[8]++;for(VY(ud,287,m),a=0;a<jb;a++)Lb[2*a+1]=5,Lb[2*a]=FY(a,5);DY=new JD(ud,YD,257,kY,Db),LY=new JD(Lb,qT,0,jb,Db),MY=new JD(new Array(0),YOe,0,19,7)})(),KY=!0),r.l_desc=new ZD(r.dyn_ltree,DY),r.d_desc=new ZD(r.dyn_dtree,LY),r.bl_desc=new ZD(r.bl_tree,MY),r.bi_buf=0,r.bi_valid=0,BY(r)},JOe=(r,a,s,l)=>{let d,f,m=0;r.level>0?(r.strm.data_type===2&&(r.strm.data_type=(y=>{let _,S=4093624447;for(_=0;_<=31;_++,S>>>=1)if(1&S&&y.dyn_ltree[2*_]!==0)return 0;if(y.dyn_ltree[18]!==0||y.dyn_ltree[20]!==0||y.dyn_ltree[26]!==0)return 1;for(_=32;_<qD;_++)if(y.dyn_ltree[2*_]!==0)return 1;return 0})(r)),e2(r,r.l_desc),e2(r,r.d_desc),m=(y=>{let _;for(HY(y,y.dyn_ltree,y.l_desc.max_code),HY(y,y.dyn_dtree,y.d_desc.max_code),e2(y,y.bl_desc),_=18;_>=3&&y.bl_tree[2*jY[_]+1]===0;_--);return y.opt_len+=3*(_+1)+5+5+4,_})(r),d=r.opt_len+3+7>>>3,f=r.static_len+3+7>>>3,f<=d&&(d=f)):d=f=s+5,s+4<=d&&a!==-1?qY(r,a,s,l):r.strategy===4||f===d?(io(r,2+(l?1:0),3),GY(r,ud,Lb)):(io(r,4+(l?1:0),3),((y,_,S,x)=>{let A;for(io(y,_-257,5),io(y,S-1,5),io(y,x-4,4),A=0;A<x;A++)io(y,y.bl_tree[2*jY[A]+1],3);zY(y,y.dyn_ltree,_-1),zY(y,y.dyn_dtree,S-1)})(r,r.l_desc.max_code+1,r.d_desc.max_code+1,m+1),GY(r,r.dyn_ltree,r.dyn_dtree)),BY(r),l&&$Y(r)},ZOe=(r,a,s)=>(r.pending_buf[r.sym_buf+r.sym_next++]=a,r.pending_buf[r.sym_buf+r.sym_next++]=a>>8,r.pending_buf[r.sym_buf+r.sym_next++]=s,a===0?r.dyn_ltree[2*s]++:(r.matches++,a--,r.dyn_ltree[2*(Ub[s]+qD+1)]++,r.dyn_dtree[2*UY(a)]++),r.sym_next===r.sym_end),QOe=r=>{io(r,2,3),cu(r,256,ud),(a=>{a.bi_valid===16?(Fb(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)})(r)},ePe={_tr_init:XOe,_tr_stored_block:qY,_tr_flush_block:JOe,_tr_tally:ZOe,_tr_align:QOe},Vb=(r,a,s,l)=>{let d=65535&r|0,f=r>>>16&65535|0,m=0;for(;s!==0;){m=s>2e3?2e3:s,s-=m;do d=d+a[l++]|0,f=f+d|0;while(--m);d%=65521,f%=65521}return d|f<<16|0};const tPe=new Uint32Array((()=>{let r,a=[];for(var s=0;s<256;s++){r=s;for(var l=0;l<8;l++)r=1&r?3988292384^r>>>1:r>>>1;a[s]=r}return a})());var Ua=(r,a,s,l)=>{const d=tPe,f=l+s;r^=-1;for(let m=l;m<f;m++)r=r>>>8^d[255&(r^a[m])];return-1^r},bp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},XT={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:nPe,_tr_stored_block:t2,_tr_flush_block:rPe,_tr_tally:Ch,_tr_align:iPe}=ePe,{Z_NO_FLUSH:Rh,Z_PARTIAL_FLUSH:aPe,Z_FULL_FLUSH:sPe,Z_FINISH:bc,Z_BLOCK:YY,Z_OK:Ja,Z_STREAM_END:XY,Z_STREAM_ERROR:lu,Z_DATA_ERROR:oPe,Z_BUF_ERROR:n2,Z_DEFAULT_COMPRESSION:cPe,Z_FILTERED:lPe,Z_HUFFMAN_ONLY:JT,Z_RLE:uPe,Z_FIXED:dPe,Z_DEFAULT_STRATEGY:hPe,Z_UNKNOWN:fPe,Z_DEFLATED:ZT}=XT,r2=286,pPe=30,mPe=19,gPe=2*r2+1,vPe=15,Ep=258,uu=262,qg=42,wp=113,Bb=666,Sp=(r,a)=>(r.msg=bp[a],a),JY=r=>2*r-(r>4?9:0),Nh=r=>{let a=r.length;for(;--a>=0;)r[a]=0},yPe=r=>{let a,s,l,d=r.w_size;a=r.hash_size,l=a;do s=r.head[--l],r.head[l]=s>=d?s-d:0;while(--a);a=d,l=a;do s=r.prev[--l],r.prev[l]=s>=d?s-d:0;while(--a)};let Ah=(r,a,s)=>(a<<r.hash_shift^s)&r.hash_mask;const Io=r=>{const a=r.state;let s=a.pending;s>r.avail_out&&(s=r.avail_out),s!==0&&(r.output.set(a.pending_buf.subarray(a.pending_out,a.pending_out+s),r.next_out),r.next_out+=s,a.pending_out+=s,r.total_out+=s,r.avail_out-=s,a.pending-=s,a.pending===0&&(a.pending_out=0))},Oo=(r,a)=>{rPe(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,a),r.block_start=r.strstart,Io(r.strm)},wr=(r,a)=>{r.pending_buf[r.pending++]=a},$b=(r,a)=>{r.pending_buf[r.pending++]=a>>>8&255,r.pending_buf[r.pending++]=255&a},i2=(r,a,s,l)=>{let d=r.avail_in;return d>l&&(d=l),d===0?0:(r.avail_in-=d,a.set(r.input.subarray(r.next_in,r.next_in+d),s),r.state.wrap===1?r.adler=Vb(r.adler,a,d,s):r.state.wrap===2&&(r.adler=Ua(r.adler,a,d,s)),r.next_in+=d,r.total_in+=d,d)},ZY=(r,a)=>{let s,l,d=r.max_chain_length,f=r.strstart,m=r.prev_length,y=r.nice_match;const _=r.strstart>r.w_size-uu?r.strstart-(r.w_size-uu):0,S=r.window,x=r.w_mask,A=r.prev,I=r.strstart+Ep;let L=S[f+m-1],K=S[f+m];r.prev_length>=r.good_match&&(d>>=2),y>r.lookahead&&(y=r.lookahead);do if(s=a,S[s+m]===K&&S[s+m-1]===L&&S[s]===S[f]&&S[++s]===S[f+1]){f+=2,s++;do;while(S[++f]===S[++s]&&S[++f]===S[++s]&&S[++f]===S[++s]&&S[++f]===S[++s]&&S[++f]===S[++s]&&S[++f]===S[++s]&&S[++f]===S[++s]&&S[++f]===S[++s]&&f<I);if(l=Ep-(I-f),f=I-Ep,l>m){if(r.match_start=a,m=l,l>=y)break;L=S[f+m-1],K=S[f+m]}}while((a=A[a&x])>_&&--d!=0);return m<=r.lookahead?m:r.lookahead},Yg=r=>{const a=r.w_size;let s,l,d;do{if(l=r.window_size-r.lookahead-r.strstart,r.strstart>=a+(a-uu)&&(r.window.set(r.window.subarray(a,a+a-l),0),r.match_start-=a,r.strstart-=a,r.block_start-=a,r.insert>r.strstart&&(r.insert=r.strstart),yPe(r),l+=a),r.strm.avail_in===0)break;if(s=i2(r.strm,r.window,r.strstart+r.lookahead,l),r.lookahead+=s,r.lookahead+r.insert>=3)for(d=r.strstart-r.insert,r.ins_h=r.window[d],r.ins_h=Ah(r,r.ins_h,r.window[d+1]);r.insert&&(r.ins_h=Ah(r,r.ins_h,r.window[d+3-1]),r.prev[d&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=d,d++,r.insert--,!(r.lookahead+r.insert<3)););}while(r.lookahead<uu&&r.strm.avail_in!==0)},QY=(r,a)=>{let s,l,d,f=r.pending_buf_size-5>r.w_size?r.w_size:r.pending_buf_size-5,m=0,y=r.strm.avail_in;do{if(s=65535,d=r.bi_valid+42>>3,r.strm.avail_out<d||(d=r.strm.avail_out-d,l=r.strstart-r.block_start,s>l+r.strm.avail_in&&(s=l+r.strm.avail_in),s>d&&(s=d),s<f&&(s===0&&a!==bc||a===Rh||s!==l+r.strm.avail_in)))break;m=a===bc&&s===l+r.strm.avail_in?1:0,t2(r,0,0,m),r.pending_buf[r.pending-4]=s,r.pending_buf[r.pending-3]=s>>8,r.pending_buf[r.pending-2]=~s,r.pending_buf[r.pending-1]=~s>>8,Io(r.strm),l&&(l>s&&(l=s),r.strm.output.set(r.window.subarray(r.block_start,r.block_start+l),r.strm.next_out),r.strm.next_out+=l,r.strm.avail_out-=l,r.strm.total_out+=l,r.block_start+=l,s-=l),s&&(i2(r.strm,r.strm.output,r.strm.next_out,s),r.strm.next_out+=s,r.strm.avail_out-=s,r.strm.total_out+=s)}while(m===0);return y-=r.strm.avail_in,y&&(y>=r.w_size?(r.matches=2,r.window.set(r.strm.input.subarray(r.strm.next_in-r.w_size,r.strm.next_in),0),r.strstart=r.w_size,r.insert=r.strstart):(r.window_size-r.strstart<=y&&(r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,r.insert>r.strstart&&(r.insert=r.strstart)),r.window.set(r.strm.input.subarray(r.strm.next_in-y,r.strm.next_in),r.strstart),r.strstart+=y,r.insert+=y>r.w_size-r.insert?r.w_size-r.insert:y),r.block_start=r.strstart),r.high_water<r.strstart&&(r.high_water=r.strstart),m?4:a!==Rh&&a!==bc&&r.strm.avail_in===0&&r.strstart===r.block_start?2:(d=r.window_size-r.strstart,r.strm.avail_in>d&&r.block_start>=r.w_size&&(r.block_start-=r.w_size,r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,d+=r.w_size,r.insert>r.strstart&&(r.insert=r.strstart)),d>r.strm.avail_in&&(d=r.strm.avail_in),d&&(i2(r.strm,r.window,r.strstart,d),r.strstart+=d,r.insert+=d>r.w_size-r.insert?r.w_size-r.insert:d),r.high_water<r.strstart&&(r.high_water=r.strstart),d=r.bi_valid+42>>3,d=r.pending_buf_size-d>65535?65535:r.pending_buf_size-d,f=d>r.w_size?r.w_size:d,l=r.strstart-r.block_start,(l>=f||(l||a===bc)&&a!==Rh&&r.strm.avail_in===0&&l<=d)&&(s=l>d?d:l,m=a===bc&&r.strm.avail_in===0&&s===l?1:0,t2(r,r.block_start,s,m),r.block_start+=s,Io(r.strm)),m?3:1)},a2=(r,a)=>{let s,l;for(;;){if(r.lookahead<uu){if(Yg(r),r.lookahead<uu&&a===Rh)return 1;if(r.lookahead===0)break}if(s=0,r.lookahead>=3&&(r.ins_h=Ah(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),s!==0&&r.strstart-s<=r.w_size-uu&&(r.match_length=ZY(r,s)),r.match_length>=3)if(l=Ch(r,r.strstart-r.match_start,r.match_length-3),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=3){r.match_length--;do r.strstart++,r.ins_h=Ah(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Ah(r,r.ins_h,r.window[r.strstart+1]);else l=Ch(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(l&&(Oo(r,!1),r.strm.avail_out===0))return 1}return r.insert=r.strstart<2?r.strstart:2,a===bc?(Oo(r,!0),r.strm.avail_out===0?3:4):r.sym_next&&(Oo(r,!1),r.strm.avail_out===0)?1:2},Xg=(r,a)=>{let s,l,d;for(;;){if(r.lookahead<uu){if(Yg(r),r.lookahead<uu&&a===Rh)return 1;if(r.lookahead===0)break}if(s=0,r.lookahead>=3&&(r.ins_h=Ah(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=2,s!==0&&r.prev_length<r.max_lazy_match&&r.strstart-s<=r.w_size-uu&&(r.match_length=ZY(r,s),r.match_length<=5&&(r.strategy===lPe||r.match_length===3&&r.strstart-r.match_start>4096)&&(r.match_length=2)),r.prev_length>=3&&r.match_length<=r.prev_length){d=r.strstart+r.lookahead-3,l=Ch(r,r.strstart-1-r.prev_match,r.prev_length-3),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=d&&(r.ins_h=Ah(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=2,r.strstart++,l&&(Oo(r,!1),r.strm.avail_out===0))return 1}else if(r.match_available){if(l=Ch(r,0,r.window[r.strstart-1]),l&&Oo(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return 1}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(l=Ch(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<2?r.strstart:2,a===bc?(Oo(r,!0),r.strm.avail_out===0?3:4):r.sym_next&&(Oo(r,!1),r.strm.avail_out===0)?1:2};function du(r,a,s,l,d){this.good_length=r,this.max_lazy=a,this.nice_length=s,this.max_chain=l,this.func=d}const Wb=[new du(0,0,0,0,QY),new du(4,4,8,4,a2),new du(4,5,16,8,a2),new du(4,6,32,32,a2),new du(4,4,16,16,Xg),new du(8,16,32,32,Xg),new du(8,16,128,128,Xg),new du(8,32,128,256,Xg),new du(32,128,258,1024,Xg),new du(32,258,258,4096,Xg)];function _Pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ZT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*gPe),this.dyn_dtree=new Uint16Array(2*(2*pPe+1)),this.bl_tree=new Uint16Array(2*(2*mPe+1)),Nh(this.dyn_ltree),Nh(this.dyn_dtree),Nh(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(vPe+1),this.heap=new Uint16Array(2*r2+1),Nh(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*r2+1),Nh(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Gb=r=>{if(!r)return 1;const a=r.state;return!a||a.strm!==r||a.status!==qg&&a.status!==57&&a.status!==69&&a.status!==73&&a.status!==91&&a.status!==103&&a.status!==wp&&a.status!==Bb?1:0},eX=r=>{if(Gb(r))return Sp(r,lu);r.total_in=r.total_out=0,r.data_type=fPe;const a=r.state;return a.pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap===2?57:a.wrap?qg:wp,r.adler=a.wrap===2?0:1,a.last_flush=-2,nPe(a),Ja},tX=r=>{const a=eX(r);return a===Ja&&(s=>{s.window_size=2*s.w_size,Nh(s.head),s.max_lazy_match=Wb[s.level].max_lazy,s.good_match=Wb[s.level].good_length,s.nice_match=Wb[s.level].nice_length,s.max_chain_length=Wb[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0})(r.state),a},nX=(r,a,s,l,d,f)=>{if(!r)return lu;let m=1;if(a===cPe&&(a=6),l<0?(m=0,l=-l):l>15&&(m=2,l-=16),d<1||d>9||s!==ZT||l<8||l>15||a<0||a>9||f<0||f>dPe||l===8&&m!==1)return Sp(r,lu);l===8&&(l=9);const y=new _Pe;return r.state=y,y.strm=r,y.status=qg,y.wrap=m,y.gzhead=null,y.w_bits=l,y.w_size=1<<y.w_bits,y.w_mask=y.w_size-1,y.hash_bits=d+7,y.hash_size=1<<y.hash_bits,y.hash_mask=y.hash_size-1,y.hash_shift=~~((y.hash_bits+3-1)/3),y.window=new Uint8Array(2*y.w_size),y.head=new Uint16Array(y.hash_size),y.prev=new Uint16Array(y.w_size),y.lit_bufsize=1<<d+6,y.pending_buf_size=4*y.lit_bufsize,y.pending_buf=new Uint8Array(y.pending_buf_size),y.sym_buf=y.lit_bufsize,y.sym_end=3*(y.lit_bufsize-1),y.level=a,y.strategy=f,y.method=s,tX(r)};var bPe=(r,a)=>{if(Gb(r)||a>YY||a<0)return r?Sp(r,lu):lu;const s=r.state;if(!r.output||r.avail_in!==0&&!r.input||s.status===Bb&&a!==bc)return Sp(r,r.avail_out===0?n2:lu);const l=s.last_flush;if(s.last_flush=a,s.pending!==0){if(Io(r),r.avail_out===0)return s.last_flush=-1,Ja}else if(r.avail_in===0&&JY(a)<=JY(l)&&a!==bc)return Sp(r,n2);if(s.status===Bb&&r.avail_in!==0)return Sp(r,n2);if(s.status===qg&&s.wrap===0&&(s.status=wp),s.status===qg){let d=ZT+(s.w_bits-8<<4)<<8,f=-1;if(f=s.strategy>=JT||s.level<2?0:s.level<6?1:s.level===6?2:3,d|=f<<6,s.strstart!==0&&(d|=32),d+=31-d%31,$b(s,d),s.strstart!==0&&($b(s,r.adler>>>16),$b(s,65535&r.adler)),r.adler=1,s.status=wp,Io(r),s.pending!==0)return s.last_flush=-1,Ja}if(s.status===57){if(r.adler=0,wr(s,31),wr(s,139),wr(s,8),s.gzhead)wr(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),wr(s,255&s.gzhead.time),wr(s,s.gzhead.time>>8&255),wr(s,s.gzhead.time>>16&255),wr(s,s.gzhead.time>>24&255),wr(s,s.level===9?2:s.strategy>=JT||s.level<2?4:0),wr(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(wr(s,255&s.gzhead.extra.length),wr(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(r.adler=Ua(r.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if(wr(s,0),wr(s,0),wr(s,0),wr(s,0),wr(s,0),wr(s,s.level===9?2:s.strategy>=JT||s.level<2?4:0),wr(s,3),s.status=wp,Io(r),s.pending!==0)return s.last_flush=-1,Ja}if(s.status===69){if(s.gzhead.extra){let d=s.pending,f=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+f>s.pending_buf_size;){let y=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+y),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>d&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-d,d)),s.gzindex+=y,Io(r),s.pending!==0)return s.last_flush=-1,Ja;d=0,f-=y}let m=new Uint8Array(s.gzhead.extra);s.pending_buf.set(m.subarray(s.gzindex,s.gzindex+f),s.pending),s.pending+=f,s.gzhead.hcrc&&s.pending>d&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-d,d)),s.gzindex=0}s.status=73}if(s.status===73){if(s.gzhead.name){let d,f=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f)),Io(r),s.pending!==0)return s.last_flush=-1,Ja;f=0}d=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,wr(s,d)}while(d!==0);s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f)),s.gzindex=0}s.status=91}if(s.status===91){if(s.gzhead.comment){let d,f=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f)),Io(r),s.pending!==0)return s.last_flush=-1,Ja;f=0}d=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,wr(s,d)}while(d!==0);s.gzhead.hcrc&&s.pending>f&&(r.adler=Ua(r.adler,s.pending_buf,s.pending-f,f))}s.status=103}if(s.status===103){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&(Io(r),s.pending!==0))return s.last_flush=-1,Ja;wr(s,255&r.adler),wr(s,r.adler>>8&255),r.adler=0}if(s.status=wp,Io(r),s.pending!==0)return s.last_flush=-1,Ja}if(r.avail_in!==0||s.lookahead!==0||a!==Rh&&s.status!==Bb){let d=s.level===0?QY(s,a):s.strategy===JT?((f,m)=>{let y;for(;;){if(f.lookahead===0&&(Yg(f),f.lookahead===0)){if(m===Rh)return 1;break}if(f.match_length=0,y=Ch(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++,y&&(Oo(f,!1),f.strm.avail_out===0))return 1}return f.insert=0,m===bc?(Oo(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Oo(f,!1),f.strm.avail_out===0)?1:2})(s,a):s.strategy===uPe?((f,m)=>{let y,_,S,x;const A=f.window;for(;;){if(f.lookahead<=Ep){if(Yg(f),f.lookahead<=Ep&&m===Rh)return 1;if(f.lookahead===0)break}if(f.match_length=0,f.lookahead>=3&&f.strstart>0&&(S=f.strstart-1,_=A[S],_===A[++S]&&_===A[++S]&&_===A[++S])){x=f.strstart+Ep;do;while(_===A[++S]&&_===A[++S]&&_===A[++S]&&_===A[++S]&&_===A[++S]&&_===A[++S]&&_===A[++S]&&_===A[++S]&&S<x);f.match_length=Ep-(x-S),f.match_length>f.lookahead&&(f.match_length=f.lookahead)}if(f.match_length>=3?(y=Ch(f,1,f.match_length-3),f.lookahead-=f.match_length,f.strstart+=f.match_length,f.match_length=0):(y=Ch(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++),y&&(Oo(f,!1),f.strm.avail_out===0))return 1}return f.insert=0,m===bc?(Oo(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Oo(f,!1),f.strm.avail_out===0)?1:2})(s,a):Wb[s.level].func(s,a);if(d!==3&&d!==4||(s.status=Bb),d===1||d===3)return r.avail_out===0&&(s.last_flush=-1),Ja;if(d===2&&(a===aPe?iPe(s):a!==YY&&(t2(s,0,0,!1),a===sPe&&(Nh(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),Io(r),r.avail_out===0))return s.last_flush=-1,Ja}return a!==bc?Ja:s.wrap<=0?XY:(s.wrap===2?(wr(s,255&r.adler),wr(s,r.adler>>8&255),wr(s,r.adler>>16&255),wr(s,r.adler>>24&255),wr(s,255&r.total_in),wr(s,r.total_in>>8&255),wr(s,r.total_in>>16&255),wr(s,r.total_in>>24&255)):($b(s,r.adler>>>16),$b(s,65535&r.adler)),Io(r),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?Ja:XY)},EPe=(r,a)=>{let s=a.length;if(Gb(r))return lu;const l=r.state,d=l.wrap;if(d===2||d===1&&l.status!==qg||l.lookahead)return lu;if(d===1&&(r.adler=Vb(r.adler,a,s,0)),l.wrap=0,s>=l.w_size){d===0&&(Nh(l.head),l.strstart=0,l.block_start=0,l.insert=0);let _=new Uint8Array(l.w_size);_.set(a.subarray(s-l.w_size,s),0),a=_,s=l.w_size}const f=r.avail_in,m=r.next_in,y=r.input;for(r.avail_in=s,r.next_in=0,r.input=a,Yg(l);l.lookahead>=3;){let _=l.strstart,S=l.lookahead-2;do l.ins_h=Ah(l,l.ins_h,l.window[_+3-1]),l.prev[_&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=_,_++;while(--S);l.strstart=_,l.lookahead=2,Yg(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=2,l.match_available=0,r.next_in=m,r.input=y,r.avail_in=f,l.wrap=d,Ja},Hb={deflateInit:(r,a)=>nX(r,a,ZT,15,8,hPe),deflateInit2:nX,deflateReset:tX,deflateResetKeep:eX,deflateSetHeader:(r,a)=>Gb(r)||r.state.wrap!==2?lu:(r.state.gzhead=a,Ja),deflate:bPe,deflateEnd:r=>{if(Gb(r))return lu;const a=r.state.status;return r.state=null,a===wp?Sp(r,oPe):Ja},deflateSetDictionary:EPe,deflateInfo:"pako deflate (from Nodeca project)"};const wPe=(r,a)=>Object.prototype.hasOwnProperty.call(r,a);var QT={assign:function(r){const a=Array.prototype.slice.call(arguments,1);for(;a.length;){const s=a.shift();if(s){if(typeof s!="object")throw new TypeError(s+"must be non-object");for(const l in s)wPe(s,l)&&(r[l]=s[l])}}return r},flattenChunks:r=>{let a=0;for(let l=0,d=r.length;l<d;l++)a+=r[l].length;const s=new Uint8Array(a);for(let l=0,d=0,f=r.length;l<f;l++){let m=r[l];s.set(m,d),d+=m.length}return s}};let rX=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rX=!1}const zb=new Uint8Array(256);for(let r=0;r<256;r++)zb[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;zb[254]=zb[254]=1;var Kb={string2buf:r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let a,s,l,d,f,m=r.length,y=0;for(d=0;d<m;d++)s=r.charCodeAt(d),(64512&s)==55296&&d+1<m&&(l=r.charCodeAt(d+1),(64512&l)==56320&&(s=65536+(s-55296<<10)+(l-56320),d++)),y+=s<128?1:s<2048?2:s<65536?3:4;for(a=new Uint8Array(y),f=0,d=0;f<y;d++)s=r.charCodeAt(d),(64512&s)==55296&&d+1<m&&(l=r.charCodeAt(d+1),(64512&l)==56320&&(s=65536+(s-55296<<10)+(l-56320),d++)),s<128?a[f++]=s:s<2048?(a[f++]=192|s>>>6,a[f++]=128|63&s):s<65536?(a[f++]=224|s>>>12,a[f++]=128|s>>>6&63,a[f++]=128|63&s):(a[f++]=240|s>>>18,a[f++]=128|s>>>12&63,a[f++]=128|s>>>6&63,a[f++]=128|63&s);return a},buf2string:(r,a)=>{const s=a||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,a));let l,d;const f=new Array(2*s);for(d=0,l=0;l<s;){let m=r[l++];if(m<128){f[d++]=m;continue}let y=zb[m];if(y>4)f[d++]=65533,l+=y-1;else{for(m&=y===2?31:y===3?15:7;y>1&&l<s;)m=m<<6|63&r[l++],y--;y>1?f[d++]=65533:m<65536?f[d++]=m:(m-=65536,f[d++]=55296|m>>10&1023,f[d++]=56320|1023&m)}}return((m,y)=>{if(y<65534&&m.subarray&&rX)return String.fromCharCode.apply(null,m.length===y?m:m.subarray(0,y));let _="";for(let S=0;S<y;S++)_+=String.fromCharCode(m[S]);return _})(f,d)},utf8border:(r,a)=>{(a=a||r.length)>r.length&&(a=r.length);let s=a-1;for(;s>=0&&(192&r[s])==128;)s--;return s<0||s===0?a:s+zb[r[s]]>a?s:a}},iX=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const aX=Object.prototype.toString,{Z_NO_FLUSH:SPe,Z_SYNC_FLUSH:xPe,Z_FULL_FLUSH:TPe,Z_FINISH:CPe,Z_OK:eC,Z_STREAM_END:RPe,Z_DEFAULT_COMPRESSION:NPe,Z_DEFAULT_STRATEGY:APe,Z_DEFLATED:IPe}=XT;function tC(r){this.options=QT.assign({level:NPe,method:IPe,chunkSize:16384,windowBits:15,memLevel:8,strategy:APe},r||{});let a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iX,this.strm.avail_out=0;let s=Hb.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(s!==eC)throw new Error(bp[s]);if(a.header&&Hb.deflateSetHeader(this.strm,a.header),a.dictionary){let l;if(l=typeof a.dictionary=="string"?Kb.string2buf(a.dictionary):aX.call(a.dictionary)==="[object ArrayBuffer]"?new Uint8Array(a.dictionary):a.dictionary,s=Hb.deflateSetDictionary(this.strm,l),s!==eC)throw new Error(bp[s]);this._dict_set=!0}}function OPe(r,a){const s=new tC(a);if(s.push(r,!0),s.err)throw s.msg||bp[s.err];return s.result}tC.prototype.push=function(r,a){const s=this.strm,l=this.options.chunkSize;let d,f;if(this.ended)return!1;for(f=a===~~a?a:a===!0?CPe:SPe,typeof r=="string"?s.input=Kb.string2buf(r):aX.call(r)==="[object ArrayBuffer]"?s.input=new Uint8Array(r):s.input=r,s.next_in=0,s.avail_in=s.input.length;;)if(s.avail_out===0&&(s.output=new Uint8Array(l),s.next_out=0,s.avail_out=l),(f===xPe||f===TPe)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(d=Hb.deflate(s,f),d===RPe)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),d=Hb.deflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===eC;if(s.avail_out!==0){if(f>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(s.avail_in===0)break}else this.onData(s.output)}return!0},tC.prototype.onData=function(r){this.chunks.push(r)},tC.prototype.onEnd=function(r){r===eC&&(this.result=QT.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var PPe={deflate:OPe};const nC=16209;var kPe=function(r,a){let s,l,d,f,m,y,_,S,x,A,I,L,K,$,G,ne,te,ce,pe,fe,ue,ye,Se,Ie;const Me=r.state;s=r.next_in,Se=r.input,l=s+(r.avail_in-5),d=r.next_out,Ie=r.output,f=d-(a-r.avail_out),m=d+(r.avail_out-257),y=Me.dmax,_=Me.wsize,S=Me.whave,x=Me.wnext,A=Me.window,I=Me.hold,L=Me.bits,K=Me.lencode,$=Me.distcode,G=(1<<Me.lenbits)-1,ne=(1<<Me.distbits)-1;e:do{L<15&&(I+=Se[s++]<<L,L+=8,I+=Se[s++]<<L,L+=8),te=K[I&G];t:for(;;){if(ce=te>>>24,I>>>=ce,L-=ce,ce=te>>>16&255,ce===0)Ie[d++]=65535&te;else{if(!(16&ce)){if(!(64&ce)){te=K[(65535&te)+(I&(1<<ce)-1)];continue t}if(32&ce){Me.mode=16191;break e}r.msg="invalid literal/length code",Me.mode=nC;break e}pe=65535&te,ce&=15,ce&&(L<ce&&(I+=Se[s++]<<L,L+=8),pe+=I&(1<<ce)-1,I>>>=ce,L-=ce),L<15&&(I+=Se[s++]<<L,L+=8,I+=Se[s++]<<L,L+=8),te=$[I&ne];n:for(;;){if(ce=te>>>24,I>>>=ce,L-=ce,ce=te>>>16&255,!(16&ce)){if(!(64&ce)){te=$[(65535&te)+(I&(1<<ce)-1)];continue n}r.msg="invalid distance code",Me.mode=nC;break e}if(fe=65535&te,ce&=15,L<ce&&(I+=Se[s++]<<L,L+=8,L<ce&&(I+=Se[s++]<<L,L+=8)),fe+=I&(1<<ce)-1,fe>y){r.msg="invalid distance too far back",Me.mode=nC;break e}if(I>>>=ce,L-=ce,ce=d-f,fe>ce){if(ce=fe-ce,ce>S&&Me.sane){r.msg="invalid distance too far back",Me.mode=nC;break e}if(ue=0,ye=A,x===0){if(ue+=_-ce,ce<pe){pe-=ce;do Ie[d++]=A[ue++];while(--ce);ue=d-fe,ye=Ie}}else if(x<ce){if(ue+=_+x-ce,ce-=x,ce<pe){pe-=ce;do Ie[d++]=A[ue++];while(--ce);if(ue=0,x<pe){ce=x,pe-=ce;do Ie[d++]=A[ue++];while(--ce);ue=d-fe,ye=Ie}}}else if(ue+=x-ce,ce<pe){pe-=ce;do Ie[d++]=A[ue++];while(--ce);ue=d-fe,ye=Ie}for(;pe>2;)Ie[d++]=ye[ue++],Ie[d++]=ye[ue++],Ie[d++]=ye[ue++],pe-=3;pe&&(Ie[d++]=ye[ue++],pe>1&&(Ie[d++]=ye[ue++]))}else{ue=d-fe;do Ie[d++]=Ie[ue++],Ie[d++]=Ie[ue++],Ie[d++]=Ie[ue++],pe-=3;while(pe>2);pe&&(Ie[d++]=Ie[ue++],pe>1&&(Ie[d++]=Ie[ue++]))}break}}break}}while(s<l&&d<m);pe=L>>3,s-=pe,L-=pe<<3,I&=(1<<L)-1,r.next_in=s,r.next_out=d,r.avail_in=s<l?l-s+5:5-(s-l),r.avail_out=d<m?m-d+257:257-(d-m),Me.hold=I,Me.bits=L};const rC=15,jPe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),DPe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),LPe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),MPe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var qb=(r,a,s,l,d,f,m,y)=>{const _=y.bits;let S,x,A,I,L,K,$=0,G=0,ne=0,te=0,ce=0,pe=0,fe=0,ue=0,ye=0,Se=0,Ie=null;const Me=new Uint16Array(16),Gt=new Uint16Array(16);let Kt,Nt,bn,vn=null;for($=0;$<=rC;$++)Me[$]=0;for(G=0;G<l;G++)Me[a[s+G]]++;for(ce=_,te=rC;te>=1&&Me[te]===0;te--);if(ce>te&&(ce=te),te===0)return d[f++]=20971520,d[f++]=20971520,y.bits=1,0;for(ne=1;ne<te&&Me[ne]===0;ne++);for(ce<ne&&(ce=ne),ue=1,$=1;$<=rC;$++)if(ue<<=1,ue-=Me[$],ue<0)return-1;if(ue>0&&(r===0||te!==1))return-1;for(Gt[1]=0,$=1;$<rC;$++)Gt[$+1]=Gt[$]+Me[$];for(G=0;G<l;G++)a[s+G]!==0&&(m[Gt[a[s+G]]++]=G);if(r===0?(Ie=vn=m,K=20):r===1?(Ie=jPe,vn=DPe,K=257):(Ie=LPe,vn=MPe,K=0),Se=0,G=0,$=ne,L=f,pe=ce,fe=0,A=-1,ye=1<<ce,I=ye-1,r===1&&ye>852||r===2&&ye>592)return 1;for(;;){Kt=$-fe,m[G]+1<K?(Nt=0,bn=m[G]):m[G]>=K?(Nt=vn[m[G]-K],bn=Ie[m[G]-K]):(Nt=96,bn=0),S=1<<$-fe,x=1<<pe,ne=x;do x-=S,d[L+(Se>>fe)+x]=Kt<<24|Nt<<16|bn|0;while(x!==0);for(S=1<<$-1;Se&S;)S>>=1;if(S!==0?(Se&=S-1,Se+=S):Se=0,G++,--Me[$]==0){if($===te)break;$=a[s+m[G]]}if($>ce&&(Se&I)!==A){for(fe===0&&(fe=ce),L+=ne,pe=$-fe,ue=1<<pe;pe+fe<te&&(ue-=Me[pe+fe],!(ue<=0));)pe++,ue<<=1;if(ye+=1<<pe,r===1&&ye>852||r===2&&ye>592)return 1;A=Se&I,d[A]=ce<<24|pe<<16|L-f|0}}return Se!==0&&(d[L+Se]=$-fe<<24|64<<16|0),y.bits=ce,0};const{Z_FINISH:sX,Z_BLOCK:UPe,Z_TREES:iC,Z_OK:xp,Z_STREAM_END:FPe,Z_NEED_DICT:VPe,Z_STREAM_ERROR:Ec,Z_DATA_ERROR:oX,Z_MEM_ERROR:cX,Z_BUF_ERROR:BPe,Z_DEFLATED:lX}=XT,aC=16180,sC=16190,dd=16191,s2=16192,o2=16194,oC=16199,cC=16200,c2=16206,yi=16209,uX=r=>(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24);function $Pe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Tp=r=>{if(!r)return 1;const a=r.state;return!a||a.strm!==r||a.mode<aC||a.mode>16211?1:0},dX=r=>{if(Tp(r))return Ec;const a=r.state;return r.total_in=r.total_out=a.total=0,r.msg="",a.wrap&&(r.adler=1&a.wrap),a.mode=aC,a.last=0,a.havedict=0,a.flags=-1,a.dmax=32768,a.head=null,a.hold=0,a.bits=0,a.lencode=a.lendyn=new Int32Array(852),a.distcode=a.distdyn=new Int32Array(592),a.sane=1,a.back=-1,xp},hX=r=>{if(Tp(r))return Ec;const a=r.state;return a.wsize=0,a.whave=0,a.wnext=0,dX(r)},fX=(r,a)=>{let s;if(Tp(r))return Ec;const l=r.state;return a<0?(s=0,a=-a):(s=5+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?Ec:(l.window!==null&&l.wbits!==a&&(l.window=null),l.wrap=s,l.wbits=a,hX(r))},pX=(r,a)=>{if(!r)return Ec;const s=new $Pe;r.state=s,s.strm=r,s.window=null,s.mode=aC;const l=fX(r,a);return l!==xp&&(r.state=null),l};let l2,u2,mX=!0;const WPe=r=>{if(mX){l2=new Int32Array(512),u2=new Int32Array(32);let a=0;for(;a<144;)r.lens[a++]=8;for(;a<256;)r.lens[a++]=9;for(;a<280;)r.lens[a++]=7;for(;a<288;)r.lens[a++]=8;for(qb(1,r.lens,0,288,l2,0,r.work,{bits:9}),a=0;a<32;)r.lens[a++]=5;qb(2,r.lens,0,32,u2,0,r.work,{bits:5}),mX=!1}r.lencode=l2,r.lenbits=9,r.distcode=u2,r.distbits=5},gX=(r,a,s,l)=>{let d;const f=r.state;return f.window===null&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new Uint8Array(f.wsize)),l>=f.wsize?(f.window.set(a.subarray(s-f.wsize,s),0),f.wnext=0,f.whave=f.wsize):(d=f.wsize-f.wnext,d>l&&(d=l),f.window.set(a.subarray(s-l,s-l+d),f.wnext),(l-=d)?(f.window.set(a.subarray(s-l,s),0),f.wnext=l,f.whave=f.wsize):(f.wnext+=d,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=d))),0};var GPe=(r,a)=>{let s,l,d,f,m,y,_,S,x,A,I,L,K,$,G,ne,te,ce,pe,fe,ue,ye,Se=0;const Ie=new Uint8Array(4);let Me,Gt;const Kt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Tp(r)||!r.output||!r.input&&r.avail_in!==0)return Ec;s=r.state,s.mode===dd&&(s.mode=s2),m=r.next_out,d=r.output,_=r.avail_out,f=r.next_in,l=r.input,y=r.avail_in,S=s.hold,x=s.bits,A=y,I=_,ye=xp;e:for(;;)switch(s.mode){case aC:if(s.wrap===0){s.mode=s2;break}for(;x<16;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(2&s.wrap&&S===35615){s.wbits===0&&(s.wbits=15),s.check=0,Ie[0]=255&S,Ie[1]=S>>>8&255,s.check=Ua(s.check,Ie,2,0),S=0,x=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&S)<<8)+(S>>8))%31){r.msg="incorrect header check",s.mode=yi;break}if((15&S)!==lX){r.msg="unknown compression method",s.mode=yi;break}if(S>>>=4,x-=4,ue=8+(15&S),s.wbits===0&&(s.wbits=ue),ue>15||ue>s.wbits){r.msg="invalid window size",s.mode=yi;break}s.dmax=1<<s.wbits,s.flags=0,r.adler=s.check=1,s.mode=512&S?16189:dd,S=0,x=0;break;case 16181:for(;x<16;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(s.flags=S,(255&xa(s))!==lX){r.msg="unknown compression method",s.mode=yi;break}if(57344&xa(s)){r.msg="unknown header flags set",s.mode=yi;break}s.head&&(s.head.text=S>>8&1),512&xa(s)&&4&s.wrap&&(Ie[0]=255&S,Ie[1]=S>>>8&255,s.check=Ua(s.check,Ie,2,0)),S=0,x=0,s.mode=16182;case 16182:for(;x<32;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}s.head&&(s.head.time=S),512&xa(s)&&4&s.wrap&&(Ie[0]=255&S,Ie[1]=S>>>8&255,Ie[2]=S>>>16&255,Ie[3]=S>>>24&255,s.check=Ua(s.check,Ie,4,0)),S=0,x=0,s.mode=16183;case 16183:for(;x<16;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}s.head&&(s.head.xflags=255&S,s.head.os=S>>8),512&xa(s)&&4&s.wrap&&(Ie[0]=255&S,Ie[1]=S>>>8&255,s.check=Ua(s.check,Ie,2,0)),S=0,x=0,s.mode=16184;case 16184:if(1024&xa(s)){for(;x<16;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}s.length=S,s.head&&(s.head.extra_len=S),512&xa(s)&&4&s.wrap&&(Ie[0]=255&S,Ie[1]=S>>>8&255,s.check=Ua(s.check,Ie,2,0)),S=0,x=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&xa(s)&&(L=s.length,L>y&&(L=y),L&&(s.head&&(ue=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(l.subarray(f,f+L),ue)),512&xa(s)&&4&s.wrap&&(s.check=Ua(s.check,l,L,f)),y-=L,f+=L,s.length-=L),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&xa(s)){if(y===0)break e;L=0;do ue=l[f+L++],s.head&&ue&&s.length<65536&&(s.head.name+=String.fromCharCode(ue));while(ue&&L<y);if(512&xa(s)&&4&s.wrap&&(s.check=Ua(s.check,l,L,f)),y-=L,f+=L,ue)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&xa(s)){if(y===0)break e;L=0;do ue=l[f+L++],s.head&&ue&&s.length<65536&&(s.head.comment+=String.fromCharCode(ue));while(ue&&L<y);if(512&xa(s)&&4&s.wrap&&(s.check=Ua(s.check,l,L,f)),y-=L,f+=L,ue)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&xa(s)){for(;x<16;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(4&s.wrap&&S!==(65535&s.check)){r.msg="header crc mismatch",s.mode=yi;break}S=0,x=0}s.head&&(s.head.hcrc=xa(s)>>9&1,s.head.done=!0),r.adler=s.check=0,s.mode=dd;break;case 16189:for(;x<32;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}r.adler=s.check=uX(S),S=0,x=0,s.mode=sC;case sC:if(s.havedict===0)return r.next_out=m,r.avail_out=_,r.next_in=f,r.avail_in=y,s.hold=S,s.bits=x,VPe;r.adler=s.check=1,s.mode=dd;case dd:if(a===UPe||a===iC)break e;case s2:if(s.last){S>>>=7&x,x-=7&x,s.mode=c2;break}for(;x<3;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}switch(s.last=1&S,S>>>=1,x-=1,3&S){case 0:s.mode=16193;break;case 1:if(WPe(s),s.mode=oC,a===iC){S>>>=2,x-=2;break e}break;case 2:s.mode=16196;break;case 3:r.msg="invalid block type",s.mode=yi}S>>>=2,x-=2;break;case 16193:for(S>>>=7&x,x-=7&x;x<32;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if((65535&S)!=(S>>>16^65535)){r.msg="invalid stored block lengths",s.mode=yi;break}if(s.length=65535&S,S=0,x=0,s.mode=o2,a===iC)break e;case o2:s.mode=16195;case 16195:if(L=s.length,L){if(L>y&&(L=y),L>_&&(L=_),L===0)break e;d.set(l.subarray(f,f+L),m),y-=L,f+=L,_-=L,m+=L,s.length-=L;break}s.mode=dd;break;case 16196:for(;x<14;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(s.nlen=257+(31&S),S>>>=5,x-=5,s.ndist=1+(31&S),S>>>=5,x-=5,s.ncode=4+(15&S),S>>>=4,x-=4,s.nlen>286||s.ndist>30){r.msg="too many length or distance symbols",s.mode=yi;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;x<3;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}s.lens[Kt[s.have++]]=7&S,S>>>=3,x-=3}for(;s.have<19;)s.lens[Kt[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,Me={bits:s.lenbits},ye=qb(0,s.lens,0,19,s.lencode,0,s.work,Me),s.lenbits=Me.bits,ye){r.msg="invalid code lengths set",s.mode=yi;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;Se=s.lencode[S&(1<<s.lenbits)-1],G=Se>>>24,ne=Se>>>16&255,te=65535&Se,!(G<=x);){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(te<16)S>>>=G,x-=G,s.lens[s.have++]=te;else{if(te===16){for(Gt=G+2;x<Gt;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(S>>>=G,x-=G,s.have===0){r.msg="invalid bit length repeat",s.mode=yi;break}ue=s.lens[s.have-1],L=3+(3&S),S>>>=2,x-=2}else if(te===17){for(Gt=G+3;x<Gt;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}S>>>=G,x-=G,ue=0,L=3+(7&S),S>>>=3,x-=3}else{for(Gt=G+7;x<Gt;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}S>>>=G,x-=G,ue=0,L=11+(127&S),S>>>=7,x-=7}if(s.have+L>s.nlen+s.ndist){r.msg="invalid bit length repeat",s.mode=yi;break}for(;L--;)s.lens[s.have++]=ue}}if(s.mode===yi)break;if(s.lens[256]===0){r.msg="invalid code -- missing end-of-block",s.mode=yi;break}if(s.lenbits=9,Me={bits:s.lenbits},ye=qb(1,s.lens,0,s.nlen,s.lencode,0,s.work,Me),s.lenbits=Me.bits,ye){r.msg="invalid literal/lengths set",s.mode=yi;break}if(s.distbits=6,s.distcode=s.distdyn,Me={bits:s.distbits},ye=qb(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,Me),s.distbits=Me.bits,ye){r.msg="invalid distances set",s.mode=yi;break}if(s.mode=oC,a===iC)break e;case oC:s.mode=cC;case cC:if(y>=6&&_>=258){r.next_out=m,r.avail_out=_,r.next_in=f,r.avail_in=y,s.hold=S,s.bits=x,kPe(r,I),m=r.next_out,d=r.output,_=r.avail_out,f=r.next_in,l=r.input,y=r.avail_in,S=s.hold,x=s.bits,s.mode===dd&&(s.back=-1);break}for(s.back=0;Se=s.lencode[S&(1<<s.lenbits)-1],G=Se>>>24,ne=Se>>>16&255,te=65535&Se,!(G<=x);){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(ne&&!(240&ne)){for(ce=G,pe=ne,fe=te;Se=s.lencode[fe+((S&(1<<ce+pe)-1)>>ce)],G=Se>>>24,ne=Se>>>16&255,te=65535&Se,!(ce+G<=x);){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}S>>>=ce,x-=ce,s.back+=ce}if(S>>>=G,x-=G,s.back+=G,s.length=te,ne===0){s.mode=16205;break}if(32&ne){s.back=-1,s.mode=dd;break}if(64&ne){r.msg="invalid literal/length code",s.mode=yi;break}s.extra=15&ne,s.mode=16201;case 16201:if(s.extra){for(Gt=s.extra;x<Gt;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}s.length+=S&(1<<s.extra)-1,S>>>=s.extra,x-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;Se=s.distcode[S&(1<<s.distbits)-1],G=Se>>>24,ne=Se>>>16&255,te=65535&Se,!(G<=x);){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(!(240&ne)){for(ce=G,pe=ne,fe=te;Se=s.distcode[fe+((S&(1<<ce+pe)-1)>>ce)],G=Se>>>24,ne=Se>>>16&255,te=65535&Se,!(ce+G<=x);){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}S>>>=ce,x-=ce,s.back+=ce}if(S>>>=G,x-=G,s.back+=G,64&ne){r.msg="invalid distance code",s.mode=yi;break}s.offset=te,s.extra=15&ne,s.mode=16203;case 16203:if(s.extra){for(Gt=s.extra;x<Gt;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}s.offset+=S&(1<<s.extra)-1,S>>>=s.extra,x-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){r.msg="invalid distance too far back",s.mode=yi;break}s.mode=16204;case 16204:if(_===0)break e;if(L=I-_,s.offset>L){if(L=s.offset-L,L>s.whave&&s.sane){r.msg="invalid distance too far back",s.mode=yi;break}L>s.wnext?(L-=s.wnext,K=s.wsize-L):K=s.wnext-L,L>s.length&&(L=s.length),$=s.window}else $=d,K=m-s.offset,L=s.length;L>_&&(L=_),_-=L,s.length-=L;do d[m++]=$[K++];while(--L);s.length===0&&(s.mode=cC);break;case 16205:if(_===0)break e;d[m++]=s.length,_--,s.mode=cC;break;case c2:if(s.wrap){for(;x<32;){if(y===0)break e;y--,S|=l[f++]<<x,x+=8}if(I-=_,r.total_out+=I,s.total+=I,4&s.wrap&&I&&(r.adler=s.check=xa(s)?Ua(s.check,d,I,m-I):Vb(s.check,d,I,m-I)),I=_,4&s.wrap&&(xa(s)?S:uX(S))!==s.check){r.msg="incorrect data check",s.mode=yi;break}S=0,x=0}s.mode=16207;case 16207:if(s.wrap&&xa(s)){for(;x<32;){if(y===0)break e;y--,S+=l[f++]<<x,x+=8}if(4&s.wrap&&S!==(4294967295&s.total)){r.msg="incorrect length check",s.mode=yi;break}S=0,x=0}s.mode=16208;case 16208:ye=FPe;break e;case yi:ye=oX;break e;case 16210:return cX;default:return Ec}return r.next_out=m,r.avail_out=_,r.next_in=f,r.avail_in=y,s.hold=S,s.bits=x,(s.wsize||I!==r.avail_out&&s.mode<yi&&(s.mode<c2||a!==sX))&&gX(r,r.output,r.next_out,I-r.avail_out),A-=r.avail_in,I-=r.avail_out,r.total_in+=A,r.total_out+=I,s.total+=I,4&s.wrap&&I&&(r.adler=s.check=xa(s)?Ua(s.check,d,I,r.next_out-I):Vb(s.check,d,I,r.next_out-I)),r.data_type=s.bits+(s.last?64:0)+(s.mode===dd?128:0)+(s.mode===oC||s.mode===o2?256:0),(A===0&&I===0||a===sX)&&ye===xp&&(ye=BPe),ye},hd={inflateReset:hX,inflateReset2:fX,inflateResetKeep:dX,inflateInit:r=>pX(r,15),inflateInit2:pX,inflate:GPe,inflateEnd:r=>{if(Tp(r))return Ec;let a=r.state;return a.window&&(a.window=null),r.state=null,xp},inflateGetHeader:(r,a)=>{if(Tp(r))return Ec;const s=r.state;return 2&s.wrap?(s.head=a,a.done=!1,xp):Ec},inflateSetDictionary:(r,a)=>{const s=a.length;let l,d,f;return Tp(r)?Ec:(l=r.state,l.wrap!==0&&l.mode!==sC?Ec:l.mode===sC&&(d=1,d=Vb(d,a,s,0),d!==l.check)?oX:(f=gX(r,a,s,s),f?(l.mode=16210,cX):(l.havedict=1,xp)))},inflateInfo:"pako inflate (from Nodeca project)"},HPe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const vX=Object.prototype.toString,{Z_NO_FLUSH:zPe,Z_FINISH:KPe,Z_OK:Yb,Z_STREAM_END:d2,Z_NEED_DICT:h2,Z_STREAM_ERROR:qPe,Z_DATA_ERROR:yX,Z_MEM_ERROR:YPe}=XT;function lC(r){this.options=QT.assign({chunkSize:65536,windowBits:15,to:""},r||{});const a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),!(a.windowBits>=0&&a.windowBits<16)||r&&r.windowBits||(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&!(15&a.windowBits)&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iX,this.strm.avail_out=0;let s=hd.inflateInit2(this.strm,a.windowBits);if(s!==Yb)throw new Error(bp[s]);if(this.header=new HPe,hd.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=Kb.string2buf(a.dictionary):vX.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(s=hd.inflateSetDictionary(this.strm,a.dictionary),s!==Yb)))throw new Error(bp[s])}function XPe(r,a){const s=new lC(a);if(s.push(r),s.err)throw s.msg||bp[s.err];return s.result}lC.prototype.push=function(r,a){const s=this.strm,l=this.options.chunkSize,d=this.options.dictionary;let f,m,y;if(this.ended)return!1;for(m=a===~~a?a:a===!0?KPe:zPe,vX.call(r)==="[object ArrayBuffer]"?s.input=new Uint8Array(r):s.input=r,s.next_in=0,s.avail_in=s.input.length;;){for(s.avail_out===0&&(s.output=new Uint8Array(l),s.next_out=0,s.avail_out=l),f=hd.inflate(s,m),f===h2&&d&&(f=hd.inflateSetDictionary(s,d),f===Yb?f=hd.inflate(s,m):f===yX&&(f=h2));s.avail_in>0&&f===d2&&s.state.wrap>0&&r[s.next_in]!==0;)hd.inflateReset(s),f=hd.inflate(s,m);switch(f){case qPe:case yX:case h2:case YPe:return this.onEnd(f),this.ended=!0,!1}if(y=s.avail_out,s.next_out&&(s.avail_out===0||f===d2))if(this.options.to==="string"){let _=Kb.utf8border(s.output,s.next_out),S=s.next_out-_,x=Kb.buf2string(s.output,_);s.next_out=S,s.avail_out=l-S,S&&s.output.set(s.output.subarray(_,_+S),0),this.onData(x)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(f!==Yb||y!==0){if(f===d2)return f=hd.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,!0;if(s.avail_in===0)break}}return!0},lC.prototype.onData=function(r){this.chunks.push(r)},lC.prototype.onEnd=function(r){r===Yb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=QT.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var JPe={inflate:XPe};const{deflate:ZPe}=PPe,{inflate:QPe}=JPe;var eke=ZPe,tke=QPe,_X=function(r){return r[r.ONE_BYTE=0]="ONE_BYTE",r[r.TWO_BYTE=1]="TWO_BYTE",r}(_X||{});class nke{constructor(){Q(this,"_sequence",0),Q(this,"_startTime",Date.now()),Q(this,"isUseOneByte",!0)}get startTime(){const a=Date.now()-this._startTime;return a<Math.pow(2,16)?a:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(a){const s={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:a};if(a.byteLength>128){const y=new Uint8Array(4);y.set([1,0,0,0]);const _={id:0,length:4,data:y.buffer},S={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[_]};s.commonPacketHeader.extension=1,s.extension=S,s.payload=this.compress(a),s.commonPacketHeader.length=8+(s.extension.length+2)+s.payload.byteLength}else s.commonPacketHeader.length=8+s.payload.byteLength;oe("SHOW_DATASTREAM2_LOG")&&V.debug("send data header: ".concat(JSON.stringify(s.commonPacketHeader)));const l=new ArrayBuffer(s.commonPacketHeader.length),d=new Uint8Array(l),f=new DataView(l);let m=0;if(f.setUint16(m,s.commonPacketHeader.extension<<15|s.commonPacketHeader.reserved<<14|s.commonPacketHeader.length,!0),m+=2,f.setUint32(m,s.commonPacketHeader.sequence,!0),m+=4,f.setUint16(m,s.commonStreamHeader,!0),m+=2,s.extension){const y=this.serializeExtension(s.extension);d.set(new Uint8Array(y),m),m+=y.byteLength}if(d.set(new Uint8Array(s.payload),m),m+=s.payload.byteLength,m!==s.commonPacketHeader.length)throw Error("serialize error!");return l}deserialize(a){if(a.byteLength<4)return new ArrayBuffer(0);const s=new DataView(a);let l=0;const d=s.getUint16(l,!0);l+=2;const f={length:16383&d,reserved:(16384&d)>>14,extension:(32768&d)>>15,sequence:s.getUint16(l+2,!0)<<16|s.getUint16(l,!0)};let m,y;if(l+=4,oe("SHOW_DATASTREAM2_LOG")&&V.debug("receive data header: ".concat(JSON.stringify(f))),s.getUint16(l,!0),l+=2,f.extension){y=this.deserializeExtension(a.slice(l)),l+=2+y.length,m=a.slice(l);let _=!1;if(y.datas.length>0){const S=y.datas.find(x=>x.id===0);S&&(_=(1&new DataView(S.data).getUint32(0,!0))==1)}m=_?this.decompress(m):m}else m=a.slice(8);return m}serializeExtension(a){const{profile:s,length:l,datas:d}=a,f=new ArrayBuffer(l+2),m=new Uint8Array(f),y=new DataView(f);let _=0;if(y.setUint8(_++,s),y.setUint8(_++,l),d.forEach(S=>{s?(y.setUint8(_++,S.id),y.setUint8(_++,S.length),m.set(new Uint8Array(S.data),_),_+=S.data.byteLength):(y.setUint8(_++,S.id|S.length<<4),m.set(new Uint8Array(S.data),_),_+=S.data.byteLength)}),_!==l+2)throw Error("serialize extension error, is ".concat(_,"!==").concat(l+2));return f}deserializeExtension(a){const s=new DataView(a);let l=0;const d=s.getUint8(l);l++;const f=s.getUint8(l);l++;const m=d===_X.TWO_BYTE,y=[],_=new DataView(a,2);let S=0;for(;S<f;){let x=0,A=0,I=new ArrayBuffer(0);m?(x=_.getUint8(S),S++,A=_.getUint8(S),S++):(x=15&_.getUint8(S),A=_.getUint8(S)>>4,S++),A>0&&(I=_.buffer.slice(S+2,S+2+A),S+=I.byteLength),y.push({id:x,length:A,data:I})}if(S!==f)throw Error("parse error");return{profile:d,length:f,datas:y}}decompress(a){return tke(new Uint8Array(a))}compress(a){return eke(new Uint8Array(a))}}const rke={name:"DataStream",create:(r,a)=>{const s=a?new dIe(r):new hIe(r);return s.useDataStream(new nke),s}};class ike extends cr{constructor(a,s,l){super(),Q(this,"ws",void 0),Q(this,"requestId",1),Q(this,"heartBeatTimer",void 0),Q(this,"joinInfo",void 0),Q(this,"clientId",void 0),Q(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),Q(this,"onClose",d=>{this.emit("close"),this.dispose()}),Q(this,"onMessage",d=>{const f=JSON.parse(d.data);if(!f||f.command!=="serverResponse"||!f.requestId)return f&&f.command==="serverStatus"&&f.serverStatus&&f.serverStatus.command?(this.emit("status",f.serverStatus),void this.emit(f.serverStatus.command,f.serverStatus)):void 0;this.emit("req_".concat(f.requestId),f)}),this.joinInfo=a,this.clientId=s,this.ws=new Eb("cross-channel-".concat(this.clientId),l),this.ws.on(Bt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(Bt.CONNECTED,this.onOpen),this.ws.on(Bt.ON_MESSAGE,this.onMessage),this.ws.on(Bt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(a){const s=this.requestId++;return a.requestId=s,a.seq=s,this.ws.sendMessage(a),s}waitStatus(a){return new He((s,l)=>{const d=window.setTimeout(()=>{l(new Ee(ie.TIMEOUT,"wait status timeout, status: ".concat(a)))},5e3);this.once(a,f=>{window.clearTimeout(d),f.state&&f.state!==0?l(new Ee(ie.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(a))):s(void 0)}),this.once("dispose",()=>{window.clearTimeout(d),l(new Ee(ie.WS_ABORT))})})}async request(a){if(this.ws.state==="closed")throw new Ee(ie.WS_DISCONNECT);const s=()=>new He((m,y)=>{this.ws.once(Bt.CLOSED,()=>y(new Ee(ie.WS_ABORT))),this.ws.once(Bt.CONNECTED,m)});this.ws.state!=="connected"&&await s();const l=this.sendMessage(a),d=new He((m,y)=>{const _=()=>{y(new Ee(ie.WS_ABORT))};this.ws.once(Bt.RECONNECTING,_),this.ws.once(Bt.CLOSED,_),this.once("req_".concat(l),m),Ti(3e3).then(()=>{this.removeAllListeners("req_".concat(l)),this.ws.off(Bt.RECONNECTING,_),this.ws.off(Bt.CLOSED,_),y(new Ee(ie.TIMEOUT,"cross channel ws request timeout"))})}),f=await d;if(!f||f.code!==200)throw new Ee(ie.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(f)));return f}async connect(a){this.ws.removeAllListeners(Bt.REQUEST_NEW_URLS),this.ws.on(Bt.REQUEST_NEW_URLS,s=>{s(a)}),await this.ws.init(a)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(a){const s=this.requestId++;return a.requestId=s,this.ws.sendMessage(a),s}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class ake extends cr{set state(a){a!==this._state&&(a!==cs.RELAY_STATE_FAILURE&&(this.errorCode=jg.RELAY_OK),this.emit("state",a,this.errorCode),this._state=a)}get state(){return this._state}constructor(a,s,l,d,f){super(),Q(this,"joinInfo",void 0),Q(this,"sid",void 0),Q(this,"clientId",void 0),Q(this,"cancelToken",Ka.CancelToken.source()),Q(this,"workerToken",void 0),Q(this,"requestId",0),Q(this,"signal",void 0),Q(this,"prevChannelMediaConfig",void 0),Q(this,"httpRetryConfig",void 0),Q(this,"_resolution",void 0),Q(this,"_state",cs.RELAY_STATE_IDLE),Q(this,"errorCode",jg.RELAY_OK),Q(this,"onStatus",m=>{V.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(m))),m&&m.command&&(m.command==="onAudioPacketReceived"&&this.emit("event",sd.PACKET_RECEIVED_AUDIO_FROM_SRC),m.command==="onVideoPacketReceived"&&this.emit("event",sd.PACKET_RECEIVED_VIDEO_FROM_SRC),m.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=jg.SRC_TOKEN_EXPIRED,this.state=cs.RELAY_STATE_FAILURE),m.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=jg.DEST_TOKEN_EXPIRED,this.state=cs.RELAY_STATE_FAILURE))}),Q(this,"onReconnect",async()=>{V.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",sd.NETWORK_DISCONNECTED),this.state=cs.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(m=>{this.state!==cs.RELAY_STATE_IDLE&&(V.error("auto restart channel media relay failed",m.toString()),this.errorCode=jg.SERVER_CONNECTION_LOST,this.state=cs.RELAY_STATE_FAILURE)})}),this.joinInfo=a,this.clientId=s,this.sid=sp(),this.signal=new ike(this.joinInfo,this.clientId,l),this.httpRetryConfig=d,this._resolution=f}async startChannelMediaRelay(a){if(this.state!==cs.RELAY_STATE_IDLE)throw new Ee(ie.INVALID_OPERATION);this.state=cs.RELAY_STATE_CONNECTING,await this.connect(),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(a)}catch(s){throw s.data&&s.data.serverResponse&&s.data.serverResponse.command==="SetSourceChannel"?new Ee(ie.CROSS_CHANNEL_FAILED_JOIN_SRC):s.data&&s.data.serverResponse&&s.serverResponse.command==="SetDestChannelStatus"?new Ee(ie.CROSS_CHANNEL_FAILED_JOIN_DEST):s.data&&s.data.serverResponse&&s.serverResponse.command==="StartPacketTransfer"?new Ee(ie.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):s}this.prevChannelMediaConfig=a}async updateChannelMediaRelay(a){if(this.state!==cs.RELAY_STATE_RUNNING)throw new Ee(ie.INVALID_OPERATION);await this.sendUpdateMessage(a),this.prevChannelMediaConfig=a}async setVideoProfile(a){if(this._resolution=a,this.state!==cs.RELAY_STATE_RUNNING)throw new Ee(ie.INVALID_OPERATION);const s=this.genMessage(Ma.SetVideoProfile);await this.signal.request(s),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),V.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=cs.RELAY_STATE_IDLE,this.dispose()}dispose(){V.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Ka.CancelToken.source(),this.state=cs.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const a=await vOe(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=a.workerToken,await this.signal.connect(a.addressList),this.emit("event",sd.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(a){const s=this.genMessage(Ma.StopPacketTransfer);await this.signal.request(s),await this.signal.waitStatus("Normal Quit"),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const l=this.genMessage(Ma.SetSdkProfile,a);await this.signal.request(l),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const d=this.genMessage(Ma.SetSourceChannel,a);await this.signal.request(d),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",sd.PACKET_JOINED_SRC_CHANNEL),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const f=this.genMessage(Ma.SetSourceUserId,a);await this.signal.request(f),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const m=this.genMessage(Ma.SetDestChannel,a);await this.signal.request(m),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",sd.PACKET_JOINED_DEST_CHANNEL),V.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const y=this.genMessage(Ma.StartPacketTransfer,a);await this.signal.request(y),this.emit("event",sd.PACKET_SENT_TO_DEST_CHANNEL),this.state=cs.RELAY_STATE_RUNNING,V.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(a){const s=this.genMessage(Ma.UpdateDestChannel,a);await this.signal.request(s),this.emit("event",sd.PACKET_UPDATE_DEST_CHANNEL),V.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const a=this.genMessage(Ma.StopPacketTransfer);await this.signal.request(a),V.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(a,s){const l=[],d=[],f=[];this.requestId+=1;const m={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:xo,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};m.sdkVersion==="4.24.0"&&(m.sdkVersion="0.0.1");let y=null,_=null;switch(a){case Ma.SetSdkProfile:return m.clientRequest={command:"SetSdkProfile",type:"multi_channel"},m;case Ma.SetSourceChannel:if(_=s&&s.getSrcChannelMediaInfo(),!_)throw new Ee(ie.UNEXPECTED_ERROR,"can not find source config");return m.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_.channelName,token:_.token||this.joinInfo.appId},m;case Ma.SetSourceUserId:if(_=s&&s.getSrcChannelMediaInfo(),!_)throw new Ee(ie.UNEXPECTED_ERROR,"can not find source config");return m.clientRequest={command:"SetSourceUserId",uid:_.uid+""},m;case Ma.SetDestChannel:if(y=s&&s.getDestChannelMediaInfo(),!y)throw new Ee(ie.UNEXPECTED_ERROR,"can not find dest config");return y.forEach(S=>{l.push(S.channelName),d.push(S.uid+""),f.push(S.token||this.joinInfo.appId)}),m.clientRequest={command:"SetDestChannel",channelName:l,uid:d,token:f},m;case Ma.StartPacketTransfer:return m.clientRequest={command:"StartPacketTransfer"},m;case Ma.Reconnect:return m.clientRequest={command:"Reconnect"},m;case Ma.StopPacketTransfer:return m.clientRequest={command:"StopPacketTransfer"},m;case Ma.UpdateDestChannel:if(y=s&&s.getDestChannelMediaInfo(),!y)throw new Ee(ie.UNEXPECTED_ERROR,"can not find dest config");return y.forEach(S=>{l.push(S.channelName),d.push(S.uid+""),f.push(S.token||this.joinInfo.appId)}),m.clientRequest={command:"UpdateDestChannel",channelName:l,uid:d,token:f},m;case Ma.SetVideoProfile:m.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return m}}const ske={name:"ChannelMediaRelay",create:function(r){return new ake(r.joinInfo,r.clientId,r.websocketRetryConfig||Gr,r.httpRetryConfig||Gr,r.resolution)}};function bX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Xb(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?bX(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):bX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class oke extends cr{constructor(a,s,l,d){super(),Q(this,"spec",void 0),Q(this,"token",void 0),Q(this,"websocket",void 0),Q(this,"pingpongTimer",void 0),Q(this,"reconnectMode","retry"),Q(this,"serviceMode",void 0),Q(this,"reqId",0),Q(this,"commandReqId",0),Q(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),Q(this,"handleWebSocketMessage",f=>{if(!f.data)return;const m=JSON.parse(f.data);m.requestId?this.emit("@".concat(m.requestId,"-").concat(m.sid),m):(it.workerEvent(this.spec.sid,{actionType:"status",serverCode:m.code,workerType:this.serviceMode===ad.TRANSCODE?1:2}),this.emit(ph.PUBLISH_STREAM_STATUS,m))}),this.spec=s,this.token=a,this.serviceMode=d,this.websocket=new Eb("live-streaming",l),this.websocket.on(Bt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(Bt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(Bt.REQUEST_NEW_URLS,(f,m)=>{Li(this,ph.REQUEST_NEW_ADDRESS).then(f).catch(m)}),this.websocket.on(Bt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(a){return this.websocket.init(a)}async request(a,s,l,d){this.reqId+=1,a==="request"&&(this.commandReqId+=1);const f=this.commandReqId,m=this.reqId;if(!m||!this.websocket)throw new Ee(ie.UNEXPECTED_ERROR);const y=Xb({command:a,sdkVersion:xo==="4.24.0"?"0.0.1":xo,seq:m,requestId:m,allocate:l,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},s);if(this.websocket.state==="closed")throw new Ee(ie.WS_DISCONNECT);const _=()=>new He((I,L)=>{this.websocket.once(Bt.CLOSED,()=>L(new Ee(ie.WS_ABORT))),this.websocket.once(Bt.CONNECTED,I)});this.websocket.state!=="connected"&&await _(),y.clientRequest&&(y.clientRequest.workerToken=this.token);const S=new He((I,L)=>{const K=()=>{L(new Ee(ie.WS_ABORT))};this.websocket.once(Bt.RECONNECTING,K),this.websocket.once(Bt.CLOSED,K),this.once("@".concat(m,"-").concat(this.spec.sid),$=>{I($)})});d&&it.workerEvent(this.spec.sid,Xb(Xb({},d),{},{requestId:f,actionType:"request",payload:JSON.stringify(s.clientRequest),serverCode:0,code:0}));const x=Date.now();this.websocket.sendMessage(y);let A=null;try{A=await S}catch(I){if(this.websocket.state==="closed")throw I;return await _(),await this.request(a,s,l)}return d&&it.workerEvent(this.spec.sid,Xb(Xb({},d),{},{requestId:f,actionType:"response",payload:JSON.stringify(A.serverResponse),serverCode:A.code,success:A.code===200,responseTime:Date.now()-x})),A.code!==200&&this.handleResponseError(A),A}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const a=xo==="4.24.0"?"0.0.1":xo;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:a,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(a){switch(a.code){case Xr.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void V.warning("live stream response already exists stream");case Xr.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Xr.LIVE_STREAM_RESPONSE_BAD_STREAM:case Xr.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new Ee(ie.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(a.serverResponse.command==="UnpublishStream")return;throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Xr.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new Ee(ie.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const s=new Ee(ie.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(ph.WARNING,s,a.serverResponse.url)}case Xr.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const s=new Ee(ie.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(ph.WARNING,s,a.serverResponse.url)}case Xr.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Xr.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new Ee(ie.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const s=new Ee(ie.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(ph.WARNING,s,a.serverResponse.url)}case Xr.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:a.code}).throw();case Xr.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Xr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Xr.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(a.serverResponse.command==="UnpublishStream")return;throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Xr.ERROR_FAIL_SEND_MESSAGE:if(a.serverResponse.command==="UnpublishStream")return;if(a.serverResponse.command==="UpdateTranscoding"||a.serverResponse.command==="ControlStream")return new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:a.code}).throw();throw new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Xr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new Ee(ie.LIVE_STREAMING_CDN_ERROR,"",{code:a.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(qx)},6e3)}}function EX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function ls(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?EX(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):EX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class cke extends cr{constructor(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gr,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gr;super(),Q(this,"onLiveStreamWarning",void 0),Q(this,"onLiveStreamError",void 0),Q(this,"spec",void 0),Q(this,"retryTimeout",1e4),Q(this,"connection",void 0),Q(this,"httpRetryConfig",void 0),Q(this,"wsRetryConfig",void 0),Q(this,"streamingTasks",new Map),Q(this,"isStartingStreamingTask",!1),Q(this,"taskMutex",new Hi("live-streaming")),Q(this,"cancelToken",Ka.CancelToken.source()),Q(this,"transcodingConfig",void 0),Q(this,"uapResponse",void 0),Q(this,"lastTaskId",1),Q(this,"statusError",new Map),this.spec=a,this.httpRetryConfig=l,this.wsRetryConfig=s}async setTranscodingConfig(a){const s=ls(ls({},YIe),a);s.videoCodecProfile!==66&&s.videoCodecProfile!==77&&s.videoCodecProfile!==100&&(V.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(s.videoCodecProfile," -> 100")),s.videoCodecProfile=100),s.transcodingUsers||(s.transcodingUsers=s.userConfigs),s.transcodingUsers&&(s.transcodingUsers=s.transcodingUsers.map(m=>ls(ls(ls({},qIe),m),{},{zOrder:m.zOrder?m.zOrder+1:1}))),function(m){hr(m.width)||kn(m.width,"config.width",0,1e4),hr(m.height)||kn(m.height,"config.height",0,1e4),hr(m.videoBitrate)||kn(m.videoBitrate,"config.videoBitrate",1,1e6),hr(m.videoFrameRate)||kn(m.videoFrameRate,"config.videoFrameRate"),hr(m.lowLatency)||el(m.lowLatency,"config.lowLatency"),hr(m.audioSampleRate)||ri(m.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),hr(m.audioBitrate)||kn(m.audioBitrate,"config.audioBitrate",1,128),hr(m.audioChannels)||ri(m.audioChannels,"config.audioChannels",[1,2,3,4,5]),hr(m.videoGop)||kn(m.videoGop,"config.videoGop"),hr(m.videoCodecProfile)||ri(m.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),hr(m.userCount)||kn(m.userCount,"config.userCount",0,17),hr(m.backgroundColor)||kn(m.backgroundColor,"config.backgroundColor",0,16777215),hr(m.userConfigExtraInfo)||xi(m.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),m.transcodingUsers&&!hr(m.transcodingUsers)&&(id(m.transcodingUsers,"config.transcodingUsers"),m.transcodingUsers.forEach((y,_)=>{yT(y.uid),hr(y.x)||kn(y.x,"transcodingUser[".concat(_,"].x"),0,1e4),hr(y.y)||kn(y.y,"transcodingUser[".concat(_,"].y"),0,1e4),hr(y.width)||kn(y.width,"transcodingUser[".concat(_,"].width"),0,1e4),hr(y.height)||kn(y.height,"transcodingUser[".concat(_,"].height"),0,1e4),hr(y.zOrder)||kn(y.zOrder-1,"transcodingUser[".concat(_,"].zOrder"),0,100),hr(y.alpha)||kn(y.alpha,"transcodingUser[".concat(_,"].alpha"),0,1,!1)})),hr(m.watermark)||dD(m.watermark,"watermark"),hr(m.backgroundImage)||dD(m.backgroundImage,"backgroundImage"),m.images&&!hr(m.images)&&(id(m.images,"config.images"),m.images.forEach((y,_)=>{dD(y,"images[".concat(_,"]"))}))}(s);const l=[];s.images&&l.push(...s.images.map(m=>ls(ls(ls({},uD),m),{},{zOrder:255}))),s.backgroundImage&&(l.push(ls(ls(ls({},uD),s.backgroundImage),{},{zOrder:0})),delete s.backgroundImage),s.watermark&&(l.push(ls(ls(ls({},uD),s.watermark),{},{zOrder:255})),delete s.watermark),s.images=l,s.transcodingUsers&&(s.userConfigs=s.transcodingUsers.map(m=>ls({},m)),s.userCount=s.transcodingUsers.length,delete s.transcodingUsers);const d=(s.userConfigs||[]).map(m=>typeof m.uid=="number"?He.resolve(m.uid):zK(m.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await He.all(d)).forEach((m,y)=>{s.userConfigs&&s.userConfigs[y]&&(s.userConfigs[y].uid=m)}),this.transcodingConfig=s,this.connection)try{var f;const m=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Cs(f=this.streamingTasks).call(f)).map(y=>y.taskId).join("#")});V.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(m.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(m){if(!m.data||!m.data.retry)throw m;m.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(y=>{V.warning("[".concat(this.spec.clientId,"] live streaming receive error"),m.toString(),"try to republish",y.url),this.startLiveStreamingTask(y.url,y.mode,m).then(()=>{V.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(y.url," success"))}).catch(_=>{V.error("[".concat(this.spec.clientId,"] live streaming republish failed"),y.url,_.toString()),this.onLiveStreamError&&this.onLiveStreamError(y.url,_)})})}}async startLiveStreamingTask(a,s,l){if(!this.transcodingConfig&&s===ad.TRANSCODE)throw new Ee(ie.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const d={command:"PublishStream",ts:Date.now(),url:a,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};V.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(a,", mode: ").concat(s));const f=await this.taskMutex.lock();if(!this.connection&&l)return void f();if(this.streamingTasks.get(a)&&!l)return f(),new Ee(ie.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(s))}catch(y){throw f(),y}switch(s){case ad.TRANSCODE:d.transcodingConfig=ls({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(d.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const m=this.lastTaskId++;try{const y=new He((S,x)=>{Ti(this.retryTimeout).then(()=>{if(l)return x(l);const A=this.statusError.get(a);return A?(this.statusError.delete(a),x(A)):void 0})}),_=await He.race([this.connection.request("request",{clientRequest:d},!0,{url:a,command:"PublishStream",workerType:s===ad.TRANSCODE?1:2,requestByUser:!l,tid:m.toString()}),y]);this.isStartingStreamingTask=!1,V.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_.code)),this.streamingTasks.set(a,{clientRequest:d,mode:s,url:a,taskId:m}),f()}catch(y){if(f(),this.isStartingStreamingTask=!1,!y.data||!y.data.retry||l)throw y;return y.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(a,s,y)):await this.startLiveStreamingTask(a,s,y)}}stopLiveStreamingTask(a){return new He((s,l)=>{const d=this.streamingTasks.get(a);if(!d||!this.connection)return new Ee(ie.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const f=d.mode;d.abortTask=()=>{V.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(a),s()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:d.url}},!1,{url:a,command:"UnPublishStream",workerType:f===ad.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(m=>{V.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(m.code)),this.streamingTasks.delete(a),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),s()}).catch(l)})}resetAllTask(){var a;const s=Array.from(Cs(a=this.streamingTasks).call(a));this.terminate();for(const l of s)this.startLiveStreamingTask(l.url,l.mode).catch(d=>{this.onLiveStreamError&&this.onLiveStreamError(l.url,d)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Ka.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(a){if(this.connection)throw new Ee(ie.UNEXPECTED_ERROR,"live streaming connection has already connected");const s=await Li(this,hD.REQUEST_WORKER_MANAGER_LIST,a);return this.uapResponse=s,this.connection=new oke(s.workerToken,this.spec,this.wsRetryConfig,a),this.connection.on(ph.WARNING,(l,d)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(d,l)),this.connection.on(ph.PUBLISH_STREAM_STATUS,l=>this.handlePublishStreamServer(l)),this.connection.on(ph.REQUEST_NEW_ADDRESS,(l,d)=>{if(!this.connection)return d(new Ee(ie.UNEXPECTED_ERROR,"can not get new live streaming address list"));Li(this,hD.REQUEST_WORKER_MANAGER_LIST,a).then(f=>{this.uapResponse=f,l(f.addressList)}).catch(d)}),await this.connection.init(s.addressList),this.connection}handlePublishStreamServer(a){const s=a.serverStatus&&a.serverStatus.url||"empty_url",l=this.streamingTasks.get(s),d=a.reason;switch(a.code){case Xr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Xr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const m=new Ee(ie.LIVE_STREAMING_CDN_ERROR,"",{code:a.code});if(l)return V.error(m.toString()),this.onLiveStreamError&&this.onLiveStreamError(s,m);if(!this.isStartingStreamingTask)return;this.statusError.set(s,m)}case Xr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const m=new Ee(ie.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,d);return this.onLiveStreamWarning&&this.onLiveStreamWarning(s,m)}case Xr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Xr.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var f;if(!this.connection)return;this.connection.tryNextAddress();const m=Array.from(Cs(f=this.streamingTasks).call(f));for(const y of m)y.abortTask?y.abortTask():(V.warning("[".concat(this.spec.clientId,"] publish stream status code"),a.code,"try to republish",y.url),this.startLiveStreamingTask(y.url,y.mode,new Ee(ie.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:a.code})).then(()=>{V.debug("[".concat(this.spec.clientId,"] republish live stream success"),y.url)}).catch(_=>{V.error(_.toString()),this.onLiveStreamError&&this.onLiveStreamError(y.url,_)}));return}}}hasUrl(a){return this.streamingTasks.has(a)}}const lke={name:"LiveStreaming",create:function(r){return new cke(r.joinInfo,r.websocketRetryConfig||Gr,r.httpRetryConfig||Gr)}};function uke(r){let a=xX();return function(s,l){let d=s.appId;d!==void 0&&(Cn(l,10),hu(l,d));let f=s.cid;f!==void 0&&(Cn(l,16),Cn(l,f));let m=s.cname;m!==void 0&&(Cn(l,26),hu(l,m));let y=s.deviceId;y!==void 0&&(Cn(l,34),hu(l,y));let _=s.elapse;_!==void 0&&(Cn(l,40),Ih(l,_));let S=s.fileSize;S!==void 0&&(Cn(l,48),Ih(l,Jg(S)));let x=s.height;x!==void 0&&(Cn(l,56),Ih(l,Jg(x)));let A=s.jpg;A!==void 0&&(Cn(l,66),Cn(l,A.length),function(Xi,Re){let Ve=Zg(Xi,Re.length);Xi.bytes.set(Re,Ve)}(l,A));let I=s.networkType;I!==void 0&&(Cn(l,72),Ih(l,Jg(I)));let L=s.osType;L!==void 0&&(Cn(l,80),Ih(l,Jg(L)));let K=s.requestId;K!==void 0&&(Cn(l,90),hu(l,K));let $=s.sdkVersion;$!==void 0&&(Cn(l,98),hu(l,$));let G=s.sequence;G!==void 0&&(Cn(l,104),Ih(l,Jg(G)));let ne=s.sid;ne!==void 0&&(Cn(l,114),hu(l,ne));let te=s.timestamp;te!==void 0&&(Cn(l,120),Ih(l,te));let ce=s.uid;ce!==void 0&&(Cn(l,128),Cn(l,ce));let pe=s.vid;pe!==void 0&&(Cn(l,136),Cn(l,pe));let fe=s.width;fe!==void 0&&(Cn(l,144),Ih(l,Jg(fe)));let ue=s.service;ue!==void 0&&(Cn(l,152),Cn(l,ue));let ye=s.callbackData;ye!==void 0&&(Cn(l,162),hu(l,ye));let Se=s.jpgEncryption;Se!==void 0&&(Cn(l,168),Cn(l,Se));let Ie=s.requestType;Ie!==void 0&&(Cn(l,176),Cn(l,Ie));let Me=s.scorePorn;Me!==void 0&&(Cn(l,185),v2(l,Me));let Gt=s.scoreSexy;Gt!==void 0&&(Cn(l,193),v2(l,Gt));let Kt=s.scoreNeutral;Kt!==void 0&&(Cn(l,201),v2(l,Kt));let Nt=s.scene;Nt!==void 0&&(Cn(l,208),Cn(l,Nt));let bn=s.ossFilePrefix;bn!==void 0&&(Cn(l,218),hu(l,bn));let vn=s.serviceVendor;if(vn!==void 0)for(let Xi of vn){Cn(l,226);let Re=xX();fke(Xi,Re),Cn(l,Re.limit),vke(l,Re),gke(Re)}}(r,a),function(s){let l=s.bytes,d=s.limit;return l.length===d?l:l.subarray(0,d)}(a)}function dke(r){return function(s){let l={};e:for(;!TX(s);){let d=fu(s);switch(d>>>3){case 0:break e;case 1:l.code=fu(s);break;case 2:l.msg=CX(s,fu(s));break;case 3:{let f=pke(s);l.data=hke(s),s.limit=f;break}default:wX(s,7&d)}}return l}({bytes:a=r,offset:0,limit:a.length});var a}function hke(r){let a={};e:for(;!TX(r);){let s=fu(r);switch(s>>>3){case 0:break e;case 1:a.requestId=CX(r,fu(r));break;case 2:a.requestType=fu(r)>>>0;break;case 3:a.scorePorn=g2(r);break;case 4:a.scoreSexy=g2(r);break;case 5:a.scoreNeutral=g2(r);break;case 6:a.requestScene=fu(r)>>>0;break;case 7:a.scene=fu(r)>>>0;break;default:wX(r,7&s)}}return a}function fke(r,a){let s=r.service;s!==void 0&&(Cn(a,8),Cn(a,s));let l=r.vendor;l!==void 0&&(Cn(a,16),Cn(a,l));let d=r.token;d!==void 0&&(Cn(a,26),hu(a,d));let f=r.callbackUrl;f!==void 0&&(Cn(a,34),hu(a,f))}function pke(r){let a=fu(r),s=r.limit;return r.limit=r.offset+a,s}function wX(r,a){switch(a){case 0:for(;128&RX(r););break;case 2:p2(r,fu(r));break;case 5:p2(r,4);break;case 1:p2(r,8);break;default:throw new Error("Unimplemented type: "+a)}}let mke=new Float32Array(1);new Uint8Array(mke.buffer);let f2=new Float64Array(1),us=new Uint8Array(f2.buffer);function Jg(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}let SX=[];function xX(){const r=SX.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}function gke(r){SX.push(r)}function p2(r,a){if(r.offset+a>r.limit)throw new Error("Skip past limit");r.offset+=a}function TX(r){return r.offset>=r.limit}function Zg(r,a){let s=r.bytes,l=r.offset,d=r.limit,f=l+a;if(f>s.length){let m=new Uint8Array(2*f);m.set(s),r.bytes=m}return r.offset=f,f>d&&(r.limit=f),l}function m2(r,a){let s=r.offset;if(s+a>r.limit)throw new Error("Read past limit");return r.offset+=a,s}function CX(r,a){let s=m2(r,a),l=String.fromCharCode,d=r.bytes,f="�",m="";for(let y=0;y<a;y++){let _,S,x,A,I=d[y+s];128&I?(224&I)==192?y+1>=a?m+=f:(_=d[y+s+1],(192&_)!=128?m+=f:(A=(31&I)<<6|63&_,A<128?m+=f:(m+=l(A),y++))):(240&I)==224?y+2>=a?m+=f:(_=d[y+s+1],S=d[y+s+2],(49344&(_|S<<8))!=32896?m+=f:(A=(15&I)<<12|(63&_)<<6|63&S,A<2048||A>=55296&&A<=57343?m+=f:(m+=l(A),y+=2))):(248&I)==240?y+3>=a?m+=f:(_=d[y+s+1],S=d[y+s+2],x=d[y+s+3],(12632256&(_|S<<8|x<<16))!=8421504?m+=f:(A=(7&I)<<18|(63&_)<<12|(63&S)<<6|63&x,A<65536||A>1114111?m+=f:(A-=65536,m+=l(55296+(A>>10),56320+(1023&A)),y+=3))):m+=f:m+=l(I)}return m}function hu(r,a){let s=a.length,l=0;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),l+=y<128?1:y<2048?2:y<65536?3:4}Cn(r,l);let d=Zg(r,l),f=r.bytes;for(let m=0;m<s;m++){let y=a.charCodeAt(m);y>=55296&&y<=56319&&m+1<s&&(y=(y<<10)+a.charCodeAt(++m)-56613888),y<128?f[d++]=y:(y<2048?f[d++]=y>>6&31|192:(y<65536?f[d++]=y>>12&15|224:(f[d++]=y>>18&7|240,f[d++]=y>>12&63|128),f[d++]=y>>6&63|128),f[d++]=63&y|128)}}function vke(r,a){let s=Zg(r,a.limit),l=r.bytes,d=a.bytes;for(let f=0,m=a.limit;f<m;f++)l[f+s]=d[f]}function RX(r){return r.bytes[m2(r,1)]}function NX(r,a){let s=Zg(r,1);r.bytes[s]=a}function g2(r){let a=m2(r,8),s=r.bytes;return us[0]=s[a++],us[1]=s[a++],us[2]=s[a++],us[3]=s[a++],us[4]=s[a++],us[5]=s[a++],us[6]=s[a++],us[7]=s[a++],f2[0]}function v2(r,a){let s=Zg(r,8),l=r.bytes;f2[0]=a,l[s++]=us[0],l[s++]=us[1],l[s++]=us[2],l[s++]=us[3],l[s++]=us[4],l[s++]=us[5],l[s++]=us[6],l[s++]=us[7]}function fu(r){let a,s=0,l=0;do a=RX(r),s<32&&(l|=(127&a)<<s),s+=7;while(128&a);return l}function Cn(r,a){for(a>>>=0;a>=128;)NX(r,127&a|128),a>>>=7;NX(r,a)}function Ih(r,a){let s=a.low>>>0,l=(a.low>>>28|a.high<<4)>>>0,d=a.high>>>24,f=d===0?l===0?s<16384?s<128?1:2:s<1<<21?3:4:l<16384?l<128?5:6:l<1<<21?7:8:d<128?9:10,m=Zg(r,f),y=r.bytes;switch(f){case 10:y[m+9]=d>>>7&1;case 9:y[m+8]=f!==9?128|d:127&d;case 8:y[m+7]=f!==8?l>>>21|128:l>>>21&127;case 7:y[m+6]=f!==7?l>>>14|128:l>>>14&127;case 6:y[m+5]=f!==6?l>>>7|128:l>>>7&127;case 5:y[m+4]=f!==5?128|l:127&l;case 4:y[m+3]=f!==4?s>>>21|128:s>>>21&127;case 3:y[m+2]=f!==3?s>>>14|128:s>>>14&127;case 2:y[m+1]=f!==2?s>>>7|128:s>>>7&127;case 1:y[m]=f!==1?128|s:127&s}}function AX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}const yke=new Map([["moderation",1],["supervise",2]]);class _ke extends cr{get connectionState(){return this._connectionState}set connectionState(a){if(this._connectionState===a)return;const s=this._connectionState;this._connectionState=a,this.emit(vi.CONNECTION_STATE_CHANGE,s,a)}get inspectType(){return this._inspectType}set inspectType(a){var s;this._inspectMode=rc(s=a.map(l=>yke.get(l)||0)).call(s,(l,d)=>l+d),this._inspectType=a}get quality(){return this._quality}set quality(a){this._quality=a>1?1:a<.1?.1:a,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(a){super(),Q(this,"name","AgoraRTCVideoContentInspect"),Q(this,"_connectionState",mc.CONNECTING),Q(this,"_innerConnectionState",void 0),Q(this,"sequence",0),Q(this,"inspectStartTime",void 0),Q(this,"workerManagerConnection",void 0),Q(this,"workerConnection",void 0),Q(this,"workerMessageLengthLimit",void 0),Q(this,"inspectIntervalMinimum",void 0),Q(this,"qualityRatio",void 0),Q(this,"_connectInfo",void 0),Q(this,"_cancelTokenSource",Ka.CancelToken.source()),Q(this,"_retryConfig",void 0),Q(this,"wmSequence",0),Q(this,"inspectInterval",void 0),Q(this,"inspectTimer",null),Q(this,"ossFilePrefix",void 0),Q(this,"extraInfo",void 0),Q(this,"_inspectType",void 0),Q(this,"_inspectMode",void 0),Q(this,"_quality",1),Q(this,"qualityTimer",null),Q(this,"_inspectId",void 0),Q(this,"_needWorkUrlOnly",!1),Q(this,"inspectImage",()=>{if(this.connectionState!==mc.CONNECTED)throw new Ee(ie.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===mc.CONNECTED?this.requestToInspectImage():V.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=Mn(5,"inspect-"),this.workerMessageLengthLimit=oe("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=oe("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=oe("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=a.interval,this.ossFilePrefix=a.ossFilePrefix,this.extraInfo=a.extraInfo,this.inspectType=a.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new Eb("worker-manager-"+this._inspectId,Gr),this.on(vi.STATE_CHANGE,(s,l)=>{this._innerConnectionState=s,V.debug("[".concat(this._inspectId,"] Inspect operation :").concat(gc[s]," ").concat(l||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new Eb("worker-"+this._inspectId,Gr),this.handleWorkerEvents()}async init(a,s){this.emit(vi.STATE_CHANGE,gc.CONNECT_AP),this._connectInfo=a;const l=this._cancelTokenSource.token;return this._retryConfig=s,new He((d,f)=>{this.on(vi.CONNECTION_STATE_CHANGE,(m,y)=>{y===mc.CONNECTED&&d()}),this.requestAP(a,l,s).then(m=>{this.connectWorkerManager(m)}).catch(m=>{f(m)})})}async requestAP(a,s,l){const d=oe("WEBCS_DOMAIN").map(y=>"https://".concat(y,"/api/v1")),f=await function(y,_,S,x){let{appId:A,areaCode:I,cname:L,sid:K,token:$,uid:G}=_;Bg++;const ne="image_moderation_api",te={service_name:ne,json_body:JSON.stringify({appId:A,areaCode:I,cname:L,command:"allocateEdge",requestId:Bg,seq:Bg,sid:K,token:$,ts:Date.now(),uid:G+""})};let ce,pe,fe=y[0];return tl(async()=>{ce=Date.now();const ue=await sl(fe,{data:te,cancelToken:S,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(pe=Date.now()-ce,ue.code!==0){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"image inspect ap error, code"+ue.code,{retry:!0,responseTime:pe});throw V.error(Me.toString()),Me}const ye=JSON.parse(ue.json_body);if(ye.code!==200){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(ye.code,", reason: ").concat(ye.reason),{code:ye.code,responseTime:pe});throw V.error(Me.toString()),Me}if(!ye.servers||!Array.isArray(ye.servers)||ye.servers.length===0){const Me=new Ee(ie.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:ye.code,responseTime:pe});throw V.error(Me.toString()),Me}const Se=oe("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Ie=oe("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:ye.servers.map(Me=>{let{address:Gt,wss:Kt}=Me;if(Gt&&Kt)return"wss://".concat(Gt.replace(/\./g,"-"),".").concat(Se,":").concat(Ie||Kt)}).filter(Me=>!!Me),workerToken:ye.workerToken,vid:ye.vid,responseTime:pe}},(ue,ye)=>(it.apworkerEvent(K,{success:!0,sc:200,serviceName:ne,responseDetail:JSON.stringify(ue.addressList),firstSuccess:ye===0,responseTime:pe,serverIp:y[ye%y.length]}),!1),(ue,ye)=>(it.apworkerEvent(K,{success:!1,sc:ue.data&&ue.data.code||200,serviceName:ne,responseTime:pe,serverIp:y[ye%y.length]}),!!(ue.code!==ie.OPERATION_ABORTED&&ue.code!==ie.UNEXPECTED_RESPONSE||ue.data&&ue.data.retry)&&(fe=y[(ye+1)%y.length],!0)),x)}(d,a,s,l);this.emit(vi.STATE_CHANGE,gc.AP_CONNECTED);const{addressList:m}=f;return this.wmSequence++,m}async connectWorkerManager(a){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=s,this.emit(vi.STATE_CHANGE,gc.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(a,1e4)}async connectWorker(a){await this.workerConnection.init([a])}handleWorkerManagerEvents(){this.workerManagerConnection.on(Bt.CONNECTED,async()=>{this.emit(vi.STATE_CHANGE,gc.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.24.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(Bt.CLOSED,()=>{this._innerConnectionState<gc.GET_WORKER_MANAGER_RESPONSE&&V.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(Bt.FAILED,()=>{this._innerConnectionState<gc.GET_WORKER_MANAGER_RESPONSE&&V.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(Bt.RECONNECTING,()=>{this._innerConnectionState<gc.GET_WORKER_MANAGER_RESPONSE&&V.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(Bt.ON_MESSAGE,async a=>{this.emit(vi.STATE_CHANGE,gc.GET_WORKER_MANAGER_RESPONSE);const s=this.workerManagerConnection.url;this.workerManagerConnection.close();const l=JSON.parse(a.data);if(l.code!==200)throw V.error("[".concat(this._inspectId,"] Unexpected code ").concat(l.code," from worker manager")),new Ee(ie.UNEXPECTED_RESPONSE,"response code of worker is unexpected",l);if(!(l.serverResponse&&l.serverResponse.portWss&&s))throw V.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(l))),new Ee(ie.UNEXPECTED_RESPONSE,"response content of worker is unexpected",l);{const d=oe("VIDEO_INSPECT_WORKER_PORT")||l.serverResponse.portWss,f=s.replace(/:\d+\/?$/,":".concat(d));this.emit(vi.STATE_CHANGE,gc.CONNECT_WORKER,f),this._needWorkUrlOnly?this.emit(vi.REQUEST_NEW_WORKER_URL,f):await this.connectWorker(f)}}),this.workerManagerConnection.on(Bt.WILL_RECONNECT,(a,s,l)=>{l(a)}),this.workerManagerConnection.on(Bt.REQUEST_NEW_URLS,(a,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a).catch(s)})}handleWorkerEvents(){this.workerConnection.on(Bt.CONNECTED,async()=>{this.emit(vi.STATE_CHANGE,gc.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=mc.CONNECTED}),this.workerConnection.on(Bt.ON_MESSAGE,async a=>{if(a.data instanceof ArrayBuffer){const l=dke(new Uint8Array(a.data));if(oe("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&V.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(l)),l.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(vi.INSPECT_RESULT,void 0,void 0);if(l.data&&l.data.scorePorn&&l.data.scoreSexy&&l.data.scoreNeutral){var s;const d={porn:l.data.scorePorn,sexy:l.data.scoreSexy,neutral:l.data.scoreNeutral},f=rc(s=Object.keys(d)).call(s,(y,_)=>d[y]>d[_]?y:_,"porn"),m=Object.keys(d).find(y=>y===f);this.emit(vi.INSPECT_RESULT,m)}else this.emit(vi.INSPECT_RESULT,void 0,new Ee(ie.UNEXPECTED_RESPONSE,l.code+"","There is an unexpected data on message"))}else this.emit(vi.INSPECT_RESULT,void 0,new Ee(ie.UNEXPECTED_RESPONSE,l.code+"",l.msg))}else V.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(vi.INSPECT_RESULT,void 0,new Ee(ie.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(Bt.CLOSED,()=>{this.connectionState=mc.CLOSED}),this.workerConnection.on(Bt.FAILED,()=>{this.connectionState=mc.CLOSED}),this.workerConnection.on(Bt.RECONNECTING,()=>{this.connectionState=this.connectionState===mc.CONNECTED?mc.RECONNECTING:mc.CONNECTING}),this.workerConnection.on(Bt.WILL_RECONNECT,(a,s,l)=>{a==="recover"&&l(a),l("tryNext")}),this.workerConnection.on(Bt.REQUEST_NEW_URLS,(a,s)=>{this.workerManagerConnection.close(),this.once(vi.REQUEST_NEW_WORKER_URL,l=>{a([l])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(l=>{this.connectWorkerManager(l,!0)}).catch(l=>{s(l)})})}async requestToInspectImage(){this.sequence++;const a=qs(this,vi.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(a){if(!a.isPlaying)return void this.emit(vi.INSPECT_RESULT,void 0,new Ee(ie.INVALID_OPERATION,"Only the track being played can be inspected"));const l=await this.generateRequestData(a,s);this.workerConnection.sendMessage(l,!0,!0)}else this.emit(vi.INSPECT_RESULT,void 0,new Ee(ie.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(a,s){let{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_}=s;const S=Date.now(),x=await a.getCurrentFrameImage("image/jpeg",this.quality),A=await l9(x,l,d),I=this.sequence+"-"+f+"-"+_+"-"+S+"-"+Mn(12,""),L={appId:l,cid:f,cname:d,deviceId:"",elapse:(K=Number(S-this.inspectStartTime),{low:K|=0,high:K>>31,unsigned:K>=0}),fileSize:A.byteLength,jpgEncryption:2,height:x.height,width:x.width,jpg:A,networkType:6,osType:7,requestId:I,sdkVersion:"4.24.0",sequence:this.sequence,sid:y,timestamp:Mq(S),uid:_,vid:m,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var K;this.extraInfo===void 0&&delete L.callbackData,this.ossFilePrefix===void 0&&delete L.ossFilePrefix;const $=uke(L);if($.byteLength<this.workerMessageLengthLimit){if(oe("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const G=function(ne){for(var te=1;te<arguments.length;te++){var ce=arguments[te]!=null?arguments[te]:{};te%2?AX(Object(ce),!0).forEach(function(pe){Q(ne,pe,ce[pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(ce)):AX(Object(ce)).forEach(function(pe){Object.defineProperty(ne,pe,Object.getOwnPropertyDescriptor(ce,pe))})}return ne}({},L);delete G.jpg,V.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(G))}return $}{const G=this.quality*this.qualityRatio;return this.quality=G,await this.generateRequestData(a,{appId:l,cname:d,cid:f,vid:m,sid:y,uid:_})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Ka.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=mc.CLOSED,this.emit(vi.STATE_CHANGE,gc.CLOSED)}}const bke={name:"ContentInspect",create:function(r){let{config:a}=r;return function(s){if(!s)throw new Ee(ie.INVALID_PARAMS,"inspectConfig is necessary.");if(!s.inspectType||!Array.isArray(s.inspectType))throw new Ee(ie.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const l=[...new Set(s.inspectType)];l.forEach(d=>{var f;if(!Be(f=["supervise","moderation"]).call(f,d))throw new Ee(ie.INVALID_PARAMS,"".concat(d," is not a valid inspect type."))}),s.inspectType=l}if(s&&s.extraInfo&&s.extraInfo.length>1024)throw new Ee(ie.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(a),new _ke(a)}};var IX=o(Le.Object.getOwnPropertySymbols),Eke=Tn,wke=RO.indexOf,Ske=yS,y2=q([].indexOf),OX=!!y2&&1/y2([1],1,-0)<0;Eke({target:"Array",proto:!0,forced:OX||!Ske("indexOf")},{indexOf:function(r){var a=arguments.length>1?arguments[1]:void 0;return OX?y2(this,r,a)||0:wke(this,r,a)}});var xke=nc("Array","indexOf"),Tke=T,Cke=xke,_2=Array.prototype,Rke=function(r){var a=r.indexOf;return r===_2||Tke(_2,r)&&a===_2.indexOf?Cke:a},PX=o(Rke);function Nke(r,a){if(r==null)return{};var s,l,d=function(m,y){if(m==null)return{};var _={};for(var S in m)if({}.hasOwnProperty.call(m,S)){if(PX(y).call(y,S)!==-1)continue;_[S]=m[S]}return _}(r,a);if(IX){var f=IX(r);for(l=0;l<f.length;l++)s=f[l],PX(a).call(a,s)===-1&&{}.propertyIsEnumerable.call(r,s)&&(d[s]=r[s])}return d}let kX=class{get localCapabilities(){return ir(this._localCapabilities)}get rtpCapabilities(){return ir(this._rtpCapabilities)}get candidates(){return ir(this._candidates)}get iceParameters(){return ir(this._iceParameters)}get dtlsParameters(){return ir(this._dtlsParameters)}constructor(r){Q(this,"sessionDesc",void 0),Q(this,"_localCapabilities",void 0),Q(this,"_rtpCapabilities",void 0),Q(this,"_candidates",void 0),Q(this,"_iceParameters",void 0),Q(this,"_dtlsParameters",void 0),Q(this,"setup",void 0),Q(this,"currentMidIndex",void 0),Q(this,"cname","o/i14u9pJrxRKAsu"),Q(this,"firefoxSsrcMidMap",new Map),r=ir(r);const{remoteIceParameters:a,remoteDtlsParameters:s,candidates:l,remoteRTPCapabilities:d,localCapabilities:f,direction:m,setup:y,videoCodec:_,audioCodec:S}=r;let x;this.setup=y,x=m===La.RECEIVE_ONLY?ss(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):ss(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=d,this._candidates=l,this._iceParameters=a,this._dtlsParameters=s,this._localCapabilities=f;const A=m===La.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,I=m===La.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,L=m===La.RECEIVE_ONLY?d.send.videoCodecs:Tb(Je.VIDEO,A,I,_),K=m===La.RECEIVE_ONLY?d.send.audioCodecs:Tb(Je.AUDIO,A,I,S);for(const $ of x.mediaDescriptions)$.attributes.iceUfrag=a.iceUfrag,$.attributes.icePwd=a.icePwd,$.attributes.fingerprints=s.fingerprints,$.attributes.candidates=l,$.attributes.setup=this.setup,$.media.mediaType==="application"&&($.attributes.sctpPort="5000"),$.media.mediaType==="video"&&($.media.fmts=L.map(G=>G.payloadType.toString(10)),$.attributes.payloads=L,$.attributes.extmaps=A.videoExtensions),$.media.mediaType==="audio"&&($.media.fmts=K.map(G=>G.payloadType.toString(10)),$.attributes.payloads=K,$.attributes.extmaps=A.audioExtensions,Vg($));this.sessionDesc=x,this.currentMidIndex=x.mediaDescriptions.length-1}toString(){return hh(this.sessionDesc)}hasMid(r){return Array.isArray(r)?r.every(a=>this.hasMid(a)):this.sessionDesc.mediaDescriptions.some(a=>a.attributes.mid===r)}send(r,a,s,l,d){s=s.replace(/ /g,"-");const{ssrcs:f,ssrcGroups:m}=xb(a,this.cname,oe("SYNC_GROUP")?s:void 0),y=this.findPreloadMediaDesc(f);if(y){if(dr()&&this.firefoxSsrcMidMap.set(f[0].ssrcId,y.attributes.mid),d&&(d.twcc||d.remb)){const _=this.sessionDesc.mediaDescriptions.indexOf(y);return this.sessionDesc.mediaDescriptions[_]=this.mungSendMediaDesc(y,d),{mid:y.attributes.mid,needExchangeSDP:!0}}return{mid:y.attributes.mid,needExchangeSDP:!1}}{const _=this.findAvailableMediaIndex(r,f,l);let S;return _===-1?(S=this.createOrRecycleSendMedia(r,f,m,"sendonly",l,d),this.updateBundleMids()):(S=ir(this.sessionDesc.mediaDescriptions[_]),S.attributes.direction="sendonly",S.attributes.ssrcs=f,S.attributes.ssrcGroups=m,this.sessionDesc.mediaDescriptions[_]=this.mungSendMediaDesc(S,d)),dr()&&this.firefoxSsrcMidMap.set(f[0].ssrcId,S.attributes.mid),{needExchangeSDP:!0,mid:S.attributes.mid}}}stopSending(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>s.attributes.mid&&r.indexOf(s.attributes.mid)!==-1);if(a.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");a.forEach(s=>{s.attributes.ssrcs=[]}),this.updateBundleMids()}receive(r,a,s){const l=[];return r.forEach(d=>{const f=d._mediaStreamTrack.kind,m=this.findAvailableRecvMediaIndex(f);let y,_=!1;m===-1?(_=!0,y=this.createOrRecycleRecvMedia(d,[],"recvonly",a,s),this.updateBundleMids()):(y=ir(this.sessionDesc.mediaDescriptions[m]),y.attributes.direction="recvonly"),l.push({mid:y.attributes.mid,needCreateTransceiver:_})}),l}stopReceiving(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>r.indexOf(s.attributes.mid)!==-1);if(a.length!==r.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");a.forEach(s=>{s.media.port="0",s.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(r){const{foundation:a,protocol:s,address:l,port:d,type:f,relatedAddress:m,relatedPort:y,priority:_}=new RTCIceCandidate(r),S={foundation:a??"",componentId:"1",transport:s??"",priority:_?_+"":"",connectionAddress:l??"",port:d?d+"":"",type:f?f+"":"",relAddr:m??"",relPort:y?y+"":"",extension:{}};this.candidates.some(x=>x.priority===S.priority&&x.connectionAddress===S.connectionAddress&&x.port===S.port)||(this._candidates.push(S),this.sessionDesc.mediaDescriptions.forEach(x=>{x.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(r,a,s,l,d){const f=r._mediaStreamTrack.kind,m=this.rtpCapabilities.recv,y=Tb(f,m,this.localCapabilities.send,f===Je.AUDIO?d:l),_=f===Je.VIDEO?m.videoExtensions:m.audioExtensions,S="".concat(++this.currentMidIndex);let x={media:{mediaType:f,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:y.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:y,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(S)}};x=this.mungRecvMediaDsec(x,r);const A=this.findFirstClosedMedia(f);if(A){const I=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[I]=x}else this.sessionDesc.mediaDescriptions.push(x);return x}muteRemote(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>Be(r).call(r,s.attributes.mid||""));if(a.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");a.forEach(s=>{s.attributes.direction="inactive"})}unmuteRemote(r){const a=this.sessionDesc.mediaDescriptions.filter(s=>Be(r).call(r,s.attributes.mid||""));if(a.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");a.forEach(s=>{s.attributes.direction="recvonly"})}findAvailableMediaIndex(r,a,s){return this.sessionDesc.mediaDescriptions.findIndex(l=>{const d=l.media.mediaType===r&&l.media.port!=="0"&&(l.attributes.direction==="sendonly"||l.attributes.direction==="sendrecv")&&l.attributes.ssrcs.length===0;if(dr()){if(d){const f=this.firefoxSsrcMidMap.get(a[0].ssrcId);return!(f||l.attributes.mid!=="0"&&l.attributes.mid!=="1")||!(!f||f!==l.attributes.mid)}return!1}return d&&l.attributes.mid===s})}findAvailableRecvMediaIndex(r){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const s=a.media.mediaType===r&&a.media.port!=="0"&&(a.attributes.direction==="recvonly"||a.attributes.direction==="sendrecv");return a.attributes.mid!=="0"&&a.attributes.mid!=="1"&&s})}predictReceivingMids(r){const a=[];for(let s=0;s<r;s++)a.push((this.currentMidIndex+s+1).toString(10));return a}restartICE(r){r=ir(r),this._iceParameters=r,this.sessionDesc.mediaDescriptions.forEach(a=>{a.attributes.iceUfrag=r.iceUfrag,a.attributes.icePwd=r.icePwd})}createOrRecycleSendMedia(r,a,s,l,d,f){const m=this.rtpCapabilities.send,y=r===Je.VIDEO?m.videoCodecs:m.audioCodecs,_=r===Je.VIDEO?m.videoExtensions:m.audioExtensions;dr()&&(d="".concat(++this.currentMidIndex));let S={media:{mediaType:r,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:y.map(A=>A.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:s,rtcpFeedbackWildcards:[],payloads:y,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:l,rtcpMux:!0,rtcpRsize:!0,mid:d}};S=this.mungSendMediaDesc(S,f);const x=this.findFirstClosedMedia(r);if(x){const A=this.sessionDesc.mediaDescriptions.indexOf(x);this.sessionDesc.mediaDescriptions[A]=S}else this.sessionDesc.mediaDescriptions.push(S);return S}mungRecvMediaDsec(r,a,s){const l=ir(r);return yD(l),Fg(l,a),_D(l,a),CK(l),CT(l,s,this.localCapabilities.send),l}mungSendMediaDesc(r,a){const s=ir(r);return CT(s,a,this.localCapabilities.recv),Vg(s),s}updateRecvMedia(r,a){const s=this.sessionDesc.mediaDescriptions.findIndex(l=>l.attributes.mid===r);if(s!==-1){const l=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],a);this.sessionDesc.mediaDescriptions[s]=l}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(r=>r.media.port!=="0").map(r=>r.attributes.mid)}findPreloadMediaDesc(r){return this.sessionDesc.mediaDescriptions.find(a=>{var s;return((s=a.attributes)===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId)===r[0].ssrcId})}findFirstClosedMedia(r){return this.sessionDesc.mediaDescriptions.find(a=>dr()?a.media.port==="0"&&a.media.mediaType===r:a.media.port==="0")}};const Ake=["sdp"];var Hn;function jX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function Oh(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?jX(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):jX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let DX=(Hn=class pv extends cK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var a,s;return(a=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&a!==void 0?a:null}get localCodecs(){return[]}set isInRestartIce(a){this._isInRestartIce=a}get isInRestartIce(){return this._isInRestartIce}constructor(a,s,l){super(a,s),Q(this,"direction",void 0),Q(this,"name",void 0),Q(this,"store",void 0),Q(this,"spec",void 0),Q(this,"peerConnection",void 0),Q(this,"initialOffer",void 0),Q(this,"transport",void 0),Q(this,"statsFilter",void 0),Q(this,"localCandidateCount",0),Q(this,"_isInRestartIce",!1),Q(this,"mutex",void 0),Q(this,"onLocalCandidate",void 0),Q(this,"remoteSDP",void 0),Q(this,"pendingCandidates",[]),Q(this,"localCapabilities",void 0),Q(this,"isReady",!1),Q(this,"restartCnt",0),Q(this,"curTurnServerIndex",0),this.store=s,this.spec=a,this.mutex=new Hi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(pv.resolvePCConfiguration(a,s.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=l??La.SEND_ONLY,this.name=this.direction===La.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=Rj(this.peerConnection,oe("STATS_UPDATE_INTERVAL"),void 0,dr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(a){try{const s=await NK();if(this.localCapabilities=RT(s),a){const{sdp:l}=a,d=Nke(a,Ake),f=function(){const x={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},A=Sb(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},L={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},K={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(vc(A,x,"videoExtensions",I,L,K),vc(A,x,"videoCodecs",I,L,K),vc(A,x,"audioExtensions",I,L,K),vc(A,x,"audioCodecs",I,L,K),oe("RAISE_H264_BASELINE_PRIORITY")){const $=K.videoCodecs.findIndex(G=>G.rtpMap&&G.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&G.fmtp&&G.fmtp.parameters["profile-level-id"]==="42001f");if($!==-1){const G=K.videoCodecs.findIndex(ne=>ne.rtpMap&&ne.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(G<$){V.debug("raising H264 baseline profile priority");const ne=K.videoCodecs[$];K.videoCodecs.splice($,1),K.videoCodecs.splice(G,0,ne)}G!==-1&&oe("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(ne=>!(ne.rtpMap&&ne.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&ne.fmtp&&ne.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:I,recv:L,sendrecv:K}}({},{},l);this.remoteSDP=new kX({remoteIceParameters:d.iceParameters,remoteDtlsParameters:d.dtlsParameters,candidates:[],remoteRTPCapabilities:f,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const m=await this.peerConnection.createAnswer();if(!m.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const y=yh(m.sdp);await this.peerConnection.setLocalDescription(m);const _=await AK({},{},m.sdp);this.localCapabilities=RT(_);const S=this.peerConnection.getTransceivers()[0];return S!=null&&S.receiver&&S.receiver.transport&&this.tryBindTransportEvents(S.receiver.transport),Oh(Oh({},y),{},{sdp:m.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const l=await this.peerConnection.createOffer();if(!l.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const d=yh(l.sdp);return this.initialOffer=l,Oh(Oh({},d),{},{sdp:l.sdp})}}catch(s){throw new we(ie.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:s,iceParameters:l,dtlsParameters:d}=a,f=await AK({},{},s);this.remoteSDP=new kX({remoteIceParameters:l,remoteDtlsParameters:d,candidates:[],remoteRTPCapabilities:f,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const m=this.peerConnection.getTransceivers()[0];m!=null&&m.sender&&m.sender.transport&&this.tryBindTransportEvents(m.sender.transport)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async addRemoteCandidate(a){try{a&&this.pendingCandidates.push(a),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(s=>{this.peerConnection.addIceCandidate(s)}),this.pendingCandidates=[])}catch(s){throw new we(ie.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(s.toString()))}}send(a,s,l){var d=this;return So(function*(){const f=yield ln(d.mutex.lock("From P2PConnection.send"));try{if(!d.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const m=[],y=d.remoteSDP.receive(a,s,l);a.forEach((G,ne)=>{if(y[ne].needCreateTransceiver){const te=d.peerConnection.addTransceiver(G._mediaStreamTrack,{direction:"sendonly"});m.push(te),G._updateRtpTransceiver(te)}else{const te=d.peerConnection.getTransceivers().find(ce=>ce.mid===y[ne].mid);if(!te)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(y[ne].mid));m.push(te),G._updateRtpTransceiver(te)}}),dr()&&oe("SIMULCAST")===!0&&(yield ln(d.applySimulcastForFirefox(m,a)));const _=y.map(G=>G.mid),S=yield ln(d.peerConnection.createOffer()),x=d.mungSendOfferSDP(S.sdp,a,_),A=ss(x),I=_.map(G=>{const ne=A.mediaDescriptions.find(te=>te.attributes.mid===G);if(!ne)throw new Error("Cannot extract ssrc from mediaDescription.");return SK(ne,oe("USE_PUB_RTX"))}),L=m.map((G,ne)=>{const te=_[ne];return{localSSRC:I[ne],id:te}});yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x}));try{yield L}catch(G){const ne=d.remoteSDP.toString();throw yield ln(d.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(d.peerConnection.setRemoteDescription({type:"answer",sdp:ne})),yield ln(d.stopSending(_,!0)),G}yield ln(d.applySimulcastEncodings(m,a)),yield ln(d.applySendEncodings(m,a));const K=d.remoteSDP.toString(),$=d.logSDPExchange(x,"offer","local","send");return $==null||$(K),yield ln(d.setRemoteDescription({type:"answer",sdp:K})),m.map((G,ne)=>{const te=_[ne];return{localSSRC:I[ne],id:te}})}catch(m){throw m instanceof we?m:new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(m.toString()))}finally{f()}})()}async stopSending(a,s){const l=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const d=this.peerConnection.getTransceivers().filter(_=>a.indexOf(_.mid)!==-1);if(d.length!==a.length)throw new Error("Transceivers' length (".concat(d.length,") doesn't match mids' length (").concat(a.length,") when trying to call P2PConnection.stopSending."));d.map(_=>{var S;_.direction="inactive",(S=_.stop)===null||S===void 0||S.call(_)});const f=await this.peerConnection.createOffer(),m=this.logSDPExchange(f.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(a);const y=this.remoteSDP.toString();m==null||m(y),await this.setRemoteDescription({type:"answer",sdp:y})}catch(d){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(d.toString()))}finally{l&&l()}}async receive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(a,s,l,d);if(m){const _=this.remoteSDP.toString(),S=this.logSDPExchange(_,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:_});const x=await this.peerConnection.createAnswer(),A=this.mungReceiveAnswerSDP(x.sdp,f,a);S==null||S(A||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:A}),V.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," by exchanging SDP."))}else V.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," no need to exchange SDP."));const y=this.peerConnection.getTransceivers().find(_=>_.mid===f);if(!y||y.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:y.receiver.track,mid:y.mid,transceiver:y}}catch(f){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async mockReceive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(a,s,l,d);if(m){const y=this.remoteSDP.toString(),_=this.logSDPExchange(y,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:y});const S=await this.peerConnection.createAnswer(),x=this.mungReceiveAnswerSDP(S.sdp,f,a);_==null||_(x||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:x}),V.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," by exchanging SDP."))}else V.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(a," no need to exchange SDP."))}catch(f){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const s=this.remoteSDP.toString(),l=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:s});const d=await this.peerConnection.createAnswer();l==null||l(d.sdp||""),await this.peerConnection.setLocalDescription(d)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async restartICE(a){try{if(this.store.p2pTransport===op.Auto&&(this.store.p2pTransport=op.SdRtn,un().supportPCSetConfiguration&&this.peerConnection.setConfiguration(pv.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,un().supportPCSetConfiguration&&this.peerConnection.setConfiguration(pv.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!a){this.restartCnt++,this.isReady=!1;const s=await this.peerConnection.createOffer({iceRestart:!0});if(!s.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:l}=yh(s.sdp);return this.store.descriptionStart(),this.direction===La.SEND_ONLY&&await this.peerConnection.setLocalDescription(s),l}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(a),this.store.descriptionStart(),this.direction===La.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const s=await this.peerConnection.createAnswer();if(!s.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:l}=yh(s.sdp);return await this.peerConnection.setLocalDescription(s),l}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}close(){var a;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const l=await this.peerConnection.createOffer(),d=this.mungSendOfferSDP(l.sdp,[s],[a]);this.remoteSDP.updateRecvMedia(a,s);const f=this.remoteSDP.toString(),m=this.logSDPExchange(d,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:d}),m==null||m(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new we(ie.EXCHANGE_SDP_FAILED,l.toString())}}async updateSendParameters(a,s){const l=this.peerConnection.getTransceivers().filter(d=>d.mid===a);l.length===1&&(this.isVP8Simulcast(s)?dr()||await this.applySimulcastEncodings(l,[s]):await this.applySendEncodings(l,[s]))}setStatsRemoteVideoIsReady(a,s){this.statsFilter.setVideoIsReady2(a,s)}async replaceTrack(a,s){const l=this.peerConnection.getTransceivers().find(d=>d.mid===s);l&&await l.sender.replaceTrack(a._mediaStreamTrack)}async getSelectedCandidatePair(){const a=this.peerConnection.getReceivers();if(a.length>0&&a[0].transport&&a[0].transport.iceTransport&&a[0].transport.iceTransport.getSelectedCandidatePair&&a[0].transport.iceTransport.getSelectedCandidatePair()){const s=a[0].transport.iceTransport,{local:l,remote:d}=s.getSelectedCandidatePair();return{local:Oh(Oh({},tu),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port}),remote:Oh(Oh({},tu),{},{candidateType:d.type,protocol:d.protocol,address:d.address,port:d.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a,s;Be(a=["connected","completed"]).call(a,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(s=this.onICEConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=a=>{if(a.candidate){var s;a.candidate.candidate&&((s=this.onLocalCandidate)===null||s===void 0||s.call(this,a.candidate.toJSON())),this.localCandidateCount+=1}else V.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const d={iceServers:[]};var f;return a.iceServers?d.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(cb(a.turnServer.servers)?d.iceServers=a.turnServer.servers:(d.iceServers&&d.iceServers.push(...pv.turnServerConfigToIceServers(a.turnServer.servers,s,l)),oe("USE_TURN_SERVER_OF_GATEWAY")&&d.iceServers&&a.turnServer.serversFromGateway&&d.iceServers.push(...pv.turnServerConfigToIceServers(a.turnServer.serversFromGateway,s,l)),Be(f=[op.Relay,op.SdRtn]).call(f,s)&&(d.iceTransportPolicy="relay"),oe("FORCE_TURN_TCP")?d.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(m=>{m.forceturn&&(d.iceTransportPolicy="relay")}))),oe("ENABLE_ENCODED_TRANSFORM")&&un().supportWebRTCEncodedTransform&&(d.encodedInsertableStreams=!0),V.debug("P2PConnection p2pTransport is ".concat(s)),d}static turnServerConfigToIceServers(a,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const d=[],f=a.filter(y=>y.tcpport);V.debug("P2PConnection turnServers is ".concat(f,", current index is ").concat(l));const m=f.length>l?f[l]:f[0];switch(s){case op.SdRtn:const y=a.filter(S=>{var x;return Be(x=S.username).call(x,"glb:")&&S.turnServerURL==S.turnServerURL}),_=y.length>l?y[l]:y[0];_&&(d.push({username:_.username,credential:_.password,credentialType:"password",urls:"turn:".concat(gh(_.turnServerURL),":").concat(_.tcpport,"?transport=udp")}),d.push({username:_.username,credential:_.password,credentialType:"password",urls:"turns:".concat(gh(_.turnServerURL),":").concat(_.tcpport,"?transport=tcp")}));break;case op.Relay:m&&(d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(m.turnServerURL,":").concat(m.tcpport,"?transport=udp")}),d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(gh(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}));break;default:m&&(d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(m.turnServerURL,":").concat(m.tcpport,"?transport=udp")}),d.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(gh(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}),d.push({username:m.username,credential:m.password,credentialType:"password",urls:"stun:".concat(m.turnServerURL,":").concat(m.tcpport)}))}return d}tryBindTransportEvents(a){if(a){this.transport=a,a.onstatechange=()=>{var l;a!=null&&a.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,a.state))},a.onerror=l=>{var d;(d=this.onDTLSTransportError)===null||d===void 0||d.call(this,"error"in l?l.error:l)};const s=a.iceTransport;s&&(s.onstatechange=()=>{const l=a==null?void 0:a.iceTransport.state;var d;l&&((d=this.onICETransportStateChange)===null||d===void 0||d.call(this,l))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:l,remote:d}=s.getSelectedCandidatePair()||{};if(l&&d){const f=l.address+":"+l.port,m=d.address+":"+d.port;V.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(mp(f)),", remote ").concat(JSON.stringify(mp(m))))}}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(a,s){var l;if(s||(s=this.peerConnection.getSenders().find(x=>x.track===a._mediaStreamTrack)),!s)return V.warn("[".concat(a.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(a))return V.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!un().supportSetRtpSenderParameters)return V.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const d={},f={};switch(a._optimizationMode){case"motion":d.degradationPreference="maintain-framerate";break;case"detail":d.degradationPreference="maintain-resolution";break;default:d.degradationPreference="balanced"}if(a._encoderConfig){var m;const{bitrateMax:x,frameRate:A,scaleResolutionDownBy:I}=a._encoderConfig;x&&(f.maxBitrate=1e3*x),Be(m=a._hints).call(m,jn.LOW_STREAM)&&(A&&(f.maxFramerate=Is(A)),I&&I>=1&&(f.scaleResolutionDownBy=I))}if(oe("DSCP_TYPE")&&rd()){var y;const x=oe("DSCP_TYPE");Be(y=["very-low","low","medium","high"]).call(y,x)&&(f.networkPriority=x)}const _=s.getParameters(),S=(l=_.encodings)===null||l===void 0?void 0:l[0];dr()&&!S&&(d.encodings=[f]),S&&Object.assign(S,f),Object.assign(_,d),V.debug("[".concat(a.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(_.encodings))),await s.setParameters(_)}async applySendEncodings(a,s){try{if(!un().supportSetRtpSenderParameters||a.length!==s.length)return;for(let l=0;l<a.length;l++){const d=a[l],f=s[l];f instanceof Gn&&!this.isVP8Simulcast(f)&&await this.updateRtpSenderEncodings(f,d.sender)}}catch{V.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(a,s,l){const d=ss(a);return s.forEach((f,m)=>{const y=l[m],_=d.mediaDescriptions.find(S=>S.attributes.mid===y);_&&(Fg(_,f),RK(_,f,this.store.codec))}),hh(d)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,s,l)=>{var d;(d=this.onFirstVideoDecoded)===null||d===void 0||d.call(this,a,s,l)},this.statsFilter.onSelectedLocalCandidateChanged=(a,s)=>{var l;(l=this.onSelectedLocalCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,s)=>{var l;(l=this.onSelectedRemoteCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onFirstVideoDecodedTimeout=a=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(a,s){if(a.length===s.length)for(let _=0;_<a.length;_++){var l,d,f,m,y;const S=a[_],x=s[_];if(x instanceof Gn&&!Be(l=x._hints).call(l,jn.LOW_STREAM)&&(d=x._encoderConfig)!==null&&d!==void 0&&d.bitrateMax&&((f=x._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(m=x._scalabilityMode)!==null&&m!==void 0&&m.numSpatialLayers&&((y=x._scalabilityMode)===null||y===void 0?void 0:y.numSpatialLayers)>1&&this.store.codec==="vp8"){const A={},I={high:1e3*(x._encoderConfig.bitrateMax-50),medium:5e4};A.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const L=S.sender.getParameters();await S.sender.setParameters(Object.assign(L,A))}}}async applySimulcastEncodings(a,s){if(!dr()&&a.length===s.length)for(let l=0;l<a.length;l++){const d=s[l];if(d instanceof Gn&&this.isVP8Simulcast(d)){const f=a[l],m={},y={high:1e3*(d._encoderConfig.bitrateMax-50),medium:5e4};m.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:y.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:y.medium,scaleResolutionDownBy:4}];const _=f.sender.getParameters();await f.sender.setParameters(Object.assign(_,m))}}}isVP8Simulcast(a){var s,l,d,f,m;return!!(a instanceof Gn&&oe("SIMULCAST")&&this.store.codec==="vp8"&&!Be(s=a._hints).call(s,jn.LOW_STREAM)&&(l=a._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((d=a._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(f=a._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=a._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1)}logSDPExchange(a,s,l,d){if(oe("SDP_LOGGING"))return V.upload("[".concat(this.store.clientId,"] exchanging ").concat(l," ").concat(s," SDP during P2PConnection.").concat(d,`
`),a),s==="offer"?f=>{this.logSDPExchange(f,"answer",l==="local"?"remote":"local",d)}:void 0}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(m=>{m.direction="inactive"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.muteRemote(a);const f=this.remoteSDP.toString();d==null||d(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(m=>m.mid&&a.indexOf(m.mid)!==-1);if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async m=>{m.direction="sendonly"});const l=await this.peerConnection.createOffer(),d=this.logSDPExchange(l.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(l),this.remoteSDP.unmuteRemote(a);const f=this.remoteSDP.toString();d==null||d(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}async getRemoteSSRC(a,s){var l;if(s=s??((l=this.currentRemoteDescription)===null||l===void 0?void 0:l.sdp)){var d;const f=(d=ss(s).mediaDescriptions.find(m=>m.attributes.mid===a))===null||d===void 0?void 0:d.attributes.ssrcs;return f==null?void 0:f[0].ssrcId}}async setRemoteDescription(a){var s;await this.peerConnection.setRemoteDescription(a),Be(s=["connected","completed"]).call(s,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(a,s,l){const d=ss(a),f=d.mediaDescriptions.find(m=>m.attributes.mid===s);return f&&l===Je.AUDIO&&f.media.mediaType==="audio"&&Vg(f),hh(d)}},rt(Hn.prototype,"establish",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"establish"),Hn.prototype),rt(Hn.prototype,"connect",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"connect"),Hn.prototype),rt(Hn.prototype,"receive",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"receive"),Hn.prototype),rt(Hn.prototype,"mockReceive",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"mockReceive"),Hn.prototype),rt(Hn.prototype,"stopReceiving",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"stopReceiving"),Hn.prototype),rt(Hn.prototype,"restartICE",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"restartICE"),Hn.prototype),rt(Hn.prototype,"close",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"close"),Hn.prototype),rt(Hn.prototype,"updateEncoderConfig",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"updateEncoderConfig"),Hn.prototype),rt(Hn.prototype,"updateSendParameters",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"updateSendParameters"),Hn.prototype),rt(Hn.prototype,"replaceTrack",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"replaceTrack"),Hn.prototype),rt(Hn.prototype,"muteLocal",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"muteLocal"),Hn.prototype),rt(Hn.prototype,"unmuteLocal",[wc],Object.getOwnPropertyDescriptor(Hn.prototype,"unmuteLocal"),Hn.prototype),Hn);function wc(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("From P2PConnection.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}let ll=function(r){return r.SEND_ONLY="SEND_ONLY",r.RECEIVE_ONLY="RECEIVE_ONLY",r}({});var LX,MX,UX,FX,VX,BX,$X,WX,GX,HX,zX,ar;function KX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function uC(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?KX(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):KX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let Ike=(LX=ul(ll.SEND_ONLY),MX=ul(ll.SEND_ONLY),UX=ul(),FX=ul(ll.RECEIVE_ONLY),VX=ul(ll.RECEIVE_ONLY),BX=ul(ll.RECEIVE_ONLY),$X=ul(ll.RECEIVE_ONLY),WX=ul(ll.RECEIVE_ONLY),GX=ul(ll.RECEIVE_ONLY),HX=ul(),zX=ul(ll.RECEIVE_ONLY),ar=class extends cr{get state(){return this._state}set state(r){const a=this._state;this._state=r,this.emit(dt.StateChange,a,this._state)}constructor(r,a){super(),Q(this,"isPlanB",!1),Q(this,"store",void 0),Q(this,"statsUploader",void 0),Q(this,"sendConnection",void 0),Q(this,"recvConnection",void 0),Q(this,"localTrackMap",new Map),Q(this,"remoteUserMap",new Map),Q(this,"localDataChannels",[]),Q(this,"pendingLocalTracks",[]),Q(this,"pendingRemoteTracks",[]),Q(this,"statsCollector",void 0),Q(this,"dtlsFailedCount",0),Q(this,"sendMutex",void 0),Q(this,"recvMutex",void 0),Q(this,"_state",wn.Disconnected),Q(this,"_restartStates",["disconnected","failed"]),Q(this,"reconnectInterval",void 0),Q(this,"uploadUnplinkStarted",!1),Q(this,"uploadDownlinkStarted",!1),Q(this,"uplinkStateUploadInterval",void 0),Q(this,"downlinkStatsUploadInterval",void 0),Q(this,"handleMuteLocalTrack",async(s,l,d)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==wn.Connected)return void d(new we(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const _=this.filterTobeMutedTracks(s);if(_.length===0)return void l();const S=_.find(L=>L[0]==="videoLowTrack");S&&S[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(_.map(L=>{let[,{id:K}]=L;return K}));let x=!1;var m,y;s.trackMediaType==="video"?x=!((m=this.localTrackMap.get(De.LocalAudioTrack))===null||m===void 0||!m.track._muted):x=((y=this.localTrackMap.get(De.LocalVideoTrack))===null||y===void 0?void 0:y.id)===void 0;const A=this.createMuteMessage(_);await Ln(this,dt.RequestMuteLocal,A);const I=s.trackMediaType==="video"?mh.MUTE_LOCAL_VIDEO:mh.MUTE_LOCAL_AUDIO;await Ln(this,dt.RequestP2PMuteLocal,{action:I,message:A,isMuteAll:x}),l()}catch(_){d(_)}finally{f()}}),Q(this,"handleUnmuteLocalTrack",async(s,l,d)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==wn.Connected)return void d(new we(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const m=this.filterTobeUnmutedTracks(s);if(m.length===0)return void l();await this.sendConnection.unmuteLocal(m.map(S=>{let[,{id:x}]=S;return x}));const y=this.createUnmuteMessage(m),_=s.trackMediaType==="video"?mh.UNMUTE_LOCAL_VIDEO:mh.UNMUTE_LOCAL_AUDIO;await Ln(this,dt.RequestP2PMuteLocal,{action:_,message:y}),l()}catch(m){d(m)}finally{f()}}),Q(this,"handleUpdateVideoEncoder",async(s,l,d,f)=>{let m;typeof f=="boolean"&&f||(m=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const _=this.localTrackMap.get(De.LocalVideoTrack);if(!this.sendConnection||!_||_.track!==s||this.state!==wn.Connected)return void l();const{id:S,track:x}=_;S&&(await this.sendConnection.updateSendParameters(S,x),await this.sendConnection.updateEncoderConfig(S,x),this.emit(dt.UpdateVideoEncoder,x)),l()}catch(_){d(_)}finally{var y;(y=m)===null||y===void 0||y()}}),Q(this,"handleUpdateVideoSendParameters",async(s,l,d)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const m=this.localTrackMap.get(De.LocalVideoTrack);if(!this.sendConnection||!m||m.track!==s||this.state!==wn.Connected)return void l();const{id:y,track:_}=m;y&&await this.sendConnection.updateSendParameters(y,_),l()}catch(m){d(m)}finally{f()}}),Q(this,"handleReplaceTrack",async(s,l,d,f)=>{let m;V.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof f=="boolean"&&f||(m=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var y;const S=Array.from(this.localTrackMap.entries()).find(x=>{let[,{track:A}]=x;return s===A});if(!this.sendConnection||!S||S[1].id===void 0||this.state!==wn.Connected)return void l();if(await((y=this.sendConnection)===null||y===void 0?void 0:y.replaceTrack(s,S[1].id)),S[0]===De.LocalVideoTrack&&un().supportDualStreamEncoding){const x=this.localTrackMap.get(De.LocalVideoLowTrack);if(x){const A=s._mediaStreamTrack.clone();x.track._originMediaStreamTrack.stop(),x.track._mediaStreamTrack=A,x.track._originMediaStreamTrack=A,await new He((I,L)=>{this.handleReplaceTrack(x.track,I,L,!0)})}}l()}catch(S){d(S)}finally{var _;(_=m)===null||_===void 0||_()}}),Q(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),Q(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),Q(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),Q(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=r,this.statsCollector=a,this.statsCollector.addP2PChannel(this),this.statsUploader=new uq(r),this.bindStatsUploaderEvents(),this.sendMutex=new Hi("P2PChannel2-send-mutex",r.clientId),this.recvMutex=new Hi("P2PChannel2-recv-mutex",r.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(s=>{s&&(s.iceConnectionState!=="disconnected"&&s.iceConnectionState!=="failed"||this.handleDisconnect(s.direction))})},oe("ICE_RESTART_INTERVAL"))}async startP2PConnection(r,a){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(r){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(r,a){let s;try{if(a){this.recvConnection&&(V.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),s=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new DX(r,this.store,La.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const l=await this.recvConnection.establish(a);return{iceParameters:l.iceParameters,dtlsParameters:l.dtlsParameters,sdp:l.sdp}}{this.state=wn.New,this.sendConnection&&(V.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),s=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new DX(r,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const l=await this.sendConnection.establish();return{iceParameters:l.iceParameters,dtlsParameters:l.dtlsParameters,sdp:l.sdp}}}finally{s&&s()}}async p2pConnect(r){if(!this.sendConnection)throw new we(ie.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(r),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=wn.Connected}async addRemoteCandidate(r,a){if(a===La.RECEIVE_ONLY){if(!this.sendConnection)throw new we(ie.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(r)}else{if(!this.recvConnection)throw new we(ie.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(r)}}publish(r,a,s){var l=this;return So(function*(){const d=yield ln(l.sendMutex.lock("From P2PChannel.publish"));try{if(!l.sendConnection||l.state!==wn.Connected){l.throwIfTrackTypeNotMatch(r);const S=r.filter(x=>l.pendingLocalTracks.indexOf(x)===-1);return void(l.pendingLocalTracks=l.pendingLocalTracks.concat(S))}l.store.pubId=l.store.pubId+1,Yi.markPublishStart(l.store.clientId,l.store.pubId);const f=l.filterTobePublishedTracks(r,a,s);if(f.length===0)return void(yield ln(l.tryToUnmuteAudio(r)));f.forEach(S=>{let{track:x,type:A}=S;const I=Date.now();l.store.publish(x.getTrackId(),A===De.LocalAudioTrack?"audio":"video",I)}),l.bindLocalTrackEvents(f);const m=yield ln(l.sendConnection.send(f.map(S=>{let{track:x}=S;return x}),l.store.codec,l.store.audioCodec)),y=(yield ln(m.next())).value,_=l.createGatewayPublishMessage(f,y);try{yield _}catch(S){throw m.throw(S),(S==null?void 0:S.code)===ie.WS_ABORT&&f.forEach(x=>{let{track:A}=x;l.pendingLocalTracks.indexOf(A)===-1&&l.pendingLocalTracks.push(A)}),l.unbindLocalTrackEvents(f),S}yield ln(m.next()),f.forEach(S=>{let{type:x}=S;l.statsCollector.addLocalStats(x)}),l.statsUploader.startUploadOutboundStats(),l.assignLocalTracks(f,y),f.forEach(S=>{let{track:x,type:A}=S;const I=Date.now();l.store.publish(x.getTrackId(),A===De.LocalAudioTrack?"audio":"video",void 0,I)}),l.startUploadUplinkState()}finally{d()}})()}async unpublish(r){if(!this.sendConnection||this.state!==wn.Connected)return void(r.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(d=>!Be(r).call(r,d)));const a=this.filterTobeUnpublishedTracks(r);if(a.length===0)return;const s=a.find(d=>d[0]==="videoLowTrack");s&&s[1].track.close();const l=this.createGatewayUnpublishMessage(a);if(await this.sendConnection.stopSending(a.map(d=>{let[,{id:f}]=d;return f})),this.withdrawLocalTracks(a),this.unbindLocalTrackEvents(a.map(d=>{let[f,{track:m}]=d;return{type:f,track:m}})),a.forEach(d=>{let[f]=d;this.statsCollector.removeLocalStats(f)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===wn.Connected)return s&&s[1].track.close(),l;r.forEach(d=>{const f=this.pendingLocalTracks.indexOf(d);f!==-1&&this.pendingLocalTracks.splice(f,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const r=()=>{const a=[],s=[];Array.from(this.localTrackMap.entries()).forEach(l=>{let[d,{track:f,ssrcs:m}]=l;const y={stream_type:wOe(f,d),ssrcs:m};f._muted||!f._enabled?a.push(y):s.push(y)}),a.length>0&&a.forEach(l=>{Ln(this,dt.RequestMuteLocal,[l])}),s.length>0&&s.forEach(l=>{Ln(this,dt.RequestUnmuteLocal,[l])})};r(),this.uplinkStateUploadInterval=window.setInterval(()=>{r()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(r){return So(function*(){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(V.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Li(this,dt.RequestRePublish,this.pendingLocalTracks),this.emit(dt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(r,a,s,l){var d;if(!this.recvConnection)throw new we(ie.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((d=this.remoteUserMap.get(r))!==null&&d!==void 0&&d.has(a))return;const{track:f,mid:m,transceiver:y}=await this.recvConnection.receive(a,[{ssrcId:s}],String(r.uid),l);a===Je.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(f):(r._audioTrack=new Og(f,r.uid,r._uintid,this.store),V.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),y&&r._audioTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoSSRC=s,r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(f):(r._videoTrack=new Ig(f,r.uid,r._uintid,this.store),V.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId()))),y&&r._videoTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(r,r._videoTrack));const _=this.remoteUserMap.get(r);_?_.set(a,m):this.remoteUserMap.set(r,new Map([[a,m]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const S=this.pendingRemoteTracks.findIndex(x=>{let{user:A,kind:I}=x;return A.uid===r.uid&&a===I});S!==-1&&(this.pendingRemoteTracks.splice(S,1),this.emit(dt.MediaReconnectEnd,r.uid))}async mockSubscribe(r,a,s,l){if(!this.recvConnection)throw new we(ie.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(a,[{ssrcId:s}],String(r.uid),l)}async unsubscribe(r,a,s){const l=this.pendingRemoteTracks.filter(f=>{let{user:m,kind:y}=f;return a!==void 0?m.uid===r.uid&&a===y:m.uid===r.uid});if(l.forEach(f=>{const m=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(m,1)}),this.recvConnection||s||l.forEach(f=>{let{kind:m}=f;var y;if(m===Je.AUDIO)(y=r._audioTrack)===null||y===void 0||y._destroy(),r._audioTrack=void 0;else if(m===Je.VIDEO){var _;(_=r._videoTrack)===null||_===void 0||_._destroy(),r._videoTrack=void 0}}),!this.recvConnection)return;const d=this.filterTobeUnSubscribedTracks(r,a);d.length!==0&&(await this.recvConnection.stopReceiving(d.map(f=>{let[,{id:m}]=f;return m})),this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),d.forEach(f=>{let[m,{kind:y}]=f;var _,S;if(y===Je.VIDEO&&m._videoSSRC&&((_=this.recvConnection)===null||_===void 0||_.setStatsRemoteVideoIsReady(m._videoSSRC,!1)),y===Je.VIDEO)this.unbindRemoteTrackEvents(m._videoTrack),s||((S=m._videoTrack)===null||S===void 0||S._destroy(),m._videoTrack=void 0);else if(y===Je.AUDIO){var x;this.unbindRemoteTrackEvents(m._audioTrack),!s&&((x=m._audioTrack)===null||x===void 0||x._destroy(),m._audioTrack=void 0)}}),d.forEach(f=>{let[,{kind:m}]=f;Ln(this,dt.RequestP2PMuteRemote,m)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const r=()=>Array.from(this.remoteUserMap.entries()).forEach(a=>{let[,s]=a;[Je.VIDEO,Je.AUDIO].forEach(l=>{s.has(l)?Ln(this,dt.RequestP2PUnmuteRemote,l):Ln(this,dt.RequestP2PMuteRemote,l)})});r(),this.downlinkStatsUploadInterval=window.setInterval(()=>{r()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(r){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(r){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(r){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(r){throw new we(ie.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(r,a){if(!this.recvConnection)return;const s=this.remoteUserMap.get(r);if(!s)return void V.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(r.uid,"."));if(!s.get(a))return void V.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."));const l=a===Je.VIDEO?r._videoSSRC:r._audioSSRC;l!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(r,a){return this.unmuteRemoteNoLock(r,a)}async unmuteRemoteNoLock(r,a){if(!this.recvConnection)return;const s=this.remoteUserMap.get(r);if(!s)return void V.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(r.uid,"."));s.get(a)||V.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(r.uid," media type ").concat(a,"."))}getAllTracks(r){const a=this.localTrackMap.get(De.LocalAudioTrack);if((a==null?void 0:a.track)instanceof Yr){const s=a.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[d]=l;return d!==De.LocalAudioTrack}).filter(l=>{let[d]=l;return!(r&&d===De.LocalVideoLowTrack)}).map(l=>{let[,{track:d}]=l;return d}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[l]=s;return!(r&&l===De.LocalVideoLowTrack)}).map(s=>{let[,{track:l}]=s;return l})}reportPublishEvent(r,a,s,l,d){if(r){const m=this.localTrackMap.get(De.LocalAudioTrack),y=l?this.localTrackMap.get(De.LocalVideoLowTrack):this.localTrackMap.get(De.LocalVideoTrack);it.publish(this.store.sessionId,{eventElapse:Yi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.track.getTrackLabel(),videoName:y==null?void 0:y.track.getTrackLabel(),screenshare:(y==null?void 0:y.track._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}else{var f;s||(s=[]);const m=s.find(_=>_ instanceof vr),y=l?(f=this.localTrackMap.get(De.LocalVideoTrack))===null||f===void 0?void 0:f.track:s.find(_=>_ instanceof Gn);it.publish(this.store.sessionId,{eventElapse:Yi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:a,audioName:m==null?void 0:m.getTrackLabel(),videoName:y==null?void 0:y.getTrackLabel(),screenshare:(y==null?void 0:y._hints.indexOf(jn.SCREEN_TRACK))!==-1,audio:!!m,video:!!y,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}}reportSubscribeEvent(r,a,s,l){const d=l===Je.VIDEO?s._videoSSRC:s._audioSSRC;d&&it.subscribe(this.store.sessionId,{succ:r,ec:a,video:l===Je.VIDEO,audio:l===Je.AUDIO,peerid:s.uid,subscribeRequestid:l===Je.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:Yi.measureFromSubscribeStart(this.store.clientId,d)})}reset(){V.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Hi("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Hi("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const r=this.localTrackMap.get(De.LocalAudioTrack);if((r==null?void 0:r.track)instanceof Yr){if(r.track.trackList.length>0){const a=r.track;r.track.trackList.forEach(s=>{a.removeAudioTrack(s)})}r.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=wn.Disconnected}getStats(r){var a,s;return r?(s=this.recvConnection)===null||s===void 0?void 0:s.getStats():(a=this.sendConnection)===null||a===void 0?void 0:a.getStats()}getRemoteVideoIsReady(r){var a;return((a=this.recvConnection)===null||a===void 0?void 0:a.getRemoteVideoIsReady(r))||!1}getLocalAudioVolume(){const r=this.localTrackMap.get(De.LocalAudioTrack);if(r)return r.track.getVolumeLevel()}getLocalVideoSize(){const r=this.localTrackMap.get(De.LocalVideoTrack);if(r)return{width:r.track.videoWidth||0,height:r.track.videoHeight||0}}getEncoderConfig(r){const a=this.localTrackMap.get(r);return a&&a.track instanceof Gn||a&&a.track instanceof vr?a.track._encoderConfig:void 0}getLocalMedia(r){return this.localTrackMap.get(r)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}async hasRemoteMediaWithLock(r,a){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!a||s.has(a))}getRemoteMedia(r){var a;const s=Array.from(os(a=this.remoteUserMap).call(a)).find(l=>l.uid===r);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let r=Array.from(this.remoteUserMap.entries()).map(s=>{let[l]=s;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const a=this.localTrackMap.get(De.LocalAudioTrack);return a&&r.push({level:100*a.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=Yf(r).call(r,(s,l)=>s.level-l.level),r}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(V.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=wn.Reconnecting,oe("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a]=r;var s;a._videoTrack&&a._videoTrack._player&&((s=a._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),a._videoTrack._player.isKeepLastFrame=!0,a._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(r=>{var a;let[s,{track:l}]=r;switch(s){case De.LocalVideoTrack:Be(a=l._hints).call(a,jn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case De.LocalAudioTrack:l instanceof Yr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case De.LocalVideoLowTrack:}}),this.emit(dt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;Array.from(os(s).call(s)).forEach(l=>{this.setPendingRemoteMedia(a,l)}),this.emit(dt.MediaReconnectStart,a.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),V.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(r,a){for(const s of this.pendingRemoteTracks){const{user:l,kind:d}=s;if((r instanceof wh?r.uid:r)===l.uid&&a===d)return!0}return!1}setPendingRemoteMedia(r,a){this.hasPendingRemoteMedia(r,a)||this.pendingRemoteTracks.push({user:r,kind:a})}async restartICE(r,a){let s,l;if(r===La.SEND_ONLY){if(!this.sendConnection)throw new we(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");s=await this.sendMutex.lock("From P2PChannel.restartICE"),l=this.sendConnection}else{if(!this.recvConnection)throw new we(ie.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");s=await this.recvMutex.lock("From P2PChannel.restartICE"),l=this.recvConnection}try{if(a){const d=await l.restartICE(a);return l.isInRestartIce=!1,d}{const d=await l.restartICE();if(d){const f=await Li(this,dt.RequestP2PRestartICE,{direction:La.RECEIVE_ONLY,iceParameter:d});await l.restartICE(f),l.isInRestartIce=!1}}}finally{s()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const r=this.sendConnection.getStats(),a=this.localTrackMap.get(De.LocalVideoTrack),s=this.localTrackMap.get(De.LocalAudioTrack),l=r.videoSend.find(L=>{var K;return L.ssrc===(a==null||(K=a.ssrcs)===null||K===void 0?void 0:K[0].ssrcId)}),d=r.audioSend.find(L=>{var K;return L.ssrc===(s==null||(K=s.ssrcs)===null||K===void 0?void 0:K[0].ssrcId)});if(!l||!d)return 1;const f=qs(this,dt.NeedSignalRTT),m=l?l.rttMs:void 0,y=d?d.rttMs:void 0,_=m&&y?(m+y)/2:m||y,S=(_&&f?(_+f)/2:_||f)||0,x=100*r.sendPacketLossRate*.7/50+.3*S/1500,A=x<.17?1:x<.36?2:x<.59?3:x<.1?4:5,I=a==null?void 0:a.track;if(I&&I._encoderConfig&&I._hints.indexOf(jn.SCREEN_TRACK)===-1){const L=I._encoderConfig.bitrateMax,K=r.bitrate.actualEncoded;if(L&&K){const $=(1e3*L-K)/(1e3*L);return eK[$<.15?0:$<.3?1:$<.45?2:$<.6?3:4][A]}}return A}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const r=this.recvConnection.getStats();let a=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[l]=s;const d=l._audioSSRC,f=l._videoSSRC,m=r.audioRecv.find(K=>K.ssrc===d),y=r.videoRecv.find(K=>K.ssrc===f);if(!m&&!y)return void(a+=1);const _=qs(this,dt.NeedSignalRTT),S=r.rtt,x=(S&&_?(S+_)/2:S||_)||0,A=m?m.jitterMs:void 0,I=r.recvPacketLossRate;let L=.7*I*100/50+.3*x/1500;A&&(L=.6*I*100/50+.2*x/1500+.2*A/400),a+=L<.1?1:L<.17?2:L<.36?3:L<.59?4:5}),this.remoteUserMap.size>0?Math.round(a/this.remoteUserMap.size):a}async muteLocalTrack(r){return new He((a,s)=>{this.handleMuteLocalTrack(r,a,s)})}filterTobePublishedTracks(r,a,s){const l=[],d=un(),f=this.getAllTracks();r=vg(r=r.filter(_=>f.indexOf(_)===-1));let m=!1,y=!1;for(const _ of r){if(_ instanceof Gn&&(this.localTrackMap.has(De.LocalVideoTrack)||m?new we(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:_,type:De.LocalVideoTrack}),m=!0),a)){const S=this.getLowVideoTrack(_,s);l.push({track:S,type:De.LocalVideoLowTrack})}if(_ instanceof vr){const S=this.localTrackMap.get(De.LocalAudioTrack);if(S){if(!(S.track instanceof Yr))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");S.track.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0)}else if(y){const x=l.find(A=>{let{type:I}=A;return I===De.LocalAudioTrack});if(!(x.track instanceof Yr))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");x.track.addAudioTrack(_)}else{if(!d.webAudioMediaStreamDest||_ instanceof Yr||_._bypassWebAudio)l.push({track:_,type:De.LocalAudioTrack});else{const x=new Yr;x.addAudioTrack(_),l.push({track:x,type:De.LocalAudioTrack})}y=!0}}}return l}filterTobeUnpublishedTracks(r){const a=[],s=this.getAllTracks();r=vg(r=r.filter(l=>s.indexOf(l)!==-1));for(const l of r){if(l instanceof vr){const d=this.localTrackMap.get(De.LocalAudioTrack);if(!d)continue;d.track instanceof Yr?(d.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),d.track.trackList.length===0&&(a.push([De.LocalAudioTrack,d]),d.track.close())):a.push([De.LocalAudioTrack,d])}if(l instanceof Gn){const d=this.localTrackMap.get(De.LocalVideoTrack);if(!d)continue;a.push([De.LocalVideoTrack,d]);const f=this.localTrackMap.get(De.LocalVideoLowTrack);f&&a.push([De.LocalVideoLowTrack,f])}}return a}bindLocalTrackEvents(r){r.forEach(a=>{let{track:s,type:l}=a;switch(l){case De.LocalVideoTrack:s.addListener(et.GET_STATS,this.handleGetLocalVideoStats),s.addListener(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(et.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(et.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.addListener(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case De.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case De.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(r,a){r instanceof Yr?r.trackList.forEach(s=>{s.addListener(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(et.GET_STATS,this.handleGetLocalAudioStats),s.addListener(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.addListener(et.GET_STATS,this.handleGetLocalAudioStats),r.addListener(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),a||r.addListener(et.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(r){r||(r=Array.from(this.localTrackMap.entries()).map(a=>{let[s,{track:l}]=a;return{track:l,type:s}})),r.forEach(a=>{let{track:s,type:l}=a;switch(l){case De.LocalVideoTrack:s.off(et.GET_STATS,this.handleGetLocalVideoStats),s.off(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(et.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(et.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.off(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case De.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case De.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(r){r instanceof Yr?r.trackList.forEach(a=>{a.off(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(et.GET_STATS,this.handleGetLocalAudioStats),a.off(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.off(et.GET_STATS,this.handleGetLocalAudioStats),r.off(et.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(et.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(et.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(et.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(et.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(r,a){a instanceof Ig&&a.addListener(et.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(r))}),a instanceof Og&&a.addListener(et.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(r))})}unbindRemoteTrackEvents(r){r&&r.removeAllListeners(et.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(r=>{let[a,s]=r;s.has(Je.AUDIO)&&this.unbindRemoteTrackEvents(a._audioTrack),s.has(Je.VIDEO)&&this.unbindRemoteTrackEvents(a._videoTrack)})}createGatewayPublishMessage(r,a){return r.map((s,l)=>{var d;let f,{track:m,type:y}=s;switch(y){case De.LocalAudioTrack:f=xn.Audio;break;case De.LocalVideoTrack:f=Be(d=m._hints).call(d,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalVideoLowTrack:f=xn.Low}return{kind:y===De.LocalAudioTrack?Je.AUDIO:Je.VIDEO,stream_type:f,mid:a[l].id,ssrcs:a[l].localSSRC,isMuted:m.muted||!m.enabled}})}createGatewayUnpublishMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case De.LocalVideoTrack:l=Be(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}assignLocalTracks(r,a){r.forEach((s,l)=>{let{track:d,type:f}=s;this.localTrackMap.set(f,{track:d,id:a[l].id,ssrcs:a[l].localSSRC})})}withdrawLocalTracks(r){r.forEach(a=>{let[s]=a;this.localTrackMap.delete(s)})}bindConnectionEvents(r){r.onConnectionStateChange=async a=>{var s;V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(r.name,".onConnectionStateChange(").concat(a,")")),this.emit(dt.PeerConnectionStateChange,a),a!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),a==="connected"&&(r.isInRestartIce=!1),Be(s=this._restartStates).call(s,a)&&!r.isInRestartIce&&(a==="disconnected"&&await Ti(800),r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))},r.onICEConnectionStateChange=a=>{a!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(a,")")),it.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:a,tag:rr.TRACER}).onSuccess(),this.emit(dt.IceConnectionStateChange,a)},r.onICETransportStateChange=a=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(a,")"))},r.onDTLSTransportStateChange=a=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(a,")"))},r.onDTLSTransportError=a=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(a,")"))},r.onFirstAudioDecoded=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(f=>f._audioSSRC===a);var d;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(d=l.audioTrack)===null||d===void 0||d.emit(Co.FIRST_FRAME_DECODED),it.firstRemoteFrame(this.store.sessionId,ii.FIRST_AUDIO_DECODE,Qn.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},r.onFirstAudioReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._audioSSRC===a);l&&it.firstRemoteFrame(this.store.sessionId,ii.FIRST_AUDIO_RECEIVED,Qn.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},r.onFirstVideoDecoded=(a,s,l)=>{this.reportVideoFirstFrameDecoded(a,s,l)},r.onFirstVideoReceived=a=>{var s;const l=Array.from(os(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===a);l&&it.firstRemoteFrame(this.store.sessionId,ii.FIRST_VIDEO_RECEIVED,Qn.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},r.onSelectedLocalCandidateChanged=(a,s)=>{const l=a.candidateType==="relay",d=s.candidateType==="relay";s.candidateType!=="unknown"&&l===d||this.emit(dt.ConnectionTypeChange,l),V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(vh(s))," -> ").concat(JSON.stringify(vh(a)),")"))},r.onSelectedRemoteCandidateChanged=(a,s)=>{V.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(vh(s))," -> ").concat(JSON.stringify(vh(a)),")"))},r.onFirstVideoDecodedTimeout=a=>{this.reportVideoFirstFrameDecoded(a,void 0,void 0,!0)},r.onLocalCandidate=a=>{this.emit(dt.LocalCandidate,{candidate:a,direction:r.direction})}}unbindConnectionEvents(r){r.onConnectionStateChange=void 0,r.onICEConnectionStateChange=void 0,r.onICETransportStateChange=void 0,r.onDTLSTransportStateChange=void 0,r.onDTLSTransportError=void 0,r.onFirstAudioDecoded=void 0,r.onFirstAudioReceived=void 0,r.onFirstVideoDecoded=void 0,r.onFirstVideoReceived=void 0,r.onSelectedLocalCandidateChanged=void 0,r.onSelectedRemoteCandidateChanged=void 0,r.onFirstVideoDecodedTimeout=void 0,r.onLocalCandidate=void 0}async handleDisconnect(r){const a=r===La.SEND_ONLY?this.sendConnection:this.recvConnection;a&&!a.isInRestartIce&&(a.isInRestartIce=!0,V.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(a.name,"] start use restartICE")),r===La.SEND_ONLY?this.restartICE(r):Li(this,dt.RequestP2PRestartICE,{direction:La.SEND_ONLY}))}filterTobeMutedTracks(r){const a=[];if(this.getAllTracks().indexOf(r)===-1)return a;const s=this.localTrackMap.get(De.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive||a.push([De.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l&&(a.push(l),l[0]===De.LocalVideoTrack)){const d=this.localTrackMap.get(De.LocalVideoLowTrack);d&&a.push([De.LocalVideoLowTrack,d])}return a}filterTobeUnmutedTracks(r){const a=[],s=this.localTrackMap.get(De.LocalAudioTrack);if(r instanceof vr&&(s==null?void 0:s.track)instanceof Yr)return s.track.isActive&&a.push([De.LocalAudioTrack,s]),a;const l=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:f}]=d;return r===f});if(l)if(l[0]===De.LocalVideoTrack){a.push(l);const d=this.localTrackMap.get(De.LocalVideoLowTrack);d&&a.push([De.LocalVideoLowTrack,d])}else a.push(l);return a}createMuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoTrack:l=Be(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}createUnmuteMessage(r){return r.map(a=>{var s;let l,[d,{track:f,ssrcs:m,id:y}]=a;switch(d){case De.LocalAudioTrack:l=xn.Audio;break;case De.LocalVideoTrack:l=Be(s=f._hints).call(s,jn.SCREEN_TRACK)?xn.Screen:xn.High;break;case De.LocalVideoLowTrack:l=xn.Low}return{stream_type:l,ssrcs:m,mid:y}})}filterTobeUnSubscribedTracks(r,a){const s=[],l=this.remoteUserMap.get(r);if(!l)return s;if(a){const d=l.get(a);if(!d)return s;s.push([r,{kind:a,id:d}])}else Array.from(l.entries()).forEach(d=>{let[f,m]=d;s.push([r,{kind:f,id:m}])});return s}createUnsubscribeMessage(r){const a=[];return r.forEach(s=>{let[l,{kind:d,id:f}]=s;switch(d){case Je.VIDEO:return void(l._videoSSRC&&a.push({stream_type:Je.VIDEO,ssrcId:l._videoSSRC}));case Je.AUDIO:return void(l._audioSSRC&&a.push({stream_type:Je.AUDIO,ssrcId:l._audioSSRC}))}}),a}withdrawRemoteTracks(r){r.forEach(a=>{let[s,{kind:l}]=a;const d=this.remoteUserMap.get(s);d&&(d.delete(l),Array.from(d.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(r){const a=this.localTrackMap.get(De.LocalVideoTrack),s=this.localTrackMap.get(De.LocalVideoLowTrack);a&&(await a.track.setBitrateLimit(r.uplink),await new He((l,d)=>{this.handleUpdateVideoEncoder(a.track,l,d,!0)})),s&&r.low_stream_uplink&&(await s.track.setBitrateLimit({max_bitrate:r.low_stream_uplink.bitrate,min_bitrate:r.low_stream_uplink.bitrate||0}),await new He((l,d)=>{this.handleUpdateVideoEncoder(s.track,l,d,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const r=this.sendConnection.peerConnectionState,a=this.recvConnection.peerConnectionState;return r!=="connected"&&a!=="connected"}return!0}async tryToUnmuteAudio(r){for(let a=0;a<r.length;a++)if(r[a]instanceof vr){const s=this.filterTobeUnmutedTracks(r[a]);if(s.length===0)continue;const l=this.createUnmuteMessage(s);return void await Ln(this,dt.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=r=>this.getStats(r),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(r=>{let[,{ssrcs:a}]=r;return!!a}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=r=>{var a;return!((a=this.recvConnection)===null||a===void 0||!a.getRemoteVideoIsReady(r))},this.statsUploader.requestUpload=(r,a)=>this.emit(dt.RequestUpload,r,a),this.statsUploader.requestUploadStats=r=>this.emit(dt.RequestUploadStats,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Ti(Ej(this.dtlsFailedCount,Gr)),this.emit(dt.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(De.LocalVideoTrack)||this.pendingLocalTracks.some(r=>r instanceof Gn)}throwIfTrackTypeNotMatch(r){if(r.filter(a=>a instanceof Gn).length>1)throw new we(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r.filter(a=>a instanceof vr).length>1&&(r.some(a=>a instanceof vr&&a._bypassWebAudio)||!un().webAudioMediaStreamDest))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const a of r){if(a instanceof Gn&&this.pendingLocalTracks.some(s=>s instanceof Gn))throw new we(ie.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(a instanceof vr&&this.pendingLocalTracks.some(s=>s instanceof vr)&&(!un().webAudioMediaStreamDest||a._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof vr&&s._bypassWebAudio)))throw new we(ie.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(r,a){const s=!oe("DISABLE_DUAL_STREAM_USE_ENCODING")&&un().supportDualStreamEncoding,l=uC(uC({},{width:160,height:120,framerate:15,bitrate:50}),a);let d;d=s?r._mediaStreamTrack.clone():MD(r,l);const f=Mn(8,"track-low-"),m=new Gn(d,uC(uC({},s&&{scaleResolutionDownBy:vD(l,r)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,f);return m.on(cp.TRANSCEIVER_UPDATED,y=>{r._updateRtpTransceiver(y,xg.LOW_STREAM)}),m._hints.push(jn.LOW_STREAM),r.addListener(et.NEED_CLOSE,()=>{m.close()}),m}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(r,a,s,l){var d;const f=Array.from(os(d=this.remoteUserMap).call(d)).find(m=>m._videoSSRC===r);if(f){l||this.store.subscribe(f.uid,"video",void 0,void 0,void 0,void 0,Date.now());const m=this.store.keyMetrics,y=m.subscribe.find(_=>_.userId===f.uid&&_.type==="video");it.firstRemoteVideoDecode(this.store.sessionId,ii.FIRST_VIDEO_DECODE,Qn.FIRST_VIDEO_DECODE,{peer:f._uintid,videowidth:a,videoheight:s,subscribeElapse:Yi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId,apEnd:m.requestAPEnd||0,apStart:m.requestAPStart||0,joinGwEnd:m.joinGatewayEnd||0,joinGwStart:m.joinGatewayStart||0,pcEnd:m.peerConnectionEnd||0,pcStart:m.peerConnectionStart||0,subscriberEnd:(y==null?void 0:y.subscribeEnd)||0,subscriberStart:(y==null?void 0:y.subscribeStart)||0,videoAddNotify:(y==null?void 0:y.streamAdded)||0,state:l?1:0})}}async remoteMediaSsrcChanged(r,a,s){if(!this.recvConnection)return!1;const l=this.remoteUserMap.get(r);if(!l)return!1;const d=l.get(a);if(!d)return!1;const f=await this.recvConnection.getRemoteSSRC(d);return f!==void 0&&f!==s}isPreSubScribe(r){return!1}async publishDataChannel(r){throw new we(ie.NOT_SUPPORTED)}async unpublishDataChannel(r){throw new we(ie.NOT_SUPPORTED)}async subscribeDataChannel(r,a){throw new we(ie.NOT_SUPPORTED)}async unsubscribeDataChannel(r,a){throw new we(ie.NOT_SUPPORTED)}hasPendingRemoteDataChannel(r,a){throw new we(ie.NOT_SUPPORTED)}setPendingRemoteDataChannel(r,a){throw new we(ie.NOT_SUPPORTED)}async preConnect(r){throw new we(ie.NOT_SUPPORTED)}getEstablishParams(){throw new we(ie.NOT_SUPPORTED)}async reSubscribe(r){throw new we(ie.NOT_SUPPORTED)}reportVideoFirstFrameRender(r){}async updateVideoStreamParameter(r,a){throw new we(ie.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(r=>{let[a,{track:s}]=r;a===De.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,xg.LOW_STREAM):s._updateRtpTransceiver(void 0)})}},rt(ar.prototype,"p2pConnect",[LX],Object.getOwnPropertyDescriptor(ar.prototype,"p2pConnect"),ar.prototype),rt(ar.prototype,"unpublish",[MX],Object.getOwnPropertyDescriptor(ar.prototype,"unpublish"),ar.prototype),rt(ar.prototype,"unpublishLowStream",[UX],Object.getOwnPropertyDescriptor(ar.prototype,"unpublishLowStream"),ar.prototype),rt(ar.prototype,"subscribe",[FX],Object.getOwnPropertyDescriptor(ar.prototype,"subscribe"),ar.prototype),rt(ar.prototype,"mockSubscribe",[VX],Object.getOwnPropertyDescriptor(ar.prototype,"mockSubscribe"),ar.prototype),rt(ar.prototype,"unsubscribe",[BX],Object.getOwnPropertyDescriptor(ar.prototype,"unsubscribe"),ar.prototype),rt(ar.prototype,"muteRemote",[$X],Object.getOwnPropertyDescriptor(ar.prototype,"muteRemote"),ar.prototype),rt(ar.prototype,"unmuteRemote",[WX],Object.getOwnPropertyDescriptor(ar.prototype,"unmuteRemote"),ar.prototype),rt(ar.prototype,"hasRemoteMediaWithLock",[GX],Object.getOwnPropertyDescriptor(ar.prototype,"hasRemoteMediaWithLock"),ar.prototype),rt(ar.prototype,"disconnectForReconnect",[HX],Object.getOwnPropertyDescriptor(ar.prototype,"disconnectForReconnect"),ar.prototype),rt(ar.prototype,"remoteMediaSsrcChanged",[zX],Object.getOwnPropertyDescriptor(ar.prototype,"remoteMediaSsrcChanged"),ar.prototype),ar);function ul(r){return function(a,s,l){const d=a[s];if(typeof d!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){for(var f=arguments.length,m=new Array(f),y=0;y<f;y++)m[y]=arguments[y];switch(r){case ll.SEND_ONLY:{const _=await this.sendMutex.lock("From P2PChannel2.".concat(s));try{return await d.apply(this,m)}finally{_()}}case ll.RECEIVE_ONLY:{const _=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await d.apply(this,m)}finally{_()}}default:{const _=await this.sendMutex.lock("From P2PChannel2.".concat(s)),S=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await d.apply(this,m)}finally{_(),S()}}}},l}}class Cp extends cr{constructor(a,s){super(),Q(this,"signal",void 0),Q(this,"token",void 0),Q(this,"tokenTimeout",void 0),Q(this,"tokenInterval",void 0),Q(this,"_sequence",0),Q(this,"userMap",new Map),Q(this,"encoder",new TextEncoder),this.signal=a,this.token=s;const l=()=>{this.signal.connectionState===Wn.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(l,1e3):this.tokenInterval=window.setTimeout(l,3*oe("P2P_TOKEN_INTERVAL"))};l()}async send(a,s,l,d,f){var m;if(this.userMap.size===0)return;const y=Array.from(Cs(m=this.userMap).call(m))[0].token;typeof s!="string"&&(s=JSON.stringify(s)),d=d??Mn(6,""),f=f??this._sequence++;const _={_id:d,_type:a,_seq:f,_message:s,token:"".concat(this.token,"_").concat(y)};oe("SHOW_P2P_LOG")&&V.debug("send message",_,"noNeedResponse : ".concat(l)),this.splitMessage(JSON.stringify(_)).forEach(x=>{this.signal.request(Ct.DATA_STREAM,{payload:dh(this.encoder.encode(x))})});const S=new He((x,A)=>{const I=window.setTimeout(()=>{this.off("res-@".concat(d,"_ack"),L),this.off("res-@".concat(d),$),this.off(Lg.ABORT,K),V.debug("[external-signal] request timeout, type: ".concat(a,", requestId: ").concat(d)),this.userMap.size===0?A(new we(ie.INVALID_REMOTE_USER)):A(new we(ie.TIMEOUT))},oe("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),L=()=>{I&&window.clearTimeout(I),this.off(Lg.ABORT,K),l&&x()},K=()=>{I&&window.clearTimeout(I),this.off("res-@".concat(d,"_ack"),L),this.off("res-@".concat(d),$),A(new we(ie.EXTERNAL_SIGNAL_ABORT,"type: ".concat(a,", requestId: ").concat(d)))};this.once(Lg.ABORT,K),this.once("res-@".concat(d,"_ack"),L);const $=(ne,te)=>{G=!0,I&&window.clearTimeout(I),this.off("res-@".concat(d,"_ack"),L),this.off(Lg.ABORT,K),ne==="success"?x(te):A(new we(ie.P2P_MESSAGE_FAILED,"request ".concat(a," failed, requestId: ").concat(d)))};let G=!1;l||(this.once("res-@".concat(d),$),Ti(oe("SIGNAL_REQUEST_TIMEOUT")).then(()=>{G||V.warning("external_signal request timeout, type: ".concat(a,", requestId: ").concat(d,", ").concat(_))}))});try{return await S}catch(x){if(x.code===ie.TIMEOUT)return await this.send(a,s,l,d,f);throw x}}onMessage(a){var s;const{_uid:l}=a;let d,f=this.userMap.get(l);if(f)d=f.splitMessageMap;else{if(this.userMap.size>0||!("_type"in a)||a._type!==Ar.CHECK)return;const{token:S}=a;d=new Map,f={uid:l,isStart:!0,token:S,splitMessageMap:d,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(l,f),this.signal.emit(en.ON_USER_ONLINE,{uid:l}),this.handleUserOnline()}if("id"in a&&"total"in a){var m;const{id:S,total:x}=a,A=(m=d.get(S))!==null&&m!==void 0?m:[];if(A.push(a),d.has(S)||d.set(S,A),A.length!==x)return;{const I=Yf(A).call(A,(L,K)=>L.index-K.index).map(L=>L.payload).join("");d.delete(S),(a=JSON.parse(I))._uid=l}}const{_type:y,token:_}=a;if(Be(s=[Ar.ACK,Ar.CHECK]).call(s,y))return y===Ar.CHECK&&this.handleCheckToken(f,_),void this.receiveMessage(a);_==="".concat(f.token,"_").concat(this.token)?this.handleReceivedMessage(a):V.debug('Receive unexpected message", '.concat(_,", cur_token: ").concat(f.token,"_").concat(this.token),a)}check(){const a={_id:Mn(6,""),token:this.token,_type:Ar.CHECK};oe("SHOW_P2P_LOG")&&V.debug("send message",a),this.signal.request(Ct.DATA_STREAM,{payload:dh(this.encoder.encode(JSON.stringify(a)))})}ack(a){const s={_id:a,_type:Ar.ACK,token:this.token};oe("SHOW_P2P_LOG")&&V.debug("send message",s),this.signal.request(Ct.DATA_STREAM,{payload:dh(this.encoder.encode(JSON.stringify(s)))})}response(a,s,l){this.send(Ar.RESPONSE,JSON.stringify({success:!l,message:s}),!0,a)}handleReceivedMessage(a){const s=()=>{this.userMap.forEach(S=>{const{receivedMessagesMap:x,nextExpectedSequenceNumber:A}=S;for(;x.has(A);){const I=x.get(A);x.delete(A),this.receiveMessage(I),S.nextExpectedSequenceNumber++}})};if(!a)return void s();const{_uid:l,_seq:d}=a,f=this.userMap.get(l),{receivedMessagesMap:m,isStart:y,nextExpectedSequenceNumber:_}=f;if(d<_)return this.ack(a._id),void V.debug("[external-signal] receive old message, seq: ".concat(d,", ").concat(a._message));m.set(d,a),y&&d===_&&(this.receiveMessage(a),m.delete(_),f.nextExpectedSequenceNumber++,s())}receiveMessage(a){const{_id:s,_type:l,_message:d,_uid:f}=a;if(oe("SHOW_P2P_LOG")&&V.debug("receive message",a),s){let m;switch(a._type!==Ar.ACK&&(d&&(m=JSON.parse(d)),this.ack(a._id)),a._type){case Ar.CANDIDATE:case Ar.CONTROL:this.signal.emit(l,m,f);break;case Ar.PUBLISH:case Ar.UNPUBLISH:case Ar.RESTART_ICE:case Ar.CALL:m.uid=f,Li(this.signal,l,m).then(y=>{this.response(a._id,y)}).catch(()=>{this.response(a._id,void 0,!0)});break;case Ar.ACK:this.getListeners("res-@".concat(s,"_ack")).length>0&&this.emit("res-@".concat(s,"_ack"));break;case Ar.RESPONSE:{const{success:y,message:_}=m;this.emit("res-@".concat(s),y?"success":"failed",_);break}}}}splitMessage(a){if(a.length<Cp.MAX_MESSAGE_SIZE)return[a];const s=[],{remoteToken:l}=JSON.parse(a),d=Mn(6,"");let f=0,m=800;const y=Math.ceil(a.length/m);for(;a.length>0;){f++;const _={id:d,index:f,total:y,payload:a.slice(0,m),token:"".concat(this.token,"_").concat(l)};JSON.stringify(_).length>Cp.MAX_MESSAGE_SIZE?m-=50:(s.push(_),a=a.slice(m))}return s.map(_=>JSON.stringify(_))}handleCheckToken(a,s){return a.token!==s?(V.debug("token changed, from ".concat(a.token," to ").concat(s)),this.reset(a.uid,s),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{V.debug("token timeout, ".concat(s)),this.reset(a.uid)},oe("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const a=await Li(this.signal,Ar.CALL,void 0),s=await this.send(Ar.CALL,a);this.signal.emit(It.P2P_CONNECTION,s,!0)}async reset(a,s){const l=this.userMap.get(a);l&&(this.emit(Lg.ABORT),this.signal.emit(en.ON_USER_OFFLINE,{uid:l.uid,reason:XIe.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),s||(V.debug("change local token from ".concat(s," to ").concat(s)),this.token=Mn(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Lg.ABORT)}}Q(Cp,"MAX_SIZE",1),Q(Cp,"MAX_MESSAGE_SIZE",1024);class Oke extends cr{get connectionState(){return this._connectionState}set connectionState(a){a!==this._connectionState&&(this._connectionState=a,a===Wn.CONNECTED?this.emit(It.WS_CONNECTED):a===Wn.RECONNECTING?this.emit(It.WS_RECONNECTING,this._websocketReconnectReason):a===Wn.CLOSED&&this.emit(It.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(a,s){super(),Q(this,"_disconnectedReason",void 0),Q(this,"_websocketReconnectReason",void 0),Q(this,"_connectionState",Wn.CLOSED),Q(this,"reconnectToken",void 0),Q(this,"p2pToken",void 0),Q(this,"websocket",void 0),Q(this,"openConnectionTime",void 0),Q(this,"clientId",void 0),Q(this,"lastMsgTime",Date.now()),Q(this,"uploadCache",[]),Q(this,"uploadCacheInterval",void 0),Q(this,"rttRolling",new wz(5)),Q(this,"pingpongTimer",void 0),Q(this,"pingpongTimeoutCount",0),Q(this,"joinResponse",void 0),Q(this,"multiIpOption",void 0),Q(this,"initError",void 0),Q(this,"spec",void 0),Q(this,"store",void 0),Q(this,"_external_signal",void 0),Q(this,"onWebsocketMessage",l=>{if(l.data instanceof ArrayBuffer)return void this.emit(It.ON_BINARY_DATA,l.data);const d=JSON.parse(l.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(d,"_id")){const f="res-@".concat(d._id);this.emit(f,d._result,d._message)}else if(Object.prototype.hasOwnProperty.call(d,"_type")){switch(d._type){case en.ON_DATA_STREAM:return void this.handleDataStream(d._message);case en.MUTE_AUDIO:case en.MUTE_VIDEO:case en.ON_P2P_LOST:case en.ON_USER_ONLINE:return;case en.ON_USER_OFFLINE:const{uid:f}=d._message;return V.debug("[".concat(this.clientId,"] user-offline uid: ").concat(f)),void this._external_signal.reset(f)}if(this.emit(d._type,d._message),d._type===en.ON_NOTIFICATION&&this.handleNotification(d._message),d._type===en.ON_USER_BANNED)switch(d._message.error_code){case 14:this.close(En.UID_BANNED);break;case 15:this.close(En.IP_BANNED);break;case 16:this.close(En.CHANNEL_BANNED)}if(d._type===en.ON_USER_LICENSE_BANNED)switch(d._message.error_code){case vt.ERR_LICENSE_MISSING:this.close(En.LICENSE_MISSING);break;case vt.ERR_LICENSE_EXPIRED:this.close(En.LICENSE_EXPIRED);break;case vt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(En.LICENSE_MINUTES_EXCEEDED);break;case vt.ERR_LICENSE_PERIOD_INVALID:this.close(En.LICENSE_PERIOD_INVALID);break;case vt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(En.LICENSE_MULTIPLE_SDK_SERVICE);break;case vt.ERR_LICENSE_ILLEGAL:this.close(En.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=a.clientId,this.spec=a,this.store=s,this.websocket=new mD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,oe("JOIN_GATEWAY_USE_DUAL_DOMAIN"),oe("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Wn.CONNECTED&&this.reconnect("retry",Di.OFFLINE)}),this.p2pToken=Mn(6,""),this._external_signal=new Cp(this,this.p2pToken)}async request(a,s,l,d){const f=Mn(6,""),m={_id:f,_type:a,_message:s},y=this.websocket.connectionID,_=()=>new He((K,$)=>{if(this.connectionState===Wn.CONNECTED)return K();const G=()=>{this.off(It.WS_CLOSED,ne),K()},ne=()=>{this.off(It.WS_CONNECTED,G),$(new we(ie.WS_ABORT))};this.once(It.WS_CONNECTED,G),this.once(It.WS_CLOSED,ne)});if(this.connectionState!==Wn.CONNECTING&&this.connectionState!==Wn.RECONNECTING||a===Ct.JOIN||a===Ct.REJOIN||await _(),this.websocket.sendMessage(m,!0),d)return;const S=new He((K,$)=>{let G=!1;const ne=(ce,pe)=>{G=!0,K({isSuccess:ce==="success",message:pe||{}}),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.emit(It.REQUEST_SUCCESS,a,s)};this.once("res-@".concat(f),ne);const te=()=>{$(new we(ie.WS_ABORT,"type: ".concat(a))),this.off(It.WS_CLOSED,te),this.off(It.WS_RECONNECTING,te),this.off("res-@".concat(f),ne)};this.once(It.WS_CLOSED,te),this.once(It.WS_RECONNECTING,te),Ti(oe("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==y||G||(V.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(a)),this.emit(It.REQUEST_TIMEOUT,a,s))})});let x=null;try{x=await S}catch(K){if(this.connectionState===Wn.CLOSED||a===Ct.LEAVE)throw new we(ie.WS_ABORT);return!this.spec.forceWaitGatewayResponse||l?K.throw():a===Ct.JOIN||a===Ct.REJOIN?null:(await _(),await this.request(a,s))}if(x.isSuccess)return x.message;const A=Number(x.message.error_code||x.message.code),I=bb(A),L=new we(ie.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(x.message.error_str),{code:A,data:x.message,desc:I.desc});return I.action==="success"?x.message:(V.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(a,", error_code: ").concat(A,", message: ").concat(I.desc,", action: ").concat(I.action)),A===vt.ERR_TOO_MANY_BROADCASTERS?((a===Ct.JOIN||a===Ct.REJOIN)&&(this.initError=L,this.close()),L.throw()):I.action==="failed"?L.throw():I.action==="quit"?(this.initError=L,this.close(),L.throw()):(A===vt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=x.message.option,V.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Di.MULTI_IP)):this.reconnect(I.action,Di.SERVER_ERROR),a===Ct.JOIN||a===Ct.REJOIN?null:await this.request(a,s)))}waitMessage(a,s){return new He(l=>{const d=f=>{(!s||s(f))&&(this.off(a,d),l(f))};this.on(a,d)})}uploadWRTCStats(a){if(!this.store.sessionId)return void V.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const s={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:a};this.upload(yb.WRTC_STATS,s)}upload(a,s){const l={_type:a,_message:s};try{this.websocket.sendMessage(l)}catch{const f=oe("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(l),this.uploadCache.length>f&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Wn.CONNECTED)return;const m=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(m._type,m._message)},oe("UPLOAD_CACHE_INTERVAL")||2e3))}}send(a,s){const l={_type:a,_message:s};this.websocket.sendMessage(l)}async sendExtensionMessage(a,s,l){return await this._external_signal.send(a,s,l)}init(a){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new He((s,l)=>{this.once(It.WS_CONNECTED,()=>s(this.joinResponse)),this.once(It.WS_CLOSED,()=>l(this.initError||new we(ie.WS_ABORT))),this.connectionState=Wn.CONNECTING,this.websocket.init(a).catch(l)})}close(a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=a||En.LEAVE,this.connectionState=Wn.CLOSED,V.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=Mn(6,""),this._external_signal.clear(),this._external_signal=new Cp(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(It.ABORT_P2P_EXECUTION);const a=await Li(this,It.REQUEST_JOIN_INFO),s=await this.request(Ct.JOIN,a);if(!s)return this.emit(It.REPORT_JOIN_GATEWAY,ie.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(It.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Wn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(a,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(a,s)}async downgradeCodec(a){return!1}handleDataStream(a){try{var s;const l=ap(a.payload),d=new TextDecoder().decode(l),f=JSON.parse(d);"total"in f&&"id"in f||Be(s=Object.values(Ar)).call(s,f._type)?(f._uid=a.uid,this._external_signal.onMessage(f)):this.emit(en.ON_DATA_STREAM,a)}catch{this.emit(en.ON_DATA_STREAM,a)}}handleNotification(a){V.debug("[".concat(this.clientId,"] receive notification: "),a);const s=bb(a.code);if(s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(En.UID_BANNED),void this.close()):void this.reconnect(s.action,Di.SERVER_ERROR);V.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const a=oe("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=a&&(V.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>oe("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Di.TIMEOUT):this.request(Ct.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const l=Date.now()-s;this.rttRolling.add(l),oe("REPORT_STATS")&&this.send(Ct.PING_BACK,{pingpongElapse:l})}).catch(l=>{})}handleWebsocketEvents(){this.websocket.on(Bt.RECONNECT_CREATE_CONNECTION,a=>{this.emit(It.WS_RECONNECT_CREATE_CONNECTION,a)}),this.websocket.on(Bt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Bt.CLOSED,()=>{this.connectionState=Wn.CLOSED}),this.websocket.on(Bt.FAILED,()=>{this._disconnectedReason=En.NETWORK_ERROR,this.connectionState=Wn.CLOSED}),this.websocket.on(Bt.RECONNECTING,a=>{this._websocketReconnectReason=a,this.joinResponse=void 0,this.connectionState===Wn.CONNECTED?this.connectionState=Wn.RECONNECTING:this.connectionState=Wn.CONNECTING}),this.websocket.on(Bt.WILL_RECONNECT,(a,s,l)=>{a!=="retry"?(V.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(a)),this.reconnectToken=void 0):V.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),l(a)}),this.websocket.on(Bt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(a=>{if(this.emit(It.REPORT_JOIN_GATEWAY,a,this.url||""),a instanceof we&&a.code===ie.UNEXPECTED_RESPONSE&&a.data.code===vt.ERR_NO_AUTHORIZED)return V.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Di.SERVER_ERROR);V.error("[".concat(this.clientId,"] join gateway request failed"),a.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Di.SERVER_ERROR):(this.initError=a,this.close())})}),this.websocket.on(Bt.REQUEST_NEW_URLS,(a,s)=>{Li(this,It.REQUEST_RECOVER,this.multiIpOption).then(a).catch(s)}),this.websocket.on(Bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(en.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const Pke={name:"P2PChannel",create:function(r){let{store:a,statsCollector:s}=r;return new Ike(a,s)},createSubmodule:function(r){let{store:a,spec:s}=r;return new Oke(s,a)}};function qX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function YX(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?qX(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):qX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}class kke{constructor(a){Q(this,"sessionDesc",void 0),Q(this,"localCapabilities",void 0),Q(this,"rtpCapabilities",void 0),Q(this,"candidates",void 0),Q(this,"_originCandidates",void 0),Q(this,"iceParameters",void 0),Q(this,"dtlsParameters",void 0),Q(this,"setup",void 0),Q(this,"currentMidIndex",void 0),Q(this,"cname",void 0),a=ir(a);const{iceParameters:s,dtlsParameters:l,candidates:d,rtpCapabilities:f,setup:m,localCapabilities:y,sdkCodec:_,cname:S}=a,x=ss(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=f,this.candidates=d,this._originCandidates=ir(d),this.iceParameters=s,this.dtlsParameters=l,this.setup=m,this.localCapabilities=y,this.cname=S;for(let A=0;A<x.mediaDescriptions.length;A++){const I=x.mediaDescriptions[A];if(I.attributes.iceUfrag=s.iceUfrag,I.attributes.icePwd=s.icePwd,I.attributes.fingerprints=l.fingerprints,I.attributes.candidates=d,I.attributes.setup=m,I.media.mediaType==="video"){I.media.fmts=f.videoCodecs.map($=>$.payloadType.toString(10));const L=f.videoCodecs.filter($=>{var G,ne;return(G=$.rtpMap)===null||G===void 0?void 0:Be(ne=G.encodingName.toLowerCase()).call(ne,_)}),K=f.videoCodecs.filter($=>!Be(L).call(L,$));I.attributes.payloads=[...L,...K],I.attributes.extmaps=f.videoExtensions}I.media.mediaType==="audio"&&(I.media.fmts=f.audioCodecs.map(L=>L.payloadType.toString(10)),I.attributes.payloads=f.audioCodecs,I.attributes.extmaps=f.audioExtensions),x.mediaDescriptions[A]=this.mungMediaDesc(I)}this.sessionDesc=x,this.currentMidIndex=x.mediaDescriptions.length-1}toString(){return hh(this.sessionDesc)}send(a,s,l){const{ssrcs:d,ssrcGroups:f}=xb(s,this.cname),m=this.sessionDesc.mediaDescriptions.find(S=>a===Je.VIDEO?S.media.mediaType==="video":S.media.mediaType==="audio"),y=d[0].attributes.label,_=d[0].attributes.mslabel;return m.attributes.ssrcs=m.attributes.ssrcs.concat(d),m.attributes.ssrcGroups=m.attributes.ssrcGroups.concat(f),{id:y,mslabel:_}}batchSend(a){return a.map(s=>{let{kind:l,ssrcMsg:d}=s;return this.send(l,d,void 0)})}stopSending(a){this.sessionDesc.mediaDescriptions.forEach(s=>{const l=[],d=[],f=[];s.attributes.ssrcs.forEach(m=>{Be(a).call(a,m.attributes.label||"")?f.push(m):l.push(m)}),s.attributes.ssrcGroups.forEach(m=>{var y;Be(y=f.map(_=>_.ssrcId)).call(y,m.ssrcIds[0])||d.push(m)}),s.attributes.ssrcs=l,s.attributes.ssrcGroups=d})}mute(a){const s=this.sessionDesc.mediaDescriptions.find(l=>l.attributes.mid===a);if(!s)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.mute."));s.attributes.direction="inactive"}unmute(a){const s=this.sessionDesc.mediaDescriptions.find(l=>l.attributes.mid===a);if(!s)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.unmute."));s.attributes.direction="sendonly"}receive(a,s,l){a.forEach((d,f)=>{const m=d._mediaStreamTrack,y=this.sessionDesc.mediaDescriptions.findIndex(S=>S.attributes.mid===m.kind),_=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[y],d);this.sessionDesc.mediaDescriptions[y]=_})}stopReceiving(a){}updateCandidates(a){const s=this._originCandidates.filter(d=>d.transport==="udp"),l=[];if(s.forEach(d=>{l.push(YX(YX({},d),{},{foundation:"tcpcandidate",priority:Number(d.priority)-1+"",transport:"tcp",port:Number(d.port)+90+""}))}),s.length!==0){switch(a){case qi.TCP_RELAY:this.candidates=l;break;case qi.UDP_TCP_RELAY:case qi.RELAY:this.candidates=[...s,...l];break;default:this.candidates=s}for(const d of this.sessionDesc.mediaDescriptions)d.attributes.candidates=this.candidates}}restartICE(a){a=ir(a),this.iceParameters=a,this.sessionDesc.mediaDescriptions.forEach(s=>{s.attributes.iceUfrag=a.iceUfrag,s.attributes.icePwd=a.icePwd})}predictReceivingMids(a){const s=[];for(let l=0;l<a;l++)s.push((this.currentMidIndex+l+1).toString(10));return s}mungRecvMediaDsec(a,s){const l=ir(a);return Fg(l,s),_D(l,s),l}updateRecvMedia(a,s){const l=this.sessionDesc.mediaDescriptions.findIndex(d=>d.attributes.mid===a);if(l!==-1){const d=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[l],s);this.sessionDesc.mediaDescriptions[l]=d}}bumpMid(a){this.currentMidIndex+=a}updateTrackLabel(a,s,l){const d=this.sessionDesc.mediaDescriptions.find(m=>a===Je.VIDEO?m.attributes.mid==="video":m.attributes.mid==="audio");if(d){const m=d.attributes.ssrcs.find(y=>y.attributes.label===s);var f;m&&(m.attributes.label=l,(f=m.attributes.msid)===null||f===void 0||f.replace(s,l))}}mungMediaDesc(a){const s=ir(a);return yD(s),function(l){const d=l.attributes.extmaps.find(f=>TT(f.extensionName));d&&l.attributes.extmaps.splice(l.attributes.extmaps.indexOf(d),1),l.attributes.payloads.forEach(f=>{const m=f.rtcpFeedbacks.findIndex(y=>y.type==="transport-cc");m!==-1&&f.rtcpFeedbacks.splice(m,1)})}(s),s}getSSRC(a){for(const s of this.sessionDesc.mediaDescriptions)for(const l of s.attributes.ssrcs)if(l.attributes.label===a)return[l]}}var Un;function XX(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable})),s.push.apply(s,l)}return s}function dC(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?XX(Object(s),!0).forEach(function(l){Q(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):XX(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}let jke=(Un=class LE extends lK{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(a=>a.rtpMap&&a.rtpMap.encodingName.toLowerCase()||"").filter(a=>{var s;return Be(s=Object.keys(fb)).call(s,a)}))]}constructor(a,s){super(a,s),Q(this,"store",void 0),Q(this,"peerConnection",void 0),Q(this,"remoteSDP",void 0),Q(this,"initialOffer",void 0),Q(this,"statsFilter",void 0),Q(this,"useRTX",!1),Q(this,"localCapabilities",void 0),Q(this,"localCandidateCount",0),Q(this,"allCandidatesReceived",!1),Q(this,"establishPromise",void 0),Q(this,"mutex",void 0),this.store=s,this.mutex=new Hi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(LE.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.statsFilter=Rj(this.peerConnection,oe("STATS_UPDATE_INTERVAL"),void 0,dr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const a=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!a.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=yh(a.sdp),l=Sb(a.sdp,{filterRTX:!this.useRTX,filterVideoFec:oe("FILTER_VIDEO_FEC"),filterAudioFec:oe("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=l,this.initialOffer=a,dC(dC({},s),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:l},offerSDP:a.sdp})}catch(a){throw new we(ie.GET_LOCAL_CONNECTION_PARAMS_FAILED,a.toString())}}async updateRemoteConnect(){}async connect(a){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new kke(dC(dC({},a),{},{rtpCapabilities:a.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const s=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async updateRemoteRTPCapabilities(a,s){throw new we(ie.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(a){}send(a,s){var l=this;return So(function*(){const d=yield ln(l.mutex.lock());try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const f=a.map(I=>l.peerConnection.addTrack(I._mediaStreamTrack)),m=yield ln(l.peerConnection.createOffer()),y=ss(m.sdp),_=a.map(I=>{const L=I._mediaStreamTrack,K=y.mediaDescriptions.find($=>$.attributes.mid===L.kind);if(!K)throw new Error("Cannot extract ssrc from mediaDescription.");return function($,G,ne){const te=$.attributes.ssrcs.filter(pe=>pe.attributes.label===G),ce=$.attributes.ssrcGroups;if(te.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(ce&&te.length>1){const pe=ce.find(fe=>fe.ssrcIds.indexOf(te[0].ssrcId)!==-1);return pe?[{ssrcId:pe.ssrcIds[0],rtx:ne?pe.ssrcIds[1]:void 0}]:[{ssrcId:te[0].ssrcId}]}return[{ssrcId:te[0].ssrcId}]}(K,L.id,l.useRTX)});let S;try{S=yield _}catch(I){throw f.forEach(L=>{ji()&&L.replaceTrack(null),l.peerConnection.removeTrack(L)}),I}const x=l.mungSendOfferSDP(m.sdp,a);l.remoteSDP.receive(a,s,S);const A=l.remoteSDP.toString();return yield ln(l.peerConnection.setLocalDescription({type:"offer",sdp:x})),yield ln(l.applySendEncodings(f,a)),yield ln(l.peerConnection.setRemoteDescription({type:"answer",sdp:A})),a.map((I,L)=>{const K=I._mediaStreamTrack.id;return{localSSRC:_[L],id:K}})}catch(f){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(f.toString()))}finally{d()}})()}async stopSending(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const s=this.peerConnection.getSenders().filter(f=>{var m;return a.indexOf(((m=f.track)===null||m===void 0?void 0:m.id)||"")!==-1});if(s.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");s.map(f=>{ji()&&f.replaceTrack(null),this.peerConnection.removeTrack(f)});const l=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(a);const d=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(s.toString()))}}async receive(a,s,l,d){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{id:f,mslabel:m}=this.remoteSDP.send(a,s,d),y=new He((x,A)=>{const I=setTimeout(()=>{A(new Error("Cannot receive track, id: ".concat(f)))},1e4),L=K=>{const $=an();if(($.name==="Safari"&&Number($.version)===11||oa())&&K.track.id!==f&&K.streams[0].id===m){var G;const ne=K.streams[0].getTracks()[0];return(G=this.remoteSDP)===null||G===void 0||G.updateTrackLabel(a,f,K.track.id),this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x(ne)}if(K.track.id===f)return this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x(K.track)};this.peerConnection.addEventListener("track",L)}),_=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_});const S=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(S),{track:await y,id:f}}catch(f){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(l)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(a){}async unmuteRemote(a){}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(l=>{var d;return a.indexOf(((d=l.track)===null||d===void 0?void 0:d.id)||"")!==-1});if(s.length!==a.length)throw new Error("sender' length doesn't match mids' length.");s.map(l=>{if(ji()&&l.track)l.track.enabled=!1;else{const d=l.getParameters();d.encodings.forEach(f=>f.active=!1),l.setParameters(d)}})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(f=>{var m;return a.indexOf(((m=f.track)===null||m===void 0?void 0:m.id)||"")!==-1});if(s.length!==a.length)throw new Error("Senders' length doesn't match mids' length.");s.map(async f=>{if(ji()&&f.track)f.track.enabled=!0;else{const m=f.getParameters();m.encodings.forEach(y=>y.active=!0),await f.setParameters(m)}});const l=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(l);const d=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(a){var s=this;return So(function*(){const l=yield ln(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const d=un().supportPCSetConfiguration;if(a===qi.RELAY&&!d)return;if(d){const S=s.peerConnection.getConfiguration(),x=a===qi.RELAY?"relay":"all";S.iceTransportPolicy!==x&&(V.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(S.iceTransportPolicy,"] to [").concat(x,"]")),S.iceTransportPolicy=x,s.peerConnection.setConfiguration(S))}a!==qi.RELAY&&s.remoteSDP.updateCandidates(a);const f=yield ln(s.peerConnection.createOffer({iceRestart:!0}));if(!f.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const m=yh(f.sdp),{remoteIceParameters:y}=yield m.iceParameters;s.remoteSDP.restartICE(y);const _=s.remoteSDP.toString();yield ln(s.peerConnection.setLocalDescription(f)),yield ln(s.peerConnection.setRemoteDescription({type:"answer",sdp:_}))}catch(d){V.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),d)}finally{l()}})()}close(){var a;this.peerConnection.close(),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const l=await this.peerConnection.createOffer(),d=this.mungSendOfferSDP(l.sdp,[s]);this.remoteSDP.updateRecvMedia(s._mediaStreamTrack.kind,s);const f=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:d}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new we(ie.EXCHANGE_SDP_FAILED,l.toString())}}async updateSendParameters(a,s){const l=this.peerConnection.getSenders().filter(d=>{var f;return((f=d.track)===null||f===void 0?void 0:f.id)===a});l.length===1&&await this.applySendEncodings(l,[s])}setStatsRemoteVideoIsReady(a,s){this.statsFilter.setVideoIsReady2(a,s)}async replaceTrack(a,s){const l=this.peerConnection.getSenders().find(d=>{var f;return((f=d.track)===null||f===void 0?void 0:f.id)===s});l&&await l.replaceTrack(a._mediaStreamTrack)}createDataChannels(a,s){throw new we(ie.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(a){throw new we(ie.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,V.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,V.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},oe("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const s={iceServers:[],sdpSemantics:"plan-b"};return a.iceServers?s.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(cb(a.turnServer.servers)?s.iceServers=a.turnServer.servers:(s.iceServers&&s.iceServers.push(...LE.turnServerConfigToIceServers(a.turnServer.servers)),oe("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&a.turnServer.serversFromGateway&&s.iceServers.push(...LE.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(l=>{l.forceturn&&(s.iceTransportPolicy="relay")}))),s}static turnServerConfigToIceServers(a){const s=[];return a.forEach(l=>{l.security?l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turns:".concat(l.turnServerURL,":").concat(l.tcpport,"?transport=tcp")}):(l.udpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.udpport,"?transport=udp")}),l.tcpport&&s.push({username:l.username,credential:l.password,credentialType:"password",urls:"turn:".concat(l.turnServerURL,":").concat(l.tcpport,"?transport=tcp")}))}),s}async updateRtpSenderEncodings(a,s){var l;if(s||(s=this.peerConnection.getSenders().find(S=>{var x;return((x=S.track)===null||x===void 0?void 0:x.id)===a._mediaStreamTrack.id})),!s)return V.warn("[".concat(a.getTrackId(),"] no rtpSender found}"));if(!un().supportSetRtpSenderParameters)return V.warn("Browser not support set rtp-sender parameters");const d={},f={};if(a instanceof Gn)switch(a._optimizationMode){case"motion":d.degradationPreference="maintain-framerate";break;case"detail":d.degradationPreference="maintain-resolution";break;default:d.degradationPreference="balanced"}if(oe("DSCP_TYPE")&&rd()){var m;const S=oe("DSCP_TYPE");Be(m=["very-low","low","medium","high"]).call(m,S)&&(f.networkPriority=S)}const y=s.getParameters(),_=(l=y.encodings)===null||l===void 0?void 0:l[0];_&&Object.assign(_,f),Object.assign(y,d),V.debug("[".concat(a.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(y.encodings))),await s.setParameters(y)}async applySendEncodings(a,s){try{if(!un().supportSetRtpSenderParameters||a.length!==s.length)return;for(let l=0;l<a.length;l++){const d=a[l],f=s[l];d&&f&&await this.updateRtpSenderEncodings(f,d)}}catch{V.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(a,s){const l=ss(a);return s.forEach((d,f)=>{const m=d._mediaStreamTrack,y=l.mediaDescriptions.find(_=>_.attributes.mid===m.kind);y&&Fg(y,d)}),hh(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,s,l)=>{var d;(d=this.onFirstVideoDecoded)===null||d===void 0||d.call(this,a,s,l)},this.statsFilter.onSelectedLocalCandidateChanged=(a,s)=>{var l;(l=this.onSelectedLocalCandidateChanged)===null||l===void 0||l.call(this,a,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,s)=>{var l;(l=this.onSelectedRemoteCandidateChanged)===null||l===void 0||l.call(this,a,s)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const s=this.remoteSDP.batchSend(a).map((f,m)=>{let{id:y,mslabel:_}=f;const{kind:S}=a[m];return new He((x,A)=>{const I=setTimeout(()=>{A(new Error("Cannot receive track, id: ".concat(y)))},1e4),L=K=>{const $=an();if($.name==="Safari"&&Number($.version)===11&&K.track.id!==y&&K.streams[0].id===_){var G;const ne=K.streams[0].getTracks()[0];return(G=this.remoteSDP)===null||G===void 0||G.updateTrackLabel(S,y,K.track.id),this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x({track:ne,id:y})}if(K.track.id===y)return this.peerConnection.removeEventListener("track",L),clearTimeout(I),void x({track:K.track,id:y})};this.peerConnection.addEventListener("track",L)})}),l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const d=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(d),await He.all(s)}catch(s){throw new we(ie.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async getRemoteSSRC(a){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(a);return s==null?void 0:s[0].ssrcId}setConfiguration(a){if(un().supportPCSetConfiguration){const s=LE.resolvePCConfiguration(a);this.peerConnection.setConfiguration(s)}}},rt(Un.prototype,"connect",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"connect"),Un.prototype),rt(Un.prototype,"stopSending",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"stopSending"),Un.prototype),rt(Un.prototype,"receive",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"receive"),Un.prototype),rt(Un.prototype,"stopReceiving",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"stopReceiving"),Un.prototype),rt(Un.prototype,"muteRemote",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"muteRemote"),Un.prototype),rt(Un.prototype,"unmuteRemote",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"unmuteRemote"),Un.prototype),rt(Un.prototype,"muteLocal",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"muteLocal"),Un.prototype),rt(Un.prototype,"unmuteLocal",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"unmuteLocal"),Un.prototype),rt(Un.prototype,"close",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"close"),Un.prototype),rt(Un.prototype,"updateEncoderConfig",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"updateEncoderConfig"),Un.prototype),rt(Un.prototype,"updateSendParameters",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"updateSendParameters"),Un.prototype),rt(Un.prototype,"replaceTrack",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"replaceTrack"),Un.prototype),rt(Un.prototype,"getRemoteSSRC",[Po],Object.getOwnPropertyDescriptor(Un.prototype,"getRemoteSSRC"),Un.prototype),Un);function Po(r,a,s){const l=r[a];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const d=this.mutex,f=await d.lock("Locking from P2PConnection.".concat(a));try{for(var m=arguments.length,y=new Array(m),_=0;_<m;_++)y[_]=arguments[_];return await l.apply(this,y)}finally{f()}},s}const Dke={name:"PlanBConnection",create:function(r){let{store:a,spec:s}=r;return new jke(s,a)}},Lke={interceptLocalAudioFrame:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!un().supportWebRTCEncodedTransform)return void V.warning("browser not support audio encoded transform");if(cT.has(r)||!r.track)return;const s={track:r.track};if(nd()){if(!r.createEncodedStreams)return void V.warning("browser not support createEncodedStreams() API");let d=null;try{d=r.createEncodedStreams()}catch(m){return void V.error("create audio-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(V.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l));const _=a.metadata&&a.metadata();_?function(S,x){const{chunk:A,controller:I}=x,L=fh.METADATA;A.data=function(K,$,G){const ne=G.byteLength,te=ne+Zj+z7,ce=Xj+Jj+te,pe=new ArrayBuffer(K.byteLength+ce),fe=new DataView(pe);fe.setUint8(0,H7),fe.setUint16(1,te),fe.setUint8(3,$),fe.setUint16(4,ne);for(let ye=0;ye<ne;ye++)fe.setUint8(6+ye,G[ye]);const ue=new Uint8Array(fe.buffer);return ue.set(new Uint8Array(K),ce),ue.buffer}(A.data,L,S),I.enqueue(A)}(_,{chunk:m,controller:y}):y.enqueue(m)}});d.readable.pipeThrough(f).pipeTo(d.writable)}else if(ji()){if(typeof RTCRtpScriptTransform>"u")return void V.warning("browser not support RTCRtpScriptTransform");const d=oT(),f=new MessageChannel;await new He(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"audio-metadata-tx",port:f.port2},[f.port2]);r.transform=m,await new He(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),f.port1.onmessage=y=>{var _;if(y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id)V.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l);else if(y.data.getMetadata){const S=a.metadata&&a.metadata();S&&f.port1.postMessage({metadata:S})}},s.worker=d}function l(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",l)}const d=cT.get(r);if(d){cT.delete(r);try{var f,m;(f=d.controller)===null||f===void 0||f.terminate(),(m=d.worker)===null||m===void 0||m.terminate()}catch(y){V.warning(y&&y.message)}}}cT.set(r,s),r.track.addEventListener("ended",l)},interceptRemoteAudioFrame:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!un().supportWebRTCEncodedTransform)return void V.warning("browser not support audio encoded transform");if(pT.has(r))return;const s={track:r.track,onMetadata:a.onMetadata,onPts:a.onPts};if(nd()&&!oa()){if(!r.createEncodedStreams)return void V.warning("browser not support createEncodedStreams() API");oj(fn.CHROME,87,116)||(a.enableTopn=!1);let d=null;try{d=r.createEncodedStreams()}catch(m){return void V.error("create audio-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(V.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l)),a.enableTopn?function(_,S,x){var A;const I=Qj(new DataView(S.data));if(!I)return x.enqueue(S);const L=_.track.id;vIe.set(L,_.track);const K=(A=I.tlv.find(pe=>pe.tag===fh.AUDIO_LEVEL))===null||A===void 0?void 0:A.value;let $=0;typeof K=="number"&&($=127-K);const G=Math.round(Math.pow(10,$/60)-1),{selected:ne,speaker:te}=function(pe,fe){let ue=Pg.get(pe);if(ue||(ue=function(ye){const Se=new q7;return Pg.set(ye,Se),rl||(rl=new mIe(oe("TOPN_SILENCE_THRESHOLD")||500),rl.on("ActiveSpeakerChanged",Ie=>{Ie!=null&&(dT=Ie)})),rl.addSpeakers([Se]),Se}(pe)),Pg.size<=Y7)return{selected:!0,speaker:ue};if(!rl)throw new Error("no active speaker detector");return rl.levelChanged(ue.id,fe),hp=rl.loudest.map(ye=>ye.id),dT&&!Be(hp).call(hp,dT)&&hp.length>=Y7&&hp.pop(),{selected:Be(hp).call(hp,ue.id)||ue.id===dT,speaker:ue}}(_,G),ce=function(pe,fe,ue){const ye=il.get(pe)||new gIe(pe,fe);return ye.score=ue,il.set(pe,ye),function(Se){if(hT.set(Se,!0),!fT)return void(fT=Date.now());const Ie=Date.now();Ie-fT>1e3&&(hT.get(Se)?hT.set(Se,!1):(X7(Se),hT.delete(Se)),fT=Ie)}(pe),ye}(L,_.track,te.energyScore);ce.addSample(ne),ce.active&&(S.data=I.frame.buffer,x.enqueue(S))}(r,m,y):a.enableMetadata||a.enablePts?function(_,S,x,A){const I=new DataView(_.data),L=I.getUint8(0);let K;if(128&L&&L!==71){const ne=function(te){if(te.byteLength<=0)return[];const ce=[];let pe=0;for(;pe<te.byteLength;){const ue=(128&te.getUint8(pe))>>7,ye=127&te.getUint8(pe);if(!(ue&&pe+4<=te.byteLength)){pe++;break}{const Se=te.getUint32(pe,!1),Ie=(16776192&Se)>>10,Me=1023&Se;ce.push({pt:ye,ts_offset:Ie,length:Me,data:new Uint8Array}),pe+=4}}let fe=te.byteLength-pe;for(const ue of ce){if(ue.length>fe)return console.warn("Broken red payload"),[];ue.length>0&&(ue.data=new Uint8Array(te.buffer,te.byteOffset+pe,ue.length),pe+=ue.length,fe-=ue.length)}if(fe>0){const ue={pt:ce.length>0?ce[ce.length-1].pt:0,ts_offset:0,length:fe,data:new Uint8Array(te.buffer,te.byteOffset+pe,fe)};ce.push(ue)}return ce}(I);if(ne.length>0){const te=function(ce){let pe=0;for(let ye=0;ye<ce.length;ye++)pe+=ye<ce.length-1?4:1,pe+=ce[ye].length;const fe=new Uint8Array(pe);let ue=0;for(let ye=0;ye<ce.length;ye++)if(ye<ce.length-1){const Se=(2147483648|(127&ce[ye].pt)<<24|(262143&ce[ye].ts_offset)<<10|1023&ce[ye].length)>>>0;fe[ue++]=Se>>24&255,fe[ue++]=Se>>16&255,fe[ue++]=Se>>8&255,fe[ue++]=255&Se}else fe[ue++]=127&ce[ye].pt;for(const ye of ce)fe.set(ye.data,ue),ue+=ye.length;return fe}(ne.map(ce=>{const pe=new Uint8Array(ce.length);pe.set(ce.data);const fe=Qj(new DataView(pe.buffer));return fe!=null&&fe.frame&&(ce.data=fe==null?void 0:fe.frame),K=fe,ce}));_.data=te.buffer}}else K=Qj(I),K&&(_.data=K.frame.buffer);if(S.enqueue(_),!K)return;const $=K.tlv.find(ne=>ne.tag===fh.METADATA);$&&x&&$.value instanceof Uint8Array&&x($.value);const G=K.tlv.find(ne=>ne.tag===fh.AUDIO_64_BIT_PTS);G&&A&&G.value instanceof Uint8Array&&G.value.length==8&&A(new DataView(G.value.buffer).getBigUint64(0,!0))}(m,y,a.onMetadata,a.onPts):y.enqueue(m)}});d.readable.pipeThrough(f).pipeTo(d.writable)}else{if(typeof RTCRtpScriptTransform>"u")return void V.warning("browser not support RTCRtpScriptTransform");const d=oT(),f=new MessageChannel;await new He(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"audio-metadata-rx",port:f.port2},[f.port2]);r.transform=m,await new He(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),f.port1.onmessage=y=>{var _;y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id?(V.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l)):y.data.metadata&&s.onMetadata?s.onMetadata(y.data.metadata):y.data.pts&&s.onPts&&s.onPts(y.data.pts)},s.worker=d}function l(){r.track.removeEventListener("ended",l),function(d){const f=pT.get(d);if(f){(function(_){const S=Pg.get(_);S&&(Pg.delete(_),rl&&(rl.removeSpeakers([S]),Pg.size===0&&(rl.destroy(),rl=null)))})(d),X7(d.track.id),pT.delete(d);try{var m,y;(m=f.controller)===null||m===void 0||m.terminate(),(y=f.worker)===null||y===void 0||y.terminate()}catch(_){V.warning(_&&_.message)}}}(r)}pT.set(r,s),r.track.addEventListener("ended",l)},interceptLocalVideoFrame:async function(r,a){if(!un().supportWebRTCEncodedTransform)return void V.warning("browser not support video encoded transform");if(mT.has(r)||!r.track)return;const s={track:r.track};if(nd()){if(!r.createEncodedStreams)return void V.warning("browser not support createEncodedStreams() API");let d=null;try{d=r.createEncodedStreams()}catch(y){return void V.error("create video-encoded-streams error",y&&y.message)}const f=[];a.on("sei-to-send",y=>{f.push(y)});const m=new TransformStream({transform(y,_){s.controller||(s.controller=_),r.track&&r.track.id!==s.track.id&&(V.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l));const S=Q7(new Uint8Array(y.data)),x=f.shift();if(x){const A=function(I,L,K){switch(K){case rD:return function($,G){const ne=Z7(G),te=ne.length,ce=Math.floor(te/255),pe=te%255,fe=new Uint8Array(6+ce+1+te+$.byteLength);fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe[4]=6,fe[5]=101;let ue=0;for(;ue<ce;)fe[6+ue]=255,ue++;return fe[6+ue]=pe,ue++,fe.set(ne,6+ue),fe.set(new Uint8Array($),6+ue+te),fe.buffer}(I,L);case iD:return function($,G){const ne=Z7(G),te=ne.length,ce=Math.floor(te/255),pe=te%255,fe=new Uint8Array(7+ce+1+te+1+$.byteLength);fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe[4]=78,fe[5]=1,fe[6]=101;let ue=0;for(;ue<ce;)fe[7+ue]=255,ue++;return fe[7+ue]=pe,ue++,fe.set(ne,7+ue),ue+=te,fe[7+ue]=128,ue++,fe.set(new Uint8Array($),7+ue),fe.buffer}(I,L);default:return null}}(y.data,x,S);A&&(y.data=A)}_.enqueue(y)}});d.readable.pipeThrough(m).pipeTo(d.writable)}else{if(!ji())return;{if(typeof RTCRtpScriptTransform>"u")return void V.warning("browser not support RTCRtpScriptTransform");const d=oT(),f=new MessageChannel;await new He(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"sei-tx",port:f.port2},[f.port2]);r.transform=m,await new He(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),a.on("sei-to-send",y=>{f.port1.postMessage({sei:y})}),f.port1.onmessage=y=>{var _;y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id&&(V.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l))},s.worker=d}}function l(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",l)}const d=mT.get(r);if(d){mT.delete(r);try{var f,m;(f=d.controller)===null||f===void 0||f.terminate(),(m=d.worker)===null||m===void 0||m.terminate()}catch(y){V.warning(y&&y.message)}}}mT.set(r,s),r.track.addEventListener("ended",l)},interceptRemoteVideoFrame:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!un().supportWebRTCEncodedTransform)return void V.warning("browser not support video encoded transform");if(!r.track)return;if(vb.has(r)){const d=vb.get(r);return void(d&&(d.onSei=a.onSei))}const s={track:r.track,onSei:a.onSei};if(nd()){if(!r.createEncodedStreams)return void V.warning("browser not support createEncodedStreams() API");let d=null;try{d=r.createEncodedStreams()}catch(m){return void V.error("create video-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(V.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l));const _=function(S,x){switch(x){case rD:return function(A){const I=new DataView(A.data);let L=0;for(;L+4<A.data.byteLength;){if(I.getUint8(L+0)===0&&I.getUint8(L+1)===0&&I.getUint8(L+2)===0&&I.getUint8(L+3)===1&&I.getUint8(L+4)===6){let K=L+6,$=0,G=0;for(;(G=I.getUint8(K++))===255;)$+=255;$+=G;const ne=J7(A.data,K,$);return new Uint8Array(ne)}L++}return null}(S);case iD:return function(A){const I=new DataView(A.data);let L=0;for(;L+5<A.data.byteLength;){if(I.getUint8(L+0)===0&&I.getUint8(L+1)===0&&I.getUint8(L+2)===0&&I.getUint8(L+3)===1&&I.getUint8(L+4)===78&&I.getUint8(L+5)===1&&I.getUint8(L+6)===101){let K=L+7,$=0,G=0;for(;(G=I.getUint8(K++))===255;)$+=255;$+=G;const ne=J7(A.data,K,$);return new Uint8Array(ne)}L++}return null}(S);default:return null}}(m,Q7(new Uint8Array(m.data)));_&&s.onSei&&s.onSei(_),y.enqueue(m)}});d.readable.pipeThrough(f).pipeTo(d.writable)}else if(ji()){if(typeof RTCRtpScriptTransform>"u")return void V.warning("browser not support RTCRtpScriptTransform");const d=oT(),f=new MessageChannel;await new He(y=>d.onmessage=_=>{_.data==="registered"&&y(void 0)});const m=new RTCRtpScriptTransform(d,{name:"sei-rx",port:f.port2},[f.port2]);r.transform=m,await new He(y=>d.onmessage=_=>{_.data==="started"&&y(void 0)}),f.port1.onmessage=y=>{var _;y.data.transformed&&r.track&&((_=r.track)===null||_===void 0?void 0:_.id)!==s.track.id?(V.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",l),s.track=r.track,s.track.addEventListener("ended",l)):y.data.sei&&s.onSei&&s.onSei(y.data.sei)},s.worker=d}function l(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",l)}(function(d){const f=vb.get(d);if(f){vb.delete(d);try{var m,y;(m=f.controller)===null||m===void 0||m.terminate(),(y=f.worker)===null||y===void 0||y.terminate()}catch(_){V.warning(_&&_.message)}}})(r)}vb.set(r,s),r.track.addEventListener("ended",l)}},Mke={name:"InterceptFrame",create:()=>Lke};Nj(),An("PROCESS_ID","process-".concat(Mn(8,""),"-").concat(Mn(4,""),"-").concat(Mn(4,""),"-").concat(Mn(4,""),"-").concat(Mn(12,""))),function(){let r;try{r=window.localStorage.getItem("websdk_ng_global_parameter")}catch(a){return void V.error("Error loading sdk config",a.message)}if(r)try{const a=JSON.parse(window.atob(r)),s=Date.now();V.debug("Loading global parameters from cache",a),Object.keys(a).forEach(l=>{if(Object.prototype.hasOwnProperty.call(Zn,l)){const{value:d,expires:f}=a[l];if(f&&f<=s)return;nl[l]=d,Zn[l]=d}})}catch(a){V.error("Error loading mutableParamsCache: ".concat(r),a.message)}}(),Array.isArray(nl.AREAS)&&nl.AREAS.length>0&&SD(nl.AREAS,!0);const JX=(r,a,s)=>{V.debug("setParameter key:".concat(r,", value:").concat(JSON.stringify(a))),An(r,a,s)};Eh(ske,!1),Eh(lke,!1),Eh($Oe,!1),Eh(bke,!1),Eh(rke,!1),Eh(Pke,!1),Eh(Dke,!1),Eh(Mke,!1);const Hr=function(r){const a=new cr,s=r,l={getListeners:a.getListeners.bind(a),on:(d,f)=>(function(m,y){m===au.SECURITY_POLICY_VIOLATION&&OY(y,!0)}(d,f),a.on.bind(a)(d,f)),addListener:a.addListener.bind(a),once:a.once.bind(a),off:a.off.bind(a),removeAllListeners:a.removeAllListeners.bind(a),emit:a.emit.bind(a),safeEmit:a.safeEmit.bind(a)};return IY(IY({},s),l)}({__TRACK_LIST__:Sg,VERSION:xo,BUILD:Oj,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:JX,getParameter:oe,getSupportedCodec:async function(){let r={audio:[],video:[]};try{let a=new RTCPeerConnection;const s=await async function(l){let d;return un().supportUnifiedPlan?(l.addTransceiver("video",{direction:"recvonly"}),l.addTransceiver("audio",{direction:"recvonly"}),d=(await l.createOffer()).sdp):d=(await l.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,d}(a);if(!s)return r;a.close(),a=null,r=function(l){const d={video:[],audio:[]};return l.match(/ VP8/i)&&d.video.push("VP8"),l.match(/ VP9/i)&&d.video.push("VP9"),l.match(/ AV1/i)&&d.video.push("AV1"),l.match(/ H264/i)&&d.video.push("H264"),l.match(/ H265/i)&&d.video.push("H265"),l.match(/ opus/i)&&d.audio.push("OPUS"),l.match(/ PCMU/i)&&d.audio.push("PCMU"),l.match(/ PCMA/i)&&d.audio.push("PCMA"),l.match(/ G722/i)&&d.audio.push("G722"),d}(s)}catch(a){throw new Ee(ie.CREATE_OFFER_FAILED,a.toString&&a.toString()).print()}return r},checkSystemRequirements:function(){const r=it.reportApiInvoke(null,{name:Er.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:rr.TRACER});let a=!1;try{const f=window.RTCPeerConnection,m=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,y=window.WebSocket;a=!!(f&&m&&y),a&&fj()&&JH(75)&&new f().close()}catch(f){return V.error("check system requirement failed: ",f),!1}let s=!1;const l=an();l.name===fn.CHROME&&Number(l.version)>=58&&(Qc.engine.name!=="WebKit"||function(){const f=an();if(Gx()){if(f.os===oi.MAC_OS)return!0;if(f.os===oi.IOS){const m=Qc.os.version&&Qc.os.version.split(".");if(m&&Number(m[0])===14&&m[1]&&Number(m[1])>=3||m&&Number(m[0])>14)return!0}}return!1}())&&(s=!0),(l.name===fn.FIREFOX&&Number(l.version)>=56||l.name===fn.OPERA&&Number(l.version)>=45||l.name===fn.SAFARI&&Number(l.version)>=11||l.name==="WebKit"&&(oa()||uc())&&l.osVersion&&Number(l.osVersion.split(".")[0])>=11||rz()||an().name===fn.QQ)&&(s=!0),V.debug("checkSystemRequirements, api:",a,"browser",s);const d=a&&s;return r.onSuccess(d),d},getDevices:function(r){return eo.enumerateDevices(!0,!0,r)},getMicrophones:function(r){return eo.getRecordingDevices(r)},getCameras:function(r){return eo.getCamerasDevices(r)},getElectronScreenSources:Jz,getPlaybackDevices:function(r){return eo.getSpeakers(r)},createClient:function(){var r;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const s=Mn(5,"client-"),l=it.reportApiInvoke(null,{id:s,name:Er.CREATE_CLIENT,options:[a],tag:rr.TRACER});try{(function(d){ri(d.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),ri(d.mode,"config.mode",["rtc","live","p2p"]),d.audioCodec!==void 0&&ri(d.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),d.proxyServer!==void 0&&xi(d.proxyServer,"config.proxyServer",1,1e4),d.turnServer!==void 0&&dz(d.turnServer),d.httpRetryConfig!==void 0&&uz(d.httpRetryConfig),d.websocketRetryConfig!==void 0&&uz(d.websocketRetryConfig)})(a)}catch(d){throw l.onError(d),d}return(ez(16,0)||uj(16,0,!0))&&(a.codec==="vp9"&&(a.codec="vp8",V.debug("browser not support vp9, force use vp8")),An("UNSUPPORTED_VIDEO_CODEC",["vp9"])),a.audioCodec===void 0&&(a.audioCodec="opus"),l.onSuccess(),new WOe(_c(_c({forceWaitGatewayResponse:!0},a),{},{role:Be(r=["rtc","p2p"]).call(r,a.mode)?"host":a.role||"audience"}),s)},createCameraVideoTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=oe("CAMERA_CAPTURE_CONFIG"),s=Mn(8,"track-cam-"),l=it.reportApiInvoke(null,{id:s,tag:rr.TRACER,name:Er.CREATE_CAM_VIDEO_TRACK,options:[$n({},r),a]});a&&(r.encoderConfig=a);const d=aT(r);let f=null;V.info("start create camera video track with config",JSON.stringify(r),"trackId",s);try{f=(await Qs({video:d},s)).getVideoTracks()[0]||null}catch(y){throw l.onError(y),y}if(!f){const y=new we(ie.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(y),y.throw(V)}if(r.optimizationMode&&Yj(s,f,r,fc(r.encoderConfig)),oe("USE_STANDARD_BITRATE_DEFAULT")){const y=fc(r.encoderConfig);r.encoderConfig=y,delete y.bitrateMax,delete y.bitrateMin}const m=new sT(f,r,d,r.scalabiltyMode?tT(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,s);return l.onSuccess(m.getTrackId()),V.info("create camera video success, trackId:",s),m},createCustomVideoTrack:function(r){const a=Mn(8,"track-cus-"),s=it.reportApiInvoke(null,{id:a,tag:rr.TRACER,name:Er.CREATE_CUSTOM_VIDEO_TRACK,options:[r]});oe("USE_STANDARD_BITRATE_DEFAULT")&&(delete r.bitrateMax,delete r.bitrateMin);const l=new Gn(r.mediaStreamTrack,{width:r.width,height:r.height,frameRate:r.frameRate,bitrateMax:r.bitrateMax,bitrateMin:r.bitrateMin},r.scalabiltyMode?tT(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,a,[jn.CUSTOM_TRACK]);return s.onSuccess(l.getTrackId()),V.info("create custom video track success with config",r,"trackId",l.getTrackId()),l},createScreenVideoTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const s=typeof a=="object"?function(I){return o9(I)}(a):void 0;s&&(a="auto");const l=Mn(8,"track-scr-v-"),d=it.reportApiInvoke(null,{id:l,tag:rr.TRACER,name:Er.CREATE_SCREEN_VIDEO_TRACK,options:[$n({},r),a]});r.encoderConfig?typeof r.encoderConfig=="string"||r.encoderConfig.width&&r.encoderConfig.height||(r.encoderConfig.width={max:1920},r.encoderConfig.height={max:1080}):r.encoderConfig="1080p_2";const f=function(I){const L={};I.screenSourceType&&(L.mediaSource=I.screenSourceType),I.extensionId&&nd()&&(L.extensionId=I.extensionId);const{displaySurface:K,selfBrowserSurface:$,surfaceSwitching:G,systemAudio:ne,preferCurrentTab:te}=I;(pg(107)||cj(107)||dj(93))&&(K&&(ri(K,"displaySurface",["browser","window","monitor"]),L.displaySurface=K),$?(ri($,"selfBrowserSurface",["exclude","include"]),L.selfBrowserSurface=$):L.selfBrowserSurface="include",G&&(ri(G,"surfaceSwitching",["exclude","include"]),L.surfaceSwitching=G)),(pg(105)||cj(105)||dj(91))&&ne&&(ri(ne,"systemAudio",["exclude","include"]),L.systemAudio=ne),(pg(94)||cj(94)||dj(80))&&te&&(L.preferCurrentTab=!0),I.electronScreenSourceId&&(L.sourceId=I.electronScreenSourceId);const ce=I.encoderConfig?Mj(I.encoderConfig):null;return L.mandatory={chromeMediaSource:"desktop",maxWidth:ce?ce.width:void 0,maxHeight:ce?ce.height:void 0},ce&&(ce.frameRate&&(typeof ce.frameRate=="number"?(L.mandatory.maxFrameRate=ce.frameRate,L.mandatory.minFrameRate=ce.frameRate):(L.mandatory.maxFrameRate=ce.frameRate.max||ce.frameRate.ideal||ce.frameRate.exact||void 0,L.mandatory.minFrameRate=ce.frameRate.min||ce.frameRate.ideal||ce.frameRate.exact||void 0),L.frameRate=ce.frameRate),ce.width&&(L.width=ce.width),ce.height&&(L.height=ce.height)),L}(r);let m=null,y=null;const _=un();if(!_.supportShareAudio&&a==="enable"){const I=new we(ie.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return d.onError(I),I.throw(V)}V.info("start create screen video track with config",r,"withAudio",a,"trackId",l);const S=_.supportShareAudio&&a!=="disable";try{const I=await Qs({screen:f,screenAudio:S?s||!0:void 0},l);m=I.getVideoTracks()[0]||null,y=I.getAudioTracks()[0]||null}catch(I){throw d.onError(I),I}if(!m){const I=new we(ie.UNEXPECTED_ERROR,"can not find track in media stream");return d.onError(I),I.throw(V)}if(!y&&a==="enable"){m&&m.stop();const I=new we(ie.SHARE_AUDIO_NOT_ALLOWED);return d.onError(I),I.throw(V)}r.optimizationMode||(r.optimizationMode="detail"),r.optimizationMode&&(Yj(l,m,r,r.encoderConfig&&Mj(r.encoderConfig)||void 0),r.encoderConfig&&typeof r.encoderConfig!="string"&&(r.encoderConfig.bitrateMin=r.encoderConfig.bitrateMax));const x=new Gn(m,r.encoderConfig?Mj(r.encoderConfig):{},r.scalabiltyMode?tT(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,l,[jn.SCREEN_TRACK]);if(!y)return d.onSuccess(x.getTrackId()),V.info("create screen video track success","video:",x.getTrackId()),x;const A=new vr(y,void 0,Mn(8,"track-scr-a-"),!1);return d.onSuccess([x.getTrackId(),A.getTrackId()]),V.info("create screen video track success","video:",x.getTrackId(),"audio:",A.getTrackId()),[x,A]},createMicrophoneAndCameraTracks:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=oe("CAMERA_CAPTURE_CONFIG"),l=Mn(8,"track-mic-"),d=Mn(8,"track-cam-"),f=it.reportApiInvoke(null,{id:"".concat(l,"-").concat(d),tag:rr.TRACER,name:Er.CREATE_MIC_AND_CAM_TRACKS,options:[r,a,s]});s&&(a.encoderConfig=s);const m=aT(a),y=c9(r);let _=null,S=null;V.info("start create camera video track(".concat(d,") and microphone audio track(").concat(l,") with config, audio: ").concat(JSON.stringify(r),", video: ").concat(JSON.stringify(a)));try{const I=await Qs({audio:y,video:m},"".concat(l,"-").concat(d));_=I.getAudioTracks()[0],S=I.getVideoTracks()[0]}catch(I){throw f.onError(I),I}if(!_||!S){const I=new we(ie.UNEXPECTED_ERROR,"can not find tracks in media stream");return f.onError(I),I.throw(V)}if(a.optimizationMode&&Yj(d,S,a,fc(a.encoderConfig)),oe("USE_STANDARD_BITRATE_DEFAULT")){const I=fc(a.encoderConfig);a.encoderConfig=I,delete I.bitrateMax,delete I.bitrateMin}const x=new gb(_,r,y,l),A=new sT(S,a,m,a.scalabiltyMode?tT(a.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},a.optimizationMode,d);return f.onSuccess([x.getTrackId(),A.getTrackId()]),V.info("create camera video track(".concat(d,") and microphone audio track(").concat(l,") success")),[x,A]},createMicrophoneAudioTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=Mn(8,"track-mic-"),s=it.reportApiInvoke(null,{id:a,tag:rr.TRACER,name:Er.CREATE_MIC_AUDIO_TRACK,options:[r]}),l=c9(r);let d=null;V.info("start create microphone audio track with config",JSON.stringify(r),"trackId",a);try{d=(await Qs({audio:l},a)).getAudioTracks()[0]||null}catch(m){throw s.onError(m),m}if(!d){const m=new we(ie.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(m),m.throw(V)}const f=new gb(d,r,l,a);return s.onSuccess(f.getTrackId()),V.info("create microphone audio track success, trackId:",a),f},createCustomAudioTrack:function(r){const a=Mn(8,"track-cus-"),s=it.reportApiInvoke(null,{id:a,tag:rr.TRACER,name:Er.CREATE_CUSTOM_AUDIO_TRACK,options:[r]}),l=new vr(r.mediaStreamTrack,r.encoderConfig?nT(r.encoderConfig):{},a,!1);return V.info("create custom audio track success with config",r,"trackId",l.getTrackId()),s.onSuccess(l.getTrackId()),l},createBufferSourceAudioTrack:async function(r){var a;const{cacheOnlineFile:s,encoderConfig:l}=r;let{source:d}=r;const f={source:d instanceof AudioBuffer?"AudioBuffer":d instanceof File?(a=File.name)!==null&&a!==void 0?a:"File":d,cacheOnlineFile:s,encoderConfig:l},m=Mn(8,"track-buf-"),y=it.reportApiInvoke(null,{id:m,tag:rr.TRACER,name:Er.CREATE_BUFFER_AUDIO_TRACK,options:[f]});if(oe("DISABLE_WEBAUDIO"))throw new we(ie.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");V.info("start create buffer source audio track with config",JSON.stringify(f),"trackId",m);const _=d;if(!(d instanceof AudioBuffer))try{d=await async function(A,I){let L=null;if(typeof A=="string"){const $=q9.get(A);if($)return V.debug("use cached audio resource: ",A),$;try{L=(await tl(()=>Ka.get(A,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(G){throw new we(ie.FETCH_AUDIO_FILE_FAILED,G.toString())}}else L=await new He((G,ne)=>{const te=new FileReader;te.onload=ce=>{ce.target?G(ce.target.result):ne(new we(ie.READ_LOCAL_AUDIO_FILE_ERROR))},te.onerror=()=>{ne(new we(ie.READ_LOCAL_AUDIO_FILE_ERROR))},te.readAsArrayBuffer(A)});const K=await function($){const G=Ng();return new He((ne,te)=>{G.decodeAudioData($,ce=>{ne(ce)},ce=>{te(new we(ie.DECODE_AUDIO_FILE_FAILED,ce.toString()))})})}(L);return typeof A=="string"&&I&&q9.set(A,K),K}(d,s)}catch(A){return y.onError(A),A.throw(V)}const S=new uIe(d),x=new lIe(_,S,l?nT(l):{},m);return V.info("create buffer source audio track success, trackId:",m),y.onSuccess(x.getTrackId()),x},setAppType:function(r){if(V.debug("setAppType: ".concat(r)),!(Number.isInteger(r)&&r>=0))throw V.debug("Invalid appType"),new Ee(ie.INVALID_PARAMS,"invalid app type",r);An("APP_TYPE",Math.floor(r))},setLogLevel:function(r){V.setLogLevel(r)},enableLogUpload:function(){oe("USE_NEW_LOG")?An("UPLOAD_LOG",!0):V.enableLogUpload()},disableLogUpload:function(){oe("USE_NEW_LOG")?An("UPLOAD_LOG",!1):V.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new JK},checkAudioTrackIsActive:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=it.reportApiInvoke(null,{tag:rr.TRACER,name:Er.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[a]});if(!(r instanceof vr||r instanceof Og)){const _=new Ee(ie.INVALID_TRACK,"the parameter is not a audio track");return s.onError(_),_.throw()}a&&a<1e3&&(a=1e3);const l=r instanceof vr?r.getTrackLabel():"remote_track",d=r.getVolumeLevel();let f=d,m=d;const y=Date.now();return new He(_=>{const S=setInterval(()=>{const x=r.getVolumeLevel();f=x>f?x:f,m=x<m?x:m;const A=f-m>1e-4,I=Date.now()-y;if(A||I>a){clearInterval(S);const L=A,K={duration:I,deviceLabel:l,maxVolumeLevel:f,result:L};V.info("[track-".concat(r.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(K))),s.onSuccess(K),_(L)}},200)})},checkVideoTrackIsActive:async function(r){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=it.reportApiInvoke(null,{tag:rr.TRACER,name:Er.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[a]});if(!(r instanceof Gn||r instanceof Ig)){const A=new Ee(ie.INVALID_TRACK,"the parameter is not a video track");return s.onError(A),A.throw()}a&&a<1e3&&(a=1e3);const l=r instanceof Gn?r.getTrackLabel():"remote_track",d=r.getMediaStreamTrack(!0),f=document.createElement("video");f.style.width="1px",f.style.height="1px",f.setAttribute("muted",""),f.muted=!0,f.setAttribute("playsinline",""),f.controls=!1,(ji()||Gx())&&(f.style.opacity="0.01",f.style.position="fixed",f.style.left="0",f.style.top="0",document.body.appendChild(f)),f.srcObject=new MediaStream([d]),f.play();const m=document.createElement("canvas");m.width=160,m.height=120;let y=0,_=0;try{const A=Date.now();y=await function(I,L,K,$){let G,ne=0,te=null;return new He((ce,pe)=>{function fe(){ne>$&&G&&(G(),ce(ne));const ue=K.getContext("2d");if(!ue){const Ie=new Ee(ie.UNEXPECTED_ERROR,"can not get canvas 2d context.");return V.error(Ie.toString()),void pe(Ie)}ue.drawImage(I,0,0,160,120);const ye=ue.getImageData(0,0,K.width,K.height),Se=Math.floor(ye.data.length/3);if(te){for(let Ie=0;Ie<Se;Ie+=3)if(ye.data[Ie]!==te[Ie])return ne+=1,void(te=ye.data);te=ye.data}else te=ye.data}setTimeout(()=>{G&&(G(),ce(ne))},L),G=$j(()=>{fe()},30)})}(f,a,m,4),_=Date.now()-A}catch(A){throw s.onError(A),A}AOe===fn.SAFARI&&(f.pause(),f.remove()),f.srcObject=null;const S=y>4,x={duration:_,changedPicNum:y,deviceLabel:l,result:S};return V.info("[track-".concat(r.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(x))),s.onSuccess(x),S},setArea:SD,audioElementPlayCenter:qa,resumeAudioContext:function(){qa.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(r){HOe.processExternalMediaAEC(r)},registerExtensions:function(r){const a=oe("PLUGIN_INFO")||[];r.forEach(s=>{"name"in s&&!Be(a).call(a,s.name)&&a.push(s.name);const l=s;l.__registered__=!0,l.logger.hookLog=V.extLog,l.reporter.hookApiInvoke=it.extApiInvoke,l.parameters&&Object.keys(l.parameters).forEach(d=>{l.parameters[d]=oe(d)})}),JX("PLUGIN_INFO",a)},ChannelMediaRelayError:jg,ChannelMediaRelayEvent:sd,ChannelMediaRelayState:cs,RemoteStreamFallbackType:nIe,RemoteStreamType:tIe,ConnectionDisconnectedReason:En,AudienceLatencyLevelType:P1e,AREAS:_n,preload:async function(r,a,s,l){return Eq(r,a,s,l)}});return Object.defineProperties(Hr,{onAudioAutoplayFailed:{get:()=>to.onAudioAutoplayFailed,set:r=>{to.onAudioAutoplayFailed=r}},onAutoplayFailed:{get:()=>to.onAutoplayFailed,set:r=>{to.onAutoplayFailed=r}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Hr._onSecurityPolicyViolation,set(r){Hr._onSecurityPolicyViolation=r,OY(r)}},__CLIENT_LIST__:{get:()=>oe("SHOW_GLOBAL_CLIENT_LIST")?fp:[]}}),eo.on(lp.CAMERA_DEVICE_CHANGED,r=>{V.info("camera device changed",JSON.stringify(r)),Hr.onCameraChanged&&Hr.onCameraChanged(r),Hr.safeEmit(au.CAMERA_CHANGED,r)}),eo.on(lp.RECORDING_DEVICE_CHANGED,r=>{V.info("microphone device changed",JSON.stringify(r)),Hr.onMicrophoneChanged&&Hr.onMicrophoneChanged(r),Hr.safeEmit(au.MICROPHONE_CHANGED,r)}),eo.on(lp.PLAYOUT_DEVICE_CHANGED,r=>{V.debug("playout device changed",JSON.stringify(r)),Hr.onPlaybackDeviceChanged&&Hr.onPlaybackDeviceChanged(r),Hr.safeEmit(au.PLAYBACK_DEVICE_CHANGED,r)}),qa.onAutoplayFailed=()=>{V.info("detect audio element autoplay failed"),to.onAudioAutoplayFailed&&to.onAudioAutoplayFailed()},In.on("autoplay-failed",()=>{V.info("detect webaudio autoplay failed"),to.onAudioAutoplayFailed&&to.onAudioAutoplayFailed(),Hr.safeEmit(au.AUTOPLAY_FAILED)}),In.on(Ri.STATE_CHANGE,(r,a)=>{V.info("audio context state changed: ".concat(a," => ").concat(r)),Hr.onAudioContextStateChanged&&Hr.onAudioContextStateChanged(r,a),Hr.safeEmit(au.AUDIO_CONTEXT_STATE_CHANGED,r,a)}),Dr.on(gg.NETWORK_STATE_CHANGE,(r,a)=>{V.info("[network-indicator] network state changed, ".concat(a," => ").concat(r))}),window&&(window.__ARTC__=Hr),Hr})})(Yle);var FBe=Yle.exports;const VR=jr(FBe),VBe="https://api.gada.chat";function BBe({open:e,onOpenChange:t,onStarted:n}){const{user:i,accessToken:o}=ct(),u=St(o),[h,p]=w.useState(""),[g,v]=w.useState("public"),[b,E]=w.useState(""),[T,C]=w.useState(!1),[R,N]=w.useState(null),[O,j]=w.useState(null),k=w.useRef(null),P=w.useRef(null),M=w.useRef(null),D=w.useRef(null),U=w.useRef(null);w.useEffect(()=>{let Z=!1;return(async()=>{if(!(!e||R))try{const X=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});if(Z){X.getTracks().forEach(ae=>ae.stop());return}P.current=X,k.current&&(k.current.srcObject=X,await k.current.play().catch(()=>{}))}catch{Ce.error("Could not access camera/microphone")}})(),()=>{Z=!0,P.current&&(P.current.getTracks().forEach(X=>X.stop()),P.current=null),k.current&&(k.current.pause(),k.current.srcObject=null)}},[e,R]);async function F(){var ae,se;const Z=D.current;if(!Z)return null;try{const J=document.createElement("video");J.muted=!0,J.playsInline=!0,J.autoplay=!0;const re=new MediaStream([Z.getMediaStreamTrack()]);J.srcObject=re,await J.play().catch(()=>{});const ee=((se=(ae=Z.getMediaStreamTrack()).getSettings)==null?void 0:se.call(ae))||{},de=Number(ee.width||J.videoWidth||1280),xe=Number(ee.height||J.videoHeight||720);if(!de||!xe)return null;const ve=1280,Te=720,Pe=document.createElement("canvas");Pe.width=ve,Pe.height=Te;const qe=Pe.getContext("2d");qe.fillStyle="#0b0f19",qe.fillRect(0,0,ve,Te);const st=de/xe,ze=ve/Te;let ft=ve,$e=Te,at=0,ke=0;st>ze?(ft=ve,$e=Math.round(ve/st),ke=Math.round((Te-$e)/2)):($e=Te,ft=Math.round(Te*st),at=Math.round((ve-ft)/2)),qe.drawImage(J,0,0,de,xe,at,ke,ft,$e),qe.fillStyle="#ef4444";const je=100,Pt=40,Dt=12,cn=24,ut=24;return X(qe,cn,ut,je,Pt,Dt),qe.fill(),qe.font="bold 18px system-ui, -apple-system, Segoe UI, Roboto, Arial",qe.fillStyle="#fff",qe.textBaseline="middle",qe.fillText("LIVE",cn+16,ut+Pt/2),Pe.toDataURL("image/png")}catch{return null}function X(J,re,ee,de,xe,ve){J.beginPath(),J.moveTo(re+ve,ee),J.arcTo(re+de,ee,re+de,ee+xe,ve),J.arcTo(re+de,ee+xe,re,ee+xe,ve),J.arcTo(re,ee+xe,re,ee,ve),J.arcTo(re,ee,re+de,ee,ve),J.closePath()}}async function H(){const Z=b.trim();if(Z.startsWith("data:image/"))return Z;if(Z.length>0)return;const X=await F();if(X)return X;const ae=k.current;if(ae)try{const se=document.createElement("canvas");return se.width=640,se.height=360,se.getContext("2d").drawImage(ae,0,0,se.width,se.height),se.toDataURL("image/png")}catch{return}}async function W(){if(!T){C(!0);try{const Z=O??await MBe({text:h||"Live",privacy:g,userId:(i==null?void 0:i.id)??(i==null?void 0:i.userId)},u);j(Z);const X=await H(),ae=Number((i==null?void 0:i.userId)??(i==null?void 0:i.id)??Date.now()),se=`live_${ae}_${Date.now()}`;console.log(X,"thumbnailDataUrlthumbnailDataUrlthumbnailDataUrl");const J=await UBe({postId:Z,channelName:se,agoraUid:ae,thumbnailDataUrl:X},u);N(J),n==null||n(J);const re=await fetch(`${VBe}/api/live/agora/host-join?postId=${Z}`,{credentials:"include",headers:u});if(!re.ok)throw new Error(`Host join failed (${re.status})`);const ee=await re.json(),de=VR.createClient({mode:"live",codec:"vp8"});M.current=de,await de.setClientRole("host"),await de.join(ee.appId,ee.channelName,ee.token,ee.uid);const xe=await VR.createMicrophoneAudioTrack(),ve=await VR.createCameraVideoTrack();if(U.current=xe,D.current=ve,await de.publish([xe,ve]),k.current){P.current&&(P.current.getTracks().forEach(qe=>qe.stop()),P.current=null,k.current.pause(),k.current.srcObject=null);const Te=k.current.parentElement;Te.innerHTML="";const Pe=document.createElement("div");Pe.style.width="100%",Pe.style.height="260px",Pe.style.background="black",Te.appendChild(Pe),await ve.play(Pe)}Ce.success("Live started")}catch(Z){console.error(Z),Ce.error((Z==null?void 0:Z.message)||"Could not start live"),await Y()}finally{C(!1)}}}async function q(){if(!T){C(!0);try{const Z=O;await Y();const X=await H();Z&&await LBe(Z,u,X),Ce.success("Live ended"),N(null),j(null),t(!1)}catch(Z){console.error(Z),Ce.error((Z==null?void 0:Z.message)||"Failed to stop live")}finally{C(!1)}}}async function Y(){try{if(D.current){try{await D.current.stop()}catch{}try{await D.current.close()}catch{}}if(U.current){try{await U.current.stop()}catch{}try{await U.current.close()}catch{}}if(D.current=null,U.current=null,M.current){const Z=M.current;M.current=null;try{await Z.unpublish().catch(()=>{})}catch{}try{await Z.leave().catch(()=>{})}catch{}Z.removeAllListeners()}}catch{}}w.useEffect(()=>{e||Y()},[e]);const z=R==null?void 0:R.live;return c.jsx(Ko,{open:e,onOpenChange:Z=>!T&&t(Z),children:c.jsxs(mo,{className:"sm:max-w-[720px]",children:[c.jsx(qo,{children:c.jsx(Yo,{children:z?"You are live":"Go Live"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("div",{className:"rounded-md overflow-hidden bg-black",children:c.jsx("video",{ref:k,className:"w-full h-[260px] object-contain bg-black",muted:!0,playsInline:!0})}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Title"}),c.jsx(Ae,{value:h,onChange:Z=>p(Z.target.value),placeholder:"My live…",disabled:!!z})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Privacy"}),c.jsxs("select",{className:"mt-1 w-full border rounded-md px-2 py-1 text-sm",value:g,onChange:Z=>v(Z.target.value),disabled:!!z,children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Thumbnail (optional URL/dataURL — leave blank to auto-capture)"}),c.jsx(Ae,{value:b,onChange:Z=>E(Z.target.value),placeholder:"/uploads/.../thumb.png or data:image/png;base64,…",disabled:!!z}),c.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:"If blank, we capture a frame from your camera and upload it automatically."})]}),z&&c.jsxs("div",{className:"text-xs text-slate-600 p-2 bg-slate-50 rounded",children:["Channel: ",c.jsx("b",{children:z.channelName||"—"}),c.jsx("br",{}),"UID: ",c.jsx("b",{children:z.agoraUid??"—"})]})]})]}),c.jsx(lm,{children:z?c.jsx(c.Fragment,{children:c.jsx(be,{variant:"destructive",onClick:q,disabled:T,children:T?"Stopping…":"End Live"})}):c.jsxs(c.Fragment,{children:[c.jsx(be,{variant:"outline",onClick:()=>t(!1),disabled:T,children:"Cancel"}),c.jsx(be,{onClick:W,disabled:T,children:T?"Starting…":"Start Live"})]})})]})})}const $Be="https://api.gada.chat";function WBe(){const{user:e}=ct(),{addPost:t}=R1(),[n,i]=w.useState(""),[o,u]=w.useState([]),[h,p]=w.useState([]),[g,v]=w.useState([]),[b,E]=w.useState([]),[T,C]=w.useState(!1),R=w.useRef(null),N=w.useRef(null),[O,j]=w.useState(!1);if(!e)return null;const k=H=>H.split(" ").map(W=>W[0]).join("").toUpperCase();function P(H){u(W=>W.filter((q,Y)=>Y!==H)),v(W=>W.filter((q,Y)=>Y!==H))}function M(H){p(W=>W.filter((q,Y)=>Y!==H)),E(W=>W.filter((q,Y)=>Y!==H))}const D=H=>{const W=H.target.files;if(!(W!=null&&W.length))return;const q=Array.from(W);u(Y=>[...Y,...q]),v(Y=>[...Y,...q.map(z=>URL.createObjectURL(z))]),H.target.value=""},U=H=>{const W=H.target.files;if(!(W!=null&&W.length))return;const q=Array.from(W);p(Y=>[...Y,...q]),E(Y=>[...Y,...q.map(z=>URL.createObjectURL(z))]),H.target.value=""},F=async H=>{if(H.preventDefault(),!(!n.trim()&&o.length===0&&h.length===0)){C(!0);try{await t(n,o,h),i(""),u([]),p([]),v([]),E([])}catch(W){console.error("Failed to create post:",W)}finally{C(!1)}}};return c.jsxs(Vr,{className:"mb-6",children:[c.jsx(mi,{className:"p-4 md:p-6",children:c.jsx("form",{onSubmit:F,children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3",children:[c.jsxs($i,{className:"mb-3 sm:mb-0 h-10 w-10 flex-shrink-0",children:[c.jsx(Ii,{src:$Be+"/uploads/"+Xn(e.profileImage?e.profileImage:"/profile/defaultavatar.png"),alt:e.username}),c.jsx(ea,{children:k(e.username)})]}),c.jsxs("div",{className:"flex-1 space-y-4",children:[c.jsx(Ei,{placeholder:`What's on your mind, ${e.username.split(" ")[0]}?`,value:n,onChange:H=>i(H.target.value),className:"resize-none min-h-[80px] focus-visible:ring-[#1877F2]"}),g.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2",children:g.map((H,W)=>c.jsxs("div",{className:"relative group rounded-md overflow-hidden",children:[c.jsx("img",{src:H,alt:`preview-${W}`,className:"w-full h-32 object-cover"}),c.jsx(be,{type:"button",variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>P(W),children:c.jsx(po,{className:"h-3 w-3"})})]},W))}),b.length>0&&c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:b.map((H,W)=>c.jsxs("div",{className:"relative group rounded-md overflow-hidden",children:[c.jsx("video",{src:H,controls:!0,className:"w-full h-48 object-cover"}),c.jsx(be,{type:"button",variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>M(W),children:c.jsx(po,{className:"h-3 w-3"})})]},W))}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between pt-2 border-t border-gray-200 space-y-2 sm:space-y-0",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Ae,{ref:R,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:D,id:"image-upload"}),c.jsxs(be,{type:"button",variant:"outline",onClick:()=>{var H;return(H=R.current)==null?void 0:H.click()},className:"flex items-center text-gray-600",disabled:T,children:[c.jsx(Zce,{className:"h-4 w-4 mr-1 text-[#45BD62]"})," Photo"]}),c.jsx(Ae,{ref:N,type:"file",accept:"video/*",multiple:!0,className:"hidden",onChange:U,id:"video-upload"}),c.jsxs(be,{type:"button",variant:"outline",onClick:()=>{var H;return(H=N.current)==null?void 0:H.click()},className:"flex items-center text-gray-600",disabled:T,children:[c.jsx(jN,{className:"h-4 w-4 mr-1 text-[#F3425F]"})," Video"]}),c.jsxs(be,{type:"button",variant:"outline",onClick:()=>j(!0),className:"flex items-center text-gray-600",children:[c.jsx(nle,{className:"h-4 w-4 mr-1 text-[#E12F2F]"})," Go Live"]})]}),c.jsx(be,{type:"submit",disabled:T||!n.trim()&&o.length===0&&h.length===0,className:"bg-[#1877F2] hover:bg-[#166FE5] w-full sm:w-auto",children:T?c.jsxs(c.Fragment,{children:[c.jsx(ei,{className:"h-4 w-4 mr-1 animate-spin"}),"Posting..."]}):"Post"})]})]})]})})}),c.jsx(BBe,{open:O,onOpenChange:j,postId:null})]})}var GBe="Separator",dQ="horizontal",HBe=["horizontal","vertical"],Zle=w.forwardRef((e,t)=>{const{decorative:n,orientation:i=dQ,...o}=e,u=zBe(i)?i:dQ,p=n?{role:"none"}:{"aria-orientation":u==="vertical"?u:void 0,role:"separator"};return c.jsx(Qt.div,{"data-orientation":u,...p,...o,ref:t})});Zle.displayName=GBe;function zBe(e){return HBe.includes(e)}var Qle=Zle;const L0=w.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...i},o)=>c.jsx(Qle,{ref:o,decorative:n,orientation:t,className:jt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...i}));L0.displayName=Qle.displayName;function KBe({isOpen:e,onClose:t,children:n}){return w.useEffect(()=>(document.body.style.overflow=e?"hidden":"",()=>{document.body.style.overflow=""}),[e]),e?c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black opacity-50",onClick:t}),c.jsxs("div",{className:"relative bg-white rounded-lg p-6 shadow-lg max-w-md w-full z-10",children:[c.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700",children:c.jsx(po,{className:"w-5 h-5"})}),n]})]}):null}function eue({isOpen:e,onClose:t,onShare:n}){const[i,o]=w.useState(""),u=async()=>{await n(i.trim()||""),o(""),t()};return c.jsxs(KBe,{isOpen:e,onClose:t,children:[c.jsx("h2",{className:"text-lg font-medium mb-4",children:"Share Post"}),c.jsx(Ei,{value:i,onChange:h=>o(h.target.value),placeholder:"Say something about this...",rows:4,className:"w-full"}),c.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[c.jsx(be,{variant:"outline",onClick:t,children:"Cancel"}),c.jsx(be,{onClick:u,disabled:i.trim()==="",children:"Share"})]})]})}function G4(e){const t=e+"CollectionProvider",[n,i]=Fs(t),[o,u]=n(t,{collectionRef:{current:null},itemMap:new Map}),h=N=>{const{scope:O,children:j}=N,k=me.useRef(null),P=me.useRef(new Map).current;return c.jsx(o,{scope:O,itemMap:P,collectionRef:k,children:j})};h.displayName=t;const p=e+"CollectionSlot",g=yf(p),v=me.forwardRef((N,O)=>{const{scope:j,children:k}=N,P=u(p,j),M=Dn(O,P.collectionRef);return c.jsx(g,{ref:M,children:k})});v.displayName=p;const b=e+"CollectionItemSlot",E="data-radix-collection-item",T=yf(b),C=me.forwardRef((N,O)=>{const{scope:j,children:k,...P}=N,M=me.useRef(null),D=Dn(O,M),U=u(b,j);return me.useEffect(()=>(U.itemMap.set(M,{ref:M,...P}),()=>void U.itemMap.delete(M))),c.jsx(T,{[E]:"",ref:D,children:k})});C.displayName=b;function R(N){const O=u(e+"CollectionConsumer",N);return me.useCallback(()=>{const k=O.collectionRef.current;if(!k)return[];const P=Array.from(k.querySelectorAll(`[${E}]`));return Array.from(O.itemMap.values()).sort((U,F)=>P.indexOf(U.ref.current)-P.indexOf(F.ref.current))},[O.collectionRef,O.itemMap])}return[{Provider:h,Slot:v,ItemSlot:C},R,i]}var qBe=w.createContext(void 0);function n_(e){const t=w.useContext(qBe);return e||t||"ltr"}var cL="rovingFocusGroup.onEntryFocus",YBe={bubbles:!1,cancelable:!0},Kw="RovingFocusGroup",[_U,tue,XBe]=G4(Kw),[JBe,r_]=Fs(Kw,[XBe]),[ZBe,QBe]=JBe(Kw),nue=w.forwardRef((e,t)=>c.jsx(_U.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(_U.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(e3e,{...e,ref:t})})}));nue.displayName=Kw;var e3e=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:o=!1,dir:u,currentTabStopId:h,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:g,onEntryFocus:v,preventScrollOnEntryFocus:b=!1,...E}=e,T=w.useRef(null),C=Dn(t,T),R=n_(u),[N,O]=Bd({prop:h,defaultProp:p??null,onChange:g,caller:Kw}),[j,k]=w.useState(!1),P=Ba(v),M=tue(n),D=w.useRef(!1),[U,F]=w.useState(0);return w.useEffect(()=>{const H=T.current;if(H)return H.addEventListener(cL,P),()=>H.removeEventListener(cL,P)},[P]),c.jsx(ZBe,{scope:n,orientation:i,dir:R,loop:o,currentTabStopId:N,onItemFocus:w.useCallback(H=>O(H),[O]),onItemShiftTab:w.useCallback(()=>k(!0),[]),onFocusableItemAdd:w.useCallback(()=>F(H=>H+1),[]),onFocusableItemRemove:w.useCallback(()=>F(H=>H-1),[]),children:c.jsx(Qt.div,{tabIndex:j||U===0?-1:0,"data-orientation":i,...E,ref:C,style:{outline:"none",...e.style},onMouseDown:Tt(e.onMouseDown,()=>{D.current=!0}),onFocus:Tt(e.onFocus,H=>{const W=!D.current;if(H.target===H.currentTarget&&W&&!j){const q=new CustomEvent(cL,YBe);if(H.currentTarget.dispatchEvent(q),!q.defaultPrevented){const Y=M().filter(se=>se.focusable),z=Y.find(se=>se.active),Z=Y.find(se=>se.id===N),ae=[z,Z,...Y].filter(Boolean).map(se=>se.ref.current);aue(ae,b)}}D.current=!1}),onBlur:Tt(e.onBlur,()=>k(!1))})})}),rue="RovingFocusGroupItem",iue=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:o=!1,tabStopId:u,children:h,...p}=e,g=Ll(),v=u||g,b=QBe(rue,n),E=b.currentTabStopId===v,T=tue(n),{onFocusableItemAdd:C,onFocusableItemRemove:R,currentTabStopId:N}=b;return w.useEffect(()=>{if(i)return C(),()=>R()},[i,C,R]),c.jsx(_U.ItemSlot,{scope:n,id:v,focusable:i,active:o,children:c.jsx(Qt.span,{tabIndex:E?0:-1,"data-orientation":b.orientation,...p,ref:t,onMouseDown:Tt(e.onMouseDown,O=>{i?b.onItemFocus(v):O.preventDefault()}),onFocus:Tt(e.onFocus,()=>b.onItemFocus(v)),onKeyDown:Tt(e.onKeyDown,O=>{if(O.key==="Tab"&&O.shiftKey){b.onItemShiftTab();return}if(O.target!==O.currentTarget)return;const j=r3e(O,b.orientation,b.dir);if(j!==void 0){if(O.metaKey||O.ctrlKey||O.altKey||O.shiftKey)return;O.preventDefault();let P=T().filter(M=>M.focusable).map(M=>M.ref.current);if(j==="last")P.reverse();else if(j==="prev"||j==="next"){j==="prev"&&P.reverse();const M=P.indexOf(O.currentTarget);P=b.loop?i3e(P,M+1):P.slice(M+1)}setTimeout(()=>aue(P))}}),children:typeof h=="function"?h({isCurrentTabStop:E,hasTabStop:N!=null}):h})})});iue.displayName=rue;var t3e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function n3e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function r3e(e,t,n){const i=n3e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return t3e[i]}function aue(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function i3e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var H4=nue,z4=iue,bU=["Enter"," "],a3e=["ArrowDown","PageUp","Home"],sue=["ArrowUp","PageDown","End"],s3e=[...a3e,...sue],o3e={ltr:[...bU,"ArrowRight"],rtl:[...bU,"ArrowLeft"]},c3e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},qw="Menu",[M0,l3e,u3e]=G4(qw),[xm,oue]=Fs(qw,[u3e,If,r_]),U1=If(),cue=r_(),[d3e,Tm]=xm(qw),[h3e,Yw]=xm(qw),lue=e=>{const{__scopeMenu:t,open:n=!1,children:i,dir:o,onOpenChange:u,modal:h=!0}=e,p=U1(t),[g,v]=w.useState(null),b=w.useRef(!1),E=Ba(u),T=n_(o);return w.useEffect(()=>{const C=()=>{b.current=!0,document.addEventListener("pointerdown",R,{capture:!0,once:!0}),document.addEventListener("pointermove",R,{capture:!0,once:!0})},R=()=>b.current=!1;return document.addEventListener("keydown",C,{capture:!0}),()=>{document.removeEventListener("keydown",C,{capture:!0}),document.removeEventListener("pointerdown",R,{capture:!0}),document.removeEventListener("pointermove",R,{capture:!0})}},[]),c.jsx(b4,{...p,children:c.jsx(d3e,{scope:t,open:n,onOpenChange:E,content:g,onContentChange:v,children:c.jsx(h3e,{scope:t,onClose:w.useCallback(()=>E(!1),[E]),isUsingKeyboardRef:b,dir:T,modal:h,children:i})})})};lue.displayName=qw;var f3e="MenuAnchor",K4=w.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,o=U1(n);return c.jsx(Mw,{...o,...i,ref:t})});K4.displayName=f3e;var q4="MenuPortal",[p3e,uue]=xm(q4,{forceMount:void 0}),due=e=>{const{__scopeMenu:t,forceMount:n,children:i,container:o}=e,u=Tm(q4,t);return c.jsx(p3e,{scope:t,forceMount:n,children:c.jsx(is,{present:n||u.open,children:c.jsx(Uw,{asChild:!0,container:o,children:i})})})};due.displayName=q4;var Lc="MenuContent",[m3e,Y4]=xm(Lc),hue=w.forwardRef((e,t)=>{const n=uue(Lc,e.__scopeMenu),{forceMount:i=n.forceMount,...o}=e,u=Tm(Lc,e.__scopeMenu),h=Yw(Lc,e.__scopeMenu);return c.jsx(M0.Provider,{scope:e.__scopeMenu,children:c.jsx(is,{present:i||u.open,children:c.jsx(M0.Slot,{scope:e.__scopeMenu,children:h.modal?c.jsx(g3e,{...o,ref:t}):c.jsx(v3e,{...o,ref:t})})})})}),g3e=w.forwardRef((e,t)=>{const n=Tm(Lc,e.__scopeMenu),i=w.useRef(null),o=Dn(t,i);return w.useEffect(()=>{const u=i.current;if(u)return P1(u)},[]),c.jsx(X4,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Tt(e.onFocusOutside,u=>u.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),v3e=w.forwardRef((e,t)=>{const n=Tm(Lc,e.__scopeMenu);return c.jsx(X4,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),y3e=yf("MenuContent.ScrollLock"),X4=w.forwardRef((e,t)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:o,onOpenAutoFocus:u,onCloseAutoFocus:h,disableOutsidePointerEvents:p,onEntryFocus:g,onEscapeKeyDown:v,onPointerDownOutside:b,onFocusOutside:E,onInteractOutside:T,onDismiss:C,disableOutsideScroll:R,...N}=e,O=Tm(Lc,n),j=Yw(Lc,n),k=U1(n),P=cue(n),M=l3e(n),[D,U]=w.useState(null),F=w.useRef(null),H=Dn(t,F,O.onContentChange),W=w.useRef(0),q=w.useRef(""),Y=w.useRef(0),z=w.useRef(null),Z=w.useRef("right"),X=w.useRef(0),ae=R?zw:w.Fragment,se=R?{as:y3e,allowPinchZoom:!0}:void 0,J=ee=>{var ze,ft;const de=q.current+ee,xe=M().filter($e=>!$e.disabled),ve=document.activeElement,Te=(ze=xe.find($e=>$e.ref.current===ve))==null?void 0:ze.textValue,Pe=xe.map($e=>$e.textValue),qe=I3e(Pe,de,Te),st=(ft=xe.find($e=>$e.textValue===qe))==null?void 0:ft.ref.current;(function $e(at){q.current=at,window.clearTimeout(W.current),at!==""&&(W.current=window.setTimeout(()=>$e(""),1e3))})(de),st&&setTimeout(()=>st.focus())};w.useEffect(()=>()=>window.clearTimeout(W.current),[]),I1();const re=w.useCallback(ee=>{var xe,ve;return Z.current===((xe=z.current)==null?void 0:xe.side)&&P3e(ee,(ve=z.current)==null?void 0:ve.area)},[]);return c.jsx(m3e,{scope:n,searchRef:q,onItemEnter:w.useCallback(ee=>{re(ee)&&ee.preventDefault()},[re]),onItemLeave:w.useCallback(ee=>{var de;re(ee)||((de=F.current)==null||de.focus(),U(null))},[re]),onTriggerLeave:w.useCallback(ee=>{re(ee)&&ee.preventDefault()},[re]),pointerGraceTimerRef:Y,onPointerGraceIntentChange:w.useCallback(ee=>{z.current=ee},[]),children:c.jsx(ae,{...se,children:c.jsx(Hw,{asChild:!0,trapped:o,onMountAutoFocus:Tt(u,ee=>{var de;ee.preventDefault(),(de=F.current)==null||de.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:c.jsx(Gy,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:v,onPointerDownOutside:b,onFocusOutside:E,onInteractOutside:T,onDismiss:C,children:c.jsx(H4,{asChild:!0,...P,dir:j.dir,orientation:"vertical",loop:i,currentTabStopId:D,onCurrentTabStopIdChange:U,onEntryFocus:Tt(g,ee=>{j.isUsingKeyboardRef.current||ee.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(b1,{role:"menu","aria-orientation":"vertical","data-state":Nue(O.open),"data-radix-menu-content":"",dir:j.dir,...k,...N,ref:H,style:{outline:"none",...N.style},onKeyDown:Tt(N.onKeyDown,ee=>{const xe=ee.target.closest("[data-radix-menu-content]")===ee.currentTarget,ve=ee.ctrlKey||ee.altKey||ee.metaKey,Te=ee.key.length===1;xe&&(ee.key==="Tab"&&ee.preventDefault(),!ve&&Te&&J(ee.key));const Pe=F.current;if(ee.target!==Pe||!s3e.includes(ee.key))return;ee.preventDefault();const st=M().filter(ze=>!ze.disabled).map(ze=>ze.ref.current);sue.includes(ee.key)&&st.reverse(),N3e(st)}),onBlur:Tt(e.onBlur,ee=>{ee.currentTarget.contains(ee.target)||(window.clearTimeout(W.current),q.current="")}),onPointerMove:Tt(e.onPointerMove,U0(ee=>{const de=ee.target,xe=X.current!==ee.clientX;if(ee.currentTarget.contains(de)&&xe){const ve=ee.clientX>X.current?"right":"left";Z.current=ve,X.current=ee.clientX}}))})})})})})})});hue.displayName=Lc;var _3e="MenuGroup",J4=w.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return c.jsx(Qt.div,{role:"group",...i,ref:t})});J4.displayName=_3e;var b3e="MenuLabel",fue=w.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return c.jsx(Qt.div,{...i,ref:t})});fue.displayName=b3e;var MN="MenuItem",hQ="menu.itemSelect",F1=w.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:i,...o}=e,u=w.useRef(null),h=Yw(MN,e.__scopeMenu),p=Y4(MN,e.__scopeMenu),g=Dn(t,u),v=w.useRef(!1),b=()=>{const E=u.current;if(!n&&E){const T=new CustomEvent(hQ,{bubbles:!0,cancelable:!0});E.addEventListener(hQ,C=>i==null?void 0:i(C),{once:!0}),Doe(E,T),T.defaultPrevented?v.current=!1:h.onClose()}};return c.jsx(pue,{...o,ref:g,disabled:n,onClick:Tt(e.onClick,b),onPointerDown:E=>{var T;(T=e.onPointerDown)==null||T.call(e,E),v.current=!0},onPointerUp:Tt(e.onPointerUp,E=>{var T;v.current||(T=E.currentTarget)==null||T.click()}),onKeyDown:Tt(e.onKeyDown,E=>{const T=p.searchRef.current!=="";n||T&&E.key===" "||bU.includes(E.key)&&(E.currentTarget.click(),E.preventDefault())})})});F1.displayName=MN;var pue=w.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:i=!1,textValue:o,...u}=e,h=Y4(MN,n),p=cue(n),g=w.useRef(null),v=Dn(t,g),[b,E]=w.useState(!1),[T,C]=w.useState("");return w.useEffect(()=>{const R=g.current;R&&C((R.textContent??"").trim())},[u.children]),c.jsx(M0.ItemSlot,{scope:n,disabled:i,textValue:o??T,children:c.jsx(z4,{asChild:!0,...p,focusable:!i,children:c.jsx(Qt.div,{role:"menuitem","data-highlighted":b?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...u,ref:v,onPointerMove:Tt(e.onPointerMove,U0(R=>{i?h.onItemLeave(R):(h.onItemEnter(R),R.defaultPrevented||R.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Tt(e.onPointerLeave,U0(R=>h.onItemLeave(R))),onFocus:Tt(e.onFocus,()=>E(!0)),onBlur:Tt(e.onBlur,()=>E(!1))})})})}),E3e="MenuCheckboxItem",mue=w.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:i,...o}=e;return c.jsx(bue,{scope:e.__scopeMenu,checked:n,children:c.jsx(F1,{role:"menuitemcheckbox","aria-checked":UN(n)?"mixed":n,...o,ref:t,"data-state":Q4(n),onSelect:Tt(o.onSelect,()=>i==null?void 0:i(UN(n)?!0:!n),{checkForDefaultPrevented:!1})})})});mue.displayName=E3e;var gue="MenuRadioGroup",[w3e,S3e]=xm(gue,{value:void 0,onValueChange:()=>{}}),vue=w.forwardRef((e,t)=>{const{value:n,onValueChange:i,...o}=e,u=Ba(i);return c.jsx(w3e,{scope:e.__scopeMenu,value:n,onValueChange:u,children:c.jsx(J4,{...o,ref:t})})});vue.displayName=gue;var yue="MenuRadioItem",_ue=w.forwardRef((e,t)=>{const{value:n,...i}=e,o=S3e(yue,e.__scopeMenu),u=n===o.value;return c.jsx(bue,{scope:e.__scopeMenu,checked:u,children:c.jsx(F1,{role:"menuitemradio","aria-checked":u,...i,ref:t,"data-state":Q4(u),onSelect:Tt(i.onSelect,()=>{var h;return(h=o.onValueChange)==null?void 0:h.call(o,n)},{checkForDefaultPrevented:!1})})})});_ue.displayName=yue;var Z4="MenuItemIndicator",[bue,x3e]=xm(Z4,{checked:!1}),Eue=w.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:i,...o}=e,u=x3e(Z4,n);return c.jsx(is,{present:i||UN(u.checked)||u.checked===!0,children:c.jsx(Qt.span,{...o,ref:t,"data-state":Q4(u.checked)})})});Eue.displayName=Z4;var T3e="MenuSeparator",wue=w.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return c.jsx(Qt.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});wue.displayName=T3e;var C3e="MenuArrow",Sue=w.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,o=U1(n);return c.jsx(E1,{...o,...i,ref:t})});Sue.displayName=C3e;var R3e="MenuSub",[rxt,xue]=xm(R3e),ME="MenuSubTrigger",Tue=w.forwardRef((e,t)=>{const n=Tm(ME,e.__scopeMenu),i=Yw(ME,e.__scopeMenu),o=xue(ME,e.__scopeMenu),u=Y4(ME,e.__scopeMenu),h=w.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:g}=u,v={__scopeMenu:e.__scopeMenu},b=w.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return w.useEffect(()=>b,[b]),w.useEffect(()=>{const E=p.current;return()=>{window.clearTimeout(E),g(null)}},[p,g]),c.jsx(K4,{asChild:!0,...v,children:c.jsx(pue,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":Nue(n.open),...e,ref:g1(t,o.onTriggerChange),onClick:E=>{var T;(T=e.onClick)==null||T.call(e,E),!(e.disabled||E.defaultPrevented)&&(E.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Tt(e.onPointerMove,U0(E=>{u.onItemEnter(E),!E.defaultPrevented&&!e.disabled&&!n.open&&!h.current&&(u.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{n.onOpenChange(!0),b()},100))})),onPointerLeave:Tt(e.onPointerLeave,U0(E=>{var C,R;b();const T=(C=n.content)==null?void 0:C.getBoundingClientRect();if(T){const N=(R=n.content)==null?void 0:R.dataset.side,O=N==="right",j=O?-5:5,k=T[O?"left":"right"],P=T[O?"right":"left"];u.onPointerGraceIntentChange({area:[{x:E.clientX+j,y:E.clientY},{x:k,y:T.top},{x:P,y:T.top},{x:P,y:T.bottom},{x:k,y:T.bottom}],side:N}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>u.onPointerGraceIntentChange(null),300)}else{if(u.onTriggerLeave(E),E.defaultPrevented)return;u.onPointerGraceIntentChange(null)}})),onKeyDown:Tt(e.onKeyDown,E=>{var C;const T=u.searchRef.current!=="";e.disabled||T&&E.key===" "||o3e[i.dir].includes(E.key)&&(n.onOpenChange(!0),(C=n.content)==null||C.focus(),E.preventDefault())})})})});Tue.displayName=ME;var Cue="MenuSubContent",Rue=w.forwardRef((e,t)=>{const n=uue(Lc,e.__scopeMenu),{forceMount:i=n.forceMount,...o}=e,u=Tm(Lc,e.__scopeMenu),h=Yw(Lc,e.__scopeMenu),p=xue(Cue,e.__scopeMenu),g=w.useRef(null),v=Dn(t,g);return c.jsx(M0.Provider,{scope:e.__scopeMenu,children:c.jsx(is,{present:i||u.open,children:c.jsx(M0.Slot,{scope:e.__scopeMenu,children:c.jsx(X4,{id:p.contentId,"aria-labelledby":p.triggerId,...o,ref:v,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:b=>{var E;h.isUsingKeyboardRef.current&&((E=g.current)==null||E.focus()),b.preventDefault()},onCloseAutoFocus:b=>b.preventDefault(),onFocusOutside:Tt(e.onFocusOutside,b=>{b.target!==p.trigger&&u.onOpenChange(!1)}),onEscapeKeyDown:Tt(e.onEscapeKeyDown,b=>{h.onClose(),b.preventDefault()}),onKeyDown:Tt(e.onKeyDown,b=>{var C;const E=b.currentTarget.contains(b.target),T=c3e[h.dir].includes(b.key);E&&T&&(u.onOpenChange(!1),(C=p.trigger)==null||C.focus(),b.preventDefault())})})})})})});Rue.displayName=Cue;function Nue(e){return e?"open":"closed"}function UN(e){return e==="indeterminate"}function Q4(e){return UN(e)?"indeterminate":e?"checked":"unchecked"}function N3e(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function A3e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}function I3e(e,t,n){const o=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,u=n?e.indexOf(n):-1;let h=A3e(e,Math.max(u,0));o.length===1&&(h=h.filter(v=>v!==n));const g=h.find(v=>v.toLowerCase().startsWith(o.toLowerCase()));return g!==n?g:void 0}function O3e(e,t){const{x:n,y:i}=e;let o=!1;for(let u=0,h=t.length-1;u<t.length;h=u++){const p=t[u],g=t[h],v=p.x,b=p.y,E=g.x,T=g.y;b>i!=T>i&&n<(E-v)*(i-b)/(T-b)+v&&(o=!o)}return o}function P3e(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return O3e(n,t)}function U0(e){return t=>t.pointerType==="mouse"?e(t):void 0}var k3e=lue,j3e=K4,D3e=due,L3e=hue,M3e=J4,U3e=fue,F3e=F1,V3e=mue,B3e=vue,$3e=_ue,W3e=Eue,G3e=wue,H3e=Sue,z3e=Tue,K3e=Rue,V1="DropdownMenu",[q3e,ixt]=Fs(V1,[oue]),Vs=oue(),[Y3e,Aue]=q3e(V1),Iue=e=>{const{__scopeDropdownMenu:t,children:n,dir:i,open:o,defaultOpen:u,onOpenChange:h,modal:p=!0}=e,g=Vs(t),v=w.useRef(null),[b,E]=Bd({prop:o,defaultProp:u??!1,onChange:h,caller:V1});return c.jsx(Y3e,{scope:t,triggerId:Ll(),triggerRef:v,contentId:Ll(),open:b,onOpenChange:E,onOpenToggle:w.useCallback(()=>E(T=>!T),[E]),modal:p,children:c.jsx(k3e,{...g,open:b,onOpenChange:E,dir:i,modal:p,children:n})})};Iue.displayName=V1;var Oue="DropdownMenuTrigger",Pue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...o}=e,u=Aue(Oue,n),h=Vs(n);return c.jsx(j3e,{asChild:!0,...h,children:c.jsx(Qt.button,{type:"button",id:u.triggerId,"aria-haspopup":"menu","aria-expanded":u.open,"aria-controls":u.open?u.contentId:void 0,"data-state":u.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...o,ref:g1(t,u.triggerRef),onPointerDown:Tt(e.onPointerDown,p=>{!i&&p.button===0&&p.ctrlKey===!1&&(u.onOpenToggle(),u.open||p.preventDefault())}),onKeyDown:Tt(e.onKeyDown,p=>{i||(["Enter"," "].includes(p.key)&&u.onOpenToggle(),p.key==="ArrowDown"&&u.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});Pue.displayName=Oue;var X3e="DropdownMenuPortal",kue=e=>{const{__scopeDropdownMenu:t,...n}=e,i=Vs(t);return c.jsx(D3e,{...i,...n})};kue.displayName=X3e;var jue="DropdownMenuContent",Due=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Aue(jue,n),u=Vs(n),h=w.useRef(!1);return c.jsx(L3e,{id:o.contentId,"aria-labelledby":o.triggerId,...u,...i,ref:t,onCloseAutoFocus:Tt(e.onCloseAutoFocus,p=>{var g;h.current||(g=o.triggerRef.current)==null||g.focus(),h.current=!1,p.preventDefault()}),onInteractOutside:Tt(e.onInteractOutside,p=>{const g=p.detail.originalEvent,v=g.button===0&&g.ctrlKey===!0,b=g.button===2||v;(!o.modal||b)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Due.displayName=jue;var J3e="DropdownMenuGroup",Z3e=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(M3e,{...o,...i,ref:t})});Z3e.displayName=J3e;var Q3e="DropdownMenuLabel",Lue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(U3e,{...o,...i,ref:t})});Lue.displayName=Q3e;var e5e="DropdownMenuItem",Mue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(F3e,{...o,...i,ref:t})});Mue.displayName=e5e;var t5e="DropdownMenuCheckboxItem",Uue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(V3e,{...o,...i,ref:t})});Uue.displayName=t5e;var n5e="DropdownMenuRadioGroup",r5e=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(B3e,{...o,...i,ref:t})});r5e.displayName=n5e;var i5e="DropdownMenuRadioItem",Fue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx($3e,{...o,...i,ref:t})});Fue.displayName=i5e;var a5e="DropdownMenuItemIndicator",Vue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(W3e,{...o,...i,ref:t})});Vue.displayName=a5e;var s5e="DropdownMenuSeparator",Bue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(G3e,{...o,...i,ref:t})});Bue.displayName=s5e;var o5e="DropdownMenuArrow",c5e=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(H3e,{...o,...i,ref:t})});c5e.displayName=o5e;var l5e="DropdownMenuSubTrigger",$ue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(z3e,{...o,...i,ref:t})});$ue.displayName=l5e;var u5e="DropdownMenuSubContent",Wue=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,o=Vs(n);return c.jsx(K3e,{...o,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Wue.displayName=u5e;var d5e=Iue,h5e=Pue,f5e=kue,Gue=Due,Hue=Lue,zue=Mue,Kue=Uue,que=Fue,Yue=Vue,Xue=Bue,Jue=$ue,Zue=Wue;const eB=d5e,tB=h5e,p5e=w.forwardRef(({className:e,inset:t,children:n,...i},o)=>c.jsxs(Jue,{ref:o,className:jt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...i,children:[n,c.jsx(Bw,{className:"ml-auto h-4 w-4"})]}));p5e.displayName=Jue.displayName;const m5e=w.forwardRef(({className:e,...t},n)=>c.jsx(Zue,{ref:n,className:jt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));m5e.displayName=Zue.displayName;const B1=w.forwardRef(({className:e,sideOffset:t=4,...n},i)=>c.jsx(f5e,{children:c.jsx(Gue,{ref:i,sideOffset:t,className:jt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));B1.displayName=Gue.displayName;const Pc=w.forwardRef(({className:e,inset:t,...n},i)=>c.jsx(zue,{ref:i,className:jt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));Pc.displayName=zue.displayName;const g5e=w.forwardRef(({className:e,children:t,checked:n,...i},o)=>c.jsxs(Kue,{ref:o,className:jt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...i,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Yue,{children:c.jsx(Fw,{className:"h-4 w-4"})})}),t]}));g5e.displayName=Kue.displayName;const v5e=w.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(que,{ref:i,className:jt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Yue,{children:c.jsx(Kce,{className:"h-2 w-2 fill-current"})})}),t]}));v5e.displayName=que.displayName;const y5e=w.forwardRef(({className:e,inset:t,...n},i)=>c.jsx(Hue,{ref:i,className:jt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));y5e.displayName=Hue.displayName;const ef=w.forwardRef(({className:e,...t},n)=>c.jsx(Xue,{ref:n,className:jt("-mx-1 my-1 h-px bg-muted",e),...t}));ef.displayName=Xue.displayName;const _5e=e=>[...new Set(e)],b5e=(e,t)=>e.filter(n=>!t.includes(n)),E5e=(e,t)=>e.filter(n=>t.includes(n)),w5e=e=>typeof e=="bigint"||!Number.isNaN(Number(e))&&Math.floor(Number(e))===e,S5e=e=>typeof e=="bigint"||e>=0&&Number.isSafeInteger(e);function cE(e,t){if(t.length===0)return e;let n;const i=[...e];for(let o=i.length-1,u=0,h=0;o>0;o--,u++){u%=t.length,h+=n=t[u].codePointAt(0);const p=(n+u+h)%o,g=i[o],v=i[p];i[p]=g,i[o]=v}return i}const x5e=(e,t)=>{const n=[];let i=e;if(typeof i=="bigint"){const o=BigInt(t.length);do n.unshift(t[Number(i%o)]),i/=o;while(i>BigInt(0))}else do n.unshift(t[i%t.length]),i=Math.floor(i/t.length);while(i>0);return n},T5e=(e,t)=>e.reduce((n,i)=>{const o=t.indexOf(i);if(o===-1)throw new Error(`The provided ID (${e.join("")}) is invalid, as it contains characters that do not exist in the alphabet (${t.join("")})`);if(typeof n=="bigint")return n*BigInt(t.length)+BigInt(o);const u=n*t.length+o;return Number.isSafeInteger(u)?u:(ede("Unable to decode the provided string, due to lack of support for BigInt numbers in the current environment"),BigInt(n)*BigInt(t.length)+BigInt(o))},0),C5e=/^\+?\d+$/,R5e=e=>{if(!C5e.test(e))return Number.NaN;const t=Number.parseInt(e,10);return Number.isSafeInteger(t)?t:(ede("Unable to encode the provided BigInt string without loss of information due to lack of support for BigInt type in the current environment"),BigInt(e))},N5e=(e,t,n)=>Array.from({length:Math.ceil(e.length/t)},(i,o)=>n(e.slice(o*t,(o+1)*t))),fQ=e=>new RegExp(e.map(t=>Que(t)).sort((t,n)=>n.length-t.length).join("|")),A5e=e=>new RegExp(`^[${e.map(t=>Que(t)).sort((t,n)=>n.length-t.length).join("")}]+$`),Que=e=>e.replace(/[\s#$()*+,.?[\\\]^{|}-]/g,"\\$&"),ede=(e="BigInt is not available in this environment")=>{if(typeof BigInt!="function")throw new TypeError(e)},pQ=16,mQ=3.5,I5e=12,gQ=16,O5e=12,vQ=100;class P5e{constructor(t="",n=0,i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",o="cfhistuCFHISTU"){if(this.minLength=n,typeof n!="number")throw new TypeError(`Hashids: Provided 'minLength' has to be a number (is ${typeof n})`);if(typeof t!="string")throw new TypeError(`Hashids: Provided 'salt' has to be a string (is ${typeof t})`);if(typeof i!="string")throw new TypeError(`Hashids: Provided alphabet has to be a string (is ${typeof i})`);const u=Array.from(t),h=Array.from(i),p=Array.from(o);this.salt=u;const g=_5e(h);if(g.length<pQ)throw new Error(`Hashids: alphabet must contain at least ${pQ} unique characters, provided: ${g.join("")}`);this.alphabet=b5e(g,p);const v=E5e(p,g);this.seps=cE(v,u);let b,E;(this.seps.length===0||this.alphabet.length/this.seps.length>mQ)&&(b=Math.ceil(this.alphabet.length/mQ),b>this.seps.length&&(E=b-this.seps.length,this.seps.push(...this.alphabet.slice(0,E)),this.alphabet=this.alphabet.slice(E))),this.alphabet=cE(this.alphabet,u);const T=Math.ceil(this.alphabet.length/I5e);this.alphabet.length<3?(this.guards=this.seps.slice(0,T),this.seps=this.seps.slice(T)):(this.guards=this.alphabet.slice(0,T),this.alphabet=this.alphabet.slice(T)),this.guardsRegExp=fQ(this.guards),this.sepsRegExp=fQ(this.seps),this.allowedCharsRegExp=A5e([...this.alphabet,...this.guards,...this.seps])}encode(t,...n){const i="";let o=Array.isArray(t)?t:[...t!=null?[t]:[],...n];return o.length===0||(o.every(w5e)||(o=o.map(u=>typeof u=="bigint"||typeof u=="number"?u:R5e(String(u)))),!o.every(S5e))?i:this._encode(o).join("")}decode(t){return!t||typeof t!="string"||t.length===0?[]:this._decode(t)}encodeHex(t){let n=t;switch(typeof n){case"bigint":n=n.toString(gQ);break;case"string":if(!/^[\dA-Fa-f]+$/.test(n))return"";break;default:throw new Error(`Hashids: The provided value is neither a string, nor a BigInt (got: ${typeof n})`)}const i=N5e(n,O5e,o=>Number.parseInt(`1${o}`,16));return this.encode(i)}decodeHex(t){return this.decode(t).map(n=>n.toString(gQ).slice(1)).join("")}isValidId(t){return this.allowedCharsRegExp.test(t)}_encode(t){let{alphabet:n}=this;const i=t.reduce((v,b,E)=>v+(typeof b=="bigint"?Number(b%BigInt(E+vQ)):b%(E+vQ)),0);let o=[n[i%n.length]];const u=[...o],{seps:h}=this,{guards:p}=this;if(t.forEach((v,b)=>{const E=u.concat(this.salt,n);n=cE(n,E);const T=x5e(v,n);if(o.push(...T),b+1<t.length){const C=T[0].codePointAt(0)+b,R=typeof v=="bigint"?Number(v%BigInt(C)):v%C;o.push(h[R%h.length])}}),o.length<this.minLength){const v=(i+o[0].codePointAt(0))%p.length;if(o.unshift(p[v]),o.length<this.minLength){const b=(i+o[2].codePointAt(0))%p.length;o.push(p[b])}}const g=Math.floor(n.length/2);for(;o.length<this.minLength;){n=cE(n,n),o.unshift(...n.slice(g)),o.push(...n.slice(0,g));const v=o.length-this.minLength;if(v>0){const b=v/2;o=o.slice(b,b+this.minLength)}}return o}_decode(t){if(!this.isValidId(t))throw new Error(`The provided ID (${t}) is invalid, as it contains characters that do not exist in the alphabet (${this.guards.join("")}${this.seps.join("")}${this.alphabet.join("")})`);const n=t.split(this.guardsRegExp),i=n.length===3||n.length===2?1:0,o=n[i];if(o.length===0)return[];const u=o[Symbol.iterator]().next().value,h=o.slice(u.length).split(this.sepsRegExp);let p=this.alphabet;const g=[];for(const v of h){const b=[u,...this.salt,...p],E=cE(p,b.slice(0,p.length));g.push(T5e(Array.from(v),E)),p=E}return this._encode(g).join("")!==t?[]:g}}const tde=new P5e("vEauO4VD-wjCuA7bf",10),F0=e=>tde.encode(e),k5e=e=>{const t=tde.decode(e);if(!t.length)throw new Error("Invalid ID");return t[0]},j5e="https://api.gada.chat";function D5e({open:e,postId:t,initialText:n,initialPrivacy:i="public",authKey:o,onClose:u,onSaved:h}){const[p,g]=w.useState(n),[v,b]=w.useState(i),[E,T]=w.useState(!1),C=w.useMemo(()=>E||!p.trim(),[E,p]);async function R(){if(!C){T(!0);try{const N=await fetch(`${j5e}/api/posts/edit/${t}`,{method:"POST",headers:{"Content-Type":"application/json",...o?{Authorization:o}:{}},body:JSON.stringify({text:p.trim(),privacy:v})}),O=await N.json();if(!N.ok)throw new Error((O==null?void 0:O.error)||"Failed to update");Ce.success("Post has been updated successfully"),h(O.post),u()}catch(N){console.error(N)}finally{T(!1)}}}return c.jsx(Ko,{open:e,onOpenChange:N=>!E&&!N&&u(),children:c.jsxs(mo,{className:"sm:max-w-lg",children:[c.jsx(qo,{children:c.jsx(Yo,{children:"Edit Post"})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ei,{value:p,onChange:N=>g(N.target.value),rows:6,placeholder:"Update your post…"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-slate-600",children:"Privacy"}),c.jsxs("select",{className:"border rounded-md px-2 py-1 text-sm",value:v,onChange:N=>b(N.target.value),children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]})]}),c.jsxs(lm,{className:"gap-2",children:[c.jsx(be,{variant:"outline",onClick:u,disabled:E,children:"Cancel"}),c.jsx(be,{onClick:R,disabled:C,children:E?"Saving…":"Save changes"})]})]})})}function nB(e){const t=w.useRef({value:e,previous:e});return w.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var rB="Radio",[L5e,nde]=Fs(rB),[M5e,U5e]=L5e(rB),rde=w.forwardRef((e,t)=>{const{__scopeRadio:n,name:i,checked:o=!1,required:u,disabled:h,value:p="on",onCheck:g,form:v,...b}=e,[E,T]=w.useState(null),C=Dn(t,O=>T(O)),R=w.useRef(!1),N=E?v||!!E.closest("form"):!0;return c.jsxs(M5e,{scope:n,checked:o,disabled:h,children:[c.jsx(Qt.button,{type:"button",role:"radio","aria-checked":o,"data-state":ode(o),"data-disabled":h?"":void 0,disabled:h,value:p,...b,ref:C,onClick:Tt(e.onClick,O=>{o||g==null||g(),N&&(R.current=O.isPropagationStopped(),R.current||O.stopPropagation())})}),N&&c.jsx(sde,{control:E,bubbles:!R.current,name:i,value:p,checked:o,required:u,disabled:h,form:v,style:{transform:"translateX(-100%)"}})]})});rde.displayName=rB;var ide="RadioIndicator",ade=w.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:i,...o}=e,u=U5e(ide,n);return c.jsx(is,{present:i||u.checked,children:c.jsx(Qt.span,{"data-state":ode(u.checked),"data-disabled":u.disabled?"":void 0,...o,ref:t})})});ade.displayName=ide;var F5e="RadioBubbleInput",sde=w.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:i=!0,...o},u)=>{const h=w.useRef(null),p=Dn(h,u),g=nB(n),v=v4(t);return w.useEffect(()=>{const b=h.current;if(!b)return;const E=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(E,"checked").set;if(g!==n&&C){const R=new Event("click",{bubbles:i});C.call(b,n),b.dispatchEvent(R)}},[g,n,i]),c.jsx(Qt.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:p,style:{...o.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});sde.displayName=F5e;function ode(e){return e?"checked":"unchecked"}var V5e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],$1="RadioGroup",[B5e,axt]=Fs($1,[r_,nde]),cde=r_(),lde=nde(),[$5e,W5e]=B5e($1),ude=w.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:i,defaultValue:o,value:u,required:h=!1,disabled:p=!1,orientation:g,dir:v,loop:b=!0,onValueChange:E,...T}=e,C=cde(n),R=n_(v),[N,O]=Bd({prop:u,defaultProp:o??null,onChange:E,caller:$1});return c.jsx($5e,{scope:n,name:i,required:h,disabled:p,value:N,onValueChange:O,children:c.jsx(H4,{asChild:!0,...C,orientation:g,dir:R,loop:b,children:c.jsx(Qt.div,{role:"radiogroup","aria-required":h,"aria-orientation":g,"data-disabled":p?"":void 0,dir:R,...T,ref:t})})})});ude.displayName=$1;var dde="RadioGroupItem",hde=w.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:i,...o}=e,u=W5e(dde,n),h=u.disabled||i,p=cde(n),g=lde(n),v=w.useRef(null),b=Dn(t,v),E=u.value===o.value,T=w.useRef(!1);return w.useEffect(()=>{const C=N=>{V5e.includes(N.key)&&(T.current=!0)},R=()=>T.current=!1;return document.addEventListener("keydown",C),document.addEventListener("keyup",R),()=>{document.removeEventListener("keydown",C),document.removeEventListener("keyup",R)}},[]),c.jsx(z4,{asChild:!0,...p,focusable:!h,active:E,children:c.jsx(rde,{disabled:h,required:u.required,checked:E,...g,...o,name:u.name,ref:b,onCheck:()=>u.onValueChange(o.value),onKeyDown:Tt(C=>{C.key==="Enter"&&C.preventDefault()}),onFocus:Tt(o.onFocus,()=>{var C;T.current&&((C=v.current)==null||C.click())})})})});hde.displayName=dde;var G5e="RadioGroupIndicator",fde=w.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...i}=e,o=lde(n);return c.jsx(ade,{...o,...i,ref:t})});fde.displayName=G5e;var pde=ude,mde=hde,H5e=fde;const gde=w.forwardRef(({className:e,...t},n)=>c.jsx(pde,{className:jt("grid gap-2",e),...t,ref:n}));gde.displayName=pde.displayName;const vde=w.forwardRef(({className:e,...t},n)=>c.jsx(mde,{ref:n,className:jt("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:c.jsx(H5e,{className:"flex items-center justify-center",children:c.jsx(Kce,{className:"h-2.5 w-2.5 fill-current text-current"})})}));vde.displayName=mde.displayName;function EU(e,[t,n]){return Math.min(n,Math.max(t,e))}function z5e(e,t){return w.useReducer((n,i)=>t[n][i]??n,e)}var iB="ScrollArea",[yde,sxt]=Fs(iB),[K5e,$c]=yde(iB),_de=w.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:i="hover",dir:o,scrollHideDelay:u=600,...h}=e,[p,g]=w.useState(null),[v,b]=w.useState(null),[E,T]=w.useState(null),[C,R]=w.useState(null),[N,O]=w.useState(null),[j,k]=w.useState(0),[P,M]=w.useState(0),[D,U]=w.useState(!1),[F,H]=w.useState(!1),W=Dn(t,Y=>g(Y)),q=n_(o);return c.jsx(K5e,{scope:n,type:i,dir:q,scrollHideDelay:u,scrollArea:p,viewport:v,onViewportChange:b,content:E,onContentChange:T,scrollbarX:C,onScrollbarXChange:R,scrollbarXEnabled:D,onScrollbarXEnabledChange:U,scrollbarY:N,onScrollbarYChange:O,scrollbarYEnabled:F,onScrollbarYEnabledChange:H,onCornerWidthChange:k,onCornerHeightChange:M,children:c.jsx(Qt.div,{dir:q,...h,ref:W,style:{position:"relative","--radix-scroll-area-corner-width":j+"px","--radix-scroll-area-corner-height":P+"px",...e.style}})})});_de.displayName=iB;var bde="ScrollAreaViewport",Ede=w.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:i,nonce:o,...u}=e,h=$c(bde,n),p=w.useRef(null),g=Dn(t,p,h.onViewportChange);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),c.jsx(Qt.div,{"data-radix-scroll-area-viewport":"",...u,ref:g,style:{overflowX:h.scrollbarXEnabled?"scroll":"hidden",overflowY:h.scrollbarYEnabled?"scroll":"hidden",...e.style},children:c.jsx("div",{ref:h.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});Ede.displayName=bde;var zu="ScrollAreaScrollbar",aB=w.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=$c(zu,e.__scopeScrollArea),{onScrollbarXEnabledChange:u,onScrollbarYEnabledChange:h}=o,p=e.orientation==="horizontal";return w.useEffect(()=>(p?u(!0):h(!0),()=>{p?u(!1):h(!1)}),[p,u,h]),o.type==="hover"?c.jsx(q5e,{...i,ref:t,forceMount:n}):o.type==="scroll"?c.jsx(Y5e,{...i,ref:t,forceMount:n}):o.type==="auto"?c.jsx(wde,{...i,ref:t,forceMount:n}):o.type==="always"?c.jsx(sB,{...i,ref:t}):null});aB.displayName=zu;var q5e=w.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=$c(zu,e.__scopeScrollArea),[u,h]=w.useState(!1);return w.useEffect(()=>{const p=o.scrollArea;let g=0;if(p){const v=()=>{window.clearTimeout(g),h(!0)},b=()=>{g=window.setTimeout(()=>h(!1),o.scrollHideDelay)};return p.addEventListener("pointerenter",v),p.addEventListener("pointerleave",b),()=>{window.clearTimeout(g),p.removeEventListener("pointerenter",v),p.removeEventListener("pointerleave",b)}}},[o.scrollArea,o.scrollHideDelay]),c.jsx(is,{present:n||u,children:c.jsx(wde,{"data-state":u?"visible":"hidden",...i,ref:t})})}),Y5e=w.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=$c(zu,e.__scopeScrollArea),u=e.orientation==="horizontal",h=G1(()=>g("SCROLL_END"),100),[p,g]=z5e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return w.useEffect(()=>{if(p==="idle"){const v=window.setTimeout(()=>g("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(v)}},[p,o.scrollHideDelay,g]),w.useEffect(()=>{const v=o.viewport,b=u?"scrollLeft":"scrollTop";if(v){let E=v[b];const T=()=>{const C=v[b];E!==C&&(g("SCROLL"),h()),E=C};return v.addEventListener("scroll",T),()=>v.removeEventListener("scroll",T)}},[o.viewport,u,g,h]),c.jsx(is,{present:n||p!=="hidden",children:c.jsx(sB,{"data-state":p==="hidden"?"hidden":"visible",...i,ref:t,onPointerEnter:Tt(e.onPointerEnter,()=>g("POINTER_ENTER")),onPointerLeave:Tt(e.onPointerLeave,()=>g("POINTER_LEAVE"))})})}),wde=w.forwardRef((e,t)=>{const n=$c(zu,e.__scopeScrollArea),{forceMount:i,...o}=e,[u,h]=w.useState(!1),p=e.orientation==="horizontal",g=G1(()=>{if(n.viewport){const v=n.viewport.offsetWidth<n.viewport.scrollWidth,b=n.viewport.offsetHeight<n.viewport.scrollHeight;h(p?v:b)}},10);return hy(n.viewport,g),hy(n.content,g),c.jsx(is,{present:i||u,children:c.jsx(sB,{"data-state":u?"visible":"hidden",...o,ref:t})})}),sB=w.forwardRef((e,t)=>{const{orientation:n="vertical",...i}=e,o=$c(zu,e.__scopeScrollArea),u=w.useRef(null),h=w.useRef(0),[p,g]=w.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),v=Rde(p.viewport,p.content),b={...i,sizes:p,onSizesChange:g,hasThumb:v>0&&v<1,onThumbChange:T=>u.current=T,onThumbPointerUp:()=>h.current=0,onThumbPointerDown:T=>h.current=T};function E(T,C){return t$e(T,h.current,p,C)}return n==="horizontal"?c.jsx(X5e,{...b,ref:t,onThumbPositionChange:()=>{if(o.viewport&&u.current){const T=o.viewport.scrollLeft,C=yQ(T,p,o.dir);u.current.style.transform=`translate3d(${C}px, 0, 0)`}},onWheelScroll:T=>{o.viewport&&(o.viewport.scrollLeft=T)},onDragScroll:T=>{o.viewport&&(o.viewport.scrollLeft=E(T,o.dir))}}):n==="vertical"?c.jsx(J5e,{...b,ref:t,onThumbPositionChange:()=>{if(o.viewport&&u.current){const T=o.viewport.scrollTop,C=yQ(T,p);u.current.style.transform=`translate3d(0, ${C}px, 0)`}},onWheelScroll:T=>{o.viewport&&(o.viewport.scrollTop=T)},onDragScroll:T=>{o.viewport&&(o.viewport.scrollTop=E(T))}}):null}),X5e=w.forwardRef((e,t)=>{const{sizes:n,onSizesChange:i,...o}=e,u=$c(zu,e.__scopeScrollArea),[h,p]=w.useState(),g=w.useRef(null),v=Dn(t,g,u.onScrollbarXChange);return w.useEffect(()=>{g.current&&p(getComputedStyle(g.current))},[g]),c.jsx(xde,{"data-orientation":"horizontal",...o,ref:v,sizes:n,style:{bottom:0,left:u.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:u.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":W1(n)+"px",...e.style},onThumbPointerDown:b=>e.onThumbPointerDown(b.x),onDragScroll:b=>e.onDragScroll(b.x),onWheelScroll:(b,E)=>{if(u.viewport){const T=u.viewport.scrollLeft+b.deltaX;e.onWheelScroll(T),Ade(T,E)&&b.preventDefault()}},onResize:()=>{g.current&&u.viewport&&h&&i({content:u.viewport.scrollWidth,viewport:u.viewport.offsetWidth,scrollbar:{size:g.current.clientWidth,paddingStart:VN(h.paddingLeft),paddingEnd:VN(h.paddingRight)}})}})}),J5e=w.forwardRef((e,t)=>{const{sizes:n,onSizesChange:i,...o}=e,u=$c(zu,e.__scopeScrollArea),[h,p]=w.useState(),g=w.useRef(null),v=Dn(t,g,u.onScrollbarYChange);return w.useEffect(()=>{g.current&&p(getComputedStyle(g.current))},[g]),c.jsx(xde,{"data-orientation":"vertical",...o,ref:v,sizes:n,style:{top:0,right:u.dir==="ltr"?0:void 0,left:u.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":W1(n)+"px",...e.style},onThumbPointerDown:b=>e.onThumbPointerDown(b.y),onDragScroll:b=>e.onDragScroll(b.y),onWheelScroll:(b,E)=>{if(u.viewport){const T=u.viewport.scrollTop+b.deltaY;e.onWheelScroll(T),Ade(T,E)&&b.preventDefault()}},onResize:()=>{g.current&&u.viewport&&h&&i({content:u.viewport.scrollHeight,viewport:u.viewport.offsetHeight,scrollbar:{size:g.current.clientHeight,paddingStart:VN(h.paddingTop),paddingEnd:VN(h.paddingBottom)}})}})}),[Z5e,Sde]=yde(zu),xde=w.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:i,hasThumb:o,onThumbChange:u,onThumbPointerUp:h,onThumbPointerDown:p,onThumbPositionChange:g,onDragScroll:v,onWheelScroll:b,onResize:E,...T}=e,C=$c(zu,n),[R,N]=w.useState(null),O=Dn(t,W=>N(W)),j=w.useRef(null),k=w.useRef(""),P=C.viewport,M=i.content-i.viewport,D=Ba(b),U=Ba(g),F=G1(E,10);function H(W){if(j.current){const q=W.clientX-j.current.left,Y=W.clientY-j.current.top;v({x:q,y:Y})}}return w.useEffect(()=>{const W=q=>{const Y=q.target;(R==null?void 0:R.contains(Y))&&D(q,M)};return document.addEventListener("wheel",W,{passive:!1}),()=>document.removeEventListener("wheel",W,{passive:!1})},[P,R,M,D]),w.useEffect(U,[i,U]),hy(R,F),hy(C.content,F),c.jsx(Z5e,{scope:n,scrollbar:R,hasThumb:o,onThumbChange:Ba(u),onThumbPointerUp:Ba(h),onThumbPositionChange:U,onThumbPointerDown:Ba(p),children:c.jsx(Qt.div,{...T,ref:O,style:{position:"absolute",...T.style},onPointerDown:Tt(e.onPointerDown,W=>{W.button===0&&(W.target.setPointerCapture(W.pointerId),j.current=R.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",C.viewport&&(C.viewport.style.scrollBehavior="auto"),H(W))}),onPointerMove:Tt(e.onPointerMove,H),onPointerUp:Tt(e.onPointerUp,W=>{const q=W.target;q.hasPointerCapture(W.pointerId)&&q.releasePointerCapture(W.pointerId),document.body.style.webkitUserSelect=k.current,C.viewport&&(C.viewport.style.scrollBehavior=""),j.current=null})})})}),FN="ScrollAreaThumb",Tde=w.forwardRef((e,t)=>{const{forceMount:n,...i}=e,o=Sde(FN,e.__scopeScrollArea);return c.jsx(is,{present:n||o.hasThumb,children:c.jsx(Q5e,{ref:t,...i})})}),Q5e=w.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:i,...o}=e,u=$c(FN,n),h=Sde(FN,n),{onThumbPositionChange:p}=h,g=Dn(t,E=>h.onThumbChange(E)),v=w.useRef(void 0),b=G1(()=>{v.current&&(v.current(),v.current=void 0)},100);return w.useEffect(()=>{const E=u.viewport;if(E){const T=()=>{if(b(),!v.current){const C=n$e(E,p);v.current=C,p()}};return p(),E.addEventListener("scroll",T),()=>E.removeEventListener("scroll",T)}},[u.viewport,b,p]),c.jsx(Qt.div,{"data-state":h.hasThumb?"visible":"hidden",...o,ref:g,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:Tt(e.onPointerDownCapture,E=>{const C=E.target.getBoundingClientRect(),R=E.clientX-C.left,N=E.clientY-C.top;h.onThumbPointerDown({x:R,y:N})}),onPointerUp:Tt(e.onPointerUp,h.onThumbPointerUp)})});Tde.displayName=FN;var oB="ScrollAreaCorner",Cde=w.forwardRef((e,t)=>{const n=$c(oB,e.__scopeScrollArea),i=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&i?c.jsx(e$e,{...e,ref:t}):null});Cde.displayName=oB;var e$e=w.forwardRef((e,t)=>{const{__scopeScrollArea:n,...i}=e,o=$c(oB,n),[u,h]=w.useState(0),[p,g]=w.useState(0),v=!!(u&&p);return hy(o.scrollbarX,()=>{var E;const b=((E=o.scrollbarX)==null?void 0:E.offsetHeight)||0;o.onCornerHeightChange(b),g(b)}),hy(o.scrollbarY,()=>{var E;const b=((E=o.scrollbarY)==null?void 0:E.offsetWidth)||0;o.onCornerWidthChange(b),h(b)}),v?c.jsx(Qt.div,{...i,ref:t,style:{width:u,height:p,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function VN(e){return e?parseInt(e,10):0}function Rde(e,t){const n=e/t;return isNaN(n)?0:n}function W1(e){const t=Rde(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=(e.scrollbar.size-n)*t;return Math.max(i,18)}function t$e(e,t,n,i="ltr"){const o=W1(n),u=o/2,h=t||u,p=o-h,g=n.scrollbar.paddingStart+h,v=n.scrollbar.size-n.scrollbar.paddingEnd-p,b=n.content-n.viewport,E=i==="ltr"?[0,b]:[b*-1,0];return Nde([g,v],E)(e)}function yQ(e,t,n="ltr"){const i=W1(t),o=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,u=t.scrollbar.size-o,h=t.content-t.viewport,p=u-i,g=n==="ltr"?[0,h]:[h*-1,0],v=EU(e,g);return Nde([0,h],[0,p])(v)}function Nde(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(n-e[0])}}function Ade(e,t){return e>0&&e<t}var n$e=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},i=0;return function o(){const u={left:e.scrollLeft,top:e.scrollTop},h=n.left!==u.left,p=n.top!==u.top;(h||p)&&t(),n=u,i=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(i)};function G1(e,t){const n=Ba(e),i=w.useRef(0);return w.useEffect(()=>()=>window.clearTimeout(i.current),[]),w.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(n,t)},[n,t])}function hy(e,t){const n=Ba(t);va(()=>{let i=0;if(e){const o=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(n)});return o.observe(e),()=>{window.cancelAnimationFrame(i),o.unobserve(e)}}},[e,n])}var Ide=_de,r$e=Ede,i$e=Cde;const Ode=w.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(Ide,{ref:i,className:jt("relative overflow-hidden",e),...n,children:[c.jsx(r$e,{className:"h-full w-full rounded-[inherit]",children:t}),c.jsx(Pde,{}),c.jsx(i$e,{})]}));Ode.displayName=Ide.displayName;const Pde=w.forwardRef(({className:e,orientation:t="vertical",...n},i)=>c.jsx(aB,{ref:i,orientation:t,className:jt("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:c.jsx(Tde,{className:"relative flex-1 rounded-full bg-border"})}));Pde.displayName=aB.displayName;const kde="https://api.gada.chat";async function a$e(e){const t=await fetch(`${kde}/api/reports/categories`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to load categories");return t.json()}async function s$e(e,t){const n=await fetch(`${kde}/api/reports`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to submit report");return n.json()}function o$e({postId:e,open:t,onOpenChange:n}){const{accessToken:i}=ct(),o=St(i),[u,h]=w.useState(null),[p,g]=w.useState(!1),[v,b]=w.useState(null),[E,T]=w.useState("");w.useEffect(()=>{!t||u||(async()=>{try{const O=await a$e(o);h(Array.isArray(O==null?void 0:O.data)?O.data:[])}catch{Ce.error("Failed to load reasons")}})()},[t,u,o]);function C(){b(null),T("")}async function R(){if(!v){Ce.error("Please choose a reason");return}g(!0);try{await s$e({nodeId:e,nodeType:"post",categoryId:v,reason:E},o),Ce.success("Thanks, we’ve received your report."),n(!1),C()}catch{Ce.error("Could not submit report")}finally{g(!1)}}const N=w.useMemo(()=>(u||[]).filter(O=>O.category_parent_id===0).sort((O,j)=>O.category_order-j.category_order),[u]);return c.jsx(Ko,{open:t,onOpenChange:O=>{n(O),O||C()},children:c.jsxs(mo,{className:"sm:max-w-[520px]",children:[c.jsxs(qo,{children:[c.jsx(Yo,{children:"Report post"}),c.jsx(t_,{children:"Tell us what’s wrong. Reports are anonymous to the post author."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{className:"mb-2 block",children:"Reason"}),c.jsx(Ode,{className:"h-[220px] rounded border",children:c.jsx(gde,{value:v?String(v):"",onValueChange:O=>b(Number(O)),className:"p-3",children:N.map(O=>c.jsxs("div",{className:"flex items-start gap-3 py-2",children:[c.jsx(vde,{id:`cat-${O.category_id}`,value:String(O.category_id)}),c.jsxs("label",{htmlFor:`cat-${O.category_id}`,className:"cursor-pointer",children:[c.jsx("div",{className:"font-medium",children:O.category_name}),O.category_description&&c.jsx("div",{className:"text-xs text-slate-500",children:O.category_description})]})]},O.category_id))})})]}),c.jsxs("div",{children:[c.jsx(Qe,{htmlFor:"report-reason",className:"mb-2 block",children:"Additional details (optional)"}),c.jsx(Ei,{id:"report-reason",placeholder:"Add context for our team",value:E,onChange:O=>T(O.target.value),className:"min-h-[90px]"})]})]}),c.jsxs(lm,{children:[c.jsx(be,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),c.jsx(be,{onClick:R,disabled:p,children:p?"Sending…":"Submit report"})]})]})})}function jde({postId:e,open:t,onOpenChange:n}){const{accessToken:i}=ct(),o=St(i),[u,h]=w.useState(null);return w.useEffect(()=>{t&&$ce(e,o).then(h).catch(console.error)},[t,e]),c.jsx(Ko,{open:t,onOpenChange:n,children:c.jsx(mo,{className:"max-w-3xl p-0 overflow-hidden",children:u?c.jsx(Vu,{post:u,trackViews:!1}):c.jsx("div",{className:"p-8",children:"Loading…"})})})}const _Q="https://api.gada.chat";function c$e({open:e,postId:t,onClose:n}){const[i,o]=w.useState(e);w.useEffect(()=>o(e),[e]);const u=w.useRef(null),[h,p]=w.useState(!1),[g,v]=w.useState(null),[b,E]=w.useState(0),T=w.useRef(null),C=w.useRef(null),R=w.useRef(null),N=w.useRef(null),O=w.useRef(!1),j=w.useRef(null),k=w.useRef(null),P=W=>typeof(W==null?void 0:W.message)=="string"&&W.message.includes("OPERATION_ABORTED")||(W==null?void 0:W.code)==="OPERATION_ABORTED",M=()=>{o(!1),O.current=!0,F(),H(),n==null||n()};w.useEffect(()=>{if(!i)return;const W=q=>{q.key==="Escape"&&(q.preventDefault(),M())};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[i]),w.useEffect(()=>{if(!i){O.current=!0,F(),H();return}O.current=!1;let W=!1;return v(null),p(!0),(async()=>{try{const q=await fetch(`${_Q}/api/live/agora/join-info?postId=${t}`,{credentials:"include"});if(!q.ok)throw new Error(`join-info ${q.status}`);const Y=await q.json();if(W||O.current)return;await D(Y),!W&&!O.current&&U()}catch(q){P(q)||(console.error(q),v((q==null?void 0:q.message)||"Failed to start player"))}finally{W||p(!1)}})(),()=>{W=!0,O.current=!0,F(),H()}},[i,t]);async function D(W){const q=String((W==null?void 0:W.appId)||"").trim(),Y=String((W==null?void 0:W.channelName)||"").trim(),z=Number(W==null?void 0:W.uid),Z=(W==null?void 0:W.token)||void 0;if(!q||!Y||!z&&z!==0)throw new Error("Incomplete join-info (appId/channel/uid)");const X=VR.createClient({mode:"live",codec:"vp8"});T.current=X;const ae=async(J,re)=>{if(!(O.current||!T.current)){try{await X.subscribe(J,re)}catch(ee){if(P(ee))return;console.error("[subscribe]",ee);return}if(!O.current){if(re==="video"&&J.videoTrack&&(C.current=J.videoTrack,u.current)){u.current.innerHTML="";const ee=document.createElement("div");ee.style.width="100%",ee.style.height="100%",u.current.appendChild(ee);try{await J.videoTrack.play(ee)}catch(de){P(de)||console.error("[video.play]",de)}}if(re==="audio"&&J.audioTrack){R.current=J.audioTrack;try{J.audioTrack.play()}catch(ee){P(ee)||console.error("[audio.play]",ee)}}}}},se=()=>{var J,re;try{(J=C.current)==null||J.stop()}catch{}try{(re=R.current)==null||re.stop()}catch{}C.current=null,R.current=null};j.current=ae,k.current=se,X.on("user-published",ae),X.on("user-unpublished",se);try{await X.setClientRole("audience"),await X.join(q,Y,Z,z)}catch(J){if(P(J))return;throw J}}function U(){F();const W=async()=>{if(!O.current){try{const q=await fetch(`${_Q}/api/live/heartbeat`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({postId:t})});if(q.ok){const Y=await q.json();typeof Y.viewers=="number"&&E(Y.viewers)}}catch{}O.current||(N.current=window.setTimeout(W,1e4))}};W()}function F(){N.current&&(clearTimeout(N.current),N.current=null)}function H(){var q,Y;const W=T.current;if(W){j.current&&W.off("user-published",j.current),k.current&&W.off("user-unpublished",k.current),j.current=null,k.current=null;try{(q=C.current)==null||q.stop()}catch{}try{(Y=R.current)==null||Y.stop()}catch{}C.current=null,R.current=null,W.leave().catch(z=>{P(z)||console.warn("[client.leave]",z)}),W.removeAllListeners(),T.current=null,u.current&&(u.current.innerHTML="")}}return i?c.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",role:"dialog","aria-modal":"true",onMouseDown:W=>{W.currentTarget===W.target&&M()},children:c.jsxs("div",{className:"w-[min(920px,95vw)] max-h-[90vh] bg-white rounded-2xl shadow-xl overflow-hidden",onMouseDown:W=>W.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Live"}),c.jsx("button",{type:"button",onClick:M,className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:c.jsx(po,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"p-4",children:c.jsx("div",{ref:u,className:"w-full h-[420px] bg-black text-white grid place-items-center rounded-lg overflow-hidden",children:h?c.jsx("span",{className:"opacity-80",children:"Connecting…"}):g?c.jsx("span",{className:"text-red-400",children:g}):c.jsx("span",{className:"opacity-60",children:"Waiting for video…"})})}),c.jsxs("div",{className:"px-4 pb-4 flex items-center justify-between text-sm text-gray-600",children:[c.jsxs("div",{children:["Viewers: ",c.jsx("strong",{children:b})]}),c.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 rounded-lg bg-gray-900 text-white",children:"Close"})]})]})}):null}const Dde="https://api.gada.chat",bu=Dde.replace(/\/+$/,""),l$e=Dde+"/uploads/gadalogo.png";function bQ(){return c.jsx("div",{className:"pointer-events-none absolute bottom-2 right-2 opacity-70",style:{zIndex:5},"aria-hidden":!0,children:c.jsx("img",{src:l$e,style:{maxWidth:96,maxHeight:36},onError:e=>{var n;e.currentTarget.style.display="none";const t=document.createElement("span");t.textContent="GADA",t.style.fontWeight="700",t.style.fontSize="14px",t.style.color="rgba(255,255,255,0.9)",t.style.textShadow="0 1px 2px rgba(0,0,0,0.6)",(n=e.currentTarget.parentElement)==null||n.appendChild(t)}})})}const u$e=[{reaction:"like",title:"Like",image:""},{reaction:"love",title:"Love",image:""},{reaction:"haha",title:"Haha",image:""},{reaction:"yay",title:"Yay",image:""},{reaction:"wow",title:"Wow",image:""},{reaction:"sad",title:"Sad",image:""},{reaction:"angry",title:"Angry",image:""}],EQ={like:"👍",love:"❤️",haha:"😆",yay:"🤩",wow:"😲",sad:"😢",angry:"😡"};let UE=null,wQ=null,lE=null,SQ=0;const d$e=12*60*60*1e3;async function h$e(e,t){const n=Date.now();return UE&&wQ===t&&n-SQ<d$e?UE:lE||(lE=fetch(`${e}/api/posts/getreactions`,{headers:t?{Authorization:t}:void 0}).then(async o=>{if(!o.ok)throw new Error(`getreactions ${o.status}`);const u=await o.json();return UE=Array.isArray(u==null?void 0:u.data)?u.data:[],wQ=t,SQ=Date.now(),UE}).finally(()=>{lE=null}),lE)}function f$e(){return UE}const uE=e=>{if(!e)return`${bu}/uploads/profile/defaultavatar.png`;if(e.startsWith("http"))return e;const t=Xn(e);return`${bu}/uploads/${t}`},dE=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":String(e);function p$e({text:e,maxLines:t=6,charThreshold:n=400}){const[i,o]=w.useState(!1),u=((e==null?void 0:e.length)||0)>n,h=`${(t*1.5).toFixed(1)}rem`;return c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx("p",{className:"whitespace-pre-line break-words leading-6 text-[15px] overflow-hidden",style:!i&&u?{maxHeight:h}:void 0,children:e}),!i&&u&&c.jsx("div",{className:"pointer-events-none absolute bottom-0 left-0 right-0 h-10 bg-gradient-to-t from-white to-transparent"})]}),u&&c.jsx("button",{type:"button",onClick:()=>o(p=>!p),className:"mt-2 text-[#1877F2] font-medium hover:underline",children:i?"See less":"See more"})]})}function m$e({open:e,catalog:t,onPick:n,onClear:i}){if(!e)return null;const o=t!=null&&t.length?t:u$e;return c.jsxs("div",{className:"relative z-[80] select-none ",children:[c.jsx("div",{className:`
          inline-flex w-max min-w-[240px] shrink-0
          items-center bg-white rounded-full px-4 py-2
          border border-slate-200 shadow-2xl ml-[220px]
        `,role:"menu","aria-label":"Choose a reaction",children:c.jsxs("div",{className:"flex items-center gap-2 w-max shrink-0",children:[o.map(u=>c.jsx("button",{type:"button",onClick:()=>n(u.reaction),className:`
                rounded-full h-9 w-9 flex items-center justify-center
                hover:scale-110 transition first:ml-1 last:mr-1
              `,title:u.title,"aria-label":u.title,children:u.image?c.jsx("img",{src:`${bu}/uploads/${String(u.image).replace(/^\/+/,"")}`,alt:u.title,className:"h-8 w-8 object-contain",onError:h=>{var g;h.currentTarget.style.display="none";const p=document.createElement("span");p.textContent=EQ[u.reaction]??"👍",p.style.fontSize="20px",(g=h.currentTarget.parentElement)==null||g.appendChild(p)}}):c.jsx("span",{style:{fontSize:20},children:EQ[u.reaction]??"👍"})},u.reaction)),i&&c.jsx("button",{type:"button",onClick:i,className:"ml-1 text-[11px] px-2 py-1 rounded bg-slate-100 hover:bg-slate-200",children:"Remove"})]})}),c.jsx("div",{className:"mx-auto h-3 w-3 -mt-1 rotate-45 bg-white border-r border-b border-slate-200 shadow"})]})}function Vu({post:e,live:t,trackViews:n=!0}){var Gi,zl;const{user:i,accessToken:o}=ct(),u=St(o),{likePost:h,commentPost:p,deletePost:g,sharePost:v,toggleSave:b}=R1(),[E,T]=w.useState(""),[C,R]=w.useState(!1),[N,O]=w.useState(!1),[j,k]=w.useState(!1),[P,M]=w.useState(!1),[D,U]=w.useState(!1),[F,H]=w.useState(!1),[W,q]=w.useState(!1),Y=()=>{n!==!1&&q(!0)},[z,Z]=w.useState(!1),ae=(Array.isArray(e==null?void 0:e.comments)?e.comments:[]).length||Number((e==null?void 0:e.comments)??0),se=Number((e==null?void 0:e.shareCount)??(e==null?void 0:e.shares)??0),J=Number((e==null?void 0:e.views)??(e==null?void 0:e.views)??(e==null?void 0:e.viewCount)??0),[re,ee]=w.useState(!1),[de,xe]=w.useState(String(e.boosted)==="1"||e.boosted===!0),[ve,Te]=w.useState(!1),Pe=e.author,qe=!!i&&((e==null?void 0:e.hasLiked)===!0||((Gi=e==null?void 0:e.likes)==null?void 0:Gi.some(bt=>String(bt.userId)===String(i.id)))),[st,ze]=w.useState([]),[ft,$e]=w.useState(!1),[at,ke]=w.useState(!1),[je,Pt]=w.useState(!1),Dt=w.useRef(null);function cn(){$e(!1),console.log("calling this"),Dt.current&&window.clearTimeout(Dt.current),console.log("here"),Dt.current=window.setTimeout(()=>{console.log("this fun "),!at&&!je&&$e(!1)},120)}const ut=w.useMemo(()=>{const bt=e.reactions;if(bt&&Array.isArray(bt))return bt.map(Bn=>({reaction:Bn.reaction,c:Number(Bn.c||0)}));const yn=Array.isArray(e.likes)?e.likes.length:0;return yn>0?[{reaction:"like",c:yn}]:[]},[e]),wt=w.useMemo(()=>{const bt=e.myReaction;return typeof bt=="string"?bt:qe?"like":null},[e,qe]),[Rt,Le]=w.useState(ut),[ge,Ne]=w.useState(wt);w.useEffect(()=>{Le(ut),Ne(wt)},[ut,wt]);const We=w.useMemo(()=>Rt.reduce((bt,yn)=>bt+Number(yn.c||0),0),[Rt]),gt=w.useMemo(()=>(u==null?void 0:u.Authorization)??"",[u==null?void 0:u.Authorization]);w.useEffect(()=>{const bt=f$e();bt&&ze(bt)},[]),w.useEffect(()=>{let bt=!0;if(gt)return h$e(bu,gt).then(yn=>{bt&&ze(yn)}).catch(()=>{}),()=>{bt=!1}},[gt]);function ot(bt,yn){const Bn=new Map;for(const zc of Rt)Bn.set(zc.reaction,Number(zc.c||0));bt&&Bn.set(bt,Math.max(0,(Bn.get(bt)||0)-1)),yn&&Bn.set(yn,(Bn.get(yn)||0)+1);const ki=Array.from(Bn.entries()).map(([zc,x_])=>({reaction:zc,c:x_}));Le(ki.filter(zc=>zc.c>0))}async function pt(bt){if(!i)return;if(!st.length&&bt==="like"){await h(e.id);return}const yn=ge;try{Ne(bt),ot(yn,bt);const Bn=await fetch(`${bu}/api/posts/${e.id}/react`,{method:"POST",headers:{"Content-Type":"application/json",...u},body:JSON.stringify({reaction:bt})});if(Bn.ok){const ki=await Bn.json();ki!=null&&ki.counts&&Le(ki.counts),typeof(ki==null?void 0:ki.myReaction)<"u"&&Ne(ki.myReaction)}}catch{Ne(yn),ot(bt,yn)}finally{$e(!1)}}async function Ft(){if(!i||!ge)return;const bt=ge;try{Ne(null),ot(bt,null);const yn=await fetch(`${bu}/api/posts/${e.id}/react`,{method:"DELETE",headers:{...u}});if(yn.ok){const Bn=await yn.json();Bn!=null&&Bn.counts&&Le(Bn.counts),Ne((Bn==null?void 0:Bn.myReaction)??null)}}catch{Ne(bt),ot(null,bt)}finally{$e(!1)}}const gn=!!i&&String(i.id)===String(Pe.id)&&i.packageactive,ur=w.useRef(null),ia=bt=>{bt.preventDefault(),!(!i||!E.trim())&&(p(e.id,E),T(""))},Ws=()=>{i&&g(e.id)},xs=async()=>{M(!0);try{await b(e.id,e.hasSaved)}catch(bt){console.error(bt)}finally{M(!1)}},Xu=async()=>{if(!gn||re)return;ee(!0);const bt=!de;try{const yn=`${bu}/api/posts/${e.id}/boost`,Bn=await fetch(yn,{method:bt?"POST":"DELETE",headers:{"Content-Type":"application/json",...u}});if(!Bn.ok){const ki=await Bn.json().catch(()=>({}));throw new Error((ki==null?void 0:ki.error)||"Boost error")}xe(bt),Ce.success(bt?"This post is now boosted.":"This post is no longer boosted.")}catch(yn){console.error(yn),Ce.success((yn==null?void 0:yn.message)||"Please try again.")}finally{ee(!1)}},Gs=bt=>bt.split(" ").map(yn=>yn[0]).join("").toUpperCase();return c.jsx("div",{ref:ur,children:c.jsxs(Vr,{className:"mb-4",children:[c.jsx(pa,{className:"p-4 pb-0",children:c.jsxs("div",{className:"flex items-center",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(At,{to:`/profile/${F0(Pe.id)}`,children:c.jsxs($i,{children:[c.jsx(Ii,{src:Pe.profileImage?uE(Pe.profileImage):`${bu}/uploads/profile/defaultavatar.png`,alt:Pe.username}),c.jsx(ea,{children:Gs(Pe.username)})]})}),c.jsxs("div",{className:"leading-tight",children:[c.jsx(At,{to:`/profile/${Pe.id}`,className:"font-semibold hover:underline",children:Pe.username}),c.jsx("p",{className:"text-sm text-gray-500",children:e.boosted=="1"?"Sponsored":RN(e.createdAt)})]})]}),c.jsx("div",{className:"ml-auto",children:c.jsxs(eB,{children:[c.jsx(tB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8","aria-label":"Post options",children:c.jsx(Yce,{className:"h-5 w-5"})})}),c.jsxs(B1,{align:"end",className:"w-56",children:[c.jsxs(Pc,{onClick:xs,disabled:P,className:"flex items-center gap-2",children:[e.hasSaved?c.jsx(FVe,{className:"w-4 h-4 text-gray-600"}):c.jsx(A4,{className:"w-4 h-4 text-gray-600"}),c.jsx("span",{children:e.hasSaved?"Unsave Post":"Save Post"})]}),c.jsx(ef,{}),c.jsxs(Pc,{onClick:()=>H(!0),className:"text-gray-600",children:[c.jsx(kN,{className:"mr-2 h-4 w-4 shrink-0"}),"   Report post"]}),gn&&c.jsxs(c.Fragment,{children:[c.jsx(ef,{}),c.jsxs(Pc,{onClick:Xu,disabled:re,className:"flex items-center gap-2",children:[c.jsx(U4,{className:`w-4 h-4 ${e.boosted?"text-[#1877F2]":"text-gray-600"}`}),c.jsx("span",{children:e.boosted?"Unboost this post":"Boost this post"})]})]}),i&&String(i.id)===String(Pe.id)&&c.jsxs(c.Fragment,{children:[c.jsx(ef,{}),c.jsxs(Pc,{onClick:()=>Te(!0),className:"text-gray-600",children:[c.jsx(tle,{className:"mr-2 h-4 w-4 shrink-0"})," Edit post"]})]}),i&&String(i.id)===String(Pe.id)&&c.jsxs(c.Fragment,{children:[c.jsx(ef,{}),c.jsxs(Pc,{onClick:Ws,className:"text-red-600",children:[c.jsx(Ww,{className:"mr-2 h-4 w-4 shrink-0"})," Delete post"]})]})]})]})})]})}),c.jsxs(mi,{className:"p-4",children:[e.content&&c.jsx(p$e,{text:e.content,maxLines:6,charThreshold:400}),e.images.length>0&&c.jsx("div",{className:`grid ${e.images.length===1?"grid-cols-1":"grid-cols-2"} gap-2 mb-3`,children:e.images.map((bt,yn)=>c.jsxs("div",{className:"relative group rounded-md overflow-hidden",children:[c.jsx("img",{src:uE(bt),alt:"Post",className:"rounded-md w-full object-cover cursor-zoom-in",style:{maxHeight:e.images.length===1?"500px":"250px"},onError:Bn=>{Bn.currentTarget.src=`${bu}/uploads/profile/defaultavatar.png`},onClick:Y,loading:"lazy",decoding:"async"}),c.jsx(bQ,{})]},yn))}),e.videos.length>0&&c.jsx("div",{className:"mb-3",children:e.videos.map((bt,yn)=>c.jsxs("div",{className:"relative rounded-md overflow-hidden",children:[c.jsx("video",{src:uE(bt),controls:!0,className:"rounded-md w-full cursor-zoom-in",style:{maxHeight:"500px"},onClick:Y,preload:"metadata"}),c.jsx(bQ,{})]},yn))})]}),c.jsx(mi,{className:"px-4 pt-3 pb-0",children:c.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-600",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex -space-x-1",children:Rt.slice().sort((bt,yn)=>Number(yn.c||0)-Number(bt.c||0)).slice(0,3).map(bt=>{const yn=st.find(ki=>ki.reaction===bt.reaction),Bn=(yn==null?void 0:yn.image)||`reactions/${bt.reaction}.png`;return c.jsx("img",{src:`${bu}/uploads/${String(Bn).replace(/^\/+/,"")}`,alt:(yn==null?void 0:yn.title)||bt.reaction,title:`${(yn==null?void 0:yn.title)||bt.reaction} • ${bt.c}`,className:"h-5 w-5 rounded-full ring-2 ring-white"},bt.reaction)})}),We>0&&c.jsx("span",{className:"ml-2",children:dE(We)})]}),c.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[c.jsxs("div",{children:[dE(ae)," ",ae===1?"comment":"comments"]}),c.jsxs("div",{children:[dE(se)," ",se===1?"Share":"Shares"]}),c.jsxs("div",{children:[dE(J)," ",J===1?"View":"Views"]})]})]})}),c.jsx(L0,{}),c.jsx(e_,{className:"p-0 overflow-visible",children:c.jsxs("div",{className:"relative grid grid-cols-4 w-full divide-x divide-slate-100",children:[c.jsxs("div",{className:"relative",onMouseEnter:()=>{ke(!0),$e(!0)},onMouseLeave:()=>{ke(!1),cn()},children:[c.jsxs(be,{variant:"ghost",onClick:()=>{st.length?$e(bt=>!bt):i&&pt("like")},"aria-pressed":!!ge,className:`w-full h-11 rounded-none flex items-center justify-center gap-2 transition-colors ${ge?"text-[#1877F2]":"text-slate-600"}`,title:ge?`You reacted (${ge})`:"Like",children:[c.jsx(D0,{className:`h-5 w-5 ${ge?"fill-[#1877F2] text-[#1877F2]":""}`}),c.jsx("span",{className:"font-medium",children:ge&&((zl=st.find(bt=>bt.reaction===ge))==null?void 0:zl.title)||"Like"})]}),st.length>0&&ft&&c.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-3 -mt-4 z-50",onMouseEnter:()=>{Pt(!0)},onMouseLeave:()=>{Pt(!1),cn()},children:c.jsx(m$e,{open:ft,catalog:st,onPick:bt=>{$e(!1),pt(bt)},onClear:ge?()=>{$e(!1),Ft()}:void 0})})]}),c.jsx("div",{children:c.jsxs(be,{variant:"ghost",className:"w-full h-11 rounded-none flex items-center justify-center gap-2 text-slate-600",onClick:()=>R(!C),children:[c.jsx($w,{className:"h-5 w-5"}),c.jsx("span",{className:"font-medium",children:"Comment"})]})}),c.jsx("div",{children:c.jsxs(be,{variant:"ghost",className:"w-full h-11 rounded-none flex items-center justify-center gap-2 text-slate-600",onClick:()=>k(!0),children:[c.jsx(A1,{className:"h-5 w-5"}),c.jsx("span",{className:"font-medium",children:"Share"})]})}),!!t&&(t==null?void 0:t.live)&&!t.ended&&c.jsxs("button",{type:"button",onClick:()=>U(!0),className:"inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full bg-red-50 text-red-600 border border-red-200 hover:bg-red-100",title:"Watch live",children:[c.jsx(nle,{className:"h-4 w-4 fill-red-600 text-red-600"}),c.jsx("span",{className:"font-medium",children:"LIVE"}),c.jsxs("span",{className:"text-slate-500",children:["· ",t.viewers]})]}),c.jsx("div",{children:c.jsxs("div",{className:"w-full h-11 rounded-none flex items-center justify-center gap-2 text-slate-600 select-none",children:[c.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5","aria-hidden":"true",children:c.jsx("path",{fill:"currentColor",d:"M12 5c5.5 0 9.5 4.5 10 6-.5 1.6-4.5 6-10 6S2.5 12.6 2 11c.5-1.6 4.5-6 10-6Zm0 2c-3.7 0-6.8 2.7-7.7 4 .9 1.3 4 4 7.7 4s6.8-2.7 7.7-4c-.9-1.3-4-4-7.7-4Zm0 2.5A3.5 3.5 0 1 1 8.5 13 3.5 3.5 0 0 1 12 9.5Zm0 2a1.5 1.5 0 1 0 1.5 1.5A1.5 1.5 0 0 0 12 11.5Z"})}),c.jsx("span",{className:"font-medium",children:dE(J)})]})})]})}),c.jsx(eue,{isOpen:j,onClose:()=>k(!1),onShare:bt=>v(e.id,bt)}),c.jsx(o$e,{open:F,onOpenChange:H,postId:Number((e==null?void 0:e.id)??(e==null?void 0:e.post_id))}),c.jsx(D5e,{open:ve,onClose:()=>Te(!1),postId:(e==null?void 0:e.id)??(e==null?void 0:e.post_id),initialText:(e==null?void 0:e.content)??"",initialPrivacy:(e==null?void 0:e.privacy)??"public",authKey:(u==null?void 0:u.Authorization)??"",onSaved:bt=>{e.content=bt.text,console.log(bt,"updatedupdated")}}),(e.comments.length>0||C)&&c.jsxs("div",{className:"p-4 pt-0",children:[c.jsx(L0,{className:"my-4"}),e.comments.length>0&&c.jsxs("div",{className:"space-y-3 mb-4",children:[(N?e.comments:e.comments.slice(0,2)).map(bt=>c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Ii,{src:uE(bt.profileImage||""),alt:bt.username}),c.jsx(ea,{children:Gs(bt.username)})]}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 px-3",children:[c.jsx(At,{to:`/profile/${bt.userId}`,className:"font-semibold hover:underline",children:bt.username}),c.jsx("p",{className:"text-sm",children:bt.content})]}),c.jsxs("div",{className:"flex space-x-3 text-xs text-gray-500 mt-1 ml-2",children:[c.jsx("span",{children:RN(bt.createdAt)}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Like"}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Reply"})]})]})]},bt.id)),e.comments.length>2&&c.jsx(be,{variant:"ghost",onClick:()=>O(!N),className:"text-gray-600 pl-0 pb-0",children:N?"Show fewer comments":`View all ${e.comments.length} comments`})]}),(C||e.comments.length>0)&&i&&c.jsxs("form",{onSubmit:ia,className:"flex space-x-2",children:[c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Ii,{src:uE(i.profileImage||""),alt:i.username}),c.jsx(ea,{children:Gs(i.username)})]}),c.jsxs("div",{className:"flex-1 flex",children:[c.jsx(Ei,{placeholder:"Write a comment...",value:E,onChange:bt=>T(bt.target.value),className:"flex-1 resize-none min-h-[40px] max-h-[120px] focus-visible:ring-[#1877F2] rounded-full py-2"}),c.jsx(be,{type:"submit",size:"icon",disabled:!E.trim(),className:"ml-2",children:c.jsx(rle,{className:"h-4 w-4"})})]})]})]}),c.jsx(jde,{postId:String(e.id),open:W,onOpenChange:q}),D&&c.jsx(c$e,{postId:Number((e==null?void 0:e.id)??(e==null?void 0:e.post_id)),open:D,onOpenChange:U})]})})}const H1=Wle,cB=PBe,g$e=Gle,Lde=w.forwardRef(({className:e,...t},n)=>c.jsx(j1,{className:jt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));Lde.displayName=j1.displayName;const v$e=Gw("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Xw=w.forwardRef(({side:e="right",className:t,children:n,...i},o)=>c.jsxs(g$e,{children:[c.jsx(Lde,{}),c.jsxs(D1,{ref:o,className:jt(v$e({side:e}),t),...i,children:[n,c.jsxs(Hle,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[c.jsx(po,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Xw.displayName=D1.displayName;const lB=({className:e,...t})=>c.jsx("div",{className:jt("flex flex-col space-y-2 text-center sm:text-left",e),...t});lB.displayName="SheetHeader";const uB=w.forwardRef(({className:e,...t},n)=>c.jsx(L1,{ref:n,className:jt("text-lg font-semibold text-foreground",e),...t}));uB.displayName=L1.displayName;const y$e=w.forwardRef(({className:e,...t},n)=>c.jsx(M1,{ref:n,className:jt("text-sm text-muted-foreground",e),...t}));y$e.displayName=M1.displayName;const z1="https://api.gada.chat";async function Mde(e,t,n){const i=await fetch(z1+"/api/payments/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,amount:t,metadata:n})});if(console.log(i,"resresresres"),!i.ok)throw new Error("Payment initialization failed");return i.json()}async function xQ(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>{u!=null&&u!==""&&n.set(o,String(u))});const i=await fetch(`${z1}/api/payments/transactions?${n.toString()}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function _$e(e){const t=await fetch(z1+"/api/payments/getsystemdetails",{headers:e});if(!t.ok)throw new Error("Failed to load transactions");return t.json()}async function BR(e){const t=await fetch(`${z1}/api/users/fetchuserbalance`,{method:"GET",headers:e,credentials:"include"});if(!t.ok){const i=await t.text().catch(()=>"Failed to load balance");throw new Error(i||"Failed to load balance")}const n=await t.json();return{user_wallet_balance:Number(n.user_wallet_balance)||0,user_points:Number(n.user_points)||0}}const Jw="https://api.gada.chat";async function Zw(e){return e.status===401&&(Ce.error("Your session has been ended Please login again"),localStorage.clear()),e.ok?e.json():e.json().catch(()=>({})).then(t=>{throw new Error(t.error||"Request failed")})}async function TQ(e,t={}){const{cursor:n=0,limit:i=20}=t,o=await fetch(`${Jw}/api/notifications?cursor=${n}&limit=${i}`,{headers:e,credentials:"include"});return Zw(o)}async function b$e(e){const t=await fetch(`${Jw}/api/notifications/unread-count`,{headers:e,credentials:"include"});return Zw(t)}async function E$e(e,t){const n=await fetch(`${Jw}/api/notifications/mark-read`,{method:"POST",headers:{...e,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({ids:t})});return Zw(n)}async function w$e(e){const t=await fetch(`${Jw}/api/notifications/mark-all-read`,{method:"POST",headers:e,credentials:"include"});return Zw(t)}async function S$e(e){const t=await fetch(`${Jw}/api/notifications/mark-seen`,{method:"POST",headers:e,credentials:"include"});return Zw(t)}const Bu=Object.create(null);Bu.open="0";Bu.close="1";Bu.ping="2";Bu.pong="3";Bu.message="4";Bu.upgrade="5";Bu.noop="6";const $R=Object.create(null);Object.keys(Bu).forEach(e=>{$R[Bu[e]]=e});const wU={type:"error",data:"parser error"},Ude=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Fde=typeof ArrayBuffer=="function",Vde=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,dB=({type:e,data:t},n,i)=>Ude&&t instanceof Blob?n?i(t):CQ(t,i):Fde&&(t instanceof ArrayBuffer||Vde(t))?n?i(t):CQ(new Blob([t]),i):i(Bu[e]+(t||"")),CQ=(e,t)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];t("b"+(i||""))},n.readAsDataURL(e)};function RQ(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let lL;function x$e(e,t){if(Ude&&e.data instanceof Blob)return e.data.arrayBuffer().then(RQ).then(t);if(Fde&&(e.data instanceof ArrayBuffer||Vde(e.data)))return t(RQ(e.data));dB(e,!1,n=>{lL||(lL=new TextEncoder),t(lL.encode(n))})}const NQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",FE=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<NQ.length;e++)FE[NQ.charCodeAt(e)]=e;const T$e=e=>{let t=e.length*.75,n=e.length,i,o=0,u,h,p,g;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const v=new ArrayBuffer(t),b=new Uint8Array(v);for(i=0;i<n;i+=4)u=FE[e.charCodeAt(i)],h=FE[e.charCodeAt(i+1)],p=FE[e.charCodeAt(i+2)],g=FE[e.charCodeAt(i+3)],b[o++]=u<<2|h>>4,b[o++]=(h&15)<<4|p>>2,b[o++]=(p&3)<<6|g&63;return v},C$e=typeof ArrayBuffer=="function",hB=(e,t)=>{if(typeof e!="string")return{type:"message",data:Bde(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:R$e(e.substring(1),t)}:$R[n]?e.length>1?{type:$R[n],data:e.substring(1)}:{type:$R[n]}:wU},R$e=(e,t)=>{if(C$e){const n=T$e(e);return Bde(n,t)}else return{base64:!0,data:e}},Bde=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},$de="",N$e=(e,t)=>{const n=e.length,i=new Array(n);let o=0;e.forEach((u,h)=>{dB(u,!1,p=>{i[h]=p,++o===n&&t(i.join($de))})})},A$e=(e,t)=>{const n=e.split($de),i=[];for(let o=0;o<n.length;o++){const u=hB(n[o],t);if(i.push(u),u.type==="error")break}return i};function I$e(){return new TransformStream({transform(e,t){x$e(e,n=>{const i=n.length;let o;if(i<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,i);else if(i<65536){o=new Uint8Array(3);const u=new DataView(o.buffer);u.setUint8(0,126),u.setUint16(1,i)}else{o=new Uint8Array(9);const u=new DataView(o.buffer);u.setUint8(0,127),u.setBigUint64(1,BigInt(i))}e.data&&typeof e.data!="string"&&(o[0]|=128),t.enqueue(o),t.enqueue(n)})}})}let uL;function BC(e){return e.reduce((t,n)=>t+n.length,0)}function $C(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let i=0;for(let o=0;o<t;o++)n[o]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),n}function O$e(e,t){uL||(uL=new TextDecoder);const n=[];let i=0,o=-1,u=!1;return new TransformStream({transform(h,p){for(n.push(h);;){if(i===0){if(BC(n)<1)break;const g=$C(n,1);u=(g[0]&128)===128,o=g[0]&127,o<126?i=3:o===126?i=1:i=2}else if(i===1){if(BC(n)<2)break;const g=$C(n,2);o=new DataView(g.buffer,g.byteOffset,g.length).getUint16(0),i=3}else if(i===2){if(BC(n)<8)break;const g=$C(n,8),v=new DataView(g.buffer,g.byteOffset,g.length),b=v.getUint32(0);if(b>Math.pow(2,21)-1){p.enqueue(wU);break}o=b*Math.pow(2,32)+v.getUint32(4),i=3}else{if(BC(n)<o)break;const g=$C(n,o);p.enqueue(hB(u?g:uL.decode(g),t)),i=0}if(o===0||o>e){p.enqueue(wU);break}}}})}const Wde=4;function ma(e){if(e)return P$e(e)}function P$e(e){for(var t in ma.prototype)e[t]=ma.prototype[t];return e}ma.prototype.on=ma.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};ma.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};ma.prototype.off=ma.prototype.removeListener=ma.prototype.removeAllListeners=ma.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var i,o=0;o<n.length;o++)if(i=n[o],i===t||i.fn===t){n.splice(o,1);break}return n.length===0&&delete this._callbacks["$"+e],this};ma.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,o=n.length;i<o;++i)n[i].apply(this,t)}return this};ma.prototype.emitReserved=ma.prototype.emit;ma.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};ma.prototype.hasListeners=function(e){return!!this.listeners(e).length};const K1=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),Oc=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),k$e="arraybuffer";function Gde(e,...t){return t.reduce((n,i)=>(e.hasOwnProperty(i)&&(n[i]=e[i]),n),{})}const j$e=Oc.setTimeout,D$e=Oc.clearTimeout;function q1(e,t){t.useNativeTimers?(e.setTimeoutFn=j$e.bind(Oc),e.clearTimeoutFn=D$e.bind(Oc)):(e.setTimeoutFn=Oc.setTimeout.bind(Oc),e.clearTimeoutFn=Oc.clearTimeout.bind(Oc))}const L$e=1.33;function M$e(e){return typeof e=="string"?U$e(e):Math.ceil((e.byteLength||e.size)*L$e)}function U$e(e){let t=0,n=0;for(let i=0,o=e.length;i<o;i++)t=e.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function Hde(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function F$e(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function V$e(e){let t={},n=e.split("&");for(let i=0,o=n.length;i<o;i++){let u=n[i].split("=");t[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}return t}class B$e extends Error{constructor(t,n,i){super(t),this.description=n,this.context=i,this.type="TransportError"}}class fB extends ma{constructor(t){super(),this.writable=!1,q1(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,i){return super.emitReserved("error",new B$e(t,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=hB(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=F$e(t);return n.length?"?"+n:""}}class $$e extends fB{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};A$e(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,N$e(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=Hde()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let zde=!1;try{zde=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const W$e=zde;function G$e(){}class H$e extends $$e{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,n){const i=this.request({method:"POST",data:t});i.on("success",n),i.on("error",(o,u)=>{this.onError("xhr post error",o,u)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=t}}let Vv=class WR extends ma{constructor(t,n,i){super(),this.createRequest=t,q1(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const n=Gde(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var o;i.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=WR.requestsCount++,WR.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=G$e,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete WR.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Vv.requestsCount=0;Vv.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",AQ);else if(typeof addEventListener=="function"){const e="onpagehide"in Oc?"pagehide":"unload";addEventListener(e,AQ,!1)}}function AQ(){for(let e in Vv.requests)Vv.requests.hasOwnProperty(e)&&Vv.requests[e].abort()}const z$e=function(){const e=Kde({xdomain:!1});return e&&e.responseType!==null}();class K$e extends H$e{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=z$e&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Vv(Kde,this.uri(),t)}}function Kde(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||W$e))return new XMLHttpRequest}catch{}if(!t)try{return new Oc[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const qde=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class q$e extends fB{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,i=qde?{}:Gde(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,i)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],o=n===t.length-1;dB(i,this.supportsBinary,u=>{try{this.doWrite(i,u)}catch{}o&&K1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=Hde()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const dL=Oc.WebSocket||Oc.MozWebSocket;class Y$e extends q$e{createSocket(t,n,i){return qde?new dL(t,n,i):n?new dL(t,n):new dL(t)}doWrite(t,n){this.ws.send(n)}}class X$e extends fB{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=O$e(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(n).getReader(),o=I$e();o.readable.pipeTo(t.writable),this._writer=o.writable.getWriter();const u=()=>{i.read().then(({done:p,value:g})=>{p||(this.onPacket(g),u())}).catch(p=>{})};u();const h={type:"open"};this.query.sid&&(h.data=`{"sid":"${this.query.sid}"}`),this._writer.write(h).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const i=t[n],o=n===t.length-1;this._writer.write(i).then(()=>{o&&K1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const J$e={websocket:Y$e,webtransport:X$e,polling:K$e},Z$e=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Q$e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function SU(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),i=e.indexOf("]");n!=-1&&i!=-1&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));let o=Z$e.exec(e||""),u={},h=14;for(;h--;)u[Q$e[h]]=o[h]||"";return n!=-1&&i!=-1&&(u.source=t,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=e6e(u,u.path),u.queryKey=t6e(u,u.query),u}function e6e(e,t){const n=/\/{2,9}/g,i=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function t6e(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,o,u){o&&(n[o]=u)}),n}const xU=typeof addEventListener=="function"&&typeof removeEventListener=="function",GR=[];xU&&addEventListener("offline",()=>{GR.forEach(e=>e())},!1);class ff extends ma{constructor(t,n){if(super(),this.binaryType=k$e,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const i=SU(t);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=SU(n.host).host);q1(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const o=i.prototype.name;this.transports.push(o),this._transportsByName[o]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=V$e(this.opts.query)),xU&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},GR.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=Wde,n.transport=t,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&ff.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",ff.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const o=this.writeBuffer[i].data;if(o&&(n+=M$e(o)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,K1(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,i){return this._sendPacket("message",t,n,i),this}send(t,n,i){return this._sendPacket("message",t,n,i),this}_sendPacket(t,n,i,o){if(typeof n=="function"&&(o=n,n=void 0),typeof i=="function"&&(o=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const u={type:t,data:n,options:i};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),o&&this.once("flush",o),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(ff.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),xU&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=GR.indexOf(this._offlineEventListener);i!==-1&&GR.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}ff.protocol=Wde;class n6e extends ff{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),i=!1;ff.priorWebsocketSuccess=!1;const o=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",E=>{if(!i)if(E.type==="pong"&&E.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;ff.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(b(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const T=new Error("probe error");T.transport=n.name,this.emitReserved("upgradeError",T)}}))};function u(){i||(i=!0,b(),n.close(),n=null)}const h=E=>{const T=new Error("probe error: "+E);T.transport=n.name,u(),this.emitReserved("upgradeError",T)};function p(){h("transport closed")}function g(){h("socket closed")}function v(E){n&&E.name!==n.name&&u()}const b=()=>{n.removeListener("open",o),n.removeListener("error",h),n.removeListener("close",p),this.off("close",g),this.off("upgrading",v)};n.once("open",o),n.once("error",h),n.once("close",p),this.once("close",g),this.once("upgrading",v),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&n.push(t[i]);return n}}let r6e=class extends n6e{constructor(t,n={}){const i=typeof t=="object"?t:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(o=>J$e[o]).filter(o=>!!o)),super(t,i)}};function i6e(e,t="",n){let i=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),i=SU(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const u=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+u+":"+i.port+t,i.href=i.protocol+"://"+u+(n&&n.port===i.port?"":":"+i.port),i}const a6e=typeof ArrayBuffer=="function",s6e=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Yde=Object.prototype.toString,o6e=typeof Blob=="function"||typeof Blob<"u"&&Yde.call(Blob)==="[object BlobConstructor]",c6e=typeof File=="function"||typeof File<"u"&&Yde.call(File)==="[object FileConstructor]";function pB(e){return a6e&&(e instanceof ArrayBuffer||s6e(e))||o6e&&e instanceof Blob||c6e&&e instanceof File}function HR(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,i=e.length;n<i;n++)if(HR(e[n]))return!0;return!1}if(pB(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return HR(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&HR(e[n]))return!0;return!1}function l6e(e){const t=[],n=e.data,i=e;return i.data=TU(n,t),i.attachments=t.length,{packet:i,buffers:t}}function TU(e,t){if(!e)return e;if(pB(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=TU(e[i],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=TU(e[i],t));return n}return e}function u6e(e,t){return e.data=CU(e.data,t),delete e.attachments,e}function CU(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=CU(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=CU(e[n],t));return e}const d6e=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],h6e=5;var sr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(sr||(sr={}));class f6e{constructor(t){this.replacer=t}encode(t){return(t.type===sr.EVENT||t.type===sr.ACK)&&HR(t)?this.encodeAsBinary({type:t.type===sr.EVENT?sr.BINARY_EVENT:sr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===sr.BINARY_EVENT||t.type===sr.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=l6e(t),i=this.encodeAsString(n.packet),o=n.buffers;return o.unshift(i),o}}function IQ(e){return Object.prototype.toString.call(e)==="[object Object]"}class mB extends ma{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const i=n.type===sr.BINARY_EVENT;i||n.type===sr.BINARY_ACK?(n.type=i?sr.EVENT:sr.ACK,this.reconstructor=new p6e(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(pB(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const i={type:Number(t.charAt(0))};if(sr[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===sr.BINARY_EVENT||i.type===sr.BINARY_ACK){const u=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const h=t.substring(u,n);if(h!=Number(h)||t.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(h)}if(t.charAt(n+1)==="/"){const u=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););i.nsp=t.substring(u,n)}else i.nsp="/";const o=t.charAt(n+1);if(o!==""&&Number(o)==o){const u=n+1;for(;++n;){const h=t.charAt(n);if(h==null||Number(h)!=h){--n;break}if(n===t.length)break}i.id=Number(t.substring(u,n+1))}if(t.charAt(++n)){const u=this.tryParse(t.substr(n));if(mB.isPayloadValid(i.type,u))i.data=u;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case sr.CONNECT:return IQ(n);case sr.DISCONNECT:return n===void 0;case sr.CONNECT_ERROR:return typeof n=="string"||IQ(n);case sr.EVENT:case sr.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&d6e.indexOf(n[0])===-1);case sr.ACK:case sr.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class p6e{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=u6e(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const m6e=Object.freeze(Object.defineProperty({__proto__:null,Decoder:mB,Encoder:f6e,get PacketType(){return sr},protocol:h6e},Symbol.toStringTag,{value:"Module"}));function Rl(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const g6e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xde extends ma{constructor(t,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Rl(t,"open",this.onopen.bind(this)),Rl(t,"packet",this.onpacket.bind(this)),Rl(t,"error",this.onerror.bind(this)),Rl(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var i,o,u;if(g6e.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const h={type:sr.EVENT,data:n};if(h.options={},h.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const b=this.ids++,E=n.pop();this._registerAckCallback(b,E),h.id=b}const p=(o=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||o===void 0?void 0:o.writable,g=this.connected&&!(!((u=this.io.engine)===null||u===void 0)&&u._hasPingExpired());return this.flags.volatile&&!p||(g?(this.notifyOutgoingListeners(h),this.packet(h)):this.sendBuffer.push(h)),this.flags={},this}_registerAckCallback(t,n){var i;const o=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(o===void 0){this.acks[t]=n;return}const u=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let p=0;p<this.sendBuffer.length;p++)this.sendBuffer[p].id===t&&this.sendBuffer.splice(p,1);n.call(this,new Error("operation has timed out"))},o),h=(...p)=>{this.io.clearTimeoutFn(u),n.apply(this,p)};h.withError=!0,this.acks[t]=h}emitWithAck(t,...n){return new Promise((i,o)=>{const u=(h,p)=>h?o(h):i(p);u.withError=!0,n.push(u),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((o,...u)=>i!==this._queue[0]?void 0:(o!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(o)):(this._queue.shift(),n&&n(null,...u)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:sr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case sr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case sr.EVENT:case sr.BINARY_EVENT:this.onevent(t);break;case sr.ACK:case sr.BINARY_ACK:this.onack(t);break;case sr.DISCONNECT:this.ondisconnect();break;case sr.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let i=!1;return function(...o){i||(i=!0,n.packet({type:sr.ACK,id:t,data:o}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:sr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,t.data)}}}function i_(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}i_.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};i_.prototype.reset=function(){this.attempts=0};i_.prototype.setMin=function(e){this.ms=e};i_.prototype.setMax=function(e){this.max=e};i_.prototype.setJitter=function(e){this.jitter=e};class RU extends ma{constructor(t,n){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,q1(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new i_({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const o=n.parser||m6e;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new r6e(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const o=Rl(n,"open",function(){i.onopen(),t&&t()}),u=p=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",p),t?t(p):this.maybeReconnectOnOpen()},h=Rl(n,"error",u);if(this._timeout!==!1){const p=this._timeout,g=this.setTimeoutFn(()=>{o(),u(new Error("timeout")),n.close()},p);this.opts.autoUnref&&g.unref(),this.subs.push(()=>{this.clearTimeoutFn(g)})}return this.subs.push(o),this.subs.push(h),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Rl(t,"ping",this.onping.bind(this)),Rl(t,"data",this.ondata.bind(this)),Rl(t,"error",this.onerror.bind(this)),Rl(t,"close",this.onclose.bind(this)),Rl(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){K1(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new Xde(this,t,n),this.nsps[t]=i),i}_destroy(t){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let i=0;i<n.length;i++)this.engine.write(n[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(o=>{o?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",o)):t.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const hE={};function zR(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=i6e(e,t.path||"/socket.io"),i=n.source,o=n.id,u=n.path,h=hE[o]&&u in hE[o].nsps,p=t.forceNew||t["force new connection"]||t.multiplex===!1||h;let g;return p?g=new RU(i,t):(hE[o]||(hE[o]=new RU(i,t)),g=hE[o]),n.query&&!t.query&&(t.query=n.queryKey),g.socket(n.path,t)}Object.assign(zR,{Manager:RU,Socket:Xde,io:zR,connect:zR});const v6e="https://api.gada.chat";function gB(e){console.log(e,"connectSockettoken");const n=zR(v6e,{transports:["websocket"],auth:{token:e},withCredentials:!0});return n.on("connect",()=>console.log("[client] connected",n.id)),n.on("connect_error",i=>console.warn("[client] connect_error",i)),n.on("error",i=>console.warn("[client] error",i)),n.on("disconnect",i=>console.warn("[client] disconnected",i)),n}const Jde=w.createContext(null),Zde=()=>{const e=w.useContext(Jde);if(!e)throw new Error("useNotifications must be used within NotificationProvider");return e},OQ="notif_sound_enabled";function y6e({children:e}){const{accessToken:t}=ct(),n=St(t),[i,o]=w.useState([]),[u,h]=w.useState(0),p=w.useRef(0),g=w.useRef(20),v=w.useRef(null),[b,E]=w.useState(()=>{const q=localStorage.getItem(OQ);return q===null?!0:q==="1"}),T=q=>{const Y=typeof q=="function"?q(b):q;E(Y),localStorage.setItem(OQ,Y?"1":"0")},C=b,R=w.useRef(null),N=w.useRef(!1),O=w.useRef(null),j=w.useRef(0),k=()=>{const q=window.AudioContext||window.webkitAudioContext;if(!q)return;O.current||(O.current=new q);const Y=O.current,z=Y.createOscillator(),Z=Y.createGain();z.type="sine",z.frequency.value=880,z.connect(Z),Z.connect(Y.destination);const X=Y.currentTime;Z.gain.setValueAtTime(0,X),Z.gain.linearRampToValueAtTime(.12,X+.01),Z.gain.exponentialRampToValueAtTime(.001,X+.25),z.start(X),z.stop(X+.3)};w.useEffect(()=>{const q=new Audio("/sounds/notify.mp3");q.preload="auto",q.crossOrigin="anonymous",q.volume=.9,R.current=q;const Y=async()=>{try{await q.play(),q.pause(),q.currentTime=0,N.current=!0}catch{}window.removeEventListener("pointerdown",Y),window.removeEventListener("keydown",Y),window.removeEventListener("touchstart",Y)};return window.addEventListener("pointerdown",Y,{once:!0}),window.addEventListener("keydown",Y,{once:!0}),window.addEventListener("touchstart",Y,{once:!0}),()=>{try{q.pause()}catch{}}},[]);const P=()=>{if(!C)return;const q=Date.now();if(q-j.current<300)return;j.current=q;const Y=R.current;Y&&N.current?(Y.currentTime=0,Y.play().catch(()=>k())):k()},M=async()=>{p.current=0;const q=g.current,[Y,{count:z}]=await Promise.all([TQ(n,{cursor:0,limit:q}),b$e(n)]);o(Y),h(z),p.current=Y.length},D=async()=>{const q=p.current,Y=g.current,z=await TQ(n,{cursor:q,limit:Y});z.length&&(o(Z=>[...Z,...z]),p.current=q+z.length)},U=async q=>{q!=null&&q.length&&(await E$e(n,q),o(Y=>Y.map(z=>q.includes(z.id)?{...z,readAt:z.readAt??new Date().toISOString()}:z)),h(Y=>Math.max(0,Y-q.length)))},F=async()=>{await w$e(n),o(q=>q.map(Y=>({...Y,readAt:Y.readAt??new Date().toISOString()}))),h(0)},H=async()=>{await S$e(n),o(q=>q.map(Y=>({...Y,seenAt:Y.seenAt??new Date().toISOString()})))};w.useEffect(()=>{if(!t)return;M().catch(console.error);const q=gB(t);return v.current=q,q.on("notification:new",Y=>{o(z=>[Y,...z]),h(z=>z+1),P()}),()=>{q.close()}},[t]);const W={items:i,unreadCount:u,loadMore:D,refresh:M,markAsRead:U,markAll:F,markSeenNow:H,soundEnabled:C,setSoundEnabled:T};return c.jsx(Jde.Provider,{value:W,children:e})}const PQ="https://api.gada.chat";function _6e(){const{items:e,unreadCount:t,markAll:n,markSeenNow:i,soundEnabled:o,setSoundEnabled:u}=Zde(),[h,p]=w.useState(!1),g=w.useRef(null),[v,b]=w.useState(null),T=Bc().state,C=(T==null?void 0:T.modal)===!0||(T==null?void 0:T.isModal)===!0,R=typeof window<"u"&&window.matchMedia("(min-width: 640px)").matches;return w.useEffect(()=>{h&&i().catch(()=>{})},[h]),w.useEffect(()=>{if(!h||!R||!g.current)return;const N=g.current.getBoundingClientRect();b({top:N.bottom+8+window.scrollY,left:N.right-384+window.scrollX,width:384})},[h,R]),w.useEffect(()=>{function N(O){if(!h||!R)return;const j=document.getElementById("notif-popover");j&&(j===O.target||j.contains(O.target))||g.current&&g.current.contains(O.target)||p(!1)}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[h,R]),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{ref:g,onClick:()=>p(N=>!N),className:"relative p-2 rounded-full hover:bg-gray-100","aria-label":"Notifications",children:[c.jsx(zce,{className:"h-6 w-6 text-gray-700"}),t>0&&c.jsx("span",{className:"absolute -top-0.5 -right-0.5 bg-red-600 text-white text-[10px] leading-none px-1.5 py-0.5 rounded-full",children:t>99?"99+":t})]}),h&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"fixed inset-0 z-[95] sm:hidden bg-black/10",onClick:()=>p(!1),"aria-label":"Close notifications"}),c.jsxs("div",{className:"sm:hidden fixed inset-x-2 top-[64px] z-[100] bg-white shadow-xl rounded-lg overflow-hidden",children:[c.jsx(kQ,{soundEnabled:o,setSoundEnabled:u,onMarkAll:()=>n().catch(()=>{})}),c.jsx(jQ,{items:e,onNavigate:()=>p(!1)}),c.jsx(DQ,{onNavigate:()=>p(!1)})]}),R&&v&&Af.createPortal(c.jsxs("div",{id:"notif-popover",className:"z-[110] bg-white shadow-xl rounded-lg overflow-hidden border",style:{position:"absolute",top:v.top,left:v.left,width:v.width},children:[c.jsx(kQ,{soundEnabled:o,setSoundEnabled:u,onMarkAll:()=>n().catch(()=>{})}),c.jsx(jQ,{items:e,onNavigate:()=>p(!1)}),c.jsx(DQ,{onNavigate:()=>p(!1)})]}),document.body)]}),C&&(T==null?void 0:T.postId)&&c.jsx(jde,{postId:String(T.postId),open:!0,onOpenChange:()=>window.history.back()})]})}function kQ({soundEnabled:e,setSoundEnabled:t,onMarkAll:n}){return c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("div",{className:"font-semibold",children:"Notifications"}),c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsxs("button",{onClick:()=>t(i=>!i),className:"inline-flex items-center gap-1 text-gray-600 hover:text-gray-900",title:e?"Mute notification sound":"Unmute notification sound",children:[e?c.jsx(zce,{className:"h-4 w-4"}):c.jsx(MVe,{className:"h-4 w-4"}),c.jsx("span",{className:"hidden sm:inline",children:e?"Sound on":"Muted"})]}),c.jsx("span",{className:"hidden sm:inline text-gray-300",children:"•"}),c.jsx("button",{onClick:n,className:"text-blue-600 hover:underline",children:"Mark all as read"})]})]})}function jQ({items:e,onNavigate:t}){return c.jsxs("ul",{className:"max-h-[70vh] overflow-y-auto overscroll-contain divide-y",children:[e.slice(0,20).map(n=>c.jsx("li",{className:`p-3 ${n.readAt?"":"bg-blue-50"}`,children:c.jsx(b6e,{n,onNavigate:t})},n.id)),e.length===0&&c.jsx("li",{className:"p-6 text-center text-gray-500",children:"No notifications"})]})}function DQ({onNavigate:e}){return c.jsx("div",{className:"p-2 text-center border-t",children:c.jsx(At,{to:"/notifications",onClick:e,className:"inline-block text-sm text-blue-600 hover:underline",children:"See all"})})}function b6e({n:e,onNavigate:t}){var h;const n=E6e(e),i=w6e(e),o=Bc(),u=`${o.pathname}${o.search}${o.hash}`;return c.jsxs(At,{to:i,state:{isModal:!0,returnTo:u,postId:(((h=e.meta)==null?void 0:h.postId)||e.entityId)??void 0},onClick:t,className:"flex items-start gap-3",children:[c.jsx("img",{src:e.actorAvatar?PQ+"/uploads/"+Xn(e.actorAvatar):PQ+"/uploads//profile/defaultavatar.png",alt:"",className:"h-10 w-10 rounded-full object-cover flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold truncate",children:e.actorName})," ",n]}),c.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),!e.readAt&&c.jsx("span",{className:"mt-2 h-2 w-2 bg-blue-600 rounded-full flex-shrink-0"})]})}function E6e(e){switch(e.type){case"post_like":return"liked your post.";case"post_comment":return"commented on your post.";case"post_share":return"shared your post.";case"friend_request":return"sent you a friend request.";case"friend_accept":return"accepted your friend request.";case"reel_like":return"liked your reel.";case"reel_comment":return"commented on your reel.";case"group_post":return"posted in your group.";case"new_message":return"sent new message.";default:return"sent you a notification."}}function w6e(e){const t=e.meta||{};switch(e.entityType){case"post":return`/posts/${t.postId||e.entityId}`;case"reel":return"/reels";case"group":return`/groups/${t.groupId||e.entityId}`;case"group_post":return`/groups/${t.groupId}/posts/${e.entityId}`;case"user":return`/profile/${e.actorId}`;default:return"#"}}var Y1="Popover",[Qde,cxt]=Fs(Y1,[If]),Qw=If(),[S6e,Pf]=Qde(Y1),ehe=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:o,onOpenChange:u,modal:h=!1}=e,p=Qw(t),g=w.useRef(null),[v,b]=w.useState(!1),[E,T]=Bd({prop:i,defaultProp:o??!1,onChange:u,caller:Y1});return c.jsx(b4,{...p,children:c.jsx(S6e,{scope:t,contentId:Ll(),triggerRef:g,open:E,onOpenChange:T,onOpenToggle:w.useCallback(()=>T(C=>!C),[T]),hasCustomAnchor:v,onCustomAnchorAdd:w.useCallback(()=>b(!0),[]),onCustomAnchorRemove:w.useCallback(()=>b(!1),[]),modal:h,children:n})})};ehe.displayName=Y1;var the="PopoverAnchor",x6e=w.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=Pf(the,n),u=Qw(n),{onCustomAnchorAdd:h,onCustomAnchorRemove:p}=o;return w.useEffect(()=>(h(),()=>p()),[h,p]),c.jsx(Mw,{...u,...i,ref:t})});x6e.displayName=the;var nhe="PopoverTrigger",rhe=w.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=Pf(nhe,n),u=Qw(n),h=Dn(t,o.triggerRef),p=c.jsx(Qt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":che(o.open),...i,ref:h,onClick:Tt(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?p:c.jsx(Mw,{asChild:!0,...u,children:p})});rhe.displayName=nhe;var vB="PopoverPortal",[T6e,C6e]=Qde(vB,{forceMount:void 0}),ihe=e=>{const{__scopePopover:t,forceMount:n,children:i,container:o}=e,u=Pf(vB,t);return c.jsx(T6e,{scope:t,forceMount:n,children:c.jsx(is,{present:n||u.open,children:c.jsx(Uw,{asChild:!0,container:o,children:i})})})};ihe.displayName=vB;var fy="PopoverContent",ahe=w.forwardRef((e,t)=>{const n=C6e(fy,e.__scopePopover),{forceMount:i=n.forceMount,...o}=e,u=Pf(fy,e.__scopePopover);return c.jsx(is,{present:i||u.open,children:u.modal?c.jsx(N6e,{...o,ref:t}):c.jsx(A6e,{...o,ref:t})})});ahe.displayName=fy;var R6e=yf("PopoverContent.RemoveScroll"),N6e=w.forwardRef((e,t)=>{const n=Pf(fy,e.__scopePopover),i=w.useRef(null),o=Dn(t,i),u=w.useRef(!1);return w.useEffect(()=>{const h=i.current;if(h)return P1(h)},[]),c.jsx(zw,{as:R6e,allowPinchZoom:!0,children:c.jsx(she,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Tt(e.onCloseAutoFocus,h=>{var p;h.preventDefault(),u.current||(p=n.triggerRef.current)==null||p.focus()}),onPointerDownOutside:Tt(e.onPointerDownOutside,h=>{const p=h.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,v=p.button===2||g;u.current=v},{checkForDefaultPrevented:!1}),onFocusOutside:Tt(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),A6e=w.forwardRef((e,t)=>{const n=Pf(fy,e.__scopePopover),i=w.useRef(!1),o=w.useRef(!1);return c.jsx(she,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h,p;(h=e.onCloseAutoFocus)==null||h.call(e,u),u.defaultPrevented||(i.current||(p=n.triggerRef.current)==null||p.focus(),u.preventDefault()),i.current=!1,o.current=!1},onInteractOutside:u=>{var g,v;(g=e.onInteractOutside)==null||g.call(e,u),u.defaultPrevented||(i.current=!0,u.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const h=u.target;((v=n.triggerRef.current)==null?void 0:v.contains(h))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&o.current&&u.preventDefault()}})}),she=w.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:u,disableOutsidePointerEvents:h,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:v,onInteractOutside:b,...E}=e,T=Pf(fy,n),C=Qw(n);return I1(),c.jsx(Hw,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:u,children:c.jsx(Gy,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:b,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:v,onDismiss:()=>T.onOpenChange(!1),children:c.jsx(b1,{"data-state":che(T.open),role:"dialog",id:T.contentId,...C,...E,ref:t,style:{...E.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ohe="PopoverClose",I6e=w.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=Pf(ohe,n);return c.jsx(Qt.button,{type:"button",...i,ref:t,onClick:Tt(e.onClick,()=>o.onOpenChange(!1))})});I6e.displayName=ohe;var O6e="PopoverArrow",P6e=w.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,o=Qw(n);return c.jsx(E1,{...o,...i,ref:t})});P6e.displayName=O6e;function che(e){return e?"open":"closed"}var k6e=ehe,j6e=rhe,D6e=ihe,lhe=ahe;const L6e=k6e,M6e=j6e,uhe=w.forwardRef(({className:e,align:t="center",sideOffset:n=4,...i},o)=>c.jsx(D6e,{children:c.jsx(lhe,{ref:o,align:t,sideOffset:n,className:jt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i})}));uhe.displayName=lhe.displayName;const kf="https://api.gada.chat";async function QE(e={}){const t=await fetch(`${kf}/api/messenger/conversations`,{credentials:"include",headers:e});if(!t.ok)throw new Error("Failed to load conversations");return t.json()}async function NU(e,t={}){const n=await fetch(`${kf}/api/messenger/conversations/open`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({userId:e})});if(!n.ok)throw new Error("Failed to open conversation");return n.json()}async function dhe(e,{cursor:t,limit:n=20}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=await fetch(`${kf}/api/messenger/conversations/${e}/messages?${o.toString()}`,{credentials:"include",headers:i});if(!u.ok)throw new Error("Failed to load messages");return u.json()}async function U6e(e,{text:t,image:n,voice:i},o={}){const u=new FormData;t&&u.append("message",t),n&&u.append("image",n),i&&u.append("voice",i);const h=await fetch(`${kf}/api/messenger/conversations/${e}/messages`,{method:"POST",credentials:"include",headers:o,body:u});if(!h.ok)throw new Error("Failed to send message");return h.json()}async function hhe(e,t,n={}){const i=await fetch(`${kf}/api/messenger/conversations/${e}/typing`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({typing:t})});if(!i.ok)throw new Error("Failed to set typing");return i.json()}async function fhe(e,t={}){const n=await fetch(`${kf}/api/messenger/conversations/${e}/seen`,{method:"POST",credentials:"include",headers:t});if(!n.ok)throw new Error("Failed to mark seen");return n.json()}async function F6e(e,t={}){const n=await fetch(`${kf}/api/messenger/users/suggest?q=${encodeURIComponent(e)}`,{credentials:"include",headers:t});if(!n.ok)throw new Error("Failed to search users");return n.json()}async function V6e(e,t={}){const n=await fetch(`${kf}/api/messenger/story-reply`,{method:"POST",credentials:"include",headers:t,body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed");return n.json()}const V0="https://api.gada.chat",B6e={iceServers:[{urls:["stun:stun.l.google.com:19302"]}],iceTransportPolicy:"all"};function $6e(e){if(!(e!=null&&e.startsWith("::meta::")))return{body:e};const t=e.indexOf("::/meta::");if(t===-1)return{body:e};const n=e.slice(8,t),i=e.slice(t+9);try{return{meta:JSON.parse(n),body:i}}catch{return{body:e}}}function W6e(e){return e&&{1:"👍",2:"❤️",3:"😆",4:"😲",5:"😢",6:"😡"}[e]||null}async function G6e(e,t,n,i){const o=await fetch(`${V0}/api/messenger/call/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:i},body:JSON.stringify({conversationId:e,toUserId:t,type:n})});if(!o.ok)throw new Error("Failed to start call");return o.json()}async function H6e(e,t,n){fetch(`${V0}/api/messenger/call/answer`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({callId:e,type:t})})}async function z6e(e,t,n,i){fetch(`${V0}/api/messenger/call/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({callId:e,type:t,declined:!!i})})}function K6e({open:e,onOpenChange:t,kind:n,peer:i,conversationId:o,socket:u,authKey:h,incoming:p,offer:g,room:v,callId:b}){const E=w.useRef(null),T=w.useRef(null),C=w.useRef(null),R=w.useRef(null),[N,O]=w.useState(!1),[j,k]=w.useState(n==="audio"),[P,M]=w.useState(!1),[D,U]=w.useState(b??null),[F,H]=w.useState(v??null);function W(){if(C.current)return C.current;const J=new RTCPeerConnection(B6e);return J.ontrack=re=>{const[ee]=re.streams;T.current&&ee&&(T.current.srcObject=ee)},J.onicecandidate=re=>{!re.candidate||!F||u==null||u.emit("call:candidate",{room:F,candidate:re.candidate})},C.current=J,J}async function q(J){const re=await navigator.mediaDevices.getUserMedia({audio:!0,video:J==="video"});R.current=re,E.current&&(E.current.srcObject=re);const ee=W();re.getTracks().forEach(de=>ee.addTrack(de,re))}async function Y(){M(!0);try{const J=await G6e(o,i.id,n,h);H(J.room),U(J.callId),u==null||u.emit("call:join",{room:J.room}),await q(n);const re=W(),ee=await re.createOffer();await re.setLocalDescription(ee),u==null||u.emit("call:offer",{toUserId:i.id,conversationId:o,kind:n,room:J.room,callId:J.callId,sdp:ee})}finally{M(!1)}}async function z(J,re,ee){M(!0);try{u==null||u.emit("call:join",{room:ee}),await q(n);const de=W();await de.setRemoteDescription(new RTCSessionDescription(J));const xe=await de.createAnswer();await de.setLocalDescription(xe),u==null||u.emit("call:answer",{room:ee,sdp:xe,callId:re,kind:n,conversationId:o}),await H6e(re,n,h)}finally{M(!1)}}w.useEffect(()=>{if(!u)return;const J=async({room:de,sdp:xe})=>{!F||de!==F||await W().setRemoteDescription(new RTCSessionDescription(xe))},re=async({room:de,candidate:xe})=>{if(!(!F||de!==F))try{await W().addIceCandidate(new RTCIceCandidate(xe))}catch{}},ee=({room:de})=>{F&&de===F&&se()};return u.on("call:answer",J),u.on("call:candidate",re),u.on("call:end",ee),()=>{u.off("call:answer",J),u.off("call:candidate",re),u.off("call:end",ee)}},[u,F]),w.useEffect(()=>{e&&(async()=>p&&g&&v&&b?(H(v),U(b),await z(g,b,v)):await Y())()},[e]);function Z(){const J=R.current;J&&(J.getAudioTracks().forEach(re=>re.enabled=!re.enabled),O(!N))}function X(){const J=R.current;J&&(J.getVideoTracks().forEach(re=>re.enabled=!re.enabled),k(!j))}function ae(){var J,re,ee;try{(J=C.current)==null||J.getSenders().forEach(de=>{var xe;return(xe=de.track)==null?void 0:xe.stop()})}catch{}try{(re=R.current)==null||re.getTracks().forEach(de=>de.stop())}catch{}try{(ee=C.current)==null||ee.close()}catch{}C.current=null,R.current=null}function se(J){D&&z6e(D,n,h,J),F&&(u==null||u.emit("call:end",{room:F})),ae(),t(!1)}return e?c.jsx("div",{className:"fixed inset-0 z-[95] bg-black/50 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white w-full max-w-[820px] rounded-xl shadow-xl overflow-hidden",children:[c.jsxs("div",{className:"px-4 h-12 bg-[#1877F2] text-white flex items-center justify-between",children:[c.jsxs("div",{className:"font-medium",children:[n==="video"?"Video call":"Audio call"," with ",(i==null?void 0:i.fullName)||(i==null?void 0:i.username)]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(be,{size:"icon",variant:"ghost",className:"text-white hover:bg-white/10",onClick:Z,title:N?"Unmute":"Mute",children:N?c.jsx(n4e,{className:"h-5 w-5"}):c.jsx(ele,{className:"h-5 w-5"})}),n==="video"&&c.jsx(be,{size:"icon",variant:"ghost",className:"text-white hover:bg-white/10",onClick:X,title:j?"Camera on":"Camera off",children:j?c.jsx(f4e,{className:"h-5 w-5"}):c.jsx(O0,{className:"h-5 w-5"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"text-white hover:bg-red-500/20",onClick:()=>se(!1),title:"End call",children:c.jsx(s4e,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:"p-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx("video",{ref:E,muted:!0,playsInline:!0,autoPlay:!0,className:"w-full aspect-video bg-black rounded"}),c.jsx("video",{ref:T,playsInline:!0,autoPlay:!0,className:"w-full aspect-video bg-black rounded"})]}),P&&c.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"Connecting…"})]})}):null}function q6e({item:e,incomingOffer:t,onConsumeIncoming:n}){const{conversationId:i,peer:o}=e,{minimizeWindow:u,closeWindow:h,socket:p,authKey:g,authKeyUpload:v}=Cm(),[b,E]=w.useState(!!e.minimized),[T,C]=w.useState(null),[R,N]=w.useState(null),[O,j]=w.useState(!1),[k,P]=w.useState(!1),[M,D]=w.useState(""),[U,F]=w.useState(null),[H,W]=w.useState(null),[q,Y]=w.useState(!1),[z,Z]=w.useState("audio"),[X,ae]=w.useState(null),se=w.useRef(null),J=w.useRef(!0),re=w.useRef(!1);w.useEffect(()=>{function Te(Pe){const st=Pe.detail;st&&st.conversationId===i&&ae({kind:st.kind,offer:st.sdp,room:st.room,callId:st.callId})}return window.addEventListener("gada:call-offer",Te),()=>window.removeEventListener("gada:call-offer",Te)},[i]),w.useEffect(()=>{const Te=window.__GADA_OFFERS__;if(!Te)return;const Pe=Te[i];Pe&&(ae({kind:Pe.kind,offer:Pe.sdp,room:Pe.room,callId:Pe.callId}),delete Te[i])},[i]),w.useEffect(()=>{t&&t.conversationId===i&&(ae({kind:t.kind,offer:t.sdp,room:t.room,callId:t.callId}),n==null||n(i))},[t,i,n]),w.useEffect(()=>{u(i,b)},[b,i,u]),w.useEffect(()=>{ee()},[i]);async function ee(){C(null),N(null),j(!1),await de(!0),requestAnimationFrame(()=>{se.current&&(se.current.scrollTop=se.current.scrollHeight)})}async function de(Te=!1){if(!(re.current||O&&!Te)){re.current=!0,P(!0);try{const{items:Pe=[],nextCursor:qe}=await dhe(i,{cursor:Te?null:R,limit:25},{Authorization:g});C(st=>st?[...Pe,...st]:Pe),N(qe??null),(!qe||Pe.length===0)&&j(!0),Te&&await fhe(i,{Authorization:g})}catch(Pe){console.error(Pe)}finally{re.current=!1,P(!1)}}}async function xe(){if(!(!M&&!U&&!H))try{const Te=await U6e(i,{text:M,image:U,voice:H},{Authorization:v});C(Pe=>Pe?[...Pe,{...Te}]:[{...Te}]),D(""),F(null),W(null)}catch(Te){console.error(Te)}}w.useEffect(()=>{const Te=setTimeout(()=>{hhe(i,!1,{Authorization:g}).catch(()=>{})},900);return()=>clearTimeout(Te)},[M,i,g]),w.useEffect(()=>{if(!p)return;const Te=({message:Pe})=>{Pe.conversationId===i&&C(qe=>qe?[...qe,Pe]:[Pe])};return p.on("message:new",Te),()=>{p.off("message:new",Te)}},[p,i]),w.useEffect(()=>{if(!p)return;const Te=({conversationId:Pe,kind:qe,room:st,callId:ze,sdp:ft})=>{Pe===i&&ae({kind:qe,offer:ft,room:st,callId:ze})};return p.on("call:offer",Te),()=>{p.off("call:offer",Te)}},[p,i]),w.useEffect(()=>{!se.current||!T||b||J.current&&(se.current.scrollTop=se.current.scrollHeight)},[T,b]);function ve(Te){const Pe=Te.currentTarget,qe=Pe.scrollHeight-Pe.scrollTop-Pe.clientHeight;if(J.current=qe<80,Pe.scrollTop<=0&&!k&&!O){const st=Pe.scrollHeight;de(!1).then(()=>{requestAnimationFrame(()=>{const ze=Pe.scrollHeight-st;Pe.scrollTop=ze})})}}return c.jsxs("div",{className:"w-[320px] bg-white rounded-xl shadow-xl border border-slate-200 flex flex-col overflow-hidden max-h-[75vh] md:max-h-[620px]",children:[c.jsxs("div",{className:"h-12 px-3 rounded-t-xl bg-[#1877F2] text-white flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs($i,{className:"h-7 w-7 ring-2 ring-white/20",children:[c.jsx(Ii,{src:o!=null&&o.avatar?V0+"/uploads/"+Xn(o.avatar):""}),c.jsx(ea,{children:((o==null?void 0:o.fullName)||(o==null?void 0:o.username)||"?").slice(0,1).toUpperCase()})]}),c.jsx("div",{className:"text-sm font-medium",children:(o==null?void 0:o.fullName)||(o==null?void 0:o.username)})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>{Z("audio"),Y(!0)},title:"Audio call",children:c.jsx(o4e,{className:"h-4 w-4"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>{Z("video"),Y(!0)},title:"Video call",children:c.jsx(jN,{className:"h-4 w-4"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>E(Te=>!Te),title:b?"Expand":"Minimize",children:b?c.jsx(P4,{className:"h-4 w-4"}):c.jsx(Vw,{className:"h-4 w-4"})}),c.jsx(be,{size:"icon",variant:"ghost",className:"h-8 w-8 text-white hover:bg-white/10",onClick:()=>h(i),title:"Close",children:c.jsx(po,{className:"h-4 w-4"})})]})]}),X&&c.jsxs("div",{className:"px-3 py-2 bg-amber-50 border-b text-sm flex items-center justify-between",children:[c.jsxs("div",{children:[X.kind==="video"?"Video":"Audio"," call from ",(o==null?void 0:o.fullName)||(o==null?void 0:o.username)]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{size:"sm",onClick:()=>{Z(X.kind),Y(!0)},children:"Accept"}),c.jsx(be,{size:"sm",variant:"secondary",onClick:()=>ae(null),children:"Decline"})]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-3 py-2",ref:se,onScroll:ve,children:[!T&&c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"}),T==null?void 0:T.map(Te=>{var ke;const Pe=Te.authorId!==(o==null?void 0:o.id),{meta:qe,body:st}=$6e(Te.text||""),ze=(qe==null?void 0:qe.kind)==="story_reply",ft=qe?W6e(((ke=qe==null?void 0:qe.reply)==null?void 0:ke.emoji_code)||null):null,$e=(qe==null?void 0:qe.story_preview_url)||null,at=ze?c.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] text-gray-500",children:[c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",className:"text-gray-400",children:c.jsx("path",{fill:"currentColor",d:"M10 17l5-5-5-5v10z"})}),c.jsxs("span",{children:[Pe?"You replied":`${(o==null?void 0:o.fullName)||(o==null?void 0:o.username)||"Someone"} replied`," to ",Pe?(o==null?void 0:o.fullName)||(o==null?void 0:o.username)||"their":"your"," story"]})]}):null;return c.jsx("div",{className:`my-2 flex ${Pe?"justify-end":"justify-start"}`,children:c.jsxs("div",{className:`max-w-[78%] ${Pe?"items-end":"items-start"} flex gap-2`,children:[c.jsxs("div",{className:`${Pe?"text-right":"text-left"}`,children:[at,c.jsxs("div",{className:`inline-block rounded-2xl px-3 py-2 text-sm ${Pe?"bg-[#1877F2] text-white":"bg-gray-100 text-gray-900"}`,children:[ze&&ft&&c.jsx("span",{className:"mr-2 text-xl align-middle",children:ft}),st!=null&&st.trim()?c.jsx("span",{className:"align-middle whitespace-pre-wrap break-words",children:st}):null,!(st!=null&&st.trim())&&Te.image&&c.jsx("img",{src:V0+"/uploads/"+Xn(Te.image),className:"mt-1 max-w-[220px] rounded-lg"})]})]}),ze&&$e&&c.jsx("a",{href:$e,target:"_blank",rel:"noreferrer",className:"block w-[64px] h-[64px] rounded-lg overflow-hidden border shadow-sm",title:"Open story preview",children:c.jsx("img",{src:$e,alt:"Only text",className:"w-full h-full object-cover"})})]})},Te.id)})]}),c.jsxs("div",{className:"px-2 py-2 border-t flex items-end gap-2",children:[c.jsx(be,{size:"icon",variant:"ghost",children:c.jsx(Zce,{className:"h-5 w-5"})}),c.jsx(be,{size:"icon",variant:"ghost",children:c.jsx(ele,{className:"h-5 w-5"})}),c.jsx(Ae,{value:M,onChange:Te=>D(Te.target.value),placeholder:"Write a message…",onKeyDown:Te=>{Te.key==="Enter"&&xe()}}),c.jsxs(be,{onClick:xe,children:[c.jsx(rle,{className:"h-4 w-4 mr-1"}),"Send"]})]}),c.jsx(K6e,{open:q,onOpenChange:Te=>{Y(Te),Te||ae(null)},kind:z,peer:o,conversationId:i,socket:p,authKey:g,incoming:!!X,offer:X==null?void 0:X.offer,room:X==null?void 0:X.room,callId:X==null?void 0:X.callId})]})}function Y6e({stashIncoming:e}){const{socket:t}=Cm(),n=w.useRef(!1);return w.useEffect(()=>{if(!t)return;const i=()=>{if(n.current)return;const o=u=>{console.log("emit received");const h={conversationId:Number(u.conversationId),fromUserId:Number(u.fromUserId),kind:u.kind,room:u.room,callId:Number(u.callId),sdp:u.sdp};e(h)};t.on("call:offer",o),n.current=!0,t.once("disconnect",()=>{try{t.off("call:offer",o)}catch{}n.current=!1})};return t.connected&&i(),t.on("connect",i),()=>{try{t.off("connect",i)}catch{}n.current=!1}},[t,e]),null}function X6e(){const{windows:e,socket:t,ensureWindowForConversation:n,openConversation:i,openChatWith:o,openWindowForUser:u}=Cm(),[h,p]=w.useState({}),g=async b=>{n?await n(b.conversationId,b.fromUserId):o?await o(b.fromUserId):u?await u(b.fromUserId):i&&i(b.conversationId,void 0),p(E=>({...E,[b.conversationId]:b}))},v=b=>p(E=>{const{[b]:T,...C}=E;return C});return c.jsxs(c.Fragment,{children:[c.jsx(Y6e,{stashIncoming:g}),(e==null?void 0:e.length)>0&&c.jsx("div",{className:"fixed bottom-2 right-2 z-[90] flex gap-2 overflow-x-auto max-w-full pr-2",children:e.map(b=>c.jsx(q6e,{item:b,incomingOffer:h[b.conversationId],onConsumeIncoming:v},b.conversationId))})]})}const phe=w.createContext(null);function J6e({children:e}){const{accessToken:t}=ct(),n=St(t),i=Bl(t),o=(n==null?void 0:n.Authorization)??"",u=(i==null?void 0:i.Authorization)??"",[h,p]=w.useState([]),[g,v]=w.useState({}),b=w.useRef(null);w.useEffect(()=>{if(!t)return;const j=gB(t);return b.current=j,()=>{try{j.close()}catch{}b.current=null}},[t]);const E=w.useCallback(async j=>{if(g[j])return g[j];try{const P=(await QE(n)).find(M=>M.conversationId===j);if(P)return v(M=>({...M,[j]:P.peer})),P.peer}catch{}return null},[n,g]),T=w.useCallback(async(j,k)=>{const P=k||await E(j);P&&p(M=>{if(M.some(F=>F.conversationId===j))return M.map(F=>F.conversationId===j?{...F,minimized:!1}:F);const U=[...M,{conversationId:j,peer:P,minimized:!1}];return U.length>4?U.slice(U.length-4):U})},[E]),C=w.useCallback(async(j,k)=>{const{conversationId:P}=await NU(j,n);k&&v(M=>({...M,[P]:k})),await T(P,k)},[n,T]),R=w.useCallback(j=>{p(k=>k.filter(P=>P.conversationId!==j))},[]),N=w.useCallback((j,k)=>{p(P=>P.map(M=>M.conversationId===j?{...M,minimized:k}:M))},[]),O=w.useMemo(()=>({windows:h,openConversation:T,openChatWith:C,closeWindow:R,minimizeWindow:N,socket:b.current,authKey:o,authKeyUpload:u}),[h,T,C,R,N,o,u]);return c.jsxs(phe.Provider,{value:O,children:[e,c.jsx(X6e,{})]})}function Cm(){const e=w.useContext(phe);if(!e)throw new Error("useChatDock must be used within ChatDockProvider");return e}const Z6e="https://api.gada.chat";function mhe({open:e,onOpenChange:t,onPick:n,search:i}){const[o,u]=w.useState(""),[h,p]=w.useState(!1),[g,v]=w.useState([]),b=w.useRef(null),E=w.useRef();return w.useEffect(()=>{if(!e){u(""),v([]);return}},[e]),w.useEffect(()=>{if(!e)return;const T=o.trim();if(E.current&&clearTimeout(E.current),b.current&&b.current.abort(),T.length<2){v([]),p(!1);return}return p(!0),E.current=window.setTimeout(async()=>{try{b.current=new AbortController;const C=await i(T);v(C)}finally{p(!1)}},250),()=>{E.current&&clearTimeout(E.current),b.current&&b.current.abort()}},[o,e,i]),c.jsx(Ko,{open:e,onOpenChange:t,children:c.jsxs(mo,{className:"sm:max-w-lg",children:[c.jsx(qo,{children:c.jsx(Yo,{children:"New message"})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ae,{value:o,onChange:T=>u(T.target.value),placeholder:"Search people",autoFocus:!0}),h&&c.jsx("div",{className:"text-sm text-gray-500",children:"Searching…"}),c.jsxs("div",{className:"max-h-80 overflow-y-auto",children:[g.map(T=>c.jsxs("button",{className:"w-full flex items-center gap-3 px-2 py-2 rounded hover:bg-gray-50 text-left",onClick:()=>n(T),children:[c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Ii,{src:T.avatar?Z6e+"/uploads/"+Xn(T.avatar):""}),c.jsx(ea,{children:(T.fullName||T.username).slice(0,1).toUpperCase()})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium",children:T.fullName||T.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",T.username]})]})]},T.id)),!h&&g.length===0&&o.trim().length>=2&&c.jsx("div",{className:"text-sm text-gray-500 px-2 py-4",children:"No people found"})]})]})]})})}const Q6e="https://api.gada.chat",e8e=e=>(e||"?").split(" ").filter(Boolean).map(t=>t[0].toUpperCase()).slice(0,2).join("");function t8e(){const{accessToken:e}=ct(),t=St(e),{openConversation:n,openChatWith:i,ensureWindowForConversation:o,socket:u}=Cm(),[h,p]=w.useState(null),[g,v]=w.useState(!1),[b,E]=w.useState(null),[T,C]=w.useState(null),[R,N]=w.useState(!1),[O,j]=w.useState(""),k=w.useMemo(()=>{const Z=O.trim().toLowerCase();return!Z||!h?h||[]:h.filter(X=>{const ae=(X.peer.fullName||X.peer.username||"").toLowerCase(),se=(X.lastText||"").toLowerCase();return ae.includes(Z)||se.includes(Z)})},[O,h]),[P,M]=w.useState(!1),[D,U]=w.useState(!1),[F,H]=w.useState(!1);w.useEffect(()=>{!(D||F)||h||W(!0)},[D,F]);async function W(Z=!1){if(!g){v(!0),E(null);try{const X=await QE(t),ae=Array.isArray(X==null?void 0:X.items)?X.items:Array.isArray(X)?X:[],se=(X==null?void 0:X.nextCursor)??null;p(J=>Z?ae:[...J||[],...ae]),C(se),N(!!se)}catch(X){console.error(X),E("Failed to load conversations")}finally{v(!1)}}}function q(Z){n(Z.conversationId,Z.peer),U(!1),H(!1)}const Y=w.useRef(!1);w.useEffect(()=>{if(!u)return;const Z=()=>{if(Y.current)return;const X=async ae=>{console.log("recieved here");const se={conversationId:Number(ae.conversationId),fromUserId:Number(ae.fromUserId),kind:ae.kind,room:ae.room,callId:Number(ae.callId),sdp:ae.sdp};try{o?await o(se.conversationId,se.fromUserId):i?await i(se.fromUserId):n(se.conversationId,{id:se.fromUserId,username:"",fullName:""})}catch(J){console.error("[call:offer] failed to open chat window",J)}window.__GADA_OFFERS__=window.__GADA_OFFERS__||{},window.__GADA_OFFERS__[se.conversationId]=se;try{window.dispatchEvent(new CustomEvent("gada:call-offer",{detail:se}))}catch{}};u.on("call:offer",X),Y.current=!0,u.once("disconnect",()=>{try{u.off("call:offer",X)}catch{}Y.current=!1})};return u.connected&&Z(),u.on("connect",Z),()=>{try{u.off("connect",Z)}catch{}Y.current=!1}},[u,o,n,i]);function z(Z){return c.jsxs("div",{className:"w-full",children:[c.jsx("div",{className:"p-3 border-b",children:c.jsxs("div",{className:"relative",children:[c.jsx(Ef,{className:"h-4 w-4 text-gray-400 absolute left-3 top-2.5"}),c.jsx(Ae,{placeholder:"Search messages",value:O,onChange:X=>j(X.target.value),className:"pl-9 bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})}),b&&c.jsx("div",{className:"p-3 text-sm text-red-600",children:b}),!b&&!h&&c.jsxs("div",{className:"p-4 text-sm text-gray-500 flex items-center gap-2",children:[c.jsx(ei,{className:"h-4 w-4 animate-spin"})," Loading…"]}),h&&c.jsxs("div",{className:"max-h-[70vh] overflow-y-auto",children:[k.length===0&&c.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No conversations"}),k.map(X=>{var ae;return c.jsxs("button",{onClick:()=>q(X),className:"w-full flex items-center gap-3 px-3 py-2 hover:bg-gray-50",children:[c.jsxs($i,{className:"h-9 w-9",children:[c.jsx(Ii,{src:(ae=X.peer)!=null&&ae.avatar?Q6e+"/uploads/"+Xn(X.peer.avatar):""}),c.jsx(ea,{children:e8e(X.peer.fullName||X.peer.username)})]}),c.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:X.peer.fullName||X.peer.username}),X.lastTime&&c.jsx("div",{className:"ml-3 text-[11px] text-gray-500 shrink-0",children:new Date(X.lastTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),c.jsx("div",{className:"text-xs text-gray-500 truncate",children:X.lastText||" "})]}),!!X.unread&&c.jsx("span",{className:"ml-2 inline-flex items-center justify-center h-5 min-w-[20px] px-1 rounded-full bg-[#1877F2] text-white text-[11px]",children:X.unread})]},X.conversationId)}),R&&c.jsx("div",{className:"p-2",children:c.jsx(be,{onClick:()=>W(!1),disabled:g,variant:"outline",className:"w-full",children:g?"Loading…":"Load more"})})]}),c.jsxs("div",{className:"p-3 border-t flex items-center justify-between",children:[c.jsx(be,{variant:"outline",size:"sm",onClick:()=>M(!0),children:"New message"}),c.jsx(be,{variant:"ghost",size:"sm",onClick:Z,children:"Close"})]}),c.jsx(mhe,{open:P,onOpenChange:X=>M(X),onPicked:async X=>{await i(X.id,{id:X.id,username:X.username,fullName:X.fullName,avatar:X.avatar}),M(!1),Z==null||Z()}})]})}return c.jsxs(c.Fragment,{children:[c.jsxs(L6e,{open:D,onOpenChange:U,children:[c.jsx(M6e,{asChild:!0,children:c.jsx(be,{variant:"ghost",className:"hidden md:inline-flex p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full","aria-label":"Messages",children:c.jsx(PN,{className:"h-6 w-6"})})}),c.jsx(uhe,{className:"w-[360px] p-0 overflow-hidden",align:"end",sideOffset:8,children:z(()=>U(!1))})]}),c.jsxs(H1,{open:F,onOpenChange:H,children:[c.jsx(cB,{asChild:!0,children:c.jsx(be,{variant:"ghost",className:"md:hidden p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full","aria-label":"Messages",children:c.jsx(PN,{className:"h-6 w-6"})})}),c.jsxs(Xw,{side:"bottom",className:"p-0 h-[85vh] rounded-t-2xl",children:[c.jsx(lB,{className:"px-4 py-3 border-b",children:c.jsx(uB,{className:"text-left",children:"Messages"})}),z(()=>H(!1))]})]})]})}const av="https://api.gada.chat",WC=e=>e.split(" ").map(t=>t[0]).join("").toUpperCase();function or(){const{user:e,accessToken:t,logout:n}=ct(),i=tr(),[o,u]=w.useState(!0),[h,p]=w.useState(""),[g,v]=w.useState({user_wallet_balance:0,user_points:0}),b=St(t),[E,T]=w.useState(!1),[C,R]=w.useState(!1),[N,O]=w.useState(null),[j,k]=w.useState(-1),P=w.useRef(null),M=w.useRef(null),D=w.useRef(null),U=w.useRef(null),F=w.useRef(b);w.useEffect(()=>{F.current=b},[b]);const H=w.useRef("");w.useEffect(()=>{const ae=se=>{P.current&&(P.current.contains(se.target)||M.current&&M.current.contains(se.target)||(T(!1),k(-1)))};return document.addEventListener("mousedown",ae),()=>document.removeEventListener("mousedown",ae)},[]),w.useEffect(()=>{t&&(u(!0),BR(b).then(v).catch(console.error).finally(()=>u(!1)))},[t]),w.useEffect(()=>{const ae=h.trim();if(U.current&&window.clearTimeout(U.current),D.current&&D.current.abort(),ae.length<2){O(null),T(!!ae),R(!1),H.current="";return}if(H.current!==ae)return R(!0),T(!0),U.current=window.setTimeout(async()=>{try{H.current=ae,D.current=new AbortController;const se=await fetch(`${av.replace(/\/+$/,"")}/api/search/suggest?q=${encodeURIComponent(ae)}`,{headers:F.current,signal:D.current.signal});if(!se.ok)throw new Error("search failed");if(H.current!==ae)return;const J=await se.json();O(J),k(-1)}catch(se){(se==null?void 0:se.name)!=="AbortError"&&console.error("[search]",se)}finally{H.current===ae&&R(!1)}},250),()=>{U.current&&window.clearTimeout(U.current),D.current&&D.current.abort()}},[h,t]);const W=ae=>{ae.preventDefault();const se=h.trim();se&&(T(!1),k(-1),i(`/search?q=${encodeURIComponent(se)}`))},q=(()=>{if(!N)return[];const ae=N.top.map(ee=>({group:"Top",kind:ee.kind,data:ee.data})),se=N.users.map(ee=>({group:"People",kind:"user",data:ee})),J=N.posts.map(ee=>({group:"Posts",kind:"post",data:ee})),re=N.tags.map(ee=>({group:"Hashtags",kind:"tag",data:ee}));return[...ae,...se,...J,...re]})(),Y=ae=>{if(E)if(ae.key==="ArrowDown")ae.preventDefault(),k(se=>Math.min(se+1,q.length-1));else if(ae.key==="ArrowUp")ae.preventDefault(),k(se=>Math.max(se-1,-1));else if(ae.key==="Enter")if(j>=0&&q[j]){const se=q[j];z(se.kind,se.data)}else W(ae);else ae.key==="Escape"&&(T(!1),k(-1))};function z(ae,se){T(!1),k(-1),ae==="user"?i(`/profile/${F0(String(se.id))}`):ae==="post"?i(`/posts/${se.id}`):ae==="tag"&&i(`/hashtag/${encodeURIComponent(se.tag)}`)}const Z=()=>{n(),i("/login")},X=ae=>WC(ae);return e?c.jsx("nav",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between h-16",children:[c.jsxs("div",{className:"flex items-center flex-1",children:[c.jsxs(At,{to:"/",className:"flex-shrink-0 flex items-center",children:[c.jsx("h1",{className:"text-[#1877F2] text-2xl font-bold"}),c.jsx("img",{src:av+"/uploads/gadalogo.png",alt:"Gada",className:"h-10 w-auto",onError:ae=>{ae.currentTarget.src="/placeholder.png"}})]}),c.jsxs("div",{className:"hidden sm:block ml-6 w-full max-w-md relative",ref:P,children:[c.jsx("form",{onSubmit:W,className:"flex",children:c.jsxs("div",{className:"relative w-full",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Ef,{className:"h-4 w-4 text-gray-400"})}),c.jsx(Ae,{ref:M,type:"text",placeholder:"Search people, posts, #hashtags",value:h,onChange:ae=>p(ae.target.value),onKeyDown:Y,className:"pl-10 w-full bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})}),E&&c.jsxs("div",{className:"absolute left-0 right-0 mt-2 bg-white border border-gray-200 rounded-xl shadow-xl overflow-hidden",children:[C&&c.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Searching…"}),!C&&(!N||N.users.length+N.posts.length+N.tags.length+N.top.length===0)&&c.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No results"}),!C&&N&&c.jsxs("div",{className:"max-h-[70vh] overflow-y-auto",children:[N.top.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"Top"}),N.top.map((ae,se)=>{const J=se;return c.jsxs("button",{onMouseEnter:()=>k(J),onClick:()=>z(ae.kind,ae.data),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-3 ${j===J?"bg-gray-50":""}`,children:[ae.kind==="user"&&c.jsxs(c.Fragment,{children:[c.jsxs($i,{className:"h-7 w-7",children:[c.jsx(Ii,{src:av+"/uploads/"+Xn(ae.data.avatar||"")}),c.jsx(ea,{children:WC(ae.data.fullName||ae.data.username)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium",children:ae.data.fullName||ae.data.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",ae.data.username]})]})]}),ae.kind==="post"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-7 w-7 rounded bg-blue-100 flex items-center justify-center text-blue-600 text-xs",children:"Post"}),c.jsx("div",{className:"text-sm line-clamp-2",dangerouslySetInnerHTML:{__html:ae.data.snippet}})]}),ae.kind==="tag"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-7 w-7 rounded bg-purple-100 flex items-center justify-center text-purple-600 text-xs",children:"#"}),c.jsxs("div",{className:"text-sm",children:["#",ae.data.tag," ",c.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:[ae.data.count," posts"]})]})]})]},`top-${se}`)})]}),N.users.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"People"}),N.users.map((ae,se)=>{const J=N.top.length+se;return c.jsxs("button",{onMouseEnter:()=>k(J),onClick:()=>z("user",ae),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-3 ${j===J?"bg-gray-50":""}`,children:[c.jsxs($i,{className:"h-7 w-7",children:[c.jsx(Ii,{src:av+"/uploads/"+Xn(ae.avatar||"")}),c.jsx(ea,{children:WC(ae.fullName||ae.username)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium",children:ae.fullName||ae.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",ae.username]})]})]},`u-${ae.id}`)})]}),N.posts.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"Posts"}),N.posts.map((ae,se)=>{var re,ee;const J=N.top.length+N.users.length+se;return c.jsxs("button",{onMouseEnter:()=>k(J),onClick:()=>z("post",ae),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-start gap-3 ${j===J?"bg-gray-50":""}`,children:[c.jsxs($i,{className:"h-7 w-7 mt-0.5",children:[c.jsx(Ii,{src:av+"/uploads/"+Xn(((re=ae.author)==null?void 0:re.avatar)||"")}),c.jsx(ea,{children:WC(((ee=ae.author)==null?void 0:ee.username)||"U")})]}),c.jsx("div",{className:"text-sm line-clamp-2",dangerouslySetInnerHTML:{__html:ae.snippet}})]},`p-${ae.id}`)})]}),N.tags.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"px-4 pt-3 pb-1 text-xs uppercase text-gray-500",children:"Hashtags"}),N.tags.map((ae,se)=>{const J=N.top.length+N.users.length+N.posts.length+se;return c.jsxs("button",{onMouseEnter:()=>k(J),onClick:()=>z("tag",ae),className:`w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-3 ${j===J?"bg-gray-50":""}`,children:[c.jsx("div",{className:"h-7 w-7 rounded bg-purple-100 flex items-center justify-center text-purple-600 text-xs",children:"#"}),c.jsxs("div",{className:"text-sm",children:["#",ae.tag," ",c.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:[ae.count," posts"]})]})]},`t-${ae.id}`)})]})]})]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[c.jsx(At,{to:"/",className:"p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full",children:c.jsx(vU,{className:"h-6 w-6"})}),c.jsx(At,{to:"/friends",className:"p-2 text-gray-600 hover:text-[#1877F2] hover:bg-gray-100 rounded-full",children:c.jsx(ly,{className:"h-6 w-6"})}),c.jsx(t8e,{}),c.jsx(_6e,{}),c.jsxs(eB,{children:[c.jsx(tB,{asChild:!0,children:c.jsx(be,{variant:"ghost",className:"p-1 rounded-full",children:c.jsxs($i,{className:"h-8 w-8",children:[c.jsx(Ii,{src:av+"/uploads/"+Xn(e.profileImage),alt:e.username}),c.jsx(ea,{children:X(e.username)})]})})}),c.jsxs(B1,{align:"end",children:[c.jsx(At,{to:`/profile/${F0(e.id.toString())}`,children:c.jsxs(Pc,{className:"cursor-pointer",children:[c.jsx(JZ,{className:"mr-2 h-4 w-4"})," Profile"]})}),c.jsx(ef,{}),c.jsx(At,{to:"/points",children:c.jsxs(Pc,{className:"cursor-pointer",children:[c.jsx(WZ,{className:"mr-2 h-4 w-4"})," Points"," ",c.jsx("span",{className:"badge bg-light text-primary",children:g.user_points})]})}),(e==null?void 0:e.roles)=="admin"?c.jsx(At,{to:"/admin",children:c.jsxs(Pc,{className:"cursor-pointer",children:[c.jsx(YZ,{className:"mr-2 h-4 w-4"})," Admin panel"," "]})}):"",c.jsx(ef,{}),c.jsx(At,{to:"/wallet",children:c.jsxs(Pc,{className:"cursor-pointer",children:[c.jsx(uy,{className:"mr-2 h-4 w-4"})," Wallet"," ",c.jsxs("span",{className:"badge bg-light text-primary",children:["₦",g.user_wallet_balance]})]})}),c.jsx(ef,{}),c.jsxs(Pc,{onClick:n,className:"cursor-pointer",children:[c.jsx(zZ,{className:"mr-2 h-4 w-4"})," Logout"]})]})]})]}),c.jsx("div",{className:"sm:hidden flex items-center",children:c.jsxs(H1,{children:[c.jsx(cB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"ml-2",children:c.jsx(Qce,{className:"h-6 w-6"})})}),c.jsxs(Xw,{className:"flex flex-col h-screen overflow-y-auto p-6",children:[c.jsx("div",{className:"flex items-center justify-between pb-4 border-b",children:c.jsx("h2",{className:"text-lg font-semibold",children:"Menu"})}),c.jsx("form",{onSubmit:W,className:"my-6",children:c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Ef,{className:"h-4 w-4 text-gray-400"})}),c.jsx(Ae,{ref:M,type:"text",placeholder:"Search people, posts, #hashtags",value:h,onChange:ae=>p(ae.target.value),onKeyDown:Y,className:"pl-10 w-full bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})}),c.jsxs("div",{className:"flex flex-col space-y-2",children:[c.jsxs(At,{to:"/",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(vU,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Home"})]}),c.jsxs(At,{to:`/profile/${e.id}`,className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(JZ,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Profile"})]}),c.jsxs(At,{to:"/friends",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(ly,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"People"})]}),(e==null?void 0:e.roles)=="admin"?c.jsxs(At,{to:"/admin",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(YZ,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Admin panel"})]}):"",c.jsxs(At,{to:"/wallet",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(uy,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsxs("span",{children:["Wallet"," ",c.jsxs("span",{className:"badge bg-light text-primary",children:["₦",g.user_wallet_balance]})]})]}),c.jsxs(At,{to:"/points",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(WZ,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsxs("span",{children:["Points",c.jsx("span",{className:"badge bg-light text-primary",children:g.user_points})]})]}),c.jsxs(At,{to:"/saved",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(A4,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Saved"})]}),c.jsxs(At,{to:"/affiliates",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(Jce,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Affiliates"})]}),c.jsxs(At,{to:"/packages",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(k4,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Packages"})]}),c.jsxs(At,{to:"/memories",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(j4,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Memories"})]}),c.jsxs(At,{to:"/ads",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(j0,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Ads Management"})]}),c.jsxs(At,{to:"/representative",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(Sm,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Representative"})]}),c.jsxs(At,{to:"/messages",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(PN,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Messages"})]}),c.jsxs(At,{to:"/pages",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(cy,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Pages"})]}),c.jsxs(At,{to:"/scheduled",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(I0,{className:"h-5 w-5 mr-3 text-[#1877F2]"}),c.jsx("span",{children:"Scheduled"})]}),c.jsx(At,{to:"/notifications",className:"flex items-center p-2 hover:bg-gray-100 rounded-md",children:c.jsx("span",{children:"Notifications"})}),c.jsx("div",{className:"pt-2 mt-2 border-t",children:c.jsxs(be,{onClick:Z,variant:"ghost",className:"flex items-center w-full justify-start p-2 hover:bg-gray-100 rounded-md",children:[c.jsx(zZ,{className:"h-5 w-5 mr-3 text-red-500"}),c.jsx("span",{children:"Logout"})]})})]})]})]})})]})})}):null}const n8e=[{name:"News Feed",icon:vU,route:"/"},{name:"Mine",icon:VVe},{name:"Saved",icon:A4,route:"/saved"},{name:"Scheduled",icon:I0,route:"/scheduled"},{name:"Memories",icon:j4,route:"/memories"},{name:"Packages",icon:k4,route:"/packages"},{name:"Affiliates",icon:Jce,route:"/affiliates"}],r8e=[{name:"Popular",icon:cy,route:"/mine/popular"},{name:"My Offers",icon:ale,route:"/mine/offers"},{name:"My Blogs",icon:cy,route:"/mine/blogs"}],i8e=[{name:"People",icon:ly,route:"/friends"},{name:"Representative",icon:Sm,route:"/representative"},{name:"Wallet",icon:uy,route:"/wallet"},{name:"Pages",icon:cy,route:"/pages"},{name:"Groups",icon:ly,route:"/groups"},{name:"Events",icon:BVe,route:"/events"},{name:"Reels",icon:jN,route:"/reels"},{name:"Watch",icon:jN,route:"/watch"},{name:"Blogs",icon:cy,route:"/blogs"},{name:"Offers",icon:ale,route:"/offers"}],Ss=()=>{const e=tr(),{user:t,isLoading:n}=ct(),[i,o]=w.useState(window.location.pathname),[u,h]=w.useState(!1),[p,g]=w.useState(!1);w.useEffect(()=>{var R;const T=window.matchMedia("(orientation: landscape)"),C=()=>{const N=window.innerWidth||document.documentElement.clientWidth;g(T.matches&&N>=640)};return C(),(R=T.addEventListener)==null||R.call(T,"change",C),window.addEventListener("resize",C),()=>{var N;(N=T.removeEventListener)==null||N.call(T,"change",C),window.removeEventListener("resize",C)}},[]);const v=T=>{if(T.name==="Mine"){h(C=>!C);return}T.route&&(e(T.route),o(T.route),u&&h(!1))},b=(T,C=!1)=>{const R=T.route===i,N=T.icon;return c.jsxs("button",{onClick:()=>!C&&v(T),disabled:C,className:`
          flex items-center w-full text-left px-3 py-2 rounded-lg transition-colors duration-150
          ${C?"text-gray-400 cursor-not-allowed":R?"bg-purple-100 text-purple-700":"text-gray-600 hover:bg-gray-100"}
        `,children:[c.jsx(N,{className:"w-5 h-5","aria-hidden":"true"}),c.jsx("span",{className:"ml-3 flex-1",children:T.name}),T.name==="Mine"&&(u?c.jsx(P4,{className:"w-4 h-4"}):c.jsx(Vw,{className:"w-4 h-4"}))]},T.name)},E=[...n8e];return n||(t!=null&&t.packageactive?E.push({name:"Ads Manager",icon:j0,route:"/ads"}):E.push({name:"Ads Manager",icon:j0})),c.jsxs("aside",{className:`
        ${p?"flex":"hidden"}
        lg:flex lg:w-64 bg-white p-4 border-r border-gray-200 h-full flex-col rounded-lg shadow
      `,children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-2",children:"Main"}),c.jsx("ul",{className:"space-y-1",children:E.map(T=>c.jsxs("li",{children:[b(T,T.name==="Ads Manager"&&!(t!=null&&t.packageactive)),T.name==="Mine"&&u&&c.jsx("ul",{className:"mt-1 space-y-1 pl-8",children:r8e.map(C=>c.jsx("li",{children:c.jsxs("button",{onClick:()=>v(C),className:`
                          flex items-center w-full text-left px-2 py-1 rounded-lg transition-colors duration-150
                          ${C.route===i?"bg-purple-50 text-purple-700":"text-gray-600 hover:bg-gray-100"}
                        `,children:[c.jsx(C.icon,{className:"w-4 h-4","aria-hidden":"true"}),c.jsx("span",{className:"ml-2 text-sm",children:C.name})]})},C.name))})]},T.name))})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-2",children:"Explore"}),c.jsx("ul",{className:"space-y-1",children:i8e.map(T=>c.jsx("li",{children:b(T)},T.name))})]}),c.jsx("div",{className:"mt-auto pt-4 border-t border-gray-200",children:c.jsxs("button",{onClick:()=>e("/settings"),className:"flex items-center w-full text-left p-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors duration-150",children:[c.jsx(ile,{className:"w-5 h-5","aria-hidden":"true"}),c.jsx("span",{className:"ml-3 text-sm font-medium",children:"Settings"})]})})]})},X1="https://api.gada.chat";async function a8e(e,t=12){const n=await fetch(`${X1}/api/pro/users?limit=${t}`,{headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to load pro users");return n.json()}async function s8e(e){const t=await fetch(`${X1}/api/pro/activepackage`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to load pro users");return t.json()}async function o8e(e,t=12){const n=await fetch(`${X1}/api/pro/trending?limit=${t}`,{headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to load pro users");return n.json()}async function c8e(e,t=12){const n=new URL(`${X1}/api/pro/pages`);n.searchParams.set("limit",String(t));const i=await fetch(n.toString(),{headers:e});if(!i.ok)throw new Error("pro-pages");return((await i.json()).items||[]).map(u=>{let h=u.avatar||"profile/defaultavatar.png";return h.startsWith("/uploads")||(h=`/uploads/${h}`.replace("//uploads","/uploads")),{id:u.id,name:u.name,avatar:h,likes:u.likes}})}const a_="https://api.gada.chat";async function ghe(e,t){const n=await fetch(`${a_}/api/friends/requests`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({toUserId:e})});if(!n.ok)throw new Error("Failed to send request");return n.json()}async function l8e(e){const t=await fetch(`${a_}/api/friends/requests`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to load requests");return t.json()}async function u8e(e,t,n){const i=await fetch(`${a_}/api/friends/requests/${e}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({action:t})});if(!i.ok)throw new Error("Failed to respond");return i.json()}async function LQ(e){const t=await fetch(`${a_}/api/friends/list`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to fetch friends");return t.json()}async function KR(e){const t=await fetch(`${a_}/api/friends/suggestions`,{credentials:"include",headers:{Accept:"application/json",...e}});if(!t.ok)throw new Error("Failed to fetch suggestions");return t.json()}async function d8e(e,t){const n=await fetch(`${a_}/api/users/search?q=${encodeURIComponent(e)}`,{credentials:"include",headers:{Accept:"application/json",...t}});if(!n.ok)throw new Error("User search failed");return n.json()}const Ku="https://api.gada.chat";async function h8e(e,t){const n=new FormData;return n.append("image",e),(await fetch(`${Ku}/api/ads/upload`,{method:"POST",credentials:"include",headers:t,body:n})).json()}async function f8e(e,t){return(await fetch(`${Ku}/api/ads/campaigns`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)})).json()}async function p8e(e=1,t=10,n){return(await fetch(`${Ku}/api/ads/campaigns?page=${e}&limit=${t}`,{credentials:"include",headers:n})).json()}async function GC(e,t,n){return(await fetch(`${Ku}/api/ads/campaigns/${e}/status`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({active:t})})).json()}async function m8e(e,t){const n=new URLSearchParams(e).toString();return(await fetch(`${Ku}/api/ads/serve?${n}`,{headers:t})).json()}async function g8e(e,t){return fetch(`${Ku}/api/ads/${e}/track-view`,{method:"POST",headers:t}).then(n=>n.json())}async function v8e(e,t){return fetch(`${Ku}/api/ads/${e}/track-click`,{method:"POST",headers:t}).then(n=>n.json())}async function y8e(e){return(await fetch("https://api.gada.chat/api/ads/countries",{headers:{...e||{}}})).json()}async function _8e(e,t,n){return(await fetch(`${Ku}/api/ads/campaigns/${e}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",...n||{}},body:JSON.stringify(t)})).json()}async function b8e(e,t){return(await fetch(`${Ku}/api/ads/campaigns/${e}`,{method:"DELETE",credentials:"include",headers:{...t||{}}})).json()}async function E8e(e){return(await fetch(`${Ku}/api/ads/whoami`,{headers:{...e||{}},credentials:"include"})).json()}const w8e="https://api.gada.chat";function S8e(e="0px"){const t=w.useRef(null),[n,i]=w.useState(!1);return w.useEffect(()=>{const o=t.current;if(!o||n)return;const u=new IntersectionObserver(([h])=>{h!=null&&h.isIntersecting&&(i(!0),u.disconnect())},{root:null,rootMargin:e,threshold:.15});return u.observe(o),()=>u.disconnect()},[n,e]),{ref:t,isVisible:n}}function vhe({placement:e,className:t=""}){const{accessToken:n,user:i}=ct(),o=St(n),[u,h]=w.useState(null),[p,g]=w.useState(!0),[v,b]=w.useState(null),[E,T]=w.useState(!1),[C,R]=w.useState({});w.useEffect(()=>{let P=!0;const M=i&&i.country_id?{country_id:i.country_id}:{};if(M.country_id){R(D=>({...D,...M}));return}return(async()=>{try{const D=await E8e(o);if(!P)return;D!=null&&D.ok&&R({country_id:D.country_id||void 0,gender:D.gender||void 0,relationship:D.relationship||void 0})}catch{}})(),()=>{P=!1}},[i,n]),w.useEffect(()=>{let P=!0;return(async()=>{try{g(!0);const M={placement:e};C.country_id&&(M.country_id=C.country_id),C.gender&&(M.gender=C.gender),C.relationship&&(M.relationship=C.relationship);const D=await m8e(M,o);if(!P)return;D!=null&&D.ok&&(D!=null&&D.item)?(h(D.item),b(null)):(h(null),b((D==null?void 0:D.error)||"No ad"))}catch(M){if(!P)return;b((M==null?void 0:M.message)||"Failed to load ad"),h(null)}finally{P&&g(!1)}})(),()=>{P=!1}},[e,C.country_id,C.gender,C.relationship,n]);const{ref:N,isVisible:O}=S8e("120px");w.useEffect(()=>{!u||E||!O||(T(!0),g8e(u.campaign_id,o).catch(()=>{}))},[u,O,E,o]);const j=()=>{u&&(v8e(u.campaign_id,o).catch(()=>{}),u.ads_url&&window.open(u.ads_url,"_blank","noopener,noreferrer"))};if(p)return c.jsx("div",{className:`rounded-2xl border bg-white p-4 flex items-center justify-center ${t}`,children:c.jsx(ei,{className:"h-5 w-5 animate-spin text-purple-600"})});if(!u)return null;const k=e==="sidebar";return c.jsxs("div",{ref:N,className:`rounded-2xl border bg-white overflow-hidden ${t}`,role:"region","aria-label":"Sponsored",children:[c.jsx("div",{className:"px-4 pt-4 flex items-center gap-2 text-sm text-gray-500",children:c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx("span",{className:"text-yellow-500",children:"📣"}),c.jsx("span",{className:"font-semibold",children:"Sponsored"})]})}),u.ads_image&&c.jsx("div",{className:`${k?"aspect-[16/10]":"aspect-[16/9]"} w-full bg-gray-100 cursor-pointer`,onClick:j,children:c.jsx("img",{src:w8e+"/uploads/"+Xn(u.ads_image),alt:u.ads_title||"Sponsored",className:"h-full w-full object-cover",loading:"lazy"})}),c.jsxs("div",{className:"px-4 py-3",children:[u.ads_title&&c.jsx("div",{onClick:j,className:"font-semibold text-gray-900 hover:underline cursor-pointer line-clamp-2",title:u.ads_title||"",children:u.ads_title}),u.ads_description&&c.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:u.ads_description}),u.ads_url&&c.jsxs("button",{onClick:j,className:"mt-3 inline-flex items-center gap-2 rounded-xl bg-purple-600 text-white px-4 py-2 hover:bg-purple-700",children:["Learn more ",c.jsx(Xce,{className:"h-4 w-4"})]})]})]})}const ju="https://api.gada.chat",x8e=[{id:1,name:"Chibuzor Okafor",avatar:`${ju}/uploads/profile/defaultavatar.png`},{id:2,name:"Ajibo Chima",avatar:`${ju}/uploads/profile/defaultavatar.png`},{id:3,name:"Anthonia Adoyi",avatar:`${ju}/uploads/profile/defaultavatar.png`}],T8e=[{id:"p1",name:"STAGES",avatar:`${ju}/uploads//profile/defaultavatar.png`},{id:"p2",name:"Movie World",avatar:`${ju}/uploads//profile/defaultavatar.png`},{id:"p3",name:"EBUKABEST",avatar:`${ju}/uploads//profile/defaultavatar.png`}],C8e=[{tag:"#movieworld",count:15},{tag:"#space",count:5},{tag:"#gada",count:4},{tag:"#science",count:6},{tag:"#Fact",count:4},{tag:"#sports",count:3}];function yB({children:e,className:t}){return c.jsx("section",{className:jt("bg-white rounded-2xl shadow-sm border p-4",t),children:e})}function MQ({items:e,title:t,cta:n,onCta:i,onItemClick:o}){return c.jsxs(yB,{className:"p-5",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(zVe,{className:"h-5 w-5 text-yellow-500"}),c.jsx("h3",{className:"text-base font-semibold",children:t})]}),n&&c.jsx("button",{type:"button",onClick:i,className:"text-sm font-medium text-indigo-600 hover:text-indigo-700",children:n})]}),c.jsx("div",{className:"flex gap-5 overflow-x-auto pb-1 hide-scrollbar",children:e.map(u=>c.jsxs("button",{type:"button",onClick:()=>o==null?void 0:o(u),className:"min-w-[84px] flex flex-col items-center focus:outline-none","aria-label":`Open ${u.name}`,children:[c.jsx("div",{className:"h-20 w-20 rounded-full shadow ring-2 ring-white overflow-hidden",children:c.jsx("img",{src:u.avatar,alt:u.name,className:"h-full w-full object-cover"})}),c.jsx("div",{className:"mt-2 text-center text-sm font-medium text-gray-900 line-clamp-1",children:u.name})]},u.id))})]})}function R8e({tags:e}){return!Array.isArray(e)||e.length===0?c.jsxs("div",{className:"rounded-2xl p-5 bg-gradient-to-tr from-pink-500 to-rose-500 text-white shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(XZ,{className:"h-5 w-5"}),c.jsx("h3",{className:"text-base font-semibold",children:"Trending"})]}),c.jsx("div",{className:"text-white/90 text-sm",children:"No trends right now"})]}):c.jsxs("div",{className:"rounded-2xl p-5 bg-gradient-to-tr from-pink-500 to-rose-500 text-white shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(XZ,{className:"h-5 w-5"}),c.jsx("h3",{className:"text-base font-semibold",children:"Trending"})]}),c.jsx("ul",{className:"space-y-2",children:e.map(t=>{const n=(t.tag||"").replace(/^#/,""),i=`/hashtag/${encodeURIComponent(n)}`;return c.jsx("li",{children:c.jsxs(At,{to:i,title:`Open #${n}`,className:`flex items-center justify-between rounded-md px-2 py-2
                           hover:bg-white/10 focus:bg-white/10 focus:outline-none
                           transition-colors`,children:[c.jsxs("div",{className:"text-lg font-semibold",children:["#",n]}),c.jsxs("div",{className:"text-sm/5 opacity-90",children:[t.count," Posts"]})]})},t.tag)})})]})}function N8e({list:e,onAdd:t,onSeeAll:n}){return c.jsxs(yB,{className:"p-5",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Suggested Friends"}),c.jsxs("button",{type:"button",onClick:n,className:"text-sm font-medium text-gray-600 hover:text-gray-900 inline-flex items-center gap-1",children:["See All ",c.jsx(LVe,{className:"h-4 w-4"})]})]}),c.jsx("ul",{className:"divide-y",children:e.map(i=>{const o=i.id??i.user_id,u=i.user_name??i.username??"User";let h;if(i.profileImage){let p=i.profileImage;h=ju+"/uploads/"+p}else h=`${ju}/uploads//profile/defaultavatar.png`;return c.jsxs("li",{className:"py-3 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("img",{src:h,alt:u,className:"h-12 w-12 rounded-full object-cover bg-gray-100"}),c.jsx("div",{className:"min-w-0",children:c.jsx(At,{to:`/profile/${F0(o)}`,children:c.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:u})})})]}),c.jsx(be,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>t==null?void 0:t(o),"aria-label":`Add ${u}`,children:c.jsx(Sm,{className:"h-4 w-4"})})]},o)})})]})}function J1({onAddFriend:e,onUpgradeClick:t,onSeeAllSuggestions:n}){const{accessToken:i}=ct(),o=St(i),u=tr(),h=w.useRef(o);w.useEffect(()=>{h.current=o},[o]);const[p,g]=w.useState(x8e),[v,b]=w.useState([]),[E,T]=w.useState(C8e),[C,R]=w.useState(!1),N=C?{}:{cta:"Upgrade",onCta:()=>u("/packages")},[O,j]=w.useState(T8e),k=async M=>{const D=String(M);try{await ghe(M,h.current),b(U=>U.filter(F=>String(F.id??F.user_id)!==D)),Ce.success("Your request has been sent successfully.")}catch(U){console.error("Failed to send friend request",U),Ce.error("Failed to send friend request",U)}},P=w.useRef(!1);return w.useEffect(()=>{if(!i||P.current)return;P.current=!0;let M=!0;return(async()=>{try{const D=await a8e(o,12);if(!M)return;g(D.map(U=>{const F=`${ju}`.replace(/\/+$/,"");let H=U.avatar||"/uploads//profile/defaultavatar.png";return H.startsWith("/uploads")||(H=`/uploads/${H}`.replace("//uploads","/uploads")),{id:U.id,name:U.name,avatar:`${F}${H}`}}))}catch(D){console.error("[RightSidebar] failed to load pro users",D)}})(),(async()=>{var D;try{const U=await s8e(o);if(console.log(U,"listlist"),!M)return;R((D=U==null?void 0:U.data)==null?void 0:D.active)}catch(U){console.error("[RightSidebar] failed to load pro users",U)}})(),(async()=>{try{const D=await c8e(o,12);if(!M)return;const U=`${ju}`.replace(/\/+$/,"");j(D.map(F=>({id:F.id,name:F.name,avatar:`${U}${F.avatar}`})))}catch(D){console.error("[RightSidebar] failed to load pro pages",D)}})(),(async()=>{try{const D=await o8e(o,12,"24 HOUR");if(!M)return;T(D.data.map(U=>({tag:U.hashtag.startsWith("#")?U.hashtag:`#${U.hashtag}`,count:Number(U.post_count)||0})))}catch(D){console.error("[RightSidebar] failed to load trending hashtags",D)}})(),(async()=>{try{const D=await KR(o);if(!M)return;b(D||[])}catch(D){console.error("[RightSidebar] failed to load friend suggestions",D),b([])}})(),()=>{M=!1}},[i]),c.jsxs("div",{className:"sticky top-20 space-y-6",children:[c.jsx(MQ,{items:p,title:"Pro Users",...N,onItemClick:M=>u(`/profile/${F0(M.id)}`)}),c.jsx(MQ,{items:O,title:"Pro Pages",...N,onItemClick:M=>u(`/pages/${M.id}`)}),c.jsx(R8e,{tags:E}),c.jsx(vhe,{placement:"sidebar"}),c.jsxs(yB,{className:"p-5",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Gadashares"}),c.jsx("div",{className:"mt-2 h-14 rounded-xl bg-gray-50"})]}),c.jsx(N8e,{list:v,onAdd:k,onSeeAll:()=>u("/friends")})]})}const UQ="https://api.gada.chat",HC=6e3;function A8e({group:e,initialIndex:t=0,onClose:n,onDeleted:i}){var ut,wt,Rt;const{user:o,accessToken:u}=ct(),h=St(u),{openChatWith:p}=Cm(),[g,v]=w.useState(""),[b,E]=w.useState(null),[T,C]=w.useState(!1),[R,N]=w.useState(!1),O=(o==null?void 0:o.id)??(o==null?void 0:o._id),j=Number(e.userId)===Number(O),[k,P]=w.useState(t),M=e.stories[k],D=e.stories.length,U=w.useMemo(()=>{var ge;const Le=((ge=M==null?void 0:M.meta)==null?void 0:ge.caption)??(M==null?void 0:M.meta);if(!Le)return{};if(typeof Le=="string")try{return JSON.parse(Le)}catch{return{}}return Le},[M]),F=M.type==="text"||!M.url&&(U==null?void 0:U.text),H=w.useMemo(()=>F||!(M!=null&&M.url)?"":/^https?:\/\//i.test(M.url)?M.url:M.url.startsWith("/uploads/")?UQ+M.url:UQ+"/uploads/"+Xn(M.url),[M,F]),[W,q]=w.useState(!1),[Y,z]=w.useState(0),Z=w.useRef(null),X=w.useRef(null),ae=w.useRef(0),[se,J]=w.useState(!0),[re,ee]=w.useState([]),[de,xe]=w.useState(0),ve=w.useRef(!1),Te=w.useRef(null),Pe=w.useRef(HC),qe=!j&&(R||T),st=(U==null?void 0:U.bg)||"#111111",ze=(U==null?void 0:U.color)||"#ffffff",ft=((U==null?void 0:U.text)??(U==null?void 0:U.caption)??"").toString();w.useEffect(()=>{if(q(!1),z(0),X.current=null,ae.current=0,F){Pe.current=HC,q(!0);return}if(M.type==="image"){Pe.current=HC;const Le=new Image;Le.src=H,Le.onload=()=>q(!0),Le.onerror=()=>q(!0)}else q(!0)},[k,H,F,M.type]),w.useEffect(()=>{if(!W)return;const Le=ge=>{if(qe){Z.current=requestAnimationFrame(Le);return}const Ne=Pe.current||HC;if(X.current==null){const ot=ae.current/100*Ne;X.current=ge-ot}const We=Math.min(100,(ge-X.current)/Ne*100);if(ae.current=We,z(We),We>=100)return $e();Z.current=requestAnimationFrame(Le)};return cancelAnimationFrame(Z.current||0),Z.current=requestAnimationFrame(Le),()=>cancelAnimationFrame(Z.current||0)},[W,k,qe]),w.useEffect(()=>{const Le=Te.current;if(Le)if(qe)try{Le.pause()}catch{}else try{Le.play()}catch{}},[qe]);function $e(){cancelAnimationFrame(Z.current||0),ae.current=0,k<D-1?P(Le=>Le+1):n("finished")}function at(){cancelAnimationFrame(Z.current||0),ae.current=0,k>0?P(Le=>Le-1):n("prevGroup")}w.useEffect(()=>{ve.current=!1,J(!0),ee([]),xe(0),(async()=>{var Le;try{ve.current||(await CVe(M.id,h),ve.current=!0);const ge=await RVe(M.id,0,36,h);ee(ge.items||[]),xe(ge.count||(((Le=ge.items)==null?void 0:Le.length)??0))}finally{J(!1)}})()},[k,M.id]);async function ke(Le){C(!0);try{await V6e({storyId:Number(M.id),toUserId:Number(e.userId),text:g.trim()||null,emojiCode:Le,previewUrl:F?null:H},h),p==null||p(Number(e.userId)),v(""),E(null)}catch(ge){console.error(ge),Ce.error("Failed to send reply.")}finally{C(!1)}}function je(Le){ke(Le)}async function Pt(){!g.trim()&&!b||await ke(b)}async function Dt(){if(confirm("Delete this story?"))try{const Le=await NVe(M.id,h);Le!=null&&Le.ok&&(i==null||i(M.id),n("deleted"),Ce.success("Story has been deleted successfully"))}catch{Ce.error("Failed to delete story")}}const cn=e.stories.map((Le,ge)=>ge<k?100:ge===k?Y:0);return c.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:c.jsxs("div",{className:"relative w-full max-w-3xl",children:[c.jsx("div",{className:"absolute top-3 left-3 right-3 flex gap-1 z-30",children:cn.map((Le,ge)=>c.jsx("div",{className:"h-1.5 w-full bg-white/30 rounded overflow-hidden",children:c.jsx("div",{className:"h-full bg-white",style:{width:`${Le}%`}})},ge))}),c.jsxs("div",{className:"relative rounded overflow-hidden bg-black",children:[F?c.jsx("div",{className:"w-full flex items-center justify-center",style:{background:st,aspectRatio:"9 / 16",maxHeight:"70vh",margin:"0 auto"},children:c.jsx("div",{className:"px-6 text-center font-semibold",style:{color:ze,whiteSpace:"pre-wrap",wordBreak:"break-word",lineHeight:1.25,fontSize:"clamp(18px, 3.5vw, 42px)"},children:ft||""})}):M.type==="image"?c.jsx("img",{src:H,alt:"",className:"w-full max-h-[70vh] object-contain"}):c.jsx("video",{ref:Le=>{if(Te.current=Le,Le)if(Le.onloadedmetadata=()=>{q(!0),Pe.current=Math.max(1e3,(Le.duration||0)*1e3),X.current=null,ae.current=0},Le.onended=()=>{qe||$e()},qe)try{Le.pause()}catch{}else try{Le.play()}catch{}},src:H,className:"w-full max-h-[70vh] object-contain",autoPlay:!0,playsInline:!0,controls:!1}),!!((wt=(ut=M.meta)==null?void 0:ut.overlays)!=null&&wt.length)&&W&&c.jsx("div",{className:"pointer-events-none absolute inset-0 z-20",children:M.meta.overlays.map(Le=>c.jsx("div",{className:"absolute select-none",style:{left:`${Le.xPct}%`,top:`${Le.yPct}%`,transform:`translate(-50%, -50%) rotate(${Le.rotateDeg??0}deg)`,fontSize:(Le.fontSize??22)+"px",color:Le.color??"#fff",fontWeight:Le.weight??600,textShadow:"0 2px 6px rgba(0,0,0,0.5)",whiteSpace:"pre-wrap",textAlign:"center"},children:Le.text},Le.id))}),((Rt=M.meta)==null?void 0:Rt.caption)&&W&&!F&&c.jsx("div",{className:"absolute bottom-3 left-3 right-3 z-20",children:c.jsx("div",{className:"bg-black/50 text-white rounded px-3 py-2 text-sm",children:M.meta.caption})}),c.jsx("button",{className:"absolute top-2 right-2 bg-black/60 hover:bg-black/80 text-white rounded-full p-2 z-[120] pointer-events-auto",onClick:()=>n("user"),"aria-label":"Close story",children:c.jsx(po,{className:"h-5 w-5"})}),c.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-2 pr-10 z-30",children:c.jsx("button",{className:"bg-black/40 hover:bg-black/60 text-white rounded-full p-2",onClick:at,children:c.jsx(O4,{className:"h-6 w-6"})})}),c.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pl-10 z-30",children:c.jsx("button",{className:"bg-black/40 hover:bg-black/60 text-white rounded-full p-2",onClick:$e,children:c.jsx(Bw,{className:"h-6 w-6"})})})]}),c.jsx("div",{className:"mt-3",children:j?c.jsxs("div",{className:"rounded-xl bg-white p-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(k0,{className:"h-4 w-4 text-gray-500"}),c.jsx("div",{className:"font-semibold",children:"Viewers"}),c.jsx("div",{className:"ml-auto text-xs text-gray-500",children:de})]}),c.jsx("div",{className:"mt-2 min-h-[40px]",children:se?c.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[c.jsx(ei,{className:"h-3 w-3 animate-spin"})," Loading…"]}):de===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No viewers yet"}):c.jsxs("div",{className:"flex flex-wrap gap-2",children:[re.map(Le=>c.jsx("span",{className:"px-2 py-1 rounded-full bg-gray-100 text-xs",children:Le.user_name??Le.username??"User"},Le.user_id??Le.id)),de>re.length&&c.jsxs("span",{className:"px-2 py-1 rounded-full bg-gray-50 text-xs text-gray-600",children:["+",de-re.length," more"]})]})}),c.jsx("div",{className:"mt-3 text-right",children:c.jsxs("button",{className:"inline-flex items-center gap-2 rounded border px-3 py-2 text-red-600 hover:bg-red-50",onClick:Dt,children:[c.jsx(Ww,{className:"h-4 w-4"})," Delete story"]})})]}):c.jsxs("div",{className:"bg-white rounded-xl p-3 shadow",children:[c.jsxs("div",{className:"flex items-center gap-2 border rounded-full px-3 py-2",children:[c.jsx("input",{type:"text",placeholder:"Reply…",className:"flex-1 outline-none text-sm",value:g,onFocus:()=>N(!0),onBlur:()=>N(!1),onChange:Le=>v(Le.target.value)}),c.jsx("button",{className:"ml-1 rounded-full bg-[#1877F2] text-white px-3 py-1.5 text-sm hover:bg-[#1865d6] disabled:opacity-50",onClick:Pt,disabled:T||!g.trim()&&!b,children:T?"Sending…":"Send"})]}),c.jsx("div",{className:"mt-2 flex justify-around text-2xl",children:[{code:1,char:"👍"},{code:2,char:"❤️"},{code:3,char:"😆"},{code:4,char:"😲"},{code:5,char:"😢"},{code:6,char:"😡"}].map(Le=>c.jsx("button",{className:`transition hover:scale-110 ${b===Le.code?"ring-2 ring-blue-500 rounded-full":""}`,onClick:()=>je(Le.code),title:"Quick reaction",children:Le.char},Le.code))}),c.jsx("div",{className:"mt-1 text-[11px] text-gray-500 text-center",children:"Typing pauses the story. Close when you’re done."})]})})]})})}const I8e=["😀","😃","😄","😁","😆","🥹","😊","🙂","😉","😍","😘","😜","🤩","🥳","🤗","😎","😇","🤔","🤨","😐","😴","🥱","😪","😮","😯","😲","😳","🥵","🥶","😱","😭","😅","😬","🤤","😷","🤒","🤕","🤧","🤮","🤢","😈","👿","💀","👻","👽","🤖","💩","👍","👎","👏","🙌","🙏","🤝","💪","🫶","🤟","✌️","👌","👉","👈","👇","👆","☝️","❤️","🧡","💛","💚","💙","💜","🖤","🤍","💖","💘","💝","💫","✨","⭐️","🔥","🎉","🌟","⚡️","❄️","🌈","🍕","🍔","🍟","🍩","🍰","🍓","🍎","🍇","🍪","☕️","🍺","🎧"],O8e=({file:e,onCancel:t,onPublish:n})=>{const i=w.useMemo(()=>e?URL.createObjectURL(e):"",[e]);e&&e.type.startsWith("video/");const o=!e;w.useEffect(()=>()=>{i&&URL.revokeObjectURL(i)},[i]);const u=w.useRef(null),[h,p]=w.useState([]),[g,v]=w.useState(null),[b,E]=w.useState(""),[T,C]=w.useState(""),[R,N]=w.useState(.8),[O,j]=w.useState(""),[k,P]=w.useState("#111111"),[M,D]=w.useState("#ffffff"),U=(X,ae="🙂")=>{const se=Math.random().toString(36).slice(2);p(J=>[...J,{id:se,type:X,text:ae,xPct:50,yPct:50,fontSize:48,color:"#ffffff",weight:700,rotateDeg:0}]),v(se)},F=w.useRef(null),H=(X,ae)=>{var re;if(!((re=u.current)==null?void 0:re.getBoundingClientRect()))return;const J=h.find(ee=>ee.id===ae);F.current={id:ae,x0:X.clientX,y0:X.clientY,xp:J.xPct,yp:J.yPct},X.target.setPointerCapture(X.pointerId),v(ae)},W=X=>{if(!F.current||!u.current)return;const ae=u.current.getBoundingClientRect(),se=(X.clientX-F.current.x0)/ae.width*100,J=(X.clientY-F.current.y0)/ae.height*100;p(re=>re.map(ee=>ee.id===F.current.id?{...ee,xPct:FQ(F.current.xp+se,0,100),yPct:FQ(F.current.yp+J,0,100)}:ee))},q=X=>{try{X.target.releasePointerCapture(X.pointerId)}catch{}F.current=null},Y=h.find(X=>X.id===g)||null,z=X=>Y&&p(ae=>ae.map(se=>se.id===Y.id?{...se,...X}:se)),Z=()=>{const X={caption:b.trim()||void 0,overlays:h,musicUrl:T.trim()||void 0,musicVolume:R,...o?{text:O.trim(),bg:k,color:M}:{}};n(X,e||null)};return c.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white w-full max-w-6xl h-[90vh] rounded-xl shadow-2xl flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 py-3 border-b bg-white",children:[c.jsx("h3",{className:"font-semibold",children:"Create story"}),c.jsx("button",{onClick:t,className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:c.jsx(po,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"flex-1 overflow-hidden bg-white",children:c.jsxs("div",{className:"h-full flex overflow-hidden",children:[c.jsx("div",{className:"flex-1 flex items-center justify-center bg-black",children:c.jsxs("div",{ref:u,className:"relative w-full max-w-[400px] max-h-[72vh] aspect-[9/16] rounded-lg overflow-hidden",onPointerMove:W,onPointerUp:q,style:o?{background:k}:{},children:[o?c.jsx("div",{className:"w-full h-full flex items-center justify-center",children:c.jsx("div",{className:"px-6 text-2xl font-semibold text-center whitespace-pre-wrap",style:{color:M},children:O||"Type your write-up…"})}):e?e.type.startsWith("video/")?c.jsx("video",{src:i,className:"w-full h-full object-contain",autoPlay:!0,muted:!0,loop:!0}):c.jsx("img",{src:i,className:"w-full h-full object-contain",alt:""}):null,h.map(X=>c.jsx("div",{className:`absolute cursor-move select-none ${g===X.id?"ring-2 ring-[#1877F2] rounded":""}`,style:{left:`${X.xPct}%`,top:`${X.yPct}%`,transform:`translate(-50%, -50%) rotate(${X.rotateDeg??0}deg)`,fontSize:(X.fontSize??22)+"px",color:X.color??"#fff",fontWeight:X.weight??700,textShadow:"0 2px 6px rgba(0,0,0,0.6)",whiteSpace:"pre-wrap",textAlign:"center"},onPointerDown:ae=>H(ae,X.id),onClick:()=>v(X.id),children:X.text},X.id)),b&&!o&&c.jsx("div",{className:"absolute bottom-3 left-3 right-3",children:c.jsx("div",{className:"bg-black/50 text-white rounded px-3 py-2 text-sm",children:b})})]})}),c.jsxs("div",{className:"w-96 border-l p-4 space-y-4 overflow-y-auto",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"block text-xs text-gray-600 flex items-center gap-2",children:[c.jsx(l4e,{className:"h-4 w-4"})," Emoji Palette"]}),c.jsx("div",{className:"flex flex-wrap gap-1 max-h-40 overflow-y-auto border rounded p-2",children:I8e.map(X=>c.jsx("button",{type:"button",className:"px-1 py-0.5 text-xl hover:bg-gray-200 rounded",onClick:()=>U("emoji",X),children:X},X))})]}),o&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-full"}),c.jsxs("div",{className:"space-y-2 w-full",children:[c.jsx("label",{className:"block text-xs text-gray-600",children:"Write-up"}),c.jsx("textarea",{className:"w-full border rounded px-2 py-1",rows:5,value:O,onChange:X=>j(X.target.value),placeholder:"Type your story…"})]}),c.jsxs("div",{className:"flex items-center gap-3 w-full",children:[c.jsxs("label",{className:"text-xs text-gray-600 flex items-center gap-1",children:[c.jsx(a4e,{className:"h-4 w-4"})," Background"]}),c.jsx("input",{type:"color",value:k,onChange:X=>P(X.target.value)}),c.jsx("label",{className:"text-xs text-gray-600 ml-4",children:"Text"}),c.jsx("input",{type:"color",value:M,onChange:X=>D(X.target.value)})]})]})]}),Y&&c.jsxs("div",{className:"border rounded-lg p-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"font-medium text-sm",children:["Selected ",Y.type==="emoji"?"Emoji":"Text"]}),c.jsx("button",{className:"p-2 rounded hover:bg-gray-100",onClick:()=>p(X=>X.filter(ae=>ae.id!==Y.id)),children:c.jsx(Ww,{className:"h-4 w-4"})})]}),c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Content"}),c.jsx("input",{className:"w-full border rounded px-2 py-1",value:Y.text,onChange:X=>z({text:X.target.value})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Font size"}),c.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:Y.fontSize??22,onChange:X=>z({fontSize:Number(X.target.value||22)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Weight"}),c.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Y.weight??700,onChange:X=>z({weight:Number(X.target.value)}),children:[c.jsx("option",{value:400,children:"400"}),c.jsx("option",{value:600,children:"600"}),c.jsx("option",{value:700,children:"700"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Color"}),c.jsx("input",{type:"color",className:"w-full border rounded px-2 py-1 h-9",value:Y.color??"#ffffff",onChange:X=>z({color:X.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Rotate"}),c.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:Y.rotateDeg??0,onChange:X=>z({rotateDeg:Number(X.target.value||0)})})]})]})]}),!o&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs text-gray-600",children:"Caption"}),c.jsx("textarea",{className:"w-full border rounded px-2 py-1",rows:3,value:b,onChange:X=>E(X.target.value),placeholder:"Say something..."})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"block text-xs text-gray-600 flex items-center gap-2",children:[c.jsx(r4e,{className:"h-4 w-4"})," Music (optional)"]}),c.jsx("input",{className:"w-full border rounded px-2 py-1",value:T,onChange:X=>C(X.target.value),placeholder:"https://your-cdn/track.mp3"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"text-xs text-gray-600",children:["Volume: ",R*100|0,"%"]}),c.jsx("input",{type:"range",min:0,max:1,step:.01,value:R,onChange:X=>N(Number(X.target.value)),className:"w-full"})]})]})]})]})}),c.jsxs("div",{className:"shrink-0 sticky bottom-0 bg-white border-t px-4 py-3 flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancel"}),c.jsxs("button",{onClick:Z,className:"inline-flex items-center gap-2 px-4 py-2 rounded bg-[#1877F2] text-white hover:bg-[#1865d6]",children:[c.jsx(Fw,{className:"h-4 w-4"})," Publish"]})]})]})})};function FQ(e,t,n){return Math.min(n,Math.max(t,e))}const fE="https://api.gada.chat";function P8e(){var q;const{user:e}=ct(),{stories:t,addStory:n,addTextStory:i,setStories:o}=OVe(),u=w.useMemo(()=>{if(!e)return t||[];const Y=(t||[]).findIndex(X=>Number(X.userId)===Number(e==null?void 0:e.userId));if(Y<=0)return t||[];const z=[...t],[Z]=z.splice(Y,1);return z.unshift(Z),z},[t,e]),h=w.useRef(null),[p,g]=w.useState(null),[v,b]=w.useState(!1),[E,T]=w.useState(null),[C,R]=w.useState(0),N=E!==null&&u[E]?u[E]:null,O=()=>{var Y;return(Y=h.current)==null?void 0:Y.click()},j=()=>{g(null),b(!0)},k=Y=>{var Z;const z=((Z=Y.target.files)==null?void 0:Z[0])??null;Y.target.value="",z&&(g(z),b(!0))},P=()=>{b(!1),g(null)},M=async(Y,z)=>{try{z?await n(z,Y):await i(Y)}finally{b(!1),g(null)}},D=Y=>{T(Y),R(0)},U=Y=>{o(z=>z.map(X=>({...X,stories:X.stories.filter(ae=>Number(ae.id)!==Number(Y))})).filter(X=>X.stories.length>0)),T(null)},F=Y=>{if(Y==="deleted"){T(null);return}if(Y==="finished"){T(z=>{if(z==null)return z;const Z=z+1;return Z>=u.length?null:(R(0),Z)});return}if(Y==="prevGroup"){T(z=>{var ae,se;if(z==null)return z;const Z=z-1;if(Z<0)return null;const X=(se=(ae=u[Z])==null?void 0:ae.stories)!=null&&se.length?u[Z].stories.length-1:0;return R(X),Z});return}T(null)};w.useEffect(()=>{E!==null&&E>=u.length&&T(null)},[u.length,E]);const H=Y=>{var Z;const z=(Z=Y.stories)==null?void 0:Z[Y.stories.length-1];return z?z.type==="text"?null:fE+"/uploads/"+Xn(z.url):fE+"/uploads//profile/defaultavatar.png"},W=Y=>{if(!Y)return{};if(typeof Y=="string")try{return JSON.parse(Y)}catch{try{return JSON.parse((Y==null?void 0:Y.caption)??"{}")||{}}catch{return{}}}if(Y.caption&&typeof Y.caption=="string")try{return JSON.parse(Y.caption)}catch{return Y}return Y};return c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex space-x-3 overflow-x-auto pb-2",children:[e&&c.jsxs("div",{className:"flex-shrink-0 text-center",children:[c.jsxs("div",{className:"relative w-16 h-16 rounded-full ring-2 ring-[#1877F2] overflow-hidden mx-auto",children:[e.profileImage?c.jsx("img",{src:fE+"/uploads/"+Xn(e.profileImage),alt:"Your story",className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:c.jsx(O0,{className:"h-6 w-6 text-gray-500"})}),c.jsxs("div",{className:"absolute inset-0 bg-black/30 opacity-0 hover:opacity-100 transition flex items-center justify-center gap-2",children:[c.jsx("button",{title:"Add media",onClick:O,className:"p-1.5 rounded-full bg-white/90 hover:bg-white",children:c.jsx(O0,{className:"h-4 w-4"})}),c.jsx("button",{title:"Write-up only",onClick:j,className:"p-1.5 rounded-full bg-white/90 hover:bg-white",children:c.jsx(u4e,{className:"h-4 w-4"})})]})]}),c.jsx("span",{className:"mt-1 block text-xs text-gray-700 truncate w-16",children:"Your story"}),c.jsx("input",{type:"file",accept:"image/*,video/*",className:"hidden",ref:h,onChange:k})]}),u.map((Y,z)=>{const Z=H(Y),X=Y.stories[Y.stories.length-1],ae=(X==null?void 0:X.type)==="text"?W(X.meta):null,se=(ae==null?void 0:ae.bg)||"#111",J=(ae==null?void 0:ae.color)||"#fff",re=((ae==null?void 0:ae.text)||(ae==null?void 0:ae.caption)||"Story").toString();return c.jsxs("div",{className:"flex-shrink-0 text-center cursor-pointer",onClick:()=>D(z),children:[c.jsx("div",{className:"w-16 h-16 rounded-full ring-2 ring-[#1877F2] overflow-hidden mx-auto",children:(X==null?void 0:X.type)==="text"?c.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] font-semibold px-1 text-center",style:{background:se,color:J},children:re.slice(0,16)}):c.jsx("img",{src:Z||fE+"/uploads//profile/defaultavatar.png",alt:Y.username,className:"w-full h-full object-cover",onError:ee=>{ee.currentTarget.src=fE+"/uploads//profile/defaultavatar.png"}})}),c.jsx("span",{className:"mt-1 block text-xs text-gray-700 truncate w-16",children:Number(Y.userId)===Number(e==null?void 0:e.userId)?"Your story":Y.username})]},Y.userId??z)})]}),E!==null&&N&&c.jsx(A8e,{group:N,initialIndex:C,onClose:F,onDeleted:U},`${((q=u[E])==null?void 0:q.userId)??E}-${C}`),v&&c.jsx(O8e,{file:p,onCancel:P,onPublish:M})]})}const k8e="https://api.gada.chat",j8e=k8e.replace(/\/+$/,"");function D8e(e){return Array.isArray(e)?{promotedPost:null,list:e}:e&&typeof e=="object"?{promotedPost:e.promoted??null,list:Array.isArray(e.items)?e.items:[]}:{promotedPost:null,list:[]}}function zC(e){const t=(e==null?void 0:e.post_id)??(e==null?void 0:e.id),n=Number(t);return Number.isFinite(n)&&n>0?n:null}function L8e(){const{user:e,accessToken:t,isLoading:n}=ct(),i=St(t),{posts:o,loading:u,busy:h,loadMore:p}=R1(),g=w.useRef(null),v=tr();w.useEffect(()=>aVe(),[]),w.useEffect(()=>{!n&&!t&&v("/login")},[n,t,v]);const{promotedPost:b,list:E}=w.useMemo(()=>D8e(o),[o]),T=w.useMemo(()=>{const k=[],P=b?zC(b):null;P&&k.push(P);for(const M of E){const D=zC(M);D&&k.push(D)}return Array.from(new Set(k))},[b,E]),[C,R]=w.useState({}),N=w.useRef("");w.useEffect(()=>{if(console.log(g.current,"infiniteRef.current"),!g.current)return;const k=new IntersectionObserver(P=>{P[0].isIntersecting&&!h&&p()},{threshold:1});return k.observe(g.current),()=>k.disconnect()},[h,p]),w.useEffect(()=>{const k=T.join(",");if(!k||k===N.current)return;N.current=k;let P=!1,M;const D=async()=>{try{const U=`${j8e}/api/live/for-posts?ids=${encodeURIComponent(k)}`,F=await fetch(U,{headers:i});if(!F.ok)return;const H=await F.json();!P&&H&&typeof H=="object"&&R(H.data)}catch{}};return D(),M=window.setInterval(D,12e3),()=>{P=!0,M&&window.clearInterval(M)}},[i,T]);const O=w.useMemo(()=>{if(!b)return null;const k=zC(b);return k?{...b,live:C[k]||null}:b},[b,C]),j=w.useMemo(()=>(console.log("postsLoadingpostsLoadingpostsLoading"),E!=null&&E.length?E.map(k=>{const P=zC(k);return P?{...k,live:C[P]||null}:k}):[]),[E,C]);return n||u?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(ei,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 show-sidebar-landscape min-h-0 overflow-y-auto py-6",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsxs("div",{className:"space-y-6 py-6",children:[c.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:c.jsx(WBe,{})}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Stories"}),c.jsx(P8e,{})]}),c.jsx("div",{className:"mx-auto max-w-[680px] w-full",children:c.jsx(vhe,{placement:"newsfeed"})}),c.jsxs("div",{className:"mx-auto max-w-[680px] w-full flex flex-col gap-4",children:[O&&c.jsx("div",{className:"rounded-2xl overflow-hidden border border-slate-200 bg-white",children:c.jsx(Vu,{post:O,live:O.live})}),j.map(k=>c.jsx("div",{className:"rounded-2xl overflow-hidden border border-slate-200 bg-white",children:c.jsx(Vu,{post:k,live:k.live})},String(k.post_id??k.id))),c.jsx("div",{ref:g,className:"h-10"}),c.jsx("div",{className:"flex items-center justify-center py-6",children:c.jsx(be,{variant:"outline",disabled:h,onClick:()=>p==null?void 0:p(),className:"min-w-[180px]",children:h?c.jsxs(c.Fragment,{children:[c.jsx(ei,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading…"]}):"Load more"})})]})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-96 min-h-0 overflow-y-auto pt-6",children:c.jsx(J1,{})})]})})]})}const M8e=Gw("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),wf=w.forwardRef(({className:e,variant:t,...n},i)=>c.jsx("div",{ref:i,role:"alert",className:jt(M8e({variant:t}),e),...n}));wf.displayName="Alert";const U8e=w.forwardRef(({className:e,...t},n)=>c.jsx("h5",{ref:n,className:jt("mb-1 font-medium leading-none tracking-tight",e),...t}));U8e.displayName="AlertTitle";const py=w.forwardRef(({className:e,...t},n)=>c.jsx("div",{ref:n,className:jt("text-sm [&_p]:leading-relaxed",e),...t}));py.displayName="AlertDescription";function yhe(){const[e,t]=w.useState(""),[n,i]=w.useState(""),[o,u]=w.useState(!1),[h,p]=w.useState(""),[g,v]=w.useState(!1),b=tr(),{login:E}=ct(),T=async C=>{if(C.preventDefault(),!e||!n){p("Please fill in all fields");return}v(!0),p("");try{await E(e,n)?b("/"):p("Invalid email or password")}catch(R){p(""+R)}finally{v(!1)}};return c.jsxs(Vr,{className:"w-full max-w-md mx-auto",children:[c.jsxs(pa,{children:[c.jsx(Wa,{className:"text-2xl text-[#1877F2] font-bold",children:"Login to Gada"}),c.jsx(Qy,{children:"Enter your credentials to access your account"})]}),c.jsxs(mi,{children:[h&&c.jsxs(wf,{variant:"destructive",className:"mb-4",children:[c.jsx(N1,{className:"h-4 w-4"}),c.jsx(py,{children:h})]}),c.jsxs("form",{onSubmit:T,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"email",children:"Email/Username"}),c.jsx(Ae,{id:"email",type:"text",placeholder:"your.email@example.com",value:e,onChange:C=>t(C.target.value),required:!0,className:"border-gray-300",autoComplete:"username"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Qe,{htmlFor:"password",children:"Password"}),c.jsx(At,{to:"/forgot-password",className:"text-sm text-[#1877F2] hover:underline",children:"Forgot password?"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(Ae,{id:"password",type:o?"text":"password",placeholder:"••••••••",value:n,onChange:C=>i(C.target.value),required:!0,className:"border-gray-300 pr-10",autoComplete:"current-password"}),c.jsx("button",{type:"button",onClick:()=>u(C=>!C),className:"absolute inset-y-0 right-2 flex items-center text-gray-500","aria-label":o?"Hide password":"Show password",children:o?c.jsx(mU,{size:18}):c.jsx(k0,{size:18})})]})]}),c.jsx(be,{type:"submit",disabled:g,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:g?"Logging in...":"Login"})]})]}),c.jsx(e_,{className:"flex justify-center border-t p-4",children:c.jsxs("p",{children:["Don't have an account?"," ",c.jsx(At,{to:"/register",className:"text-[#1877F2] hover:underline font-medium",children:"Create an account"})]})})]})}const F8e="https://api.gada.chat";function V8e(){const{accessToken:e,isLoading:t}=ct(),n=tr();return w.useEffect(()=>{!t&&e&&n("/")},[e,t,n]),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(At,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${F8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Connect with friends and the world around you"})]}),c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsx(yhe,{})})]})}function B8e(){const[e,t]=w.useState(""),[n,i]=w.useState(""),[o,u]=w.useState(""),[h,p]=w.useState(""),[g,v]=w.useState(""),[b,E]=w.useState(""),[T,C]=w.useState(""),[R,N]=w.useState(""),[O,j]=w.useState(!1),[k,P]=w.useState(!1),[M,D]=w.useState(!1),U=tr(),{register:F}=ct(),H=w.useMemo(()=>{const q=new URLSearchParams(location.search);return q.get("ref")||q.get("r")||""},[location.search]),W=async q=>{if(q.preventDefault(),!e||!n||!o||!h||!g||!b){C("Please fill in all fields");return}if(g!==b){C("Passwords do not match");return}if(g.length<6){C("Password must be at least 6 characters long");return}j(!0),C("");try{await F(e,n,o,h,g,H||void 0)?(N("Registration completed successfully, Please check your email and activate the account"),window.setTimeout(()=>U("/login"),3e3)):C("Email is already in use")}catch(Y){C("An error occurred."+Y+" Please try again.")}finally{j(!1)}};return c.jsxs(Vr,{className:"w-full max-w-md mx-auto",children:[c.jsxs(pa,{children:[c.jsx(Wa,{className:"text-2xl text-[#1877F2] font-bold",children:"Create an Account"}),c.jsx(Qy,{children:"Join Gada today and connect with friends"})]}),c.jsxs(mi,{children:[c.jsxs("form",{onSubmit:W,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"firstname",children:"First Name"}),c.jsx(Ae,{id:"firstname",placeholder:"John",value:e,onChange:q=>t(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"lastname",children:"Last Name"}),c.jsx(Ae,{id:"lastname",placeholder:"Doe",value:n,onChange:q=>i(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"username",children:"User Name"}),c.jsx(Ae,{id:"username",placeholder:"johndoe",value:o,onChange:q=>u(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"email",children:"Email"}),c.jsx(Ae,{id:"email",type:"email",placeholder:"your.email@example.com",value:h,onChange:q=>p(q.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2 relative",children:[c.jsx(Qe,{htmlFor:"password",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ae,{id:"password",type:k?"text":"password",placeholder:"••••••••",value:g,onChange:q=>v(q.target.value),required:!0,className:"border-gray-300 pr-10"}),c.jsx("button",{type:"button",onClick:()=>P(!k),className:"absolute inset-y-0 right-2 flex items-center text-gray-500",children:k?c.jsx(mU,{size:18}):c.jsx(k0,{size:18})})]})]}),c.jsxs("div",{className:"space-y-2 relative",children:[c.jsx(Qe,{htmlFor:"confirmPassword",children:"Confirm Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ae,{id:"confirmPassword",type:M?"text":"password",placeholder:"••••••••",value:b,onChange:q=>E(q.target.value),required:!0,className:"border-gray-300 pr-10"}),c.jsx("button",{type:"button",onClick:()=>D(!M),className:"absolute inset-y-0 right-2 flex items-center text-gray-500",children:M?c.jsx(mU,{size:18}):c.jsx(k0,{size:18})})]})]}),H&&c.jsxs("div",{className:"space-y-1",children:[c.jsx(Qe,{children:"Referred by"}),c.jsx(Ae,{value:H,readOnly:!0,className:"bg-gray-100"})]}),c.jsx(be,{type:"submit",disabled:O,className:"w-full bg-[#42B72A] hover:bg-[#36A420] text-white",children:O?"Creating account...":"Sign Up"})]}),c.jsxs("div",{className:"space-y-2 mt-2",children:[T&&c.jsxs(wf,{variant:"destructive",className:"mb-4",children:[c.jsx(N1,{className:"h-4 w-4"}),c.jsx(py,{children:T})]}),R&&c.jsxs(wf,{variant:"success",className:"mb-4",children:[c.jsx(WVe,{className:"h-4 w-4 text-green-600"}),c.jsx(py,{className:"ml-2 text-green-800",children:R})]})]})]}),c.jsx(e_,{className:"flex justify-center border-t p-4",children:c.jsxs("p",{children:["Already have an account?"," ",c.jsx(At,{to:"/login",className:"text-[#1877F2] hover:underline font-medium",children:"Log in"})]})})]})}const $8e="https://api.gada.chat";function W8e(){const{user:e,isLoading:t}=ct(),n=tr();return w.useEffect(()=>{},[e,t,n]),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(At,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${$8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Create an account and connect with friends"})]}),c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsx(B8e,{})})]})}function G8e(){const[e,t]=w.useState(1),[n,i]=w.useState(1),[o,u]=w.useState(""),[h,p]=w.useState(""),[g,v]=w.useState(""),[b,E]=w.useState(""),[T,C]=w.useState(""),[R,N]=w.useState(!1),O=tr(),{sendOtp:j,forgotpassword:k,resetpassword:P,resendOtp:M}=ct(),[D,U]=w.useState(!1),[F,H]=w.useState(0);w.useEffect(()=>{if(F>0){const Z=setTimeout(()=>H(F-1),1e3);return()=>clearTimeout(Z)}},[F]);const W=async()=>{if(!o){C("Please enter your email");return}N(!0),C("");try{await j(o)?(i(2),H(30)):C("Failed to send OTP")}catch(Z){C(String(Z))}finally{N(!1)}},q=async Z=>{if(Z.preventDefault(),console.log("yeah its comes"),!/^\d{4}$/.test(h)){C("OTP must be a 4-digit number");return}N(!0),C("");try{await k(o,h)?t(2):C("Invalid or expired OTP")}catch(X){C(""+X)}finally{N(!1)}},Y=async()=>{if(!o){C("Please enter your email first");return}U(!0),C("");try{await M(o),H(30)}catch{C("Failed to resend OTP")}finally{U(!1)}},z=async Z=>{if(Z.preventDefault(),!g||!b){C("Please fill in both password fields");return}if(g.length<6){C("Password must be at least 6 characters long");return}if(g!==b){C("Passwords do not match");return}N(!0),C("");try{await P(o,h,g)?O("/login"):C("Failed to reset password")}catch(X){C(String(X))}finally{N(!1)}};return c.jsxs(Vr,{className:"w-full max-w-md mx-auto",children:[c.jsxs(pa,{children:[c.jsx(Wa,{className:"text-2xl text-[#1877F2] font-bold",children:e===1?"Forgot Password":"Reset Password"}),c.jsx(Qy,{children:e===1?n===1?"Enter your email to receive OTP":"Enter the OTP sent to your email":"Set your new password"})]}),c.jsxs(mi,{children:[T&&c.jsxs(wf,{variant:"destructive",className:"mb-4",children:[c.jsx(N1,{className:"h-4 w-4"}),c.jsx(py,{children:T})]}),e===1&&n===1&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-2 mb-2",children:[c.jsx(Qe,{htmlFor:"email",children:"Email"}),c.jsx(Ae,{id:"email",type:"email",placeholder:"your.email@example.com",value:o,onChange:Z=>u(Z.target.value),required:!0,className:"border-gray-300"})]}),c.jsx(be,{onClick:W,disabled:R,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:R?"Sending...":"Send OTP"})]}),e===1&&n===2&&c.jsxs("form",{onSubmit:q,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"email",children:"Email"}),c.jsx(Ae,{value:o,disabled:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Qe,{htmlFor:"otp",children:"4-Digit OTP"}),c.jsx("span",{onClick:()=>{!D&&F===0&&Y()},style:{color:F>0?"#999":"#007bff",cursor:F>0||D?"not-allowed":"pointer",textDecoration:F===0&&!D?"underline":"none",fontSize:"14px",display:"inline-block",marginTop:"6px"},children:D?"Sending...":F>0?`Resend in ${F}s`:"Resend"})]}),c.jsx(Ae,{id:"otp",type:"number",onInput:Z=>{Z.currentTarget.value=Z.currentTarget.value.slice(0,4)},placeholder:"1234",value:h,onChange:Z=>p(Z.target.value),required:!0,className:"border-gray-300"})]}),c.jsx(be,{type:"submit",disabled:R,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:R?"Verifying...":"Verify OTP"})]}),e===2&&c.jsxs("form",{onSubmit:z,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"newPassword",children:"New Password"}),c.jsx(Ae,{id:"newPassword",type:"password",placeholder:"••••••••",value:g,onChange:Z=>v(Z.target.value),required:!0,className:"border-gray-300"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"confirmPassword",children:"Confirm Password"}),c.jsx(Ae,{id:"confirmPassword",type:"password",placeholder:"••••••••",value:b,onChange:Z=>E(Z.target.value),required:!0,className:"border-gray-300"})]}),c.jsx(be,{type:"submit",disabled:R,className:"w-full bg-[#1877F2] hover:bg-[#166FE5] text-white",children:R?"Resetting...":"Reset Password"})]})]}),c.jsx(e_,{className:"flex justify-center border-t p-4",children:c.jsxs("p",{children:["Back to ","",c.jsx(At,{to:"/login",className:"text-[#1877F2] hover:underline font-medium",children:"Login"})]})})]})}const H8e="https://api.gada.chat";function z8e(){const{accessToken:e,user:t,isLoading:n}=ct();return tr(),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(At,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${H8e}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Connect with friends and the world around you"})]}),c.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:c.jsx(G8e,{})})]})}const _B="https://api.gada.chat";async function K8e(e,t={}){const n=await fetch(`${_B}/api/profile/${e}/summary`,{credentials:"include",headers:t});if(!n.ok)throw new Error("Failed to load profile summary");return n.json()}async function q8e(e,{cursor:t,limit:n=10}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=await fetch(`${_B}/api/profile/${e}/posts?`+o.toString(),{credentials:"include",headers:i});if(!u.ok)throw new Error("Failed to load profile posts");return u.json()}async function Y8e(e,{cursor:t,limit:n=24}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=await fetch(`${_B}/api/profile/${e}/friends?`+o.toString(),{credentials:"include",headers:i});if(!u.ok)throw new Error("Failed to load profile friends");return u.json()}var Z1="Tabs",[X8e,lxt]=Fs(Z1,[r_]),_he=r_(),[J8e,bB]=X8e(Z1),bhe=w.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:o,defaultValue:u,orientation:h="horizontal",dir:p,activationMode:g="automatic",...v}=e,b=n_(p),[E,T]=Bd({prop:i,onChange:o,defaultProp:u??"",caller:Z1});return c.jsx(J8e,{scope:n,baseId:Ll(),value:E,onValueChange:T,orientation:h,dir:b,activationMode:g,children:c.jsx(Qt.div,{dir:b,"data-orientation":h,...v,ref:t})})});bhe.displayName=Z1;var Ehe="TabsList",whe=w.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...o}=e,u=bB(Ehe,n),h=_he(n);return c.jsx(H4,{asChild:!0,...h,orientation:u.orientation,dir:u.dir,loop:i,children:c.jsx(Qt.div,{role:"tablist","aria-orientation":u.orientation,...o,ref:t})})});whe.displayName=Ehe;var She="TabsTrigger",xhe=w.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:o=!1,...u}=e,h=bB(She,n),p=_he(n),g=Rhe(h.baseId,i),v=Nhe(h.baseId,i),b=i===h.value;return c.jsx(z4,{asChild:!0,...p,focusable:!o,active:b,children:c.jsx(Qt.button,{type:"button",role:"tab","aria-selected":b,"aria-controls":v,"data-state":b?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:g,...u,ref:t,onMouseDown:Tt(e.onMouseDown,E=>{!o&&E.button===0&&E.ctrlKey===!1?h.onValueChange(i):E.preventDefault()}),onKeyDown:Tt(e.onKeyDown,E=>{[" ","Enter"].includes(E.key)&&h.onValueChange(i)}),onFocus:Tt(e.onFocus,()=>{const E=h.activationMode!=="manual";!b&&!o&&E&&h.onValueChange(i)})})})});xhe.displayName=She;var The="TabsContent",Che=w.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:o,children:u,...h}=e,p=bB(The,n),g=Rhe(p.baseId,i),v=Nhe(p.baseId,i),b=i===p.value,E=w.useRef(b);return w.useEffect(()=>{const T=requestAnimationFrame(()=>E.current=!1);return()=>cancelAnimationFrame(T)},[]),c.jsx(is,{present:o||b,children:({present:T})=>c.jsx(Qt.div,{"data-state":b?"active":"inactive","data-orientation":p.orientation,role:"tabpanel","aria-labelledby":g,hidden:!T,id:v,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:E.current?"0s":void 0},children:T&&u})})});Che.displayName=The;function Rhe(e,t){return`${e}-trigger-${t}`}function Nhe(e,t){return`${e}-content-${t}`}var Z8e=bhe,Ahe=whe,Ihe=xhe,Ohe=Che;const Rm=Z8e,jf=w.forwardRef(({className:e,...t},n)=>c.jsx(Ahe,{ref:n,className:jt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));jf.displayName=Ahe.displayName;const Ia=w.forwardRef(({className:e,...t},n)=>c.jsx(Ihe,{ref:n,className:jt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Ia.displayName=Ihe.displayName;const fi=w.forwardRef(({className:e,...t},n)=>c.jsx(Ohe,{ref:n,className:jt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));fi.displayName=Ohe.displayName;const VQ="https://api.gada.chat";function Q8e({open:e,onOpenChange:t,onSaved:n}){const{accessToken:i}=ct(),o=St(i),[u,h]=w.useState(!1),[p,g]=w.useState(null),[v,b]=w.useState("basic"),[E,T]=w.useState({firstName:"",lastName:"",gender:"",birthdate:"",bio:"",website:"",workTitle:"",workPlace:"",currentCity:"",hometown:"",socialFacebook:"",socialTwitter:"",socialInstagram:"",socialYoutube:"",socialLinkedin:"",privacyChat:"public",privacyWall:"friends",privacyPhotos:"public"}),C=w.useRef(!1);w.useEffect(()=>{!e||C.current||(C.current=!0,(async()=>{try{g(null);const O=await fetch(`${VQ}/api/profile/me`,{headers:o});if(!O.ok)throw new Error("Failed to load");const j=await O.json();T({firstName:j.firstName??"",lastName:j.lastName??"",gender:j.gender??"",birthdate:j.birthdate??"",bio:j.bio??"",website:j.website??"",workTitle:j.workTitle??"",workPlace:j.workPlace??"",currentCity:j.currentCity??"",hometown:j.hometown??"",socialFacebook:j.socialFacebook??"",socialTwitter:j.socialTwitter??"",socialInstagram:j.socialInstagram??"",socialYoutube:j.socialYoutube??"",socialLinkedin:j.socialLinkedin??"",privacyChat:j.privacyChat??"public",privacyWall:j.privacyWall??"friends",privacyPhotos:j.privacyPhotos??"public"})}catch(O){g((O==null?void 0:O.message)||"Failed to load profile")}})())},[e,o]);const R=O=>j=>{const k=j!=null&&j.target?j.target.value:j;T(P=>({...P,[O]:k}))};async function N(){try{h(!0),g(null);const O=await fetch(`${VQ}/api/profile`,{method:"PUT",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(E)});if(!O.ok){const j=await O.json().catch(()=>({}));throw new Error((j==null?void 0:j.error)||"Update failed")}Ce.success("Profile data has been updated successfully"),n==null||n(),t(!1)}catch(O){g((O==null?void 0:O.message)||"Update failed")}finally{h(!1)}}return c.jsx(Ko,{open:e,onOpenChange:O=>{u||t(O)},children:c.jsxs(mo,{className:"sm:max-w-[720px]",children:[c.jsx(qo,{children:c.jsx(Yo,{children:"Edit profile"})}),p&&c.jsx("div",{className:"text-red-600 text-sm mb-2",children:p}),c.jsxs(Rm,{value:v,onValueChange:b,children:[c.jsxs(jf,{className:"grid grid-cols-4 w-full",children:[c.jsx(Ia,{value:"basic",children:"Basic"}),c.jsx(Ia,{value:"about",children:"About"}),c.jsx(Ia,{value:"social",children:"Social"}),c.jsx(Ia,{value:"privacy",children:"Privacy"})]}),c.jsxs(fi,{value:"basic",className:"mt-4 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(ms,{label:"First name",children:c.jsx(Ae,{value:E.firstName,onChange:R("firstName")})}),c.jsx(ms,{label:"Last name",children:c.jsx(Ae,{value:E.lastName,onChange:R("lastName")})}),c.jsx(ms,{label:"Gender",children:c.jsx(Ae,{value:E.gender,onChange:R("gender"),placeholder:"male/female/other"})}),c.jsx(ms,{label:"Birthdate",children:c.jsx(Ae,{type:"date",value:E.birthdate||"",onChange:R("birthdate")})})]}),c.jsx(ms,{label:"Bio",children:c.jsx(Ei,{value:E.bio,onChange:R("bio"),rows:4})}),c.jsx(ms,{label:"Website",children:c.jsx(Ae,{value:E.website,onChange:R("website"),placeholder:"https://…"})})]}),c.jsx(fi,{value:"about",className:"mt-4 space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(ms,{label:"Work title",children:c.jsx(Ae,{value:E.workTitle,onChange:R("workTitle")})}),c.jsx(ms,{label:"Work place",children:c.jsx(Ae,{value:E.workPlace,onChange:R("workPlace")})}),c.jsx(ms,{label:"Current city",children:c.jsx(Ae,{value:E.currentCity,onChange:R("currentCity")})}),c.jsx(ms,{label:"Hometown",children:c.jsx(Ae,{value:E.hometown,onChange:R("hometown")})})]})}),c.jsx(fi,{value:"social",className:"mt-4 space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(ms,{label:"Facebook",children:c.jsx(Ae,{value:E.socialFacebook,onChange:R("socialFacebook")})}),c.jsx(ms,{label:"Twitter / X",children:c.jsx(Ae,{value:E.socialTwitter,onChange:R("socialTwitter")})}),c.jsx(ms,{label:"Instagram",children:c.jsx(Ae,{value:E.socialInstagram,onChange:R("socialInstagram")})}),c.jsx(ms,{label:"YouTube",children:c.jsx(Ae,{value:E.socialYoutube,onChange:R("socialYoutube")})}),c.jsx(ms,{label:"LinkedIn",children:c.jsx(Ae,{value:E.socialLinkedin,onChange:R("socialLinkedin")})})]})}),c.jsx(fi,{value:"privacy",className:"mt-4 space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsx(hL,{label:"Who can chat with me?",value:E.privacyChat,onChange:R("privacyChat")}),c.jsx(hL,{label:"Who can post on my wall?",value:E.privacyWall,onChange:R("privacyWall")}),c.jsx(hL,{label:"Who can see my photos?",value:E.privacyPhotos,onChange:R("privacyPhotos")})]})})]}),c.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>t(!1),disabled:u,children:"Cancel"}),c.jsx(be,{onClick:N,disabled:u,children:u?"Saving…":"Save changes"})]})]})})}function ms({label:e,children:t}){return c.jsxs("div",{className:"space-y-1.5",children:[c.jsx(Qe,{className:"text-sm",children:e}),t]})}function hL({label:e,value:t,onChange:n}){return c.jsx(ms,{label:e,children:c.jsxs("select",{value:t,onChange:n,className:"h-9 px-3 rounded-md border border-gray-300 bg-white",children:[c.jsx("option",{value:"me",children:"Only me"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"public",children:"Public"})]})})}function BQ({isOpen:e,onClose:t,onSave:n,title:i,type:o,description:u,onUploadingChange:h}){const[p,g]=w.useState(null),[v,b]=w.useState(null),[E,T]=w.useState(null),[C,R]=w.useState(!1),N=w.useRef(null),{id:O}=Qo(),{accessToken:j}=ct(),k=Bl(j),P=tr(),M=U=>{var H;const F=((H=U.target.files)==null?void 0:H[0])||null;if(g(null),!F){T(null),b(null);return}if(F.size>5*1024*1024){g("File is too large. Maximum size is 5MB.");return}if(!F.type.startsWith("image/")){g("Only image files are allowed.");return}T(F),b(URL.createObjectURL(F))},D=async()=>{if(!(!E||!O)){R(!0),h==null||h(!0),g(null);try{const U=await fVe(O,E,k,o);n(U),b(U),t(),P("/profile/"+O)}catch(U){console.error("Avatar upload failed",U),g((U==null?void 0:U.message)||"Upload failed")}finally{R(!1),h==null||h(!1),N.current&&(N.current.value="")}}};return c.jsx(Ko,{open:e,onOpenChange:U=>!U&&t(),children:c.jsxs(mo,{className:"sm:max-w-[425px]",children:[c.jsxs(qo,{children:[c.jsx(Yo,{children:i}),c.jsx(t_,{children:u})]}),c.jsxs("div",{className:"grid gap-4 py-4",children:[p&&c.jsxs(wf,{variant:"destructive",children:[c.jsx(N1,{className:"h-4 w-4"}),c.jsx(py,{children:p})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qe,{htmlFor:"image-upload",children:"Upload an image"}),c.jsx(Ae,{id:"image-upload",type:"file",accept:"image/*",ref:N,onChange:M})]}),v&&c.jsxs("div",{className:"mt-2",children:[c.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Preview:"}),c.jsx("div",{className:"relative w-full max-w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:c.jsx("img",{src:v,alt:"Preview",className:"object-cover w-full h-full"})})]})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(be,{variant:"outline",onClick:t,disabled:C,children:"Cancel"}),c.jsx(be,{onClick:D,disabled:!E||C,children:C?c.jsxs(c.Fragment,{children:[c.jsx(ei,{className:"h-4 w-4 animate-spin mr-2"})," Uploading…"]}):"Save"})]})]})})}const KC="https://api.gada.chat";function eWe(){const{id:e}=Qo(),t=tr(),{user:n,isLoading:i,accessToken:o,updateProfile:u}=ct(),h=St(o),[p,g]=w.useState(!1),{openChatWith:v}=Cm(),[b,E]=w.useState(!1),[T,C]=w.useState(!1),R=w.useMemo(()=>{if(!e)return null;try{return Number(k5e(e))}catch{return Number(e)}},[e]),[N,O]=w.useState("posts"),[j,k]=w.useState(null),[P,M]=w.useState(!0),[D,U]=w.useState(null),[F,H]=w.useState(null),[W,q]=w.useState(null),[Y,z]=w.useState(!1),[Z,X]=w.useState(!1),[ae,se]=w.useState([]),[J,re]=w.useState(null),[ee,de]=w.useState(!1),[xe,ve]=w.useState(!1),Te=w.useRef(h);w.useEffect(()=>{Te.current=h},[h]),w.useEffect(()=>{!i&&!n&&t("/login")},[i,n,t]);const Pe=w.useRef({userId:null,done:!1});w.useEffect(()=>{if(!R||!o||(Pe.current.userId!==R&&(Pe.current={userId:R,done:!1}),Pe.current.done))return;Pe.current.done=!0,M(!0),U(null);let wt=!1;return K8e(R,Te.current).then(Rt=>{wt||k(Rt)}).catch(Rt=>{wt||U((Rt==null?void 0:Rt.message)||"Failed to load")}).finally(()=>{wt||M(!1)}),()=>{wt=!0}},[R,o]);const qe=w.useRef(!1),st=w.useRef(""),ze=async(wt=!1)=>{if(!(!R||!o)&&!qe.current&&!(!wt&&Z)){qe.current=!0,z(!0);try{const{items:Rt=[],nextCursor:Le}=await q8e(R,{cursor:wt?null:W,limit:10},Te.current);H(ge=>wt?Rt:[...ge||[],...Rt]),q(Le??null),(!Le||Rt.length===0)&&X(!0)}catch(Rt){console.error("[profile posts]",Rt)}finally{qe.current=!1,z(!1)}}};w.useEffect(()=>{if(!R||N!=="posts"||!o)return;const wt=`posts|${R}`;st.current!==wt&&(st.current=wt,H(null),q(null),X(!1),Promise.resolve().then(()=>ze(!0)))},[R,N,o]);const ft=w.useRef(!1),$e=w.useRef(""),at=async(wt=!1)=>{if(!(!R||!o)&&!ft.current&&!(!wt&&xe)){ft.current=!0,de(!0);try{const{items:Rt=[],nextCursor:Le}=await Y8e(R,{cursor:wt?void 0:J??void 0,limit:24},Te.current);se(ge=>wt?Rt:[...ge,...Rt]),re(Le??null),(!Le||Rt.length===0)&&ve(!0)}catch(Rt){console.error("[profile friends]",Rt)}finally{ft.current=!1,de(!1)}}};if(w.useEffect(()=>{if(!R||N!=="friends"||!o)return;const wt=`friends|${R}`;$e.current!==wt&&($e.current=wt,se([]),re(null),ve(!1),Promise.resolve().then(()=>at(!0)))},[R,N,o]),i||P)return c.jsxs("div",{className:"min-h-screen bg-white",children:[c.jsx(or,{}),c.jsx("div",{className:"flex items-center justify-center py-24",children:c.jsx(ei,{className:"h-8 w-8 animate-spin text-[#1877F2]"})})]});if(D||!j)return c.jsxs("div",{className:"min-h-screen bg-white",children:[c.jsx(or,{}),c.jsx("div",{className:"max-w-4xl mx-auto p-6 text-center text-red-600",children:D||"Profile not found"})]});const ke=j.user.fullName||j.user.username,je=j.user.avatar?KC+"/uploads/"+Xn(j.user.avatar):"",Pt=j.user.cover?KC+"/uploads/"+Xn(j.user.cover):"",Dt=j.relationship==="me",cn=wt=>{u==null||u({profileImage:wt}),k(Rt=>Rt&&{...Rt,user:{...Rt.user,avatar:wt}}),E(!1)},ut=wt=>{u==null||u({coverImage:wt}),k(Rt=>Rt&&{...Rt,user:{...Rt.user,cover:wt}}),C(!1)};return c.jsxs("div",{className:"min-h-screen bg-gray-100",children:[c.jsx(or,{}),c.jsxs("div",{className:"bg-white shadow",children:[c.jsxs("div",{className:"relative max-w-5xl mx-auto",children:[c.jsxs("div",{className:"h-56 sm:h-64 w-full bg-gray-200 overflow-hidden rounded-b-lg relative",children:[Pt?c.jsx("img",{src:Pt,alt:"",className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full bg-gradient-to-r from-slate-200 to-slate-300"}),Dt&&c.jsx(be,{size:"icon",variant:"secondary",className:"absolute bottom-3 right-3 bg-white/80 backdrop-blur-sm hover:bg-white",onClick:()=>C(!0),"aria-label":"Change cover photo",children:c.jsx(O0,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"px-4 sm:px-6",children:[c.jsxs("div",{className:"flex items-end gap-4 -mt-10 sm:-mt-12",children:[c.jsxs("div",{className:"relative h-24 w-24 sm:h-32 sm:w-32 rounded-full ring-4 ring-white overflow-hidden bg-gray-200",children:[je?c.jsx("img",{src:je,alt:ke,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl text-gray-500",children:(ke==null?void 0:ke[0])??"U"}),Dt&&c.jsx(be,{size:"icon",variant:"secondary",className:"absolute bottom-1 right-1 bg-white/85 hover:bg-white h-8 w-8 rounded-full shadow",onClick:()=>E(!0),"aria-label":"Change profile picture",children:c.jsx(O0,{className:"h-4 w-4"})})]}),c.jsxs("div",{className:"pb-2",children:[c.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:ke}),c.jsxs("div",{className:"text-gray-600 text-sm",children:[j.counts.friends," friends · ",j.counts.posts," posts"]})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 pb-4",children:[j.relationship!=="me"&&c.jsxs(c.Fragment,{children:[c.jsxs(be,{variant:"secondary",onClick:()=>v(Number(j.user.id),{id:Number(j.user.id),username:j.user.username,fullName:j.user.fullName,avatar:j.user.avatar||null}),"aria-label":`Message ${j.user.fullName||j.user.username}`,children:[c.jsx(PN,{className:"h-4 w-4 mr-2"}),"Message"]}),c.jsx(be,{className:"bg-[#1877F2] hover:bg-[#166FE5]",children:j.relationship==="friends"?"Friends":j.relationship==="requested"?"Requested":"Add Friend"})]}),Dt&&c.jsx(be,{variant:"outline",onClick:()=>g(!0),children:"Edit Profile"}),c.jsx(Q8e,{open:p,onOpenChange:g,onSaved:()=>window.location.reload()})]})]})]}),c.jsx("div",{className:"border-t",children:c.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6",children:c.jsxs("div",{className:"flex gap-6",children:[c.jsx(fL,{active:N==="posts",onClick:()=>O("posts"),children:"Posts"}),c.jsx(fL,{active:N==="friends",onClick:()=>O("friends"),children:"Friends"}),c.jsx(fL,{active:N==="photos",onClick:()=>O("photos"),children:"Photos"})]})})})]}),c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h2",{className:"text-lg font-semibold mb-2",children:"About"}),j.user.bio?c.jsx("p",{className:"text-gray-700",children:j.user.bio}):c.jsx("p",{className:"text-gray-500 italic",children:"No bio yet"})]}),N==="posts"&&c.jsxs("div",{className:"space-y-4",children:[F===null&&Y&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"Loading…"}),Array.isArray(F)&&F.length>0&&c.jsxs(c.Fragment,{children:[F.map(wt=>c.jsx(Vu,{post:wt},wt.id)),!Z&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>ze(!1),disabled:Y,children:Y?"Loading…":"Load more"})})]}),F!==null&&F.length===0&&Z&&!Y&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts yet"})]}),N==="friends"&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:ae.map(wt=>{var Rt;return c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("div",{className:"h-20 w-20 rounded-md overflow-hidden bg-gray-200",children:wt.avatar?c.jsx("img",{src:KC+"/uploads/"+Xn(wt.avatar),alt:wt.fullName,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-lg text-gray-500",children:((Rt=wt.fullName)==null?void 0:Rt[0])??"U"})}),c.jsx("div",{className:"mt-2 text-sm font-medium text-center leading-tight",children:wt.fullName})]},wt.id)})}),!xe&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>at(!1),disabled:ee,children:ee?"Loading…":"Load more"})}),ae.length===0&&xe&&c.jsx("div",{className:"text-center text-gray-500 py-6",children:"No friends to show"})]}),N==="photos"&&c.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:c.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:[j.previews.photos.map((wt,Rt)=>c.jsx("div",{className:"aspect-square overflow-hidden rounded",children:c.jsx("img",{src:KC+"/uploads/"+Xn(wt),className:"w-full h-full object-cover"})},Rt)),j.previews.photos.length===0&&c.jsx("div",{className:"text-gray-500 text-center py-6 col-span-full",children:"No photos yet"})]})})]}),c.jsx(BQ,{isOpen:b,onClose:()=>E(!1),onSave:cn,title:"Change Profile Picture",type:"profile",description:"Upload a new profile picture or enter an image URL"}),c.jsx(BQ,{isOpen:T,onClose:()=>C(!1),onSave:ut,title:"Change Cover Photo",type:"cover",description:"Upload a new cover photo or enter an image URL"})]})}function fL({active:e,onClick:t,children:n}){return c.jsx("button",{onClick:t,className:`py-3 px-1 border-b-2 -mb-px text-sm sm:text-base ${e?"border-[#1877F2] text-[#1877F2] font-medium":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:n})}const tWe="https://api.gada.chat";function nWe(){const{accessToken:e,user:t,isLoading:n}=ct(),i=St(e),o=tr(),{token:u}=Qo(),[h,p]=w.useState(""),[g,v]=w.useState("");return w.useEffect(()=>{if(!u){o("/login");return}if(e){o("/");return}async function b(){try{if(await dVe({token:u},i)){v("Your account has been activated successfully, You can login now");const T=window.setTimeout(()=>{v(""),o("/login")},5e3);return!1}}catch(E){console.log(E),p(""+E)}}b()},[u,o]),c.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[c.jsxs(At,{to:"/",className:"inline-flex items-center justify-center gap-3 mb-4","aria-label":"Go to home",children:[c.jsx("img",{src:`${tWe}/uploads/gadalogo.png`,alt:"Gada logo",className:"h-12 w-12 object-contain"}),c.jsx("span",{className:"text-[#1877F2] text-5xl font-bold leading-none",children:"Gada.chat"})]}),c.jsx("h2",{className:"text-gray-900 text-xl",children:"Connect with friends and the world around you"})]}),c.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[h&&c.jsx(wf,{variant:"destructive",className:"mb-4",children:h}),g&&c.jsx(wf,{variant:"default",className:"mb-4",children:g}),c.jsx(yhe,{})]})]})}const Phe=w.createContext(null);function rWe({children:e}){const{accessToken:t,user:n}=ct(),i=St(t),[o,u]=w.useState([]),[h,p]=w.useState([]),[g,v]=w.useState([]);w.useEffect(()=>{t&&(LQ(i).then(u).catch(console.error),l8e(i).then(p).catch(console.error),KR(i).then(v).catch(console.error))},[t]);const b=async T=>{const C=await ghe(T,i);Ce.success("Request sent successfully "),KR(i).then(v).catch(console.error),p(R=>[C,...R]),v(R=>R.filter(N=>N.id!==T))},E=async(T,C)=>{if(await u8e(T,C,i),p(R=>R.map(N=>N.id===T?{...N,status:C}:N)),Ce.success("Request "+C+" successfully "),C==="accepted"){const R=await LQ(i);u(R)}KR(i).then(v).catch(console.error)};return c.jsx(Phe.Provider,{value:{friends:o,requests:h,suggestions:g,sendRequest:b,respondRequest:E},children:e})}function Q1(){const e=w.useContext(Phe);if(!e)throw new Error("useFriends must be in FriendProvider");return e}const iWe="https://api.gada.chat";function aWe(){const{friends:e}=Q1();return e.length===0?c.jsx("p",{className:"p-4 text-gray-500",children:"You have no friends yet."}):c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 p-4",children:e.map(t=>c.jsxs(At,{to:`/profile/${t.id}`,className:"flex flex-col items-center hover:bg-gray-100 p-2 rounded",children:[c.jsx($i,{className:"h-16 w-16",children:t.profileImage?c.jsx(Ii,{src:iWe+"/uploads/"+t.profileImage}):c.jsx(ea,{children:t.user_name[0].toUpperCase()})}),c.jsx("span",{className:"mt-2 text-sm text-gray-800",children:t.user_name})]},t.id))})}const $Q="https://api.gada.chat";function sWe(){const{user:e}=ct(),{requests:t,respondRequest:n}=Q1(),i=t.filter(o=>o.toUserId===e.id&&o.status===0);return i.length===0?c.jsx("p",{className:"p-4 text-gray-500",children:"No new friend requests."}):c.jsx("div",{className:"p-4 space-y-4",children:i.map(o=>c.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded shadow",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("img",{src:o.fromProfileImage?$Q+"/uploads/"+o.fromProfileImage:$Q+"/uploads//profile/defaultavatar.png",alt:o.fromUsername,className:"h-10 w-10 rounded-full object-cover"}),c.jsx("span",{children:o.fromUsername})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(be,{size:"sm",onClick:()=>n(o.id,"accepted"),children:"Accept"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>n(o.id,"declined"),children:"Decline"})]})]},o.id))})}function oWe(){const[e,t]=w.useState(""),[n,i]=w.useState([]),[o,u]=w.useState(!1),{accessToken:h}=ct(),p=St(h),{sendRequest:g}=Q1(),v=async b=>{if(b.preventDefault(),!!e.trim()){u(!0);try{const E=await d8e(e,p);i(E)}catch(E){console.error("Search failed",E)}finally{u(!1)}}};return c.jsxs("div",{className:"p-4 bg-white rounded shadow",children:[c.jsxs("form",{onSubmit:v,className:"flex space-x-2 mb-4",children:[c.jsx(Ae,{value:e,onChange:b=>t(b.target.value),placeholder:"Find friends"}),c.jsx(be,{type:"submit",disabled:o,children:o?"Searching…":"Search"})]}),c.jsxs("div",{className:"space-y-3",children:[n.map(b=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx($i,{className:"h-8 w-8",children:b.profileImage?c.jsx(Ii,{src:b.profileImage}):c.jsx(ea,{children:b.user_name[0].toUpperCase()})}),c.jsx("span",{children:b.user_name})]}),c.jsx(be,{size:"sm",onClick:()=>g(b.user_id),children:"Add Friend"})]},b.user_id)),n.length===0&&!o&&c.jsx("p",{className:"text-gray-500 text-sm",children:"No users found."})]})]})}const pL="https://api.gada.chat";function cWe(){const{suggestions:e,sendRequest:t}=Q1();return console.log(e,"suggestionssuggestions"),e.length===0?null:c.jsx("div",{className:"p-4 bg-white rounded shadow",children:c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:e.map(n=>c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx($i,{className:"h-16 w-16 mx-auto",children:n!=null&&n.profileImage?c.jsx(Ii,{src:n!=null&&n.profileImage?pL+"/uploads/"+n.profileImage:pL+"/uploads//profile/defaultavatar.png"}):c.jsx(Ii,{src:pL+"/uploads//profile/defaultavatar.png"})}),c.jsx("div",{className:"text-sm font-medium",children:n.user_name}),c.jsx(be,{size:"sm",onClick:()=>t(n.user_id),className:"w-full",children:"Add Friend"})]},n.id))})})}function lWe(){const{accessToken:e,isLoading:t}=ct(),n=tr();return w.useEffect(()=>{!t&&!e&&n("/login")},[t,e,n]),t?null:c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsxs("div",{className:"sticky top-16",children:["   ",c.jsx(Ss,{})]})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsx("div",{className:"space-y-6 py-6",children:c.jsxs(rWe,{children:[c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"People You May Know"}),c.jsx(cWe,{})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Friend Requests"}),c.jsx(sWe,{})]}),c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Find Friends"}),c.jsx(oWe,{})]})]}),c.jsxs("section",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Your Friends"}),c.jsx(aWe,{})]})]})})}),c.jsx("aside",{className:"hidden xl:block xl:w-80 py-6",children:c.jsx(J1,{})})]})})]})}function uWe(){const{accessToken:e,isLoading:t}=ct(),n=St(e),[i,o]=w.useState([]),[u,h]=w.useState(!0),p=tr();return w.useEffect(()=>{!t&&!e&&p("/login")},[t,e,p]),w.useEffect(()=>{e&&wVe(n).then(o).catch(console.error).finally(()=>h(!1))},[e]),t||u?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx(ei,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsx(Ss,{})}),c.jsx("main",{className:"flex-1 overflow-auto p-6 space-y-6",children:c.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h1",{className:"text-3xl font-bold",children:"Saved Posts"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"All the posts you’ve saved for later"})]}),i.length>0?i.map(g=>c.jsx(Vu,{post:g},g.id)):c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:"No saved posts yet"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"When you save a post, it’ll show up here."})]})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-96 min-h-0 overflow-y-auto pt-6",children:c.jsx(J1,{})})]})})]})}const dWe="https://api.gada.chat";async function hWe(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error((t==null?void 0:t.error)||"Request failed");return t}async function fWe(e){const t=await fetch(`${dWe}/api/memories`,{headers:e,credentials:"include"});return hWe(t)}function pWe(){const{accessToken:e,isLoading:t}=ct(),n=St(e),[i,o]=w.useState([]),[u,h]=w.useState(!0),p=tr();return w.useEffect(()=>{!t&&!e&&p("/login")},[t,e,p]),w.useEffect(()=>{e&&fWe(n).then(o).catch(console.error).finally(()=>h(!1))},[e]),t||u?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(ei,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsxs("div",{className:"space-y-6 py-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("h1",{className:"text-2xl font-bold",children:"On This Day"}),c.jsx("p",{className:"text-gray-600",children:"Your posts from this date in previous years."})]}),i.length>0?i.map(g=>c.jsx(Vu,{post:g},g.id)):c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:"No memories today"}),c.jsx("p",{className:"text-gray-500",children:"Come back tomorrow!"})]})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-80 py-6",children:c.jsx("div",{className:"sticky space-y-8"})})]})})]})}const mWe=({email:e,amount:t,metadata:n,onSuccess:i,onClose:o})=>{const u=async()=>{try{const{authorization_url:h,reference:p}=await Mde(e,t,n);h&&window.location.assign(h)}catch(h){console.error(h),alert("Could not initialize payment")}};return c.jsxs("button",{onClick:u,className:"bg-green-500 text-white px-4 py-2 rounded",children:["Pay ₦",t.toLocaleString()]})};function gWe(){const{user:e}=ct();if(!e)return null;const t=n=>{alert(`Payment successful! Reference: ${n}`)};return c.jsxs("div",{className:"p-6",children:[c.jsx("h1",{className:"text-2xl mb-4",children:"Complete Your Payment"}),c.jsx(mWe,{email:e.email,amount:5e3,metadata:{userId:e.id},onSuccess:t})]})}function Gl(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function um(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const khe=6048e5,vWe=864e5;let yWe={};function eI(){return yWe}function B0(e,t){var p,g,v,b;const n=eI(),i=(t==null?void 0:t.weekStartsOn)??((g=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((b=(v=n.locale)==null?void 0:v.options)==null?void 0:b.weekStartsOn)??0,o=Gl(e),u=o.getDay(),h=(u<i?7:0)+u-i;return o.setDate(o.getDate()-h),o.setHours(0,0,0,0),o}function BN(e){return B0(e,{weekStartsOn:1})}function jhe(e){const t=Gl(e),n=t.getFullYear(),i=um(e,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const o=BN(i),u=um(e,0);u.setFullYear(n,0,4),u.setHours(0,0,0,0);const h=BN(u);return t.getTime()>=o.getTime()?n+1:t.getTime()>=h.getTime()?n:n-1}function WQ(e){const t=Gl(e);return t.setHours(0,0,0,0),t}function GQ(e){const t=Gl(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function _We(e,t){const n=WQ(e),i=WQ(t),o=+n-GQ(n),u=+i-GQ(i);return Math.round((o-u)/vWe)}function bWe(e){const t=jhe(e),n=um(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),BN(n)}function EWe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function wWe(e){if(!EWe(e)&&typeof e!="number")return!1;const t=Gl(e);return!isNaN(Number(t))}function SWe(e){const t=Gl(e),n=um(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}const xWe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},TWe=(e,t,n)=>{let i;const o=xWe[e];return typeof o=="string"?i=o:t===1?i=o.one:i=o.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function mL(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const CWe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},RWe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},NWe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},AWe={date:mL({formats:CWe,defaultWidth:"full"}),time:mL({formats:RWe,defaultWidth:"full"}),dateTime:mL({formats:NWe,defaultWidth:"full"})},IWe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},OWe=(e,t,n,i)=>IWe[e];function pE(e){return(t,n)=>{const i=n!=null&&n.context?String(n.context):"standalone";let o;if(i==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,p=n!=null&&n.width?String(n.width):h;o=e.formattingValues[p]||e.formattingValues[h]}else{const h=e.defaultWidth,p=n!=null&&n.width?String(n.width):e.defaultWidth;o=e.values[p]||e.values[h]}const u=e.argumentCallback?e.argumentCallback(t):t;return o[u]}}const PWe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kWe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},jWe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},DWe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},LWe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},MWe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},UWe=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},FWe={ordinalNumber:UWe,era:pE({values:PWe,defaultWidth:"wide"}),quarter:pE({values:kWe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:pE({values:jWe,defaultWidth:"wide"}),day:pE({values:DWe,defaultWidth:"wide"}),dayPeriod:pE({values:LWe,defaultWidth:"wide",formattingValues:MWe,defaultFormattingWidth:"wide"})};function mE(e){return(t,n={})=>{const i=n.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],u=t.match(o);if(!u)return null;const h=u[0],p=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],g=Array.isArray(p)?BWe(p,E=>E.test(h)):VWe(p,E=>E.test(h));let v;v=e.valueCallback?e.valueCallback(g):g,v=n.valueCallback?n.valueCallback(v):v;const b=t.slice(h.length);return{value:v,rest:b}}}function VWe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function BWe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function $We(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const o=i[0],u=t.match(e.parsePattern);if(!u)return null;let h=e.valueCallback?e.valueCallback(u[0]):u[0];h=n.valueCallback?n.valueCallback(h):h;const p=t.slice(o.length);return{value:h,rest:p}}}const WWe=/^(\d+)(th|st|nd|rd)?/i,GWe=/\d+/i,HWe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},zWe={any:[/^b/i,/^(a|c)/i]},KWe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qWe={any:[/1/i,/2/i,/3/i,/4/i]},YWe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},XWe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},JWe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ZWe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},QWe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},eGe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},tGe={ordinalNumber:$We({matchPattern:WWe,parsePattern:GWe,valueCallback:e=>parseInt(e,10)}),era:mE({matchPatterns:HWe,defaultMatchWidth:"wide",parsePatterns:zWe,defaultParseWidth:"any"}),quarter:mE({matchPatterns:KWe,defaultMatchWidth:"wide",parsePatterns:qWe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:mE({matchPatterns:YWe,defaultMatchWidth:"wide",parsePatterns:XWe,defaultParseWidth:"any"}),day:mE({matchPatterns:JWe,defaultMatchWidth:"wide",parsePatterns:ZWe,defaultParseWidth:"any"}),dayPeriod:mE({matchPatterns:QWe,defaultMatchWidth:"any",parsePatterns:eGe,defaultParseWidth:"any"})},nGe={code:"en-US",formatDistance:TWe,formatLong:AWe,formatRelative:OWe,localize:FWe,match:tGe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function rGe(e){const t=Gl(e);return _We(t,SWe(t))+1}function iGe(e){const t=Gl(e),n=+BN(t)-+bWe(t);return Math.round(n/khe)+1}function Dhe(e,t){var b,E,T,C;const n=Gl(e),i=n.getFullYear(),o=eI(),u=(t==null?void 0:t.firstWeekContainsDate)??((E=(b=t==null?void 0:t.locale)==null?void 0:b.options)==null?void 0:E.firstWeekContainsDate)??o.firstWeekContainsDate??((C=(T=o.locale)==null?void 0:T.options)==null?void 0:C.firstWeekContainsDate)??1,h=um(e,0);h.setFullYear(i+1,0,u),h.setHours(0,0,0,0);const p=B0(h,t),g=um(e,0);g.setFullYear(i,0,u),g.setHours(0,0,0,0);const v=B0(g,t);return n.getTime()>=p.getTime()?i+1:n.getTime()>=v.getTime()?i:i-1}function aGe(e,t){var p,g,v,b;const n=eI(),i=(t==null?void 0:t.firstWeekContainsDate)??((g=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??n.firstWeekContainsDate??((b=(v=n.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,o=Dhe(e,t),u=um(e,0);return u.setFullYear(o,0,i),u.setHours(0,0,0,0),B0(u,t)}function sGe(e,t){const n=Gl(e),i=+B0(n,t)-+aGe(n,t);return Math.round(i/khe)+1}function Fr(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const Dh={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return Fr(t==="yy"?i%100:i,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Fr(n+1,2)},d(e,t){return Fr(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Fr(e.getHours()%12||12,t.length)},H(e,t){return Fr(e.getHours(),t.length)},m(e,t){return Fr(e.getMinutes(),t.length)},s(e,t){return Fr(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),o=Math.trunc(i*Math.pow(10,n-3));return Fr(o,t.length)}},sv={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},HQ={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const i=e.getFullYear(),o=i>0?i:1-i;return n.ordinalNumber(o,{unit:"year"})}return Dh.y(e,t)},Y:function(e,t,n,i){const o=Dhe(e,i),u=o>0?o:1-o;if(t==="YY"){const h=u%100;return Fr(h,2)}return t==="Yo"?n.ordinalNumber(u,{unit:"year"}):Fr(u,t.length)},R:function(e,t){const n=jhe(e);return Fr(n,t.length)},u:function(e,t){const n=e.getFullYear();return Fr(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Fr(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Fr(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return Dh.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Fr(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const o=sGe(e,i);return t==="wo"?n.ordinalNumber(o,{unit:"week"}):Fr(o,t.length)},I:function(e,t,n){const i=iGe(e);return t==="Io"?n.ordinalNumber(i,{unit:"week"}):Fr(i,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Dh.d(e,t)},D:function(e,t,n){const i=rGe(e);return t==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Fr(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const o=e.getDay(),u=(o-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(u);case"ee":return Fr(u,2);case"eo":return n.ordinalNumber(u,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const o=e.getDay(),u=(o-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(u);case"cc":return Fr(u,t.length);case"co":return n.ordinalNumber(u,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),o=i===0?7:i;switch(t){case"i":return String(o);case"ii":return Fr(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const o=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let o;switch(i===12?o=sv.noon:i===0?o=sv.midnight:o=i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let o;switch(i>=17?o=sv.evening:i>=12?o=sv.afternoon:i>=4?o=sv.morning:o=sv.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Dh.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Dh.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return t==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Fr(i,t.length)},k:function(e,t,n){let i=e.getHours();return i===0&&(i=24),t==="ko"?n.ordinalNumber(i,{unit:"hour"}):Fr(i,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Dh.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Dh.s(e,t)},S:function(e,t){return Dh.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return KQ(i);case"XXXX":case"XX":return kp(i);case"XXXXX":case"XXX":default:return kp(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return KQ(i);case"xxxx":case"xx":return kp(i);case"xxxxx":case"xxx":default:return kp(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+zQ(i,":");case"OOOO":default:return"GMT"+kp(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+zQ(i,":");case"zzzz":default:return"GMT"+kp(i,":")}},t:function(e,t,n){const i=Math.trunc(e.getTime()/1e3);return Fr(i,t.length)},T:function(e,t,n){const i=e.getTime();return Fr(i,t.length)}};function zQ(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),o=Math.trunc(i/60),u=i%60;return u===0?n+String(o):n+String(o)+t+Fr(u,2)}function KQ(e,t){return e%60===0?(e>0?"-":"+")+Fr(Math.abs(e)/60,2):kp(e,t)}function kp(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),o=Fr(Math.trunc(i/60),2),u=Fr(i%60,2);return n+o+t+u}const qQ=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Lhe=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},oGe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],o=n[2];if(!o)return qQ(e,t);let u;switch(i){case"P":u=t.dateTime({width:"short"});break;case"PP":u=t.dateTime({width:"medium"});break;case"PPP":u=t.dateTime({width:"long"});break;case"PPPP":default:u=t.dateTime({width:"full"});break}return u.replace("{{date}}",qQ(i,t)).replace("{{time}}",Lhe(o,t))},cGe={p:Lhe,P:oGe},lGe=/^D+$/,uGe=/^Y+$/,dGe=["D","DD","YY","YYYY"];function hGe(e){return lGe.test(e)}function fGe(e){return uGe.test(e)}function pGe(e,t,n){const i=mGe(e,t,n);if(console.warn(i),dGe.includes(e))throw new RangeError(i)}function mGe(e,t,n){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const gGe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vGe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yGe=/^'([^]*?)'?$/,_Ge=/''/g,bGe=/[a-zA-Z]/;function Ad(e,t,n){var b,E,T,C;const i=eI(),o=i.locale??nGe,u=i.firstWeekContainsDate??((E=(b=i.locale)==null?void 0:b.options)==null?void 0:E.firstWeekContainsDate)??1,h=i.weekStartsOn??((C=(T=i.locale)==null?void 0:T.options)==null?void 0:C.weekStartsOn)??0,p=Gl(e);if(!wWe(p))throw new RangeError("Invalid time value");let g=t.match(vGe).map(R=>{const N=R[0];if(N==="p"||N==="P"){const O=cGe[N];return O(R,o.formatLong)}return R}).join("").match(gGe).map(R=>{if(R==="''")return{isToken:!1,value:"'"};const N=R[0];if(N==="'")return{isToken:!1,value:EGe(R)};if(HQ[N])return{isToken:!0,value:R};if(N.match(bGe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:R}});o.localize.preprocessor&&(g=o.localize.preprocessor(p,g));const v={firstWeekContainsDate:u,weekStartsOn:h,locale:o};return g.map(R=>{if(!R.isToken)return R.value;const N=R.value;(fGe(N)||hGe(N))&&pGe(N,t,String(e));const O=HQ[N[0]];return O(p,N,o.localize,v)}).join("")}function EGe(e){const t=e.match(yGe);return t?t[1].replace(_Ge,"'"):e}const ya=w.forwardRef(({className:e,...t},n)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:n,className:jt("w-full caption-bottom text-sm",e),...t})}));ya.displayName="Table";const _a=w.forwardRef(({className:e,...t},n)=>c.jsx("thead",{ref:n,className:jt("[&_tr]:border-b",e),...t}));_a.displayName="TableHeader";const ba=w.forwardRef(({className:e,...t},n)=>c.jsx("tbody",{ref:n,className:jt("[&_tr:last-child]:border-0",e),...t}));ba.displayName="TableBody";const wGe=w.forwardRef(({className:e,...t},n)=>c.jsx("tfoot",{ref:n,className:jt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));wGe.displayName="TableFooter";const tn=w.forwardRef(({className:e,...t},n)=>c.jsx("tr",{ref:n,className:jt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));tn.displayName="TableRow";const nt=w.forwardRef(({className:e,...t},n)=>c.jsx("th",{ref:n,className:jt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));nt.displayName="TableHead";const Ke=w.forwardRef(({className:e,...t},n)=>c.jsx("td",{ref:n,className:jt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ke.displayName="TableCell";const SGe=w.forwardRef(({className:e,...t},n)=>c.jsx("caption",{ref:n,className:jt("mt-4 text-sm text-muted-foreground",e),...t}));SGe.displayName="TableCaption";const Mhe="https://api.gada.chat";async function xGe(e,t){const n=await fetch(`${Mhe}/api/wallet/withdrawals`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function YQ(e){const t=await fetch(`${Mhe}/api/wallet/withdrawals`,{headers:e});if(!t.ok)throw new Error(await t.text());return await t.json()}function TGe({headers:e,balance:t,refreshBalance:n}){const[i,o]=w.useState(""),[u,h]=w.useState("bank"),[p,g]=w.useState(""),[v,b]=w.useState(!1),[E,T]=w.useState([]),[C,R]=w.useState(!0),[N,O]=w.useState(1),[j]=w.useState(10),[k,P]=w.useState(!1),[M,D]=w.useState(""),[U,F]=w.useState(""),[H,W]=w.useState("all"),[q,Y]=w.useState("all"),[z,Z]=w.useState(""),X=w.useRef(null);w.useEffect(()=>{X.current&&window.clearTimeout(X.current),X.current=window.setTimeout(()=>{ae()},300)},[M,U,H,q,z]),w.useEffect(()=>{ae()},[e]);const ae=async()=>{R(!0);try{const ve=await YQ(e,{page:1,pageSize:j,startDate:M||void 0,endDate:U||void 0,status:H,method:q,q:z||void 0});console.log(ve,"resprespresp"),T(ve.data),O(ve.page),P(ve.hasMore)}catch(ve){console.error(ve),Ce.error("Failed to load history")}finally{R(!1)}},se=async()=>{if(k)try{const ve=await YQ(e,{page:N+1,pageSize:j,startDate:M||void 0,endDate:U||void 0,status:H,method:q,q:z||void 0});T(Te=>[...Te,...ve.data]),O(ve.page),P(ve.hasMore)}catch(ve){console.error(ve),Ce.error("Failed to load more")}},J=()=>{D(""),F(""),W("all"),Y("all"),Z("")},re=1e3,ee=w.useMemo(()=>{const ve=Number(i||0);return!ve||ve<re||!p.trim()||v},[i,p,v]),de=async ve=>{ve.preventDefault();const Te=Number(i||0);if(!Te||Te<=0)return Ce.error("Enter a valid amount");if(Te<re)return Ce.error(`Minimum withdrawal is ₦${re}`);if(!p.trim())return Ce.error("Please fill ‘Transfer To’");try{b(!0),await xGe(e,{amount:Te,method:u,transferTo:p.trim()}),Ce.success("Withdrawal request submitted"),o(""),g(""),await(n==null?void 0:n()),await ae()}catch(Pe){console.error(Pe),Ce.error("Failed to submit request")}finally{b(!1)}},xe=ve=>`₦${(isNaN(ve)?0:ve).toLocaleString(void 0,{maximumFractionDigits:2})}`;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex items-center gap-4",children:[c.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:c.jsx(P0,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Your Balance"}),c.jsx("p",{className:"text-2xl font-semibold",children:xe(t||0)})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Withdrawal Method"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors ${u==="bank"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"withdrawMethod",className:"hidden",value:"bank",checked:u==="bank",onChange:()=>h("bank")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-emerald-100 flex items-center justify-center",children:c.jsx(ON,{className:"h-5 w-5 text-emerald-600"})}),c.jsx("span",{className:"font-medium",children:"Bank Transfer"})]}),c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors ${u==="gada_token"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"withdrawMethod",className:"hidden",value:"gada_token",checked:u==="gada_token",onChange:()=>h("gada_token")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-yellow-100 flex items-center justify-center",children:c.jsx(qce,{className:"h-5 w-5 text-yellow-700"})}),c.jsx("span",{className:"font-medium",children:"gada token"})]})]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Amount (₦)"}),c.jsx(Ae,{type:"number",min:1,inputMode:"numeric",value:i,onChange:ve=>o(ve.target.value===""?"":Number(ve.target.value)),placeholder:"Enter amount",className:"h-11"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["The minimum withdrawal request amount is ",`₦${re.toLocaleString()}`]})]})})]}),c.jsx("form",{onSubmit:de,className:"bg-white rounded-lg shadow p-6 space-y-3",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:items-end",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Transfer To"}),c.jsx(Ae,{value:p,onChange:ve=>g(ve.target.value),placeholder:u==="bank"?"e.g., 2027267123, Kuda Bank, Account Name":"e.g., 0xYourTokenAddress",className:"h-11"})]}),c.jsx("div",{className:"flex md:justify-end",children:c.jsx(be,{type:"submit",className:"h-11 w-full md:w-auto",disabled:ee,children:v?"Submitting...":"Make a withdrawal"})})]})}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 md:items-end",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),c.jsx(Ae,{type:"date",value:M,onChange:ve=>D(ve.target.value),max:Ad(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"End Date"}),c.jsx(Ae,{type:"date",value:U,onChange:ve=>F(ve.target.value),max:Ad(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Method"}),c.jsxs("select",{className:"h-11 w-full border rounded-md px-3",value:q,onChange:ve=>Y(ve.target.value),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"bank",children:"Bank"}),c.jsx("option",{value:"gada_token",children:"gada token"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Status"}),c.jsxs("select",{className:"h-11 w-full border rounded-md px-3",value:H,onChange:ve=>W(ve.target.value),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"0",children:"Pending"}),c.jsx("option",{value:"1",children:"Approved"}),c.jsx("option",{value:"-1",children:"Declined"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Search (Transfer To)"}),c.jsx(Ae,{value:z,onChange:ve=>Z(ve.target.value),placeholder:"e.g., bank name / address",className:"h-11"})]})]}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(be,{variant:"secondary",className:"h-11",onClick:J,children:"Clear"})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Withdrawal History"}),C?c.jsx("div",{className:"flex justify-center py-10",children:c.jsxs("svg",{className:"animate-spin h-6 w-6 text-gray-500",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}):c.jsxs(c.Fragment,{children:[E&&c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"ID"}),c.jsx(nt,{children:"Amount"}),c.jsx(nt,{children:"Method"}),c.jsx(nt,{children:"Transfer To"}),c.jsx(nt,{children:"Time"}),c.jsx(nt,{children:"Status"})]})}),c.jsxs(ba,{children:[E.map(ve=>c.jsxs(tn,{children:[c.jsx(Ke,{children:ve.id}),c.jsx(Ke,{children:xe(Number(ve.amount))}),c.jsx(Ke,{className:"capitalize",children:ve.method}),c.jsx(Ke,{className:"truncate max-w-[260px]",title:ve.transferTo,children:ve.transferTo}),c.jsx(Ke,{children:new Date(ve.time).toLocaleString()}),c.jsxs(Ke,{children:[ve.status===1&&c.jsx("span",{className:"px-2 py-1 text-xs rounded bg-emerald-100 text-emerald-700",children:"Approved"}),ve.status===0&&c.jsx("span",{className:"px-2 py-1 text-xs rounded bg-amber-100 text-amber-700",children:"Pending"}),ve.status===-1&&c.jsx("span",{className:"px-2 py-1 text-xs rounded bg-rose-100 text-rose-700",children:"Declined"})]})]},ve.id)),E.length===0&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:6,className:"text-center text-gray-500 py-10",children:"No withdrawal requests found."})})]})]}),k&&c.jsx("div",{className:"flex justify-center mt-6",children:c.jsx(be,{onClick:se,className:"h-11 px-6",children:"Load more"})})]})]})]})}const CGe="https://api.gada.chat";function RGe(){const{user:e,accessToken:t}=ct(),n=St(t),i=Bl(t),[o,u]=w.useState([]),[h,p]=w.useState(!0),g=20,[v,b]=w.useState(1),[E,T]=w.useState(!1),[C,R]=w.useState(!1),[N,O]=w.useState({user_wallet_balance:0,user_points:0}),[j,k]=w.useState(""),[P,M]=w.useState(""),[D,U]=w.useState(""),[F,H]=w.useState([]),[W,q]=w.useState(!1),[Y,z]=w.useState("paystack"),[Z,X]=w.useState(!1),[ae,se]=w.useState(!1),[J,re]=w.useState("wallet"),[ee,de]=w.useState(null),[xe,ve]=w.useState(!1),Te=Number((F==null?void 0:F.payment_vat_percentage)||2),Pe=Number((F==null?void 0:F.payment_fees_percentage)||6),qe=Number(D||0),st=w.useMemo(()=>+(qe*(Te/100)).toFixed(2),[qe]),ze=w.useMemo(()=>+(qe*(Pe/100)).toFixed(2),[qe]),ft=w.useMemo(()=>+(qe+st+ze).toFixed(2),[qe,st,ze]),$e=async()=>{if(t){p(!0);try{const ut=await xQ(n,{page:1,pageSize:g,startDate:j||void 0,endDate:P||void 0});u(ut.data),b(ut.page),T(ut.hasMore)}catch(ut){console.error(ut),Ce.error("Failed to load transactions")}finally{p(!1)}}},at=async()=>{if(!(!E||C)){R(!0);try{const ut=await xQ(n,{page:v+1,pageSize:g,startDate:j||void 0,endDate:P||void 0});u(wt=>[...wt,...ut.data]),b(ut.page),T(ut.hasMore)}catch(ut){console.error(ut),Ce.error("Failed to load more")}finally{R(!1)}}};w.useEffect(()=>{t&&($e(),BR(n).then(O).catch(console.error),_$e(n).then(H).catch(console.error))},[t]),w.useEffect(()=>{$e()},[j,P]);const ke=ut=>`₦${(isNaN(ut)?0:ut).toLocaleString(void 0,{maximumFractionDigits:2})}`,je=ut=>{ut.preventDefault();const wt=Number(D);!wt||wt<=0||X(!0)},Pt=async()=>{const ut=ft;if(Y==="bank"){X(!1),se(!0);return}if(e!=null&&e.email){q(!0);try{const{authorization_url:wt,reference:Rt}=await Mde(e.email,ut,{userId:e.id,method:"paystack",baseAmount:qe});console.log(wt,Rt,"fjskdfjlskdjflsdkf"),window.location.href=wt}catch(wt){console.error(wt),alert("Could not initiate Paystack payment")}finally{q(!1),X(!1)}}},Dt=async()=>{if(!(!e||!ee)){ve(!0);try{const ut=new FormData;ut.append("userId",String(e.id)),ut.append("amount",String(ft)),ut.append("baseAmount",String(qe)),ut.append("vat",String(st)),ut.append("fees",String(ze)),ut.append("method","bank"),ut.append("receipt",ee),await fetch(CGe+"/api/payments/bank-transfer/receipt",{method:"POST",headers:{...i},body:ut}),Ce.success("Receipt submitted. We’ll verify within 48 hours."),de(null),se(!1),U(""),$e(),BR(n).then(O).catch(console.error)}catch(ut){console.error(ut),alert("Failed to submit receipt. Please try again.")}finally{ve(!1)}}},cn={bank_name:(F==null?void 0:F.bank_name)||"moniepoint MFB",account_number:(F==null?void 0:F.bank_account_number)||"5329604228",account_name:(F==null?void 0:F.bank_account_name)||"mega fruitful vine services limited",country:(F==null?void 0:F.bank_account_country)||"nigeria"};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx(Ss,{})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsx("div",{className:"bg-white",children:c.jsxs("nav",{className:"flex gap-8 px-6",children:[c.jsx("button",{type:"button",className:`py-4 border-b-2 font-medium ${J==="wallet"?"text-blue-600 border-blue-600":"text-gray-600 hover:text-gray-900 border-transparent"}`,onClick:()=>re("wallet"),children:"Wallet"}),c.jsx("button",{type:"button",className:`py-4 border-b-2 font-medium ${J==="payments"?"text-blue-600 border-blue-600":"text-gray-600 hover:text-gray-900 border-transparent"}`,onClick:()=>re("payments"),children:"Payments"})]})}),J==="wallet"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex items-center gap-4",children:[c.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-100 flex items-center justify-center",children:c.jsx(P0,{className:"h-5 w-5 text-gray-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Your Credit"}),c.jsx("p",{className:"text-2xl font-semibold",children:ke(N.user_wallet_balance)})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Payment Method"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors
                        ${Y==="paystack"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"paymentMethod",className:"hidden",value:"paystack",checked:Y==="paystack",onChange:()=>z("paystack")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-sky-100 flex items-center justify-center",children:c.jsx(P0,{className:"h-5 w-5 text-sky-600"})}),c.jsx("span",{className:"font-medium",children:"Paystack"})]}),c.jsxs("label",{className:`flex items-center gap-3 border rounded-lg px-4 py-3 cursor-pointer transition-colors
                        ${Y==="bank"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"paymentMethod",className:"hidden",value:"bank",checked:Y==="bank",onChange:()=>z("bank")}),c.jsx("div",{className:"h-9 w-9 rounded-md bg-emerald-100 flex items-center justify-center",children:c.jsx(ON,{className:"h-5 w-5 text-emerald-600"})}),c.jsx("span",{className:"font-medium",children:"Bank Transfer"})]})]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("form",{onSubmit:je,className:"flex flex-col sm:flex-row gap-3 sm:items-end",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:"amount",className:"block text-sm text-gray-600 mb-1",children:"Amount (₦)"}),c.jsx(Ae,{id:"amount",type:"number",min:"1",inputMode:"numeric",value:D,onChange:ut=>U(ut.target.value===""?"":Number(ut.target.value)),placeholder:"Enter amount",className:"h-11"})]}),c.jsx(be,{type:"submit",disabled:W||!D||Number(D)<=0,className:"h-11 px-6 w-full sm:w-auto",children:W?"Processing…":"Pay ₦"})]})})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:items-end",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"startDate",className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),c.jsx(Ae,{id:"startDate",type:"date",value:j,onChange:ut=>k(ut.target.value),max:Ad(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"endDate",className:"block text-sm text-gray-600 mb-1",children:"End Date"}),c.jsx(Ae,{id:"endDate",type:"date",value:P,onChange:ut=>M(ut.target.value),max:Ad(new Date,"yyyy-MM-dd"),className:"h-11"})]}),c.jsx("div",{className:"flex sm:justify-end",children:c.jsx(be,{type:"button",variant:"secondary",onClick:()=>{k(""),M("")},className:"h-11 w-full sm:w-auto",children:"Clear"})})]})}),c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:h?c.jsx("div",{className:"flex justify-center py-10",children:c.jsxs("svg",{className:"animate-spin h-6 w-6 text-gray-500",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"max-h-[420px] overflow-y-auto pr-2",children:c.jsxs(ya,{children:[c.jsx(_a,{className:"sticky top-0 bg-white",children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Date"}),c.jsx(nt,{children:"Type"}),c.jsx(nt,{className:"text-right",children:"Amount (₦)"})]})}),c.jsxs(ba,{children:[o.map(ut=>c.jsxs(tn,{children:[c.jsx(Ke,{children:Ad(new Date(ut.createdAt),"MMM d, yyyy")}),c.jsx(Ke,{className:"capitalize",children:ut.type}),c.jsx(Ke,{className:"text-right",children:ut.amount.toLocaleString()})]},ut.id)),o.length===0&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:3,className:"text-center text-gray-500 py-10",children:"No transactions found."})})]})]})}),E&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:at,disabled:C,className:"h-11 px-6",children:C?"Loading...":"Load more"})})]})})]}),J==="payments"&&c.jsx(TGe,{headers:n,balance:N.user_wallet_balance,refreshBalance:()=>BR(n).then(O).catch(console.error)})]})]})}),c.jsx(Ko,{open:Z,onOpenChange:X,children:c.jsxs(mo,{className:"sm:max-w-md",children:[c.jsx(qo,{children:c.jsx(Yo,{children:"Payment"})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Amount"}),c.jsx("span",{children:qe||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:["VAT +%",Te]}),c.jsx("span",{children:st})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:["Fees +%",Pe]}),c.jsx("span",{children:ze})]}),c.jsx(L0,{}),c.jsxs("div",{className:"flex justify-between font-semibold",children:[c.jsx("span",{children:"Total"}),c.jsx("span",{className:"text-gray-900",children:ke(ft)})]})]}),c.jsxs(lm,{className:"mt-6",children:[c.jsx(be,{variant:"secondary",onClick:()=>X(!1),children:"Cancel"}),c.jsx(be,{onClick:Pt,disabled:W,children:"Continue"})]})]})}),c.jsx(Ko,{open:ae,onOpenChange:se,children:c.jsxs(mo,{className:"sm:max-w-2xl",children:[c.jsx(qo,{children:c.jsxs(Yo,{className:"flex items-center gap-2",children:[c.jsx(ON,{className:"h-5 w-5"})," Bank Transfer"]})}),c.jsxs("div",{className:"rounded-xl border bg-gradient-to-b from-blue-600 to-blue-500 text-white p-6",children:[c.jsx("div",{className:"text-xl font-semibold",children:cn.bank_name}),c.jsx("div",{className:"mt-4 text-2xl tracking-wide",children:cn.account_number}),c.jsx("div",{className:"mt-1 capitalize",children:cn.account_name}),c.jsx("div",{className:"mt-1 uppercase text-white/80",children:cn.country}),c.jsxs("div",{className:"mt-4 text-white/90",children:["Amount to pay: ",c.jsx("span",{className:"font-semibold",children:ke(ft)})]})]}),c.jsxs("div",{className:"mt-4 rounded-md bg-orange-50 border border-orange-200 p-4 text-sm text-orange-800",children:["In order to confirm the bank transfer, you will need to upload a receipt (or a screenshot) within ",c.jsx("strong",{children:"1 day"})," from your payment date. We will verify and confirm within ",c.jsx("strong",{children:"48 hours"})," after upload."]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bank Receipt"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ae,{type:"file",accept:"image/*,application/pdf",onChange:ut=>{var wt;return de(((wt=ut.target.files)==null?void 0:wt[0])||null)},className:"cursor-pointer"}),ee&&c.jsx("span",{className:"text-sm text-gray-600",children:ee.name})]})]}),c.jsxs(lm,{className:"mt-6",children:[c.jsx(be,{variant:"secondary",onClick:()=>se(!1),children:"Cancel"}),c.jsx(be,{onClick:Dt,disabled:!ee||xe,children:xe?"Sending...":"Send"})]})]})})]})}function NGe({onSelected:e}){const t=w.useRef(null),[n,i]=w.useState(null),o=()=>{var h;return(h=t.current)==null?void 0:h.click()},u=async h=>{var b;const p=(b=h.target.files)==null?void 0:b[0];if(!p)return;if(!["video/mp4","video/webm","video/quicktime"].includes(p.type)){i("Only MP4, WEBM or MOV allowed");return}if(p.size>50*1024*1024){i("Max 50MB");return}i(null);const g=URL.createObjectURL(p),v=document.createElement("video");v.preload="metadata",v.src=g,v.onloadedmetadata=()=>{const E=Math.round(v.duration||0);e(p,g,E)}};return c.jsxs("div",{className:"border-2 border-dashed rounded-xl p-6 text-center bg-white",children:[c.jsx("input",{ref:t,type:"file",accept:"video/*",className:"hidden",onChange:u}),c.jsx("p",{className:"text-gray-600 mb-3",children:"Upload reel (9:16, up to 90s / 50MB)"}),c.jsx(be,{onClick:o,children:"Add video"}),n&&c.jsx("p",{className:"text-red-600 mt-3 text-sm",children:n})]})}const Nm="https://api.gada.chat";async function Am(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error((t==null?void 0:t.error)||"Request failed");return t}async function AGe(e,t){const n=new FormData;n.append("files",e);const i=await fetch(`${Nm}/api/media/upload`,{method:"POST",body:n,headers:t,credentials:"include"}),{urls:o}=await Am(i);return o[0]}async function IGe(e,t){console.log(e,"inputinputinputinput");const n=await fetch(`${Nm}/api/reels`,{method:"POST",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"});return Am(n)}async function Uhe(e){const t=await fetch(`${Nm}/api/reels`,{headers:e,credentials:"include"});return Am(t)}async function Fhe(e,t){const n=await fetch(`${Nm}/api/reels/${e}/like`,{method:"POST",headers:t,credentials:"include"});return Am(n)}async function Vhe(e,t){const n=await fetch(`${Nm}/api/reels/${e}/share`,{method:"POST",headers:t,credentials:"include"});return Am(n)}async function OGe(e,t){const n=await fetch(`${Nm}/api/reels/${e}/comments`,{headers:t,credentials:"include"});return Am(n)}async function PGe(e,t,n){const i=await fetch(`${Nm}/api/reels/${e}/comments`,{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({content:t}),credentials:"include"});return Am(i)}function kGe(){const{accessToken:e}=ct(),t=St(e),n=Bl(e),[i,o]=w.useState(null),[u,h]=w.useState(""),[p,g]=w.useState(),[v,b]=w.useState(""),[E,T]=w.useState(!1),C=(N,O,j)=>{o(N),h(O),g(j)},R=async()=>{if(i){T(!0);try{const N=await AGe(i,n);console.log(N,"urlurlurlurl"),await IGe({videoUrl:N,caption:v},t),window.location.href="/reels"}catch(N){console.error(N)}finally{T(!1)}}};return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-1",children:[c.jsx(NGe,{onSelected:C}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Caption"}),c.jsx(Ae,{value:v,onChange:N=>b(N.target.value),placeholder:"Say something…"})]}),c.jsx(be,{onClick:R,disabled:!i||E,className:"mt-4 w-full",children:E?"Uploading…":"Next"})]}),c.jsx("div",{className:"lg:col-span-2",children:c.jsxs("div",{className:"bg-white rounded-xl p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Preview"}),c.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-xl min-h-[420px]",children:u?c.jsx("video",{src:u,className:"max-h-[80vh] aspect-[9/16]",controls:!0,playsInline:!0}):c.jsx("div",{className:"text-gray-500",children:"Upload your video to see preview here."})})]})})]})})]})})]})}const AU="https://api.gada.chat",gL=`${AU}/uploads//profile/defaultavatar.png`;function jGe({reel:e,onLike:t,onShare:n,active:i}){const o=w.useRef(null),{accessToken:u}=ct(),h=St(u),[p,g]=w.useState([]),[v,b]=w.useState(!1),[E,T]=w.useState("");w.useEffect(()=>{o.current&&(i?o.current.play().catch(()=>{}):(o.current.pause(),o.current.currentTime=0))},[i]);const C=async()=>{const j=await OGe(e.id,h);g(j)},R=()=>{b(j=>{const k=!j;return k&&p.length===0&&C().catch(console.error),k})},N=async j=>{if(j.preventDefault(),!E.trim())return;const k=await PGe(e.id,E.trim(),h);g(P=>[...P,k]),T("")},O=j=>j?`${AU}/uploads/${Xn(j)}`:gL;return c.jsxs("div",{className:`mx-auto w-full md:max-w-[820px] ${v?"md:max-w-[820px]":"md:max-w-[480px]"}`,children:[c.jsxs("div",{className:v?"md:grid md:grid-cols-[420px,360px] md:gap-5":"",children:[c.jsxs("div",{className:"relative w-full max-w-[420px] aspect-[9/16] bg-black rounded-2xl overflow-hidden shadow-xl mx-auto",children:[c.jsx("video",{ref:o,src:`${AU}/uploads/${Xn(e.videoUrl)}`,className:"h-full w-full object-cover",playsInline:!0,muted:!0,loop:!0,controls:!1}),c.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-4 bg-gradient-to-t from-black/60 to-transparent text-white",children:[c.jsx("div",{className:"text-sm font-semibold",children:e.authorUsername}),e.caption&&c.jsx("div",{className:"text-sm opacity-90 line-clamp-2",children:e.caption})]}),c.jsxs("div",{className:"absolute right-3 bottom-24 flex flex-col items-center gap-4 text-white",children:[c.jsx("button",{onClick:()=>t(e.id),className:`p-3 rounded-full bg-black/50 hover:bg-black/60 ${e.hasLiked?"text-blue-400":""}`,children:c.jsx(D0,{})}),c.jsx("div",{className:"text-xs",children:e.likeCount}),c.jsx("button",{onClick:R,className:"p-3 rounded-full bg-black/50 hover:bg-black/60",children:c.jsx($w,{})}),c.jsx("div",{className:"text-xs",children:e.commentCount}),c.jsx("button",{onClick:()=>n(e.id),className:"p-3 rounded-full bg-black/50 hover:bg-black/60",children:c.jsx(A1,{})}),c.jsx("div",{className:"text-xs",children:e.shareCount})]})]}),v&&c.jsxs("aside",{className:"hidden md:flex flex-col h-[calc(100vh-160px)] w-[360px] bg-white rounded-2xl border shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("div",{className:"font-semibold",children:"Comments"}),c.jsx("button",{onClick:()=>b(!1),className:"p-1 rounded hover:bg-gray-100","aria-label":"Close comments",children:c.jsx(po,{className:"h-4 w-4"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:[p.length===0&&c.jsx("div",{className:"text-sm text-gray-500",children:"Be the first to comment"}),p.map(j=>c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("img",{src:O(j.profileImage),alt:j.username,className:"h-8 w-8 rounded-full object-cover border",onError:k=>k.currentTarget.src=gL}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium leading-none",children:j.username}),c.jsx("div",{className:"text-sm mt-1",children:j.content})]})]},j.id))]}),c.jsx("form",{onSubmit:N,className:"sticky bottom-0 bg-white border-t p-3",children:c.jsx("input",{value:E,onChange:j=>T(j.target.value),placeholder:"Write a comment…",className:"w-full border rounded-md px-3 py-2 text-sm"})})]})]}),v&&c.jsxs("div",{className:"md:hidden inset-x-0 bottom-0 h-[60vh] bg-white rounded-t-2xl z-50 shadow-2xl flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("div",{className:"font-semibold",children:"Comments"}),c.jsx("button",{onClick:()=>b(!1),className:"p-1 rounded hover:bg-gray-100","aria-label":"Close comments",children:c.jsx(po,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:[p.length===0&&c.jsx("div",{className:"text-sm text-gray-500",children:"Be the first to comment"}),p.map(j=>c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("img",{src:O(j.profileImage),alt:j.username,className:"h-8 w-8 rounded-full object-cover border",onError:k=>k.currentTarget.src=gL}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium leading-none",children:j.username}),c.jsx("div",{className:"text-sm mt-1",children:j.content})]})]},j.id))]}),c.jsx("form",{onSubmit:N,className:"sticky bottom-0 bg-white border-t p-3",children:c.jsx("input",{value:E,onChange:j=>T(j.target.value),placeholder:"Write a comment…",className:"w-full border rounded-md px-3 py-2 text-sm"})})]})]})}function DGe(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState([]),[o,u]=w.useState(0),h=w.useRef(null),p=w.useMemo(()=>[],[]);w.useEffect(()=>{e&&Uhe(t).then(i).catch(console.error)},[e]),w.useEffect(()=>{for(;p.length<n.length;)p.push({current:null});for(;p.length>n.length;)p.pop()},[n.length,p]),w.useEffect(()=>{const E=h.current;if(!E||n.length===0)return;const T=new IntersectionObserver(C=>{const R=C.filter(O=>O.isIntersecting).sort((O,j)=>j.intersectionRatio-O.intersectionRatio)[0];if(!R)return;const N=p.findIndex(O=>O.current===R.target);N!==-1&&u(N)},{root:E,threshold:[.3,.6,.9]});return p.forEach(C=>C.current&&T.observe(C.current)),()=>T.disconnect()},[n.length,p]);const g=E=>{var R;const T=h.current,C=(R=p[E])==null?void 0:R.current;!T||!C||T.scrollTo({top:C.offsetTop,behavior:"smooth"})};w.useEffect(()=>{const E=T=>{if(T.key==="ArrowDown"){const C=Math.min(o+1,n.length-1);g(C)}if(T.key==="ArrowUp"){const C=Math.max(o-1,0);g(C)}};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[o,n.length]);const v=async E=>{const{liked:T}=await Fhe(E,t);i(C=>C.map(R=>R.id===E?{...R,hasLiked:T,likeCount:R.likeCount+(T?1:-1)}:R))},b=async E=>{await Vhe(E,t),i(T=>T.map(C=>C.id===E?{...C,shareCount:C.shareCount+1}:C))};return c.jsxs("div",{className:"flex flex-col h-screen bg-black",children:[c.jsx(or,{}),c.jsxs(At,{to:"/reels/create",className:`fixed right-6 top-[88px] z-30 hidden md:inline-flex items-center gap-2 
             bg-white/90 hover:bg-white text-gray-900 px-3 py-2 rounded-full shadow`,children:[c.jsx(M4,{className:"h-4 w-4"})," Create reel"]}),c.jsx("div",{ref:h,className:"flex-1 overflow-y-scroll snap-y snap-mandatory",children:n.map((E,T)=>c.jsx("section",{ref:C=>p[T]={current:C},className:`
              snap-start
              h-[calc(100vh-72px)]   /* full height minus navbar */
              flex items-center justify-center
            `,children:c.jsx("div",{className:"w-full flex justify-center",children:c.jsx(jGe,{reel:E,onLike:v,onShare:b,active:T===o})})},E.id))}),n.length>1&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>g(Math.max(o-1,0)),className:"hidden md:flex absolute left-6 top-1/2 -translate-y-1/2 h-12 w-12 rounded-full bg-white/10 hover:bg-white/20 text-white items-center justify-center",children:"◂"}),c.jsx("button",{onClick:()=>g(Math.min(o+1,n.length-1)),className:"hidden md:flex absolute right-6 top-1/2 -translate-y-1/2 h-12 w-12 rounded-full bg-white/10 hover:bg-white/20 text-white items-center justify-center",children:"▸"})]})]})}const XQ="https://api.gada.chat";function LGe(){const{accessToken:e}=ct(),{items:t,unreadCount:n,loadMore:i,refresh:o,markAll:u}=Zde();return w.useEffect(()=>{e&&o().catch(console.error)},[e]),c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 overflow-y-auto",children:c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[c.jsx("h1",{className:"text-xl font-semibold",children:"Notifications"}),n>0&&c.jsx("button",{onClick:()=>u().catch(console.error),className:"text-sm text-blue-600 hover:underline",children:"Mark all as read"})]}),c.jsxs("ul",{className:"divide-y",children:[t.map(h=>c.jsx("li",{className:`p-4 ${h.readAt?"":"bg-blue-50"}`,children:c.jsx(MGe,{n:h})},h.id)),t.length===0&&c.jsx("li",{className:"p-10 text-center text-gray-500",children:"You have no notifications."})]}),c.jsx("div",{className:"p-4 text-center",children:c.jsx("button",{onClick:()=>i().catch(console.error),className:"text-blue-600 hover:underline",children:"Load more"})})]})})]})})]})}function MGe({n:e}){e.message||`${e.actorName}${JQ(e.type)}`;const t=e.meta&&e.meta.postId?`/posts/${e.meta.postId}`:"#";return c.jsxs(At,{to:t,className:"flex items-start gap-3",children:[c.jsx("img",{src:e.actorAvatar?XQ+"/uploads/"+Xn(e.actorAvatar):XQ+"/uploads//profile/defaultavatar.png",alt:"",className:"h-10 w-10 rounded-full object-cover"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:e.actorName})," ",JQ(e.type)]}),c.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),!e.readAt&&c.jsx("span",{className:"mt-2 h-2 w-2 bg-blue-600 rounded-full"})]})}function JQ(e){switch(e){case"post_like":return"liked your post";case"post_comment":return"commented on your post";case"friend_request":return"sent you a friend request";case"friend_accept":return"accepted your friend request";case"reel_like":return"liked your reel";case"new_message":return"sent new message.";default:return"sent you a notification"}}function UGe(){const{postId:e}=Qo();Bc();const{accessToken:t}=ct(),n=St(t),[i,o]=w.useState(null),[u,h]=w.useState(!0);return w.useEffect(()=>{e&&(h(!0),$ce(e,n).then(o).catch(console.error).finally(()=>h(!1)))},[e,t]),u?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(ei,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):i?c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsxs("div",{className:"sticky top-16",children:["   ",c.jsx(Ss,{})]})}),c.jsx("main",{className:"flex-1 overflow-y-auto py-6",children:c.jsx("div",{className:"max-w-4xl mx-auto",children:c.jsx(Vu,{post:i})})})]})})]}):c.jsx("div",{className:"p-8 text-center",children:"Post not found."})}const FGe=w.createContext(null);function VGe({children:e}){const{accessToken:t}=ct(),n=St(t),[i,o]=w.useState([]),u=w.useRef(0),h=async()=>{const v=await Uhe(n);u.current=10,o(v)};w.useEffect(()=>{t&&h().catch(console.error)},[t]);const p=async v=>{const{liked:b}=await Fhe(v,n);o(E=>E.map(T=>T.id===v?{...T,hasLiked:b,likeCount:T.likeCount+(b?1:-1)}:T))},g=async v=>{await Vhe(v,n),o(b=>b.map(E=>E.id===v?{...E,shareCount:E.shareCount+1}:E))};return c.jsx(FGe.Provider,{value:{reels:i,like:p,share:g,refresh:h},children:e})}const qd="https://api.gada.chat";async function BGe(e){const t=await fetch(`${qd}/api/settings/profile`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch profile");return t.json()}async function $Ge(e,t){const n=await fetch(`${qd}/api/settings/profile`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to update profile");return n.json()}async function WGe(e){const t=await fetch(`${qd}/api/settings/privacy`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch privacy");return t.json()}async function GGe(e,t){const n=await fetch(`${qd}/api/settings/privacy`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to update privacy");return n.json()}async function HGe(e){const t=await fetch(`${qd}/api/settings/notifications`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch notifications");return t.json()}async function zGe(e,t){const n=await fetch(`${qd}/api/settings/notifications`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw new Error("Failed to update notifications");return n.json()}async function KGe(e,t,n){const i=await fetch(`${qd}/api/settings/security/password`,{method:"PUT",headers:{...n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentPassword:e,newPassword:t})});if(!i.ok)throw new Error((await i.json()).error||"Failed to change password");return i.json()}async function qGe(e){const t=await fetch(`${qd}/api/settings/security/sessions`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch sessions");return t.json()}async function YGe(e,t){const n=await fetch(`${qd}/api/settings/security/sessions/${e}`,{method:"DELETE",headers:t,credentials:"include"});if(!n.ok)throw new Error("Failed to revoke session");return n.json()}const XGe=[{value:"AF",label:"Afghanistan"},{value:"AX",label:"Åland Islands"},{value:"AL",label:"Albania"},{value:"DZ",label:"Algeria"},{value:"AS",label:"American Samoa"},{value:"AD",label:"Andorra"},{value:"AO",label:"Angola"},{value:"AI",label:"Anguilla"},{value:"AQ",label:"Antarctica"},{value:"AG",label:"Antigua and Barbuda"},{value:"AR",label:"Argentina"},{value:"AM",label:"Armenia"},{value:"AW",label:"Aruba"},{value:"AU",label:"Australia"},{value:"AT",label:"Austria"},{value:"AZ",label:"Azerbaijan"},{value:"BS",label:"Bahamas"},{value:"BH",label:"Bahrain"},{value:"BD",label:"Bangladesh"},{value:"BB",label:"Barbados"},{value:"BY",label:"Belarus"},{value:"BE",label:"Belgium"},{value:"BZ",label:"Belize"},{value:"BJ",label:"Benin"},{value:"BM",label:"Bermuda"},{value:"BT",label:"Bhutan"},{value:"BO",label:"Bolivia, Plurinational State of"},{value:"BQ",label:"Bonaire, Sint Eustatius and Saba"},{value:"BA",label:"Bosnia and Herzegovina"},{value:"BW",label:"Botswana"},{value:"BV",label:"Bouvet Island"},{value:"BR",label:"Brazil"},{value:"IO",label:"British Indian Ocean Territory"},{value:"BN",label:"Brunei Darussalam"},{value:"BG",label:"Bulgaria"},{value:"BF",label:"Burkina Faso"},{value:"BI",label:"Burundi"},{value:"CV",label:"Cabo Verde"},{value:"KH",label:"Cambodia"},{value:"CM",label:"Cameroon"},{value:"CA",label:"Canada"},{value:"KY",label:"Cayman Islands"},{value:"CF",label:"Central African Republic"},{value:"TD",label:"Chad"},{value:"CL",label:"Chile"},{value:"CN",label:"China"},{value:"CX",label:"Christmas Island"},{value:"CC",label:"Cocos (Keeling) Islands"},{value:"CO",label:"Colombia"},{value:"KM",label:"Comoros"},{value:"CG",label:"Congo"},{value:"CD",label:"Congo, Democratic Republic of the"},{value:"CK",label:"Cook Islands"},{value:"CR",label:"Costa Rica"},{value:"HR",label:"Croatia"},{value:"CU",label:"Cuba"},{value:"CW",label:"Curaçao"},{value:"CY",label:"Cyprus"},{value:"CZ",label:"Czechia"},{value:"CI",label:"Côte d'Ivoire"},{value:"DK",label:"Denmark"},{value:"DJ",label:"Djibouti"},{value:"DM",label:"Dominica"},{value:"DO",label:"Dominican Republic"},{value:"EC",label:"Ecuador"},{value:"EG",label:"Egypt"},{value:"SV",label:"El Salvador"},{value:"GQ",label:"Equatorial Guinea"},{value:"ER",label:"Eritrea"},{value:"EE",label:"Estonia"},{value:"SZ",label:"Eswatini"},{value:"ET",label:"Ethiopia"},{value:"FK",label:"Falkland Islands (Malvinas)"},{value:"FO",label:"Faroe Islands"},{value:"FJ",label:"Fiji"},{value:"FI",label:"Finland"},{value:"FR",label:"France"},{value:"GF",label:"French Guiana"},{value:"PF",label:"French Polynesia"},{value:"TF",label:"French Southern Territories"},{value:"GA",label:"Gabon"},{value:"GM",label:"Gambia"},{value:"GE",label:"Georgia"},{value:"DE",label:"Germany"},{value:"GH",label:"Ghana"},{value:"GI",label:"Gibraltar"},{value:"GR",label:"Greece"},{value:"GL",label:"Greenland"},{value:"GD",label:"Grenada"},{value:"GP",label:"Guadeloupe"},{value:"GU",label:"Guam"},{value:"GT",label:"Guatemala"},{value:"GG",label:"Guernsey"},{value:"GN",label:"Guinea"},{value:"GW",label:"Guinea-Bissau"},{value:"GY",label:"Guyana"},{value:"HT",label:"Haiti"},{value:"HM",label:"Heard Island and McDonald Islands"},{value:"VA",label:"Holy See"},{value:"HN",label:"Honduras"},{value:"HK",label:"Hong Kong"},{value:"HU",label:"Hungary"},{value:"IS",label:"Iceland"},{value:"IN",label:"India"},{value:"ID",label:"Indonesia"},{value:"IR",label:"Iran, Islamic Republic of"},{value:"IQ",label:"Iraq"},{value:"IE",label:"Ireland"},{value:"IM",label:"Isle of Man"},{value:"IL",label:"Israel"},{value:"IT",label:"Italy"},{value:"JM",label:"Jamaica"},{value:"JP",label:"Japan"},{value:"JE",label:"Jersey"},{value:"JO",label:"Jordan"},{value:"KZ",label:"Kazakhstan"},{value:"KE",label:"Kenya"},{value:"KI",label:"Kiribati"},{value:"KP",label:"Korea, Democratic People's Republic of"},{value:"KR",label:"Korea, Republic of"},{value:"KW",label:"Kuwait"},{value:"KG",label:"Kyrgyzstan"},{value:"LA",label:"Lao People's Democratic Republic"},{value:"LV",label:"Latvia"},{value:"LB",label:"Lebanon"},{value:"LS",label:"Lesotho"},{value:"LR",label:"Liberia"},{value:"LY",label:"Libya"},{value:"LI",label:"Liechtenstein"},{value:"LT",label:"Lithuania"},{value:"LU",label:"Luxembourg"},{value:"MO",label:"Macao"},{value:"MG",label:"Madagascar"},{value:"MW",label:"Malawi"},{value:"MY",label:"Malaysia"},{value:"MV",label:"Maldives"},{value:"ML",label:"Mali"},{value:"MT",label:"Malta"},{value:"MH",label:"Marshall Islands"},{value:"MQ",label:"Martinique"},{value:"MR",label:"Mauritania"},{value:"MU",label:"Mauritius"},{value:"YT",label:"Mayotte"},{value:"MX",label:"Mexico"},{value:"FM",label:"Micronesia, Federated States of"},{value:"MD",label:"Moldova, Republic of"},{value:"MC",label:"Monaco"},{value:"MN",label:"Mongolia"},{value:"ME",label:"Montenegro"},{value:"MS",label:"Montserrat"},{value:"MA",label:"Morocco"},{value:"MZ",label:"Mozambique"},{value:"MM",label:"Myanmar"},{value:"NA",label:"Namibia"},{value:"NR",label:"Nauru"},{value:"NP",label:"Nepal"},{value:"NL",label:"Netherlands"},{value:"NC",label:"New Caledonia"},{value:"NZ",label:"New Zealand"},{value:"NI",label:"Nicaragua"},{value:"NE",label:"Niger"},{value:"NG",label:"Nigeria"},{value:"NU",label:"Niue"},{value:"NF",label:"Norfolk Island"},{value:"MK",label:"North Macedonia"},{value:"MP",label:"Northern Mariana Islands"},{value:"NO",label:"Norway"},{value:"OM",label:"Oman"},{value:"PK",label:"Pakistan"},{value:"PW",label:"Palau"},{value:"PS",label:"Palestine, State of"},{value:"PA",label:"Panama"},{value:"PG",label:"Papua New Guinea"},{value:"PY",label:"Paraguay"},{value:"PE",label:"Peru"},{value:"PH",label:"Philippines"},{value:"PN",label:"Pitcairn"},{value:"PL",label:"Poland"},{value:"PT",label:"Portugal"},{value:"PR",label:"Puerto Rico"},{value:"QA",label:"Qatar"},{value:"RO",label:"Romania"},{value:"RU",label:"Russian Federation"},{value:"RW",label:"Rwanda"},{value:"RE",label:"Réunion"},{value:"BL",label:"Saint Barthélemy"},{value:"SH",label:"Saint Helena, Ascension and Tristan da Cunha"},{value:"KN",label:"Saint Kitts and Nevis"},{value:"LC",label:"Saint Lucia"},{value:"MF",label:"Saint Martin (French part)"},{value:"PM",label:"Saint Pierre and Miquelon"},{value:"VC",label:"Saint Vincent and the Grenadines"},{value:"WS",label:"Samoa"},{value:"SM",label:"San Marino"},{value:"ST",label:"Sao Tome and Principe"},{value:"SA",label:"Saudi Arabia"},{value:"SN",label:"Senegal"},{value:"RS",label:"Serbia"},{value:"SC",label:"Seychelles"},{value:"SL",label:"Sierra Leone"},{value:"SG",label:"Singapore"},{value:"SX",label:"Sint Maarten (Dutch part)"},{value:"SK",label:"Slovakia"},{value:"SI",label:"Slovenia"},{value:"SB",label:"Solomon Islands"},{value:"SO",label:"Somalia"},{value:"ZA",label:"South Africa"},{value:"GS",label:"South Georgia and the South Sandwich Islands"},{value:"SS",label:"South Sudan"},{value:"ES",label:"Spain"},{value:"LK",label:"Sri Lanka"},{value:"SD",label:"Sudan"},{value:"SR",label:"Suriname"},{value:"SJ",label:"Svalbard and Jan Mayen"},{value:"SE",label:"Sweden"},{value:"CH",label:"Switzerland"},{value:"SY",label:"Syrian Arab Republic"},{value:"TW",label:"Taiwan, Province of China"},{value:"TJ",label:"Tajikistan"},{value:"TZ",label:"Tanzania, United Republic of"},{value:"TH",label:"Thailand"},{value:"TL",label:"Timor-Leste"},{value:"TG",label:"Togo"},{value:"TK",label:"Tokelau"},{value:"TO",label:"Tonga"},{value:"TT",label:"Trinidad and Tobago"},{value:"TN",label:"Tunisia"},{value:"TR",label:"Turkey"},{value:"TM",label:"Turkmenistan"},{value:"TC",label:"Turks and Caicos Islands"},{value:"TV",label:"Tuvalu"},{value:"UG",label:"Uganda"},{value:"UA",label:"Ukraine"},{value:"AE",label:"United Arab Emirates"},{value:"GB",label:"United Kingdom"},{value:"UM",label:"United States Minor Outlying Islands"},{value:"US",label:"United States"},{value:"UY",label:"Uruguay"},{value:"UZ",label:"Uzbekistan"},{value:"VU",label:"Vanuatu"},{value:"VE",label:"Venezuela, Bolivarian Republic of"},{value:"VN",label:"Viet Nam"},{value:"VG",label:"Virgin Islands, British"},{value:"VI",label:"Virgin Islands, U.S."},{value:"WF",label:"Wallis and Futuna"},{value:"EH",label:"Western Sahara"},{value:"YE",label:"Yemen"},{value:"ZM",label:"Zambia"},{value:"ZW",label:"Zimbabwe"}],JGe=[{value:"AF",label:"افغانستان"},{value:"AX",label:"Åland"},{value:"AL",label:"Shqipëria"},{value:"DZ",label:"الجزائر"},{value:"AS",label:"American Samoa"},{value:"AD",label:"Andorra"},{value:"AO",label:"Angola"},{value:"AI",label:"Anguilla"},{value:"AQ",label:"Antarctica"},{value:"AG",label:"Antigua and Barbuda"},{value:"AR",label:"Argentina"},{value:"AM",label:"Հայաստան"},{value:"AW",label:"Aruba"},{value:"AU",label:"Australia"},{value:"AT",label:"Österreich"},{value:"AZ",label:"Azərbaycan"},{value:"BS",label:"Bahamas"},{value:"BH",label:"‏البحرين"},{value:"BD",label:"Bangladesh"},{value:"BB",label:"Barbados"},{value:"BY",label:"Белару́сь"},{value:"BE",label:"België"},{value:"BZ",label:"Belize"},{value:"BJ",label:"Bénin"},{value:"BM",label:"Bermuda"},{value:"BT",label:"ʼbrug-yul"},{value:"BO",label:"Bolivia"},{value:"BQ",label:"Bonaire"},{value:"BA",label:"Bosna i Hercegovina"},{value:"BW",label:"Botswana"},{value:"BV",label:"Bouvetøya"},{value:"BR",label:"Brasil"},{value:"IO",label:"British Indian Ocean Territory"},{value:"BN",label:"Negara Brunei Darussalam"},{value:"BG",label:"България"},{value:"BF",label:"Burkina Faso"},{value:"BI",label:"Burundi"},{value:"KH",label:"Kâmpŭchéa"},{value:"CM",label:"Cameroon"},{value:"CA",label:"Canada"},{value:"CV",label:"Cabo Verde"},{value:"KY",label:"Cayman Islands"},{value:"CF",label:"Ködörösêse tî Bêafrîka"},{value:"TD",label:"Tchad"},{value:"CL",label:"Chile"},{value:"CN",label:"中国"},{value:"CX",label:"Christmas Island"},{value:"CC",label:"Cocos (Keeling) Islands"},{value:"CO",label:"Colombia"},{value:"KM",label:"Komori"},{value:"CG",label:"République du Congo"},{value:"CD",label:"République démocratique du Congo"},{value:"CK",label:"Cook Islands"},{value:"CR",label:"Costa Rica"},{value:"CI",label:"Côte d'Ivoire"},{value:"HR",label:"Hrvatska"},{value:"CU",label:"Cuba"},{value:"CW",label:"Curaçao"},{value:"CY",label:"Κύπρος"},{value:"CZ",label:"Česká republika"},{value:"DK",label:"Danmark"},{value:"DJ",label:"Djibouti"},{value:"DM",label:"Dominica"},{value:"DO",label:"República Dominicana"},{value:"EC",label:"Ecuador"},{value:"EG",label:"مصر‎"},{value:"SV",label:"El Salvador"},{value:"GQ",label:"Guinea Ecuatorial"},{value:"ER",label:"ኤርትራ"},{value:"EE",label:"Eesti"},{value:"ET",label:"ኢትዮጵያ"},{value:"FK",label:"Falkland Islands"},{value:"FO",label:"Føroyar"},{value:"FJ",label:"Fiji"},{value:"FI",label:"Suomi"},{value:"FR",label:"France"},{value:"GF",label:"Guyane française"},{value:"PF",label:"Polynésie française"},{value:"TF",label:"Territoire des Terres australes et antarctiques fr"},{value:"GA",label:"Gabon"},{value:"GM",label:"Gambia"},{value:"GE",label:"საქართველო"},{value:"DE",label:"Deutschland"},{value:"GH",label:"Ghana"},{value:"GI",label:"Gibraltar"},{value:"GR",label:"Ελλάδα"},{value:"GL",label:"Kalaallit Nunaat"},{value:"GD",label:"Grenada"},{value:"GP",label:"Guadeloupe"},{value:"GU",label:"Guam"},{value:"GT",label:"Guatemala"},{value:"GG",label:"Guernsey"},{value:"GN",label:"Guinée"},{value:"GW",label:"Guiné-Bissau"},{value:"GY",label:"Guyana"},{value:"HT",label:"Haïti"},{value:"HM",label:"Heard Island and McDonald Islands"},{value:"VA",label:"Vaticano"},{value:"HN",label:"Honduras"},{value:"HK",label:"香港"},{value:"HU",label:"Magyarország"},{value:"IS",label:"Ísland"},{value:"IN",label:"भारत"},{value:"ID",label:"Indonesia"},{value:"IR",label:"ایران"},{value:"IQ",label:"العراق"},{value:"IE",label:"Éire"},{value:"IM",label:"Isle of Man"},{value:"IL",label:"יִשְׂרָאֵל"},{value:"IT",label:"Italia"},{value:"JM",label:"Jamaica"},{value:"JP",label:"日本"},{value:"JE",label:"Jersey"},{value:"JO",label:"الأردن"},{value:"KZ",label:"Қазақстан"},{value:"KE",label:"Kenya"},{value:"KI",label:"Kiribati"},{value:"KP",label:"북한"},{value:"KR",label:"대한민국"},{value:"KW",label:"الكويت"},{value:"KG",label:"Кыргызстан"},{value:"LA",label:"ສປປລາວ"},{value:"LV",label:"Latvija"},{value:"LB",label:"لبنان"},{value:"LS",label:"Lesotho"},{value:"LR",label:"Liberia"},{value:"LY",label:"‏ليبيا"},{value:"LI",label:"Liechtenstein"},{value:"LT",label:"Lietuva"},{value:"LU",label:"Luxembourg"},{value:"MO",label:"澳門"},{value:"MK",label:"Северна Македонија"},{value:"MG",label:"Madagasikara"},{value:"MW",label:"Malawi"},{value:"MY",label:"Malaysia"},{value:"MV",label:"Maldives"},{value:"ML",label:"Mali"},{value:"MT",label:"Malta"},{value:"MH",label:"M̧ajeļ"},{value:"MQ",label:"Martinique"},{value:"MR",label:"موريتانيا"},{value:"MU",label:"Maurice"},{value:"YT",label:"Mayotte"},{value:"MX",label:"México"},{value:"FM",label:"Micronesia"},{value:"MD",label:"Moldova"},{value:"MC",label:"Monaco"},{value:"MN",label:"Монгол улс"},{value:"ME",label:"Црна Гора"},{value:"MS",label:"Montserrat"},{value:"MA",label:"المغرب"},{value:"MZ",label:"Moçambique"},{value:"MM",label:"မြန်မာ"},{value:"NA",label:"Namibia"},{value:"NR",label:"Nauru"},{value:"NP",label:"नपल"},{value:"NL",label:"Nederland"},{value:"NC",label:"Nouvelle-Calédonie"},{value:"NZ",label:"New Zealand"},{value:"NI",label:"Nicaragua"},{value:"NE",label:"Niger"},{value:"NG",label:"Nigeria"},{value:"NU",label:"Niuē"},{value:"NF",label:"Norfolk Island"},{value:"MP",label:"Northern Mariana Islands"},{value:"NO",label:"Norge"},{value:"OM",label:"عمان"},{value:"PK",label:"Pakistan"},{value:"PW",label:"Palau"},{value:"PS",label:"فلسطين"},{value:"PA",label:"Panamá"},{value:"PG",label:"Papua Niugini"},{value:"PY",label:"Paraguay"},{value:"PE",label:"Perú"},{value:"PH",label:"Pilipinas"},{value:"PN",label:"Pitcairn Islands"},{value:"PL",label:"Polska"},{value:"PT",label:"Portugal"},{value:"PR",label:"Puerto Rico"},{value:"QA",label:"قطر"},{value:"RE",label:"La Réunion"},{value:"RO",label:"România"},{value:"RU",label:"Россия"},{value:"RW",label:"Rwanda"},{value:"BL",label:"Saint-Barthélemy"},{value:"SH",label:"Saint Helena"},{value:"KN",label:"Saint Kitts and Nevis"},{value:"LC",label:"Saint Lucia"},{value:"MF",label:"Saint-Martin"},{value:"PM",label:"Saint-Pierre-et-Miquelon"},{value:"VC",label:"Saint Vincent and the Grenadines"},{value:"WS",label:"Samoa"},{value:"SM",label:"San Marino"},{value:"ST",label:"São Tomé e Príncipe"},{value:"SA",label:"العربية السعودية"},{value:"SN",label:"Sénégal"},{value:"RS",label:"Србија"},{value:"SC",label:"Seychelles"},{value:"SL",label:"Sierra Leone"},{value:"SG",label:"Singapore"},{value:"SX",label:"Sint Maarten"},{value:"SK",label:"Slovensko"},{value:"SI",label:"Slovenija"},{value:"SB",label:"Solomon Islands"},{value:"SO",label:"Soomaaliya"},{value:"ZA",label:"South Africa"},{value:"GS",label:"South Georgia"},{value:"SS",label:"South Sudan"},{value:"ES",label:"España"},{value:"LK",label:"śrī laṃkāva"},{value:"SD",label:"السودان"},{value:"SR",label:"Suriname"},{value:"SJ",label:"Svalbard og Jan Mayen"},{value:"SZ",label:"Swaziland"},{value:"SE",label:"Sverige"},{value:"CH",label:"Schweiz"},{value:"SY",label:"سوريا"},{value:"TW",label:"臺灣"},{value:"TJ",label:"Тоҷикистон"},{value:"TZ",label:"Tanzania"},{value:"TH",label:"ประเทศไทย"},{value:"TL",label:"Timor-Leste"},{value:"TG",label:"Togo"},{value:"TK",label:"Tokelau"},{value:"TO",label:"Tonga"},{value:"TT",label:"Trinidad and Tobago"},{value:"TN",label:"تونس"},{value:"TR",label:"Türkiye"},{value:"TM",label:"Türkmenistan"},{value:"TC",label:"Turks and Caicos Islands"},{value:"TV",label:"Tuvalu"},{value:"UG",label:"Uganda"},{value:"UA",label:"Україна"},{value:"AE",label:"دولة الإمارات العربية المتحدة"},{value:"GB",label:"United Kingdom"},{value:"US",label:"United States"},{value:"UM",label:"United States Minor Outlying Islands"},{value:"UY",label:"Uruguay"},{value:"UZ",label:"O‘zbekiston"},{value:"VU",label:"Vanuatu"},{value:"VE",label:"Venezuela"},{value:"VN",label:"Việt Nam"},{value:"VG",label:"British Virgin Islands"},{value:"VI",label:"United States Virgin Islands"},{value:"WF",label:"Wallis et Futuna"},{value:"EH",label:"الصحراء الغربية"},{value:"YE",label:"اليَمَن"},{value:"ZM",label:"Zambia"},{value:"ZW",label:"Zimbabwe"}];class ZQ{constructor(){this.data=XGe,this.labelMap={},this.valueMap={},this.data.forEach(t=>{this.labelMap[t.label.toLowerCase()]=t.value,this.valueMap[t.value.toLowerCase()]=t.label})}getValue(t){return this.labelMap[t.toLowerCase()]}getLabel(t){return this.valueMap[t.toLowerCase()]}getLabels(){return this.data.map(t=>t.label)}getValues(){return this.data.map(t=>t.value)}getLabelList(){return this.labelMap}getValueList(){return this.valueMap}getData(){return this.data}setLabel(t,n){return this.data.forEach(i=>{i.value===t&&(i.label=n,this.valueMap[i.value.toLowerCase()]=i.label)}),this}setEmpty(t){return this.data.unshift({value:"",label:t}),this.valueMap[""]=t,this.labelMap[t]="",this}native(){return this.nativeData=JGe,this.nativeData.forEach(t=>{this.labelMap[t.label.toLowerCase()]=t.value,this.valueMap[t.value.toLowerCase()]=t.label}),this}}const ZGe=()=>{if(!(void 0 instanceof ZQ))return new ZQ};var QGe=ZGe;const eHe=jr(QGe);function tHe(){const{accessToken:e,user:t}=ct(),n=w.useMemo(()=>eHe().getData(),[]),i=St(e),[o,u]=w.useState(null),[h,p]=w.useState(!1);w.useEffect(()=>{e&&(BGe(i).then(v=>{u({...v,dateOfBirth:v.dateOfBirth?new Date(v.dateOfBirth).toISOString().split("T")[0]:""})}).catch(console.error),console.log(o,"datadata"))},[e]);const g=async()=>{if(o){p(!0);try{await $Ge(o,i),Ce.success("Your settings were updated successfully")}catch(v){console.error(v),Ce.error((v==null?void 0:v.message)||"Something went wrong. Please try again.")}finally{p(!1)}}};return o?c.jsxs(Vr,{className:"mb-6",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"General"})}),c.jsxs(mi,{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Username"}),c.jsx(Ae,{value:o.username,disabled:!0,required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Email"}),c.jsx(Ae,{value:o.user_email,disabled:!0,required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Phone"}),c.jsx(Ae,{type:"number",value:o.phone??"",onChange:v=>u({...o,phone:v.target.value}),onKeyDown:v=>{["e","E","+","-"].includes(v.key)&&v.preventDefault()},required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Date of Birth"}),c.jsx(Ae,{type:"date",value:o.dateOfBirth??"",onChange:v=>u({...o,dateOfBirth:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Gender"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3",value:o.gender??"",onChange:v=>u({...o,gender:v.target.value}),required:!0,children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"}),c.jsx("option",{value:"non_binary",children:"Non-binary"}),c.jsx("option",{value:"prefer_not",children:"Prefer not to say"})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Website"}),c.jsx(Ae,{value:o.website??"",onChange:v=>u({...o,website:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"City"}),c.jsx(Ae,{value:o.city??"",onChange:v=>u({...o,city:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Country"}),c.jsxs("select",{value:(o==null?void 0:o.country)??"",onChange:v=>u({...o,country:v.target.value}),required:!0,className:"w-full border rounded-md h-10 px-3",children:[c.jsx("option",{value:"",children:"Select Country"}),n.map(v=>c.jsx("option",{value:v.label,children:v.label},v.value))]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Timezone"}),c.jsx(Ae,{value:o.timezone??"UTC",onChange:v=>u({...o,timezone:v.target.value}),required:!0})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Language"}),c.jsx(Ae,{value:o.language??"en",onChange:v=>u({...o,language:v.target.value}),required:!0})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx(Qe,{children:"Work"}),c.jsx(Ae,{value:o.work??"",onChange:v=>u({...o,work:v.target.value}),required:!0})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx(Qe,{children:"Education"}),c.jsx(Ae,{value:o.education??"",onChange:v=>u({...o,education:v.target.value}),required:!0})]})]}),c.jsx(L0,{}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:g,disabled:h,children:h?"Saving…":"Save changes"})})]})]}):c.jsx("div",{className:"p-4",children:"Loading…"})}var tI="Switch",[nHe,uxt]=Fs(tI),[rHe,iHe]=nHe(tI),Bhe=w.forwardRef((e,t)=>{const{__scopeSwitch:n,name:i,checked:o,defaultChecked:u,required:h,disabled:p,value:g="on",onCheckedChange:v,form:b,...E}=e,[T,C]=w.useState(null),R=Dn(t,P=>C(P)),N=w.useRef(!1),O=T?b||!!T.closest("form"):!0,[j,k]=Bd({prop:o,defaultProp:u??!1,onChange:v,caller:tI});return c.jsxs(rHe,{scope:n,checked:j,disabled:p,children:[c.jsx(Qt.button,{type:"button",role:"switch","aria-checked":j,"aria-required":h,"data-state":Hhe(j),"data-disabled":p?"":void 0,disabled:p,value:g,...E,ref:R,onClick:Tt(e.onClick,P=>{k(M=>!M),O&&(N.current=P.isPropagationStopped(),N.current||P.stopPropagation())})}),O&&c.jsx(Ghe,{control:T,bubbles:!N.current,name:i,value:g,checked:j,required:h,disabled:p,form:b,style:{transform:"translateX(-100%)"}})]})});Bhe.displayName=tI;var $he="SwitchThumb",Whe=w.forwardRef((e,t)=>{const{__scopeSwitch:n,...i}=e,o=iHe($he,n);return c.jsx(Qt.span,{"data-state":Hhe(o.checked),"data-disabled":o.disabled?"":void 0,...i,ref:t})});Whe.displayName=$he;var aHe="SwitchBubbleInput",Ghe=w.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:i=!0,...o},u)=>{const h=w.useRef(null),p=Dn(h,u),g=nB(n),v=v4(t);return w.useEffect(()=>{const b=h.current;if(!b)return;const E=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(E,"checked").set;if(g!==n&&C){const R=new Event("click",{bubbles:i});C.call(b,n),b.dispatchEvent(R)}},[g,n,i]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:p,style:{...o.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ghe.displayName=aHe;function Hhe(e){return e?"checked":"unchecked"}var zhe=Bhe,sHe=Whe;const Qi=w.forwardRef(({className:e,...t},n)=>c.jsx(zhe,{className:jt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:c.jsx(sHe,{className:jt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Qi.displayName=zhe.displayName;function oHe(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(null),[o,u]=w.useState(!1);if(w.useEffect(()=>{e&&WGe(t).then(i).catch(console.error)},[e]),!n)return c.jsx("div",{className:"p-4",children:"Loading…"});const h=async()=>{u(!0);try{await GGe(n,t)}finally{u(!1)}};return c.jsxs(Vr,{className:"mb-6",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Privacy"})}),c.jsxs(mi,{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Profile visibility"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.profileVisibility,onChange:p=>i({...n,profileVisibility:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Who can send you friend requests"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.friendRequestPolicy,onChange:p=>i({...n,friendRequestPolicy:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends_of_friends",children:"Friends of friends"})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Who can look you up by email"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.lookupEmail,onChange:p=>i({...n,lookupEmail:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Who can look you up by phone"}),c.jsxs("select",{className:"w-full border rounded-md h-10 px-3 mt-1",value:n.lookupPhone,onChange:p=>i({...n,lookupPhone:p.target.value}),children:[c.jsx("option",{value:"everyone",children:"Everyone"}),c.jsx("option",{value:"friends",children:"Friends"}),c.jsx("option",{value:"only_me",children:"Only me"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Qi,{checked:n.showOnline,onCheckedChange:p=>i({...n,showOnline:p})}),c.jsx(Qe,{children:"Show online status"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Qi,{checked:n.tagReview,onCheckedChange:p=>i({...n,tagReview:p})}),c.jsx(Qe,{children:"Require review before tags appear"})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:h,disabled:o,children:o?"Saving…":"Save changes"})})]})]})}function cHe(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(null),[o,u]=w.useState(!1);if(w.useEffect(()=>{e&&HGe(t).then(i).catch(console.error)},[e]),!n)return c.jsx("div",{className:"p-4",children:"Loading…"});const h=g=>i(v=>v&&{...v,[g]:!v[g]}),p=async()=>{u(!0);try{await zGe(n,t)}finally{u(!1)}};return c.jsxs(Vr,{className:"mb-6",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Notifications"})}),c.jsxs(mi,{className:"space-y-6",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[["inappLikes","Likes"],["inappComments","Comments"],["inappMentions","Mentions"],["inappFriendRequests","Friend requests"],["inappGroupActivity","Group activity"],["inappPayments","Payments"],["emailDigest","Email weekly digest"],["emailSecurity","Email security alerts"]].map(([g,v])=>c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Qi,{checked:n[g],onCheckedChange:()=>h(g)}),c.jsx(Qe,{children:v})]},g))}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:p,disabled:o,children:o?"Saving…":"Save changes"})})]})]})}function lHe(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(""),[o,u]=w.useState(""),[h,p]=w.useState(!1),[g,v]=w.useState([]),[b,E]=w.useState(!0);w.useEffect(()=>{e&&qGe(t).then(v).catch(console.error).finally(()=>E(!1))},[e]);const T=async()=>{p(!0);try{let R=await KGe(n,o,t);i(""),u(""),Ce.success("Your password has been updated successfully")}catch(R){Ce.error(R.message)}finally{p(!1)}},C=async R=>{await YGe(R,t).catch(console.error),v(N=>N.filter(O=>O.id!==R))};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Vr,{children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Change Password"})}),c.jsxs(mi,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Current password"}),c.jsx(Ae,{type:"password",value:n,onChange:R=>i(R.target.value)})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"New password"}),c.jsx(Ae,{type:"password",value:o,onChange:R=>u(R.target.value)})]}),c.jsx("div",{className:"md:col-span-2 flex justify-end",children:c.jsx(be,{onClick:T,disabled:h||!n||o.length<8,children:h?"Saving…":"Change password"})})]})]}),c.jsxs(Vr,{children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Active Sessions"})}),c.jsx(mi,{children:b?c.jsx("div",{children:"Loading…"}):g.length===0?c.jsx("div",{className:"text-gray-500",children:"No active sessions."}):c.jsx("div",{className:"space-y-3",children:g.map(R=>c.jsxs("div",{className:"flex items-center justify-between border rounded-md p-3 bg-white",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium",children:R.userAgent||"Unknown device"}),c.jsxs("div",{className:"text-gray-500",children:["IP ",R.ip||"—"," • Created ",new Date(R.createdAt).toLocaleString(),R.lastSeen&&c.jsxs(c.Fragment,{children:[" • Last seen ",new Date(R.lastSeen).toLocaleString()]})]})]}),c.jsx(be,{variant:"outline",onClick:()=>C(R.id),children:"Revoke"})]},R.id))})})]})]})}const uHe=[{key:"general",label:"General"},{key:"privacy",label:"Privacy"},{key:"notifications",label:"Notifications"},{key:"security",label:"Security"}];function dHe(){const[e,t]=w.useState("general");return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex w-full max-w-[1440px] mx-auto gap-6 min-w-0",children:[c.jsx("aside",{className:"hidden lg:block w-64 shrink-0 min-h-0",children:c.jsx("div",{className:"sticky top-16 h-[calc(100vh-4rem)] overflow-y-auto",children:c.jsx(Ss,{})})}),c.jsx("div",{className:"flex-1 min-h-0 min-w-0",children:c.jsx("div",{className:"bg-white rounded-xl shadow-sm border h-full overflow-hidden flex flex-col",children:c.jsxs(Rm,{value:e,onValueChange:n=>t(n),className:"flex h-full flex-col min-w-0",children:[c.jsx("div",{className:"sticky z-20 bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-b",children:c.jsx("div",{className:"px-3 sm:px-4 md:px-6",children:c.jsx(jf,{"aria-label":"Settings sections",className:`
                        !bg-transparent p-0 h-auto
                        w-full
                        flex flex-wrap sm:flex-nowrap gap-2 items-stretch
                        overflow-x-visible sm:overflow-x-auto hide-scrollbar
                      `,children:uHe.map(n=>c.jsx(Ia,{value:n.key,className:`
                            rounded-md
                            px-3 md:px-4 py-2
                            text-sm font-medium
                            text-gray-600
                            outline-none ring-0 focus:outline-none
                            focus-visible:ring-0 focus-visible:ring-offset-0
                            data-[state=active]:text-gray-900
                            data-[state=active]:bg-white
                            data-[state=active]:border
                            data-[state=active]:shadow-none
                            whitespace-nowrap
                          `,children:n.label},n.key))})})}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 sm:p-4 md:p-6 pt-4 sm:pt-6",children:[c.jsx(fi,{value:"general",className:"m-0",children:c.jsx(tHe,{})}),c.jsx(fi,{value:"privacy",className:"m-0",children:c.jsx(oHe,{})}),c.jsx(fi,{value:"notifications",className:"m-0",children:c.jsx(cHe,{})}),c.jsx(fi,{value:"security",className:"m-0",children:c.jsx(lHe,{})})]})]})})})]})})]})}function hHe(){return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1400px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"max-w-3xl mx-auto",children:c.jsxs("div",{className:"rounded-xl shadow-sm border bg-white overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-[#7C3AED] via-[#5B6CFA] to-[#1D4ED8] p-6 text-white",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"bg-white/20 rounded-2xl p-3",children:c.jsx(U4,{className:"h-6 w-6"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Something exciting is on the way"}),c.jsx("p",{className:"text-white/90",children:"We’re polishing the last bits. Stay tuned!"})]})]})}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"rounded-lg border bg-gray-50 px-4 py-3 text-gray-700 flex items-center gap-2",children:[c.jsx("span",{className:"inline-flex h-2 w-2 rounded-full bg-amber-500 animate-pulse"}),"Launching soon"]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx(At,{to:"/",children:c.jsxs(be,{variant:"outline",className:"gap-2",children:[c.jsx(DVe,{className:"h-4 w-4"}),"Back to feed"]})}),c.jsx(At,{to:"/help"})]})]})]})})}),c.jsx("aside",{className:"hidden xl:block xl:w-80"})]})})]})}var eS=e=>e.type==="checkbox",Vp=e=>e instanceof Date,ks=e=>e==null;const Khe=e=>typeof e=="object";var na=e=>!ks(e)&&!Array.isArray(e)&&Khe(e)&&!Vp(e),qhe=e=>na(e)&&e.target?eS(e.target)?e.target.checked:e.target.value:e,fHe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Yhe=(e,t)=>e.has(fHe(t)),pHe=e=>{const t=e.constructor&&e.constructor.prototype;return na(t)&&t.hasOwnProperty("isPrototypeOf")},EB=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ra(e){let t;const n=Array.isArray(e),i=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(EB&&(e instanceof Blob||i))&&(n||na(e)))if(t=n?[]:{},!n&&!pHe(e))t=e;else for(const o in e)e.hasOwnProperty(o)&&(t[o]=Ra(e[o]));else return e;return t}var nI=e=>/^\w*$/.test(e),Ji=e=>e===void 0,wB=e=>Array.isArray(e)?e.filter(Boolean):[],SB=e=>wB(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Ot=(e,t,n)=>{if(!t||!na(e))return n;const i=(nI(t)?[t]:SB(t)).reduce((o,u)=>ks(o)?o:o[u],e);return Ji(i)||i===e?Ji(e[t])?n:e[t]:i},Uo=e=>typeof e=="boolean",Ur=(e,t,n)=>{let i=-1;const o=nI(t)?[t]:SB(t),u=o.length,h=u-1;for(;++i<u;){const p=o[i];let g=n;if(i!==h){const v=e[p];g=na(v)||Array.isArray(v)?v:isNaN(+o[i+1])?{}:[]}if(p==="__proto__"||p==="constructor"||p==="prototype")return;e[p]=g,e=e[p]}};const $N={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Il={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},gd={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},xB=me.createContext(null);xB.displayName="HookFormContext";const rI=()=>me.useContext(xB),mHe=e=>{const{children:t,...n}=e;return me.createElement(xB.Provider,{value:n},t)};var Xhe=(e,t,n,i=!0)=>{const o={defaultValues:t._defaultValues};for(const u in e)Object.defineProperty(o,u,{get:()=>{const h=u;return t._proxyFormState[h]!==Il.all&&(t._proxyFormState[h]=!i||Il.all),n&&(n[h]=!0),e[h]}});return o};const TB=typeof window<"u"?me.useLayoutEffect:me.useEffect;function gHe(e){const t=rI(),{control:n=t.control,disabled:i,name:o,exact:u}=e||{},[h,p]=me.useState(n._formState),g=me.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return TB(()=>n._subscribe({name:o,formState:g.current,exact:u,callback:v=>{!i&&p({...n._formState,...v})}}),[o,i,u]),me.useEffect(()=>{g.current.isValid&&n._setValid(!0)},[n]),me.useMemo(()=>Xhe(h,n,g.current,!1),[h,n])}var Au=e=>typeof e=="string",Jhe=(e,t,n,i,o)=>Au(e)?(i&&t.watch.add(e),Ot(n,e,o)):Array.isArray(e)?e.map(u=>(i&&t.watch.add(u),Ot(n,u))):(i&&(t.watchAll=!0),n),IU=e=>ks(e)||!Khe(e);function wd(e,t,n=new WeakSet){if(IU(e)||IU(t))return e===t;if(Vp(e)&&Vp(t))return e.getTime()===t.getTime();const i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const u of i){const h=e[u];if(!o.includes(u))return!1;if(u!=="ref"){const p=t[u];if(Vp(h)&&Vp(p)||na(h)&&na(p)||Array.isArray(h)&&Array.isArray(p)?!wd(h,p,n):h!==p)return!1}}return!0}function vHe(e){const t=rI(),{control:n=t.control,name:i,defaultValue:o,disabled:u,exact:h,compute:p}=e||{},g=me.useRef(o),v=me.useRef(p),b=me.useRef(void 0);v.current=p;const E=me.useMemo(()=>n._getWatch(i,g.current),[n,i]),[T,C]=me.useState(v.current?v.current(E):E);return TB(()=>n._subscribe({name:i,formState:{values:!0},exact:h,callback:R=>{if(!u){const N=Jhe(i,n._names,R.values||n._formValues,!1,g.current);if(v.current){const O=v.current(N);wd(O,b.current)||(C(O),b.current=O)}else C(N)}}}),[n,u,i,h]),me.useEffect(()=>n._removeUnmounted()),T}function yHe(e){const t=rI(),{name:n,disabled:i,control:o=t.control,shouldUnregister:u,defaultValue:h}=e,p=Yhe(o._names.array,n),g=me.useMemo(()=>Ot(o._formValues,n,Ot(o._defaultValues,n,h)),[o,n,h]),v=vHe({control:o,name:n,defaultValue:g,exact:!0}),b=gHe({control:o,name:n,exact:!0}),E=me.useRef(e),T=me.useRef(o.register(n,{...e.rules,value:v,...Uo(e.disabled)?{disabled:e.disabled}:{}}));E.current=e;const C=me.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ot(b.errors,n)},isDirty:{enumerable:!0,get:()=>!!Ot(b.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Ot(b.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Ot(b.validatingFields,n)},error:{enumerable:!0,get:()=>Ot(b.errors,n)}}),[b,n]),R=me.useCallback(k=>T.current.onChange({target:{value:qhe(k),name:n},type:$N.CHANGE}),[n]),N=me.useCallback(()=>T.current.onBlur({target:{value:Ot(o._formValues,n),name:n},type:$N.BLUR}),[n,o._formValues]),O=me.useCallback(k=>{const P=Ot(o._fields,n);P&&k&&(P._f.ref={focus:()=>k.focus&&k.focus(),select:()=>k.select&&k.select(),setCustomValidity:M=>k.setCustomValidity(M),reportValidity:()=>k.reportValidity()})},[o._fields,n]),j=me.useMemo(()=>({name:n,value:v,...Uo(i)||b.disabled?{disabled:b.disabled||i}:{},onChange:R,onBlur:N,ref:O}),[n,i,b.disabled,R,N,O,v]);return me.useEffect(()=>{const k=o._options.shouldUnregister||u;o.register(n,{...E.current.rules,...Uo(E.current.disabled)?{disabled:E.current.disabled}:{}});const P=(M,D)=>{const U=Ot(o._fields,M);U&&U._f&&(U._f.mount=D)};if(P(n,!0),k){const M=Ra(Ot(o._options.defaultValues,n));Ur(o._defaultValues,n,M),Ji(Ot(o._formValues,n))&&Ur(o._formValues,n,M)}return!p&&o.register(n),()=>{(p?k&&!o._state.action:k)?o.unregister(n):P(n,!1)}},[n,o,p,u]),me.useEffect(()=>{o._setDisabledField({disabled:i,name:n})},[i,n,o]),me.useMemo(()=>({field:j,formState:b,fieldState:C}),[j,b,C])}const _He=e=>e.render(yHe(e));var Zhe=(e,t,n,i,o)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[i]:o||!0}}:{},e0=e=>Array.isArray(e)?e:[e],QQ=()=>{let e=[];return{get observers(){return e},next:o=>{for(const u of e)u.next&&u.next(o)},subscribe:o=>(e.push(o),{unsubscribe:()=>{e=e.filter(u=>u!==o)}}),unsubscribe:()=>{e=[]}}},ao=e=>na(e)&&!Object.keys(e).length,CB=e=>e.type==="file",Ol=e=>typeof e=="function",WN=e=>{if(!EB)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Qhe=e=>e.type==="select-multiple",RB=e=>e.type==="radio",bHe=e=>RB(e)||eS(e),vL=e=>WN(e)&&e.isConnected;function EHe(e,t){const n=t.slice(0,-1).length;let i=0;for(;i<n;)e=Ji(e)?i++:e[t[i++]];return e}function wHe(e){for(const t in e)if(e.hasOwnProperty(t)&&!Ji(e[t]))return!1;return!0}function la(e,t){const n=Array.isArray(t)?t:nI(t)?[t]:SB(t),i=n.length===1?e:EHe(e,n),o=n.length-1,u=n[o];return i&&delete i[u],o!==0&&(na(i)&&ao(i)||Array.isArray(i)&&wHe(i))&&la(e,n.slice(0,-1)),e}var efe=e=>{for(const t in e)if(Ol(e[t]))return!0;return!1};function GN(e,t={}){const n=Array.isArray(e);if(na(e)||n)for(const i in e)Array.isArray(e[i])||na(e[i])&&!efe(e[i])?(t[i]=Array.isArray(e[i])?[]:{},GN(e[i],t[i])):ks(e[i])||(t[i]=!0);return t}function tfe(e,t,n){const i=Array.isArray(e);if(na(e)||i)for(const o in e)Array.isArray(e[o])||na(e[o])&&!efe(e[o])?Ji(t)||IU(n[o])?n[o]=Array.isArray(e[o])?GN(e[o],[]):{...GN(e[o])}:tfe(e[o],ks(t)?{}:t[o],n[o]):n[o]=!wd(e[o],t[o]);return n}var gE=(e,t)=>tfe(e,t,GN(t));const eee={value:!1,isValid:!1},tee={value:!0,isValid:!0};var nfe=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Ji(e[0].attributes.value)?Ji(e[0].value)||e[0].value===""?tee:{value:e[0].value,isValid:!0}:tee:eee}return eee},rfe=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:i})=>Ji(e)?e:t?e===""?NaN:e&&+e:n&&Au(e)?new Date(e):i?i(e):e;const nee={isValid:!1,value:null};var ife=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,nee):nee;function ree(e){const t=e.ref;return CB(t)?t.files:RB(t)?ife(e.refs).value:Qhe(t)?[...t.selectedOptions].map(({value:n})=>n):eS(t)?nfe(e.refs).value:rfe(Ji(t.value)?e.ref.value:t.value,e)}var SHe=(e,t,n,i)=>{const o={};for(const u of e){const h=Ot(t,u);h&&Ur(o,u,h._f)}return{criteriaMode:n,names:[...e],fields:o,shouldUseNativeValidation:i}},HN=e=>e instanceof RegExp,vE=e=>Ji(e)?e:HN(e)?e.source:na(e)?HN(e.value)?e.value.source:e.value:e,iee=e=>({isOnSubmit:!e||e===Il.onSubmit,isOnBlur:e===Il.onBlur,isOnChange:e===Il.onChange,isOnAll:e===Il.all,isOnTouch:e===Il.onTouched});const aee="AsyncFunction";var xHe=e=>!!e&&!!e.validate&&!!(Ol(e.validate)&&e.validate.constructor.name===aee||na(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===aee)),THe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),see=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const t0=(e,t,n,i)=>{for(const o of n||Object.keys(e)){const u=Ot(e,o);if(u){const{_f:h,...p}=u;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],o)&&!i)return!0;if(h.ref&&t(h.ref,h.name)&&!i)return!0;if(t0(p,t))break}else if(na(p)&&t0(p,t))break}}};function oee(e,t,n){const i=Ot(e,n);if(i||nI(n))return{error:i,name:n};const o=n.split(".");for(;o.length;){const u=o.join("."),h=Ot(t,u),p=Ot(e,u);if(h&&!Array.isArray(h)&&n!==u)return{name:n};if(p&&p.type)return{name:u,error:p};if(p&&p.root&&p.root.type)return{name:`${u}.root`,error:p.root};o.pop()}return{name:n}}var CHe=(e,t,n,i)=>{n(e);const{name:o,...u}=e;return ao(u)||Object.keys(u).length>=Object.keys(t).length||Object.keys(u).find(h=>t[h]===(!i||Il.all))},RHe=(e,t,n)=>!e||!t||e===t||e0(e).some(i=>i&&(n?i===t:i.startsWith(t)||t.startsWith(i))),NHe=(e,t,n,i,o)=>o.isOnAll?!1:!n&&o.isOnTouch?!(t||e):(n?i.isOnBlur:o.isOnBlur)?!e:(n?i.isOnChange:o.isOnChange)?e:!0,AHe=(e,t)=>!wB(Ot(e,t)).length&&la(e,t),IHe=(e,t,n)=>{const i=e0(Ot(e,n));return Ur(i,"root",t[n]),Ur(e,n,i),e},qR=e=>Au(e);function cee(e,t,n="validate"){if(qR(e)||Array.isArray(e)&&e.every(qR)||Uo(e)&&!e)return{type:n,message:qR(e)?e:"",ref:t}}var ov=e=>na(e)&&!HN(e)?e:{value:e,message:""},lee=async(e,t,n,i,o,u)=>{const{ref:h,refs:p,required:g,maxLength:v,minLength:b,min:E,max:T,pattern:C,validate:R,name:N,valueAsNumber:O,mount:j}=e._f,k=Ot(n,N);if(!j||t.has(N))return{};const P=p?p[0]:h,M=z=>{o&&P.reportValidity&&(P.setCustomValidity(Uo(z)?"":z||""),P.reportValidity())},D={},U=RB(h),F=eS(h),H=U||F,W=(O||CB(h))&&Ji(h.value)&&Ji(k)||WN(h)&&h.value===""||k===""||Array.isArray(k)&&!k.length,q=Zhe.bind(null,N,i,D),Y=(z,Z,X,ae=gd.maxLength,se=gd.minLength)=>{const J=z?Z:X;D[N]={type:z?ae:se,message:J,ref:h,...q(z?ae:se,J)}};if(u?!Array.isArray(k)||!k.length:g&&(!H&&(W||ks(k))||Uo(k)&&!k||F&&!nfe(p).isValid||U&&!ife(p).isValid)){const{value:z,message:Z}=qR(g)?{value:!!g,message:g}:ov(g);if(z&&(D[N]={type:gd.required,message:Z,ref:P,...q(gd.required,Z)},!i))return M(Z),D}if(!W&&(!ks(E)||!ks(T))){let z,Z;const X=ov(T),ae=ov(E);if(!ks(k)&&!isNaN(k)){const se=h.valueAsNumber||k&&+k;ks(X.value)||(z=se>X.value),ks(ae.value)||(Z=se<ae.value)}else{const se=h.valueAsDate||new Date(k),J=de=>new Date(new Date().toDateString()+" "+de),re=h.type=="time",ee=h.type=="week";Au(X.value)&&k&&(z=re?J(k)>J(X.value):ee?k>X.value:se>new Date(X.value)),Au(ae.value)&&k&&(Z=re?J(k)<J(ae.value):ee?k<ae.value:se<new Date(ae.value))}if((z||Z)&&(Y(!!z,X.message,ae.message,gd.max,gd.min),!i))return M(D[N].message),D}if((v||b)&&!W&&(Au(k)||u&&Array.isArray(k))){const z=ov(v),Z=ov(b),X=!ks(z.value)&&k.length>+z.value,ae=!ks(Z.value)&&k.length<+Z.value;if((X||ae)&&(Y(X,z.message,Z.message),!i))return M(D[N].message),D}if(C&&!W&&Au(k)){const{value:z,message:Z}=ov(C);if(HN(z)&&!k.match(z)&&(D[N]={type:gd.pattern,message:Z,ref:h,...q(gd.pattern,Z)},!i))return M(Z),D}if(R){if(Ol(R)){const z=await R(k,n),Z=cee(z,P);if(Z&&(D[N]={...Z,...q(gd.validate,Z.message)},!i))return M(Z.message),D}else if(na(R)){let z={};for(const Z in R){if(!ao(z)&&!i)break;const X=cee(await R[Z](k,n),P,Z);X&&(z={...X,...q(Z,X.message)},M(X.message),i&&(D[N]=z))}if(!ao(z)&&(D[N]={ref:P,...z},!i))return D}}return M(!0),D};const OHe={mode:Il.onSubmit,reValidateMode:Il.onChange,shouldFocusError:!0};function PHe(e={}){let t={...OHe,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ol(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},o=na(t.defaultValues)||na(t.values)?Ra(t.defaultValues||t.values)||{}:{},u=t.shouldUnregister?{}:Ra(o),h={action:!1,mount:!1,watch:!1},p={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},g,v=0;const b={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let E={...b};const T={array:QQ(),state:QQ()},C=t.criteriaMode===Il.all,R=ge=>Ne=>{clearTimeout(v),v=setTimeout(ge,Ne)},N=async ge=>{if(!t.disabled&&(b.isValid||E.isValid||ge)){const Ne=t.resolver?ao((await F()).errors):await W(i,!0);Ne!==n.isValid&&T.state.next({isValid:Ne})}},O=(ge,Ne)=>{!t.disabled&&(b.isValidating||b.validatingFields||E.isValidating||E.validatingFields)&&((ge||Array.from(p.mount)).forEach(We=>{We&&(Ne?Ur(n.validatingFields,We,Ne):la(n.validatingFields,We))}),T.state.next({validatingFields:n.validatingFields,isValidating:!ao(n.validatingFields)}))},j=(ge,Ne=[],We,gt,ot=!0,pt=!0)=>{if(gt&&We&&!t.disabled){if(h.action=!0,pt&&Array.isArray(Ot(i,ge))){const Ft=We(Ot(i,ge),gt.argA,gt.argB);ot&&Ur(i,ge,Ft)}if(pt&&Array.isArray(Ot(n.errors,ge))){const Ft=We(Ot(n.errors,ge),gt.argA,gt.argB);ot&&Ur(n.errors,ge,Ft),AHe(n.errors,ge)}if((b.touchedFields||E.touchedFields)&&pt&&Array.isArray(Ot(n.touchedFields,ge))){const Ft=We(Ot(n.touchedFields,ge),gt.argA,gt.argB);ot&&Ur(n.touchedFields,ge,Ft)}(b.dirtyFields||E.dirtyFields)&&(n.dirtyFields=gE(o,u)),T.state.next({name:ge,isDirty:Y(ge,Ne),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Ur(u,ge,Ne)},k=(ge,Ne)=>{Ur(n.errors,ge,Ne),T.state.next({errors:n.errors})},P=ge=>{n.errors=ge,T.state.next({errors:n.errors,isValid:!1})},M=(ge,Ne,We,gt)=>{const ot=Ot(i,ge);if(ot){const pt=Ot(u,ge,Ji(We)?Ot(o,ge):We);Ji(pt)||gt&&gt.defaultChecked||Ne?Ur(u,ge,Ne?pt:ree(ot._f)):X(ge,pt),h.mount&&N()}},D=(ge,Ne,We,gt,ot)=>{let pt=!1,Ft=!1;const gn={name:ge};if(!t.disabled){if(!We||gt){(b.isDirty||E.isDirty)&&(Ft=n.isDirty,n.isDirty=gn.isDirty=Y(),pt=Ft!==gn.isDirty);const ur=wd(Ot(o,ge),Ne);Ft=!!Ot(n.dirtyFields,ge),ur?la(n.dirtyFields,ge):Ur(n.dirtyFields,ge,!0),gn.dirtyFields=n.dirtyFields,pt=pt||(b.dirtyFields||E.dirtyFields)&&Ft!==!ur}if(We){const ur=Ot(n.touchedFields,ge);ur||(Ur(n.touchedFields,ge,We),gn.touchedFields=n.touchedFields,pt=pt||(b.touchedFields||E.touchedFields)&&ur!==We)}pt&&ot&&T.state.next(gn)}return pt?gn:{}},U=(ge,Ne,We,gt)=>{const ot=Ot(n.errors,ge),pt=(b.isValid||E.isValid)&&Uo(Ne)&&n.isValid!==Ne;if(t.delayError&&We?(g=R(()=>k(ge,We)),g(t.delayError)):(clearTimeout(v),g=null,We?Ur(n.errors,ge,We):la(n.errors,ge)),(We?!wd(ot,We):ot)||!ao(gt)||pt){const Ft={...gt,...pt&&Uo(Ne)?{isValid:Ne}:{},errors:n.errors,name:ge};n={...n,...Ft},T.state.next(Ft)}},F=async ge=>{O(ge,!0);const Ne=await t.resolver(u,t.context,SHe(ge||p.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return O(ge),Ne},H=async ge=>{const{errors:Ne}=await F(ge);if(ge)for(const We of ge){const gt=Ot(Ne,We);gt?Ur(n.errors,We,gt):la(n.errors,We)}else n.errors=Ne;return Ne},W=async(ge,Ne,We={valid:!0})=>{for(const gt in ge){const ot=ge[gt];if(ot){const{_f:pt,...Ft}=ot;if(pt){const gn=p.array.has(pt.name),ur=ot._f&&xHe(ot._f);ur&&b.validatingFields&&O([gt],!0);const ia=await lee(ot,p.disabled,u,C,t.shouldUseNativeValidation&&!Ne,gn);if(ur&&b.validatingFields&&O([gt]),ia[pt.name]&&(We.valid=!1,Ne))break;!Ne&&(Ot(ia,pt.name)?gn?IHe(n.errors,ia,pt.name):Ur(n.errors,pt.name,ia[pt.name]):la(n.errors,pt.name))}!ao(Ft)&&await W(Ft,Ne,We)}}return We.valid},q=()=>{for(const ge of p.unMount){const Ne=Ot(i,ge);Ne&&(Ne._f.refs?Ne._f.refs.every(We=>!vL(We)):!vL(Ne._f.ref))&&ze(ge)}p.unMount=new Set},Y=(ge,Ne)=>!t.disabled&&(ge&&Ne&&Ur(u,ge,Ne),!wd(de(),o)),z=(ge,Ne,We)=>Jhe(ge,p,{...h.mount?u:Ji(Ne)?o:Au(ge)?{[ge]:Ne}:Ne},We,Ne),Z=ge=>wB(Ot(h.mount?u:o,ge,t.shouldUnregister?Ot(o,ge,[]):[])),X=(ge,Ne,We={})=>{const gt=Ot(i,ge);let ot=Ne;if(gt){const pt=gt._f;pt&&(!pt.disabled&&Ur(u,ge,rfe(Ne,pt)),ot=WN(pt.ref)&&ks(Ne)?"":Ne,Qhe(pt.ref)?[...pt.ref.options].forEach(Ft=>Ft.selected=ot.includes(Ft.value)):pt.refs?eS(pt.ref)?pt.refs.forEach(Ft=>{(!Ft.defaultChecked||!Ft.disabled)&&(Array.isArray(ot)?Ft.checked=!!ot.find(gn=>gn===Ft.value):Ft.checked=ot===Ft.value||!!ot)}):pt.refs.forEach(Ft=>Ft.checked=Ft.value===ot):CB(pt.ref)?pt.ref.value="":(pt.ref.value=ot,pt.ref.type||T.state.next({name:ge,values:Ra(u)})))}(We.shouldDirty||We.shouldTouch)&&D(ge,ot,We.shouldTouch,We.shouldDirty,!0),We.shouldValidate&&ee(ge)},ae=(ge,Ne,We)=>{for(const gt in Ne){if(!Ne.hasOwnProperty(gt))return;const ot=Ne[gt],pt=ge+"."+gt,Ft=Ot(i,pt);(p.array.has(ge)||na(ot)||Ft&&!Ft._f)&&!Vp(ot)?ae(pt,ot,We):X(pt,ot,We)}},se=(ge,Ne,We={})=>{const gt=Ot(i,ge),ot=p.array.has(ge),pt=Ra(Ne);Ur(u,ge,pt),ot?(T.array.next({name:ge,values:Ra(u)}),(b.isDirty||b.dirtyFields||E.isDirty||E.dirtyFields)&&We.shouldDirty&&T.state.next({name:ge,dirtyFields:gE(o,u),isDirty:Y(ge,pt)})):gt&&!gt._f&&!ks(pt)?ae(ge,pt,We):X(ge,pt,We),see(ge,p)&&T.state.next({...n,name:ge}),T.state.next({name:h.mount?ge:void 0,values:Ra(u)})},J=async ge=>{h.mount=!0;const Ne=ge.target;let We=Ne.name,gt=!0;const ot=Ot(i,We),pt=ur=>{gt=Number.isNaN(ur)||Vp(ur)&&isNaN(ur.getTime())||wd(ur,Ot(u,We,ur))},Ft=iee(t.mode),gn=iee(t.reValidateMode);if(ot){let ur,ia;const Ws=Ne.type?ree(ot._f):qhe(ge),xs=ge.type===$N.BLUR||ge.type===$N.FOCUS_OUT,Xu=!THe(ot._f)&&!t.resolver&&!Ot(n.errors,We)&&!ot._f.deps||NHe(xs,Ot(n.touchedFields,We),n.isSubmitted,gn,Ft),Gs=see(We,p,xs);Ur(u,We,Ws),xs?(ot._f.onBlur&&ot._f.onBlur(ge),g&&g(0)):ot._f.onChange&&ot._f.onChange(ge);const Gi=D(We,Ws,xs),zl=!ao(Gi)||Gs;if(!xs&&T.state.next({name:We,type:ge.type,values:Ra(u)}),Xu)return(b.isValid||E.isValid)&&(t.mode==="onBlur"?xs&&N():xs||N()),zl&&T.state.next({name:We,...Gs?{}:Gi});if(!xs&&Gs&&T.state.next({...n}),t.resolver){const{errors:bt}=await F([We]);if(pt(Ws),gt){const yn=oee(n.errors,i,We),Bn=oee(bt,i,yn.name||We);ur=Bn.error,We=Bn.name,ia=ao(bt)}}else O([We],!0),ur=(await lee(ot,p.disabled,u,C,t.shouldUseNativeValidation))[We],O([We]),pt(Ws),gt&&(ur?ia=!1:(b.isValid||E.isValid)&&(ia=await W(i,!0)));gt&&(ot._f.deps&&ee(ot._f.deps),U(We,ia,ur,Gi))}},re=(ge,Ne)=>{if(Ot(n.errors,Ne)&&ge.focus)return ge.focus(),1},ee=async(ge,Ne={})=>{let We,gt;const ot=e0(ge);if(t.resolver){const pt=await H(Ji(ge)?ge:ot);We=ao(pt),gt=ge?!ot.some(Ft=>Ot(pt,Ft)):We}else ge?(gt=(await Promise.all(ot.map(async pt=>{const Ft=Ot(i,pt);return await W(Ft&&Ft._f?{[pt]:Ft}:Ft)}))).every(Boolean),!(!gt&&!n.isValid)&&N()):gt=We=await W(i);return T.state.next({...!Au(ge)||(b.isValid||E.isValid)&&We!==n.isValid?{}:{name:ge},...t.resolver||!ge?{isValid:We}:{},errors:n.errors}),Ne.shouldFocus&&!gt&&t0(i,re,ge?ot:p.mount),gt},de=ge=>{const Ne={...h.mount?u:o};return Ji(ge)?Ne:Au(ge)?Ot(Ne,ge):ge.map(We=>Ot(Ne,We))},xe=(ge,Ne)=>({invalid:!!Ot((Ne||n).errors,ge),isDirty:!!Ot((Ne||n).dirtyFields,ge),error:Ot((Ne||n).errors,ge),isValidating:!!Ot(n.validatingFields,ge),isTouched:!!Ot((Ne||n).touchedFields,ge)}),ve=ge=>{ge&&e0(ge).forEach(Ne=>la(n.errors,Ne)),T.state.next({errors:ge?n.errors:{}})},Te=(ge,Ne,We)=>{const gt=(Ot(i,ge,{_f:{}})._f||{}).ref,ot=Ot(n.errors,ge)||{},{ref:pt,message:Ft,type:gn,...ur}=ot;Ur(n.errors,ge,{...ur,...Ne,ref:gt}),T.state.next({name:ge,errors:n.errors,isValid:!1}),We&&We.shouldFocus&&gt&&gt.focus&&gt.focus()},Pe=(ge,Ne)=>Ol(ge)?T.state.subscribe({next:We=>"values"in We&&ge(z(void 0,Ne),We)}):z(ge,Ne,!0),qe=ge=>T.state.subscribe({next:Ne=>{RHe(ge.name,Ne.name,ge.exact)&&CHe(Ne,ge.formState||b,wt,ge.reRenderRoot)&&ge.callback({values:{...u},...n,...Ne,defaultValues:o})}}).unsubscribe,st=ge=>(h.mount=!0,E={...E,...ge.formState},qe({...ge,formState:E})),ze=(ge,Ne={})=>{for(const We of ge?e0(ge):p.mount)p.mount.delete(We),p.array.delete(We),Ne.keepValue||(la(i,We),la(u,We)),!Ne.keepError&&la(n.errors,We),!Ne.keepDirty&&la(n.dirtyFields,We),!Ne.keepTouched&&la(n.touchedFields,We),!Ne.keepIsValidating&&la(n.validatingFields,We),!t.shouldUnregister&&!Ne.keepDefaultValue&&la(o,We);T.state.next({values:Ra(u)}),T.state.next({...n,...Ne.keepDirty?{isDirty:Y()}:{}}),!Ne.keepIsValid&&N()},ft=({disabled:ge,name:Ne})=>{(Uo(ge)&&h.mount||ge||p.disabled.has(Ne))&&(ge?p.disabled.add(Ne):p.disabled.delete(Ne))},$e=(ge,Ne={})=>{let We=Ot(i,ge);const gt=Uo(Ne.disabled)||Uo(t.disabled);return Ur(i,ge,{...We||{},_f:{...We&&We._f?We._f:{ref:{name:ge}},name:ge,mount:!0,...Ne}}),p.mount.add(ge),We?ft({disabled:Uo(Ne.disabled)?Ne.disabled:t.disabled,name:ge}):M(ge,!0,Ne.value),{...gt?{disabled:Ne.disabled||t.disabled}:{},...t.progressive?{required:!!Ne.required,min:vE(Ne.min),max:vE(Ne.max),minLength:vE(Ne.minLength),maxLength:vE(Ne.maxLength),pattern:vE(Ne.pattern)}:{},name:ge,onChange:J,onBlur:J,ref:ot=>{if(ot){$e(ge,Ne),We=Ot(i,ge);const pt=Ji(ot.value)&&ot.querySelectorAll&&ot.querySelectorAll("input,select,textarea")[0]||ot,Ft=bHe(pt),gn=We._f.refs||[];if(Ft?gn.find(ur=>ur===pt):pt===We._f.ref)return;Ur(i,ge,{_f:{...We._f,...Ft?{refs:[...gn.filter(vL),pt,...Array.isArray(Ot(o,ge))?[{}]:[]],ref:{type:pt.type,name:ge}}:{ref:pt}}}),M(ge,!1,void 0,pt)}else We=Ot(i,ge,{}),We._f&&(We._f.mount=!1),(t.shouldUnregister||Ne.shouldUnregister)&&!(Yhe(p.array,ge)&&h.action)&&p.unMount.add(ge)}}},at=()=>t.shouldFocusError&&t0(i,re,p.mount),ke=ge=>{Uo(ge)&&(T.state.next({disabled:ge}),t0(i,(Ne,We)=>{const gt=Ot(i,We);gt&&(Ne.disabled=gt._f.disabled||ge,Array.isArray(gt._f.refs)&&gt._f.refs.forEach(ot=>{ot.disabled=gt._f.disabled||ge}))},0,!1))},je=(ge,Ne)=>async We=>{let gt;We&&(We.preventDefault&&We.preventDefault(),We.persist&&We.persist());let ot=Ra(u);if(T.state.next({isSubmitting:!0}),t.resolver){const{errors:pt,values:Ft}=await F();n.errors=pt,ot=Ra(Ft)}else await W(i);if(p.disabled.size)for(const pt of p.disabled)la(ot,pt);if(la(n.errors,"root"),ao(n.errors)){T.state.next({errors:{}});try{await ge(ot,We)}catch(pt){gt=pt}}else Ne&&await Ne({...n.errors},We),at(),setTimeout(at);if(T.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ao(n.errors)&&!gt,submitCount:n.submitCount+1,errors:n.errors}),gt)throw gt},Pt=(ge,Ne={})=>{Ot(i,ge)&&(Ji(Ne.defaultValue)?se(ge,Ra(Ot(o,ge))):(se(ge,Ne.defaultValue),Ur(o,ge,Ra(Ne.defaultValue))),Ne.keepTouched||la(n.touchedFields,ge),Ne.keepDirty||(la(n.dirtyFields,ge),n.isDirty=Ne.defaultValue?Y(ge,Ra(Ot(o,ge))):Y()),Ne.keepError||(la(n.errors,ge),b.isValid&&N()),T.state.next({...n}))},Dt=(ge,Ne={})=>{const We=ge?Ra(ge):o,gt=Ra(We),ot=ao(ge),pt=ot?o:gt;if(Ne.keepDefaultValues||(o=We),!Ne.keepValues){if(Ne.keepDirtyValues){const Ft=new Set([...p.mount,...Object.keys(gE(o,u))]);for(const gn of Array.from(Ft))Ot(n.dirtyFields,gn)?Ur(pt,gn,Ot(u,gn)):se(gn,Ot(pt,gn))}else{if(EB&&Ji(ge))for(const Ft of p.mount){const gn=Ot(i,Ft);if(gn&&gn._f){const ur=Array.isArray(gn._f.refs)?gn._f.refs[0]:gn._f.ref;if(WN(ur)){const ia=ur.closest("form");if(ia){ia.reset();break}}}}if(Ne.keepFieldsRef)for(const Ft of p.mount)se(Ft,Ot(pt,Ft));else i={}}u=t.shouldUnregister?Ne.keepDefaultValues?Ra(o):{}:Ra(pt),T.array.next({values:{...pt}}),T.state.next({values:{...pt}})}p={mount:Ne.keepDirtyValues?p.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!b.isValid||!!Ne.keepIsValid||!!Ne.keepDirtyValues,h.watch=!!t.shouldUnregister,T.state.next({submitCount:Ne.keepSubmitCount?n.submitCount:0,isDirty:ot?!1:Ne.keepDirty?n.isDirty:!!(Ne.keepDefaultValues&&!wd(ge,o)),isSubmitted:Ne.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:ot?{}:Ne.keepDirtyValues?Ne.keepDefaultValues&&u?gE(o,u):n.dirtyFields:Ne.keepDefaultValues&&ge?gE(o,ge):Ne.keepDirty?n.dirtyFields:{},touchedFields:Ne.keepTouched?n.touchedFields:{},errors:Ne.keepErrors?n.errors:{},isSubmitSuccessful:Ne.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},cn=(ge,Ne)=>Dt(Ol(ge)?ge(u):ge,Ne),ut=(ge,Ne={})=>{const We=Ot(i,ge),gt=We&&We._f;if(gt){const ot=gt.refs?gt.refs[0]:gt.ref;ot.focus&&(ot.focus(),Ne.shouldSelect&&Ol(ot.select)&&ot.select())}},wt=ge=>{n={...n,...ge}},Le={control:{register:$e,unregister:ze,getFieldState:xe,handleSubmit:je,setError:Te,_subscribe:qe,_runSchema:F,_focusError:at,_getWatch:z,_getDirty:Y,_setValid:N,_setFieldArray:j,_setDisabledField:ft,_setErrors:P,_getFieldArray:Z,_reset:Dt,_resetDefaultValues:()=>Ol(t.defaultValues)&&t.defaultValues().then(ge=>{cn(ge,t.resetOptions),T.state.next({isLoading:!1})}),_removeUnmounted:q,_disableForm:ke,_subjects:T,_proxyFormState:b,get _fields(){return i},get _formValues(){return u},get _state(){return h},set _state(ge){h=ge},get _defaultValues(){return o},get _names(){return p},set _names(ge){p=ge},get _formState(){return n},get _options(){return t},set _options(ge){t={...t,...ge}}},subscribe:st,trigger:ee,register:$e,handleSubmit:je,watch:Pe,setValue:se,getValues:de,reset:cn,resetField:Pt,clearErrors:ve,unregister:ze,setError:Te,setFocus:ut,getFieldState:xe};return{...Le,formControl:Le}}function kHe(e={}){const t=me.useRef(void 0),n=me.useRef(void 0),[i,o]=me.useState({isDirty:!1,isValidating:!1,isLoading:Ol(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Ol(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:i},e.defaultValues&&!Ol(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:h,...p}=PHe(e);t.current={...p,formState:i}}const u=t.current.control;return u._options=e,TB(()=>{const h=u._subscribe({formState:u._proxyFormState,callback:()=>o({...u._formState}),reRenderRoot:!0});return o(p=>({...p,isReady:!0})),u._formState.isReady=!0,h},[u]),me.useEffect(()=>u._disableForm(e.disabled),[u,e.disabled]),me.useEffect(()=>{e.mode&&(u._options.mode=e.mode),e.reValidateMode&&(u._options.reValidateMode=e.reValidateMode)},[u,e.mode,e.reValidateMode]),me.useEffect(()=>{e.errors&&(u._setErrors(e.errors),u._focusError())},[u,e.errors]),me.useEffect(()=>{e.shouldUnregister&&u._subjects.state.next({values:u._getWatch()})},[u,e.shouldUnregister]),me.useEffect(()=>{if(u._proxyFormState.isDirty){const h=u._getDirty();h!==i.isDirty&&u._subjects.state.next({isDirty:h})}},[u,i.isDirty]),me.useEffect(()=>{e.values&&!wd(e.values,n.current)?(u._reset(e.values,{keepFieldsRef:!0,...u._options.resetOptions}),n.current=e.values,o(h=>({...h}))):u._resetDefaultValues()},[u,e.values]),me.useEffect(()=>{u._state.mount||(u._setValid(),u._state.mount=!0),u._state.watch&&(u._state.watch=!1,u._subjects.state.next({...u._formState})),u._removeUnmounted()}),t.current.formState=Xhe(i,u),t.current}var _r;(function(e){e.assertEqual=o=>{};function t(o){}e.assertIs=t;function n(o){throw new Error}e.assertNever=n,e.arrayToEnum=o=>{const u={};for(const h of o)u[h]=h;return u},e.getValidEnumValues=o=>{const u=e.objectKeys(o).filter(p=>typeof o[o[p]]!="number"),h={};for(const p of u)h[p]=o[p];return e.objectValues(h)},e.objectValues=o=>e.objectKeys(o).map(function(u){return o[u]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const u=[];for(const h in o)Object.prototype.hasOwnProperty.call(o,h)&&u.push(h);return u},e.find=(o,u)=>{for(const h of o)if(u(h))return h},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function i(o,u=" | "){return o.map(h=>typeof h=="string"?`'${h}'`:h).join(u)}e.joinValues=i,e.jsonStringifyReplacer=(o,u)=>typeof u=="bigint"?u.toString():u})(_r||(_r={}));var uee;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(uee||(uee={}));const qt=_r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Vh=e=>{switch(typeof e){case"undefined":return qt.undefined;case"string":return qt.string;case"number":return Number.isNaN(e)?qt.nan:qt.number;case"boolean":return qt.boolean;case"function":return qt.function;case"bigint":return qt.bigint;case"symbol":return qt.symbol;case"object":return Array.isArray(e)?qt.array:e===null?qt.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?qt.promise:typeof Map<"u"&&e instanceof Map?qt.map:typeof Set<"u"&&e instanceof Set?qt.set:typeof Date<"u"&&e instanceof Date?qt.date:qt.object;default:return qt.unknown}},_t=_r.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Wd extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(u){return u.message},i={_errors:[]},o=u=>{for(const h of u.issues)if(h.code==="invalid_union")h.unionErrors.map(o);else if(h.code==="invalid_return_type")o(h.returnTypeError);else if(h.code==="invalid_arguments")o(h.argumentsError);else if(h.path.length===0)i._errors.push(n(h));else{let p=i,g=0;for(;g<h.path.length;){const v=h.path[g];g===h.path.length-1?(p[v]=p[v]||{_errors:[]},p[v]._errors.push(n(h))):p[v]=p[v]||{_errors:[]},p=p[v],g++}}};return o(this),i}static assert(t){if(!(t instanceof Wd))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,_r.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},i=[];for(const o of this.issues)if(o.path.length>0){const u=o.path[0];n[u]=n[u]||[],n[u].push(t(o))}else i.push(t(o));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Wd.create=e=>new Wd(e);const OU=(e,t)=>{let n;switch(e.code){case _t.invalid_type:e.received===qt.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case _t.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,_r.jsonStringifyReplacer)}`;break;case _t.unrecognized_keys:n=`Unrecognized key(s) in object: ${_r.joinValues(e.keys,", ")}`;break;case _t.invalid_union:n="Invalid input";break;case _t.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${_r.joinValues(e.options)}`;break;case _t.invalid_enum_value:n=`Invalid enum value. Expected ${_r.joinValues(e.options)}, received '${e.received}'`;break;case _t.invalid_arguments:n="Invalid function arguments";break;case _t.invalid_return_type:n="Invalid function return type";break;case _t.invalid_date:n="Invalid date";break;case _t.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:_r.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case _t.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case _t.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case _t.custom:n="Invalid input";break;case _t.invalid_intersection_types:n="Intersection results could not be merged";break;case _t.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case _t.not_finite:n="Number must be finite";break;default:n=t.defaultError,_r.assertNever(e)}return{message:n}};let jHe=OU;function DHe(){return jHe}const LHe=e=>{const{data:t,path:n,errorMaps:i,issueData:o}=e,u=[...n,...o.path||[]],h={...o,path:u};if(o.message!==void 0)return{...o,path:u,message:o.message};let p="";const g=i.filter(v=>!!v).slice().reverse();for(const v of g)p=v(h,{data:t,defaultError:p}).message;return{...o,path:u,message:p}};function $t(e,t){const n=DHe(),i=LHe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===OU?void 0:OU].filter(o=>!!o)});e.common.issues.push(i)}class Xo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const i=[];for(const o of n){if(o.status==="aborted")return Rn;o.status==="dirty"&&t.dirty(),i.push(o.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,n){const i=[];for(const o of n){const u=await o.key,h=await o.value;i.push({key:u,value:h})}return Xo.mergeObjectSync(t,i)}static mergeObjectSync(t,n){const i={};for(const o of n){const{key:u,value:h}=o;if(u.status==="aborted"||h.status==="aborted")return Rn;u.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),u.value!=="__proto__"&&(typeof h.value<"u"||o.alwaysSet)&&(i[u.value]=h.value)}return{status:t.value,value:i}}}const Rn=Object.freeze({status:"aborted"}),VE=e=>({status:"dirty",value:e}),Wc=e=>({status:"valid",value:e}),dee=e=>e.status==="aborted",hee=e=>e.status==="dirty",my=e=>e.status==="valid",zN=e=>typeof Promise<"u"&&e instanceof Promise;var Yt;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Yt||(Yt={}));class Sf{constructor(t,n,i,o){this._cachedPath=[],this.parent=t,this.data=n,this._path=i,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const fee=(e,t)=>{if(my(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Wd(e.common.issues);return this._error=n,this._error}}};function qn(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:o}=e;if(t&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(h,p)=>{const{message:g}=e;return h.code==="invalid_enum_value"?{message:g??p.defaultError}:typeof p.data>"u"?{message:g??i??p.defaultError}:h.code!=="invalid_type"?{message:p.defaultError}:{message:g??n??p.defaultError}},description:o}}class mr{get description(){return this._def.description}_getType(t){return Vh(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Vh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Xo,ctx:{common:t.parent.common,data:t.data,parsedType:Vh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(zN(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const i=this.safeParse(t,n);if(i.success)return i.data;throw i.error}safeParse(t,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Vh(t)},o=this._parseSync({data:t,path:i.path,parent:i});return fee(i,o)}"~validate"(t){var i,o;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Vh(t)};if(!this["~standard"].async)try{const u=this._parseSync({data:t,path:[],parent:n});return my(u)?{value:u.value}:{issues:n.common.issues}}catch(u){(o=(i=u==null?void 0:u.message)==null?void 0:i.toLowerCase())!=null&&o.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(u=>my(u)?{value:u.value}:{issues:n.common.issues})}async parseAsync(t,n){const i=await this.safeParseAsync(t,n);if(i.success)return i.data;throw i.error}async safeParseAsync(t,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Vh(t)},o=this._parse({data:t,path:i.path,parent:i}),u=await(zN(o)?o:Promise.resolve(o));return fee(i,u)}refine(t,n){const i=o=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(o):n;return this._refinement((o,u)=>{const h=t(o),p=()=>u.addIssue({code:_t.custom,...i(o)});return typeof Promise<"u"&&h instanceof Promise?h.then(g=>g?!0:(p(),!1)):h?!0:(p(),!1)})}refinement(t,n){return this._refinement((i,o)=>t(i)?!0:(o.addIssue(typeof n=="function"?n(i,o):n),!1))}_refinement(t){return new vy({schema:this,typeName:Nn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return pf.create(this,this._def)}nullable(){return yy.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Du.create(this)}promise(){return XN.create(this,this._def)}or(t){return qN.create([this,t],this._def)}and(t){return YN.create(this,t,this._def)}transform(t){return new vy({...qn(this._def),schema:this,typeName:Nn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new kU({...qn(this._def),innerType:this,defaultValue:n,typeName:Nn.ZodDefault})}brand(){return new aze({typeName:Nn.ZodBranded,type:this,...qn(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new jU({...qn(this._def),innerType:this,catchValue:n,typeName:Nn.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return NB.create(this,t)}readonly(){return DU.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const MHe=/^c[^\s-]{8,}$/i,UHe=/^[0-9a-z]+$/,FHe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,VHe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,BHe=/^[a-z0-9_-]{21}$/i,$He=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,WHe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,GHe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,HHe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let yL;const zHe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,KHe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qHe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,YHe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,XHe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,JHe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,afe="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ZHe=new RegExp(`^${afe}$`);function sfe(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function QHe(e){return new RegExp(`^${sfe(e)}$`)}function eze(e){let t=`${afe}T${sfe(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function tze(e,t){return!!((t==="v4"||!t)&&zHe.test(e)||(t==="v6"||!t)&&qHe.test(e))}function nze(e,t){if(!$He.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(i));return!(typeof o!="object"||o===null||"typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||t&&o.alg!==t)}catch{return!1}}function rze(e,t){return!!((t==="v4"||!t)&&KHe.test(e)||(t==="v6"||!t)&&YHe.test(e))}class tf extends mr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==qt.string){const u=this._getOrReturnCtx(t);return $t(u,{code:_t.invalid_type,expected:qt.string,received:u.parsedType}),Rn}const i=new Xo;let o;for(const u of this._def.checks)if(u.kind==="min")t.data.length<u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="max")t.data.length>u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="length"){const h=t.data.length>u.value,p=t.data.length<u.value;(h||p)&&(o=this._getOrReturnCtx(t,o),h?$t(o,{code:_t.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):p&&$t(o,{code:_t.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),i.dirty())}else if(u.kind==="email")GHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"email",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="emoji")yL||(yL=new RegExp(HHe,"u")),yL.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"emoji",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="uuid")VHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"uuid",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="nanoid")BHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"nanoid",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid")MHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"cuid",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid2")UHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"cuid2",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="ulid")FHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"ulid",code:_t.invalid_string,message:u.message}),i.dirty());else if(u.kind==="url")try{new URL(t.data)}catch{o=this._getOrReturnCtx(t,o),$t(o,{validation:"url",code:_t.invalid_string,message:u.message}),i.dirty()}else u.kind==="regex"?(u.regex.lastIndex=0,u.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"regex",code:_t.invalid_string,message:u.message}),i.dirty())):u.kind==="trim"?t.data=t.data.trim():u.kind==="includes"?t.data.includes(u.value,u.position)||(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),i.dirty()):u.kind==="toLowerCase"?t.data=t.data.toLowerCase():u.kind==="toUpperCase"?t.data=t.data.toUpperCase():u.kind==="startsWith"?t.data.startsWith(u.value)||(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.invalid_string,validation:{startsWith:u.value},message:u.message}),i.dirty()):u.kind==="endsWith"?t.data.endsWith(u.value)||(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.invalid_string,validation:{endsWith:u.value},message:u.message}),i.dirty()):u.kind==="datetime"?eze(u).test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.invalid_string,validation:"datetime",message:u.message}),i.dirty()):u.kind==="date"?ZHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.invalid_string,validation:"date",message:u.message}),i.dirty()):u.kind==="time"?QHe(u).test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.invalid_string,validation:"time",message:u.message}),i.dirty()):u.kind==="duration"?WHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"duration",code:_t.invalid_string,message:u.message}),i.dirty()):u.kind==="ip"?tze(t.data,u.version)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"ip",code:_t.invalid_string,message:u.message}),i.dirty()):u.kind==="jwt"?nze(t.data,u.alg)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"jwt",code:_t.invalid_string,message:u.message}),i.dirty()):u.kind==="cidr"?rze(t.data,u.version)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"cidr",code:_t.invalid_string,message:u.message}),i.dirty()):u.kind==="base64"?XHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"base64",code:_t.invalid_string,message:u.message}),i.dirty()):u.kind==="base64url"?JHe.test(t.data)||(o=this._getOrReturnCtx(t,o),$t(o,{validation:"base64url",code:_t.invalid_string,message:u.message}),i.dirty()):_r.assertNever(u);return{status:i.value,value:t.data}}_regex(t,n,i){return this.refinement(o=>t.test(o),{validation:n,code:_t.invalid_string,...Yt.errToObj(i)})}_addCheck(t){return new tf({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Yt.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Yt.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Yt.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Yt.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Yt.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Yt.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Yt.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Yt.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Yt.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Yt.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Yt.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Yt.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Yt.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Yt.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Yt.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Yt.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Yt.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Yt.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Yt.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Yt.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Yt.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Yt.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Yt.errToObj(n)})}nonempty(t){return this.min(1,Yt.errToObj(t))}trim(){return new tf({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new tf({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new tf({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}tf.create=e=>new tf({checks:[],typeName:Nn.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...qn(e)});function ize(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,o=n>i?n:i,u=Number.parseInt(e.toFixed(o).replace(".","")),h=Number.parseInt(t.toFixed(o).replace(".",""));return u%h/10**o}class $0 extends mr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==qt.number){const u=this._getOrReturnCtx(t);return $t(u,{code:_t.invalid_type,expected:qt.number,received:u.parsedType}),Rn}let i;const o=new Xo;for(const u of this._def.checks)u.kind==="int"?_r.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.invalid_type,expected:"integer",received:"float",message:u.message}),o.dirty()):u.kind==="min"?(u.inclusive?t.data<u.value:t.data<=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.too_small,minimum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),o.dirty()):u.kind==="max"?(u.inclusive?t.data>u.value:t.data>=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.too_big,maximum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),o.dirty()):u.kind==="multipleOf"?ize(t.data,u.value)!==0&&(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.not_multiple_of,multipleOf:u.value,message:u.message}),o.dirty()):u.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.not_finite,message:u.message}),o.dirty()):_r.assertNever(u);return{status:o.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Yt.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Yt.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Yt.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Yt.toString(n))}setLimit(t,n,i,o){return new $0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:i,message:Yt.toString(o)}]})}_addCheck(t){return new $0({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Yt.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Yt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Yt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Yt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Yt.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Yt.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Yt.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Yt.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Yt.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&_r.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(n)&&Number.isFinite(t)}}$0.create=e=>new $0({checks:[],typeName:Nn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...qn(e)});class W0 extends mr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==qt.bigint)return this._getInvalidInput(t);let i;const o=new Xo;for(const u of this._def.checks)u.kind==="min"?(u.inclusive?t.data<u.value:t.data<=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.too_small,type:"bigint",minimum:u.value,inclusive:u.inclusive,message:u.message}),o.dirty()):u.kind==="max"?(u.inclusive?t.data>u.value:t.data>=u.value)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.too_big,type:"bigint",maximum:u.value,inclusive:u.inclusive,message:u.message}),o.dirty()):u.kind==="multipleOf"?t.data%u.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),$t(i,{code:_t.not_multiple_of,multipleOf:u.value,message:u.message}),o.dirty()):_r.assertNever(u);return{status:o.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return $t(n,{code:_t.invalid_type,expected:qt.bigint,received:n.parsedType}),Rn}gte(t,n){return this.setLimit("min",t,!0,Yt.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Yt.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Yt.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Yt.toString(n))}setLimit(t,n,i,o){return new W0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:i,message:Yt.toString(o)}]})}_addCheck(t){return new W0({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Yt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Yt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Yt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Yt.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Yt.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}W0.create=e=>new W0({checks:[],typeName:Nn.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...qn(e)});class pee extends mr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==qt.boolean){const i=this._getOrReturnCtx(t);return $t(i,{code:_t.invalid_type,expected:qt.boolean,received:i.parsedType}),Rn}return Wc(t.data)}}pee.create=e=>new pee({typeName:Nn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...qn(e)});class KN extends mr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==qt.date){const u=this._getOrReturnCtx(t);return $t(u,{code:_t.invalid_type,expected:qt.date,received:u.parsedType}),Rn}if(Number.isNaN(t.data.getTime())){const u=this._getOrReturnCtx(t);return $t(u,{code:_t.invalid_date}),Rn}const i=new Xo;let o;for(const u of this._def.checks)u.kind==="min"?t.data.getTime()<u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.too_small,message:u.message,inclusive:!0,exact:!1,minimum:u.value,type:"date"}),i.dirty()):u.kind==="max"?t.data.getTime()>u.value&&(o=this._getOrReturnCtx(t,o),$t(o,{code:_t.too_big,message:u.message,inclusive:!0,exact:!1,maximum:u.value,type:"date"}),i.dirty()):_r.assertNever(u);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new KN({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Yt.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Yt.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}KN.create=e=>new KN({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Nn.ZodDate,...qn(e)});class mee extends mr{_parse(t){if(this._getType(t)!==qt.symbol){const i=this._getOrReturnCtx(t);return $t(i,{code:_t.invalid_type,expected:qt.symbol,received:i.parsedType}),Rn}return Wc(t.data)}}mee.create=e=>new mee({typeName:Nn.ZodSymbol,...qn(e)});class gee extends mr{_parse(t){if(this._getType(t)!==qt.undefined){const i=this._getOrReturnCtx(t);return $t(i,{code:_t.invalid_type,expected:qt.undefined,received:i.parsedType}),Rn}return Wc(t.data)}}gee.create=e=>new gee({typeName:Nn.ZodUndefined,...qn(e)});class vee extends mr{_parse(t){if(this._getType(t)!==qt.null){const i=this._getOrReturnCtx(t);return $t(i,{code:_t.invalid_type,expected:qt.null,received:i.parsedType}),Rn}return Wc(t.data)}}vee.create=e=>new vee({typeName:Nn.ZodNull,...qn(e)});class yee extends mr{constructor(){super(...arguments),this._any=!0}_parse(t){return Wc(t.data)}}yee.create=e=>new yee({typeName:Nn.ZodAny,...qn(e)});class _ee extends mr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Wc(t.data)}}_ee.create=e=>new _ee({typeName:Nn.ZodUnknown,...qn(e)});class xf extends mr{_parse(t){const n=this._getOrReturnCtx(t);return $t(n,{code:_t.invalid_type,expected:qt.never,received:n.parsedType}),Rn}}xf.create=e=>new xf({typeName:Nn.ZodNever,...qn(e)});class bee extends mr{_parse(t){if(this._getType(t)!==qt.undefined){const i=this._getOrReturnCtx(t);return $t(i,{code:_t.invalid_type,expected:qt.void,received:i.parsedType}),Rn}return Wc(t.data)}}bee.create=e=>new bee({typeName:Nn.ZodVoid,...qn(e)});class Du extends mr{_parse(t){const{ctx:n,status:i}=this._processInputParams(t),o=this._def;if(n.parsedType!==qt.array)return $t(n,{code:_t.invalid_type,expected:qt.array,received:n.parsedType}),Rn;if(o.exactLength!==null){const h=n.data.length>o.exactLength.value,p=n.data.length<o.exactLength.value;(h||p)&&($t(n,{code:h?_t.too_big:_t.too_small,minimum:p?o.exactLength.value:void 0,maximum:h?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),i.dirty())}if(o.minLength!==null&&n.data.length<o.minLength.value&&($t(n,{code:_t.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),i.dirty()),o.maxLength!==null&&n.data.length>o.maxLength.value&&($t(n,{code:_t.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((h,p)=>o.type._parseAsync(new Sf(n,h,n.path,p)))).then(h=>Xo.mergeArray(i,h));const u=[...n.data].map((h,p)=>o.type._parseSync(new Sf(n,h,n.path,p)));return Xo.mergeArray(i,u)}get element(){return this._def.type}min(t,n){return new Du({...this._def,minLength:{value:t,message:Yt.toString(n)}})}max(t,n){return new Du({...this._def,maxLength:{value:t,message:Yt.toString(n)}})}length(t,n){return new Du({...this._def,exactLength:{value:t,message:Yt.toString(n)}})}nonempty(t){return this.min(1,t)}}Du.create=(e,t)=>new Du({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Nn.ZodArray,...qn(t)});function mv(e){if(e instanceof da){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=pf.create(mv(i))}return new da({...e._def,shape:()=>t})}else return e instanceof Du?new Du({...e._def,type:mv(e.element)}):e instanceof pf?pf.create(mv(e.unwrap())):e instanceof yy?yy.create(mv(e.unwrap())):e instanceof dm?dm.create(e.items.map(t=>mv(t))):e}class da extends mr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=_r.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==qt.object){const v=this._getOrReturnCtx(t);return $t(v,{code:_t.invalid_type,expected:qt.object,received:v.parsedType}),Rn}const{status:i,ctx:o}=this._processInputParams(t),{shape:u,keys:h}=this._getCached(),p=[];if(!(this._def.catchall instanceof xf&&this._def.unknownKeys==="strip"))for(const v in o.data)h.includes(v)||p.push(v);const g=[];for(const v of h){const b=u[v],E=o.data[v];g.push({key:{status:"valid",value:v},value:b._parse(new Sf(o,E,o.path,v)),alwaysSet:v in o.data})}if(this._def.catchall instanceof xf){const v=this._def.unknownKeys;if(v==="passthrough")for(const b of p)g.push({key:{status:"valid",value:b},value:{status:"valid",value:o.data[b]}});else if(v==="strict")p.length>0&&($t(o,{code:_t.unrecognized_keys,keys:p}),i.dirty());else if(v!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const v=this._def.catchall;for(const b of p){const E=o.data[b];g.push({key:{status:"valid",value:b},value:v._parse(new Sf(o,E,o.path,b)),alwaysSet:b in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const v=[];for(const b of g){const E=await b.key,T=await b.value;v.push({key:E,value:T,alwaysSet:b.alwaysSet})}return v}).then(v=>Xo.mergeObjectSync(i,v)):Xo.mergeObjectSync(i,g)}get shape(){return this._def.shape()}strict(t){return Yt.errToObj,new da({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,i)=>{var u,h;const o=((h=(u=this._def).errorMap)==null?void 0:h.call(u,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:Yt.errToObj(t).message??o}:{message:o}}}:{}})}strip(){return new da({...this._def,unknownKeys:"strip"})}passthrough(){return new da({...this._def,unknownKeys:"passthrough"})}extend(t){return new da({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new da({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Nn.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new da({...this._def,catchall:t})}pick(t){const n={};for(const i of _r.objectKeys(t))t[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new da({...this._def,shape:()=>n})}omit(t){const n={};for(const i of _r.objectKeys(this.shape))t[i]||(n[i]=this.shape[i]);return new da({...this._def,shape:()=>n})}deepPartial(){return mv(this)}partial(t){const n={};for(const i of _r.objectKeys(this.shape)){const o=this.shape[i];t&&!t[i]?n[i]=o:n[i]=o.optional()}return new da({...this._def,shape:()=>n})}required(t){const n={};for(const i of _r.objectKeys(this.shape))if(t&&!t[i])n[i]=this.shape[i];else{let u=this.shape[i];for(;u instanceof pf;)u=u._def.innerType;n[i]=u}return new da({...this._def,shape:()=>n})}keyof(){return ofe(_r.objectKeys(this.shape))}}da.create=(e,t)=>new da({shape:()=>e,unknownKeys:"strip",catchall:xf.create(),typeName:Nn.ZodObject,...qn(t)});da.strictCreate=(e,t)=>new da({shape:()=>e,unknownKeys:"strict",catchall:xf.create(),typeName:Nn.ZodObject,...qn(t)});da.lazycreate=(e,t)=>new da({shape:e,unknownKeys:"strip",catchall:xf.create(),typeName:Nn.ZodObject,...qn(t)});class qN extends mr{_parse(t){const{ctx:n}=this._processInputParams(t),i=this._def.options;function o(u){for(const p of u)if(p.result.status==="valid")return p.result;for(const p of u)if(p.result.status==="dirty")return n.common.issues.push(...p.ctx.common.issues),p.result;const h=u.map(p=>new Wd(p.ctx.common.issues));return $t(n,{code:_t.invalid_union,unionErrors:h}),Rn}if(n.common.async)return Promise.all(i.map(async u=>{const h={...n,common:{...n.common,issues:[]},parent:null};return{result:await u._parseAsync({data:n.data,path:n.path,parent:h}),ctx:h}})).then(o);{let u;const h=[];for(const g of i){const v={...n,common:{...n.common,issues:[]},parent:null},b=g._parseSync({data:n.data,path:n.path,parent:v});if(b.status==="valid")return b;b.status==="dirty"&&!u&&(u={result:b,ctx:v}),v.common.issues.length&&h.push(v.common.issues)}if(u)return n.common.issues.push(...u.ctx.common.issues),u.result;const p=h.map(g=>new Wd(g));return $t(n,{code:_t.invalid_union,unionErrors:p}),Rn}}get options(){return this._def.options}}qN.create=(e,t)=>new qN({options:e,typeName:Nn.ZodUnion,...qn(t)});function PU(e,t){const n=Vh(e),i=Vh(t);if(e===t)return{valid:!0,data:e};if(n===qt.object&&i===qt.object){const o=_r.objectKeys(t),u=_r.objectKeys(e).filter(p=>o.indexOf(p)!==-1),h={...e,...t};for(const p of u){const g=PU(e[p],t[p]);if(!g.valid)return{valid:!1};h[p]=g.data}return{valid:!0,data:h}}else if(n===qt.array&&i===qt.array){if(e.length!==t.length)return{valid:!1};const o=[];for(let u=0;u<e.length;u++){const h=e[u],p=t[u],g=PU(h,p);if(!g.valid)return{valid:!1};o.push(g.data)}return{valid:!0,data:o}}else return n===qt.date&&i===qt.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class YN extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t),o=(u,h)=>{if(dee(u)||dee(h))return Rn;const p=PU(u.value,h.value);return p.valid?((hee(u)||hee(h))&&n.dirty(),{status:n.value,value:p.data}):($t(i,{code:_t.invalid_intersection_types}),Rn)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([u,h])=>o(u,h)):o(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}YN.create=(e,t,n)=>new YN({left:e,right:t,typeName:Nn.ZodIntersection,...qn(n)});class dm extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.parsedType!==qt.array)return $t(i,{code:_t.invalid_type,expected:qt.array,received:i.parsedType}),Rn;if(i.data.length<this._def.items.length)return $t(i,{code:_t.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Rn;!this._def.rest&&i.data.length>this._def.items.length&&($t(i,{code:_t.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const u=[...i.data].map((h,p)=>{const g=this._def.items[p]||this._def.rest;return g?g._parse(new Sf(i,h,i.path,p)):null}).filter(h=>!!h);return i.common.async?Promise.all(u).then(h=>Xo.mergeArray(n,h)):Xo.mergeArray(n,u)}get items(){return this._def.items}rest(t){return new dm({...this._def,rest:t})}}dm.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new dm({items:e,typeName:Nn.ZodTuple,rest:null,...qn(t)})};class Eee extends mr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.parsedType!==qt.map)return $t(i,{code:_t.invalid_type,expected:qt.map,received:i.parsedType}),Rn;const o=this._def.keyType,u=this._def.valueType,h=[...i.data.entries()].map(([p,g],v)=>({key:o._parse(new Sf(i,p,i.path,[v,"key"])),value:u._parse(new Sf(i,g,i.path,[v,"value"]))}));if(i.common.async){const p=new Map;return Promise.resolve().then(async()=>{for(const g of h){const v=await g.key,b=await g.value;if(v.status==="aborted"||b.status==="aborted")return Rn;(v.status==="dirty"||b.status==="dirty")&&n.dirty(),p.set(v.value,b.value)}return{status:n.value,value:p}})}else{const p=new Map;for(const g of h){const v=g.key,b=g.value;if(v.status==="aborted"||b.status==="aborted")return Rn;(v.status==="dirty"||b.status==="dirty")&&n.dirty(),p.set(v.value,b.value)}return{status:n.value,value:p}}}}Eee.create=(e,t,n)=>new Eee({valueType:t,keyType:e,typeName:Nn.ZodMap,...qn(n)});class G0 extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.parsedType!==qt.set)return $t(i,{code:_t.invalid_type,expected:qt.set,received:i.parsedType}),Rn;const o=this._def;o.minSize!==null&&i.data.size<o.minSize.value&&($t(i,{code:_t.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),n.dirty()),o.maxSize!==null&&i.data.size>o.maxSize.value&&($t(i,{code:_t.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),n.dirty());const u=this._def.valueType;function h(g){const v=new Set;for(const b of g){if(b.status==="aborted")return Rn;b.status==="dirty"&&n.dirty(),v.add(b.value)}return{status:n.value,value:v}}const p=[...i.data.values()].map((g,v)=>u._parse(new Sf(i,g,i.path,v)));return i.common.async?Promise.all(p).then(g=>h(g)):h(p)}min(t,n){return new G0({...this._def,minSize:{value:t,message:Yt.toString(n)}})}max(t,n){return new G0({...this._def,maxSize:{value:t,message:Yt.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}G0.create=(e,t)=>new G0({valueType:e,minSize:null,maxSize:null,typeName:Nn.ZodSet,...qn(t)});class wee extends mr{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}wee.create=(e,t)=>new wee({getter:e,typeName:Nn.ZodLazy,...qn(t)});class See extends mr{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return $t(n,{received:n.data,code:_t.invalid_literal,expected:this._def.value}),Rn}return{status:"valid",value:t.data}}get value(){return this._def.value}}See.create=(e,t)=>new See({value:e,typeName:Nn.ZodLiteral,...qn(t)});function ofe(e,t){return new gy({values:e,typeName:Nn.ZodEnum,...qn(t)})}class gy extends mr{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),i=this._def.values;return $t(n,{expected:_r.joinValues(i),received:n.parsedType,code:_t.invalid_type}),Rn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),i=this._def.values;return $t(n,{received:n.data,code:_t.invalid_enum_value,options:i}),Rn}return Wc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return gy.create(t,{...this._def,...n})}exclude(t,n=this._def){return gy.create(this.options.filter(i=>!t.includes(i)),{...this._def,...n})}}gy.create=ofe;class xee extends mr{_parse(t){const n=_r.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==qt.string&&i.parsedType!==qt.number){const o=_r.objectValues(n);return $t(i,{expected:_r.joinValues(o),received:i.parsedType,code:_t.invalid_type}),Rn}if(this._cache||(this._cache=new Set(_r.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const o=_r.objectValues(n);return $t(i,{received:i.data,code:_t.invalid_enum_value,options:o}),Rn}return Wc(t.data)}get enum(){return this._def.values}}xee.create=(e,t)=>new xee({values:e,typeName:Nn.ZodNativeEnum,...qn(t)});class XN extends mr{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==qt.promise&&n.common.async===!1)return $t(n,{code:_t.invalid_type,expected:qt.promise,received:n.parsedType}),Rn;const i=n.parsedType===qt.promise?n.data:Promise.resolve(n.data);return Wc(i.then(o=>this._def.type.parseAsync(o,{path:n.path,errorMap:n.common.contextualErrorMap})))}}XN.create=(e,t)=>new XN({type:e,typeName:Nn.ZodPromise,...qn(t)});class vy extends mr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Nn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:i}=this._processInputParams(t),o=this._def.effect||null,u={addIssue:h=>{$t(i,h),h.fatal?n.abort():n.dirty()},get path(){return i.path}};if(u.addIssue=u.addIssue.bind(u),o.type==="preprocess"){const h=o.transform(i.data,u);if(i.common.async)return Promise.resolve(h).then(async p=>{if(n.value==="aborted")return Rn;const g=await this._def.schema._parseAsync({data:p,path:i.path,parent:i});return g.status==="aborted"?Rn:g.status==="dirty"||n.value==="dirty"?VE(g.value):g});{if(n.value==="aborted")return Rn;const p=this._def.schema._parseSync({data:h,path:i.path,parent:i});return p.status==="aborted"?Rn:p.status==="dirty"||n.value==="dirty"?VE(p.value):p}}if(o.type==="refinement"){const h=p=>{const g=o.refinement(p,u);if(i.common.async)return Promise.resolve(g);if(g instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return p};if(i.common.async===!1){const p=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return p.status==="aborted"?Rn:(p.status==="dirty"&&n.dirty(),h(p.value),{status:n.value,value:p.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(p=>p.status==="aborted"?Rn:(p.status==="dirty"&&n.dirty(),h(p.value).then(()=>({status:n.value,value:p.value}))))}if(o.type==="transform")if(i.common.async===!1){const h=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!my(h))return Rn;const p=o.transform(h.value,u);if(p instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:p}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(h=>my(h)?Promise.resolve(o.transform(h.value,u)).then(p=>({status:n.value,value:p})):Rn);_r.assertNever(o)}}vy.create=(e,t,n)=>new vy({schema:e,typeName:Nn.ZodEffects,effect:t,...qn(n)});vy.createWithPreprocess=(e,t,n)=>new vy({schema:t,effect:{type:"preprocess",transform:e},typeName:Nn.ZodEffects,...qn(n)});class pf extends mr{_parse(t){return this._getType(t)===qt.undefined?Wc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}pf.create=(e,t)=>new pf({innerType:e,typeName:Nn.ZodOptional,...qn(t)});class yy extends mr{_parse(t){return this._getType(t)===qt.null?Wc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}yy.create=(e,t)=>new yy({innerType:e,typeName:Nn.ZodNullable,...qn(t)});class kU extends mr{_parse(t){const{ctx:n}=this._processInputParams(t);let i=n.data;return n.parsedType===qt.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}kU.create=(e,t)=>new kU({innerType:e,typeName:Nn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...qn(t)});class jU extends mr{_parse(t){const{ctx:n}=this._processInputParams(t),i={...n,common:{...n.common,issues:[]}},o=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return zN(o)?o.then(u=>({status:"valid",value:u.status==="valid"?u.value:this._def.catchValue({get error(){return new Wd(i.common.issues)},input:i.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Wd(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}jU.create=(e,t)=>new jU({innerType:e,typeName:Nn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...qn(t)});class Tee extends mr{_parse(t){if(this._getType(t)!==qt.nan){const i=this._getOrReturnCtx(t);return $t(i,{code:_t.invalid_type,expected:qt.nan,received:i.parsedType}),Rn}return{status:"valid",value:t.data}}}Tee.create=e=>new Tee({typeName:Nn.ZodNaN,...qn(e)});class aze extends mr{_parse(t){const{ctx:n}=this._processInputParams(t),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class NB extends mr{_parse(t){const{status:n,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const u=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?Rn:u.status==="dirty"?(n.dirty(),VE(u.value)):this._def.out._parseAsync({data:u.value,path:i.path,parent:i})})();{const o=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?Rn:o.status==="dirty"?(n.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:i.path,parent:i})}}static create(t,n){return new NB({in:t,out:n,typeName:Nn.ZodPipeline})}}class DU extends mr{_parse(t){const n=this._def.innerType._parse(t),i=o=>(my(o)&&(o.value=Object.freeze(o.value)),o);return zN(n)?n.then(o=>i(o)):i(n)}unwrap(){return this._def.innerType}}DU.create=(e,t)=>new DU({innerType:e,typeName:Nn.ZodReadonly,...qn(t)});var Nn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Nn||(Nn={}));const gu=tf.create;xf.create;Du.create;const sze=da.create;qN.create;YN.create;dm.create;gy.create;XN.create;pf.create;yy.create;const Cee=(e,t,n)=>{if(e&&"reportValidity"in e){const i=Ot(n,t);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},cfe=(e,t)=>{for(const n in t.fields){const i=t.fields[n];i&&i.ref&&"reportValidity"in i.ref?Cee(i.ref,n,e):i.refs&&i.refs.forEach(o=>Cee(o,n,e))}},oze=(e,t)=>{t.shouldUseNativeValidation&&cfe(e,t);const n={};for(const i in e){const o=Ot(t.fields,i),u=Object.assign(e[i]||{},{ref:o&&o.ref});if(cze(t.names||Object.keys(e),i)){const h=Object.assign({},Ot(n,i));Ur(h,"root",u),Ur(n,i,h)}else Ur(n,i,u)}return n},cze=(e,t)=>e.some(n=>n.startsWith(t+"."));var lze=function(e,t){for(var n={};e.length;){var i=e[0],o=i.code,u=i.message,h=i.path.join(".");if(!n[h])if("unionErrors"in i){var p=i.unionErrors[0].errors[0];n[h]={message:p.message,type:p.code}}else n[h]={message:u,type:o};if("unionErrors"in i&&i.unionErrors.forEach(function(b){return b.errors.forEach(function(E){return e.push(E)})}),t){var g=n[h].types,v=g&&g[i.code];n[h]=Zhe(h,t,n,o,v?[].concat(v,i.message):i.message)}e.shift()}return n},uze=function(e,t,n){return n===void 0&&(n={}),function(i,o,u){try{return Promise.resolve(function(h,p){try{var g=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](i,t)).then(function(v){return u.shouldUseNativeValidation&&cfe({},u),{errors:{},values:n.raw?i:v}})}catch(v){return p(v)}return g&&g.then?g.then(void 0,p):g}(0,function(h){if(function(p){return Array.isArray(p==null?void 0:p.errors)}(h))return{values:{},errors:oze(lze(h.errors,!u.shouldUseNativeValidation&&u.criteriaMode==="all"),u)};throw h}))}catch(h){return Promise.reject(h)}}};const dze=mHe,lfe=w.createContext({}),vu=({...e})=>c.jsx(lfe.Provider,{value:{name:e.name},children:c.jsx(_He,{...e})}),iI=()=>{const e=w.useContext(lfe),t=w.useContext(ufe),{getFieldState:n,formState:i}=rI(),o=n(e.name,i);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:u}=t;return{id:u,name:e.name,formItemId:`${u}-form-item`,formDescriptionId:`${u}-form-item-description`,formMessageId:`${u}-form-item-message`,...o}},ufe=w.createContext({}),vl=w.forwardRef(({className:e,...t},n)=>{const i=w.useId();return c.jsx(ufe.Provider,{value:{id:i},children:c.jsx("div",{ref:n,className:jt("space-y-2",e),...t})})});vl.displayName="FormItem";const yl=w.forwardRef(({className:e,...t},n)=>{const{error:i,formItemId:o}=iI();return c.jsx(Qe,{ref:n,className:jt(i&&"text-destructive",e),htmlFor:o,...t})});yl.displayName="FormLabel";const _l=w.forwardRef(({...e},t)=>{const{error:n,formItemId:i,formDescriptionId:o,formMessageId:u}=iI();return c.jsx(koe,{ref:t,id:i,"aria-describedby":n?`${o} ${u}`:`${o}`,"aria-invalid":!!n,...e})});_l.displayName="FormControl";const hze=w.forwardRef(({className:e,...t},n)=>{const{formDescriptionId:i}=iI();return c.jsx("p",{ref:n,id:i,className:jt("text-sm text-muted-foreground",e),...t})});hze.displayName="FormDescription";const bl=w.forwardRef(({className:e,children:t,...n},i)=>{const{error:o,formMessageId:u}=iI(),h=o?String(o==null?void 0:o.message):t;return h?c.jsx("p",{ref:i,id:u,className:jt("text-sm font-medium text-destructive",e),...n,children:h}):null});bl.displayName="FormMessage";const fze=Gw("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function pze({className:e,variant:t,...n}){return c.jsx("div",{className:jt(fze({variant:t}),e),...n})}const qC="https://api.gada.chat",mze=sze({name:gu().min(2,"Name is required"),username:gu().min(3,"Username must be at least 3 characters").regex(/^[a-z0-9._-]+$/i,"Only letters, numbers, dot, underscore, dash"),phone:gu().min(7,"Phone is required").max(20).regex(/^[+0-9 ()-]+$/,"Invalid phone number"),email:gu().email("Invalid email"),state:gu().min(2,"State is required"),residentAddress:gu().min(5,"Address is required"),residentialState:gu().min(2,"Residential state is required"),proposedLocation:gu().min(2,"Proposed location is required"),gadaChatUsername:gu().min(3,"Gada.chat username is required").regex(/^[a-z0-9._-]+$/i,"Only letters, numbers, dot, underscore, dash"),note:gu().min(10,"Please add a short note").max(600,"Max 600 chars")});function Ree(){const{user:e,accessToken:t}=ct(),n=St(t),[i,o]=w.useState(!1),[u,h]=w.useState(!0),[p,g]=w.useState(null),[v,b]=w.useState(!0),[E,T]=w.useState([]),C=w.useRef(!1),R=kHe({resolver:uze(mze),defaultValues:{name:"",username:"",phone:"",email:"",state:"",residentAddress:"",residentialState:"",proposedLocation:"",gadaChatUsername:"",note:""},mode:"onBlur"});w.useEffect(()=>{C.current=!1},[t]),w.useEffect(()=>{if(!t||C.current)return;C.current=!0;const k=new AbortController;return(async()=>{try{h(!0);const P=await fetch(`${qC}/api/pro/activepackage/`,{headers:n,credentials:"include",signal:k.signal});if(P.ok){const U=await P.json();T(U==null?void 0:U.data)}console.log(P,"packagedet");const M=await fetch(`${qC}/api/representatives/me`,{headers:n,credentials:"include",signal:k.signal});if(M.status===404){g(null),b(!0);return}if(!M.ok){const U=await M.json().catch(()=>({}));throw new Error((U==null?void 0:U.error)||"Failed to load application")}const D=await M.json();g(D),R.reset({name:D.name,username:D.username,phone:D.phone,email:D.email,state:D.state,residentAddress:D.residentAddress,residentialState:D.residentialState,proposedLocation:D.proposedLocation,gadaChatUsername:D.gadaChatUsername,note:D.note}),b(!1)}catch(P){if((P==null?void 0:P.name)==="AbortError")return;console.error(P),Ce.error("Could not load representative application.")}finally{h(!1)}})(),()=>k.abort()},[t]);const N=async k=>{try{o(!0);const P=!!p,M=P?`${qC}/api/representatives/me`:`${qC}/api/representatives`,U=await fetch(M,{method:P?"PUT":"POST",headers:{...n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(k)});if(!U.ok){const H=await U.json().catch(()=>({}));throw new Error((H==null?void 0:H.error)||"Failed to save application")}const F=await U.json();g(F),b(!1),Ce.success(P?"Your changes have been saved":"We’ll review and get back to you shortly")}catch(P){Ce.error((P==null?void 0:P.message)??"Please try again")}finally{o(!1)}},O=p!=null&&p.status?c.jsx(pze,{variant:p.status==="approved"?"default":p.status==="rejected"?"destructive":"secondary",className:"capitalize",children:p.status}):null,j=u||i||!v&&!!p;return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 min-h-0 overflow-y-auto",children:c.jsx("div",{className:"w-full max-w-5xl 2xl:max-w-6xl mx-auto",children:c.jsxs("div",{className:"rounded-xl shadow-sm border bg-white overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-[#7C3AED] via-[#5B6CFA] to-[#1D4ED8] p-6",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-white text-2xl font-bold",children:"Become a Representative"}),c.jsx("p",{className:"text-white/90",children:"Share a few details and the team will reach out if it’s a fit."})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[O,!!p&&c.jsx(be,{type:"button",variant:v?"secondary":"outline",onClick:()=>b(k=>!k),disabled:u||i,className:"bg-white/10 text-white hover:bg-white/20 border-white/20",children:v?"Cancel":"Edit"})]})]})}),c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"mb-6 rounded-lg border border-amber-300 bg-amber-50 p-4",children:c.jsx("p",{className:"text-sm text-amber-900",children:"Only VVIP user can request to be a Representative"})}),c.jsx(dze,{...R,children:c.jsxs("form",{onSubmit:R.handleSubmit(N),className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(vu,{control:R.control,name:"name",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Name"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"Full name",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsx(vu,{control:R.control,name:"username",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Username"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"username",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsx(vu,{control:R.control,name:"phone",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Phone number"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"+234...",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsx(vu,{control:R.control,name:"email",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Email"}),c.jsx(_l,{children:c.jsx(Ae,{type:"email",placeholder:"you@example.com",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsx(vu,{control:R.control,name:"state",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"State"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"e.g., Lagos",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsx(vu,{control:R.control,name:"residentialState",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Residential state"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"e.g., Lagos",...k,disabled:j})}),c.jsx(bl,{})]})})]}),c.jsx(vu,{control:R.control,name:"residentAddress",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Resident address"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"Street, city, state",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(vu,{control:R.control,name:"proposedLocation",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Proposed location to represent"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"City / area",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsx(vu,{control:R.control,name:"gadaChatUsername",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Gada.chat username"}),c.jsx(_l,{children:c.jsx(Ae,{placeholder:"@yourhandle",...k,disabled:j})}),c.jsx(bl,{})]})})]}),c.jsx(vu,{control:R.control,name:"note",render:({field:k})=>c.jsxs(vl,{children:[c.jsx(yl,{children:"Little note about yourself"}),c.jsx(_l,{children:c.jsx(Ei,{placeholder:"Tell us briefly about yourself, experience, and why you’d like to represent.",className:"min-h-[120px] resize-y",...k,disabled:j})}),c.jsx(bl,{})]})}),c.jsxs("div",{className:"flex justify-end gap-3",children:[!!p&&v&&c.jsx(be,{type:"button",variant:"outline",onClick:()=>{p&&(ti,R.reset({name:p.name,username:p.username,phone:p.phone,email:p.email,state:p.state,residentAddress:p.residentAddress,residentialState:p.residentialState,proposedLocation:p.proposedLocation,gadaChatUsername:p.gadaChatUsername,note:p.note})),b(!1)},disabled:i,children:"Cancel"}),(E==null?void 0:E.packageName)&&(E==null?void 0:E.packageName)=="GADA VVIP"&&c.jsx(be,{type:"submit",disabled:i||!v&&!!p,className:"bg-[#1877F2] hover:bg-[#166FE5]",children:i?"Saving…":p?v?"Save Changes":"Locked":"Submit application"})]})]})}),!!p&&c.jsxs("p",{className:"mt-4 text-xs text-gray-500",children:["Last updated: ",p.updatedAt?new Date(p.updatedAt).toLocaleString():"—"]})]})]})})})]})})]})}var gze=[" ","Enter","ArrowUp","ArrowDown"],vze=[" ","Enter"],hm="Select",[aI,sI,yze]=G4(hm),[s_,dxt]=Fs(hm,[yze,If]),oI=If(),[_ze,Df]=s_(hm),[bze,Eze]=s_(hm),dfe=e=>{const{__scopeSelect:t,children:n,open:i,defaultOpen:o,onOpenChange:u,value:h,defaultValue:p,onValueChange:g,dir:v,name:b,autoComplete:E,disabled:T,required:C,form:R}=e,N=oI(t),[O,j]=w.useState(null),[k,P]=w.useState(null),[M,D]=w.useState(!1),U=n_(v),[F,H]=Bd({prop:i,defaultProp:o??!1,onChange:u,caller:hm}),[W,q]=Bd({prop:h,defaultProp:p,onChange:g,caller:hm}),Y=w.useRef(null),z=O?R||!!O.closest("form"):!0,[Z,X]=w.useState(new Set),ae=Array.from(Z).map(se=>se.props.value).join(";");return c.jsx(b4,{...N,children:c.jsxs(_ze,{required:C,scope:t,trigger:O,onTriggerChange:j,valueNode:k,onValueNodeChange:P,valueNodeHasChildren:M,onValueNodeHasChildrenChange:D,contentId:Ll(),value:W,onValueChange:q,open:F,onOpenChange:H,dir:U,triggerPointerDownPosRef:Y,disabled:T,children:[c.jsx(aI.Provider,{scope:t,children:c.jsx(bze,{scope:e.__scopeSelect,onNativeOptionAdd:w.useCallback(se=>{X(J=>new Set(J).add(se))},[]),onNativeOptionRemove:w.useCallback(se=>{X(J=>{const re=new Set(J);return re.delete(se),re})},[]),children:n})}),z?c.jsxs(Dfe,{"aria-hidden":!0,required:C,tabIndex:-1,name:b,autoComplete:E,value:W,onChange:se=>q(se.target.value),disabled:T,form:R,children:[W===void 0?c.jsx("option",{value:""}):null,Array.from(Z)]},ae):null]})})};dfe.displayName=hm;var hfe="SelectTrigger",ffe=w.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:i=!1,...o}=e,u=oI(n),h=Df(hfe,n),p=h.disabled||i,g=Dn(t,h.onTriggerChange),v=sI(n),b=w.useRef("touch"),[E,T,C]=Mfe(N=>{const O=v().filter(P=>!P.disabled),j=O.find(P=>P.value===h.value),k=Ufe(O,N,j);k!==void 0&&h.onValueChange(k.value)}),R=N=>{p||(h.onOpenChange(!0),C()),N&&(h.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return c.jsx(Mw,{asChild:!0,...u,children:c.jsx(Qt.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:p,"data-disabled":p?"":void 0,"data-placeholder":Lfe(h.value)?"":void 0,...o,ref:g,onClick:Tt(o.onClick,N=>{N.currentTarget.focus(),b.current!=="mouse"&&R(N)}),onPointerDown:Tt(o.onPointerDown,N=>{b.current=N.pointerType;const O=N.target;O.hasPointerCapture(N.pointerId)&&O.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(R(N),N.preventDefault())}),onKeyDown:Tt(o.onKeyDown,N=>{const O=E.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&T(N.key),!(O&&N.key===" ")&&gze.includes(N.key)&&(R(),N.preventDefault())})})})});ffe.displayName=hfe;var pfe="SelectValue",mfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:o,children:u,placeholder:h="",...p}=e,g=Df(pfe,n),{onValueNodeHasChildrenChange:v}=g,b=u!==void 0,E=Dn(t,g.onValueNodeChange);return va(()=>{v(b)},[v,b]),c.jsx(Qt.span,{...p,ref:E,style:{pointerEvents:"none"},children:Lfe(g.value)?c.jsx(c.Fragment,{children:h}):u})});mfe.displayName=pfe;var wze="SelectIcon",gfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,children:i,...o}=e;return c.jsx(Qt.span,{"aria-hidden":!0,...o,ref:t,children:i||"▼"})});gfe.displayName=wze;var Sze="SelectPortal",vfe=e=>c.jsx(Uw,{asChild:!0,...e});vfe.displayName=Sze;var fm="SelectContent",yfe=w.forwardRef((e,t)=>{const n=Df(fm,e.__scopeSelect),[i,o]=w.useState();if(va(()=>{o(new DocumentFragment)},[]),!n.open){const u=i;return u?Af.createPortal(c.jsx(_fe,{scope:e.__scopeSelect,children:c.jsx(aI.Slot,{scope:e.__scopeSelect,children:c.jsx("div",{children:e.children})})}),u):null}return c.jsx(bfe,{...e,ref:t})});yfe.displayName=fm;var El=10,[_fe,Lf]=s_(fm),xze="SelectContentImpl",Tze=yf("SelectContent.RemoveScroll"),bfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:u,onPointerDownOutside:h,side:p,sideOffset:g,align:v,alignOffset:b,arrowPadding:E,collisionBoundary:T,collisionPadding:C,sticky:R,hideWhenDetached:N,avoidCollisions:O,...j}=e,k=Df(fm,n),[P,M]=w.useState(null),[D,U]=w.useState(null),F=Dn(t,ze=>M(ze)),[H,W]=w.useState(null),[q,Y]=w.useState(null),z=sI(n),[Z,X]=w.useState(!1),ae=w.useRef(!1);w.useEffect(()=>{if(P)return P1(P)},[P]),I1();const se=w.useCallback(ze=>{const[ft,...$e]=z().map(je=>je.ref.current),[at]=$e.slice(-1),ke=document.activeElement;for(const je of ze)if(je===ke||(je==null||je.scrollIntoView({block:"nearest"}),je===ft&&D&&(D.scrollTop=0),je===at&&D&&(D.scrollTop=D.scrollHeight),je==null||je.focus(),document.activeElement!==ke))return},[z,D]),J=w.useCallback(()=>se([H,P]),[se,H,P]);w.useEffect(()=>{Z&&J()},[Z,J]);const{onOpenChange:re,triggerPointerDownPosRef:ee}=k;w.useEffect(()=>{if(P){let ze={x:0,y:0};const ft=at=>{var ke,je;ze={x:Math.abs(Math.round(at.pageX)-(((ke=ee.current)==null?void 0:ke.x)??0)),y:Math.abs(Math.round(at.pageY)-(((je=ee.current)==null?void 0:je.y)??0))}},$e=at=>{ze.x<=10&&ze.y<=10?at.preventDefault():P.contains(at.target)||re(!1),document.removeEventListener("pointermove",ft),ee.current=null};return ee.current!==null&&(document.addEventListener("pointermove",ft),document.addEventListener("pointerup",$e,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ft),document.removeEventListener("pointerup",$e,{capture:!0})}}},[P,re,ee]),w.useEffect(()=>{const ze=()=>re(!1);return window.addEventListener("blur",ze),window.addEventListener("resize",ze),()=>{window.removeEventListener("blur",ze),window.removeEventListener("resize",ze)}},[re]);const[de,xe]=Mfe(ze=>{const ft=z().filter(ke=>!ke.disabled),$e=ft.find(ke=>ke.ref.current===document.activeElement),at=Ufe(ft,ze,$e);at&&setTimeout(()=>at.ref.current.focus())}),ve=w.useCallback((ze,ft,$e)=>{const at=!ae.current&&!$e;(k.value!==void 0&&k.value===ft||at)&&(W(ze),at&&(ae.current=!0))},[k.value]),Te=w.useCallback(()=>P==null?void 0:P.focus(),[P]),Pe=w.useCallback((ze,ft,$e)=>{const at=!ae.current&&!$e;(k.value!==void 0&&k.value===ft||at)&&Y(ze)},[k.value]),qe=i==="popper"?LU:Efe,st=qe===LU?{side:p,sideOffset:g,align:v,alignOffset:b,arrowPadding:E,collisionBoundary:T,collisionPadding:C,sticky:R,hideWhenDetached:N,avoidCollisions:O}:{};return c.jsx(_fe,{scope:n,content:P,viewport:D,onViewportChange:U,itemRefCallback:ve,selectedItem:H,onItemLeave:Te,itemTextRefCallback:Pe,focusSelectedItem:J,selectedItemText:q,position:i,isPositioned:Z,searchRef:de,children:c.jsx(zw,{as:Tze,allowPinchZoom:!0,children:c.jsx(Hw,{asChild:!0,trapped:k.open,onMountAutoFocus:ze=>{ze.preventDefault()},onUnmountAutoFocus:Tt(o,ze=>{var ft;(ft=k.trigger)==null||ft.focus({preventScroll:!0}),ze.preventDefault()}),children:c.jsx(Gy,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:u,onPointerDownOutside:h,onFocusOutside:ze=>ze.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:c.jsx(qe,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:ze=>ze.preventDefault(),...j,...st,onPlaced:()=>X(!0),ref:F,style:{display:"flex",flexDirection:"column",outline:"none",...j.style},onKeyDown:Tt(j.onKeyDown,ze=>{const ft=ze.ctrlKey||ze.altKey||ze.metaKey;if(ze.key==="Tab"&&ze.preventDefault(),!ft&&ze.key.length===1&&xe(ze.key),["ArrowUp","ArrowDown","Home","End"].includes(ze.key)){let at=z().filter(ke=>!ke.disabled).map(ke=>ke.ref.current);if(["ArrowUp","End"].includes(ze.key)&&(at=at.slice().reverse()),["ArrowUp","ArrowDown"].includes(ze.key)){const ke=ze.target,je=at.indexOf(ke);at=at.slice(je+1)}setTimeout(()=>se(at)),ze.preventDefault()}})})})})})})});bfe.displayName=xze;var Cze="SelectItemAlignedPosition",Efe=w.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:i,...o}=e,u=Df(fm,n),h=Lf(fm,n),[p,g]=w.useState(null),[v,b]=w.useState(null),E=Dn(t,F=>b(F)),T=sI(n),C=w.useRef(!1),R=w.useRef(!0),{viewport:N,selectedItem:O,selectedItemText:j,focusSelectedItem:k}=h,P=w.useCallback(()=>{if(u.trigger&&u.valueNode&&p&&v&&N&&O&&j){const F=u.trigger.getBoundingClientRect(),H=v.getBoundingClientRect(),W=u.valueNode.getBoundingClientRect(),q=j.getBoundingClientRect();if(u.dir!=="rtl"){const ke=q.left-H.left,je=W.left-ke,Pt=F.left-je,Dt=F.width+Pt,cn=Math.max(Dt,H.width),ut=window.innerWidth-El,wt=EU(je,[El,Math.max(El,ut-cn)]);p.style.minWidth=Dt+"px",p.style.left=wt+"px"}else{const ke=H.right-q.right,je=window.innerWidth-W.right-ke,Pt=window.innerWidth-F.right-je,Dt=F.width+Pt,cn=Math.max(Dt,H.width),ut=window.innerWidth-El,wt=EU(je,[El,Math.max(El,ut-cn)]);p.style.minWidth=Dt+"px",p.style.right=wt+"px"}const Y=T(),z=window.innerHeight-El*2,Z=N.scrollHeight,X=window.getComputedStyle(v),ae=parseInt(X.borderTopWidth,10),se=parseInt(X.paddingTop,10),J=parseInt(X.borderBottomWidth,10),re=parseInt(X.paddingBottom,10),ee=ae+se+Z+re+J,de=Math.min(O.offsetHeight*5,ee),xe=window.getComputedStyle(N),ve=parseInt(xe.paddingTop,10),Te=parseInt(xe.paddingBottom,10),Pe=F.top+F.height/2-El,qe=z-Pe,st=O.offsetHeight/2,ze=O.offsetTop+st,ft=ae+se+ze,$e=ee-ft;if(ft<=Pe){const ke=Y.length>0&&O===Y[Y.length-1].ref.current;p.style.bottom="0px";const je=v.clientHeight-N.offsetTop-N.offsetHeight,Pt=Math.max(qe,st+(ke?Te:0)+je+J),Dt=ft+Pt;p.style.height=Dt+"px"}else{const ke=Y.length>0&&O===Y[0].ref.current;p.style.top="0px";const Pt=Math.max(Pe,ae+N.offsetTop+(ke?ve:0)+st)+$e;p.style.height=Pt+"px",N.scrollTop=ft-Pe+N.offsetTop}p.style.margin=`${El}px 0`,p.style.minHeight=de+"px",p.style.maxHeight=z+"px",i==null||i(),requestAnimationFrame(()=>C.current=!0)}},[T,u.trigger,u.valueNode,p,v,N,O,j,u.dir,i]);va(()=>P(),[P]);const[M,D]=w.useState();va(()=>{v&&D(window.getComputedStyle(v).zIndex)},[v]);const U=w.useCallback(F=>{F&&R.current===!0&&(P(),k==null||k(),R.current=!1)},[P,k]);return c.jsx(Nze,{scope:n,contentWrapper:p,shouldExpandOnScrollRef:C,onScrollButtonChange:U,children:c.jsx("div",{ref:g,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:M},children:c.jsx(Qt.div,{...o,ref:E,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});Efe.displayName=Cze;var Rze="SelectPopperPosition",LU=w.forwardRef((e,t)=>{const{__scopeSelect:n,align:i="start",collisionPadding:o=El,...u}=e,h=oI(n);return c.jsx(b1,{...h,...u,ref:t,align:i,collisionPadding:o,style:{boxSizing:"border-box",...u.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});LU.displayName=Rze;var[Nze,AB]=s_(fm,{}),MU="SelectViewport",wfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:i,...o}=e,u=Lf(MU,n),h=AB(MU,n),p=Dn(t,u.onViewportChange),g=w.useRef(0);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),c.jsx(aI.Slot,{scope:n,children:c.jsx(Qt.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:p,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:Tt(o.onScroll,v=>{const b=v.currentTarget,{contentWrapper:E,shouldExpandOnScrollRef:T}=h;if(T!=null&&T.current&&E){const C=Math.abs(g.current-b.scrollTop);if(C>0){const R=window.innerHeight-El*2,N=parseFloat(E.style.minHeight),O=parseFloat(E.style.height),j=Math.max(N,O);if(j<R){const k=j+C,P=Math.min(R,k),M=k-P;E.style.height=P+"px",E.style.bottom==="0px"&&(b.scrollTop=M>0?M:0,E.style.justifyContent="flex-end")}}}g.current=b.scrollTop})})})]})});wfe.displayName=MU;var Sfe="SelectGroup",[Aze,Ize]=s_(Sfe),Oze=w.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,o=Ll();return c.jsx(Aze,{scope:n,id:o,children:c.jsx(Qt.div,{role:"group","aria-labelledby":o,...i,ref:t})})});Oze.displayName=Sfe;var xfe="SelectLabel",Tfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,o=Ize(xfe,n);return c.jsx(Qt.div,{id:o.id,...i,ref:t})});Tfe.displayName=xfe;var JN="SelectItem",[Pze,Cfe]=s_(JN),Rfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,value:i,disabled:o=!1,textValue:u,...h}=e,p=Df(JN,n),g=Lf(JN,n),v=p.value===i,[b,E]=w.useState(u??""),[T,C]=w.useState(!1),R=Dn(t,k=>{var P;return(P=g.itemRefCallback)==null?void 0:P.call(g,k,i,o)}),N=Ll(),O=w.useRef("touch"),j=()=>{o||(p.onValueChange(i),p.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return c.jsx(Pze,{scope:n,value:i,disabled:o,textId:N,isSelected:v,onItemTextChange:w.useCallback(k=>{E(P=>P||((k==null?void 0:k.textContent)??"").trim())},[]),children:c.jsx(aI.ItemSlot,{scope:n,value:i,disabled:o,textValue:b,children:c.jsx(Qt.div,{role:"option","aria-labelledby":N,"data-highlighted":T?"":void 0,"aria-selected":v&&T,"data-state":v?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...h,ref:R,onFocus:Tt(h.onFocus,()=>C(!0)),onBlur:Tt(h.onBlur,()=>C(!1)),onClick:Tt(h.onClick,()=>{O.current!=="mouse"&&j()}),onPointerUp:Tt(h.onPointerUp,()=>{O.current==="mouse"&&j()}),onPointerDown:Tt(h.onPointerDown,k=>{O.current=k.pointerType}),onPointerMove:Tt(h.onPointerMove,k=>{var P;O.current=k.pointerType,o?(P=g.onItemLeave)==null||P.call(g):O.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Tt(h.onPointerLeave,k=>{var P;k.currentTarget===document.activeElement&&((P=g.onItemLeave)==null||P.call(g))}),onKeyDown:Tt(h.onKeyDown,k=>{var M;((M=g.searchRef)==null?void 0:M.current)!==""&&k.key===" "||(vze.includes(k.key)&&j(),k.key===" "&&k.preventDefault())})})})})});Rfe.displayName=JN;var BE="SelectItemText",Nfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:o,...u}=e,h=Df(BE,n),p=Lf(BE,n),g=Cfe(BE,n),v=Eze(BE,n),[b,E]=w.useState(null),T=Dn(t,j=>E(j),g.onItemTextChange,j=>{var k;return(k=p.itemTextRefCallback)==null?void 0:k.call(p,j,g.value,g.disabled)}),C=b==null?void 0:b.textContent,R=w.useMemo(()=>c.jsx("option",{value:g.value,disabled:g.disabled,children:C},g.value),[g.disabled,g.value,C]),{onNativeOptionAdd:N,onNativeOptionRemove:O}=v;return va(()=>(N(R),()=>O(R)),[N,O,R]),c.jsxs(c.Fragment,{children:[c.jsx(Qt.span,{id:g.textId,...u,ref:T}),g.isSelected&&h.valueNode&&!h.valueNodeHasChildren?Af.createPortal(u.children,h.valueNode):null]})});Nfe.displayName=BE;var Afe="SelectItemIndicator",Ife=w.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return Cfe(Afe,n).isSelected?c.jsx(Qt.span,{"aria-hidden":!0,...i,ref:t}):null});Ife.displayName=Afe;var UU="SelectScrollUpButton",Ofe=w.forwardRef((e,t)=>{const n=Lf(UU,e.__scopeSelect),i=AB(UU,e.__scopeSelect),[o,u]=w.useState(!1),h=Dn(t,i.onScrollButtonChange);return va(()=>{if(n.viewport&&n.isPositioned){let p=function(){const v=g.scrollTop>0;u(v)};const g=n.viewport;return p(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[n.viewport,n.isPositioned]),o?c.jsx(kfe,{...e,ref:h,onAutoScroll:()=>{const{viewport:p,selectedItem:g}=n;p&&g&&(p.scrollTop=p.scrollTop-g.offsetHeight)}}):null});Ofe.displayName=UU;var FU="SelectScrollDownButton",Pfe=w.forwardRef((e,t)=>{const n=Lf(FU,e.__scopeSelect),i=AB(FU,e.__scopeSelect),[o,u]=w.useState(!1),h=Dn(t,i.onScrollButtonChange);return va(()=>{if(n.viewport&&n.isPositioned){let p=function(){const v=g.scrollHeight-g.clientHeight,b=Math.ceil(g.scrollTop)<v;u(b)};const g=n.viewport;return p(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[n.viewport,n.isPositioned]),o?c.jsx(kfe,{...e,ref:h,onAutoScroll:()=>{const{viewport:p,selectedItem:g}=n;p&&g&&(p.scrollTop=p.scrollTop+g.offsetHeight)}}):null});Pfe.displayName=FU;var kfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:i,...o}=e,u=Lf("SelectScrollButton",n),h=w.useRef(null),p=sI(n),g=w.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return w.useEffect(()=>()=>g(),[g]),va(()=>{var b;const v=p().find(E=>E.ref.current===document.activeElement);(b=v==null?void 0:v.ref.current)==null||b.scrollIntoView({block:"nearest"})},[p]),c.jsx(Qt.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:Tt(o.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(i,50))}),onPointerMove:Tt(o.onPointerMove,()=>{var v;(v=u.onItemLeave)==null||v.call(u),h.current===null&&(h.current=window.setInterval(i,50))}),onPointerLeave:Tt(o.onPointerLeave,()=>{g()})})}),kze="SelectSeparator",jfe=w.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return c.jsx(Qt.div,{"aria-hidden":!0,...i,ref:t})});jfe.displayName=kze;var VU="SelectArrow",jze=w.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,o=oI(n),u=Df(VU,n),h=Lf(VU,n);return u.open&&h.position==="popper"?c.jsx(E1,{...o,...i,ref:t}):null});jze.displayName=VU;var Dze="SelectBubbleInput",Dfe=w.forwardRef(({__scopeSelect:e,value:t,...n},i)=>{const o=w.useRef(null),u=Dn(i,o),h=nB(t);return w.useEffect(()=>{const p=o.current;if(!p)return;const g=window.HTMLSelectElement.prototype,b=Object.getOwnPropertyDescriptor(g,"value").set;if(h!==t&&b){const E=new Event("change",{bubbles:!0});b.call(p,t),p.dispatchEvent(E)}},[h,t]),c.jsx(Qt.select,{...n,style:{...sce,...n.style},ref:u,defaultValue:t})});Dfe.displayName=Dze;function Lfe(e){return e===""||e===void 0}function Mfe(e){const t=Ba(e),n=w.useRef(""),i=w.useRef(0),o=w.useCallback(h=>{const p=n.current+h;t(p),function g(v){n.current=v,window.clearTimeout(i.current),v!==""&&(i.current=window.setTimeout(()=>g(""),1e3))}(p)},[t]),u=w.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return w.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,o,u]}function Ufe(e,t,n){const o=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,u=n?e.indexOf(n):-1;let h=Lze(e,Math.max(u,0));o.length===1&&(h=h.filter(v=>v!==n));const g=h.find(v=>v.textValue.toLowerCase().startsWith(o.toLowerCase()));return g!==n?g:void 0}function Lze(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var Mze=dfe,Ffe=ffe,Uze=mfe,Fze=gfe,Vze=vfe,Vfe=yfe,Bze=wfe,Bfe=Tfe,$fe=Rfe,$ze=Nfe,Wze=Ife,Wfe=Ofe,Gfe=Pfe,Hfe=jfe;const Pr=Mze,kr=Uze,Cr=w.forwardRef(({className:e,children:t,...n},i)=>c.jsxs(Ffe,{ref:i,className:jt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,c.jsx(Fze,{asChild:!0,children:c.jsx(Vw,{className:"h-4 w-4 opacity-50"})})]}));Cr.displayName=Ffe.displayName;const zfe=w.forwardRef(({className:e,...t},n)=>c.jsx(Wfe,{ref:n,className:jt("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(P4,{className:"h-4 w-4"})}));zfe.displayName=Wfe.displayName;const Kfe=w.forwardRef(({className:e,...t},n)=>c.jsx(Gfe,{ref:n,className:jt("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(Vw,{className:"h-4 w-4"})}));Kfe.displayName=Gfe.displayName;const Rr=w.forwardRef(({className:e,children:t,position:n="popper",...i},o)=>c.jsx(Vze,{children:c.jsxs(Vfe,{ref:o,className:jt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...i,children:[c.jsx(zfe,{}),c.jsx(Bze,{className:jt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),c.jsx(Kfe,{})]})}));Rr.displayName=Vfe.displayName;const Gze=w.forwardRef(({className:e,...t},n)=>c.jsx(Bfe,{ref:n,className:jt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Gze.displayName=Bfe.displayName;const ht=w.forwardRef(({className:e,children:t,...n},i)=>c.jsxs($fe,{ref:i,className:jt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Wze,{children:c.jsx(Fw,{className:"h-4 w-4"})})}),c.jsx($ze,{children:t})]}));ht.displayName=$fe.displayName;const Hze=w.forwardRef(({className:e,...t},n)=>c.jsx(Hfe,{ref:n,className:jt("-mx-1 my-1 h-px bg-muted",e),...t}));Hze.displayName=Hfe.displayName;const qfe="https://api.gada.chat";async function Nee(e){const t=await fetch(`${qfe}/api/points/overview`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to load points overview");return t.json()}async function zze(e,t={}){const{page:n=1,limit:i=10,q:o="",sort:u="time",dir:h="desc"}=t,p=new URLSearchParams({page:String(n),limit:String(i),q:o,sort:u,dir:h}),g=await fetch(`${qfe}/api/points/logs?${p.toString()}`,{headers:e,credentials:"include"});if(!g.ok)throw new Error("Failed to load transactions");return g.json()}function Kze({type:e}){const t="h-5 w-5";switch(e){case"post":return c.jsx(qce,{className:t});case"view":return c.jsx(k0,{className:t});case"comment":return c.jsx($w,{className:t});case"follow":return c.jsx(Sm,{className:t});case"refer":return c.jsx(c4e,{className:t});case"transfer":return c.jsx(uy,{className:t})}}function qze(){const{accessToken:e}=ct(),t=St(e);w.useRef(0);const n=w.useRef(0);function i(se,J=300){const[re,ee]=w.useState(se);return w.useEffect(()=>{const de=setTimeout(()=>ee(se),J);return()=>clearTimeout(de)},[se,J]),re}const[o,u]=w.useState(!0),[h,p]=w.useState(null),[g,v]=w.useState(10),[b,E]=w.useState(1),[T,C]=w.useState(""),[R,N]=w.useState([]),[O,j]=w.useState(0),k=e||"",P=i(T,350),[M,D]=w.useState(""),[U,F]=w.useState(!1),H=(h==null?void 0:h.rules.conversion.pointsPerNaira)??10,W=!!(h!=null&&h.rules.conversion.enabled),q=typeof M=="number"&&M>0?Math.floor(M/H*100)/100:0,Y=w.useRef(!1);w.useEffect(()=>{if(!k||Y.current)return;Y.current=!0;const se=new AbortController;return(async()=>{try{u(!0);const J=await Nee(t,{signal:se.signal});p(J)}catch(J){(J==null?void 0:J.name)!=="AbortError"&&console.error(J)}finally{u(!1)}})(),()=>se.abort()},[k]),w.useEffect(()=>{if(!k)return;const se=++n.current,J=new AbortController;return u(!0),(async()=>{try{const re=await zze(t,{page:b,limit:g,q:P,sort:"time",dir:"desc",signal:J.signal});N(re.rows),j(re.total),re.page!==b&&E(re.page)}catch(re){(re==null?void 0:re.name)!=="AbortError"&&console.error(re)}finally{n.current===se&&u(!1)}})(),()=>J.abort()},[k,b,g,P]);const z=Math.max(1,Math.ceil(O/g)),Z=Math.min(b,z),X=w.useMemo(()=>h?[{title:"Points",subtitle:"For creating a new post",points:h.rules.post_create,icon:"post"},{title:"Points",subtitle:"For each post view",points:h.rules.post_view,icon:"view"},{title:"Points",subtitle:"For any comment on your post",points:h.rules.post_comment,icon:"comment"},{title:"Points",subtitle:"For each follower you got",points:h.rules.follow,icon:"follow"},{title:"Points",subtitle:"For referring user",points:h.rules.refer,icon:"refer"}]:[],[h]),ae=async()=>{if(!h)return;const se=typeof M=="number"?M:0;if(se<=0)return toast.error("Enter points amount");if(!W)return toast.error("Transfer is currently disabled");if(se>h.balances.points)return toast.error("Insufficient points");F(!0);try{const J=await fetch("https://api.gada.chat/api/points/transfer",{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({points:se})}),re=await J.json();if(!J.ok||!(re!=null&&re.ok))throw new Error((re==null?void 0:re.error)||"Transfer failed");toast.success(`Transferred ${se} points → ₦${re.moved.money}`);const ee=await Nee(t);p(ee),D("")}catch(J){toast.error((J==null?void 0:J.message)||"Transfer failed")}finally{F(!1)}};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky",children:c.jsx(Ss,{})})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsx(Vr,{className:"mb-6 overflow-hidden",children:c.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-indigo-500 p-4 text-white",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"bg-white/20 rounded-md p-2",children:c.jsx(XVe,{className:"h-5 w-5"})}),c.jsxs("div",{className:"space-y-1 text-sm leading-6",children:[c.jsx("div",{className:"font-semibold",children:"Points System"}),c.jsxs("div",{children:["Each ",c.jsx("b",{children:H})," points equal ₦1.",h&&c.jsxs("span",{className:"ml-2",children:["Daily limit: ",c.jsx("b",{children:h.rules.daily_limit})," • Remaining today: ",c.jsx("b",{children:h.remainingToday})]})]}),c.jsxs("div",{children:["Your daily points limit resets ",h?`~ every ${h.windowHours}h`:"daily"," after your last valid earn."]}),c.jsx("div",{children:"You can transfer your money to your wallet."})]})]})})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-indigo-500 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Points Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:[h?h.balances.points.toLocaleString():"—"," Points"]})]})}),c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Wallet Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:["₦",h?h.balances.money.toLocaleString():"—"]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[X.map((se,J)=>c.jsx(Vr,{children:c.jsxs(mi,{className:"p-4 flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold",children:se.points}),c.jsx("div",{className:"text-sm text-gray-500",children:"Points"}),c.jsx("div",{className:"mt-2 text-gray-700 text-sm",children:se.subtitle})]}),c.jsx("div",{className:"rounded-full bg-gray-100 p-2 text-gray-600",children:c.jsx(Kze,{type:se.icon})})]})},J)),c.jsx(Vr,{children:c.jsxs(mi,{className:"p-4 flex flex-col sm:flex-row sm:items-end gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Points to convert"}),c.jsx(Ae,{type:"number",min:0,step:1,value:M,onChange:se=>D(se.target.value===""?"":Math.max(0,Math.floor(Number(se.target.value)))),placeholder:"e.g. 100",className:"max-w-xs"}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Preview: ₦",q,"  •  Rate: ",H," pts = ₦1"]}),!W&&c.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Transfers are currently disabled."})]}),c.jsxs("div",{children:[c.jsx(be,{disabled:!W||U||!M||(h?Number(M)>h.balances.points:!0),onClick:ae,children:U?c.jsxs(c.Fragment,{children:[c.jsx(ei,{className:"h-4 w-4 animate-spin mr-2"})," Transferring…"]}):"Transfer to Wallet"}),h&&M&&Number(M)>h.balances.points&&c.jsx("div",{className:"text-xs text-red-600 mt-2",children:"Insufficient points"})]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-indigo-500 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Points Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:[h?h.balances.points.toLocaleString():"—"," Points"]})]})}),c.jsx(Vr,{className:"overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-5 text-white",children:[c.jsx("div",{className:"text-sm/6 opacity-90",children:"Points Money Balance"}),c.jsxs("div",{className:"mt-2 text-2xl font-semibold",children:["₦",h?h.balances.money.toLocaleString():"—"]})]})})]}),c.jsx(Vr,{children:c.jsxs(mi,{className:"p-4 md:p-6",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Points Transactions"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Show"}),c.jsxs(Pr,{value:String(g),onValueChange:se=>{v(Number(se)),E(1)},children:[c.jsx(Cr,{className:"h-8 w-16",children:c.jsx(kr,{})}),c.jsx(Rr,{children:[10,20,50].map(se=>c.jsx(ht,{value:String(se),children:se},se))})]}),c.jsx("span",{className:"text-sm text-gray-600",children:"entries"})]}),c.jsx("div",{className:"w-56",children:c.jsx(Ae,{placeholder:"Search…",value:T,onChange:se=>{C(se.target.value),E(1)},className:"h-9"})})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"ID"}),c.jsx(nt,{children:"Points"}),c.jsx(nt,{children:"From"}),c.jsx(nt,{children:"Time"})]})}),c.jsxs(ba,{children:[R.map(se=>c.jsxs(tn,{children:[c.jsx(Ke,{className:"font-medium",children:se.id}),c.jsx(Ke,{children:se.points}),c.jsx(Ke,{children:se.from}),c.jsx(Ke,{children:new Date(se.time).toLocaleString()})]},se.id)),!R.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:4,className:"text-center text-gray-500",children:o?"Loading…":"No transactions found."})})]})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(1),disabled:Z===1,children:"First"}),c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(se=>Math.max(1,se-1)),disabled:Z===1,children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",c.jsx("b",{children:Z})," of ",c.jsx("b",{children:Math.max(1,Math.ceil(O/g))})]}),c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(se=>se+1),disabled:Z>=z,children:"Next"}),c.jsx(be,{variant:"outline",size:"sm",onClick:()=>E(z),disabled:Z>=z,children:"Last"})]}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Showing ",R.length?(Z-1)*g+1:0," to ",(Z-1)*g+R.length," of ",O," entries"]})]})})]})]})})]})}const Yfe="https://api.gada.chat";async function Yze(e,t={}){const n=`${Yfe}/api/hashtag/${encodeURIComponent(e)}/summary`,i=await fetch(n,{credentials:"include",headers:t});if(!i.ok)throw new Error("Failed to load hashtag summary");return i.json()}async function Xze(e,{cursor:t,limit:n=10}={},i={}){const o=new URLSearchParams;t&&o.set("cursor",String(t)),n&&o.set("limit",String(n));const u=`${Yfe}/api/hashtag/${encodeURIComponent(e)}/posts?${o.toString()}`,h=await fetch(u,{credentials:"include",headers:i});if(!h.ok)throw new Error("Failed to load hashtag posts");return h.json()}const Jze="https://api.gada.chat";function Zze(e=""){const t=String(e).trim();return t.startsWith("#")?t.slice(1).toLowerCase():t.toLowerCase()}function Qze(){var F;const{tag:e}=Qo(),{accessToken:t}=ct(),n=St(t),i=w.useMemo(()=>Zze(e||""),[e]),o=w.useRef(n);w.useEffect(()=>{o.current=n},[n]);const[u,h]=w.useState(null),[p,g]=w.useState(!0),[v,b]=w.useState(null),[E,T]=w.useState(null),[C,R]=w.useState(null),[N,O]=w.useState(!1),[j,k]=w.useState(!1),P=w.useRef(""),M=w.useRef(""),D=w.useRef(!1);w.useEffect(()=>{if(!i||!t)return;const H=`sum|${i}`;if(P.current===H)return;P.current=H,g(!0),b(null);let W=!1;return Yze(i,o.current).then(q=>{W||h(q)}).catch(q=>{W||b((q==null?void 0:q.message)||"Failed to load")}).finally(()=>{W||g(!1)}),()=>{W=!0}},[i,t]),w.useEffect(()=>{if(!i||!t)return;const H=`posts|${i}`;M.current!==H&&(M.current=H,T(null),R(null),k(!1),Promise.resolve().then(()=>U(!0)))},[i,t]);const U=async(H=!1)=>{if(!(!i||!t)&&!D.current&&!(!H&&j)){D.current=!0,O(!0);try{const{items:W=[],nextCursor:q}=await Xze(i,{cursor:H?null:C,limit:10},o.current);T(Y=>Y?[...Y,...W]:W),R(q??null),(!q||W.length===0)&&k(!0)}catch(W){console.error("[hashtag posts]",W)}finally{D.current=!1,O(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"bg-white shadow",children:c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6",children:[c.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold break-all",children:["#",i]}),c.jsx("div",{className:"text-gray-600 text-sm mt-1",children:p?"Loading…":`${(u==null?void 0:u.counts.posts)??0} posts`}),c.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mt-4",children:[((u==null?void 0:u.previews.photos)||[]).map((H,W)=>c.jsx("div",{className:"aspect-square overflow-hidden rounded bg-gray-100",children:c.jsx("img",{src:Jze+"/uploads/"+Xn(H),alt:"",className:"w-full h-full object-cover"})},W)),!p&&(((F=u==null?void 0:u.previews.photos)==null?void 0:F.length)??0)===0&&c.jsx("div",{className:"text-gray-500 text-sm py-6 col-span-full",children:"No photos yet"})]})]})}),c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 space-y-4",children:[E===null&&N&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:[c.jsx(ei,{className:"h-5 w-5 inline animate-spin mr-2"}),"Loading…"]}),Array.isArray(E)&&E.length>0&&c.jsxs(c.Fragment,{children:[E.map(H=>c.jsx(Vu,{post:H},H.id)),!j&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>U(!1),disabled:N,children:N?"Loading…":"Load more"})})]}),E!==null&&E.length===0&&j&&!N&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts for this hashtag yet"})]})]})}const e9e="https://api.gada.chat";function t9e(){const{accessToken:e,user:t}=ct(),n=St(e),i=Bl(e),o=w.useRef(n),u=w.useRef(i);w.useEffect(()=>{o.current=n,u.current=i},[n,i]);const[h]=Xy(),p=w.useMemo(()=>{const ee=h.get("user");return ee?Number(ee):null},[h]),{openConversation:g}=Cm(),[v,b]=w.useState(null),[E,T]=w.useState(!1),[C,R]=w.useState(null),[N,O]=w.useState(null),[j,k]=w.useState(null),[P,M]=w.useState(!1),[D,U]=w.useState(!1),[F,H]=w.useState(""),[W,q]=w.useState(null),[Y,z]=w.useState(null),Z=w.useRef(!1),[X,ae]=w.useState(!1),se=w.useRef(null);w.useEffect(()=>{e&&(E||v||(T(!0),QE(o.current).then(b).catch(console.error).finally(()=>T(!1))))},[e,v,E]),w.useEffect(()=>{e&&p&&(async()=>{try{const{conversationId:ee}=await NU(p,o.current);if(!v){const de=await QE(o.current);b(de)}R(ee)}catch(ee){console.error("[open from query]",ee)}})()},[e,p]),w.useEffect(()=>{!e||!C||(O(null),k(null),U(!1),Promise.resolve().then(()=>J(!0)))},[e,C]),w.useEffect(()=>{if(!e)return;const ee=gB(e);return se.current=ee,ee.on("message:new",({message:de})=>{C&&de.conversationId===C&&de.authorId!==(t==null?void 0:t.id)&&O(xe=>xe?[...xe,de]:[de]),b(xe=>{if(!xe)return xe;const ve=de.text||(de.image?"[image]":de.voice?"[voice]":"");return xe.some(Pe=>Pe.conversationId===de.conversationId)?xe.map(Pe=>Pe.conversationId===de.conversationId?{...Pe,lastMessage:ve,lastTime:de.time,unread:Pe.conversationId!==C}:Pe):xe})}),ee.on("message:typing",de=>{de.userId!==(t==null?void 0:t.id)&&b(xe=>(xe==null?void 0:xe.map(ve=>ve.conversationId===de.conversationId?{...ve,typing:de.typing}:ve))||null)}),ee.on("message:seen",de=>{de.userId===(t==null?void 0:t.id)&&b(xe=>(xe==null?void 0:xe.map(ve=>ve.conversationId===de.conversationId?{...ve,unread:!1}:ve))||null)}),ee.on("conversation:update",de=>{b(xe=>!xe||!xe.find(Te=>Te.conversationId===de.conversationId)?xe:xe.map(Te=>Te.conversationId===de.conversationId?{...Te,lastMessage:de.lastMessage,lastTime:de.lastTime}:Te))}),()=>{ee.close()}},[e,C,t==null?void 0:t.id]),w.useEffect(()=>{if(!C)return;const ee=setTimeout(()=>{hhe(C,!1,o.current).catch(()=>{})},1e3);return()=>clearTimeout(ee)},[F,C]);const J=async(ee=!1)=>{if(!(!C||!e)&&!Z.current&&!(!ee&&D)){Z.current=!0,M(!0);try{const{items:de=[],nextCursor:xe}=await dhe(C,{cursor:ee?null:j,limit:25},o.current);O(ve=>ve?[...de,...ve]:de),k(xe??null),(!xe||de.length===0)&&U(!0),ee&&(await fhe(C,o.current),b(ve=>(ve==null?void 0:ve.map(Te=>Te.conversationId===C?{...Te,unread:!1}:Te))||null))}catch(de){console.error(de)}finally{Z.current=!1,M(!1)}}},re=async ee=>{try{const{conversationId:de}=await NU(ee.id,o.current);if(!v){const xe=await QE(o.current);b(xe)}R(de),ae(!1)}catch(de){console.error("[open from pick]",de)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"max-w-6xl mx-auto px-2 sm:px-6 py-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-3 md:col-span-1 flex flex-col h-[70vh]",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"text-lg font-semibold",children:"Messages"}),c.jsxs(be,{size:"sm",variant:"secondary",onClick:()=>ae(!0),children:[c.jsx(M4,{className:"h-4 w-4 mr-1"})," New"]})]}),E&&c.jsxs("div",{className:"text-sm text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),Array.isArray(v)&&v.length===0&&c.jsxs("div",{className:"text-sm text-gray-500",children:["No conversations yet. Click ",c.jsx("span",{className:"font-medium",children:"New"})," to start one."]}),c.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain pr-1",children:c.jsx("div",{className:"space-y-1",children:Array.isArray(v)&&v.map(ee=>c.jsxs("button",{onClick:()=>g(ee.conversationId,ee.peer),className:`w-full flex items-center gap-3 px-2 py-2 rounded hover:bg-gray-50 ${C===ee.conversationId?"bg-gray-50":""}`,children:[c.jsxs($i,{className:"h-9 w-9",children:[c.jsx(Ii,{src:ee.peer.avatar?e9e+"/uploads/"+Xn(ee.peer.avatar):""}),c.jsx(ea,{children:(ee.peer.fullName||ee.peer.username).slice(0,1).toUpperCase()})]}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"font-medium truncate",children:ee.peer.fullName||ee.peer.username}),ee.unread&&c.jsx("span",{className:"ml-2 inline-block w-2 h-2 rounded-full bg-[#1877F2]"})]}),c.jsx("div",{className:"text-xs text-gray-500 truncate",children:ee.typing?"typing…":ee.lastMessage})]})]},ee.conversationId))})})]})}),c.jsx(mhe,{open:X,onOpenChange:ae,search:ee=>F6e(ee,o.current),onPick:re})]})}const n9e="https://api.gada.chat";function Bs(e,t){const n=new URL(`${n9e}/api/pages${e}`);return t&&Object.entries(t).forEach(([i,o])=>{o!=null&&o!==""&&n.searchParams.set(i,String(o))}),n.toString()}function tS(e={}){return fetch(Bs("/categories"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load categories");return t.json()})}function r9e(e,t={}){return fetch(Bs(""),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to create page");return n.json()})}function i9e(e,t={}){return fetch(Bs("",e),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load pages");return n.json()})}function a9e(e,t={}){return fetch(Bs(`/${e}`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to fetch page");return n.json()})}function s9e(e,t,n={}){const i=new FormData;return i.append("cover",t),fetch(Bs(`/${e}/cover`),{method:"POST",credentials:"include",headers:n,body:i}).then(o=>{if(!o.ok)throw new Error("Failed to update cover");return o.json()})}function o9e(e,t={}){return fetch(Bs(`/${e}/like`),{method:"POST",credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to like/unlike");return n.json()})}function c9e(e,t,n={}){return fetch(Bs(`/${e}/posts`,t),{credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to load posts");return i.json()})}function l9e(e,t,n={}){return fetch(Bs(`/${e}/posts`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify(t)}).then(i=>{if(!i.ok)throw new Error("Failed to create post");return i.json()})}function u9e(e,t={}){return fetch(Bs("/users/suggest",{q:e}),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to search users");return n.json()})}function nS(e={}){return fetch(Bs("/invites"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load invites");return t.json()})}function Aee(e,t={}){return fetch(Bs(`/${e}/invites`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load page invites");return n.json()})}function d9e(e,t,n={}){return fetch(Bs(`/${e}/invites`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({userId:t})}).then(i=>{if(!i.ok)throw new Error("Failed to invite");return i.json()})}function h9e(e,t,n={}){return fetch(Bs(`/${e}/invites/${t}/accept`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to accept");return i.json()})}function f9e(e,t,n={}){return fetch(Bs(`/${e}/invites/${t}/decline`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to decline");return i.json()})}function p9e(e,t,n){return fetch(Bs(`/${encodeURIComponent(String(e))}/boost`),{method:t?"POST":"DELETE",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to decline");return i.json()})}function cI({cats:e,invCount:t,highlight:n=null}){const{accessToken:i}=ct(),o=St(i),u=w.useRef(o);w.useEffect(()=>{u.current=o},[o]);const[h,p]=w.useState(e??[]),[g,v]=w.useState(t??0);w.useEffect(()=>{if(e){p(e);return}i&&tS(u.current).then(p).catch(()=>{})},[i,e]),w.useEffect(()=>{if(typeof t=="number"){v(t);return}i&&nS(u.current).then(E=>v(E.length)).catch(()=>{})},[i,t]);const b=E=>n===E?"bg-gray-50":"";return c.jsxs("div",{className:"md:sticky md:top-20 bg-white rounded-lg shadow p-3 space-y-2",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Pages"}),c.jsxs(At,{to:"/pages",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(Ef,{className:"h-4 w-4 mr-2"})," Discover"]}),c.jsxs(At,{to:"/pages?my=1",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(qVe,{className:"h-4 w-4 mr-2"})," Your Pages"]}),c.jsxs(At,{to:"/pages/invites",className:`flex items-center justify-between px-3 py-2 rounded hover:bg-gray-100 ${b("invites")}`,children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(L4,{className:"h-4 w-4 mr-2"})," Invites"]}),g>0&&c.jsx("span",{className:"text-xs bg-[#1877F2] text-white rounded-full px-2 py-0.5",children:g})]}),c.jsxs(At,{to:"/pages/create",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(D4,{className:"h-4 w-4 mr-2"})," Create Page"]}),c.jsx("div",{className:"h-px bg-gray-200 my-2"}),c.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide px-1 mb-1",children:"Categories"}),c.jsxs("div",{className:"max-h-64 overflow-auto pr-1 space-y-1",children:[c.jsx(At,{to:"/pages",className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:"All"}),h.map(E=>c.jsx(At,{to:`/pages?categoryId=${E.category_id}`,className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:E.category_name},E.category_id))]})]})}const Iee="https://api.gada.chat";function m9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const[i,o]=Xy();tr();const[u,h]=w.useState(i.get("q")||""),[p,g]=w.useState(i.get("categoryId")?Number(i.get("categoryId")):""),[v,b]=w.useState(i.get("sort")||"popular"),E=i.get("my")==="1",[T,C]=w.useState([]),[R,N]=w.useState(null),[O,j]=w.useState(null),[k,P]=w.useState(!1),[M,D]=w.useState(!1),[U,F]=w.useState(0);w.useEffect(()=>{e&&(tS(n.current).then(C).catch(console.error),nS(n.current).then(W=>F(W.length)).catch(()=>{}))},[e]),w.useEffect(()=>{const W={};u&&(W.q=u),p&&(W.categoryId=p),v&&v!=="popular"&&(W.sort=v),E&&(W.my="1"),o(W,{replace:!0})},[u,p,v,E]),w.useEffect(()=>{e&&(N(null),j(null),D(!1),Promise.resolve().then(()=>H(!0)))},[u,p,v,E,e]);const H=async(W=!1)=>{if(!k&&!(!W&&M)){P(!0);try{const{items:q=[],nextCursor:Y}=await i9e({q:u.trim(),categoryId:p||void 0,sort:v,my:E?1:void 0,cursor:W?void 0:O,limit:12},n.current);N(z=>z?[...z,...q]:q),j(Y??null),(!Y||q.length===0)&&D(!0)}finally{P(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(cI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[c.jsx(Ae,{value:u,onChange:W=>h(W.target.value),placeholder:"Search pages…",className:"max-w-sm"}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:p,onChange:W=>g(W.target.value?Number(W.target.value):""),children:[c.jsx("option",{value:"",children:"All categories"}),T.map(W=>c.jsx("option",{value:W.category_id,children:W.category_name},W.category_id))]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:v,onChange:W=>b(W.target.value),children:[c.jsx("option",{value:"popular",children:"Popular"}),c.jsx("option",{value:"recent",children:"Recent"})]})]}),R===null&&c.jsxs("div",{className:"text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-4",children:Array.isArray(R)&&R.map(W=>c.jsxs(At,{to:`/pages/${W.page_name}`,className:"bg-white rounded-lg shadow hover:shadow-md transition",children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:W.page_cover&&c.jsx("img",{src:`${Iee}/uploads/${W.page_cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 overflow-hidden",children:W.page_picture&&c.jsx("img",{src:`${Iee}/uploads/${W.page_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-semibold truncate",children:W.page_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",W.page_name]})]})]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:[W.page_likes," likes"]})]})]},W.page_id??W.pageId))}),!M&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>H(!1),disabled:k,children:k?"Loading…":"Load more"})})]})]})]})}const YC="https://api.gada.chat";function g9e(){var Pt,Dt,cn,ut,wt,Rt;const{handle:e}=Qo(),{accessToken:t,user:n}=ct(),i=St(t),o=w.useRef(i);w.useEffect(()=>{o.current=i},[i]);const[u,h]=w.useState([]),[p,g]=w.useState(0),[v,b]=w.useState(null),[E,T]=w.useState(!0),[C,R]=w.useState(!1),[N,O]=w.useState(null),[j,k]=w.useState(null),[P,M]=w.useState(!1),[D,U]=w.useState(!1),F=!!((Pt=v==null?void 0:v.admins)!=null&&Pt.some(Le=>String(Le.id)===String(n==null?void 0:n.id)))||((Dt=v==null?void 0:v.page)==null?void 0:Dt.adminId)===(n==null?void 0:n.id),[H,W]=w.useState(""),[q,Y]=w.useState(null),[z,Z]=w.useState(!1),[X,ae]=w.useState(""),[se,J]=w.useState([]),[re,ee]=w.useState(null);w.useEffect(()=>{t&&(tS(o.current).then(h).catch(()=>{}),nS(o.current).then(Le=>g(Le.length)).catch(()=>{}))},[t]),w.useEffect(()=>{if(!t||!e)return;let Le=!1;return T(!0),a9e(e,o.current).then(ge=>{Le||b(ge)}).catch(console.error).finally(()=>{Le||T(!1)}),()=>{Le=!0}},[t,e]),w.useEffect(()=>{!t||!e||(O(null),k(null),U(!1),de(!0))},[t,e]);const de=async(Le=!1)=>{if(e&&!P&&!(!Le&&D)){M(!0);try{const{items:ge=[],nextCursor:Ne}=await c9e(e,{cursor:Le?null:j,limit:10},o.current);O(We=>We?[...We,...ge]:ge),k(Ne??null),(!Ne||ge.length===0)&&U(!0)}finally{M(!1)}}};w.useEffect(()=>{if(!F||!e||!t){Y(null);return}Aee(e,o.current).then(Y).catch(console.error)},[F,e,t]);const xe=async()=>{if(!(!v||C)){R(!0);try{const{hasLiked:Le}=await o9e(v.page.id??v.page.name,o.current);b(ge=>{if(!ge)return ge;const Ne=Math.max(0,Number(ge.page.likes||0)+(Le?1:-1));return{...ge,hasLiked:Le,page:{...ge.page,likes:Ne}}})}catch(Le){console.error(Le)}finally{R(!1)}}},ve=async()=>{if(H.trim())try{await l9e(e,{content:H},o.current),W(""),O(null),k(null),U(!1),de(!0)}catch(Le){console.error(Le)}},Te=async Le=>{if(Le)try{const{cover:ge}=await s9e(e,Le,o.current);b(Ne=>Ne&&{...Ne,page:{...Ne.page,cover:ge}})}catch(ge){console.error(ge)}};w.useEffect(()=>{const Le=setTimeout(()=>{if(!z||!X.trim()){J([]);return}u9e(X.trim(),o.current).then(J).catch(()=>J([]))},250);return()=>clearTimeout(Le)},[X,z]);function Pe(Le,ge){const Ne=String(ge),We=Le.findIndex(gt=>String(gt.id)===Ne);We!==-1&&Le.splice(We,1)}const qe=async Le=>{ee(Le);try{await d9e(e,Le,o.current),Pe(se,Le),await Aee(e,o.current).then(Y)}catch(ge){console.error(ge)}finally{ee(null)}},st=!!(v!=null&&v.hasLiked),ze=String((cn=v==null?void 0:v.page)==null?void 0:cn.page_boosted)==="1"||String((ut=v==null?void 0:v.page)==null?void 0:ut.boosted)==="1"||((wt=v==null?void 0:v.page)==null?void 0:wt.boosted)===!0,[ft,$e]=w.useState(!1),[at,ke]=w.useState(!1);w.useEffect(()=>{$e(!!ze)},[ze]);const je=async()=>{if(!F||!e||at)return;ke(!0);const Le=!ft;try{await p9e(e,Le,o.current),$e(Le),b(ge=>ge&&{...ge,page:{...ge.page,page_boosted:Le?"1":"0"}}),Ce.success("This page is now boosted.")}catch(ge){console.error(ge),Ce.error("Boost action failed"+(ge==null?void 0:ge.message)||"Please try again")}finally{ke(!1)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),E?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):v?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(cI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[c.jsxs("div",{className:"relative h-48 sm:h-64 bg-gray-200",children:[v.page.cover&&c.jsx("img",{src:`${YC}/uploads/${v.page.cover}`,className:"w-full h-full object-cover"}),F&&c.jsxs("label",{className:"absolute right-3 bottom-3 bg-white/80 rounded px-3 py-1 text-sm cursor-pointer",children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:Le=>{var ge;return Te((ge=Le.target.files)==null?void 0:ge[0])}}),"Change cover"]})]}),c.jsx("div",{className:"px-4 sm:px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-white p-1 shadow -mt-14",children:c.jsx("div",{className:"h-full w-full rounded-full overflow-hidden bg-gray-100",children:v.page.picture&&c.jsx("img",{src:`${YC}/uploads/${v.page.picture}`,className:"w-full h-full object-cover"})})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"text-2xl font-bold truncate",children:v.page.title}),c.jsxs("div",{className:"text-gray-500 truncate",children:["@",v.page.name]})]}),c.jsxs(be,{variant:"ghost",onClick:xe,disabled:C,className:`rounded-full ${st?"text-[#1877F2]":"text-gray-700"}`,children:[c.jsx(D0,{className:"h-5 w-5 mr-2"}),st?"Liked":"Like"," · ",v.page.likes]}),F&&c.jsxs(be,{variant:"ghost",onClick:je,disabled:at,className:`rounded-full ${ft?"text-[#1877F2]":"text-gray-700"}`,title:ft?"Unboost page":"Boost page",children:[c.jsx(U4,{className:"h-5 w-5 mr-2"}),ft?"Unboost":"Boost"]})]})})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-6",children:[c.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-4",children:[v.page.description&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-1",children:"About"}),c.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:v.page.description})]}),F&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsxs("div",{className:"font-semibold mb-2",children:["Create a post as ",v.page.title]}),c.jsx(Ei,{value:H,onChange:Le=>W(Le.target.value),placeholder:"Say something…"}),c.jsx("div",{className:"mt-2 flex justify-end",children:c.jsx(be,{onClick:ve,disabled:!H.trim(),children:"Post"})})]}),c.jsxs("div",{className:"space-y-4",children:[N===null&&P&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin mr-1"})," Loading…"]}),Array.isArray(N)&&N.map(Le=>c.jsx(Vu,{post:Le},Le.id)),Array.isArray(N)&&N.length===0&&D&&!P&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts yet"}),!D&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>de(!1),disabled:P,children:P?"Loading…":"Load more"})})]})]}),c.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Admins"}),c.jsx("ul",{className:"space-y-2",children:(Rt=v.admins)==null?void 0:Rt.map(Le=>c.jsxs("li",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:Le.avatar&&c.jsx("img",{src:`${YC}/uploads/${Xn(Le.avatar)}`,className:"w-full h-full object-cover"})}),c.jsx("div",{className:"text-sm truncate",children:Le.fullName||Le.username})]},Le.id))}),F&&c.jsx("div",{className:"mt-3",children:c.jsxs(be,{size:"sm",onClick:()=>Z(!0),children:[c.jsx(Sm,{className:"h-4 w-4 mr-2"})," Invite admin"]})})]}),F&&q&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Pending invites"}),q.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No pending invites"}):c.jsx("ul",{className:"space-y-2",children:q.map(Le=>c.jsxs("li",{className:"text-sm flex items-center gap-2",children:[c.jsx("span",{className:"truncate",children:Le.toUsername}),c.jsx("span",{className:"text-gray-400",children:"·"}),c.jsxs("span",{className:"text-gray-500",children:["invited by ",Le.fromUsername]})]},Le.inviteId))})]})]})]})]}),z&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white rounded-lg shadow w-full max-w-md p-4 relative",children:[c.jsx("button",{className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>{Z(!1),ae(""),J([])},children:c.jsx(po,{className:"h-5 w-5"})}),c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invite admin"}),c.jsx("input",{className:"w-full border rounded px-3 py-2 mb-3",placeholder:"Search users…",value:X,onChange:Le=>ae(Le.target.value)}),c.jsx("div",{className:"max-h-64 overflow-auto -mx-2 px-2",children:se.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"Type a name or username…"}):c.jsx("ul",{className:"divide-y",children:se.map(Le=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:Le.avatar&&c.jsx("img",{src:`${YC}/uploads/${Xn(Le.avatar)}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:Le.fullName||Le.username}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",Le.username]})]})]}),c.jsx(be,{size:"sm",onClick:()=>qe(Number(Le.id)),disabled:re===Number(Le.id),children:re===Number(Le.id)?"...":"Invite"})]},Le.id))})})]})})]}):c.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:"Page not found"})]})}function v9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const i=tr(),[o,u]=w.useState([]),[h,p]=w.useState(0),[g,v]=w.useState({page_name:"",page_title:"",page_category:"",page_country:"",page_description:""}),[b,E]=w.useState(!1);w.useEffect(()=>{e&&(tS(n.current).then(u).catch(console.error),nS(n.current).then(C=>p(C.length)).catch(()=>{}))},[e]);const T=async()=>{if(!(!g.page_name||!g.page_title||!g.page_category||!g.page_country)&&!b){E(!0);try{await r9e({...g,page_category:Number(g.page_category),page_country:Number(g.page_country)},n.current),i(`/pages/${g.page_name}`)}catch(C){console.error(C)}finally{E(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(cI,{})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-3",children:[c.jsx("div",{className:"text-xl font-semibold",children:"Create a Page"}),c.jsx(Ae,{placeholder:"Username (handle)",value:g.page_name,onChange:C=>v({...g,page_name:C.target.value})}),c.jsx(Ae,{placeholder:"Title",value:g.page_title,onChange:C=>v({...g,page_title:C.target.value})}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white w-full",value:g.page_category,onChange:C=>v({...g,page_category:C.target.value}),children:[c.jsx("option",{value:"",children:"Select category"}),o.map(C=>c.jsx("option",{value:C.category_id,children:C.category_name},C.category_id))]}),c.jsx(Ae,{placeholder:"Country ID (numeric)",value:g.page_country,onChange:C=>v({...g,page_country:C.target.value})}),c.jsx(Ei,{placeholder:"Description",value:g.page_description,onChange:C=>v({...g,page_description:C.target.value})}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:T,disabled:b,children:b?"Creating…":"Create"})})]})})]})]})}const y9e="https://api.gada.chat";function _9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]),tr();const[i,o]=w.useState([]),[u,h]=w.useState(0),[p,g]=w.useState(null),[v,b]=w.useState(null),E=()=>nS(n.current).then(R=>{g(R),h(R.length)}).catch(console.error);w.useEffect(()=>{e&&(g(null),E(),tS(n.current).then(o).catch(()=>{}))},[e]);const T=async(R,N)=>{b(N);try{await h9e(R,N,n.current),await E()}finally{b(null)}},C=async(R,N)=>{b(N);try{await f9e(R,N,n.current),await E()}finally{b(null)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(cI,{})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"text-xl font-semibold mb-3",children:"Page Invites"}),p===null?c.jsxs("div",{className:"text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):p.length===0?c.jsx("div",{className:"text-gray-500",children:"No invites"}):c.jsx("ul",{className:"divide-y",children:p.map(R=>c.jsxs("li",{className:"py-3 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-10 w-10 rounded-full overflow-hidden bg-gray-200",children:R.page_picture&&c.jsx("img",{src:`${y9e}/uploads/${R.page_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-medium truncate",children:R.page_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",R.page_name," • invited by ",R.fromUsername]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{size:"sm",onClick:()=>T(R.page_name,R.inviteId),disabled:v===R.inviteId,children:v===R.inviteId?"...":"Accept"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>C(R.page_name,R.inviteId),disabled:v===R.inviteId,children:"Decline"})]})]},R.inviteId))})]})})]})]})}const b9e="https://api.gada.chat";function $s(e,t){const n=new URL(`${b9e}/api/groups${e}`);return t&&Object.entries(t).forEach(([i,o])=>{o!=null&&o!==""&&n.searchParams.set(i,String(o))}),n.toString()}function rS(e={}){return fetch($s("/categories"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load categories");return t.json()})}function E9e(e,t={}){return fetch($s(""),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)}).then(n=>{if(!n.ok)throw new Error("Failed to create group");return n.json()})}function w9e(e,t={}){return fetch($s("",e),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load groups");return n.json()})}function S9e(e,t={}){return fetch($s(`/${e}`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to fetch group");return n.json()})}function x9e(e,t,n={}){const i=new FormData;return i.append("cover",t),fetch($s(`/${e}/cover`),{method:"POST",credentials:"include",headers:n,body:i}).then(o=>{if(!o.ok)throw new Error("Failed to update cover");return o.json()})}function T9e(e,t={}){return fetch($s(`/${e}/join`),{method:"POST",credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to join");return n.json()})}function C9e(e,t={}){return fetch($s(`/${e}/leave`),{method:"POST",credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to leave");return n.json()})}function R9e(e,t,n={}){return fetch($s(`/${e}/posts`,t),{credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to load posts");return i.json()})}function N9e(e,t,n={}){return fetch($s(`/${e}/posts`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify(t)}).then(i=>{if(!i.ok)throw new Error("Failed to create post");return i.json()})}function A9e(e,t={}){return fetch($s("/users/suggest",{q:e}),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to search users");return n.json()})}function iS(e={}){return fetch($s("/invites"),{credentials:"include",headers:e}).then(t=>{if(!t.ok)throw new Error("Failed to load invites");return t.json()})}function Oee(e,t={}){return fetch($s(`/${e}/invites`),{credentials:"include",headers:t}).then(n=>{if(!n.ok)throw new Error("Failed to load group invites");return n.json()})}function I9e(e,t,n={}){return fetch($s(`/${e}/invites`),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({userId:t})}).then(i=>{if(!i.ok)throw new Error("Failed to invite");return i.json()})}function O9e(e,t,n={}){return fetch($s(`/${e}/invites/${t}/accept`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to accept");return i.json()})}function P9e(e,t,n={}){return fetch($s(`/${e}/invites/${t}/decline`),{method:"POST",credentials:"include",headers:n}).then(i=>{if(!i.ok)throw new Error("Failed to decline");return i.json()})}function lI({highlight:e=null,cats:t,invCount:n}){const{accessToken:i}=ct(),o=St(i),u=w.useRef(o);w.useEffect(()=>{u.current=o},[o]);const[h,p]=w.useState(t??[]),[g,v]=w.useState(n??0);w.useEffect(()=>{if(t){p(t);return}i&&rS(u.current).then(p).catch(()=>{})},[i,t]),w.useEffect(()=>{if(typeof n=="number"){v(n);return}i&&iS(u.current).then(E=>v(E.length)).catch(()=>{})},[i,n]);const b=E=>e===E?"bg-gray-50":"";return c.jsxs("div",{className:"md:sticky md:top-20 bg-white rounded-lg shadow p-3 space-y-2",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Groups"}),c.jsxs(At,{to:"/groups",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(Ef,{className:"h-4 w-4 mr-2"})," Discover"]}),c.jsxs(At,{to:"/groups?my=1",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(gU,{className:"h-4 w-4 mr-2"})," Your Groups"]}),c.jsxs(At,{to:"/groups/invites",className:`flex items-center justify-between px-3 py-2 rounded hover:bg-gray-100 ${b("invites")}`,children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(L4,{className:"h-4 w-4 mr-2"})," Invites"]}),g>0&&c.jsx("span",{className:"text-xs bg-[#1877F2] text-white rounded-full px-2 py-0.5",children:g})]}),c.jsxs(At,{to:"/groups/create",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(D4,{className:"h-4 w-4 mr-2"})," Create Group"]}),c.jsx("div",{className:"h-px bg-gray-200 my-2"}),c.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide px-1 mb-1",children:"Categories"}),c.jsxs("div",{className:"max-h-64 overflow-auto pr-1 space-y-1",children:[c.jsx(At,{to:"/groups",className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:"All"}),h.map(E=>c.jsx(At,{to:`/groups?categoryId=${E.category_id}`,className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:E.category_name},E.category_id))]})]})}const Pee="https://api.gada.chat";function k9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const[i,o]=Xy();tr();const[u,h]=w.useState(i.get("q")||""),[p,g]=w.useState(i.get("categoryId")?Number(i.get("categoryId")):""),[v,b]=w.useState(i.get("sort")||"popular"),E=i.get("my")==="1",[T,C]=w.useState([]),[R,N]=w.useState(null),[O,j]=w.useState(null),[k,P]=w.useState(!1),[M,D]=w.useState(!1),[U,F]=w.useState(0);w.useEffect(()=>{e&&(rS(n.current).then(C).catch(console.error),iS(n.current).then(W=>F(W.length)).catch(()=>{}))},[e]),w.useEffect(()=>{const W={};u&&(W.q=u),p&&(W.categoryId=p),v&&v!=="popular"&&(W.sort=v),E&&(W.my="1"),o(W,{replace:!0})},[u,p,v,E]),w.useEffect(()=>{e&&(N(null),j(null),D(!1),Promise.resolve().then(()=>H(!0)))},[u,p,v,E,e]);const H=async(W=!1)=>{if(!k&&!(!W&&M)){P(!0);try{const{items:q=[],nextCursor:Y}=await w9e({q:u.trim(),categoryId:p||void 0,sort:v,my:E?1:void 0,cursor:W?void 0:O,limit:12},n.current);N(z=>z?[...z,...q]:q),j(Y??null),(!Y||q.length===0)&&D(!0)}finally{P(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(lI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[c.jsx(Ae,{value:u,onChange:W=>h(W.target.value),placeholder:"Search groups…",className:"max-w-sm"}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:p,onChange:W=>g(W.target.value?Number(W.target.value):""),children:[c.jsx("option",{value:"",children:"All categories"}),T.map(W=>c.jsx("option",{value:W.category_id,children:W.category_name},W.category_id))]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:v,onChange:W=>b(W.target.value),children:[c.jsx("option",{value:"popular",children:"Popular"}),c.jsx("option",{value:"recent",children:"Recent"})]})]}),R===null&&c.jsxs("div",{className:"text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-4",children:Array.isArray(R)&&R.map(W=>c.jsxs(At,{to:`/groups/${W.group_name}`,className:"bg-white rounded-lg shadow hover:shadow-md transition",children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:W.group_cover&&c.jsx("img",{src:`${Pee}/uploads/${W.group_cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 overflow-hidden",children:W.group_picture&&c.jsx("img",{src:`${Pee}/uploads/${W.group_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-semibold truncate",children:W.group_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",W.group_name]})]})]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:[W.group_members," members · ",W.group_privacy]})]})]},W.group_id??W.groupId))}),!M&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>H(!1),disabled:k,children:k?"Loading…":"Load more"})})]})]})]})}const XC="https://api.gada.chat";function j9e(){var ze,ft,$e,at;const{handle:e}=Qo(),{accessToken:t,user:n}=ct(),i=St(t),o=w.useRef(i);w.useEffect(()=>{o.current=i},[i]);const[u,h]=w.useState([]),[p,g]=w.useState(0),[v,b]=w.useState(null),[E,T]=w.useState(!0),[C,R]=w.useState(null),[N,O]=w.useState(null),[j,k]=w.useState(!1),[P,M]=w.useState(!1),[D,U]=w.useState(""),[F,H]=w.useState(null),[W,q]=w.useState(!1),[Y,z]=w.useState(""),[Z,X]=w.useState([]),[ae,se]=w.useState(null),J=!!((ze=v==null?void 0:v.admins)!=null&&ze.some(ke=>String(ke.id)===String(n==null?void 0:n.id)))||((ft=v==null?void 0:v.group)==null?void 0:ft.adminId)===(n==null?void 0:n.id),re=!!(v!=null&&v.isMember),ee=!!(v!=null&&v.isPending),de=re&&(($e=v==null?void 0:v.group)==null?void 0:$e.privacy)!=="secret";w.useEffect(()=>{t&&(rS(o.current).then(h).catch(()=>{}),iS(o.current).then(ke=>g(ke.length)).catch(()=>{}))},[t]),w.useEffect(()=>{if(!t||!e)return;let ke=!1;return T(!0),S9e(e,o.current).then(je=>{ke||b(je)}).catch(console.error).finally(()=>{ke||T(!1)}),()=>{ke=!0}},[t,e]),w.useEffect(()=>{!t||!e||(R(null),O(null),M(!1),xe(!0))},[t,e]);const xe=async(ke=!1)=>{if(!(!e||j||!ke&&P)){k(!0);try{const{items:je=[],nextCursor:Pt}=await R9e(e,{cursor:ke?null:N,limit:10},o.current);R(Dt=>Dt?[...Dt,...je]:je),O(Pt??null),(!Pt||je.length===0)&&M(!0)}finally{k(!1)}}};w.useEffect(()=>{if(!J||!e||!t){H(null);return}Oee(e,o.current).then(H).catch(console.error)},[J,e,t]);const ve=async()=>{try{const ke=await T9e(e,o.current);b(je=>je&&{...je,isMember:ke.isMember,isPending:ke.isPending,group:{...je.group,members:je.group.members+(ke.isMember?1:0)}})}catch(ke){console.error(ke)}},Te=async()=>{try{await C9e(e,o.current),b(ke=>ke&&{...ke,isMember:!1,isPending:!1,group:{...ke.group,members:Math.max(0,ke.group.members-1)}})}catch(ke){console.error(ke)}},Pe=async()=>{if(D.trim())try{const{hidden:ke}=await N9e(e,{content:D},o.current);U(""),ke||(R(null),O(null),M(!1),xe(!0))}catch(ke){console.error(ke)}},qe=async ke=>{if(ke)try{const{cover:je}=await x9e(e,ke,o.current);b(Pt=>Pt&&{...Pt,group:{...Pt.group,cover:je}})}catch(je){console.error(je)}};w.useEffect(()=>{const ke=setTimeout(()=>{if(!W||!Y.trim()){X([]);return}A9e(Y.trim(),o.current).then(X).catch(()=>X([]))},250);return()=>clearTimeout(ke)},[Y,W]);const st=async ke=>{se(ke);try{await I9e(e,ke,o.current),z(""),X([]),await Oee(e,o.current).then(H)}catch(je){console.error(je)}finally{se(null)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),E?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):v?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(lI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[c.jsxs("div",{className:"relative h-48 sm:h-64 bg-gray-200",children:[v.group.cover&&c.jsx("img",{src:`${XC}/uploads/${v.group.cover}`,className:"w-full h-full object-cover"}),J&&c.jsxs("label",{className:"absolute right-3 bottom-3 bg-white/80 rounded px-3 py-1 text-sm cursor-pointer",children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:ke=>{var je;return qe((je=ke.target.files)==null?void 0:je[0])}}),"Change cover"]})]}),c.jsx("div",{className:"px-4 sm:px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-white p-1 shadow -mt-14",children:c.jsx("div",{className:"h-full w-full rounded-full overflow-hidden bg-gray-100",children:v.group.picture&&c.jsx("img",{src:`${XC}/uploads/${v.group.picture}`,className:"w-full h-full object-cover"})})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"text-2xl font-bold truncate",children:v.group.title}),c.jsxs("div",{className:"text-gray-500 truncate",children:["@",v.group.name," · ",v.group.members," members · ",v.group.privacy]})]}),!re&&!ee&&c.jsx(be,{onClick:ve,children:"Join"}),ee&&c.jsx(be,{variant:"outline",disabled:!0,children:"Request sent"}),re&&c.jsx(be,{variant:"outline",onClick:Te,children:"Leave"})]})})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-6",children:[c.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-4",children:[v.group.description&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-1",children:"About"}),c.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:v.group.description})]}),de&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Create a post"}),c.jsx(Ei,{value:D,onChange:ke=>U(ke.target.value),placeholder:"Say something…"}),c.jsx("div",{className:"mt-2 flex justify-end",children:c.jsx(be,{onClick:Pe,disabled:!D.trim(),children:"Post"})})]}),c.jsxs("div",{className:"space-y-4",children:[C===null&&j&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin mr-1"})," Loading…"]}),Array.isArray(C)&&C.map(ke=>c.jsx(Vu,{post:ke},ke.id)),Array.isArray(C)&&C.length===0&&P&&!j&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No posts yet"}),!P&&c.jsx("div",{className:"flex justify-center",children:c.jsx(be,{onClick:()=>xe(!1),disabled:j,children:j?"Loading…":"Load more"})})]})]}),c.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Admins"}),c.jsx("ul",{className:"space-y-2",children:(at=v.admins)==null?void 0:at.map(ke=>c.jsxs("li",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:ke.avatar&&c.jsx("img",{src:`${XC}/uploads/${Xn(ke.avatar)}`,className:"w-full h-full object-cover"})}),c.jsx("div",{className:"text-sm truncate",children:ke.fullName||ke.username})]},ke.id))}),J&&c.jsx("div",{className:"mt-3",children:c.jsxs(be,{size:"sm",onClick:()=>q(!0),children:[c.jsx(Sm,{className:"h-4 w-4 mr-2"})," Invite member"]})})]}),J&&F&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Pending invites"}),F.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No pending invites"}):c.jsx("ul",{className:"space-y-2",children:F.map(ke=>c.jsxs("li",{className:"text-sm flex items-center gap-2",children:[c.jsx("span",{className:"truncate",children:ke.toUsername}),c.jsx("span",{className:"text-gray-400",children:"·"}),c.jsxs("span",{className:"text-gray-500",children:["invited by ",ke.fromUsername]})]},ke.inviteId))})]})]})]})]}),W&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white rounded-lg shadow w-full max-w-md p-4 relative",children:[c.jsx("button",{className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>{q(!1),z(""),X([])},children:c.jsx(po,{className:"h-5 w-5"})}),c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invite to group"}),c.jsx("input",{className:"w-full border rounded px-3 py-2 mb-3",placeholder:"Search users…",value:Y,onChange:ke=>z(ke.target.value)}),c.jsx("div",{className:"max-h-64 overflow-auto -mx-2 px-2",children:Z.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"Type a name or username…"}):c.jsx("ul",{className:"divide-y",children:Z.map(ke=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:ke.avatar&&c.jsx("img",{src:`${XC}/uploads/${Xn(ke.avatar)}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:ke.fullName||ke.username}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",ke.username]})]})]}),c.jsx(be,{size:"sm",onClick:()=>st(Number(ke.id)),disabled:ae===Number(ke.id),children:ae===Number(ke.id)?"...":"Invite"})]},ke.id))})})]})})]}):c.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:"Group not found"})]})}const D9e="https://api.gada.chat";function L9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]),tr();const[i,o]=w.useState([]),[u,h]=w.useState(0),[p,g]=w.useState(null),[v,b]=w.useState(null),E=()=>iS(n.current).then(R=>{g(R),h(R.length)}).catch(console.error);w.useEffect(()=>{e&&(g(null),E(),rS(n.current).then(o).catch(()=>{}))},[e]);const T=async(R,N)=>{b(N);try{await O9e(R,N,n.current),await E()}finally{b(null)}},C=async(R,N)=>{b(N);try{await P9e(R,N,n.current),await E()}finally{b(null)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(lI,{})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"text-xl font-semibold mb-3",children:"Group Invites"}),p===null?c.jsxs("div",{className:"text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):p.length===0?c.jsx("div",{className:"text-gray-500",children:"No invites"}):c.jsx("ul",{className:"divide-y",children:p.map(R=>c.jsxs("li",{className:"py-3 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-10 w-10 rounded-full overflow-hidden bg-gray-200",children:R.group_picture&&c.jsx("img",{src:`${D9e}/uploads/${R.group_picture}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-medium truncate",children:R.group_title}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",R.group_name," • invited by ",R.fromUsername]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{size:"sm",onClick:()=>T(R.group_name,R.inviteId),disabled:v===R.inviteId,children:v===R.inviteId?"...":"Accept"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>C(R.group_name,R.inviteId),disabled:v===R.inviteId,children:"Decline"})]})]},R.inviteId))})]})})]})]})}function M9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const i=tr(),[o,u]=w.useState([]),[h,p]=w.useState(0),[g,v]=w.useState({group_name:"",group_title:"",group_privacy:"public",group_category:"",group_country:"",group_description:""}),[b,E]=w.useState(!1);w.useEffect(()=>{e&&(rS(n.current).then(u).catch(console.error),iS(n.current).then(C=>p(C.length)).catch(()=>{}))},[e]);const T=async()=>{const{group_name:C,group_title:R,group_category:N,group_country:O}=g;if(!(!C||!R||!N||!O)&&!b){E(!0);try{await E9e({...g,group_category:Number(g.group_category),group_country:Number(g.group_country)},n.current),i(`/groups/${g.group_name}`)}catch(j){console.error(j)}finally{E(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(lI,{highlight:"discover"})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-3",children:[c.jsx("div",{className:"text-xl font-semibold",children:"Create a Group"}),c.jsx(Ae,{placeholder:"Username (handle)",value:g.group_name,onChange:C=>v({...g,group_name:C.target.value})}),c.jsx(Ae,{placeholder:"Title",value:g.group_title,onChange:C=>v({...g,group_title:C.target.value})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("select",{className:"border rounded px-2 py-2 bg-white w-full",value:g.group_privacy,onChange:C=>v({...g,group_privacy:C.target.value}),children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"closed",children:"Closed (approval)"}),c.jsx("option",{value:"secret",children:"Secret (invite only)"})]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white w-full",value:g.group_category,onChange:C=>v({...g,group_category:C.target.value}),children:[c.jsx("option",{value:"",children:"Select category"}),o.map(C=>c.jsx("option",{value:C.category_id,children:C.category_name},C.category_id))]})]}),c.jsx(Ae,{placeholder:"Country ID (numeric)",value:g.group_country,onChange:C=>v({...g,group_country:C.target.value})}),c.jsx(Ei,{placeholder:"Description",value:g.group_description,onChange:C=>v({...g,group_description:C.target.value})}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:T,disabled:b,children:b?"Creating…":"Create"})})]})})]})]})}const qu="https://api.gada.chat";function Xfe(e={}){return{"Content-Type":"application/json",...e}}async function IB(e){const t=await fetch(`${qu}/api/events/categories`,{headers:e});if(!t.ok)throw new Error("categories");return t.json()}async function U9e(e,t){const n=new URL(`${qu}/api/events`);Object.entries(e).forEach(([o,u])=>{u!=null&&u!==""&&n.searchParams.set(o,String(u))});const i=await fetch(n.toString(),{headers:t});if(!i.ok)throw new Error("events");return i.json()}async function kee(e,t){const n=await fetch(`${qu}/api/events/${e}`,{headers:t});if(!n.ok)throw new Error("event");return n.json()}async function jee(e,t){const n=await fetch(`${qu}/api/events/${e}/members`,{headers:t});if(!n.ok)throw new Error("members");return n.json()}async function F9e(e,t,n){const i=await fetch(`${qu}/api/events/${e}/rsvp`,{method:"POST",headers:Xfe(n),body:JSON.stringify({status:t})});if(!i.ok)throw new Error("rsvp");return i.json()}async function Jfe(e){const t=await fetch(`${qu}/api/events/invites/me`,{headers:e});if(!t.ok)throw new Error("my invites");return t.json()}async function V9e(e,t,n){const i=new FormData;Object.entries(e).forEach(([h,p])=>i.append(h,String(p??""))),t&&i.append("cover",t);const o=await fetch(`${qu}/api/events`,{method:"POST",headers:{...n},body:i});if(!o.ok)throw new Error("create");return(await o.json()).id}async function B9e(e,t,n){const i=new FormData;i.append("cover",t);const o=await fetch(`${qu}/api/events/${e}`,{method:"PATCH",headers:{...n},body:i});if(!o.ok)throw new Error("cover");return o.json()}async function $9e(e,t,n){const i=await fetch(`${qu}/api/events/${e}/invite`,{method:"POST",headers:Xfe(n),body:JSON.stringify({userId:t})});if(!i.ok)throw new Error("invite");return i.json()}async function W9e(e,t){const n=new URL(`${qu}/api/users/suggest`);console.log(encodeURIComponent(e),"encodeURIComponent(q)"),n.searchParams.set("q",encodeURIComponent(e));const i=await fetch(n.toString(),{headers:t});if(!i.ok)throw new Error("suggest-users");return i.json()}function uI({highlight:e=null,cats:t,invCount:n}){const{accessToken:i}=ct(),o=St(i),u=w.useRef(o);w.useEffect(()=>{u.current=o},[o]);const[h,p]=w.useState(t??[]),[g,v]=w.useState(n??0);Xy(),w.useEffect(()=>{if(t){p(t);return}i&&IB(u.current).then(p).catch(()=>{})},[i,t]),w.useEffect(()=>{if(typeof n=="number"){v(n);return}i&&Jfe(u.current).then(E=>v(E.length)).catch(()=>{})},[i,n]);const b=E=>e===E?"bg-gray-50":"";return c.jsxs("div",{className:"md:sticky md:top-20 bg-white rounded-lg shadow p-3 space-y-2",children:[c.jsxs("div",{className:"text-sm font-semibold text-gray-700 mb-1 flex items-center",children:[c.jsx(I4,{className:"h-4 w-4 mr-2"})," Events"]}),c.jsxs(At,{to:"/events",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(Ef,{className:"h-4 w-4 mr-2"})," Discover"]}),c.jsxs(At,{to:"/events?my=going",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(I0,{className:"h-4 w-4 mr-2"})," Your Events"]}),c.jsxs(At,{to:"/events/invites",className:`flex items-center justify-between px-3 py-2 rounded hover:bg-gray-100 ${b("invites")}`,children:[c.jsxs("span",{className:"flex items-center",children:[c.jsx(L4,{className:"h-4 w-4 mr-2"})," Invites"]}),g>0&&c.jsx("span",{className:"text-xs bg-[#1877F2] text-white rounded-full px-2 py-0.5",children:g})]}),c.jsxs(At,{to:"/events/create",className:`flex items-center px-3 py-2 rounded hover:bg-gray-100 ${b("create")}`,children:[c.jsx(D4,{className:"h-4 w-4 mr-2"})," Create Event"]}),c.jsx("div",{className:"h-px bg-gray-200 my-2"}),c.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide px-1 mb-1",children:"Categories"}),c.jsxs("div",{className:"max-h-64 overflow-auto pr-1 space-y-1",children:[c.jsx(At,{to:"/events",className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:"All"}),h.map(E=>c.jsx(At,{to:`/events?categoryId=${E.category_id}`,className:"block w-full text-left px-3 py-1.5 rounded hover:bg-gray-100",children:E.category_name},E.category_id))]})]})}const G9e="https://api.gada.chat";function H9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const[i,o]=Xy(),[u,h]=w.useState(i.get("q")||""),[p,g]=w.useState(i.get("categoryId")?Number(i.get("categoryId")):""),[v,b]=w.useState(i.get("when")||"upcoming"),[E,T]=w.useState([]),[C,R]=w.useState(null),[N,O]=w.useState(null),[j,k]=w.useState(!1),[P,M]=w.useState(!1);w.useEffect(()=>{const U=i.get("q")||"",F=i.get("categoryId")?Number(i.get("categoryId")):"",H=i.get("when")||"upcoming";U!==u&&h(U),F!==p&&g(F),H!==v&&b(H)},[i.toString()]),w.useEffect(()=>{const U={};u&&(U.q=u),p&&(U.categoryId=p),v&&v!=="upcoming"&&(U.when=v),o(U,{replace:!0})},[u,p,v]),w.useEffect(()=>{e&&IB(n.current).then(T).catch(()=>{})},[e]),w.useEffect(()=>{e&&(R(null),O(null),M(!1),Promise.resolve().then(()=>D(!0)))},[u,p,v,e]);const D=async(U=!1)=>{if(!j&&!(!U&&P)){k(!0);try{const{items:F,nextCursor:H}=await U9e({q:u.trim(),categoryId:p||void 0,when:v,cursor:U?void 0:N,limit:12},n.current);R(W=>W?[...W,...F]:F),O(H??null),(!H||F.length===0)&&M(!0)}finally{k(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(uI,{highlight:"discover"})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[c.jsx(Ae,{value:u,onChange:U=>h(U.target.value),placeholder:"Search events…",className:"max-w-sm"}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:p,onChange:U=>g(U.target.value?Number(U.target.value):""),children:[c.jsx("option",{value:"",children:"All categories"}),E.map(U=>c.jsx("option",{value:U.category_id,children:U.category_name},U.category_id))]}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:v,onChange:U=>b(U.target.value),children:[c.jsx("option",{value:"upcoming",children:"Upcoming"}),c.jsx("option",{value:"today",children:"Today"}),c.jsx("option",{value:"week",children:"This week"}),c.jsx("option",{value:"month",children:"This month"}),c.jsx("option",{value:"past",children:"Past"})]})]}),C===null&&c.jsxs("div",{className:"text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.isArray(C)&&C.map(U=>c.jsxs(At,{to:`/events/${U.id}`,className:"bg-white rounded-lg shadow hover:shadow-md transition",children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:U.cover&&c.jsx("img",{src:`${G9e}/uploads/${U.cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsx("div",{className:"font-semibold line-clamp-1",children:U.title}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(U.startAt).toLocaleString()}),c.jsx("div",{className:"text-xs text-gray-600 mt-1",children:U.location}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[U.stats.going," going · ",U.stats.interested," interested"]})]})]},U.id))}),!P&&c.jsx("div",{className:"flex justify-center mt-4",children:c.jsx(be,{onClick:()=>D(!1),disabled:j,children:j?"Loading…":"Load more"})})]})]})]})}function z9e(){const{accessToken:e}=ct(),t=Bl(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const[i,o]=w.useState([]),[u,h]=w.useState(""),[p,g]=w.useState(""),[v,b]=w.useState(""),[E,T]=w.useState(161),[C,R]=w.useState(16),[N,O]=w.useState("public"),[j,k]=w.useState(""),[P,M]=w.useState(""),[D,U]=w.useState(""),[F,H]=w.useState(""),[W,q]=w.useState(null),[Y,z]=w.useState(!1),Z=tr();w.useEffect(()=>{e&&IB(n.current).then(o).catch(()=>{})},[e]);const X=async()=>{if(!(!u.trim()||!p.trim()||!j||!P||!C)){z(!0);try{const ae=await V9e({title:u,description:p,location:v,countryId:E,categoryId:C,privacy:N,startAt:new Date(j).toISOString(),endAt:new Date(P).toISOString(),ticketsLink:D||null,prices:F||null},W,n.current);Z(`/events/${ae}`)}catch(ae){console.error(ae)}finally{z(!1)}}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(uI,{highlight:"create",cats:i})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-4",children:[c.jsx("div",{className:"text-lg font-semibold",children:"Create Event"}),c.jsx(Ae,{value:u,onChange:ae=>h(ae.target.value),placeholder:"Title"}),c.jsx(Ei,{value:p,onChange:ae=>g(ae.target.value),placeholder:"Description"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(Ae,{value:v,onChange:ae=>b(ae.target.value),placeholder:"Location"}),c.jsx(Ae,{value:E,onChange:ae=>T(Number(ae.target.value)||161),placeholder:"Country ID"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx("select",{className:"border rounded px-2 py-2 bg-white",value:C,onChange:ae=>R(Number(ae.target.value)),children:i.map(ae=>c.jsx("option",{value:ae.category_id,children:ae.category_name},ae.category_id))}),c.jsxs("select",{className:"border rounded px-2 py-2 bg-white",value:N,onChange:ae=>O(ae.target.value),children:[c.jsx("option",{value:"public",children:"Public"}),c.jsx("option",{value:"closed",children:"Closed"}),c.jsx("option",{value:"secret",children:"Secret"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(Ae,{type:"datetime-local",value:j,onChange:ae=>k(ae.target.value)}),c.jsx(Ae,{type:"datetime-local",value:P,onChange:ae=>M(ae.target.value)})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(Ae,{value:D,onChange:ae=>U(ae.target.value),placeholder:"Tickets link (optional)"}),c.jsx(Ae,{value:F,onChange:ae=>H(ae.target.value),placeholder:"Prices (optional)"})]}),c.jsx("div",{children:c.jsx("input",{type:"file",accept:"image/*",onChange:ae=>{var se;return q(((se=ae.target.files)==null?void 0:se[0])||null)}})}),c.jsx("div",{className:"flex justify-end",children:c.jsx(be,{onClick:X,disabled:Y||!u.trim()||!p.trim()||!j||!P,children:Y?"Creating…":"Create Event"})})]})})]})]})}const K9e="https://api.gada.chat";function q9e(){const{accessToken:e}=ct(),t=St(e),n=w.useRef(t);w.useEffect(()=>{n.current=t},[t]);const[i,o]=w.useState(null);return w.useEffect(()=>{e&&Jfe(n.current).then(o).catch(()=>o([]))},[e]),c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(uI,{highlight:"invites"})}),c.jsx("main",{className:"col-span-12 md:col-span-9",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invites"}),i?i.length===0?c.jsx("div",{className:"text-gray-500",children:"No invites"}):c.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(u=>c.jsx("li",{className:"bg-white rounded-lg shadow",children:c.jsxs(At,{to:`/events/${u.id}`,children:[c.jsx("div",{className:"aspect-[3/1] bg-gray-200 rounded-t-lg overflow-hidden",children:u.cover&&c.jsx("img",{src:`${K9e}/uploads/${u.cover}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-3",children:[c.jsx("div",{className:"font-semibold line-clamp-1",children:u.title}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(u.startAt).toLocaleString()})]})]})},u.id))}):c.jsx("div",{className:"text-gray-500",children:"Loading…"})]})})]})]})}const _L="https://api.gada.chat";function Y9e(){var q,Y,z,Z,X,ae;const{id:e}=Qo(),{accessToken:t,user:n}=ct(),i=St(t),o=w.useRef(i);w.useEffect(()=>{o.current=i},[i]);const[u,h]=w.useState(null),[p,g]=w.useState(!0),[v,b]=w.useState(!1),[E,T]=w.useState(null),[C,R]=w.useState(!1),[N,O]=w.useState(""),[j,k]=w.useState([]),[P,M]=w.useState(null),D=!!((q=u==null?void 0:u.admins)!=null&&q.some(se=>String(se.id)===String(n==null?void 0:n.id)))||String((Y=u==null?void 0:u.event)==null?void 0:Y.adminId)===String(n==null?void 0:n.id);w.useEffect(()=>{if(!t||!e)return;let se=!1;return g(!0),kee(e,o.current).then(J=>!se&&h(J)).catch(console.error).finally(()=>!se&&g(!1)),()=>{se=!0}},[t,e]),w.useEffect(()=>{!t||!e||jee(e,o.current).then(T).catch(()=>T([]))},[t,e]),w.useEffect(()=>{const se=setTimeout(()=>{if(!C||!N.trim()){k([]);return}W9e(N.trim(),o.current).then(k).catch(()=>k([]))},250);return()=>clearTimeout(se)},[C,N]);const U=async se=>{if(!(!e||v)){b(!0);try{await F9e(e,se,o.current);const J=await kee(e,o.current);h(J);const re=await jee(e,o.current);T(re)}finally{b(!1)}}};function F(se,J){const re=String(J),ee=se.findIndex(de=>String(de.id)===re);ee!==-1&&se.splice(ee,1)}const H=async se=>{if(e){M(se);try{await $9e(e,se,o.current),F(j,se)}catch(J){console.error(J)}finally{M(null)}}},W=async se=>{if(!(!se||!e))try{const J=await B9e(e,se,o.current);h(re=>re&&{...re,event:{...re.event,cover:J.cover}})}catch(J){console.error(J)}};return c.jsxs("div",{className:"min-h-screen bg-cus",children:[c.jsx(or,{}),p?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:[c.jsx(ei,{className:"inline h-4 w-4 animate-spin"})," Loading…"]}):u?c.jsxs("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-12 gap-6",children:[c.jsx("aside",{className:"col-span-12 md:col-span-3",children:c.jsx(uI,{})}),c.jsxs("main",{className:"col-span-12 md:col-span-9",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[c.jsxs("div",{className:"relative h-48 sm:h-64 bg-gray-200",children:[u.event.cover&&c.jsx("img",{src:`${_L}/uploads/${u.event.cover}`,className:"w-full h-full object-cover"}),D&&c.jsxs("label",{className:"absolute right-3 bottom-3 bg-white/80 rounded px-3 py-1 text-sm cursor-pointer",children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:se=>{var J;return W((J=se.target.files)==null?void 0:J[0])}}),"Change cover"]})]}),c.jsxs("div",{className:"px-4 sm:px-6 py-4",children:[c.jsx("div",{className:"text-2xl font-bold",children:u.event.title}),c.jsxs("div",{className:"text-gray-600 mt-1 flex flex-wrap gap-4",children:[c.jsxs("span",{className:"inline-flex items-center",children:[c.jsx(I4,{className:"h-4 w-4 mr-2"}),new Date(u.event.startAt).toLocaleString()," – ",new Date(u.event.endAt).toLocaleString()]}),u.event.location&&c.jsxs("span",{className:"inline-flex items-center",children:[c.jsx(e4e,{className:"h-4 w-4 mr-2"}),u.event.location]}),u.event.ticketsLink&&c.jsxs("a",{href:u.event.ticketsLink,target:"_blank",className:"inline-flex items-center text-[#1877F2]",children:[c.jsx(ZVe,{className:"h-4 w-4 mr-1"})," Tickets"]})]}),c.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[c.jsx(be,{variant:(z=u.my)!=null&&z.interested?"default":"outline",onClick:()=>U("interested"),disabled:v,children:"Interested"}),c.jsx(be,{variant:(Z=u.my)!=null&&Z.going?"default":"outline",onClick:()=>U("going"),disabled:v,children:"Going"}),c.jsxs(be,{variant:"outline",onClick:()=>R(!0),children:[c.jsx(Sm,{className:"h-4 w-4 mr-2"})," Invite people"]}),(((X=u.my)==null?void 0:X.interested)||((ae=u.my)==null?void 0:ae.going))&&c.jsx(be,{variant:"ghost",onClick:()=>U("none"),disabled:v,children:"Remove response"}),c.jsxs("div",{className:"ml-auto text-sm text-gray-600",children:[u.event.stats.going," going · ",u.event.stats.interested," interested"]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-6",children:[c.jsx("div",{className:"col-span-12 lg:col-span-8 space-y-4",children:u.event.description&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-1",children:"About"}),c.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:u.event.description})]})}),c.jsx("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[c.jsx("div",{className:"font-semibold mb-2",children:"Attendees"}),E?E.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No attendees yet"}):c.jsx("ul",{className:"space-y-2",children:E.slice(0,12).map(se=>c.jsxs("li",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 overflow-hidden",children:se.avatar&&c.jsx("img",{src:`${_L}/uploads/${se.avatar}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"text-sm truncate",children:[se.fullName||se.username,se.going?c.jsx("span",{className:"text-xs text-green-600 ml-2",children:"Going"}):se.interested?c.jsx("span",{className:"text-xs text-amber-600 ml-2",children:"Interested"}):null]})]},se.id))}):c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"})]})})]})]}),C&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center",children:c.jsxs("div",{className:"bg-white rounded-lg shadow w-full max-w-md p-4 relative",children:[c.jsx("button",{className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>{R(!1),O(""),k([])},children:c.jsx(po,{className:"h-5 w-5"})}),c.jsx("div",{className:"text-lg font-semibold mb-3",children:"Invite people"}),c.jsx("input",{className:"w-full border rounded px-3 py-2 mb-3",placeholder:"Search users…",value:N,onChange:se=>O(se.target.value)}),c.jsx("div",{className:"max-h-64 overflow-auto -mx-2 px-2",children:j.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"Type a name or username…"}):c.jsx("ul",{className:"divide-y",children:j.map(se=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden bg-gray-200",children:se.avatar&&c.jsx("img",{src:`${_L}/uploads/${se.avatar}`,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:se.fullName||se.username}),c.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["@",se.username]})]})]}),c.jsx(be,{size:"sm",onClick:()=>H(Number(se.id)),disabled:P===Number(se.id),children:P===Number(se.id)?"...":"Invite"})]},se.id))})})]})})]}):c.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 py-10 text-gray-500",children:"Event not found"})]})}const JC="https://api.gada.chat".replace(/\/+$/,"");function X9e({post:e,onEnded:t}){const{user:n}=ct(),{likePost:i,commentPost:o,deletePost:u,sharePost:h,toggleSave:p}=R1(),g=w.useMemo(()=>{var re,ee;return n?(e==null?void 0:e.hasLiked)===!0||((ee=(re=e==null?void 0:e.likes)==null?void 0:re.some)==null?void 0:ee.call(re,de=>String(de.userId)===String(n.id))):!!(e!=null&&e.hasLiked)},[e==null?void 0:e.hasLiked,e==null?void 0:e.likes,n]),v=w.useMemo(()=>Array.isArray(e==null?void 0:e.likes)?e.likes.length:Number((e==null?void 0:e.likeCount)??0),[e==null?void 0:e.likes,e==null?void 0:e.likeCount]),[b,E]=w.useState(g),[T,C]=w.useState(v),[R,N]=w.useState(!1);w.useEffect(()=>{E(g),C(v)},[g,v,e==null?void 0:e.id]);const O=b,[j,k]=w.useState(!1),[P,M]=w.useState(""),[D,U]=w.useState(!1),[F,H]=w.useState(!1),W=w.useRef(null),q=w.useRef(null),[Y,z]=w.useState(!0);w.useEffect(()=>{const re=q.current,ee=W.current;if(!re||!ee)return;const de=new IntersectionObserver(([xe])=>{xe.isIntersecting&&xe.intersectionRatio>=.6?ee.play().catch(()=>{}):ee.pause()},{threshold:[0,.6,1]});return de.observe(re),()=>de.disconnect()},[]),w.useEffect(()=>{const re=W.current;if(!re||!t)return;const ee=()=>t();return re.addEventListener("ended",ee),()=>re.removeEventListener("ended",ee)},[t]);const Z=()=>{const re=W.current;re&&(re.muted=!re.muted,z(re.muted))},X=async()=>{if(!n||R)return;const re=!b;E(re),N(!0),C(ee=>Math.max(0,ee+(re?1:-1)));try{await i(e.id)}catch(ee){E(!re),C(de=>Math.max(0,de+(re?-1:1))),console.error(ee)}finally{N(!1)}},ae=re=>{re.preventDefault(),!(!n||!P.trim())&&(o(e.id,P),M(""))},se=()=>{n&&u(e.id)},J=re=>re.split(" ").map(ee=>ee[0]).join("").toUpperCase();return c.jsx("div",{ref:q,children:c.jsxs(Vr,{className:"mb-6 overflow-hidden",children:[c.jsxs(pa,{className:"p-4 pb-2 flex items-start",children:[c.jsxs("div",{className:"flex-1 flex items-center space-x-3",children:[c.jsx(At,{to:`/profile/${e.author.id}`,children:c.jsx($i,{children:e.author.profileImage?c.jsx(Ii,{src:`${JC}/uploads/${Xn(e.author.profileImage)}`,alt:e.author.username}):c.jsx(ea,{children:J(e.author.username)})})}),c.jsxs("div",{children:[c.jsx(At,{to:`/profile/${e.author.id}`,className:"font-semibold hover:underline",children:e.author.username}),c.jsx("p",{className:"text-sm text-gray-500",children:RN(e.createdAt)})]})]}),c.jsxs(eB,{children:[c.jsx(tB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8",children:c.jsx(Yce,{className:"h-5 w-5"})})}),n&&String(n.id)===String(e.author.id)&&c.jsx(B1,{align:"end",children:c.jsx(Pc,{onClick:se,className:"text-red-600",children:"Delete post"})})]})]}),c.jsxs(mi,{className:"p-0",children:[e.content&&c.jsx("p",{className:"px-4 pt-2 pb-3",children:e.content}),c.jsxs("div",{className:"relative bg-black",children:[c.jsx("video",{ref:W,src:`${JC}/uploads/${Xn(e.videos[0])}`,className:"w-full max-h-[70vh] object-contain",controls:!1,playsInline:!0,muted:Y,preload:"metadata"}),c.jsx("button",{onClick:Z,className:"absolute right-3 bottom-3 bg-white/80 rounded-full p-2",title:Y?"Unmute":"Mute",children:Y?c.jsx(m4e,{className:"h-5 w-5"}):c.jsx(p4e,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-sm text-gray-500",children:[T>0&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(D0,{className:"h-4 w-4 text-[#1877F2]"}),c.jsx("span",{children:T})]}),e.comments.length>0&&c.jsxs("div",{children:[e.comments.length," comments"]}),c.jsxs("div",{children:[e.shareCount??e.shares??0," shares"]})]})]}),c.jsx(e_,{className:"p-0",children:c.jsxs("div",{className:"grid grid-cols-3 w-full",children:[c.jsxs(be,{variant:"ghost",onClick:X,"aria-pressed":O,disabled:R,className:`flex items-center justify-center py-2 rounded-none ${O?"text-[#1877F2]":"text-gray-600"}`,children:[c.jsx(D0,{className:`h-5 w-5 mr-1 ${O?"fill-[#1877F2] text-[#1877F2]":""}`}),"Like"]}),c.jsxs(be,{variant:"ghost",onClick:()=>k(!j),className:"flex items-center justify-center py-2 rounded-none text-gray-600",children:[c.jsx($w,{className:"h-5 w-5 mr-1"}),"Comment"]}),c.jsxs(be,{variant:"ghost",className:"flex items-center justify-center py-2 rounded-none text-gray-600",onClick:()=>H(!0),children:[c.jsx(A1,{className:"h-5 w-5 mr-1"}),"Share"]})]})}),c.jsx(eue,{isOpen:F,onClose:()=>H(!1),onShare:re=>h(e.id,re)}),(e.comments.length>0||j)&&c.jsxs("div",{className:"p-4 pt-0",children:[c.jsx("div",{className:"h-px bg-gray-200 my-4"}),e.comments.length>0&&c.jsxs("div",{className:"space-y-3 mb-4",children:[(D?e.comments:e.comments.slice(0,2)).map(re=>c.jsxs("div",{className:"flex space-x-2",children:[c.jsx($i,{className:"h-8 w-8",children:re.profileImage?c.jsx(Ii,{src:`${JC}/uploads/${Xn(re.profileImage)}`,alt:re.username}):c.jsx(ea,{children:J(re.username)})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"bg-gray-100 rounded-lg p-2 px-3",children:[c.jsx(At,{to:`/profile/${re.userId}`,className:"font-semibold hover:underline",children:re.username}),c.jsx("p",{className:"text-sm",children:re.content})]}),c.jsxs("div",{className:"flex space-x-3 text-xs text-gray-500 mt-1 ml-2",children:[c.jsx("span",{children:RN(re.createdAt)}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Like"}),c.jsx("button",{className:"hover:text-[#1877F2]",children:"Reply"})]})]})]},re.id)),e.comments.length>2&&c.jsx(be,{variant:"ghost",onClick:()=>U(!D),className:"text-gray-600 pl-0 pb-0",children:D?"Show fewer comments":`View all ${e.comments.length} comments`})]}),(j||e.comments.length>0)&&n&&c.jsxs("form",{onSubmit:ae,className:"flex space-x-2",children:[c.jsx($i,{className:"h-8 w-8",children:n.profileImage?c.jsx(Ii,{src:`${JC}/uploads/${Xn(n.profileImage)}`,alt:n.username}):c.jsx(ea,{children:J(n.username)})}),c.jsx("input",{className:"flex-1 rounded-full border px-3 py-2 text-sm",placeholder:"Write a comment...",value:P,onChange:re=>M(re.target.value)}),c.jsx(be,{type:"submit",size:"sm",disabled:!P.trim(),children:"Post"})]})]})]})})}const J9e="https://api.gada.chat".replace(/\/+$/,"")||"http://localhost:8085";async function Z9e(e,t){const n=new URL(`${J9e}/api/watch`);n.searchParams.set("limit",String(e.limit)),e.cursor&&n.searchParams.set("cursor",String(e.cursor));const i=await fetch(n.toString(),{headers:t});if(!i.ok)throw new Error("watch-feed");return i.json()}function Q9e(){const{accessToken:e,isLoading:t}=ct(),n=St(e),i=w.useRef(n);w.useEffect(()=>{i.current=n},[n]);const[o,u]=w.useState(null),[h,p]=w.useState(null),[g,v]=w.useState(!1),[b,E]=w.useState(!1);w.useEffect(()=>{t||e&&(u(null),p(null),E(!1),T(!0))},[t,e]);const T=async(R=!1)=>{if(!g&&!(!R&&b)){v(!0);try{const{items:N,nextCursor:O}=await Z9e({limit:8,cursor:R?null:h},i.current);u(j=>j?[...j,...N]:N),p(O??null),(!O||N.length===0)&&E(!0)}finally{v(!1)}}};w.useEffect(()=>{const R=()=>{if(g||b)return;window.innerHeight+window.scrollY>=document.body.offsetHeight-800&&T(!1)};return window.addEventListener("scroll",R),()=>window.removeEventListener("scroll",R)},[g,b]);const C=R=>{const N=document.querySelectorAll("[data-watch-card]")[R+1];N&&N.scrollIntoView({behavior:"smooth",block:"center"})};return t||o===null?c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:c.jsx(ei,{className:"h-8 w-8 animate-spin text-[#1877F2]"})}):c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto space-x-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto py-6",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-y-auto",children:c.jsxs("div",{className:"space-y-6 py-6",children:[o.map((R,N)=>c.jsx("div",{"data-watch-card":!0,children:c.jsx(X9e,{post:R,onEnded:()=>C(N)})},R.id)),!b&&c.jsx("div",{className:"flex justify-center py-4",children:c.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 rounded bg-[#1877F2] text-white disabled:opacity-50",disabled:g,children:g?"Loading…":"Load more"})})]})}),c.jsx("aside",{className:"hidden xl:block xl:w-96 min-h-0 overflow-y-auto pt-6",children:c.jsx(J1,{})})]})})]})}const OB="https://api.gada.chat";async function Dee(e){const t=await fetch(`${OB}/api/affiliates/overview`,{headers:e});if(!t.ok)throw new Error("overview failed");return t.json()}async function e7e(e,t={}){const n=new URLSearchParams;t.page&&n.set("page",String(t.page)),t.limit&&n.set("limit",String(t.limit)),t.level&&n.set("level",String(t.level)),t.search&&n.set("search",t.search);const i=await fetch(`${OB}/api/affiliates/referrals?`+n.toString(),{headers:e});if(!i.ok)throw new Error("referrals failed");return i.json()}async function t7e(e,t){const n=await fetch(`${OB}/api/affiliates/transfer`,{method:"POST",headers:{...e,"Content-Type":"application/json"},body:JSON.stringify({amount:t})});if(!n.ok)throw new Error(await n.text());return n.json()}function Lee({url:e,text:t="Join me here!",title:n="Check this out",className:i,size:o="sm",fbAppId:u,fbRedirectUri:h}){if(!e)return null;const p=encodeURIComponent(e),g=encodeURIComponent(t),v=encodeURIComponent(n),b=[{key:"facebook",label:"Facebook",href:`https://www.facebook.com/sharer/sharer.php?u=${p}`,color:"#1877F2"},{key:"x",label:"X",href:`https://twitter.com/intent/tweet?url=${p}&text=${g}`,color:"#000000"},{key:"linkedin",label:"LinkedIn",href:`https://www.linkedin.com/sharing/share-offsite/?url=${p}`,color:"#0A66C2"},{key:"whatsapp",label:"WhatsApp",href:`https://api.whatsapp.com/send?text=${g}%20${p}`,color:"#25D366"},{key:"telegram",label:"Telegram",href:`https://t.me/share/url?url=${p}&text=${g}`,color:"#0088CC"},{key:"reddit",label:"Reddit",href:`https://www.reddit.com/submit?url=${p}&title=${v}`,color:"#FF4500"},{key:"email",label:"Email",href:`mailto:?subject=${v}&body=${g}%0A%0A${p}`,color:"#475569"},{key:"messenger",label:"Messenger",href:`https://www.facebook.com/dialog/send?link=${p}&app_id=${encodeURIComponent(u||"")}&redirect_uri=${encodeURIComponent(h||"")}`,color:"#1877F2",hidden:!u||!h}],E=typeof navigator<"u"&&!!navigator.share,T=async()=>{try{await navigator.share({title:n,text:t,url:e})}catch{}},C=o==="sm"?"h-8 px-2 text-[12px]":"h-9 px-3 text-[13px]";return c.jsxs("div",{className:er("flex flex-wrap items-center gap-2",i),children:[E&&c.jsxs(be,{type:"button",onClick:T,className:er(C,"rounded-full bg-gray-900 hover:bg-gray-800"),children:[c.jsx(A1,{className:"h-4 w-4 mr-2"}),"Share…"]}),b.filter(R=>!R.hidden).map(R=>c.jsx("a",{href:R.href,target:"_blank",rel:"noreferrer noopener",className:er(C,"inline-flex items-center rounded-full text-white font-medium"),style:{backgroundColor:R.color},"aria-label":`Share on ${R.label}`,title:`Share on ${R.label}`,children:R.label},R.key))]})}const n7e="https://api.gada.chat",r7e=e=>(e||"?").split(" ").filter(Boolean).map(t=>t[0].toUpperCase()).slice(0,2).join(""),i7e=e=>`₦${(isNaN(e)?0:e).toLocaleString(void 0,{maximumFractionDigits:2})}`;function a7e(){var W,q,Y;const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(null),[o,u]=w.useState(!1),[h,p]=w.useState(null),[g,v]=w.useState(1),[b,E]=w.useState(1),[T,C]=w.useState(10),[R,N]=w.useState(""),[O,j]=w.useState(null),k=w.useMemo(()=>O?Math.max(1,Math.ceil((O.total||0)/T)):1,[O,T]);w.useEffect(()=>{e&&(u(!0),p(null),Dee(t).then(i).catch(z=>p(String((z==null?void 0:z.message)||"Failed to load"))).finally(()=>u(!1)))},[e]),w.useEffect(()=>{e&&e7e(t,{page:b,limit:T,level:g,search:R}).then(z=>j({items:z.items||[],total:z.total||0})).catch(console.error)},[e,b,T,g,R]);const[P,M]=w.useState(!1),D=async()=>{if(n!=null&&n.shareLink)try{await navigator.clipboard.writeText(n.shareLink),M(!0),setTimeout(()=>M(!1),1500)}catch{}},[U,F]=w.useState(""),H=async()=>{if(n)try{const z=Number(U);if(!Number.isFinite(z)||z<=0)return;await t7e(t,z);const Z=await Dee(t);Ce.success("Balance transfered successfully!"),i(Z),F("")}catch(z){alert((z==null?void 0:z.message)||"Transfer failed")}};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx(Ss,{})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsxs("div",{className:"rounded-xl bg-cyan-50 text-cyan-900 border border-cyan-200 p-4",children:[c.jsx("div",{className:"font-semibold",children:"Affiliates System"}),c.jsxs("div",{className:"text-sm opacity-90",children:["Earn up to multi-level commissions when people join via your link. Earn up to ",(W=n==null?void 0:n.settings)==null?void 0:W.level1per,"% (Level 1) , ",(q=n==null?void 0:n.settings)==null?void 0:q.level2per,"% (Level 2) , ",(Y=n==null?void 0:n.settings)==null?void 0:Y.level3per,"% (Level 3) From the package of your refered user. You will be paid when new user registered & bought a package. your affiliate balance to your wallet."]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0 w-full",children:[c.jsx("div",{className:"font-medium text-sm text-gray-700",children:"Your affiliate link"}),c.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[c.jsx(Ae,{value:(n==null?void 0:n.shareLink)||"",readOnly:!0,className:"bg-gray-50 flex-1"}),c.jsxs(be,{variant:"outline",onClick:D,className:"shrink-0",children:[P?c.jsx(Fw,{className:"h-4 w-4 mr-2"}):c.jsx(HVe,{className:"h-4 w-4 mr-2"}),P?"Copied":"Copy"]}),c.jsx("div",{className:"hidden md:block",children:c.jsx(Lee,{url:(n==null?void 0:n.shareLink)||"",title:"Join me on Gada Chat",text:"Sign up using my invitation link!"})})]}),c.jsx("div",{className:"mt-3 md:hidden",children:c.jsx(Lee,{url:(n==null?void 0:n.shareLink)||"",title:"Join me on Gada Chat",text:"Sign up using my invitation link!"})})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Affiliates Money Balance"}),c.jsx("div",{className:"mt-1 text-3xl font-semibold",children:i7e(Number((n==null?void 0:n.balance.affiliate)||0))})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Amount (₦)"}),c.jsx(Ae,{type:"number",min:0,step:"0.01",placeholder:"Enter amount",value:U,onChange:z=>F(z.target.value),className:"h-11"})]}),c.jsx(be,{onClick:H,disabled:!(n!=null&&n.settings.transferEnabled)||!U||Number(U)<=0,className:"h-11 px-6 w-full sm:w-auto",children:"Transfer to Wallet"})]}),!(n!=null&&n.settings.transferEnabled)&&c.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Transfers are currently disabled by admin."})]}),n&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:n.referrals.perLevel.map((z,Z)=>c.jsxs("div",{className:"rounded-xl bg-white shadow p-4 text-center",children:[c.jsxs("div",{className:"text-xs text-gray-500",children:["Level ",Z+1]}),c.jsx("div",{className:"text-xl font-semibold",children:z})]},Z))}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Show"}),c.jsx("select",{value:T,onChange:z=>{E(1),C(Number(z.target.value))},className:"h-9 rounded-md border border-gray-300 px-2 text-sm",children:[10,20,50].map(z=>c.jsxs("option",{value:z,children:[z," / page"]},z))}),c.jsx("select",{value:g,onChange:z=>{E(1),v(Number(z.target.value))},className:"h-9 rounded-md border border-gray-300 px-2 text-sm",children:Array.from({length:Math.max(1,(n==null?void 0:n.settings.levels)||1)}).map((z,Z)=>c.jsxs("option",{value:Z+1,children:["Level ",Z+1]},Z))})]}),c.jsxs("div",{className:"relative w-full md:w-80",children:[c.jsx(Ef,{className:"h-4 w-4 text-gray-400 absolute left-3 top-2.5"}),c.jsx(Ae,{placeholder:"Search by name or username",value:R,onChange:z=>{E(1),N(z.target.value)},className:"pl-9 bg-gray-100 border-none rounded-full focus-visible:ring-[#1877F2]"})]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow p-0",children:O?O.items.length===0?c.jsx("div",{className:"p-6 text-gray-500",children:"No referrals found"}):c.jsx("div",{className:"max-h-[420px] overflow-y-auto pr-2",children:c.jsx("ul",{className:"divide-y",children:O.items.map(z=>c.jsxs("li",{className:"px-4 py-3 flex items-center gap-3",children:[c.jsxs($i,{className:"h-9 w-9",children:[c.jsx(Ii,{src:z.avatar?`${n7e}/uploads/${Xn(z.avatar)}`:""}),c.jsx(ea,{children:r7e(z.fullName||z.username)})]}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("div",{className:"font-medium truncate",children:z.fullName||z.username}),c.jsxs("div",{className:"text-xs text-gray-500",children:["@",z.username]})]}),c.jsx("div",{className:"text-xs text-gray-500",children:z.joinedAt?new Date(z.joinedAt).toLocaleDateString():""})]},z.id))})}):c.jsxs("div",{className:"p-6 text-gray-500 flex items-center gap-2",children:[c.jsx(ei,{className:"h-4 w-4 animate-spin"})," Loading…"]})}),c.jsxs("div",{className:"flex items-center justify-center gap-2 pb-6",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:b<=1,onClick:()=>E(z=>z-1),children:c.jsx(O4,{className:"h-4 w-4"})}),c.jsxs("div",{className:"text-sm",children:[Math.min(b,k)," / ",k]}),c.jsx(be,{variant:"outline",size:"sm",disabled:b>=k,onClick:()=>E(z=>z+1),children:c.jsx(Bw,{className:"h-4 w-4"})})]})]})]})})]})}function pm(e){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(e)}function s7e(e,t){if(pm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(pm(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zfe(e){var t=s7e(e,"string");return pm(t)=="symbol"?t:t+""}function $E(e,t,n){return(t=Zfe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mee(Object(n),!0).forEach(function(i){$E(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mee(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function o7e(e){if(Array.isArray(e))return e}function c7e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function BU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Qfe(e,t){if(e){if(typeof e=="string")return BU(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BU(e,t):void 0}}function l7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Id(e,t){return o7e(e)||c7e(e,t)||Qfe(e,t)||l7e()}function u7e(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Yd(e,t){if(e==null)return{};var n,i,o=u7e(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(i=0;i<u.length;i++)n=u[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d7e=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function h7e(e){var t=e.defaultInputValue,n=t===void 0?"":t,i=e.defaultMenuIsOpen,o=i===void 0?!1:i,u=e.defaultValue,h=u===void 0?null:u,p=e.inputValue,g=e.menuIsOpen,v=e.onChange,b=e.onInputChange,E=e.onMenuClose,T=e.onMenuOpen,C=e.value,R=Yd(e,d7e),N=w.useState(p!==void 0?p:n),O=Id(N,2),j=O[0],k=O[1],P=w.useState(g!==void 0?g:o),M=Id(P,2),D=M[0],U=M[1],F=w.useState(C!==void 0?C:h),H=Id(F,2),W=H[0],q=H[1],Y=w.useCallback(function(re,ee){typeof v=="function"&&v(re,ee),q(re)},[v]),z=w.useCallback(function(re,ee){var de;typeof b=="function"&&(de=b(re,ee)),k(de!==void 0?de:re)},[b]),Z=w.useCallback(function(){typeof T=="function"&&T(),U(!0)},[T]),X=w.useCallback(function(){typeof E=="function"&&E(),U(!1)},[E]),ae=p!==void 0?p:j,se=g!==void 0?g:D,J=C!==void 0?C:W;return hn(hn({},R),{},{inputValue:ae,menuIsOpen:se,onChange:Y,onInputChange:z,onMenuClose:X,onMenuOpen:Z,value:J})}function mn(){return mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mn.apply(null,arguments)}function f7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zfe(i.key),i)}}function p7e(e,t,n){return t&&Uee(e.prototype,t),n&&Uee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $U(e,t){return $U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$U(e,t)}function m7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$U(e,t)}function ZN(e){return ZN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ZN(e)}function epe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(epe=function(){return!!e})()}function g7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v7e(e,t){if(t&&(pm(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g7e(e)}function y7e(e){var t=epe();return function(){var n,i=ZN(e);if(t){var o=ZN(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return v7e(this,n)}}function _7e(e){if(Array.isArray(e))return BU(e)}function b7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function E7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PB(e){return _7e(e)||b7e(e)||Qfe(e)||E7e()}function w7e(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function S7e(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var x7e=function(){function e(n){var i=this;this._insertTag=function(o){var u;i.tags.length===0?i.insertionPoint?u=i.insertionPoint.nextSibling:i.prepend?u=i.container.firstChild:u=i.before:u=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(o,u),i.tags.push(o)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(i){i.forEach(this._insertTag)},t.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(S7e(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var u=w7e(o);try{u.insertRule(i,u.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(i));this.ctr++},t.flush=function(){this.tags.forEach(function(i){var o;return(o=i.parentNode)==null?void 0:o.removeChild(i)}),this.tags=[],this.ctr=0},e}(),gs="-ms-",QN="-moz-",Sr="-webkit-",tpe="comm",kB="rule",jB="decl",T7e="@import",npe="@keyframes",C7e="@layer",R7e=Math.abs,dI=String.fromCharCode,N7e=Object.assign;function A7e(e,t){return es(e,0)^45?(((t<<2^es(e,0))<<2^es(e,1))<<2^es(e,2))<<2^es(e,3):0}function rpe(e){return e.trim()}function I7e(e,t){return(e=t.exec(e))?e[0]:e}function xr(e,t,n){return e.replace(t,n)}function WU(e,t){return e.indexOf(t)}function es(e,t){return e.charCodeAt(t)|0}function H0(e,t,n){return e.slice(t,n)}function xu(e){return e.length}function DB(e){return e.length}function ZC(e,t){return t.push(e),e}function O7e(e,t){return e.map(t).join("")}var hI=1,_y=1,ipe=0,go=0,ha=0,o_="";function fI(e,t,n,i,o,u,h){return{value:e,root:t,parent:n,type:i,props:o,children:u,line:hI,column:_y,length:h,return:""}}function yE(e,t){return N7e(fI("",null,null,"",null,null,0),e,{length:-e.length},t)}function P7e(){return ha}function k7e(){return ha=go>0?es(o_,--go):0,_y--,ha===10&&(_y=1,hI--),ha}function Ho(){return ha=go<ipe?es(o_,go++):0,_y++,ha===10&&(_y=1,hI++),ha}function Lu(){return es(o_,go)}function YR(){return go}function aS(e,t){return H0(o_,e,t)}function z0(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ape(e){return hI=_y=1,ipe=xu(o_=e),go=0,[]}function spe(e){return o_="",e}function XR(e){return rpe(aS(go-1,GU(e===91?e+2:e===40?e+1:e)))}function j7e(e){for(;(ha=Lu())&&ha<33;)Ho();return z0(e)>2||z0(ha)>3?"":" "}function D7e(e,t){for(;--t&&Ho()&&!(ha<48||ha>102||ha>57&&ha<65||ha>70&&ha<97););return aS(e,YR()+(t<6&&Lu()==32&&Ho()==32))}function GU(e){for(;Ho();)switch(ha){case e:return go;case 34:case 39:e!==34&&e!==39&&GU(ha);break;case 40:e===41&&GU(e);break;case 92:Ho();break}return go}function L7e(e,t){for(;Ho()&&e+ha!==57;)if(e+ha===84&&Lu()===47)break;return"/*"+aS(t,go-1)+"*"+dI(e===47?e:Ho())}function M7e(e){for(;!z0(Lu());)Ho();return aS(e,go)}function U7e(e){return spe(JR("",null,null,null,[""],e=ape(e),0,[0],e))}function JR(e,t,n,i,o,u,h,p,g){for(var v=0,b=0,E=h,T=0,C=0,R=0,N=1,O=1,j=1,k=0,P="",M=o,D=u,U=i,F=P;O;)switch(R=k,k=Ho()){case 40:if(R!=108&&es(F,E-1)==58){WU(F+=xr(XR(k),"&","&\f"),"&\f")!=-1&&(j=-1);break}case 34:case 39:case 91:F+=XR(k);break;case 9:case 10:case 13:case 32:F+=j7e(R);break;case 92:F+=D7e(YR()-1,7);continue;case 47:switch(Lu()){case 42:case 47:ZC(F7e(L7e(Ho(),YR()),t,n),g);break;default:F+="/"}break;case 123*N:p[v++]=xu(F)*j;case 125*N:case 59:case 0:switch(k){case 0:case 125:O=0;case 59+b:j==-1&&(F=xr(F,/\f/g,"")),C>0&&xu(F)-E&&ZC(C>32?Vee(F+";",i,n,E-1):Vee(xr(F," ","")+";",i,n,E-2),g);break;case 59:F+=";";default:if(ZC(U=Fee(F,t,n,v,b,o,p,P,M=[],D=[],E),u),k===123)if(b===0)JR(F,t,U,U,M,u,E,p,D);else switch(T===99&&es(F,3)===110?100:T){case 100:case 108:case 109:case 115:JR(e,U,U,i&&ZC(Fee(e,U,U,0,0,o,p,P,o,M=[],E),D),o,D,E,p,i?M:D);break;default:JR(F,U,U,U,[""],D,0,p,D)}}v=b=C=0,N=j=1,P=F="",E=h;break;case 58:E=1+xu(F),C=R;default:if(N<1){if(k==123)--N;else if(k==125&&N++==0&&k7e()==125)continue}switch(F+=dI(k),k*N){case 38:j=b>0?1:(F+="\f",-1);break;case 44:p[v++]=(xu(F)-1)*j,j=1;break;case 64:Lu()===45&&(F+=XR(Ho())),T=Lu(),b=E=xu(P=F+=M7e(YR())),k++;break;case 45:R===45&&xu(F)==2&&(N=0)}}return u}function Fee(e,t,n,i,o,u,h,p,g,v,b){for(var E=o-1,T=o===0?u:[""],C=DB(T),R=0,N=0,O=0;R<i;++R)for(var j=0,k=H0(e,E+1,E=R7e(N=h[R])),P=e;j<C;++j)(P=rpe(N>0?T[j]+" "+k:xr(k,/&\f/g,T[j])))&&(g[O++]=P);return fI(e,t,n,o===0?kB:p,g,v,b)}function F7e(e,t,n){return fI(e,t,n,tpe,dI(P7e()),H0(e,2,-2),0)}function Vee(e,t,n,i){return fI(e,t,n,jB,H0(e,0,i),H0(e,i+1,-1),i)}function Bv(e,t){for(var n="",i=DB(e),o=0;o<i;o++)n+=t(e[o],o,e,t)||"";return n}function V7e(e,t,n,i){switch(e.type){case C7e:if(e.children.length)break;case T7e:case jB:return e.return=e.return||e.value;case tpe:return"";case npe:return e.return=e.value+"{"+Bv(e.children,i)+"}";case kB:e.value=e.props.join(",")}return xu(n=Bv(e.children,i))?e.return=e.value+"{"+n+"}":""}function B7e(e){var t=DB(e);return function(n,i,o,u){for(var h="",p=0;p<t;p++)h+=e[p](n,i,o,u)||"";return h}}function $7e(e){return function(t){t.root||(t=t.return)&&e(t)}}function W7e(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var G7e=function(t,n,i){for(var o=0,u=0;o=u,u=Lu(),o===38&&u===12&&(n[i]=1),!z0(u);)Ho();return aS(t,go)},H7e=function(t,n){var i=-1,o=44;do switch(z0(o)){case 0:o===38&&Lu()===12&&(n[i]=1),t[i]+=G7e(go-1,n,i);break;case 2:t[i]+=XR(o);break;case 4:if(o===44){t[++i]=Lu()===58?"&\f":"",n[i]=t[i].length;break}default:t[i]+=dI(o)}while(o=Ho());return t},z7e=function(t,n){return spe(H7e(ape(t),n))},Bee=new WeakMap,K7e=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,i=t.parent,o=t.column===i.column&&t.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!Bee.get(i))&&!o){Bee.set(t,!0);for(var u=[],h=z7e(n,u),p=i.props,g=0,v=0;g<h.length;g++)for(var b=0;b<p.length;b++,v++)t.props[v]=u[g]?h[g].replace(/&\f/g,p[b]):p[b]+" "+h[g]}}},q7e=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function ope(e,t){switch(A7e(e,t)){case 5103:return Sr+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Sr+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Sr+e+QN+e+gs+e+e;case 6828:case 4268:return Sr+e+gs+e+e;case 6165:return Sr+e+gs+"flex-"+e+e;case 5187:return Sr+e+xr(e,/(\w+).+(:[^]+)/,Sr+"box-$1$2"+gs+"flex-$1$2")+e;case 5443:return Sr+e+gs+"flex-item-"+xr(e,/flex-|-self/,"")+e;case 4675:return Sr+e+gs+"flex-line-pack"+xr(e,/align-content|flex-|-self/,"")+e;case 5548:return Sr+e+gs+xr(e,"shrink","negative")+e;case 5292:return Sr+e+gs+xr(e,"basis","preferred-size")+e;case 6060:return Sr+"box-"+xr(e,"-grow","")+Sr+e+gs+xr(e,"grow","positive")+e;case 4554:return Sr+xr(e,/([^-])(transform)/g,"$1"+Sr+"$2")+e;case 6187:return xr(xr(xr(e,/(zoom-|grab)/,Sr+"$1"),/(image-set)/,Sr+"$1"),e,"")+e;case 5495:case 3959:return xr(e,/(image-set\([^]*)/,Sr+"$1$`$1");case 4968:return xr(xr(e,/(.+:)(flex-)?(.*)/,Sr+"box-pack:$3"+gs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Sr+e+e;case 4095:case 3583:case 4068:case 2532:return xr(e,/(.+)-inline(.+)/,Sr+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xu(e)-1-t>6)switch(es(e,t+1)){case 109:if(es(e,t+4)!==45)break;case 102:return xr(e,/(.+:)(.+)-([^]+)/,"$1"+Sr+"$2-$3$1"+QN+(es(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~WU(e,"stretch")?ope(xr(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(es(e,t+1)!==115)break;case 6444:switch(es(e,xu(e)-3-(~WU(e,"!important")&&10))){case 107:return xr(e,":",":"+Sr)+e;case 101:return xr(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Sr+(es(e,14)===45?"inline-":"")+"box$3$1"+Sr+"$2$3$1"+gs+"$2box$3")+e}break;case 5936:switch(es(e,t+11)){case 114:return Sr+e+gs+xr(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Sr+e+gs+xr(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Sr+e+gs+xr(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Sr+e+gs+e+e}return e}var Y7e=function(t,n,i,o){if(t.length>-1&&!t.return)switch(t.type){case jB:t.return=ope(t.value,t.length);break;case npe:return Bv([yE(t,{value:xr(t.value,"@","@"+Sr)})],o);case kB:if(t.length)return O7e(t.props,function(u){switch(I7e(u,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Bv([yE(t,{props:[xr(u,/:(read-\w+)/,":"+QN+"$1")]})],o);case"::placeholder":return Bv([yE(t,{props:[xr(u,/:(plac\w+)/,":"+Sr+"input-$1")]}),yE(t,{props:[xr(u,/:(plac\w+)/,":"+QN+"$1")]}),yE(t,{props:[xr(u,/:(plac\w+)/,gs+"input-$1")]})],o)}return""})}},X7e=[Y7e],J7e=function(t){var n=t.key;if(n==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(N){var O=N.getAttribute("data-emotion");O.indexOf(" ")!==-1&&(document.head.appendChild(N),N.setAttribute("data-s",""))})}var o=t.stylisPlugins||X7e,u={},h,p=[];h=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(N){for(var O=N.getAttribute("data-emotion").split(" "),j=1;j<O.length;j++)u[O[j]]=!0;p.push(N)});var g,v=[K7e,q7e];{var b,E=[V7e,$7e(function(N){b.insert(N)})],T=B7e(v.concat(o,E)),C=function(O){return Bv(U7e(O),T)};g=function(O,j,k,P){b=k,C(O?O+"{"+j.styles+"}":j.styles),P&&(R.inserted[j.name]=!0)}}var R={key:n,sheet:new x7e({key:n,container:h,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:u,registered:{},insert:g};return R.sheet.hydrate(p),R},cpe={exports:{}},$r={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ha=typeof Symbol=="function"&&Symbol.for,LB=Ha?Symbol.for("react.element"):60103,MB=Ha?Symbol.for("react.portal"):60106,pI=Ha?Symbol.for("react.fragment"):60107,mI=Ha?Symbol.for("react.strict_mode"):60108,gI=Ha?Symbol.for("react.profiler"):60114,vI=Ha?Symbol.for("react.provider"):60109,yI=Ha?Symbol.for("react.context"):60110,UB=Ha?Symbol.for("react.async_mode"):60111,_I=Ha?Symbol.for("react.concurrent_mode"):60111,bI=Ha?Symbol.for("react.forward_ref"):60112,EI=Ha?Symbol.for("react.suspense"):60113,Z7e=Ha?Symbol.for("react.suspense_list"):60120,wI=Ha?Symbol.for("react.memo"):60115,SI=Ha?Symbol.for("react.lazy"):60116,Q7e=Ha?Symbol.for("react.block"):60121,eKe=Ha?Symbol.for("react.fundamental"):60117,tKe=Ha?Symbol.for("react.responder"):60118,nKe=Ha?Symbol.for("react.scope"):60119;function ec(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case LB:switch(e=e.type,e){case UB:case _I:case pI:case gI:case mI:case EI:return e;default:switch(e=e&&e.$$typeof,e){case yI:case bI:case SI:case wI:case vI:return e;default:return t}}case MB:return t}}}function lpe(e){return ec(e)===_I}$r.AsyncMode=UB;$r.ConcurrentMode=_I;$r.ContextConsumer=yI;$r.ContextProvider=vI;$r.Element=LB;$r.ForwardRef=bI;$r.Fragment=pI;$r.Lazy=SI;$r.Memo=wI;$r.Portal=MB;$r.Profiler=gI;$r.StrictMode=mI;$r.Suspense=EI;$r.isAsyncMode=function(e){return lpe(e)||ec(e)===UB};$r.isConcurrentMode=lpe;$r.isContextConsumer=function(e){return ec(e)===yI};$r.isContextProvider=function(e){return ec(e)===vI};$r.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===LB};$r.isForwardRef=function(e){return ec(e)===bI};$r.isFragment=function(e){return ec(e)===pI};$r.isLazy=function(e){return ec(e)===SI};$r.isMemo=function(e){return ec(e)===wI};$r.isPortal=function(e){return ec(e)===MB};$r.isProfiler=function(e){return ec(e)===gI};$r.isStrictMode=function(e){return ec(e)===mI};$r.isSuspense=function(e){return ec(e)===EI};$r.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===pI||e===_I||e===gI||e===mI||e===EI||e===Z7e||typeof e=="object"&&e!==null&&(e.$$typeof===SI||e.$$typeof===wI||e.$$typeof===vI||e.$$typeof===yI||e.$$typeof===bI||e.$$typeof===eKe||e.$$typeof===tKe||e.$$typeof===nKe||e.$$typeof===Q7e)};$r.typeOf=ec;cpe.exports=$r;var rKe=cpe.exports,upe=rKe,iKe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},aKe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},dpe={};dpe[upe.ForwardRef]=iKe;dpe[upe.Memo]=aKe;var sKe=!0;function oKe(e,t,n){var i="";return n.split(" ").forEach(function(o){e[o]!==void 0?t.push(e[o]+";"):o&&(i+=o+" ")}),i}var hpe=function(t,n,i){var o=t.key+"-"+n.name;(i===!1||sKe===!1)&&t.registered[o]===void 0&&(t.registered[o]=n.styles)},cKe=function(t,n,i){hpe(t,n,i);var o=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var u=n;do t.insert(n===u?"."+o:"",u,t.sheet,!0),u=u.next;while(u!==void 0)}};function lKe(e){for(var t=0,n,i=0,o=e.length;o>=4;++i,o-=4)n=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(o){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var uKe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},dKe=/[A-Z]|^ms/g,hKe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,fpe=function(t){return t.charCodeAt(1)===45},$ee=function(t){return t!=null&&typeof t!="boolean"},bL=W7e(function(e){return fpe(e)?e:e.replace(dKe,"-$&").toLowerCase()}),Wee=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(hKe,function(i,o,u){return Tu={name:o,styles:u,next:Tu},o})}return uKe[t]!==1&&!fpe(t)&&typeof n=="number"&&n!==0?n+"px":n};function K0(e,t,n){if(n==null)return"";var i=n;if(i.__emotion_styles!==void 0)return i;switch(typeof n){case"boolean":return"";case"object":{var o=n;if(o.anim===1)return Tu={name:o.name,styles:o.styles,next:Tu},o.name;var u=n;if(u.styles!==void 0){var h=u.next;if(h!==void 0)for(;h!==void 0;)Tu={name:h.name,styles:h.styles,next:Tu},h=h.next;var p=u.styles+";";return p}return fKe(e,t,n)}case"function":{if(e!==void 0){var g=Tu,v=n(e);return Tu=g,K0(e,t,v)}break}}var b=n;return b}function fKe(e,t,n){var i="";if(Array.isArray(n))for(var o=0;o<n.length;o++)i+=K0(e,t,n[o])+";";else for(var u in n){var h=n[u];if(typeof h!="object"){var p=h;$ee(p)&&(i+=bL(u)+":"+Wee(u,p)+";")}else if(Array.isArray(h)&&typeof h[0]=="string"&&t==null)for(var g=0;g<h.length;g++)$ee(h[g])&&(i+=bL(u)+":"+Wee(u,h[g])+";");else{var v=K0(e,t,h);switch(u){case"animation":case"animationName":{i+=bL(u)+":"+v+";";break}default:i+=u+"{"+v+"}"}}}return i}var Gee=/label:\s*([^\s;{]+)\s*(;|$)/g,Tu;function ppe(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,o="";Tu=void 0;var u=e[0];if(u==null||u.raw===void 0)i=!1,o+=K0(n,t,u);else{var h=u;o+=h[0]}for(var p=1;p<e.length;p++)if(o+=K0(n,t,e[p]),i){var g=u;o+=g[p]}Gee.lastIndex=0;for(var v="",b;(b=Gee.exec(o))!==null;)v+="-"+b[1];var E=lKe(o)+v;return{name:E,styles:o,next:Tu}}var pKe=function(t){return t()},mKe=s0.useInsertionEffect?s0.useInsertionEffect:!1,gKe=mKe||pKe,mpe=w.createContext(typeof HTMLElement<"u"?J7e({key:"css"}):null);mpe.Provider;var vKe=function(t){return w.forwardRef(function(n,i){var o=w.useContext(mpe);return t(n,o,i)})},yKe=w.createContext({}),FB={}.hasOwnProperty,HU="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",_Ke=function(t,n){var i={};for(var o in n)FB.call(n,o)&&(i[o]=n[o]);return i[HU]=t,i},bKe=function(t){var n=t.cache,i=t.serialized,o=t.isStringTag;return hpe(n,i,o),gKe(function(){return cKe(n,i,o)}),null},EKe=vKe(function(e,t,n){var i=e.css;typeof i=="string"&&t.registered[i]!==void 0&&(i=t.registered[i]);var o=e[HU],u=[i],h="";typeof e.className=="string"?h=oKe(t.registered,u,e.className):e.className!=null&&(h=e.className+" ");var p=ppe(u,void 0,w.useContext(yKe));h+=t.key+"-"+p.name;var g={};for(var v in e)FB.call(e,v)&&v!=="css"&&v!==HU&&(g[v]=e[v]);return g.className=h,n&&(g.ref=n),w.createElement(w.Fragment,null,w.createElement(bKe,{cache:t,serialized:p,isStringTag:typeof o=="string"}),w.createElement(o,g))}),wKe=EKe,nn=function(t,n){var i=arguments;if(n==null||!FB.call(n,"css"))return w.createElement.apply(void 0,i);var o=i.length,u=new Array(o);u[0]=wKe,u[1]=_Ke(t,n);for(var h=2;h<o;h++)u[h]=i[h];return w.createElement.apply(null,u)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(nn||(nn={}));function VB(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ppe(t)}function SKe(){var e=VB.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function xKe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var zU=w.useLayoutEffect,TKe=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],eA=function(){};function CKe(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function RKe(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var u=[].concat(i);if(t&&e)for(var h in t)t.hasOwnProperty(h)&&t[h]&&u.push("".concat(CKe(e,h)));return u.filter(function(p){return p}).map(function(p){return String(p).trim()}).join(" ")}var Hee=function(t){return LKe(t)?t.filter(Boolean):pm(t)==="object"&&t!==null?[t]:[]},gpe=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var n=Yd(t,TKe);return hn({},n)},Wi=function(t,n,i){var o=t.cx,u=t.getStyles,h=t.getClassNames,p=t.className;return{css:u(n,t),className:o(i??{},h(n,t),p)}};function xI(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function NKe(e){return xI(e)?window.innerHeight:e.clientHeight}function vpe(e){return xI(e)?window.pageYOffset:e.scrollTop}function tA(e,t){if(xI(e)){window.scrollTo(0,t);return}e.scrollTop=t}function AKe(e){var t=getComputedStyle(e),n=t.position==="absolute",i=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var o=e;o=o.parentElement;)if(t=getComputedStyle(o),!(n&&t.position==="static")&&i.test(t.overflow+t.overflowY+t.overflowX))return o;return document.documentElement}function IKe(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t}function QC(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:eA,o=vpe(e),u=t-o,h=10,p=0;function g(){p+=h;var v=IKe(p,o,u,n);tA(e,v),p<n?window.requestAnimationFrame(g):i(e)}g()}function zee(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),o=t.offsetHeight/3;i.bottom+o>n.bottom?tA(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+o,e.scrollHeight)):i.top-o<n.top&&tA(e,Math.max(t.offsetTop-o,0))}function OKe(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function Kee(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function PKe(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var ype=!1,kKe={get passive(){return ype=!0}},eR=typeof window<"u"?window:{};eR.addEventListener&&eR.removeEventListener&&(eR.addEventListener("p",eA,kKe),eR.removeEventListener("p",eA,!1));var jKe=ype;function DKe(e){return e!=null}function LKe(e){return Array.isArray(e)}function tR(e,t,n){return e?t:n}var MKe=function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var u=Object.entries(t).filter(function(h){var p=Id(h,1),g=p[0];return!i.includes(g)});return u.reduce(function(h,p){var g=Id(p,2),v=g[0],b=g[1];return h[v]=b,h},{})},UKe=["children","innerProps"],FKe=["children","innerProps"];function VKe(e){var t=e.maxHeight,n=e.menuEl,i=e.minHeight,o=e.placement,u=e.shouldScroll,h=e.isFixedPosition,p=e.controlHeight,g=AKe(n),v={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return v;var b=g.getBoundingClientRect(),E=b.height,T=n.getBoundingClientRect(),C=T.bottom,R=T.height,N=T.top,O=n.offsetParent.getBoundingClientRect(),j=O.top,k=h?window.innerHeight:NKe(g),P=vpe(g),M=parseInt(getComputedStyle(n).marginBottom,10),D=parseInt(getComputedStyle(n).marginTop,10),U=j-D,F=k-N,H=U+P,W=E-P-N,q=C-k+P+M,Y=P+N-D,z=160;switch(o){case"auto":case"bottom":if(F>=R)return{placement:"bottom",maxHeight:t};if(W>=R&&!h)return u&&QC(g,q,z),{placement:"bottom",maxHeight:t};if(!h&&W>=i||h&&F>=i){u&&QC(g,q,z);var Z=h?F-M:W-M;return{placement:"bottom",maxHeight:Z}}if(o==="auto"||h){var X=t,ae=h?U:H;return ae>=i&&(X=Math.min(ae-M-p,t)),{placement:"top",maxHeight:X}}if(o==="bottom")return u&&tA(g,q),{placement:"bottom",maxHeight:t};break;case"top":if(U>=R)return{placement:"top",maxHeight:t};if(H>=R&&!h)return u&&QC(g,Y,z),{placement:"top",maxHeight:t};if(!h&&H>=i||h&&U>=i){var se=t;return(!h&&H>=i||h&&U>=i)&&(se=h?U-D:H-D),u&&QC(g,Y,z),{placement:"top",maxHeight:se}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(o,'".'))}return v}function BKe(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var _pe=function(t){return t==="auto"?"bottom":t},$Ke=function(t,n){var i,o=t.placement,u=t.theme,h=u.borderRadius,p=u.spacing,g=u.colors;return hn((i={label:"menu"},$E(i,BKe(o),"100%"),$E(i,"position","absolute"),$E(i,"width","100%"),$E(i,"zIndex",1),i),n?{}:{backgroundColor:g.neutral0,borderRadius:h,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:p.menuGutter,marginTop:p.menuGutter})},bpe=w.createContext(null),WKe=function(t){var n=t.children,i=t.minMenuHeight,o=t.maxMenuHeight,u=t.menuPlacement,h=t.menuPosition,p=t.menuShouldScrollIntoView,g=t.theme,v=w.useContext(bpe)||{},b=v.setPortalPlacement,E=w.useRef(null),T=w.useState(o),C=Id(T,2),R=C[0],N=C[1],O=w.useState(null),j=Id(O,2),k=j[0],P=j[1],M=g.spacing.controlHeight;return zU(function(){var D=E.current;if(D){var U=h==="fixed",F=p&&!U,H=VKe({maxHeight:o,menuEl:D,minHeight:i,placement:u,shouldScroll:F,isFixedPosition:U,controlHeight:M});N(H.maxHeight),P(H.placement),b==null||b(H.placement)}},[o,u,h,p,i,b,M]),n({ref:E,placerProps:hn(hn({},t),{},{placement:k||_pe(u),maxHeight:R})})},GKe=function(t){var n=t.children,i=t.innerRef,o=t.innerProps;return nn("div",mn({},Wi(t,"menu",{menu:!0}),{ref:i},o),n)},HKe=GKe,zKe=function(t,n){var i=t.maxHeight,o=t.theme.spacing.baseUnit;return hn({maxHeight:i,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},n?{}:{paddingBottom:o,paddingTop:o})},KKe=function(t){var n=t.children,i=t.innerProps,o=t.innerRef,u=t.isMulti;return nn("div",mn({},Wi(t,"menuList",{"menu-list":!0,"menu-list--is-multi":u}),{ref:o},i),n)},Epe=function(t,n){var i=t.theme,o=i.spacing.baseUnit,u=i.colors;return hn({textAlign:"center"},n?{}:{color:u.neutral40,padding:"".concat(o*2,"px ").concat(o*3,"px")})},qKe=Epe,YKe=Epe,XKe=function(t){var n=t.children,i=n===void 0?"No options":n,o=t.innerProps,u=Yd(t,UKe);return nn("div",mn({},Wi(hn(hn({},u),{},{children:i,innerProps:o}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),o),i)},JKe=function(t){var n=t.children,i=n===void 0?"Loading...":n,o=t.innerProps,u=Yd(t,FKe);return nn("div",mn({},Wi(hn(hn({},u),{},{children:i,innerProps:o}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),o),i)},ZKe=function(t){var n=t.rect,i=t.offset,o=t.position;return{left:n.left,position:o,top:i,width:n.width,zIndex:1}},QKe=function(t){var n=t.appendTo,i=t.children,o=t.controlElement,u=t.innerProps,h=t.menuPlacement,p=t.menuPosition,g=w.useRef(null),v=w.useRef(null),b=w.useState(_pe(h)),E=Id(b,2),T=E[0],C=E[1],R=w.useMemo(function(){return{setPortalPlacement:C}},[]),N=w.useState(null),O=Id(N,2),j=O[0],k=O[1],P=w.useCallback(function(){if(o){var F=OKe(o),H=p==="fixed"?0:window.pageYOffset,W=F[T]+H;(W!==(j==null?void 0:j.offset)||F.left!==(j==null?void 0:j.rect.left)||F.width!==(j==null?void 0:j.rect.width))&&k({offset:W,rect:F})}},[o,p,T,j==null?void 0:j.offset,j==null?void 0:j.rect.left,j==null?void 0:j.rect.width]);zU(function(){P()},[P]);var M=w.useCallback(function(){typeof v.current=="function"&&(v.current(),v.current=null),o&&g.current&&(v.current=qoe(o,g.current,P,{elementResize:"ResizeObserver"in window}))},[o,P]);zU(function(){M()},[M]);var D=w.useCallback(function(F){g.current=F,M()},[M]);if(!n&&p!=="fixed"||!j)return null;var U=nn("div",mn({ref:D},Wi(hn(hn({},t),{},{offset:j.offset,position:p,rect:j.rect}),"menuPortal",{"menu-portal":!0}),u),i);return nn(bpe.Provider,{value:R},n?Af.createPortal(U,n):U)},eqe=function(t){var n=t.isDisabled,i=t.isRtl;return{label:"container",direction:i?"rtl":void 0,pointerEvents:n?"none":void 0,position:"relative"}},tqe=function(t){var n=t.children,i=t.innerProps,o=t.isDisabled,u=t.isRtl;return nn("div",mn({},Wi(t,"container",{"--is-disabled":o,"--is-rtl":u}),i),n)},nqe=function(t,n){var i=t.theme.spacing,o=t.isMulti,u=t.hasValue,h=t.selectProps.controlShouldRenderValue;return hn({alignItems:"center",display:o&&u&&h?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},n?{}:{padding:"".concat(i.baseUnit/2,"px ").concat(i.baseUnit*2,"px")})},rqe=function(t){var n=t.children,i=t.innerProps,o=t.isMulti,u=t.hasValue;return nn("div",mn({},Wi(t,"valueContainer",{"value-container":!0,"value-container--is-multi":o,"value-container--has-value":u}),i),n)},iqe=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},aqe=function(t){var n=t.children,i=t.innerProps;return nn("div",mn({},Wi(t,"indicatorsContainer",{indicators:!0}),i),n)},qee,sqe=["size"],oqe=["innerProps","isRtl","size"],cqe={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},wpe=function(t){var n=t.size,i=Yd(t,sqe);return nn("svg",mn({height:n,width:n,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:cqe},i))},BB=function(t){return nn(wpe,mn({size:20},t),nn("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Spe=function(t){return nn(wpe,mn({size:20},t),nn("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},xpe=function(t,n){var i=t.isFocused,o=t.theme,u=o.spacing.baseUnit,h=o.colors;return hn({label:"indicatorContainer",display:"flex",transition:"color 150ms"},n?{}:{color:i?h.neutral60:h.neutral20,padding:u*2,":hover":{color:i?h.neutral80:h.neutral40}})},lqe=xpe,uqe=function(t){var n=t.children,i=t.innerProps;return nn("div",mn({},Wi(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),i),n||nn(Spe,null))},dqe=xpe,hqe=function(t){var n=t.children,i=t.innerProps;return nn("div",mn({},Wi(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),i),n||nn(BB,null))},fqe=function(t,n){var i=t.isDisabled,o=t.theme,u=o.spacing.baseUnit,h=o.colors;return hn({label:"indicatorSeparator",alignSelf:"stretch",width:1},n?{}:{backgroundColor:i?h.neutral10:h.neutral20,marginBottom:u*2,marginTop:u*2})},pqe=function(t){var n=t.innerProps;return nn("span",mn({},n,Wi(t,"indicatorSeparator",{"indicator-separator":!0})))},mqe=SKe(qee||(qee=xKe([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),gqe=function(t,n){var i=t.isFocused,o=t.size,u=t.theme,h=u.colors,p=u.spacing.baseUnit;return hn({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:o,lineHeight:1,marginRight:o,textAlign:"center",verticalAlign:"middle"},n?{}:{color:i?h.neutral60:h.neutral20,padding:p*2})},EL=function(t){var n=t.delay,i=t.offset;return nn("span",{css:VB({animation:"".concat(mqe," 1s ease-in-out ").concat(n,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:i?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},vqe=function(t){var n=t.innerProps,i=t.isRtl,o=t.size,u=o===void 0?4:o,h=Yd(t,oqe);return nn("div",mn({},Wi(hn(hn({},h),{},{innerProps:n,isRtl:i,size:u}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),n),nn(EL,{delay:0,offset:i}),nn(EL,{delay:160,offset:!0}),nn(EL,{delay:320,offset:!i}))},yqe=function(t,n){var i=t.isDisabled,o=t.isFocused,u=t.theme,h=u.colors,p=u.borderRadius,g=u.spacing;return hn({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:g.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},n?{}:{backgroundColor:i?h.neutral5:h.neutral0,borderColor:i?h.neutral10:o?h.primary:h.neutral20,borderRadius:p,borderStyle:"solid",borderWidth:1,boxShadow:o?"0 0 0 1px ".concat(h.primary):void 0,"&:hover":{borderColor:o?h.primary:h.neutral30}})},_qe=function(t){var n=t.children,i=t.isDisabled,o=t.isFocused,u=t.innerRef,h=t.innerProps,p=t.menuIsOpen;return nn("div",mn({ref:u},Wi(t,"control",{control:!0,"control--is-disabled":i,"control--is-focused":o,"control--menu-is-open":p}),h,{"aria-disabled":i||void 0}),n)},bqe=_qe,Eqe=["data"],wqe=function(t,n){var i=t.theme.spacing;return n?{}:{paddingBottom:i.baseUnit*2,paddingTop:i.baseUnit*2}},Sqe=function(t){var n=t.children,i=t.cx,o=t.getStyles,u=t.getClassNames,h=t.Heading,p=t.headingProps,g=t.innerProps,v=t.label,b=t.theme,E=t.selectProps;return nn("div",mn({},Wi(t,"group",{group:!0}),g),nn(h,mn({},p,{selectProps:E,theme:b,getStyles:o,getClassNames:u,cx:i}),v),nn("div",null,n))},xqe=function(t,n){var i=t.theme,o=i.colors,u=i.spacing;return hn({label:"group",cursor:"default",display:"block"},n?{}:{color:o.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:u.baseUnit*3,paddingRight:u.baseUnit*3,textTransform:"uppercase"})},Tqe=function(t){var n=gpe(t);n.data;var i=Yd(n,Eqe);return nn("div",mn({},Wi(t,"groupHeading",{"group-heading":!0}),i))},Cqe=Sqe,Rqe=["innerRef","isDisabled","isHidden","inputClassName"],Nqe=function(t,n){var i=t.isDisabled,o=t.value,u=t.theme,h=u.spacing,p=u.colors;return hn(hn({visibility:i?"hidden":"visible",transform:o?"translateZ(0)":""},Aqe),n?{}:{margin:h.baseUnit/2,paddingBottom:h.baseUnit/2,paddingTop:h.baseUnit/2,color:p.neutral80})},Tpe={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Aqe={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":hn({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Tpe)},Iqe=function(t){return hn({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},Tpe)},Oqe=function(t){var n=t.cx,i=t.value,o=gpe(t),u=o.innerRef,h=o.isDisabled,p=o.isHidden,g=o.inputClassName,v=Yd(o,Rqe);return nn("div",mn({},Wi(t,"input",{"input-container":!0}),{"data-value":i||""}),nn("input",mn({className:n({input:!0},g),ref:u,style:Iqe(p),disabled:h},v)))},Pqe=Oqe,kqe=function(t,n){var i=t.theme,o=i.spacing,u=i.borderRadius,h=i.colors;return hn({label:"multiValue",display:"flex",minWidth:0},n?{}:{backgroundColor:h.neutral10,borderRadius:u/2,margin:o.baseUnit/2})},jqe=function(t,n){var i=t.theme,o=i.borderRadius,u=i.colors,h=t.cropWithEllipsis;return hn({overflow:"hidden",textOverflow:h||h===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},n?{}:{borderRadius:o/2,color:u.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},Dqe=function(t,n){var i=t.theme,o=i.spacing,u=i.borderRadius,h=i.colors,p=t.isFocused;return hn({alignItems:"center",display:"flex"},n?{}:{borderRadius:u/2,backgroundColor:p?h.dangerLight:void 0,paddingLeft:o.baseUnit,paddingRight:o.baseUnit,":hover":{backgroundColor:h.dangerLight,color:h.danger}})},Cpe=function(t){var n=t.children,i=t.innerProps;return nn("div",i,n)},Lqe=Cpe,Mqe=Cpe;function Uqe(e){var t=e.children,n=e.innerProps;return nn("div",mn({role:"button"},n),t||nn(BB,{size:14}))}var Fqe=function(t){var n=t.children,i=t.components,o=t.data,u=t.innerProps,h=t.isDisabled,p=t.removeProps,g=t.selectProps,v=i.Container,b=i.Label,E=i.Remove;return nn(v,{data:o,innerProps:hn(hn({},Wi(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":h})),u),selectProps:g},nn(b,{data:o,innerProps:hn({},Wi(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:g},n),nn(E,{data:o,innerProps:hn(hn({},Wi(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(n||"option")},p),selectProps:g}))},Vqe=Fqe,Bqe=function(t,n){var i=t.isDisabled,o=t.isFocused,u=t.isSelected,h=t.theme,p=h.spacing,g=h.colors;return hn({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},n?{}:{backgroundColor:u?g.primary:o?g.primary25:"transparent",color:i?g.neutral20:u?g.neutral0:"inherit",padding:"".concat(p.baseUnit*2,"px ").concat(p.baseUnit*3,"px"),":active":{backgroundColor:i?void 0:u?g.primary:g.primary50}})},$qe=function(t){var n=t.children,i=t.isDisabled,o=t.isFocused,u=t.isSelected,h=t.innerRef,p=t.innerProps;return nn("div",mn({},Wi(t,"option",{option:!0,"option--is-disabled":i,"option--is-focused":o,"option--is-selected":u}),{ref:h,"aria-disabled":i},p),n)},Wqe=$qe,Gqe=function(t,n){var i=t.theme,o=i.spacing,u=i.colors;return hn({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},n?{}:{color:u.neutral50,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},Hqe=function(t){var n=t.children,i=t.innerProps;return nn("div",mn({},Wi(t,"placeholder",{placeholder:!0}),i),n)},zqe=Hqe,Kqe=function(t,n){var i=t.isDisabled,o=t.theme,u=o.spacing,h=o.colors;return hn({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n?{}:{color:i?h.neutral40:h.neutral80,marginLeft:u.baseUnit/2,marginRight:u.baseUnit/2})},qqe=function(t){var n=t.children,i=t.isDisabled,o=t.innerProps;return nn("div",mn({},Wi(t,"singleValue",{"single-value":!0,"single-value--is-disabled":i}),o),n)},Yqe=qqe,Xqe={ClearIndicator:hqe,Control:bqe,DropdownIndicator:uqe,DownChevron:Spe,CrossIcon:BB,Group:Cqe,GroupHeading:Tqe,IndicatorsContainer:aqe,IndicatorSeparator:pqe,Input:Pqe,LoadingIndicator:vqe,Menu:HKe,MenuList:KKe,MenuPortal:QKe,LoadingMessage:JKe,NoOptionsMessage:XKe,MultiValue:Vqe,MultiValueContainer:Lqe,MultiValueLabel:Mqe,MultiValueRemove:Uqe,Option:Wqe,Placeholder:zqe,SelectContainer:tqe,SingleValue:Yqe,ValueContainer:rqe},Jqe=function(t){return hn(hn({},Xqe),t.components)},Yee=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Zqe(e,t){return!!(e===t||Yee(e)&&Yee(t))}function Qqe(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Zqe(e[n],t[n]))return!1;return!0}function eYe(e,t){t===void 0&&(t=Qqe);var n=null;function i(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];if(n&&n.lastThis===this&&t(o,n.lastArgs))return n.lastResult;var h=e.apply(this,o);return n={lastResult:h,lastArgs:o,lastThis:this},h}return i.clear=function(){n=null},i}var tYe={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},nYe=function(t){return nn("span",mn({css:tYe},t))},Xee=nYe,rYe={guidance:function(t){var n=t.isSearchable,i=t.isMulti,o=t.tabSelectsValue,u=t.context,h=t.isInitialFocus;switch(u){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(o?", press Tab to select the option and exit the menu":"",".");case"input":return h?"".concat(t["aria-label"]||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(i?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var n=t.action,i=t.label,o=i===void 0?"":i,u=t.labels,h=t.isDisabled;switch(n){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(o,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(u.length>1?"s":""," ").concat(u.join(","),", selected.");case"select-option":return h?"option ".concat(o," is disabled. Select another option."):"option ".concat(o,", selected.");default:return""}},onFocus:function(t){var n=t.context,i=t.focused,o=t.options,u=t.label,h=u===void 0?"":u,p=t.selectValue,g=t.isDisabled,v=t.isSelected,b=t.isAppleDevice,E=function(N,O){return N&&N.length?"".concat(N.indexOf(O)+1," of ").concat(N.length):""};if(n==="value"&&p)return"value ".concat(h," focused, ").concat(E(p,i),".");if(n==="menu"&&b){var T=g?" disabled":"",C="".concat(v?" selected":"").concat(T);return"".concat(h).concat(C,", ").concat(E(o,i),".")}return""},onFilter:function(t){var n=t.inputValue,i=t.resultsMessage;return"".concat(i).concat(n?" for search term "+n:"",".")}},iYe=function(t){var n=t.ariaSelection,i=t.focusedOption,o=t.focusedValue,u=t.focusableOptions,h=t.isFocused,p=t.selectValue,g=t.selectProps,v=t.id,b=t.isAppleDevice,E=g.ariaLiveMessages,T=g.getOptionLabel,C=g.inputValue,R=g.isMulti,N=g.isOptionDisabled,O=g.isSearchable,j=g.menuIsOpen,k=g.options,P=g.screenReaderStatus,M=g.tabSelectsValue,D=g.isLoading,U=g["aria-label"],F=g["aria-live"],H=w.useMemo(function(){return hn(hn({},rYe),E||{})},[E]),W=w.useMemo(function(){var ae="";if(n&&H.onChange){var se=n.option,J=n.options,re=n.removedValue,ee=n.removedValues,de=n.value,xe=function(ft){return Array.isArray(ft)?null:ft},ve=re||se||xe(de),Te=ve?T(ve):"",Pe=J||ee||void 0,qe=Pe?Pe.map(T):[],st=hn({isDisabled:ve&&N(ve,p),label:Te,labels:qe},n);ae=H.onChange(st)}return ae},[n,H,N,p,T]),q=w.useMemo(function(){var ae="",se=i||o,J=!!(i&&p&&p.includes(i));if(se&&H.onFocus){var re={focused:se,label:T(se),isDisabled:N(se,p),isSelected:J,options:u,context:se===i?"menu":"value",selectValue:p,isAppleDevice:b};ae=H.onFocus(re)}return ae},[i,o,T,N,H,u,p,b]),Y=w.useMemo(function(){var ae="";if(j&&k.length&&!D&&H.onFilter){var se=P({count:u.length});ae=H.onFilter({inputValue:C,resultsMessage:se})}return ae},[u,C,j,H,k,P,D]),z=(n==null?void 0:n.action)==="initial-input-focus",Z=w.useMemo(function(){var ae="";if(H.guidance){var se=o?"value":j?"menu":"input";ae=H.guidance({"aria-label":U,context:se,isDisabled:i&&N(i,p),isMulti:R,isSearchable:O,tabSelectsValue:M,isInitialFocus:z})}return ae},[U,i,o,R,N,O,j,H,p,M,z]),X=nn(w.Fragment,null,nn("span",{id:"aria-selection"},W),nn("span",{id:"aria-focused"},q),nn("span",{id:"aria-results"},Y),nn("span",{id:"aria-guidance"},Z));return nn(w.Fragment,null,nn(Xee,{id:v},z&&X),nn(Xee,{"aria-live":F,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},h&&!z&&X))},aYe=iYe,KU=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],sYe=new RegExp("["+KU.map(function(e){return e.letters}).join("")+"]","g"),Rpe={};for(var wL=0;wL<KU.length;wL++)for(var SL=KU[wL],xL=0;xL<SL.letters.length;xL++)Rpe[SL.letters[xL]]=SL.base;var Npe=function(t){return t.replace(sYe,function(n){return Rpe[n]})},oYe=eYe(Npe),Jee=function(t){return t.replace(/^\s+|\s+$/g,"")},cYe=function(t){return"".concat(t.label," ").concat(t.value)},lYe=function(t){return function(n,i){if(n.data.__isNew__)return!0;var o=hn({ignoreCase:!0,ignoreAccents:!0,stringify:cYe,trim:!0,matchFrom:"any"},t),u=o.ignoreCase,h=o.ignoreAccents,p=o.stringify,g=o.trim,v=o.matchFrom,b=g?Jee(i):i,E=g?Jee(p(n)):p(n);return u&&(b=b.toLowerCase(),E=E.toLowerCase()),h&&(b=oYe(b),E=Npe(E)),v==="start"?E.substr(0,b.length)===b:E.indexOf(b)>-1}},uYe=["innerRef"];function dYe(e){var t=e.innerRef,n=Yd(e,uYe),i=MKe(n,"onExited","in","enter","exit","appear");return nn("input",mn({ref:t},i,{css:VB({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var hYe=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function fYe(e){var t=e.isEnabled,n=e.onBottomArrive,i=e.onBottomLeave,o=e.onTopArrive,u=e.onTopLeave,h=w.useRef(!1),p=w.useRef(!1),g=w.useRef(0),v=w.useRef(null),b=w.useCallback(function(O,j){if(v.current!==null){var k=v.current,P=k.scrollTop,M=k.scrollHeight,D=k.clientHeight,U=v.current,F=j>0,H=M-D-P,W=!1;H>j&&h.current&&(i&&i(O),h.current=!1),F&&p.current&&(u&&u(O),p.current=!1),F&&j>H?(n&&!h.current&&n(O),U.scrollTop=M,W=!0,h.current=!0):!F&&-j>P&&(o&&!p.current&&o(O),U.scrollTop=0,W=!0,p.current=!0),W&&hYe(O)}},[n,i,o,u]),E=w.useCallback(function(O){b(O,O.deltaY)},[b]),T=w.useCallback(function(O){g.current=O.changedTouches[0].clientY},[]),C=w.useCallback(function(O){var j=g.current-O.changedTouches[0].clientY;b(O,j)},[b]),R=w.useCallback(function(O){if(O){var j=jKe?{passive:!1}:!1;O.addEventListener("wheel",E,j),O.addEventListener("touchstart",T,j),O.addEventListener("touchmove",C,j)}},[C,T,E]),N=w.useCallback(function(O){O&&(O.removeEventListener("wheel",E,!1),O.removeEventListener("touchstart",T,!1),O.removeEventListener("touchmove",C,!1))},[C,T,E]);return w.useEffect(function(){if(t){var O=v.current;return R(O),function(){N(O)}}},[t,R,N]),function(O){v.current=O}}var Zee=["boxSizing","height","overflow","paddingRight","position"],Qee={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function ete(e){e.cancelable&&e.preventDefault()}function tte(e){e.stopPropagation()}function nte(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;e===0?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function rte(){return"ontouchstart"in window||navigator.maxTouchPoints}var ite=!!(typeof window<"u"&&window.document&&window.document.createElement),_E=0,cv={capture:!1,passive:!1};function pYe(e){var t=e.isEnabled,n=e.accountForScrollbars,i=n===void 0?!0:n,o=w.useRef({}),u=w.useRef(null),h=w.useCallback(function(g){if(ite){var v=document.body,b=v&&v.style;if(i&&Zee.forEach(function(R){var N=b&&b[R];o.current[R]=N}),i&&_E<1){var E=parseInt(o.current.paddingRight,10)||0,T=document.body?document.body.clientWidth:0,C=window.innerWidth-T+E||0;Object.keys(Qee).forEach(function(R){var N=Qee[R];b&&(b[R]=N)}),b&&(b.paddingRight="".concat(C,"px"))}v&&rte()&&(v.addEventListener("touchmove",ete,cv),g&&(g.addEventListener("touchstart",nte,cv),g.addEventListener("touchmove",tte,cv))),_E+=1}},[i]),p=w.useCallback(function(g){if(ite){var v=document.body,b=v&&v.style;_E=Math.max(_E-1,0),i&&_E<1&&Zee.forEach(function(E){var T=o.current[E];b&&(b[E]=T)}),v&&rte()&&(v.removeEventListener("touchmove",ete,cv),g&&(g.removeEventListener("touchstart",nte,cv),g.removeEventListener("touchmove",tte,cv)))}},[i]);return w.useEffect(function(){if(t){var g=u.current;return h(g),function(){p(g)}}},[t,h,p]),function(g){u.current=g}}var mYe=function(t){var n=t.target;return n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()},gYe={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function vYe(e){var t=e.children,n=e.lockEnabled,i=e.captureEnabled,o=i===void 0?!0:i,u=e.onBottomArrive,h=e.onBottomLeave,p=e.onTopArrive,g=e.onTopLeave,v=fYe({isEnabled:o,onBottomArrive:u,onBottomLeave:h,onTopArrive:p,onTopLeave:g}),b=pYe({isEnabled:n}),E=function(C){v(C),b(C)};return nn(w.Fragment,null,n&&nn("div",{onClick:mYe,css:gYe}),t(E))}var yYe={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},_Ye=function(t){var n=t.name,i=t.onFocus;return nn("input",{required:!0,name:n,tabIndex:-1,"aria-hidden":"true",onFocus:i,css:yYe,value:"",onChange:function(){}})},bYe=_Ye;function $B(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function EYe(){return $B(/^iPhone/i)}function Ape(){return $B(/^Mac/i)}function wYe(){return $B(/^iPad/i)||Ape()&&navigator.maxTouchPoints>1}function SYe(){return EYe()||wYe()}function xYe(){return Ape()||SYe()}var TYe=function(t){return t.label},CYe=function(t){return t.label},RYe=function(t){return t.value},NYe=function(t){return!!t.isDisabled},AYe={clearIndicator:dqe,container:eqe,control:yqe,dropdownIndicator:lqe,group:wqe,groupHeading:xqe,indicatorsContainer:iqe,indicatorSeparator:fqe,input:Nqe,loadingIndicator:gqe,loadingMessage:YKe,menu:$Ke,menuList:zKe,menuPortal:ZKe,multiValue:kqe,multiValueLabel:jqe,multiValueRemove:Dqe,noOptionsMessage:qKe,option:Bqe,placeholder:Gqe,singleValue:Kqe,valueContainer:nqe},IYe={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},OYe=4,Ipe=4,PYe=38,kYe=Ipe*2,jYe={baseUnit:Ipe,controlHeight:PYe,menuGutter:kYe},TL={borderRadius:OYe,colors:IYe,spacing:jYe},DYe={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Kee(),captureMenuScroll:!Kee(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:lYe(),formatGroupLabel:TYe,getOptionLabel:CYe,getOptionValue:RYe,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:NYe,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!PKe(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var n=t.count;return"".concat(n," result").concat(n!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function ate(e,t,n,i){var o=kpe(e,t,n),u=jpe(e,t,n),h=Ppe(e,t),p=nA(e,t);return{type:"option",data:t,isDisabled:o,isSelected:u,label:h,value:p,index:i}}function ZR(e,t){return e.options.map(function(n,i){if("options"in n){var o=n.options.map(function(h,p){return ate(e,h,t,p)}).filter(function(h){return ote(e,h)});return o.length>0?{type:"group",data:n,options:o,index:i}:void 0}var u=ate(e,n,t,i);return ote(e,u)?u:void 0}).filter(DKe)}function Ope(e){return e.reduce(function(t,n){return n.type==="group"?t.push.apply(t,PB(n.options.map(function(i){return i.data}))):t.push(n.data),t},[])}function ste(e,t){return e.reduce(function(n,i){return i.type==="group"?n.push.apply(n,PB(i.options.map(function(o){return{data:o.data,id:"".concat(t,"-").concat(i.index,"-").concat(o.index)}}))):n.push({data:i.data,id:"".concat(t,"-").concat(i.index)}),n},[])}function LYe(e,t){return Ope(ZR(e,t))}function ote(e,t){var n=e.inputValue,i=n===void 0?"":n,o=t.data,u=t.isSelected,h=t.label,p=t.value;return(!Lpe(e)||!u)&&Dpe(e,{label:h,value:p,data:o},i)}function MYe(e,t){var n=e.focusedValue,i=e.selectValue,o=i.indexOf(n);if(o>-1){var u=t.indexOf(n);if(u>-1)return n;if(o<t.length)return t[o]}return null}function UYe(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}var CL=function(t,n){var i,o=(i=t.find(function(u){return u.data===n}))===null||i===void 0?void 0:i.id;return o||null},Ppe=function(t,n){return t.getOptionLabel(n)},nA=function(t,n){return t.getOptionValue(n)};function kpe(e,t,n){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,n):!1}function jpe(e,t,n){if(n.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,n);var i=nA(e,t);return n.some(function(o){return nA(e,o)===i})}function Dpe(e,t,n){return e.filterOption?e.filterOption(t,n):!0}var Lpe=function(t){var n=t.hideSelectedOptions,i=t.isMulti;return n===void 0?i:n},FYe=1,Mpe=function(e){m7e(n,e);var t=y7e(n);function n(i){var o;if(f7e(this,n),o=t.call(this,i),o.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},o.blockOptionHover=!1,o.isComposing=!1,o.commonProps=void 0,o.initialTouchX=0,o.initialTouchY=0,o.openAfterFocus=!1,o.scrollToFocusedOptionOnUpdate=!1,o.userIsDragging=void 0,o.controlRef=null,o.getControlRef=function(g){o.controlRef=g},o.focusedOptionRef=null,o.getFocusedOptionRef=function(g){o.focusedOptionRef=g},o.menuListRef=null,o.getMenuListRef=function(g){o.menuListRef=g},o.inputRef=null,o.getInputRef=function(g){o.inputRef=g},o.focus=o.focusInput,o.blur=o.blurInput,o.onChange=function(g,v){var b=o.props,E=b.onChange,T=b.name;v.name=T,o.ariaOnChange(g,v),E(g,v)},o.setValue=function(g,v,b){var E=o.props,T=E.closeMenuOnSelect,C=E.isMulti,R=E.inputValue;o.onInputChange("",{action:"set-value",prevInputValue:R}),T&&(o.setState({inputIsHiddenAfterUpdate:!C}),o.onMenuClose()),o.setState({clearFocusValueOnUpdate:!0}),o.onChange(g,{action:v,option:b})},o.selectOption=function(g){var v=o.props,b=v.blurInputOnSelect,E=v.isMulti,T=v.name,C=o.state.selectValue,R=E&&o.isOptionSelected(g,C),N=o.isOptionDisabled(g,C);if(R){var O=o.getOptionValue(g);o.setValue(C.filter(function(j){return o.getOptionValue(j)!==O}),"deselect-option",g)}else if(!N)E?o.setValue([].concat(PB(C),[g]),"select-option",g):o.setValue(g,"select-option");else{o.ariaOnChange(g,{action:"select-option",option:g,name:T});return}b&&o.blurInput()},o.removeValue=function(g){var v=o.props.isMulti,b=o.state.selectValue,E=o.getOptionValue(g),T=b.filter(function(R){return o.getOptionValue(R)!==E}),C=tR(v,T,T[0]||null);o.onChange(C,{action:"remove-value",removedValue:g}),o.focusInput()},o.clearValue=function(){var g=o.state.selectValue;o.onChange(tR(o.props.isMulti,[],null),{action:"clear",removedValues:g})},o.popValue=function(){var g=o.props.isMulti,v=o.state.selectValue,b=v[v.length-1],E=v.slice(0,v.length-1),T=tR(g,E,E[0]||null);b&&o.onChange(T,{action:"pop-value",removedValue:b})},o.getFocusedOptionId=function(g){return CL(o.state.focusableOptionsWithIds,g)},o.getFocusableOptionsWithIds=function(){return ste(ZR(o.props,o.state.selectValue),o.getElementId("option"))},o.getValue=function(){return o.state.selectValue},o.cx=function(){for(var g=arguments.length,v=new Array(g),b=0;b<g;b++)v[b]=arguments[b];return RKe.apply(void 0,[o.props.classNamePrefix].concat(v))},o.getOptionLabel=function(g){return Ppe(o.props,g)},o.getOptionValue=function(g){return nA(o.props,g)},o.getStyles=function(g,v){var b=o.props.unstyled,E=AYe[g](v,b);E.boxSizing="border-box";var T=o.props.styles[g];return T?T(E,v):E},o.getClassNames=function(g,v){var b,E;return(b=(E=o.props.classNames)[g])===null||b===void 0?void 0:b.call(E,v)},o.getElementId=function(g){return"".concat(o.state.instancePrefix,"-").concat(g)},o.getComponents=function(){return Jqe(o.props)},o.buildCategorizedOptions=function(){return ZR(o.props,o.state.selectValue)},o.getCategorizedOptions=function(){return o.props.menuIsOpen?o.buildCategorizedOptions():[]},o.buildFocusableOptions=function(){return Ope(o.buildCategorizedOptions())},o.getFocusableOptions=function(){return o.props.menuIsOpen?o.buildFocusableOptions():[]},o.ariaOnChange=function(g,v){o.setState({ariaSelection:hn({value:g},v)})},o.onMenuMouseDown=function(g){g.button===0&&(g.stopPropagation(),g.preventDefault(),o.focusInput())},o.onMenuMouseMove=function(g){o.blockOptionHover=!1},o.onControlMouseDown=function(g){if(!g.defaultPrevented){var v=o.props.openMenuOnClick;o.state.isFocused?o.props.menuIsOpen?g.target.tagName!=="INPUT"&&g.target.tagName!=="TEXTAREA"&&o.onMenuClose():v&&o.openMenu("first"):(v&&(o.openAfterFocus=!0),o.focusInput()),g.target.tagName!=="INPUT"&&g.target.tagName!=="TEXTAREA"&&g.preventDefault()}},o.onDropdownIndicatorMouseDown=function(g){if(!(g&&g.type==="mousedown"&&g.button!==0)&&!o.props.isDisabled){var v=o.props,b=v.isMulti,E=v.menuIsOpen;o.focusInput(),E?(o.setState({inputIsHiddenAfterUpdate:!b}),o.onMenuClose()):o.openMenu("first"),g.preventDefault()}},o.onClearIndicatorMouseDown=function(g){g&&g.type==="mousedown"&&g.button!==0||(o.clearValue(),g.preventDefault(),o.openAfterFocus=!1,g.type==="touchend"?o.focusInput():setTimeout(function(){return o.focusInput()}))},o.onScroll=function(g){typeof o.props.closeMenuOnScroll=="boolean"?g.target instanceof HTMLElement&&xI(g.target)&&o.props.onMenuClose():typeof o.props.closeMenuOnScroll=="function"&&o.props.closeMenuOnScroll(g)&&o.props.onMenuClose()},o.onCompositionStart=function(){o.isComposing=!0},o.onCompositionEnd=function(){o.isComposing=!1},o.onTouchStart=function(g){var v=g.touches,b=v&&v.item(0);b&&(o.initialTouchX=b.clientX,o.initialTouchY=b.clientY,o.userIsDragging=!1)},o.onTouchMove=function(g){var v=g.touches,b=v&&v.item(0);if(b){var E=Math.abs(b.clientX-o.initialTouchX),T=Math.abs(b.clientY-o.initialTouchY),C=5;o.userIsDragging=E>C||T>C}},o.onTouchEnd=function(g){o.userIsDragging||(o.controlRef&&!o.controlRef.contains(g.target)&&o.menuListRef&&!o.menuListRef.contains(g.target)&&o.blurInput(),o.initialTouchX=0,o.initialTouchY=0)},o.onControlTouchEnd=function(g){o.userIsDragging||o.onControlMouseDown(g)},o.onClearIndicatorTouchEnd=function(g){o.userIsDragging||o.onClearIndicatorMouseDown(g)},o.onDropdownIndicatorTouchEnd=function(g){o.userIsDragging||o.onDropdownIndicatorMouseDown(g)},o.handleInputChange=function(g){var v=o.props.inputValue,b=g.currentTarget.value;o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange(b,{action:"input-change",prevInputValue:v}),o.props.menuIsOpen||o.onMenuOpen()},o.onInputFocus=function(g){o.props.onFocus&&o.props.onFocus(g),o.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(o.openAfterFocus||o.props.openMenuOnFocus)&&o.openMenu("first"),o.openAfterFocus=!1},o.onInputBlur=function(g){var v=o.props.inputValue;if(o.menuListRef&&o.menuListRef.contains(document.activeElement)){o.inputRef.focus();return}o.props.onBlur&&o.props.onBlur(g),o.onInputChange("",{action:"input-blur",prevInputValue:v}),o.onMenuClose(),o.setState({focusedValue:null,isFocused:!1})},o.onOptionHover=function(g){if(!(o.blockOptionHover||o.state.focusedOption===g)){var v=o.getFocusableOptions(),b=v.indexOf(g);o.setState({focusedOption:g,focusedOptionId:b>-1?o.getFocusedOptionId(g):null})}},o.shouldHideSelectedOptions=function(){return Lpe(o.props)},o.onValueInputFocus=function(g){g.preventDefault(),g.stopPropagation(),o.focus()},o.onKeyDown=function(g){var v=o.props,b=v.isMulti,E=v.backspaceRemovesValue,T=v.escapeClearsValue,C=v.inputValue,R=v.isClearable,N=v.isDisabled,O=v.menuIsOpen,j=v.onKeyDown,k=v.tabSelectsValue,P=v.openMenuOnFocus,M=o.state,D=M.focusedOption,U=M.focusedValue,F=M.selectValue;if(!N&&!(typeof j=="function"&&(j(g),g.defaultPrevented))){switch(o.blockOptionHover=!0,g.key){case"ArrowLeft":if(!b||C)return;o.focusValue("previous");break;case"ArrowRight":if(!b||C)return;o.focusValue("next");break;case"Delete":case"Backspace":if(C)return;if(U)o.removeValue(U);else{if(!E)return;b?o.popValue():R&&o.clearValue()}break;case"Tab":if(o.isComposing||g.shiftKey||!O||!k||!D||P&&o.isOptionSelected(D,F))return;o.selectOption(D);break;case"Enter":if(g.keyCode===229)break;if(O){if(!D||o.isComposing)return;o.selectOption(D);break}return;case"Escape":O?(o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange("",{action:"menu-close",prevInputValue:C}),o.onMenuClose()):R&&T&&o.clearValue();break;case" ":if(C)return;if(!O){o.openMenu("first");break}if(!D)return;o.selectOption(D);break;case"ArrowUp":O?o.focusOption("up"):o.openMenu("last");break;case"ArrowDown":O?o.focusOption("down"):o.openMenu("first");break;case"PageUp":if(!O)return;o.focusOption("pageup");break;case"PageDown":if(!O)return;o.focusOption("pagedown");break;case"Home":if(!O)return;o.focusOption("first");break;case"End":if(!O)return;o.focusOption("last");break;default:return}g.preventDefault()}},o.state.instancePrefix="react-select-"+(o.props.instanceId||++FYe),o.state.selectValue=Hee(i.value),i.menuIsOpen&&o.state.selectValue.length){var u=o.getFocusableOptionsWithIds(),h=o.buildFocusableOptions(),p=h.indexOf(o.state.selectValue[0]);o.state.focusableOptionsWithIds=u,o.state.focusedOption=h[p],o.state.focusedOptionId=CL(u,h[p])}return o}return p7e(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&zee(this.menuListRef,this.focusedOptionRef),xYe()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(o){var u=this.props,h=u.isDisabled,p=u.menuIsOpen,g=this.state.isFocused;(g&&!h&&o.isDisabled||g&&p&&!o.menuIsOpen)&&this.focusInput(),g&&h&&!o.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!g&&!h&&o.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(zee(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(o,u){this.props.onInputChange(o,u)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(o){var u=this,h=this.state,p=h.selectValue,g=h.isFocused,v=this.buildFocusableOptions(),b=o==="first"?0:v.length-1;if(!this.props.isMulti){var E=v.indexOf(p[0]);E>-1&&(b=E)}this.scrollToFocusedOptionOnUpdate=!(g&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:v[b],focusedOptionId:this.getFocusedOptionId(v[b])},function(){return u.onMenuOpen()})}},{key:"focusValue",value:function(o){var u=this.state,h=u.selectValue,p=u.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var g=h.indexOf(p);p||(g=-1);var v=h.length-1,b=-1;if(h.length){switch(o){case"previous":g===0?b=0:g===-1?b=v:b=g-1;break;case"next":g>-1&&g<v&&(b=g+1);break}this.setState({inputIsHidden:b!==-1,focusedValue:h[b]})}}}},{key:"focusOption",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",u=this.props.pageSize,h=this.state.focusedOption,p=this.getFocusableOptions();if(p.length){var g=0,v=p.indexOf(h);h||(v=-1),o==="up"?g=v>0?v-1:p.length-1:o==="down"?g=(v+1)%p.length:o==="pageup"?(g=v-u,g<0&&(g=0)):o==="pagedown"?(g=v+u,g>p.length-1&&(g=p.length-1)):o==="last"&&(g=p.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:p[g],focusedValue:null,focusedOptionId:this.getFocusedOptionId(p[g])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(TL):hn(hn({},TL),this.props.theme):TL}},{key:"getCommonProps",value:function(){var o=this.clearValue,u=this.cx,h=this.getStyles,p=this.getClassNames,g=this.getValue,v=this.selectOption,b=this.setValue,E=this.props,T=E.isMulti,C=E.isRtl,R=E.options,N=this.hasValue();return{clearValue:o,cx:u,getStyles:h,getClassNames:p,getValue:g,hasValue:N,isMulti:T,isRtl:C,options:R,selectOption:v,selectProps:E,setValue:b,theme:this.getTheme()}}},{key:"hasValue",value:function(){var o=this.state.selectValue;return o.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var o=this.props,u=o.isClearable,h=o.isMulti;return u===void 0?h:u}},{key:"isOptionDisabled",value:function(o,u){return kpe(this.props,o,u)}},{key:"isOptionSelected",value:function(o,u){return jpe(this.props,o,u)}},{key:"filterOption",value:function(o,u){return Dpe(this.props,o,u)}},{key:"formatOptionLabel",value:function(o,u){if(typeof this.props.formatOptionLabel=="function"){var h=this.props.inputValue,p=this.state.selectValue;return this.props.formatOptionLabel(o,{context:u,inputValue:h,selectValue:p})}else return this.getOptionLabel(o)}},{key:"formatGroupLabel",value:function(o){return this.props.formatGroupLabel(o)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var o=this.props,u=o.isDisabled,h=o.isSearchable,p=o.inputId,g=o.inputValue,v=o.tabIndex,b=o.form,E=o.menuIsOpen,T=o.required,C=this.getComponents(),R=C.Input,N=this.state,O=N.inputIsHidden,j=N.ariaSelection,k=this.commonProps,P=p||this.getElementId("input"),M=hn(hn(hn({"aria-autocomplete":"list","aria-expanded":E,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":T,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},E&&{"aria-controls":this.getElementId("listbox")}),!h&&{"aria-readonly":!0}),this.hasValue()?(j==null?void 0:j.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return h?w.createElement(R,mn({},k,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:P,innerRef:this.getInputRef,isDisabled:u,isHidden:O,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:v,form:b,type:"text",value:g},M)):w.createElement(dYe,mn({id:P,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:eA,onFocus:this.onInputFocus,disabled:u,tabIndex:v,inputMode:"none",form:b,value:""},M))}},{key:"renderPlaceholderOrValue",value:function(){var o=this,u=this.getComponents(),h=u.MultiValue,p=u.MultiValueContainer,g=u.MultiValueLabel,v=u.MultiValueRemove,b=u.SingleValue,E=u.Placeholder,T=this.commonProps,C=this.props,R=C.controlShouldRenderValue,N=C.isDisabled,O=C.isMulti,j=C.inputValue,k=C.placeholder,P=this.state,M=P.selectValue,D=P.focusedValue,U=P.isFocused;if(!this.hasValue()||!R)return j?null:w.createElement(E,mn({},T,{key:"placeholder",isDisabled:N,isFocused:U,innerProps:{id:this.getElementId("placeholder")}}),k);if(O)return M.map(function(H,W){var q=H===D,Y="".concat(o.getOptionLabel(H),"-").concat(o.getOptionValue(H));return w.createElement(h,mn({},T,{components:{Container:p,Label:g,Remove:v},isFocused:q,isDisabled:N,key:Y,index:W,removeProps:{onClick:function(){return o.removeValue(H)},onTouchEnd:function(){return o.removeValue(H)},onMouseDown:function(Z){Z.preventDefault()}},data:H}),o.formatOptionLabel(H,"value"))});if(j)return null;var F=M[0];return w.createElement(b,mn({},T,{data:F,isDisabled:N}),this.formatOptionLabel(F,"value"))}},{key:"renderClearIndicator",value:function(){var o=this.getComponents(),u=o.ClearIndicator,h=this.commonProps,p=this.props,g=p.isDisabled,v=p.isLoading,b=this.state.isFocused;if(!this.isClearable()||!u||g||!this.hasValue()||v)return null;var E={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(u,mn({},h,{innerProps:E,isFocused:b}))}},{key:"renderLoadingIndicator",value:function(){var o=this.getComponents(),u=o.LoadingIndicator,h=this.commonProps,p=this.props,g=p.isDisabled,v=p.isLoading,b=this.state.isFocused;if(!u||!v)return null;var E={"aria-hidden":"true"};return w.createElement(u,mn({},h,{innerProps:E,isDisabled:g,isFocused:b}))}},{key:"renderIndicatorSeparator",value:function(){var o=this.getComponents(),u=o.DropdownIndicator,h=o.IndicatorSeparator;if(!u||!h)return null;var p=this.commonProps,g=this.props.isDisabled,v=this.state.isFocused;return w.createElement(h,mn({},p,{isDisabled:g,isFocused:v}))}},{key:"renderDropdownIndicator",value:function(){var o=this.getComponents(),u=o.DropdownIndicator;if(!u)return null;var h=this.commonProps,p=this.props.isDisabled,g=this.state.isFocused,v={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(u,mn({},h,{innerProps:v,isDisabled:p,isFocused:g}))}},{key:"renderMenu",value:function(){var o=this,u=this.getComponents(),h=u.Group,p=u.GroupHeading,g=u.Menu,v=u.MenuList,b=u.MenuPortal,E=u.LoadingMessage,T=u.NoOptionsMessage,C=u.Option,R=this.commonProps,N=this.state.focusedOption,O=this.props,j=O.captureMenuScroll,k=O.inputValue,P=O.isLoading,M=O.loadingMessage,D=O.minMenuHeight,U=O.maxMenuHeight,F=O.menuIsOpen,H=O.menuPlacement,W=O.menuPosition,q=O.menuPortalTarget,Y=O.menuShouldBlockScroll,z=O.menuShouldScrollIntoView,Z=O.noOptionsMessage,X=O.onMenuScrollToTop,ae=O.onMenuScrollToBottom;if(!F)return null;var se=function(Te,Pe){var qe=Te.type,st=Te.data,ze=Te.isDisabled,ft=Te.isSelected,$e=Te.label,at=Te.value,ke=N===st,je=ze?void 0:function(){return o.onOptionHover(st)},Pt=ze?void 0:function(){return o.selectOption(st)},Dt="".concat(o.getElementId("option"),"-").concat(Pe),cn={id:Dt,onClick:Pt,onMouseMove:je,onMouseOver:je,tabIndex:-1,role:"option","aria-selected":o.state.isAppleDevice?void 0:ft};return w.createElement(C,mn({},R,{innerProps:cn,data:st,isDisabled:ze,isSelected:ft,key:Dt,label:$e,type:qe,value:at,isFocused:ke,innerRef:ke?o.getFocusedOptionRef:void 0}),o.formatOptionLabel(Te.data,"menu"))},J;if(this.hasOptions())J=this.getCategorizedOptions().map(function(ve){if(ve.type==="group"){var Te=ve.data,Pe=ve.options,qe=ve.index,st="".concat(o.getElementId("group"),"-").concat(qe),ze="".concat(st,"-heading");return w.createElement(h,mn({},R,{key:st,data:Te,options:Pe,Heading:p,headingProps:{id:ze,data:ve.data},label:o.formatGroupLabel(ve.data)}),ve.options.map(function(ft){return se(ft,"".concat(qe,"-").concat(ft.index))}))}else if(ve.type==="option")return se(ve,"".concat(ve.index))});else if(P){var re=M({inputValue:k});if(re===null)return null;J=w.createElement(E,R,re)}else{var ee=Z({inputValue:k});if(ee===null)return null;J=w.createElement(T,R,ee)}var de={minMenuHeight:D,maxMenuHeight:U,menuPlacement:H,menuPosition:W,menuShouldScrollIntoView:z},xe=w.createElement(WKe,mn({},R,de),function(ve){var Te=ve.ref,Pe=ve.placerProps,qe=Pe.placement,st=Pe.maxHeight;return w.createElement(g,mn({},R,de,{innerRef:Te,innerProps:{onMouseDown:o.onMenuMouseDown,onMouseMove:o.onMenuMouseMove},isLoading:P,placement:qe}),w.createElement(vYe,{captureEnabled:j,onTopArrive:X,onBottomArrive:ae,lockEnabled:Y},function(ze){return w.createElement(v,mn({},R,{innerRef:function($e){o.getMenuListRef($e),ze($e)},innerProps:{role:"listbox","aria-multiselectable":R.isMulti,id:o.getElementId("listbox")},isLoading:P,maxHeight:st,focusedOption:N}),J)}))});return q||W==="fixed"?w.createElement(b,mn({},R,{appendTo:q,controlElement:this.controlRef,menuPlacement:H,menuPosition:W}),xe):xe}},{key:"renderFormField",value:function(){var o=this,u=this.props,h=u.delimiter,p=u.isDisabled,g=u.isMulti,v=u.name,b=u.required,E=this.state.selectValue;if(b&&!this.hasValue()&&!p)return w.createElement(bYe,{name:v,onFocus:this.onValueInputFocus});if(!(!v||p))if(g)if(h){var T=E.map(function(N){return o.getOptionValue(N)}).join(h);return w.createElement("input",{name:v,type:"hidden",value:T})}else{var C=E.length>0?E.map(function(N,O){return w.createElement("input",{key:"i-".concat(O),name:v,type:"hidden",value:o.getOptionValue(N)})}):w.createElement("input",{name:v,type:"hidden",value:""});return w.createElement("div",null,C)}else{var R=E[0]?this.getOptionValue(E[0]):"";return w.createElement("input",{name:v,type:"hidden",value:R})}}},{key:"renderLiveRegion",value:function(){var o=this.commonProps,u=this.state,h=u.ariaSelection,p=u.focusedOption,g=u.focusedValue,v=u.isFocused,b=u.selectValue,E=this.getFocusableOptions();return w.createElement(aYe,mn({},o,{id:this.getElementId("live-region"),ariaSelection:h,focusedOption:p,focusedValue:g,isFocused:v,selectValue:b,focusableOptions:E,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var o=this.getComponents(),u=o.Control,h=o.IndicatorsContainer,p=o.SelectContainer,g=o.ValueContainer,v=this.props,b=v.className,E=v.id,T=v.isDisabled,C=v.menuIsOpen,R=this.state.isFocused,N=this.commonProps=this.getCommonProps();return w.createElement(p,mn({},N,{className:b,innerProps:{id:E,onKeyDown:this.onKeyDown},isDisabled:T,isFocused:R}),this.renderLiveRegion(),w.createElement(u,mn({},N,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:T,isFocused:R,menuIsOpen:C}),w.createElement(g,mn({},N,{isDisabled:T}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(h,mn({},N,{isDisabled:T}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(o,u){var h=u.prevProps,p=u.clearFocusValueOnUpdate,g=u.inputIsHiddenAfterUpdate,v=u.ariaSelection,b=u.isFocused,E=u.prevWasFocused,T=u.instancePrefix,C=o.options,R=o.value,N=o.menuIsOpen,O=o.inputValue,j=o.isMulti,k=Hee(R),P={};if(h&&(R!==h.value||C!==h.options||N!==h.menuIsOpen||O!==h.inputValue)){var M=N?LYe(o,k):[],D=N?ste(ZR(o,k),"".concat(T,"-option")):[],U=p?MYe(u,k):null,F=UYe(u,M),H=CL(D,F);P={selectValue:k,focusedOption:F,focusedOptionId:H,focusableOptionsWithIds:D,focusedValue:U,clearFocusValueOnUpdate:!1}}var W=g!=null&&o!==h?{inputIsHidden:g,inputIsHiddenAfterUpdate:void 0}:{},q=v,Y=b&&E;return b&&!Y&&(q={value:tR(j,k,k[0]||null),options:k,action:"initial-input-focus"},Y=!E),(v==null?void 0:v.action)==="initial-input-focus"&&(q=null),hn(hn(hn({},P),W),{},{prevProps:o,ariaSelection:q,prevWasFocused:Y})}}]),n}(w.Component);Mpe.defaultProps=DYe;var VYe=w.forwardRef(function(e,t){var n=h7e(e);return w.createElement(Mpe,mn({ref:t},n))}),cte=VYe;const BYe="https://api.gada.chat";function $Ye(){const{accessToken:e,isLoading:t}=ct(),n=St(e),i=Bl(e),[o,u]=w.useState([]),[h,p]=w.useState(!0),[g,v]=w.useState({campaign_title:"",campaign_start_date:"",campaign_end_date:"",campaign_budget:"",campaign_bidding:"click",audience_countries:[],audience_gender:"all",audience_relationship:"all",ads_title:"",ads_description:"",ads_type:"url",ads_url:"",ads_placement:"newsfeed",ads_image:""}),[b,E]=w.useState(!1),[T,C]=w.useState(!1),[R,N]=w.useState([]),[O,j]=w.useState(1),[k,P]=w.useState(0),M=w.useMemo(()=>Math.max(1,Math.ceil(k/10)),[k]),[D,U]=w.useState(null),[F,H]=w.useState(null),[W,q]=w.useState(!1);w.useEffect(()=>{if(!D)return H(null);const J=(D.audience_countries||"").split(",").map(re=>Number(re.trim())).filter(Boolean).map(re=>o.find(de=>de.value===re)||{value:re,label:String(re)});H({campaign_title:D.campaign_title||"",campaign_start_date:D.campaign_start_date?new Date(D.campaign_start_date).toISOString().slice(0,16):"",campaign_end_date:D.campaign_end_date?new Date(D.campaign_end_date).toISOString().slice(0,16):"",campaign_budget:D.campaign_budget??"",campaign_bidding:D.campaign_bidding||"click",audience_countries:J,audience_gender:D.audience_gender||"all",audience_relationship:D.audience_relationship||"all",ads_title:D.ads_title||"",ads_description:D.ads_description||"",ads_type:D.ads_type||"url",ads_url:D.ads_url||"",ads_placement:D.ads_placement||"newsfeed",ads_image:D.ads_image||""})},[D,o]),w.useEffect(()=>{(async()=>{try{p(!0);const J=await y8e(n);if(!(J!=null&&J.ok))throw new Error((J==null?void 0:J.error)||"Failed to load countries");u(J.items||[])}catch(J){Ce.error((J==null?void 0:J.message)||"Failed to load countries")}finally{p(!1)}})()},[e]);const Y=async J=>{var ee;const re=(ee=J.target.files)==null?void 0:ee[0];if(re){E(!0);try{const de=await h8e(re,i);de!=null&&de.ok?(v(xe=>({...xe,ads_image:de.path})),Ce.success("Image uploaded successfully")):Ce.error((de==null?void 0:de.error)||"Upload failed")}catch(de){Ce.error((de==null?void 0:de.message)||"Upload failed")}finally{E(!1)}}},z=J=>{var ee,de;if(!((ee=J.campaign_title)!=null&&ee.trim()))return"Campaign title is required";if(!J.campaign_start_date||!J.campaign_end_date)return"Start and End dates are required";const re=Number(J.campaign_budget);return!re||isNaN(re)||re<=0?"Budget must be a positive number":J.ads_type==="url"&&!((de=J.ads_url)!=null&&de.trim())?"Target URL is required for URL ads":null},Z=async J=>{J.preventDefault();const re=z(g);if(re)return Ce.error(re);C(!0);try{const ee={...g,campaign_budget:Number(g.campaign_budget),campaign_start_date:new Date(g.campaign_start_date).toISOString(),campaign_end_date:new Date(g.campaign_end_date).toISOString(),audience_countries:g.audience_countries.map(xe=>xe.value).join(",")},de=await f8e(ee,n);if(!(de!=null&&de.ok))throw new Error((de==null?void 0:de.error)||"Failed to create campaign");Ce.success("Campaign created successfully!"),v(xe=>({...xe,campaign_title:"",campaign_start_date:"",campaign_end_date:"",campaign_budget:"",audience_countries:[],ads_title:"",ads_description:"",ads_url:"",ads_image:""})),se(1)}catch(ee){Ce.error((ee==null?void 0:ee.message)||"Failed to create campaign")}finally{C(!1)}},X=async()=>{if(!D||!F)return;const J=z(F);if(J)return Ce.error(J);q(!0);try{const re={...F,campaign_budget:Number(F.campaign_budget),campaign_start_date:new Date(F.campaign_start_date).toISOString(),campaign_end_date:new Date(F.campaign_end_date).toISOString(),audience_countries:F.audience_countries.map(de=>de.value).join(",")},ee=await _8e(D.campaign_id,re,n);if(!(ee!=null&&ee.ok))throw new Error((ee==null?void 0:ee.error)||"Failed to update campaign");Ce.success("Campaign updated"),U(null),se()}catch(re){Ce.error((re==null?void 0:re.message)||"Failed to update campaign")}finally{q(!1)}},ae=async J=>{const re=J.campaign_id;if(window.confirm(`Delete campaign "${J.campaign_title}"?`))try{const de=await b8e(re,n);if(!(de!=null&&de.ok))throw new Error((de==null?void 0:de.error)||"Failed to delete");Ce.success("Campaign deleted"),se()}catch(de){Ce.error((de==null?void 0:de.message)||"Failed to delete")}};async function se(J=O){try{const re=await p8e(J,10,n);if(!(re!=null&&re.ok))throw new Error((re==null?void 0:re.error)||"Failed to load campaigns");N(re.items||[]),P(re.total||0),j(re.page||1)}catch(re){Ce.error((re==null?void 0:re.message)||"Failed to load campaigns")}}return w.useEffect(()=>{!e||t||se(1)},[t,e]),c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5 min-h-0 overflow-y-auto",children:c.jsx(Ss,{})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsxs("header",{className:"rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-6 sm:p-8",children:[c.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Ads Manager"}),c.jsx("p",{className:"opacity-90",children:"Manage Ads, Create new Campaign"})]}),c.jsxs("section",{className:"rounded-2xl border bg-white shadow p-4 sm:p-6",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"New Campaign"}),c.jsxs("form",{onSubmit:Z,className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[c.jsxs("div",{className:"md:col-span-6 grid gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Campaign Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:g.campaign_title,onChange:J=>v({...g,campaign_title:J.target.value}),placeholder:"Set a title for your campaign"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Start"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:g.campaign_start_date,onChange:J=>v({...g,campaign_start_date:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"End"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:g.campaign_end_date,onChange:J=>v({...g,campaign_end_date:J.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Budget (₦)"}),c.jsx("input",{type:"number",min:0,className:"w-full border rounded-lg p-2",value:g.campaign_budget,onChange:J=>v({...g,campaign_budget:J.target.value}),placeholder:"E.g., 10000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Bidding"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.campaign_bidding,onChange:J=>v({...g,campaign_bidding:J.target.value}),children:[c.jsx("option",{value:"click",children:"Pay Per Click (₦50)"}),c.jsx("option",{value:"view",children:"Pay Per View (₦10)"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-sm mb-1",children:"Target Audience"}),c.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Countries"}),c.jsx(cte,{isMulti:!0,options:o,isLoading:h,value:g.audience_countries,onChange:J=>v({...g,audience_countries:J||[]}),classNamePrefix:"select",placeholder:"Select countries..."}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Gender"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.audience_gender,onChange:J=>v({...g,audience_gender:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Relationship"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.audience_relationship,onChange:J=>v({...g,audience_relationship:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"single",children:"Single"}),c.jsx("option",{value:"married",children:"Married"})]})]})]})]})]}),c.jsxs("div",{className:"md:col-span-6 grid gap-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:g.ads_title,onChange:J=>v({...g,ads_title:J.target.value}),placeholder:"Set a title for your ads"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Placement"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.ads_placement,onChange:J=>v({...g,ads_placement:J.target.value}),children:[c.jsx("option",{value:"newsfeed",children:"Newsfeed"}),c.jsx("option",{value:"sidebar",children:"Sidebar"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Description (max 200)"}),c.jsx("textarea",{maxLength:200,rows:5,className:"w-full border rounded-lg p-2",value:g.ads_description,onChange:J=>v({...g,ads_description:J.target.value}),placeholder:"Set a description for your ads"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Advertise For"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:g.ads_type,onChange:J=>v({...g,ads_type:J.target.value}),children:[c.jsx("option",{value:"url",children:"URL"}),c.jsx("option",{value:"post",children:"Post"}),c.jsx("option",{value:"page",children:"Page"}),c.jsx("option",{value:"group",children:"Group"}),c.jsx("option",{value:"event",children:"Event"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Target URL"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:g.ads_url,onChange:J=>v({...g,ads_url:J.target.value}),placeholder:"https://example.com"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Image"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"file",accept:"image/*",onChange:Y}),b&&c.jsx("span",{className:"text-sm",children:"Uploading…"})]}),g.ads_image&&c.jsx("img",{src:BYe+"/uploads/"+Xn(g.ads_image),className:"h-24 mt-2 rounded-lg"})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{disabled:T,className:"w-full sm:w-auto px-5 py-2 rounded-xl bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",children:T?"Publishing…":"Publish"})})]})]})]}),c.jsxs("section",{className:"rounded-2xl border bg-white shadow p-4 sm:p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsx("h2",{className:"text-xl font-semibold",children:"My Campaigns"})}),c.jsxs("div",{className:"grid md:hidden gap-3",children:[R.map(J=>c.jsxs("div",{className:"rounded-xl border p-4",children:[c.jsx("div",{className:"font-semibold",children:J.campaign_title}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[new Date(J.campaign_start_date).toLocaleDateString()," –"," ",new Date(J.campaign_end_date).toLocaleDateString()]}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[c.jsxs("div",{children:["Budget: ₦",J.campaign_budget.toFixed(2)]}),c.jsxs("div",{children:["Spend: ₦",J.campaign_spend.toFixed(2)]}),c.jsxs("div",{children:["Bidding: ",J.campaign_bidding==="click"?"Click":"View"]}),c.jsxs("div",{children:["Clicks/Views: ",J.campaign_clicks," / ",J.campaign_views]})]}),c.jsx("div",{className:"mt-2",children:J.campaign_is_active==="1"?c.jsx("span",{className:"rounded-full bg-green-100 text-green-700 px-2 py-0.5 text-xs",children:"Active"}):c.jsx("span",{className:"rounded-full bg-gray-100 text-gray-700 px-2 py-0.5 text-xs",children:"Not Active"})}),c.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[J.campaign_is_active==="1"?c.jsx("button",{onClick:async()=>{const re=await GC(J.campaign_id,!1,n);re!=null&&re.ok?(Ce.success("Campaign paused"),se()):Ce.error((re==null?void 0:re.error)||"Failed to pause")},className:"text-xs rounded-md border px-3 py-1",children:"Pause"}):c.jsx("button",{onClick:async()=>{const re=await GC(J.campaign_id,!0,n);re!=null&&re.ok?(Ce.success("Campaign resumed"),se()):Ce.error((re==null?void 0:re.error)||"Failed to resume")},className:"text-xs rounded-md border px-3 py-1",children:"Resume"}),c.jsx("button",{onClick:()=>U(J),className:"text-xs rounded-md border px-3 py-1",children:"Edit"}),c.jsx("button",{onClick:()=>ae(J),className:"text-xs rounded-md border px-3 py-1 text-red-600 border-red-300",children:"Delete"})]})]},J.campaign_id)),!R.length&&c.jsx("div",{className:"text-center text-gray-500 py-6",children:"No campaigns yet."})]}),c.jsx("div",{className:"hidden md:block overflow-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"[&>th]:text-left [&>th]:py-2",children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Start - End"}),c.jsx("th",{children:"Budget"}),c.jsx("th",{children:"Spend"}),c.jsx("th",{children:"Bidding"}),c.jsx("th",{children:"Clicks/Views"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Created"}),c.jsx("th",{children:"Actions"})]})}),c.jsxs("tbody",{children:[R.map(J=>c.jsxs("tr",{className:"[&>td]:py-2 border-t",children:[c.jsx("td",{children:J.campaign_title}),c.jsxs("td",{children:[new Date(J.campaign_start_date).toLocaleDateString()," -"," ",new Date(J.campaign_end_date).toLocaleDateString()]}),c.jsxs("td",{children:["₦",J.campaign_budget.toFixed(2)]}),c.jsxs("td",{children:["₦",J.campaign_spend.toFixed(2)]}),c.jsx("td",{children:J.campaign_bidding==="click"?"🖱 Click":"👁 View"}),c.jsxs("td",{children:[J.campaign_clicks," / ",J.campaign_views]}),c.jsx("td",{children:J.campaign_is_active==="1"?c.jsx("span",{className:"rounded-full bg-green-100 text-green-700 px-2 py-0.5",children:"Active"}):c.jsx("span",{className:"rounded-full bg-gray-100 text-gray-700 px-2 py-0.5",children:"Not Active"})}),c.jsx("td",{children:new Date(J.campaign_created_date).toLocaleDateString()}),c.jsxs("td",{className:"space-x-2",children:[J.campaign_is_active==="1"?c.jsx("button",{onClick:async()=>{const re=await GC(J.campaign_id,!1,n);re!=null&&re.ok?(Ce.success("Campaign paused"),se()):Ce.error((re==null?void 0:re.error)||"Failed to pause")},className:"text-xs rounded-md border px-2 py-1",children:"Pause"}):c.jsx("button",{onClick:async()=>{const re=await GC(J.campaign_id,!0,n);re!=null&&re.ok?(Ce.success("Campaign resumed"),se()):Ce.error((re==null?void 0:re.error)||"Failed to resume")},className:"text-xs rounded-md border px-2 py-1",children:"Resume"}),c.jsx("button",{onClick:()=>U(J),className:"text-xs rounded-md border px-2 py-1",children:"Edit"}),c.jsx("button",{onClick:()=>ae(J),className:"text-xs rounded-md border px-2 py-1 text-red-600 border-red-300",children:"Delete"})]})]},J.campaign_id)),!R.length&&c.jsx("tr",{children:c.jsx("td",{colSpan:9,className:"py-8 text-center text-gray-500",children:"No campaigns yet."})})]})]})}),c.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[c.jsx("button",{disabled:O<=1,onClick:()=>se(O-1),className:"text-sm border px-3 py-1 rounded-md disabled:opacity-50",children:"Previous"}),c.jsxs("div",{className:"text-sm",children:["Page ",O," / ",M]}),c.jsx("button",{disabled:O>=M,onClick:()=>se(O+1),className:"text-sm border px-3 py-1 rounded-md disabled:opacity-50",children:"Next"})]})]})]})]})}),D&&F&&c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>U(null)}),c.jsxs("div",{className:"relative bg-white w-[95%] max-w-3xl rounded-2xl shadow-xl p-4 sm:p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Edit Campaign"}),c.jsx("button",{onClick:()=>U(null),className:"text-sm",children:"✕"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Campaign Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:F.campaign_title,onChange:J=>H({...F,campaign_title:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Budget (₦)"}),c.jsx("input",{type:"number",min:0,className:"w-full border rounded-lg p-2",value:F.campaign_budget,onChange:J=>H({...F,campaign_budget:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Start"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:F.campaign_start_date,onChange:J=>H({...F,campaign_start_date:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"End"}),c.jsx("input",{type:"datetime-local",className:"w-full border rounded-lg p-2",value:F.campaign_end_date,onChange:J=>H({...F,campaign_end_date:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Bidding"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:F.campaign_bidding,onChange:J=>H({...F,campaign_bidding:J.target.value}),children:[c.jsx("option",{value:"click",children:"Pay Per Click (₦50)"}),c.jsx("option",{value:"view",children:"Pay Per View (₦10)"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Placement"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:F.ads_placement,onChange:J=>H({...F,ads_placement:J.target.value}),children:[c.jsx("option",{value:"newsfeed",children:"Newsfeed"}),c.jsx("option",{value:"sidebar",children:"Sidebar"})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Title"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:F.ads_title,onChange:J=>H({...F,ads_title:J.target.value})})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium",children:"Ads Description (max 200)"}),c.jsx("textarea",{maxLength:200,rows:4,className:"w-full border rounded-lg p-2",value:F.ads_description,onChange:J=>H({...F,ads_description:J.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Advertise For"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:F.ads_type,onChange:J=>H({...F,ads_type:J.target.value}),children:[c.jsx("option",{value:"url",children:"URL"}),c.jsx("option",{value:"post",children:"Post"}),c.jsx("option",{value:"page",children:"Page"}),c.jsx("option",{value:"group",children:"Group"}),c.jsx("option",{value:"event",children:"Event"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium",children:"Target URL"}),c.jsx("input",{className:"w-full border rounded-lg p-2",value:F.ads_url,onChange:J=>H({...F,ads_url:J.target.value})})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium",children:"Countries"}),c.jsx(cte,{isMulti:!0,options:o,value:F.audience_countries,onChange:J=>H({...F,audience_countries:J||[]}),classNamePrefix:"select",placeholder:"Select countries..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Gender"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:F.audience_gender,onChange:J=>H({...F,audience_gender:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500",children:"Relationship"}),c.jsxs("select",{className:"w-full border rounded-lg p-2",value:F.audience_relationship,onChange:J=>H({...F,audience_relationship:J.target.value}),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"single",children:"Single"}),c.jsx("option",{value:"married",children:"Married"})]})]})]}),c.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>U(null),className:"px-4 py-2 border rounded-lg",children:"Cancel"}),c.jsx("button",{onClick:X,disabled:W,className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",children:W?"Saving…":"Save changes"})]})]})]})]})}function WYe({children:e}){const{accessToken:t,isLoading:n}=ct(),i=Bc();return n?null:t?e:c.jsx(Fce,{to:"/login",replace:!0,state:{from:i}})}function GYe(e,t){return Array.isArray(e)?e:typeof e=="string"&&e?[e]:Array.isArray(t)?t:typeof t=="string"&&t?[t]:[]}function HYe(e,t){return GYe(e==null?void 0:e.roles,e==null?void 0:e.role).some(i=>t.includes(i))}function zYe({roles:e,children:t}){const{user:n,isLoading:i}=ct(),o=Bc();return i?null:(console.log(n,"useruseruser"),n&&HYe(n,e)?t:c.jsx(Fce,{to:"/",replace:!0,state:{from:o}}))}const lte=[{to:"/admin/",label:"Dashboard",icon:YVe},{to:"/admin/users",label:"Users",icon:ly},{to:"/admin/posts",label:"Posts",icon:i4e},{to:"/admin/representatives",label:"Representatives",icon:JVe},{to:"/admin/banktransfers",label:"Bank Transfers",icon:ON},{to:"/admin/earningspayments",label:"Earning-Payments",icon:k4},{label:"Earnings",icon:pU,children:[{to:"/admin/earnings/packages",label:"Earnings",icon:pU}]},{label:"Pages",icon:IN,children:[{to:"/admin/pages",label:"Pages",icon:IN},{to:"/admin/page-categories",label:"Pages Categories",icon:qZ}]},{label:"Wallet",icon:uy,children:[{to:"/admin/payment-requests",label:"Payment requests",icon:uy},{to:"/admin/wallet-settings",label:"Wallet settings",icon:qZ}]},{label:"Settings",icon:ile,children:[{to:"/admin/settings/payments",label:"Payment setttings",icon:P0},{to:"/admin/settings/points",label:"Points setttings",icon:P0}]},{label:"Groups",icon:gU,children:[{to:"/admin/groups",label:"Groups",icon:gU},{to:"/admin/group-categories",label:"Group Categories",icon:Z2}]},{label:"Events",icon:I0,children:[{to:"/admin/events",label:"Events",icon:I0},{to:"/admin/events-categories",label:"Events Categories",icon:Z2}]},{label:"Ads Management",icon:j0,children:[{to:"/admin/ads",label:"Ads Management",icon:j0},{to:"/admin/adssettings",label:"AdminAdsSettings",icon:$Z}]},{label:"Pros",icon:KZ,children:[{to:"/admin/packages",label:"Packages",icon:KZ},{to:"/admin/subscribers",label:"Subscribers",icon:Z2}]},{label:"Reports",icon:kN,children:[{to:"/admin/reports",label:"Reports",icon:kN},{to:"/admin/reports/categories",label:"Reports categories",icon:$Z}]}];function KYe(){const{pathname:e}=Bc(),[t,n]=w.useState(!1),i=w.useMemo(()=>{const v=new Map;return lte.forEach(b=>{var E;if((E=b.children)!=null&&E.length){const T=b.children.some(C=>e===C.to||e.startsWith(`${C.to}/`));v.set(b.label,T)}}),v},[e]),[o,u]=w.useState({});w.useEffect(()=>{u(v=>{const b={...v};return i.forEach((E,T)=>{E&&(b[T]=!0)}),b})},[i]);const h=v=>u(b=>({...b,[v]:!b[v]})),p=({active:v,children:b,onClick:E})=>c.jsx(be,{variant:v?"default":"ghost",className:"w-full justify-start",onClick:E,children:b}),g=c.jsx("nav",{className:"p-4 space-y-2",children:lte.map(v=>{var T;if((T=v.children)!=null&&T.length){const C=v.icon,R=v.label,N=!!i.get(R),O=!!o[R];return c.jsxs("div",{className:"space-y-1",children:[c.jsxs(p,{active:N,onClick:()=>h(R),children:[c.jsx(C,{className:"h-4 w-4 mr-2"}),c.jsx("span",{className:"flex-1 text-left",children:R}),O?c.jsx(Vw,{className:"h-4 w-4 opacity-70"}):c.jsx(Bw,{className:"h-4 w-4 opacity-70"})]}),O&&c.jsx("div",{className:"ml-6 space-y-1",children:v.children.map(j=>{const k=j.icon||IN,P=e===j.to||e.startsWith(`${j.to}/`);return c.jsx(At,{to:j.to,onClick:()=>n(!1),className:"block",children:c.jsxs(p,{active:P,children:[c.jsx(k,{className:"h-4 w-4 mr-2"}),j.label]})},j.to)})})]},R)}const b=v.icon,E=e===v.to||e.startsWith(`${v.to}/`);return c.jsx(At,{to:v.to,onClick:()=>n(!1),className:"block",children:c.jsxs(p,{active:E,children:[c.jsx(b,{className:"h-4 w-4 mr-2"}),v.label]})},v.to)})});return c.jsxs("div",{className:"flex flex-col h-screen bg-cus",children:[c.jsx(or,{}),c.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[c.jsx("aside",{className:"hidden md:block w-64 border-r bg-white",children:c.jsx("div",{className:"sticky top-16 h-[calc(100vh-4rem)] overflow-y-auto",children:g})}),c.jsxs(H1,{open:t,onOpenChange:n,children:[c.jsx(cB,{asChild:!0,children:c.jsx(be,{variant:"ghost",size:"icon",className:"md:hidden fixed top-16 left-2 z-20",children:c.jsx(Qce,{className:"h-5 w-5"})})}),c.jsx(Xw,{side:"left",className:"p-0 w-72",children:g})]}),c.jsx("main",{className:"flex-1 min-h-0 overflow-y-auto p-4 md:p-6",children:c.jsx(BFe,{})})]})]})}var qYe=Array.isArray,vo=qYe,YYe=typeof Xh=="object"&&Xh&&Xh.Object===Object&&Xh,Upe=YYe,XYe=Upe,JYe=typeof self=="object"&&self&&self.Object===Object&&self,ZYe=XYe||JYe||Function("return this")(),Yu=ZYe,QYe=Yu,eXe=QYe.Symbol,sS=eXe,ute=sS,Fpe=Object.prototype,tXe=Fpe.hasOwnProperty,nXe=Fpe.toString,bE=ute?ute.toStringTag:void 0;function rXe(e){var t=tXe.call(e,bE),n=e[bE];try{e[bE]=void 0;var i=!0}catch{}var o=nXe.call(e);return i&&(t?e[bE]=n:delete e[bE]),o}var iXe=rXe,aXe=Object.prototype,sXe=aXe.toString;function oXe(e){return sXe.call(e)}var cXe=oXe,dte=sS,lXe=iXe,uXe=cXe,dXe="[object Null]",hXe="[object Undefined]",hte=dte?dte.toStringTag:void 0;function fXe(e){return e==null?e===void 0?hXe:dXe:hte&&hte in Object(e)?lXe(e):uXe(e)}var Xd=fXe;function pXe(e){return e!=null&&typeof e=="object"}var Jd=pXe,mXe=Xd,gXe=Jd,vXe="[object Symbol]";function yXe(e){return typeof e=="symbol"||gXe(e)&&mXe(e)==vXe}var c_=yXe,_Xe=vo,bXe=c_,EXe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,wXe=/^\w*$/;function SXe(e,t){if(_Xe(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||bXe(e)?!0:wXe.test(e)||!EXe.test(e)||t!=null&&e in Object(t)}var WB=SXe;function xXe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Mf=xXe;const l_=jr(Mf);var TXe=Xd,CXe=Mf,RXe="[object AsyncFunction]",NXe="[object Function]",AXe="[object GeneratorFunction]",IXe="[object Proxy]";function OXe(e){if(!CXe(e))return!1;var t=TXe(e);return t==NXe||t==AXe||t==RXe||t==IXe}var GB=OXe;const Kn=jr(GB);var PXe=Yu,kXe=PXe["__core-js_shared__"],jXe=kXe,RL=jXe,fte=function(){var e=/[^.]+$/.exec(RL&&RL.keys&&RL.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function DXe(e){return!!fte&&fte in e}var LXe=DXe,MXe=Function.prototype,UXe=MXe.toString;function FXe(e){if(e!=null){try{return UXe.call(e)}catch{}try{return e+""}catch{}}return""}var Vpe=FXe,VXe=GB,BXe=LXe,$Xe=Mf,WXe=Vpe,GXe=/[\\^$.*+?()[\]{}|]/g,HXe=/^\[object .+?Constructor\]$/,zXe=Function.prototype,KXe=Object.prototype,qXe=zXe.toString,YXe=KXe.hasOwnProperty,XXe=RegExp("^"+qXe.call(YXe).replace(GXe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function JXe(e){if(!$Xe(e)||BXe(e))return!1;var t=VXe(e)?XXe:HXe;return t.test(WXe(e))}var ZXe=JXe;function QXe(e,t){return e==null?void 0:e[t]}var eJe=QXe,tJe=ZXe,nJe=eJe;function rJe(e,t){var n=nJe(e,t);return tJe(n)?n:void 0}var Im=rJe,iJe=Im,aJe=iJe(Object,"create"),TI=aJe,pte=TI;function sJe(){this.__data__=pte?pte(null):{},this.size=0}var oJe=sJe;function cJe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var lJe=cJe,uJe=TI,dJe="__lodash_hash_undefined__",hJe=Object.prototype,fJe=hJe.hasOwnProperty;function pJe(e){var t=this.__data__;if(uJe){var n=t[e];return n===dJe?void 0:n}return fJe.call(t,e)?t[e]:void 0}var mJe=pJe,gJe=TI,vJe=Object.prototype,yJe=vJe.hasOwnProperty;function _Je(e){var t=this.__data__;return gJe?t[e]!==void 0:yJe.call(t,e)}var bJe=_Je,EJe=TI,wJe="__lodash_hash_undefined__";function SJe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=EJe&&t===void 0?wJe:t,this}var xJe=SJe,TJe=oJe,CJe=lJe,RJe=mJe,NJe=bJe,AJe=xJe;function u_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u_.prototype.clear=TJe;u_.prototype.delete=CJe;u_.prototype.get=RJe;u_.prototype.has=NJe;u_.prototype.set=AJe;var IJe=u_;function OJe(){this.__data__=[],this.size=0}var PJe=OJe;function kJe(e,t){return e===t||e!==e&&t!==t}var HB=kJe,jJe=HB;function DJe(e,t){for(var n=e.length;n--;)if(jJe(e[n][0],t))return n;return-1}var CI=DJe,LJe=CI,MJe=Array.prototype,UJe=MJe.splice;function FJe(e){var t=this.__data__,n=LJe(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():UJe.call(t,n,1),--this.size,!0}var VJe=FJe,BJe=CI;function $Je(e){var t=this.__data__,n=BJe(t,e);return n<0?void 0:t[n][1]}var WJe=$Je,GJe=CI;function HJe(e){return GJe(this.__data__,e)>-1}var zJe=HJe,KJe=CI;function qJe(e,t){var n=this.__data__,i=KJe(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}var YJe=qJe,XJe=PJe,JJe=VJe,ZJe=WJe,QJe=zJe,eZe=YJe;function d_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}d_.prototype.clear=XJe;d_.prototype.delete=JJe;d_.prototype.get=ZJe;d_.prototype.has=QJe;d_.prototype.set=eZe;var RI=d_,tZe=Im,nZe=Yu,rZe=tZe(nZe,"Map"),zB=rZe,mte=IJe,iZe=RI,aZe=zB;function sZe(){this.size=0,this.__data__={hash:new mte,map:new(aZe||iZe),string:new mte}}var oZe=sZe;function cZe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var lZe=cZe,uZe=lZe;function dZe(e,t){var n=e.__data__;return uZe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var NI=dZe,hZe=NI;function fZe(e){var t=hZe(this,e).delete(e);return this.size-=t?1:0,t}var pZe=fZe,mZe=NI;function gZe(e){return mZe(this,e).get(e)}var vZe=gZe,yZe=NI;function _Ze(e){return yZe(this,e).has(e)}var bZe=_Ze,EZe=NI;function wZe(e,t){var n=EZe(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}var SZe=wZe,xZe=oZe,TZe=pZe,CZe=vZe,RZe=bZe,NZe=SZe;function h_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}h_.prototype.clear=xZe;h_.prototype.delete=TZe;h_.prototype.get=CZe;h_.prototype.has=RZe;h_.prototype.set=NZe;var KB=h_,Bpe=KB,AZe="Expected a function";function qB(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(AZe);var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],u=n.cache;if(u.has(o))return u.get(o);var h=e.apply(this,i);return n.cache=u.set(o,h)||u,h};return n.cache=new(qB.Cache||Bpe),n}qB.Cache=Bpe;var $pe=qB;const IZe=jr($pe);var OZe=$pe,PZe=500;function kZe(e){var t=OZe(e,function(i){return n.size===PZe&&n.clear(),i}),n=t.cache;return t}var jZe=kZe,DZe=jZe,LZe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,MZe=/\\(\\)?/g,UZe=DZe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(LZe,function(n,i,o,u){t.push(o?u.replace(MZe,"$1"):i||n)}),t}),FZe=UZe;function VZe(e,t){for(var n=-1,i=e==null?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}var YB=VZe,gte=sS,BZe=YB,$Ze=vo,WZe=c_,vte=gte?gte.prototype:void 0,yte=vte?vte.toString:void 0;function Wpe(e){if(typeof e=="string")return e;if($Ze(e))return BZe(e,Wpe)+"";if(WZe(e))return yte?yte.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var GZe=Wpe,HZe=GZe;function zZe(e){return e==null?"":HZe(e)}var Gpe=zZe,KZe=vo,qZe=WB,YZe=FZe,XZe=Gpe;function JZe(e,t){return KZe(e)?e:qZe(e,t)?[e]:YZe(XZe(e))}var Hpe=JZe,ZZe=c_;function QZe(e){if(typeof e=="string"||ZZe(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var AI=QZe,eQe=Hpe,tQe=AI;function nQe(e,t){t=eQe(t,e);for(var n=0,i=t.length;e!=null&&n<i;)e=e[tQe(t[n++])];return n&&n==i?e:void 0}var XB=nQe,rQe=XB;function iQe(e,t,n){var i=e==null?void 0:rQe(e,t);return i===void 0?n:i}var zpe=iQe;const Mc=jr(zpe);function aQe(e){return e==null}var sQe=aQe;const Nr=jr(sQe);var oQe=Xd,cQe=vo,lQe=Jd,uQe="[object String]";function dQe(e){return typeof e=="string"||!cQe(e)&&lQe(e)&&oQe(e)==uQe}var hQe=dQe;const mm=jr(hQe);var Kpe={exports:{}},Wr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JB=Symbol.for("react.element"),ZB=Symbol.for("react.portal"),II=Symbol.for("react.fragment"),OI=Symbol.for("react.strict_mode"),PI=Symbol.for("react.profiler"),kI=Symbol.for("react.provider"),jI=Symbol.for("react.context"),fQe=Symbol.for("react.server_context"),DI=Symbol.for("react.forward_ref"),LI=Symbol.for("react.suspense"),MI=Symbol.for("react.suspense_list"),UI=Symbol.for("react.memo"),FI=Symbol.for("react.lazy"),pQe=Symbol.for("react.offscreen"),qpe;qpe=Symbol.for("react.module.reference");function Gc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case JB:switch(e=e.type,e){case II:case PI:case OI:case LI:case MI:return e;default:switch(e=e&&e.$$typeof,e){case fQe:case jI:case DI:case FI:case UI:case kI:return e;default:return t}}case ZB:return t}}}Wr.ContextConsumer=jI;Wr.ContextProvider=kI;Wr.Element=JB;Wr.ForwardRef=DI;Wr.Fragment=II;Wr.Lazy=FI;Wr.Memo=UI;Wr.Portal=ZB;Wr.Profiler=PI;Wr.StrictMode=OI;Wr.Suspense=LI;Wr.SuspenseList=MI;Wr.isAsyncMode=function(){return!1};Wr.isConcurrentMode=function(){return!1};Wr.isContextConsumer=function(e){return Gc(e)===jI};Wr.isContextProvider=function(e){return Gc(e)===kI};Wr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===JB};Wr.isForwardRef=function(e){return Gc(e)===DI};Wr.isFragment=function(e){return Gc(e)===II};Wr.isLazy=function(e){return Gc(e)===FI};Wr.isMemo=function(e){return Gc(e)===UI};Wr.isPortal=function(e){return Gc(e)===ZB};Wr.isProfiler=function(e){return Gc(e)===PI};Wr.isStrictMode=function(e){return Gc(e)===OI};Wr.isSuspense=function(e){return Gc(e)===LI};Wr.isSuspenseList=function(e){return Gc(e)===MI};Wr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===II||e===PI||e===OI||e===LI||e===MI||e===pQe||typeof e=="object"&&e!==null&&(e.$$typeof===FI||e.$$typeof===UI||e.$$typeof===kI||e.$$typeof===jI||e.$$typeof===DI||e.$$typeof===qpe||e.getModuleId!==void 0)};Wr.typeOf=Gc;Kpe.exports=Wr;var mQe=Kpe.exports,gQe=Xd,vQe=Jd,yQe="[object Number]";function _Qe(e){return typeof e=="number"||vQe(e)&&gQe(e)==yQe}var Ype=_Qe;const bQe=jr(Ype);var EQe=Ype;function wQe(e){return EQe(e)&&e!=+e}var SQe=wQe;const oS=jr(SQe);var kl=function(t){return t===0?0:t>0?1:-1},Bp=function(t){return mm(t)&&t.indexOf("%")===t.length-1},xt=function(t){return bQe(t)&&!oS(t)},xQe=function(t){return Nr(t)},Oa=function(t){return xt(t)||mm(t)},TQe=0,VI=function(t){var n=++TQe;return"".concat(t||"").concat(n)},gm=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!xt(t)&&!mm(t))return i;var u;if(Bp(t)){var h=t.indexOf("%");u=n*parseFloat(t.slice(0,h))/100}else u=+t;return oS(u)&&(u=i),o&&u>n&&(u=n),u},Gh=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},CQe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,i={},o=0;o<n;o++)if(!i[t[o]])i[t[o]]=!0;else return!0;return!1},lv=function(t,n){return xt(t)&&xt(n)?function(i){return t+i*(n-t)}:function(){return n}};function qU(e,t,n){return!e||!e.length?null:e.find(function(i){return i&&(typeof t=="function"?t(i):Mc(i,t))===n})}var RQe=function(t,n){return xt(t)&&xt(n)?t-n:mm(t)&&mm(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function $v(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function YU(e){"@babel/helpers - typeof";return YU=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YU(e)}var NQe=["viewBox","children"],AQe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],_te=["points","pathLength"],NL={svg:NQe,polygon:_te,polyline:_te},QB=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],rA=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(w.isValidElement(t)&&(i=t.props),!l_(i))return null;var o={};return Object.keys(i).forEach(function(u){QB.includes(u)&&(o[u]=n||function(h){return i[u](i,h)})}),o},IQe=function(t,n,i){return function(o){return t(n,i,o),null}},iA=function(t,n,i){if(!l_(t)||YU(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(u){var h=t[u];QB.includes(u)&&typeof h=="function"&&(o||(o={}),o[u]=IQe(h,n,i))}),o},OQe=["children"],PQe=["children"];function bte(e,t){if(e==null)return{};var n=kQe(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function kQe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var Ete={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Od=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},wte=null,AL=null,e3=function e(t){if(t===wte&&Array.isArray(AL))return AL;var n=[];return w.Children.forEach(t,function(i){Nr(i)||(mQe.isFragment(i)?n=n.concat(e(i.props.children)):n.push(i))}),AL=n,wte=t,n};function Ml(e,t){var n=[],i=[];return Array.isArray(t)?i=t.map(function(o){return Od(o)}):i=[Od(t)],e3(e).forEach(function(o){var u=Mc(o,"type.displayName")||Mc(o,"type.name");i.indexOf(u)!==-1&&n.push(o)}),n}function Mo(e,t){var n=Ml(e,t);return n&&n[0]}var Ste=function(t){if(!t||!t.props)return!1;var n=t.props,i=n.width,o=n.height;return!(!xt(i)||i<=0||!xt(o)||o<=0)},jQe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],DQe=function(t){return t&&t.type&&mm(t.type)&&jQe.indexOf(t.type)>=0},LQe=function(t,n,i,o){var u,h=(u=NL==null?void 0:NL[o])!==null&&u!==void 0?u:[];return n.startsWith("data-")||!Kn(t)&&(o&&h.includes(n)||AQe.includes(n))||i&&QB.includes(n)},Tr=function(t,n,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(w.isValidElement(t)&&(o=t.props),!l_(o))return null;var u={};return Object.keys(o).forEach(function(h){var p;LQe((p=o)===null||p===void 0?void 0:p[h],h,n,i)&&(u[h]=o[h])}),u},XU=function e(t,n){if(t===n)return!0;var i=w.Children.count(t);if(i!==w.Children.count(n))return!1;if(i===0)return!0;if(i===1)return xte(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var o=0;o<i;o++){var u=t[o],h=n[o];if(Array.isArray(u)||Array.isArray(h)){if(!e(u,h))return!1}else if(!xte(u,h))return!1}return!0},xte=function(t,n){if(Nr(t)&&Nr(n))return!0;if(!Nr(t)&&!Nr(n)){var i=t.props||{},o=i.children,u=bte(i,OQe),h=n.props||{},p=h.children,g=bte(h,PQe);return o&&p?$v(u,g)&&XU(o,p):!o&&!p?$v(u,g):!1}return!1},Tte=function(t,n){var i=[],o={};return e3(t).forEach(function(u,h){if(DQe(u))i.push(u);else if(u){var p=Od(u.type),g=n[p]||{},v=g.handler,b=g.once;if(v&&(!b||!o[p])){var E=v(u,p,h);i.push(E),o[p]=!0}}}),i},MQe=function(t){var n=t&&t.type;return n&&Ete[n]?Ete[n]:null},UQe=function(t,n){return e3(n).indexOf(t)},FQe=["children","width","height","viewBox","className","style","title","desc"];function JU(){return JU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},JU.apply(this,arguments)}function VQe(e,t){if(e==null)return{};var n=BQe(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function BQe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function ZU(e){var t=e.children,n=e.width,i=e.height,o=e.viewBox,u=e.className,h=e.style,p=e.title,g=e.desc,v=VQe(e,FQe),b=o||{width:n,height:i,x:0,y:0},E=er("recharts-surface",u);return me.createElement("svg",JU({},Tr(v,!0,"svg"),{className:E,width:n,height:i,style:h,viewBox:"".concat(b.x," ").concat(b.y," ").concat(b.width," ").concat(b.height)}),me.createElement("title",null,p),me.createElement("desc",null,g),t)}var $Qe=["children","className"];function QU(){return QU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},QU.apply(this,arguments)}function WQe(e,t){if(e==null)return{};var n=GQe(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function GQe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var $a=me.forwardRef(function(e,t){var n=e.children,i=e.className,o=WQe(e,$Qe),u=er("recharts-layer",i);return me.createElement("g",QU({className:u},Tr(o,!0),{ref:t}),n)}),Pd=function(t,n){for(var i=arguments.length,o=new Array(i>2?i-2:0),u=2;u<i;u++)o[u-2]=arguments[u]};function HQe(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var u=Array(o);++i<o;)u[i]=e[i+t];return u}var zQe=HQe,KQe=zQe;function qQe(e,t,n){var i=e.length;return n=n===void 0?i:n,!t&&n>=i?e:KQe(e,t,n)}var YQe=qQe,XQe="\\ud800-\\udfff",JQe="\\u0300-\\u036f",ZQe="\\ufe20-\\ufe2f",QQe="\\u20d0-\\u20ff",eet=JQe+ZQe+QQe,tet="\\ufe0e\\ufe0f",net="\\u200d",ret=RegExp("["+net+XQe+eet+tet+"]");function iet(e){return ret.test(e)}var Xpe=iet;function aet(e){return e.split("")}var set=aet,Jpe="\\ud800-\\udfff",oet="\\u0300-\\u036f",cet="\\ufe20-\\ufe2f",uet="\\u20d0-\\u20ff",det=oet+cet+uet,het="\\ufe0e\\ufe0f",fet="["+Jpe+"]",eF="["+det+"]",tF="\\ud83c[\\udffb-\\udfff]",pet="(?:"+eF+"|"+tF+")",Zpe="[^"+Jpe+"]",Qpe="(?:\\ud83c[\\udde6-\\uddff]){2}",eme="[\\ud800-\\udbff][\\udc00-\\udfff]",met="\\u200d",tme=pet+"?",nme="["+het+"]?",get="(?:"+met+"(?:"+[Zpe,Qpe,eme].join("|")+")"+nme+tme+")*",vet=nme+tme+get,yet="(?:"+[Zpe+eF+"?",eF,Qpe,eme,fet].join("|")+")",_et=RegExp(tF+"(?="+tF+")|"+yet+vet,"g");function bet(e){return e.match(_et)||[]}var Eet=bet,wet=set,xet=Xpe,Tet=Eet;function Cet(e){return xet(e)?Tet(e):wet(e)}var Ret=Cet,Net=YQe,Aet=Xpe,Iet=Ret,Oet=Gpe;function Pet(e){return function(t){t=Oet(t);var n=Aet(t)?Iet(t):void 0,i=n?n[0]:t.charAt(0),o=n?Net(n,1).join(""):t.slice(1);return i[e]()+o}}var ket=Pet,jet=ket,Det=jet("toUpperCase"),Let=Det;const BI=jr(Let);function ai(e){return function(){return e}}const rme=Math.cos,aA=Math.sin,Hl=Math.sqrt,sA=Math.PI,$I=2*sA,nF=Math.PI,rF=2*nF,jp=1e-6,Met=rF-jp;function ime(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Uet(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ime;const n=10**t;return function(i){this._+=i[0];for(let o=1,u=i.length;o<u;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}class Fet{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ime:Uet(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,o){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+o}`}bezierCurveTo(t,n,i,o,u,h){this._append`C${+t},${+n},${+i},${+o},${this._x1=+u},${this._y1=+h}`}arcTo(t,n,i,o,u){if(t=+t,n=+n,i=+i,o=+o,u=+u,u<0)throw new Error(`negative radius: ${u}`);let h=this._x1,p=this._y1,g=i-t,v=o-n,b=h-t,E=p-n,T=b*b+E*E;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(T>jp)if(!(Math.abs(E*g-v*b)>jp)||!u)this._append`L${this._x1=t},${this._y1=n}`;else{let C=i-h,R=o-p,N=g*g+v*v,O=C*C+R*R,j=Math.sqrt(N),k=Math.sqrt(T),P=u*Math.tan((nF-Math.acos((N+T-O)/(2*j*k)))/2),M=P/k,D=P/j;Math.abs(M-1)>jp&&this._append`L${t+M*b},${n+M*E}`,this._append`A${u},${u},0,0,${+(E*C>b*R)},${this._x1=t+D*g},${this._y1=n+D*v}`}}arc(t,n,i,o,u,h){if(t=+t,n=+n,i=+i,h=!!h,i<0)throw new Error(`negative radius: ${i}`);let p=i*Math.cos(o),g=i*Math.sin(o),v=t+p,b=n+g,E=1^h,T=h?o-u:u-o;this._x1===null?this._append`M${v},${b}`:(Math.abs(this._x1-v)>jp||Math.abs(this._y1-b)>jp)&&this._append`L${v},${b}`,i&&(T<0&&(T=T%rF+rF),T>Met?this._append`A${i},${i},0,1,${E},${t-p},${n-g}A${i},${i},0,1,${E},${this._x1=v},${this._y1=b}`:T>jp&&this._append`A${i},${i},0,${+(T>=nF)},${E},${this._x1=t+i*Math.cos(u)},${this._y1=n+i*Math.sin(u)}`)}rect(t,n,i,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+o}h${-i}Z`}toString(){return this._}}function t3(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new Fet(t)}function n3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ame(e){this._context=e}ame.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function WI(e){return new ame(e)}function sme(e){return e[0]}function ome(e){return e[1]}function cme(e,t){var n=ai(!0),i=null,o=WI,u=null,h=t3(p);e=typeof e=="function"?e:e===void 0?sme:ai(e),t=typeof t=="function"?t:t===void 0?ome:ai(t);function p(g){var v,b=(g=n3(g)).length,E,T=!1,C;for(i==null&&(u=o(C=h())),v=0;v<=b;++v)!(v<b&&n(E=g[v],v,g))===T&&((T=!T)?u.lineStart():u.lineEnd()),T&&u.point(+e(E,v,g),+t(E,v,g));if(C)return u=null,C+""||null}return p.x=function(g){return arguments.length?(e=typeof g=="function"?g:ai(+g),p):e},p.y=function(g){return arguments.length?(t=typeof g=="function"?g:ai(+g),p):t},p.defined=function(g){return arguments.length?(n=typeof g=="function"?g:ai(!!g),p):n},p.curve=function(g){return arguments.length?(o=g,i!=null&&(u=o(i)),p):o},p.context=function(g){return arguments.length?(g==null?i=u=null:u=o(i=g),p):i},p}function nR(e,t,n){var i=null,o=ai(!0),u=null,h=WI,p=null,g=t3(v);e=typeof e=="function"?e:e===void 0?sme:ai(+e),t=typeof t=="function"?t:ai(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?ome:ai(+n);function v(E){var T,C,R,N=(E=n3(E)).length,O,j=!1,k,P=new Array(N),M=new Array(N);for(u==null&&(p=h(k=g())),T=0;T<=N;++T){if(!(T<N&&o(O=E[T],T,E))===j)if(j=!j)C=T,p.areaStart(),p.lineStart();else{for(p.lineEnd(),p.lineStart(),R=T-1;R>=C;--R)p.point(P[R],M[R]);p.lineEnd(),p.areaEnd()}j&&(P[T]=+e(O,T,E),M[T]=+t(O,T,E),p.point(i?+i(O,T,E):P[T],n?+n(O,T,E):M[T]))}if(k)return p=null,k+""||null}function b(){return cme().defined(o).curve(h).context(u)}return v.x=function(E){return arguments.length?(e=typeof E=="function"?E:ai(+E),i=null,v):e},v.x0=function(E){return arguments.length?(e=typeof E=="function"?E:ai(+E),v):e},v.x1=function(E){return arguments.length?(i=E==null?null:typeof E=="function"?E:ai(+E),v):i},v.y=function(E){return arguments.length?(t=typeof E=="function"?E:ai(+E),n=null,v):t},v.y0=function(E){return arguments.length?(t=typeof E=="function"?E:ai(+E),v):t},v.y1=function(E){return arguments.length?(n=E==null?null:typeof E=="function"?E:ai(+E),v):n},v.lineX0=v.lineY0=function(){return b().x(e).y(t)},v.lineY1=function(){return b().x(e).y(n)},v.lineX1=function(){return b().x(i).y(t)},v.defined=function(E){return arguments.length?(o=typeof E=="function"?E:ai(!!E),v):o},v.curve=function(E){return arguments.length?(h=E,u!=null&&(p=h(u)),v):h},v.context=function(E){return arguments.length?(E==null?u=p=null:p=h(u=E),v):u},v}class lme{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Vet(e){return new lme(e,!0)}function Bet(e){return new lme(e,!1)}const r3={draw(e,t){const n=Hl(t/sA);e.moveTo(n,0),e.arc(0,0,n,0,$I)}},$et={draw(e,t){const n=Hl(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},ume=Hl(1/3),Wet=ume*2,Get={draw(e,t){const n=Hl(t/Wet),i=n*ume;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}},Het={draw(e,t){const n=Hl(t),i=-n/2;e.rect(i,i,n,n)}},zet=.8908130915292852,dme=aA(sA/10)/aA(7*sA/10),Ket=aA($I/10)*dme,qet=-rme($I/10)*dme,Yet={draw(e,t){const n=Hl(t*zet),i=Ket*n,o=qet*n;e.moveTo(0,-n),e.lineTo(i,o);for(let u=1;u<5;++u){const h=$I*u/5,p=rme(h),g=aA(h);e.lineTo(g*n,-p*n),e.lineTo(p*i-g*o,g*i+p*o)}e.closePath()}},IL=Hl(3),Xet={draw(e,t){const n=-Hl(t/(IL*3));e.moveTo(0,n*2),e.lineTo(-IL*n,-n),e.lineTo(IL*n,-n),e.closePath()}},xc=-.5,Tc=Hl(3)/2,iF=1/Hl(12),Jet=(iF/2+1)*3,Zet={draw(e,t){const n=Hl(t/Jet),i=n/2,o=n*iF,u=i,h=n*iF+n,p=-u,g=h;e.moveTo(i,o),e.lineTo(u,h),e.lineTo(p,g),e.lineTo(xc*i-Tc*o,Tc*i+xc*o),e.lineTo(xc*u-Tc*h,Tc*u+xc*h),e.lineTo(xc*p-Tc*g,Tc*p+xc*g),e.lineTo(xc*i+Tc*o,xc*o-Tc*i),e.lineTo(xc*u+Tc*h,xc*h-Tc*u),e.lineTo(xc*p+Tc*g,xc*g-Tc*p),e.closePath()}};function Qet(e,t){let n=null,i=t3(o);e=typeof e=="function"?e:ai(e||r3),t=typeof t=="function"?t:ai(t===void 0?64:+t);function o(){let u;if(n||(n=u=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),u)return n=null,u+""||null}return o.type=function(u){return arguments.length?(e=typeof u=="function"?u:ai(u),o):e},o.size=function(u){return arguments.length?(t=typeof u=="function"?u:ai(+u),o):t},o.context=function(u){return arguments.length?(n=u??null,o):n},o}function oA(){}function cA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function hme(e){this._context=e}hme.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ett(e){return new hme(e)}function fme(e){this._context=e}fme.prototype={areaStart:oA,areaEnd:oA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:cA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ttt(e){return new fme(e)}function pme(e){this._context=e}pme.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:cA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ntt(e){return new pme(e)}function mme(e){this._context=e}mme.prototype={areaStart:oA,areaEnd:oA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function rtt(e){return new mme(e)}function Cte(e){return e<0?-1:1}function Rte(e,t,n){var i=e._x1-e._x0,o=t-e._x1,u=(e._y1-e._y0)/(i||o<0&&-0),h=(n-e._y1)/(o||i<0&&-0),p=(u*o+h*i)/(i+o);return(Cte(u)+Cte(h))*Math.min(Math.abs(u),Math.abs(h),.5*Math.abs(p))||0}function Nte(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function OL(e,t,n){var i=e._x0,o=e._y0,u=e._x1,h=e._y1,p=(u-i)/3;e._context.bezierCurveTo(i+p,o+p*t,u-p,h-p*n,u,h)}function lA(e){this._context=e}lA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:OL(this,this._t0,Nte(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,OL(this,Nte(this,n=Rte(this,e,t)),n);break;default:OL(this,this._t0,n=Rte(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function gme(e){this._context=new vme(e)}(gme.prototype=Object.create(lA.prototype)).point=function(e,t){lA.prototype.point.call(this,t,e)};function vme(e){this._context=e}vme.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,o,u){this._context.bezierCurveTo(t,e,i,n,u,o)}};function itt(e){return new lA(e)}function att(e){return new gme(e)}function yme(e){this._context=e}yme.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=Ate(e),o=Ate(t),u=0,h=1;h<n;++u,++h)this._context.bezierCurveTo(i[0][u],o[0][u],i[1][u],o[1][u],e[h],t[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Ate(e){var t,n=e.length-1,i,o=new Array(n),u=new Array(n),h=new Array(n);for(o[0]=0,u[0]=2,h[0]=e[0]+2*e[1],t=1;t<n-1;++t)o[t]=1,u[t]=4,h[t]=4*e[t]+2*e[t+1];for(o[n-1]=2,u[n-1]=7,h[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=o[t]/u[t-1],u[t]-=i,h[t]-=i*h[t-1];for(o[n-1]=h[n-1]/u[n-1],t=n-2;t>=0;--t)o[t]=(h[t]-o[t+1])/u[t];for(u[n-1]=(e[n]+o[n-1])/2,t=0;t<n-1;++t)u[t]=2*e[t+1]-o[t+1];return[o,u]}function stt(e){return new yme(e)}function GI(e,t){this._context=e,this._t=t}GI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function ott(e){return new GI(e,.5)}function ctt(e){return new GI(e,0)}function ltt(e){return new GI(e,1)}function by(e,t){if((h=e.length)>1)for(var n=1,i,o,u=e[t[0]],h,p=u.length;n<h;++n)for(o=u,u=e[t[n]],i=0;i<p;++i)u[i][1]+=u[i][0]=isNaN(o[i][1])?o[i][0]:o[i][1]}function aF(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function utt(e,t){return e[t]}function dtt(e){const t=[];return t.key=e,t}function htt(){var e=ai([]),t=aF,n=by,i=utt;function o(u){var h=Array.from(e.apply(this,arguments),dtt),p,g=h.length,v=-1,b;for(const E of u)for(p=0,++v;p<g;++p)(h[p][v]=[0,+i(E,h[p].key,v,u)]).data=E;for(p=0,b=n3(t(h));p<g;++p)h[b[p]].index=p;return n(h,b),h}return o.keys=function(u){return arguments.length?(e=typeof u=="function"?u:ai(Array.from(u)),o):e},o.value=function(u){return arguments.length?(i=typeof u=="function"?u:ai(+u),o):i},o.order=function(u){return arguments.length?(t=u==null?aF:typeof u=="function"?u:ai(Array.from(u)),o):t},o.offset=function(u){return arguments.length?(n=u??by,o):n},o}function ftt(e,t){if((i=e.length)>0){for(var n,i,o=0,u=e[0].length,h;o<u;++o){for(h=n=0;n<i;++n)h+=e[n][o][1]||0;if(h)for(n=0;n<i;++n)e[n][o][1]/=h}by(e,t)}}function ptt(e,t){if((o=e.length)>0){for(var n=0,i=e[t[0]],o,u=i.length;n<u;++n){for(var h=0,p=0;h<o;++h)p+=e[h][n][1]||0;i[n][1]+=i[n][0]=-p/2}by(e,t)}}function mtt(e,t){if(!(!((h=e.length)>0)||!((u=(o=e[t[0]]).length)>0))){for(var n=0,i=1,o,u,h;i<u;++i){for(var p=0,g=0,v=0;p<h;++p){for(var b=e[t[p]],E=b[i][1]||0,T=b[i-1][1]||0,C=(E-T)/2,R=0;R<p;++R){var N=e[t[R]],O=N[i][1]||0,j=N[i-1][1]||0;C+=O-j}g+=E,v+=C*E}o[i-1][1]+=o[i-1][0]=n,g&&(n-=v/g)}o[i-1][1]+=o[i-1][0]=n,by(e,t)}}function q0(e){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}var gtt=["type","size","sizeType"];function sF(){return sF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},sF.apply(this,arguments)}function Ite(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ote(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ite(Object(n),!0).forEach(function(i){vtt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ite(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function vtt(e,t,n){return t=ytt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ytt(e){var t=_tt(e,"string");return q0(t)=="symbol"?t:t+""}function _tt(e,t){if(q0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(q0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function btt(e,t){if(e==null)return{};var n=Ett(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Ett(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var _me={symbolCircle:r3,symbolCross:$et,symbolDiamond:Get,symbolSquare:Het,symbolStar:Yet,symbolTriangle:Xet,symbolWye:Zet},wtt=Math.PI/180,Stt=function(t){var n="symbol".concat(BI(t));return _me[n]||r3},xtt=function(t,n,i){if(n==="area")return t;switch(i){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*wtt;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Ttt=function(t,n){_me["symbol".concat(BI(t))]=n},i3=function(t){var n=t.type,i=n===void 0?"circle":n,o=t.size,u=o===void 0?64:o,h=t.sizeType,p=h===void 0?"area":h,g=btt(t,gtt),v=Ote(Ote({},g),{},{type:i,size:u,sizeType:p}),b=function(){var O=Stt(i),j=Qet().type(O).size(xtt(u,p,i));return j()},E=v.className,T=v.cx,C=v.cy,R=Tr(v,!0);return T===+T&&C===+C&&u===+u?me.createElement("path",sF({},R,{className:er("recharts-symbols",E),transform:"translate(".concat(T,", ").concat(C,")"),d:b()})):null};i3.registerSymbol=Ttt;function Ey(e){"@babel/helpers - typeof";return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(e)}function oF(){return oF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},oF.apply(this,arguments)}function Pte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ctt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pte(Object(n),!0).forEach(function(i){Y0(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Rtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ntt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Eme(i.key),i)}}function Att(e,t,n){return t&&Ntt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Itt(e,t,n){return t=uA(t),Ott(e,bme()?Reflect.construct(t,n||[],uA(e).constructor):t.apply(e,n))}function Ott(e,t){if(t&&(Ey(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ptt(e)}function Ptt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bme=function(){return!!e})()}function uA(e){return uA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uA(e)}function ktt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cF(e,t)}function cF(e,t){return cF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},cF(e,t)}function Y0(e,t,n){return t=Eme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eme(e){var t=jtt(e,"string");return Ey(t)=="symbol"?t:t+""}function jtt(e,t){if(Ey(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ey(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Cc=32,a3=function(e){function t(){return Rtt(this,t),Itt(this,t,arguments)}return ktt(t,e),Att(t,[{key:"renderIcon",value:function(i){var o=this.props.inactiveColor,u=Cc/2,h=Cc/6,p=Cc/3,g=i.inactive?o:i.color;if(i.type==="plainline")return me.createElement("line",{strokeWidth:4,fill:"none",stroke:g,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:u,x2:Cc,y2:u,className:"recharts-legend-icon"});if(i.type==="line")return me.createElement("path",{strokeWidth:4,fill:"none",stroke:g,d:"M0,".concat(u,"h").concat(p,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*p,",").concat(u,`
            H`).concat(Cc,"M").concat(2*p,",").concat(u,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(p,",").concat(u),className:"recharts-legend-icon"});if(i.type==="rect")return me.createElement("path",{stroke:"none",fill:g,d:"M0,".concat(Cc/8,"h").concat(Cc,"v").concat(Cc*3/4,"h").concat(-Cc,"z"),className:"recharts-legend-icon"});if(me.isValidElement(i.legendIcon)){var v=Ctt({},i);return delete v.legendIcon,me.cloneElement(i.legendIcon,v)}return me.createElement(i3,{fill:g,cx:u,cy:u,size:Cc,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,o=this.props,u=o.payload,h=o.iconSize,p=o.layout,g=o.formatter,v=o.inactiveColor,b={x:0,y:0,width:Cc,height:Cc},E={display:p==="horizontal"?"inline-block":"block",marginRight:10},T={display:"inline-block",verticalAlign:"middle",marginRight:4};return u.map(function(C,R){var N=C.formatter||g,O=er(Y0(Y0({"recharts-legend-item":!0},"legend-item-".concat(R),!0),"inactive",C.inactive));if(C.type==="none")return null;var j=Kn(C.value)?null:C.value;Pd(!Kn(C.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var k=C.inactive?v:C.color;return me.createElement("li",oF({className:O,style:E,key:"legend-item-".concat(R)},iA(i.props,C,R)),me.createElement(ZU,{width:h,height:h,viewBox:b,style:T},i.renderIcon(C)),me.createElement("span",{className:"recharts-legend-item-text",style:{color:k}},N?N(j,C,R):j))})}},{key:"render",value:function(){var i=this.props,o=i.payload,u=i.layout,h=i.align;if(!o||!o.length)return null;var p={padding:0,margin:0,textAlign:u==="horizontal"?h:"left"};return me.createElement("ul",{className:"recharts-default-legend",style:p},this.renderItems())}}])}(w.PureComponent);Y0(a3,"displayName","Legend");Y0(a3,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Dtt=RI;function Ltt(){this.__data__=new Dtt,this.size=0}var Mtt=Ltt;function Utt(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Ftt=Utt;function Vtt(e){return this.__data__.get(e)}var Btt=Vtt;function $tt(e){return this.__data__.has(e)}var Wtt=$tt,Gtt=RI,Htt=zB,ztt=KB,Ktt=200;function qtt(e,t){var n=this.__data__;if(n instanceof Gtt){var i=n.__data__;if(!Htt||i.length<Ktt-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new ztt(i)}return n.set(e,t),this.size=n.size,this}var Ytt=qtt,Xtt=RI,Jtt=Mtt,Ztt=Ftt,Qtt=Btt,ent=Wtt,tnt=Ytt;function f_(e){var t=this.__data__=new Xtt(e);this.size=t.size}f_.prototype.clear=Jtt;f_.prototype.delete=Ztt;f_.prototype.get=Qtt;f_.prototype.has=ent;f_.prototype.set=tnt;var wme=f_,nnt="__lodash_hash_undefined__";function rnt(e){return this.__data__.set(e,nnt),this}var int=rnt;function ant(e){return this.__data__.has(e)}var snt=ant,ont=KB,cnt=int,lnt=snt;function dA(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new ont;++t<n;)this.add(e[t])}dA.prototype.add=dA.prototype.push=cnt;dA.prototype.has=lnt;var Sme=dA;function unt(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var xme=unt;function dnt(e,t){return e.has(t)}var Tme=dnt,hnt=Sme,fnt=xme,pnt=Tme,mnt=1,gnt=2;function vnt(e,t,n,i,o,u){var h=n&mnt,p=e.length,g=t.length;if(p!=g&&!(h&&g>p))return!1;var v=u.get(e),b=u.get(t);if(v&&b)return v==t&&b==e;var E=-1,T=!0,C=n&gnt?new hnt:void 0;for(u.set(e,t),u.set(t,e);++E<p;){var R=e[E],N=t[E];if(i)var O=h?i(N,R,E,t,e,u):i(R,N,E,e,t,u);if(O!==void 0){if(O)continue;T=!1;break}if(C){if(!fnt(t,function(j,k){if(!pnt(C,k)&&(R===j||o(R,j,n,i,u)))return C.push(k)})){T=!1;break}}else if(!(R===N||o(R,N,n,i,u))){T=!1;break}}return u.delete(e),u.delete(t),T}var Cme=vnt,ynt=Yu,_nt=ynt.Uint8Array,bnt=_nt;function Ent(e){var t=-1,n=Array(e.size);return e.forEach(function(i,o){n[++t]=[o,i]}),n}var wnt=Ent;function Snt(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}var s3=Snt,kte=sS,jte=bnt,xnt=HB,Tnt=Cme,Cnt=wnt,Rnt=s3,Nnt=1,Ant=2,Int="[object Boolean]",Ont="[object Date]",Pnt="[object Error]",knt="[object Map]",jnt="[object Number]",Dnt="[object RegExp]",Lnt="[object Set]",Mnt="[object String]",Unt="[object Symbol]",Fnt="[object ArrayBuffer]",Vnt="[object DataView]",Dte=kte?kte.prototype:void 0,PL=Dte?Dte.valueOf:void 0;function Bnt(e,t,n,i,o,u,h){switch(n){case Vnt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Fnt:return!(e.byteLength!=t.byteLength||!u(new jte(e),new jte(t)));case Int:case Ont:case jnt:return xnt(+e,+t);case Pnt:return e.name==t.name&&e.message==t.message;case Dnt:case Mnt:return e==t+"";case knt:var p=Cnt;case Lnt:var g=i&Nnt;if(p||(p=Rnt),e.size!=t.size&&!g)return!1;var v=h.get(e);if(v)return v==t;i|=Ant,h.set(e,t);var b=Tnt(p(e),p(t),i,o,u,h);return h.delete(e),b;case Unt:if(PL)return PL.call(e)==PL.call(t)}return!1}var $nt=Bnt;function Wnt(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}var Rme=Wnt,Gnt=Rme,Hnt=vo;function znt(e,t,n){var i=t(e);return Hnt(e)?i:Gnt(i,n(e))}var Knt=znt;function qnt(e,t){for(var n=-1,i=e==null?0:e.length,o=0,u=[];++n<i;){var h=e[n];t(h,n,e)&&(u[o++]=h)}return u}var Ynt=qnt;function Xnt(){return[]}var Jnt=Xnt,Znt=Ynt,Qnt=Jnt,ert=Object.prototype,trt=ert.propertyIsEnumerable,Lte=Object.getOwnPropertySymbols,nrt=Lte?function(e){return e==null?[]:(e=Object(e),Znt(Lte(e),function(t){return trt.call(e,t)}))}:Qnt,rrt=nrt;function irt(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}var art=irt,srt=Xd,ort=Jd,crt="[object Arguments]";function lrt(e){return ort(e)&&srt(e)==crt}var urt=lrt,Mte=urt,drt=Jd,Nme=Object.prototype,hrt=Nme.hasOwnProperty,frt=Nme.propertyIsEnumerable,prt=Mte(function(){return arguments}())?Mte:function(e){return drt(e)&&hrt.call(e,"callee")&&!frt.call(e,"callee")},o3=prt,hA={exports:{}};function mrt(){return!1}var grt=mrt;hA.exports;(function(e,t){var n=Yu,i=grt,o=t&&!t.nodeType&&t,u=o&&!0&&e&&!e.nodeType&&e,h=u&&u.exports===o,p=h?n.Buffer:void 0,g=p?p.isBuffer:void 0,v=g||i;e.exports=v})(hA,hA.exports);var Ame=hA.exports,vrt=9007199254740991,yrt=/^(?:0|[1-9]\d*)$/;function _rt(e,t){var n=typeof e;return t=t??vrt,!!t&&(n=="number"||n!="symbol"&&yrt.test(e))&&e>-1&&e%1==0&&e<t}var c3=_rt,brt=9007199254740991;function Ert(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=brt}var l3=Ert,wrt=Xd,Srt=l3,xrt=Jd,Trt="[object Arguments]",Crt="[object Array]",Rrt="[object Boolean]",Nrt="[object Date]",Art="[object Error]",Irt="[object Function]",Ort="[object Map]",Prt="[object Number]",krt="[object Object]",jrt="[object RegExp]",Drt="[object Set]",Lrt="[object String]",Mrt="[object WeakMap]",Urt="[object ArrayBuffer]",Frt="[object DataView]",Vrt="[object Float32Array]",Brt="[object Float64Array]",$rt="[object Int8Array]",Wrt="[object Int16Array]",Grt="[object Int32Array]",Hrt="[object Uint8Array]",zrt="[object Uint8ClampedArray]",Krt="[object Uint16Array]",qrt="[object Uint32Array]",di={};di[Vrt]=di[Brt]=di[$rt]=di[Wrt]=di[Grt]=di[Hrt]=di[zrt]=di[Krt]=di[qrt]=!0;di[Trt]=di[Crt]=di[Urt]=di[Rrt]=di[Frt]=di[Nrt]=di[Art]=di[Irt]=di[Ort]=di[Prt]=di[krt]=di[jrt]=di[Drt]=di[Lrt]=di[Mrt]=!1;function Yrt(e){return xrt(e)&&Srt(e.length)&&!!di[wrt(e)]}var Xrt=Yrt;function Jrt(e){return function(t){return e(t)}}var Ime=Jrt,fA={exports:{}};fA.exports;(function(e,t){var n=Upe,i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,u=o&&o.exports===i,h=u&&n.process,p=function(){try{var g=o&&o.require&&o.require("util").types;return g||h&&h.binding&&h.binding("util")}catch{}}();e.exports=p})(fA,fA.exports);var Zrt=fA.exports,Qrt=Xrt,eit=Ime,Ute=Zrt,Fte=Ute&&Ute.isTypedArray,tit=Fte?eit(Fte):Qrt,Ome=tit,nit=art,rit=o3,iit=vo,ait=Ame,sit=c3,oit=Ome,cit=Object.prototype,lit=cit.hasOwnProperty;function uit(e,t){var n=iit(e),i=!n&&rit(e),o=!n&&!i&&ait(e),u=!n&&!i&&!o&&oit(e),h=n||i||o||u,p=h?nit(e.length,String):[],g=p.length;for(var v in e)(t||lit.call(e,v))&&!(h&&(v=="length"||o&&(v=="offset"||v=="parent")||u&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||sit(v,g)))&&p.push(v);return p}var dit=uit,hit=Object.prototype;function fit(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||hit;return e===n}var pit=fit;function mit(e,t){return function(n){return e(t(n))}}var Pme=mit,git=Pme,vit=git(Object.keys,Object),yit=vit,_it=pit,bit=yit,Eit=Object.prototype,wit=Eit.hasOwnProperty;function Sit(e){if(!_it(e))return bit(e);var t=[];for(var n in Object(e))wit.call(e,n)&&n!="constructor"&&t.push(n);return t}var xit=Sit,Tit=GB,Cit=l3;function Rit(e){return e!=null&&Cit(e.length)&&!Tit(e)}var cS=Rit,Nit=dit,Ait=xit,Iit=cS;function Oit(e){return Iit(e)?Nit(e):Ait(e)}var HI=Oit,Pit=Knt,kit=rrt,jit=HI;function Dit(e){return Pit(e,jit,kit)}var Lit=Dit,Vte=Lit,Mit=1,Uit=Object.prototype,Fit=Uit.hasOwnProperty;function Vit(e,t,n,i,o,u){var h=n&Mit,p=Vte(e),g=p.length,v=Vte(t),b=v.length;if(g!=b&&!h)return!1;for(var E=g;E--;){var T=p[E];if(!(h?T in t:Fit.call(t,T)))return!1}var C=u.get(e),R=u.get(t);if(C&&R)return C==t&&R==e;var N=!0;u.set(e,t),u.set(t,e);for(var O=h;++E<g;){T=p[E];var j=e[T],k=t[T];if(i)var P=h?i(k,j,T,t,e,u):i(j,k,T,e,t,u);if(!(P===void 0?j===k||o(j,k,n,i,u):P)){N=!1;break}O||(O=T=="constructor")}if(N&&!O){var M=e.constructor,D=t.constructor;M!=D&&"constructor"in e&&"constructor"in t&&!(typeof M=="function"&&M instanceof M&&typeof D=="function"&&D instanceof D)&&(N=!1)}return u.delete(e),u.delete(t),N}var Bit=Vit,$it=Im,Wit=Yu,Git=$it(Wit,"DataView"),Hit=Git,zit=Im,Kit=Yu,qit=zit(Kit,"Promise"),Yit=qit,Xit=Im,Jit=Yu,Zit=Xit(Jit,"Set"),kme=Zit,Qit=Im,eat=Yu,tat=Qit(eat,"WeakMap"),nat=tat,lF=Hit,uF=zB,dF=Yit,hF=kme,fF=nat,jme=Xd,p_=Vpe,Bte="[object Map]",rat="[object Object]",$te="[object Promise]",Wte="[object Set]",Gte="[object WeakMap]",Hte="[object DataView]",iat=p_(lF),aat=p_(uF),sat=p_(dF),oat=p_(hF),cat=p_(fF),Dp=jme;(lF&&Dp(new lF(new ArrayBuffer(1)))!=Hte||uF&&Dp(new uF)!=Bte||dF&&Dp(dF.resolve())!=$te||hF&&Dp(new hF)!=Wte||fF&&Dp(new fF)!=Gte)&&(Dp=function(e){var t=jme(e),n=t==rat?e.constructor:void 0,i=n?p_(n):"";if(i)switch(i){case iat:return Hte;case aat:return Bte;case sat:return $te;case oat:return Wte;case cat:return Gte}return t});var lat=Dp,kL=wme,uat=Cme,dat=$nt,hat=Bit,zte=lat,Kte=vo,qte=Ame,fat=Ome,pat=1,Yte="[object Arguments]",Xte="[object Array]",rR="[object Object]",mat=Object.prototype,Jte=mat.hasOwnProperty;function gat(e,t,n,i,o,u){var h=Kte(e),p=Kte(t),g=h?Xte:zte(e),v=p?Xte:zte(t);g=g==Yte?rR:g,v=v==Yte?rR:v;var b=g==rR,E=v==rR,T=g==v;if(T&&qte(e)){if(!qte(t))return!1;h=!0,b=!1}if(T&&!b)return u||(u=new kL),h||fat(e)?uat(e,t,n,i,o,u):dat(e,t,g,n,i,o,u);if(!(n&pat)){var C=b&&Jte.call(e,"__wrapped__"),R=E&&Jte.call(t,"__wrapped__");if(C||R){var N=C?e.value():e,O=R?t.value():t;return u||(u=new kL),o(N,O,n,i,u)}}return T?(u||(u=new kL),hat(e,t,n,i,o,u)):!1}var vat=gat,yat=vat,Zte=Jd;function Dme(e,t,n,i,o){return e===t?!0:e==null||t==null||!Zte(e)&&!Zte(t)?e!==e&&t!==t:yat(e,t,n,i,Dme,o)}var u3=Dme,_at=wme,bat=u3,Eat=1,wat=2;function Sat(e,t,n,i){var o=n.length,u=o,h=!i;if(e==null)return!u;for(e=Object(e);o--;){var p=n[o];if(h&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++o<u;){p=n[o];var g=p[0],v=e[g],b=p[1];if(h&&p[2]){if(v===void 0&&!(g in e))return!1}else{var E=new _at;if(i)var T=i(v,b,g,e,t,E);if(!(T===void 0?bat(b,v,Eat|wat,i,E):T))return!1}}return!0}var xat=Sat,Tat=Mf;function Cat(e){return e===e&&!Tat(e)}var Lme=Cat,Rat=Lme,Nat=HI;function Aat(e){for(var t=Nat(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,Rat(o)]}return t}var Iat=Aat;function Oat(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var Mme=Oat,Pat=xat,kat=Iat,jat=Mme;function Dat(e){var t=kat(e);return t.length==1&&t[0][2]?jat(t[0][0],t[0][1]):function(n){return n===e||Pat(n,e,t)}}var Lat=Dat;function Mat(e,t){return e!=null&&t in Object(e)}var Uat=Mat,Fat=Hpe,Vat=o3,Bat=vo,$at=c3,Wat=l3,Gat=AI;function Hat(e,t,n){t=Fat(t,e);for(var i=-1,o=t.length,u=!1;++i<o;){var h=Gat(t[i]);if(!(u=e!=null&&n(e,h)))break;e=e[h]}return u||++i!=o?u:(o=e==null?0:e.length,!!o&&Wat(o)&&$at(h,o)&&(Bat(e)||Vat(e)))}var zat=Hat,Kat=Uat,qat=zat;function Yat(e,t){return e!=null&&qat(e,t,Kat)}var Xat=Yat,Jat=u3,Zat=zpe,Qat=Xat,est=WB,tst=Lme,nst=Mme,rst=AI,ist=1,ast=2;function sst(e,t){return est(e)&&tst(t)?nst(rst(e),t):function(n){var i=Zat(n,e);return i===void 0&&i===t?Qat(n,e):Jat(t,i,ist|ast)}}var ost=sst;function cst(e){return e}var m_=cst;function lst(e){return function(t){return t==null?void 0:t[e]}}var ust=lst,dst=XB;function hst(e){return function(t){return dst(t,e)}}var fst=hst,pst=ust,mst=fst,gst=WB,vst=AI;function yst(e){return gst(e)?pst(vst(e)):mst(e)}var _st=yst,bst=Lat,Est=ost,wst=m_,Sst=vo,xst=_st;function Tst(e){return typeof e=="function"?e:e==null?wst:typeof e=="object"?Sst(e)?Est(e[0],e[1]):bst(e):xst(e)}var Uf=Tst;function Cst(e,t,n,i){for(var o=e.length,u=n+(i?1:-1);i?u--:++u<o;)if(t(e[u],u,e))return u;return-1}var Ume=Cst;function Rst(e){return e!==e}var Nst=Rst;function Ast(e,t,n){for(var i=n-1,o=e.length;++i<o;)if(e[i]===t)return i;return-1}var Ist=Ast,Ost=Ume,Pst=Nst,kst=Ist;function jst(e,t,n){return t===t?kst(e,t,n):Ost(e,Pst,n)}var Dst=jst,Lst=Dst;function Mst(e,t){var n=e==null?0:e.length;return!!n&&Lst(e,t,0)>-1}var Ust=Mst;function Fst(e,t,n){for(var i=-1,o=e==null?0:e.length;++i<o;)if(n(t,e[i]))return!0;return!1}var Vst=Fst;function Bst(){}var $st=Bst,jL=kme,Wst=$st,Gst=s3,Hst=1/0,zst=jL&&1/Gst(new jL([,-0]))[1]==Hst?function(e){return new jL(e)}:Wst,Kst=zst,qst=Sme,Yst=Ust,Xst=Vst,Jst=Tme,Zst=Kst,Qst=s3,eot=200;function tot(e,t,n){var i=-1,o=Yst,u=e.length,h=!0,p=[],g=p;if(n)h=!1,o=Xst;else if(u>=eot){var v=t?null:Zst(e);if(v)return Qst(v);h=!1,o=Jst,g=new qst}else g=t?[]:p;e:for(;++i<u;){var b=e[i],E=t?t(b):b;if(b=n||b!==0?b:0,h&&E===E){for(var T=g.length;T--;)if(g[T]===E)continue e;t&&g.push(E),p.push(b)}else o(g,E,n)||(g!==p&&g.push(E),p.push(b))}return p}var not=tot,rot=Uf,iot=not;function aot(e,t){return e&&e.length?iot(e,rot(t)):[]}var sot=aot;const Qte=jr(sot);function Fme(e,t,n){return t===!0?Qte(e,n):Kn(t)?Qte(e,t):e}function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}var oot=["ref"];function ene(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function vd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ene(Object(n),!0).forEach(function(i){zI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ene(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function cot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Bme(i.key),i)}}function lot(e,t,n){return t&&tne(e.prototype,t),n&&tne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function uot(e,t,n){return t=pA(t),dot(e,Vme()?Reflect.construct(t,n||[],pA(e).constructor):t.apply(e,n))}function dot(e,t){if(t&&(wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hot(e)}function hot(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vme=function(){return!!e})()}function pA(e){return pA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pA(e)}function fot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pF(e,t)}function pF(e,t){return pF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},pF(e,t)}function zI(e,t,n){return t=Bme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bme(e){var t=pot(e,"string");return wy(t)=="symbol"?t:t+""}function pot(e,t){if(wy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(wy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function mot(e,t){if(e==null)return{};var n=got(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function got(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function vot(e){return e.value}function yot(e,t){if(me.isValidElement(e))return me.cloneElement(e,t);if(typeof e=="function")return me.createElement(e,t);t.ref;var n=mot(t,oot);return me.createElement(a3,n)}var nne=1,kd=function(e){function t(){var n;cot(this,t);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return n=uot(this,t,[].concat(o)),zI(n,"lastBoundingBox",{width:-1,height:-1}),n}return fot(t,e),lot(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>nne||Math.abs(o.height-this.lastBoundingBox.height)>nne)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,i&&i(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?vd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var o=this.props,u=o.layout,h=o.align,p=o.verticalAlign,g=o.margin,v=o.chartWidth,b=o.chartHeight,E,T;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(h==="center"&&u==="vertical"){var C=this.getBBoxSnapshot();E={left:((v||0)-C.width)/2}}else E=h==="right"?{right:g&&g.right||0}:{left:g&&g.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(p==="middle"){var R=this.getBBoxSnapshot();T={top:((b||0)-R.height)/2}}else T=p==="bottom"?{bottom:g&&g.bottom||0}:{top:g&&g.top||0};return vd(vd({},E),T)}},{key:"render",value:function(){var i=this,o=this.props,u=o.content,h=o.width,p=o.height,g=o.wrapperStyle,v=o.payloadUniqBy,b=o.payload,E=vd(vd({position:"absolute",width:h||"auto",height:p||"auto"},this.getDefaultPosition(g)),g);return me.createElement("div",{className:"recharts-legend-wrapper",style:E,ref:function(C){i.wrapperNode=C}},yot(u,vd(vd({},this.props),{},{payload:Fme(b,v,vot)})))}}],[{key:"getWithHeight",value:function(i,o){var u=vd(vd({},this.defaultProps),i.props),h=u.layout;return h==="vertical"&&xt(i.props.height)?{height:i.props.height}:h==="horizontal"?{width:i.props.width||o}:null}}])}(w.PureComponent);zI(kd,"displayName","Legend");zI(kd,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var rne=sS,_ot=o3,bot=vo,ine=rne?rne.isConcatSpreadable:void 0;function Eot(e){return bot(e)||_ot(e)||!!(ine&&e&&e[ine])}var wot=Eot,Sot=Rme,xot=wot;function $me(e,t,n,i,o){var u=-1,h=e.length;for(n||(n=xot),o||(o=[]);++u<h;){var p=e[u];t>0&&n(p)?t>1?$me(p,t-1,n,i,o):Sot(o,p):i||(o[o.length]=p)}return o}var Wme=$me;function Tot(e){return function(t,n,i){for(var o=-1,u=Object(t),h=i(t),p=h.length;p--;){var g=h[e?p:++o];if(n(u[g],g,u)===!1)break}return t}}var Cot=Tot,Rot=Cot,Not=Rot(),Aot=Not,Iot=Aot,Oot=HI;function Pot(e,t){return e&&Iot(e,t,Oot)}var Gme=Pot,kot=cS;function jot(e,t){return function(n,i){if(n==null)return n;if(!kot(n))return e(n,i);for(var o=n.length,u=t?o:-1,h=Object(n);(t?u--:++u<o)&&i(h[u],u,h)!==!1;);return n}}var Dot=jot,Lot=Gme,Mot=Dot,Uot=Mot(Lot),d3=Uot,Fot=d3,Vot=cS;function Bot(e,t){var n=-1,i=Vot(e)?Array(e.length):[];return Fot(e,function(o,u,h){i[++n]=t(o,u,h)}),i}var Hme=Bot;function $ot(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var Wot=$ot,ane=c_;function Got(e,t){if(e!==t){var n=e!==void 0,i=e===null,o=e===e,u=ane(e),h=t!==void 0,p=t===null,g=t===t,v=ane(t);if(!p&&!v&&!u&&e>t||u&&h&&g&&!p&&!v||i&&h&&g||!n&&g||!o)return 1;if(!i&&!u&&!v&&e<t||v&&n&&o&&!i&&!u||p&&n&&o||!h&&o||!g)return-1}return 0}var Hot=Got,zot=Hot;function Kot(e,t,n){for(var i=-1,o=e.criteria,u=t.criteria,h=o.length,p=n.length;++i<h;){var g=zot(o[i],u[i]);if(g){if(i>=p)return g;var v=n[i];return g*(v=="desc"?-1:1)}}return e.index-t.index}var qot=Kot,DL=YB,Yot=XB,Xot=Uf,Jot=Hme,Zot=Wot,Qot=Ime,ect=qot,tct=m_,nct=vo;function rct(e,t,n){t.length?t=DL(t,function(u){return nct(u)?function(h){return Yot(h,u.length===1?u[0]:u)}:u}):t=[tct];var i=-1;t=DL(t,Qot(Xot));var o=Jot(e,function(u,h,p){var g=DL(t,function(v){return v(u)});return{criteria:g,index:++i,value:u}});return Zot(o,function(u,h){return ect(u,h,n)})}var ict=rct;function act(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var sct=act,oct=sct,sne=Math.max;function cct(e,t,n){return t=sne(t===void 0?e.length-1:t,0),function(){for(var i=arguments,o=-1,u=sne(i.length-t,0),h=Array(u);++o<u;)h[o]=i[t+o];o=-1;for(var p=Array(t+1);++o<t;)p[o]=i[o];return p[t]=n(h),oct(e,this,p)}}var lct=cct;function uct(e){return function(){return e}}var dct=uct,hct=Im,fct=function(){try{var e=hct(Object,"defineProperty");return e({},"",{}),e}catch{}}(),zme=fct,pct=dct,one=zme,mct=m_,gct=one?function(e,t){return one(e,"toString",{configurable:!0,enumerable:!1,value:pct(t),writable:!0})}:mct,vct=gct,yct=800,_ct=16,bct=Date.now;function Ect(e){var t=0,n=0;return function(){var i=bct(),o=_ct-(i-n);if(n=i,o>0){if(++t>=yct)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var wct=Ect,Sct=vct,xct=wct,Tct=xct(Sct),Cct=Tct,Rct=m_,Nct=lct,Act=Cct;function Ict(e,t){return Act(Nct(e,t,Rct),e+"")}var Oct=Ict,Pct=HB,kct=cS,jct=c3,Dct=Mf;function Lct(e,t,n){if(!Dct(n))return!1;var i=typeof t;return(i=="number"?kct(n)&&jct(t,n.length):i=="string"&&t in n)?Pct(n[t],e):!1}var KI=Lct,Mct=Wme,Uct=ict,Fct=Oct,cne=KI,Vct=Fct(function(e,t){if(e==null)return[];var n=t.length;return n>1&&cne(e,t[0],t[1])?t=[]:n>2&&cne(t[0],t[1],t[2])&&(t=[t[0]]),Uct(e,Mct(t,1),[])}),Bct=Vct;const h3=jr(Bct);function X0(e){"@babel/helpers - typeof";return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(e)}function mF(){return mF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mF.apply(this,arguments)}function $ct(e,t){return zct(e)||Hct(e,t)||Gct(e,t)||Wct()}function Wct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gct(e,t){if(e){if(typeof e=="string")return lne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lne(e,t)}}function lne(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Hct(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function zct(e){if(Array.isArray(e))return e}function une(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function LL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?une(Object(n),!0).forEach(function(i){Kct(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):une(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Kct(e,t,n){return t=qct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qct(e){var t=Yct(e,"string");return X0(t)=="symbol"?t:t+""}function Yct(e,t){if(X0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(X0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xct(e){return Array.isArray(e)&&Oa(e[0])&&Oa(e[1])?e.join(" ~ "):e}var Jct=function(t){var n=t.separator,i=n===void 0?" : ":n,o=t.contentStyle,u=o===void 0?{}:o,h=t.itemStyle,p=h===void 0?{}:h,g=t.labelStyle,v=g===void 0?{}:g,b=t.payload,E=t.formatter,T=t.itemSorter,C=t.wrapperClassName,R=t.labelClassName,N=t.label,O=t.labelFormatter,j=t.accessibilityLayer,k=j===void 0?!1:j,P=function(){if(b&&b.length){var z={padding:0,margin:0},Z=(T?h3(b,T):b).map(function(X,ae){if(X.type==="none")return null;var se=LL({display:"block",paddingTop:4,paddingBottom:4,color:X.color||"#000"},p),J=X.formatter||E||Xct,re=X.value,ee=X.name,de=re,xe=ee;if(J&&de!=null&&xe!=null){var ve=J(re,ee,X,ae,b);if(Array.isArray(ve)){var Te=$ct(ve,2);de=Te[0],xe=Te[1]}else de=ve}return me.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ae),style:se},Oa(xe)?me.createElement("span",{className:"recharts-tooltip-item-name"},xe):null,Oa(xe)?me.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,me.createElement("span",{className:"recharts-tooltip-item-value"},de),me.createElement("span",{className:"recharts-tooltip-item-unit"},X.unit||""))});return me.createElement("ul",{className:"recharts-tooltip-item-list",style:z},Z)}return null},M=LL({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},u),D=LL({margin:0},v),U=!Nr(N),F=U?N:"",H=er("recharts-default-tooltip",C),W=er("recharts-tooltip-label",R);U&&O&&b!==void 0&&b!==null&&(F=O(N,b));var q=k?{role:"status","aria-live":"assertive"}:{};return me.createElement("div",mF({className:H,style:M},q),me.createElement("p",{className:W,style:D},me.isValidElement(F)?F:"".concat(F)),P())};function J0(e){"@babel/helpers - typeof";return J0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J0(e)}function iR(e,t,n){return t=Zct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zct(e){var t=Qct(e,"string");return J0(t)=="symbol"?t:t+""}function Qct(e,t){if(J0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(J0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EE="recharts-tooltip-wrapper",elt={visibility:"hidden"};function tlt(e){var t=e.coordinate,n=e.translateX,i=e.translateY;return er(EE,iR(iR(iR(iR({},"".concat(EE,"-right"),xt(n)&&t&&xt(t.x)&&n>=t.x),"".concat(EE,"-left"),xt(n)&&t&&xt(t.x)&&n<t.x),"".concat(EE,"-bottom"),xt(i)&&t&&xt(t.y)&&i>=t.y),"".concat(EE,"-top"),xt(i)&&t&&xt(t.y)&&i<t.y))}function dne(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.key,o=e.offsetTopLeft,u=e.position,h=e.reverseDirection,p=e.tooltipDimension,g=e.viewBox,v=e.viewBoxDimension;if(u&&xt(u[i]))return u[i];var b=n[i]-p-o,E=n[i]+o;if(t[i])return h[i]?b:E;if(h[i]){var T=b,C=g[i];return T<C?Math.max(E,g[i]):Math.max(b,g[i])}var R=E+p,N=g[i]+v;return R>N?Math.max(b,g[i]):Math.max(E,g[i])}function nlt(e){var t=e.translateX,n=e.translateY,i=e.useTranslate3d;return{transform:i?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function rlt(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.offsetTopLeft,o=e.position,u=e.reverseDirection,h=e.tooltipBox,p=e.useTranslate3d,g=e.viewBox,v,b,E;return h.height>0&&h.width>0&&n?(b=dne({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:i,position:o,reverseDirection:u,tooltipDimension:h.width,viewBox:g,viewBoxDimension:g.width}),E=dne({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:i,position:o,reverseDirection:u,tooltipDimension:h.height,viewBox:g,viewBoxDimension:g.height}),v=nlt({translateX:b,translateY:E,useTranslate3d:p})):v=elt,{cssProperties:v,cssClasses:tlt({translateX:b,translateY:E,coordinate:n})}}function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function hne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function fne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hne(Object(n),!0).forEach(function(i){vF(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function ilt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function alt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,qme(i.key),i)}}function slt(e,t,n){return t&&alt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function olt(e,t,n){return t=mA(t),clt(e,Kme()?Reflect.construct(t,n||[],mA(e).constructor):t.apply(e,n))}function clt(e,t){if(t&&(Sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return llt(e)}function llt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kme=function(){return!!e})()}function mA(e){return mA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mA(e)}function ult(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gF(e,t)}function gF(e,t){return gF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},gF(e,t)}function vF(e,t,n){return t=qme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qme(e){var t=dlt(e,"string");return Sy(t)=="symbol"?t:t+""}function dlt(e,t){if(Sy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Sy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pne=1,hlt=function(e){function t(){var n;ilt(this,t);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return n=olt(this,t,[].concat(o)),vF(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),vF(n,"handleKeyDown",function(h){if(h.key==="Escape"){var p,g,v,b;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(p=(g=n.props.coordinate)===null||g===void 0?void 0:g.x)!==null&&p!==void 0?p:0,y:(v=(b=n.props.coordinate)===null||b===void 0?void 0:b.y)!==null&&v!==void 0?v:0}})}}),n}return ult(t,e),slt(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>pne||Math.abs(i.height-this.state.lastBoundingBox.height)>pne)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,o=this.props,u=o.active,h=o.allowEscapeViewBox,p=o.animationDuration,g=o.animationEasing,v=o.children,b=o.coordinate,E=o.hasPayload,T=o.isAnimationActive,C=o.offset,R=o.position,N=o.reverseDirection,O=o.useTranslate3d,j=o.viewBox,k=o.wrapperStyle,P=rlt({allowEscapeViewBox:h,coordinate:b,offsetTopLeft:C,position:R,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:O,viewBox:j}),M=P.cssClasses,D=P.cssProperties,U=fne(fne({transition:T&&u?"transform ".concat(p,"ms ").concat(g):void 0},D),{},{pointerEvents:"none",visibility:!this.state.dismissed&&u&&E?"visible":"hidden",position:"absolute",top:0,left:0},k);return me.createElement("div",{tabIndex:-1,className:M,style:U,ref:function(H){i.wrapperNode=H}},v)}}])}(w.PureComponent),flt=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},lS={isSsr:flt()};function xy(e){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function mne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function gne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mne(Object(n),!0).forEach(function(i){f3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function plt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mlt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Xme(i.key),i)}}function glt(e,t,n){return t&&mlt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vlt(e,t,n){return t=gA(t),ylt(e,Yme()?Reflect.construct(t,n||[],gA(e).constructor):t.apply(e,n))}function ylt(e,t){if(t&&(xy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _lt(e)}function _lt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yme=function(){return!!e})()}function gA(e){return gA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},gA(e)}function blt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yF(e,t)}function yF(e,t){return yF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},yF(e,t)}function f3(e,t,n){return t=Xme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xme(e){var t=Elt(e,"string");return xy(t)=="symbol"?t:t+""}function Elt(e,t){if(xy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(xy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function wlt(e){return e.dataKey}function Slt(e,t){return me.isValidElement(e)?me.cloneElement(e,t):typeof e=="function"?me.createElement(e,t):me.createElement(Jct,t)}var Nc=function(e){function t(){return plt(this,t),vlt(this,t,arguments)}return blt(t,e),glt(t,[{key:"render",value:function(){var i=this,o=this.props,u=o.active,h=o.allowEscapeViewBox,p=o.animationDuration,g=o.animationEasing,v=o.content,b=o.coordinate,E=o.filterNull,T=o.isAnimationActive,C=o.offset,R=o.payload,N=o.payloadUniqBy,O=o.position,j=o.reverseDirection,k=o.useTranslate3d,P=o.viewBox,M=o.wrapperStyle,D=R??[];E&&D.length&&(D=Fme(R.filter(function(F){return F.value!=null&&(F.hide!==!0||i.props.includeHidden)}),N,wlt));var U=D.length>0;return me.createElement(hlt,{allowEscapeViewBox:h,animationDuration:p,animationEasing:g,isAnimationActive:T,active:u,coordinate:b,hasPayload:U,offset:C,position:O,reverseDirection:j,useTranslate3d:k,viewBox:P,wrapperStyle:M},Slt(v,gne(gne({},this.props),{},{payload:D})))}}])}(w.PureComponent);f3(Nc,"displayName","Tooltip");f3(Nc,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!lS.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var xlt=Yu,Tlt=function(){return xlt.Date.now()},Clt=Tlt,Rlt=/\s/;function Nlt(e){for(var t=e.length;t--&&Rlt.test(e.charAt(t)););return t}var Alt=Nlt,Ilt=Alt,Olt=/^\s+/;function Plt(e){return e&&e.slice(0,Ilt(e)+1).replace(Olt,"")}var klt=Plt,jlt=klt,vne=Mf,Dlt=c_,yne=NaN,Llt=/^[-+]0x[0-9a-f]+$/i,Mlt=/^0b[01]+$/i,Ult=/^0o[0-7]+$/i,Flt=parseInt;function Vlt(e){if(typeof e=="number")return e;if(Dlt(e))return yne;if(vne(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=vne(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=jlt(e);var n=Mlt.test(e);return n||Ult.test(e)?Flt(e.slice(2),n?2:8):Llt.test(e)?yne:+e}var Jme=Vlt,Blt=Mf,ML=Clt,_ne=Jme,$lt="Expected a function",Wlt=Math.max,Glt=Math.min;function Hlt(e,t,n){var i,o,u,h,p,g,v=0,b=!1,E=!1,T=!0;if(typeof e!="function")throw new TypeError($lt);t=_ne(t)||0,Blt(n)&&(b=!!n.leading,E="maxWait"in n,u=E?Wlt(_ne(n.maxWait)||0,t):u,T="trailing"in n?!!n.trailing:T);function C(U){var F=i,H=o;return i=o=void 0,v=U,h=e.apply(H,F),h}function R(U){return v=U,p=setTimeout(j,t),b?C(U):h}function N(U){var F=U-g,H=U-v,W=t-F;return E?Glt(W,u-H):W}function O(U){var F=U-g,H=U-v;return g===void 0||F>=t||F<0||E&&H>=u}function j(){var U=ML();if(O(U))return k(U);p=setTimeout(j,N(U))}function k(U){return p=void 0,T&&i?C(U):(i=o=void 0,h)}function P(){p!==void 0&&clearTimeout(p),v=0,i=g=o=p=void 0}function M(){return p===void 0?h:k(ML())}function D(){var U=ML(),F=O(U);if(i=arguments,o=this,g=U,F){if(p===void 0)return R(g);if(E)return clearTimeout(p),p=setTimeout(j,t),C(g)}return p===void 0&&(p=setTimeout(j,t)),h}return D.cancel=P,D.flush=M,D}var zlt=Hlt,Klt=zlt,qlt=Mf,Ylt="Expected a function";function Xlt(e,t,n){var i=!0,o=!0;if(typeof e!="function")throw new TypeError(Ylt);return qlt(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),Klt(e,t,{leading:i,maxWait:t,trailing:o})}var Jlt=Xlt;const Zme=jr(Jlt);function Z0(e){"@babel/helpers - typeof";return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}function bne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function aR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bne(Object(n),!0).forEach(function(i){Zlt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Zlt(e,t,n){return t=Qlt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qlt(e){var t=eut(e,"string");return Z0(t)=="symbol"?t:t+""}function eut(e,t){if(Z0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Z0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tut(e,t){return aut(e)||iut(e,t)||rut(e,t)||nut()}function nut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rut(e,t){if(e){if(typeof e=="string")return Ene(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ene(e,t)}}function Ene(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function iut(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function aut(e){if(Array.isArray(e))return e}var p3=w.forwardRef(function(e,t){var n=e.aspect,i=e.initialDimension,o=i===void 0?{width:-1,height:-1}:i,u=e.width,h=u===void 0?"100%":u,p=e.height,g=p===void 0?"100%":p,v=e.minWidth,b=v===void 0?0:v,E=e.minHeight,T=e.maxHeight,C=e.children,R=e.debounce,N=R===void 0?0:R,O=e.id,j=e.className,k=e.onResize,P=e.style,M=P===void 0?{}:P,D=w.useRef(null),U=w.useRef();U.current=k,w.useImperativeHandle(t,function(){return Object.defineProperty(D.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),D.current},configurable:!0})});var F=w.useState({containerWidth:o.width,containerHeight:o.height}),H=tut(F,2),W=H[0],q=H[1],Y=w.useCallback(function(Z,X){q(function(ae){var se=Math.round(Z),J=Math.round(X);return ae.containerWidth===se&&ae.containerHeight===J?ae:{containerWidth:se,containerHeight:J}})},[]);w.useEffect(function(){var Z=function(ee){var de,xe=ee[0].contentRect,ve=xe.width,Te=xe.height;Y(ve,Te),(de=U.current)===null||de===void 0||de.call(U,ve,Te)};N>0&&(Z=Zme(Z,N,{trailing:!0,leading:!1}));var X=new ResizeObserver(Z),ae=D.current.getBoundingClientRect(),se=ae.width,J=ae.height;return Y(se,J),X.observe(D.current),function(){X.disconnect()}},[Y,N]);var z=w.useMemo(function(){var Z=W.containerWidth,X=W.containerHeight;if(Z<0||X<0)return null;Pd(Bp(h)||Bp(g),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,g),Pd(!n||n>0,"The aspect(%s) must be greater than zero.",n);var ae=Bp(h)?Z:h,se=Bp(g)?X:g;n&&n>0&&(ae?se=ae/n:se&&(ae=se*n),T&&se>T&&(se=T)),Pd(ae>0||se>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ae,se,h,g,b,E,n);var J=!Array.isArray(C)&&Od(C.type).endsWith("Chart");return me.Children.map(C,function(re){return me.isValidElement(re)?w.cloneElement(re,aR({width:ae,height:se},J?{style:aR({height:"100%",width:"100%",maxHeight:se,maxWidth:ae},re.props.style)}:{})):re})},[n,C,g,T,E,b,W,h]);return me.createElement("div",{id:O?"".concat(O):void 0,className:er("recharts-responsive-container",j),style:aR(aR({},M),{},{width:h,height:g,minWidth:b,minHeight:E,maxHeight:T}),ref:D},z)}),Qme=function(t){return null};Qme.displayName="Cell";function Q0(e){"@babel/helpers - typeof";return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(e)}function wne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function _F(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wne(Object(n),!0).forEach(function(i){sut(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function sut(e,t,n){return t=out(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function out(e){var t=cut(e,"string");return Q0(t)=="symbol"?t:t+""}function cut(e,t){if(Q0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Q0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uv={widthCache:{},cacheCount:0},lut=2e3,uut={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Sne="recharts_measurement_span";function dut(e){var t=_F({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var n0=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||lS.isSsr)return{width:0,height:0};var i=dut(n),o=JSON.stringify({text:t,copyStyle:i});if(uv.widthCache[o])return uv.widthCache[o];try{var u=document.getElementById(Sne);u||(u=document.createElement("span"),u.setAttribute("id",Sne),u.setAttribute("aria-hidden","true"),document.body.appendChild(u));var h=_F(_F({},uut),i);Object.assign(u.style,h),u.textContent="".concat(t);var p=u.getBoundingClientRect(),g={width:p.width,height:p.height};return uv.widthCache[o]=g,++uv.cacheCount>lut&&(uv.cacheCount=0,uv.widthCache={}),g}catch{return{width:0,height:0}}},hut=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function ew(e){"@babel/helpers - typeof";return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}function vA(e,t){return gut(e)||mut(e,t)||put(e,t)||fut()}function fut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function put(e,t){if(e){if(typeof e=="string")return xne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xne(e,t)}}function xne(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function mut(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function gut(e){if(Array.isArray(e))return e}function vut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_ut(i.key),i)}}function yut(e,t,n){return t&&Tne(e.prototype,t),n&&Tne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ut(e){var t=but(e,"string");return ew(t)=="symbol"?t:t+""}function but(e,t){if(ew(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(ew(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Cne=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Rne=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Eut=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,wut=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,ege={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Sut=Object.keys(ege),Nv="NaN";function xut(e,t){return e*ege[t]}var sR=function(){function e(t,n){vut(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!Eut.test(n)&&(this.num=NaN,this.unit=""),Sut.includes(n)&&(this.num=xut(t,n),this.unit="px")}return yut(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var i,o=(i=wut.exec(n))!==null&&i!==void 0?i:[],u=vA(o,3),h=u[1],p=u[2];return new e(parseFloat(h),p??"")}}])}();function tge(e){if(e.includes(Nv))return Nv;for(var t=e;t.includes("*")||t.includes("/");){var n,i=(n=Cne.exec(t))!==null&&n!==void 0?n:[],o=vA(i,4),u=o[1],h=o[2],p=o[3],g=sR.parse(u??""),v=sR.parse(p??""),b=h==="*"?g.multiply(v):g.divide(v);if(b.isNaN())return Nv;t=t.replace(Cne,b.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var E,T=(E=Rne.exec(t))!==null&&E!==void 0?E:[],C=vA(T,4),R=C[1],N=C[2],O=C[3],j=sR.parse(R??""),k=sR.parse(O??""),P=N==="+"?j.add(k):j.subtract(k);if(P.isNaN())return Nv;t=t.replace(Rne,P.toString())}return t}var Nne=/\(([^()]*)\)/;function Tut(e){for(var t=e;t.includes("(");){var n=Nne.exec(t),i=vA(n,2),o=i[1];t=t.replace(Nne,tge(o))}return t}function Cut(e){var t=e.replace(/\s+/g,"");return t=Tut(t),t=tge(t),t}function Rut(e){try{return Cut(e)}catch{return Nv}}function UL(e){var t=Rut(e.slice(5,-1));return t===Nv?"":t}var Nut=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Aut=["dx","dy","angle","className","breakAll"];function bF(){return bF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bF.apply(this,arguments)}function Ane(e,t){if(e==null)return{};var n=Iut(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Iut(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Ine(e,t){return jut(e)||kut(e,t)||Put(e,t)||Out()}function Out(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Put(e,t){if(e){if(typeof e=="string")return One(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return One(e,t)}}function One(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function kut(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;g=!1}else for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function jut(e){if(Array.isArray(e))return e}var nge=/[ \f\n\r\t\v\u2028\u2029]+/,rge=function(t){var n=t.children,i=t.breakAll,o=t.style;try{var u=[];Nr(n)||(i?u=n.toString().split(""):u=n.toString().split(nge));var h=u.map(function(g){return{word:g,width:n0(g,o).width}}),p=i?0:n0(" ",o).width;return{wordsWithComputedWidth:h,spaceWidth:p}}catch{return null}},Dut=function(t,n,i,o,u){var h=t.maxLines,p=t.children,g=t.style,v=t.breakAll,b=xt(h),E=p,T=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ae.reduce(function(se,J){var re=J.word,ee=J.width,de=se[se.length-1];if(de&&(o==null||u||de.width+ee+i<Number(o)))de.words.push(re),de.width+=ee+i;else{var xe={words:[re],width:ee};se.push(xe)}return se},[])},C=T(n),R=function(ae){return ae.reduce(function(se,J){return se.width>J.width?se:J})};if(!b)return C;for(var N="…",O=function(ae){var se=E.slice(0,ae),J=rge({breakAll:v,style:g,children:se+N}).wordsWithComputedWidth,re=T(J),ee=re.length>h||R(re).width>Number(o);return[ee,re]},j=0,k=E.length-1,P=0,M;j<=k&&P<=E.length-1;){var D=Math.floor((j+k)/2),U=D-1,F=O(U),H=Ine(F,2),W=H[0],q=H[1],Y=O(D),z=Ine(Y,1),Z=z[0];if(!W&&!Z&&(j=D+1),W&&Z&&(k=D-1),!W&&Z){M=q;break}P++}return M||C},Pne=function(t){var n=Nr(t)?[]:t.toString().split(nge);return[{words:n}]},Lut=function(t){var n=t.width,i=t.scaleToFit,o=t.children,u=t.style,h=t.breakAll,p=t.maxLines;if((n||i)&&!lS.isSsr){var g,v,b=rge({breakAll:h,children:o,style:u});if(b){var E=b.wordsWithComputedWidth,T=b.spaceWidth;g=E,v=T}else return Pne(o);return Dut({breakAll:h,children:o,maxLines:p,style:u},g,v,n,i)}return Pne(o)},kne="#808080",yA=function(t){var n=t.x,i=n===void 0?0:n,o=t.y,u=o===void 0?0:o,h=t.lineHeight,p=h===void 0?"1em":h,g=t.capHeight,v=g===void 0?"0.71em":g,b=t.scaleToFit,E=b===void 0?!1:b,T=t.textAnchor,C=T===void 0?"start":T,R=t.verticalAnchor,N=R===void 0?"end":R,O=t.fill,j=O===void 0?kne:O,k=Ane(t,Nut),P=w.useMemo(function(){return Lut({breakAll:k.breakAll,children:k.children,maxLines:k.maxLines,scaleToFit:E,style:k.style,width:k.width})},[k.breakAll,k.children,k.maxLines,E,k.style,k.width]),M=k.dx,D=k.dy,U=k.angle,F=k.className,H=k.breakAll,W=Ane(k,Aut);if(!Oa(i)||!Oa(u))return null;var q=i+(xt(M)?M:0),Y=u+(xt(D)?D:0),z;switch(N){case"start":z=UL("calc(".concat(v,")"));break;case"middle":z=UL("calc(".concat((P.length-1)/2," * -").concat(p," + (").concat(v," / 2))"));break;default:z=UL("calc(".concat(P.length-1," * -").concat(p,")"));break}var Z=[];if(E){var X=P[0].width,ae=k.width;Z.push("scale(".concat((xt(ae)?ae/X:1)/X,")"))}return U&&Z.push("rotate(".concat(U,", ").concat(q,", ").concat(Y,")")),Z.length&&(W.transform=Z.join(" ")),me.createElement("text",bF({},Tr(W,!0),{x:q,y:Y,className:er("recharts-text",F),textAnchor:C,fill:j.includes("url")?kne:j}),P.map(function(se,J){var re=se.words.join(H?"":" ");return me.createElement("tspan",{x:q,dy:J===0?z:p,key:"".concat(re,"-").concat(J)},re)}))};function mf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Mut(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function m3(e){let t,n,i;e.length!==2?(t=mf,n=(p,g)=>mf(e(p),g),i=(p,g)=>e(p)-g):(t=e===mf||e===Mut?e:Uut,n=e,i=e);function o(p,g,v=0,b=p.length){if(v<b){if(t(g,g)!==0)return b;do{const E=v+b>>>1;n(p[E],g)<0?v=E+1:b=E}while(v<b)}return v}function u(p,g,v=0,b=p.length){if(v<b){if(t(g,g)!==0)return b;do{const E=v+b>>>1;n(p[E],g)<=0?v=E+1:b=E}while(v<b)}return v}function h(p,g,v=0,b=p.length){const E=o(p,g,v,b-1);return E>v&&i(p[E-1],g)>-i(p[E],g)?E-1:E}return{left:o,center:h,right:u}}function Uut(){return 0}function ige(e){return e===null?NaN:+e}function*Fut(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const Vut=m3(mf),uS=Vut.right;m3(ige).center;class jne extends Map{constructor(t,n=Wut){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,o]of t)this.set(i,o)}get(t){return super.get(Dne(this,t))}has(t){return super.has(Dne(this,t))}set(t,n){return super.set(But(this,t),n)}delete(t){return super.delete($ut(this,t))}}function Dne({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function But({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function $ut({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function Wut(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Gut(e=mf){if(e===mf)return age;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function age(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Hut=Math.sqrt(50),zut=Math.sqrt(10),Kut=Math.sqrt(2);function _A(e,t,n){const i=(t-e)/Math.max(0,n),o=Math.floor(Math.log10(i)),u=i/Math.pow(10,o),h=u>=Hut?10:u>=zut?5:u>=Kut?2:1;let p,g,v;return o<0?(v=Math.pow(10,-o)/h,p=Math.round(e*v),g=Math.round(t*v),p/v<e&&++p,g/v>t&&--g,v=-v):(v=Math.pow(10,o)*h,p=Math.round(e/v),g=Math.round(t/v),p*v<e&&++p,g*v>t&&--g),g<p&&.5<=n&&n<2?_A(e,t,n*2):[p,g,v]}function EF(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[o,u,h]=i?_A(t,e,n):_A(e,t,n);if(!(u>=o))return[];const p=u-o+1,g=new Array(p);if(i)if(h<0)for(let v=0;v<p;++v)g[v]=(u-v)/-h;else for(let v=0;v<p;++v)g[v]=(u-v)*h;else if(h<0)for(let v=0;v<p;++v)g[v]=(o+v)/-h;else for(let v=0;v<p;++v)g[v]=(o+v)*h;return g}function wF(e,t,n){return t=+t,e=+e,n=+n,_A(e,t,n)[2]}function SF(e,t,n){t=+t,e=+e,n=+n;const i=t<e,o=i?wF(t,e,n):wF(e,t,n);return(i?-1:1)*(o<0?1/-o:o)}function Lne(e,t){let n;for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function Mne(e,t){let n;for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function sge(e,t,n=0,i=1/0,o){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(o=o===void 0?age:Gut(o);i>n;){if(i-n>600){const g=i-n+1,v=t-n+1,b=Math.log(g),E=.5*Math.exp(2*b/3),T=.5*Math.sqrt(b*E*(g-E)/g)*(v-g/2<0?-1:1),C=Math.max(n,Math.floor(t-v*E/g+T)),R=Math.min(i,Math.floor(t+(g-v)*E/g+T));sge(e,t,C,R,o)}const u=e[t];let h=n,p=i;for(wE(e,n,t),o(e[i],u)>0&&wE(e,n,i);h<p;){for(wE(e,h,p),++h,--p;o(e[h],u)<0;)++h;for(;o(e[p],u)>0;)--p}o(e[n],u)===0?wE(e,n,p):(++p,wE(e,p,i)),p<=t&&(n=p+1),t<=p&&(i=p-1)}return e}function wE(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function qut(e,t,n){if(e=Float64Array.from(Fut(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return Mne(e);if(t>=1)return Lne(e);var i,o=(i-1)*t,u=Math.floor(o),h=Lne(sge(e,u).subarray(0,u+1)),p=Mne(e.subarray(u+1));return h+(p-h)*(o-u)}}function Yut(e,t,n=ige){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,o=(i-1)*t,u=Math.floor(o),h=+n(e[u],u,e),p=+n(e[u+1],u+1,e);return h+(p-h)*(o-u)}}function Xut(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var i=-1,o=Math.max(0,Math.ceil((t-e)/n))|0,u=new Array(o);++i<o;)u[i]=e+i*n;return u}function Hc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Zd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const xF=Symbol("implicit");function g3(){var e=new jne,t=[],n=[],i=xF;function o(u){let h=e.get(u);if(h===void 0){if(i!==xF)return i;e.set(u,h=t.push(u)-1)}return n[h%n.length]}return o.domain=function(u){if(!arguments.length)return t.slice();t=[],e=new jne;for(const h of u)e.has(h)||e.set(h,t.push(h)-1);return o},o.range=function(u){return arguments.length?(n=Array.from(u),o):n.slice()},o.unknown=function(u){return arguments.length?(i=u,o):i},o.copy=function(){return g3(t,n).unknown(i)},Hc.apply(o,arguments),o}function tw(){var e=g3().unknown(void 0),t=e.domain,n=e.range,i=0,o=1,u,h,p=!1,g=0,v=0,b=.5;delete e.unknown;function E(){var T=t().length,C=o<i,R=C?o:i,N=C?i:o;u=(N-R)/Math.max(1,T-g+v*2),p&&(u=Math.floor(u)),R+=(N-R-u*(T-g))*b,h=u*(1-g),p&&(R=Math.round(R),h=Math.round(h));var O=Xut(T).map(function(j){return R+u*j});return n(C?O.reverse():O)}return e.domain=function(T){return arguments.length?(t(T),E()):t()},e.range=function(T){return arguments.length?([i,o]=T,i=+i,o=+o,E()):[i,o]},e.rangeRound=function(T){return[i,o]=T,i=+i,o=+o,p=!0,E()},e.bandwidth=function(){return h},e.step=function(){return u},e.round=function(T){return arguments.length?(p=!!T,E()):p},e.padding=function(T){return arguments.length?(g=Math.min(1,v=+T),E()):g},e.paddingInner=function(T){return arguments.length?(g=Math.min(1,T),E()):g},e.paddingOuter=function(T){return arguments.length?(v=+T,E()):v},e.align=function(T){return arguments.length?(b=Math.max(0,Math.min(1,T)),E()):b},e.copy=function(){return tw(t(),[i,o]).round(p).paddingInner(g).paddingOuter(v).align(b)},Hc.apply(E(),arguments)}function oge(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return oge(t())},e}function r0(){return oge(tw.apply(null,arguments).paddingInner(1))}function v3(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function cge(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function dS(){}var nw=.7,bA=1/nw,Wv="\\s*([+-]?\\d+)\\s*",rw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jut=/^#([0-9a-f]{3,8})$/,Zut=new RegExp(`^rgb\\(${Wv},${Wv},${Wv}\\)$`),Qut=new RegExp(`^rgb\\(${Mu},${Mu},${Mu}\\)$`),edt=new RegExp(`^rgba\\(${Wv},${Wv},${Wv},${rw}\\)$`),tdt=new RegExp(`^rgba\\(${Mu},${Mu},${Mu},${rw}\\)$`),ndt=new RegExp(`^hsl\\(${rw},${Mu},${Mu}\\)$`),rdt=new RegExp(`^hsla\\(${rw},${Mu},${Mu},${rw}\\)$`),Une={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};v3(dS,iw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Fne,formatHex:Fne,formatHex8:idt,formatHsl:adt,formatRgb:Vne,toString:Vne});function Fne(){return this.rgb().formatHex()}function idt(){return this.rgb().formatHex8()}function adt(){return lge(this).formatHsl()}function Vne(){return this.rgb().formatRgb()}function iw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Jut.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Bne(t):n===3?new lo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?oR(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?oR(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Zut.exec(e))?new lo(t[1],t[2],t[3],1):(t=Qut.exec(e))?new lo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=edt.exec(e))?oR(t[1],t[2],t[3],t[4]):(t=tdt.exec(e))?oR(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ndt.exec(e))?Gne(t[1],t[2]/100,t[3]/100,1):(t=rdt.exec(e))?Gne(t[1],t[2]/100,t[3]/100,t[4]):Une.hasOwnProperty(e)?Bne(Une[e]):e==="transparent"?new lo(NaN,NaN,NaN,0):null}function Bne(e){return new lo(e>>16&255,e>>8&255,e&255,1)}function oR(e,t,n,i){return i<=0&&(e=t=n=NaN),new lo(e,t,n,i)}function sdt(e){return e instanceof dS||(e=iw(e)),e?(e=e.rgb(),new lo(e.r,e.g,e.b,e.opacity)):new lo}function TF(e,t,n,i){return arguments.length===1?sdt(e):new lo(e,t,n,i??1)}function lo(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}v3(lo,TF,cge(dS,{brighter(e){return e=e==null?bA:Math.pow(bA,e),new lo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?nw:Math.pow(nw,e),new lo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new lo(Qp(this.r),Qp(this.g),Qp(this.b),EA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$ne,formatHex:$ne,formatHex8:odt,formatRgb:Wne,toString:Wne}));function $ne(){return`#${$p(this.r)}${$p(this.g)}${$p(this.b)}`}function odt(){return`#${$p(this.r)}${$p(this.g)}${$p(this.b)}${$p((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wne(){const e=EA(this.opacity);return`${e===1?"rgb(":"rgba("}${Qp(this.r)}, ${Qp(this.g)}, ${Qp(this.b)}${e===1?")":`, ${e})`}`}function EA(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $p(e){return e=Qp(e),(e<16?"0":"")+e.toString(16)}function Gne(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Pl(e,t,n,i)}function lge(e){if(e instanceof Pl)return new Pl(e.h,e.s,e.l,e.opacity);if(e instanceof dS||(e=iw(e)),!e)return new Pl;if(e instanceof Pl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,o=Math.min(t,n,i),u=Math.max(t,n,i),h=NaN,p=u-o,g=(u+o)/2;return p?(t===u?h=(n-i)/p+(n<i)*6:n===u?h=(i-t)/p+2:h=(t-n)/p+4,p/=g<.5?u+o:2-u-o,h*=60):p=g>0&&g<1?0:h,new Pl(h,p,g,e.opacity)}function cdt(e,t,n,i){return arguments.length===1?lge(e):new Pl(e,t,n,i??1)}function Pl(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}v3(Pl,cdt,cge(dS,{brighter(e){return e=e==null?bA:Math.pow(bA,e),new Pl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?nw:Math.pow(nw,e),new Pl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,o=2*n-i;return new lo(FL(e>=240?e-240:e+120,o,i),FL(e,o,i),FL(e<120?e+240:e-120,o,i),this.opacity)},clamp(){return new Pl(Hne(this.h),cR(this.s),cR(this.l),EA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=EA(this.opacity);return`${e===1?"hsl(":"hsla("}${Hne(this.h)}, ${cR(this.s)*100}%, ${cR(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hne(e){return e=(e||0)%360,e<0?e+360:e}function cR(e){return Math.max(0,Math.min(1,e||0))}function FL(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const y3=e=>()=>e;function ldt(e,t){return function(n){return e+n*t}}function udt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ddt(e){return(e=+e)==1?uge:function(t,n){return n-t?udt(t,n,e):y3(isNaN(t)?n:t)}}function uge(e,t){var n=t-e;return n?ldt(e,n):y3(isNaN(e)?t:e)}const zne=function e(t){var n=ddt(t);function i(o,u){var h=n((o=TF(o)).r,(u=TF(u)).r),p=n(o.g,u.g),g=n(o.b,u.b),v=uge(o.opacity,u.opacity);return function(b){return o.r=h(b),o.g=p(b),o.b=g(b),o.opacity=v(b),o+""}}return i.gamma=e,i}(1);function hdt(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),o;return function(u){for(o=0;o<n;++o)i[o]=e[o]*(1-u)+t[o]*u;return i}}function fdt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function pdt(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,o=new Array(i),u=new Array(n),h;for(h=0;h<i;++h)o[h]=g_(e[h],t[h]);for(;h<n;++h)u[h]=t[h];return function(p){for(h=0;h<i;++h)u[h]=o[h](p);return u}}function mdt(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function wA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function gdt(e,t){var n={},i={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=g_(e[o],t[o]):i[o]=t[o];return function(u){for(o in n)i[o]=n[o](u);return i}}var CF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,VL=new RegExp(CF.source,"g");function vdt(e){return function(){return e}}function ydt(e){return function(t){return e(t)+""}}function _dt(e,t){var n=CF.lastIndex=VL.lastIndex=0,i,o,u,h=-1,p=[],g=[];for(e=e+"",t=t+"";(i=CF.exec(e))&&(o=VL.exec(t));)(u=o.index)>n&&(u=t.slice(n,u),p[h]?p[h]+=u:p[++h]=u),(i=i[0])===(o=o[0])?p[h]?p[h]+=o:p[++h]=o:(p[++h]=null,g.push({i:h,x:wA(i,o)})),n=VL.lastIndex;return n<t.length&&(u=t.slice(n),p[h]?p[h]+=u:p[++h]=u),p.length<2?g[0]?ydt(g[0].x):vdt(t):(t=g.length,function(v){for(var b=0,E;b<t;++b)p[(E=g[b]).i]=E.x(v);return p.join("")})}function g_(e,t){var n=typeof t,i;return t==null||n==="boolean"?y3(t):(n==="number"?wA:n==="string"?(i=iw(t))?(t=i,zne):_dt:t instanceof iw?zne:t instanceof Date?mdt:fdt(t)?hdt:Array.isArray(t)?pdt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?gdt:wA)(e,t)}function _3(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function bdt(e,t){t===void 0&&(t=e,e=g_);for(var n=0,i=t.length-1,o=t[0],u=new Array(i<0?0:i);n<i;)u[n]=e(o,o=t[++n]);return function(h){var p=Math.max(0,Math.min(i-1,Math.floor(h*=i)));return u[p](h-p)}}function Edt(e){return function(){return e}}function SA(e){return+e}var Kne=[0,1];function Ds(e){return e}function RF(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Edt(isNaN(t)?NaN:.5)}function wdt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function Sdt(e,t,n){var i=e[0],o=e[1],u=t[0],h=t[1];return o<i?(i=RF(o,i),u=n(h,u)):(i=RF(i,o),u=n(u,h)),function(p){return u(i(p))}}function xdt(e,t,n){var i=Math.min(e.length,t.length)-1,o=new Array(i),u=new Array(i),h=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<i;)o[h]=RF(e[h],e[h+1]),u[h]=n(t[h],t[h+1]);return function(p){var g=uS(e,p,1,i)-1;return u[g](o[g](p))}}function hS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function qI(){var e=Kne,t=Kne,n=g_,i,o,u,h=Ds,p,g,v;function b(){var T=Math.min(e.length,t.length);return h!==Ds&&(h=wdt(e[0],e[T-1])),p=T>2?xdt:Sdt,g=v=null,E}function E(T){return T==null||isNaN(T=+T)?u:(g||(g=p(e.map(i),t,n)))(i(h(T)))}return E.invert=function(T){return h(o((v||(v=p(t,e.map(i),wA)))(T)))},E.domain=function(T){return arguments.length?(e=Array.from(T,SA),b()):e.slice()},E.range=function(T){return arguments.length?(t=Array.from(T),b()):t.slice()},E.rangeRound=function(T){return t=Array.from(T),n=_3,b()},E.clamp=function(T){return arguments.length?(h=T?!0:Ds,b()):h!==Ds},E.interpolate=function(T){return arguments.length?(n=T,b()):n},E.unknown=function(T){return arguments.length?(u=T,E):u},function(T,C){return i=T,o=C,b()}}function b3(){return qI()(Ds,Ds)}function Tdt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function xA(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Ty(e){return e=xA(Math.abs(e)),e?e[1]:NaN}function Cdt(e,t){return function(n,i){for(var o=n.length,u=[],h=0,p=e[0],g=0;o>0&&p>0&&(g+p+1>i&&(p=Math.max(1,i-g)),u.push(n.substring(o-=p,o+p)),!((g+=p+1)>i));)p=e[h=(h+1)%e.length];return u.reverse().join(t)}}function Rdt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Ndt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function aw(e){if(!(t=Ndt.exec(e)))throw new Error("invalid format: "+e);var t;return new E3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}aw.prototype=E3.prototype;function E3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}E3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Adt(e){e:for(var t=e.length,n=1,i=-1,o;n<t;++n)switch(e[n]){case".":i=o=n;break;case"0":i===0&&(i=n),o=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(o+1):e}var dge;function Idt(e,t){var n=xA(e,t);if(!n)return e+"";var i=n[0],o=n[1],u=o-(dge=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,h=i.length;return u===h?i:u>h?i+new Array(u-h+1).join("0"):u>0?i.slice(0,u)+"."+i.slice(u):"0."+new Array(1-u).join("0")+xA(e,Math.max(0,t+u-1))[0]}function qne(e,t){var n=xA(e,t);if(!n)return e+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")}const Yne={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Tdt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>qne(e*100,t),r:qne,s:Idt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Xne(e){return e}var Jne=Array.prototype.map,Zne=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Odt(e){var t=e.grouping===void 0||e.thousands===void 0?Xne:Cdt(Jne.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",u=e.numerals===void 0?Xne:Rdt(Jne.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",p=e.minus===void 0?"−":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function v(E){E=aw(E);var T=E.fill,C=E.align,R=E.sign,N=E.symbol,O=E.zero,j=E.width,k=E.comma,P=E.precision,M=E.trim,D=E.type;D==="n"?(k=!0,D="g"):Yne[D]||(P===void 0&&(P=12),M=!0,D="g"),(O||T==="0"&&C==="=")&&(O=!0,T="0",C="=");var U=N==="$"?n:N==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",F=N==="$"?i:/[%p]/.test(D)?h:"",H=Yne[D],W=/[defgprs%]/.test(D);P=P===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,P)):Math.max(0,Math.min(20,P));function q(Y){var z=U,Z=F,X,ae,se;if(D==="c")Z=H(Y)+Z,Y="";else{Y=+Y;var J=Y<0||1/Y<0;if(Y=isNaN(Y)?g:H(Math.abs(Y),P),M&&(Y=Adt(Y)),J&&+Y==0&&R!=="+"&&(J=!1),z=(J?R==="("?R:p:R==="-"||R==="("?"":R)+z,Z=(D==="s"?Zne[8+dge/3]:"")+Z+(J&&R==="("?")":""),W){for(X=-1,ae=Y.length;++X<ae;)if(se=Y.charCodeAt(X),48>se||se>57){Z=(se===46?o+Y.slice(X+1):Y.slice(X))+Z,Y=Y.slice(0,X);break}}}k&&!O&&(Y=t(Y,1/0));var re=z.length+Y.length+Z.length,ee=re<j?new Array(j-re+1).join(T):"";switch(k&&O&&(Y=t(ee+Y,ee.length?j-Z.length:1/0),ee=""),C){case"<":Y=z+Y+Z+ee;break;case"=":Y=z+ee+Y+Z;break;case"^":Y=ee.slice(0,re=ee.length>>1)+z+Y+Z+ee.slice(re);break;default:Y=ee+z+Y+Z;break}return u(Y)}return q.toString=function(){return E+""},q}function b(E,T){var C=v((E=aw(E),E.type="f",E)),R=Math.max(-8,Math.min(8,Math.floor(Ty(T)/3)))*3,N=Math.pow(10,-R),O=Zne[8+R/3];return function(j){return C(N*j)+O}}return{format:v,formatPrefix:b}}var lR,w3,hge;Pdt({thousands:",",grouping:[3],currency:["$",""]});function Pdt(e){return lR=Odt(e),w3=lR.format,hge=lR.formatPrefix,lR}function kdt(e){return Math.max(0,-Ty(Math.abs(e)))}function jdt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ty(t)/3)))*3-Ty(Math.abs(e)))}function Ddt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ty(t)-Ty(e))+1}function fge(e,t,n,i){var o=SF(e,t,n),u;switch(i=aw(i??",f"),i.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(u=jdt(o,h))&&(i.precision=u),hge(i,h)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(u=Ddt(o,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=u-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(u=kdt(o))&&(i.precision=u-(i.type==="%")*2);break}}return w3(i)}function Ff(e){var t=e.domain;return e.ticks=function(n){var i=t();return EF(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var o=t();return fge(o[0],o[o.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),o=0,u=i.length-1,h=i[o],p=i[u],g,v,b=10;for(p<h&&(v=h,h=p,p=v,v=o,o=u,u=v);b-- >0;){if(v=wF(h,p,n),v===g)return i[o]=h,i[u]=p,t(i);if(v>0)h=Math.floor(h/v)*v,p=Math.ceil(p/v)*v;else if(v<0)h=Math.ceil(h*v)/v,p=Math.floor(p*v)/v;else break;g=v}return e},e}function TA(){var e=b3();return e.copy=function(){return hS(e,TA())},Hc.apply(e,arguments),Ff(e)}function pge(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,SA),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return pge(e).unknown(t)},e=arguments.length?Array.from(e,SA):[0,1],Ff(n)}function mge(e,t){e=e.slice();var n=0,i=e.length-1,o=e[n],u=e[i],h;return u<o&&(h=n,n=i,i=h,h=o,o=u,u=h),e[n]=t.floor(o),e[i]=t.ceil(u),e}function Qne(e){return Math.log(e)}function ere(e){return Math.exp(e)}function Ldt(e){return-Math.log(-e)}function Mdt(e){return-Math.exp(-e)}function Udt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Fdt(e){return e===10?Udt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Vdt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function tre(e){return(t,n)=>-e(-t,n)}function S3(e){const t=e(Qne,ere),n=t.domain;let i=10,o,u;function h(){return o=Vdt(i),u=Fdt(i),n()[0]<0?(o=tre(o),u=tre(u),e(Ldt,Mdt)):e(Qne,ere),t}return t.base=function(p){return arguments.length?(i=+p,h()):i},t.domain=function(p){return arguments.length?(n(p),h()):n()},t.ticks=p=>{const g=n();let v=g[0],b=g[g.length-1];const E=b<v;E&&([v,b]=[b,v]);let T=o(v),C=o(b),R,N;const O=p==null?10:+p;let j=[];if(!(i%1)&&C-T<O){if(T=Math.floor(T),C=Math.ceil(C),v>0){for(;T<=C;++T)for(R=1;R<i;++R)if(N=T<0?R/u(-T):R*u(T),!(N<v)){if(N>b)break;j.push(N)}}else for(;T<=C;++T)for(R=i-1;R>=1;--R)if(N=T>0?R/u(-T):R*u(T),!(N<v)){if(N>b)break;j.push(N)}j.length*2<O&&(j=EF(v,b,O))}else j=EF(T,C,Math.min(C-T,O)).map(u);return E?j.reverse():j},t.tickFormat=(p,g)=>{if(p==null&&(p=10),g==null&&(g=i===10?"s":","),typeof g!="function"&&(!(i%1)&&(g=aw(g)).precision==null&&(g.trim=!0),g=w3(g)),p===1/0)return g;const v=Math.max(1,i*p/t.ticks().length);return b=>{let E=b/u(Math.round(o(b)));return E*i<i-.5&&(E*=i),E<=v?g(b):""}},t.nice=()=>n(mge(n(),{floor:p=>u(Math.floor(o(p))),ceil:p=>u(Math.ceil(o(p)))})),t}function gge(){const e=S3(qI()).domain([1,10]);return e.copy=()=>hS(e,gge()).base(e.base()),Hc.apply(e,arguments),e}function nre(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function rre(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function x3(e){var t=1,n=e(nre(t),rre(t));return n.constant=function(i){return arguments.length?e(nre(t=+i),rre(t)):t},Ff(n)}function vge(){var e=x3(qI());return e.copy=function(){return hS(e,vge()).constant(e.constant())},Hc.apply(e,arguments)}function ire(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Bdt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $dt(e){return e<0?-e*e:e*e}function T3(e){var t=e(Ds,Ds),n=1;function i(){return n===1?e(Ds,Ds):n===.5?e(Bdt,$dt):e(ire(n),ire(1/n))}return t.exponent=function(o){return arguments.length?(n=+o,i()):n},Ff(t)}function C3(){var e=T3(qI());return e.copy=function(){return hS(e,C3()).exponent(e.exponent())},Hc.apply(e,arguments),e}function Wdt(){return C3.apply(null,arguments).exponent(.5)}function are(e){return Math.sign(e)*e*e}function Gdt(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function yge(){var e=b3(),t=[0,1],n=!1,i;function o(u){var h=Gdt(e(u));return isNaN(h)?i:n?Math.round(h):h}return o.invert=function(u){return e.invert(are(u))},o.domain=function(u){return arguments.length?(e.domain(u),o):e.domain()},o.range=function(u){return arguments.length?(e.range((t=Array.from(u,SA)).map(are)),o):t.slice()},o.rangeRound=function(u){return o.range(u).round(!0)},o.round=function(u){return arguments.length?(n=!!u,o):n},o.clamp=function(u){return arguments.length?(e.clamp(u),o):e.clamp()},o.unknown=function(u){return arguments.length?(i=u,o):i},o.copy=function(){return yge(e.domain(),t).round(n).clamp(e.clamp()).unknown(i)},Hc.apply(o,arguments),Ff(o)}function _ge(){var e=[],t=[],n=[],i;function o(){var h=0,p=Math.max(1,t.length);for(n=new Array(p-1);++h<p;)n[h-1]=Yut(e,h/p);return u}function u(h){return h==null||isNaN(h=+h)?i:t[uS(n,h)]}return u.invertExtent=function(h){var p=t.indexOf(h);return p<0?[NaN,NaN]:[p>0?n[p-1]:e[0],p<n.length?n[p]:e[e.length-1]]},u.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let p of h)p!=null&&!isNaN(p=+p)&&e.push(p);return e.sort(mf),o()},u.range=function(h){return arguments.length?(t=Array.from(h),o()):t.slice()},u.unknown=function(h){return arguments.length?(i=h,u):i},u.quantiles=function(){return n.slice()},u.copy=function(){return _ge().domain(e).range(t).unknown(i)},Hc.apply(u,arguments)}function bge(){var e=0,t=1,n=1,i=[.5],o=[0,1],u;function h(g){return g!=null&&g<=g?o[uS(i,g,0,n)]:u}function p(){var g=-1;for(i=new Array(n);++g<n;)i[g]=((g+1)*t-(g-n)*e)/(n+1);return h}return h.domain=function(g){return arguments.length?([e,t]=g,e=+e,t=+t,p()):[e,t]},h.range=function(g){return arguments.length?(n=(o=Array.from(g)).length-1,p()):o.slice()},h.invertExtent=function(g){var v=o.indexOf(g);return v<0?[NaN,NaN]:v<1?[e,i[0]]:v>=n?[i[n-1],t]:[i[v-1],i[v]]},h.unknown=function(g){return arguments.length&&(u=g),h},h.thresholds=function(){return i.slice()},h.copy=function(){return bge().domain([e,t]).range(o).unknown(u)},Hc.apply(Ff(h),arguments)}function Ege(){var e=[.5],t=[0,1],n,i=1;function o(u){return u!=null&&u<=u?t[uS(e,u,0,i)]:n}return o.domain=function(u){return arguments.length?(e=Array.from(u),i=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(u){return arguments.length?(t=Array.from(u),i=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(u){var h=t.indexOf(u);return[e[h-1],e[h]]},o.unknown=function(u){return arguments.length?(n=u,o):n},o.copy=function(){return Ege().domain(e).range(t).unknown(n)},Hc.apply(o,arguments)}const BL=new Date,$L=new Date;function Pa(e,t,n,i){function o(u){return e(u=arguments.length===0?new Date:new Date(+u)),u}return o.floor=u=>(e(u=new Date(+u)),u),o.ceil=u=>(e(u=new Date(u-1)),t(u,1),e(u),u),o.round=u=>{const h=o(u),p=o.ceil(u);return u-h<p-u?h:p},o.offset=(u,h)=>(t(u=new Date(+u),h==null?1:Math.floor(h)),u),o.range=(u,h,p)=>{const g=[];if(u=o.ceil(u),p=p==null?1:Math.floor(p),!(u<h)||!(p>0))return g;let v;do g.push(v=new Date(+u)),t(u,p),e(u);while(v<u&&u<h);return g},o.filter=u=>Pa(h=>{if(h>=h)for(;e(h),!u(h);)h.setTime(h-1)},(h,p)=>{if(h>=h)if(p<0)for(;++p<=0;)for(;t(h,-1),!u(h););else for(;--p>=0;)for(;t(h,1),!u(h););}),n&&(o.count=(u,h)=>(BL.setTime(+u),$L.setTime(+h),e(BL),e($L),Math.floor(n(BL,$L))),o.every=u=>(u=Math.floor(u),!isFinite(u)||!(u>0)?null:u>1?o.filter(i?h=>i(h)%u===0:h=>o.count(0,h)%u===0):o)),o}const CA=Pa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);CA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Pa(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):CA);CA.range;const Td=1e3,jc=Td*60,Cd=jc*60,Gd=Cd*24,R3=Gd*7,sre=Gd*30,WL=Gd*365,Wp=Pa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Td)},(e,t)=>(t-e)/Td,e=>e.getUTCSeconds());Wp.range;const N3=Pa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Td)},(e,t)=>{e.setTime(+e+t*jc)},(e,t)=>(t-e)/jc,e=>e.getMinutes());N3.range;const A3=Pa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*jc)},(e,t)=>(t-e)/jc,e=>e.getUTCMinutes());A3.range;const I3=Pa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Td-e.getMinutes()*jc)},(e,t)=>{e.setTime(+e+t*Cd)},(e,t)=>(t-e)/Cd,e=>e.getHours());I3.range;const O3=Pa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Cd)},(e,t)=>(t-e)/Cd,e=>e.getUTCHours());O3.range;const fS=Pa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*jc)/Gd,e=>e.getDate()-1);fS.range;const YI=Pa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Gd,e=>e.getUTCDate()-1);YI.range;const wge=Pa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Gd,e=>Math.floor(e/Gd));wge.range;function Om(e){return Pa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*jc)/R3)}const XI=Om(0),RA=Om(1),Hdt=Om(2),zdt=Om(3),Cy=Om(4),Kdt=Om(5),qdt=Om(6);XI.range;RA.range;Hdt.range;zdt.range;Cy.range;Kdt.range;qdt.range;function Pm(e){return Pa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/R3)}const JI=Pm(0),NA=Pm(1),Ydt=Pm(2),Xdt=Pm(3),Ry=Pm(4),Jdt=Pm(5),Zdt=Pm(6);JI.range;NA.range;Ydt.range;Xdt.range;Ry.range;Jdt.range;Zdt.range;const P3=Pa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());P3.range;const k3=Pa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());k3.range;const Hd=Pa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Hd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Pa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Hd.range;const zd=Pa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Pa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});zd.range;function Sge(e,t,n,i,o,u){const h=[[Wp,1,Td],[Wp,5,5*Td],[Wp,15,15*Td],[Wp,30,30*Td],[u,1,jc],[u,5,5*jc],[u,15,15*jc],[u,30,30*jc],[o,1,Cd],[o,3,3*Cd],[o,6,6*Cd],[o,12,12*Cd],[i,1,Gd],[i,2,2*Gd],[n,1,R3],[t,1,sre],[t,3,3*sre],[e,1,WL]];function p(v,b,E){const T=b<v;T&&([v,b]=[b,v]);const C=E&&typeof E.range=="function"?E:g(v,b,E),R=C?C.range(v,+b+1):[];return T?R.reverse():R}function g(v,b,E){const T=Math.abs(b-v)/E,C=m3(([,,O])=>O).right(h,T);if(C===h.length)return e.every(SF(v/WL,b/WL,E));if(C===0)return CA.every(Math.max(SF(v,b,E),1));const[R,N]=h[T/h[C-1][2]<h[C][2]/T?C-1:C];return R.every(N)}return[p,g]}const[Qdt,eht]=Sge(zd,k3,JI,wge,O3,A3),[tht,nht]=Sge(Hd,P3,XI,fS,I3,N3);function GL(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function HL(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function SE(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function rht(e){var t=e.dateTime,n=e.date,i=e.time,o=e.periods,u=e.days,h=e.shortDays,p=e.months,g=e.shortMonths,v=xE(o),b=TE(o),E=xE(u),T=TE(u),C=xE(h),R=TE(h),N=xE(p),O=TE(p),j=xE(g),k=TE(g),P={a:J,A:re,b:ee,B:de,c:null,d:hre,e:hre,f:Cht,g:Lht,G:Uht,H:Sht,I:xht,j:Tht,L:xge,m:Rht,M:Nht,p:xe,q:ve,Q:mre,s:gre,S:Aht,u:Iht,U:Oht,V:Pht,w:kht,W:jht,x:null,X:null,y:Dht,Y:Mht,Z:Fht,"%":pre},M={a:Te,A:Pe,b:qe,B:st,c:null,d:fre,e:fre,f:Wht,g:Qht,G:tft,H:Vht,I:Bht,j:$ht,L:Cge,m:Ght,M:Hht,p:ze,q:ft,Q:mre,s:gre,S:zht,u:Kht,U:qht,V:Yht,w:Xht,W:Jht,x:null,X:null,y:Zht,Y:eft,Z:nft,"%":pre},D={a:q,A:Y,b:z,B:Z,c:X,d:ure,e:ure,f:_ht,g:lre,G:cre,H:dre,I:dre,j:mht,L:yht,m:pht,M:ght,p:W,q:fht,Q:Eht,s:wht,S:vht,u:cht,U:lht,V:uht,w:oht,W:dht,x:ae,X:se,y:lre,Y:cre,Z:hht,"%":bht};P.x=U(n,P),P.X=U(i,P),P.c=U(t,P),M.x=U(n,M),M.X=U(i,M),M.c=U(t,M);function U($e,at){return function(ke){var je=[],Pt=-1,Dt=0,cn=$e.length,ut,wt,Rt;for(ke instanceof Date||(ke=new Date(+ke));++Pt<cn;)$e.charCodeAt(Pt)===37&&(je.push($e.slice(Dt,Pt)),(wt=ore[ut=$e.charAt(++Pt)])!=null?ut=$e.charAt(++Pt):wt=ut==="e"?" ":"0",(Rt=at[ut])&&(ut=Rt(ke,wt)),je.push(ut),Dt=Pt+1);return je.push($e.slice(Dt,Pt)),je.join("")}}function F($e,at){return function(ke){var je=SE(1900,void 0,1),Pt=H(je,$e,ke+="",0),Dt,cn;if(Pt!=ke.length)return null;if("Q"in je)return new Date(je.Q);if("s"in je)return new Date(je.s*1e3+("L"in je?je.L:0));if(at&&!("Z"in je)&&(je.Z=0),"p"in je&&(je.H=je.H%12+je.p*12),je.m===void 0&&(je.m="q"in je?je.q:0),"V"in je){if(je.V<1||je.V>53)return null;"w"in je||(je.w=1),"Z"in je?(Dt=HL(SE(je.y,0,1)),cn=Dt.getUTCDay(),Dt=cn>4||cn===0?NA.ceil(Dt):NA(Dt),Dt=YI.offset(Dt,(je.V-1)*7),je.y=Dt.getUTCFullYear(),je.m=Dt.getUTCMonth(),je.d=Dt.getUTCDate()+(je.w+6)%7):(Dt=GL(SE(je.y,0,1)),cn=Dt.getDay(),Dt=cn>4||cn===0?RA.ceil(Dt):RA(Dt),Dt=fS.offset(Dt,(je.V-1)*7),je.y=Dt.getFullYear(),je.m=Dt.getMonth(),je.d=Dt.getDate()+(je.w+6)%7)}else("W"in je||"U"in je)&&("w"in je||(je.w="u"in je?je.u%7:"W"in je?1:0),cn="Z"in je?HL(SE(je.y,0,1)).getUTCDay():GL(SE(je.y,0,1)).getDay(),je.m=0,je.d="W"in je?(je.w+6)%7+je.W*7-(cn+5)%7:je.w+je.U*7-(cn+6)%7);return"Z"in je?(je.H+=je.Z/100|0,je.M+=je.Z%100,HL(je)):GL(je)}}function H($e,at,ke,je){for(var Pt=0,Dt=at.length,cn=ke.length,ut,wt;Pt<Dt;){if(je>=cn)return-1;if(ut=at.charCodeAt(Pt++),ut===37){if(ut=at.charAt(Pt++),wt=D[ut in ore?at.charAt(Pt++):ut],!wt||(je=wt($e,ke,je))<0)return-1}else if(ut!=ke.charCodeAt(je++))return-1}return je}function W($e,at,ke){var je=v.exec(at.slice(ke));return je?($e.p=b.get(je[0].toLowerCase()),ke+je[0].length):-1}function q($e,at,ke){var je=C.exec(at.slice(ke));return je?($e.w=R.get(je[0].toLowerCase()),ke+je[0].length):-1}function Y($e,at,ke){var je=E.exec(at.slice(ke));return je?($e.w=T.get(je[0].toLowerCase()),ke+je[0].length):-1}function z($e,at,ke){var je=j.exec(at.slice(ke));return je?($e.m=k.get(je[0].toLowerCase()),ke+je[0].length):-1}function Z($e,at,ke){var je=N.exec(at.slice(ke));return je?($e.m=O.get(je[0].toLowerCase()),ke+je[0].length):-1}function X($e,at,ke){return H($e,t,at,ke)}function ae($e,at,ke){return H($e,n,at,ke)}function se($e,at,ke){return H($e,i,at,ke)}function J($e){return h[$e.getDay()]}function re($e){return u[$e.getDay()]}function ee($e){return g[$e.getMonth()]}function de($e){return p[$e.getMonth()]}function xe($e){return o[+($e.getHours()>=12)]}function ve($e){return 1+~~($e.getMonth()/3)}function Te($e){return h[$e.getUTCDay()]}function Pe($e){return u[$e.getUTCDay()]}function qe($e){return g[$e.getUTCMonth()]}function st($e){return p[$e.getUTCMonth()]}function ze($e){return o[+($e.getUTCHours()>=12)]}function ft($e){return 1+~~($e.getUTCMonth()/3)}return{format:function($e){var at=U($e+="",P);return at.toString=function(){return $e},at},parse:function($e){var at=F($e+="",!1);return at.toString=function(){return $e},at},utcFormat:function($e){var at=U($e+="",M);return at.toString=function(){return $e},at},utcParse:function($e){var at=F($e+="",!0);return at.toString=function(){return $e},at}}}var ore={"-":"",_:" ",0:"0"},za=/^\s*\d+/,iht=/^%/,aht=/[\\^$*+?|[\]().{}]/g;function br(e,t,n){var i=e<0?"-":"",o=(i?-e:e)+"",u=o.length;return i+(u<n?new Array(n-u+1).join(t)+o:o)}function sht(e){return e.replace(aht,"\\$&")}function xE(e){return new RegExp("^(?:"+e.map(sht).join("|")+")","i")}function TE(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function oht(e,t,n){var i=za.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function cht(e,t,n){var i=za.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function lht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function uht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function dht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function cre(e,t,n){var i=za.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function lre(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function hht(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function fht(e,t,n){var i=za.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function pht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function ure(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function mht(e,t,n){var i=za.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function dre(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function ght(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function vht(e,t,n){var i=za.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function yht(e,t,n){var i=za.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function _ht(e,t,n){var i=za.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function bht(e,t,n){var i=iht.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function Eht(e,t,n){var i=za.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function wht(e,t,n){var i=za.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function hre(e,t){return br(e.getDate(),t,2)}function Sht(e,t){return br(e.getHours(),t,2)}function xht(e,t){return br(e.getHours()%12||12,t,2)}function Tht(e,t){return br(1+fS.count(Hd(e),e),t,3)}function xge(e,t){return br(e.getMilliseconds(),t,3)}function Cht(e,t){return xge(e,t)+"000"}function Rht(e,t){return br(e.getMonth()+1,t,2)}function Nht(e,t){return br(e.getMinutes(),t,2)}function Aht(e,t){return br(e.getSeconds(),t,2)}function Iht(e){var t=e.getDay();return t===0?7:t}function Oht(e,t){return br(XI.count(Hd(e)-1,e),t,2)}function Tge(e){var t=e.getDay();return t>=4||t===0?Cy(e):Cy.ceil(e)}function Pht(e,t){return e=Tge(e),br(Cy.count(Hd(e),e)+(Hd(e).getDay()===4),t,2)}function kht(e){return e.getDay()}function jht(e,t){return br(RA.count(Hd(e)-1,e),t,2)}function Dht(e,t){return br(e.getFullYear()%100,t,2)}function Lht(e,t){return e=Tge(e),br(e.getFullYear()%100,t,2)}function Mht(e,t){return br(e.getFullYear()%1e4,t,4)}function Uht(e,t){var n=e.getDay();return e=n>=4||n===0?Cy(e):Cy.ceil(e),br(e.getFullYear()%1e4,t,4)}function Fht(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+br(t/60|0,"0",2)+br(t%60,"0",2)}function fre(e,t){return br(e.getUTCDate(),t,2)}function Vht(e,t){return br(e.getUTCHours(),t,2)}function Bht(e,t){return br(e.getUTCHours()%12||12,t,2)}function $ht(e,t){return br(1+YI.count(zd(e),e),t,3)}function Cge(e,t){return br(e.getUTCMilliseconds(),t,3)}function Wht(e,t){return Cge(e,t)+"000"}function Ght(e,t){return br(e.getUTCMonth()+1,t,2)}function Hht(e,t){return br(e.getUTCMinutes(),t,2)}function zht(e,t){return br(e.getUTCSeconds(),t,2)}function Kht(e){var t=e.getUTCDay();return t===0?7:t}function qht(e,t){return br(JI.count(zd(e)-1,e),t,2)}function Rge(e){var t=e.getUTCDay();return t>=4||t===0?Ry(e):Ry.ceil(e)}function Yht(e,t){return e=Rge(e),br(Ry.count(zd(e),e)+(zd(e).getUTCDay()===4),t,2)}function Xht(e){return e.getUTCDay()}function Jht(e,t){return br(NA.count(zd(e)-1,e),t,2)}function Zht(e,t){return br(e.getUTCFullYear()%100,t,2)}function Qht(e,t){return e=Rge(e),br(e.getUTCFullYear()%100,t,2)}function eft(e,t){return br(e.getUTCFullYear()%1e4,t,4)}function tft(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Ry(e):Ry.ceil(e),br(e.getUTCFullYear()%1e4,t,4)}function nft(){return"+0000"}function pre(){return"%"}function mre(e){return+e}function gre(e){return Math.floor(+e/1e3)}var dv,Nge,Age;rft({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function rft(e){return dv=rht(e),Nge=dv.format,dv.parse,Age=dv.utcFormat,dv.utcParse,dv}function ift(e){return new Date(e)}function aft(e){return e instanceof Date?+e:+new Date(+e)}function j3(e,t,n,i,o,u,h,p,g,v){var b=b3(),E=b.invert,T=b.domain,C=v(".%L"),R=v(":%S"),N=v("%I:%M"),O=v("%I %p"),j=v("%a %d"),k=v("%b %d"),P=v("%B"),M=v("%Y");function D(U){return(g(U)<U?C:p(U)<U?R:h(U)<U?N:u(U)<U?O:i(U)<U?o(U)<U?j:k:n(U)<U?P:M)(U)}return b.invert=function(U){return new Date(E(U))},b.domain=function(U){return arguments.length?T(Array.from(U,aft)):T().map(ift)},b.ticks=function(U){var F=T();return e(F[0],F[F.length-1],U??10)},b.tickFormat=function(U,F){return F==null?D:v(F)},b.nice=function(U){var F=T();return(!U||typeof U.range!="function")&&(U=t(F[0],F[F.length-1],U??10)),U?T(mge(F,U)):b},b.copy=function(){return hS(b,j3(e,t,n,i,o,u,h,p,g,v))},b}function sft(){return Hc.apply(j3(tht,nht,Hd,P3,XI,fS,I3,N3,Wp,Nge).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oft(){return Hc.apply(j3(Qdt,eht,zd,k3,JI,YI,O3,A3,Wp,Age).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ZI(){var e=0,t=1,n,i,o,u,h=Ds,p=!1,g;function v(E){return E==null||isNaN(E=+E)?g:h(o===0?.5:(E=(u(E)-n)*o,p?Math.max(0,Math.min(1,E)):E))}v.domain=function(E){return arguments.length?([e,t]=E,n=u(e=+e),i=u(t=+t),o=n===i?0:1/(i-n),v):[e,t]},v.clamp=function(E){return arguments.length?(p=!!E,v):p},v.interpolator=function(E){return arguments.length?(h=E,v):h};function b(E){return function(T){var C,R;return arguments.length?([C,R]=T,h=E(C,R),v):[h(0),h(1)]}}return v.range=b(g_),v.rangeRound=b(_3),v.unknown=function(E){return arguments.length?(g=E,v):g},function(E){return u=E,n=E(e),i=E(t),o=n===i?0:1/(i-n),v}}function Vf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Ige(){var e=Ff(ZI()(Ds));return e.copy=function(){return Vf(e,Ige())},Zd.apply(e,arguments)}function Oge(){var e=S3(ZI()).domain([1,10]);return e.copy=function(){return Vf(e,Oge()).base(e.base())},Zd.apply(e,arguments)}function Pge(){var e=x3(ZI());return e.copy=function(){return Vf(e,Pge()).constant(e.constant())},Zd.apply(e,arguments)}function D3(){var e=T3(ZI());return e.copy=function(){return Vf(e,D3()).exponent(e.exponent())},Zd.apply(e,arguments)}function cft(){return D3.apply(null,arguments).exponent(.5)}function kge(){var e=[],t=Ds;function n(i){if(i!=null&&!isNaN(i=+i))return t((uS(e,i,1)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(mf),n},n.interpolator=function(i){return arguments.length?(t=i,n):t},n.range=function(){return e.map((i,o)=>t(o/(e.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(o,u)=>qut(e,u/i))},n.copy=function(){return kge(t).domain(e)},Zd.apply(n,arguments)}function QI(){var e=0,t=.5,n=1,i=1,o,u,h,p,g,v=Ds,b,E=!1,T;function C(N){return isNaN(N=+N)?T:(N=.5+((N=+b(N))-u)*(i*N<i*u?p:g),v(E?Math.max(0,Math.min(1,N)):N))}C.domain=function(N){return arguments.length?([e,t,n]=N,o=b(e=+e),u=b(t=+t),h=b(n=+n),p=o===u?0:.5/(u-o),g=u===h?0:.5/(h-u),i=u<o?-1:1,C):[e,t,n]},C.clamp=function(N){return arguments.length?(E=!!N,C):E},C.interpolator=function(N){return arguments.length?(v=N,C):v};function R(N){return function(O){var j,k,P;return arguments.length?([j,k,P]=O,v=bdt(N,[j,k,P]),C):[v(0),v(.5),v(1)]}}return C.range=R(g_),C.rangeRound=R(_3),C.unknown=function(N){return arguments.length?(T=N,C):T},function(N){return b=N,o=N(e),u=N(t),h=N(n),p=o===u?0:.5/(u-o),g=u===h?0:.5/(h-u),i=u<o?-1:1,C}}function jge(){var e=Ff(QI()(Ds));return e.copy=function(){return Vf(e,jge())},Zd.apply(e,arguments)}function Dge(){var e=S3(QI()).domain([.1,1,10]);return e.copy=function(){return Vf(e,Dge()).base(e.base())},Zd.apply(e,arguments)}function Lge(){var e=x3(QI());return e.copy=function(){return Vf(e,Lge()).constant(e.constant())},Zd.apply(e,arguments)}function L3(){var e=T3(QI());return e.copy=function(){return Vf(e,L3()).exponent(e.exponent())},Zd.apply(e,arguments)}function lft(){return L3.apply(null,arguments).exponent(.5)}const vre=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:tw,scaleDiverging:jge,scaleDivergingLog:Dge,scaleDivergingPow:L3,scaleDivergingSqrt:lft,scaleDivergingSymlog:Lge,scaleIdentity:pge,scaleImplicit:xF,scaleLinear:TA,scaleLog:gge,scaleOrdinal:g3,scalePoint:r0,scalePow:C3,scaleQuantile:_ge,scaleQuantize:bge,scaleRadial:yge,scaleSequential:Ige,scaleSequentialLog:Oge,scaleSequentialPow:D3,scaleSequentialQuantile:kge,scaleSequentialSqrt:cft,scaleSequentialSymlog:Pge,scaleSqrt:Wdt,scaleSymlog:vge,scaleThreshold:Ege,scaleTime:sft,scaleUtc:oft,tickFormat:fge},Symbol.toStringTag,{value:"Module"}));var uft=c_;function dft(e,t,n){for(var i=-1,o=e.length;++i<o;){var u=e[i],h=t(u);if(h!=null&&(p===void 0?h===h&&!uft(h):n(h,p)))var p=h,g=u}return g}var Mge=dft;function hft(e,t){return e>t}var fft=hft,pft=Mge,mft=fft,gft=m_;function vft(e){return e&&e.length?pft(e,gft,mft):void 0}var yft=vft;const eO=jr(yft);function _ft(e,t){return e<t}var bft=_ft,Eft=Mge,wft=bft,Sft=m_;function xft(e){return e&&e.length?Eft(e,Sft,wft):void 0}var Tft=xft;const tO=jr(Tft);var Cft=YB,Rft=Uf,Nft=Hme,Aft=vo;function Ift(e,t){var n=Aft(e)?Cft:Nft;return n(e,Rft(t))}var Oft=Ift,Pft=Wme,kft=Oft;function jft(e,t){return Pft(kft(e,t),1)}var Dft=jft;const Lft=jr(Dft);var Mft=u3;function Uft(e,t){return Mft(e,t)}var Fft=Uft;const M3=jr(Fft);var v_=1e9,Vft={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},F3,bi=!0,Vc="[DecimalError] ",em=Vc+"Invalid argument: ",U3=Vc+"Exponent out of range: ",y_=Math.floor,Lp=Math.pow,Bft=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Vo,Fa=1e7,hi=7,Uge=9007199254740991,AA=y_(Uge/hi),zt={};zt.absoluteValue=zt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};zt.comparedTo=zt.cmp=function(e){var t,n,i,o,u=this;if(e=new u.constructor(e),u.s!==e.s)return u.s||-e.s;if(u.e!==e.e)return u.e>e.e^u.s<0?1:-1;for(i=u.d.length,o=e.d.length,t=0,n=i<o?i:o;t<n;++t)if(u.d[t]!==e.d[t])return u.d[t]>e.d[t]^u.s<0?1:-1;return i===o?0:i>o^u.s<0?1:-1};zt.decimalPlaces=zt.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*hi;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};zt.dividedBy=zt.div=function(e){return jd(this,new this.constructor(e))};zt.dividedToIntegerBy=zt.idiv=function(e){var t=this,n=t.constructor;return Qr(jd(t,new n(e),0,1),n.precision)};zt.equals=zt.eq=function(e){return!this.cmp(e)};zt.exponent=function(){return ga(this)};zt.greaterThan=zt.gt=function(e){return this.cmp(e)>0};zt.greaterThanOrEqualTo=zt.gte=function(e){return this.cmp(e)>=0};zt.isInteger=zt.isint=function(){return this.e>this.d.length-2};zt.isNegative=zt.isneg=function(){return this.s<0};zt.isPositive=zt.ispos=function(){return this.s>0};zt.isZero=function(){return this.s===0};zt.lessThan=zt.lt=function(e){return this.cmp(e)<0};zt.lessThanOrEqualTo=zt.lte=function(e){return this.cmp(e)<1};zt.logarithm=zt.log=function(e){var t,n=this,i=n.constructor,o=i.precision,u=o+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq(Vo))throw Error(Vc+"NaN");if(n.s<1)throw Error(Vc+(n.s?"NaN":"-Infinity"));return n.eq(Vo)?new i(0):(bi=!1,t=jd(sw(n,u),sw(e,u),u),bi=!0,Qr(t,o))};zt.minus=zt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Bge(t,e):Fge(t,(e.s=-e.s,e))};zt.modulo=zt.mod=function(e){var t,n=this,i=n.constructor,o=i.precision;if(e=new i(e),!e.s)throw Error(Vc+"NaN");return n.s?(bi=!1,t=jd(n,e,0,1).times(e),bi=!0,n.minus(t)):Qr(new i(n),o)};zt.naturalExponential=zt.exp=function(){return Vge(this)};zt.naturalLogarithm=zt.ln=function(){return sw(this)};zt.negated=zt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};zt.plus=zt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Fge(t,e):Bge(t,(e.s=-e.s,e))};zt.precision=zt.sd=function(e){var t,n,i,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(em+e);if(t=ga(o)+1,i=o.d.length-1,n=i*hi+1,i=o.d[i],i){for(;i%10==0;i/=10)n--;for(i=o.d[0];i>=10;i/=10)n++}return e&&t>n?t:n};zt.squareRoot=zt.sqrt=function(){var e,t,n,i,o,u,h,p=this,g=p.constructor;if(p.s<1){if(!p.s)return new g(0);throw Error(Vc+"NaN")}for(e=ga(p),bi=!1,o=Math.sqrt(+p),o==0||o==1/0?(t=Iu(p.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=y_((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new g(t)):i=new g(o.toString()),n=g.precision,o=h=n+3;;)if(u=i,i=u.plus(jd(p,u,h+2)).times(.5),Iu(u.d).slice(0,h)===(t=Iu(i.d)).slice(0,h)){if(t=t.slice(h-3,h+1),o==h&&t=="4999"){if(Qr(u,n+1,0),u.times(u).eq(p)){i=u;break}}else if(t!="9999")break;h+=4}return bi=!0,Qr(i,n)};zt.times=zt.mul=function(e){var t,n,i,o,u,h,p,g,v,b=this,E=b.constructor,T=b.d,C=(e=new E(e)).d;if(!b.s||!e.s)return new E(0);for(e.s*=b.s,n=b.e+e.e,g=T.length,v=C.length,g<v&&(u=T,T=C,C=u,h=g,g=v,v=h),u=[],h=g+v,i=h;i--;)u.push(0);for(i=v;--i>=0;){for(t=0,o=g+i;o>i;)p=u[o]+C[i]*T[o-i-1]+t,u[o--]=p%Fa|0,t=p/Fa|0;u[o]=(u[o]+t)%Fa|0}for(;!u[--h];)u.pop();return t?++n:u.shift(),e.d=u,e.e=n,bi?Qr(e,E.precision):e};zt.toDecimalPlaces=zt.todp=function(e,t){var n=this,i=n.constructor;return n=new i(n),e===void 0?n:($u(e,0,v_),t===void 0?t=i.rounding:$u(t,0,8),Qr(n,e+ga(n)+1,t))};zt.toExponential=function(e,t){var n,i=this,o=i.constructor;return e===void 0?n=vm(i,!0):($u(e,0,v_),t===void 0?t=o.rounding:$u(t,0,8),i=Qr(new o(i),e+1,t),n=vm(i,!0,e+1)),n};zt.toFixed=function(e,t){var n,i,o=this,u=o.constructor;return e===void 0?vm(o):($u(e,0,v_),t===void 0?t=u.rounding:$u(t,0,8),i=Qr(new u(o),e+ga(o)+1,t),n=vm(i.abs(),!1,e+ga(i)+1),o.isneg()&&!o.isZero()?"-"+n:n)};zt.toInteger=zt.toint=function(){var e=this,t=e.constructor;return Qr(new t(e),ga(e)+1,t.rounding)};zt.toNumber=function(){return+this};zt.toPower=zt.pow=function(e){var t,n,i,o,u,h,p=this,g=p.constructor,v=12,b=+(e=new g(e));if(!e.s)return new g(Vo);if(p=new g(p),!p.s){if(e.s<1)throw Error(Vc+"Infinity");return p}if(p.eq(Vo))return p;if(i=g.precision,e.eq(Vo))return Qr(p,i);if(t=e.e,n=e.d.length-1,h=t>=n,u=p.s,h){if((n=b<0?-b:b)<=Uge){for(o=new g(Vo),t=Math.ceil(i/hi+4),bi=!1;n%2&&(o=o.times(p),_re(o.d,t)),n=y_(n/2),n!==0;)p=p.times(p),_re(p.d,t);return bi=!0,e.s<0?new g(Vo).div(o):Qr(o,i)}}else if(u<0)throw Error(Vc+"NaN");return u=u<0&&e.d[Math.max(t,n)]&1?-1:1,p.s=1,bi=!1,o=e.times(sw(p,i+v)),bi=!0,o=Vge(o),o.s=u,o};zt.toPrecision=function(e,t){var n,i,o=this,u=o.constructor;return e===void 0?(n=ga(o),i=vm(o,n<=u.toExpNeg||n>=u.toExpPos)):($u(e,1,v_),t===void 0?t=u.rounding:$u(t,0,8),o=Qr(new u(o),e,t),n=ga(o),i=vm(o,e<=n||n<=u.toExpNeg,e)),i};zt.toSignificantDigits=zt.tosd=function(e,t){var n=this,i=n.constructor;return e===void 0?(e=i.precision,t=i.rounding):($u(e,1,v_),t===void 0?t=i.rounding:$u(t,0,8)),Qr(new i(n),e,t)};zt.toString=zt.valueOf=zt.val=zt.toJSON=zt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ga(e),n=e.constructor;return vm(e,t<=n.toExpNeg||t>=n.toExpPos)};function Fge(e,t){var n,i,o,u,h,p,g,v,b=e.constructor,E=b.precision;if(!e.s||!t.s)return t.s||(t=new b(e)),bi?Qr(t,E):t;if(g=e.d,v=t.d,h=e.e,o=t.e,g=g.slice(),u=h-o,u){for(u<0?(i=g,u=-u,p=v.length):(i=v,o=h,p=g.length),h=Math.ceil(E/hi),p=h>p?h+1:p+1,u>p&&(u=p,i.length=1),i.reverse();u--;)i.push(0);i.reverse()}for(p=g.length,u=v.length,p-u<0&&(u=p,i=v,v=g,g=i),n=0;u;)n=(g[--u]=g[u]+v[u]+n)/Fa|0,g[u]%=Fa;for(n&&(g.unshift(n),++o),p=g.length;g[--p]==0;)g.pop();return t.d=g,t.e=o,bi?Qr(t,E):t}function $u(e,t,n){if(e!==~~e||e<t||e>n)throw Error(em+e)}function Iu(e){var t,n,i,o=e.length-1,u="",h=e[0];if(o>0){for(u+=h,t=1;t<o;t++)i=e[t]+"",n=hi-i.length,n&&(u+=Bh(n)),u+=i;h=e[t],i=h+"",n=hi-i.length,n&&(u+=Bh(n))}else if(h===0)return"0";for(;h%10===0;)h/=10;return u+h}var jd=function(){function e(i,o){var u,h=0,p=i.length;for(i=i.slice();p--;)u=i[p]*o+h,i[p]=u%Fa|0,h=u/Fa|0;return h&&i.unshift(h),i}function t(i,o,u,h){var p,g;if(u!=h)g=u>h?1:-1;else for(p=g=0;p<u;p++)if(i[p]!=o[p]){g=i[p]>o[p]?1:-1;break}return g}function n(i,o,u){for(var h=0;u--;)i[u]-=h,h=i[u]<o[u]?1:0,i[u]=h*Fa+i[u]-o[u];for(;!i[0]&&i.length>1;)i.shift()}return function(i,o,u,h){var p,g,v,b,E,T,C,R,N,O,j,k,P,M,D,U,F,H,W=i.constructor,q=i.s==o.s?1:-1,Y=i.d,z=o.d;if(!i.s)return new W(i);if(!o.s)throw Error(Vc+"Division by zero");for(g=i.e-o.e,F=z.length,D=Y.length,C=new W(q),R=C.d=[],v=0;z[v]==(Y[v]||0);)++v;if(z[v]>(Y[v]||0)&&--g,u==null?k=u=W.precision:h?k=u+(ga(i)-ga(o))+1:k=u,k<0)return new W(0);if(k=k/hi+2|0,v=0,F==1)for(b=0,z=z[0],k++;(v<D||b)&&k--;v++)P=b*Fa+(Y[v]||0),R[v]=P/z|0,b=P%z|0;else{for(b=Fa/(z[0]+1)|0,b>1&&(z=e(z,b),Y=e(Y,b),F=z.length,D=Y.length),M=F,N=Y.slice(0,F),O=N.length;O<F;)N[O++]=0;H=z.slice(),H.unshift(0),U=z[0],z[1]>=Fa/2&&++U;do b=0,p=t(z,N,F,O),p<0?(j=N[0],F!=O&&(j=j*Fa+(N[1]||0)),b=j/U|0,b>1?(b>=Fa&&(b=Fa-1),E=e(z,b),T=E.length,O=N.length,p=t(E,N,T,O),p==1&&(b--,n(E,F<T?H:z,T))):(b==0&&(p=b=1),E=z.slice()),T=E.length,T<O&&E.unshift(0),n(N,E,O),p==-1&&(O=N.length,p=t(z,N,F,O),p<1&&(b++,n(N,F<O?H:z,O))),O=N.length):p===0&&(b++,N=[0]),R[v++]=b,p&&N[0]?N[O++]=Y[M]||0:(N=[Y[M]],O=1);while((M++<D||N[0]!==void 0)&&k--)}return R[0]||R.shift(),C.e=g,Qr(C,h?u+ga(C)+1:u)}}();function Vge(e,t){var n,i,o,u,h,p,g=0,v=0,b=e.constructor,E=b.precision;if(ga(e)>16)throw Error(U3+ga(e));if(!e.s)return new b(Vo);for(bi=!1,p=E,h=new b(.03125);e.abs().gte(.1);)e=e.times(h),v+=5;for(i=Math.log(Lp(2,v))/Math.LN10*2+5|0,p+=i,n=o=u=new b(Vo),b.precision=p;;){if(o=Qr(o.times(e),p),n=n.times(++g),h=u.plus(jd(o,n,p)),Iu(h.d).slice(0,p)===Iu(u.d).slice(0,p)){for(;v--;)u=Qr(u.times(u),p);return b.precision=E,t==null?(bi=!0,Qr(u,E)):u}u=h}}function ga(e){for(var t=e.e*hi,n=e.d[0];n>=10;n/=10)t++;return t}function zL(e,t,n){if(t>e.LN10.sd())throw bi=!0,n&&(e.precision=n),Error(Vc+"LN10 precision limit exceeded");return Qr(new e(e.LN10),t)}function Bh(e){for(var t="";e--;)t+="0";return t}function sw(e,t){var n,i,o,u,h,p,g,v,b,E=1,T=10,C=e,R=C.d,N=C.constructor,O=N.precision;if(C.s<1)throw Error(Vc+(C.s?"NaN":"-Infinity"));if(C.eq(Vo))return new N(0);if(t==null?(bi=!1,v=O):v=t,C.eq(10))return t==null&&(bi=!0),zL(N,v);if(v+=T,N.precision=v,n=Iu(R),i=n.charAt(0),u=ga(C),Math.abs(u)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)C=C.times(e),n=Iu(C.d),i=n.charAt(0),E++;u=ga(C),i>1?(C=new N("0."+n),u++):C=new N(i+"."+n.slice(1))}else return g=zL(N,v+2,O).times(u+""),C=sw(new N(i+"."+n.slice(1)),v-T).plus(g),N.precision=O,t==null?(bi=!0,Qr(C,O)):C;for(p=h=C=jd(C.minus(Vo),C.plus(Vo),v),b=Qr(C.times(C),v),o=3;;){if(h=Qr(h.times(b),v),g=p.plus(jd(h,new N(o),v)),Iu(g.d).slice(0,v)===Iu(p.d).slice(0,v))return p=p.times(2),u!==0&&(p=p.plus(zL(N,v+2,O).times(u+""))),p=jd(p,new N(E),v),N.precision=O,t==null?(bi=!0,Qr(p,O)):p;p=g,o+=2}}function yre(e,t){var n,i,o;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length),i=0;t.charCodeAt(i)===48;)++i;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(i,o),t){if(o-=i,n=n-i-1,e.e=y_(n/hi),e.d=[],i=(n+1)%hi,n<0&&(i+=hi),i<o){for(i&&e.d.push(+t.slice(0,i)),o-=hi;i<o;)e.d.push(+t.slice(i,i+=hi));t=t.slice(i),i=hi-t.length}else i-=o;for(;i--;)t+="0";if(e.d.push(+t),bi&&(e.e>AA||e.e<-AA))throw Error(U3+n)}else e.s=0,e.e=0,e.d=[0];return e}function Qr(e,t,n){var i,o,u,h,p,g,v,b,E=e.d;for(h=1,u=E[0];u>=10;u/=10)h++;if(i=t-h,i<0)i+=hi,o=t,v=E[b=0];else{if(b=Math.ceil((i+1)/hi),u=E.length,b>=u)return e;for(v=u=E[b],h=1;u>=10;u/=10)h++;i%=hi,o=i-hi+h}if(n!==void 0&&(u=Lp(10,h-o-1),p=v/u%10|0,g=t<0||E[b+1]!==void 0||v%u,g=n<4?(p||g)&&(n==0||n==(e.s<0?3:2)):p>5||p==5&&(n==4||g||n==6&&(i>0?o>0?v/Lp(10,h-o):0:E[b-1])%10&1||n==(e.s<0?8:7))),t<1||!E[0])return g?(u=ga(e),E.length=1,t=t-u-1,E[0]=Lp(10,(hi-t%hi)%hi),e.e=y_(-t/hi)||0):(E.length=1,E[0]=e.e=e.s=0),e;if(i==0?(E.length=b,u=1,b--):(E.length=b+1,u=Lp(10,hi-i),E[b]=o>0?(v/Lp(10,h-o)%Lp(10,o)|0)*u:0),g)for(;;)if(b==0){(E[0]+=u)==Fa&&(E[0]=1,++e.e);break}else{if(E[b]+=u,E[b]!=Fa)break;E[b--]=0,u=1}for(i=E.length;E[--i]===0;)E.pop();if(bi&&(e.e>AA||e.e<-AA))throw Error(U3+ga(e));return e}function Bge(e,t){var n,i,o,u,h,p,g,v,b,E,T=e.constructor,C=T.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new T(e),bi?Qr(t,C):t;if(g=e.d,E=t.d,i=t.e,v=e.e,g=g.slice(),h=v-i,h){for(b=h<0,b?(n=g,h=-h,p=E.length):(n=E,i=v,p=g.length),o=Math.max(Math.ceil(C/hi),p)+2,h>o&&(h=o,n.length=1),n.reverse(),o=h;o--;)n.push(0);n.reverse()}else{for(o=g.length,p=E.length,b=o<p,b&&(p=o),o=0;o<p;o++)if(g[o]!=E[o]){b=g[o]<E[o];break}h=0}for(b&&(n=g,g=E,E=n,t.s=-t.s),p=g.length,o=E.length-p;o>0;--o)g[p++]=0;for(o=E.length;o>h;){if(g[--o]<E[o]){for(u=o;u&&g[--u]===0;)g[u]=Fa-1;--g[u],g[o]+=Fa}g[o]-=E[o]}for(;g[--p]===0;)g.pop();for(;g[0]===0;g.shift())--i;return g[0]?(t.d=g,t.e=i,bi?Qr(t,C):t):new T(0)}function vm(e,t,n){var i,o=ga(e),u=Iu(e.d),h=u.length;return t?(n&&(i=n-h)>0?u=u.charAt(0)+"."+u.slice(1)+Bh(i):h>1&&(u=u.charAt(0)+"."+u.slice(1)),u=u+(o<0?"e":"e+")+o):o<0?(u="0."+Bh(-o-1)+u,n&&(i=n-h)>0&&(u+=Bh(i))):o>=h?(u+=Bh(o+1-h),n&&(i=n-o-1)>0&&(u=u+"."+Bh(i))):((i=o+1)<h&&(u=u.slice(0,i)+"."+u.slice(i)),n&&(i=n-h)>0&&(o+1===h&&(u+="."),u+=Bh(i))),e.s<0?"-"+u:u}function _re(e,t){if(e.length>t)return e.length=t,!0}function $ge(e){var t,n,i;function o(u){var h=this;if(!(h instanceof o))return new o(u);if(h.constructor=o,u instanceof o){h.s=u.s,h.e=u.e,h.d=(u=u.d)?u.slice():u;return}if(typeof u=="number"){if(u*0!==0)throw Error(em+u);if(u>0)h.s=1;else if(u<0)u=-u,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(u===~~u&&u<1e7){h.e=0,h.d=[u];return}return yre(h,u.toString())}else if(typeof u!="string")throw Error(em+u);if(u.charCodeAt(0)===45?(u=u.slice(1),h.s=-1):h.s=1,Bft.test(u))yre(h,u);else throw Error(em+u)}if(o.prototype=zt,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=$ge,o.config=o.set=$ft,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return o.config(e),o}function $ft(e){if(!e||typeof e!="object")throw Error(Vc+"Object expected");var t,n,i,o=["precision",1,v_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((i=e[n=o[t]])!==void 0)if(y_(i)===i&&i>=o[t+1]&&i<=o[t+2])this[n]=i;else throw Error(em+n+": "+i);if((i=e[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(em+n+": "+i);return this}var F3=$ge(Vft);Vo=new F3(1);const Kr=F3;function Wft(e){return Kft(e)||zft(e)||Hft(e)||Gft()}function Gft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hft(e,t){if(e){if(typeof e=="string")return NF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NF(e,t)}}function zft(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Kft(e){if(Array.isArray(e))return NF(e)}function NF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var qft=function(t){return t},Wge={},Gge=function(t){return t===Wge},bre=function(t){return function n(){return arguments.length===0||arguments.length===1&&Gge(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},Yft=function e(t,n){return t===1?n:bre(function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];var h=o.filter(function(p){return p!==Wge}).length;return h>=t?n.apply(void 0,o):e(t-h,bre(function(){for(var p=arguments.length,g=new Array(p),v=0;v<p;v++)g[v]=arguments[v];var b=o.map(function(E){return Gge(E)?g.shift():E});return n.apply(void 0,Wft(b).concat(g))}))})},nO=function(t){return Yft(t.length,t)},AF=function(t,n){for(var i=[],o=t;o<n;++o)i[o-t]=o;return i},Xft=nO(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),Jft=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.length)return qft;var o=n.reverse(),u=o[0],h=o.slice(1);return function(){return h.reduce(function(p,g){return g(p)},u.apply(void 0,arguments))}},IF=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Hge=function(t){var n=null,i=null;return function(){for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];return n&&u.every(function(p,g){return p===n[g]})||(n=u,i=t.apply(void 0,u)),i}};function Zft(e){var t;return e===0?t=1:t=Math.floor(new Kr(e).abs().log(10).toNumber())+1,t}function Qft(e,t,n){for(var i=new Kr(e),o=0,u=[];i.lt(t)&&o<1e5;)u.push(i.toNumber()),i=i.add(n),o++;return u}var ept=nO(function(e,t,n){var i=+e,o=+t;return i+n*(o-i)}),tpt=nO(function(e,t,n){var i=t-+e;return i=i||1/0,(n-e)/i}),npt=nO(function(e,t,n){var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(n-e)/i))});const rO={rangeStep:Qft,getDigitCount:Zft,interpolateNumber:ept,uninterpolateNumber:tpt,uninterpolateTruncation:npt};function OF(e){return apt(e)||ipt(e)||zge(e)||rpt()}function rpt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ipt(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function apt(e){if(Array.isArray(e))return PF(e)}function ow(e,t){return cpt(e)||opt(e,t)||zge(e,t)||spt()}function spt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zge(e,t){if(e){if(typeof e=="string")return PF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PF(e,t)}}function PF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function opt(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],i=!0,o=!1,u=void 0;try{for(var h=e[Symbol.iterator](),p;!(i=(p=h.next()).done)&&(n.push(p.value),!(t&&n.length===t));i=!0);}catch(g){o=!0,u=g}finally{try{!i&&h.return!=null&&h.return()}finally{if(o)throw u}}return n}}function cpt(e){if(Array.isArray(e))return e}function Kge(e){var t=ow(e,2),n=t[0],i=t[1],o=n,u=i;return n>i&&(o=i,u=n),[o,u]}function qge(e,t,n){if(e.lte(0))return new Kr(0);var i=rO.getDigitCount(e.toNumber()),o=new Kr(10).pow(i),u=e.div(o),h=i!==1?.05:.1,p=new Kr(Math.ceil(u.div(h).toNumber())).add(n).mul(h),g=p.mul(o);return t?g:new Kr(Math.ceil(g))}function lpt(e,t,n){var i=1,o=new Kr(e);if(!o.isint()&&n){var u=Math.abs(e);u<1?(i=new Kr(10).pow(rO.getDigitCount(e)-1),o=new Kr(Math.floor(o.div(i).toNumber())).mul(i)):u>1&&(o=new Kr(Math.floor(e)))}else e===0?o=new Kr(Math.floor((t-1)/2)):n||(o=new Kr(Math.floor(e)));var h=Math.floor((t-1)/2),p=Jft(Xft(function(g){return o.add(new Kr(g-h).mul(i)).toNumber()}),AF);return p(0,t)}function Yge(e,t,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Kr(0),tickMin:new Kr(0),tickMax:new Kr(0)};var u=qge(new Kr(t).sub(e).div(n-1),i,o),h;e<=0&&t>=0?h=new Kr(0):(h=new Kr(e).add(t).div(2),h=h.sub(new Kr(h).mod(u)));var p=Math.ceil(h.sub(e).div(u).toNumber()),g=Math.ceil(new Kr(t).sub(h).div(u).toNumber()),v=p+g+1;return v>n?Yge(e,t,n,i,o+1):(v<n&&(g=t>0?g+(n-v):g,p=t>0?p:p+(n-v)),{step:u,tickMin:h.sub(new Kr(p).mul(u)),tickMax:h.add(new Kr(g).mul(u))})}function upt(e){var t=ow(e,2),n=t[0],i=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(o,2),p=Kge([n,i]),g=ow(p,2),v=g[0],b=g[1];if(v===-1/0||b===1/0){var E=b===1/0?[v].concat(OF(AF(0,o-1).map(function(){return 1/0}))):[].concat(OF(AF(0,o-1).map(function(){return-1/0})),[b]);return n>i?IF(E):E}if(v===b)return lpt(v,o,u);var T=Yge(v,b,h,u),C=T.step,R=T.tickMin,N=T.tickMax,O=rO.rangeStep(R,N.add(new Kr(.1).mul(C)),C);return n>i?IF(O):O}function dpt(e,t){var n=ow(e,2),i=n[0],o=n[1],u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Kge([i,o]),p=ow(h,2),g=p[0],v=p[1];if(g===-1/0||v===1/0)return[i,o];if(g===v)return[g];var b=Math.max(t,2),E=qge(new Kr(v).sub(g).div(b-1),u,0),T=[].concat(OF(rO.rangeStep(new Kr(g),new Kr(v).sub(new Kr(.99).mul(E)),E)),[v]);return i>o?IF(T):T}var hpt=Hge(upt),fpt=Hge(dpt),ppt="Invariant failed";function ym(e,t){throw new Error(ppt)}var mpt=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ny(e){"@babel/helpers - typeof";return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}function IA(){return IA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},IA.apply(this,arguments)}function gpt(e,t){return bpt(e)||_pt(e,t)||ypt(e,t)||vpt()}function vpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ypt(e,t){if(e){if(typeof e=="string")return Ere(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ere(e,t)}}function Ere(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _pt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function bpt(e){if(Array.isArray(e))return e}function Ept(e,t){if(e==null)return{};var n=wpt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function wpt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Spt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xpt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zge(i.key),i)}}function Tpt(e,t,n){return t&&xpt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cpt(e,t,n){return t=OA(t),Rpt(e,Xge()?Reflect.construct(t,n||[],OA(e).constructor):t.apply(e,n))}function Rpt(e,t){if(t&&(Ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Npt(e)}function Npt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xge=function(){return!!e})()}function OA(e){return OA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},OA(e)}function Apt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kF(e,t)}function kF(e,t){return kF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},kF(e,t)}function Jge(e,t,n){return t=Zge(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zge(e){var t=Ipt(e,"string");return Ny(t)=="symbol"?t:t+""}function Ipt(e,t){if(Ny(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ny(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var iO=function(e){function t(){return Spt(this,t),Cpt(this,t,arguments)}return Apt(t,e),Tpt(t,[{key:"render",value:function(){var i=this.props,o=i.offset,u=i.layout,h=i.width,p=i.dataKey,g=i.data,v=i.dataPointFormatter,b=i.xAxis,E=i.yAxis,T=Ept(i,mpt),C=Tr(T,!1);this.props.direction==="x"&&b.type!=="number"&&ym();var R=g.map(function(N){var O=v(N,p),j=O.x,k=O.y,P=O.value,M=O.errorVal;if(!M)return null;var D=[],U,F;if(Array.isArray(M)){var H=gpt(M,2);U=H[0],F=H[1]}else U=F=M;if(u==="vertical"){var W=b.scale,q=k+o,Y=q+h,z=q-h,Z=W(P-U),X=W(P+F);D.push({x1:X,y1:Y,x2:X,y2:z}),D.push({x1:Z,y1:q,x2:X,y2:q}),D.push({x1:Z,y1:Y,x2:Z,y2:z})}else if(u==="horizontal"){var ae=E.scale,se=j+o,J=se-h,re=se+h,ee=ae(P-U),de=ae(P+F);D.push({x1:J,y1:de,x2:re,y2:de}),D.push({x1:se,y1:ee,x2:se,y2:de}),D.push({x1:J,y1:ee,x2:re,y2:ee})}return me.createElement($a,IA({className:"recharts-errorBar",key:"bar-".concat(D.map(function(xe){return"".concat(xe.x1,"-").concat(xe.x2,"-").concat(xe.y1,"-").concat(xe.y2)}))},C),D.map(function(xe){return me.createElement("line",IA({},xe,{key:"line-".concat(xe.x1,"-").concat(xe.x2,"-").concat(xe.y1,"-").concat(xe.y2)}))}))});return me.createElement($a,{className:"recharts-errorBars"},R)}}])}(me.Component);Jge(iO,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Jge(iO,"displayName","ErrorBar");function cw(e){"@babel/helpers - typeof";return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cw(e)}function wre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ap(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wre(Object(n),!0).forEach(function(i){Opt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Opt(e,t,n){return t=Ppt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ppt(e){var t=kpt(e,"string");return cw(t)=="symbol"?t:t+""}function kpt(e,t){if(cw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(cw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qge=function(t){var n=t.children,i=t.formattedGraphicalItems,o=t.legendWidth,u=t.legendContent,h=Mo(n,kd);if(!h)return null;var p=kd.defaultProps,g=p!==void 0?Ap(Ap({},p),h.props):{},v;return h.props&&h.props.payload?v=h.props&&h.props.payload:u==="children"?v=(i||[]).reduce(function(b,E){var T=E.item,C=E.props,R=C.sectors||C.data||[];return b.concat(R.map(function(N){return{type:h.props.iconType||T.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):v=(i||[]).map(function(b){var E=b.item,T=E.type.defaultProps,C=T!==void 0?Ap(Ap({},T),E.props):{},R=C.dataKey,N=C.name,O=C.legendType,j=C.hide;return{inactive:j,dataKey:R,type:g.iconType||O||"square",color:V3(E),value:N||R,payload:C}}),Ap(Ap(Ap({},g),kd.getWithHeight(h,o)),{},{payload:v,item:h})};function lw(e){"@babel/helpers - typeof";return lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(e)}function Sre(e){return Mpt(e)||Lpt(e)||Dpt(e)||jpt()}function jpt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dpt(e,t){if(e){if(typeof e=="string")return jF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jF(e,t)}}function Lpt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mpt(e){if(Array.isArray(e))return jF(e)}function jF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function xre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Bi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xre(Object(n),!0).forEach(function(i){Gv(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Gv(e,t,n){return t=Upt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Upt(e){var t=Fpt(e,"string");return lw(t)=="symbol"?t:t+""}function Fpt(e,t){if(lw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(lw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wu(e,t,n){return Nr(e)||Nr(t)?n:Oa(t)?Mc(e,t,n):Kn(t)?t(e):n}function i0(e,t,n,i){var o=Lft(e,function(p){return Wu(p,t)});if(n==="number"){var u=o.filter(function(p){return xt(p)||parseFloat(p)});return u.length?[tO(u),eO(u)]:[1/0,-1/0]}var h=i?o.filter(function(p){return!Nr(p)}):o;return h.map(function(p){return Oa(p)||p instanceof Date?p:""})}var Vpt=function(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,h=-1,p=(n=i==null?void 0:i.length)!==null&&n!==void 0?n:0;if(p<=1)return 0;if(u&&u.axisType==="angleAxis"&&Math.abs(Math.abs(u.range[1]-u.range[0])-360)<=1e-6)for(var g=u.range,v=0;v<p;v++){var b=v>0?o[v-1].coordinate:o[p-1].coordinate,E=o[v].coordinate,T=v>=p-1?o[0].coordinate:o[v+1].coordinate,C=void 0;if(kl(E-b)!==kl(T-E)){var R=[];if(kl(T-E)===kl(g[1]-g[0])){C=T;var N=E+g[1]-g[0];R[0]=Math.min(N,(N+b)/2),R[1]=Math.max(N,(N+b)/2)}else{C=b;var O=T+g[1]-g[0];R[0]=Math.min(E,(O+E)/2),R[1]=Math.max(E,(O+E)/2)}var j=[Math.min(E,(C+E)/2),Math.max(E,(C+E)/2)];if(t>j[0]&&t<=j[1]||t>=R[0]&&t<=R[1]){h=o[v].index;break}}else{var k=Math.min(b,T),P=Math.max(b,T);if(t>(k+E)/2&&t<=(P+E)/2){h=o[v].index;break}}}else for(var M=0;M<p;M++)if(M===0&&t<=(i[M].coordinate+i[M+1].coordinate)/2||M>0&&M<p-1&&t>(i[M].coordinate+i[M-1].coordinate)/2&&t<=(i[M].coordinate+i[M+1].coordinate)/2||M===p-1&&t>(i[M].coordinate+i[M-1].coordinate)/2){h=i[M].index;break}return h},V3=function(t){var n,i=t,o=i.type.displayName,u=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Bi(Bi({},t.type.defaultProps),t.props):t.props,h=u.stroke,p=u.fill,g;switch(o){case"Line":g=h;break;case"Area":case"Radar":g=h&&h!=="none"?h:p;break;default:g=p;break}return g},Bpt=function(t){var n=t.barSize,i=t.totalSize,o=t.stackGroups,u=o===void 0?{}:o;if(!u)return{};for(var h={},p=Object.keys(u),g=0,v=p.length;g<v;g++)for(var b=u[p[g]].stackGroups,E=Object.keys(b),T=0,C=E.length;T<C;T++){var R=b[E[T]],N=R.items,O=R.cateAxisId,j=N.filter(function(F){return Od(F.type).indexOf("Bar")>=0});if(j&&j.length){var k=j[0].type.defaultProps,P=k!==void 0?Bi(Bi({},k),j[0].props):j[0].props,M=P.barSize,D=P[O];h[D]||(h[D]=[]);var U=Nr(M)?n:M;h[D].push({item:j[0],stackList:j.slice(1),barSize:Nr(U)?void 0:gm(U,i,0)})}}return h},$pt=function(t){var n=t.barGap,i=t.barCategoryGap,o=t.bandSize,u=t.sizeList,h=u===void 0?[]:u,p=t.maxBarSize,g=h.length;if(g<1)return null;var v=gm(n,o,0,!0),b,E=[];if(h[0].barSize===+h[0].barSize){var T=!1,C=o/g,R=h.reduce(function(M,D){return M+D.barSize||0},0);R+=(g-1)*v,R>=o&&(R-=(g-1)*v,v=0),R>=o&&C>0&&(T=!0,C*=.9,R=g*C);var N=(o-R)/2>>0,O={offset:N-v,size:0};b=h.reduce(function(M,D){var U={item:D.item,position:{offset:O.offset+O.size+v,size:T?C:D.barSize}},F=[].concat(Sre(M),[U]);return O=F[F.length-1].position,D.stackList&&D.stackList.length&&D.stackList.forEach(function(H){F.push({item:H,position:O})}),F},E)}else{var j=gm(i,o,0,!0);o-2*j-(g-1)*v<=0&&(v=0);var k=(o-2*j-(g-1)*v)/g;k>1&&(k>>=0);var P=p===+p?Math.min(k,p):k;b=h.reduce(function(M,D,U){var F=[].concat(Sre(M),[{item:D.item,position:{offset:j+(k+v)*U+(k-P)/2,size:P}}]);return D.stackList&&D.stackList.length&&D.stackList.forEach(function(H){F.push({item:H,position:F[F.length-1].position})}),F},E)}return b},Wpt=function(t,n,i,o){var u=i.children,h=i.width,p=i.margin,g=h-(p.left||0)-(p.right||0),v=Qge({children:u,legendWidth:g});if(v){var b=o||{},E=b.width,T=b.height,C=v.align,R=v.verticalAlign,N=v.layout;if((N==="vertical"||N==="horizontal"&&R==="middle")&&C!=="center"&&xt(t[C]))return Bi(Bi({},t),{},Gv({},C,t[C]+(E||0)));if((N==="horizontal"||N==="vertical"&&C==="center")&&R!=="middle"&&xt(t[R]))return Bi(Bi({},t),{},Gv({},R,t[R]+(T||0)))}return t},Gpt=function(t,n,i){return Nr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||i==="x"?n==="xAxis":i==="y"?n==="yAxis":!0},eve=function(t,n,i,o,u){var h=n.props.children,p=Ml(h,iO).filter(function(v){return Gpt(o,u,v.props.direction)});if(p&&p.length){var g=p.map(function(v){return v.props.dataKey});return t.reduce(function(v,b){var E=Wu(b,i);if(Nr(E))return v;var T=Array.isArray(E)?[tO(E),eO(E)]:[E,E],C=g.reduce(function(R,N){var O=Wu(b,N,0),j=T[0]-Math.abs(Array.isArray(O)?O[0]:O),k=T[1]+Math.abs(Array.isArray(O)?O[1]:O);return[Math.min(j,R[0]),Math.max(k,R[1])]},[1/0,-1/0]);return[Math.min(C[0],v[0]),Math.max(C[1],v[1])]},[1/0,-1/0])}return null},Hpt=function(t,n,i,o,u){var h=n.map(function(p){return eve(t,p,i,u,o)}).filter(function(p){return!Nr(p)});return h&&h.length?h.reduce(function(p,g){return[Math.min(p[0],g[0]),Math.max(p[1],g[1])]},[1/0,-1/0]):null},tve=function(t,n,i,o,u){var h=n.map(function(g){var v=g.props.dataKey;return i==="number"&&v&&eve(t,g,v,o)||i0(t,v,i,u)});if(i==="number")return h.reduce(function(g,v){return[Math.min(g[0],v[0]),Math.max(g[1],v[1])]},[1/0,-1/0]);var p={};return h.reduce(function(g,v){for(var b=0,E=v.length;b<E;b++)p[v[b]]||(p[v[b]]=!0,g.push(v[b]));return g},[])},nve=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},rve=function(t,n,i,o){if(o)return t.map(function(g){return g.coordinate});var u,h,p=t.map(function(g){return g.coordinate===n&&(u=!0),g.coordinate===i&&(h=!0),g.coordinate});return u||p.push(n),h||p.push(i),p},Rd=function(t,n,i){if(!t)return null;var o=t.scale,u=t.duplicateDomain,h=t.type,p=t.range,g=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,v=(n||i)&&h==="category"&&o.bandwidth?o.bandwidth()/g:0;if(v=t.axisType==="angleAxis"&&(p==null?void 0:p.length)>=2?kl(p[0]-p[1])*2*v:v,n&&(t.ticks||t.niceTicks)){var b=(t.ticks||t.niceTicks).map(function(E){var T=u?u.indexOf(E):E;return{coordinate:o(T)+v,value:E,offset:v}});return b.filter(function(E){return!oS(E.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(E,T){return{coordinate:o(E)+v,value:E,index:T,offset:v}}):o.ticks&&!i?o.ticks(t.tickCount).map(function(E){return{coordinate:o(E)+v,value:E,offset:v}}):o.domain().map(function(E,T){return{coordinate:o(E)+v,value:u?u[E]:E,index:T,offset:v}})},KL=new WeakMap,uR=function(t,n){if(typeof n!="function")return t;KL.has(t)||KL.set(t,new WeakMap);var i=KL.get(t);if(i.has(n))return i.get(n);var o=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return i.set(n,o),o},zpt=function(t,n,i){var o=t.scale,u=t.type,h=t.layout,p=t.axisType;if(o==="auto")return h==="radial"&&p==="radiusAxis"?{scale:tw(),realScaleType:"band"}:h==="radial"&&p==="angleAxis"?{scale:TA(),realScaleType:"linear"}:u==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!i)?{scale:r0(),realScaleType:"point"}:u==="category"?{scale:tw(),realScaleType:"band"}:{scale:TA(),realScaleType:"linear"};if(mm(o)){var g="scale".concat(BI(o));return{scale:(vre[g]||r0)(),realScaleType:vre[g]?g:"point"}}return Kn(o)?{scale:o}:{scale:r0(),realScaleType:"point"}},Tre=1e-4,Kpt=function(t){var n=t.domain();if(!(!n||n.length<=2)){var i=n.length,o=t.range(),u=Math.min(o[0],o[1])-Tre,h=Math.max(o[0],o[1])+Tre,p=t(n[0]),g=t(n[i-1]);(p<u||p>h||g<u||g>h)&&t.domain([n[0],n[i-1]])}},qpt=function(t,n){if(!t)return null;for(var i=0,o=t.length;i<o;i++)if(t[i].item===n)return t[i].position;return null},Ypt=function(t,n){if(!n||n.length!==2||!xt(n[0])||!xt(n[1]))return t;var i=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]),u=[t[0],t[1]];return(!xt(t[0])||t[0]<i)&&(u[0]=i),(!xt(t[1])||t[1]>o)&&(u[1]=o),u[0]>o&&(u[0]=o),u[1]<i&&(u[1]=i),u},Xpt=function(t){var n=t.length;if(!(n<=0))for(var i=0,o=t[0].length;i<o;++i)for(var u=0,h=0,p=0;p<n;++p){var g=oS(t[p][i][1])?t[p][i][0]:t[p][i][1];g>=0?(t[p][i][0]=u,t[p][i][1]=u+g,u=t[p][i][1]):(t[p][i][0]=h,t[p][i][1]=h+g,h=t[p][i][1])}},Jpt=function(t){var n=t.length;if(!(n<=0))for(var i=0,o=t[0].length;i<o;++i)for(var u=0,h=0;h<n;++h){var p=oS(t[h][i][1])?t[h][i][0]:t[h][i][1];p>=0?(t[h][i][0]=u,t[h][i][1]=u+p,u=t[h][i][1]):(t[h][i][0]=0,t[h][i][1]=0)}},Zpt={sign:Xpt,expand:ftt,none:by,silhouette:ptt,wiggle:mtt,positive:Jpt},Qpt=function(t,n,i){var o=n.map(function(p){return p.props.dataKey}),u=Zpt[i],h=htt().keys(o).value(function(p,g){return+Wu(p,g,0)}).order(aF).offset(u);return h(t)},emt=function(t,n,i,o,u,h){if(!t)return null;var p=h?n.reverse():n,g={},v=p.reduce(function(E,T){var C,R=(C=T.type)!==null&&C!==void 0&&C.defaultProps?Bi(Bi({},T.type.defaultProps),T.props):T.props,N=R.stackId,O=R.hide;if(O)return E;var j=R[i],k=E[j]||{hasStack:!1,stackGroups:{}};if(Oa(N)){var P=k.stackGroups[N]||{numericAxisId:i,cateAxisId:o,items:[]};P.items.push(T),k.hasStack=!0,k.stackGroups[N]=P}else k.stackGroups[VI("_stackId_")]={numericAxisId:i,cateAxisId:o,items:[T]};return Bi(Bi({},E),{},Gv({},j,k))},g),b={};return Object.keys(v).reduce(function(E,T){var C=v[T];if(C.hasStack){var R={};C.stackGroups=Object.keys(C.stackGroups).reduce(function(N,O){var j=C.stackGroups[O];return Bi(Bi({},N),{},Gv({},O,{numericAxisId:i,cateAxisId:o,items:j.items,stackedData:Qpt(t,j.items,u)}))},R)}return Bi(Bi({},E),{},Gv({},T,C))},b)},tmt=function(t,n){var i=n.realScaleType,o=n.type,u=n.tickCount,h=n.originalDomain,p=n.allowDecimals,g=i||n.scale;if(g!=="auto"&&g!=="linear")return null;if(u&&o==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var v=t.domain();if(!v.length)return null;var b=hpt(v,u,p);return t.domain([tO(b),eO(b)]),{niceTicks:b}}if(u&&o==="number"){var E=t.domain(),T=fpt(E,u,p);return{niceTicks:T}}return null},Cre=function(t){var n=t.axis,i=t.ticks,o=t.offset,u=t.bandSize,h=t.entry,p=t.index;if(n.type==="category")return i[p]?i[p].coordinate+o:null;var g=Wu(h,n.dataKey,n.domain[p]);return Nr(g)?null:n.scale(g)-u/2+o},nmt=function(t){var n=t.numericAxis,i=n.scale.domain();if(n.type==="number"){var o=Math.min(i[0],i[1]),u=Math.max(i[0],i[1]);return o<=0&&u>=0?0:u<0?u:o}return i[0]},rmt=function(t,n){var i,o=(i=t.type)!==null&&i!==void 0&&i.defaultProps?Bi(Bi({},t.type.defaultProps),t.props):t.props,u=o.stackId;if(Oa(u)){var h=n[u];if(h){var p=h.items.indexOf(t);return p>=0?h.stackedData[p]:null}}return null},imt=function(t){return t.reduce(function(n,i){return[tO(i.concat([n[0]]).filter(xt)),eO(i.concat([n[1]]).filter(xt))]},[1/0,-1/0])},ive=function(t,n,i){return Object.keys(t).reduce(function(o,u){var h=t[u],p=h.stackedData,g=p.reduce(function(v,b){var E=imt(b.slice(n,i+1));return[Math.min(v[0],E[0]),Math.max(v[1],E[1])]},[1/0,-1/0]);return[Math.min(g[0],o[0]),Math.max(g[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},Rre=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Nre=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DF=function(t,n,i){if(Kn(t))return t(n,i);if(!Array.isArray(t))return n;var o=[];if(xt(t[0]))o[0]=i?t[0]:Math.min(t[0],n[0]);else if(Rre.test(t[0])){var u=+Rre.exec(t[0])[1];o[0]=n[0]-u}else Kn(t[0])?o[0]=t[0](n[0]):o[0]=n[0];if(xt(t[1]))o[1]=i?t[1]:Math.max(t[1],n[1]);else if(Nre.test(t[1])){var h=+Nre.exec(t[1])[1];o[1]=n[1]+h}else Kn(t[1])?o[1]=t[1](n[1]):o[1]=n[1];return o},PA=function(t,n,i){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!i||o>0)return o}if(t&&n&&n.length>=2){for(var u=h3(n,function(E){return E.coordinate}),h=1/0,p=1,g=u.length;p<g;p++){var v=u[p],b=u[p-1];h=Math.min((v.coordinate||0)-(b.coordinate||0),h)}return h===1/0?0:h}return i?void 0:0},Are=function(t,n,i){return!t||!t.length||M3(t,Mc(i,"type.defaultProps.domain"))?n:t},ave=function(t,n){var i=t.type.defaultProps?Bi(Bi({},t.type.defaultProps),t.props):t.props,o=i.dataKey,u=i.name,h=i.unit,p=i.formatter,g=i.tooltipType,v=i.chartType,b=i.hide;return Bi(Bi({},Tr(t,!1)),{},{dataKey:o,unit:h,formatter:p,name:u||o,color:V3(t),value:Wu(n,o),type:g,payload:n,chartType:v,hide:b})};function uw(e){"@babel/helpers - typeof";return uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uw(e)}function Ire(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ore(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ire(Object(n),!0).forEach(function(i){amt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ire(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function amt(e,t,n){return t=smt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function smt(e){var t=omt(e,"string");return uw(t)=="symbol"?t:t+""}function omt(e,t){if(uw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(uw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kA=Math.PI/180,cmt=function(t){return t*180/Math.PI},ts=function(t,n,i,o){return{x:t+Math.cos(-kA*o)*i,y:n+Math.sin(-kA*o)*i}},lmt=function(t,n){var i=t.x,o=t.y,u=n.x,h=n.y;return Math.sqrt(Math.pow(i-u,2)+Math.pow(o-h,2))},umt=function(t,n){var i=t.x,o=t.y,u=n.cx,h=n.cy,p=lmt({x:i,y:o},{x:u,y:h});if(p<=0)return{radius:p};var g=(i-u)/p,v=Math.acos(g);return o>h&&(v=2*Math.PI-v),{radius:p,angle:cmt(v),angleInRadian:v}},dmt=function(t){var n=t.startAngle,i=t.endAngle,o=Math.floor(n/360),u=Math.floor(i/360),h=Math.min(o,u);return{startAngle:n-h*360,endAngle:i-h*360}},hmt=function(t,n){var i=n.startAngle,o=n.endAngle,u=Math.floor(i/360),h=Math.floor(o/360),p=Math.min(u,h);return t+p*360},Pre=function(t,n){var i=t.x,o=t.y,u=umt({x:i,y:o},n),h=u.radius,p=u.angle,g=n.innerRadius,v=n.outerRadius;if(h<g||h>v)return!1;if(h===0)return!0;var b=dmt(n),E=b.startAngle,T=b.endAngle,C=p,R;if(E<=T){for(;C>T;)C-=360;for(;C<E;)C+=360;R=C>=E&&C<=T}else{for(;C>E;)C-=360;for(;C<T;)C+=360;R=C>=T&&C<=E}return R?Ore(Ore({},n),{},{radius:h,angle:hmt(C,n)}):null};function dw(e){"@babel/helpers - typeof";return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dw(e)}var fmt=["offset"];function pmt(e){return ymt(e)||vmt(e)||gmt(e)||mmt()}function mmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gmt(e,t){if(e){if(typeof e=="string")return LF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LF(e,t)}}function vmt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ymt(e){if(Array.isArray(e))return LF(e)}function LF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _mt(e,t){if(e==null)return{};var n=bmt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function bmt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function kre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ca(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kre(Object(n),!0).forEach(function(i){Emt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Emt(e,t,n){return t=wmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wmt(e){var t=Smt(e,"string");return dw(t)=="symbol"?t:t+""}function Smt(e,t){if(dw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(dw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hw(){return hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},hw.apply(this,arguments)}var xmt=function(t){var n=t.value,i=t.formatter,o=Nr(t.children)?n:t.children;return Kn(i)?i(o):o},Tmt=function(t,n){var i=kl(n-t),o=Math.min(Math.abs(n-t),360);return i*o},Cmt=function(t,n,i){var o=t.position,u=t.viewBox,h=t.offset,p=t.className,g=u,v=g.cx,b=g.cy,E=g.innerRadius,T=g.outerRadius,C=g.startAngle,R=g.endAngle,N=g.clockWise,O=(E+T)/2,j=Tmt(C,R),k=j>=0?1:-1,P,M;o==="insideStart"?(P=C+k*h,M=N):o==="insideEnd"?(P=R-k*h,M=!N):o==="end"&&(P=R+k*h,M=N),M=j<=0?M:!M;var D=ts(v,b,O,P),U=ts(v,b,O,P+(M?1:-1)*359),F="M".concat(D.x,",").concat(D.y,`
    A`).concat(O,",").concat(O,",0,1,").concat(M?0:1,`,
    `).concat(U.x,",").concat(U.y),H=Nr(t.id)?VI("recharts-radial-line-"):t.id;return me.createElement("text",hw({},i,{dominantBaseline:"central",className:er("recharts-radial-bar-label",p)}),me.createElement("defs",null,me.createElement("path",{id:H,d:F})),me.createElement("textPath",{xlinkHref:"#".concat(H)},n))},Rmt=function(t){var n=t.viewBox,i=t.offset,o=t.position,u=n,h=u.cx,p=u.cy,g=u.innerRadius,v=u.outerRadius,b=u.startAngle,E=u.endAngle,T=(b+E)/2;if(o==="outside"){var C=ts(h,p,v+i,T),R=C.x,N=C.y;return{x:R,y:N,textAnchor:R>=h?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:h,y:p,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:h,y:p,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:h,y:p,textAnchor:"middle",verticalAnchor:"end"};var O=(g+v)/2,j=ts(h,p,O,T),k=j.x,P=j.y;return{x:k,y:P,textAnchor:"middle",verticalAnchor:"middle"}},Nmt=function(t){var n=t.viewBox,i=t.parentViewBox,o=t.offset,u=t.position,h=n,p=h.x,g=h.y,v=h.width,b=h.height,E=b>=0?1:-1,T=E*o,C=E>0?"end":"start",R=E>0?"start":"end",N=v>=0?1:-1,O=N*o,j=N>0?"end":"start",k=N>0?"start":"end";if(u==="top"){var P={x:p+v/2,y:g-E*o,textAnchor:"middle",verticalAnchor:C};return Ca(Ca({},P),i?{height:Math.max(g-i.y,0),width:v}:{})}if(u==="bottom"){var M={x:p+v/2,y:g+b+T,textAnchor:"middle",verticalAnchor:R};return Ca(Ca({},M),i?{height:Math.max(i.y+i.height-(g+b),0),width:v}:{})}if(u==="left"){var D={x:p-O,y:g+b/2,textAnchor:j,verticalAnchor:"middle"};return Ca(Ca({},D),i?{width:Math.max(D.x-i.x,0),height:b}:{})}if(u==="right"){var U={x:p+v+O,y:g+b/2,textAnchor:k,verticalAnchor:"middle"};return Ca(Ca({},U),i?{width:Math.max(i.x+i.width-U.x,0),height:b}:{})}var F=i?{width:v,height:b}:{};return u==="insideLeft"?Ca({x:p+O,y:g+b/2,textAnchor:k,verticalAnchor:"middle"},F):u==="insideRight"?Ca({x:p+v-O,y:g+b/2,textAnchor:j,verticalAnchor:"middle"},F):u==="insideTop"?Ca({x:p+v/2,y:g+T,textAnchor:"middle",verticalAnchor:R},F):u==="insideBottom"?Ca({x:p+v/2,y:g+b-T,textAnchor:"middle",verticalAnchor:C},F):u==="insideTopLeft"?Ca({x:p+O,y:g+T,textAnchor:k,verticalAnchor:R},F):u==="insideTopRight"?Ca({x:p+v-O,y:g+T,textAnchor:j,verticalAnchor:R},F):u==="insideBottomLeft"?Ca({x:p+O,y:g+b-T,textAnchor:k,verticalAnchor:C},F):u==="insideBottomRight"?Ca({x:p+v-O,y:g+b-T,textAnchor:j,verticalAnchor:C},F):l_(u)&&(xt(u.x)||Bp(u.x))&&(xt(u.y)||Bp(u.y))?Ca({x:p+gm(u.x,v),y:g+gm(u.y,b),textAnchor:"end",verticalAnchor:"end"},F):Ca({x:p+v/2,y:g+b/2,textAnchor:"middle",verticalAnchor:"middle"},F)},Amt=function(t){return"cx"in t&&xt(t.cx)};function bs(e){var t=e.offset,n=t===void 0?5:t,i=_mt(e,fmt),o=Ca({offset:n},i),u=o.viewBox,h=o.position,p=o.value,g=o.children,v=o.content,b=o.className,E=b===void 0?"":b,T=o.textBreakAll;if(!u||Nr(p)&&Nr(g)&&!w.isValidElement(v)&&!Kn(v))return null;if(w.isValidElement(v))return w.cloneElement(v,o);var C;if(Kn(v)){if(C=w.createElement(v,o),w.isValidElement(C))return C}else C=xmt(o);var R=Amt(u),N=Tr(o,!0);if(R&&(h==="insideStart"||h==="insideEnd"||h==="end"))return Cmt(o,C,N);var O=R?Rmt(o):Nmt(o);return me.createElement(yA,hw({className:er("recharts-label",E)},N,O,{breakAll:T}),C)}bs.displayName="Label";var sve=function(t){var n=t.cx,i=t.cy,o=t.angle,u=t.startAngle,h=t.endAngle,p=t.r,g=t.radius,v=t.innerRadius,b=t.outerRadius,E=t.x,T=t.y,C=t.top,R=t.left,N=t.width,O=t.height,j=t.clockWise,k=t.labelViewBox;if(k)return k;if(xt(N)&&xt(O)){if(xt(E)&&xt(T))return{x:E,y:T,width:N,height:O};if(xt(C)&&xt(R))return{x:C,y:R,width:N,height:O}}return xt(E)&&xt(T)?{x:E,y:T,width:0,height:0}:xt(n)&&xt(i)?{cx:n,cy:i,startAngle:u||o||0,endAngle:h||o||0,innerRadius:v||0,outerRadius:b||g||p||0,clockWise:j}:t.viewBox?t.viewBox:{}},Imt=function(t,n){return t?t===!0?me.createElement(bs,{key:"label-implicit",viewBox:n}):Oa(t)?me.createElement(bs,{key:"label-implicit",viewBox:n,value:t}):w.isValidElement(t)?t.type===bs?w.cloneElement(t,{key:"label-implicit",viewBox:n}):me.createElement(bs,{key:"label-implicit",content:t,viewBox:n}):Kn(t)?me.createElement(bs,{key:"label-implicit",content:t,viewBox:n}):l_(t)?me.createElement(bs,hw({viewBox:n},t,{key:"label-implicit"})):null:null},Omt=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&i&&!t.label)return null;var o=t.children,u=sve(t),h=Ml(o,bs).map(function(g,v){return w.cloneElement(g,{viewBox:n||u,key:"label-".concat(v)})});if(!i)return h;var p=Imt(t.label,n||u);return[p].concat(pmt(h))};bs.parseViewBox=sve;bs.renderCallByParent=Omt;function Pmt(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var kmt=Pmt;const jmt=jr(kmt);function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}var Dmt=["valueAccessor"],Lmt=["data","dataKey","clockWise","id","textBreakAll"];function Mmt(e){return Bmt(e)||Vmt(e)||Fmt(e)||Umt()}function Umt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fmt(e,t){if(e){if(typeof e=="string")return MF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MF(e,t)}}function Vmt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bmt(e){if(Array.isArray(e))return MF(e)}function MF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function jA(){return jA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},jA.apply(this,arguments)}function jre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Dre(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jre(Object(n),!0).forEach(function(i){$mt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function $mt(e,t,n){return t=Wmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wmt(e){var t=Gmt(e,"string");return fw(t)=="symbol"?t:t+""}function Gmt(e,t){if(fw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(fw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lre(e,t){if(e==null)return{};var n=Hmt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Hmt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var zmt=function(t){return Array.isArray(t.value)?jmt(t.value):t.value};function tm(e){var t=e.valueAccessor,n=t===void 0?zmt:t,i=Lre(e,Dmt),o=i.data,u=i.dataKey,h=i.clockWise,p=i.id,g=i.textBreakAll,v=Lre(i,Lmt);return!o||!o.length?null:me.createElement($a,{className:"recharts-label-list"},o.map(function(b,E){var T=Nr(u)?n(b,E):Wu(b&&b.payload,u),C=Nr(p)?{}:{id:"".concat(p,"-").concat(E)};return me.createElement(bs,jA({},Tr(b,!0),v,C,{parentViewBox:b.parentViewBox,value:T,textBreakAll:g,viewBox:bs.parseViewBox(Nr(h)?b:Dre(Dre({},b),{},{clockWise:h})),key:"label-".concat(E),index:E}))}))}tm.displayName="LabelList";function Kmt(e,t){return e?e===!0?me.createElement(tm,{key:"labelList-implicit",data:t}):me.isValidElement(e)||Kn(e)?me.createElement(tm,{key:"labelList-implicit",data:t,content:e}):l_(e)?me.createElement(tm,jA({data:t},e,{key:"labelList-implicit"})):null:null}function qmt(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,o=Ml(i,tm).map(function(h,p){return w.cloneElement(h,{data:t,key:"labelList-".concat(p)})});if(!n)return o;var u=Kmt(e.label,t);return[u].concat(Mmt(o))}tm.renderCallByParent=qmt;function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function UF(){return UF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},UF.apply(this,arguments)}function Mre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ure(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mre(Object(n),!0).forEach(function(i){Ymt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Ymt(e,t,n){return t=Xmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xmt(e){var t=Jmt(e,"string");return pw(t)=="symbol"?t:t+""}function Jmt(e,t){if(pw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(pw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zmt=function(t,n){var i=kl(n-t),o=Math.min(Math.abs(n-t),359.999);return i*o},dR=function(t){var n=t.cx,i=t.cy,o=t.radius,u=t.angle,h=t.sign,p=t.isExternal,g=t.cornerRadius,v=t.cornerIsExternal,b=g*(p?1:-1)+o,E=Math.asin(g/b)/kA,T=v?u:u+h*E,C=ts(n,i,b,T),R=ts(n,i,o,T),N=v?u-h*E:u,O=ts(n,i,b*Math.cos(E*kA),N);return{center:C,circleTangency:R,lineTangency:O,theta:E}},ove=function(t){var n=t.cx,i=t.cy,o=t.innerRadius,u=t.outerRadius,h=t.startAngle,p=t.endAngle,g=Zmt(h,p),v=h+g,b=ts(n,i,u,h),E=ts(n,i,u,v),T="M ".concat(b.x,",").concat(b.y,`
    A `).concat(u,",").concat(u,`,0,
    `).concat(+(Math.abs(g)>180),",").concat(+(h>v),`,
    `).concat(E.x,",").concat(E.y,`
  `);if(o>0){var C=ts(n,i,o,h),R=ts(n,i,o,v);T+="L ".concat(R.x,",").concat(R.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(g)>180),",").concat(+(h<=v),`,
            `).concat(C.x,",").concat(C.y," Z")}else T+="L ".concat(n,",").concat(i," Z");return T},Qmt=function(t){var n=t.cx,i=t.cy,o=t.innerRadius,u=t.outerRadius,h=t.cornerRadius,p=t.forceCornerRadius,g=t.cornerIsExternal,v=t.startAngle,b=t.endAngle,E=kl(b-v),T=dR({cx:n,cy:i,radius:u,angle:v,sign:E,cornerRadius:h,cornerIsExternal:g}),C=T.circleTangency,R=T.lineTangency,N=T.theta,O=dR({cx:n,cy:i,radius:u,angle:b,sign:-E,cornerRadius:h,cornerIsExternal:g}),j=O.circleTangency,k=O.lineTangency,P=O.theta,M=g?Math.abs(v-b):Math.abs(v-b)-N-P;if(M<0)return p?"M ".concat(R.x,",").concat(R.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):ove({cx:n,cy:i,innerRadius:o,outerRadius:u,startAngle:v,endAngle:b});var D="M ".concat(R.x,",").concat(R.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(C.x,",").concat(C.y,`
    A`).concat(u,",").concat(u,",0,").concat(+(M>180),",").concat(+(E<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(k.x,",").concat(k.y,`
  `);if(o>0){var U=dR({cx:n,cy:i,radius:o,angle:v,sign:E,isExternal:!0,cornerRadius:h,cornerIsExternal:g}),F=U.circleTangency,H=U.lineTangency,W=U.theta,q=dR({cx:n,cy:i,radius:o,angle:b,sign:-E,isExternal:!0,cornerRadius:h,cornerIsExternal:g}),Y=q.circleTangency,z=q.lineTangency,Z=q.theta,X=g?Math.abs(v-b):Math.abs(v-b)-W-Z;if(X<0&&h===0)return"".concat(D,"L").concat(n,",").concat(i,"Z");D+="L".concat(z.x,",").concat(z.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(Y.x,",").concat(Y.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(X>180),",").concat(+(E>0),",").concat(F.x,",").concat(F.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(E<0),",").concat(H.x,",").concat(H.y,"Z")}else D+="L".concat(n,",").concat(i,"Z");return D},egt={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},cve=function(t){var n=Ure(Ure({},egt),t),i=n.cx,o=n.cy,u=n.innerRadius,h=n.outerRadius,p=n.cornerRadius,g=n.forceCornerRadius,v=n.cornerIsExternal,b=n.startAngle,E=n.endAngle,T=n.className;if(h<u||b===E)return null;var C=er("recharts-sector",T),R=h-u,N=gm(p,R,0,!0),O;return N>0&&Math.abs(b-E)<360?O=Qmt({cx:i,cy:o,innerRadius:u,outerRadius:h,cornerRadius:Math.min(N,R/2),forceCornerRadius:g,cornerIsExternal:v,startAngle:b,endAngle:E}):O=ove({cx:i,cy:o,innerRadius:u,outerRadius:h,startAngle:b,endAngle:E}),me.createElement("path",UF({},Tr(n,!0),{className:C,d:O,role:"img"}))};function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}function FF(){return FF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},FF.apply(this,arguments)}function Fre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Vre(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fre(Object(n),!0).forEach(function(i){tgt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function tgt(e,t,n){return t=ngt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ngt(e){var t=rgt(e,"string");return mw(t)=="symbol"?t:t+""}function rgt(e,t){if(mw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(mw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bre={curveBasisClosed:ttt,curveBasisOpen:ntt,curveBasis:ett,curveBumpX:Vet,curveBumpY:Bet,curveLinearClosed:rtt,curveLinear:WI,curveMonotoneX:itt,curveMonotoneY:att,curveNatural:stt,curveStep:ott,curveStepAfter:ltt,curveStepBefore:ctt},hR=function(t){return t.x===+t.x&&t.y===+t.y},CE=function(t){return t.x},RE=function(t){return t.y},igt=function(t,n){if(Kn(t))return t;var i="curve".concat(BI(t));return(i==="curveMonotone"||i==="curveBump")&&n?Bre["".concat(i).concat(n==="vertical"?"Y":"X")]:Bre[i]||WI},agt=function(t){var n=t.type,i=n===void 0?"linear":n,o=t.points,u=o===void 0?[]:o,h=t.baseLine,p=t.layout,g=t.connectNulls,v=g===void 0?!1:g,b=igt(i,p),E=v?u.filter(function(N){return hR(N)}):u,T;if(Array.isArray(h)){var C=v?h.filter(function(N){return hR(N)}):h,R=E.map(function(N,O){return Vre(Vre({},N),{},{base:C[O]})});return p==="vertical"?T=nR().y(RE).x1(CE).x0(function(N){return N.base.x}):T=nR().x(CE).y1(RE).y0(function(N){return N.base.y}),T.defined(hR).curve(b),T(R)}return p==="vertical"&&xt(h)?T=nR().y(RE).x1(CE).x0(h):xt(h)?T=nR().x(CE).y1(RE).y0(h):T=cme().x(CE).y(RE),T.defined(hR).curve(b),T(E)},$re=function(t){var n=t.className,i=t.points,o=t.path,u=t.pathRef;if((!i||!i.length)&&!o)return null;var h=i&&i.length?agt(t):o;return w.createElement("path",FF({},Tr(t,!1),rA(t),{className:er("recharts-curve",n),d:h,ref:u}))},lve={exports:{}},sgt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ogt=sgt,cgt=ogt;function uve(){}function dve(){}dve.resetWarningCache=uve;var lgt=function(){function e(i,o,u,h,p,g){if(g!==cgt){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:dve,resetWarningCache:uve};return n.PropTypes=n,n};lve.exports=lgt();var ugt=lve.exports;const Or=jr(ugt);var dgt=Object.getOwnPropertyNames,hgt=Object.getOwnPropertySymbols,fgt=Object.prototype.hasOwnProperty;function Wre(e,t){return function(i,o,u){return e(i,o,u)&&t(i,o,u)}}function fR(e){return function(n,i,o){if(!n||!i||typeof n!="object"||typeof i!="object")return e(n,i,o);var u=o.cache,h=u.get(n),p=u.get(i);if(h&&p)return h===i&&p===n;u.set(n,i),u.set(i,n);var g=e(n,i,o);return u.delete(n),u.delete(i),g}}function Gre(e){return dgt(e).concat(hgt(e))}var pgt=Object.hasOwn||function(e,t){return fgt.call(e,t)};function km(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var mgt="__v",ggt="__o",vgt="_owner",Hre=Object.getOwnPropertyDescriptor,zre=Object.keys;function ygt(e,t,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!n.equals(e[i],t[i],i,i,e,t,n))return!1;return!0}function _gt(e,t){return km(e.getTime(),t.getTime())}function bgt(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Egt(e,t){return e===t}function Kre(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var o=new Array(i),u=e.entries(),h,p,g=0;(h=u.next())&&!h.done;){for(var v=t.entries(),b=!1,E=0;(p=v.next())&&!p.done;){if(o[E]){E++;continue}var T=h.value,C=p.value;if(n.equals(T[0],C[0],g,E,e,t,n)&&n.equals(T[1],C[1],T[0],C[0],e,t,n)){b=o[E]=!0;break}E++}if(!b)return!1;g++}return!0}var wgt=km;function Sgt(e,t,n){var i=zre(e),o=i.length;if(zre(t).length!==o)return!1;for(;o-- >0;)if(!hve(e,t,n,i[o]))return!1;return!0}function NE(e,t,n){var i=Gre(e),o=i.length;if(Gre(t).length!==o)return!1;for(var u,h,p;o-- >0;)if(u=i[o],!hve(e,t,n,u)||(h=Hre(e,u),p=Hre(t,u),(h||p)&&(!h||!p||h.configurable!==p.configurable||h.enumerable!==p.enumerable||h.writable!==p.writable)))return!1;return!0}function xgt(e,t){return km(e.valueOf(),t.valueOf())}function Tgt(e,t){return e.source===t.source&&e.flags===t.flags}function qre(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var o=new Array(i),u=e.values(),h,p;(h=u.next())&&!h.done;){for(var g=t.values(),v=!1,b=0;(p=g.next())&&!p.done;){if(!o[b]&&n.equals(h.value,p.value,h.value,p.value,e,t,n)){v=o[b]=!0;break}b++}if(!v)return!1}return!0}function Cgt(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Rgt(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function hve(e,t,n,i){return(i===vgt||i===ggt||i===mgt)&&(e.$$typeof||t.$$typeof)?!0:pgt(t,i)&&n.equals(e[i],t[i],i,i,e,t,n)}var Ngt="[object Arguments]",Agt="[object Boolean]",Igt="[object Date]",Ogt="[object Error]",Pgt="[object Map]",kgt="[object Number]",jgt="[object Object]",Dgt="[object RegExp]",Lgt="[object Set]",Mgt="[object String]",Ugt="[object URL]",Fgt=Array.isArray,Yre=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Xre=Object.assign,Vgt=Object.prototype.toString.call.bind(Object.prototype.toString);function Bgt(e){var t=e.areArraysEqual,n=e.areDatesEqual,i=e.areErrorsEqual,o=e.areFunctionsEqual,u=e.areMapsEqual,h=e.areNumbersEqual,p=e.areObjectsEqual,g=e.arePrimitiveWrappersEqual,v=e.areRegExpsEqual,b=e.areSetsEqual,E=e.areTypedArraysEqual,T=e.areUrlsEqual;return function(R,N,O){if(R===N)return!0;if(R==null||N==null)return!1;var j=typeof R;if(j!==typeof N)return!1;if(j!=="object")return j==="number"?h(R,N,O):j==="function"?o(R,N,O):!1;var k=R.constructor;if(k!==N.constructor)return!1;if(k===Object)return p(R,N,O);if(Fgt(R))return t(R,N,O);if(Yre!=null&&Yre(R))return E(R,N,O);if(k===Date)return n(R,N,O);if(k===RegExp)return v(R,N,O);if(k===Map)return u(R,N,O);if(k===Set)return b(R,N,O);var P=Vgt(R);return P===Igt?n(R,N,O):P===Dgt?v(R,N,O):P===Pgt?u(R,N,O):P===Lgt?b(R,N,O):P===jgt?typeof R.then!="function"&&typeof N.then!="function"&&p(R,N,O):P===Ugt?T(R,N,O):P===Ogt?i(R,N,O):P===Ngt?p(R,N,O):P===Agt||P===kgt||P===Mgt?g(R,N,O):!1}}function $gt(e){var t=e.circular,n=e.createCustomConfig,i=e.strict,o={areArraysEqual:i?NE:ygt,areDatesEqual:_gt,areErrorsEqual:bgt,areFunctionsEqual:Egt,areMapsEqual:i?Wre(Kre,NE):Kre,areNumbersEqual:wgt,areObjectsEqual:i?NE:Sgt,arePrimitiveWrappersEqual:xgt,areRegExpsEqual:Tgt,areSetsEqual:i?Wre(qre,NE):qre,areTypedArraysEqual:i?NE:Cgt,areUrlsEqual:Rgt};if(n&&(o=Xre({},o,n(o))),t){var u=fR(o.areArraysEqual),h=fR(o.areMapsEqual),p=fR(o.areObjectsEqual),g=fR(o.areSetsEqual);o=Xre({},o,{areArraysEqual:u,areMapsEqual:h,areObjectsEqual:p,areSetsEqual:g})}return o}function Wgt(e){return function(t,n,i,o,u,h,p){return e(t,n,p)}}function Ggt(e){var t=e.circular,n=e.comparator,i=e.createState,o=e.equals,u=e.strict;if(i)return function(g,v){var b=i(),E=b.cache,T=E===void 0?t?new WeakMap:void 0:E,C=b.meta;return n(g,v,{cache:T,equals:o,meta:C,strict:u})};if(t)return function(g,v){return n(g,v,{cache:new WeakMap,equals:o,meta:void 0,strict:u})};var h={cache:void 0,equals:o,meta:void 0,strict:u};return function(g,v){return n(g,v,h)}}var Hgt=Bf();Bf({strict:!0});Bf({circular:!0});Bf({circular:!0,strict:!0});Bf({createInternalComparator:function(){return km}});Bf({strict:!0,createInternalComparator:function(){return km}});Bf({circular:!0,createInternalComparator:function(){return km}});Bf({circular:!0,createInternalComparator:function(){return km},strict:!0});function Bf(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,i=e.createInternalComparator,o=e.createState,u=e.strict,h=u===void 0?!1:u,p=$gt(e),g=Bgt(p),v=i?i(g):Wgt(g);return Ggt({circular:n,comparator:g,createState:o,equals:v,strict:h})}function zgt(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Jre(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=function o(u){n<0&&(n=u),u-n>t?(e(u),n=-1):zgt(o)};requestAnimationFrame(i)}function VF(e){"@babel/helpers - typeof";return VF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VF(e)}function Kgt(e){return Jgt(e)||Xgt(e)||Ygt(e)||qgt()}function qgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ygt(e,t){if(e){if(typeof e=="string")return Zre(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zre(e,t)}}function Zre(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Xgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jgt(e){if(Array.isArray(e))return e}function Zgt(){var e={},t=function(){return null},n=!1,i=function o(u){if(!n){if(Array.isArray(u)){if(!u.length)return;var h=u,p=Kgt(h),g=p[0],v=p.slice(1);if(typeof g=="number"){Jre(o.bind(null,v),g);return}o(g),Jre(o.bind(null,v));return}VF(u)==="object"&&(e=u,t(e)),typeof u=="function"&&u()}};return{stop:function(){n=!0},start:function(u){n=!1,i(u)},subscribe:function(u){return t=u,function(){t=function(){return null}}}}}function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function Qre(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function eie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qre(Object(n),!0).forEach(function(i){fve(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qre(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function fve(e,t,n){return t=Qgt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qgt(e){var t=evt(e,"string");return gw(t)==="symbol"?t:String(t)}function evt(e,t){if(gw(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(gw(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tvt=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(i,o){return i.filter(function(u){return o.includes(u)})})},nvt=function(t){return t},rvt=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},a0=function(t,n){return Object.keys(n).reduce(function(i,o){return eie(eie({},i),{},fve({},o,t(o,n[o])))},{})},tie=function(t,n,i){return t.map(function(o){return"".concat(rvt(o)," ").concat(n,"ms ").concat(i)}).join(",")};function ivt(e,t){return ovt(e)||svt(e,t)||pve(e,t)||avt()}function avt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function svt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function ovt(e){if(Array.isArray(e))return e}function cvt(e){return dvt(e)||uvt(e)||pve(e)||lvt()}function lvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pve(e,t){if(e){if(typeof e=="string")return BF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BF(e,t)}}function uvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dvt(e){if(Array.isArray(e))return BF(e)}function BF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var DA=1e-4,mve=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},gve=function(t,n){return t.map(function(i,o){return i*Math.pow(n,o)}).reduce(function(i,o){return i+o})},nie=function(t,n){return function(i){var o=mve(t,n);return gve(o,i)}},hvt=function(t,n){return function(i){var o=mve(t,n),u=[].concat(cvt(o.map(function(h,p){return h*p}).slice(1)),[0]);return gve(u,i)}},rie=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0],u=n[1],h=n[2],p=n[3];if(n.length===1)switch(n[0]){case"linear":o=0,u=0,h=1,p=1;break;case"ease":o=.25,u=.1,h=.25,p=1;break;case"ease-in":o=.42,u=0,h=1,p=1;break;case"ease-out":o=.42,u=0,h=.58,p=1;break;case"ease-in-out":o=0,u=0,h=.58,p=1;break;default:{var g=n[0].split("(");if(g[0]==="cubic-bezier"&&g[1].split(")")[0].split(",").length===4){var v=g[1].split(")")[0].split(",").map(function(O){return parseFloat(O)}),b=ivt(v,4);o=b[0],u=b[1],h=b[2],p=b[3]}}}var E=nie(o,h),T=nie(u,p),C=hvt(o,h),R=function(j){return j>1?1:j<0?0:j},N=function(j){for(var k=j>1?1:j,P=k,M=0;M<8;++M){var D=E(P)-k,U=C(P);if(Math.abs(D-k)<DA||U<DA)return T(P);P=R(P-D/U)}return T(P)};return N.isStepper=!1,N},fvt=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,i=n===void 0?100:n,o=t.damping,u=o===void 0?8:o,h=t.dt,p=h===void 0?17:h,g=function(b,E,T){var C=-(b-E)*i,R=T*u,N=T+(C-R)*p/1e3,O=T*p/1e3+b;return Math.abs(O-E)<DA&&Math.abs(N)<DA?[E,0]:[O,N]};return g.isStepper=!0,g.dt=p,g},pvt=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return rie(o);case"spring":return fvt();default:if(o.split("(")[0]==="cubic-bezier")return rie(o)}return typeof o=="function"?o:null};function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function iie(e){return vvt(e)||gvt(e)||vve(e)||mvt()}function mvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vvt(e){if(Array.isArray(e))return WF(e)}function aie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Za(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aie(Object(n),!0).forEach(function(i){$F(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function $F(e,t,n){return t=yvt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yvt(e){var t=_vt(e,"string");return vw(t)==="symbol"?t:String(t)}function _vt(e,t){if(vw(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(vw(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bvt(e,t){return Svt(e)||wvt(e,t)||vve(e,t)||Evt()}function Evt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vve(e,t){if(e){if(typeof e=="string")return WF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WF(e,t)}}function WF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function wvt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Svt(e){if(Array.isArray(e))return e}var LA=function(t,n,i){return t+(n-t)*i},GF=function(t){var n=t.from,i=t.to;return n!==i},xvt=function e(t,n,i){var o=a0(function(u,h){if(GF(h)){var p=t(h.from,h.to,h.velocity),g=bvt(p,2),v=g[0],b=g[1];return Za(Za({},h),{},{from:v,velocity:b})}return h},n);return i<1?a0(function(u,h){return GF(h)?Za(Za({},h),{},{velocity:LA(h.velocity,o[u].velocity,i),from:LA(h.from,o[u].from,i)}):h},n):e(t,o,i-1)};const Tvt=function(e,t,n,i,o){var u=tvt(e,t),h=u.reduce(function(O,j){return Za(Za({},O),{},$F({},j,[e[j],t[j]]))},{}),p=u.reduce(function(O,j){return Za(Za({},O),{},$F({},j,{from:e[j],velocity:0,to:t[j]}))},{}),g=-1,v,b,E=function(){return null},T=function(){return a0(function(j,k){return k.from},p)},C=function(){return!Object.values(p).filter(GF).length},R=function(j){v||(v=j);var k=j-v,P=k/n.dt;p=xvt(n,p,P),o(Za(Za(Za({},e),t),T())),v=j,C()||(g=requestAnimationFrame(E))},N=function(j){b||(b=j);var k=(j-b)/i,P=a0(function(D,U){return LA.apply(void 0,iie(U).concat([n(k)]))},h);if(o(Za(Za(Za({},e),t),P)),k<1)g=requestAnimationFrame(E);else{var M=a0(function(D,U){return LA.apply(void 0,iie(U).concat([n(1)]))},h);o(Za(Za(Za({},e),t),M))}};return E=n.isStepper?R:N,function(){return requestAnimationFrame(E),function(){cancelAnimationFrame(g)}}};function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}var Cvt=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Rvt(e,t){if(e==null)return{};var n=Nvt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Nvt(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,u;for(u=0;u<i.length;u++)o=i[u],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function qL(e){return Pvt(e)||Ovt(e)||Ivt(e)||Avt()}function Avt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ivt(e,t){if(e){if(typeof e=="string")return HF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HF(e,t)}}function Ovt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pvt(e){if(Array.isArray(e))return HF(e)}function HF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function sie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function ml(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sie(Object(n),!0).forEach(function(i){WE(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function WE(e,t,n){return t=yve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jvt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,yve(i.key),i)}}function Dvt(e,t,n){return t&&jvt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yve(e){var t=Lvt(e,"string");return Ay(t)==="symbol"?t:String(t)}function Lvt(e,t){if(Ay(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ay(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zF(e,t)}function zF(e,t){return zF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},zF(e,t)}function Uvt(e){var t=Fvt();return function(){var i=MA(e),o;if(t){var u=MA(this).constructor;o=Reflect.construct(i,arguments,u)}else o=i.apply(this,arguments);return KF(this,o)}}function KF(e,t){if(t&&(Ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qF(e)}function qF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MA(e){return MA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},MA(e)}var Tf=function(e){Mvt(n,e);var t=Uvt(n);function n(i,o){var u;kvt(this,n),u=t.call(this,i,o);var h=u.props,p=h.isActive,g=h.attributeName,v=h.from,b=h.to,E=h.steps,T=h.children,C=h.duration;if(u.handleStyleChange=u.handleStyleChange.bind(qF(u)),u.changeStyle=u.changeStyle.bind(qF(u)),!p||C<=0)return u.state={style:{}},typeof T=="function"&&(u.state={style:b}),KF(u);if(E&&E.length)u.state={style:E[0].style};else if(v){if(typeof T=="function")return u.state={style:v},KF(u);u.state={style:g?WE({},g,v):v}}else u.state={style:{}};return u}return Dvt(n,[{key:"componentDidMount",value:function(){var o=this.props,u=o.isActive,h=o.canBegin;this.mounted=!0,!(!u||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var u=this.props,h=u.isActive,p=u.canBegin,g=u.attributeName,v=u.shouldReAnimate,b=u.to,E=u.from,T=this.state.style;if(p){if(!h){var C={style:g?WE({},g,b):b};this.state&&T&&(g&&T[g]!==b||!g&&T!==b)&&this.setState(C);return}if(!(Hgt(o.to,b)&&o.canBegin&&o.isActive)){var R=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=R||v?E:o.to;if(this.state&&T){var O={style:g?WE({},g,N):N};(g&&T[g]!==N||!g&&T!==N)&&this.setState(O)}this.runAnimation(ml(ml({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var u=this,h=o.from,p=o.to,g=o.duration,v=o.easing,b=o.begin,E=o.onAnimationEnd,T=o.onAnimationStart,C=Tvt(h,p,pvt(v),g,this.changeStyle),R=function(){u.stopJSAnimation=C()};this.manager.start([T,b,R,g,E])}},{key:"runStepAnimation",value:function(o){var u=this,h=o.steps,p=o.begin,g=o.onAnimationStart,v=h[0],b=v.style,E=v.duration,T=E===void 0?0:E,C=function(N,O,j){if(j===0)return N;var k=O.duration,P=O.easing,M=P===void 0?"ease":P,D=O.style,U=O.properties,F=O.onAnimationEnd,H=j>0?h[j-1]:O,W=U||Object.keys(D);if(typeof M=="function"||M==="spring")return[].concat(qL(N),[u.runJSAnimation.bind(u,{from:H.style,to:D,duration:k,easing:M}),k]);var q=tie(W,k,M),Y=ml(ml(ml({},H.style),D),{},{transition:q});return[].concat(qL(N),[Y,k,F]).filter(nvt)};return this.manager.start([g].concat(qL(h.reduce(C,[b,Math.max(T,p)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=Zgt());var u=o.begin,h=o.duration,p=o.attributeName,g=o.to,v=o.easing,b=o.onAnimationStart,E=o.onAnimationEnd,T=o.steps,C=o.children,R=this.manager;if(this.unSubscribe=R.subscribe(this.handleStyleChange),typeof v=="function"||typeof C=="function"||v==="spring"){this.runJSAnimation(o);return}if(T.length>1){this.runStepAnimation(o);return}var N=p?WE({},p,g):g,O=tie(Object.keys(N),h,v);R.start([b,u,ml(ml({},N),{},{transition:O}),h,E])}},{key:"render",value:function(){var o=this.props,u=o.children;o.begin;var h=o.duration;o.attributeName,o.easing;var p=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var g=Rvt(o,Cvt),v=w.Children.count(u),b=this.state.style;if(typeof u=="function")return u(b);if(!p||v===0||h<=0)return u;var E=function(C){var R=C.props,N=R.style,O=N===void 0?{}:N,j=R.className,k=w.cloneElement(C,ml(ml({},g),{},{style:ml(ml({},O),b),className:j}));return k};return v===1?E(w.Children.only(u)):me.createElement("div",null,w.Children.map(u,function(T){return E(T)}))}}]),n}(w.PureComponent);Tf.displayName="Animate";Tf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Tf.propTypes={from:Or.oneOfType([Or.object,Or.string]),to:Or.oneOfType([Or.object,Or.string]),attributeName:Or.string,duration:Or.number,begin:Or.number,easing:Or.oneOfType([Or.string,Or.func]),steps:Or.arrayOf(Or.shape({duration:Or.number.isRequired,style:Or.object.isRequired,easing:Or.oneOfType([Or.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Or.func]),properties:Or.arrayOf("string"),onAnimationEnd:Or.func})),children:Or.oneOfType([Or.node,Or.func]),isActive:Or.bool,canBegin:Or.bool,onAnimationEnd:Or.func,shouldReAnimate:Or.bool,onAnimationStart:Or.func,onAnimationReStart:Or.func};function yw(e){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function UA(){return UA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},UA.apply(this,arguments)}function Vvt(e,t){return Gvt(e)||Wvt(e,t)||$vt(e,t)||Bvt()}function Bvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $vt(e,t){if(e){if(typeof e=="string")return oie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oie(e,t)}}function oie(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Wvt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Gvt(e){if(Array.isArray(e))return e}function cie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function lie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cie(Object(n),!0).forEach(function(i){Hvt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Hvt(e,t,n){return t=zvt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zvt(e){var t=Kvt(e,"string");return yw(t)=="symbol"?t:t+""}function Kvt(e,t){if(yw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(yw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uie=function(t,n,i,o,u){var h=Math.min(Math.abs(i)/2,Math.abs(o)/2),p=o>=0?1:-1,g=i>=0?1:-1,v=o>=0&&i>=0||o<0&&i<0?1:0,b;if(h>0&&u instanceof Array){for(var E=[0,0,0,0],T=0,C=4;T<C;T++)E[T]=u[T]>h?h:u[T];b="M".concat(t,",").concat(n+p*E[0]),E[0]>0&&(b+="A ".concat(E[0],",").concat(E[0],",0,0,").concat(v,",").concat(t+g*E[0],",").concat(n)),b+="L ".concat(t+i-g*E[1],",").concat(n),E[1]>0&&(b+="A ".concat(E[1],",").concat(E[1],",0,0,").concat(v,`,
        `).concat(t+i,",").concat(n+p*E[1])),b+="L ".concat(t+i,",").concat(n+o-p*E[2]),E[2]>0&&(b+="A ".concat(E[2],",").concat(E[2],",0,0,").concat(v,`,
        `).concat(t+i-g*E[2],",").concat(n+o)),b+="L ".concat(t+g*E[3],",").concat(n+o),E[3]>0&&(b+="A ".concat(E[3],",").concat(E[3],",0,0,").concat(v,`,
        `).concat(t,",").concat(n+o-p*E[3])),b+="Z"}else if(h>0&&u===+u&&u>0){var R=Math.min(h,u);b="M ".concat(t,",").concat(n+p*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t+g*R,",").concat(n,`
            L `).concat(t+i-g*R,",").concat(n,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t+i,",").concat(n+p*R,`
            L `).concat(t+i,",").concat(n+o-p*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t+i-g*R,",").concat(n+o,`
            L `).concat(t+g*R,",").concat(n+o,`
            A `).concat(R,",").concat(R,",0,0,").concat(v,",").concat(t,",").concat(n+o-p*R," Z")}else b="M ".concat(t,",").concat(n," h ").concat(i," v ").concat(o," h ").concat(-i," Z");return b},qvt=function(t,n){if(!t||!n)return!1;var i=t.x,o=t.y,u=n.x,h=n.y,p=n.width,g=n.height;if(Math.abs(p)>0&&Math.abs(g)>0){var v=Math.min(u,u+p),b=Math.max(u,u+p),E=Math.min(h,h+g),T=Math.max(h,h+g);return i>=v&&i<=b&&o>=E&&o<=T}return!1},Yvt={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},B3=function(t){var n=lie(lie({},Yvt),t),i=w.useRef(),o=w.useState(-1),u=Vvt(o,2),h=u[0],p=u[1];w.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var M=i.current.getTotalLength();M&&p(M)}catch{}},[]);var g=n.x,v=n.y,b=n.width,E=n.height,T=n.radius,C=n.className,R=n.animationEasing,N=n.animationDuration,O=n.animationBegin,j=n.isAnimationActive,k=n.isUpdateAnimationActive;if(g!==+g||v!==+v||b!==+b||E!==+E||b===0||E===0)return null;var P=er("recharts-rectangle",C);return k?me.createElement(Tf,{canBegin:h>0,from:{width:b,height:E,x:g,y:v},to:{width:b,height:E,x:g,y:v},duration:N,animationEasing:R,isActive:k},function(M){var D=M.width,U=M.height,F=M.x,H=M.y;return me.createElement(Tf,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:O,duration:N,isActive:j,easing:R},me.createElement("path",UA({},Tr(n,!0),{className:P,d:uie(F,H,D,U,T),ref:i})))}):me.createElement("path",UA({},Tr(n,!0),{className:P,d:uie(g,v,b,E,T)}))};function YF(){return YF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},YF.apply(this,arguments)}var _ve=function(t){var n=t.cx,i=t.cy,o=t.r,u=t.className,h=er("recharts-dot",u);return n===+n&&i===+i&&o===+o?w.createElement("circle",YF({},Tr(t,!1),rA(t),{className:h,cx:n,cy:i,r:o})):null};function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}var Xvt=["x","y","top","left","width","height","className"];function XF(){return XF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},XF.apply(this,arguments)}function die(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Jvt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?die(Object(n),!0).forEach(function(i){Zvt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):die(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Zvt(e,t,n){return t=Qvt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qvt(e){var t=eyt(e,"string");return _w(t)=="symbol"?t:t+""}function eyt(e,t){if(_w(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(_w(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tyt(e,t){if(e==null)return{};var n=nyt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function nyt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var ryt=function(t,n,i,o,u,h){return"M".concat(t,",").concat(u,"v").concat(o,"M").concat(h,",").concat(n,"h").concat(i)},iyt=function(t){var n=t.x,i=n===void 0?0:n,o=t.y,u=o===void 0?0:o,h=t.top,p=h===void 0?0:h,g=t.left,v=g===void 0?0:g,b=t.width,E=b===void 0?0:b,T=t.height,C=T===void 0?0:T,R=t.className,N=tyt(t,Xvt),O=Jvt({x:i,y:u,top:p,left:v,width:E,height:C},N);return!xt(i)||!xt(u)||!xt(E)||!xt(C)||!xt(p)||!xt(v)?null:me.createElement("path",XF({},Tr(O,!0),{className:er("recharts-cross",R),d:ryt(i,u,E,C,p,v)}))},ayt=Pme,syt=ayt(Object.getPrototypeOf,Object),oyt=syt,cyt=Xd,lyt=oyt,uyt=Jd,dyt="[object Object]",hyt=Function.prototype,fyt=Object.prototype,bve=hyt.toString,pyt=fyt.hasOwnProperty,myt=bve.call(Object);function gyt(e){if(!uyt(e)||cyt(e)!=dyt)return!1;var t=lyt(e);if(t===null)return!0;var n=pyt.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&bve.call(n)==myt}var vyt=gyt;const yyt=jr(vyt);var _yt=Xd,byt=Jd,Eyt="[object Boolean]";function wyt(e){return e===!0||e===!1||byt(e)&&_yt(e)==Eyt}var Syt=wyt;const xyt=jr(Syt);function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function FA(){return FA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},FA.apply(this,arguments)}function Tyt(e,t){return Ayt(e)||Nyt(e,t)||Ryt(e,t)||Cyt()}function Cyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ryt(e,t){if(e){if(typeof e=="string")return hie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hie(e,t)}}function hie(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Nyt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function Ayt(e){if(Array.isArray(e))return e}function fie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function pie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fie(Object(n),!0).forEach(function(i){Iyt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Iyt(e,t,n){return t=Oyt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oyt(e){var t=Pyt(e,"string");return bw(t)=="symbol"?t:t+""}function Pyt(e,t){if(bw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(bw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mie=function(t,n,i,o,u){var h=i-o,p;return p="M ".concat(t,",").concat(n),p+="L ".concat(t+i,",").concat(n),p+="L ".concat(t+i-h/2,",").concat(n+u),p+="L ".concat(t+i-h/2-o,",").concat(n+u),p+="L ".concat(t,",").concat(n," Z"),p},kyt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jyt=function(t){var n=pie(pie({},kyt),t),i=w.useRef(),o=w.useState(-1),u=Tyt(o,2),h=u[0],p=u[1];w.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var P=i.current.getTotalLength();P&&p(P)}catch{}},[]);var g=n.x,v=n.y,b=n.upperWidth,E=n.lowerWidth,T=n.height,C=n.className,R=n.animationEasing,N=n.animationDuration,O=n.animationBegin,j=n.isUpdateAnimationActive;if(g!==+g||v!==+v||b!==+b||E!==+E||T!==+T||b===0&&E===0||T===0)return null;var k=er("recharts-trapezoid",C);return j?me.createElement(Tf,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:T,x:g,y:v},to:{upperWidth:b,lowerWidth:E,height:T,x:g,y:v},duration:N,animationEasing:R,isActive:j},function(P){var M=P.upperWidth,D=P.lowerWidth,U=P.height,F=P.x,H=P.y;return me.createElement(Tf,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:O,duration:N,easing:R},me.createElement("path",FA({},Tr(n,!0),{className:k,d:mie(F,H,M,D,U),ref:i})))}):me.createElement("g",null,me.createElement("path",FA({},Tr(n,!0),{className:k,d:mie(g,v,b,E,T)})))},Dyt=["option","shapeType","propTransformer","activeClassName","isActive"];function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function Lyt(e,t){if(e==null)return{};var n=Myt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Myt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function gie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function VA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gie(Object(n),!0).forEach(function(i){Uyt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Uyt(e,t,n){return t=Fyt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fyt(e){var t=Vyt(e,"string");return Ew(t)=="symbol"?t:t+""}function Vyt(e,t){if(Ew(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ew(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Byt(e,t){return VA(VA({},t),e)}function $yt(e,t){return e==="symbols"}function vie(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return me.createElement(B3,n);case"trapezoid":return me.createElement(jyt,n);case"sector":return me.createElement(cve,n);case"symbols":if($yt(t))return me.createElement(i3,n);break;default:return null}}function Wyt(e){return w.isValidElement(e)?e.props:e}function Gyt(e){var t=e.option,n=e.shapeType,i=e.propTransformer,o=i===void 0?Byt:i,u=e.activeClassName,h=u===void 0?"recharts-active-shape":u,p=e.isActive,g=Lyt(e,Dyt),v;if(w.isValidElement(t))v=w.cloneElement(t,VA(VA({},g),Wyt(t)));else if(Kn(t))v=t(g);else if(yyt(t)&&!xyt(t)){var b=o(t,g);v=me.createElement(vie,{shapeType:n,elementProps:b})}else{var E=g;v=me.createElement(vie,{shapeType:n,elementProps:E})}return p?me.createElement($a,{className:h},v):v}function aO(e,t){return t!=null&&"trapezoids"in e.props}function sO(e,t){return t!=null&&"sectors"in e.props}function ww(e,t){return t!=null&&"points"in e.props}function Hyt(e,t){var n,i,o=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,u=e.y===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.y)||e.y===t.y;return o&&u}function zyt(e,t){var n=e.endAngle===t.endAngle,i=e.startAngle===t.startAngle;return n&&i}function Kyt(e,t){var n=e.x===t.x,i=e.y===t.y,o=e.z===t.z;return n&&i&&o}function qyt(e,t){var n;return aO(e,t)?n=Hyt:sO(e,t)?n=zyt:ww(e,t)&&(n=Kyt),n}function Yyt(e,t){var n;return aO(e,t)?n="trapezoids":sO(e,t)?n="sectors":ww(e,t)&&(n="points"),n}function Xyt(e,t){if(aO(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(sO(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return ww(e,t)?t.payload:{}}function Jyt(e){var t=e.activeTooltipItem,n=e.graphicalItem,i=e.itemData,o=Yyt(n,t),u=Xyt(n,t),h=i.filter(function(g,v){var b=M3(u,g),E=n.props[o].filter(function(R){var N=qyt(n,t);return N(R,t)}),T=n.props[o].indexOf(E[E.length-1]),C=v===T;return b&&C}),p=i.indexOf(h[h.length-1]);return p}var Zyt=Math.ceil,Qyt=Math.max;function e_t(e,t,n,i){for(var o=-1,u=Qyt(Zyt((t-e)/(n||1)),0),h=Array(u);u--;)h[i?u:++o]=e,e+=n;return h}var t_t=e_t,n_t=Jme,yie=1/0,r_t=17976931348623157e292;function i_t(e){if(!e)return e===0?e:0;if(e=n_t(e),e===yie||e===-yie){var t=e<0?-1:1;return t*r_t}return e===e?e:0}var Eve=i_t,a_t=t_t,s_t=KI,YL=Eve;function o_t(e){return function(t,n,i){return i&&typeof i!="number"&&s_t(t,n,i)&&(n=i=void 0),t=YL(t),n===void 0?(n=t,t=0):n=YL(n),i=i===void 0?t<n?1:-1:YL(i),a_t(t,n,i,e)}}var c_t=o_t,l_t=c_t,u_t=l_t(),d_t=u_t;const BA=jr(d_t);function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function _ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function bie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_ie(Object(n),!0).forEach(function(i){wve(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_ie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function wve(e,t,n){return t=h_t(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h_t(e){var t=f_t(e,"string");return Sw(t)=="symbol"?t:t+""}function f_t(e,t){if(Sw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Sw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p_t=["Webkit","Moz","O","ms"],m_t=function(t,n){var i=t.replace(/(\w)/,function(u){return u.toUpperCase()}),o=p_t.reduce(function(u,h){return bie(bie({},u),{},wve({},h+i,n))},{});return o[t]=n,o};function Iy(e){"@babel/helpers - typeof";return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function $A(){return $A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},$A.apply(this,arguments)}function Eie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function XL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Eie(Object(n),!0).forEach(function(i){Do(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function g_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,xve(i.key),i)}}function v_t(e,t,n){return t&&wie(e.prototype,t),n&&wie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y_t(e,t,n){return t=WA(t),__t(e,Sve()?Reflect.construct(t,n||[],WA(e).constructor):t.apply(e,n))}function __t(e,t){if(t&&(Iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b_t(e)}function b_t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sve=function(){return!!e})()}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},WA(e)}function E_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JF(e,t)}function JF(e,t){return JF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},JF(e,t)}function Do(e,t,n){return t=xve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xve(e){var t=w_t(e,"string");return Iy(t)=="symbol"?t:t+""}function w_t(e,t){if(Iy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Iy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var S_t=function(t){var n=t.data,i=t.startIndex,o=t.endIndex,u=t.x,h=t.width,p=t.travellerWidth;if(!n||!n.length)return{};var g=n.length,v=r0().domain(BA(0,g)).range([u,u+h-p]),b=v.domain().map(function(E){return v(E)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:v(i),endX:v(o),scale:v,scaleValues:b}},Sie=function(t){return t.changedTouches&&!!t.changedTouches.length},Oy=function(e){function t(n){var i;return g_t(this,t),i=y_t(this,t,[n]),Do(i,"handleDrag",function(o){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(o):i.state.isSlideMoving&&i.handleSlideDrag(o)}),Do(i,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&i.handleDrag(o.changedTouches[0])}),Do(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=i.props,u=o.endIndex,h=o.onDragEnd,p=o.startIndex;h==null||h({endIndex:u,startIndex:p})}),i.detachDragEndListener()}),Do(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Do(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Do(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Do(i,"handleSlideDragStart",function(o){var u=Sie(o)?o.changedTouches[0]:o;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:u.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return E_t(t,e),v_t(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var o=i.startX,u=i.endX,h=this.state.scaleValues,p=this.props,g=p.gap,v=p.data,b=v.length-1,E=Math.min(o,u),T=Math.max(o,u),C=t.getIndexInRange(h,E),R=t.getIndexInRange(h,T);return{startIndex:C-C%g,endIndex:R===b?b:R-R%g}}},{key:"getTextOfTick",value:function(i){var o=this.props,u=o.data,h=o.tickFormatter,p=o.dataKey,g=Wu(u[i],p,i);return Kn(h)?h(g,i):g}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var o=this.state,u=o.slideMoveStartX,h=o.startX,p=o.endX,g=this.props,v=g.x,b=g.width,E=g.travellerWidth,T=g.startIndex,C=g.endIndex,R=g.onChange,N=i.pageX-u;N>0?N=Math.min(N,v+b-E-p,v+b-E-h):N<0&&(N=Math.max(N,v-h,v-p));var O=this.getIndex({startX:h+N,endX:p+N});(O.startIndex!==T||O.endIndex!==C)&&R&&R(O),this.setState({startX:h+N,endX:p+N,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,o){var u=Sie(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:u.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var o=this.state,u=o.brushMoveStartX,h=o.movingTravellerId,p=o.endX,g=o.startX,v=this.state[h],b=this.props,E=b.x,T=b.width,C=b.travellerWidth,R=b.onChange,N=b.gap,O=b.data,j={startX:this.state.startX,endX:this.state.endX},k=i.pageX-u;k>0?k=Math.min(k,E+T-C-v):k<0&&(k=Math.max(k,E-v)),j[h]=v+k;var P=this.getIndex(j),M=P.startIndex,D=P.endIndex,U=function(){var H=O.length-1;return h==="startX"&&(p>g?M%N===0:D%N===0)||p<g&&D===H||h==="endX"&&(p>g?D%N===0:M%N===0)||p>g&&D===H};this.setState(Do(Do({},h,v+k),"brushMoveStartX",i.pageX),function(){R&&U()&&R(P)})}},{key:"handleTravellerMoveKeyboard",value:function(i,o){var u=this,h=this.state,p=h.scaleValues,g=h.startX,v=h.endX,b=this.state[o],E=p.indexOf(b);if(E!==-1){var T=E+i;if(!(T===-1||T>=p.length)){var C=p[T];o==="startX"&&C>=v||o==="endX"&&C<=g||this.setState(Do({},o,C),function(){u.props.onChange(u.getIndex({startX:u.state.startX,endX:u.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,o=i.x,u=i.y,h=i.width,p=i.height,g=i.fill,v=i.stroke;return me.createElement("rect",{stroke:v,fill:g,x:o,y:u,width:h,height:p})}},{key:"renderPanorama",value:function(){var i=this.props,o=i.x,u=i.y,h=i.width,p=i.height,g=i.data,v=i.children,b=i.padding,E=w.Children.only(v);return E?me.cloneElement(E,{x:o,y:u,width:h,height:p,margin:b,compact:!0,data:g}):null}},{key:"renderTravellerLayer",value:function(i,o){var u,h,p=this,g=this.props,v=g.y,b=g.travellerWidth,E=g.height,T=g.traveller,C=g.ariaLabel,R=g.data,N=g.startIndex,O=g.endIndex,j=Math.max(i,this.props.x),k=XL(XL({},Tr(this.props,!1)),{},{x:j,y:v,width:b,height:E}),P=C||"Min value: ".concat((u=R[N])===null||u===void 0?void 0:u.name,", Max value: ").concat((h=R[O])===null||h===void 0?void 0:h.name);return me.createElement($a,{tabIndex:0,role:"slider","aria-label":P,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(D){["ArrowLeft","ArrowRight"].includes(D.key)&&(D.preventDefault(),D.stopPropagation(),p.handleTravellerMoveKeyboard(D.key==="ArrowRight"?1:-1,o))},onFocus:function(){p.setState({isTravellerFocused:!0})},onBlur:function(){p.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(T,k))}},{key:"renderSlide",value:function(i,o){var u=this.props,h=u.y,p=u.height,g=u.stroke,v=u.travellerWidth,b=Math.min(i,o)+v,E=Math.max(Math.abs(o-i)-v,0);return me.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:g,fillOpacity:.2,x:b,y:h,width:E,height:p})}},{key:"renderText",value:function(){var i=this.props,o=i.startIndex,u=i.endIndex,h=i.y,p=i.height,g=i.travellerWidth,v=i.stroke,b=this.state,E=b.startX,T=b.endX,C=5,R={pointerEvents:"none",fill:v};return me.createElement($a,{className:"recharts-brush-texts"},me.createElement(yA,$A({textAnchor:"end",verticalAnchor:"middle",x:Math.min(E,T)-C,y:h+p/2},R),this.getTextOfTick(o)),me.createElement(yA,$A({textAnchor:"start",verticalAnchor:"middle",x:Math.max(E,T)+g+C,y:h+p/2},R),this.getTextOfTick(u)))}},{key:"render",value:function(){var i=this.props,o=i.data,u=i.className,h=i.children,p=i.x,g=i.y,v=i.width,b=i.height,E=i.alwaysShowText,T=this.state,C=T.startX,R=T.endX,N=T.isTextActive,O=T.isSlideMoving,j=T.isTravellerMoving,k=T.isTravellerFocused;if(!o||!o.length||!xt(p)||!xt(g)||!xt(v)||!xt(b)||v<=0||b<=0)return null;var P=er("recharts-brush",u),M=me.Children.count(h)===1,D=m_t("userSelect","none");return me.createElement($a,{className:P,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:D},this.renderBackground(),M&&this.renderPanorama(),this.renderSlide(C,R),this.renderTravellerLayer(C,"startX"),this.renderTravellerLayer(R,"endX"),(N||O||j||k||E)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var o=i.x,u=i.y,h=i.width,p=i.height,g=i.stroke,v=Math.floor(u+p/2)-1;return me.createElement(me.Fragment,null,me.createElement("rect",{x:o,y:u,width:h,height:p,fill:g,stroke:"none"}),me.createElement("line",{x1:o+1,y1:v,x2:o+h-1,y2:v,fill:"none",stroke:"#fff"}),me.createElement("line",{x1:o+1,y1:v+2,x2:o+h-1,y2:v+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,o){var u;return me.isValidElement(i)?u=me.cloneElement(i,o):Kn(i)?u=i(o):u=t.renderDefaultTraveller(o),u}},{key:"getDerivedStateFromProps",value:function(i,o){var u=i.data,h=i.width,p=i.x,g=i.travellerWidth,v=i.updateId,b=i.startIndex,E=i.endIndex;if(u!==o.prevData||v!==o.prevUpdateId)return XL({prevData:u,prevTravellerWidth:g,prevUpdateId:v,prevX:p,prevWidth:h},u&&u.length?S_t({data:u,width:h,x:p,travellerWidth:g,startIndex:b,endIndex:E}):{scale:null,scaleValues:null});if(o.scale&&(h!==o.prevWidth||p!==o.prevX||g!==o.prevTravellerWidth)){o.scale.range([p,p+h-g]);var T=o.scale.domain().map(function(C){return o.scale(C)});return{prevData:u,prevTravellerWidth:g,prevUpdateId:v,prevX:p,prevWidth:h,startX:o.scale(i.startIndex),endX:o.scale(i.endIndex),scaleValues:T}}return null}},{key:"getIndexInRange",value:function(i,o){for(var u=i.length,h=0,p=u-1;p-h>1;){var g=Math.floor((h+p)/2);i[g]>o?p=g:h=g}return o>=i[p]?p:h}}])}(w.PureComponent);Do(Oy,"displayName","Brush");Do(Oy,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var x_t=d3;function T_t(e,t){var n;return x_t(e,function(i,o,u){return n=t(i,o,u),!n}),!!n}var C_t=T_t,R_t=xme,N_t=Uf,A_t=C_t,I_t=vo,O_t=KI;function P_t(e,t,n){var i=I_t(e)?R_t:A_t;return n&&O_t(e,t,n)&&(t=void 0),i(e,N_t(t))}var k_t=P_t;const j_t=jr(k_t);var Uu=function(t,n){var i=t.alwaysShow,o=t.ifOverflow;return i&&(o="extendDomain"),o===n},xie=zme;function D_t(e,t,n){t=="__proto__"&&xie?xie(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var L_t=D_t,M_t=L_t,U_t=Gme,F_t=Uf;function V_t(e,t){var n={};return t=F_t(t),U_t(e,function(i,o,u){M_t(n,o,t(i,o,u))}),n}var B_t=V_t;const $_t=jr(B_t);function W_t(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}var G_t=W_t,H_t=d3;function z_t(e,t){var n=!0;return H_t(e,function(i,o,u){return n=!!t(i,o,u),n}),n}var K_t=z_t,q_t=G_t,Y_t=K_t,X_t=Uf,J_t=vo,Z_t=KI;function Q_t(e,t,n){var i=J_t(e)?q_t:Y_t;return n&&Z_t(e,t,n)&&(t=void 0),i(e,X_t(t))}var ebt=Q_t;const Tve=jr(ebt);var tbt=["x","y"];function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function ZF(){return ZF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ZF.apply(this,arguments)}function Tie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function AE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tie(Object(n),!0).forEach(function(i){nbt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function nbt(e,t,n){return t=rbt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rbt(e){var t=ibt(e,"string");return xw(t)=="symbol"?t:t+""}function ibt(e,t){if(xw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(xw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function abt(e,t){if(e==null)return{};var n=sbt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function sbt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function obt(e,t){var n=e.x,i=e.y,o=abt(e,tbt),u="".concat(n),h=parseInt(u,10),p="".concat(i),g=parseInt(p,10),v="".concat(t.height||o.height),b=parseInt(v,10),E="".concat(t.width||o.width),T=parseInt(E,10);return AE(AE(AE(AE(AE({},t),o),h?{x:h}:{}),g?{y:g}:{}),{},{height:b,width:T,name:t.name,radius:t.radius})}function Cie(e){return me.createElement(Gyt,ZF({shapeType:"rectangle",propTransformer:obt,activeClassName:"recharts-active-bar"},e))}var cbt=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,o){if(typeof t=="number")return t;var u=xt(i)||xQe(i);return u?t(i,o):(u||ym(),n)}},lbt=["value","background"],Cve;function Py(e){"@babel/helpers - typeof";return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function ubt(e,t){if(e==null)return{};var n=dbt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function dbt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function GA(){return GA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},GA.apply(this,arguments)}function Rie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rie(Object(n),!0).forEach(function(i){nf(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function hbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Nve(i.key),i)}}function fbt(e,t,n){return t&&Nie(e.prototype,t),n&&Nie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pbt(e,t,n){return t=HA(t),mbt(e,Rve()?Reflect.construct(t,n||[],HA(e).constructor):t.apply(e,n))}function mbt(e,t){if(t&&(Py(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gbt(e)}function gbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Rve=function(){return!!e})()}function HA(e){return HA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HA(e)}function vbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QF(e,t)}function QF(e,t){return QF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},QF(e,t)}function nf(e,t,n){return t=Nve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nve(e){var t=ybt(e,"string");return Py(t)=="symbol"?t:t+""}function ybt(e,t){if(Py(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Py(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Bo=function(e){function t(){var n;hbt(this,t);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return n=pbt(this,t,[].concat(o)),nf(n,"state",{isAnimationFinished:!1}),nf(n,"id",VI("recharts-bar-")),nf(n,"handleAnimationEnd",function(){var h=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),h&&h()}),nf(n,"handleAnimationStart",function(){var h=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),h&&h()}),n}return vbt(t,e),fbt(t,[{key:"renderRectanglesStatically",value:function(i){var o=this,u=this.props,h=u.shape,p=u.dataKey,g=u.activeIndex,v=u.activeBar,b=Tr(this.props,!1);return i&&i.map(function(E,T){var C=T===g,R=C?v:h,N=ua(ua(ua({},b),E),{},{isActive:C,option:R,index:T,dataKey:p,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return me.createElement($a,GA({className:"recharts-bar-rectangle"},iA(o.props,E,T),{key:"rectangle-".concat(E==null?void 0:E.x,"-").concat(E==null?void 0:E.y,"-").concat(E==null?void 0:E.value,"-").concat(T)}),me.createElement(Cie,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,o=this.props,u=o.data,h=o.layout,p=o.isAnimationActive,g=o.animationBegin,v=o.animationDuration,b=o.animationEasing,E=o.animationId,T=this.state.prevData;return me.createElement(Tf,{begin:g,duration:v,isActive:p,easing:b,from:{t:0},to:{t:1},key:"bar-".concat(E),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(C){var R=C.t,N=u.map(function(O,j){var k=T&&T[j];if(k){var P=lv(k.x,O.x),M=lv(k.y,O.y),D=lv(k.width,O.width),U=lv(k.height,O.height);return ua(ua({},O),{},{x:P(R),y:M(R),width:D(R),height:U(R)})}if(h==="horizontal"){var F=lv(0,O.height),H=F(R);return ua(ua({},O),{},{y:O.y+O.height-H,height:H})}var W=lv(0,O.width),q=W(R);return ua(ua({},O),{},{width:q})});return me.createElement($a,null,i.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var i=this.props,o=i.data,u=i.isAnimationActive,h=this.state.prevData;return u&&o&&o.length&&(!h||!M3(h,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var i=this,o=this.props,u=o.data,h=o.dataKey,p=o.activeIndex,g=Tr(this.props.background,!1);return u.map(function(v,b){v.value;var E=v.background,T=ubt(v,lbt);if(!E)return null;var C=ua(ua(ua(ua(ua({},T),{},{fill:"#eee"},E),g),iA(i.props,v,b)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:h,index:b,className:"recharts-bar-background-rectangle"});return me.createElement(Cie,GA({key:"background-bar-".concat(b),option:i.props.background,isActive:b===p},C))})}},{key:"renderErrorBar",value:function(i,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,h=u.data,p=u.xAxis,g=u.yAxis,v=u.layout,b=u.children,E=Ml(b,iO);if(!E)return null;var T=v==="vertical"?h[0].height/2:h[0].width/2,C=function(O,j){var k=Array.isArray(O.value)?O.value[1]:O.value;return{x:O.x,y:O.y,value:k,errorVal:Wu(O,j)}},R={clipPath:i?"url(#clipPath-".concat(o,")"):null};return me.createElement($a,R,E.map(function(N){return me.cloneElement(N,{key:"error-bar-".concat(o,"-").concat(N.props.dataKey),data:h,xAxis:p,yAxis:g,layout:v,offset:T,dataPointFormatter:C})}))}},{key:"render",value:function(){var i=this.props,o=i.hide,u=i.data,h=i.className,p=i.xAxis,g=i.yAxis,v=i.left,b=i.top,E=i.width,T=i.height,C=i.isAnimationActive,R=i.background,N=i.id;if(o||!u||!u.length)return null;var O=this.state.isAnimationFinished,j=er("recharts-bar",h),k=p&&p.allowDataOverflow,P=g&&g.allowDataOverflow,M=k||P,D=Nr(N)?this.id:N;return me.createElement($a,{className:j},k||P?me.createElement("defs",null,me.createElement("clipPath",{id:"clipPath-".concat(D)},me.createElement("rect",{x:k?v:v-E/2,y:P?b:b-T/2,width:k?E:E*2,height:P?T:T*2}))):null,me.createElement($a,{className:"recharts-bar-rectangles",clipPath:M?"url(#clipPath-".concat(D,")"):null},R?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(M,D),(!C||O)&&tm.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(i,o){return i.animationId!==o.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:o.curData}:i.data!==o.curData?{curData:i.data}:null}}])}(w.PureComponent);Cve=Bo;nf(Bo,"displayName","Bar");nf(Bo,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!lS.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});nf(Bo,"getComposedData",function(e){var t=e.props,n=e.item,i=e.barPosition,o=e.bandSize,u=e.xAxis,h=e.yAxis,p=e.xAxisTicks,g=e.yAxisTicks,v=e.stackedData,b=e.dataStartIndex,E=e.displayedData,T=e.offset,C=qpt(i,n);if(!C)return null;var R=t.layout,N=n.type.defaultProps,O=N!==void 0?ua(ua({},N),n.props):n.props,j=O.dataKey,k=O.children,P=O.minPointSize,M=R==="horizontal"?h:u,D=v?M.scale.domain():null,U=nmt({numericAxis:M}),F=Ml(k,Qme),H=E.map(function(W,q){var Y,z,Z,X,ae,se;v?Y=Ypt(v[b+q],D):(Y=Wu(W,j),Array.isArray(Y)||(Y=[U,Y]));var J=cbt(P,Cve.defaultProps.minPointSize)(Y[1],q);if(R==="horizontal"){var re,ee=[h.scale(Y[0]),h.scale(Y[1])],de=ee[0],xe=ee[1];z=Cre({axis:u,ticks:p,bandSize:o,offset:C.offset,entry:W,index:q}),Z=(re=xe??de)!==null&&re!==void 0?re:void 0,X=C.size;var ve=de-xe;if(ae=Number.isNaN(ve)?0:ve,se={x:z,y:h.y,width:X,height:h.height},Math.abs(J)>0&&Math.abs(ae)<Math.abs(J)){var Te=kl(ae||J)*(Math.abs(J)-Math.abs(ae));Z-=Te,ae+=Te}}else{var Pe=[u.scale(Y[0]),u.scale(Y[1])],qe=Pe[0],st=Pe[1];if(z=qe,Z=Cre({axis:h,ticks:g,bandSize:o,offset:C.offset,entry:W,index:q}),X=st-qe,ae=C.size,se={x:u.x,y:Z,width:u.width,height:ae},Math.abs(J)>0&&Math.abs(X)<Math.abs(J)){var ze=kl(X||J)*(Math.abs(J)-Math.abs(X));X+=ze}}return ua(ua(ua({},W),{},{x:z,y:Z,width:X,height:ae,value:v?Y:Y[1],payload:W,background:se},F&&F[q]&&F[q].props),{},{tooltipPayload:[ave(n,W)],tooltipPosition:{x:z+X/2,y:Z+ae/2}})});return ua({data:H,layout:R},T)});function Tw(e){"@babel/helpers - typeof";return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}function _bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ave(i.key),i)}}function bbt(e,t,n){return t&&Aie(e.prototype,t),n&&Aie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Nl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iie(Object(n),!0).forEach(function(i){oO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function oO(e,t,n){return t=Ave(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ave(e){var t=Ebt(e,"string");return Tw(t)=="symbol"?t:t+""}function Ebt(e,t){if(Tw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Tw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wbt=function(t,n,i,o,u){var h=t.width,p=t.height,g=t.layout,v=t.children,b=Object.keys(n),E={left:i.left,leftMirror:i.left,right:h-i.right,rightMirror:h-i.right,top:i.top,topMirror:i.top,bottom:p-i.bottom,bottomMirror:p-i.bottom},T=!!Mo(v,Bo);return b.reduce(function(C,R){var N=n[R],O=N.orientation,j=N.domain,k=N.padding,P=k===void 0?{}:k,M=N.mirror,D=N.reversed,U="".concat(O).concat(M?"Mirror":""),F,H,W,q,Y;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var z=j[1]-j[0],Z=1/0,X=N.categoricalDomain.sort(RQe);if(X.forEach(function(Pe,qe){qe>0&&(Z=Math.min((Pe||0)-(X[qe-1]||0),Z))}),Number.isFinite(Z)){var ae=Z/z,se=N.layout==="vertical"?i.height:i.width;if(N.padding==="gap"&&(F=ae*se/2),N.padding==="no-gap"){var J=gm(t.barCategoryGap,ae*se),re=ae*se/2;F=re-J-(re-J)/se*J}}}o==="xAxis"?H=[i.left+(P.left||0)+(F||0),i.left+i.width-(P.right||0)-(F||0)]:o==="yAxis"?H=g==="horizontal"?[i.top+i.height-(P.bottom||0),i.top+(P.top||0)]:[i.top+(P.top||0)+(F||0),i.top+i.height-(P.bottom||0)-(F||0)]:H=N.range,D&&(H=[H[1],H[0]]);var ee=zpt(N,u,T),de=ee.scale,xe=ee.realScaleType;de.domain(j).range(H),Kpt(de);var ve=tmt(de,Nl(Nl({},N),{},{realScaleType:xe}));o==="xAxis"?(Y=O==="top"&&!M||O==="bottom"&&M,W=i.left,q=E[U]-Y*N.height):o==="yAxis"&&(Y=O==="left"&&!M||O==="right"&&M,W=E[U]-Y*N.width,q=i.top);var Te=Nl(Nl(Nl({},N),ve),{},{realScaleType:xe,x:W,y:q,scale:de,width:o==="xAxis"?i.width:N.width,height:o==="yAxis"?i.height:N.height});return Te.bandSize=PA(Te,ve),!N.hide&&o==="xAxis"?E[U]+=(Y?-1:1)*Te.height:N.hide||(E[U]+=(Y?-1:1)*Te.width),Nl(Nl({},C),{},oO({},R,Te))},{})},Ive=function(t,n){var i=t.x,o=t.y,u=n.x,h=n.y;return{x:Math.min(i,u),y:Math.min(o,h),width:Math.abs(u-i),height:Math.abs(h-o)}},Sbt=function(t){var n=t.x1,i=t.y1,o=t.x2,u=t.y2;return Ive({x:n,y:i},{x:o,y:u})},Ove=function(){function e(t){_bt(this,e),this.scale=t}return bbt(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,u=i.position;if(n!==void 0){if(u)switch(u){case"start":return this.scale(n);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+h}case"end":{var p=this.bandwidth?this.bandwidth():0;return this.scale(n)+p}default:return this.scale(n)}if(o){var g=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+g}return this.scale(n)}}},{key:"isInRange",value:function(n){var i=this.range(),o=i[0],u=i[i.length-1];return o<=u?n>=o&&n<=u:n>=u&&n<=o}}],[{key:"create",value:function(n){return new e(n)}}])}();oO(Ove,"EPS",1e-4);var $3=function(t){var n=Object.keys(t).reduce(function(i,o){return Nl(Nl({},i),{},oO({},o,Ove.create(t[o])))},{});return Nl(Nl({},n),{},{apply:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=u.bandAware,p=u.position;return $_t(o,function(g,v){return n[v].apply(g,{bandAware:h,position:p})})},isInRange:function(o){return Tve(o,function(u,h){return n[h].isInRange(u)})}})};function xbt(e){return(e%180+180)%180}var Tbt=function(t){var n=t.width,i=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=xbt(o),h=u*Math.PI/180,p=Math.atan(i/n),g=h>p&&h<Math.PI-p?i/Math.sin(h):n/Math.cos(h);return Math.abs(g)},Cbt=Uf,Rbt=cS,Nbt=HI;function Abt(e){return function(t,n,i){var o=Object(t);if(!Rbt(t)){var u=Cbt(n);t=Nbt(t),n=function(p){return u(o[p],p,o)}}var h=e(t,n,i);return h>-1?o[u?t[h]:h]:void 0}}var Ibt=Abt,Obt=Eve;function Pbt(e){var t=Obt(e),n=t%1;return t===t?n?t-n:t:0}var kbt=Pbt,jbt=Ume,Dbt=Uf,Lbt=kbt,Mbt=Math.max;function Ubt(e,t,n){var i=e==null?0:e.length;if(!i)return-1;var o=n==null?0:Lbt(n);return o<0&&(o=Mbt(i+o,0)),jbt(e,Dbt(t),o)}var Fbt=Ubt,Vbt=Ibt,Bbt=Fbt,$bt=Vbt(Bbt),Wbt=$bt;const Gbt=jr(Wbt);var Hbt=IZe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),W3=w.createContext(void 0),G3=w.createContext(void 0),Pve=w.createContext(void 0),kve=w.createContext({}),jve=w.createContext(void 0),Dve=w.createContext(0),Lve=w.createContext(0),Oie=function(t){var n=t.state,i=n.xAxisMap,o=n.yAxisMap,u=n.offset,h=t.clipPathId,p=t.children,g=t.width,v=t.height,b=Hbt(u);return me.createElement(W3.Provider,{value:i},me.createElement(G3.Provider,{value:o},me.createElement(kve.Provider,{value:u},me.createElement(Pve.Provider,{value:b},me.createElement(jve.Provider,{value:h},me.createElement(Dve.Provider,{value:v},me.createElement(Lve.Provider,{value:g},p)))))))},zbt=function(){return w.useContext(jve)},Mve=function(t){var n=w.useContext(W3);n==null&&ym();var i=n[t];return i==null&&ym(),i},Kbt=function(){var t=w.useContext(W3);return Gh(t)},qbt=function(){var t=w.useContext(G3),n=Gbt(t,function(i){return Tve(i.domain,Number.isFinite)});return n||Gh(t)},Uve=function(t){var n=w.useContext(G3);n==null&&ym();var i=n[t];return i==null&&ym(),i},Ybt=function(){var t=w.useContext(Pve);return t},Xbt=function(){return w.useContext(kve)},H3=function(){return w.useContext(Lve)},z3=function(){return w.useContext(Dve)};function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function Jbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zbt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Vve(i.key),i)}}function Qbt(e,t,n){return t&&Zbt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eEt(e,t,n){return t=zA(t),tEt(e,Fve()?Reflect.construct(t,n||[],zA(e).constructor):t.apply(e,n))}function tEt(e,t){if(t&&(ky(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nEt(e)}function nEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fve=function(){return!!e})()}function zA(e){return zA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zA(e)}function rEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eV(e,t)}function eV(e,t){return eV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},eV(e,t)}function Pie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function kie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pie(Object(n),!0).forEach(function(i){K3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function K3(e,t,n){return t=Vve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vve(e){var t=iEt(e,"string");return ky(t)=="symbol"?t:t+""}function iEt(e,t){if(ky(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(ky(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function aEt(e,t){return lEt(e)||cEt(e,t)||oEt(e,t)||sEt()}function sEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oEt(e,t){if(e){if(typeof e=="string")return jie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jie(e,t)}}function jie(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function cEt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function lEt(e){if(Array.isArray(e))return e}function tV(){return tV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tV.apply(this,arguments)}var uEt=function(t,n){var i;return me.isValidElement(t)?i=me.cloneElement(t,n):Kn(t)?i=t(n):i=me.createElement("line",tV({},n,{className:"recharts-reference-line-line"})),i},dEt=function(t,n,i,o,u,h,p,g,v){var b=u.x,E=u.y,T=u.width,C=u.height;if(i){var R=v.y,N=t.y.apply(R,{position:h});if(Uu(v,"discard")&&!t.y.isInRange(N))return null;var O=[{x:b+T,y:N},{x:b,y:N}];return g==="left"?O.reverse():O}if(n){var j=v.x,k=t.x.apply(j,{position:h});if(Uu(v,"discard")&&!t.x.isInRange(k))return null;var P=[{x:k,y:E+C},{x:k,y:E}];return p==="top"?P.reverse():P}if(o){var M=v.segment,D=M.map(function(U){return t.apply(U,{position:h})});return Uu(v,"discard")&&j_t(D,function(U){return!t.isInRange(U)})?null:D}return null};function hEt(e){var t=e.x,n=e.y,i=e.segment,o=e.xAxisId,u=e.yAxisId,h=e.shape,p=e.className,g=e.alwaysShow,v=zbt(),b=Mve(o),E=Uve(u),T=Ybt();if(!v||!T)return null;Pd(g===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=$3({x:b.scale,y:E.scale}),R=Oa(t),N=Oa(n),O=i&&i.length===2,j=dEt(C,R,N,O,T,e.position,b.orientation,E.orientation,e);if(!j)return null;var k=aEt(j,2),P=k[0],M=P.x,D=P.y,U=k[1],F=U.x,H=U.y,W=Uu(e,"hidden")?"url(#".concat(v,")"):void 0,q=kie(kie({clipPath:W},Tr(e,!0)),{},{x1:M,y1:D,x2:F,y2:H});return me.createElement($a,{className:er("recharts-reference-line",p)},uEt(h,q),bs.renderCallByParent(e,Sbt({x1:M,y1:D,x2:F,y2:H})))}var q3=function(e){function t(){return Jbt(this,t),eEt(this,t,arguments)}return rEt(t,e),Qbt(t,[{key:"render",value:function(){return me.createElement(hEt,this.props)}}])}(me.Component);K3(q3,"displayName","ReferenceLine");K3(q3,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function nV(){return nV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nV.apply(this,arguments)}function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function Die(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Lie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Die(Object(n),!0).forEach(function(i){cO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Die(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function fEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pEt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,$ve(i.key),i)}}function mEt(e,t,n){return t&&pEt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gEt(e,t,n){return t=KA(t),vEt(e,Bve()?Reflect.construct(t,n||[],KA(e).constructor):t.apply(e,n))}function vEt(e,t){if(t&&(jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yEt(e)}function yEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bve=function(){return!!e})()}function KA(e){return KA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},KA(e)}function _Et(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rV(e,t)}function rV(e,t){return rV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},rV(e,t)}function cO(e,t,n){return t=$ve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $ve(e){var t=bEt(e,"string");return jy(t)=="symbol"?t:t+""}function bEt(e,t){if(jy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(jy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var EEt=function(t){var n=t.x,i=t.y,o=t.xAxis,u=t.yAxis,h=$3({x:o.scale,y:u.scale}),p=h.apply({x:n,y:i},{bandAware:!0});return Uu(t,"discard")&&!h.isInRange(p)?null:p},lO=function(e){function t(){return fEt(this,t),gEt(this,t,arguments)}return _Et(t,e),mEt(t,[{key:"render",value:function(){var i=this.props,o=i.x,u=i.y,h=i.r,p=i.alwaysShow,g=i.clipPathId,v=Oa(o),b=Oa(u);if(Pd(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!v||!b)return null;var E=EEt(this.props);if(!E)return null;var T=E.x,C=E.y,R=this.props,N=R.shape,O=R.className,j=Uu(this.props,"hidden")?"url(#".concat(g,")"):void 0,k=Lie(Lie({clipPath:j},Tr(this.props,!0)),{},{cx:T,cy:C});return me.createElement($a,{className:er("recharts-reference-dot",O)},t.renderDot(N,k),bs.renderCallByParent(this.props,{x:T-h,y:C-h,width:2*h,height:2*h}))}}])}(me.Component);cO(lO,"displayName","ReferenceDot");cO(lO,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});cO(lO,"renderDot",function(e,t){var n;return me.isValidElement(e)?n=me.cloneElement(e,t):Kn(e)?n=e(t):n=me.createElement(_ve,nV({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function iV(){return iV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},iV.apply(this,arguments)}function Dy(e){"@babel/helpers - typeof";return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dy(e)}function Mie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Uie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mie(Object(n),!0).forEach(function(i){uO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function wEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SEt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Gve(i.key),i)}}function xEt(e,t,n){return t&&SEt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TEt(e,t,n){return t=qA(t),CEt(e,Wve()?Reflect.construct(t,n||[],qA(e).constructor):t.apply(e,n))}function CEt(e,t){if(t&&(Dy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return REt(e)}function REt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wve=function(){return!!e})()}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qA(e)}function NEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aV(e,t)}function aV(e,t){return aV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},aV(e,t)}function uO(e,t,n){return t=Gve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gve(e){var t=AEt(e,"string");return Dy(t)=="symbol"?t:t+""}function AEt(e,t){if(Dy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Dy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var IEt=function(t,n,i,o,u){var h=u.x1,p=u.x2,g=u.y1,v=u.y2,b=u.xAxis,E=u.yAxis;if(!b||!E)return null;var T=$3({x:b.scale,y:E.scale}),C={x:t?T.x.apply(h,{position:"start"}):T.x.rangeMin,y:i?T.y.apply(g,{position:"start"}):T.y.rangeMin},R={x:n?T.x.apply(p,{position:"end"}):T.x.rangeMax,y:o?T.y.apply(v,{position:"end"}):T.y.rangeMax};return Uu(u,"discard")&&(!T.isInRange(C)||!T.isInRange(R))?null:Ive(C,R)},dO=function(e){function t(){return wEt(this,t),TEt(this,t,arguments)}return NEt(t,e),xEt(t,[{key:"render",value:function(){var i=this.props,o=i.x1,u=i.x2,h=i.y1,p=i.y2,g=i.className,v=i.alwaysShow,b=i.clipPathId;Pd(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var E=Oa(o),T=Oa(u),C=Oa(h),R=Oa(p),N=this.props.shape;if(!E&&!T&&!C&&!R&&!N)return null;var O=IEt(E,T,C,R,this.props);if(!O&&!N)return null;var j=Uu(this.props,"hidden")?"url(#".concat(b,")"):void 0;return me.createElement($a,{className:er("recharts-reference-area",g)},t.renderRect(N,Uie(Uie({clipPath:j},Tr(this.props,!0)),O)),bs.renderCallByParent(this.props,O))}}])}(me.Component);uO(dO,"displayName","ReferenceArea");uO(dO,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});uO(dO,"renderRect",function(e,t){var n;return me.isValidElement(e)?n=me.cloneElement(e,t):Kn(e)?n=e(t):n=me.createElement(B3,iV({},t,{className:"recharts-reference-area-rect"})),n});function Hve(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var i=[],o=0;o<e.length;o+=t)i.push(e[o]);return i}function OEt(e,t,n){var i={width:e.width+t.width,height:e.height+t.height};return Tbt(i,n)}function PEt(e,t,n){var i=n==="width",o=e.x,u=e.y,h=e.width,p=e.height;return t===1?{start:i?o:u,end:i?o+h:u+p}:{start:i?o+h:u+p,end:i?o:u}}function YA(e,t,n,i,o){if(e*t<e*i||e*t>e*o)return!1;var u=n();return e*(t-e*u/2-i)>=0&&e*(t+e*u/2-o)<=0}function kEt(e,t){return Hve(e,t+1)}function jEt(e,t,n,i,o){for(var u=(i||[]).slice(),h=t.start,p=t.end,g=0,v=1,b=h,E=function(){var R=i==null?void 0:i[g];if(R===void 0)return{v:Hve(i,v)};var N=g,O,j=function(){return O===void 0&&(O=n(R,N)),O},k=R.coordinate,P=g===0||YA(e,k,j,b,p);P||(g=0,b=h,v+=1),P&&(b=k+e*(j()/2+o),g+=v)},T;v<=u.length;)if(T=E(),T)return T.v;return[]}function Cw(e){"@babel/helpers - typeof";return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(e)}function Fie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fie(Object(n),!0).forEach(function(i){DEt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function DEt(e,t,n){return t=LEt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LEt(e){var t=MEt(e,"string");return Cw(t)=="symbol"?t:t+""}function MEt(e,t){if(Cw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Cw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UEt(e,t,n,i,o){for(var u=(i||[]).slice(),h=u.length,p=t.start,g=t.end,v=function(T){var C=u[T],R,N=function(){return R===void 0&&(R=n(C,T)),R};if(T===h-1){var O=e*(C.coordinate+e*N()/2-g);u[T]=C=ys(ys({},C),{},{tickCoord:O>0?C.coordinate-O*e:C.coordinate})}else u[T]=C=ys(ys({},C),{},{tickCoord:C.coordinate});var j=YA(e,C.tickCoord,N,p,g);j&&(g=C.tickCoord-e*(N()/2+o),u[T]=ys(ys({},C),{},{isShow:!0}))},b=h-1;b>=0;b--)v(b);return u}function FEt(e,t,n,i,o,u){var h=(i||[]).slice(),p=h.length,g=t.start,v=t.end;if(u){var b=i[p-1],E=n(b,p-1),T=e*(b.coordinate+e*E/2-v);h[p-1]=b=ys(ys({},b),{},{tickCoord:T>0?b.coordinate-T*e:b.coordinate});var C=YA(e,b.tickCoord,function(){return E},g,v);C&&(v=b.tickCoord-e*(E/2+o),h[p-1]=ys(ys({},b),{},{isShow:!0}))}for(var R=u?p-1:p,N=function(k){var P=h[k],M,D=function(){return M===void 0&&(M=n(P,k)),M};if(k===0){var U=e*(P.coordinate-e*D()/2-g);h[k]=P=ys(ys({},P),{},{tickCoord:U<0?P.coordinate-U*e:P.coordinate})}else h[k]=P=ys(ys({},P),{},{tickCoord:P.coordinate});var F=YA(e,P.tickCoord,D,g,v);F&&(g=P.tickCoord+e*(D()/2+o),h[k]=ys(ys({},P),{},{isShow:!0}))},O=0;O<R;O++)N(O);return h}function Y3(e,t,n){var i=e.tick,o=e.ticks,u=e.viewBox,h=e.minTickGap,p=e.orientation,g=e.interval,v=e.tickFormatter,b=e.unit,E=e.angle;if(!o||!o.length||!i)return[];if(xt(g)||lS.isSsr)return kEt(o,typeof g=="number"&&xt(g)?g:0);var T=[],C=p==="top"||p==="bottom"?"width":"height",R=b&&C==="width"?n0(b,{fontSize:t,letterSpacing:n}):{width:0,height:0},N=function(P,M){var D=Kn(v)?v(P.value,M):P.value;return C==="width"?OEt(n0(D,{fontSize:t,letterSpacing:n}),R,E):n0(D,{fontSize:t,letterSpacing:n})[C]},O=o.length>=2?kl(o[1].coordinate-o[0].coordinate):1,j=PEt(u,O,C);return g==="equidistantPreserveStart"?jEt(O,j,N,o,h):(g==="preserveStart"||g==="preserveStartEnd"?T=FEt(O,j,N,o,h,g==="preserveStartEnd"):T=UEt(O,j,N,o,h),T.filter(function(k){return k.isShow}))}var VEt=["viewBox"],BEt=["viewBox"],$Et=["ticks"];function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ly(e)}function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Av.apply(this,arguments)}function Vie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Ta(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vie(Object(n),!0).forEach(function(i){X3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function JL(e,t){if(e==null)return{};var n=WEt(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function WEt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function GEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Kve(i.key),i)}}function HEt(e,t,n){return t&&Bie(e.prototype,t),n&&Bie(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function zEt(e,t,n){return t=XA(t),KEt(e,zve()?Reflect.construct(t,n||[],XA(e).constructor):t.apply(e,n))}function KEt(e,t){if(t&&(Ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qEt(e)}function qEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zve=function(){return!!e})()}function XA(e){return XA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XA(e)}function YEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sV(e,t)}function sV(e,t){return sV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},sV(e,t)}function X3(e,t,n){return t=Kve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kve(e){var t=XEt(e,"string");return Ly(t)=="symbol"?t:t+""}function XEt(e,t){if(Ly(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ly(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __=function(e){function t(n){var i;return GEt(this,t),i=zEt(this,t,[n]),i.state={fontSize:"",letterSpacing:""},i}return YEt(t,e),HEt(t,[{key:"shouldComponentUpdate",value:function(i,o){var u=i.viewBox,h=JL(i,VEt),p=this.props,g=p.viewBox,v=JL(p,BEt);return!$v(u,g)||!$v(h,v)||!$v(o,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var o=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var o=this.props,u=o.x,h=o.y,p=o.width,g=o.height,v=o.orientation,b=o.tickSize,E=o.mirror,T=o.tickMargin,C,R,N,O,j,k,P=E?-1:1,M=i.tickSize||b,D=xt(i.tickCoord)?i.tickCoord:i.coordinate;switch(v){case"top":C=R=i.coordinate,O=h+ +!E*g,N=O-P*M,k=N-P*T,j=D;break;case"left":N=O=i.coordinate,R=u+ +!E*p,C=R-P*M,j=C-P*T,k=D;break;case"right":N=O=i.coordinate,R=u+ +E*p,C=R+P*M,j=C+P*T,k=D;break;default:C=R=i.coordinate,O=h+ +E*g,N=O+P*M,k=N+P*T,j=D;break}return{line:{x1:C,y1:N,x2:R,y2:O},tick:{x:j,y:k}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,o=i.orientation,u=i.mirror,h;switch(o){case"left":h=u?"start":"end";break;case"right":h=u?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,o=i.orientation,u=i.mirror,h="end";switch(o){case"left":case"right":h="middle";break;case"top":h=u?"start":"end";break;default:h=u?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var i=this.props,o=i.x,u=i.y,h=i.width,p=i.height,g=i.orientation,v=i.mirror,b=i.axisLine,E=Ta(Ta(Ta({},Tr(this.props,!1)),Tr(b,!1)),{},{fill:"none"});if(g==="top"||g==="bottom"){var T=+(g==="top"&&!v||g==="bottom"&&v);E=Ta(Ta({},E),{},{x1:o,y1:u+T*p,x2:o+h,y2:u+T*p})}else{var C=+(g==="left"&&!v||g==="right"&&v);E=Ta(Ta({},E),{},{x1:o+C*h,y1:u,x2:o+C*h,y2:u+p})}return me.createElement("line",Av({},E,{className:er("recharts-cartesian-axis-line",Mc(b,"className"))}))}},{key:"renderTicks",value:function(i,o,u){var h=this,p=this.props,g=p.tickLine,v=p.stroke,b=p.tick,E=p.tickFormatter,T=p.unit,C=Y3(Ta(Ta({},this.props),{},{ticks:i}),o,u),R=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),O=Tr(this.props,!1),j=Tr(b,!1),k=Ta(Ta({},O),{},{fill:"none"},Tr(g,!1)),P=C.map(function(M,D){var U=h.getTickLineCoord(M),F=U.line,H=U.tick,W=Ta(Ta(Ta(Ta({textAnchor:R,verticalAnchor:N},O),{},{stroke:"none",fill:v},j),H),{},{index:D,payload:M,visibleTicksCount:C.length,tickFormatter:E});return me.createElement($a,Av({className:"recharts-cartesian-axis-tick",key:"tick-".concat(M.value,"-").concat(M.coordinate,"-").concat(M.tickCoord)},iA(h.props,M,D)),g&&me.createElement("line",Av({},k,F,{className:er("recharts-cartesian-axis-tick-line",Mc(g,"className"))})),b&&t.renderTickItem(b,W,"".concat(Kn(E)?E(M.value,D):M.value).concat(T||"")))});return me.createElement("g",{className:"recharts-cartesian-axis-ticks"},P)}},{key:"render",value:function(){var i=this,o=this.props,u=o.axisLine,h=o.width,p=o.height,g=o.ticksGenerator,v=o.className,b=o.hide;if(b)return null;var E=this.props,T=E.ticks,C=JL(E,$Et),R=T;return Kn(g)&&(R=T&&T.length>0?g(this.props):g(C)),h<=0||p<=0||!R||!R.length?null:me.createElement($a,{className:er("recharts-cartesian-axis",v),ref:function(O){i.layerReference=O}},u&&this.renderAxisLine(),this.renderTicks(R,this.state.fontSize,this.state.letterSpacing),bs.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,o,u){var h,p=er(o.className,"recharts-cartesian-axis-tick-value");return me.isValidElement(i)?h=me.cloneElement(i,Ta(Ta({},o),{},{className:p})):Kn(i)?h=i(Ta(Ta({},o),{},{className:p})):h=me.createElement(yA,Av({},o,{className:"recharts-cartesian-axis-tick-value"}),u),h}}])}(w.Component);X3(__,"displayName","CartesianAxis");X3(__,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var JEt=["x1","y1","x2","y2","key"],ZEt=["offset"];function _m(e){"@babel/helpers - typeof";return _m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_m(e)}function $ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Es(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$ie(Object(n),!0).forEach(function(i){QEt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$ie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function QEt(e,t,n){return t=e0t(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e0t(e){var t=t0t(e,"string");return _m(t)=="symbol"?t:t+""}function t0t(e,t){if(_m(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(_m(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Gp.apply(this,arguments)}function Wie(e,t){if(e==null)return{};var n=n0t(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function n0t(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var r0t=function(t){var n=t.fill;if(!n||n==="none")return null;var i=t.fillOpacity,o=t.x,u=t.y,h=t.width,p=t.height,g=t.ry;return me.createElement("rect",{x:o,y:u,ry:g,width:h,height:p,stroke:"none",fill:n,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function qve(e,t){var n;if(me.isValidElement(e))n=me.cloneElement(e,t);else if(Kn(e))n=e(t);else{var i=t.x1,o=t.y1,u=t.x2,h=t.y2,p=t.key,g=Wie(t,JEt),v=Tr(g,!1);v.offset;var b=Wie(v,ZEt);n=me.createElement("line",Gp({},b,{x1:i,y1:o,x2:u,y2:h,fill:"none",key:p}))}return n}function i0t(e){var t=e.x,n=e.width,i=e.horizontal,o=i===void 0?!0:i,u=e.horizontalPoints;if(!o||!u||!u.length)return null;var h=u.map(function(p,g){var v=Es(Es({},e),{},{x1:t,y1:p,x2:t+n,y2:p,key:"line-".concat(g),index:g});return qve(o,v)});return me.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function a0t(e){var t=e.y,n=e.height,i=e.vertical,o=i===void 0?!0:i,u=e.verticalPoints;if(!o||!u||!u.length)return null;var h=u.map(function(p,g){var v=Es(Es({},e),{},{x1:p,y1:t,x2:p,y2:t+n,key:"line-".concat(g),index:g});return qve(o,v)});return me.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function s0t(e){var t=e.horizontalFill,n=e.fillOpacity,i=e.x,o=e.y,u=e.width,h=e.height,p=e.horizontalPoints,g=e.horizontal,v=g===void 0?!0:g;if(!v||!t||!t.length)return null;var b=p.map(function(T){return Math.round(T+o-o)}).sort(function(T,C){return T-C});o!==b[0]&&b.unshift(0);var E=b.map(function(T,C){var R=!b[C+1],N=R?o+h-T:b[C+1]-T;if(N<=0)return null;var O=C%t.length;return me.createElement("rect",{key:"react-".concat(C),y:T,x:i,height:N,width:u,stroke:"none",fill:t[O],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},E)}function o0t(e){var t=e.vertical,n=t===void 0?!0:t,i=e.verticalFill,o=e.fillOpacity,u=e.x,h=e.y,p=e.width,g=e.height,v=e.verticalPoints;if(!n||!i||!i.length)return null;var b=v.map(function(T){return Math.round(T+u-u)}).sort(function(T,C){return T-C});u!==b[0]&&b.unshift(0);var E=b.map(function(T,C){var R=!b[C+1],N=R?u+p-T:b[C+1]-T;if(N<=0)return null;var O=C%i.length;return me.createElement("rect",{key:"react-".concat(C),x:T,y:h,width:N,height:g,stroke:"none",fill:i[O],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},E)}var c0t=function(t,n){var i=t.xAxis,o=t.width,u=t.height,h=t.offset;return rve(Y3(Es(Es(Es({},__.defaultProps),i),{},{ticks:Rd(i,!0),viewBox:{x:0,y:0,width:o,height:u}})),h.left,h.left+h.width,n)},l0t=function(t,n){var i=t.yAxis,o=t.width,u=t.height,h=t.offset;return rve(Y3(Es(Es(Es({},__.defaultProps),i),{},{ticks:Rd(i,!0),viewBox:{x:0,y:0,width:o,height:u}})),h.top,h.top+h.height,n)},hv={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function hO(e){var t,n,i,o,u,h,p=H3(),g=z3(),v=Xbt(),b=Es(Es({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:hv.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:hv.fill,horizontal:(i=e.horizontal)!==null&&i!==void 0?i:hv.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:hv.horizontalFill,vertical:(u=e.vertical)!==null&&u!==void 0?u:hv.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:hv.verticalFill,x:xt(e.x)?e.x:v.left,y:xt(e.y)?e.y:v.top,width:xt(e.width)?e.width:v.width,height:xt(e.height)?e.height:v.height}),E=b.x,T=b.y,C=b.width,R=b.height,N=b.syncWithTicks,O=b.horizontalValues,j=b.verticalValues,k=Kbt(),P=qbt();if(!xt(C)||C<=0||!xt(R)||R<=0||!xt(E)||E!==+E||!xt(T)||T!==+T)return null;var M=b.verticalCoordinatesGenerator||c0t,D=b.horizontalCoordinatesGenerator||l0t,U=b.horizontalPoints,F=b.verticalPoints;if((!U||!U.length)&&Kn(D)){var H=O&&O.length,W=D({yAxis:P?Es(Es({},P),{},{ticks:H?O:P.ticks}):void 0,width:p,height:g,offset:v},H?!0:N);Pd(Array.isArray(W),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(_m(W),"]")),Array.isArray(W)&&(U=W)}if((!F||!F.length)&&Kn(M)){var q=j&&j.length,Y=M({xAxis:k?Es(Es({},k),{},{ticks:q?j:k.ticks}):void 0,width:p,height:g,offset:v},q?!0:N);Pd(Array.isArray(Y),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(_m(Y),"]")),Array.isArray(Y)&&(F=Y)}return me.createElement("g",{className:"recharts-cartesian-grid"},me.createElement(r0t,{fill:b.fill,fillOpacity:b.fillOpacity,x:b.x,y:b.y,width:b.width,height:b.height,ry:b.ry}),me.createElement(i0t,Gp({},b,{offset:v,horizontalPoints:U,xAxis:k,yAxis:P})),me.createElement(a0t,Gp({},b,{offset:v,verticalPoints:F,xAxis:k,yAxis:P})),me.createElement(s0t,Gp({},b,{horizontalPoints:U})),me.createElement(o0t,Gp({},b,{verticalPoints:F})))}hO.displayName="CartesianGrid";function My(e){"@babel/helpers - typeof";return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},My(e)}function u0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Jve(i.key),i)}}function h0t(e,t,n){return t&&d0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function f0t(e,t,n){return t=JA(t),p0t(e,Yve()?Reflect.construct(t,n||[],JA(e).constructor):t.apply(e,n))}function p0t(e,t){if(t&&(My(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m0t(e)}function m0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yve=function(){return!!e})()}function JA(e){return JA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},JA(e)}function g0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oV(e,t)}function oV(e,t){return oV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},oV(e,t)}function Xve(e,t,n){return t=Jve(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jve(e){var t=v0t(e,"string");return My(t)=="symbol"?t:t+""}function v0t(e,t){if(My(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(My(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function cV(){return cV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cV.apply(this,arguments)}function y0t(e){var t=e.xAxisId,n=H3(),i=z3(),o=Mve(t);return o==null?null:w.createElement(__,cV({},o,{className:er("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(h){return Rd(h,!0)}}))}var b_=function(e){function t(){return u0t(this,t),f0t(this,t,arguments)}return g0t(t,e),h0t(t,[{key:"render",value:function(){return w.createElement(y0t,this.props)}}])}(w.Component);Xve(b_,"displayName","XAxis");Xve(b_,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Uy(e){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}function _0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,eye(i.key),i)}}function E0t(e,t,n){return t&&b0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function w0t(e,t,n){return t=ZA(t),S0t(e,Zve()?Reflect.construct(t,n||[],ZA(e).constructor):t.apply(e,n))}function S0t(e,t){if(t&&(Uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x0t(e)}function x0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zve=function(){return!!e})()}function ZA(e){return ZA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ZA(e)}function T0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lV(e,t)}function lV(e,t){return lV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},lV(e,t)}function Qve(e,t,n){return t=eye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eye(e){var t=C0t(e,"string");return Uy(t)=="symbol"?t:t+""}function C0t(e,t){if(Uy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Uy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function uV(){return uV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},uV.apply(this,arguments)}var R0t=function(t){var n=t.yAxisId,i=H3(),o=z3(),u=Uve(n);return u==null?null:w.createElement(__,uV({},u,{className:er("recharts-".concat(u.axisType," ").concat(u.axisType),u.className),viewBox:{x:0,y:0,width:i,height:o},ticksGenerator:function(p){return Rd(p,!0)}}))},E_=function(e){function t(){return _0t(this,t),w0t(this,t,arguments)}return T0t(t,e),E0t(t,[{key:"render",value:function(){return w.createElement(R0t,this.props)}}])}(w.Component);Qve(E_,"displayName","YAxis");Qve(E_,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Gie(e){return O0t(e)||I0t(e)||A0t(e)||N0t()}function N0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A0t(e,t){if(e){if(typeof e=="string")return dV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dV(e,t)}}function I0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function O0t(e){if(Array.isArray(e))return dV(e)}function dV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var hV=function(t,n,i,o,u){var h=Ml(t,q3),p=Ml(t,lO),g=[].concat(Gie(h),Gie(p)),v=Ml(t,dO),b="".concat(o,"Id"),E=o[0],T=n;if(g.length&&(T=g.reduce(function(N,O){if(O.props[b]===i&&Uu(O.props,"extendDomain")&&xt(O.props[E])){var j=O.props[E];return[Math.min(N[0],j),Math.max(N[1],j)]}return N},T)),v.length){var C="".concat(E,"1"),R="".concat(E,"2");T=v.reduce(function(N,O){if(O.props[b]===i&&Uu(O.props,"extendDomain")&&xt(O.props[C])&&xt(O.props[R])){var j=O.props[C],k=O.props[R];return[Math.min(N[0],j,k),Math.max(N[1],j,k)]}return N},T)}return u&&u.length&&(T=u.reduce(function(N,O){return xt(O)?[Math.min(N[0],O),Math.max(N[1],O)]:N},T)),T},tye={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function o(g,v,b){this.fn=g,this.context=v,this.once=b||!1}function u(g,v,b,E,T){if(typeof b!="function")throw new TypeError("The listener must be a function");var C=new o(b,E||g,T),R=n?n+v:v;return g._events[R]?g._events[R].fn?g._events[R]=[g._events[R],C]:g._events[R].push(C):(g._events[R]=C,g._eventsCount++),g}function h(g,v){--g._eventsCount===0?g._events=new i:delete g._events[v]}function p(){this._events=new i,this._eventsCount=0}p.prototype.eventNames=function(){var v=[],b,E;if(this._eventsCount===0)return v;for(E in b=this._events)t.call(b,E)&&v.push(n?E.slice(1):E);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(b)):v},p.prototype.listeners=function(v){var b=n?n+v:v,E=this._events[b];if(!E)return[];if(E.fn)return[E.fn];for(var T=0,C=E.length,R=new Array(C);T<C;T++)R[T]=E[T].fn;return R},p.prototype.listenerCount=function(v){var b=n?n+v:v,E=this._events[b];return E?E.fn?1:E.length:0},p.prototype.emit=function(v,b,E,T,C,R){var N=n?n+v:v;if(!this._events[N])return!1;var O=this._events[N],j=arguments.length,k,P;if(O.fn){switch(O.once&&this.removeListener(v,O.fn,void 0,!0),j){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,b),!0;case 3:return O.fn.call(O.context,b,E),!0;case 4:return O.fn.call(O.context,b,E,T),!0;case 5:return O.fn.call(O.context,b,E,T,C),!0;case 6:return O.fn.call(O.context,b,E,T,C,R),!0}for(P=1,k=new Array(j-1);P<j;P++)k[P-1]=arguments[P];O.fn.apply(O.context,k)}else{var M=O.length,D;for(P=0;P<M;P++)switch(O[P].once&&this.removeListener(v,O[P].fn,void 0,!0),j){case 1:O[P].fn.call(O[P].context);break;case 2:O[P].fn.call(O[P].context,b);break;case 3:O[P].fn.call(O[P].context,b,E);break;case 4:O[P].fn.call(O[P].context,b,E,T);break;default:if(!k)for(D=1,k=new Array(j-1);D<j;D++)k[D-1]=arguments[D];O[P].fn.apply(O[P].context,k)}}return!0},p.prototype.on=function(v,b,E){return u(this,v,b,E,!1)},p.prototype.once=function(v,b,E){return u(this,v,b,E,!0)},p.prototype.removeListener=function(v,b,E,T){var C=n?n+v:v;if(!this._events[C])return this;if(!b)return h(this,C),this;var R=this._events[C];if(R.fn)R.fn===b&&(!T||R.once)&&(!E||R.context===E)&&h(this,C);else{for(var N=0,O=[],j=R.length;N<j;N++)(R[N].fn!==b||T&&!R[N].once||E&&R[N].context!==E)&&O.push(R[N]);O.length?this._events[C]=O.length===1?O[0]:O:h(this,C)}return this},p.prototype.removeAllListeners=function(v){var b;return v?(b=n?n+v:v,this._events[b]&&h(this,b)):(this._events=new i,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=n,p.EventEmitter=p,e.exports=p})(tye);var P0t=tye.exports;const k0t=jr(P0t);var ZL=new k0t,QL="recharts.syncMouseEvents";function Rw(e){"@babel/helpers - typeof";return Rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rw(e)}function j0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,nye(i.key),i)}}function L0t(e,t,n){return t&&D0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eM(e,t,n){return t=nye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nye(e){var t=M0t(e,"string");return Rw(t)=="symbol"?t:t+""}function M0t(e,t){if(Rw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Rw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var U0t=function(){function e(){j0t(this,e),eM(this,"activeIndex",0),eM(this,"coordinateList",[]),eM(this,"layout","horizontal")}return L0t(e,[{key:"setDetails",value:function(n){var i,o=n.coordinateList,u=o===void 0?null:o,h=n.container,p=h===void 0?null:h,g=n.layout,v=g===void 0?null:g,b=n.offset,E=b===void 0?null:b,T=n.mouseHandlerCallback,C=T===void 0?null:T;this.coordinateList=(i=u??this.coordinateList)!==null&&i!==void 0?i:[],this.container=p??this.container,this.layout=v??this.layout,this.offset=E??this.offset,this.mouseHandlerCallback=C??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),u=o.x,h=o.y,p=o.height,g=this.coordinateList[this.activeIndex].coordinate,v=((n=window)===null||n===void 0?void 0:n.scrollX)||0,b=((i=window)===null||i===void 0?void 0:i.scrollY)||0,E=u+g+v,T=h+this.offset.top+p/2+b;this.mouseHandlerCallback({pageX:E,pageY:T})}}}])}();function F0t(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var i=e==null?void 0:e[0],o=e==null?void 0:e[1];if(i&&o&&xt(i)&&xt(o))return!0}return!1}function V0t(e,t,n,i){var o=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-o,width:e==="horizontal"?i:n.width-1,height:e==="horizontal"?n.height-1:i}}function rye(e){var t=e.cx,n=e.cy,i=e.radius,o=e.startAngle,u=e.endAngle,h=ts(t,n,i,o),p=ts(t,n,i,u);return{points:[h,p],cx:t,cy:n,radius:i,startAngle:o,endAngle:u}}function B0t(e,t,n){var i,o,u,h;if(e==="horizontal")i=t.x,u=i,o=n.top,h=n.top+n.height;else if(e==="vertical")o=t.y,h=o,i=n.left,u=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var p=t.cx,g=t.cy,v=t.innerRadius,b=t.outerRadius,E=t.angle,T=ts(p,g,v,E),C=ts(p,g,b,E);i=T.x,o=T.y,u=C.x,h=C.y}else return rye(t);return[{x:i,y:o},{x:u,y:h}]}function Nw(e){"@babel/helpers - typeof";return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nw(e)}function Hie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function pR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Hie(Object(n),!0).forEach(function(i){$0t(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function $0t(e,t,n){return t=W0t(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W0t(e){var t=G0t(e,"string");return Nw(t)=="symbol"?t:t+""}function G0t(e,t){if(Nw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Nw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H0t(e){var t,n,i=e.element,o=e.tooltipEventType,u=e.isActive,h=e.activeCoordinate,p=e.activePayload,g=e.offset,v=e.activeTooltipIndex,b=e.tooltipAxisBandSize,E=e.layout,T=e.chartName,C=(t=i.props.cursor)!==null&&t!==void 0?t:(n=i.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!i||!C||!u||!h||T!=="ScatterChart"&&o!=="axis")return null;var R,N=$re;if(T==="ScatterChart")R=h,N=iyt;else if(T==="BarChart")R=V0t(E,h,g,b),N=B3;else if(E==="radial"){var O=rye(h),j=O.cx,k=O.cy,P=O.radius,M=O.startAngle,D=O.endAngle;R={cx:j,cy:k,startAngle:M,endAngle:D,innerRadius:P,outerRadius:P},N=cve}else R={points:B0t(E,h,g)},N=$re;var U=pR(pR(pR(pR({stroke:"#ccc",pointerEvents:"none"},g),R),Tr(C,!1)),{},{payload:p,payloadIndex:v,className:er("recharts-tooltip-cursor",C.className)});return w.isValidElement(C)?w.cloneElement(C,U):w.createElement(N,U)}var z0t=["item"],K0t=["children","className","width","height","style","compact","title","desc"];function Fy(e){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Iv.apply(this,arguments)}function zie(e,t){return X0t(e)||Y0t(e,t)||aye(e,t)||q0t()}function q0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y0t(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,u,h,p=[],g=!0,v=!1;try{if(u=(n=n.call(e)).next,t!==0)for(;!(g=(i=u.call(n)).done)&&(p.push(i.value),p.length!==t);g=!0);}catch(b){v=!0,o=b}finally{try{if(!g&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(v)throw o}}return p}}function X0t(e){if(Array.isArray(e))return e}function Kie(e,t){if(e==null)return{};var n=J0t(e,t),i,o;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)i=u[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function J0t(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Z0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q0t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,sye(i.key),i)}}function ewt(e,t,n){return t&&Q0t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function twt(e,t,n){return t=QA(t),nwt(e,iye()?Reflect.construct(t,n||[],QA(e).constructor):t.apply(e,n))}function nwt(e,t){if(t&&(Fy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rwt(e)}function rwt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iye(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iye=function(){return!!e})()}function QA(e){return QA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},QA(e)}function iwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fV(e,t)}function fV(e,t){return fV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},fV(e,t)}function Vy(e){return owt(e)||swt(e)||aye(e)||awt()}function awt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aye(e,t){if(e){if(typeof e=="string")return pV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pV(e,t)}}function swt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function owt(e){if(Array.isArray(e))return pV(e)}function pV(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qie(Object(n),!0).forEach(function(i){pn(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qie(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function pn(e,t,n){return t=sye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sye(e){var t=cwt(e,"string");return Fy(t)=="symbol"?t:t+""}function cwt(e,t){if(Fy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Fy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lwt={xAxis:["bottom","top"],yAxis:["left","right"]},uwt={width:"100%",height:"100%"},oye={x:0,y:0};function mR(e){return e}var dwt=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},hwt=function(t,n,i,o){var u=n.find(function(b){return b&&b.index===i});if(u){if(t==="horizontal")return{x:u.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:u.coordinate};if(t==="centric"){var h=u.coordinate,p=o.radius;return Xe(Xe(Xe({},o),ts(o.cx,o.cy,p,h)),{},{angle:h,radius:p})}var g=u.coordinate,v=o.angle;return Xe(Xe(Xe({},o),ts(o.cx,o.cy,g,v)),{},{angle:v,radius:g})}return oye},fO=function(t,n){var i=n.graphicalItems,o=n.dataStartIndex,u=n.dataEndIndex,h=(i??[]).reduce(function(p,g){var v=g.props.data;return v&&v.length?[].concat(Vy(p),Vy(v)):p},[]);return h.length>0?h:t&&t.length&&xt(o)&&xt(u)?t.slice(o,u+1):[]};function cye(e){return e==="number"?[0,"auto"]:void 0}var mV=function(t,n,i,o){var u=t.graphicalItems,h=t.tooltipAxis,p=fO(n,t);return i<0||!u||!u.length||i>=p.length?null:u.reduce(function(g,v){var b,E=(b=v.props.data)!==null&&b!==void 0?b:n;E&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=i&&(E=E.slice(t.dataStartIndex,t.dataEndIndex+1));var T;if(h.dataKey&&!h.allowDuplicatedCategory){var C=E===void 0?p:E;T=qU(C,h.dataKey,o)}else T=E&&E[i]||p[i];return T?[].concat(Vy(g),[ave(v,T)]):g},[])},Yie=function(t,n,i,o){var u=o||{x:t.chartX,y:t.chartY},h=dwt(u,i),p=t.orderedTooltipTicks,g=t.tooltipAxis,v=t.tooltipTicks,b=Vpt(h,p,v,g);if(b>=0&&v){var E=v[b]&&v[b].value,T=mV(t,n,b,E),C=hwt(i,p,b,u);return{activeTooltipIndex:b,activeLabel:E,activePayload:T,activeCoordinate:C}}return null},fwt=function(t,n){var i=n.axes,o=n.graphicalItems,u=n.axisType,h=n.axisIdKey,p=n.stackGroups,g=n.dataStartIndex,v=n.dataEndIndex,b=t.layout,E=t.children,T=t.stackOffset,C=nve(b,u);return i.reduce(function(R,N){var O,j=N.type.defaultProps!==void 0?Xe(Xe({},N.type.defaultProps),N.props):N.props,k=j.type,P=j.dataKey,M=j.allowDataOverflow,D=j.allowDuplicatedCategory,U=j.scale,F=j.ticks,H=j.includeHidden,W=j[h];if(R[W])return R;var q=fO(t.data,{graphicalItems:o.filter(function(ve){var Te,Pe=h in ve.props?ve.props[h]:(Te=ve.type.defaultProps)===null||Te===void 0?void 0:Te[h];return Pe===W}),dataStartIndex:g,dataEndIndex:v}),Y=q.length,z,Z,X;F0t(j.domain,M,k)&&(z=DF(j.domain,null,M),C&&(k==="number"||U!=="auto")&&(X=i0(q,P,"category")));var ae=cye(k);if(!z||z.length===0){var se,J=(se=j.domain)!==null&&se!==void 0?se:ae;if(P){if(z=i0(q,P,k),k==="category"&&C){var re=CQe(z);D&&re?(Z=z,z=BA(0,Y)):D||(z=Are(J,z,N).reduce(function(ve,Te){return ve.indexOf(Te)>=0?ve:[].concat(Vy(ve),[Te])},[]))}else if(k==="category")D?z=z.filter(function(ve){return ve!==""&&!Nr(ve)}):z=Are(J,z,N).reduce(function(ve,Te){return ve.indexOf(Te)>=0||Te===""||Nr(Te)?ve:[].concat(Vy(ve),[Te])},[]);else if(k==="number"){var ee=Hpt(q,o.filter(function(ve){var Te,Pe,qe=h in ve.props?ve.props[h]:(Te=ve.type.defaultProps)===null||Te===void 0?void 0:Te[h],st="hide"in ve.props?ve.props.hide:(Pe=ve.type.defaultProps)===null||Pe===void 0?void 0:Pe.hide;return qe===W&&(H||!st)}),P,u,b);ee&&(z=ee)}C&&(k==="number"||U!=="auto")&&(X=i0(q,P,"category"))}else C?z=BA(0,Y):p&&p[W]&&p[W].hasStack&&k==="number"?z=T==="expand"?[0,1]:ive(p[W].stackGroups,g,v):z=tve(q,o.filter(function(ve){var Te=h in ve.props?ve.props[h]:ve.type.defaultProps[h],Pe="hide"in ve.props?ve.props.hide:ve.type.defaultProps.hide;return Te===W&&(H||!Pe)}),k,b,!0);if(k==="number")z=hV(E,z,W,u,F),J&&(z=DF(J,z,M));else if(k==="category"&&J){var de=J,xe=z.every(function(ve){return de.indexOf(ve)>=0});xe&&(z=de)}}return Xe(Xe({},R),{},pn({},W,Xe(Xe({},j),{},{axisType:u,domain:z,categoricalDomain:X,duplicateDomain:Z,originalDomain:(O=j.domain)!==null&&O!==void 0?O:ae,isCategorical:C,layout:b})))},{})},pwt=function(t,n){var i=n.graphicalItems,o=n.Axis,u=n.axisType,h=n.axisIdKey,p=n.stackGroups,g=n.dataStartIndex,v=n.dataEndIndex,b=t.layout,E=t.children,T=fO(t.data,{graphicalItems:i,dataStartIndex:g,dataEndIndex:v}),C=T.length,R=nve(b,u),N=-1;return i.reduce(function(O,j){var k=j.type.defaultProps!==void 0?Xe(Xe({},j.type.defaultProps),j.props):j.props,P=k[h],M=cye("number");if(!O[P]){N++;var D;return R?D=BA(0,C):p&&p[P]&&p[P].hasStack?(D=ive(p[P].stackGroups,g,v),D=hV(E,D,P,u)):(D=DF(M,tve(T,i.filter(function(U){var F,H,W=h in U.props?U.props[h]:(F=U.type.defaultProps)===null||F===void 0?void 0:F[h],q="hide"in U.props?U.props.hide:(H=U.type.defaultProps)===null||H===void 0?void 0:H.hide;return W===P&&!q}),"number",b),o.defaultProps.allowDataOverflow),D=hV(E,D,P,u)),Xe(Xe({},O),{},pn({},P,Xe(Xe({axisType:u},o.defaultProps),{},{hide:!0,orientation:Mc(lwt,"".concat(u,".").concat(N%2),null),domain:D,originalDomain:M,isCategorical:R,layout:b})))}return O},{})},mwt=function(t,n){var i=n.axisType,o=i===void 0?"xAxis":i,u=n.AxisComp,h=n.graphicalItems,p=n.stackGroups,g=n.dataStartIndex,v=n.dataEndIndex,b=t.children,E="".concat(o,"Id"),T=Ml(b,u),C={};return T&&T.length?C=fwt(t,{axes:T,graphicalItems:h,axisType:o,axisIdKey:E,stackGroups:p,dataStartIndex:g,dataEndIndex:v}):h&&h.length&&(C=pwt(t,{Axis:u,graphicalItems:h,axisType:o,axisIdKey:E,stackGroups:p,dataStartIndex:g,dataEndIndex:v})),C},gwt=function(t){var n=Gh(t),i=Rd(n,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:h3(i,function(o){return o.coordinate}),tooltipAxis:n,tooltipAxisBandSize:PA(n,i)}},Xie=function(t){var n=t.children,i=t.defaultShowTooltip,o=Mo(n,Oy),u=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(u=o.props.startIndex),o.props.endIndex>=0&&(h=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:u,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!i}},vwt=function(t){return!t||!t.length?!1:t.some(function(n){var i=Od(n&&n.type);return i&&i.indexOf("Bar")>=0})},Jie=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},ywt=function(t,n){var i=t.props,o=t.graphicalItems,u=t.xAxisMap,h=u===void 0?{}:u,p=t.yAxisMap,g=p===void 0?{}:p,v=i.width,b=i.height,E=i.children,T=i.margin||{},C=Mo(E,Oy),R=Mo(E,kd),N=Object.keys(g).reduce(function(D,U){var F=g[U],H=F.orientation;return!F.mirror&&!F.hide?Xe(Xe({},D),{},pn({},H,D[H]+F.width)):D},{left:T.left||0,right:T.right||0}),O=Object.keys(h).reduce(function(D,U){var F=h[U],H=F.orientation;return!F.mirror&&!F.hide?Xe(Xe({},D),{},pn({},H,Mc(D,"".concat(H))+F.height)):D},{top:T.top||0,bottom:T.bottom||0}),j=Xe(Xe({},O),N),k=j.bottom;C&&(j.bottom+=C.props.height||Oy.defaultProps.height),R&&n&&(j=Wpt(j,o,i,n));var P=v-j.left-j.right,M=b-j.top-j.bottom;return Xe(Xe({brushBottom:k},j),{},{width:Math.max(P,0),height:Math.max(M,0)})},_wt=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},bwt=function(t){var n=t.chartName,i=t.GraphicalChild,o=t.defaultTooltipEventType,u=o===void 0?"axis":o,h=t.validateTooltipEventTypes,p=h===void 0?["axis"]:h,g=t.axisComponents,v=t.legendContent,b=t.formatAxisMap,E=t.defaultProps,T=function(j,k){var P=k.graphicalItems,M=k.stackGroups,D=k.offset,U=k.updateId,F=k.dataStartIndex,H=k.dataEndIndex,W=j.barSize,q=j.layout,Y=j.barGap,z=j.barCategoryGap,Z=j.maxBarSize,X=Jie(q),ae=X.numericAxisName,se=X.cateAxisName,J=vwt(P),re=[];return P.forEach(function(ee,de){var xe=fO(j.data,{graphicalItems:[ee],dataStartIndex:F,dataEndIndex:H}),ve=ee.type.defaultProps!==void 0?Xe(Xe({},ee.type.defaultProps),ee.props):ee.props,Te=ve.dataKey,Pe=ve.maxBarSize,qe=ve["".concat(ae,"Id")],st=ve["".concat(se,"Id")],ze={},ft=g.reduce(function(Ne,We){var gt=k["".concat(We.axisType,"Map")],ot=ve["".concat(We.axisType,"Id")];gt&&gt[ot]||We.axisType==="zAxis"||ym();var pt=gt[ot];return Xe(Xe({},Ne),{},pn(pn({},We.axisType,pt),"".concat(We.axisType,"Ticks"),Rd(pt)))},ze),$e=ft[se],at=ft["".concat(se,"Ticks")],ke=M&&M[qe]&&M[qe].hasStack&&rmt(ee,M[qe].stackGroups),je=Od(ee.type).indexOf("Bar")>=0,Pt=PA($e,at),Dt=[],cn=J&&Bpt({barSize:W,stackGroups:M,totalSize:_wt(ft,se)});if(je){var ut,wt,Rt=Nr(Pe)?Z:Pe,Le=(ut=(wt=PA($e,at,!0))!==null&&wt!==void 0?wt:Rt)!==null&&ut!==void 0?ut:0;Dt=$pt({barGap:Y,barCategoryGap:z,bandSize:Le!==Pt?Le:Pt,sizeList:cn[st],maxBarSize:Rt}),Le!==Pt&&(Dt=Dt.map(function(Ne){return Xe(Xe({},Ne),{},{position:Xe(Xe({},Ne.position),{},{offset:Ne.position.offset-Le/2})})}))}var ge=ee&&ee.type&&ee.type.getComposedData;ge&&re.push({props:Xe(Xe({},ge(Xe(Xe({},ft),{},{displayedData:xe,props:j,dataKey:Te,item:ee,bandSize:Pt,barPosition:Dt,offset:D,stackedData:ke,layout:q,dataStartIndex:F,dataEndIndex:H}))),{},pn(pn(pn({key:ee.key||"item-".concat(de)},ae,ft[ae]),se,ft[se]),"animationId",U)),childIndex:UQe(ee,j.children),item:ee})}),re},C=function(j,k){var P=j.props,M=j.dataStartIndex,D=j.dataEndIndex,U=j.updateId;if(!Ste({props:P}))return null;var F=P.children,H=P.layout,W=P.stackOffset,q=P.data,Y=P.reverseStackOrder,z=Jie(H),Z=z.numericAxisName,X=z.cateAxisName,ae=Ml(F,i),se=emt(q,ae,"".concat(Z,"Id"),"".concat(X,"Id"),W,Y),J=g.reduce(function(ve,Te){var Pe="".concat(Te.axisType,"Map");return Xe(Xe({},ve),{},pn({},Pe,mwt(P,Xe(Xe({},Te),{},{graphicalItems:ae,stackGroups:Te.axisType===Z&&se,dataStartIndex:M,dataEndIndex:D}))))},{}),re=ywt(Xe(Xe({},J),{},{props:P,graphicalItems:ae}),k==null?void 0:k.legendBBox);Object.keys(J).forEach(function(ve){J[ve]=b(P,J[ve],re,ve.replace("Map",""),n)});var ee=J["".concat(X,"Map")],de=gwt(ee),xe=T(P,Xe(Xe({},J),{},{dataStartIndex:M,dataEndIndex:D,updateId:U,graphicalItems:ae,stackGroups:se,offset:re}));return Xe(Xe({formattedGraphicalItems:xe,graphicalItems:ae,offset:re,stackGroups:se},de),J)},R=function(O){function j(k){var P,M,D;return Z0t(this,j),D=twt(this,j,[k]),pn(D,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),pn(D,"accessibilityManager",new U0t),pn(D,"handleLegendBBoxUpdate",function(U){if(U){var F=D.state,H=F.dataStartIndex,W=F.dataEndIndex,q=F.updateId;D.setState(Xe({legendBBox:U},C({props:D.props,dataStartIndex:H,dataEndIndex:W,updateId:q},Xe(Xe({},D.state),{},{legendBBox:U}))))}}),pn(D,"handleReceiveSyncEvent",function(U,F,H){if(D.props.syncId===U){if(H===D.eventEmitterSymbol&&typeof D.props.syncMethod!="function")return;D.applySyncEvent(F)}}),pn(D,"handleBrushChange",function(U){var F=U.startIndex,H=U.endIndex;if(F!==D.state.dataStartIndex||H!==D.state.dataEndIndex){var W=D.state.updateId;D.setState(function(){return Xe({dataStartIndex:F,dataEndIndex:H},C({props:D.props,dataStartIndex:F,dataEndIndex:H,updateId:W},D.state))}),D.triggerSyncEvent({dataStartIndex:F,dataEndIndex:H})}}),pn(D,"handleMouseEnter",function(U){var F=D.getMouseInfo(U);if(F){var H=Xe(Xe({},F),{},{isTooltipActive:!0});D.setState(H),D.triggerSyncEvent(H);var W=D.props.onMouseEnter;Kn(W)&&W(H,U)}}),pn(D,"triggeredAfterMouseMove",function(U){var F=D.getMouseInfo(U),H=F?Xe(Xe({},F),{},{isTooltipActive:!0}):{isTooltipActive:!1};D.setState(H),D.triggerSyncEvent(H);var W=D.props.onMouseMove;Kn(W)&&W(H,U)}),pn(D,"handleItemMouseEnter",function(U){D.setState(function(){return{isTooltipActive:!0,activeItem:U,activePayload:U.tooltipPayload,activeCoordinate:U.tooltipPosition||{x:U.cx,y:U.cy}}})}),pn(D,"handleItemMouseLeave",function(){D.setState(function(){return{isTooltipActive:!1}})}),pn(D,"handleMouseMove",function(U){U.persist(),D.throttleTriggeredAfterMouseMove(U)}),pn(D,"handleMouseLeave",function(U){D.throttleTriggeredAfterMouseMove.cancel();var F={isTooltipActive:!1};D.setState(F),D.triggerSyncEvent(F);var H=D.props.onMouseLeave;Kn(H)&&H(F,U)}),pn(D,"handleOuterEvent",function(U){var F=MQe(U),H=Mc(D.props,"".concat(F));if(F&&Kn(H)){var W,q;/.*touch.*/i.test(F)?q=D.getMouseInfo(U.changedTouches[0]):q=D.getMouseInfo(U),H((W=q)!==null&&W!==void 0?W:{},U)}}),pn(D,"handleClick",function(U){var F=D.getMouseInfo(U);if(F){var H=Xe(Xe({},F),{},{isTooltipActive:!0});D.setState(H),D.triggerSyncEvent(H);var W=D.props.onClick;Kn(W)&&W(H,U)}}),pn(D,"handleMouseDown",function(U){var F=D.props.onMouseDown;if(Kn(F)){var H=D.getMouseInfo(U);F(H,U)}}),pn(D,"handleMouseUp",function(U){var F=D.props.onMouseUp;if(Kn(F)){var H=D.getMouseInfo(U);F(H,U)}}),pn(D,"handleTouchMove",function(U){U.changedTouches!=null&&U.changedTouches.length>0&&D.throttleTriggeredAfterMouseMove(U.changedTouches[0])}),pn(D,"handleTouchStart",function(U){U.changedTouches!=null&&U.changedTouches.length>0&&D.handleMouseDown(U.changedTouches[0])}),pn(D,"handleTouchEnd",function(U){U.changedTouches!=null&&U.changedTouches.length>0&&D.handleMouseUp(U.changedTouches[0])}),pn(D,"handleDoubleClick",function(U){var F=D.props.onDoubleClick;if(Kn(F)){var H=D.getMouseInfo(U);F(H,U)}}),pn(D,"handleContextMenu",function(U){var F=D.props.onContextMenu;if(Kn(F)){var H=D.getMouseInfo(U);F(H,U)}}),pn(D,"triggerSyncEvent",function(U){D.props.syncId!==void 0&&ZL.emit(QL,D.props.syncId,U,D.eventEmitterSymbol)}),pn(D,"applySyncEvent",function(U){var F=D.props,H=F.layout,W=F.syncMethod,q=D.state.updateId,Y=U.dataStartIndex,z=U.dataEndIndex;if(U.dataStartIndex!==void 0||U.dataEndIndex!==void 0)D.setState(Xe({dataStartIndex:Y,dataEndIndex:z},C({props:D.props,dataStartIndex:Y,dataEndIndex:z,updateId:q},D.state)));else if(U.activeTooltipIndex!==void 0){var Z=U.chartX,X=U.chartY,ae=U.activeTooltipIndex,se=D.state,J=se.offset,re=se.tooltipTicks;if(!J)return;if(typeof W=="function")ae=W(re,U);else if(W==="value"){ae=-1;for(var ee=0;ee<re.length;ee++)if(re[ee].value===U.activeLabel){ae=ee;break}}var de=Xe(Xe({},J),{},{x:J.left,y:J.top}),xe=Math.min(Z,de.x+de.width),ve=Math.min(X,de.y+de.height),Te=re[ae]&&re[ae].value,Pe=mV(D.state,D.props.data,ae),qe=re[ae]?{x:H==="horizontal"?re[ae].coordinate:xe,y:H==="horizontal"?ve:re[ae].coordinate}:oye;D.setState(Xe(Xe({},U),{},{activeLabel:Te,activeCoordinate:qe,activePayload:Pe,activeTooltipIndex:ae}))}else D.setState(U)}),pn(D,"renderCursor",function(U){var F,H=D.state,W=H.isTooltipActive,q=H.activeCoordinate,Y=H.activePayload,z=H.offset,Z=H.activeTooltipIndex,X=H.tooltipAxisBandSize,ae=D.getTooltipEventType(),se=(F=U.props.active)!==null&&F!==void 0?F:W,J=D.props.layout,re=U.key||"_recharts-cursor";return me.createElement(H0t,{key:re,activeCoordinate:q,activePayload:Y,activeTooltipIndex:Z,chartName:n,element:U,isActive:se,layout:J,offset:z,tooltipAxisBandSize:X,tooltipEventType:ae})}),pn(D,"renderPolarAxis",function(U,F,H){var W=Mc(U,"type.axisType"),q=Mc(D.state,"".concat(W,"Map")),Y=U.type.defaultProps,z=Y!==void 0?Xe(Xe({},Y),U.props):U.props,Z=q&&q[z["".concat(W,"Id")]];return w.cloneElement(U,Xe(Xe({},Z),{},{className:er(W,Z.className),key:U.key||"".concat(F,"-").concat(H),ticks:Rd(Z,!0)}))}),pn(D,"renderPolarGrid",function(U){var F=U.props,H=F.radialLines,W=F.polarAngles,q=F.polarRadius,Y=D.state,z=Y.radiusAxisMap,Z=Y.angleAxisMap,X=Gh(z),ae=Gh(Z),se=ae.cx,J=ae.cy,re=ae.innerRadius,ee=ae.outerRadius;return w.cloneElement(U,{polarAngles:Array.isArray(W)?W:Rd(ae,!0).map(function(de){return de.coordinate}),polarRadius:Array.isArray(q)?q:Rd(X,!0).map(function(de){return de.coordinate}),cx:se,cy:J,innerRadius:re,outerRadius:ee,key:U.key||"polar-grid",radialLines:H})}),pn(D,"renderLegend",function(){var U=D.state.formattedGraphicalItems,F=D.props,H=F.children,W=F.width,q=F.height,Y=D.props.margin||{},z=W-(Y.left||0)-(Y.right||0),Z=Qge({children:H,formattedGraphicalItems:U,legendWidth:z,legendContent:v});if(!Z)return null;var X=Z.item,ae=Kie(Z,z0t);return w.cloneElement(X,Xe(Xe({},ae),{},{chartWidth:W,chartHeight:q,margin:Y,onBBoxUpdate:D.handleLegendBBoxUpdate}))}),pn(D,"renderTooltip",function(){var U,F=D.props,H=F.children,W=F.accessibilityLayer,q=Mo(H,Nc);if(!q)return null;var Y=D.state,z=Y.isTooltipActive,Z=Y.activeCoordinate,X=Y.activePayload,ae=Y.activeLabel,se=Y.offset,J=(U=q.props.active)!==null&&U!==void 0?U:z;return w.cloneElement(q,{viewBox:Xe(Xe({},se),{},{x:se.left,y:se.top}),active:J,label:ae,payload:J?X:[],coordinate:Z,accessibilityLayer:W})}),pn(D,"renderBrush",function(U){var F=D.props,H=F.margin,W=F.data,q=D.state,Y=q.offset,z=q.dataStartIndex,Z=q.dataEndIndex,X=q.updateId;return w.cloneElement(U,{key:U.key||"_recharts-brush",onChange:uR(D.handleBrushChange,U.props.onChange),data:W,x:xt(U.props.x)?U.props.x:Y.left,y:xt(U.props.y)?U.props.y:Y.top+Y.height+Y.brushBottom-(H.bottom||0),width:xt(U.props.width)?U.props.width:Y.width,startIndex:z,endIndex:Z,updateId:"brush-".concat(X)})}),pn(D,"renderReferenceElement",function(U,F,H){if(!U)return null;var W=D,q=W.clipPathId,Y=D.state,z=Y.xAxisMap,Z=Y.yAxisMap,X=Y.offset,ae=U.type.defaultProps||{},se=U.props,J=se.xAxisId,re=J===void 0?ae.xAxisId:J,ee=se.yAxisId,de=ee===void 0?ae.yAxisId:ee;return w.cloneElement(U,{key:U.key||"".concat(F,"-").concat(H),xAxis:z[re],yAxis:Z[de],viewBox:{x:X.left,y:X.top,width:X.width,height:X.height},clipPathId:q})}),pn(D,"renderActivePoints",function(U){var F=U.item,H=U.activePoint,W=U.basePoint,q=U.childIndex,Y=U.isRange,z=[],Z=F.props.key,X=F.item.type.defaultProps!==void 0?Xe(Xe({},F.item.type.defaultProps),F.item.props):F.item.props,ae=X.activeDot,se=X.dataKey,J=Xe(Xe({index:q,dataKey:se,cx:H.x,cy:H.y,r:4,fill:V3(F.item),strokeWidth:2,stroke:"#fff",payload:H.payload,value:H.value},Tr(ae,!1)),rA(ae));return z.push(j.renderActiveDot(ae,J,"".concat(Z,"-activePoint-").concat(q))),W?z.push(j.renderActiveDot(ae,Xe(Xe({},J),{},{cx:W.x,cy:W.y}),"".concat(Z,"-basePoint-").concat(q))):Y&&z.push(null),z}),pn(D,"renderGraphicChild",function(U,F,H){var W=D.filterFormatItem(U,F,H);if(!W)return null;var q=D.getTooltipEventType(),Y=D.state,z=Y.isTooltipActive,Z=Y.tooltipAxis,X=Y.activeTooltipIndex,ae=Y.activeLabel,se=D.props.children,J=Mo(se,Nc),re=W.props,ee=re.points,de=re.isRange,xe=re.baseLine,ve=W.item.type.defaultProps!==void 0?Xe(Xe({},W.item.type.defaultProps),W.item.props):W.item.props,Te=ve.activeDot,Pe=ve.hide,qe=ve.activeBar,st=ve.activeShape,ze=!!(!Pe&&z&&J&&(Te||qe||st)),ft={};q!=="axis"&&J&&J.props.trigger==="click"?ft={onClick:uR(D.handleItemMouseEnter,U.props.onClick)}:q!=="axis"&&(ft={onMouseLeave:uR(D.handleItemMouseLeave,U.props.onMouseLeave),onMouseEnter:uR(D.handleItemMouseEnter,U.props.onMouseEnter)});var $e=w.cloneElement(U,Xe(Xe({},W.props),ft));function at(We){return typeof Z.dataKey=="function"?Z.dataKey(We.payload):null}if(ze)if(X>=0){var ke,je;if(Z.dataKey&&!Z.allowDuplicatedCategory){var Pt=typeof Z.dataKey=="function"?at:"payload.".concat(Z.dataKey.toString());ke=qU(ee,Pt,ae),je=de&&xe&&qU(xe,Pt,ae)}else ke=ee==null?void 0:ee[X],je=de&&xe&&xe[X];if(st||qe){var Dt=U.props.activeIndex!==void 0?U.props.activeIndex:X;return[w.cloneElement(U,Xe(Xe(Xe({},W.props),ft),{},{activeIndex:Dt})),null,null]}if(!Nr(ke))return[$e].concat(Vy(D.renderActivePoints({item:W,activePoint:ke,basePoint:je,childIndex:X,isRange:de})))}else{var cn,ut=(cn=D.getItemByXY(D.state.activeCoordinate))!==null&&cn!==void 0?cn:{graphicalItem:$e},wt=ut.graphicalItem,Rt=wt.item,Le=Rt===void 0?U:Rt,ge=wt.childIndex,Ne=Xe(Xe(Xe({},W.props),ft),{},{activeIndex:ge});return[w.cloneElement(Le,Ne),null,null]}return de?[$e,null,null]:[$e,null]}),pn(D,"renderCustomized",function(U,F,H){return w.cloneElement(U,Xe(Xe({key:"recharts-customized-".concat(H)},D.props),D.state))}),pn(D,"renderMap",{CartesianGrid:{handler:mR,once:!0},ReferenceArea:{handler:D.renderReferenceElement},ReferenceLine:{handler:mR},ReferenceDot:{handler:D.renderReferenceElement},XAxis:{handler:mR},YAxis:{handler:mR},Brush:{handler:D.renderBrush,once:!0},Bar:{handler:D.renderGraphicChild},Line:{handler:D.renderGraphicChild},Area:{handler:D.renderGraphicChild},Radar:{handler:D.renderGraphicChild},RadialBar:{handler:D.renderGraphicChild},Scatter:{handler:D.renderGraphicChild},Pie:{handler:D.renderGraphicChild},Funnel:{handler:D.renderGraphicChild},Tooltip:{handler:D.renderCursor,once:!0},PolarGrid:{handler:D.renderPolarGrid,once:!0},PolarAngleAxis:{handler:D.renderPolarAxis},PolarRadiusAxis:{handler:D.renderPolarAxis},Customized:{handler:D.renderCustomized}}),D.clipPathId="".concat((P=k.id)!==null&&P!==void 0?P:VI("recharts"),"-clip"),D.throttleTriggeredAfterMouseMove=Zme(D.triggeredAfterMouseMove,(M=k.throttleDelay)!==null&&M!==void 0?M:1e3/60),D.state={},D}return iwt(j,O),ewt(j,[{key:"componentDidMount",value:function(){var P,M;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(P=this.props.margin.left)!==null&&P!==void 0?P:0,top:(M=this.props.margin.top)!==null&&M!==void 0?M:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var P=this.props,M=P.children,D=P.data,U=P.height,F=P.layout,H=Mo(M,Nc);if(H){var W=H.props.defaultIndex;if(!(typeof W!="number"||W<0||W>this.state.tooltipTicks.length-1)){var q=this.state.tooltipTicks[W]&&this.state.tooltipTicks[W].value,Y=mV(this.state,D,W,q),z=this.state.tooltipTicks[W].coordinate,Z=(this.state.offset.top+U)/2,X=F==="horizontal",ae=X?{x:z,y:Z}:{y:z,x:Z},se=this.state.formattedGraphicalItems.find(function(re){var ee=re.item;return ee.type.name==="Scatter"});se&&(ae=Xe(Xe({},ae),se.props.points[W].tooltipPosition),Y=se.props.points[W].tooltipPayload);var J={activeTooltipIndex:W,isTooltipActive:!0,activeLabel:q,activePayload:Y,activeCoordinate:ae};this.setState(J),this.renderCursor(H),this.accessibilityManager.setIndex(W)}}}},{key:"getSnapshotBeforeUpdate",value:function(P,M){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==M.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==P.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==P.margin){var D,U;this.accessibilityManager.setDetails({offset:{left:(D=this.props.margin.left)!==null&&D!==void 0?D:0,top:(U=this.props.margin.top)!==null&&U!==void 0?U:0}})}return null}},{key:"componentDidUpdate",value:function(P){XU([Mo(P.children,Nc)],[Mo(this.props.children,Nc)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var P=Mo(this.props.children,Nc);if(P&&typeof P.props.shared=="boolean"){var M=P.props.shared?"axis":"item";return p.indexOf(M)>=0?M:u}return u}},{key:"getMouseInfo",value:function(P){if(!this.container)return null;var M=this.container,D=M.getBoundingClientRect(),U=hut(D),F={chartX:Math.round(P.pageX-U.left),chartY:Math.round(P.pageY-U.top)},H=D.width/M.offsetWidth||1,W=this.inRange(F.chartX,F.chartY,H);if(!W)return null;var q=this.state,Y=q.xAxisMap,z=q.yAxisMap,Z=this.getTooltipEventType(),X=Yie(this.state,this.props.data,this.props.layout,W);if(Z!=="axis"&&Y&&z){var ae=Gh(Y).scale,se=Gh(z).scale,J=ae&&ae.invert?ae.invert(F.chartX):null,re=se&&se.invert?se.invert(F.chartY):null;return Xe(Xe({},F),{},{xValue:J,yValue:re},X)}return X?Xe(Xe({},F),X):null}},{key:"inRange",value:function(P,M){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,U=this.props.layout,F=P/D,H=M/D;if(U==="horizontal"||U==="vertical"){var W=this.state.offset,q=F>=W.left&&F<=W.left+W.width&&H>=W.top&&H<=W.top+W.height;return q?{x:F,y:H}:null}var Y=this.state,z=Y.angleAxisMap,Z=Y.radiusAxisMap;if(z&&Z){var X=Gh(z);return Pre({x:F,y:H},X)}return null}},{key:"parseEventsOfWrapper",value:function(){var P=this.props.children,M=this.getTooltipEventType(),D=Mo(P,Nc),U={};D&&M==="axis"&&(D.props.trigger==="click"?U={onClick:this.handleClick}:U={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var F=rA(this.props,this.handleOuterEvent);return Xe(Xe({},F),U)}},{key:"addListener",value:function(){ZL.on(QL,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){ZL.removeListener(QL,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(P,M,D){for(var U=this.state.formattedGraphicalItems,F=0,H=U.length;F<H;F++){var W=U[F];if(W.item===P||W.props.key===P.key||M===Od(W.item.type)&&D===W.childIndex)return W}return null}},{key:"renderClipPath",value:function(){var P=this.clipPathId,M=this.state.offset,D=M.left,U=M.top,F=M.height,H=M.width;return me.createElement("defs",null,me.createElement("clipPath",{id:P},me.createElement("rect",{x:D,y:U,height:F,width:H})))}},{key:"getXScales",value:function(){var P=this.state.xAxisMap;return P?Object.entries(P).reduce(function(M,D){var U=zie(D,2),F=U[0],H=U[1];return Xe(Xe({},M),{},pn({},F,H.scale))},{}):null}},{key:"getYScales",value:function(){var P=this.state.yAxisMap;return P?Object.entries(P).reduce(function(M,D){var U=zie(D,2),F=U[0],H=U[1];return Xe(Xe({},M),{},pn({},F,H.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(P){var M;return(M=this.state.xAxisMap)===null||M===void 0||(M=M[P])===null||M===void 0?void 0:M.scale}},{key:"getYScaleByAxisId",value:function(P){var M;return(M=this.state.yAxisMap)===null||M===void 0||(M=M[P])===null||M===void 0?void 0:M.scale}},{key:"getItemByXY",value:function(P){var M=this.state,D=M.formattedGraphicalItems,U=M.activeItem;if(D&&D.length)for(var F=0,H=D.length;F<H;F++){var W=D[F],q=W.props,Y=W.item,z=Y.type.defaultProps!==void 0?Xe(Xe({},Y.type.defaultProps),Y.props):Y.props,Z=Od(Y.type);if(Z==="Bar"){var X=(q.data||[]).find(function(re){return qvt(P,re)});if(X)return{graphicalItem:W,payload:X}}else if(Z==="RadialBar"){var ae=(q.data||[]).find(function(re){return Pre(P,re)});if(ae)return{graphicalItem:W,payload:ae}}else if(aO(W,U)||sO(W,U)||ww(W,U)){var se=Jyt({graphicalItem:W,activeTooltipItem:U,itemData:z.data}),J=z.activeIndex===void 0?se:z.activeIndex;return{graphicalItem:Xe(Xe({},W),{},{childIndex:J}),payload:ww(W,U)?z.data[se]:W.props.data[se]}}}return null}},{key:"render",value:function(){var P=this;if(!Ste(this))return null;var M=this.props,D=M.children,U=M.className,F=M.width,H=M.height,W=M.style,q=M.compact,Y=M.title,z=M.desc,Z=Kie(M,K0t),X=Tr(Z,!1);if(q)return me.createElement(Oie,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement(ZU,Iv({},X,{width:F,height:H,title:Y,desc:z}),this.renderClipPath(),Tte(D,this.renderMap)));if(this.props.accessibilityLayer){var ae,se;X.tabIndex=(ae=this.props.tabIndex)!==null&&ae!==void 0?ae:0,X.role=(se=this.props.role)!==null&&se!==void 0?se:"application",X.onKeyDown=function(re){P.accessibilityManager.keyboardEvent(re)},X.onFocus=function(){P.accessibilityManager.focus()}}var J=this.parseEventsOfWrapper();return me.createElement(Oie,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement("div",Iv({className:er("recharts-wrapper",U),style:Xe({position:"relative",cursor:"default",width:F,height:H},W)},J,{ref:function(ee){P.container=ee}}),me.createElement(ZU,Iv({},X,{width:F,height:H,title:Y,desc:z,style:uwt}),this.renderClipPath(),Tte(D,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(w.Component);pn(R,"displayName",n),pn(R,"defaultProps",Xe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},E)),pn(R,"getDerivedStateFromProps",function(O,j){var k=O.dataKey,P=O.data,M=O.children,D=O.width,U=O.height,F=O.layout,H=O.stackOffset,W=O.margin,q=j.dataStartIndex,Y=j.dataEndIndex;if(j.updateId===void 0){var z=Xie(O);return Xe(Xe(Xe({},z),{},{updateId:0},C(Xe(Xe({props:O},z),{},{updateId:0}),j)),{},{prevDataKey:k,prevData:P,prevWidth:D,prevHeight:U,prevLayout:F,prevStackOffset:H,prevMargin:W,prevChildren:M})}if(k!==j.prevDataKey||P!==j.prevData||D!==j.prevWidth||U!==j.prevHeight||F!==j.prevLayout||H!==j.prevStackOffset||!$v(W,j.prevMargin)){var Z=Xie(O),X={chartX:j.chartX,chartY:j.chartY,isTooltipActive:j.isTooltipActive},ae=Xe(Xe({},Yie(j,P,F)),{},{updateId:j.updateId+1}),se=Xe(Xe(Xe({},Z),X),ae);return Xe(Xe(Xe({},se),C(Xe({props:O},se),j)),{},{prevDataKey:k,prevData:P,prevWidth:D,prevHeight:U,prevLayout:F,prevStackOffset:H,prevMargin:W,prevChildren:M})}if(!XU(M,j.prevChildren)){var J,re,ee,de,xe=Mo(M,Oy),ve=xe&&(J=(re=xe.props)===null||re===void 0?void 0:re.startIndex)!==null&&J!==void 0?J:q,Te=xe&&(ee=(de=xe.props)===null||de===void 0?void 0:de.endIndex)!==null&&ee!==void 0?ee:Y,Pe=ve!==q||Te!==Y,qe=!Nr(P),st=qe&&!Pe?j.updateId:j.updateId+1;return Xe(Xe({updateId:st},C(Xe(Xe({props:O},j),{},{updateId:st,dataStartIndex:ve,dataEndIndex:Te}),j)),{},{prevChildren:M,dataStartIndex:ve,dataEndIndex:Te})}return null}),pn(R,"renderActiveDot",function(O,j,k){var P;return w.isValidElement(O)?P=w.cloneElement(O,j):Kn(O)?P=O(j):P=me.createElement(_ve,j),me.createElement($a,{className:"recharts-active-dot",key:k},P)});var N=w.forwardRef(function(j,k){return me.createElement(R,Iv({},j,{ref:k}))});return N.displayName=R.displayName,N},J3=bwt({chartName:"BarChart",GraphicalChild:Bo,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:b_},{axisType:"yAxis",AxisComp:E_}],formatAxisMap:wbt});const Zie="https://api.gada.chat",Ewt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function IE({title:e,value:t,gradient:n,Icon:i}){return c.jsxs("div",{className:`relative overflow-hidden rounded-3xl px-6 py-7 text-white shadow-sm bg-gradient-to-tr ${n}`,children:[c.jsx("div",{className:"pointer-events-none absolute -right-10 -bottom-10 h-40 w-40 rounded-full bg-white/20"}),c.jsx("div",{className:"pointer-events-none absolute -right-16 bottom-0 h-28 w-28 rounded-full bg-white/10"}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-5xl font-extrabold leading-none",children:t}),c.jsx("div",{className:"mt-2 text-xl font-semibold opacity-95",children:e})]}),c.jsx("div",{className:"shrink-0",children:c.jsx("div",{className:"grid place-items-center h-14 w-14 rounded-2xl bg-white/15",children:c.jsx(i,{className:"h-7 w-7 text-white"})})})]})]})}function yu({title:e,value:t,gradient:n,Icon:i}){return c.jsxs("div",{className:`relative overflow-hidden rounded-3xl px-5 py-6 text-white shadow-sm bg-gradient-to-tr ${n}`,children:[c.jsx("div",{className:"pointer-events-none absolute -right-10 -bottom-10 h-32 w-32 rounded-full bg-white/15"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-extrabold leading-none",children:t}),c.jsx("div",{className:"mt-1 text-sm font-medium opacity-95",children:e})]}),c.jsx("div",{className:"h-10 w-10 grid place-items-center rounded-xl bg-white/15",children:c.jsx(i,{className:"h-5 w-5 text-white"})})]})]})}function wwt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState(null),[u,h]=w.useState(new Date().getFullYear()),[p,g]=w.useState(null);w.useEffect(()=>{n&&fetch(`${Zie}/api/admin/stats`,{headers:t}).then(b=>{if(!b.ok)throw new Error("Failed to load stats");return b.json()}).then(o).catch(console.error)},[n]),w.useEffect(()=>{if(!n)return;(async()=>{try{const T=await fetch(`${Zie}/api/admin/stats/monthly?year=${u}`,{headers:t});if(T.ok){const C=await T.json();g(C);return}}catch{}const E=window;E&&E.__ADMIN_MONTHLY__&&g(E.__ADMIN_MONTHLY__)})()},[n,u,t]);const v=w.useMemo(()=>p?Ewt.map((b,E)=>{var T,C,R,N,O;return{month:b,Users:((T=p.users)==null?void 0:T[E])??0,Pages:((C=p.pages)==null?void 0:C[E])??0,Groups:((R=p.groups)==null?void 0:R[E])??0,Events:((N=p.events)==null?void 0:N[E])??0,Posts:((O=p.posts)==null?void 0:O[E])??0}}):[],[p]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"rounded-2xl bg-white ring-1 ring-black/5 shadow-sm p-5 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx($Ve,{className:"h-6 w-6 text-slate-700"}),c.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Dashboard"})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("select",{value:u,onChange:b=>h(Number(b.target.value)),className:"h-9 rounded-lg border border-slate-200 px-3 text-sm",children:[0,1,2,3,4].map(b=>{const E=new Date().getFullYear()-b;return c.jsx("option",{value:E,children:E},E)})})})]}),c.jsxs("div",{className:"rounded-2xl bg-white ring-1 ring-black/5 shadow-sm p-5",children:[c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(pU,{className:"h-5 w-5 text-slate-700"}),c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Monthly Average"})]})}),c.jsx("div",{className:"h-[340px]",children:c.jsx(p3,{width:"100%",height:"100%",children:c.jsxs(J3,{data:v,children:[c.jsx(hO,{strokeDasharray:"3 3"}),c.jsx(b_,{dataKey:"month"}),c.jsx(E_,{}),c.jsx(Nc,{}),c.jsx(kd,{}),c.jsx(Bo,{dataKey:"Users",fill:"#3b82f6"}),c.jsx(Bo,{dataKey:"Pages",fill:"#22c55e"}),c.jsx(Bo,{dataKey:"Groups",fill:"#f59e0b"}),c.jsx(Bo,{dataKey:"Events",fill:"#ef4444"}),c.jsx(Bo,{dataKey:"Posts",fill:"#8b5cf6"})]})})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[c.jsx(IE,{title:"Users",value:(i==null?void 0:i.totalUsers)??"—",gradient:"from-indigo-500 to-blue-500",Icon:ly}),c.jsx(IE,{title:"Online",value:(i==null?void 0:i.online)??"—",gradient:"from-cyan-500 to-sky-500",Icon:d4e}),c.jsx(IE,{title:"Pending",value:(i==null?void 0:i.pendingUsers)??"—",gradient:"from-orange-400 to-amber-500",Icon:j4}),c.jsx(IE,{title:"Not Activated",value:(i==null?void 0:i.notActivated)??"—",gradient:"from-rose-500 to-pink-500",Icon:QVe})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[c.jsx(IE,{title:"Banned",value:(i==null?void 0:i.banned)??"—",gradient:"from-red-500 to-rose-700",Icon:GVe}),c.jsx(yu,{title:"Total Visits",value:(i==null?void 0:i.totalVisits)??"—",gradient:"from-slate-700 to-slate-900",Icon:Q2}),c.jsx(yu,{title:"Today Visits",value:(i==null?void 0:i.todayVisits)??"—",gradient:"from-indigo-500 to-violet-500",Icon:Q2}),c.jsx(yu,{title:"This Month Visits",value:(i==null?void 0:i.monthVisits)??"—",gradient:"from-cyan-500 to-teal-600",Icon:Q2})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[c.jsx(yu,{title:"Posts",value:(i==null?void 0:i.posts)??"—",gradient:"from-violet-500 to-fuchsia-500",Icon:cy}),c.jsx(yu,{title:"Comments",value:(i==null?void 0:i.comments)??"—",gradient:"from-emerald-500 to-teal-600",Icon:$w}),c.jsx(yu,{title:"Pages",value:(i==null?void 0:i.pages)??"—",gradient:"from-blue-500 to-indigo-600",Icon:IN}),c.jsx(yu,{title:"Groups",value:(i==null?void 0:i.groups)??"—",gradient:"from-sky-500 to-cyan-600",Icon:h4e}),c.jsx(yu,{title:"Events",value:(i==null?void 0:i.events)??"—",gradient:"from-amber-500 to-orange-600",Icon:I4}),c.jsx(yu,{title:"Messages",value:(i==null?void 0:i.messages)??"—",gradient:"from-pink-500 to-rose-600",Icon:t4e}),c.jsx(yu,{title:"Notifications",value:(i==null?void 0:i.notifications)??"—",gradient:"from-lime-500 to-emerald-600",Icon:UVe})]})]})}const $f="https://api.gada.chat";async function Swt(e,t){const n=await fetch(`${$f}/api/admin/users/${t}`,{headers:e});if(!n.ok)throw new Error("Failed to load user");return(await n.json()).data}async function xwt(e,t,n){const i=await fetch(`${$f}/api/admin/users/${t}/profile`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(n)});if(!i.ok)throw new Error("Failed to update profile");return i.json()}async function Twt(e,t,n){const i=await fetch(`${$f}/api/admin/users/${t}/balances`,{method:"POST",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(n)});if(!i.ok)throw new Error("Failed to adjust balances");return i.json()}async function Cwt(e,t){var i;const n=await fetch(`${$f}/api/admin/users/${t}/membership`,{headers:e});if(!n.ok)throw new Error("Failed to load membership");return((i=await n.json())==null?void 0:i.data)||[]}async function Rwt(e,t){const n=await fetch(`${$f}/api/admin/users/${t}/membership`,{headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to fetch membership");return n.json()}async function Nwt(e){const t=await fetch(`${$f}/api/admin/users/packages/list`,{headers:e,credentials:"include"});if(!t.ok)throw new Error("Failed to fetch packages");return t.json()}async function Awt(e,t,n){const i=await fetch(`${$f}/api/admin/users/${t}/membership/plan`,{method:"POST",headers:e,credentials:"include",body:JSON.stringify(n)});if(!i.ok)throw new Error("Failed to update membership plan");return i.json()}async function Iwt(e,t){const n=await fetch(`${$f}/api/admin/users/${t}/membership/unsubscribe`,{method:"POST",headers:e,credentials:"include"});if(!n.ok)throw new Error("Failed to unsubscribe");return n.json()}function gR(e){return`₦${Number(e??0).toLocaleString(void 0,{maximumFractionDigits:2})}`}function Qie(e){if(!e)return"-";try{return new Date(e).toLocaleDateString(void 0,{day:"numeric",month:"long",year:"numeric"})}catch{return e}}function Owt(e){if(!e)return null;const t=new Date(e).getTime()-Date.now();return Math.max(0,Math.ceil(t/(1e3*60*60*24)))}function Pwt({userId:e,open:t,onOpenChange:n,onSaved:i}){const{accessToken:o}=ct(),u=St(o),[h,p]=w.useState(!1),[g,v]=w.useState("profile"),[b,E]=w.useState(null),[T,C]=w.useState([]),[R,N]=w.useState({}),[O,j]=w.useState(null),[k,P]=w.useState([]),[M,D]=w.useState("");w.useEffect(()=>{!t||!e||U()},[t,e]);async function U(){try{p(!0);const ee=await Swt(u,e);E(ee),N({username:ee.username,email:ee.email,phone:ee.phone||"",firstName:ee.firstName||"",lastName:ee.lastName||"",gender:ee.gender||"",birthdate:ee.birthdate?String(ee.birthdate).slice(0,10):"",bio:ee.bio||"",website:ee.website||""});const de=await Cwt(u,e);C(de);const[xe,ve]=await Promise.all([Rwt(u,e),Nwt(u)]);console.log(xe,ve),xe.data&&(j(xe.data),D(xe!=null&&xe.packageId?String(xe.packageId):"")),ve&&P(ve.data||[])}catch(ee){console.error(ee),Ce.error(ee.message||"Failed to load user"),n(!1)}finally{p(!1)}}async function F(){if(b)try{await xwt(u,b.id,R),Ce.success("Profile updated"),await U(),i==null||i()}catch(ee){console.error(ee),Ce.error(ee.message||"Failed to update")}}const[H,W]=w.useState(""),[q,Y]=w.useState(""),[z,Z]=w.useState("");async function X(){if(b){if(!H&&!q)return Ce.message("Nothing to change");try{await Twt(u,b.id,{walletDelta:H?Number(H):0,pointsDelta:q?Number(q):0,reason:z||"admin adjustment"}),Ce.success("Balances updated"),W(""),Y(""),Z(""),await U(),i==null||i()}catch(ee){console.error(ee),Ce.error(ee.message||"Failed to update balances")}}}async function ae(){if(b)try{await Iwt(u,b.id),Ce.success("User unsubscribed"),await U(),i==null||i()}catch(ee){console.error(ee),Ce.error(ee.message||"Failed to unsubscribe")}}async function se(){if(!b)return;if(!M){Ce.message("Please select a package");return}const ee=Number(M);if((O==null?void 0:O.packageId)===ee){Ce.message("No changes to save");return}try{await Awt(u,b.id,{packageId:ee}),Ce.success("Membership updated"),await U(),i==null||i()}catch(de){console.error(de),Ce.error(de.message||"Failed to update membership")}}const J=w.useMemo(()=>{const ee=(O==null?void 0:O.usage.boostedPostsUsed)??0,de=(O==null?void 0:O.limits.boostPostsLimit)??0;return de>0?Math.min(100,Math.round(ee/de*100)):0},[O]),re=w.useMemo(()=>{const ee=(O==null?void 0:O.usage.boostedPagesUsed)??0,de=(O==null?void 0:O.limits.boostPagesLimit)??0;return de>0?Math.min(100,Math.round(ee/de*100)):0},[O]);return c.jsx(H1,{open:t,onOpenChange:n,children:c.jsxs(Xw,{className:"w-full sm:max-w-2xl overflow-hidden",children:[c.jsx(lB,{children:c.jsxs(uB,{children:["Edit User ",b?`#${b.id}`:""]})}),c.jsx("div",{className:"mt-4 flex flex-col gap-4 h-[85vh]",children:c.jsxs(Rm,{value:g,onValueChange:ee=>v(ee),className:"flex-1 flex flex-col",children:[c.jsxs(jf,{className:"self-start",children:[c.jsx(Ia,{value:"profile",children:"Profile"}),c.jsx(Ia,{value:"balances",children:"Balances"}),c.jsx(Ia,{value:"membership",children:"Membership"})]}),c.jsxs(fi,{value:"profile",className:"flex-1 overflow-y-auto pr-1",children:[h&&c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"}),!h&&b&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Username"}),c.jsx(Ae,{value:R.username||"",onChange:ee=>N({...R,username:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Email"}),c.jsx(Ae,{type:"email",value:R.email||"",onChange:ee=>N({...R,email:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"First name"}),c.jsx(Ae,{value:R.firstName||"",onChange:ee=>N({...R,firstName:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Last name"}),c.jsx(Ae,{value:R.lastName||"",onChange:ee=>N({...R,lastName:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Phone"}),c.jsx(Ae,{value:R.phone||"",onChange:ee=>N({...R,phone:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Gender"}),c.jsx(Ae,{value:R.gender||"",onChange:ee=>N({...R,gender:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Birthdate"}),c.jsx(Ae,{type:"date",value:R.birthdate||"",onChange:ee=>N({...R,birthdate:ee.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Website"}),c.jsx(Ae,{value:R.website||"",onChange:ee=>N({...R,website:ee.target.value})})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Bio"}),c.jsx("textarea",{className:"w-full rounded-md border p-2 text-sm",rows:4,value:R.bio||"",onChange:ee=>N({...R,bio:ee.target.value})})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Wallet: ",c.jsx("b",{children:gR(b.wallet)})," · Points: ",c.jsx("b",{children:b.points.toFixed(0)})]}),c.jsx(be,{onClick:F,children:"Save profile"})]})]})]}),c.jsx(fi,{value:"balances",className:"flex-1 overflow-y-auto pr-1",children:b?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"rounded-lg border p-3 bg-white",children:[c.jsx("div",{className:"text-sm mb-2",children:"Current Balances"}),c.jsxs("div",{className:"flex gap-6 text-sm",children:[c.jsxs("div",{children:["Wallet: ",c.jsx("b",{children:gR(b.wallet)})]}),c.jsxs("div",{children:["Points: ",c.jsx("b",{children:b.points.toFixed(0)})]})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Wallet Δ (±)"}),c.jsx(Ae,{type:"number",value:H,onChange:ee=>W(ee.target.value),placeholder:"e.g. 1000 or -500"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Points Δ (±)"}),c.jsx(Ae,{type:"number",value:q,onChange:ee=>Y(ee.target.value),placeholder:"e.g. 50 or -20"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Reason"}),c.jsx(Ae,{value:z,onChange:ee=>Z(ee.target.value),placeholder:"admin adjustment"})]})]}),c.jsx(be,{onClick:X,children:"Apply"})]}):c.jsx("div",{className:"text-sm text-gray-500",children:"Loading…"})}),c.jsx(fi,{value:"membership",className:"flex-1 overflow-y-auto pr-1",children:c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[c.jsx("div",{className:"text-sm font-semibold mb-4",children:"PACKAGE DETAILS"}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-3",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Package"}),c.jsx("div",{className:"col-span-12 sm:col-span-9 text-[15px] font-medium",children:O!=null&&O.packageName?`${O.packageName} (${gR(O.price)} per ${(O==null?void 0:O.period_num)??0} ${(O==null?void 0:O.period)??""})`:"—"})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-3",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Subscription Date"}),c.jsx("div",{className:"col-span-12 sm:col-span-9",children:Qie(O==null?void 0:O.subscribedAt)})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-3",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Expiration Date"}),c.jsx("div",{className:"col-span-12 sm:col-span-9",children:O!=null&&O.expiresAt?c.jsxs(c.Fragment,{children:[Qie(O.expiresAt)," ",c.jsxs("span",{className:"text-gray-500",children:["(Remaining ",Owt(O.expiresAt)," Days)"]})]}):"—"})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-2",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Boosted Posts"}),c.jsxs("div",{className:"col-span-12 sm:col-span-9",children:[c.jsxs("div",{className:"text-sm mb-1",children:[(O==null?void 0:O.usage.boostedPostsUsed)??0,"/",(O==null?void 0:O.limits.boostPostsLimit)??0]}),c.jsx("div",{className:"h-3 w-full rounded-full bg-gray-200 overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full bg-[#8b5cf6]",style:{width:`${J}%`}})})]})]}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center mb-4",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Boosted Pages"}),c.jsxs("div",{className:"col-span-12 sm:col-span-9",children:[c.jsxs("div",{className:"text-sm mb-1",children:[(O==null?void 0:O.usage.boostedPagesUsed)??0,"/",(O==null?void 0:O.limits.boostPagesLimit)??0]}),c.jsx("div",{className:"h-3 w-full rounded-full bg-gray-200 overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full bg-[#8b5cf6]",style:{width:`${re}%`}})})]})]}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsx(be,{variant:"destructive",onClick:ae,disabled:!(O!=null&&O.active),children:"Unsubscribe"})})]}),c.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[c.jsx("div",{className:"text-sm font-semibold mb-4",children:"UPGRADE PACKAGE"}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end",children:[c.jsx("div",{className:"col-span-12 sm:col-span-3 text-sm text-gray-500",children:"Select Package"}),c.jsx("div",{className:"col-span-12 sm:col-span-9",children:c.jsxs("select",{className:"w-full rounded-md border px-3 py-2 text-sm",value:M,onChange:ee=>D(ee.target.value),children:[c.jsx("option",{value:"",children:"— Select —"}),k.map(ee=>c.jsxs("option",{value:ee.package_id,children:[ee.name," (",gR(ee.price)," per ",ee.period_num," ",ee.period,")"]},ee.package_id))]})})]}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(be,{onClick:se,children:"Save Changes"})})]})]})})]})})]})})}const tM="https://api.gada.chat";function kwt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState([]),[o,u]=w.useState(0),[h,p]=w.useState(1),[g,v]=w.useState(10),[b,E]=w.useState(""),[T,C]=w.useState("createdAt"),[R,N]=w.useState("desc"),[O,j]=w.useState(!1),k=w.useMemo(()=>Math.max(1,Math.ceil(o/g)),[o,g]),[P,M]=w.useState(null),[D,U]=w.useState(!1);function F(z){M(z),U(!0)}async function H(){j(!0);try{const z=new URLSearchParams({page:String(h),limit:String(g),search:b,sort:T,dir:R}),Z=await fetch(`${tM}/api/admin/users?${z.toString()}`,{headers:t});if(!Z.ok)throw new Error("Failed to load users");const X=await Z.json();console.log(X,"datadatadata"),i(X.items??[]),u(X.total??0)}catch(z){Ce.error(z.message||"Failed to load users")}finally{j(!1)}}w.useEffect(()=>{H()},[h,g,b,T,R,e]);function W(z){return(z==null?void 0:z.user_banned)===1||(z==null?void 0:z.user_banned)==="1"||(z==null?void 0:z.banned)===!0}async function q(z,Z,X){const ae=await fetch(`${tM}/api/admin/users/${z}/suspend`,{method:"POST",headers:X,body:JSON.stringify({banned:Z})});if(!ae.ok){const se=await ae.text().catch(()=>"");throw new Error(se||"Suspend request failed")}return ae.json()}const Y=async z=>{try{const Z=new URLSearchParams({search:b,sort:T,dir:R,format:z}),X=await fetch(`${tM}/api/admin/users/export?${Z.toString()}`,{headers:t});if(!X.ok)throw new Error("Export failed");const ae=await X.blob(),se=URL.createObjectURL(ae),J=document.createElement("a");J.href=se,J.download=z==="csv"?"users.csv":"users.json",document.body.appendChild(J),J.click(),J.remove(),URL.revokeObjectURL(se),Ce.success("Export prepared")}catch(Z){Ce.error(Z.message||"Export failed")}};return c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx(Ae,{placeholder:"Search username or email…",value:b,onChange:z=>{p(1),E(z.target.value)},className:"w-full md:w-80"}),c.jsxs(Pr,{value:T,onValueChange:z=>C(z),children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{placeholder:"Sort by"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"createdAt",children:"Created"}),c.jsx(ht,{value:"email",children:"Email"}),c.jsx(ht,{value:"username",children:"Username"})]})]}),c.jsxs(Pr,{value:R,onValueChange:z=>N(z),children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Dir"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"desc",children:"Desc"}),c.jsx(ht,{value:"asc",children:"Asc"})]})]}),c.jsx(be,{onClick:()=>H(),disabled:O,children:"Search"}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsxs(Pr,{value:String(g),onValueChange:z=>{v(Number(z)),p(1)},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]}),c.jsx(be,{variant:"outline",onClick:()=>Y("csv"),children:"Export CSV"}),c.jsx(be,{variant:"outline",onClick:()=>Y("json"),children:"Export JSON"})]})]}),c.jsx("div",{className:"rounded-md border bg-white",children:c.jsxs(ya,{className:"table-fixed",children:[c.jsx(_a,{className:"sticky top-0 bg-white z-10",children:c.jsxs(tn,{children:[c.jsx(nt,{className:"w-48",children:"User"}),c.jsx(nt,{className:"w-72",children:"Email"}),c.jsx(nt,{className:"w-48",children:"Created"}),c.jsx(nt,{className:"w-32",children:"Role"}),c.jsx(nt,{className:"w-28",children:"Status"}),c.jsx(nt,{className:"w-48",children:"Actions"})]})}),c.jsxs(ba,{children:[n.map(z=>c.jsxs(tn,{children:[c.jsx(Ke,{className:"whitespace-nowrap truncate",children:z.username}),c.jsx(Ke,{className:"whitespace-nowrap truncate",children:z.email}),c.jsx(Ke,{className:"whitespace-nowrap",children:new Date(z.createdAt).toLocaleString()}),c.jsx(Ke,{className:"whitespace-nowrap",children:c.jsx("span",{className:"inline-flex items-center rounded-full border px-2 py-0.5 text-xs capitalize",children:z.role??"user"})}),c.jsx(Ke,{className:"whitespace-nowrap",children:W(z)?c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-red-50 text-red-700 border border-red-200",children:"Suspended"}):c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Active"})}),c.jsx(Ke,{className:"whitespace-nowrap",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>F(z.id),children:"Edit"}),c.jsx(be,{size:"sm",className:W(z)?"bg-slate-600 hover:bg-slate-700":"bg-red-500 hover:bg-red-600",onClick:async()=>{try{const Z=!W(z),X=await q(z.id,Z,t);console.log(X,"respresp"),i(ae=>ae.map(se=>se.id===z.id?{...se,user_banned:X.banned?"1":"0",banned:X.banned}:se)),Ce.success(X.banned?"User suspended":"User unsuspended")}catch(Z){Ce.error((Z==null?void 0:Z.message)||"Failed to update user")}},children:W(z)?"Unsuspend":"Suspend"})]})})]},z.id)),!n.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:6,className:"text-center py-10 text-gray-500",children:"No users found"})})]})]})}),c.jsx(Pwt,{userId:P,open:D,onOpenChange:U,onSaved:()=>{}}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",h," of ",k," — ",o," users"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>p(z=>Math.max(1,z-1)),disabled:h<=1||O,children:"Prev"}),c.jsx(be,{variant:"outline",onClick:()=>p(z=>Math.min(k,z+1)),disabled:h>=k||O,children:"Next"})]})]})]})}const lye="https://api.gada.chat";async function jwt(e){const t=await fetch(`${lye}/api/admin/settings`,{headers:e});if(!t.ok)throw new Error("Failed to load settings");return t.json()}async function Dwt(e,t,n){const i=await fetch(`${lye}/api/admin/settings/${e}`,{method:"PUT",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const o=await i.json().catch(()=>({}));throw new Error(o.error||"Failed to update settings")}}function Lwt(){var g,v,b,E,T,C,R,N,O,j,k,P,M,D,U;const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(null),[o,u]=w.useState("general"),h=w.useMemo(()=>"Authorization"in t,[t]);if(w.useEffect(()=>{h&&jwt(t).then(i).catch(F=>Ce.error("Failed to load settings",{description:F.message}))},[h]),!n)return c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:"Loading settings…"});const p=async(F,H)=>{try{await Dwt(F,H,t),i(W=>W&&{...W,[F]:{...H}}),Ce.success("Saved",{description:`Updated ${F} settings.`})}catch(W){Ce.error("Save failed",{description:W==null?void 0:W.message})}};return c.jsx("div",{className:"bg-white rounded-xl shadow-sm border h-full overflow-hidden flex flex-col",children:c.jsxs(Rm,{value:o,onValueChange:F=>u(F),className:"flex h-full flex-col",children:[c.jsx("div",{className:"sticky top-0 z-10 bg-white/90 backdrop-blur border-b",children:c.jsx("div",{className:"px-3 sm:px-4 md:px-6",children:c.jsx(jf,{className:`
                !bg-transparent p-0 h-auto
                w-full md:w-auto
                flex flex-wrap md:flex-nowrap gap-2 items-end
                overflow-x-auto hide-scrollbar
                border-b-0
              `,children:["general","features","moderation","storage","email","security"].map(F=>c.jsx(Ia,{value:F,className:`
                    rounded-md
                    px-3 md:px-4 py-2
                    text-sm font-medium whitespace-nowrap
                    text-gray-600
                    data-[state=active]:text-gray-900
                    data-[state=active]:bg-white
                    data-[state=active]:border
                  `,children:F[0].toUpperCase()+F.slice(1)},F))})})}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 sm:p-4 md:p-6 pt-6",children:[c.jsxs(fi,{value:"general",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Site Name"}),c.jsx(Ae,{defaultValue:((g=n.general)==null?void 0:g.siteName)||"",id:"siteName"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Site URL"}),c.jsx(Ae,{defaultValue:((v=n.general)==null?void 0:v.siteUrl)||"",id:"siteUrl"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Qi,{defaultChecked:!!((b=n.general)!=null&&b.allowSignups),id:"allowSignups"}),c.jsx(Qe,{htmlFor:"allowSignups",children:"Allow new signups"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var q,Y,z;const F=(q=document.getElementById("siteName"))==null?void 0:q.value,H=(Y=document.getElementById("siteUrl"))==null?void 0:Y.value,W=(z=document.getElementById("allowSignups"))==null?void 0:z.checked;p("general",{siteName:F,siteUrl:H,allowSignups:W})},children:"Save"})})]}),c.jsxs(fi,{value:"features",className:"m-0",children:[c.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:[["stories","Stories"],["reels","Reels"],["groups","Groups"],["payments","Payments"]].map(([F,H])=>{var W;return c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Qi,{id:`f-${F}`,defaultChecked:!!((W=n.features)!=null&&W[F])}),c.jsx(Qe,{htmlFor:`f-${F}`,children:H})]},F)})}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var Y,z,Z,X;const F=(Y=document.getElementById("f-stories"))==null?void 0:Y.checked,H=(z=document.getElementById("f-reels"))==null?void 0:z.checked,W=(Z=document.getElementById("f-groups"))==null?void 0:Z.checked,q=(X=document.getElementById("f-payments"))==null?void 0:X.checked;p("features",{stories:F,reels:H,groups:W,payments:q})},children:"Save"})})]}),c.jsxs(fi,{value:"moderation",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Max Post Length"}),c.jsx(Ae,{type:"number",defaultValue:((E=n.moderation)==null?void 0:E.maxPostLength)??5e3,id:"maxPostLength"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Bad Words (comma separated)"}),c.jsx(Ae,{defaultValue:(((T=n.moderation)==null?void 0:T.badWords)||[]).join(", "),id:"badWords"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var W,q;const F=Number((W=document.getElementById("maxPostLength"))==null?void 0:W.value)||5e3,H=(q=document.getElementById("badWords"))==null?void 0:q.value.split(",").map(Y=>Y.trim()).filter(Boolean);p("moderation",{maxPostLength:F,badWords:H})},children:"Save"})})]}),c.jsxs(fi,{value:"storage",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Max upload (MB)"}),c.jsx(Ae,{type:"number",defaultValue:((C=n.storage)==null?void 0:C.maxUploadMB)??20,id:"maxUploadMB"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Allowed Image MIME (comma separated)"}),c.jsx(Ei,{defaultValue:(((R=n.storage)==null?void 0:R.allowedImageMime)||[]).join(", "),id:"imgMime"})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Qe,{children:"Allowed Video MIME (comma separated)"}),c.jsx(Ei,{defaultValue:(((N=n.storage)==null?void 0:N.allowedVideoMime)||[]).join(", "),id:"vidMime"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var q,Y,z;const F=Number((q=document.getElementById("maxUploadMB"))==null?void 0:q.value)||20,H=(Y=document.getElementById("imgMime"))==null?void 0:Y.value.split(",").map(Z=>Z.trim()).filter(Boolean),W=(z=document.getElementById("vidMime"))==null?void 0:z.value.split(",").map(Z=>Z.trim()).filter(Boolean);p("storage",{maxUploadMB:F,allowedImageMime:H,allowedVideoMime:W})},children:"Save"})})]}),c.jsxs(fi,{value:"email",className:"m-0",children:[c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"From Name"}),c.jsx(Ae,{defaultValue:((O=n.email)==null?void 0:O.fromName)||"",id:"fromName"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"From Email"}),c.jsx(Ae,{defaultValue:((j=n.email)==null?void 0:j.fromEmail)||"",id:"fromEmail"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"SMTP Host"}),c.jsx(Ae,{defaultValue:((k=n.email)==null?void 0:k.smtpHost)||"",id:"smtpHost"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"SMTP Port"}),c.jsx(Ae,{type:"number",defaultValue:((P=n.email)==null?void 0:P.smtpPort)??587,id:"smtpPort"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"SMTP User"}),c.jsx(Ae,{defaultValue:((M=n.email)==null?void 0:M.smtpUser)||"",id:"smtpUser"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"SMTP Password"}),c.jsx(Ae,{type:"password",defaultValue:((D=n.email)==null?void 0:D.smtpPassword)||"",id:"smtpPassword"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"If you see ********, leaving it unchanged will keep the existing secret."})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var Z,X,ae,se,J,re;const F=(Z=document.getElementById("fromName"))==null?void 0:Z.value,H=(X=document.getElementById("fromEmail"))==null?void 0:X.value,W=(ae=document.getElementById("smtpHost"))==null?void 0:ae.value,q=Number((se=document.getElementById("smtpPort"))==null?void 0:se.value)||587,Y=(J=document.getElementById("smtpUser"))==null?void 0:J.value,z=(re=document.getElementById("smtpPassword"))==null?void 0:re.value;p("email",{fromName:F,fromEmail:H,smtpHost:W,smtpPort:q,smtpUser:Y,smtpPassword:z})},children:"Save"})})]}),c.jsxs(fi,{value:"security",className:"m-0",children:[c.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Qe,{children:"CORS Origins (one per line)"}),c.jsx(Ei,{id:"corsOrigins",defaultValue:(((U=n.security)==null?void 0:U.corsOrigins)||[]).join(`
`),rows:5})]})}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:()=>{var H;const F=(H=document.getElementById("corsOrigins"))==null?void 0:H.value.split(`
`).map(W=>W.trim()).filter(Boolean);p("security",{corsOrigins:F})},children:"Save"})})]})]})]})})}const w_="https://api.gada.chat";async function Mwt(e){const t=await fetch(`${w_}api/admin/profile/me`,{headers:e});if(!t.ok)throw new Error("Failed to fetch profile");return t.json()}async function Uwt(e,t){const n=await fetch(`${w_}api/admin/profile`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.error||"Failed to update profile")}}async function Fwt(e,t,n){const i=await fetch(`${w_}api/admin/profile/password`,{method:"PUT",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({oldPassword:e,newPassword:t})});if(!i.ok){const o=await i.json().catch(()=>({}));throw new Error(o.error||"Failed to change password")}}async function Vwt(e,t){const n=new FormData;n.append("avatar",e);const i=await fetch(`${w_}api/admin/profile/avatar`,{method:"PUT",headers:t,body:n});if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.error||"Upload failed")}const{avatarUrl:o}=await i.json();return o}async function Bwt(e){const t=await fetch(`${w_}api/admin/profile/sessions`,{headers:e});if(!t.ok)throw new Error("Failed to load sessions");return t.json()}async function $wt(e,t){if(!(await fetch(`${w_}api/admin/profile/sessions/${e}`,{method:"DELETE",headers:t})).ok)throw new Error("Failed to revoke session")}function Wwt({me:e,onUpdated:t}){const{accessToken:n}=ct(),i=Bl(n);console.log(i,"headersheaders");const[o,u]=w.useState({username:e.username||"",firstname:e.firstname||"",lastname:e.lastname||"",email:e.email||"",bio:e.bio||"",timezone:e.timezone||""}),[h,p]=w.useState(!1),g=b=>E=>u(T=>({...T,[b]:E.target.value})),v=async()=>{p(!0);try{await Uwt(o,i),t({...e,...o}),Ce.success("Profile updated")}catch(b){Ce.error("Update failed",{description:b==null?void 0:b.message})}finally{p(!1)}};return c.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Username"}),c.jsx(Ae,{value:o.username,onChange:g("username")})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Email"}),c.jsx(Ae,{value:o.email,onChange:g("email"),type:"email"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"First name"}),c.jsx(Ae,{value:o.firstname,onChange:g("firstname")})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Last name"}),c.jsx(Ae,{value:o.lastname,onChange:g("lastname")})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Qe,{children:"Bio"}),c.jsx(Ei,{value:o.bio,onChange:g("bio"),rows:3})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx(Qe,{children:"Timezone"}),c.jsx(Ae,{value:o.timezone,onChange:g("timezone"),placeholder:"e.g. Asia/Kolkata"})]}),c.jsx("div",{className:"sm:col-span-2",children:c.jsx(be,{onClick:v,disabled:h,children:h?"Saving…":"Save"})})]})}function Gwt(e){var n;if(!e)return"A";const t=e.split(" ");return(t[0][0]+(((n=t[1])==null?void 0:n[0])||"")).toUpperCase()}function Hwt({me:e,onUpdated:t}){const{accessToken:n}=ct(),i=St(n),o=w.useRef(null),[u,h]=w.useState(null),[p,g]=w.useState(!1),v=()=>{var C;return(C=o.current)==null?void 0:C.click()},b=C=>{var O;const R=(O=C.target.files)==null?void 0:O[0];if(!R)return;const N=URL.createObjectURL(R);h(N)},E=async()=>{var R,N;const C=(N=(R=o.current)==null?void 0:R.files)==null?void 0:N[0];if(!C)return Ce.error("Please choose an image first");g(!0);try{const O=await Vwt(C,i);t({...e,profileImage:O}),Ce.success("Avatar updated"),h(null),o.current&&(o.current.value="")}catch(O){Ce.error("Upload failed",{description:O==null?void 0:O.message})}finally{g(!1)}},T=u||e.profileImage||"";return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx($i,{className:"h-20 w-20",children:T?c.jsx(Ii,{src:T,alt:e.username}):c.jsx(ea,{children:Gwt(e.username)})}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(be,{variant:"outline",onClick:v,children:"Choose image"}),c.jsx(be,{onClick:E,disabled:!u||p,children:p?"Saving…":"Save"}),c.jsx("input",{ref:o,type:"file",accept:"image/*",className:"hidden",onChange:b})]})]}),u&&c.jsx("p",{className:"text-xs text-gray-500",children:"Preview shown. Click “Save” to upload."})]})}function zwt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(""),[o,u]=w.useState(""),[h,p]=w.useState(!1),g=async()=>{if(o.length<8)return Ce.error("New password must be at least 8 characters");p(!0);try{await Fwt(n,o,t),Ce.success("Password changed"),i(""),u("")}catch(v){Ce.error("Failed",{description:v==null?void 0:v.message})}finally{p(!1)}};return c.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Old password"}),c.jsx(Ae,{type:"password",value:n,onChange:v=>i(v.target.value)})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"New password"}),c.jsx(Ae,{type:"password",value:o,onChange:v=>u(v.target.value)})]}),c.jsx("div",{className:"sm:col-span-2",children:c.jsx(be,{onClick:g,disabled:h,children:h?"Saving…":"Change password"})})]})}function Kwt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState([]),[o,u]=w.useState(!0),h=async()=>{u(!0);try{i(await Bwt(t))}catch(g){Ce.error("Failed to load sessions",{description:g==null?void 0:g.message})}finally{u(!1)}};w.useEffect(()=>{h()},[]);const p=async g=>{try{await $wt(g,t),Ce.success("Session revoked"),i(v=>v.filter(b=>b.id!==g))}catch(v){Ce.error("Failed",{description:v==null?void 0:v.message})}};return o?c.jsx("div",{children:"Loading…"}):n.length?c.jsx("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Device"}),c.jsx(nt,{children:"IP"}),c.jsx(nt,{children:"Last Seen"}),c.jsx(nt,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:n.map(g=>c.jsxs(tn,{children:[c.jsx(Ke,{className:"max-w-[320px] truncate",children:g.userAgent}),c.jsx(Ke,{children:g.ip}),c.jsx(Ke,{children:new Date(g.lastSeen||g.createdAt).toLocaleString()}),c.jsx(Ke,{className:"text-right",children:c.jsx(be,{variant:"destructive",size:"sm",onClick:()=>p(g.id),children:"Revoke"})})]},g.id))})]})}):c.jsx("div",{className:"text-gray-500",children:"No other active sessions."})}function qwt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState(null),[u,h]=w.useState("profile");return w.useEffect(()=>{n&&Mwt(t).then(o).catch(p=>Ce.error("Failed to load admin profile",{description:p.message}))},[n]),i?c.jsx("div",{className:"bg-white rounded-xl shadow-sm border h-full overflow-hidden flex flex-col",children:c.jsxs(Rm,{value:u,onValueChange:p=>h(p),className:"flex flex-col h-full",children:[c.jsx("div",{className:"sticky top-0 z-10 bg-white/90 backdrop-blur border-b",children:c.jsx("div",{className:"px-3 sm:px-4 md:px-6",children:c.jsxs(jf,{className:"!bg-transparent p-0 h-auto w-full flex flex-wrap gap-2 overflow-x-auto",children:[c.jsx(Ia,{value:"profile",children:"Profile"}),c.jsx(Ia,{value:"avatar",children:"Avatar"}),c.jsx(Ia,{value:"password",children:"Password"}),c.jsx(Ia,{value:"sessions",children:"Sessions"})]})})}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 sm:p-4 md:p-6",children:[c.jsx(fi,{value:"profile",className:"m-0",children:c.jsx(Wwt,{me:i,onUpdated:o})}),c.jsx(fi,{value:"avatar",className:"m-0",children:c.jsx(Hwt,{me:i,onUpdated:o})}),c.jsx(fi,{value:"password",className:"m-0",children:c.jsx(zwt,{})}),c.jsx(fi,{value:"sessions",className:"m-0",children:c.jsx(Kwt,{})})]})]})}):c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:"Loading…"})}const jm=({className:e,...t})=>c.jsx("nav",{role:"navigation","aria-label":"pagination",className:jt("mx-auto flex w-full justify-center",e),...t});jm.displayName="Pagination";const Dm=w.forwardRef(({className:e,...t},n)=>c.jsx("ul",{ref:n,className:jt("flex flex-row items-center gap-1",e),...t}));Dm.displayName="PaginationContent";const Yn=w.forwardRef(({className:e,...t},n)=>c.jsx("li",{ref:n,className:jt("",e),...t}));Yn.displayName="PaginationItem";const ra=({className:e,isActive:t,size:n="icon",...i})=>c.jsx("a",{"aria-current":t?"page":void 0,className:jt(sle({variant:t?"outline":"ghost",size:n}),e),...i});ra.displayName="PaginationLink";const Lm=({className:e,...t})=>c.jsxs(ra,{"aria-label":"Go to previous page",size:"default",className:jt("gap-1 pl-2.5",e),...t,children:[c.jsx(O4,{className:"h-4 w-4"}),c.jsx("span",{children:"Previous"})]});Lm.displayName="PaginationPrevious";const Mm=({className:e,...t})=>c.jsxs(ra,{"aria-label":"Go to next page",size:"default",className:jt("gap-1 pr-2.5",e),...t,children:[c.jsx("span",{children:"Next"}),c.jsx(Bw,{className:"h-4 w-4"})]});Mm.displayName="PaginationNext";const nM="https://api.gada.chat";function rM({label:e,value:t,gradient:n}){return c.jsxs("div",{className:`rounded-3xl p-6 text-white shadow-sm bg-gradient-to-r ${n} relative overflow-hidden`,children:[c.jsx("div",{className:"text-4xl md:text-5xl font-extrabold tracking-tight",children:typeof t=="number"?t.toLocaleString():t}),c.jsx("div",{className:"mt-2 text-xl opacity-95",children:e}),c.jsx("div",{className:"absolute -right-10 -bottom-10 w-40 h-40 rounded-full bg-white/15 pointer-events-none"})]})}function Ywt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState("all"),[p,g]=w.useState(""),[v,b]=w.useState(1),[E,T]=w.useState(10),[C,R]=w.useState(0),[N,O]=w.useState(1),[j,k]=w.useState(!1),[P,M]=w.useState(!1),[D,U]=w.useState({totalPosts:0,pendingPosts:0,totalComments:0,totalReactions:0}),F=async()=>{try{const Z=await fetch(`${nM}/api/admin/posts/metrics`,{headers:t});if(!Z.ok)throw new Error("Failed to load stats");const X=await Z.json();U({totalPosts:Number(X.totalPosts||0),pendingPosts:Number(X.pendingPosts||0),totalComments:Number(X.totalComments||0),totalReactions:Number(X.totalReactions||0)})}catch(Z){console.warn("[admin posts] metrics load failed:",Z==null?void 0:Z.message)}},H=async()=>{try{const Z=new URLSearchParams({status:u,search:p,page:String(v),limit:String(E)}),X=await fetch(`${nM}/api/admin/posts?${Z.toString()}`,{headers:t});if(!X.ok)throw new Error("Failed to load posts");const ae=await X.json();o(ae.items||[]),R(ae.total||0),O(ae.totalPages||1),k(!!ae.hasPrev),M(!!ae.hasNext)}catch(Z){Ce.error("Load failed",{description:Z==null?void 0:Z.message})}};function W(Z){if(!Z)return"";const X=new Date(Z);return Number.isNaN(X)?String(Z):X.toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}w.useEffect(()=>{n&&F()},[n]),w.useEffect(()=>{n&&H()},[n,u,v,E]);const q=async(Z,X)=>{try{if(!(await fetch(`${nM}/api/admin/posts/${Z}`,{method:"DELETE",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({action:X})})).ok)throw new Error("Action failed");Ce.success("Post has been deleted"),H(),F()}catch(ae){Ce.error("Failed",{description:ae==null?void 0:ae.message})}};function Y(Z,X){const ae=[],se=ee=>ae.push(ee);if(X<=7){for(let ee=1;ee<=X;ee++)se(ee);return ae}se(1),Z>3&&se("…");const J=Math.max(2,Z-1),re=Math.min(X-1,Z+1);for(let ee=J;ee<=re;ee++)se(ee);return Z<X-2&&se("…"),se(X),ae}const z=Y(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[c.jsx(rM,{label:"Posts",value:D.totalPosts,gradient:"from-fuchsia-600 to-purple-500"}),c.jsx(rM,{label:"Comments",value:D.totalComments,gradient:"from-indigo-500 to-violet-500"}),c.jsx(rM,{label:"Reactions",value:D.totalReactions,gradient:"from-sky-500 to-blue-500"})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsx(Ae,{placeholder:"Search content/author",value:p,onChange:Z=>g(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&(b(1),H()),className:"w-full sm:w-64"}),c.jsx(be,{onClick:()=>{b(1),H()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:Z=>{b(1),T(Number(Z))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"ID"}),c.jsx(nt,{children:"Author"}),c.jsx(nt,{children:"Type"}),c.jsx(nt,{children:"Likes"}),c.jsx(nt,{children:"Comments"}),c.jsx(nt,{children:"Link"}),c.jsx(nt,{children:"Datetime"}),c.jsx(nt,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.map(Z=>c.jsxs(tn,{children:[c.jsx(Ke,{children:Z.id}),c.jsx(Ke,{children:Z.authorUsername}),c.jsx(Ke,{children:Z.type}),c.jsx(Ke,{children:Z.likeCount}),c.jsx(Ke,{children:Z.commentCount}),c.jsx(Ke,{children:c.jsx(At,{target:"_blank",to:`/posts/${Z.id}`,children:"View"})}),c.jsx(Ke,{children:W(Z.createdAt)}),c.jsx(Ke,{className:"text-right space-x-2",children:c.jsx(be,{size:"sm",variant:"destructive",onClick:async()=>{window.confirm("Are you sure you want to Delete this?")&&await q(Z.id,"remove")},children:"Remove"})})]},Z.id))})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(jm,{children:c.jsxs(Dm,{children:[c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Yn,{children:c.jsx(Lm,{onClick:()=>b(Z=>Math.max(1,Z-1)),className:j?"":"pointer-events-none opacity-50"})}),z.map((Z,X)=>Z==="…"?c.jsx(Yn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${X}`):c.jsx(Yn,{children:c.jsx(ra,{isActive:Z===v,onClick:()=>b(Z),children:Z})},Z)),c.jsx(Yn,{children:c.jsx(Mm,{onClick:()=>b(Z=>Math.min(N,Z+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]})]})}const eae="https://api.gada.chat";function Xwt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),i=tr(),[o,u]=w.useState([]),[h,p]=w.useState(""),g=async()=>{const b=new URLSearchParams;h.trim()&&b.set("search",h.trim());const E=await fetch(`${eae}/api/admin/page-categories?`+b,{headers:t});if(!E.ok)return Ce.error("Failed to load categories");const T=await E.json();u(T||[])};w.useEffect(()=>{n&&g()},[n]);const v=async(b,E)=>{if(!confirm(`Delete category "${E}"?`))return;const T=await fetch(`${eae}/api/admin/page-categories/${b}`,{method:"DELETE",headers:t});if(!T.ok){const C=await T.json().catch(()=>({}));return Ce.error((C==null?void 0:C.error)||"Delete failed")}Ce.success("Deleted"),g()};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Pages › Categories"}),c.jsx(be,{onClick:()=>i("/admin/page-categories/new"),children:"+ Add New Category"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ae,{placeholder:"Search by name or description",value:h,onChange:b=>p(b.target.value),onKeyDown:b=>b.key==="Enter"&&g(),className:"w-full sm:w-96"}),c.jsx(be,{onClick:g,children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Title"}),c.jsx(nt,{children:"Description"}),c.jsx(nt,{className:"w-24",children:"Order"}),c.jsx(nt,{className:"w-40",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(b=>c.jsxs(tn,{children:[c.jsxs(Ke,{className:"align-top",children:[c.jsx("div",{className:"font-medium",children:b.name}),b.parentId?c.jsxs("div",{className:"text-xs text-gray-500",children:["Child of #",b.parentId]}):c.jsx("div",{className:"text-xs text-gray-500",children:"Parent"})]}),c.jsx(Ke,{className:"align-top",children:b.description||c.jsx("span",{className:"text-gray-400",children:"—"})}),c.jsx(Ke,{className:"align-top",children:c.jsx("span",{className:"inline-flex items-center rounded-full bg-cyan-100 text-cyan-700 px-2 py-0.5 text-xs font-medium",children:b.order})}),c.jsxs(Ke,{className:"align-top space-x-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>i(`/admin/page-categories/${b.id}`),children:"Edit"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>v(b.id,b.name),children:"Delete"})]})]},b.id)),!o.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:4,className:"text-center text-gray-500",children:"No categories found"})})]})]})})]})}const vR="https://api.gada.chat";function tae(){const{id:e}=Qo(),t=!!e,n=tr(),{accessToken:i}=ct(),o=St(i),u=w.useMemo(()=>"Authorization"in o,[o]),[h,p]=w.useState(""),[g,v]=w.useState(""),[b,E]=w.useState(0),[T,C]=w.useState(0),[R,N]=w.useState([]),O=async()=>{const M=await(await fetch(`${vR}/api/admin/page-categories/options`,{headers:o})).json();N(M||[])},j=async()=>{if(!t)return;const P=await fetch(`${vR}/api/admin/page-categories/${e}`,{headers:o});if(!P.ok){Ce.error("Category not found");return}const M=await P.json();p(M.name||""),v(M.description||""),E(Number(M.parentId||0)),C(Number(M.order||0))};w.useEffect(()=>{u&&(O(),j())},[u]);const k=async()=>{if(!h.trim())return Ce.error("Name is required");const P={name:h.trim(),description:g,parentId:b,order:T},M=t?`${vR}/api/admin/page-categories/${e}`:`${vR}/api/admin/page-categories`,U=await fetch(M,{method:t?"PUT":"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(P)});if(!U.ok){const F=await U.json().catch(()=>({}));return Ce.error((F==null?void 0:F.error)||"Save failed")}Ce.success("Saved"),n("/admin/page-categories")};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Pages › Categories › ",t?"Edit Category":"Add New Category"]}),c.jsx(be,{variant:"outline",onClick:()=>n("/admin/page-categories"),children:"Go Back"})]}),c.jsxs("div",{className:"space-y-6 max-w-3xl",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Name"}),c.jsx(Ae,{value:h,onChange:P=>p(P.target.value),placeholder:"Enter name"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(Ei,{rows:4,value:g,onChange:P=>v(P.target.value),placeholder:"Optional description"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Parent Category"}),c.jsxs(Pr,{value:String(b),onValueChange:P=>E(Number(P)),children:[c.jsx(Cr,{className:"w-full sm:w-96",children:c.jsx(kr,{placeholder:"Set as a Parent Category"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"0",children:"Set as a Parent Category"}),R.map(P=>c.jsx(ht,{value:String(P.id),children:P.name},P.id))]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Order"}),c.jsx(Ae,{type:"number",value:T,onChange:P=>C(Number(P.target.value||0)),className:"w-40"})]}),c.jsx("div",{children:c.jsx(be,{onClick:k,children:"Save Changes"})})]})]})}const iM="https://api.gada.chat";function aM({label:e,value:t,gradient:n}){return c.jsxs("div",{className:`rounded-3xl p-6 text-white shadow-sm bg-gradient-to-r ${n} relative overflow-hidden`,children:[c.jsx("div",{className:"text-4xl md:text-5xl font-extrabold tracking-tight",children:typeof t=="number"?t.toLocaleString():t}),c.jsx("div",{className:"mt-2 text-xl opacity-95",children:e}),c.jsx("div",{className:"absolute -right-10 -bottom-10 w-40 h-40 rounded-full bg-white/15 pointer-events-none"})]})}function Jwt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState(""),[p,g]=w.useState("all"),[v,b]=w.useState(1),[E,T]=w.useState(10),[C,R]=w.useState(0),[N,O]=w.useState(1),[j,k]=w.useState(!1),[P,M]=w.useState(!1),[D,U]=w.useState({totalGroups:0,publicGroups:0,closedGroups:0,secretGroups:0,totalMembers:0}),F=async()=>{try{const Z=await fetch(`${iM}/api/admin/groups/metrics`,{headers:t});if(!Z.ok)throw new Error("Failed to load metrics");const X=await Z.json();U({totalGroups:Number(X.totalGroups||0),publicGroups:Number(X.publicGroups||0),closedGroups:Number(X.closedGroups||0),secretGroups:Number(X.secretGroups||0),totalMembers:Number(X.totalMembers||0)})}catch(Z){console.warn("[admin groups] metrics failed:",Z==null?void 0:Z.message)}},H=async()=>{try{const Z=new URLSearchParams({search:u,privacy:p,page:String(v),limit:String(E)}),X=await fetch(`${iM}/api/admin/groups?${Z.toString()}`,{headers:t});if(!X.ok)throw new Error("Failed to load groups");const ae=await X.json();o(ae.items||[]),R(Number(ae.total||0)),O(Number(ae.totalPages||1)),k(!!ae.hasPrev),M(!!ae.hasNext)}catch(Z){Ce.error("Load failed",{description:Z==null?void 0:Z.message})}};w.useEffect(()=>{n&&F()},[n]),w.useEffect(()=>{n&&H()},[n,p,v,E]);const W=async Z=>{if(window.confirm("Delete this group permanently? This cannot be undone."))try{if(!(await fetch(`${iM}/api/admin/groups/${Z}`,{method:"DELETE",headers:t})).ok)throw new Error("Delete failed");Ce.success("Group deleted"),H(),F()}catch(X){Ce.error("Failed",{description:X==null?void 0:X.message})}},q=Z=>{if(!Z)return"";const X=new Date(Z);return Number.isNaN(X)?String(Z):X.toLocaleString()};function Y(Z,X){const ae=[],se=ee=>ae.push(ee);if(X<=7){for(let ee=1;ee<=X;ee++)se(ee);return ae}se(1),Z>3&&se("…");const J=Math.max(2,Z-1),re=Math.min(X-1,Z+1);for(let ee=J;ee<=re;ee++)se(ee);return Z<X-2&&se("…"),se(X),ae}const z=Y(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[c.jsx(aM,{label:"Groups",value:D.totalGroups,gradient:"from-fuchsia-600 to-purple-500"}),c.jsx(aM,{label:"Public Groups",value:D.publicGroups,gradient:"from-indigo-500 to-violet-500"}),c.jsx(aM,{label:"Total Members",value:D.totalMembers,gradient:"from-sky-500 to-blue-500"})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsxs(Pr,{value:p,onValueChange:Z=>{b(1),g(Z)},children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{placeholder:"Privacy"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"all",children:"All privacy"}),c.jsx(ht,{value:"public",children:"Public"}),c.jsx(ht,{value:"closed",children:"Closed"}),c.jsx(ht,{value:"secret",children:"Secret"})]})]}),c.jsx(Ae,{placeholder:"Search by title / web address",value:u,onChange:Z=>h(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&(b(1),H()),className:"w-full sm:w-72"}),c.jsx(be,{onClick:()=>{b(1),H()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:Z=>{b(1),T(Number(Z))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{className:"w-16",children:"ID"}),c.jsx(nt,{children:"Group"}),c.jsx(nt,{children:"Admin"}),c.jsx(nt,{children:"Privacy"}),c.jsx(nt,{children:"Members"}),c.jsx(nt,{children:"Link"}),c.jsx(nt,{children:"Created"}),c.jsx(nt,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.map(Z=>c.jsxs(tn,{children:[c.jsx(Ke,{children:Z.id}),c.jsx(Ke,{className:"max-w-[360px] truncate",children:Z.title}),c.jsx(Ke,{children:Z.adminUsername||"-"}),c.jsx(Ke,{className:"capitalize",children:Z.privacy||"public"}),c.jsx(Ke,{children:(Z.membersCount??0).toLocaleString()}),c.jsx(Ke,{children:Z.slug?c.jsx(At,{target:"_blank",to:`/groups/${Z.slug}`,children:"View"}):c.jsx(At,{target:"_blank",to:`/groups/${Z.id}`,children:"View"})}),c.jsx(Ke,{children:q(Z.createdAt)}),c.jsx(Ke,{className:"text-right space-x-2",children:c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>W(Z.id),children:"Delete"})})]},Z.id))})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(jm,{children:c.jsxs(Dm,{children:[c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Yn,{children:c.jsx(Lm,{onClick:()=>b(Z=>Math.max(1,Z-1)),className:j?"":"pointer-events-none opacity-50"})}),z.map((Z,X)=>Z==="…"?c.jsx(Yn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${X}`):c.jsx(Yn,{children:c.jsx(ra,{isActive:Z===v,onClick:()=>b(Z),children:Z})},Z)),c.jsx(Yn,{children:c.jsx(Mm,{onClick:()=>b(Z=>Math.min(N,Z+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]})]})}const nae="https://api.gada.chat";function Zwt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),i=tr(),[o,u]=w.useState([]),[h,p]=w.useState(""),g=async()=>{const b=new URLSearchParams;h.trim()&&b.set("search",h.trim());const E=await fetch(`${nae}/api/admin/group-categories?`+b,{headers:t});if(!E.ok)return Ce.error("Failed to load categories");const T=await E.json();u(T||[])};w.useEffect(()=>{n&&g()},[n]);const v=async(b,E)=>{if(!confirm(`Delete category "${E}"?`))return;const T=await fetch(`${nae}/api/admin/group-categories/${b}`,{method:"DELETE",headers:t});if(!T.ok){const C=await T.json().catch(()=>({}));return Ce.error((C==null?void 0:C.error)||"Delete failed")}Ce.success("Deleted"),g()};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Groups › Categories"}),c.jsx(be,{onClick:()=>i("/admin/group-categories/new"),children:"+ Add New Category"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ae,{placeholder:"Search by name or description",value:h,onChange:b=>p(b.target.value),onKeyDown:b=>b.key==="Enter"&&g(),className:"w-full sm:w-96"}),c.jsx(be,{onClick:g,children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Title"}),c.jsx(nt,{children:"Description"}),c.jsx(nt,{className:"w-24",children:"Order"}),c.jsx(nt,{className:"w-40",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(b=>c.jsxs(tn,{children:[c.jsxs(Ke,{className:"align-top",children:[c.jsx("div",{className:"font-medium",children:b.name}),b.parentId?c.jsxs("div",{className:"text-xs text-gray-500",children:["Child of #",b.parentId]}):c.jsx("div",{className:"text-xs text-gray-500",children:"Parent"})]}),c.jsx(Ke,{className:"align-top",children:b.description||c.jsx("span",{className:"text-gray-400",children:"—"})}),c.jsx(Ke,{className:"align-top",children:c.jsx("span",{className:"inline-flex items-center rounded-full bg-cyan-100 text-cyan-700 px-2 py-0.5 text-xs font-medium",children:b.order})}),c.jsxs(Ke,{className:"align-top space-x-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>i(`/admin/group-categories/${b.id}`),children:"Edit"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>v(b.id,b.name),children:"Delete"})]})]},b.id)),!o.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:4,className:"text-center text-gray-500",children:"No categories found"})})]})]})})]})}const yR="https://api.gada.chat";function rae(){const{id:e}=Qo(),t=!!e,n=tr(),{accessToken:i}=ct(),o=St(i),u=w.useMemo(()=>"Authorization"in o,[o]),[h,p]=w.useState(""),[g,v]=w.useState(""),[b,E]=w.useState(0),[T,C]=w.useState(0),[R,N]=w.useState([]),O=async()=>{const M=await(await fetch(`${yR}/api/admin/group-categories/options`,{headers:o})).json();N(M||[])},j=async()=>{if(!t)return;const P=await fetch(`${yR}/api/admin/group-categories/${e}`,{headers:o});if(!P.ok){Ce.error("Category not found");return}const M=await P.json();p(M.name||""),v(M.description||""),E(Number(M.parentId||0)),C(Number(M.order||0))};w.useEffect(()=>{u&&(O(),j())},[u]);const k=async()=>{if(!h.trim())return Ce.error("Name is required");const P={name:h.trim(),description:g,parentId:b,order:T},M=t?`${yR}/api/admin/group-categories/${e}`:`${yR}/api/admin/group-categories`,U=await fetch(M,{method:t?"PUT":"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(P)});if(!U.ok){const F=await U.json().catch(()=>({}));return Ce.error((F==null?void 0:F.error)||"Save failed")}Ce.success("Saved"),n("/admin/group-categories")};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Groups › Categories › ",t?"Edit Category":"Add New Category"]}),c.jsx(be,{variant:"outline",onClick:()=>n("/admin/group-categories"),children:"Go Back"})]}),c.jsxs("div",{className:"space-y-6 max-w-3xl",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Name"}),c.jsx(Ae,{value:h,onChange:P=>p(P.target.value),placeholder:"Enter name"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(Ei,{rows:4,value:g,onChange:P=>v(P.target.value),placeholder:"Optional description"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Parent Category"}),c.jsxs(Pr,{value:String(b),onValueChange:P=>E(Number(P)),children:[c.jsx(Cr,{className:"w-full sm:w-96",children:c.jsx(kr,{placeholder:"Set as a Parent Category"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"0",children:"Set as a Parent Category"}),R.map(P=>c.jsx(ht,{value:String(P.id),children:P.name},P.id))]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Order"}),c.jsx(Ae,{type:"number",value:T,onChange:P=>C(Number(P.target.value||0)),className:"w-40"})]}),c.jsx("div",{children:c.jsx(be,{onClick:k,children:"Save Changes"})})]})]})}const sM="https://api.gada.chat";function Qwt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),i=tr(),[o,u]=w.useState([]),[h,p]=w.useState(""),[g,v]=w.useState(1),[b,E]=w.useState(1),T=async(R=1)=>{const N=new URLSearchParams({page:String(R),limit:"20"});h.trim()&&N.set("search",h.trim());const O=await fetch(`${sM}/api/admin/events?${N}`,{headers:t});if(!O.ok)return Ce.error("Failed to load events");const j=await O.json();u(j.items||[]),v(j.page||1),E(j.totalPages||1)};w.useEffect(()=>{n&&T(1)},[n]);const C=async(R,N)=>{if(!confirm(`Delete event "${N}"?`))return;if(!(await fetch(`${sM}/api/admin/events/${R}`,{method:"DELETE",headers:t})).ok)return Ce.error("Delete failed");Ce.success("Deleted"),T(g)};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Events"}),c.jsx(be,{onClick:()=>i("/admin/events/new"),children:"+ Add Event"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ae,{placeholder:"Search by title or admin",value:h,onChange:R=>p(R.target.value),onKeyDown:R=>R.key==="Enter"&&T(1),className:"w-full sm:w-96"}),c.jsx(be,{onClick:()=>T(1),children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{className:"w-12",children:"ID"}),c.jsx(nt,{children:"Event"}),c.jsx(nt,{children:"Admin"}),c.jsx(nt,{children:"Privacy"}),c.jsx(nt,{className:"text-right",children:"Interested"}),c.jsx(nt,{className:"text-right",children:"Going"}),c.jsx(nt,{className:"text-right",children:"Invited"}),c.jsx(nt,{className:"w-40 text-right",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(R=>c.jsxs(tn,{children:[c.jsx(Ke,{children:R.id}),c.jsxs(Ke,{children:[c.jsx("div",{className:"font-medium",children:R.title}),c.jsxs("div",{className:"text-xs text-gray-500",children:[R.startsAt?Ad(new Date(R.startsAt),"PPp"):"",R.endsAt?` — ${Ad(new Date(R.endsAt),"PPp")}`:"",R.location?` · ${R.location}`:""]})]}),c.jsx(Ke,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[R.adminAvatar?c.jsx("img",{src:`${sM}/uploads/${R.adminAvatar}`,alt:"",className:"h-6 w-6 rounded-full object-cover bg-gray-100"}):c.jsx("div",{className:"h-6 w-6 rounded-full bg-gray-200"}),c.jsx("span",{className:"text-sm",children:R.adminName})]})}),c.jsx(Ke,{className:"capitalize",children:R.privacy}),c.jsx(Ke,{className:"text-right",children:R.interestedCount}),c.jsx(Ke,{className:"text-right",children:R.goingCount}),c.jsx(Ke,{className:"text-right",children:R.invitedCount}),c.jsxs(Ke,{className:"text-right space-x-2",children:[c.jsx(At,{to:`/admin/events/${R.id}`,children:c.jsx(be,{size:"sm",variant:"outline",children:"Edit"})}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>C(R.id,R.title),children:"Delete"})]})]},R.id)),!o.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:8,className:"text-center text-gray-500",children:"No events found"})})]})]})}),c.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[c.jsx(be,{variant:"outline",disabled:g<=1,onClick:()=>T(g-1),children:"Prev"}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",g," / ",b]}),c.jsx(be,{variant:"outline",disabled:g>=b,onClick:()=>T(g+1),children:"Next"})]})]})}const _R="https://api.gada.chat";function iae(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const n=i=>String(i).padStart(2,"0");return`${t.getFullYear()}-${n(t.getMonth()+1)}-${n(t.getDate())}T${n(t.getHours())}:${n(t.getMinutes())}`}function aae(){const{id:e}=Qo(),t=!!e,n=tr(),{accessToken:i,user:o}=ct(),u=St(i),h=w.useMemo(()=>"Authorization"in u,[u]),[p,g]=w.useState(""),[v,b]=w.useState(""),[E,T]=w.useState("public"),[C,R]=w.useState(""),[N,O]=w.useState(""),[j,k]=w.useState(""),[P,M]=w.useState(null),[D,U]=w.useState(""),[F,H]=w.useState([]),[W,q]=w.useState(!1),Y=ae=>{if(console.log(ae.parentId,"c.parentId"),!ae.parentId)return ae.name;const se=F.find(J=>J.id===ae.parentId);return se?`${se.name} / ${ae.name}`:ae.name},z=async()=>{q(!0);try{const ae=await fetch(`${_R}/api/admin/events/categories`,{headers:u});if(!ae.ok)throw new Error("Failed");const se=await ae.json();H(Array.isArray(se)?se:[])}catch{Ce.error("Failed to load categories")}finally{q(!1)}},Z=async()=>{if(!t)return;const ae=await fetch(`${_R}/api/admin/events/${e}`,{headers:u});if(!ae.ok)return Ce.error("Not found");const se=await ae.json();g(se.title||""),b(se.description||""),T(se.privacy||"public"),R(iae(se.startsAt)),O(iae(se.endsAt)),k(se.location||""),M(se.category_id||null),U(se.cover||"")};w.useEffect(()=>{h&&(async()=>(await z(),await Z()))()},[h]);const X=async()=>{if(!p.trim())return Ce.error("Title is required");if(!C)return Ce.error("Start date/time is required");const ae={adminId:o==null?void 0:o.userId,title:p.trim(),description:v,privacy:E,startsAt:new Date(C).toISOString(),endsAt:N?new Date(N).toISOString():null,location:j,categoryId:P,cover:D},se=t?`${_R}/api/admin/events/${e}`:`${_R}/api/admin/events`,re=await fetch(se,{method:t?"PUT":"POST",headers:{...u,"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!re.ok){const ee=await re.json().catch(()=>({}));return Ce.error((ee==null?void 0:ee.error)||"Save failed")}Ce.success("Saved"),n("/admin/events")};return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Events › ",t?"Edit":"Add New"]}),c.jsx(be,{variant:"outline",onClick:()=>n("/admin/events"),children:"Go Back"})]}),c.jsxs("div",{className:"space-y-6 max-w-3xl",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Title"}),c.jsx(Ae,{value:p,onChange:ae=>g(ae.target.value),placeholder:"Event title"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(Ei,{rows:4,value:v,onChange:ae=>b(ae.target.value),placeholder:"Optional description"})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Privacy"}),c.jsxs(Pr,{value:E,onValueChange:T,children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:"public/private"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"public",children:"Public"}),c.jsx(ht,{value:"private",children:"Private"})]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Category (optional)"}),F?c.jsxs(Pr,{value:String(P??""),onValueChange:ae=>M(ae?Number(ae):null),disabled:W,children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:W?"Loading…":"Select a category"})}),c.jsx(Rr,{children:F.map(ae=>c.jsx(ht,{value:String(ae.id),children:Y(ae)},ae.id))})]}):""]})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Starts At"}),c.jsx(Ae,{type:"datetime-local",value:C,onChange:ae=>R(ae.target.value)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Ends At (optional)"}),c.jsx(Ae,{type:"datetime-local",value:N,onChange:ae=>O(ae.target.value)})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Location (optional)"}),c.jsx(Ae,{value:j,onChange:ae=>k(ae.target.value),placeholder:"City / Venue"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Cover (path/url – optional)"}),c.jsx(Ae,{value:D,onChange:ae=>U(ae.target.value),placeholder:"uploads/2025/08/cover.jpg"})]}),c.jsx("div",{children:c.jsx(be,{onClick:X,children:"Save Changes"})})]})]})}const bR="https://api.gada.chat";function sae(){const{id:e}=Qo(),t=!!e,n=tr(),{accessToken:i}=ct(),o=St(i),u=w.useMemo(()=>"Authorization"in o,[o]),[h,p]=w.useState(""),[g,v]=w.useState(""),[b,E]=w.useState("0"),[T,C]=w.useState(1),[R,N]=w.useState([]),O=async()=>{const P=await fetch(`${bR}/api/admin/events-categories/select`,{headers:o});P.ok&&N(await P.json())},j=async()=>{if(!t)return;const P=await fetch(`${bR}/api/admin/events-categories/${e}`,{headers:o});if(!P.ok)return Ce.error("Not found");const M=await P.json();p(M.name||""),v(M.description??""),E(String(M.parentId??0)),C(M.order??1)};w.useEffect(()=>{u&&(O(),j())},[u]);const k=async()=>{if(!h.trim())return Ce.error("Name is required");const P={name:h.trim(),description:g??"",parentId:Number(b||0),order:Number.isFinite(T)&&T>=1?T:1},M=t?`${bR}/api/admin/events-categories/${e}`:`${bR}/api/admin/events-categories`,U=await fetch(M,{method:t?"PUT":"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(P)});if(!U.ok){const F=await U.json().catch(()=>({}));return Ce.error((F==null?void 0:F.error)||"Save failed")}Ce.success("Saved"),n("/admin/events/categories")};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Events › Categories › ",t?"Edit":"Add New"]}),c.jsx(be,{asChild:!0,variant:"outline",children:c.jsx(At,{to:"/admin/events/categories",children:"Go Back"})})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 max-w-3xl space-y-5",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Name"}),c.jsx(Ae,{value:h,onChange:P=>p(P.target.value),placeholder:"e.g. Conferences"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Description"}),c.jsx(Ei,{rows:3,value:g,onChange:P=>v(P.target.value),placeholder:"Optional (may be empty)"})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Parent Category"}),c.jsxs(Pr,{value:b,onValueChange:E,children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:"Set as a Parent Category"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"0",children:"— (Top Level)"}),R.filter(P=>String(P.id)!==String(e)).map(P=>c.jsx(ht,{value:String(P.id),children:P.name},P.id))]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-1 font-medium",children:"Order"}),c.jsx(Ae,{type:"number",min:1,value:String(T),onChange:P=>C(Number(P.target.value||1))})]})]}),c.jsx("div",{children:c.jsx(be,{onClick:k,children:"Save Changes"})})]})]})}const oae="https://api.gada.chat";function eSt(){var O,j;const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=Xy(),[u,h]=w.useState(i.get("q")||""),[p,g]=w.useState(Number(i.get("page")||1)),[v,b]=w.useState(null),[E,T]=w.useState(!1),C=async()=>{T(!0);try{const k=await fetch(`${oae}/api/admin/events-categories?search=${encodeURIComponent(u)}&page=${p}&limit=25`,{headers:t});if(!k.ok)throw new Error;b(await k.json())}catch{Ce.error("Failed to load categories")}finally{T(!1)}};w.useEffect(()=>{n&&C()},[n,p]);const R=k=>{k.preventDefault(),g(1),o(P=>(P.set("q",u),P.set("page","1"),P)),C()},N=async k=>{if(confirm("Delete this category? This cannot be undone."))try{const P=await fetch(`${oae}/api/admin/events-categories/${k}`,{method:"DELETE",headers:t});if(!P.ok){const M=await P.json().catch(()=>({}));return Ce.error((M==null?void 0:M.error)||"Delete failed")}Ce.success("Deleted"),C()}catch{Ce.error("Delete failed")}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-lg font-semibold",children:"Events › Categories"}),c.jsx(be,{asChild:!0,children:c.jsx(At,{to:"/admin/events-categories/new",children:"+ Add New Category"})})]}),c.jsxs("form",{onSubmit:R,className:"flex gap-2",children:[c.jsx(Ae,{value:u,onChange:k=>h(k.target.value),placeholder:"Search by name or description"}),c.jsx(be,{type:"submit",variant:"secondary",children:"Search"})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-left border-b",children:[c.jsx("th",{className:"p-3",children:"Title"}),c.jsx("th",{className:"p-3",children:"Parent"}),c.jsx("th",{className:"p-3",children:"Order"}),c.jsx("th",{className:"p-3",children:"Used"}),c.jsx("th",{className:"p-3",children:"Children"}),c.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),c.jsxs("tbody",{children:[E&&c.jsx("tr",{children:c.jsx("td",{className:"p-4",colSpan:6,children:"Loading…"})}),!E&&((O=v==null?void 0:v.items)==null?void 0:O.length)===0&&c.jsx("tr",{children:c.jsx("td",{className:"p-4",colSpan:6,children:"No categories"})}),!E&&((j=v==null?void 0:v.items)==null?void 0:j.map(k=>c.jsxs("tr",{className:"border-b",children:[c.jsxs("td",{className:"p-3",children:[c.jsx("div",{className:"font-medium",children:k.name}),k.description&&c.jsx("div",{className:"text-xs text-gray-500 line-clamp-2",children:k.description})]}),c.jsx("td",{className:"p-3",children:k.parentId===0?"—":k.parentName||"—"}),c.jsx("td",{className:"p-3",children:k.order}),c.jsx("td",{className:"p-3",children:k.usedCount}),c.jsx("td",{className:"p-3",children:k.childCount}),c.jsx("td",{className:"p-3 text-right",children:c.jsxs("div",{className:"inline-flex gap-2",children:[c.jsx(be,{asChild:!0,size:"sm",variant:"outline",children:c.jsx(At,{to:`/admin/events-categories/${k.id}`,children:"Edit"})}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>N(k.id),children:"Delete"})]})})]},k.id)))]})]})}),v&&v.totalPages>1&&c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:p<=1,onClick:()=>g(k=>k-1),children:"Prev"}),c.jsxs("div",{className:"text-sm",children:["Page ",p," / ",v.totalPages]}),c.jsx(be,{variant:"outline",size:"sm",disabled:p>=v.totalPages,onClick:()=>g(k=>k+1),children:"Next"})]})]})}const oM="https://api.gada.chat";function tSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState(0),[p,g]=w.useState(1),[v,b]=w.useState(1),[E,T]=w.useState(10),[C,R]=w.useState(!1),[N,O]=w.useState(!1),[j,k]=w.useState("0"),[P,M]=w.useState("all"),[D,U]=w.useState(""),[F,H]=w.useState(""),[W,q]=w.useState(""),Y=J=>`₦${(J||0).toLocaleString()}`,z=async()=>{try{const J=new URLSearchParams({page:String(v),pageSize:String(E),status:j,method:P});D&&J.set("q",D),F&&J.set("startDate",F),W&&J.set("endDate",W);const re=await fetch(`${oM}/api/wallet/withdrawals/admin?${J.toString()}`,{headers:t});if(!re.ok)throw new Error(await re.text());const ee=await re.json();o(ee.items||[]),h(ee.total||0),g(ee.totalPages||1),R(!!ee.hasPrev),O(!!ee.hasNext)}catch(J){Ce.error("Failed to load withdrawal requests",{description:J==null?void 0:J.message})}};w.useEffect(()=>{n&&z()},[n,v,E,j,P]);const Z=async J=>{try{const re=await fetch(`${oM}/api/wallet/withdrawals/${J}/approve`,{method:"POST",headers:t});if(!re.ok)throw new Error(await re.text());Ce.success("Request approved"),z()}catch(re){Ce.error("Approve failed",{description:re==null?void 0:re.message})}},X=async J=>{try{const re=await fetch(`${oM}/api/wallet/withdrawals/${J}/decline`,{method:"POST",headers:t});if(!re.ok)throw new Error(await re.text());Ce.success("Request declined"),z()}catch(re){Ce.error("Decline failed",{description:re==null?void 0:re.message})}},ae=()=>{k("0"),M("all"),U(""),H(""),q(""),b(1),z()};function se(J,re){const ee=[],de=Te=>ee.push(Te);if(re<=7){for(let Te=1;Te<=re;Te++)de(Te);return ee}de(1),J>3&&de("…");const xe=Math.max(2,J-1),ve=Math.min(re-1,J+1);for(let Te=xe;Te<=ve;Te++)de(Te);return J<re-2&&de("…"),de(re),ee}return se(v,p),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 lg:items-end justify-between mb-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 w-full",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Status"}),c.jsxs(Pr,{value:j,onValueChange:J=>{k(J),b(1)},children:[c.jsx(Cr,{className:"w-full",children:c.jsx(kr,{placeholder:"Status"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"0",children:"Pending"}),c.jsx(ht,{value:"1",children:"Approved"}),c.jsx(ht,{value:"-1",children:"Declined"}),c.jsx(ht,{value:"all",children:"All"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Method"}),c.jsxs(Pr,{value:P,onValueChange:J=>{M(J),b(1)},children:[c.jsx(Cr,{className:"w-full",children:c.jsx(kr,{placeholder:"Method"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"all",children:"All"}),c.jsx(ht,{value:"bank",children:"Bank"}),c.jsx(ht,{value:"gada_token",children:"gada token"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),c.jsx(Ae,{type:"date",value:F,onChange:J=>{H(J.target.value),b(1)}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"End Date"}),c.jsx(Ae,{type:"date",value:W,onChange:J=>{q(J.target.value),b(1)}})]}),c.jsxs("div",{className:"sm:col-span-2",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Search"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Ae,{placeholder:"User / handle / transfer to",value:D,onChange:J=>U(J.target.value),onKeyDown:J=>J.key==="Enter"&&(b(1),z())}),c.jsx(be,{onClick:()=>(b(1),z()),children:"Search"}),c.jsx(be,{variant:"secondary",onClick:ae,children:"Clear"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(Pr,{value:String(E),onValueChange:J=>{T(Number(J)),b(1)},children:[c.jsx(Cr,{className:"w-32",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]}),c.jsxs("div",{className:"text-sm text-gray-500 min-w-[140px] text-right",children:[u.toLocaleString()," total"]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"ID"}),c.jsx(nt,{children:"User"}),c.jsx(nt,{children:"Handle"}),c.jsx(nt,{children:"Method"}),c.jsx(nt,{children:"Amount"}),c.jsx(nt,{children:"Transfer To"}),c.jsx(nt,{children:"Time"}),c.jsx(nt,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.length?i.map(J=>c.jsxs(tn,{children:[c.jsx(Ke,{children:J.id}),c.jsx(Ke,{children:J.user_name}),c.jsx(Ke,{children:J.handle}),c.jsx(Ke,{className:"capitalize",children:J.method}),c.jsx(Ke,{children:Y(Number(J.amount))}),c.jsx(Ke,{className:"truncate max-w-[260px]",title:J.transferTo,children:J.transferTo}),c.jsx(Ke,{children:new Date(J.time).toLocaleString()}),c.jsxs(Ke,{className:"text-right space-x-2",children:[c.jsx(be,{size:"sm",onClick:()=>Z(J.id),children:"Approve"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>X(J.id),children:"Reject"})]})]},J.id)):c.jsx(tn,{children:c.jsx(Ke,{colSpan:8,className:"text-center text-gray-500",children:"No requests found"})})})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",u]}),c.jsx(jm,{children:c.jsxs(Dm,{children:[c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Yn,{children:c.jsx(Lm,{onClick:()=>b(J=>Math.max(1,J-1)),className:C?"":"pointer-events-none opacity-50"})}),se(v,p).map((J,re)=>J==="…"?c.jsx(Yn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${re}`):c.jsx(Yn,{children:c.jsx(ra,{isActive:J===v,onClick:()=>b(J),children:J})},J)),c.jsx(Yn,{children:c.jsx(Mm,{onClick:()=>b(J=>Math.min(p,J+1)),className:N?"":"pointer-events-none opacity-50"})}),c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(p),"aria-disabled":v===p,className:v===p?"pointer-events-none opacity-50":"",children:"Last"})})]})})]})]})}const pS="https://api.gada.chat";async function nSt(e){const t=await fetch(`${pS}/api/admin/payment-settings`,{headers:e});if(!t.ok)throw new Error(await t.text());return(await t.json()).data}async function rSt(e,t){const n=await fetch(`${pS}/api/admin/payment-settings/fees`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function iSt(e,t){const n=await fetch(`${pS}/api/admin/payment-settings/vat`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function aSt(e,t){const n=await fetch(`${pS}/api/admin/payment-settings/bank`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function sSt(e,t){const n=await fetch(`${pS}/api/admin/payment-settings/paystack`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}function oSt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(!0),[o,u]=w.useState({}),[h,p]=w.useState(!1),[g,v]=w.useState(0),[b,E]=w.useState(!1),[T,C]=w.useState(!1),[R,N]=w.useState(0),[O,j]=w.useState(!1),[k,P]=w.useState(""),[M,D]=w.useState(""),[U,F]=w.useState(""),[H,W]=w.useState(""),[q,Y]=w.useState(""),[z,Z]=w.useState(!1),[X,ae]=w.useState("");w.useEffect(()=>{(async()=>{try{const de=await nSt(t);u(de),p(!!de.payment_fees_enabled),v(Number(de.payment_fees_percentage||0)),E(!!de.payment_vat_enabled),C(!!de.payment_country_vat_enabled),N(Number(de.payment_vat_percentage||0)),j(!!de.bank_transfers_enabled),P(de.bank_name||""),D(de.bank_account_number||""),F(de.bank_account_name||""),W(de.bank_account_country||""),Y(de.bank_transfer_note||""),Z(!!de.paystack_enabled),ae(de.paystack_secret||"")}catch(de){console.error(de),Ce.error("Failed to load payment settings")}finally{i(!1)}})()},[]);const se=async()=>{try{await rSt(t,{payment_fees_enabled:h,payment_fees_percentage:Number(g||0)}),Ce.success("Fees settings saved")}catch(de){Ce.error("Failed to save fees",{description:de==null?void 0:de.message})}},J=async()=>{try{await iSt(t,{payment_vat_enabled:b,payment_country_vat_enabled:T,payment_vat_percentage:Number(R||0)}),Ce.success("VAT settings saved")}catch(de){Ce.error("Failed to save VAT",{description:de==null?void 0:de.message})}},re=async()=>{try{await aSt(t,{bank_transfers_enabled:O,bank_name:k,bank_account_number:M,bank_account_name:U,bank_account_country:H,bank_transfer_note:q}),Ce.success("Bank transfer settings saved")}catch(de){Ce.error("Failed to save bank transfer settings",{description:de==null?void 0:de.message})}},ee=async()=>{try{await sSt(t,{paystack_enabled:z,paystack_secret:X}),Ce.success("Online payment settings saved")}catch(de){Ce.error("Failed to save online payment settings",{description:de==null?void 0:de.message})}};return n?c.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6 flex justify-center",children:c.jsxs("svg",{className:"animate-spin h-6 w-6 text-gray-500",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}):c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Settings › Payments"}),c.jsxs(Rm,{defaultValue:"settings",className:"w-full",children:[c.jsxs(jf,{className:"grid grid-cols-3 max-w-[560px]",children:[c.jsx(Ia,{value:"settings",children:"Settings"}),c.jsx(Ia,{value:"online",children:"Online Payments"}),c.jsx(Ia,{value:"bank",children:"Bank Transfers"})]}),c.jsxs(fi,{value:"settings",className:"mt-6 space-y-8",children:[c.jsxs("section",{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"Payment Fees"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable/Disable Payment Fees"})]}),c.jsx(Qi,{checked:h,onCheckedChange:p})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Fees Percentage (%)"}),c.jsx(Ae,{type:"number",min:0,max:100,step:"0.1",value:g,onChange:de=>v(Number(de.target.value)),placeholder:"5"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Percentage of fees to be added to the payment amount"})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:se,children:"Save Fees"})})]}),c.jsx("hr",{className:"my-6"}),c.jsxs("section",{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"VAT Enabled"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable/Disable VAT"})]}),c.jsx(Qi,{checked:b,onCheckedChange:E})]}),c.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"VAT By User Country"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable/Disable VAT by user country (Manage Countries VAT)"})]}),c.jsx(Qi,{checked:T,onCheckedChange:C})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Default VAT Percentage (%)"}),c.jsx(Ae,{type:"number",min:0,max:100,step:"0.1",value:R,onChange:de=>N(Number(de.target.value)),placeholder:"1"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used when country VAT is not set or user has no country."})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:J,children:"Save VAT"})})]})]}),c.jsx(fi,{value:"online",className:"mt-6 space-y-6",children:c.jsxs("section",{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"Paystack Enabled"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable payments via Paystack"})]}),c.jsx(Qi,{checked:z,onCheckedChange:Z})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Secret Key"}),c.jsx(Ae,{type:"text",value:X,onChange:de=>ae(de.target.value),placeholder:"sk_live_xxx"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Paystack secret key that starts with ",c.jsx("code",{children:"sk_"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx(be,{onClick:ee,children:"Save Online Payments"})})]})}),c.jsx(fi,{value:"bank",className:"mt-6 space-y-6",children:c.jsxs("section",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:"Bank Transfers Enabled"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enable payments via Bank Transfers"})]}),c.jsx(Qi,{checked:O,onCheckedChange:j})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Name"}),c.jsx(Ae,{value:k,onChange:de=>P(de.target.value),placeholder:"Your Bank Name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Account Number"}),c.jsx(Ae,{value:M,onChange:de=>D(de.target.value),placeholder:"Your Bank Account Number"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Account Name"}),c.jsx(Ae,{value:U,onChange:de=>F(de.target.value),placeholder:"Your Bank Account Name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bank Account Country"}),c.jsx(Ae,{value:H,onChange:de=>W(de.target.value),placeholder:"Your Bank Account Country"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Transfer Note"}),c.jsx(Ei,{rows:5,value:q,onChange:de=>Y(de.target.value),placeholder:"In order to confirm the bank transfer, you will need to upload a receipt..."})]}),c.jsx("div",{className:"pt-2",children:c.jsx(be,{onClick:re,children:"Save Bank Transfers"})})]})})]})]})}const pO="https://api.gada.chat";async function cSt(e){const t=await fetch(`${pO}/api/admin/wallet-settings`,{headers:e});if(!t.ok)throw new Error(await t.text());return t.json()}async function lSt(e,t){const n=await fetch(`${pO}/api/admin/wallet-settings`,{method:"PUT",headers:{"Content-Type":"application/json",...e},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}async function uSt(e){const t=await fetch(`${pO}/api/admin/settings/points/fetch`,{headers:{"Content-Type":"application/json",...e}});if(!t.ok)throw new Error(await t.text());return await t.json()}async function dSt(e,t){const n=await fetch(`${pO}/api/admin/settings/points/update`,{method:"PUT",headers:{...e,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(await n.text());return n.json()}function hSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState(!0),[u,h]=w.useState(!1),[p,g]=w.useState({wallet_min_withdrawal:null,wallet_max_transfer:null,wallet_withdrawal_enabled:!0}),[v,b]=w.useState(null);w.useEffect(()=>{n&&(o(!0),cSt(t).then(R=>{g(R),b(R)}).catch(R=>Ce.error("Failed to load wallet settings",{description:String(R)})).finally(()=>o(!1)))},[n]);const E=w.useMemo(()=>JSON.stringify(p)!==JSON.stringify(v),[p,v]),T=async()=>{h(!0);try{await lSt(t,p),Ce.success("Wallet settings saved"),b(p)}catch(R){Ce.error("Save failed",{description:R==null?void 0:R.message})}finally{h(!1)}},C=()=>{v&&g(v)};return c.jsx("div",{className:"max-w-5xl mx-auto",children:c.jsxs(Vr,{children:[c.jsxs(pa,{children:[c.jsx(Wa,{children:"Wallet Settings"}),c.jsx(Qy,{children:"Configure withdrawal and transfer limits."})]}),c.jsx(mi,{className:"space-y-6",children:i?c.jsx("div",{className:"py-8 text-center text-sm text-gray-500",children:"Loading…"}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Qe,{htmlFor:"enabled",className:"text-base",children:"Enable Withdrawals"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Turn wallet withdrawals on/off for all users."})]}),c.jsx(Qi,{id:"enabled",checked:p.wallet_withdrawal_enabled,onCheckedChange:R=>g(N=>({...N,wallet_withdrawal_enabled:!!R}))})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{htmlFor:"min",className:"text-base",children:"Minimum Withdrawal (₦)"}),c.jsx(Ae,{id:"min",type:"number",min:0,placeholder:"e.g., 1000",value:p.wallet_min_withdrawal??"",onChange:R=>g(N=>({...N,wallet_min_withdrawal:R.target.value===""?null:Math.max(0,Number(R.target.value))})),className:"mt-2 h-11"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to use the app default."})]}),c.jsxs("div",{children:[c.jsx(Qe,{htmlFor:"max",className:"text-base",children:"Max Transfer (₦)"}),c.jsx(Ae,{id:"max",type:"number",min:0,placeholder:"e.g., 500000",value:p.wallet_max_transfer??"",onChange:R=>g(N=>({...N,wallet_max_transfer:R.target.value===""?null:Math.max(0,Number(R.target.value))})),className:"mt-2 h-11"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to disable the limit."})]})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[c.jsx(be,{onClick:T,disabled:!E||u,className:"h-11",children:u?"Saving…":"Save changes"}),c.jsx(be,{type:"button",variant:"secondary",onClick:C,disabled:!E,className:"h-11",children:"Reset"})]})]})})]})})}const uye="https://api.gada.chat";async function fSt(e,t={}){const n=new URLSearchParams;t.year&&n.set("year",String(t.year)),t.month&&n.set("month",String(t.month));const i=await fetch(`${uye}/api/admin/earnings/packages/summary?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function pSt(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>{u!=null&&u!==""&&n.set(o,String(u))});const i=await fetch(`${uye}/api/admin/earnings/packages/table?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}const mSt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ER=e=>`₦${(e||0).toLocaleString()}`;function gSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState(new Date().getFullYear()),[u,h]=w.useState({totalAll:0,totalThisMonth:0,chart:[],seriesNames:[]}),[p,g]=w.useState([]),[v,b]=w.useState(1),[E,T]=w.useState(10),[C,R]=w.useState(0),[N,O]=w.useState(1),[j,k]=w.useState(""),[P,M]=w.useState(""),[D,U]=w.useState(""),[F,H]=w.useState("earnings"),[W,q]=w.useState("desc"),Y=async()=>{try{const X=await fSt(t,{year:i}),ae=X.series.map(J=>J.package_name),se=mSt.map((J,re)=>{const ee={month:J};for(const de of X.series)ee[de.package_name]=de.data[re]||0;return ee});h({totalAll:X.totalAll,totalThisMonth:X.totalThisMonth,chart:se,seriesNames:ae})}catch(X){Ce.error("Failed to load summary",{description:X==null?void 0:X.message})}},z=async()=>{try{const X=await pSt(t,{search:j,page:v,pageSize:E,startDate:P,endDate:D,sort:F,order:W});g(X.items),R(X.total),O(X.totalPages)}catch(X){Ce.error("Failed to load table",{description:X==null?void 0:X.message})}};w.useEffect(()=>{n&&Y()},[n,i]),w.useEffect(()=>{n&&z()},[n,v,E,F,W,P,D]);const Z=w.useMemo(()=>{const X=[];if(N<=7){for(let J=1;J<=N;J++)X.push(J);return X}X.push(1),v>3&&X.push("…");const ae=Math.max(2,v-1),se=Math.min(N-1,v+1);for(let J=ae;J<=se;J++)X.push(J);return v<N-2&&X.push("…"),X.push(N),X},[v,N]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Vr,{children:[c.jsxs(pa,{className:"flex flex-row items-center justify-between",children:[c.jsx(Wa,{children:"Packages"}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Pr,{value:String(i),onValueChange:X=>o(Number(X)),children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Year"})}),c.jsx(Rr,{children:[0,1,2,3].map(X=>{const ae=new Date().getFullYear()-X;return c.jsx(ht,{value:String(ae),children:ae},ae)})})]})})]}),c.jsx(mi,{className:"h-[300px]",children:c.jsx(p3,{width:"100%",height:"100%",children:c.jsxs(J3,{data:u.chart,children:[c.jsx(hO,{strokeDasharray:"3 3"}),c.jsx(b_,{dataKey:"month"}),c.jsx(E_,{}),c.jsx(Nc,{formatter:X=>ER(X)}),c.jsx(kd,{}),u.seriesNames.map(X=>c.jsx(Bo,{dataKey:X,stackId:void 0},X))]})})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs(Vr,{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 text-white",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"Total Earnings"})}),c.jsx(mi,{className:"text-3xl font-semibold",children:ER(u.totalAll)})]}),c.jsxs(Vr,{className:"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white",children:[c.jsx(pa,{children:c.jsx(Wa,{children:"This Month Earnings"})}),c.jsx(mi,{className:"text-3xl font-semibold",children:ER(u.totalThisMonth)})]})]}),c.jsxs(Vr,{children:[c.jsxs(pa,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[c.jsx(Wa,{children:"Packages"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Show"}),c.jsxs(Pr,{value:String(E),onValueChange:X=>{b(1),T(Number(X))},children:[c.jsx(Cr,{className:"w-20",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10"}),c.jsx(ht,{value:"25",children:"25"}),c.jsx(ht,{value:"50",children:"50"})]})]}),c.jsx("span",{className:"text-sm text-gray-500",children:"entries"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ae,{placeholder:"Search package…",value:j,onChange:X=>k(X.target.value),className:"h-10 w-56"}),c.jsx(be,{onClick:()=>{b(1),z()},children:"Search"})]})]})]}),c.jsxs(mi,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Start Date"}),c.jsx(Ae,{type:"date",value:P,onChange:X=>{b(1),M(X.target.value)},max:Ad(new Date,"yyyy-MM-dd")})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"End Date"}),c.jsx(Ae,{type:"date",value:D,onChange:X=>{b(1),U(X.target.value)},max:Ad(new Date,"yyyy-MM-dd")})]}),c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsxs(Pr,{value:`${F}:${W}`,onValueChange:X=>{const[ae,se]=X.split(":");H(ae),q(se)},children:[c.jsx(Cr,{className:"w-full",children:c.jsx(kr,{placeholder:"Sort"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"earnings:desc",children:"Earnings ↓"}),c.jsx(ht,{value:"earnings:asc",children:"Earnings ↑"}),c.jsx(ht,{value:"sales:desc",children:"Sales ↓"}),c.jsx(ht,{value:"sales:asc",children:"Sales ↑"}),c.jsx(ht,{value:"name:asc",children:"Name A–Z"}),c.jsx(ht,{value:"name:desc",children:"Name Z–A"})]})]}),c.jsx(be,{variant:"secondary",onClick:()=>{k(""),M(""),U(""),H("earnings"),q("desc"),b(1)},children:"Clear"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Package"}),c.jsx(nt,{children:"Total Sales"}),c.jsx(nt,{children:"Total Earnings"})]})}),c.jsx(ba,{children:p.length?p.map(X=>c.jsxs(tn,{children:[c.jsx(Ke,{children:X.package}),c.jsx(Ke,{children:X.total_sales.toLocaleString()}),c.jsx(Ke,{children:ER(X.total_earnings)})]},X.package_id)):c.jsx(tn,{children:c.jsx(Ke,{colSpan:3,className:"text-center text-gray-500",children:"No data"})})})]})}),c.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[c.jsxs("div",{children:["Showing ",p.length?(v-1)*E+1:0," to ",(v-1)*E+p.length," of ",C]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:v===1,onClick:()=>b(1),children:"First"}),c.jsx(be,{variant:"outline",size:"sm",disabled:v===1,onClick:()=>b(X=>Math.max(1,X-1)),children:"Prev"}),Z.map((X,ae)=>X==="…"?c.jsx("span",{className:"px-2",children:"…"},`e${ae}`):c.jsx(be,{variant:X===v?"default":"outline",size:"sm",onClick:()=>b(X),children:X},X)),c.jsx(be,{variant:"outline",size:"sm",disabled:v>=N,onClick:()=>b(X=>Math.min(N,X+1)),children:"Next"}),c.jsx(be,{variant:"outline",size:"sm",disabled:v>=N,onClick:()=>b(N),children:"Last"})]})]})]})]})]})}const mS="https://api.gada.chat";async function vSt(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>u!=null&&u!==""&&n.set(o,String(u)));const i=await fetch(`${mS}/api/admin/packages?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function ySt(e,t){const n=await fetch(`${mS}/api/admin/packages/${t}`,{headers:e});if(!n.ok)throw new Error(await n.text());return n.json()}async function _St(e,t){const n=await fetch(`${mS}/api/admin/packages`,{method:"POST",headers:e,body:t});if(!n.ok)throw new Error(await n.text());return n.json()}async function bSt(e,t,n){const i=await fetch(`${mS}/api/admin/packages/${t}`,{method:"PUT",headers:e,body:n});if(!i.ok)throw new Error(await i.text());return i.json()}async function ESt(e,t){const n=await fetch(`${mS}/api/admin/packages/${t}`,{method:"DELETE",headers:e});if(!n.ok)throw new Error(await n.text());return n.json()}const wSt="";function SSt(){const e=tr(),{accessToken:t}=ct(),n=St(t),i=w.useMemo(()=>"Authorization"in n,[n]),[o,u]=w.useState([]),[h,p]=w.useState(1),[g,v]=w.useState(10),[b,E]=w.useState(0),[T,C]=w.useState(1),[R,N]=w.useState(""),[O,j]=w.useState("package_order"),[k,P]=w.useState("asc"),[M,D]=w.useState(!0),U=async()=>{D(!0);try{const W=await vSt(n,{page:h,pageSize:g,search:R,sort:O,order:k});u(W.items),E(W.total),C(W.totalPages)}catch(W){Ce.error("Failed to load packages",{description:W==null?void 0:W.message})}finally{D(!1)}};w.useEffect(()=>{i&&U()},[i,h,g,O,k]);const F=async W=>{if(confirm("Delete this package? This cannot be undone."))try{await ESt(n,W),Ce.success("Package deleted"),o.length===1&&h>1?p(q=>q-1):U()}catch(q){Ce.error("Delete failed",{description:q==null?void 0:q.message})}},H=(W,q)=>`${W} ${q[0].toUpperCase()+q.slice(1)}`;return w.useMemo(()=>{const W=[];if(T<=7){for(let z=1;z<=T;z++)W.push(z);return W}W.push(1),h>3&&W.push("…");const q=Math.max(2,h-1),Y=Math.min(T-1,h+1);for(let z=q;z<=Y;z++)W.push(z);return h<T-2&&W.push("…"),W.push(T),W},[h,T]),c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:[c.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4",children:[c.jsx("h1",{className:"text-[28px] leading-8 font-extrabold text-slate-900",children:"Pro System › Packages"}),c.jsxs("div",{className:"flex w-full md:w-auto items-center gap-2",children:[c.jsx(Ae,{placeholder:"Search…",value:R,onChange:W=>N(W.target.value),className:"h-11 md:w-[420px]"}),c.jsx(be,{className:"h-11",onClick:()=>{p(1),U()},children:"Search"}),c.jsxs(be,{className:"h-11 gap-2",onClick:()=>e("/admin/packages/new"),children:[c.jsx(M4,{className:"h-5 w-5"}),"Add New Package"]})]})]}),c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-sm text-slate-500",children:"Show"}),c.jsxs(Pr,{value:String(g),onValueChange:W=>{p(1),v(Number(W))},children:[c.jsx(Cr,{className:"w-24 h-10",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10"}),c.jsx(ht,{value:"25",children:"25"}),c.jsx(ht,{value:"50",children:"50"})]})]}),c.jsx("span",{className:"text-sm text-slate-500",children:"entries"})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Pr,{value:`${O}:${k}`,onValueChange:W=>{const[q,Y]=W.split(":");j(q),P(Y)},children:[c.jsx(Cr,{className:"w-44 h-10",children:c.jsx(kr,{placeholder:"Order"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"package_order:asc",children:"Order ↑"}),c.jsx(ht,{value:"package_order:desc",children:"Order ↓"}),c.jsx(ht,{value:"name:asc",children:"Name A–Z"}),c.jsx(ht,{value:"name:desc",children:"Name Z–A"}),c.jsx(ht,{value:"price:asc",children:"Price ↑"}),c.jsx(ht,{value:"price:desc",children:"Price ↓"}),c.jsx(ht,{value:"period_num:asc",children:"Period (num) ↑"}),c.jsx(ht,{value:"period_num:desc",children:"Period (num) ↓"})]})]})})]}),c.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{className:"bg-slate-50",children:[c.jsx(nt,{className:"w-16",children:"ID"}),c.jsx(nt,{className:"min-w-[280px]",children:"Name"}),c.jsx(nt,{className:"min-w-[150px]",children:"Price (₦)"}),c.jsx(nt,{className:"min-w-[140px]",children:"Period"}),c.jsx(nt,{className:"min-w-[100px]",children:"Order"}),c.jsx(nt,{className:"text-right min-w-[160px]",children:"Actions"})]})}),c.jsx(ba,{children:M?c.jsx(tn,{children:c.jsx(Ke,{colSpan:6,className:"py-12 text-center text-slate-500",children:"Loading…"})}):o.length?o.map((W,q)=>c.jsxs(tn,{className:q%2?"bg-white":"bg-slate-50/40",children:[c.jsx(Ke,{className:"font-medium",children:W.package_id}),c.jsx(Ke,{children:c.jsxs("div",{className:"flex items-center gap-3",children:[W.icon?c.jsx("img",{src:`${wSt}/${W.icon}`,alt:"",className:"h-8 w-8 rounded-lg object-cover ring-1 ring-slate-200"}):c.jsx("div",{className:"h-8 w-8 rounded-lg bg-slate-100 ring-1 ring-slate-200"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-semibold text-slate-900",children:W.name}),c.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full ring-1 ring-slate-300",style:{backgroundColor:W.color},title:W.color})]})]})}),c.jsx(Ke,{className:"font-semibold",children:W.price}),c.jsx(Ke,{children:H(W.period_num,W.period)}),c.jsx(Ke,{children:W.package_order}),c.jsx(Ke,{className:"text-right",children:c.jsxs("div",{className:"inline-flex gap-2",children:[c.jsx(be,{size:"sm",variant:"outline",className:"rounded-full",onClick:()=>e(`/admin/packages/${W.package_id}/edit`),title:"Edit",children:c.jsx(tle,{className:"h-4 w-4"})}),c.jsx(be,{size:"sm",variant:"destructive",className:"rounded-full",onClick:()=>F(W.package_id),title:"Delete",children:c.jsx(Ww,{className:"h-4 w-4"})})]})})]},W.package_id)):c.jsx(tn,{children:c.jsx(Ke,{colSpan:6,className:"py-12 text-center text-slate-500",children:"No packages"})})})]})})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",o.length?(h-1)*g+1:0," to ",(h-1)*g+o.length," of ",b]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{variant:"secondary",size:"sm",disabled:h===1,onClick:()=>p(1),className:"rounded-xl",children:"First"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:h===1,onClick:()=>p(W=>Math.max(1,W-1)),className:"rounded-xl",children:"Prev"}),w.useMemo(()=>{const W=[];if(T<=7)for(let q=1;q<=T;q++)W.push(q);else{W.push(1),h>3&&W.push("…");const q=Math.max(2,h-1),Y=Math.min(T-1,h+1);for(let z=q;z<=Y;z++)W.push(z);h<T-2&&W.push("…"),W.push(T)}return W},[h,T]).map((W,q)=>W==="…"?c.jsx("span",{className:"px-2 text-slate-500",children:"…"},`e${q}`):c.jsx(be,{size:"sm",variant:W===h?"default":"secondary",onClick:()=>p(W),className:"rounded-xl ",children:W},W)),c.jsx(be,{variant:"secondary",size:"sm",disabled:h>=T,onClick:()=>p(W=>Math.min(T,W+1)),className:"rounded-xl",children:"Next"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:h>=T,onClick:()=>p(T),className:"rounded-xl",children:"Last"})]})]})]})})}function cae(){const{id:e}=Qo(),t=!!e,n=tr(),{accessToken:i}=ct(),o=Bl(i),u=w.useMemo(()=>"Authorization"in o,[o]),[h,p]=w.useState(t),[g,v]=w.useState(!1),[b,E]=w.useState({package_id:0,name:"",price:"",period_num:30,period:"day",color:"#000000",icon:"",package_permissions_group_id:0,allowed_blogs_categories:0,allowed_videos_categories:0,allowed_products:0,verification_badge_enabled:"0",boost_posts_enabled:"0",boost_posts:0,boost_pages_enabled:"0",boost_pages:0,custom_description:"",package_order:0,paypal_billing_plan:"",stripe_billing_plan:""}),[T,C]=w.useState(null),[R,N]=w.useState(!0),O=w.useRef(null);w.useEffect(()=>{!t||!u||(async()=>{try{const k=await ySt(o,Number(e));E({...k,verification_badge_enabled:k.verification_badge_enabled==="1"||k.verification_badge_enabled===!0,boost_posts_enabled:k.boost_posts_enabled==="1"||k.boost_posts_enabled===!0,boost_pages_enabled:k.boost_pages_enabled==="1"||k.boost_pages_enabled===!0})}catch(k){Ce.error("Failed to load package",{description:k==null?void 0:k.message})}finally{p(!1)}})()},[t,e,u]);const j=async k=>{k.preventDefault(),v(!0);try{const P=new FormData;if(Object.entries(b).forEach(([M,D])=>{M!=="package_id"&&M!=="icon"&&P.append(M,String(D??""))}),P.set("verification_badge_enabled",b.verification_badge_enabled?"true":"false"),P.set("boost_posts_enabled",b.boost_posts_enabled?"true":"false"),P.set("boost_pages_enabled",b.boost_pages_enabled?"true":"false"),t&&P.set("keep_icon",R?"true":"false"),T&&(!t||!R)&&P.append("icon",T),t)await bSt(o,Number(e),P),Ce.success("Package updated");else{const M=await _St(o,P);Ce.success("Package created"),n(`/admin/packages/${M.id}/edit`,{replace:!0});return}n("/admin/packages")}catch(P){Ce.error("Save failed",{description:P==null?void 0:P.message})}finally{v(!1)}};return c.jsx("form",{onSubmit:j,className:"max-w-5xl",children:c.jsxs(Vr,{children:[c.jsxs(pa,{children:[c.jsx(Wa,{children:t?"Edit Package":"Add New Package"}),c.jsx(Qy,{children:"Configure a subscription package for the Pro System."})]}),c.jsx(mi,{className:"space-y-6",children:h?c.jsx("div",{className:"text-sm text-gray-500 py-12 text-center",children:"Loading…"}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Name"}),c.jsx(Ae,{value:b.name,onChange:k=>E({...b,name:k.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Price (NGN)"}),c.jsx(Ae,{type:"number",min:0,value:b.price,onChange:k=>E({...b,price:k.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Paid Every"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Ae,{type:"number",min:1,value:b.period_num,onChange:k=>E({...b,period_num:Number(k.target.value||1)}),className:"w-28"}),c.jsxs(Pr,{value:b.period,onValueChange:k=>E({...b,period:k}),children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"day",children:"Day"}),c.jsx(ht,{value:"month",children:"Month"}),c.jsx(ht,{value:"year",children:"Year"})]})]})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Color"}),c.jsx(Ae,{type:"color",value:b.color,onChange:k=>E({...b,color:k.target.value})})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx(Qe,{children:"Icon"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ae,{type:"file",ref:O,accept:"image/*",onChange:k=>{var P;return C(((P=k.target.files)==null?void 0:P[0])||null)}}),t&&b.icon&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("img",{src:`/${b.icon}`,className:"h-12 w-12 rounded object-cover border"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Qi,{checked:R,onCheckedChange:N,id:"keepicon"}),c.jsx(Qe,{htmlFor:"keepicon",children:"Keep current"})]})]})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Perfect size: 60×60 – 180×180px"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Permissions Group ID"}),c.jsx(Ae,{type:"number",min:0,value:b.package_permissions_group_id,onChange:k=>E({...b,package_permissions_group_id:Number(k.target.value||0)})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maps to your permissions groups table."})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Blogs Categories Allowed"}),c.jsx(Ae,{type:"number",min:0,value:b.allowed_blogs_categories,onChange:k=>E({...b,allowed_blogs_categories:Number(k.target.value||0)})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Videos Categories Allowed"}),c.jsx(Ae,{type:"number",min:0,value:b.allowed_videos_categories,onChange:k=>E({...b,allowed_videos_categories:Number(k.target.value||0)})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Market Products Allowed"}),c.jsx(Ae,{type:"number",min:0,value:b.allowed_products,onChange:k=>E({...b,allowed_products:Number(k.target.value||0)})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Verification Badge Enabled"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Enable verification badge with this package"})]}),c.jsx(Qi,{checked:!!b.verification_badge_enabled,onCheckedChange:k=>E({...b,verification_badge_enabled:k})})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Boost Posts Enabled"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Enable “boost posts” feature"})]}),c.jsx(Qi,{checked:!!b.boost_posts_enabled,onCheckedChange:k=>E({...b,boost_posts_enabled:k})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Posts Boosts (max)"}),c.jsx(Ae,{type:"number",min:0,value:b.boost_posts,onChange:k=>E({...b,boost_posts:Number(k.target.value||0)})})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Boost Pages Enabled"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Enable “boost pages” feature"})]}),c.jsx(Qi,{checked:!!b.boost_pages_enabled,onCheckedChange:k=>E({...b,boost_pages_enabled:k})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Pages Boosts (max)"}),c.jsx(Ae,{type:"number",min:0,value:b.boost_pages,onChange:k=>E({...b,boost_pages:Number(k.target.value||0)})})]})]})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Custom Description"}),c.jsx(Ei,{rows:4,value:b.custom_description??"",onChange:k=>E({...b,custom_description:k.target.value})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Order"}),c.jsx(Ae,{type:"number",min:0,value:b.package_order,onChange:k=>E({...b,package_order:Number(k.target.value||0)})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"PayPal Billing Plan (optional)"}),c.jsx(Ae,{value:b.paypal_billing_plan??"",onChange:k=>E({...b,paypal_billing_plan:k.target.value})})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Stripe Billing Plan (optional)"}),c.jsx(Ae,{value:b.stripe_billing_plan??"",onChange:k=>E({...b,stripe_billing_plan:k.target.value})})]})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[c.jsx(be,{type:"submit",disabled:g,children:g?"Saving…":"Save Changes"}),c.jsx(be,{type:"button",variant:"secondary",onClick:()=>n("/admin/packages"),children:"Cancel"})]})]})})]})})}const dye="https://api.gada.chat";async function xSt(e,t={}){const n=new URLSearchParams;Object.entries(t).forEach(([o,u])=>u!=null&&u!==""&&n.set(o,String(u)));const i=await fetch(`${dye}/api/admin/subscribers?${n}`,{headers:e});if(!i.ok)throw new Error(await i.text());return i.json()}async function TSt(e,t={}){const n=new URLSearchParams;Object.entries({...t,export:"csv"}).forEach(([h,p])=>p!=null&&p!==""&&n.set(h,String(p)));const i=`${dye}/api/admin/subscribers?${n}`,o=await fetch(i,{headers:e});if(!o.ok)throw new Error(await o.text());return{blob:await o.blob(),filename:`subscribers_${Date.now()}.csv`}}function lae(e){const t=e.replace(" ","T"),n=new Date(t);return isNaN(n.getTime())?e:n.toLocaleString()}function CSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState(1),[p,g]=w.useState(10),[v,b]=w.useState(0),[E,T]=w.useState(1),[C,R]=w.useState(""),[N,O]=w.useState("all"),[j,k]=w.useState(""),[P,M]=w.useState("newest"),[D,U]=w.useState(!1),F=async()=>{U(!0);try{const q=await xSt(t,{page:u,pageSize:p,search:C,status:N,packageName:j,order:P});o(q.items),b(q.total),T(q.totalPages)}catch(q){Ce.error("Failed to load subscribers",{description:q==null?void 0:q.message})}finally{U(!1)}};w.useEffect(()=>{n&&F()},[n,u,p,N,j,P]);const H=async()=>{try{const{blob:q,filename:Y}=await TSt(t,{page:u,pageSize:p,search:C,status:N,packageName:j,order:P}),z=URL.createObjectURL(q),Z=document.createElement("a");Z.href=z,Z.download=Y,Z.click(),URL.revokeObjectURL(z)}catch(q){Ce.error("Export failed",{description:q==null?void 0:q.message})}},W=w.useMemo(()=>{const q=[];if(E<=7){for(let Z=1;Z<=E;Z++)q.push(Z);return q}q.push(1),u>3&&q.push("…");const Y=Math.max(2,u-1),z=Math.min(E-1,u+1);for(let Z=Y;Z<=z;Z++)q.push(Z);return u<E-2&&q.push("…"),q.push(E),q},[u,E]);return c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:[c.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[c.jsxs("div",{className:"flex-1 flex flex-wrap gap-2",children:[c.jsx(Ae,{placeholder:"Search by user / handle",value:C,onChange:q=>R(q.target.value),className:"h-11 w-full sm:w-[340px]"}),c.jsx(be,{className:"h-11",onClick:()=>{h(1),F()},children:"Search"}),c.jsxs(Pr,{value:String(p),onValueChange:q=>{h(1),g(Number(q))},children:[c.jsx(Cr,{className:"h-11 w-[120px]",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"25",children:"25 / page"}),c.jsx(ht,{value:"50",children:"50 / page"})]})]}),c.jsxs(Pr,{value:N,onValueChange:q=>{h(1),O(q)},children:[c.jsx(Cr,{className:"h-11 w-[140px]",children:c.jsx(kr,{placeholder:"Status"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"all",children:"All"}),c.jsx(ht,{value:"active",children:"Active"}),c.jsx(ht,{value:"expired",children:"Expired"})]})]}),c.jsxs(Pr,{value:j,onValueChange:q=>{h(1),k(q)},children:[c.jsx(Cr,{className:"h-11 w-[160px]",children:c.jsx(kr,{placeholder:"Package"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"All",children:"All Packages"}),c.jsx(ht,{value:"GADA VIP",children:"GADA VIP"}),c.jsx(ht,{value:"GADA VVIP",children:"GADA VVIP"})]})]}),c.jsxs(Pr,{value:P,onValueChange:q=>{h(1),M(q)},children:[c.jsx(Cr,{className:"h-11 w-[140px]",children:c.jsx(kr,{placeholder:"Order"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"newest",children:"Newest"}),c.jsx(ht,{value:"oldest",children:"Oldest"})]})]})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(be,{variant:"outline",className:"h-11 gap-2",onClick:H,children:[c.jsx(KVe,{className:"h-4 w-4"})," Export CSV"]})})]}),c.jsx("div",{className:"mt-4 overflow-hidden rounded-2xl border border-slate-200",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{className:"bg-slate-50",children:[c.jsx(nt,{className:"w-20",children:"ID"}),c.jsx(nt,{className:"min-w-[220px]",children:"User"}),c.jsx(nt,{className:"min-w-[160px]",children:"Handle"}),c.jsx(nt,{className:"min-w-[160px]",children:"Package"}),c.jsx(nt,{className:"min-w-[180px]",children:"Subscription"}),c.jsx(nt,{className:"min-w-[260px]",children:"Expiration"}),c.jsx(nt,{className:"min-w-[120px]",children:"Status"})]})}),c.jsx(ba,{children:D?c.jsx(tn,{children:c.jsx(Ke,{colSpan:7,className:"py-12 text-center text-slate-500",children:"Loading…"})}):i.length?i.map((q,Y)=>{const z=Number(q.remainingDays),Z=q.status==="Active",X=Z?`(Remaining ${z} ${Math.abs(z)===1?"Day":"Days"})`:"(Expired)";return c.jsxs(tn,{className:Y%2?"bg-white":"bg-slate-50/40",children:[c.jsx(Ke,{children:q.userId}),c.jsx(Ke,{className:"font-medium text-slate-900",children:q.user??"—"}),c.jsx(Ke,{className:"text-slate-600",children:q.handle??"—"}),c.jsx(Ke,{className:"font-medium",children:q.packageName}),c.jsx(Ke,{children:lae(q.subscription)}),c.jsx(Ke,{children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{children:lae(q.expiration)}),c.jsx("span",{className:`text-xs ${Z?"text-emerald-600":"text-rose-600"}`,children:X})]})}),c.jsx(Ke,{children:c.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ring-1
                            ${Z?"bg-emerald-50 text-emerald-700 ring-emerald-200":"bg-rose-50 text-rose-700 ring-rose-200"}`,children:q.status})})]},`${q.userId}-${q.time}`)}):c.jsx(tn,{children:c.jsx(Ke,{colSpan:7,className:"py-12 text-center text-slate-500",children:"No records"})})})]})})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",i.length?(u-1)*p+1:0," to ",(u-1)*p+i.length," of ",v]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(be,{variant:"secondary",size:"sm",disabled:u===1,onClick:()=>h(1),className:"rounded-xl",children:"First"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:u===1,onClick:()=>h(q=>Math.max(1,q-1)),className:"rounded-xl",children:"Prev"}),W.map((q,Y)=>q==="…"?c.jsx("span",{className:"px-2 text-slate-500",children:"…"},`e${Y}`):c.jsx(be,{size:"sm",variant:q===u?"default":"secondary",onClick:()=>h(q),className:"rounded-xl",children:q},q)),c.jsx(be,{variant:"secondary",size:"sm",disabled:u>=E,onClick:()=>h(q=>Math.min(E,q+1)),className:"rounded-xl",children:"Next"}),c.jsx(be,{variant:"secondary",size:"sm",disabled:u>=E,onClick:()=>h(E),className:"rounded-xl",children:"Last"})]})]})]})})}const gl=e=>e===""||e===null||e===void 0?0:Number(e);function RSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState(null),[u,h]=w.useState(!1),p=async()=>{try{const v=await uSt(t);o(v)}catch(v){Ce.error("Failed to load points settings",{description:v==null?void 0:v.message})}};w.useEffect(()=>{n&&p()},[n]);const g=async()=>{if(i){h(!0);try{await dSt(t,i),Ce.success("Points settings saved"),await p()}catch(v){Ce.error("Save failed",{description:v==null?void 0:v.message})}finally{h(!1)}}};return i?c.jsx("div",{className:"space-y-6",children:c.jsxs("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:[c.jsx("h1",{className:"text-[28px] leading-8 font-extrabold text-slate-900 mb-6",children:"Settings › Points System"}),c.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[c.jsxs(Vr,{className:"border-slate-200",children:[c.jsx(pa,{children:c.jsx(Wa,{className:"text-slate-800",children:"Enable & Transfers"})}),c.jsxs(mi,{className:"space-y-5",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Qe,{className:"font-medium",children:"Points System Enabled"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Allow users to earn, hold, and use points."})]}),c.jsx(Qi,{checked:i.points_enabled,onCheckedChange:v=>o({...i,points_enabled:v})})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Qe,{className:"font-medium",children:"Points Transfer Enabled"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Allow users to transfer points (P2P)."})]}),c.jsx(Qi,{checked:i.points_money_transfer_enabled,onCheckedChange:v=>o({...i,points_money_transfer_enabled:v})})]}),c.jsxs("div",{children:[c.jsx(Qe,{className:"font-medium",children:"Minimum Withdrawal (points)"}),c.jsx(Ae,{type:"number",min:0,value:i.points_min_withdrawal,onChange:v=>o({...i,points_min_withdrawal:gl(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Minimum point balance required to request withdrawal."})]})]})]}),c.jsxs(Vr,{className:"border-slate-200",children:[c.jsx(pa,{children:c.jsx(Wa,{className:"text-slate-800",children:"Daily/Monthly Limits"})}),c.jsxs(mi,{className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx(Qe,{className:"font-medium",children:"Limit (Pro users)"}),c.jsx(Ae,{type:"number",min:0,value:i.points_limit_pro,onChange:v=>o({...i,points_limit_pro:gl(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Max points a Pro user can earn/spend per period."})]}),c.jsxs("div",{children:[c.jsx(Qe,{className:"font-medium",children:"Limit (Regular users)"}),c.jsx(Ae,{type:"number",min:0,value:i.points_limit_user,onChange:v=>o({...i,points_limit_user:gl(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Max points a regular user can earn/spend per period."})]}),c.jsxs("div",{children:[c.jsx(Qe,{className:"font-medium",children:"Points per 1 Currency Unit"}),c.jsx(Ae,{type:"number",min:0,step:"0.01",value:i.points_per_currency,onChange:v=>o({...i,points_per_currency:gl(v.target.value)}),className:"mt-1"}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Conversion rate (e.g., points per ₦1)."})]})]})]}),c.jsxs(Vr,{className:"border-slate-200",children:[c.jsx(pa,{children:c.jsx(Wa,{className:"text-slate-800",children:"Earning Rules"})}),c.jsxs(mi,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Post"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_post,onChange:v=>o({...i,points_per_post:gl(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Post View"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_post_view,onChange:v=>o({...i,points_per_post_view:gl(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Post Reaction"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_post_reaction,onChange:v=>o({...i,points_per_post_reaction:gl(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Post Comment"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_post_comment,onChange:v=>o({...i,points_per_post_comment:gl(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Comment"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_comment,onChange:v=>o({...i,points_per_comment:gl(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Reaction"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_reaction,onChange:v=>o({...i,points_per_reaction:gl(v.target.value)}),className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(Qe,{children:"Per Follow"}),c.jsx(Ae,{type:"number",min:0,value:i.points_per_follow,onChange:v=>o({...i,points_per_follow:gl(v.target.value)}),className:"mt-1"})]})]})]})]}),c.jsxs("div",{className:"mt-6 flex items-center gap-3",children:[c.jsx(be,{disabled:u,onClick:g,children:u?"Saving…":"Save Changes"}),c.jsx(be,{variant:"secondary",disabled:u,onClick:()=>p(),children:"Reset"})]})]})}):c.jsx("div",{className:"rounded-3xl bg-white shadow-xl ring-1 ring-black/5 p-6 md:p-7",children:"Loading…"})}const OE="https://api.gada.chat",NSt=e=>(e||"?").split(" ").filter(Boolean).map(t=>t[0].toUpperCase()).slice(0,2).join("");function ASt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState(!1),[o,u]=w.useState([]),[h,p]=w.useState(1),[g,v]=w.useState(1),[b,E]=w.useState(0),[T,C]=w.useState(""),[R,N]=w.useState(10);async function O(D=h){i(!0);try{const U=new URL(`${OE}/api/admin/reports`);U.searchParams.set("page",String(D)),U.searchParams.set("limit",String(R)),T.trim()&&U.searchParams.set("q",T.trim());const H=await(await fetch(U.toString(),{headers:t})).json();if(!(H!=null&&H.ok))throw new Error("Failed");u(H.items||[]),p(H.page),v(H.pages),E(H.total)}catch(U){console.error(U)}finally{i(!1)}}w.useEffect(()=>{O(1)},[T,R]);async function j(D){if(!confirm("Mark this report as safe? This removes the report entry."))return;const F=await(await fetch(`${OE}/api/admin/reports/${D}/mark-safe`,{method:"POST",headers:t})).json();F!=null&&F.ok&&(u(H=>H.filter(W=>W.id!==D)),E(H=>Math.max(0,H-1)))}async function k(D){if(!confirm("Delete this report entry?"))return;const F=await(await fetch(`${OE}/api/admin/reports/${D}`,{method:"DELETE",headers:t})).json();F!=null&&F.ok&&(u(H=>H.filter(W=>W.id!==D)),E(H=>Math.max(0,H-1)))}async function P(){if(!confirm("Mark ALL reports as safe? This clears the table."))return;const U=await(await fetch(`${OE}/api/admin/reports/bulk/mark-safe`,{method:"POST",headers:t,body:JSON.stringify({ids:[]})})).json();U!=null&&U.ok&&(u([]),E(0),v(1),p(1))}const M=w.useMemo(()=>{if(b===0)return"Showing 0 of 0";const D=(h-1)*R+1,U=Math.min(b,h*R);return`Showing ${D}–${U} of ${b}`},[h,R,b]);return c.jsx("div",{className:"p-4 md:p-6",children:c.jsx("div",{className:"mx-auto max-w-[1400px]",children:c.jsxs("div",{className:"rounded-2xl bg-white border shadow-sm",children:[c.jsxs("div",{className:"p-4 md:p-6 border-b flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(kN,{className:"h-5 w-5 text-gray-700"}),c.jsx("h1",{className:"text-xl font-semibold",children:"Reports"})]}),c.jsx(be,{onClick:P,variant:"destructive",className:"bg-rose-600 hover:bg-rose-700",children:"Mark All As Safe"})]}),c.jsxs("div",{className:"px-4 md:px-6 py-3 border-b flex flex-wrap items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Show"}),c.jsx("select",{value:R,onChange:D=>N(Number(D.target.value)),className:"h-9 rounded-md border px-2 text-sm",children:[10,25,50,100].map(D=>c.jsx("option",{value:D,children:D},D))}),c.jsx("span",{className:"text-sm text-gray-500",children:"entries"})]}),c.jsxs("div",{className:"ml-auto relative",children:[c.jsx(Ef,{className:"h-4 w-4 text-gray-400 absolute left-3 top-2.5"}),c.jsx(Ae,{placeholder:"Search…",value:T,onChange:D=>C(D.target.value),className:"pl-9 w-[260px] bg-white"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50 text-gray-600",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left w-[60px]",children:"ID"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Node"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Type"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Reporter By"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Reporter For"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Time"}),c.jsx("th",{className:"px-3 py-2 text-left w-[140px]",children:"Actions"})]})}),c.jsxs("tbody",{children:[n&&c.jsx("tr",{children:c.jsxs("td",{colSpan:7,className:"px-3 py-8 text-center text-gray-500",children:[c.jsx(ei,{className:"h-4 w-4 animate-spin inline mr-2"}),"Loading…"]})}),!n&&o.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-3 py-8 text-center text-gray-500",children:"No reports"})}),o.map(D=>{var U,F,H,W,q,Y;return c.jsxs("tr",{className:"border-t",children:[c.jsx("td",{className:"px-3 py-2",children:D.id}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("a",{href:`/posts/${D.nodeId}`,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-[#1877F2] hover:underline",children:[c.jsx(Xce,{className:"h-3.5 w-3.5"})," View Post"]})}),c.jsx("td",{className:"px-3 py-2",children:c.jsx("span",{className:"inline-flex px-2 py-1 rounded-full bg-rose-50 text-rose-700 text-xs font-medium",children:((U=D.type)==null?void 0:U.toUpperCase())||"—"})}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs($i,{className:"h-7 w-7",children:[c.jsx(Ii,{src:(F=D.reporter)!=null&&F.avatar?`${OE}/uploads/${Xn(D.reporter.avatar)}`:""}),c.jsx(ea,{children:NSt(((H=D.reporter)==null?void 0:H.fullName)||((W=D.reporter)==null?void 0:W.username))})]}),c.jsx("div",{className:"truncate max-w-[220px]",children:c.jsx("div",{className:"font-medium truncate",children:((q=D.reporter)==null?void 0:q.fullName)||((Y=D.reporter)==null?void 0:Y.username)})})]})}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("div",{className:"min-w-[120px]",children:[c.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-gray-100 text-gray-800 text-xs font-medium",children:D.category||"—"}),D.reason?c.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-[220px]",children:D.reason}):null]})}),c.jsx("td",{className:"px-3 py-2",children:D.time?new Date(D.time).toLocaleString(void 0,{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}),c.jsx("td",{className:"px-3 py-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(be,{size:"sm",onClick:()=>j(D.id),className:"bg-emerald-600 hover:bg-emerald-700",children:[c.jsx(Fw,{className:"h-4 w-4 mr-1"})," Safe"]}),c.jsxs(be,{size:"sm",variant:"destructive",onClick:()=>k(D.id),children:[c.jsx(Ww,{className:"h-4 w-4 mr-1"})," Delete"]})]})})]},D.id)})]})]})}),c.jsxs("div",{className:"px-4 md:px-6 py-3 border-t flex flex-wrap items-center gap-3",children:[c.jsx("div",{className:"text-sm text-gray-500",children:M}),c.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[c.jsx(be,{variant:"outline",size:"sm",disabled:h<=1,onClick:()=>{const D=Math.max(1,h-1);p(D),O(D)},children:"Prev"}),c.jsx("div",{className:"px-3 py-1 border rounded",children:h}),c.jsx(be,{variant:"outline",size:"sm",disabled:h>=g,onClick:()=>{const D=Math.min(g,h+1);p(D),O(D)},children:"Next"})]})]})]})})})}const hye="https://api.gada.chat";async function ISt(e){return(await fetch(`${hye}/api/admin/adssettings`,{headers:e})).json()}async function OSt(e,t){return(await fetch(`${hye}/api/admin/adssettings`,{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)})).json()}function PSt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState({ads_enabled:"0",ads_approval_enabled:"0",ads_author_view_enabled:"0",ads_cost_view:"0",ads_cost_click:"0"}),[o,u]=w.useState(!1),[h,p]=w.useState(!1);w.useEffect(()=>{(async()=>{u(!0);try{const v=await ISt(t);v!=null&&v.ok?i(v.settings):Ce.error((v==null?void 0:v.error)||"Failed to load settings")}catch{Ce.error("Failed to load settings")}finally{u(!1)}})()},[e]);const g=async()=>{p(!0);try{const v=await OSt(n,t);v!=null&&v.ok?Ce.success("Settings saved"):Ce.error((v==null?void 0:v.error)||"Failed to save")}catch{Ce.error("Failed to save")}finally{p(!1)}};return c.jsxs("div",{className:"p-6 space-y-6 max-w-6xl",children:[c.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Ads Settings"}),c.jsxs("div",{className:"space-y-4 bg-white p-6 rounded-lg shadow",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Ads Campaigns"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Allow users to create ads (enabling will also enable wallet by default)."})]}),c.jsx(Qi,{checked:n.ads_enabled==="1",onCheckedChange:v=>i(b=>({...b,ads_enabled:v?"1":"0"}))})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Ads Campaigns Approval System"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Turn the approval system On and Off (if disabled all campaigns will be auto-approved)."})]}),c.jsx(Qi,{checked:n.ads_approval_enabled==="1",onCheckedChange:v=>i(b=>({...b,ads_approval_enabled:v?"1":"0"}))})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:"Ads Author Can See His Ads"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Allow the author of ads to see them (disable = author can’t see own ads)."})]}),c.jsx(Qi,{checked:n.ads_author_view_enabled==="1",onCheckedChange:v=>i(b=>({...b,ads_author_view_enabled:v?"1":"0"}))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block font-semibold mb-1",children:"Cost by View"}),c.jsx(Ae,{type:"number",value:n.ads_cost_view,onChange:v=>i(b=>({...b,ads_cost_view:v.target.value}))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block font-semibold mb-1",children:"Cost by Click"}),c.jsx(Ae,{type:"number",value:n.ads_cost_click,onChange:v=>i(b=>({...b,ads_cost_click:v.target.value}))})]}),c.jsx(be,{onClick:g,disabled:h,children:h?"Saving…":"Save Changes"})]})]})}const fye="https://api.gada.chat";async function pye(e){const t=await e.json().catch(()=>({}));if(!e.ok)throw new Error(t&&(t.error||t.message)||"Request failed");return t}async function kSt(e={}){const t=await fetch(`${fye}/api/packages`,{headers:e,credentials:"include"});return pye(t)}async function jSt(e,t,n,i){const o=await fetch(`${fye}/api/packages/buypackage`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},credentials:"include",body:JSON.stringify({package_id:t,package_name:n,package_price:i})});return pye(o)}function DSt(){const{accessToken:e}=ct(),[t,n]=w.useState([]),[i,o]=w.useState(!0),[u,h]=w.useState(null),[p,g]=w.useState(0),[v,b]=w.useState(null),E=tr();w.useEffect(()=>{T()},[e]);const T=async()=>{e&&(o(!0),kSt({Authorization:`Bearer ${e}`}).then(R=>{console.log("Packages API response:",R),n((R==null?void 0:R.data)||[]),g((R==null?void 0:R.walletBalance)||0),b((R==null?void 0:R.activePlan)||null)}).catch(R=>{console.error("Error fetching packages:",R)}).finally(()=>{o(!1)}))},C=async R=>{if(!u){h(R.package_id);try{const N=await jSt(e,R.package_id,R.name,R.price);N.status?(console.log(N.message),Ce.success("Purchase successfull!"),T()):(Ce.error(N.message),E("/wallet"),console.log(N.message||"Purchase failed"))}catch{Ce.error("Something went wrong while purchasing."),console.log("Something went wrong while purchasing.")}finally{h(null)}}};return c.jsxs("div",{className:"flex flex-col min-h-screen bg-cus",children:[c.jsx(or,{}),c.jsx("div",{className:"flex flex-1 overflow-hidden px-4 lg:px-8 py-6",children:c.jsxs("div",{className:"flex flex-1 max-w-[1600px] w-full mx-auto gap-6",children:[c.jsx("aside",{className:"hidden lg:block lg:w-1/5",children:c.jsx("div",{className:"sticky top-16",children:c.jsx(Ss,{})})}),c.jsxs("main",{className:"flex-1 flex flex-col overflow-y-auto space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Pro Packages"}),c.jsxs("p",{className:"text-lg text-white/80",children:["Choose the Plan That's Right for You"," ",c.jsxs("strong",{children:["( Available Balance : ",p," )"]})]})]}),i?c.jsx("p",{className:"text-white text-center",children:"Loading..."}):c.jsx("div",{className:"flex flex-col md:flex-row gap-6 justify-center",children:t.map(R=>c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full md:w-1/2 border",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:R.color||"#000"},children:R.name}),c.jsxs("p",{className:"text-3xl font-bold",children:["N",R.price]}),c.jsxs("p",{className:"text-gray-500 mb-4",children:["for ",R.period_num," ",R.period,R.period_num>1?"s":""]}),c.jsxs("ul",{className:"space-y-2 mb-4",children:[R.verification_badge_enabled==="1"&&c.jsx("li",{children:"✅ Verified badge"}),R.boost_posts>0&&c.jsxs("li",{children:["✅ Boost up to ",R.boost_posts," Posts"]}),R.boost_pages>0&&c.jsxs("li",{children:["✅ Boost up to ",R.boost_pages," Pages"]}),c.jsx("li",{className:"font-semibold",children:"🛡 All Permissions"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",dangerouslySetInnerHTML:{__html:R.custom_description}}),c.jsx("button",{onClick:()=>C(R),disabled:u===R.package_id||(v==null?void 0:v.package_name)==="GADA VVIP"||(v==null?void 0:v.package_name)==="GADA VIP"&&R.name==="GADA VIP",className:`w-full rounded-full px-6 py-2 transition
    ${u===R.package_id||(v==null?void 0:v.package_name)==="GADA VVIP"||(v==null?void 0:v.package_name)==="GADA VIP"&&R.name==="GADA VIP"?"bg-gray-400 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-600"}`,children:u===R.package_id?"Processing...":(v==null?void 0:v.package_name)===R.name?"Purchased":(v==null?void 0:v.package_name)==="GADA VVIP"&&R.name==="GADA VIP"?"Unavailable":"Buy Now"})]},R.package_id))})]})]})})]})}const uae="https://api.gada.chat";function LSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState("all"),[p,g]=w.useState(""),[v,b]=w.useState(1),[E,T]=w.useState(10),[C,R]=w.useState(0),[N,O]=w.useState(1),[j,k]=w.useState(!1),[P,M]=w.useState(!1),[D,U]=w.useState(null),F=async()=>{try{const Y=new URLSearchParams({status:u,search:p,page:String(v),limit:String(E)}),z=await fetch(`${uae}/api/admin/representatives?${Y.toString()}`,{headers:t});if(!z.ok)throw new Error("Failed to load representatives");const Z=await z.json();o(Z.items||[]),R(Z.total||0),O(Z.totalPages||1),k(!!Z.hasPrev),M(!!Z.hasNext)}catch(Y){Ce.error("Load failed",{description:Y==null?void 0:Y.message})}};w.useEffect(()=>{n&&F()},[n,u,v,E]);const H=async(Y,z)=>{try{if(!(await fetch(`${uae}/api/admin/representatives/${Y}/status`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({action:z})})).ok)throw new Error("Action failed");Ce.success("Updated"),F()}catch(Z){Ce.error("Failed",{description:Z==null?void 0:Z.message})}};function W(Y,z){const Z=[],X=J=>Z.push(J);if(z<=7){for(let J=1;J<=z;J++)X(J);return Z}X(1),Y>3&&X("…");const ae=Math.max(2,Y-1),se=Math.min(z-1,Y+1);for(let J=ae;J<=se;J++)X(J);return Y<z-2&&X("…"),X(z),Z}const q=W(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsxs(Pr,{value:u,onValueChange:Y=>{b(1),h(Y)},children:[c.jsx(Cr,{className:"w-40",children:c.jsx(kr,{placeholder:"Status"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"all",children:"All"}),c.jsx(ht,{value:"pending",children:"Pending"}),c.jsx(ht,{value:"approved",children:"Approved"}),c.jsx(ht,{value:"rejected",children:"Rejected"})]})]}),c.jsx(Ae,{placeholder:"Search name/email",value:p,onChange:Y=>g(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&(b(1),F()),className:"w-full sm:w-64"}),c.jsx(be,{onClick:()=>{b(1),F()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:Y=>{b(1),T(Number(Y))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Name"}),c.jsx(nt,{children:"Username"}),c.jsx(nt,{children:"Email"}),c.jsx(nt,{children:"Phone"}),c.jsx(nt,{children:"State"}),c.jsx(nt,{children:"Proposed Location"}),c.jsx(nt,{children:"Status"}),c.jsx(nt,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.map(Y=>c.jsxs(tn,{children:[c.jsx(Ke,{children:Y.name}),c.jsx(Ke,{children:Y.username}),c.jsx(Ke,{children:Y.email}),c.jsx(Ke,{children:Y.phone}),c.jsx(Ke,{children:Y.state}),c.jsx(Ke,{children:Y.proposed_location}),c.jsx(Ke,{className:"capitalize",children:Y.status}),c.jsxs(Ke,{className:"text-right space-x-2",children:[Y.status==="pending"?c.jsxs(c.Fragment,{children:[c.jsx(be,{size:"sm",onClick:()=>H(Y.id,"accept"),children:"Approve"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>H(Y.id,"decline"),children:"Reject"})]}):"---",c.jsx(be,{size:"sm",variant:"outline",onClick:()=>U(Y),children:"View"})]})]},Y.id))})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(jm,{children:c.jsxs(Dm,{children:[c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Yn,{children:c.jsx(Lm,{onClick:()=>b(Y=>Math.max(1,Y-1)),className:j?"":"pointer-events-none opacity-50"})}),q.map((Y,z)=>Y==="…"?c.jsx(Yn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${z}`):c.jsx(Yn,{children:c.jsx(ra,{isActive:Y===v,onClick:()=>b(Y),children:Y})},Y)),c.jsx(Yn,{children:c.jsx(Mm,{onClick:()=>b(Y=>Math.min(N,Y+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]}),c.jsx(Ko,{open:!!D,onOpenChange:()=>U(null),children:c.jsxs(mo,{className:"max-w-lg",children:[c.jsxs(qo,{children:[c.jsx(Yo,{children:"Representative Details"}),c.jsxs(t_,{children:["All details for ",D==null?void 0:D.name]})]}),D&&c.jsxs("div",{className:"space-y-3 text-md",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Name:"})," ",D.name]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Username:"})," ",D.username]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Email:"})," ",D.email]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Phone:"})," ",D.phone]}),c.jsxs("div",{children:[c.jsx("strong",{children:"State:"})," ",D.state]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Resident Address:"})," ",D.resident_address]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Residential State:"})," ",D.residential_state]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Proposed Location:"})," ",D.proposed_location]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Gada Chat Username:"})," ",D.gada_chat_username]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Note:"})," ",D.note]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",D.status]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Date:"})," ",new Date(D.created_at).toLocaleString()]})]})]})})]})}const wR="https://api.gada.chat";function MSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState("all"),[p,g]=w.useState(""),[v,b]=w.useState(1),[E,T]=w.useState(10),[C,R]=w.useState(0),[N,O]=w.useState(1),[j,k]=w.useState(!1),[P,M]=w.useState(!1),[D,U]=w.useState(null),F=async()=>{try{const Y=new URLSearchParams({status:u,search:p,page:String(v),limit:String(E)}),z=await fetch(`${wR}/api/admin/bank-transfers?${Y.toString()}`,{headers:t});if(!z.ok)throw new Error("Failed to load bank transfers");const Z=await z.json();o(Z.items||[]),R(Z.total||0),O(Z.totalPages||1),k(!!Z.hasPrev),M(!!Z.hasNext)}catch(Y){Ce.error("Load failed",{description:Y==null?void 0:Y.message})}};w.useEffect(()=>{n&&F()},[n,u,v,E]);const H=async(Y,z)=>{try{if(!(await fetch(`${wR}/api/admin/bank-transfers/${Y}/status`,{method:"PUT",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({action:z})})).ok)throw new Error("Action failed");Ce.success("Updated"),F()}catch(Z){Ce.error("Failed",{description:Z==null?void 0:Z.message})}};function W(Y,z){const Z=[],X=J=>Z.push(J);if(z<=7){for(let J=1;J<=z;J++)X(J);return Z}X(1),Y>3&&X("…");const ae=Math.max(2,Y-1),se=Math.min(z-1,Y+1);for(let J=ae;J<=se;J++)X(J);return Y<z-2&&X("…"),X(z),Z}const q=W(v,N);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsx(Ae,{placeholder:"Search by user / handle",value:p,onChange:Y=>g(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&(b(1),F()),className:"w-full sm:w-64"}),c.jsx(be,{onClick:()=>{b(1),F()},children:"Search"}),c.jsxs(Pr,{value:String(E),onValueChange:Y=>{b(1),T(Number(Y))},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{placeholder:"Page size"})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[C.toLocaleString()," total • Page ",v," of ",N]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"ID"}),c.jsx(nt,{children:"User"}),c.jsx(nt,{children:"Handle"}),c.jsx(nt,{children:"Price"}),c.jsx(nt,{children:"Receipt"}),c.jsx(nt,{children:"Time"}),c.jsx(nt,{children:"Status"}),c.jsx(nt,{className:"text-right",children:"Actions"})]})}),c.jsx(ba,{children:i.length>0?i.map(Y=>c.jsxs(tn,{children:[c.jsx(Ke,{children:Y.transfer_id}),c.jsx(Ke,{children:Y.user_name}),c.jsx(Ke,{children:Y.handle}),c.jsx(Ke,{children:Y.price??"---"}),c.jsx(Ke,{children:Y.bank_receipt?c.jsx("a",{href:`${wR}/uploads/${Y.bank_receipt}`,target:"_blank",className:"text-blue-500 underline",children:"View"}):"-"}),c.jsx(Ke,{children:new Date(Y.time).toLocaleString()}),c.jsx(Ke,{children:Y.status===1?"Success":Y.status===-1?"Failed":"Pending"}),c.jsxs(Ke,{className:"text-right space-x-2",children:[c.jsx(be,{size:"sm",onClick:()=>H(Y.transfer_id,"accept"),children:"Approve"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>H(Y.transfer_id,"decline"),children:"Reject"}),c.jsx(be,{size:"sm",variant:"outline",onClick:()=>U(Y),children:"View"})]})]},Y.transfer_id)):c.jsx(tn,{children:c.jsx(Ke,{colSpan:9,className:"text-center text-gray-500",children:"No data available"})})})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(v-1)*E+1:0,"–",(v-1)*E+i.length," of ",C]}),c.jsx(jm,{children:c.jsxs(Dm,{children:[c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(1),"aria-disabled":v===1,className:v===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Yn,{children:c.jsx(Lm,{onClick:()=>b(Y=>Math.max(1,Y-1)),className:j?"":"pointer-events-none opacity-50"})}),q.map((Y,z)=>Y==="…"?c.jsx(Yn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${z}`):c.jsx(Yn,{children:c.jsx(ra,{isActive:Y===v,onClick:()=>b(Y),children:Y})},Y)),c.jsx(Yn,{children:c.jsx(Mm,{onClick:()=>b(Y=>Math.min(N,Y+1)),className:P?"":"pointer-events-none opacity-50"})}),c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>b(N),"aria-disabled":v===N,className:v===N?"pointer-events-none opacity-50":"",children:"Last"})})]})})]}),c.jsx(Ko,{open:!!D,onOpenChange:()=>U(null),children:c.jsxs(mo,{className:"max-w-lg",children:[c.jsxs(qo,{children:[c.jsx(Yo,{children:"Bank Transfer Details"}),c.jsxs(t_,{children:["Transfer #",D==null?void 0:D.transfer_id]})]}),D&&c.jsxs("div",{className:"space-y-3 text-md",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"User:"})," ",D.user_name]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Handle:"})," ",D.handle]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Price:"})," ",D.price??"---"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Receipt:"})," ",D.bank_receipt?c.jsx("a",{href:`${wR}/uploads/${D.bank_receipt}`,target:"_blank",className:"text-blue-500 underline",children:"View Receipt"}):"-"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Time:"})," ",new Date(D.time).toLocaleString()]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",D.status===1?"Success":D.status===-1?"Failed":"Pending"]})]})]})})]})}const cM="https://api.gada.chat",SR=25;function fv({title:e,value:t,gradient:n,Icon:i}){return c.jsxs("div",{className:`relative overflow-hidden rounded-3xl px-6 py-7 text-white shadow-sm bg-gradient-to-tr ${n}`,children:[c.jsx("div",{className:"pointer-events-none absolute -right-10 -bottom-10 h-40 w-40 rounded-full bg-white/20"}),c.jsx("div",{className:"pointer-events-none absolute -right-16 bottom-0 h-28 w-28 rounded-full bg-white/10"}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-extrabold leading-none",children:t}),c.jsx("div",{className:"mt-2 text-xl font-semibold opacity-95",children:e})]}),c.jsx("div",{className:"shrink-0",children:c.jsx("div",{className:"grid place-items-center h-12 w-12 rounded-2xl bg-white/15",children:c.jsx(i,{className:"h-6 w-6 text-white"})})})]})]})}function USt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState(1),[p,g]=w.useState(0),[v,b]=w.useState(1),[E,T]=w.useState(!1),[C,R]=w.useState(!1),[N,O]=w.useState(null),[j,k]=w.useState([]),[P,M]=w.useState([]),[D,U]=w.useState(null),F=async()=>{try{const z=new URLSearchParams({page:String(u),limit:String(SR)}),Z=await fetch(`${cM}/api/admin/earning-payments?${z.toString()}`,{headers:t});if(!Z.ok)throw new Error("Failed to load earning payments");const X=await Z.json();o(X.items||[]),g(X.total||0),b(X.totalPages||1),T(!!X.hasPrev),R(!!X.hasNext)}catch(z){Ce.error("Load failed",{description:z==null?void 0:z.message})}},H=async()=>{try{const z=await fetch(`${cM}/api/admin/earning-payments/log-points-stats`,{headers:t});if(!z.ok)throw new Error("Failed to load stats");const Z=await z.json();O(Z)}catch(z){Ce.error("Stats load failed",{description:z==null?void 0:z.message})}},W=async()=>{try{const z=await fetch(`${cM}/api/admin/earning-payments/payin-methods`,{headers:t});if(!z.ok)throw new Error("Failed to load chart");const Z=await z.json();k(Z.data),M(Z.methods)}catch(z){Ce.error("Chart load failed",{description:z==null?void 0:z.message})}};w.useEffect(()=>{n&&(F(),H(),W())},[n,u]);function q(z,Z){const X=[],ae=re=>X.push(re);if(Z<=7){for(let re=1;re<=Z;re++)ae(re);return X}ae(1),z>3&&ae("…");const se=Math.max(2,z-1),J=Math.min(Z-1,z+1);for(let re=se;re<=J;re++)ae(re);return z<Z-2&&ae("…"),ae(Z),X}const Y=q(u,v);return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Earnings - Payments"}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"PayIn Methods"}),c.jsx(p3,{width:"100%",height:300,children:c.jsxs(J3,{data:j,children:[c.jsx(hO,{strokeDasharray:"3 3"}),c.jsx(b_,{dataKey:"month"}),c.jsx(E_,{}),c.jsx(Nc,{}),c.jsx(kd,{}),P.map((z,Z)=>c.jsx(Bo,{dataKey:z,fill:Z===0?"#3b82f6":"#8b5cf6"},z))]})})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[c.jsx(fv,{title:"Total PayIn",value:N?N.totalPayIn.toFixed(2):"—",gradient:"from-indigo-500 to-blue-500",Icon:GZ}),c.jsx(fv,{title:"This Month PayIn",value:N?N.totalPayInMonth.toFixed(2):"—",gradient:"from-green-500 to-emerald-500",Icon:GZ}),c.jsx(fv,{title:"Total Pending PayOut",value:N?N.pendingPayOut.toFixed(2):"—",gradient:"from-purple-500 to-violet-500",Icon:HZ}),c.jsx(fv,{title:"This Month Pending PayOut",value:N?N.pendingPayOutMonth.toFixed(2):"—",gradient:"from-pink-500 to-rose-500",Icon:HZ}),c.jsx(fv,{title:"Total Approved PayOut",value:N?N.totalPayOut.toFixed(2):"—",gradient:"from-yellow-500 to-amber-500",Icon:BZ}),c.jsx(fv,{title:"This Month Approved PayOut",value:N?N.totalPayOutMonth.toFixed(2):"—",gradient:"from-red-500 to-orange-500",Icon:BZ})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsxs("div",{className:"text-sm text-gray-500",children:[p.toLocaleString()," total • Page ",u," of ",v," •"," ",SR," / page"]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Txn ID"}),c.jsx(nt,{children:"User"}),c.jsx(nt,{children:"Type"}),c.jsx(nt,{children:"Node"}),c.jsx(nt,{children:"Amount"}),c.jsx(nt,{children:"Reference"}),c.jsx(nt,{children:"Date"}),c.jsx(nt,{className:"text-right",children:"Details"})]})}),c.jsx(ba,{children:i.length>0?i.map(z=>c.jsxs(tn,{children:[c.jsx(Ke,{children:z.transaction_id}),c.jsx(Ke,{children:z.user_name??z.user_id}),c.jsx(Ke,{className:"capitalize",children:z.type}),c.jsxs(Ke,{children:[z.node_type,z.node_id?` #${z.node_id}`:""]}),c.jsx(Ke,{children:z.amount}),c.jsx(Ke,{children:z.reference??"—"}),c.jsx(Ke,{children:new Date(z.date).toLocaleString()}),c.jsx(Ke,{className:"text-right",children:c.jsx("button",{className:"text-sm px-3 py-1 rounded border hover:bg-gray-50",onClick:()=>U(z),children:"View"})})]},z.transaction_id)):c.jsx(tn,{children:c.jsx(Ke,{colSpan:8,className:"text-center text-gray-500",children:"No data available"})})})]})}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",i.length?(u-1)*SR+1:0,"–",(u-1)*SR+i.length," of ",p]}),c.jsx(jm,{children:c.jsxs(Dm,{children:[c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>h(1),"aria-disabled":u===1,className:u===1?"pointer-events-none opacity-50":"",children:"First"})}),c.jsx(Yn,{children:c.jsx(Lm,{onClick:()=>h(z=>Math.max(1,z-1)),className:E?"":"pointer-events-none opacity-50"})}),Y.map((z,Z)=>z==="…"?c.jsx(Yn,{children:c.jsx("span",{className:"px-2 text-gray-400",children:"…"})},`ell-${Z}`):c.jsx(Yn,{children:c.jsx(ra,{isActive:z===u,onClick:()=>h(z),children:z})},z)),c.jsx(Yn,{children:c.jsx(Mm,{onClick:()=>h(z=>Math.min(v,z+1)),className:C?"":"pointer-events-none opacity-50"})}),c.jsx(Yn,{children:c.jsx(ra,{onClick:()=>h(v),"aria-disabled":u===v,className:u===v?"pointer-events-none opacity-50":"",children:"Last"})})]})})]}),c.jsx(Ko,{open:!!D,onOpenChange:()=>U(null),children:c.jsxs(mo,{className:"max-w-lg",children:[c.jsxs(qo,{children:[c.jsx(Yo,{children:"Earning Payment Details"}),c.jsxs(t_,{children:["Transaction #",D==null?void 0:D.transaction_id]})]}),D&&c.jsxs("div",{className:"space-y-3 text-md",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"User:"})," ",D.user_name??D.user_id]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Type:"})," ",D.type]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Node:"})," ",D.node_type,D.node_id?` #${D.node_id}`:""]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Amount:"})," ",D.amount]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Reference:"})," ",D.reference??"—"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Date:"})," ",new Date(D.date).toLocaleString()]})]})]})})]})]})}const xR="https://api.gada.chat";function FSt(){const{accessToken:e}=ct(),t=St(e),n=w.useMemo(()=>"Authorization"in t,[t]),[i,o]=w.useState([]),[u,h]=w.useState(""),[p,g]=w.useState(!1),v={parentId:0,name:"",description:"",order:1},[b,E]=w.useState(v),[T,C]=w.useState(!1),R=async()=>{const M=new URLSearchParams;u.trim()&&M.set("search",u.trim());const D=await fetch(`${xR}/api/admin/report-categories?`+M,{headers:t});if(!D.ok)return Ce.error("Failed to load categories");const U=await D.json();o(Array.isArray(U)?U:[])};w.useEffect(()=>{n&&R()},[n]);const N=()=>{E(v),g(!0)},O=M=>{E({id:M.id,parentId:M.parentId??0,name:M.name??"",description:M.description??"",order:M.order??1}),g(!0)},j=async()=>{if(!b.name.trim())return Ce.error("Name is required");C(!0);try{const M=b.id?"PUT":"POST",D=b.id?`${xR}/api/admin/report-categories/${b.id}`:`${xR}/api/admin/report-categories`,U=await fetch(D,{method:M,headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({parentId:Number(b.parentId)||0,name:b.name.trim(),description:b.description??"",order:Number(b.order)||1})});if(!U.ok){const F=await U.json().catch(()=>({}));throw new Error((F==null?void 0:F.error)||"Save failed")}Ce.success(b.id?"Updated":"Created"),g(!1),await R()}catch(M){Ce.error(M.message||"Save failed")}finally{C(!1)}},k=async M=>{if(!confirm(`Delete category "${M.name}"?`))return;const D=await fetch(`${xR}/api/admin/report-categories/${M.id}`,{method:"DELETE",headers:t});if(!D.ok){const U=await D.json().catch(()=>({}));return Ce.error((U==null?void 0:U.error)||"Delete failed")}Ce.success("Deleted"),R()},P=w.useMemo(()=>[{id:0,name:"— Parent (no parent) —"},...i.filter(M=>!M.parentId).map(M=>({id:M.id,name:M.name}))],[i]);return c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Reports › Categories"}),c.jsx(be,{onClick:N,children:"+ Add New Category"})]}),c.jsxs("div",{className:"flex gap-2 mb-4",children:[c.jsx(Ae,{placeholder:"Search by name or description",value:u,onChange:M=>h(M.target.value),onKeyDown:M=>M.key==="Enter"&&R(),className:"w-full sm:w-96"}),c.jsx(be,{onClick:R,children:"Search"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(ya,{children:[c.jsx(_a,{children:c.jsxs(tn,{children:[c.jsx(nt,{children:"Title"}),c.jsx(nt,{children:"Description"}),c.jsx(nt,{className:"w-24",children:"Order"}),c.jsx(nt,{className:"w-40",children:"Actions"})]})}),c.jsxs(ba,{children:[i.map(M=>c.jsxs(tn,{children:[c.jsxs(Ke,{className:"align-top",children:[c.jsx("div",{className:"font-medium",children:M.name}),M.parentId?c.jsxs("div",{className:"text-xs text-gray-500",children:["Child of #",M.parentId]}):c.jsx("div",{className:"text-xs text-gray-500",children:"Parent"})]}),c.jsx(Ke,{className:"align-top",children:M.description||c.jsx("span",{className:"text-gray-400",children:"—"})}),c.jsx(Ke,{className:"align-top",children:c.jsx("span",{className:"inline-flex items-center rounded-full bg-cyan-100 text-cyan-700 px-2 py-0.5 text-xs font-medium",children:M.order})}),c.jsxs(Ke,{className:"align-top space-x-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:()=>O(M),children:"Edit"}),c.jsx(be,{size:"sm",variant:"destructive",onClick:()=>k(M),children:"Delete"})]})]},M.id)),!i.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:4,className:"text-center text-gray-500",children:"No categories found"})})]})]})}),c.jsx(Ko,{open:p,onOpenChange:g,children:c.jsxs(mo,{className:"sm:max-w-lg",children:[c.jsx(qo,{children:c.jsx(Yo,{children:b.id?"Edit Category":"Create Category"})}),c.jsxs("div",{className:"space-y-4 py-2",children:[c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Qe,{children:"Name *"}),c.jsx(Ae,{value:b.name,onChange:M=>E(D=>({...D,name:M.target.value})),placeholder:"e.g., Nudity"})]}),c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Qe,{children:"Description"}),c.jsx(Ei,{value:b.description,onChange:M=>E(D=>({...D,description:M.target.value})),placeholder:"Optional"})]}),c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Qe,{children:"Parent"}),c.jsxs(Pr,{value:String(b.parentId),onValueChange:M=>E(D=>({...D,parentId:Number(M)})),children:[c.jsx(Cr,{children:c.jsx(kr,{placeholder:"Select parent"})}),c.jsx(Rr,{children:P.map(M=>c.jsx(ht,{value:String(M.id),children:M.name},M.id))})]})]}),c.jsxs("div",{className:"grid gap-2",children:[c.jsx(Qe,{children:"Order"}),c.jsx(Ae,{type:"number",min:1,value:b.order,onChange:M=>E(D=>({...D,order:Number(M.target.value||1)}))})]})]}),c.jsxs(lm,{className:"gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>g(!1),disabled:T,children:"Cancel"}),c.jsx(be,{onClick:j,disabled:T,children:T?"Saving…":"Save"})]})]})})]})}const S_="https://api.gada.chat";async function VSt(e,t){const n=new URLSearchParams({status:e.status,page:String(e.page??1),limit:String(e.limit??10),search:e.search??""});return(await fetch(`${S_}/api/admin/ads?${n.toString()}`,{headers:t})).json()}async function BSt(e,t){return(await fetch(`${S_}/api/admin/ads/${e}/approve`,{method:"POST",headers:t})).json()}async function $St(e,t){return(await fetch(`${S_}/api/admin/ads/${e}/decline`,{method:"POST",headers:t})).json()}async function WSt(e,t,n){return(await fetch(`${S_}/api/admin/ads/${e}/active`,{method:"POST",headers:{"Content-Type":"application/json",...n},body:JSON.stringify({active:t})})).json()}async function GSt(e,t){return(await fetch(`${S_}/api/admin/ads/${e}`,{method:"DELETE",headers:t})).json()}async function HSt(e,t){return(await fetch(`${S_}/api/admin/ads/${e}`,{headers:t})).json()}function zSt({open:e,onOpenChange:t,ad:n}){return e?c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>t(!1)}),c.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-full sm:w-[520px] bg-white shadow-xl p-4 overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Ad Details"}),c.jsx("button",{onClick:()=>t(!1),children:"✕"})]}),n?c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Title:"})," ",n.campaign_title]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"User:"})," ",n.user_name," (#",n.user_id,")"]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Budget:"})," ₦",Number(n.campaign_budget).toFixed(2)]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Spend:"})," ₦",Number(n.campaign_spend).toFixed(2)]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Bidding:"})," ",n.campaign_bidding]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Clicks / Views:"})," ",n.campaign_clicks," / ",n.campaign_views]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Placement:"})," ",n.ads_placement]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Start:"})," ",new Date(n.campaign_start_date).toLocaleString()]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"End:"})," ",new Date(n.campaign_end_date).toLocaleString()]}),n.ads_image&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium block mb-1",children:"Image"}),c.jsx("img",{src:n.ads_image,className:"rounded-md max-h-64"})]}),n.ads_url&&c.jsx("div",{className:"mt-2",children:c.jsx("a",{className:"text-indigo-600 underline",href:n.ads_url,target:"_blank",children:"Visit target URL"})})]}):c.jsx("div",{className:"text-sm text-gray-500",children:"No data"})]})]}):null}function KSt(){const{accessToken:e}=ct(),t=St(e),[n,i]=w.useState("pending"),[o,u]=w.useState([]),[h,p]=w.useState(0),[g,v]=w.useState(1),[b,E]=w.useState(10),[T,C]=w.useState(""),[R,N]=w.useState(!1),O=w.useMemo(()=>Math.max(1,Math.ceil(h/b)),[h,b]),[j,k]=w.useState(!1),[P,M]=w.useState(null);async function D(){N(!0);try{const U=await VSt({status:n,page:g,limit:b,search:T},t);if(!(U!=null&&U.ok))throw new Error((U==null?void 0:U.error)||"Failed to load");u(U.items??[]),p(U.total??0)}catch(U){Ce.error(U.message||"Failed to load ads")}finally{N(!1)}}return w.useEffect(()=>{D()},[n,g,b,T,e]),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx(Rm,{value:n,onValueChange:U=>{i(U),v(1)},children:c.jsxs(jf,{children:[c.jsx(Ia,{value:"pending",children:"Pending"}),c.jsx(Ia,{value:"approved",children:"Approved"})]})}),c.jsx(Ae,{placeholder:"Search title or user…",value:T,onChange:U=>{v(1),C(U.target.value)},className:"w-full md:w-80"}),c.jsxs("div",{className:"ml-auto flex gap-2",children:[c.jsxs(Pr,{value:String(b),onValueChange:U=>{E(Number(U)),v(1)},children:[c.jsx(Cr,{className:"w-28",children:c.jsx(kr,{})}),c.jsxs(Rr,{children:[c.jsx(ht,{value:"10",children:"10 / page"}),c.jsx(ht,{value:"20",children:"20 / page"}),c.jsx(ht,{value:"50",children:"50 / page"}),c.jsx(ht,{value:"100",children:"100 / page"})]})]}),c.jsx(be,{onClick:()=>D(),disabled:R,children:"Refresh"})]})]}),c.jsx("div",{className:"rounded-md border bg-white",children:c.jsxs(ya,{className:"table-fixed",children:[c.jsx(_a,{className:"sticky top-0 bg-white z-10",children:c.jsxs(tn,{children:[c.jsx(nt,{className:"w-16",children:"ID"}),c.jsx(nt,{children:"Title"}),c.jsx(nt,{className:"w-56",children:"By"}),c.jsx(nt,{className:"w-32",children:"Budget"}),c.jsx(nt,{className:"w-32",children:"Spend"}),c.jsx(nt,{className:"w-40",children:"Clicks/Views"}),c.jsx(nt,{className:"w-28",children:"Status"}),c.jsx(nt,{className:"w-56",children:"Actions"})]})}),c.jsxs(ba,{children:[o.map(U=>{const F=U.campaign_is_active===1||U.campaign_is_active==="1",H=Number(U.campaign_clicks||0),W=Number(U.campaign_views||0);return c.jsxs(tn,{children:[c.jsx(Ke,{children:U.campaign_id}),c.jsx(Ke,{className:"whitespace-nowrap truncate",children:U.campaign_title}),c.jsx(Ke,{className:"whitespace-nowrap truncate",children:U.user_name}),c.jsxs(Ke,{children:["₦",Number(U.campaign_budget).toFixed(2)]}),c.jsxs(Ke,{children:["₦",Number(U.campaign_spend).toFixed(2)]}),c.jsx(Ke,{children:H>0?`${H} Clicks`:`${W} Views`}),c.jsx(Ke,{children:F?c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Active"}):c.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs bg-red-50 text-red-700 border border-red-200",children:"Not Active"})}),c.jsx(Ke,{className:"whitespace-nowrap",children:c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(be,{size:"sm",variant:"outline",onClick:async()=>{const q=await HSt(U.campaign_id,t);q!=null&&q.ok?(M(q.item),k(!0)):Ce.error((q==null?void 0:q.error)||"Failed to fetch")},title:"View",children:"👁"}),n==="pending"?c.jsxs(c.Fragment,{children:[c.jsx(be,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{const q=await BSt(U.campaign_id,t);q!=null&&q.ok?(Ce.success("Approved"),D()):Ce.error((q==null?void 0:q.error)||"Approve failed")},title:"Approve",children:"✓"}),c.jsx(be,{size:"sm",className:"bg-yellow-500 hover:bg-yellow-600",onClick:async()=>{const q=await $St(U.campaign_id,t);q!=null&&q.ok?(Ce.success("Declined"),D()):Ce.error((q==null?void 0:q.error)||"Decline failed")},title:"Decline",children:"✕"})]}):c.jsxs(c.Fragment,{children:[c.jsx(be,{size:"sm",variant:"outline",onClick:async()=>{const q=await WSt(U.campaign_id,!F,t);q!=null&&q.ok?(Ce.success(q.active?"Activated":"Paused"),u(Y=>Y.map(z=>z.campaign_id===U.campaign_id?{...z,campaign_is_active:q.active?"1":"0"}:z))):Ce.error((q==null?void 0:q.error)||"Status update failed")},title:F?"Pause":"Activate",children:F?"Pause":"Activate"}),c.jsx(be,{size:"sm",className:"bg-red-500 hover:bg-red-600",onClick:async()=>{if(!confirm(`Delete "${U.campaign_title}"?`))return;const q=await GSt(U.campaign_id,t);q!=null&&q.ok?(Ce.success("Deleted"),D()):Ce.error((q==null?void 0:q.error)||"Delete failed")},title:"Delete",children:"🗑"})]})]})})]},U.campaign_id)}),!o.length&&c.jsx(tn,{children:c.jsx(Ke,{colSpan:8,className:"text-center py-10 text-gray-500",children:"No ads found"})})]})]})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",g," of ",O," — ",h," ads"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(be,{variant:"outline",onClick:()=>v(U=>Math.max(1,U-1)),disabled:g<=1||R,children:"Prev"}),c.jsx(be,{variant:"outline",onClick:()=>v(U=>Math.min(O,U+1)),disabled:g>=O||R,children:"Next"})]})]}),c.jsx(zSt,{open:j,onOpenChange:k,ad:P})]})}const qSt=new KUe,YSt=()=>c.jsx(YUe,{client:qSt,children:c.jsx(pVe,{children:c.jsx(J6e,{children:c.jsx(xVe,{children:c.jsx(SUe,{children:c.jsxs(y6e,{children:[c.jsx(L2e,{position:"top-right",richColors:!0,closeButton:!0,theme:"system"}),c.jsx(JFe,{children:c.jsxs(WFe,{children:[c.jsx(Ut,{path:"/",element:c.jsx(IVe,{children:c.jsx(L8e,{})})}),c.jsx(Ut,{path:"/login",element:c.jsx(V8e,{})}),c.jsx(Ut,{path:"/register",element:c.jsx(W8e,{})}),c.jsx(Ut,{path:"/forgot-password",element:c.jsx(z8e,{})}),c.jsx(Ut,{path:"/profile/:id",element:c.jsx(eWe,{})}),c.jsx(Ut,{path:"*",element:c.jsx(hHe,{})}),c.jsx(Ut,{path:"activation/:token",element:c.jsx(nWe,{})}),c.jsx(Ut,{path:"friends",element:c.jsx(lWe,{})}),c.jsx(Ut,{path:"saved",element:c.jsx(uWe,{})}),c.jsx(Ut,{path:"/memories",element:c.jsx(pWe,{})}),c.jsx(Ut,{path:"/checkout",element:c.jsx(gWe,{})}),c.jsx(Ut,{path:"/wallet",element:c.jsx(RGe,{})}),c.jsx(Ut,{path:"/packages",element:c.jsx(DSt,{})}),c.jsx(Ut,{path:"/points",element:c.jsx(qze,{})}),c.jsx(Ut,{path:"/reels/create",element:c.jsx(kGe,{})}),c.jsx(Ut,{path:"/reels",element:c.jsx(VGe,{children:c.jsx(DGe,{})})}),c.jsx(Ut,{path:"/notifications",element:c.jsx(LGe,{})}),c.jsx(Ut,{path:"/posts/:postId",element:c.jsx(UGe,{})}),c.jsx(Ut,{path:"/settings",element:c.jsx(dHe,{})}),c.jsx(Ut,{path:"/representative",element:c.jsx(Ree,{})}),c.jsx(Ut,{path:"/hashtag/:tag",element:c.jsx(Qze,{})}),c.jsx(Ut,{path:"/messages",element:c.jsx(t9e,{})}),c.jsx(Ut,{path:"/pages",element:c.jsx(m9e,{})}),c.jsx(Ut,{path:"/pages/create",element:c.jsx(v9e,{})}),c.jsx(Ut,{path:"/pages/:handle",element:c.jsx(g9e,{})}),c.jsx(Ut,{path:"/pages/invites",element:c.jsx(_9e,{})}),c.jsx(Ut,{path:"/groups",element:c.jsx(k9e,{})}),c.jsx(Ut,{path:"/groups/invites",element:c.jsx(L9e,{})}),c.jsx(Ut,{path:"/groups/create",element:c.jsx(M9e,{})}),c.jsx(Ut,{path:"/groups/:handle",element:c.jsx(j9e,{})}),c.jsx(Ut,{path:"/events",element:c.jsx(H9e,{})}),c.jsx(Ut,{path:"/events/create",element:c.jsx(z9e,{})}),c.jsx(Ut,{path:"/events/invites",element:c.jsx(q9e,{})}),c.jsx(Ut,{path:"/events/:id",element:c.jsx(Y9e,{})}),c.jsx(Ut,{path:"/watch",element:c.jsx(Q9e,{})}),c.jsx(Ut,{path:"/affiliates",element:c.jsx(a7e,{})}),c.jsx(Ut,{path:"/ads",element:c.jsx($Ye,{})}),c.jsxs(Ut,{path:"/admin",element:c.jsx(WYe,{children:c.jsx(zYe,{roles:["admin"],children:c.jsx(KYe,{})})}),children:[c.jsx(Ut,{path:"representative",element:c.jsx(Ree,{})}),c.jsx(Ut,{index:!0,element:c.jsx(wwt,{})}),c.jsx(Ut,{path:"users",element:c.jsx(kwt,{})}),c.jsx(Ut,{path:"settings",element:c.jsx(Lwt,{})}),c.jsx(Ut,{path:"profile",element:c.jsx(qwt,{})}),c.jsx(Ut,{path:"posts",element:c.jsx(Ywt,{})}),c.jsx(Ut,{path:"representatives",element:c.jsx(LSt,{})}),c.jsx(Ut,{path:"banktransfers",element:c.jsx(MSt,{})}),c.jsx(Ut,{path:"earningspayments",element:c.jsx(USt,{})}),c.jsx(Ut,{path:"/admin/page-categories",element:c.jsx(Xwt,{})}),c.jsx(Ut,{path:"/admin/page-categories/new",element:c.jsx(tae,{})}),c.jsx(Ut,{path:"/admin/page-categories/:id",element:c.jsx(tae,{})}),c.jsx(Ut,{path:"/admin/groups",element:c.jsx(Jwt,{})}),c.jsx(Ut,{path:"/admin/group-categories",element:c.jsx(Zwt,{})}),c.jsx(Ut,{path:"/admin/group-categories/new",element:c.jsx(rae,{})}),c.jsx(Ut,{path:"/admin/group-categories/:id",element:c.jsx(rae,{})}),c.jsx(Ut,{path:"/admin/events",element:c.jsx(Qwt,{})}),c.jsx(Ut,{path:"/admin/events/new",element:c.jsx(aae,{})}),c.jsx(Ut,{path:"/admin/events/:id",element:c.jsx(aae,{})}),c.jsx(Ut,{path:"/admin/events-categories",element:c.jsx(eSt,{})}),c.jsx(Ut,{path:"/admin/events-categories/new",element:c.jsx(sae,{})}),c.jsx(Ut,{path:"/admin/events-categories/:id",element:c.jsx(sae,{})}),c.jsx(Ut,{path:"/admin/payment-requests",element:c.jsx(tSt,{})}),c.jsx(Ut,{path:"/admin/settings/payments",element:c.jsx(oSt,{})}),c.jsx(Ut,{path:"/admin/wallet-settings",element:c.jsx(hSt,{})}),c.jsx(Ut,{path:"/admin/earnings/packages",element:c.jsx(gSt,{})}),c.jsx(Ut,{path:"/admin/packages",element:c.jsx(SSt,{})}),c.jsx(Ut,{path:"/admin/packages/new",element:c.jsx(cae,{})}),c.jsx(Ut,{path:"/admin/packages/:id/edit",element:c.jsx(cae,{})}),c.jsx(Ut,{path:"/admin/subscribers",element:c.jsx(CSt,{})}),c.jsx(Ut,{path:"/admin/settings/points",element:c.jsx(RSt,{})}),c.jsx(Ut,{path:"/admin/reports",element:c.jsx(ASt,{})}),c.jsx(Ut,{path:"/admin/reports/categories",element:c.jsx(FSt,{})}),c.jsx(Ut,{path:"/admin/ads",element:c.jsx(KSt,{})}),c.jsx(Ut,{path:"/admin/adssettings",element:c.jsx(PSt,{})})]})]})})]})})})})})});(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function e(P){try{return P.defaultView&&P.defaultView.frameElement||null}catch{return null}}var t=function(P){for(var M=P,D=e(M);D;)M=D.ownerDocument,D=e(M);return M}(window.document),n=[],i=null,o=null;function u(P){this.time=P.time,this.target=P.target,this.rootBounds=R(P.rootBounds),this.boundingClientRect=R(P.boundingClientRect),this.intersectionRect=R(P.intersectionRect||C()),this.isIntersecting=!!P.intersectionRect;var M=this.boundingClientRect,D=M.width*M.height,U=this.intersectionRect,F=U.width*U.height;D?this.intersectionRatio=Number((F/D).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function h(P,M){var D=M||{};if(typeof P!="function")throw new Error("callback must be a function");if(D.root&&D.root.nodeType!=1&&D.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=g(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=P,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(D.rootMargin),this.thresholds=this._initThresholds(D.threshold),this.root=D.root||null,this.rootMargin=this._rootMarginValues.map(function(U){return U.value+U.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}h.prototype.THROTTLE_TIMEOUT=100,h.prototype.POLL_INTERVAL=null,h.prototype.USE_MUTATION_OBSERVER=!0,h._setupCrossOriginUpdater=function(){return i||(i=function(P,M){!P||!M?o=C():o=N(P,M),n.forEach(function(D){D._checkForIntersections()})}),i},h._resetCrossOriginUpdater=function(){i=null,o=null},h.prototype.observe=function(P){var M=this._observationTargets.some(function(D){return D.element==P});if(!M){if(!(P&&P.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:P,entry:null}),this._monitorIntersections(P.ownerDocument),this._checkForIntersections()}},h.prototype.unobserve=function(P){this._observationTargets=this._observationTargets.filter(function(M){return M.element!=P}),this._unmonitorIntersections(P.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},h.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},h.prototype.takeRecords=function(){var P=this._queuedEntries.slice();return this._queuedEntries=[],P},h.prototype._initThresholds=function(P){var M=P||[0];return Array.isArray(M)||(M=[M]),M.sort().filter(function(D,U,F){if(typeof D!="number"||isNaN(D)||D<0||D>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return D!==F[U-1]})},h.prototype._parseRootMargin=function(P){var M=P||"0px",D=M.split(/\s+/).map(function(U){var F=/^(-?\d*\.?\d+)(px|%)$/.exec(U);if(!F)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(F[1]),unit:F[2]}});return D[1]=D[1]||D[0],D[2]=D[2]||D[0],D[3]=D[3]||D[1],D},h.prototype._monitorIntersections=function(P){var M=P.defaultView;if(M&&this._monitoringDocuments.indexOf(P)==-1){var D=this._checkForIntersections,U=null,F=null;this.POLL_INTERVAL?U=M.setInterval(D,this.POLL_INTERVAL):(v(M,"resize",D,!0),v(P,"scroll",D,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in M&&(F=new M.MutationObserver(D),F.observe(P,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(P),this._monitoringUnsubscribes.push(function(){var q=P.defaultView;q&&(U&&q.clearInterval(U),b(q,"resize",D,!0)),b(P,"scroll",D,!0),F&&F.disconnect()});var H=this.root&&(this.root.ownerDocument||this.root)||t;if(P!=H){var W=e(P);W&&this._monitorIntersections(W.ownerDocument)}}},h.prototype._unmonitorIntersections=function(P){var M=this._monitoringDocuments.indexOf(P);if(M!=-1){var D=this.root&&(this.root.ownerDocument||this.root)||t,U=this._observationTargets.some(function(W){var q=W.element.ownerDocument;if(q==P)return!0;for(;q&&q!=D;){var Y=e(q);if(q=Y&&Y.ownerDocument,q==P)return!0}return!1});if(!U){var F=this._monitoringUnsubscribes[M];if(this._monitoringDocuments.splice(M,1),this._monitoringUnsubscribes.splice(M,1),F(),P!=D){var H=e(P);H&&this._unmonitorIntersections(H.ownerDocument)}}}},h.prototype._unmonitorAllIntersections=function(){var P=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var M=0;M<P.length;M++)P[M]()},h.prototype._checkForIntersections=function(){if(!(!this.root&&i&&!o)){var P=this._rootIsInDom(),M=P?this._getRootRect():C();this._observationTargets.forEach(function(D){var U=D.element,F=T(U),H=this._rootContainsTarget(U),W=D.entry,q=P&&H&&this._computeTargetAndRootIntersection(U,F,M),Y=null;this._rootContainsTarget(U)?(!i||this.root)&&(Y=M):Y=C();var z=D.entry=new u({time:p(),target:U,boundingClientRect:F,rootBounds:Y,intersectionRect:q});W?P&&H?this._hasCrossedThreshold(W,z)&&this._queuedEntries.push(z):W&&W.isIntersecting&&this._queuedEntries.push(z):this._queuedEntries.push(z)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},h.prototype._computeTargetAndRootIntersection=function(P,M,D){if(window.getComputedStyle(P).display!="none"){for(var U=M,F=j(P),H=!1;!H&&F;){var W=null,q=F.nodeType==1?window.getComputedStyle(F):{};if(q.display=="none")return null;if(F==this.root||F.nodeType==9)if(H=!0,F==this.root||F==t)i&&!this.root?!o||o.width==0&&o.height==0?(F=null,W=null,U=null):W=o:W=D;else{var Y=j(F),z=Y&&T(Y),Z=Y&&this._computeTargetAndRootIntersection(Y,z,D);z&&Z?(F=Y,W=N(z,Z)):(F=null,U=null)}else{var X=F.ownerDocument;F!=X.body&&F!=X.documentElement&&q.overflow!="visible"&&(W=T(F))}if(W&&(U=E(W,U)),!U)break;F=F&&j(F)}return U}},h.prototype._getRootRect=function(){var P;if(this.root&&!k(this.root))P=T(this.root);else{var M=k(this.root)?this.root:t,D=M.documentElement,U=M.body;P={top:0,left:0,right:D.clientWidth||U.clientWidth,width:D.clientWidth||U.clientWidth,bottom:D.clientHeight||U.clientHeight,height:D.clientHeight||U.clientHeight}}return this._expandRectByRootMargin(P)},h.prototype._expandRectByRootMargin=function(P){var M=this._rootMarginValues.map(function(U,F){return U.unit=="px"?U.value:U.value*(F%2?P.width:P.height)/100}),D={top:P.top-M[0],right:P.right+M[1],bottom:P.bottom+M[2],left:P.left-M[3]};return D.width=D.right-D.left,D.height=D.bottom-D.top,D},h.prototype._hasCrossedThreshold=function(P,M){var D=P&&P.isIntersecting?P.intersectionRatio||0:-1,U=M.isIntersecting?M.intersectionRatio||0:-1;if(D!==U)for(var F=0;F<this.thresholds.length;F++){var H=this.thresholds[F];if(H==D||H==U||H<D!=H<U)return!0}},h.prototype._rootIsInDom=function(){return!this.root||O(t,this.root)},h.prototype._rootContainsTarget=function(P){var M=this.root&&(this.root.ownerDocument||this.root)||t;return O(M,P)&&(!this.root||M==P.ownerDocument)},h.prototype._registerInstance=function(){n.indexOf(this)<0&&n.push(this)},h.prototype._unregisterInstance=function(){var P=n.indexOf(this);P!=-1&&n.splice(P,1)};function p(){return window.performance&&performance.now&&performance.now()}function g(P,M){var D=null;return function(){D||(D=setTimeout(function(){P(),D=null},M))}}function v(P,M,D,U){typeof P.addEventListener=="function"?P.addEventListener(M,D,U):typeof P.attachEvent=="function"&&P.attachEvent("on"+M,D)}function b(P,M,D,U){typeof P.removeEventListener=="function"?P.removeEventListener(M,D,U):typeof P.detachEvent=="function"&&P.detachEvent("on"+M,D)}function E(P,M){var D=Math.max(P.top,M.top),U=Math.min(P.bottom,M.bottom),F=Math.max(P.left,M.left),H=Math.min(P.right,M.right),W=H-F,q=U-D;return W>=0&&q>=0&&{top:D,bottom:U,left:F,right:H,width:W,height:q}||null}function T(P){var M;try{M=P.getBoundingClientRect()}catch{}return M?(M.width&&M.height||(M={top:M.top,right:M.right,bottom:M.bottom,left:M.left,width:M.right-M.left,height:M.bottom-M.top}),M):C()}function C(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function R(P){return!P||"x"in P?P:{top:P.top,y:P.top,bottom:P.bottom,left:P.left,x:P.left,right:P.right,width:P.width,height:P.height}}function N(P,M){var D=M.top-P.top,U=M.left-P.left;return{top:D,left:U,height:M.height,width:M.width,bottom:D+M.height,right:U+M.width}}function O(P,M){for(var D=M;D;){if(D==P)return!0;D=j(D)}return!1}function j(P){var M=P.parentNode;return P.nodeType==9&&P!=t?e(P):(M&&M.assignedSlot&&(M=M.assignedSlot.parentNode),M&&M.nodeType==11&&M.host?M.host:M)}function k(P){return P&&P.nodeType===9}window.IntersectionObserver=h,window.IntersectionObserverEntry=u})();Poe(document.getElementById("root")).render(c.jsx(YSt,{}));
